;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2009 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-313D-7374-F1			    |
; |   Aditya Thakur, University	of Wisconsin/Computer Sciences Department   |
; +-------------------------------------------------------------------------+
;
.text:00401000 ;
.text:00401000 ; +-------------------------------------------------------------------------+
.text:00401000 ; |   This file has been	generated by The Interactive Disassembler (IDA)	   |
.text:00401000 ; |	  Copyright (c)	2009 by	Hex-Rays, <support@hex-rays.com>	   |
.text:00401000 ; |			License	info: 48-313D-7374-F1			   |
.text:00401000 ; |   Aditya Thakur, University of Wisconsin/Computer Sciences Department   |
.text:00401000 ; +-------------------------------------------------------------------------+
.text:00401000 ;
.text:00401000 ; Input MD5   : 018D656B0E2029537BA75453CD78BFC6
.text:00401000
.text:00401000 ; File Name   : C:\aditya\work\waldo\tests\teststkl.exe
.text:00401000 ; Format	     : Portable	executable for 80386 (PE)
.text:00401000 ; Imagebase   : 400000
.text:00401000 ; Section 1. (virtual address 00001000)
.text:00401000 ; Virtual size		       : 0001BC89 ( 113801.)
.text:00401000 ; Section size in file	       : 0001C000 ( 114688.)
.text:00401000 ; Offset	to raw data for	section: 00001000
.text:00401000 ; Flags 60000020: Text Executable Readable
.text:00401000 ; Alignment     : default
.text:00401000 ; OS type	 :  MS Windows
.text:00401000 ; Application type:  Executable 32bit
.text:00401000
.text:00401000		       include uni.inc ; see unicode subdir of ida for info on unicode
.text:00401000
.text:00401000		       .686p
.text:00401000		       .mmx
.text:00401000		       .model flat
.text:00401000
.text:00401000 ; ===========================================================================
.text:00401000
.text:00401000 ; Segment type: Pure code
.text:00401000 ; Segment permissions: Read/Execute
.text:00401000 _text	       segment para public 'CODE' use32
.text:00401000		       assume cs:_text
.text:00401000		       ;org 401000h
.text:00401000		       assume es:nothing, ss:nothing, ds:_data,	fs:nothing, gs:nothing
.text:00401000		       db 5 dup(0CCh)
.text:00401005 ; [00000005 BYTES: COLLAPSED FUNCTION j__MakeEmpty. PRESS KEYPAD	"+" TO EXPAND]
.text:0040100A ; [00000005 BYTES: COLLAPSED FUNCTION j__CreateStack. PRESS KEYPAD "+" TO EXPAND]
.text:0040100F ; [00000005 BYTES: COLLAPSED FUNCTION j__Pop. PRESS KEYPAD "+" TO EXPAND]
.text:00401014 ; [00000005 BYTES: COLLAPSED FUNCTION j__Top. PRESS KEYPAD "+" TO EXPAND]
.text:00401019 ; [00000005 BYTES: COLLAPSED FUNCTION j__Push. PRESS KEYPAD "+" TO EXPAND]
.text:0040101E
.text:0040101E ; =============== S U B R O U T I N E =======================================
.text:0040101E
.text:0040101E
.text:0040101E ; int __cdecl main_0()
.text:0040101E _main_0	       proc near	       ; CODE XREF: __tmainCRTStartup+15Ap
.text:0040101E		       jmp     _main
.text:0040101E _main_0	       endp
.text:0040101E
.text:00401023 ; [00000005 BYTES: COLLAPSED FUNCTION j__IsEmpty. PRESS KEYPAD "+" TO EXPAND]
.text:00401028 ; [00000005 BYTES: COLLAPSED FUNCTION j__DisposeStack. PRESS KEYPAD "+" TO EXPAND]
.text:0040102D		       db 33h dup(0CCh)
.text:00401060
.text:00401060 ; =============== S U B R O U T I N E =======================================
.text:00401060
.text:00401060 ; Attributes: bp-based frame
.text:00401060
.text:00401060 ; int __cdecl main()
.text:00401060 _main	       proc near	       ; CODE XREF: _main_0j
.text:00401060
.text:00401060 S	       = dword ptr -8
.text:00401060 i	       = dword ptr -4
.text:00401060
.text:00401060		       push    ebp
.text:00401061		       mov     ebp, esp
.text:00401063		       sub     esp, 8
.text:00401066		       call    j__CreateStack
.text:0040106B		       mov     [ebp+S],	eax
.text:0040106E		       mov     [ebp+i],	0
.text:00401075		       jmp     short loc_401080
.text:00401077 ; ---------------------------------------------------------------------------
.text:00401077
.text:00401077 loc_401077:			       ; CODE XREF: _main+36j
.text:00401077		       mov     eax, [ebp+i]
.text:0040107A		       add     eax, 1
.text:0040107D		       mov     [ebp+i],	eax
.text:00401080
.text:00401080 loc_401080:			       ; CODE XREF: _main+15j
.text:00401080		       cmp     [ebp+i],	0Ah
.text:00401084		       jge     short loc_401098
.text:00401086		       mov     ecx, [ebp+S]
.text:00401089		       push    ecx	       ; S
.text:0040108A		       mov     edx, [ebp+i]
.text:0040108D		       push    edx	       ; X
.text:0040108E		       call    j__Push
.text:00401093		       add     esp, 8
.text:00401096		       jmp     short loc_401077
.text:00401098 ; ---------------------------------------------------------------------------
.text:00401098
.text:00401098 loc_401098:			       ; CODE XREF: _main+24j
.text:00401098					       ; _main+6Ej
.text:00401098		       mov     eax, [ebp+S]
.text:0040109B		       push    eax	       ; S
.text:0040109C		       call    j__IsEmpty
.text:004010A1		       add     esp, 4
.text:004010A4		       test    eax, eax
.text:004010A6		       jnz     short loc_4010D0
.text:004010A8		       mov     ecx, [ebp+S]
.text:004010AB		       push    ecx	       ; S
.text:004010AC		       call    j__Top
.text:004010B1		       add     esp, 4
.text:004010B4		       push    eax
.text:004010B5		       push    offset format   ; "%d\n"
.text:004010BA		       call    _printf
.text:004010BF		       add     esp, 8
.text:004010C2		       mov     edx, [ebp+S]
.text:004010C5		       push    edx	       ; S
.text:004010C6		       call    j__Pop
.text:004010CB		       add     esp, 4
.text:004010CE		       jmp     short loc_401098
.text:004010D0 ; ---------------------------------------------------------------------------
.text:004010D0
.text:004010D0 loc_4010D0:			       ; CODE XREF: _main+46j
.text:004010D0		       mov     eax, [ebp+S]
.text:004010D3		       push    eax	       ; S
.text:004010D4		       call    j__DisposeStack
.text:004010D9		       add     esp, 4
.text:004010DC		       xor     eax, eax
.text:004010DE		       mov     esp, ebp
.text:004010E0		       pop     ebp
.text:004010E1		       retn
.text:004010E1 _main	       endp
.text:004010E1
.text:004010E1 ; ---------------------------------------------------------------------------
.text:004010E2		       db 2Eh dup(0CCh)
.text:00401110
.text:00401110 ; =============== S U B R O U T I N E =======================================
.text:00401110
.text:00401110 ; Attributes: bp-based frame
.text:00401110
.text:00401110 ; int __cdecl IsEmpty(Node *S)
.text:00401110 _IsEmpty	       proc near	       ; CODE XREF: j__IsEmptyj
.text:00401110
.text:00401110 S	       = dword ptr  8
.text:00401110
.text:00401110		       push    ebp
.text:00401111		       mov     ebp, esp
.text:00401113		       mov     eax, [ebp+S]
.text:00401116		       xor     ecx, ecx
.text:00401118		       cmp     dword ptr [eax+4], 0
.text:0040111C		       setz    cl
.text:0040111F		       mov     eax, ecx
.text:00401121		       pop     ebp
.text:00401122		       retn
.text:00401122 _IsEmpty	       endp
.text:00401122
.text:00401122 ; ---------------------------------------------------------------------------
.text:00401123		       align 10h
.text:00401130
.text:00401130 ; =============== S U B R O U T I N E =======================================
.text:00401130
.text:00401130 ; Attributes: bp-based frame
.text:00401130
.text:00401130 ; Node *__cdecl CreateStack()
.text:00401130 _CreateStack    proc near	       ; CODE XREF: j__CreateStackj
.text:00401130
.text:00401130 S	       = dword ptr -4
.text:00401130
.text:00401130		       push    ebp
.text:00401131		       mov     ebp, esp
.text:00401133		       push    ecx
.text:00401134		       push    8	       ; size
.text:00401136		       call    _malloc
.text:0040113B		       add     esp, 4
.text:0040113E		       mov     [ebp+S],	eax
.text:00401141		       cmp     [ebp+S],	0
.text:00401145		       jnz     short loc_401169
.text:00401147		       push    offset aOutOfSpace ; "Out of space!!!"
.text:0040114C		       push    offset aS       ; "%s\n"
.text:00401151		       call    ___iob_func
.text:00401156		       add     eax, 40h
.text:00401159		       push    eax	       ; str
.text:0040115A		       call    _fprintf
.text:0040115F		       add     esp, 0Ch
.text:00401162		       push    1	       ; code
.text:00401164		       call    _exit
.text:00401169 ; ---------------------------------------------------------------------------
.text:00401169
.text:00401169 loc_401169:			       ; CODE XREF: _CreateStack+15j
.text:00401169		       mov     eax, [ebp+S]
.text:0040116C		       mov     dword ptr [eax+4], 0
.text:00401173		       mov     ecx, [ebp+S]
.text:00401176		       push    ecx	       ; S
.text:00401177		       call    j__MakeEmpty
.text:0040117C		       add     esp, 4
.text:0040117F		       mov     eax, [ebp+S]
.text:00401182		       mov     esp, ebp
.text:00401184		       pop     ebp
.text:00401185		       retn
.text:00401185 _CreateStack    endp
.text:00401185
.text:00401185 ; ---------------------------------------------------------------------------
.text:00401186		       align 10h
.text:00401190
.text:00401190 ; =============== S U B R O U T I N E =======================================
.text:00401190
.text:00401190 ; Attributes: bp-based frame
.text:00401190
.text:00401190 ; void __cdecl MakeEmpty(Node *S)
.text:00401190 _MakeEmpty      proc near	       ; CODE XREF: j__MakeEmptyj
.text:00401190
.text:00401190 S	       = dword ptr  8
.text:00401190
.text:00401190		       push    ebp
.text:00401191		       mov     ebp, esp
.text:00401193		       cmp     [ebp+S],	0
.text:00401197		       jnz     short loc_4011BD
.text:00401199		       push    offset aMustUseCreates ;	"Must use CreateStack first"
.text:0040119E		       push    offset aS_0     ; "%s\n"
.text:004011A3		       call    ___iob_func
.text:004011A8		       add     eax, 40h
.text:004011AB		       push    eax	       ; str
.text:004011AC		       call    _fprintf
.text:004011B1		       add     esp, 0Ch
.text:004011B4		       push    1	       ; code
.text:004011B6		       call    _exit
.text:004011BB ; ---------------------------------------------------------------------------
.text:004011BB		       jmp     short loc_4011DB
.text:004011BD ; ---------------------------------------------------------------------------
.text:004011BD
.text:004011BD loc_4011BD:			       ; CODE XREF: _MakeEmpty+7j
.text:004011BD					       ; _MakeEmpty+49j
.text:004011BD		       mov     eax, [ebp+S]
.text:004011C0		       push    eax	       ; S
.text:004011C1		       call    j__IsEmpty
.text:004011C6		       add     esp, 4
.text:004011C9		       test    eax, eax
.text:004011CB		       jnz     short loc_4011DB
.text:004011CD		       mov     ecx, [ebp+S]
.text:004011D0		       push    ecx	       ; S
.text:004011D1		       call    j__Pop
.text:004011D6		       add     esp, 4
.text:004011D9		       jmp     short loc_4011BD
.text:004011DB ; ---------------------------------------------------------------------------
.text:004011DB
.text:004011DB loc_4011DB:			       ; CODE XREF: _MakeEmpty+2Bj
.text:004011DB					       ; _MakeEmpty+3Bj
.text:004011DB		       pop     ebp
.text:004011DC		       retn
.text:004011DC _MakeEmpty      endp ; sp-analysis failed
.text:004011DC
.text:004011DC ; ---------------------------------------------------------------------------
.text:004011DD		       align 10h
.text:004011E0
.text:004011E0 ; =============== S U B R O U T I N E =======================================
.text:004011E0
.text:004011E0 ; Attributes: bp-based frame
.text:004011E0
.text:004011E0 ; void __cdecl DisposeStack(Node	*S)
.text:004011E0 _DisposeStack   proc near	       ; CODE XREF: j__DisposeStackj
.text:004011E0
.text:004011E0 S	       = dword ptr  8
.text:004011E0
.text:004011E0		       push    ebp
.text:004011E1		       mov     ebp, esp
.text:004011E3		       mov     eax, [ebp+S]
.text:004011E6		       push    eax	       ; S
.text:004011E7		       call    j__MakeEmpty
.text:004011EC		       add     esp, 4
.text:004011EF		       mov     ecx, [ebp+S]
.text:004011F2		       push    ecx	       ; pBlock
.text:004011F3		       call    _free
.text:004011F8		       add     esp, 4
.text:004011FB		       pop     ebp
.text:004011FC		       retn
.text:004011FC _DisposeStack   endp
.text:004011FC
.text:004011FC ; ---------------------------------------------------------------------------
.text:004011FD		       align 10h
.text:00401200
.text:00401200 ; =============== S U B R O U T I N E =======================================
.text:00401200
.text:00401200 ; Attributes: bp-based frame
.text:00401200
.text:00401200 ; void __cdecl Push(int X, Node *S)
.text:00401200 _Push	       proc near	       ; CODE XREF: j__Pushj
.text:00401200
.text:00401200 TmpCell	       = dword ptr -4
.text:00401200 X	       = dword ptr  8
.text:00401200 S	       = dword ptr  0Ch
.text:00401200
.text:00401200		       push    ebp
.text:00401201		       mov     ebp, esp
.text:00401203		       push    ecx
.text:00401204		       push    8	       ; size
.text:00401206		       call    _malloc
.text:0040120B		       add     esp, 4
.text:0040120E		       mov     [ebp+TmpCell], eax
.text:00401211		       cmp     [ebp+TmpCell], 0
.text:00401215		       jnz     short loc_40123B
.text:00401217		       push    offset aOutOfSpace_0 ; "Out of space!!!"
.text:0040121C		       push    offset aS_1     ; "%s\n"
.text:00401221		       call    ___iob_func
.text:00401226		       add     eax, 40h
.text:00401229		       push    eax	       ; str
.text:0040122A		       call    _fprintf
.text:0040122F		       add     esp, 0Ch
.text:00401232		       push    1	       ; code
.text:00401234		       call    _exit
.text:00401239 ; ---------------------------------------------------------------------------
.text:00401239		       jmp     short loc_401258
.text:0040123B ; ---------------------------------------------------------------------------
.text:0040123B
.text:0040123B loc_40123B:			       ; CODE XREF: _Push+15j
.text:0040123B		       mov     eax, [ebp+TmpCell]
.text:0040123E		       mov     ecx, [ebp+X]
.text:00401241		       mov     [eax], ecx
.text:00401243		       mov     edx, [ebp+TmpCell]
.text:00401246		       mov     eax, [ebp+S]
.text:00401249		       mov     ecx, [eax+4]
.text:0040124C		       mov     [edx+4],	ecx
.text:0040124F		       mov     edx, [ebp+S]
.text:00401252		       mov     eax, [ebp+TmpCell]
.text:00401255		       mov     [edx+4],	eax
.text:00401258
.text:00401258 loc_401258:			       ; CODE XREF: _Push+39j
.text:00401258		       mov     esp, ebp
.text:0040125A		       pop     ebp
.text:0040125B		       retn
.text:0040125B _Push	       endp
.text:0040125B
.text:0040125B ; ---------------------------------------------------------------------------
.text:0040125C		       align 10h
.text:00401260
.text:00401260 ; =============== S U B R O U T I N E =======================================
.text:00401260
.text:00401260 ; Attributes: bp-based frame
.text:00401260
.text:00401260 ; int __cdecl Top(Node *S)
.text:00401260 _Top	       proc near	       ; CODE XREF: j__Topj
.text:00401260
.text:00401260 S	       = dword ptr  8
.text:00401260
.text:00401260		       push    ebp
.text:00401261		       mov     ebp, esp
.text:00401263		       mov     eax, [ebp+S]
.text:00401266		       push    eax	       ; S
.text:00401267		       call    j__IsEmpty
.text:0040126C		       add     esp, 4
.text:0040126F		       test    eax, eax
.text:00401271		       jnz     short loc_40127D
.text:00401273		       mov     ecx, [ebp+S]
.text:00401276		       mov     edx, [ecx+4]
.text:00401279		       mov     eax, [edx]
.text:0040127B		       jmp     short loc_4012A1
.text:0040127D ; ---------------------------------------------------------------------------
.text:0040127D
.text:0040127D loc_40127D:			       ; CODE XREF: _Top+11j
.text:0040127D		       push    offset aEmptyStack ; "Empty stack"
.text:00401282		       push    offset aS_2     ; "%s\n"
.text:00401287		       call    ___iob_func
.text:0040128C		       add     eax, 40h
.text:0040128F		       push    eax	       ; str
.text:00401290		       call    _fprintf
.text:00401295		       add     esp, 0Ch
.text:00401298		       push    1	       ; code
.text:0040129A		       call    _exit
.text:0040129F ; ---------------------------------------------------------------------------
.text:0040129F		       xor     eax, eax
.text:004012A1
.text:004012A1 loc_4012A1:			       ; CODE XREF: _Top+1Bj
.text:004012A1		       pop     ebp
.text:004012A2		       retn
.text:004012A2 _Top	       endp ; sp-analysis failed
.text:004012A2
.text:004012A2 ; ---------------------------------------------------------------------------
.text:004012A3		       align 10h
.text:004012B0
.text:004012B0 ; =============== S U B R O U T I N E =======================================
.text:004012B0
.text:004012B0 ; Attributes: bp-based frame
.text:004012B0
.text:004012B0 ; void __cdecl Pop(Node *S)
.text:004012B0 _Pop	       proc near	       ; CODE XREF: j__Popj
.text:004012B0
.text:004012B0 FirstCell       = dword ptr -4
.text:004012B0 S	       = dword ptr  8
.text:004012B0
.text:004012B0		       push    ebp
.text:004012B1		       mov     ebp, esp
.text:004012B3		       push    ecx
.text:004012B4		       mov     eax, [ebp+S]
.text:004012B7		       push    eax	       ; S
.text:004012B8		       call    j__IsEmpty
.text:004012BD		       add     esp, 4
.text:004012C0		       test    eax, eax
.text:004012C2		       jz      short loc_4012E8
.text:004012C4		       push    offset aEmptyStack_0 ; "Empty stack"
.text:004012C9		       push    offset aS_3     ; "%s\n"
.text:004012CE		       call    ___iob_func
.text:004012D3		       add     eax, 40h
.text:004012D6		       push    eax	       ; str
.text:004012D7		       call    _fprintf
.text:004012DC		       add     esp, 0Ch
.text:004012DF		       push    1	       ; code
.text:004012E1		       call    _exit
.text:004012E6 ; ---------------------------------------------------------------------------
.text:004012E6		       jmp     short loc_40130C
.text:004012E8 ; ---------------------------------------------------------------------------
.text:004012E8
.text:004012E8 loc_4012E8:			       ; CODE XREF: _Pop+12j
.text:004012E8		       mov     ecx, [ebp+S]
.text:004012EB		       mov     edx, [ecx+4]
.text:004012EE		       mov     [ebp+FirstCell],	edx
.text:004012F1		       mov     eax, [ebp+S]
.text:004012F4		       mov     ecx, [eax+4]
.text:004012F7		       mov     edx, [ebp+S]
.text:004012FA		       mov     eax, [ecx+4]
.text:004012FD		       mov     [edx+4],	eax
.text:00401300		       mov     ecx, [ebp+FirstCell]
.text:00401303		       push    ecx	       ; pBlock
.text:00401304		       call    _free
.text:00401309		       add     esp, 4
.text:0040130C
.text:0040130C loc_40130C:			       ; CODE XREF: _Pop+36j
.text:0040130C		       mov     esp, ebp
.text:0040130E		       pop     ebp
.text:0040130F		       retn
.text:0040130F _Pop	       endp
.text:0040130F
.text:0040130F ; ---------------------------------------------------------------------------
.text:00401310		       db 80h dup(0CCh)
.text:00401390
.text:00401390 ; =============== S U B R O U T I N E =======================================
.text:00401390
.text:00401390 ; Attributes: bp-based frame
.text:00401390
.text:00401390 ; int __cdecl printf(const char *format)
.text:00401390 _printf	       proc near	       ; CODE XREF: _main+5Ap
.text:00401390
.text:00401390 retval	       = dword ptr -1Ch
.text:00401390 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00401390 format	       = dword ptr  8
.text:00401390 argptr	       = byte ptr  0Ch
.text:00401390
.text:00401390		       push    0Ch
.text:00401392		       push    offset dword_420450
.text:00401397		       call    __SEH_prolog4
.text:0040139C		       xor     eax, eax
.text:0040139E		       xor     esi, esi
.text:004013A0		       cmp     [ebp+format], esi
.text:004013A3		       setnz   al
.text:004013A6		       cmp     eax, esi
.text:004013A8		       jnz     short loc_4013C7
.text:004013AA		       call    __errno
.text:004013AF		       mov     dword ptr [eax],	16h
.text:004013B5		       push    esi	       ; pReserved
.text:004013B6		       push    esi	       ; nLine
.text:004013B7		       push    esi	       ; pszFile
.text:004013B8		       push    esi	       ; pszFunction
.text:004013B9		       push    esi	       ; pszExpression
.text:004013BA		       call    __invalid_parameter
.text:004013BF		       add     esp, 14h
.text:004013C2		       or      eax, 0FFFFFFFFh
.text:004013C5		       jmp     short loc_401426
.text:004013C7 ; ---------------------------------------------------------------------------
.text:004013C7
.text:004013C7 loc_4013C7:			       ; CODE XREF: _printf+18j
.text:004013C7		       call    ___iob_func
.text:004013CC		       push    20h
.text:004013CE		       pop     ebx
.text:004013CF		       add     eax, ebx
.text:004013D1		       push    eax	       ; s
.text:004013D2		       push    1	       ; i
.text:004013D4		       call    __lock_file2
.text:004013D9		       pop     ecx
.text:004013DA		       pop     ecx
.text:004013DB		       mov     [ebp+ms_exc.disabled], esi
.text:004013DE		       call    ___iob_func
.text:004013E3		       add     eax, ebx
.text:004013E5		       push    eax	       ; str
.text:004013E6		       call    __stbuf
.text:004013EB		       pop     ecx
.text:004013EC		       mov     edi, eax
.text:004013EE		       lea     eax, [ebp+argptr]
.text:004013F1		       push    eax	       ; argptr
.text:004013F2		       push    esi	       ; plocinfo
.text:004013F3		       push    [ebp+format]    ; format
.text:004013F6		       call    ___iob_func
.text:004013FB		       add     eax, ebx
.text:004013FD		       push    eax	       ; stream
.text:004013FE		       call    __output_l
.text:00401403		       mov     [ebp+retval], eax
.text:00401406		       call    ___iob_func
.text:0040140B		       add     eax, ebx
.text:0040140D		       push    eax	       ; str
.text:0040140E		       push    edi	       ; flag
.text:0040140F		       call    __ftbuf
.text:00401414		       add     esp, 18h
.text:00401417		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040141E		       call    $LN6
.text:00401423
.text:00401423 $LN9:
.text:00401423		       mov     eax, [ebp+retval]
.text:00401426
.text:00401426 loc_401426:			       ; CODE XREF: _printf+35j
.text:00401426		       call    __SEH_epilog4
.text:0040142B		       retn
.text:0040142C ; ---------------------------------------------------------------------------
.text:0040142C
.text:0040142C $LN6:				       ; CODE XREF: _printf+8Ep
.text:0040142C					       ; DATA XREF: .rdata:00420468o
.text:0040142C		       call    ___iob_func
.text:00401431		       add     eax, 20h
.text:00401434		       push    eax	       ; s
.text:00401435		       push    1	       ; i
.text:00401437		       call    __unlock_file2
.text:0040143C		       pop     ecx
.text:0040143D		       pop     ecx
.text:0040143E
.text:0040143E $LN7:
.text:0040143E		       retn
.text:0040143E _printf	       endp
.text:0040143E
.text:0040143F
.text:0040143F ; =============== S U B R O U T I N E =======================================
.text:0040143F
.text:0040143F
.text:0040143F ; int __cdecl _printf_l(const char *format, localeinfo_struct *plocinfo)
.text:0040143F __printf_l      proc near
.text:0040143F
.text:0040143F format	       = dword ptr  4
.text:0040143F plocinfo	       = dword ptr  8
.text:0040143F ap	       = byte ptr  0Ch
.text:0040143F
.text:0040143F		       lea     eax, [esp+ap]
.text:00401443		       push    eax	       ; ap
.text:00401444		       push    [esp+4+plocinfo]	; plocinfo
.text:00401448		       push    [esp+8+format]  ; format
.text:0040144C		       call    __vprintf_l
.text:00401451		       add     esp, 0Ch
.text:00401454		       retn
.text:00401454 __printf_l      endp
.text:00401454
.text:00401455
.text:00401455 ; =============== S U B R O U T I N E =======================================
.text:00401455
.text:00401455
.text:00401455 ; int __cdecl _printf_s_l(const char *format, localeinfo_struct *plocinfo)
.text:00401455 __printf_s_l    proc near
.text:00401455
.text:00401455 format	       = dword ptr  4
.text:00401455 plocinfo	       = dword ptr  8
.text:00401455 ap	       = byte ptr  0Ch
.text:00401455
.text:00401455		       lea     eax, [esp+ap]
.text:00401459		       push    eax	       ; ap
.text:0040145A		       push    [esp+4+plocinfo]	; plocinfo
.text:0040145E		       push    [esp+8+format]  ; format
.text:00401462		       call    __vprintf_s_l
.text:00401467		       add     esp, 0Ch
.text:0040146A		       retn
.text:0040146A __printf_s_l    endp
.text:0040146A
.text:0040146B
.text:0040146B ; =============== S U B R O U T I N E =======================================
.text:0040146B
.text:0040146B
.text:0040146B ; int __cdecl printf_s(const char *format)
.text:0040146B _printf_s       proc near
.text:0040146B
.text:0040146B format	       = dword ptr  4
.text:0040146B ap	       = byte ptr  8
.text:0040146B
.text:0040146B		       lea     eax, [esp+ap]
.text:0040146F		       push    eax	       ; ap
.text:00401470		       push    0	       ; plocinfo
.text:00401472		       push    [esp+8+format]  ; format
.text:00401476		       call    __vprintf_s_l
.text:0040147B		       add     esp, 0Ch
.text:0040147E		       retn
.text:0040147E _printf_s       endp
.text:0040147E
.text:0040147F
.text:0040147F ; =============== S U B R O U T I N E =======================================
.text:0040147F
.text:0040147F
.text:0040147F ; int __cdecl _printf_p_l(const char *format, localeinfo_struct *plocinfo)
.text:0040147F __printf_p_l    proc near
.text:0040147F
.text:0040147F format	       = dword ptr  4
.text:0040147F plocinfo	       = dword ptr  8
.text:0040147F ap	       = byte ptr  0Ch
.text:0040147F
.text:0040147F		       lea     eax, [esp+ap]
.text:00401483		       push    eax	       ; ap
.text:00401484		       push    [esp+4+plocinfo]	; plocinfo
.text:00401488		       push    [esp+8+format]  ; format
.text:0040148C		       call    __vprintf_p_l
.text:00401491		       add     esp, 0Ch
.text:00401494		       retn
.text:00401494 __printf_p_l    endp
.text:00401494
.text:00401495
.text:00401495 ; =============== S U B R O U T I N E =======================================
.text:00401495
.text:00401495
.text:00401495 ; int __cdecl _printf_p(const char *format)
.text:00401495 __printf_p      proc near
.text:00401495
.text:00401495 format	       = dword ptr  4
.text:00401495 ap	       = byte ptr  8
.text:00401495
.text:00401495		       lea     eax, [esp+ap]
.text:00401499		       push    eax	       ; ap
.text:0040149A		       push    0	       ; plocinfo
.text:0040149C		       push    [esp+8+format]  ; format
.text:004014A0		       call    __vprintf_p_l
.text:004014A5		       add     esp, 0Ch
.text:004014A8		       retn
.text:004014A8 __printf_p      endp
.text:004014A8
.text:004014A9
.text:004014A9 ; =============== S U B R O U T I N E =======================================
.text:004014A9
.text:004014A9
.text:004014A9 ; int __cdecl _set_printf_count_output(int value)
.text:004014A9 __set_printf_count_output proc near
.text:004014A9
.text:004014A9 value	       = dword ptr  4
.text:004014A9
.text:004014A9		       mov     ecx, ___security_cookie
.text:004014AF		       mov     edx, [esp+value]
.text:004014B3		       or      ecx, 1
.text:004014B6		       xor     eax, eax
.text:004014B8		       cmp     __enable_percent_n, ecx
.text:004014BE		       setz    al
.text:004014C1		       neg     edx
.text:004014C3		       sbb     edx, edx
.text:004014C5		       and     edx, ecx
.text:004014C7		       mov     __enable_percent_n, edx
.text:004014CD		       retn
.text:004014CD __set_printf_count_output endp
.text:004014CD
.text:004014CE
.text:004014CE ; =============== S U B R O U T I N E =======================================
.text:004014CE
.text:004014CE
.text:004014CE ; int __cdecl _get_printf_count_output()
.text:004014CE __get_printf_count_output proc near     ; CODE XREF: __output_l+554p
.text:004014CE					       ; __output_s_l+562p ...
.text:004014CE		       mov     eax, ___security_cookie
.text:004014D3		       or      eax, 1
.text:004014D6		       xor     ecx, ecx
.text:004014D8		       cmp     __enable_percent_n, eax
.text:004014DE		       setz    cl
.text:004014E1		       mov     eax, ecx
.text:004014E3		       retn
.text:004014E3 __get_printf_count_output endp
.text:004014E3
.text:004014E4
.text:004014E4 ; =============== S U B R O U T I N E =======================================
.text:004014E4
.text:004014E4
.text:004014E4 ; void __cdecl _amsg_exit(int rterrnum)
.text:004014E4 __amsg_exit     proc near	       ; CODE XREF: __tmainCRTStartup+F3p
.text:004014E4					       ; __tmainCRTStartup+119p ...
.text:004014E4
.text:004014E4 rterrnum	       = dword ptr  4
.text:004014E4
.text:004014E4		       call    __FF_MSGBANNER
.text:004014E9		       push    [esp+rterrnum]  ; rterrnum
.text:004014ED		       call    __NMSG_WRITE
.text:004014F2		       push    __aexit_rtn     ; codedptr
.text:004014F8		       call    __decode_pointer
.text:004014FD		       push    0FFh
.text:00401502		       call    eax
.text:00401504		       add     esp, 0Ch
.text:00401507		       retn
.text:00401507 __amsg_exit     endp
.text:00401507
.text:00401508
.text:00401508 ; =============== S U B R O U T I N E =======================================
.text:00401508
.text:00401508
.text:00401508 ; void __cdecl __crtCorExitProcess(int status)
.text:00401508 ___crtCorExitProcess proc near	       ; CODE XREF: ___crtExitProcess+4p
.text:00401508
.text:00401508 status	       = dword ptr  4
.text:00401508
.text:00401508		       push    offset ModuleName ; "mscoree.dll"
.text:0040150D		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00401513		       test    eax, eax
.text:00401515		       jz      short locret_40152D
.text:00401517		       push    offset ProcName ; "CorExitProcess"
.text:0040151C		       push    eax	       ; hModule
.text:0040151D		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00401523		       test    eax, eax
.text:00401525		       jz      short locret_40152D
.text:00401527		       push    [esp+status]
.text:0040152B		       call    eax
.text:0040152D
.text:0040152D locret_40152D:			       ; CODE XREF: ___crtCorExitProcess+Dj
.text:0040152D					       ; ___crtCorExitProcess+1Dj
.text:0040152D		       retn
.text:0040152D ___crtCorExitProcess endp
.text:0040152D
.text:0040152E
.text:0040152E ; =============== S U B R O U T I N E =======================================
.text:0040152E
.text:0040152E ; Attributes: noreturn
.text:0040152E
.text:0040152E ; void __cdecl __crtExitProcess(int status)
.text:0040152E ___crtExitProcess proc near	       ; CODE XREF: doexit+C5p
.text:0040152E					       ; __heap_alloc+1Ap ...
.text:0040152E
.text:0040152E status	       = dword ptr  4
.text:0040152E
.text:0040152E		       push    [esp+status]    ; status
.text:00401532		       call    ___crtCorExitProcess
.text:00401537		       pop     ecx
.text:00401538		       push    [esp+status]    ; uExitCode
.text:0040153C		       call    ds:__imp__ExitProcess@4 ; ExitProcess(x)
.text:0040153C ; ---------------------------------------------------------------------------
.text:00401542 $LN4	       db 0CCh
.text:00401542 ___crtExitProcess endp
.text:00401542
.text:00401543
.text:00401543 ; =============== S U B R O U T I N E =======================================
.text:00401543
.text:00401543
.text:00401543 __lockexit      proc near	       ; CODE XREF: __onexit+Cp
.text:00401543		       push    8	       ; locknum
.text:00401545		       call    __lock
.text:0040154A		       pop     ecx
.text:0040154B		       retn
.text:0040154B __lockexit      endp
.text:0040154B
.text:0040154C
.text:0040154C ; =============== S U B R O U T I N E =======================================
.text:0040154C
.text:0040154C
.text:0040154C __unlockexit    proc near	       ; CODE XREF: __onexit:$LN5p
.text:0040154C		       push    8	       ; locknum
.text:0040154E		       call    __unlock
.text:00401553		       pop     ecx
.text:00401554		       retn
.text:00401554 __unlockexit    endp
.text:00401554
.text:00401555
.text:00401555 ; =============== S U B R O U T I N E =======================================
.text:00401555
.text:00401555
.text:00401555 ; void __usercall initterm(void (__cdecl	**pfbegin)()<eax>, void	(__cdecl **pfend)())
.text:00401555 _initterm       proc near	       ; CODE XREF: doexit+8Cp
.text:00401555					       ; doexit+9Cp
.text:00401555
.text:00401555 pfend	       = dword ptr  4
.text:00401555
.text:00401555 pfbegin = eax
.text:00401555		       push    esi
.text:00401556		       mov     esi, pfbegin
.text:00401558		       jmp     short loc_401565
.text:0040155A ; ---------------------------------------------------------------------------
.text:0040155A
.text:0040155A loc_40155A:			       ; CODE XREF: _initterm+14j
.text:0040155A		       mov     pfbegin,	[esi]
.text:0040155C		       test    pfbegin,	pfbegin
.text:0040155E		       jz      short loc_401562
.text:00401560		       call    pfbegin
.text:00401562
.text:00401562 loc_401562:			       ; CODE XREF: _initterm+9j
.text:00401562		       add     esi, 4
.text:00401565
.text:00401565 loc_401565:			       ; CODE XREF: _initterm+3j
.text:00401565		       cmp     esi, [esp+4+pfend]
.text:00401569		       jb      short loc_40155A
.text:0040156B		       pop     esi
.text:0040156C		       retn
.text:0040156C _initterm       endp
.text:0040156C
.text:0040156D
.text:0040156D ; =============== S U B R O U T I N E =======================================
.text:0040156D
.text:0040156D
.text:0040156D ; int __cdecl _initterm_e(int (__cdecl **pfbegin)(), int	(__cdecl **pfend)())
.text:0040156D __initterm_e    proc near	       ; CODE XREF: __cinit+32p
.text:0040156D
.text:0040156D pfbegin	       = dword ptr  4
.text:0040156D pfend	       = dword ptr  8
.text:0040156D
.text:0040156D		       push    esi
.text:0040156E		       mov     esi, [esp+4+pfbegin]
.text:00401572		       xor     eax, eax
.text:00401574		       jmp     short loc_401585
.text:00401576 ; ---------------------------------------------------------------------------
.text:00401576
.text:00401576 loc_401576:			       ; CODE XREF: __initterm_e+1Cj
.text:00401576		       test    eax, eax
.text:00401578		       jnz     short loc_40158B
.text:0040157A		       mov     ecx, [esi]
.text:0040157C		       test    ecx, ecx
.text:0040157E		       jz      short loc_401582
.text:00401580		       call    ecx
.text:00401582
.text:00401582 loc_401582:			       ; CODE XREF: __initterm_e+11j
.text:00401582		       add     esi, 4
.text:00401585
.text:00401585 loc_401585:			       ; CODE XREF: __initterm_e+7j
.text:00401585		       cmp     esi, [esp+4+pfend]
.text:00401589		       jb      short loc_401576
.text:0040158B
.text:0040158B loc_40158B:			       ; CODE XREF: __initterm_e+Bj
.text:0040158B		       pop     esi
.text:0040158C		       retn
.text:0040158C __initterm_e    endp
.text:0040158C
.text:0040158D
.text:0040158D ; =============== S U B R O U T I N E =======================================
.text:0040158D
.text:0040158D
.text:0040158D ; int __cdecl _get_osplatform(unsigned int *pValue)
.text:0040158D __get_osplatform	proc near	       ; CODE XREF: ___crtInitCritSecAndSpinCount+27p
.text:0040158D					       ; ___heap_select+12p ...
.text:0040158D
.text:0040158D pValue	       = dword ptr  4
.text:0040158D
.text:0040158D		       mov     ecx, [esp+pValue]
.text:00401591		       push    esi
.text:00401592		       xor     esi, esi
.text:00401594		       cmp     ecx, esi
.text:00401596		       jnz     short loc_4015B5
.text:00401598
.text:00401598 loc_401598:			       ; CODE XREF: __get_osplatform+2Fj
.text:00401598		       call    __errno
.text:0040159D		       push    esi	       ; pReserved
.text:0040159E		       push    esi	       ; nLine
.text:0040159F		       push    esi	       ; pszFile
.text:004015A0		       push    esi	       ; pszFunction
.text:004015A1		       push    esi	       ; pszExpression
.text:004015A2		       mov     dword ptr [eax],	16h
.text:004015A8		       call    __invalid_parameter
.text:004015AD		       add     esp, 14h
.text:004015B0		       push    16h
.text:004015B2		       pop     eax
.text:004015B3		       pop     esi
.text:004015B4		       retn
.text:004015B5 ; ---------------------------------------------------------------------------
.text:004015B5
.text:004015B5 loc_4015B5:			       ; CODE XREF: __get_osplatform+9j
.text:004015B5		       mov     eax, __osplatform
.text:004015BA		       cmp     eax, esi
.text:004015BC		       jz      short loc_401598
.text:004015BE		       mov     [ecx], eax
.text:004015C0		       xor     eax, eax
.text:004015C2		       pop     esi
.text:004015C3		       retn
.text:004015C3 __get_osplatform	endp
.text:004015C3
.text:004015C4
.text:004015C4 ; =============== S U B R O U T I N E =======================================
.text:004015C4
.text:004015C4
.text:004015C4 ; int __cdecl _get_osver(unsigned int *pValue)
.text:004015C4 __get_osver     proc near
.text:004015C4
.text:004015C4 pValue	       = dword ptr  4
.text:004015C4
.text:004015C4		       mov     eax, [esp+pValue]
.text:004015C8		       push    esi
.text:004015C9		       xor     esi, esi
.text:004015CB		       cmp     eax, esi
.text:004015CD		       jnz     short loc_4015EC
.text:004015CF
.text:004015CF loc_4015CF:			       ; CODE XREF: __get_osver+2Ej
.text:004015CF		       call    __errno
.text:004015D4		       push    esi	       ; pReserved
.text:004015D5		       push    esi	       ; nLine
.text:004015D6		       push    esi	       ; pszFile
.text:004015D7		       push    esi	       ; pszFunction
.text:004015D8		       push    esi	       ; pszExpression
.text:004015D9		       mov     dword ptr [eax],	16h
.text:004015DF		       call    __invalid_parameter
.text:004015E4		       add     esp, 14h
.text:004015E7		       push    16h
.text:004015E9		       pop     eax
.text:004015EA		       pop     esi
.text:004015EB		       retn
.text:004015EC ; ---------------------------------------------------------------------------
.text:004015EC
.text:004015EC loc_4015EC:			       ; CODE XREF: __get_osver+9j
.text:004015EC		       cmp     __osplatform, esi
.text:004015F2		       jz      short loc_4015CF
.text:004015F4		       mov     ecx, __osver
.text:004015FA		       mov     [eax], ecx
.text:004015FC		       xor     eax, eax
.text:004015FE		       pop     esi
.text:004015FF		       retn
.text:004015FF __get_osver     endp
.text:004015FF
.text:00401600
.text:00401600 ; =============== S U B R O U T I N E =======================================
.text:00401600
.text:00401600
.text:00401600 ; int __cdecl _get_winver(unsigned int *pValue)
.text:00401600 __get_winver    proc near
.text:00401600
.text:00401600 pValue	       = dword ptr  4
.text:00401600
.text:00401600		       mov     eax, [esp+pValue]
.text:00401604		       push    esi
.text:00401605		       xor     esi, esi
.text:00401607		       cmp     eax, esi
.text:00401609		       jnz     short loc_401628
.text:0040160B
.text:0040160B loc_40160B:			       ; CODE XREF: __get_winver+2Ej
.text:0040160B		       call    __errno
.text:00401610		       push    esi	       ; pReserved
.text:00401611		       push    esi	       ; nLine
.text:00401612		       push    esi	       ; pszFile
.text:00401613		       push    esi	       ; pszFunction
.text:00401614		       push    esi	       ; pszExpression
.text:00401615		       mov     dword ptr [eax],	16h
.text:0040161B		       call    __invalid_parameter
.text:00401620		       add     esp, 14h
.text:00401623		       push    16h
.text:00401625		       pop     eax
.text:00401626		       pop     esi
.text:00401627		       retn
.text:00401628 ; ---------------------------------------------------------------------------
.text:00401628
.text:00401628 loc_401628:			       ; CODE XREF: __get_winver+9j
.text:00401628		       cmp     __osplatform, esi
.text:0040162E		       jz      short loc_40160B
.text:00401630		       mov     ecx, __winver
.text:00401636		       mov     [eax], ecx
.text:00401638		       xor     eax, eax
.text:0040163A		       pop     esi
.text:0040163B		       retn
.text:0040163B __get_winver    endp
.text:0040163B
.text:0040163C
.text:0040163C ; =============== S U B R O U T I N E =======================================
.text:0040163C
.text:0040163C
.text:0040163C ; int __cdecl _get_winmajor(unsigned int	*pValue)
.text:0040163C __get_winmajor  proc near	       ; CODE XREF: _use_encode_pointer+16p
.text:0040163C					       ; ___heap_select+2Dp ...
.text:0040163C
.text:0040163C pValue	       = dword ptr  4
.text:0040163C
.text:0040163C		       mov     eax, [esp+pValue]
.text:00401640		       push    esi
.text:00401641		       xor     esi, esi
.text:00401643		       cmp     eax, esi
.text:00401645		       jnz     short loc_401664
.text:00401647
.text:00401647 loc_401647:			       ; CODE XREF: __get_winmajor+2Ej
.text:00401647		       call    __errno
.text:0040164C		       push    esi	       ; pReserved
.text:0040164D		       push    esi	       ; nLine
.text:0040164E		       push    esi	       ; pszFile
.text:0040164F		       push    esi	       ; pszFunction
.text:00401650		       push    esi	       ; pszExpression
.text:00401651		       mov     dword ptr [eax],	16h
.text:00401657		       call    __invalid_parameter
.text:0040165C		       add     esp, 14h
.text:0040165F		       push    16h
.text:00401661		       pop     eax
.text:00401662		       pop     esi
.text:00401663		       retn
.text:00401664 ; ---------------------------------------------------------------------------
.text:00401664
.text:00401664 loc_401664:			       ; CODE XREF: __get_winmajor+9j
.text:00401664		       cmp     __osplatform, esi
.text:0040166A		       jz      short loc_401647
.text:0040166C		       mov     ecx, __winmajor
.text:00401672		       mov     [eax], ecx
.text:00401674		       xor     eax, eax
.text:00401676		       pop     esi
.text:00401677		       retn
.text:00401677 __get_winmajor  endp
.text:00401677
.text:00401678
.text:00401678 ; =============== S U B R O U T I N E =======================================
.text:00401678
.text:00401678
.text:00401678 ; int __cdecl _get_winminor(unsigned int	*pValue)
.text:00401678 __get_winminor  proc near
.text:00401678
.text:00401678 pValue	       = dword ptr  4
.text:00401678
.text:00401678		       mov     eax, [esp+pValue]
.text:0040167C		       push    esi
.text:0040167D		       xor     esi, esi
.text:0040167F		       cmp     eax, esi
.text:00401681		       jnz     short loc_4016A0
.text:00401683
.text:00401683 loc_401683:			       ; CODE XREF: __get_winminor+2Ej
.text:00401683		       call    __errno
.text:00401688		       push    esi	       ; pReserved
.text:00401689		       push    esi	       ; nLine
.text:0040168A		       push    esi	       ; pszFile
.text:0040168B		       push    esi	       ; pszFunction
.text:0040168C		       push    esi	       ; pszExpression
.text:0040168D		       mov     dword ptr [eax],	16h
.text:00401693		       call    __invalid_parameter
.text:00401698		       add     esp, 14h
.text:0040169B		       push    16h
.text:0040169D		       pop     eax
.text:0040169E		       pop     esi
.text:0040169F		       retn
.text:004016A0 ; ---------------------------------------------------------------------------
.text:004016A0
.text:004016A0 loc_4016A0:			       ; CODE XREF: __get_winminor+9j
.text:004016A0		       cmp     __osplatform, esi
.text:004016A6		       jz      short loc_401683
.text:004016A8		       mov     ecx, __winminor
.text:004016AE		       mov     [eax], ecx
.text:004016B0		       xor     eax, eax
.text:004016B2		       pop     esi
.text:004016B3		       retn
.text:004016B3 __get_winminor  endp
.text:004016B3
.text:004016B4
.text:004016B4 ; =============== S U B R O U T I N E =======================================
.text:004016B4
.text:004016B4
.text:004016B4 ; int __cdecl _get_wpgmptr(unsigned __int16 **pValue)
.text:004016B4 __get_wpgmptr   proc near
.text:004016B4
.text:004016B4 pValue	       = dword ptr  4
.text:004016B4
.text:004016B4		       mov     ecx, [esp+pValue]
.text:004016B8		       push    esi
.text:004016B9		       xor     esi, esi
.text:004016BB		       cmp     ecx, esi
.text:004016BD		       jnz     short loc_4016DC
.text:004016BF
.text:004016BF loc_4016BF:			       ; CODE XREF: __get_wpgmptr+2Fj
.text:004016BF		       call    __errno
.text:004016C4		       push    esi	       ; pReserved
.text:004016C5		       push    esi	       ; nLine
.text:004016C6		       push    esi	       ; pszFile
.text:004016C7		       push    esi	       ; pszFunction
.text:004016C8		       push    esi	       ; pszExpression
.text:004016C9		       mov     dword ptr [eax],	16h
.text:004016CF		       call    __invalid_parameter
.text:004016D4		       add     esp, 14h
.text:004016D7		       push    16h
.text:004016D9		       pop     eax
.text:004016DA		       pop     esi
.text:004016DB		       retn
.text:004016DC ; ---------------------------------------------------------------------------
.text:004016DC
.text:004016DC loc_4016DC:			       ; CODE XREF: __get_wpgmptr+9j
.text:004016DC		       mov     eax, __wpgmptr
.text:004016E1		       cmp     eax, esi
.text:004016E3		       jz      short loc_4016BF
.text:004016E5		       mov     [ecx], eax
.text:004016E7		       xor     eax, eax
.text:004016E9		       pop     esi
.text:004016EA		       retn
.text:004016EA __get_wpgmptr   endp
.text:004016EA
.text:004016EB
.text:004016EB ; =============== S U B R O U T I N E =======================================
.text:004016EB
.text:004016EB
.text:004016EB ; int __cdecl _get_pgmptr(char **pValue)
.text:004016EB __get_pgmptr    proc near
.text:004016EB
.text:004016EB pValue	       = dword ptr  4
.text:004016EB
.text:004016EB		       mov     ecx, [esp+pValue]
.text:004016EF		       push    esi
.text:004016F0		       xor     esi, esi
.text:004016F2		       cmp     ecx, esi
.text:004016F4		       jnz     short loc_401713
.text:004016F6
.text:004016F6 loc_4016F6:			       ; CODE XREF: __get_pgmptr+2Fj
.text:004016F6		       call    __errno
.text:004016FB		       push    esi	       ; pReserved
.text:004016FC		       push    esi	       ; nLine
.text:004016FD		       push    esi	       ; pszFile
.text:004016FE		       push    esi	       ; pszFunction
.text:004016FF		       push    esi	       ; pszExpression
.text:00401700		       mov     dword ptr [eax],	16h
.text:00401706		       call    __invalid_parameter
.text:0040170B		       add     esp, 14h
.text:0040170E		       push    16h
.text:00401710		       pop     eax
.text:00401711		       pop     esi
.text:00401712		       retn
.text:00401713 ; ---------------------------------------------------------------------------
.text:00401713
.text:00401713 loc_401713:			       ; CODE XREF: __get_pgmptr+9j
.text:00401713		       mov     eax, __pgmptr
.text:00401718		       cmp     eax, esi
.text:0040171A		       jz      short loc_4016F6
.text:0040171C		       mov     [ecx], eax
.text:0040171E		       xor     eax, eax
.text:00401720		       pop     esi
.text:00401721		       retn
.text:00401721 __get_pgmptr    endp
.text:00401721
.text:00401722
.text:00401722 ; =============== S U B R O U T I N E =======================================
.text:00401722
.text:00401722
.text:00401722 ; int __cdecl _cinit(int	initFloatingPrecision)
.text:00401722 __cinit	       proc near	       ; CODE XREF: __tmainCRTStartup+132p
.text:00401722
.text:00401722 initFloatingPrecision= dword ptr	 4
.text:00401722
.text:00401722		       cmp     __FPinit, 0
.text:00401729		       jz      short loc_401745
.text:0040172B		       push    offset __FPinit ; pTarget
.text:00401730		       call    __IsNonwritableInCurrentImage
.text:00401735		       test    eax, eax
.text:00401737		       pop     ecx
.text:00401738		       jz      short loc_401745
.text:0040173A		       push    [esp+initFloatingPrecision]
.text:0040173E		       call    __FPinit
.text:00401744		       pop     ecx
.text:00401745
.text:00401745 loc_401745:			       ; CODE XREF: __cinit+7j
.text:00401745					       ; __cinit+16j
.text:00401745		       call    __initp_misc_cfltcvt_tab
.text:0040174A		       push    offset ___xi_z  ; pfend
.text:0040174F		       push    offset ___xi_a  ; pfbegin
.text:00401754		       call    __initterm_e
.text:00401759		       test    eax, eax
.text:0040175B		       pop     ecx
.text:0040175C		       pop     ecx
.text:0040175D		       jnz     short locret_4017B3
.text:0040175F		       push    esi
.text:00401760		       push    edi
.text:00401761		       push    offset __RTC_Terminate ;	func
.text:00401766		       call    _atexit
.text:0040176B ; ---------------------------------------------------------------------------
.text:0040176B		       mov     esi, offset ___xc_a
.text:00401770		       mov     eax, esi
.text:00401772		       mov     edi, offset ___xc_z
.text:00401777		       cmp     eax, edi
.text:00401779		       pop     ecx
.text:0040177A		       jnb     short loc_40178B
.text:0040177C
.text:0040177C loc_40177C:			       ; CODE XREF: __cinit+67j
.text:0040177C		       mov     eax, [esi]
.text:0040177E		       test    eax, eax
.text:00401780		       jz      short loc_401784
.text:00401782		       call    eax
.text:00401784
.text:00401784 loc_401784:			       ; CODE XREF: __cinit+5Ej
.text:00401784		       add     esi, 4
.text:00401787		       cmp     esi, edi
.text:00401789		       jb      short loc_40177C
.text:0040178B
.text:0040178B loc_40178B:			       ; CODE XREF: __cinit+58j
.text:0040178B		       cmp     ___dyn_tls_init_callback, 0
.text:00401792		       pop     edi
.text:00401793		       pop     esi
.text:00401794		       jz      short loc_4017B1
.text:00401796		       push    offset ___dyn_tls_init_callback ; pTarget
.text:0040179B		       call    __IsNonwritableInCurrentImage
.text:004017A0		       test    eax, eax
.text:004017A2		       pop     ecx
.text:004017A3		       jz      short loc_4017B1
.text:004017A5		       push    0
.text:004017A7		       push    2
.text:004017A9		       push    0
.text:004017AB		       call    ___dyn_tls_init_callback
.text:004017B1
.text:004017B1 loc_4017B1:			       ; CODE XREF: __cinit+72j
.text:004017B1					       ; __cinit+81j
.text:004017B1		       xor     eax, eax
.text:004017B3
.text:004017B3 locret_4017B3:			       ; CODE XREF: __cinit+3Bj
.text:004017B3		       retn
.text:004017B3 __cinit	       endp
.text:004017B3
.text:004017B4
.text:004017B4 ; =============== S U B R O U T I N E =======================================
.text:004017B4
.text:004017B4 ; Attributes: noreturn bp-based frame
.text:004017B4
.text:004017B4 ; void __cdecl doexit(int code, int quick, int retcaller)
.text:004017B4 doexit	       proc near	       ; CODE XREF: _exit+8p
.text:004017B4					       ; __exit+8p ...
.text:004017B4
.text:004017B4 onexitend       = dword ptr -20h
.text:004017B4 onexitbegin     = dword ptr -1Ch
.text:004017B4 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004017B4 code	       = dword ptr  8
.text:004017B4 quick	       = dword ptr  0Ch
.text:004017B4 retcaller       = dword ptr  10h
.text:004017B4
.text:004017B4		       push    10h
.text:004017B6		       push    offset dword_420470
.text:004017BB		       call    __SEH_prolog4
.text:004017C0		       push    8	       ; locknum
.text:004017C2		       call    __lock
.text:004017C7		       pop     ecx
.text:004017C8		       xor     edi, edi
.text:004017CA		       mov     [ebp+ms_exc.disabled], edi
.text:004017CD		       xor     ebx, ebx
.text:004017CF		       inc     ebx
.text:004017D0		       cmp     __C_Exit_Done, ebx
.text:004017D6		       jz      short loc_401856
.text:004017D8		       mov     __C_Termination_Done, ebx
.text:004017DE		       mov     al, byte	ptr [ebp+retcaller]
.text:004017E1		       mov     __exitflag, al
.text:004017E6		       cmp     [ebp+quick], edi
.text:004017E9		       jnz     short loc_401846
.text:004017EB		       push    ___onexitbegin  ; codedptr
.text:004017F1		       call    __decode_pointer
.text:004017F6		       mov     [ebp+onexitbegin], eax
.text:004017F9		       push    ___onexitend    ; codedptr
.text:004017FF		       call    __decode_pointer
.text:00401804		       pop     ecx
.text:00401805		       pop     ecx
.text:00401806		       mov     esi, eax
.text:00401808		       mov     [ebp+onexitend],	esi
.text:0040180B		       cmp     [ebp+onexitbegin], edi
.text:0040180E		       jz      short loc_401836
.text:00401810
.text:00401810 loc_401810:			       ; CODE XREF: doexit+6Aj
.text:00401810					       ; doexit+75j ...
.text:00401810		       sub     esi, 4
.text:00401813		       mov     [ebp+onexitend],	esi
.text:00401816		       cmp     esi, [ebp+onexitbegin]
.text:00401819		       jb      short loc_401836
.text:0040181B		       cmp     dword ptr [esi],	0
.text:0040181E		       jz      short loc_401810
.text:00401820		       mov     edi, [esi]
.text:00401822		       call    __encoded_null
.text:00401827		       cmp     edi, eax
.text:00401829		       jz      short loc_401810
.text:0040182B		       push    edi	       ; codedptr
.text:0040182C		       call    __decode_pointer
.text:00401831		       pop     ecx
.text:00401832		       call    eax
.text:00401834		       jmp     short loc_401810
.text:00401836 ; ---------------------------------------------------------------------------
.text:00401836
.text:00401836 loc_401836:			       ; CODE XREF: doexit+5Aj
.text:00401836					       ; doexit+65j
.text:00401836		       push    offset ___xp_z  ; pfend
.text:0040183B		       mov     eax, offset ___xp_a ; pfbegin
.text:00401840		       call    _initterm
.text:00401845		       pop     ecx
.text:00401846
.text:00401846 loc_401846:			       ; CODE XREF: doexit+35j
.text:00401846		       push    offset ___xt_z  ; pfend
.text:0040184B		       mov     eax, offset ___xt_a ; pfbegin
.text:00401850		       call    _initterm
.text:00401855		       pop     ecx
.text:00401856
.text:00401856 loc_401856:			       ; CODE XREF: doexit+22j
.text:00401856		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040185D		       call    $LN15
.text:00401862 ; ---------------------------------------------------------------------------
.text:00401862
.text:00401862 $LN16:
.text:00401862		       cmp     [ebp+retcaller],	0
.text:00401866		       jnz     short loc_401890
.text:00401868		       mov     __C_Exit_Done, ebx
.text:0040186E		       push    8	       ; locknum
.text:00401870		       call    __unlock
.text:00401875		       pop     ecx
.text:00401876		       push    [ebp+code]      ; status
.text:00401879		       call    ___crtExitProcess
.text:0040187E ; ---------------------------------------------------------------------------
.text:0040187E
.text:0040187E $LN29:				       ; DATA XREF: .rdata:00420488o
.text:0040187E		       xor     ebx, ebx
.text:00401880		       inc     ebx
.text:00401881
.text:00401881 $LN15:				       ; CODE XREF: doexit+A9p
.text:00401881		       cmp     [ebp+retcaller],	0
.text:00401885		       jz      short $LN14
.text:00401887		       push    8	       ; locknum
.text:00401889		       call    __unlock
.text:0040188E		       pop     ecx
.text:0040188F
.text:0040188F $LN14:				       ; CODE XREF: doexit+D1j
.text:0040188F		       retn
.text:00401890 ; ---------------------------------------------------------------------------
.text:00401890
.text:00401890 loc_401890:			       ; CODE XREF: doexit+B2j
.text:00401890		       call    __SEH_epilog4
.text:00401895		       retn
.text:00401895 doexit	       endp ; sp-analysis failed
.text:00401895
.text:00401896
.text:00401896 ; =============== S U B R O U T I N E =======================================
.text:00401896
.text:00401896 ; Attributes: noreturn
.text:00401896
.text:00401896 ; void __cdecl exit(int code)
.text:00401896 _exit	       proc near	       ; CODE XREF: _CreateStack+34p
.text:00401896					       ; _MakeEmpty+26p ...
.text:00401896
.text:00401896 code	       = dword ptr  4
.text:00401896
.text:00401896		       push    0	       ; retcaller
.text:00401898		       push    0	       ; quick
.text:0040189A		       push    [esp+8+code]    ; code
.text:0040189E		       call    doexit
.text:004018A3 ; ---------------------------------------------------------------------------
.text:004018A3		       add     esp, 0Ch
.text:004018A6		       retn
.text:004018A6 _exit	       endp
.text:004018A6
.text:004018A7
.text:004018A7 ; =============== S U B R O U T I N E =======================================
.text:004018A7
.text:004018A7 ; Attributes: noreturn
.text:004018A7
.text:004018A7 ; void __cdecl _exit(int	code)
.text:004018A7 __exit	       proc near	       ; CODE XREF: __tmainCRTStartup+19Cp
.text:004018A7					       ; _raise+D9p ...
.text:004018A7
.text:004018A7 code	       = dword ptr  4
.text:004018A7
.text:004018A7		       push    0	       ; retcaller
.text:004018A9		       push    1	       ; quick
.text:004018AB		       push    [esp+8+code]    ; code
.text:004018AF		       call    doexit
.text:004018B4 ; ---------------------------------------------------------------------------
.text:004018B4		       add     esp, 0Ch
.text:004018B7		       retn
.text:004018B7 __exit	       endp
.text:004018B7
.text:004018B8
.text:004018B8 ; =============== S U B R O U T I N E =======================================
.text:004018B8
.text:004018B8 ; Attributes: noreturn
.text:004018B8
.text:004018B8 ; void __cdecl _cexit()
.text:004018B8 __cexit	       proc near	       ; CODE XREF: __tmainCRTStartup:$LN35p
.text:004018B8		       push    1	       ; retcaller
.text:004018BA		       push    0	       ; quick
.text:004018BC		       push    0	       ; code
.text:004018BE		       call    doexit
.text:004018C3 ; ---------------------------------------------------------------------------
.text:004018C3		       add     esp, 0Ch
.text:004018C6		       retn
.text:004018C6 __cexit	       endp
.text:004018C6
.text:004018C7
.text:004018C7 ; =============== S U B R O U T I N E =======================================
.text:004018C7
.text:004018C7 ; Attributes: noreturn
.text:004018C7
.text:004018C7 ; void __cdecl _c_exit()
.text:004018C7 __c_exit	       proc near	       ; CODE XREF: __tmainCRTStartup:$LN36p
.text:004018C7		       push    1	       ; retcaller
.text:004018C9		       push    1	       ; quick
.text:004018CB		       push    0	       ; code
.text:004018CD		       call    doexit
.text:004018D2 ; ---------------------------------------------------------------------------
.text:004018D2		       add     esp, 0Ch
.text:004018D5		       retn
.text:004018D5 __c_exit	       endp
.text:004018D5
.text:004018D6
.text:004018D6 ; =============== S U B R O U T I N E =======================================
.text:004018D6
.text:004018D6
.text:004018D6 __init_pointers proc near	       ; CODE XREF: __mtinit+C4p
.text:004018D6		       push    esi
.text:004018D7		       call    __encoded_null
.text:004018DC		       mov     esi, eax
.text:004018DE		       push    esi	       ; enull
.text:004018DF		       call    __initp_heap_handler
.text:004018E4		       push    esi	       ; enull
.text:004018E5		       call    __initp_misc_initcrit
.text:004018EA		       push    esi	       ; enull
.text:004018EB		       call    __initp_misc_invarg
.text:004018F0		       push    esi	       ; enull
.text:004018F1		       call    __initp_misc_purevirt
.text:004018F6		       push    esi	       ; enull
.text:004018F7		       call    __initp_misc_rand_s
.text:004018FC		       push    esi	       ; enull
.text:004018FD		       call    __initp_misc_winsig
.text:00401902		       push    esi	       ; enull
.text:00401903		       call    __initp_misc_winxfltr
.text:00401908		       push    esi	       ; enull
.text:00401909		       call    __initp_eh_hooks
.text:0040190E		       push    offset __exit   ; ptr
.text:00401913		       call    __encode_pointer
.text:00401918		       add     esp, 24h
.text:0040191B		       mov     __aexit_rtn, eax
.text:00401920		       pop     esi
.text:00401921		       retn
.text:00401921 __init_pointers endp
.text:00401921
.text:00401922
.text:00401922 ; =============== S U B R O U T I N E =======================================
.text:00401922
.text:00401922 ; Attributes: bp-based frame
.text:00401922
.text:00401922 ; int __cdecl fprintf(_iobuf *str, const	char *format)
.text:00401922 _fprintf	       proc near	       ; CODE XREF: _CreateStack+2Ap
.text:00401922					       ; _MakeEmpty+1Cp ...
.text:00401922
.text:00401922 retval	       = dword ptr -1Ch
.text:00401922 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00401922 stream	       = dword ptr  8
.text:00401922 format	       = dword ptr  0Ch
.text:00401922 argptr	       = byte ptr  10h
.text:00401922
.text:00401922		       push    0Ch
.text:00401924		       push    offset dword_420490
.text:00401929		       call    __SEH_prolog4
.text:0040192E		       xor     ebx, ebx
.text:00401930		       mov     [ebp+retval], ebx
.text:00401933		       xor     eax, eax
.text:00401935		       mov     esi, [ebp+stream]
.text:00401938		       cmp     esi, ebx
.text:0040193A		       setnz   al
.text:0040193D		       cmp     eax, ebx
.text:0040193F		       jnz     short loc_401961
.text:00401941
.text:00401941 loc_401941:			       ; CODE XREF: _fprintf+49j
.text:00401941		       call    __errno
.text:00401946		       mov     dword ptr [eax],	16h
.text:0040194C		       push    ebx	       ; pReserved
.text:0040194D		       push    ebx	       ; nLine
.text:0040194E		       push    ebx	       ; pszFile
.text:0040194F		       push    ebx	       ; pszFunction
.text:00401950		       push    ebx	       ; pszExpression
.text:00401951		       call    __invalid_parameter
.text:00401956		       add     esp, 14h
.text:00401959		       or      eax, 0FFFFFFFFh
.text:0040195C		       jmp     loc_401A61
.text:00401961 ; ---------------------------------------------------------------------------
.text:00401961
.text:00401961 loc_401961:			       ; CODE XREF: _fprintf+1Dj
.text:00401961		       xor     eax, eax
.text:00401963		       cmp     [ebp+format], ebx
.text:00401966		       setnz   al
.text:00401969		       cmp     eax, ebx
.text:0040196B		       jz      short loc_401941
.text:0040196D		       mov     [ebp+stream], esi
.text:00401970		       push    esi	       ; pf
.text:00401971		       call    __lock_file
.text:00401976		       pop     ecx
.text:00401977		       mov     [ebp+ms_exc.disabled], ebx
.text:0040197A		       test    byte ptr	[esi+0Ch], 40h
.text:0040197E		       jnz     loc_401A2A
.text:00401984		       push    esi	       ; stream
.text:00401985		       call    __fileno
.text:0040198A		       pop     ecx
.text:0040198B		       cmp     eax, 0FFFFFFFFh
.text:0040198E		       jz      short loc_4019BE
.text:00401990		       push    esi	       ; stream
.text:00401991		       call    __fileno
.text:00401996		       pop     ecx
.text:00401997		       cmp     eax, 0FFFFFFFEh
.text:0040199A		       jz      short loc_4019BE
.text:0040199C		       push    esi	       ; stream
.text:0040199D		       call    __fileno
.text:004019A2		       sar     eax, 5
.text:004019A5		       lea     edi, ds:422F40h[eax*4]
.text:004019AC		       push    esi	       ; stream
.text:004019AD		       call    __fileno
.text:004019B2		       pop     ecx
.text:004019B3		       pop     ecx
.text:004019B4		       and     eax, 1Fh
.text:004019B7		       shl     eax, 6
.text:004019BA		       add     eax, [edi]
.text:004019BC		       jmp     short loc_4019C3
.text:004019BE ; ---------------------------------------------------------------------------
.text:004019BE
.text:004019BE loc_4019BE:			       ; CODE XREF: _fprintf+6Cj
.text:004019BE					       ; _fprintf+78j
.text:004019BE		       mov     eax, offset ___badioinfo
.text:004019C3
.text:004019C3 loc_4019C3:			       ; CODE XREF: _fprintf+9Aj
.text:004019C3		       test    byte ptr	[eax+24h], 7Fh
.text:004019C7		       jnz     short loc_401A0E
.text:004019C9		       push    esi	       ; stream
.text:004019CA		       call    __fileno
.text:004019CF		       pop     ecx
.text:004019D0		       cmp     eax, 0FFFFFFFFh
.text:004019D3		       jz      short loc_401A03
.text:004019D5		       push    esi	       ; stream
.text:004019D6		       call    __fileno
.text:004019DB		       pop     ecx
.text:004019DC		       cmp     eax, 0FFFFFFFEh
.text:004019DF		       jz      short loc_401A03
.text:004019E1		       push    esi	       ; stream
.text:004019E2		       call    __fileno
.text:004019E7		       sar     eax, 5
.text:004019EA		       lea     edi, ds:422F40h[eax*4]
.text:004019F1		       push    esi	       ; stream
.text:004019F2		       call    __fileno
.text:004019F7		       pop     ecx
.text:004019F8		       pop     ecx
.text:004019F9		       and     eax, 1Fh
.text:004019FC		       shl     eax, 6
.text:004019FF		       add     eax, [edi]
.text:00401A01		       jmp     short loc_401A08
.text:00401A03 ; ---------------------------------------------------------------------------
.text:00401A03
.text:00401A03 loc_401A03:			       ; CODE XREF: _fprintf+B1j
.text:00401A03					       ; _fprintf+BDj
.text:00401A03		       mov     eax, offset ___badioinfo
.text:00401A08
.text:00401A08 loc_401A08:			       ; CODE XREF: _fprintf+DFj
.text:00401A08		       test    byte ptr	[eax+24h], 80h
.text:00401A0C		       jz      short loc_401A2A
.text:00401A0E
.text:00401A0E loc_401A0E:			       ; CODE XREF: _fprintf+A5j
.text:00401A0E		       call    __errno
.text:00401A13		       mov     dword ptr [eax],	16h
.text:00401A19		       push    ebx	       ; pReserved
.text:00401A1A		       push    ebx	       ; nLine
.text:00401A1B		       push    ebx	       ; pszFile
.text:00401A1C		       push    ebx	       ; pszFunction
.text:00401A1D		       push    ebx	       ; pszExpression
.text:00401A1E		       call    __invalid_parameter
.text:00401A23		       add     esp, 14h
.text:00401A26		       or      [ebp+retval], 0FFFFFFFFh
.text:00401A2A
.text:00401A2A loc_401A2A:			       ; CODE XREF: _fprintf+5Cj
.text:00401A2A					       ; _fprintf+EAj
.text:00401A2A		       cmp     [ebp+retval], ebx
.text:00401A2D		       jnz     short loc_401A52
.text:00401A2F		       push    esi	       ; str
.text:00401A30		       call    __stbuf
.text:00401A35		       mov     edi, eax
.text:00401A37		       lea     eax, [ebp+argptr]
.text:00401A3A		       push    eax	       ; argptr
.text:00401A3B		       push    ebx	       ; plocinfo
.text:00401A3C		       push    [ebp+format]    ; format
.text:00401A3F		       push    esi	       ; stream
.text:00401A40		       call    __output_l
.text:00401A45		       mov     [ebp+retval], eax
.text:00401A48		       push    esi	       ; str
.text:00401A49		       push    edi	       ; flag
.text:00401A4A		       call    __ftbuf
.text:00401A4F		       add     esp, 1Ch
.text:00401A52
.text:00401A52 loc_401A52:			       ; CODE XREF: _fprintf+10Bj
.text:00401A52		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00401A59		       call    $LN16_0
.text:00401A5E
.text:00401A5E $LN19:
.text:00401A5E		       mov     eax, [ebp+retval]
.text:00401A61
.text:00401A61 loc_401A61:			       ; CODE XREF: _fprintf+3Aj
.text:00401A61		       call    __SEH_epilog4
.text:00401A66		       retn
.text:00401A67 ; ---------------------------------------------------------------------------
.text:00401A67
.text:00401A67 $LN16_0:				       ; CODE XREF: _fprintf+137p
.text:00401A67					       ; DATA XREF: .rdata:004204A8o
.text:00401A67		       push    [ebp+stream]    ; pf
.text:00401A6A		       call    __unlock_file
.text:00401A6F		       pop     ecx
.text:00401A70
.text:00401A70 $LN17:
.text:00401A70		       retn
.text:00401A70 _fprintf	       endp
.text:00401A70
.text:00401A71
.text:00401A71 ; =============== S U B R O U T I N E =======================================
.text:00401A71
.text:00401A71
.text:00401A71 ; int __cdecl _fprintf_l(_iobuf *str, const char	*format, localeinfo_struct *plocinfo)
.text:00401A71 __fprintf_l     proc near
.text:00401A71
.text:00401A71 str	       = dword ptr  4
.text:00401A71 format	       = dword ptr  8
.text:00401A71 plocinfo	       = dword ptr  0Ch
.text:00401A71 ap	       = byte ptr  10h
.text:00401A71
.text:00401A71		       lea     eax, [esp+ap]
.text:00401A75		       push    eax	       ; ap
.text:00401A76		       push    [esp+4+plocinfo]	; plocinfo
.text:00401A7A		       push    [esp+8+format]  ; format
.text:00401A7E		       push    [esp+0Ch+str]   ; str
.text:00401A82		       call    __vfprintf_l
.text:00401A87		       add     esp, 10h
.text:00401A8A		       retn
.text:00401A8A __fprintf_l     endp
.text:00401A8A
.text:00401A8B
.text:00401A8B ; =============== S U B R O U T I N E =======================================
.text:00401A8B
.text:00401A8B
.text:00401A8B ; int __cdecl _fprintf_s_l(_iobuf *str, const char *format, localeinfo_struct *plocinfo)
.text:00401A8B __fprintf_s_l   proc near
.text:00401A8B
.text:00401A8B str	       = dword ptr  4
.text:00401A8B format	       = dword ptr  8
.text:00401A8B plocinfo	       = dword ptr  0Ch
.text:00401A8B ap	       = byte ptr  10h
.text:00401A8B
.text:00401A8B		       lea     eax, [esp+ap]
.text:00401A8F		       push    eax	       ; ap
.text:00401A90		       push    [esp+4+plocinfo]	; plocinfo
.text:00401A94		       push    [esp+8+format]  ; format
.text:00401A98		       push    [esp+0Ch+str]   ; str
.text:00401A9C		       call    __vfprintf_s_l
.text:00401AA1		       add     esp, 10h
.text:00401AA4		       retn
.text:00401AA4 __fprintf_s_l   endp
.text:00401AA4
.text:00401AA5
.text:00401AA5 ; =============== S U B R O U T I N E =======================================
.text:00401AA5
.text:00401AA5
.text:00401AA5 ; int __cdecl fprintf_s(_iobuf *str, const char *format)
.text:00401AA5 _fprintf_s      proc near
.text:00401AA5
.text:00401AA5 str	       = dword ptr  4
.text:00401AA5 format	       = dword ptr  8
.text:00401AA5 ap	       = byte ptr  0Ch
.text:00401AA5
.text:00401AA5		       lea     eax, [esp+ap]
.text:00401AA9		       push    eax	       ; ap
.text:00401AAA		       push    0	       ; plocinfo
.text:00401AAC		       push    [esp+8+format]  ; format
.text:00401AB0		       push    [esp+0Ch+str]   ; str
.text:00401AB4		       call    __vfprintf_s_l
.text:00401AB9		       add     esp, 10h
.text:00401ABC		       retn
.text:00401ABC _fprintf_s      endp
.text:00401ABC
.text:00401ABD
.text:00401ABD ; =============== S U B R O U T I N E =======================================
.text:00401ABD
.text:00401ABD
.text:00401ABD ; int __cdecl _fprintf_p_l(_iobuf *str, const char *format, localeinfo_struct *plocinfo)
.text:00401ABD __fprintf_p_l   proc near
.text:00401ABD
.text:00401ABD str	       = dword ptr  4
.text:00401ABD format	       = dword ptr  8
.text:00401ABD plocinfo	       = dword ptr  0Ch
.text:00401ABD ap	       = byte ptr  10h
.text:00401ABD
.text:00401ABD		       lea     eax, [esp+ap]
.text:00401AC1		       push    eax	       ; ap
.text:00401AC2		       push    [esp+4+plocinfo]	; plocinfo
.text:00401AC6		       push    [esp+8+format]  ; format
.text:00401ACA		       push    [esp+0Ch+str]   ; str
.text:00401ACE		       call    __vfprintf_p_l
.text:00401AD3		       add     esp, 10h
.text:00401AD6		       retn
.text:00401AD6 __fprintf_p_l   endp
.text:00401AD6
.text:00401AD7
.text:00401AD7 ; =============== S U B R O U T I N E =======================================
.text:00401AD7
.text:00401AD7
.text:00401AD7 ; int __cdecl _fprintf_p(_iobuf *str, const char	*format)
.text:00401AD7 __fprintf_p     proc near
.text:00401AD7
.text:00401AD7 str	       = dword ptr  4
.text:00401AD7 format	       = dword ptr  8
.text:00401AD7 ap	       = byte ptr  0Ch
.text:00401AD7
.text:00401AD7		       lea     eax, [esp+ap]
.text:00401ADB		       push    eax	       ; ap
.text:00401ADC		       push    0	       ; plocinfo
.text:00401ADE		       push    [esp+8+format]  ; format
.text:00401AE2		       push    [esp+0Ch+str]   ; str
.text:00401AE6		       call    __vfprintf_p_l
.text:00401AEB		       add     esp, 10h
.text:00401AEE		       retn
.text:00401AEE __fprintf_p     endp
.text:00401AEE
.text:00401AEF
.text:00401AEF ; =============== S U B R O U T I N E =======================================
.text:00401AEF
.text:00401AEF
.text:00401AEF ; _iobuf	*__cdecl __iob_func()
.text:00401AEF ___iob_func     proc near	       ; CODE XREF: _CreateStack+21p
.text:00401AEF					       ; _MakeEmpty+13p ...
.text:00401AEF		       mov     eax, offset __iob
.text:00401AF4		       retn
.text:00401AF4 ___iob_func     endp
.text:00401AF4
.text:00401AF5
.text:00401AF5 ; =============== S U B R O U T I N E =======================================
.text:00401AF5
.text:00401AF5
.text:00401AF5 ; int __cdecl __initstdio()
.text:00401AF5 ___initstdio    proc near	       ; DATA XREF: .rdata:pinito
.text:00401AF5		       mov     eax, __nstream
.text:00401AFA		       test    eax, eax
.text:00401AFC		       push    esi
.text:00401AFD		       push    14h
.text:00401AFF		       pop     esi
.text:00401B00		       jnz     short loc_401B09
.text:00401B02		       mov     eax, 200h
.text:00401B07		       jmp     short loc_401B0F
.text:00401B09 ; ---------------------------------------------------------------------------
.text:00401B09
.text:00401B09 loc_401B09:			       ; CODE XREF: ___initstdio+Bj
.text:00401B09		       cmp     eax, esi
.text:00401B0B		       jge     short loc_401B14
.text:00401B0D		       mov     eax, esi
.text:00401B0F
.text:00401B0F loc_401B0F:			       ; CODE XREF: ___initstdio+12j
.text:00401B0F		       mov     __nstream, eax
.text:00401B14
.text:00401B14 loc_401B14:			       ; CODE XREF: ___initstdio+16j
.text:00401B14		       push    4	       ; size
.text:00401B16		       push    eax	       ; count
.text:00401B17		       call    __calloc_crt
.text:00401B1C		       test    eax, eax
.text:00401B1E		       pop     ecx
.text:00401B1F		       pop     ecx
.text:00401B20		       mov     ___piob,	eax
.text:00401B25		       jnz     short loc_401B45
.text:00401B27		       push    4	       ; size
.text:00401B29		       push    esi	       ; count
.text:00401B2A		       mov     __nstream, esi
.text:00401B30		       call    __calloc_crt
.text:00401B35		       test    eax, eax
.text:00401B37		       pop     ecx
.text:00401B38		       pop     ecx
.text:00401B39		       mov     ___piob,	eax
.text:00401B3E		       jnz     short loc_401B45
.text:00401B40		       push    1Ah
.text:00401B42		       pop     eax
.text:00401B43		       pop     esi
.text:00401B44		       retn
.text:00401B45 ; ---------------------------------------------------------------------------
.text:00401B45
.text:00401B45 loc_401B45:			       ; CODE XREF: ___initstdio+30j
.text:00401B45					       ; ___initstdio+49j
.text:00401B45		       xor     edx, edx
.text:00401B47		       mov     ecx, offset __iob
.text:00401B4C		       jmp     short loc_401B53
.text:00401B4E ; ---------------------------------------------------------------------------
.text:00401B4E
.text:00401B4E loc_401B4E:			       ; CODE XREF: ___initstdio+6Dj
.text:00401B4E		       mov     eax, ___piob
.text:00401B53
.text:00401B53 loc_401B53:			       ; CODE XREF: ___initstdio+57j
.text:00401B53		       mov     [edx+eax], ecx
.text:00401B56		       add     ecx, 20h
.text:00401B59		       add     edx, 4
.text:00401B5C		       cmp     ecx, offset ___app_type
.text:00401B62		       jl      short loc_401B4E
.text:00401B64		       push    0FFFFFFFEh
.text:00401B66		       pop     esi
.text:00401B67		       xor     edx, edx
.text:00401B69		       mov     ecx, offset dword_421098
.text:00401B6E		       push    edi
.text:00401B6F
.text:00401B6F loc_401B6F:			       ; CODE XREF: ___initstdio+AAj
.text:00401B6F		       mov     eax, edx
.text:00401B71		       sar     eax, 5
.text:00401B74		       mov     eax, ___pioinfo[eax*4]
.text:00401B7B		       mov     edi, edx
.text:00401B7D		       and     edi, 1Fh
.text:00401B80		       shl     edi, 6
.text:00401B83		       mov     eax, [edi+eax]
.text:00401B86		       cmp     eax, 0FFFFFFFFh
.text:00401B89		       jz      short loc_401B93
.text:00401B8B		       cmp     eax, esi
.text:00401B8D		       jz      short loc_401B93
.text:00401B8F		       test    eax, eax
.text:00401B91		       jnz     short loc_401B95
.text:00401B93
.text:00401B93 loc_401B93:			       ; CODE XREF: ___initstdio+94j
.text:00401B93					       ; ___initstdio+98j
.text:00401B93		       mov     [ecx], esi
.text:00401B95
.text:00401B95 loc_401B95:			       ; CODE XREF: ___initstdio+9Cj
.text:00401B95		       add     ecx, 20h
.text:00401B98		       inc     edx
.text:00401B99		       cmp     ecx, offset dword_4210F8
.text:00401B9F		       jl      short loc_401B6F
.text:00401BA1		       pop     edi
.text:00401BA2		       xor     eax, eax
.text:00401BA4		       pop     esi
.text:00401BA5		       retn
.text:00401BA5 ___initstdio    endp
.text:00401BA5
.text:00401BA6
.text:00401BA6 ; =============== S U B R O U T I N E =======================================
.text:00401BA6
.text:00401BA6
.text:00401BA6 ___endstdio     proc near	       ; DATA XREF: .rdata:pterm_0o
.text:00401BA6		       call    __flushall
.text:00401BAB		       cmp     __exitflag, 0
.text:00401BB2		       jz      short loc_401BB9
.text:00401BB4		       call    __fcloseall
.text:00401BB9
.text:00401BB9 loc_401BB9:			       ; CODE XREF: ___endstdio+Cj
.text:00401BB9		       push    ___piob	       ; pBlock
.text:00401BBF		       call    _free
.text:00401BC4		       pop     ecx
.text:00401BC5		       retn
.text:00401BC5 ___endstdio     endp
.text:00401BC5
.text:00401BC6
.text:00401BC6 ; =============== S U B R O U T I N E =======================================
.text:00401BC6
.text:00401BC6
.text:00401BC6 ; void __cdecl _lock_file(_iobuf	*pf)
.text:00401BC6 __lock_file     proc near	       ; CODE XREF: _fprintf+4Fp
.text:00401BC6					       ; _vprintf_helper+45p ...
.text:00401BC6
.text:00401BC6 arg_0	       = dword ptr  4
.text:00401BC6
.text:00401BC6		       push    esi
.text:00401BC7		       mov     esi, [esp+4+arg_0]
.text:00401BCB		       mov     eax, offset __iob
.text:00401BD0		       cmp     esi, eax
.text:00401BD2		       jb      short loc_401BF6
.text:00401BD4		       cmp     esi, offset dword_4212E8
.text:00401BDA		       ja      short loc_401BF6
.text:00401BDC		       mov     ecx, esi
.text:00401BDE		       sub     ecx, eax
.text:00401BE0		       sar     ecx, 5
.text:00401BE3		       add     ecx, 10h
.text:00401BE6		       push    ecx	       ; locknum
.text:00401BE7		       call    __lock
.text:00401BEC		       or      dword ptr [esi+0Ch], 8000h
.text:00401BF3		       pop     ecx
.text:00401BF4		       pop     esi
.text:00401BF5		       retn
.text:00401BF6 ; ---------------------------------------------------------------------------
.text:00401BF6
.text:00401BF6 loc_401BF6:			       ; CODE XREF: __lock_file+Cj
.text:00401BF6					       ; __lock_file+14j
.text:00401BF6		       add     esi, 20h
.text:00401BF9		       push    esi	       ; lpCriticalSection
.text:00401BFA		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:00401C00		       pop     esi
.text:00401C01		       retn
.text:00401C01 __lock_file     endp
.text:00401C01
.text:00401C02
.text:00401C02 ; =============== S U B R O U T I N E =======================================
.text:00401C02
.text:00401C02
.text:00401C02 ; void __cdecl _lock_file2(int i, void *s)
.text:00401C02 __lock_file2    proc near	       ; CODE XREF: _printf+44p
.text:00401C02					       ; flsall+46p
.text:00401C02
.text:00401C02 i	       = dword ptr  4
.text:00401C02 s	       = dword ptr  8
.text:00401C02
.text:00401C02		       mov     eax, [esp+i]
.text:00401C06		       cmp     eax, 14h
.text:00401C09		       jge     short loc_401C21
.text:00401C0B		       add     eax, 10h
.text:00401C0E		       push    eax	       ; locknum
.text:00401C0F		       call    __lock
.text:00401C14		       mov     eax, [esp+4+s]
.text:00401C18		       or      dword ptr [eax+0Ch], 8000h
.text:00401C1F		       pop     ecx
.text:00401C20		       retn
.text:00401C21 ; ---------------------------------------------------------------------------
.text:00401C21
.text:00401C21 loc_401C21:			       ; CODE XREF: __lock_file2+7j
.text:00401C21		       mov     eax, [esp+s]
.text:00401C25		       add     eax, 20h
.text:00401C28		       push    eax	       ; lpCriticalSection
.text:00401C29		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:00401C2F		       retn
.text:00401C2F __lock_file2    endp
.text:00401C2F
.text:00401C30
.text:00401C30 ; =============== S U B R O U T I N E =======================================
.text:00401C30
.text:00401C30
.text:00401C30 ; void __cdecl _unlock_file(_iobuf *pf)
.text:00401C30 __unlock_file   proc near	       ; CODE XREF: _fprintf+148p
.text:00401C30					       ; _vprintf_helper+89p ...
.text:00401C30
.text:00401C30 arg_0	       = dword ptr  4
.text:00401C30
.text:00401C30		       mov     eax, [esp+arg_0]
.text:00401C34		       mov     ecx, offset __iob
.text:00401C39		       cmp     eax, ecx
.text:00401C3B		       jb      short loc_401C5B
.text:00401C3D		       cmp     eax, offset dword_4212E8
.text:00401C42		       ja      short loc_401C5B
.text:00401C44		       and     dword ptr [eax+0Ch], 0FFFF7FFFh
.text:00401C4B		       sub     eax, ecx
.text:00401C4D		       sar     eax, 5
.text:00401C50		       add     eax, 10h
.text:00401C53		       push    eax	       ; locknum
.text:00401C54		       call    __unlock
.text:00401C59		       pop     ecx
.text:00401C5A		       retn
.text:00401C5B ; ---------------------------------------------------------------------------
.text:00401C5B
.text:00401C5B loc_401C5B:			       ; CODE XREF: __unlock_file+Bj
.text:00401C5B					       ; __unlock_file+12j
.text:00401C5B		       add     eax, 20h
.text:00401C5E		       push    eax	       ; lpCriticalSection
.text:00401C5F		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:00401C65		       retn
.text:00401C65 __unlock_file   endp
.text:00401C65
.text:00401C66
.text:00401C66 ; =============== S U B R O U T I N E =======================================
.text:00401C66
.text:00401C66
.text:00401C66 ; void __cdecl _unlock_file2(int	i, void	*s)
.text:00401C66 __unlock_file2  proc near	       ; CODE XREF: _printf+A7p
.text:00401C66					       ; flsall+ABp
.text:00401C66
.text:00401C66 i	       = dword ptr  4
.text:00401C66 s	       = dword ptr  8
.text:00401C66
.text:00401C66		       mov     ecx, [esp+i]
.text:00401C6A		       cmp     ecx, 14h
.text:00401C6D		       mov     eax, [esp+s]
.text:00401C71		       jge     short loc_401C85
.text:00401C73		       and     dword ptr [eax+0Ch], 0FFFF7FFFh
.text:00401C7A		       add     ecx, 10h
.text:00401C7D		       push    ecx	       ; locknum
.text:00401C7E		       call    __unlock
.text:00401C83		       pop     ecx
.text:00401C84		       retn
.text:00401C85 ; ---------------------------------------------------------------------------
.text:00401C85
.text:00401C85 loc_401C85:			       ; CODE XREF: __unlock_file2+Bj
.text:00401C85		       add     eax, 20h
.text:00401C88		       push    eax	       ; lpCriticalSection
.text:00401C89		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:00401C8F		       retn
.text:00401C8F __unlock_file2  endp
.text:00401C8F
.text:00401C90
.text:00401C90 ; =============== S U B R O U T I N E =======================================
.text:00401C90
.text:00401C90 ; Attributes: bp-based frame
.text:00401C90
.text:00401C90 ; void *__cdecl V6_HeapAlloc(unsigned int size)
.text:00401C90 _V6_HeapAlloc   proc near	       ; CODE XREF: __heap_alloc+4Fp
.text:00401C90					       ; _malloc+59p
.text:00401C90
.text:00401C90 pvReturn	       = dword ptr -1Ch
.text:00401C90 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00401C90 size	       = dword ptr  8
.text:00401C90
.text:00401C90		       push    0Ch
.text:00401C92		       push    offset dword_4204B0
.text:00401C97		       call    __SEH_prolog4
.text:00401C9C		       and     [ebp+pvReturn], 0
.text:00401CA0		       mov     esi, [ebp+size]
.text:00401CA3		       cmp     esi, ___sbh_threshold
.text:00401CA9		       ja      short $LN9_0
.text:00401CAB		       push    4	       ; locknum
.text:00401CAD		       call    __lock
.text:00401CB2		       pop     ecx
.text:00401CB3		       and     [ebp+ms_exc.disabled], 0
.text:00401CB7		       push    esi	       ; intSize
.text:00401CB8		       call    ___sbh_alloc_block
.text:00401CBD		       pop     ecx
.text:00401CBE		       mov     [ebp+pvReturn], eax
.text:00401CC1		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00401CC8		       call    $LN6_0
.text:00401CCD
.text:00401CCD $LN9_0:				       ; CODE XREF: _V6_HeapAlloc+19j
.text:00401CCD		       mov     eax, [ebp+pvReturn]
.text:00401CD0		       call    __SEH_epilog4
.text:00401CD5		       retn
.text:00401CD6 ; ---------------------------------------------------------------------------
.text:00401CD6
.text:00401CD6 $LN6_0:				       ; CODE XREF: _V6_HeapAlloc+38p
.text:00401CD6					       ; DATA XREF: .rdata:004204C8o
.text:00401CD6		       push    4	       ; locknum
.text:00401CD8		       call    __unlock
.text:00401CDD		       pop     ecx
.text:00401CDE
.text:00401CDE $LN7_0:
.text:00401CDE		       retn
.text:00401CDE _V6_HeapAlloc   endp
.text:00401CDE
.text:00401CDF
.text:00401CDF ; =============== S U B R O U T I N E =======================================
.text:00401CDF
.text:00401CDF
.text:00401CDF ; void *__cdecl _heap_alloc(unsigned int	size)
.text:00401CDF __heap_alloc    proc near
.text:00401CDF
.text:00401CDF size	       = dword ptr  4
.text:00401CDF
.text:00401CDF		       cmp     __crtheap, 0
.text:00401CE6		       jnz     short loc_401D00
.text:00401CE8		       call    __FF_MSGBANNER
.text:00401CED		       push    1Eh	       ; rterrnum
.text:00401CEF		       call    __NMSG_WRITE
.text:00401CF4		       push    0FFh	       ; status
.text:00401CF9		       call    ___crtExitProcess
.text:00401CFE ; ---------------------------------------------------------------------------
.text:00401CFE		       pop     ecx
.text:00401CFF		       pop     ecx
.text:00401D00
.text:00401D00 loc_401D00:			       ; CODE XREF: __heap_alloc+7j
.text:00401D00		       mov     eax, ___active_heap
.text:00401D05		       cmp     eax, 1
.text:00401D08		       jnz     short loc_401D23
.text:00401D0A		       mov     eax, [esp+size]
.text:00401D0E		       test    eax, eax
.text:00401D10		       jnz     short loc_401D13
.text:00401D12		       inc     eax
.text:00401D13
.text:00401D13 loc_401D13:			       ; CODE XREF: __heap_alloc+31j
.text:00401D13		       push    eax	       ; dwBytes
.text:00401D14		       push    0	       ; dwFlags
.text:00401D16		       push    __crtheap       ; hHeap
.text:00401D1C		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:00401D22		       retn
.text:00401D23 ; ---------------------------------------------------------------------------
.text:00401D23
.text:00401D23 loc_401D23:			       ; CODE XREF: __heap_alloc+29j
.text:00401D23		       cmp     eax, 3
.text:00401D26		       push    esi
.text:00401D27		       mov     esi, [esp+4+size]
.text:00401D2B		       jnz     short loc_401D38
.text:00401D2D		       push    esi	       ; size
.text:00401D2E		       call    _V6_HeapAlloc
.text:00401D33		       test    eax, eax
.text:00401D35		       pop     ecx
.text:00401D36		       jnz     short loc_401D52
.text:00401D38
.text:00401D38 loc_401D38:			       ; CODE XREF: __heap_alloc+4Cj
.text:00401D38		       test    esi, esi
.text:00401D3A		       jnz     short loc_401D3D
.text:00401D3C		       inc     esi
.text:00401D3D
.text:00401D3D loc_401D3D:			       ; CODE XREF: __heap_alloc+5Bj
.text:00401D3D		       add     esi, 0Fh
.text:00401D40		       and     esi, 0FFFFFFF0h
.text:00401D43		       push    esi	       ; dwBytes
.text:00401D44		       push    0	       ; dwFlags
.text:00401D46		       push    __crtheap       ; hHeap
.text:00401D4C		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:00401D52
.text:00401D52 loc_401D52:			       ; CODE XREF: __heap_alloc+57j
.text:00401D52		       pop     esi
.text:00401D53		       retn
.text:00401D53 __heap_alloc    endp
.text:00401D53
.text:00401D54
.text:00401D54 ; =============== S U B R O U T I N E =======================================
.text:00401D54
.text:00401D54
.text:00401D54 ; void *__cdecl malloc(unsigned int size)
.text:00401D54 _malloc	       proc near	       ; CODE XREF: _CreateStack+6p
.text:00401D54					       ; _Push+6p ...
.text:00401D54
.text:00401D54 size	       = dword ptr  4
.text:00401D54
.text:00401D54		       push    ebp
.text:00401D55		       mov     ebp, [esp+4+size]
.text:00401D59		       cmp     ebp, 0FFFFFFE0h
.text:00401D5C		       ja      loc_401E01
.text:00401D62		       push    ebx
.text:00401D63		       mov     ebx, ds:__imp__HeapAlloc@12 ; HeapAlloc(x,x,x)
.text:00401D69		       push    esi
.text:00401D6A		       push    edi
.text:00401D6B
.text:00401D6B loc_401D6B:			       ; CODE XREF: _malloc+94j
.text:00401D6B		       xor     esi, esi
.text:00401D6D		       cmp     __crtheap, esi
.text:00401D73		       mov     edi, ebp
.text:00401D75		       jnz     short loc_401D8F
.text:00401D77		       call    __FF_MSGBANNER
.text:00401D7C		       push    1Eh	       ; rterrnum
.text:00401D7E		       call    __NMSG_WRITE
.text:00401D83		       push    0FFh	       ; status
.text:00401D88		       call    ___crtExitProcess
.text:00401D8D ; ---------------------------------------------------------------------------
.text:00401D8D		       pop     ecx
.text:00401D8E		       pop     ecx
.text:00401D8F
.text:00401D8F loc_401D8F:			       ; CODE XREF: _malloc+21j
.text:00401D8F		       mov     eax, ___active_heap
.text:00401D94		       cmp     eax, 1
.text:00401D97		       jnz     short loc_401DA7
.text:00401D99		       cmp     ebp, esi
.text:00401D9B		       jz      short loc_401DA1
.text:00401D9D		       mov     eax, ebp
.text:00401D9F		       jmp     short loc_401DA4
.text:00401DA1 ; ---------------------------------------------------------------------------
.text:00401DA1
.text:00401DA1 loc_401DA1:			       ; CODE XREF: _malloc+47j
.text:00401DA1		       xor     eax, eax
.text:00401DA3		       inc     eax
.text:00401DA4
.text:00401DA4 loc_401DA4:			       ; CODE XREF: _malloc+4Bj
.text:00401DA4		       push    eax
.text:00401DA5		       jmp     short loc_401DC5
.text:00401DA7 ; ---------------------------------------------------------------------------
.text:00401DA7
.text:00401DA7 loc_401DA7:			       ; CODE XREF: _malloc+43j
.text:00401DA7		       cmp     eax, 3
.text:00401DAA		       jnz     short loc_401DB7
.text:00401DAC		       push    ebp	       ; size
.text:00401DAD		       call    _V6_HeapAlloc
.text:00401DB2		       cmp     eax, esi
.text:00401DB4		       pop     ecx
.text:00401DB5		       jnz     short loc_401DCE
.text:00401DB7
.text:00401DB7 loc_401DB7:			       ; CODE XREF: _malloc+56j
.text:00401DB7		       cmp     ebp, esi
.text:00401DB9		       jnz     short loc_401DBE
.text:00401DBB		       xor     edi, edi
.text:00401DBD		       inc     edi
.text:00401DBE
.text:00401DBE loc_401DBE:			       ; CODE XREF: _malloc+65j
.text:00401DBE		       add     edi, 0Fh
.text:00401DC1		       and     edi, 0FFFFFFF0h
.text:00401DC4		       push    edi	       ; dwBytes
.text:00401DC5
.text:00401DC5 loc_401DC5:			       ; CODE XREF: _malloc+51j
.text:00401DC5		       push    esi	       ; dwFlags
.text:00401DC6		       push    __crtheap       ; hHeap
.text:00401DCC		       call    ebx ; HeapAlloc(x,x,x) ;	HeapAlloc(x,x,x)
.text:00401DCE
.text:00401DCE loc_401DCE:			       ; CODE XREF: _malloc+61j
.text:00401DCE		       mov     esi, eax
.text:00401DD0		       test    esi, esi
.text:00401DD2		       jnz     short loc_401DFA
.text:00401DD4		       cmp     __newmode, eax
.text:00401DDA		       push    0Ch
.text:00401DDC		       pop     edi
.text:00401DDD		       jz      short loc_401DEC
.text:00401DDF		       push    ebp	       ; size
.text:00401DE0		       call    __callnewh
.text:00401DE5		       test    eax, eax
.text:00401DE7		       pop     ecx
.text:00401DE8		       jnz     short loc_401D6B
.text:00401DEA		       jmp     short loc_401DF3
.text:00401DEC ; ---------------------------------------------------------------------------
.text:00401DEC
.text:00401DEC loc_401DEC:			       ; CODE XREF: _malloc+89j
.text:00401DEC		       call    __errno
.text:00401DF1		       mov     [eax], edi
.text:00401DF3
.text:00401DF3 loc_401DF3:			       ; CODE XREF: _malloc+96j
.text:00401DF3		       call    __errno
.text:00401DF8		       mov     [eax], edi
.text:00401DFA
.text:00401DFA loc_401DFA:			       ; CODE XREF: _malloc+7Ej
.text:00401DFA		       pop     edi
.text:00401DFB		       mov     eax, esi
.text:00401DFD		       pop     esi
.text:00401DFE		       pop     ebx
.text:00401DFF		       pop     ebp
.text:00401E00		       retn
.text:00401E01 ; ---------------------------------------------------------------------------
.text:00401E01
.text:00401E01 loc_401E01:			       ; CODE XREF: _malloc+8j
.text:00401E01		       push    ebp	       ; size
.text:00401E02		       call    __callnewh
.text:00401E07		       pop     ecx
.text:00401E08		       call    __errno
.text:00401E0D		       mov     dword ptr [eax],	0Ch
.text:00401E13		       xor     eax, eax
.text:00401E15		       pop     ebp
.text:00401E16		       retn
.text:00401E16 _malloc	       endp
.text:00401E16
.text:00401E17
.text:00401E17 ; =============== S U B R O U T I N E =======================================
.text:00401E17
.text:00401E17 ; Attributes: bp-based frame
.text:00401E17
.text:00401E17 ; void __cdecl free(void	*pBlock)
.text:00401E17 _free	       proc near	       ; CODE XREF: _DisposeStack+13p
.text:00401E17					       ; _Pop+54p ...
.text:00401E17
.text:00401E17 pHeader	       = dword ptr -1Ch
.text:00401E17 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00401E17 pBlock	       = dword ptr  8
.text:00401E17
.text:00401E17		       push    0Ch
.text:00401E19		       push    offset dword_4204D0
.text:00401E1E		       call    __SEH_prolog4
.text:00401E23		       mov     esi, [ebp+pBlock]
.text:00401E26		       test    esi, esi
.text:00401E28		       jz      short loc_401E9F
.text:00401E2A		       cmp     ___active_heap, 3
.text:00401E31		       jnz     short loc_401E76
.text:00401E33		       push    4	       ; locknum
.text:00401E35		       call    __lock
.text:00401E3A		       pop     ecx
.text:00401E3B		       and     [ebp+ms_exc.disabled], 0
.text:00401E3F		       push    esi	       ; pvAlloc
.text:00401E40		       call    ___sbh_find_block
.text:00401E45		       pop     ecx
.text:00401E46		       mov     [ebp+pHeader], eax
.text:00401E49		       test    eax, eax
.text:00401E4B		       jz      short loc_401E56
.text:00401E4D		       push    esi	       ; pvAlloc
.text:00401E4E		       push    eax	       ; pHeader
.text:00401E4F		       call    ___sbh_free_block
.text:00401E54		       pop     ecx
.text:00401E55		       pop     ecx
.text:00401E56
.text:00401E56 loc_401E56:			       ; CODE XREF: _free+34j
.text:00401E56		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00401E5D		       call    $LN12
.text:00401E62
.text:00401E62 $LN15_0:
.text:00401E62		       cmp     [ebp+pHeader], 0
.text:00401E66		       jnz     short loc_401E9F
.text:00401E68		       push    [ebp+pBlock]
.text:00401E6B		       jmp     short loc_401E77
.text:00401E6D ; ---------------------------------------------------------------------------
.text:00401E6D
.text:00401E6D $LN12:				       ; CODE XREF: _free+46p
.text:00401E6D					       ; DATA XREF: .rdata:004204E8o
.text:00401E6D		       push    4	       ; locknum
.text:00401E6F		       call    __unlock
.text:00401E74		       pop     ecx
.text:00401E75
.text:00401E75 $LN13:
.text:00401E75		       retn
.text:00401E76 ; ---------------------------------------------------------------------------
.text:00401E76
.text:00401E76 loc_401E76:			       ; CODE XREF: _free+1Aj
.text:00401E76		       push    esi	       ; lpMem
.text:00401E77
.text:00401E77 loc_401E77:			       ; CODE XREF: _free+54j
.text:00401E77		       push    0	       ; dwFlags
.text:00401E79		       push    __crtheap       ; hHeap
.text:00401E7F		       call    ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00401E85		       test    eax, eax
.text:00401E87		       jnz     short loc_401E9F
.text:00401E89		       call    __errno
.text:00401E8E		       mov     esi, eax
.text:00401E90		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00401E96		       push    eax	       ; oserrno
.text:00401E97		       call    __get_errno_from_oserr
.text:00401E9C		       mov     [esi], eax
.text:00401E9E		       pop     ecx
.text:00401E9F
.text:00401E9F loc_401E9F:			       ; CODE XREF: _free+11j
.text:00401E9F					       ; _free+4Fj ...
.text:00401E9F		       call    __SEH_epilog4
.text:00401EA4		       retn
.text:00401EA4 _free	       endp
.text:00401EA4
.text:00401EA5
.text:00401EA5 ; =============== S U B R O U T I N E =======================================
.text:00401EA5
.text:00401EA5
.text:00401EA5 ; void __cdecl _set_osplatform(unsigned int _Value)
.text:00401EA5 __set_osplatform	proc near
.text:00401EA5
.text:00401EA5 _Value	       = dword ptr  4
.text:00401EA5
.text:00401EA5		       mov     eax, [esp+_Value]
.text:00401EA9		       mov     __osplatform, eax
.text:00401EAE		       retn
.text:00401EAE __set_osplatform	endp
.text:00401EAE
.text:00401EAF
.text:00401EAF ; =============== S U B R O U T I N E =======================================
.text:00401EAF
.text:00401EAF
.text:00401EAF ; void __cdecl _set_osver(unsigned int _Value)
.text:00401EAF __set_osver     proc near
.text:00401EAF
.text:00401EAF _Value	       = dword ptr  4
.text:00401EAF
.text:00401EAF		       mov     eax, [esp+_Value]
.text:00401EB3		       mov     __osver,	eax
.text:00401EB8		       retn
.text:00401EB8 __set_osver     endp
.text:00401EB8
.text:00401EB9
.text:00401EB9 ; =============== S U B R O U T I N E =======================================
.text:00401EB9
.text:00401EB9
.text:00401EB9 ; void __cdecl _set_winver(unsigned int _Value)
.text:00401EB9 __set_winver    proc near
.text:00401EB9
.text:00401EB9 _Value	       = dword ptr  4
.text:00401EB9
.text:00401EB9		       mov     eax, [esp+_Value]
.text:00401EBD		       mov     __winver, eax
.text:00401EC2		       retn
.text:00401EC2 __set_winver    endp
.text:00401EC2
.text:00401EC3
.text:00401EC3 ; =============== S U B R O U T I N E =======================================
.text:00401EC3
.text:00401EC3
.text:00401EC3 ; void __cdecl _set_winmajor(unsigned int _Value)
.text:00401EC3 __set_winmajor  proc near
.text:00401EC3
.text:00401EC3 _Value	       = dword ptr  4
.text:00401EC3
.text:00401EC3		       mov     eax, [esp+_Value]
.text:00401EC7		       mov     __winmajor, eax
.text:00401ECC		       retn
.text:00401ECC __set_winmajor  endp
.text:00401ECC
.text:00401ECD
.text:00401ECD ; =============== S U B R O U T I N E =======================================
.text:00401ECD
.text:00401ECD
.text:00401ECD ; void __cdecl _set_winminor(unsigned int _Value)
.text:00401ECD __set_winminor  proc near
.text:00401ECD
.text:00401ECD _Value	       = dword ptr  4
.text:00401ECD
.text:00401ECD		       mov     eax, [esp+_Value]
.text:00401ED1		       mov     __winminor, eax
.text:00401ED6		       retn
.text:00401ED6 __set_winminor  endp
.text:00401ED6
.text:00401ED7
.text:00401ED7 ; =============== S U B R O U T I N E =======================================
.text:00401ED7
.text:00401ED7 ; Attributes: noreturn
.text:00401ED7
.text:00401ED7 ; void __cdecl fast_error_exit(int rterrnum)
.text:00401ED7 fast_error_exit proc near	       ; CODE XREF: __tmainCRTStartup+2Bp
.text:00401ED7					       ; __tmainCRTStartup+C8p	...
.text:00401ED7
.text:00401ED7 rterrnum	       = dword ptr  4
.text:00401ED7
.text:00401ED7		       cmp     ___error_mode, 2
.text:00401EDE		       jz      short loc_401EE5
.text:00401EE0		       call    __FF_MSGBANNER
.text:00401EE5
.text:00401EE5 loc_401EE5:			       ; CODE XREF: fast_error_exit+7j
.text:00401EE5		       push    [esp+rterrnum]  ; rterrnum
.text:00401EE9		       call    __NMSG_WRITE
.text:00401EEE		       push    0FFh	       ; status
.text:00401EF3		       call    ___crtExitProcess
.text:00401EF8 ; ---------------------------------------------------------------------------
.text:00401EF8		       pop     ecx
.text:00401EF9		       pop     ecx
.text:00401EFA		       retn
.text:00401EFA fast_error_exit endp
.text:00401EFA
.text:00401EFB
.text:00401EFB ; =============== S U B R O U T I N E =======================================
.text:00401EFB
.text:00401EFB
.text:00401EFB ; int __cdecl check_managed_app()
.text:00401EFB check_managed_app proc near	       ; CODE XREF: __tmainCRTStartup+B2p
.text:00401EFB		       cmp     word ptr	ds:400000h, 5A4Dh
.text:00401F04		       jnz     short loc_401F39
.text:00401F06		       mov     eax, ds:40003Ch
.text:00401F0B		       cmp     dword ptr [eax+400000h],	4550h
.text:00401F15		       jnz     short loc_401F39
.text:00401F17		       cmp     word ptr	[eax+400018h], 10Bh
.text:00401F20		       jnz     short loc_401F39
.text:00401F22		       cmp     dword ptr [eax+400074h],	0Eh
.text:00401F29		       jbe     short loc_401F39
.text:00401F2B		       xor     ecx, ecx
.text:00401F2D		       cmp     [eax+4000E8h], ecx
.text:00401F33		       setnz   cl
.text:00401F36		       mov     eax, ecx
.text:00401F38		       retn
.text:00401F39 ; ---------------------------------------------------------------------------
.text:00401F39
.text:00401F39 loc_401F39:			       ; CODE XREF: check_managed_app+9j
.text:00401F39					       ; check_managed_app+1Aj	...
.text:00401F39		       xor     eax, eax
.text:00401F3B		       retn
.text:00401F3B check_managed_app endp
.text:00401F3B
.text:00401F3C ; [000001B6 BYTES: COLLAPSED FUNCTION __tmainCRTStartup.	PRESS KEYPAD "+" TO EXPAND]
.text:004020F2 ; [0000000A BYTES: COLLAPSED FUNCTION _mainCRTStartup. PRESS KEYPAD "+" TO EXPAND]
.text:004020FC
.text:004020FC ; =============== S U B R O U T I N E =======================================
.text:004020FC
.text:004020FC
.text:004020FC ; int __cdecl _stbuf(_iobuf *str)
.text:004020FC __stbuf	       proc near	       ; CODE XREF: _printf+56p
.text:004020FC					       ; _fprintf+10Ep	...
.text:004020FC
.text:004020FC str	       = dword ptr  4
.text:004020FC
.text:004020FC		       push    esi
.text:004020FD		       mov     esi, [esp+4+str]
.text:00402101		       push    esi	       ; stream
.text:00402102		       call    __fileno
.text:00402107		       push    eax	       ; fh
.text:00402108		       call    __isatty
.text:0040210D		       test    eax, eax
.text:0040210F		       pop     ecx
.text:00402110		       pop     ecx
.text:00402111		       jz      short loc_40218E
.text:00402113		       call    ___iob_func
.text:00402118		       add     eax, 20h
.text:0040211B		       cmp     esi, eax
.text:0040211D		       jnz     short loc_402123
.text:0040211F		       xor     eax, eax
.text:00402121		       jmp     short loc_402132
.text:00402123 ; ---------------------------------------------------------------------------
.text:00402123
.text:00402123 loc_402123:			       ; CODE XREF: __stbuf+21j
.text:00402123		       call    ___iob_func
.text:00402128		       add     eax, 40h
.text:0040212B		       cmp     esi, eax
.text:0040212D		       jnz     short loc_40218E
.text:0040212F		       xor     eax, eax
.text:00402131		       inc     eax
.text:00402132
.text:00402132 loc_402132:			       ; CODE XREF: __stbuf+25j
.text:00402132		       inc     __cflush
.text:00402138		       test    word ptr	[esi+0Ch], 10Ch
.text:0040213E		       jnz     short loc_40218E
.text:00402140		       push    ebx
.text:00402141		       push    edi
.text:00402142		       lea     edi, ds:42245Ch[eax*4]
.text:00402149		       cmp     dword ptr [edi],	0
.text:0040214C		       mov     ebx, 1000h
.text:00402151		       jnz     short loc_402173
.text:00402153		       push    ebx	       ; cb
.text:00402154		       call    __malloc_crt
.text:00402159		       test    eax, eax
.text:0040215B		       pop     ecx
.text:0040215C		       mov     [edi], eax
.text:0040215E		       jnz     short loc_402173
.text:00402160		       lea     eax, [esi+14h]
.text:00402163		       push    2
.text:00402165		       mov     [esi+8],	eax
.text:00402168		       mov     [esi], eax
.text:0040216A		       pop     eax
.text:0040216B		       mov     [esi+18h], eax
.text:0040216E		       mov     [esi+4],	eax
.text:00402171		       jmp     short loc_402180
.text:00402173 ; ---------------------------------------------------------------------------
.text:00402173
.text:00402173 loc_402173:			       ; CODE XREF: __stbuf+55j
.text:00402173					       ; __stbuf+62j
.text:00402173		       mov     edi, [edi]
.text:00402175		       mov     [esi+8],	edi
.text:00402178		       mov     [esi], edi
.text:0040217A		       mov     [esi+18h], ebx
.text:0040217D		       mov     [esi+4],	ebx
.text:00402180
.text:00402180 loc_402180:			       ; CODE XREF: __stbuf+75j
.text:00402180		       or      dword ptr [esi+0Ch], 1102h
.text:00402187		       pop     edi
.text:00402188		       xor     eax, eax
.text:0040218A		       pop     ebx
.text:0040218B		       inc     eax
.text:0040218C		       pop     esi
.text:0040218D		       retn
.text:0040218E ; ---------------------------------------------------------------------------
.text:0040218E
.text:0040218E loc_40218E:			       ; CODE XREF: __stbuf+15j
.text:0040218E					       ; __stbuf+31j ...
.text:0040218E		       xor     eax, eax
.text:00402190		       pop     esi
.text:00402191		       retn
.text:00402191 __stbuf	       endp
.text:00402191
.text:00402192
.text:00402192 ; =============== S U B R O U T I N E =======================================
.text:00402192
.text:00402192
.text:00402192 ; void __cdecl _ftbuf(int flag, _iobuf *str)
.text:00402192 __ftbuf	       proc near	       ; CODE XREF: _printf+7Fp
.text:00402192					       ; _fprintf+128p	...
.text:00402192
.text:00402192 flag	       = dword ptr  4
.text:00402192 str	       = dword ptr  8
.text:00402192
.text:00402192		       cmp     [esp+flag], 0
.text:00402197		       jz      short locret_4021C0
.text:00402199		       push    esi
.text:0040219A		       mov     esi, [esp+4+str]
.text:0040219E		       test    word ptr	[esi+0Ch], 1000h
.text:004021A4		       jz      short loc_4021BF
.text:004021A6		       push    esi	       ; str
.text:004021A7		       call    __flush
.text:004021AC		       and     dword ptr [esi+0Ch], 0FFFFEEFFh
.text:004021B3		       and     dword ptr [esi+18h], 0
.text:004021B7		       and     dword ptr [esi],	0
.text:004021BA		       and     dword ptr [esi+8], 0
.text:004021BE		       pop     ecx
.text:004021BF
.text:004021BF loc_4021BF:			       ; CODE XREF: __ftbuf+12j
.text:004021BF		       pop     esi
.text:004021C0
.text:004021C0 locret_4021C0:			       ; CODE XREF: __ftbuf+5j
.text:004021C0		       retn
.text:004021C0 __ftbuf	       endp
.text:004021C0
.text:004021C1
.text:004021C1 ; =============== S U B R O U T I N E =======================================
.text:004021C1
.text:004021C1
.text:004021C1 ; void __thiscall _LocaleUpdate___LocaleUpdate(_LocaleUpdate *this, localeinfo_struct *plocinfo)
.text:004021C1 ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z proc near
.text:004021C1					       ; CODE XREF: __output_l+56p
.text:004021C1					       ; getSystemCP+Dp ...
.text:004021C1
.text:004021C1 plocinfo	       = dword ptr  4
.text:004021C1
.text:004021C1 this = ecx
.text:004021C1		       mov     eax, [esp+plocinfo]
.text:004021C5		       test    eax, eax
.text:004021C7		       push    esi
.text:004021C8		       mov     esi, this
.text:004021CA		       mov     byte ptr	[esi+0Ch], 0
.text:004021CE		       jnz     short loc_402233
.text:004021D0		       call    __getptd
.text:004021D5		       mov     [esi+8],	eax
.text:004021D8		       mov     this, [eax+6Ch]
.text:004021DB		       mov     [esi], this
.text:004021DD		       mov     this, [eax+68h]
.text:004021E0		       mov     [esi+4],	this
.text:004021E3		       mov     this, [esi]
.text:004021E5		       cmp     this, ___ptlocinfo ; ___ptlocinfo
.text:004021EB		       jz      short loc_4021FF
.text:004021ED		       mov     this, ___globallocalestatus
.text:004021F3		       test    [eax+70h], this
.text:004021F6		       jnz     short loc_4021FF
.text:004021F8		       call    ___updatetlocinfo
.text:004021FD		       mov     [esi], eax
.text:004021FF
.text:004021FF loc_4021FF:			       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+2Aj
.text:004021FF					       ; _LocaleUpdate::_LocaleUpdate(localeinfo_struct	*)+35j
.text:004021FF		       mov     eax, [esi+4]
.text:00402202		       cmp     eax, ___ptmbcinfo ; ___ptmbcinfo
.text:00402208		       jz      short loc_402220
.text:0040220A		       mov     eax, [esi+8]
.text:0040220D		       mov     this, ___globallocalestatus
.text:00402213		       test    [eax+70h], this
.text:00402216		       jnz     short loc_402220
.text:00402218		       call    ___updatetmbcinfo
.text:0040221D		       mov     [esi+4],	eax
.text:00402220
.text:00402220 loc_402220:			       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+47j
.text:00402220					       ; _LocaleUpdate::_LocaleUpdate(localeinfo_struct	*)+55j
.text:00402220		       mov     eax, [esi+8]
.text:00402223		       test    byte ptr	[eax+70h], 2
.text:00402227		       jnz     short loc_40223D
.text:00402229		       or      dword ptr [eax+70h], 2
.text:0040222D		       mov     byte ptr	[esi+0Ch], 1
.text:00402231		       jmp     short loc_40223D
.text:00402233 ; ---------------------------------------------------------------------------
.text:00402233
.text:00402233 loc_402233:			       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+Dj
.text:00402233		       mov     this, [eax]
.text:00402235		       mov     [esi], this
.text:00402237		       mov     eax, [eax+4]
.text:0040223A		       mov     [esi+4],	eax
.text:0040223D
.text:0040223D loc_40223D:			       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+66j
.text:0040223D					       ; _LocaleUpdate::_LocaleUpdate(localeinfo_struct	*)+70j
.text:0040223D		       mov     eax, esi
.text:0040223F		       pop     esi
.text:00402240		       retn    4
.text:00402240 ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z endp
.text:00402240
.text:00402243
.text:00402243 ; =============== S U B R O U T I N E =======================================
.text:00402243
.text:00402243
.text:00402243 ; void __thiscall _LocaleUpdate____LocaleUpdate(_LocaleUpdate *this)
.text:00402243 ??1_LocaleUpdate@@QAE@XZ	proc near
.text:00402243 this = ecx
.text:00402243		       cmp     byte ptr	[this+0Ch], 0
.text:00402247		       jz      short locret_402250
.text:00402249		       mov     eax, [this+8]
.text:0040224C		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00402250
.text:00402250 locret_402250:			       ; CODE XREF: _LocaleUpdate::~_LocaleUpdate(void)+4j
.text:00402250		       retn
.text:00402250 ??1_LocaleUpdate@@QAE@XZ	endp
.text:00402250
.text:00402251
.text:00402251 ; =============== S U B R O U T I N E =======================================
.text:00402251
.text:00402251
.text:00402251 ; localeinfo_struct *__thiscall _LocaleUpdate__GetLocaleT(_LocaleUpdate *this)
.text:00402251 ?GetLocaleT@_LocaleUpdate@@QAEPAUlocaleinfo_struct@@XZ proc near
.text:00402251 this = ecx
.text:00402251		       mov     eax, this
.text:00402253		       retn
.text:00402253 ?GetLocaleT@_LocaleUpdate@@QAEPAUlocaleinfo_struct@@XZ endp
.text:00402253
.text:00402254
.text:00402254 ; =============== S U B R O U T I N E =======================================
.text:00402254
.text:00402254
.text:00402254 ; void __usercall write_char(char ch<al>, _iobuf	*f<ecx>, int *pnumwritten<esi>)
.text:00402254 write_char      proc near	       ; CODE XREF: write_multi_char+11p
.text:00402254					       ; write_string+22p ...
.text:00402254 f = ecx
.text:00402254 pnumwritten = esi
.text:00402254		       test    byte ptr	[f+0Ch], 40h
.text:00402258		       jz      short loc_402260
.text:0040225A		       cmp     dword ptr [f+8],	0
.text:0040225E		       jz      short loc_402284
.text:00402260
.text:00402260 loc_402260:			       ; CODE XREF: write_char+4j
.text:00402260		       dec     dword ptr [f+4]
.text:00402263		       js      short loc_402270
.text:00402265		       mov     edx, [f]
.text:00402267		       mov     [edx], al
.text:00402269		       inc     dword ptr [f]
.text:0040226B		       movzx   eax, al
.text:0040226E		       jmp     short loc_40227C
.text:00402270 ; ---------------------------------------------------------------------------
.text:00402270
.text:00402270 loc_402270:			       ; CODE XREF: write_char+Fj
.text:00402270		       movsx   eax, al
.text:00402273		       push    f	       ; str
.text:00402274		       push    eax	       ; ch
.text:00402275		       call    __flsbuf
.text:0040227A		       pop     f
.text:0040227B		       pop     f
.text:0040227C
.text:0040227C loc_40227C:			       ; CODE XREF: write_char+1Aj
.text:0040227C		       cmp     eax, 0FFFFFFFFh
.text:0040227F		       jnz     short loc_402284
.text:00402281		       or      [pnumwritten], eax
.text:00402283		       retn
.text:00402284 ; ---------------------------------------------------------------------------
.text:00402284
.text:00402284 loc_402284:			       ; CODE XREF: write_char+Aj
.text:00402284					       ; write_char+2Bj
.text:00402284		       inc     dword ptr [pnumwritten]
.text:00402286		       retn
.text:00402286 write_char      endp
.text:00402286
.text:00402287
.text:00402287 ; =============== S U B R O U T I N E =======================================
.text:00402287
.text:00402287 ; Attributes: bp-based frame
.text:00402287
.text:00402287 ; void __usercall write_multi_char(char ch, int num, _iobuf *f, int *pnumwritten<eax>)
.text:00402287 write_multi_char	proc near	       ; CODE XREF: __output_l+852p
.text:00402287					       ; __output_l+87Fp ...
.text:00402287
.text:00402287 arg_0	       = byte ptr  8
.text:00402287 num	       = dword ptr  0Ch
.text:00402287 f	       = dword ptr  10h
.text:00402287
.text:00402287 pnumwritten = eax
.text:00402287		       push    ebp
.text:00402288		       mov     ebp, esp
.text:0040228A		       push    esi
.text:0040228B		       mov     esi, pnumwritten	; pnumwritten
.text:0040228D		       jmp     short loc_4022A2
.text:0040228F ; ---------------------------------------------------------------------------
.text:0040228F
.text:0040228F loc_40228F:			       ; CODE XREF: write_multi_char+1Fj
.text:0040228F		       mov     ecx, [ebp+f]    ; f
.text:00402292		       mov     al, [ebp+arg_0] ; ch
.text:00402295		       dec     [ebp+num]
.text:00402298		       call    write_char
.text:0040229D		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:004022A0		       jz      short loc_4022A8
.text:004022A2
.text:004022A2 loc_4022A2:			       ; CODE XREF: write_multi_char+6j
.text:004022A2		       cmp     [ebp+num], 0
.text:004022A6		       jg      short loc_40228F
.text:004022A8
.text:004022A8 loc_4022A8:			       ; CODE XREF: write_multi_char+19j
.text:004022A8		       pop     esi
.text:004022A9		       pop     ebp
.text:004022AA		       retn
.text:004022AA write_multi_char	endp
.text:004022AA
.text:004022AB
.text:004022AB ; =============== S U B R O U T I N E =======================================
.text:004022AB
.text:004022AB
.text:004022AB ; void __usercall write_string(char *string<ecx>, int len, _iobuf *f<edi>, int *pnumwritten<eax>)
.text:004022AB write_string    proc near	       ; CODE XREF: __output_l+866p
.text:004022AB					       ; __output_l+8CDp ...
.text:004022AB
.text:004022AB len	       = dword ptr  4
.text:004022AB
.text:004022AB string =	ecx
.text:004022AB f = edi
.text:004022AB pnumwritten = eax
.text:004022AB		       test    byte ptr	[f+0Ch], 40h
.text:004022AF		       push    ebx
.text:004022B0		       push    esi
.text:004022B1		       mov     esi, pnumwritten	; pnumwritten
.text:004022B3		       mov     ebx, string
.text:004022B5		       jz      short loc_4022EB
.text:004022B7		       cmp     dword ptr [f+8],	0
.text:004022BB		       jnz     short loc_4022EB
.text:004022BD		       mov     pnumwritten, [esp+8+len]
.text:004022C1		       add     [esi], pnumwritten
.text:004022C3		       jmp     short loc_4022F2
.text:004022C5 ; ---------------------------------------------------------------------------
.text:004022C5
.text:004022C5 loc_4022C5:			       ; CODE XREF: write_string+45j
.text:004022C5		       mov     al, [ebx]       ; ch
.text:004022C7		       dec     [esp+8+len]
.text:004022CB		       mov     string, f       ; f
.text:004022CD		       call    write_char
.text:004022D2		       inc     ebx
.text:004022D3		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:004022D6		       jnz     short loc_4022EB
.text:004022D8		       call    __errno
.text:004022DD		       cmp     dword ptr [pnumwritten],	2Ah
.text:004022E0		       jnz     short loc_4022F2
.text:004022E2		       mov     string, f       ; f
.text:004022E4		       mov     al, 3Fh	       ; ch
.text:004022E6		       call    write_char
.text:004022EB
.text:004022EB loc_4022EB:			       ; CODE XREF: write_string+Aj
.text:004022EB					       ; write_string+10j ...
.text:004022EB		       cmp     [esp+8+len], 0
.text:004022F0		       jg      short loc_4022C5
.text:004022F2
.text:004022F2 loc_4022F2:			       ; CODE XREF: write_string+18j
.text:004022F2					       ; write_string+35j
.text:004022F2		       pop     esi
.text:004022F3		       pop     ebx
.text:004022F4		       retn
.text:004022F4 write_string    endp
.text:004022F4
.text:004022F5
.text:004022F5 ; =============== S U B R O U T I N E =======================================
.text:004022F5
.text:004022F5
.text:004022F5 ; int __cdecl get_int_arg(char **pargptr)
.text:004022F5 _get_int_arg    proc near
.text:004022F5
.text:004022F5 pargptr	       = dword ptr  4
.text:004022F5
.text:004022F5		       mov     eax, [esp+pargptr]
.text:004022F9		       add     dword ptr [eax],	4
.text:004022FC		       mov     eax, [eax]
.text:004022FE		       mov     eax, [eax-4]
.text:00402301		       retn
.text:00402301 _get_int_arg    endp
.text:00402301
.text:00402302
.text:00402302 ; =============== S U B R O U T I N E =======================================
.text:00402302
.text:00402302
.text:00402302 ; __int64 __cdecl get_int64_arg(char **pargptr)
.text:00402302 _get_int64_arg  proc near
.text:00402302
.text:00402302 pargptr	       = dword ptr  4
.text:00402302
.text:00402302		       mov     eax, [esp+pargptr]
.text:00402306		       add     dword ptr [eax],	8
.text:00402309		       mov     ecx, [eax]
.text:0040230B		       mov     eax, [ecx-8]
.text:0040230E		       mov     edx, [ecx-4]
.text:00402311		       retn
.text:00402311 _get_int64_arg  endp
.text:00402311
.text:00402312
.text:00402312 ; =============== S U B R O U T I N E =======================================
.text:00402312
.text:00402312
.text:00402312 ; __int16 __cdecl get_short_arg(char **pargptr)
.text:00402312 _get_short_arg  proc near
.text:00402312
.text:00402312 pargptr	       = dword ptr  4
.text:00402312
.text:00402312		       mov     eax, [esp+pargptr]
.text:00402316		       add     dword ptr [eax],	4
.text:00402319		       mov     eax, [eax]
.text:0040231B		       mov     ax, [eax-4]
.text:0040231F		       retn
.text:0040231F _get_short_arg  endp
.text:0040231F
.text:00402320
.text:00402320 ; =============== S U B R O U T I N E =======================================
.text:00402320
.text:00402320 ; Attributes: bp-based frame fpd=1F8h
.text:00402320
.text:00402320 ; int __cdecl _output_l(_iobuf *stream, const char *format, localeinfo_struct *plocinfo,	char *argptr)
.text:00402320 __output_l      proc near	       ; CODE XREF: _printf+6Ep
.text:00402320					       ; _fprintf+11Ep
.text:00402320					       ; DATA XREF: ...
.text:00402320
.text:00402320 tmp	       = _CRT_DOUBLE ptr -278h
.text:00402320 capexp	       = dword ptr -270h
.text:00402320 state	       = dword ptr -26Ch
.text:00402320 retval	       = dword ptr -268h
.text:00402320 count	       = dword ptr -260h
.text:00402320 _loc_update     = _LocaleUpdate ptr -25Ch
.text:00402320 heapbuf	       = dword ptr -24Ch
.text:00402320 no_output       = dword ptr -248h
.text:00402320 hexadd	       = dword ptr -244h
.text:00402320 var_240	       = dword ptr -240h
.text:00402320 bufferiswide    = dword ptr -23Ch
.text:00402320 fldwidth	       = dword ptr -238h
.text:00402320 prefixlen       = dword ptr -234h
.text:00402320 prefix	       = byte ptr -230h
.text:00402320 charsout	       = dword ptr -22Ch
.text:00402320 f	       = dword ptr -228h
.text:00402320 var_224	       = dword ptr -224h
.text:00402320 radix	       = dword ptr -220h
.text:00402320 text	       = $12F061FBE778B92DEB8200A0ACF7A038 ptr -21Ch
.text:00402320 precision       = dword ptr -218h
.text:00402320 var_211	       = byte ptr -211h
.text:00402320 flags	       = dword ptr -210h
.text:00402320 buffer	       = $C8014B43F160BFD769FAE3F15553333C ptr -20Ch
.text:00402320 L_buffer	       = byte ptr -0Ch
.text:00402320 var_4	       = dword ptr -4
.text:00402320 stream	       = dword ptr  8
.text:00402320 format	       = dword ptr  0Ch
.text:00402320 plocinfo	       = dword ptr  10h
.text:00402320 argptr	       = dword ptr  14h
.text:00402320
.text:00402320		       push    ebp
.text:00402321		       lea     ebp, [esp-1F8h]
.text:00402328		       sub     esp, 278h
.text:0040232E		       mov     eax, ___security_cookie
.text:00402333		       xor     eax, ebp
.text:00402335		       mov     [ebp+1F8h+var_4], eax
.text:0040233B		       mov     eax, [ebp+1F8h+stream]
.text:00402341		       push    ebx
.text:00402342		       mov     ebx, [ebp+1F8h+format]
.text:00402348		       push    esi
.text:00402349		       xor     esi, esi
.text:0040234B		       push    edi
.text:0040234C		       mov     edi, [ebp+1F8h+argptr]
.text:00402352		       push    [ebp+1F8h+plocinfo] ; plocinfo
.text:00402358		       lea     ecx, [ebp+1F8h+_loc_update] ; this
.text:0040235B		       mov     [ebp+1F8h+f], eax
.text:0040235E		       mov     [ebp+1F8h+var_224], edi
.text:00402361		       mov     [ebp+1F8h+hexadd], esi
.text:00402364		       mov     [ebp+1F8h+flags], esi
.text:00402367		       mov     [ebp+1F8h+fldwidth], esi
.text:0040236A		       mov     [ebp+1F8h+precision], esi
.text:0040236D		       mov     [ebp+1F8h+prefixlen], esi
.text:00402370		       mov     [ebp+1F8h+no_output], esi
.text:00402373		       mov     [ebp+1F8h+bufferiswide],	esi
.text:00402376		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040237B		       cmp     [ebp+1F8h+f], esi
.text:0040237E		       jnz     short loc_4023AD
.text:00402380
.text:00402380 loc_402380:			       ; CODE XREF: __output_l+E5j
.text:00402380					       ; __output_l+138j ...
.text:00402380		       call    __errno
.text:00402385		       push    esi	       ; pReserved
.text:00402386		       push    esi	       ; nLine
.text:00402387		       push    esi	       ; pszFile
.text:00402388		       push    esi	       ; pszFunction
.text:00402389		       mov     dword ptr [eax],	16h
.text:0040238F		       push    esi	       ; pszExpression
.text:00402390
.text:00402390 loc_402390:			       ; CODE XREF: __output_l+947j
.text:00402390		       call    __invalid_parameter
.text:00402395		       add     esp, 14h
.text:00402398		       cmp     [ebp+1F8h+_loc_update.updated], 0
.text:0040239C		       jz      short loc_4023A5
.text:0040239E		       mov     eax, [ebp+1F8h+_loc_update.ptd]
.text:004023A1		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004023A5
.text:004023A5 loc_4023A5:			       ; CODE XREF: __output_l+7Cj
.text:004023A5		       or      eax, 0FFFFFFFFh
.text:004023A8		       jmp     loc_402C7C
.text:004023AD ; ---------------------------------------------------------------------------
.text:004023AD
.text:004023AD loc_4023AD:			       ; CODE XREF: __output_l+5Ej
.text:004023AD		       mov     eax, [ebp+1F8h+f]
.text:004023B0		       test    byte ptr	[eax+0Ch], 40h
.text:004023B4		       jnz     loc_40245E
.text:004023BA		       push    eax	       ; stream
.text:004023BB		       call    __fileno
.text:004023C0		       cmp     eax, 0FFFFFFFFh
.text:004023C3		       pop     ecx
.text:004023C4		       jz      short loc_4023FC
.text:004023C6		       push    [ebp+1F8h+f]    ; stream
.text:004023C9		       call    __fileno
.text:004023CE		       cmp     eax, 0FFFFFFFEh
.text:004023D1		       pop     ecx
.text:004023D2		       jz      short loc_4023FC
.text:004023D4		       push    [ebp+1F8h+f]    ; stream
.text:004023D7		       call    __fileno
.text:004023DC		       push    [ebp+1F8h+f]    ; stream
.text:004023DF		       sar     eax, 5
.text:004023E2		       lea     esi, ds:422F40h[eax*4]
.text:004023E9		       call    __fileno
.text:004023EE		       and     eax, 1Fh
.text:004023F1		       shl     eax, 6
.text:004023F4		       add     eax, [esi]
.text:004023F6		       pop     ecx
.text:004023F7		       pop     ecx
.text:004023F8		       xor     esi, esi
.text:004023FA		       jmp     short loc_402401
.text:004023FC ; ---------------------------------------------------------------------------
.text:004023FC
.text:004023FC loc_4023FC:			       ; CODE XREF: __output_l+A4j
.text:004023FC					       ; __output_l+B2j
.text:004023FC		       mov     eax, offset ___badioinfo
.text:00402401
.text:00402401 loc_402401:			       ; CODE XREF: __output_l+DAj
.text:00402401		       test    byte ptr	[eax+24h], 7Fh
.text:00402405		       jnz     loc_402380
.text:0040240B		       push    [ebp+1F8h+f]    ; stream
.text:0040240E		       call    __fileno
.text:00402413		       cmp     eax, 0FFFFFFFFh
.text:00402416		       pop     ecx
.text:00402417		       jz      short loc_40244F
.text:00402419		       push    [ebp+1F8h+f]    ; stream
.text:0040241C		       call    __fileno
.text:00402421		       cmp     eax, 0FFFFFFFEh
.text:00402424		       pop     ecx
.text:00402425		       jz      short loc_40244F
.text:00402427		       push    [ebp+1F8h+f]    ; stream
.text:0040242A		       call    __fileno
.text:0040242F		       push    [ebp+1F8h+f]    ; stream
.text:00402432		       sar     eax, 5
.text:00402435		       lea     esi, ds:422F40h[eax*4]
.text:0040243C		       call    __fileno
.text:00402441		       and     eax, 1Fh
.text:00402444		       shl     eax, 6
.text:00402447		       add     eax, [esi]
.text:00402449		       pop     ecx
.text:0040244A		       pop     ecx
.text:0040244B		       xor     esi, esi
.text:0040244D		       jmp     short loc_402454
.text:0040244F ; ---------------------------------------------------------------------------
.text:0040244F
.text:0040244F loc_40244F:			       ; CODE XREF: __output_l+F7j
.text:0040244F					       ; __output_l+105j
.text:0040244F		       mov     eax, offset ___badioinfo
.text:00402454
.text:00402454 loc_402454:			       ; CODE XREF: __output_l+12Dj
.text:00402454		       test    byte ptr	[eax+24h], 80h
.text:00402458		       jnz     loc_402380
.text:0040245E
.text:0040245E loc_40245E:			       ; CODE XREF: __output_l+94j
.text:0040245E		       cmp     ebx, esi
.text:00402460		       jz      loc_402380
.text:00402466		       mov     dl, [ebx]
.text:00402468		       xor     ecx, ecx
.text:0040246A		       test    dl, dl
.text:0040246C		       mov     [ebp+1F8h+charsout], esi
.text:0040246F		       mov     [ebp+1F8h+radix], esi
.text:00402472		       mov     [ebp+1F8h+heapbuf], esi
.text:00402475		       mov     [ebp+1F8h+var_211], dl
.text:00402478		       jz      loc_402C6C
.text:0040247E
.text:0040247E loc_40247E:			       ; CODE XREF: __output_l+930j
.text:0040247E		       inc     ebx
.text:0040247F		       cmp     [ebp+1F8h+charsout], 0
.text:00402483		       mov     [ebp+1F8h+var_240], ebx
.text:00402486		       jl      loc_402C6C
.text:0040248C		       mov     al, dl
.text:0040248E		       sub     al, 20h
.text:00402490		       cmp     al, 58h
.text:00402492		       ja      short loc_4024A5
.text:00402494		       movsx   eax, dl
.text:00402497		       movzx   eax, byte ptr ds:aNull_0[eax] ; "(null)"
.text:0040249E		       and     eax, 0Fh
.text:004024A1		       xor     esi, esi
.text:004024A3		       jmp     short loc_4024A9
.text:004024A5 ; ---------------------------------------------------------------------------
.text:004024A5
.text:004024A5 loc_4024A5:			       ; CODE XREF: __output_l+172j
.text:004024A5		       xor     esi, esi
.text:004024A7		       xor     eax, eax
.text:004024A9
.text:004024A9 loc_4024A9:			       ; CODE XREF: __output_l+183j
.text:004024A9		       movsx   eax, ds:___lookuptable[ecx+eax*8]
.text:004024B1		       push    7
.text:004024B3		       sar     eax, 4
.text:004024B6		       pop     ecx
.text:004024B7		       cmp     eax, ecx	       ; switch	8 cases
.text:004024B9		       mov     [ebp+1F8h+state], eax
.text:004024BC		       ja      loc_402C3C      ; default
.text:004024C2		       jmp     ds:off_402C94[eax*4] ; switch jump
.text:004024C9
.text:004024C9 $LN130:				       ; DATA XREF: __output_l:off_402C94o
.text:004024C9		       or      [ebp+1F8h+precision], 0FFFFFFFFh	; jumptable 004024C2 case 1
.text:004024CD		       mov     [ebp+1F8h+capexp], esi
.text:004024D0		       mov     [ebp+1F8h+no_output], esi
.text:004024D3		       mov     [ebp+1F8h+fldwidth], esi
.text:004024D6		       mov     [ebp+1F8h+prefixlen], esi
.text:004024D9		       mov     [ebp+1F8h+flags], esi
.text:004024DC		       mov     [ebp+1F8h+bufferiswide],	esi
.text:004024DF		       jmp     loc_402C3C      ; default
.text:004024E4 ; ---------------------------------------------------------------------------
.text:004024E4
.text:004024E4 $LN129:				       ; CODE XREF: __output_l+1A2j
.text:004024E4					       ; DATA XREF: __output_l:off_402C94o
.text:004024E4		       movsx   eax, dl	       ; jumptable 004024C2 case 2
.text:004024E7		       sub     eax, 20h
.text:004024EA		       jz      short loc_40252A
.text:004024EC		       sub     eax, 3
.text:004024EF		       jz      short loc_40251E
.text:004024F1		       sub     eax, 8
.text:004024F4		       jz      short loc_402515
.text:004024F6		       dec     eax
.text:004024F7		       dec     eax
.text:004024F8		       jz      short loc_40250C
.text:004024FA		       sub     eax, 3
.text:004024FD		       jnz     loc_402C3C      ; default
.text:00402503		       or      [ebp+1F8h+flags], 8
.text:00402507		       jmp     loc_402C3C      ; default
.text:0040250C ; ---------------------------------------------------------------------------
.text:0040250C
.text:0040250C loc_40250C:			       ; CODE XREF: __output_l+1D8j
.text:0040250C		       or      [ebp+1F8h+flags], 4
.text:00402510		       jmp     loc_402C3C      ; default
.text:00402515 ; ---------------------------------------------------------------------------
.text:00402515
.text:00402515 loc_402515:			       ; CODE XREF: __output_l+1D4j
.text:00402515		       or      [ebp+1F8h+flags], 1
.text:00402519		       jmp     loc_402C3C      ; default
.text:0040251E ; ---------------------------------------------------------------------------
.text:0040251E
.text:0040251E loc_40251E:			       ; CODE XREF: __output_l+1CFj
.text:0040251E		       or      [ebp+1F8h+flags], 80h
.text:00402525		       jmp     loc_402C3C      ; default
.text:0040252A ; ---------------------------------------------------------------------------
.text:0040252A
.text:0040252A loc_40252A:			       ; CODE XREF: __output_l+1CAj
.text:0040252A		       or      [ebp+1F8h+flags], 2
.text:0040252E		       jmp     loc_402C3C      ; default
.text:00402533 ; ---------------------------------------------------------------------------
.text:00402533
.text:00402533 $LN121:				       ; CODE XREF: __output_l+1A2j
.text:00402533					       ; DATA XREF: __output_l:off_402C94o
.text:00402533		       cmp     dl, 2Ah	       ; jumptable 004024C2 case 3
.text:00402536		       jnz     short loc_402558
.text:00402538		       add     edi, 4
.text:0040253B		       mov     [ebp+1F8h+var_224], edi
.text:0040253E		       mov     edi, [edi-4]
.text:00402541		       cmp     edi, esi
.text:00402543		       mov     [ebp+1F8h+fldwidth], edi
.text:00402546		       jge     loc_402C3C      ; default
.text:0040254C		       or      [ebp+1F8h+flags], 4
.text:00402550		       neg     [ebp+1F8h+fldwidth]
.text:00402553		       jmp     loc_402C3C      ; default
.text:00402558 ; ---------------------------------------------------------------------------
.text:00402558
.text:00402558 loc_402558:			       ; CODE XREF: __output_l+216j
.text:00402558		       mov     eax, [ebp+1F8h+fldwidth]
.text:0040255B		       imul    eax, 0Ah
.text:0040255E		       movsx   ecx, dl
.text:00402561		       lea     eax, [eax+ecx-30h]
.text:00402565		       mov     [ebp+1F8h+fldwidth], eax
.text:00402568		       jmp     loc_402C3C      ; default
.text:0040256D ; ---------------------------------------------------------------------------
.text:0040256D
.text:0040256D $LN117:				       ; CODE XREF: __output_l+1A2j
.text:0040256D					       ; DATA XREF: __output_l:off_402C94o
.text:0040256D		       mov     [ebp+1F8h+precision], esi ; jumptable 004024C2 case 4
.text:00402570		       jmp     loc_402C3C      ; default
.text:00402575 ; ---------------------------------------------------------------------------
.text:00402575
.text:00402575 $LN116:				       ; CODE XREF: __output_l+1A2j
.text:00402575					       ; DATA XREF: __output_l:off_402C94o
.text:00402575		       cmp     dl, 2Ah	       ; jumptable 004024C2 case 5
.text:00402578		       jnz     short loc_402597
.text:0040257A		       add     edi, 4
.text:0040257D		       mov     [ebp+1F8h+var_224], edi
.text:00402580		       mov     edi, [edi-4]
.text:00402583		       cmp     edi, esi
.text:00402585		       mov     [ebp+1F8h+precision], edi
.text:00402588		       jge     loc_402C3C      ; default
.text:0040258E		       or      [ebp+1F8h+precision], 0FFFFFFFFh
.text:00402592		       jmp     loc_402C3C      ; default
.text:00402597 ; ---------------------------------------------------------------------------
.text:00402597
.text:00402597 loc_402597:			       ; CODE XREF: __output_l+258j
.text:00402597		       mov     eax, [ebp+1F8h+precision]
.text:0040259A		       imul    eax, 0Ah
.text:0040259D		       movsx   ecx, dl
.text:004025A0		       lea     eax, [eax+ecx-30h]
.text:004025A4		       mov     [ebp+1F8h+precision], eax
.text:004025A7		       jmp     loc_402C3C      ; default
.text:004025AC ; ---------------------------------------------------------------------------
.text:004025AC
.text:004025AC $LN112:				       ; CODE XREF: __output_l+1A2j
.text:004025AC					       ; DATA XREF: __output_l:off_402C94o
.text:004025AC		       cmp     dl, 49h	       ; jumptable 004024C2 case 6
.text:004025AF		       jz      short loc_4025F7
.text:004025B1		       cmp     dl, 68h
.text:004025B4		       jz      short loc_4025EE
.text:004025B6		       cmp     dl, 6Ch
.text:004025B9		       jz      short loc_4025D0
.text:004025BB		       cmp     dl, 77h
.text:004025BE		       jnz     loc_402C3C      ; default
.text:004025C4		       or      [ebp+1F8h+flags], 800h
.text:004025CB		       jmp     loc_402C3C      ; default
.text:004025D0 ; ---------------------------------------------------------------------------
.text:004025D0
.text:004025D0 loc_4025D0:			       ; CODE XREF: __output_l+299j
.text:004025D0		       cmp     byte ptr	[ebx], 6Ch
.text:004025D3		       jnz     short loc_4025E5
.text:004025D5		       inc     ebx
.text:004025D6		       or      [ebp+1F8h+flags], 1000h
.text:004025DD		       mov     [ebp+1F8h+var_240], ebx
.text:004025E0		       jmp     loc_402C3C      ; default
.text:004025E5 ; ---------------------------------------------------------------------------
.text:004025E5
.text:004025E5 loc_4025E5:			       ; CODE XREF: __output_l+2B3j
.text:004025E5		       or      [ebp+1F8h+flags], 10h
.text:004025E9		       jmp     loc_402C3C      ; default
.text:004025EE ; ---------------------------------------------------------------------------
.text:004025EE
.text:004025EE loc_4025EE:			       ; CODE XREF: __output_l+294j
.text:004025EE		       or      [ebp+1F8h+flags], 20h
.text:004025F2		       jmp     loc_402C3C      ; default
.text:004025F7 ; ---------------------------------------------------------------------------
.text:004025F7
.text:004025F7 loc_4025F7:			       ; CODE XREF: __output_l+28Fj
.text:004025F7		       mov     al, [ebx]
.text:004025F9		       cmp     al, 36h
.text:004025FB		       jnz     short loc_402614
.text:004025FD		       cmp     byte ptr	[ebx+1], 34h
.text:00402601		       jnz     short loc_402614
.text:00402603		       inc     ebx
.text:00402604		       inc     ebx
.text:00402605		       or      [ebp+1F8h+flags], 8000h
.text:0040260C		       mov     [ebp+1F8h+var_240], ebx
.text:0040260F		       jmp     loc_402C3C      ; default
.text:00402614 ; ---------------------------------------------------------------------------
.text:00402614
.text:00402614 loc_402614:			       ; CODE XREF: __output_l+2DBj
.text:00402614					       ; __output_l+2E1j
.text:00402614		       cmp     al, 33h
.text:00402616		       jnz     short loc_40262F
.text:00402618		       cmp     byte ptr	[ebx+1], 32h
.text:0040261C		       jnz     short loc_40262F
.text:0040261E		       inc     ebx
.text:0040261F		       inc     ebx
.text:00402620		       and     [ebp+1F8h+flags], 0FFFF7FFFh
.text:00402627		       mov     [ebp+1F8h+var_240], ebx
.text:0040262A		       jmp     loc_402C3C      ; default
.text:0040262F ; ---------------------------------------------------------------------------
.text:0040262F
.text:0040262F loc_40262F:			       ; CODE XREF: __output_l+2F6j
.text:0040262F					       ; __output_l+2FCj
.text:0040262F		       cmp     al, 64h
.text:00402631		       jz      loc_402C3C      ; default
.text:00402637		       cmp     al, 69h
.text:00402639		       jz      loc_402C3C      ; default
.text:0040263F		       cmp     al, 6Fh
.text:00402641		       jz      loc_402C3C      ; default
.text:00402647		       cmp     al, 75h
.text:00402649		       jz      loc_402C3C      ; default
.text:0040264F		       cmp     al, 78h
.text:00402651		       jz      loc_402C3C      ; default
.text:00402657		       cmp     al, 58h
.text:00402659		       jz      loc_402C3C      ; default
.text:0040265F		       mov     [ebp+1F8h+state], esi
.text:00402662
.text:00402662 NORMAL_STATE:			       ; CODE XREF: __output_l+1A2j
.text:00402662					       ; DATA XREF: __output_l:off_402C94o
.text:00402662		       lea     eax, [ebp+1F8h+_loc_update] ; jumptable 004024C2	case 0
.text:00402665		       push    eax	       ; plocinfo
.text:00402666		       movzx   eax, dl
.text:00402669		       push    eax	       ; c
.text:0040266A		       mov     [ebp+1F8h+bufferiswide],	esi
.text:0040266D		       call    __isleadbyte_l
.text:00402672		       pop     ecx
.text:00402673		       test    eax, eax
.text:00402675		       mov     al, [ebp+1F8h+var_211]
.text:00402678		       pop     ecx
.text:00402679		       jz      short loc_402694
.text:0040267B		       mov     ecx, [ebp+1F8h+f] ; f
.text:0040267E		       lea     esi, [ebp+1F8h+charsout]	; pnumwritten
.text:00402681		       call    write_char
.text:00402686		       mov     al, [ebx]       ; ch
.text:00402688		       inc     ebx
.text:00402689		       test    al, al
.text:0040268B		       mov     [ebp+1F8h+var_240], ebx
.text:0040268E		       jz      loc_402C55
.text:00402694
.text:00402694 loc_402694:			       ; CODE XREF: __output_l+359j
.text:00402694		       mov     ecx, [ebp+1F8h+f] ; f
.text:00402697		       lea     esi, [ebp+1F8h+charsout]	; pnumwritten
.text:0040269A		       call    write_char
.text:0040269F		       jmp     loc_402C3C      ; default
.text:004026A4 ; ---------------------------------------------------------------------------
.text:004026A4
.text:004026A4 $LN96:				       ; CODE XREF: __output_l+1A2j
.text:004026A4					       ; DATA XREF: __output_l:off_402C94o
.text:004026A4		       movsx   eax, dl	       ; jumptable 004024C2 case 7
.text:004026A7		       cmp     eax, 64h
.text:004026AA		       jg      loc_402822
.text:004026B0		       jz      loc_4028A1
.text:004026B6		       cmp     eax, 53h
.text:004026B9		       jg      loc_40276A
.text:004026BF		       jz      short loc_40271B
.text:004026C1		       sub     eax, 41h
.text:004026C4		       jz      short loc_4026D6
.text:004026C6		       dec     eax
.text:004026C7		       dec     eax
.text:004026C8		       jz      short loc_40270A
.text:004026CA		       dec     eax
.text:004026CB		       dec     eax
.text:004026CC		       jz      short loc_4026D6
.text:004026CE		       dec     eax
.text:004026CF		       dec     eax
.text:004026D0		       jnz     loc_402B24
.text:004026D6
.text:004026D6 loc_4026D6:			       ; CODE XREF: __output_l+3A4j
.text:004026D6					       ; __output_l+3ACj
.text:004026D6		       add     dl, 20h
.text:004026D9		       mov     [ebp+1F8h+capexp], 1
.text:004026E0		       mov     [ebp+1F8h+var_211], dl
.text:004026E3
.text:004026E3 loc_4026E3:			       ; CODE XREF: __output_l+459j
.text:004026E3					       ; __output_l+51Dj
.text:004026E3		       or      [ebp+1F8h+flags], 40h
.text:004026E7		       cmp     [ebp+1F8h+precision], esi
.text:004026EA		       lea     ebx, [ebp+1F8h+buffer]
.text:004026ED		       mov     eax, 200h
.text:004026F2		       mov     dword ptr [ebp+1F8h+text], ebx
.text:004026F5		       mov     [ebp+1F8h+count], eax
.text:004026F8		       jge     loc_4028C5
.text:004026FE		       mov     [ebp+1F8h+precision], 6
.text:00402705		       jmp     loc_402913
.text:0040270A ; ---------------------------------------------------------------------------
.text:0040270A
.text:0040270A loc_40270A:			       ; CODE XREF: __output_l+3A8j
.text:0040270A		       test    word ptr	[ebp+1F8h+flags], 830h
.text:00402710		       jnz     short loc_402787
.text:00402712		       or      [ebp+1F8h+flags], 800h
.text:00402719		       jmp     short loc_402787
.text:0040271B ; ---------------------------------------------------------------------------
.text:0040271B
.text:0040271B loc_40271B:			       ; CODE XREF: __output_l+39Fj
.text:0040271B		       test    word ptr	[ebp+1F8h+flags], 830h
.text:00402721		       jnz     short loc_40272A
.text:00402723		       or      [ebp+1F8h+flags], 800h
.text:0040272A
.text:0040272A loc_40272A:			       ; CODE XREF: __output_l+401j
.text:0040272A					       ; __output_l+694j
.text:0040272A		       mov     ecx, [ebp+1F8h+precision]
.text:0040272D		       cmp     ecx, 0FFFFFFFFh
.text:00402730		       jnz     short loc_402737
.text:00402732		       mov     ecx, 7FFFFFFFh
.text:00402737
.text:00402737 loc_402737:			       ; CODE XREF: __output_l+410j
.text:00402737		       add     edi, 4
.text:0040273A		       test    word ptr	[ebp+1F8h+flags], 810h
.text:00402740		       mov     [ebp+1F8h+var_224], edi
.text:00402743		       mov     edi, [edi-4]
.text:00402746		       mov     dword ptr [ebp+1F8h+text], edi
.text:00402749		       jz      loc_402B02
.text:0040274F		       cmp     edi, esi
.text:00402751		       jnz     short loc_40275B
.text:00402753		       mov     eax, ___wnullstring
.text:00402758		       mov     dword ptr [ebp+1F8h+text], eax
.text:0040275B
.text:0040275B loc_40275B:			       ; CODE XREF: __output_l+431j
.text:0040275B		       mov     eax, dword ptr [ebp+1F8h+text]
.text:0040275E		       mov     [ebp+1F8h+bufferiswide],	1
.text:00402765		       jmp     loc_402AF7
.text:0040276A ; ---------------------------------------------------------------------------
.text:0040276A
.text:0040276A loc_40276A:			       ; CODE XREF: __output_l+399j
.text:0040276A		       sub     eax, 58h
.text:0040276D		       jz      loc_4029AC
.text:00402773		       dec     eax
.text:00402774		       dec     eax
.text:00402775		       jz      short loc_4027D4
.text:00402777		       sub     eax, ecx
.text:00402779		       jz      loc_4026E3
.text:0040277F		       dec     eax
.text:00402780		       dec     eax
.text:00402781		       jnz     loc_402B24
.text:00402787
.text:00402787 loc_402787:			       ; CODE XREF: __output_l+3F0j
.text:00402787					       ; __output_l+3F9j
.text:00402787		       add     edi, 4
.text:0040278A		       test    word ptr	[ebp+1F8h+flags], 810h
.text:00402790		       mov     [ebp+1F8h+var_224], edi
.text:00402793		       jz      short loc_4027BC
.text:00402795		       movzx   eax, word ptr [edi-4]
.text:00402799		       push    eax	       ; wchar
.text:0040279A		       push    200h	       ; sizeInBytes
.text:0040279F		       lea     eax, [ebp+1F8h+buffer]
.text:004027A2		       push    eax	       ; dst
.text:004027A3		       lea     eax, [ebp+1F8h+radix]
.text:004027A6		       push    eax	       ; pRetValue
.text:004027A7		       call    _wctomb_s
.text:004027AC		       add     esp, 10h
.text:004027AF		       test    eax, eax
.text:004027B1		       jz      short loc_4027C9
.text:004027B3		       mov     [ebp+1F8h+no_output], 1
.text:004027BA		       jmp     short loc_4027C9
.text:004027BC ; ---------------------------------------------------------------------------
.text:004027BC
.text:004027BC loc_4027BC:			       ; CODE XREF: __output_l+473j
.text:004027BC		       mov     al, [edi-4]
.text:004027BF		       mov     byte ptr	[ebp+1F8h+buffer], al
.text:004027C2		       mov     [ebp+1F8h+radix], 1
.text:004027C9
.text:004027C9 loc_4027C9:			       ; CODE XREF: __output_l+491j
.text:004027C9					       ; __output_l+49Aj
.text:004027C9		       lea     eax, [ebp+1F8h+buffer]
.text:004027CC		       mov     dword ptr [ebp+1F8h+text], eax
.text:004027CF		       jmp     loc_402B24
.text:004027D4 ; ---------------------------------------------------------------------------
.text:004027D4
.text:004027D4 loc_4027D4:			       ; CODE XREF: __output_l+455j
.text:004027D4		       mov     eax, [edi]
.text:004027D6		       add     edi, 4
.text:004027D9		       cmp     eax, esi
.text:004027DB		       mov     [ebp+1F8h+var_224], edi
.text:004027DE		       jz      short loc_40280E
.text:004027E0		       mov     ecx, [eax+4]
.text:004027E3		       cmp     ecx, esi
.text:004027E5		       jz      short loc_40280E
.text:004027E7		       test    word ptr	[ebp+1F8h+flags], 800h
.text:004027ED		       movsx   eax, word ptr [eax]
.text:004027F0		       mov     dword ptr [ebp+1F8h+text], ecx
.text:004027F3		       jz      short loc_402806
.text:004027F5		       cdq
.text:004027F6		       sub     eax, edx
.text:004027F8		       sar     eax, 1
.text:004027FA		       mov     [ebp+1F8h+bufferiswide],	1
.text:00402801		       jmp     loc_402B21
.text:00402806 ; ---------------------------------------------------------------------------
.text:00402806
.text:00402806 loc_402806:			       ; CODE XREF: __output_l+4D3j
.text:00402806		       mov     [ebp+1F8h+bufferiswide],	esi
.text:00402809		       jmp     loc_402B21
.text:0040280E ; ---------------------------------------------------------------------------
.text:0040280E
.text:0040280E loc_40280E:			       ; CODE XREF: __output_l+4BEj
.text:0040280E					       ; __output_l+4C5j
.text:0040280E		       mov     eax, ___nullstring
.text:00402813		       mov     dword ptr [ebp+1F8h+text], eax
.text:00402816		       push    eax	       ; buf
.text:00402817
.text:00402817 loc_402817:			       ; CODE XREF: __output_l+680j
.text:00402817		       call    _strlen
.text:0040281C		       pop     ecx
.text:0040281D		       jmp     loc_402B21
.text:00402822 ; ---------------------------------------------------------------------------
.text:00402822
.text:00402822 loc_402822:			       ; CODE XREF: __output_l+38Aj
.text:00402822		       cmp     eax, 70h
.text:00402825		       jg      loc_4029B1
.text:0040282B		       jz      loc_4029A5
.text:00402831		       cmp     eax, 65h
.text:00402834		       jl      loc_402B24
.text:0040283A		       cmp     eax, 67h
.text:0040283D		       jle     loc_4026E3
.text:00402843		       cmp     eax, 69h
.text:00402846		       jz      short loc_4028A1
.text:00402848		       cmp     eax, 6Eh
.text:0040284B		       jz      short loc_40286C
.text:0040284D		       cmp     eax, 6Fh
.text:00402850		       jnz     loc_402B24
.text:00402856		       test    byte ptr	[ebp+1F8h+flags], 80h
.text:0040285A		       mov     [ebp+1F8h+radix], 8
.text:00402861		       jz      short COMMON_INT
.text:00402863		       or      [ebp+1F8h+flags], 200h
.text:0040286A		       jmp     short COMMON_INT
.text:0040286C ; ---------------------------------------------------------------------------
.text:0040286C
.text:0040286C loc_40286C:			       ; CODE XREF: __output_l+52Bj
.text:0040286C		       mov     esi, [edi]
.text:0040286E		       add     edi, 4
.text:00402871		       mov     [ebp+1F8h+var_224], edi
.text:00402874		       call    __get_printf_count_output
.text:00402879		       test    eax, eax
.text:0040287B		       jz      loc_402C55
.text:00402881		       test    byte ptr	[ebp+1F8h+flags], 20h
.text:00402885		       jz      short loc_402890
.text:00402887		       mov     ax, word	ptr [ebp+1F8h+charsout]
.text:0040288B		       mov     [esi], ax
.text:0040288E		       jmp     short loc_402895
.text:00402890 ; ---------------------------------------------------------------------------
.text:00402890
.text:00402890 loc_402890:			       ; CODE XREF: __output_l+565j
.text:00402890		       mov     eax, [ebp+1F8h+charsout]
.text:00402893		       mov     [esi], eax
.text:00402895
.text:00402895 loc_402895:			       ; CODE XREF: __output_l+56Ej
.text:00402895		       mov     [ebp+1F8h+no_output], 1
.text:0040289C		       jmp     loc_402C29
.text:004028A1 ; ---------------------------------------------------------------------------
.text:004028A1
.text:004028A1 loc_4028A1:			       ; CODE XREF: __output_l+390j
.text:004028A1					       ; __output_l+526j
.text:004028A1		       or      [ebp+1F8h+flags], 40h
.text:004028A5
.text:004028A5 loc_4028A5:			       ; CODE XREF: __output_l+69Cj
.text:004028A5		       mov     [ebp+1F8h+radix], 0Ah
.text:004028AC
.text:004028AC COMMON_INT:			       ; CODE XREF: __output_l+541j
.text:004028AC					       ; __output_l+54Aj ...
.text:004028AC		       mov     ecx, [ebp+1F8h+flags]
.text:004028AF		       test    cx, cx
.text:004028B2		       jns     loc_4029FB
.text:004028B8
.text:004028B8 loc_4028B8:			       ; CODE XREF: __output_l+6E0j
.text:004028B8		       mov     eax, [edi]
.text:004028BA		       mov     edx, [edi+4]
.text:004028BD		       add     edi, 8
.text:004028C0		       jmp     loc_402A30
.text:004028C5 ; ---------------------------------------------------------------------------
.text:004028C5
.text:004028C5 loc_4028C5:			       ; CODE XREF: __output_l+3D8j
.text:004028C5		       jnz     short loc_4028D5
.text:004028C7		       cmp     dl, 67h
.text:004028CA		       jnz     short loc_402913
.text:004028CC		       mov     [ebp+1F8h+precision], 1
.text:004028D3		       jmp     short loc_402913
.text:004028D5 ; ---------------------------------------------------------------------------
.text:004028D5
.text:004028D5 loc_4028D5:			       ; CODE XREF: __output_l:loc_4028C5j
.text:004028D5		       cmp     [ebp+1F8h+precision], eax
.text:004028D8		       jle     short loc_4028DD
.text:004028DA		       mov     [ebp+1F8h+precision], eax
.text:004028DD
.text:004028DD loc_4028DD:			       ; CODE XREF: __output_l+5B8j
.text:004028DD		       cmp     [ebp+1F8h+precision], 0A3h
.text:004028E4		       jle     short loc_402913
.text:004028E6		       mov     esi, [ebp+1F8h+precision]
.text:004028E9		       add     esi, 15Dh
.text:004028EF		       push    esi	       ; cb
.text:004028F0		       call    __malloc_crt
.text:004028F5		       test    eax, eax
.text:004028F7		       mov     dl, [ebp+1F8h+var_211]
.text:004028FA		       pop     ecx
.text:004028FB		       mov     [ebp+1F8h+heapbuf], eax
.text:004028FE		       jz      short loc_40290A
.text:00402900		       mov     dword ptr [ebp+1F8h+text], eax
.text:00402903		       mov     [ebp+1F8h+count], esi
.text:00402906		       mov     ebx, eax
.text:00402908		       jmp     short loc_402911
.text:0040290A ; ---------------------------------------------------------------------------
.text:0040290A
.text:0040290A loc_40290A:			       ; CODE XREF: __output_l+5DEj
.text:0040290A		       mov     [ebp+1F8h+precision], 0A3h
.text:00402911
.text:00402911 loc_402911:			       ; CODE XREF: __output_l+5E8j
.text:00402911		       xor     esi, esi
.text:00402913
.text:00402913 loc_402913:			       ; CODE XREF: __output_l+3E5j
.text:00402913					       ; __output_l+5AAj ...
.text:00402913		       mov     eax, [edi]
.text:00402915		       add     edi, 8
.text:00402918		       mov     dword ptr [ebp+1F8h+tmp.x], eax
.text:0040291B		       mov     eax, [edi-4]
.text:0040291E		       mov     dword ptr [ebp+1F8h+tmp.x+4], eax
.text:00402921		       lea     eax, [ebp+1F8h+_loc_update]
.text:00402924		       push    eax
.text:00402925		       push    [ebp+1F8h+capexp]
.text:00402928		       movsx   eax, dl
.text:0040292B		       push    [ebp+1F8h+precision]
.text:0040292E		       mov     [ebp+1F8h+var_224], edi
.text:00402931		       push    eax
.text:00402932		       push    [ebp+1F8h+count]
.text:00402935		       lea     eax, [ebp+1F8h+tmp]
.text:00402938		       push    ebx
.text:00402939		       push    eax
.text:0040293A		       push    codedptr	       ; codedptr
.text:00402940		       call    __decode_pointer
.text:00402945		       pop     ecx
.text:00402946		       call    eax
.text:00402948		       mov     edi, [ebp+1F8h+flags]
.text:0040294B		       add     esp, 1Ch
.text:0040294E		       and     edi, 80h
.text:00402954		       jz      short loc_402970
.text:00402956		       cmp     [ebp+1F8h+precision], esi
.text:00402959		       jnz     short loc_402970
.text:0040295B		       lea     eax, [ebp+1F8h+_loc_update]
.text:0040295E		       push    eax
.text:0040295F		       push    ebx
.text:00402960		       push    off_421694      ; codedptr
.text:00402966		       call    __decode_pointer
.text:0040296B		       pop     ecx
.text:0040296C		       call    eax
.text:0040296E		       pop     ecx
.text:0040296F		       pop     ecx
.text:00402970
.text:00402970 loc_402970:			       ; CODE XREF: __output_l+634j
.text:00402970					       ; __output_l+639j
.text:00402970		       cmp     [ebp+1F8h+var_211], 67h
.text:00402974		       jnz     short loc_40298F
.text:00402976		       cmp     edi, esi
.text:00402978		       jnz     short loc_40298F
.text:0040297A		       lea     eax, [ebp+1F8h+_loc_update]
.text:0040297D		       push    eax
.text:0040297E		       push    ebx
.text:0040297F		       push    off_421690      ; codedptr
.text:00402985		       call    __decode_pointer
.text:0040298A		       pop     ecx
.text:0040298B		       call    eax
.text:0040298D		       pop     ecx
.text:0040298E		       pop     ecx
.text:0040298F
.text:0040298F loc_40298F:			       ; CODE XREF: __output_l+654j
.text:0040298F					       ; __output_l+658j
.text:0040298F		       cmp     byte ptr	[ebx], 2Dh
.text:00402992		       jnz     short loc_40299F
.text:00402994		       or      [ebp+1F8h+flags], 100h
.text:0040299B		       inc     ebx
.text:0040299C		       mov     dword ptr [ebp+1F8h+text], ebx
.text:0040299F
.text:0040299F loc_40299F:			       ; CODE XREF: __output_l+672j
.text:0040299F		       push    ebx
.text:004029A0		       jmp     loc_402817
.text:004029A5 ; ---------------------------------------------------------------------------
.text:004029A5
.text:004029A5 loc_4029A5:			       ; CODE XREF: __output_l+50Bj
.text:004029A5		       mov     [ebp+1F8h+precision], 8
.text:004029AC
.text:004029AC loc_4029AC:			       ; CODE XREF: __output_l+44Dj
.text:004029AC		       mov     [ebp+1F8h+hexadd], ecx
.text:004029AF		       jmp     short COMMON_HEX
.text:004029B1 ; ---------------------------------------------------------------------------
.text:004029B1
.text:004029B1 loc_4029B1:			       ; CODE XREF: __output_l+505j
.text:004029B1		       sub     eax, 73h
.text:004029B4		       jz      loc_40272A
.text:004029BA		       dec     eax
.text:004029BB		       dec     eax
.text:004029BC		       jz      loc_4028A5
.text:004029C2		       sub     eax, 3
.text:004029C5		       jnz     loc_402B24
.text:004029CB		       mov     [ebp+1F8h+hexadd], 27h
.text:004029D2
.text:004029D2 COMMON_HEX:			       ; CODE XREF: __output_l+68Fj
.text:004029D2		       test    byte ptr	[ebp+1F8h+flags], 80h
.text:004029D6		       mov     [ebp+1F8h+radix], 10h
.text:004029DD		       jz      COMMON_INT
.text:004029E3		       mov     al, byte	ptr [ebp+1F8h+hexadd]
.text:004029E6		       add     al, 51h
.text:004029E8		       mov     [ebp+1F8h+prefix], 30h
.text:004029EC		       mov     [ebp+1F8h+prefix+1], al
.text:004029EF		       mov     [ebp+1F8h+prefixlen], 2
.text:004029F6		       jmp     COMMON_INT
.text:004029FB ; ---------------------------------------------------------------------------
.text:004029FB
.text:004029FB loc_4029FB:			       ; CODE XREF: __output_l+592j
.text:004029FB		       test    cx, 1000h
.text:00402A00		       jnz     loc_4028B8
.text:00402A06		       add     edi, 4
.text:00402A09		       test    cl, 20h
.text:00402A0C		       jz      short loc_402A23
.text:00402A0E		       test    cl, 40h
.text:00402A11		       mov     [ebp+1F8h+var_224], edi
.text:00402A14		       jz      short loc_402A1C
.text:00402A16		       movsx   eax, word ptr [edi-4]
.text:00402A1A		       jmp     short loc_402A20
.text:00402A1C ; ---------------------------------------------------------------------------
.text:00402A1C
.text:00402A1C loc_402A1C:			       ; CODE XREF: __output_l+6F4j
.text:00402A1C		       movzx   eax, word ptr [edi-4]
.text:00402A20
.text:00402A20 loc_402A20:			       ; CODE XREF: __output_l+6FAj
.text:00402A20		       cdq
.text:00402A21		       jmp     short loc_402A33
.text:00402A23 ; ---------------------------------------------------------------------------
.text:00402A23
.text:00402A23 loc_402A23:			       ; CODE XREF: __output_l+6ECj
.text:00402A23		       test    cl, 40h
.text:00402A26		       mov     eax, [edi-4]
.text:00402A29		       jz      short loc_402A2E
.text:00402A2B		       cdq
.text:00402A2C		       jmp     short loc_402A30
.text:00402A2E ; ---------------------------------------------------------------------------
.text:00402A2E
.text:00402A2E loc_402A2E:			       ; CODE XREF: __output_l+709j
.text:00402A2E		       xor     edx, edx
.text:00402A30
.text:00402A30 loc_402A30:			       ; CODE XREF: __output_l+5A0j
.text:00402A30					       ; __output_l+70Cj
.text:00402A30		       mov     [ebp+1F8h+var_224], edi
.text:00402A33
.text:00402A33 loc_402A33:			       ; CODE XREF: __output_l+701j
.text:00402A33		       test    cl, 40h
.text:00402A36		       jz      short loc_402A50
.text:00402A38		       cmp     edx, esi
.text:00402A3A		       jg      short loc_402A50
.text:00402A3C		       jl      short loc_402A42
.text:00402A3E		       cmp     eax, esi
.text:00402A40		       jnb     short loc_402A50
.text:00402A42
.text:00402A42 loc_402A42:			       ; CODE XREF: __output_l+71Cj
.text:00402A42		       neg     eax
.text:00402A44		       adc     edx, 0
.text:00402A47		       neg     edx
.text:00402A49		       or      [ebp+1F8h+flags], 100h
.text:00402A50
.text:00402A50 loc_402A50:			       ; CODE XREF: __output_l+716j
.text:00402A50					       ; __output_l+71Aj ...
.text:00402A50		       test    word ptr	[ebp+1F8h+flags], 9000h
.text:00402A56		       mov     ebx, edx
.text:00402A58		       mov     edi, eax
.text:00402A5A		       jnz     short loc_402A5E
.text:00402A5C		       xor     ebx, ebx
.text:00402A5E
.text:00402A5E loc_402A5E:			       ; CODE XREF: __output_l+73Aj
.text:00402A5E		       cmp     [ebp+1F8h+precision], 0
.text:00402A62		       jge     short loc_402A6D
.text:00402A64		       mov     [ebp+1F8h+precision], 1
.text:00402A6B		       jmp     short loc_402A7E
.text:00402A6D ; ---------------------------------------------------------------------------
.text:00402A6D
.text:00402A6D loc_402A6D:			       ; CODE XREF: __output_l+742j
.text:00402A6D		       and     [ebp+1F8h+flags], 0FFFFFFF7h
.text:00402A71		       mov     eax, 200h
.text:00402A76		       cmp     [ebp+1F8h+precision], eax
.text:00402A79		       jle     short loc_402A7E
.text:00402A7B		       mov     [ebp+1F8h+precision], eax
.text:00402A7E
.text:00402A7E loc_402A7E:			       ; CODE XREF: __output_l+74Bj
.text:00402A7E					       ; __output_l+759j
.text:00402A7E		       mov     eax, edi
.text:00402A80		       or      eax, ebx
.text:00402A82		       jnz     short loc_402A87
.text:00402A84		       and     [ebp+1F8h+prefixlen], eax
.text:00402A87
.text:00402A87 loc_402A87:			       ; CODE XREF: __output_l+762j
.text:00402A87		       lea     esi, [ebp+1F8h+buffer+1FFh]
.text:00402A8D
.text:00402A8D loc_402A8D:			       ; CODE XREF: __output_l+79Fj
.text:00402A8D		       mov     eax, [ebp+1F8h+precision]
.text:00402A90		       dec     [ebp+1F8h+precision]
.text:00402A93		       test    eax, eax
.text:00402A95		       jg      short loc_402A9D
.text:00402A97		       mov     eax, edi
.text:00402A99		       or      eax, ebx
.text:00402A9B		       jz      short loc_402AC1
.text:00402A9D
.text:00402A9D loc_402A9D:			       ; CODE XREF: __output_l+775j
.text:00402A9D		       mov     eax, [ebp+1F8h+radix]
.text:00402AA0		       cdq
.text:00402AA1		       push    edx
.text:00402AA2		       push    eax
.text:00402AA3		       push    ebx
.text:00402AA4		       push    edi
.text:00402AA5		       call    __aulldvrm
.text:00402AAA		       add     ecx, 30h
.text:00402AAD		       cmp     ecx, 39h
.text:00402AB0		       mov     [ebp+1F8h+count], ebx
.text:00402AB3		       mov     edi, eax	       ; f
.text:00402AB5		       mov     ebx, edx
.text:00402AB7		       jle     short loc_402ABC
.text:00402AB9		       add     ecx, [ebp+1F8h+hexadd]
.text:00402ABC
.text:00402ABC loc_402ABC:			       ; CODE XREF: __output_l+797j
.text:00402ABC		       mov     [esi], cl
.text:00402ABE		       dec     esi
.text:00402ABF		       jmp     short loc_402A8D
.text:00402AC1 ; ---------------------------------------------------------------------------
.text:00402AC1
.text:00402AC1 loc_402AC1:			       ; CODE XREF: __output_l+77Bj
.text:00402AC1		       lea     eax, [ebp+1F8h+buffer+1FFh]
.text:00402AC7		       sub     eax, esi
.text:00402AC9		       inc     esi
.text:00402ACA		       test    word ptr	[ebp+1F8h+flags], 200h
.text:00402AD0		       mov     [ebp+1F8h+radix], eax
.text:00402AD3		       mov     dword ptr [ebp+1F8h+text], esi
.text:00402AD6		       jz      short loc_402B24
.text:00402AD8		       test    eax, eax
.text:00402ADA		       jz      short loc_402AE3
.text:00402ADC		       mov     ecx, esi
.text:00402ADE		       cmp     byte ptr	[ecx], 30h
.text:00402AE1		       jz      short loc_402B24
.text:00402AE3
.text:00402AE3 loc_402AE3:			       ; CODE XREF: __output_l+7BAj
.text:00402AE3		       dec     dword ptr [ebp+1F8h+text]
.text:00402AE6		       mov     ecx, dword ptr [ebp+1F8h+text]
.text:00402AE9		       mov     byte ptr	[ecx], 30h
.text:00402AEC		       inc     eax
.text:00402AED		       jmp     short loc_402B21
.text:00402AEF ; ---------------------------------------------------------------------------
.text:00402AEF
.text:00402AEF loc_402AEF:			       ; CODE XREF: __output_l+7D9j
.text:00402AEF		       dec     ecx
.text:00402AF0		       cmp     [eax], si
.text:00402AF3		       jz      short loc_402AFB
.text:00402AF5		       inc     eax
.text:00402AF6		       inc     eax
.text:00402AF7
.text:00402AF7 loc_402AF7:			       ; CODE XREF: __output_l+445j
.text:00402AF7		       cmp     ecx, esi
.text:00402AF9		       jnz     short loc_402AEF
.text:00402AFB
.text:00402AFB loc_402AFB:			       ; CODE XREF: __output_l+7D3j
.text:00402AFB		       sub     eax, dword ptr [ebp+1F8h+text]
.text:00402AFE		       sar     eax, 1
.text:00402B00		       jmp     short loc_402B21
.text:00402B02 ; ---------------------------------------------------------------------------
.text:00402B02
.text:00402B02 loc_402B02:			       ; CODE XREF: __output_l+429j
.text:00402B02		       cmp     edi, esi
.text:00402B04		       jnz     short loc_402B0E
.text:00402B06		       mov     eax, ___nullstring
.text:00402B0B		       mov     dword ptr [ebp+1F8h+text], eax
.text:00402B0E
.text:00402B0E loc_402B0E:			       ; CODE XREF: __output_l+7E4j
.text:00402B0E		       mov     eax, dword ptr [ebp+1F8h+text]
.text:00402B11		       jmp     short loc_402B1A
.text:00402B13 ; ---------------------------------------------------------------------------
.text:00402B13
.text:00402B13 loc_402B13:			       ; CODE XREF: __output_l+7FCj
.text:00402B13		       dec     ecx
.text:00402B14		       cmp     byte ptr	[eax], 0
.text:00402B17		       jz      short loc_402B1E
.text:00402B19		       inc     eax
.text:00402B1A
.text:00402B1A loc_402B1A:			       ; CODE XREF: __output_l+7F1j
.text:00402B1A		       cmp     ecx, esi
.text:00402B1C		       jnz     short loc_402B13
.text:00402B1E
.text:00402B1E loc_402B1E:			       ; CODE XREF: __output_l+7F7j
.text:00402B1E		       sub     eax, dword ptr [ebp+1F8h+text]
.text:00402B21
.text:00402B21 loc_402B21:			       ; CODE XREF: __output_l+4E1j
.text:00402B21					       ; __output_l+4E9j ...
.text:00402B21		       mov     [ebp+1F8h+radix], eax
.text:00402B24
.text:00402B24 loc_402B24:			       ; CODE XREF: __output_l+3B0j
.text:00402B24					       ; __output_l+461j ...
.text:00402B24		       cmp     [ebp+1F8h+no_output], 0
.text:00402B28		       jnz     loc_402C29
.text:00402B2E		       mov     eax, [ebp+1F8h+flags]
.text:00402B31		       test    al, 40h
.text:00402B33		       jz      short loc_402B5A
.text:00402B35		       test    ax, 100h
.text:00402B39		       jz      short loc_402B41
.text:00402B3B		       mov     [ebp+1F8h+prefix], 2Dh
.text:00402B3F		       jmp     short loc_402B53
.text:00402B41 ; ---------------------------------------------------------------------------
.text:00402B41
.text:00402B41 loc_402B41:			       ; CODE XREF: __output_l+819j
.text:00402B41		       test    al, 1
.text:00402B43		       jz      short loc_402B4B
.text:00402B45		       mov     [ebp+1F8h+prefix], 2Bh
.text:00402B49		       jmp     short loc_402B53
.text:00402B4B ; ---------------------------------------------------------------------------
.text:00402B4B
.text:00402B4B loc_402B4B:			       ; CODE XREF: __output_l+823j
.text:00402B4B		       test    al, 2
.text:00402B4D		       jz      short loc_402B5A
.text:00402B4F		       mov     [ebp+1F8h+prefix], 20h
.text:00402B53
.text:00402B53 loc_402B53:			       ; CODE XREF: __output_l+81Fj
.text:00402B53					       ; __output_l+829j
.text:00402B53		       mov     [ebp+1F8h+prefixlen], 1
.text:00402B5A
.text:00402B5A loc_402B5A:			       ; CODE XREF: __output_l+813j
.text:00402B5A					       ; __output_l+82Dj
.text:00402B5A		       mov     ebx, [ebp+1F8h+fldwidth]
.text:00402B5D		       sub     ebx, [ebp+1F8h+radix]
.text:00402B60		       sub     ebx, [ebp+1F8h+prefixlen]
.text:00402B63		       test    byte ptr	[ebp+1F8h+flags], 0Ch
.text:00402B67		       jnz     short loc_402B7A
.text:00402B69		       push    [ebp+1F8h+f]    ; f
.text:00402B6C		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402B6F		       push    ebx	       ; num
.text:00402B70		       push    20h	       ; ch
.text:00402B72		       call    write_multi_char
.text:00402B77		       add     esp, 0Ch
.text:00402B7A
.text:00402B7A loc_402B7A:			       ; CODE XREF: __output_l+847j
.text:00402B7A		       push    [ebp+1F8h+prefixlen] ; len
.text:00402B7D		       mov     edi, [ebp+1F8h+f] ; f
.text:00402B80		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402B83		       lea     ecx, [ebp+1F8h+prefix] ;	string
.text:00402B86		       call    write_string
.text:00402B8B		       test    byte ptr	[ebp+1F8h+flags], 8
.text:00402B8F		       pop     ecx
.text:00402B90		       jz      short loc_402BA7
.text:00402B92		       test    byte ptr	[ebp+1F8h+flags], 4
.text:00402B96		       jnz     short loc_402BA7
.text:00402B98		       push    edi	       ; f
.text:00402B99		       push    ebx	       ; num
.text:00402B9A		       push    30h	       ; ch
.text:00402B9C		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402B9F		       call    write_multi_char
.text:00402BA4		       add     esp, 0Ch
.text:00402BA7
.text:00402BA7 loc_402BA7:			       ; CODE XREF: __output_l+870j
.text:00402BA7					       ; __output_l+876j
.text:00402BA7		       cmp     [ebp+1F8h+bufferiswide],	0
.text:00402BAB		       mov     eax, [ebp+1F8h+radix]
.text:00402BAE		       jz      short loc_402C01
.text:00402BB0		       test    eax, eax
.text:00402BB2		       jle     short loc_402C01
.text:00402BB4		       mov     esi, dword ptr [ebp+1F8h+text]
.text:00402BB7		       mov     [ebp+1F8h+count], eax
.text:00402BBA
.text:00402BBA loc_402BBA:			       ; CODE XREF: __output_l+8D7j
.text:00402BBA		       movzx   eax, word ptr [esi]
.text:00402BBD		       dec     [ebp+1F8h+count]
.text:00402BC0		       push    eax	       ; wchar
.text:00402BC1		       push    6	       ; sizeInBytes
.text:00402BC3		       lea     eax, [ebp+1F8h+L_buffer]
.text:00402BC9		       push    eax	       ; dst
.text:00402BCA		       lea     eax, [ebp+1F8h+retval]
.text:00402BCD		       inc     esi
.text:00402BCE		       push    eax	       ; pRetValue
.text:00402BCF		       inc     esi
.text:00402BD0		       call    _wctomb_s
.text:00402BD5		       add     esp, 10h
.text:00402BD8		       test    eax, eax
.text:00402BDA		       jnz     short loc_402BFB
.text:00402BDC		       cmp     [ebp+1F8h+retval], eax
.text:00402BDF		       jz      short loc_402BFB
.text:00402BE1		       push    [ebp+1F8h+retval] ; len
.text:00402BE4		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402BE7		       lea     ecx, [ebp+1F8h+L_buffer]	; string
.text:00402BED		       call    write_string
.text:00402BF2		       cmp     [ebp+1F8h+count], 0
.text:00402BF6		       pop     ecx
.text:00402BF7		       jnz     short loc_402BBA
.text:00402BF9		       jmp     short loc_402C0E
.text:00402BFB ; ---------------------------------------------------------------------------
.text:00402BFB
.text:00402BFB loc_402BFB:			       ; CODE XREF: __output_l+8BAj
.text:00402BFB					       ; __output_l+8BFj
.text:00402BFB		       or      [ebp+1F8h+charsout], 0FFFFFFFFh
.text:00402BFF		       jmp     short loc_402C0E
.text:00402C01 ; ---------------------------------------------------------------------------
.text:00402C01
.text:00402C01 loc_402C01:			       ; CODE XREF: __output_l+88Ej
.text:00402C01					       ; __output_l+892j
.text:00402C01		       mov     ecx, dword ptr [ebp+1F8h+text] ;	string
.text:00402C04		       push    eax	       ; len
.text:00402C05		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402C08		       call    write_string
.text:00402C0D		       pop     ecx
.text:00402C0E
.text:00402C0E loc_402C0E:			       ; CODE XREF: __output_l+8D9j
.text:00402C0E					       ; __output_l+8DFj
.text:00402C0E		       cmp     [ebp+1F8h+charsout], 0
.text:00402C12		       jl      short loc_402C29
.text:00402C14		       test    byte ptr	[ebp+1F8h+flags], 4
.text:00402C18		       jz      short loc_402C29
.text:00402C1A		       push    edi	       ; f
.text:00402C1B		       push    ebx	       ; num
.text:00402C1C		       push    20h	       ; ch
.text:00402C1E		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402C21		       call    write_multi_char
.text:00402C26		       add     esp, 0Ch
.text:00402C29
.text:00402C29 loc_402C29:			       ; CODE XREF: __output_l+57Cj
.text:00402C29					       ; __output_l+808j ...
.text:00402C29		       cmp     [ebp+1F8h+heapbuf], 0
.text:00402C2D		       jz      short loc_402C3C	; default
.text:00402C2F		       push    [ebp+1F8h+heapbuf] ; pBlock
.text:00402C32		       call    _free
.text:00402C37		       and     [ebp+1F8h+heapbuf], 0
.text:00402C3B		       pop     ecx
.text:00402C3C
.text:00402C3C loc_402C3C:			       ; CODE XREF: __output_l+19Cj
.text:00402C3C					       ; __output_l+1BFj ...
.text:00402C3C		       mov     ebx, [ebp+1F8h+var_240] ; default
.text:00402C3F		       mov     al, [ebx]
.text:00402C41		       test    al, al
.text:00402C43		       mov     [ebp+1F8h+var_211], al
.text:00402C46		       jz      short loc_402C6C
.text:00402C48		       mov     ecx, [ebp+1F8h+state]
.text:00402C4B		       mov     edi, [ebp+1F8h+var_224]
.text:00402C4E		       mov     dl, al
.text:00402C50		       jmp     loc_40247E
.text:00402C55 ; ---------------------------------------------------------------------------
.text:00402C55
.text:00402C55 loc_402C55:			       ; CODE XREF: __output_l+36Ej
.text:00402C55					       ; __output_l+55Bj
.text:00402C55		       call    __errno
.text:00402C5A		       mov     dword ptr [eax],	16h
.text:00402C60		       xor     eax, eax
.text:00402C62		       push    eax
.text:00402C63		       push    eax
.text:00402C64		       push    eax
.text:00402C65		       push    eax
.text:00402C66		       push    eax
.text:00402C67		       jmp     loc_402390
.text:00402C6C ; ---------------------------------------------------------------------------
.text:00402C6C
.text:00402C6C loc_402C6C:			       ; CODE XREF: __output_l+158j
.text:00402C6C					       ; __output_l+166j ...
.text:00402C6C		       cmp     [ebp+1F8h+_loc_update.updated], 0
.text:00402C70		       jz      short loc_402C79
.text:00402C72		       mov     eax, [ebp+1F8h+_loc_update.ptd]
.text:00402C75		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00402C79
.text:00402C79 loc_402C79:			       ; CODE XREF: __output_l+950j
.text:00402C79		       mov     eax, [ebp+1F8h+charsout]
.text:00402C7C
.text:00402C7C loc_402C7C:			       ; CODE XREF: __output_l+88j
.text:00402C7C		       mov     ecx, [ebp+1F8h+var_4]
.text:00402C82		       pop     edi
.text:00402C83		       pop     esi
.text:00402C84		       xor     ecx, ebp
.text:00402C86		       pop     ebx
.text:00402C87		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00402C8C		       add     ebp, 1F8h
.text:00402C92		       leave
.text:00402C93		       retn
.text:00402C93 ; ---------------------------------------------------------------------------
.text:00402C94 off_402C94      dd offset NORMAL_STATE  ; DATA XREF: __output_l+1A2r
.text:00402C94		       dd offset $LN130	       ; jump table for	switch statement
.text:00402C94		       dd offset $LN129
.text:00402C94		       dd offset $LN121
.text:00402C94		       dd offset $LN117
.text:00402C94		       dd offset $LN116
.text:00402C94		       dd offset $LN112
.text:00402C94		       dd offset $LN96
.text:00402C94 __output_l      endp
.text:00402C94
.text:00402CB4
.text:00402CB4 ; =============== S U B R O U T I N E =======================================
.text:00402CB4
.text:00402CB4
.text:00402CB4 ; void __cdecl _initp_misc_invarg(void *enull)
.text:00402CB4 __initp_misc_invarg proc	near	       ; CODE XREF: __init_pointers+15p
.text:00402CB4
.text:00402CB4 enull	       = dword ptr  4
.text:00402CB4
.text:00402CB4		       mov     eax, [esp+enull]
.text:00402CB8		       mov     ___pInvalidArgHandler, eax
.text:00402CBD		       retn
.text:00402CBD __initp_misc_invarg endp
.text:00402CBD
.text:00402CBE
.text:00402CBE ; =============== S U B R O U T I N E =======================================
.text:00402CBE
.text:00402CBE ; Attributes: bp-based frame fpd=2A8h
.text:00402CBE
.text:00402CBE ; void __cdecl _invoke_watson(const wchar_t *pszExpression, const wchar_t *pszFunction, const wchar_t *pszFile, unsigned	int nLine, unsigned int	pReserved)
.text:00402CBE __invoke_watson proc near	       ; CODE XREF: _invoke_watson(ushort const	*,ushort const *,ushort	const *,uint,uint)+4j
.text:00402CBE					       ; __invalid_parameter+1Fj ...
.text:00402CBE
.text:00402CBE ExceptionRecord = _EXCEPTION_RECORD ptr -328h
.text:00402CBE ExceptionPointers= _EXCEPTION_POINTERS ptr -2D8h
.text:00402CBE ContextRecord   = _CONTEXT ptr -2D0h
.text:00402CBE var_4	       = dword ptr -4
.text:00402CBE pszExpression   = dword ptr  8
.text:00402CBE pszFunction     = dword ptr  0Ch
.text:00402CBE pszFile	       = dword ptr  10h
.text:00402CBE nLine	       = dword ptr  14h
.text:00402CBE pReserved       = dword ptr  18h
.text:00402CBE
.text:00402CBE		       push    ebp
.text:00402CBF		       lea     ebp, [esp-2A8h]
.text:00402CC6		       sub     esp, 328h
.text:00402CCC		       mov     eax, ___security_cookie
.text:00402CD1		       xor     eax, ebp
.text:00402CD3		       mov     [ebp+2A8h+var_4], eax
.text:00402CD9		       push    esi
.text:00402CDA		       mov     [ebp+2A8h+ContextRecord._Eax], eax
.text:00402CE0		       mov     [ebp+2A8h+ContextRecord._Ecx], ecx
.text:00402CE6		       mov     [ebp+2A8h+ContextRecord._Edx], edx
.text:00402CEC		       mov     [ebp+2A8h+ContextRecord._Ebx], ebx
.text:00402CEF		       mov     [ebp+2A8h+ContextRecord._Esi], esi
.text:00402CF2		       mov     [ebp+2A8h+ContextRecord._Edi], edi
.text:00402CF5		       mov     word ptr	[ebp+2A8h+ContextRecord.SegSs],	ss
.text:00402CFC		       mov     word ptr	[ebp+2A8h+ContextRecord.SegCs],	cs
.text:00402D03		       mov     word ptr	[ebp+2A8h+ContextRecord.SegDs],	ds
.text:00402D07		       mov     word ptr	[ebp+2A8h+ContextRecord.SegEs],	es
.text:00402D0B		       mov     word ptr	[ebp+2A8h+ContextRecord.SegFs],	fs
.text:00402D0F		       mov     word ptr	[ebp+2A8h+ContextRecord.SegGs],	gs
.text:00402D13		       pushf
.text:00402D14		       pop     [ebp+2A8h+ContextRecord.EFlags]
.text:00402D1A		       mov     esi, [ebp+2ACh]
.text:00402D20		       lea     eax, [ebp+2ACh]
.text:00402D26		       mov     [ebp+2A8h+ContextRecord._Esp], eax
.text:00402D2C		       mov     [ebp+2A8h+ContextRecord.ContextFlags], 10001h
.text:00402D33		       mov     [ebp+2A8h+ContextRecord._Eip], esi
.text:00402D39		       mov     eax, [eax-4]
.text:00402D3C		       push    50h	       ; count
.text:00402D3E		       mov     [ebp+2A8h+ContextRecord._Ebp], eax
.text:00402D44		       lea     eax, [ebp+2A8h+ExceptionRecord]
.text:00402D47		       push    0	       ; value
.text:00402D49		       push    eax	       ; dst
.text:00402D4A		       call    _memset
.text:00402D4F		       lea     eax, [ebp+2A8h+ExceptionRecord]
.text:00402D52		       mov     [ebp+2A8h+ExceptionPointers.ExceptionRecord], eax
.text:00402D55		       lea     eax, [ebp+2A8h+ContextRecord]
.text:00402D58		       add     esp, 0Ch
.text:00402D5B		       mov     [ebp+2A8h+ExceptionRecord.ExceptionCode], 0C000000Dh
.text:00402D62		       mov     [ebp+2A8h+ExceptionRecord.ExceptionAddress], esi
.text:00402D65		       mov     [ebp+2A8h+ExceptionPointers.ContextRecord], eax
.text:00402D68		       call    ds:__imp__IsDebuggerPresent@0 ; IsDebuggerPresent()
.text:00402D6E		       push    0	       ; lpTopLevelExceptionFilter
.text:00402D70		       mov     esi, eax
.text:00402D72		       call    ds:__imp__SetUnhandledExceptionFilter@4 ; SetUnhandledExceptionFilter(x)
.text:00402D78		       lea     eax, [ebp+2A8h+ExceptionPointers]
.text:00402D7B		       push    eax	       ; ExceptionInfo
.text:00402D7C		       call    ds:__imp__UnhandledExceptionFilter@4 ; UnhandledExceptionFilter(x)
.text:00402D82		       test    eax, eax
.text:00402D84		       jnz     short loc_402D92
.text:00402D86		       test    esi, esi
.text:00402D88		       jnz     short loc_402D92
.text:00402D8A		       push    2	       ; _Reserved
.text:00402D8C		       call    __crt_debugger_hook
.text:00402D91		       pop     ecx
.text:00402D92
.text:00402D92 loc_402D92:			       ; CODE XREF: __invoke_watson+C6j
.text:00402D92					       ; __invoke_watson+CAj
.text:00402D92		       push    0C000000Dh      ; uExitCode
.text:00402D97		       call    ds:__imp__GetCurrentProcess@0 ; GetCurrentProcess()
.text:00402D9D		       push    eax	       ; hProcess
.text:00402D9E		       call    ds:__imp__TerminateProcess@8 ; TerminateProcess(x,x)
.text:00402DA4		       mov     ecx, [ebp+2A8h+var_4]
.text:00402DAA		       xor     ecx, ebp
.text:00402DAC		       pop     esi
.text:00402DAD		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00402DB2		       add     ebp, 2A8h
.text:00402DB8		       leave
.text:00402DB9		       retn
.text:00402DB9 __invoke_watson endp
.text:00402DB9
.text:00402DBA
.text:00402DBA ; =============== S U B R O U T I N E =======================================
.text:00402DBA
.text:00402DBA
.text:00402DBA ; void (__cdecl *__cdecl	_set_invalid_parameter_handler(void (__cdecl *pNew)(const wchar_t *, const wchar_t *, const wchar_t *, unsigned	int, unsigned int)))(const wchar_t *, const wchar_t *, const wchar_t *,	unsigned int, unsigned int)
.text:00402DBA __set_invalid_parameter_handler proc near
.text:00402DBA
.text:00402DBA pNew	       = dword ptr  4
.text:00402DBA
.text:00402DBA		       push    esi
.text:00402DBB		       push    ___pInvalidArgHandler ; codedptr
.text:00402DC1		       call    __decode_pointer
.text:00402DC6		       push    [esp+8+pNew]    ; ptr
.text:00402DCA		       mov     esi, eax
.text:00402DCC		       call    __encode_pointer
.text:00402DD1		       pop     ecx
.text:00402DD2		       pop     ecx
.text:00402DD3		       mov     ___pInvalidArgHandler, eax
.text:00402DD8		       mov     eax, esi
.text:00402DDA		       pop     esi
.text:00402DDB		       retn
.text:00402DDB __set_invalid_parameter_handler endp
.text:00402DDB
.text:00402DDC
.text:00402DDC ; =============== S U B R O U T I N E =======================================
.text:00402DDC
.text:00402DDC
.text:00402DDC ; void (__cdecl *__cdecl	_get_invalid_parameter_handler())(const	wchar_t	*, const wchar_t *, const wchar_t *, unsigned int, unsigned int)
.text:00402DDC __get_invalid_parameter_handler proc near
.text:00402DDC		       push    ___pInvalidArgHandler ; codedptr
.text:00402DE2		       call    __decode_pointer
.text:00402DE7		       pop     ecx
.text:00402DE8		       retn
.text:00402DE8 __get_invalid_parameter_handler endp
.text:00402DE8
.text:00402DE9
.text:00402DE9 ; =============== S U B R O U T I N E =======================================
.text:00402DE9
.text:00402DE9 ; Attributes: bp-based frame
.text:00402DE9
.text:00402DE9 ; void __cdecl _invoke_watson(const unsigned __int16 *pszExpression, const unsigned __int16 *pszFunction, const unsigned	__int16	*pszFile, unsigned int nLine, unsigned int pReserved)
.text:00402DE9 ?_invoke_watson@@YAXPBG00II@Z proc near
.text:00402DE9
.text:00402DE9 pszExpression   = dword ptr  8
.text:00402DE9 pszFunction     = dword ptr  0Ch
.text:00402DE9 pszFile	       = dword ptr  10h
.text:00402DE9 nLine	       = dword ptr  14h
.text:00402DE9 pReserved       = dword ptr  18h
.text:00402DE9
.text:00402DE9		       push    ebp
.text:00402DEA		       mov     ebp, esp
.text:00402DEC		       pop     ebp
.text:00402DED		       jmp     __invoke_watson
.text:00402DED ?_invoke_watson@@YAXPBG00II@Z endp
.text:00402DED
.text:00402DF2
.text:00402DF2 ; =============== S U B R O U T I N E =======================================
.text:00402DF2
.text:00402DF2 ; Attributes: bp-based frame
.text:00402DF2
.text:00402DF2 ; void __cdecl _invalid_parameter(const wchar_t *pszExpression, const wchar_t *pszFunction, const wchar_t *pszFile, unsigned int	nLine, unsigned	int pReserved)
.text:00402DF2 __invalid_parameter proc	near	       ; CODE XREF: _printf+2Ap
.text:00402DF2					       ; __get_osplatform+1Bp ...
.text:00402DF2
.text:00402DF2 pszExpression   = dword ptr  8
.text:00402DF2 pszFunction     = dword ptr  0Ch
.text:00402DF2 pszFile	       = dword ptr  10h
.text:00402DF2 nLine	       = dword ptr  14h
.text:00402DF2 pReserved       = dword ptr  18h
.text:00402DF2
.text:00402DF2		       push    ebp
.text:00402DF3		       mov     ebp, esp
.text:00402DF5		       push    ___pInvalidArgHandler ; codedptr
.text:00402DFB		       call    __decode_pointer
.text:00402E00		       test    eax, eax
.text:00402E02		       pop     ecx
.text:00402E03		       jz      short loc_402E08
.text:00402E05		       pop     ebp
.text:00402E06		       jmp     eax
.text:00402E08 ; ---------------------------------------------------------------------------
.text:00402E08
.text:00402E08 loc_402E08:			       ; CODE XREF: __invalid_parameter+11j
.text:00402E08		       push    2	       ; _Reserved
.text:00402E0A		       call    __crt_debugger_hook
.text:00402E0F		       pop     ecx
.text:00402E10		       pop     ebp
.text:00402E11		       jmp     __invoke_watson
.text:00402E11 __invalid_parameter endp
.text:00402E11
.text:00402E16
.text:00402E16 ; =============== S U B R O U T I N E =======================================
.text:00402E16
.text:00402E16
.text:00402E16 __invalid_parameter_noinfo proc near
.text:00402E16		       xor     eax, eax
.text:00402E18		       push    eax	       ; pReserved
.text:00402E19		       push    eax	       ; nLine
.text:00402E1A		       push    eax	       ; pszFile
.text:00402E1B		       push    eax	       ; pszFunction
.text:00402E1C		       push    eax	       ; pszExpression
.text:00402E1D		       call    __invalid_parameter
.text:00402E22		       add     esp, 14h
.text:00402E25		       retn
.text:00402E25 __invalid_parameter_noinfo endp
.text:00402E25
.text:00402E26
.text:00402E26 ; =============== S U B R O U T I N E =======================================
.text:00402E26
.text:00402E26 ; Attributes: bp-based frame
.text:00402E26
.text:00402E26 ; void __cdecl _invalid_parameter(const unsigned	__int16	*pszExpression,	const unsigned __int16 *pszFunction, const unsigned __int16 *pszFile, unsigned int nLine, unsigned int pReserved)
.text:00402E26 ?_invalid_parameter@@YAXPBG00II@Z proc near
.text:00402E26
.text:00402E26 pszExpression   = dword ptr  8
.text:00402E26 pszFunction     = dword ptr  0Ch
.text:00402E26 pszFile	       = dword ptr  10h
.text:00402E26 nLine	       = dword ptr  14h
.text:00402E26 pReserved       = dword ptr  18h
.text:00402E26
.text:00402E26		       push    ebp
.text:00402E27		       mov     ebp, esp
.text:00402E29		       pop     ebp
.text:00402E2A		       jmp     __invalid_parameter
.text:00402E2A ?_invalid_parameter@@YAXPBG00II@Z endp
.text:00402E2A
.text:00402E2F
.text:00402E2F ; =============== S U B R O U T I N E =======================================
.text:00402E2F
.text:00402E2F
.text:00402E2F ; int __cdecl _get_errno_from_oserr(unsigned int	oserrno)
.text:00402E2F __get_errno_from_oserr proc near	       ; CODE XREF: _free+80p
.text:00402E2F					       ; __dosmaperr+Dp ...
.text:00402E2F
.text:00402E2F oserrno	       = dword ptr  4
.text:00402E2F
.text:00402E2F		       mov     eax, [esp+oserrno]
.text:00402E33		       xor     ecx, ecx
.text:00402E35
.text:00402E35 loc_402E35:			       ; CODE XREF: __get_errno_from_oserr+13j
.text:00402E35		       cmp     eax, errtable.oscode[ecx*8]
.text:00402E3C		       jz      short loc_402E50
.text:00402E3E		       inc     ecx
.text:00402E3F		       cmp     ecx, 2Dh
.text:00402E42		       jb      short loc_402E35
.text:00402E44		       lea     ecx, [eax-13h]
.text:00402E47		       cmp     ecx, 11h
.text:00402E4A		       ja      short loc_402E58
.text:00402E4C		       push    0Dh
.text:00402E4E		       pop     eax
.text:00402E4F		       retn
.text:00402E50 ; ---------------------------------------------------------------------------
.text:00402E50
.text:00402E50 loc_402E50:			       ; CODE XREF: __get_errno_from_oserr+Dj
.text:00402E50		       mov     eax, errtable.errnocode[ecx*8]
.text:00402E57		       retn
.text:00402E58 ; ---------------------------------------------------------------------------
.text:00402E58
.text:00402E58 loc_402E58:			       ; CODE XREF: __get_errno_from_oserr+1Bj
.text:00402E58		       add     eax, 0FFFFFF44h
.text:00402E5D		       push    0Eh
.text:00402E5F		       pop     ecx
.text:00402E60		       cmp     ecx, eax
.text:00402E62		       sbb     eax, eax
.text:00402E64		       and     eax, ecx
.text:00402E66		       add     eax, 8
.text:00402E69		       retn
.text:00402E69 __get_errno_from_oserr endp
.text:00402E69
.text:00402E6A
.text:00402E6A ; =============== S U B R O U T I N E =======================================
.text:00402E6A
.text:00402E6A
.text:00402E6A ; int *__cdecl _errno()
.text:00402E6A __errno	       proc near	       ; CODE XREF: _printf+1Ap
.text:00402E6A					       ; __get_osplatform:loc_401598p ...
.text:00402E6A		       call    __getptd_noexit
.text:00402E6F		       test    eax, eax
.text:00402E71		       jnz     short loc_402E79
.text:00402E73		       mov     eax, offset ErrnoNoMem
.text:00402E78		       retn
.text:00402E79 ; ---------------------------------------------------------------------------
.text:00402E79
.text:00402E79 loc_402E79:			       ; CODE XREF: __errno+7j
.text:00402E79		       add     eax, 8
.text:00402E7C		       retn
.text:00402E7C __errno	       endp
.text:00402E7C
.text:00402E7D
.text:00402E7D ; =============== S U B R O U T I N E =======================================
.text:00402E7D
.text:00402E7D
.text:00402E7D ; unsigned int *__cdecl __doserrno()
.text:00402E7D ___doserrno     proc near	       ; CODE XREF: __dosmaperr+1p
.text:00402E7D					       ; __set_doserrno:loc_402F00p ...
.text:00402E7D		       call    __getptd_noexit
.text:00402E82		       test    eax, eax
.text:00402E84		       jnz     short loc_402E8C
.text:00402E86		       mov     eax, offset DoserrorNoMem
.text:00402E8B		       retn
.text:00402E8C ; ---------------------------------------------------------------------------
.text:00402E8C
.text:00402E8C loc_402E8C:			       ; CODE XREF: ___doserrno+7j
.text:00402E8C		       add     eax, 0Ch
.text:00402E8F		       retn
.text:00402E8F ___doserrno     endp
.text:00402E8F
.text:00402E90
.text:00402E90 ; =============== S U B R O U T I N E =======================================
.text:00402E90
.text:00402E90
.text:00402E90 ; void __cdecl _dosmaperr(unsigned int oserrno)
.text:00402E90 __dosmaperr     proc near	       ; CODE XREF: __write_nolock+5CCp
.text:00402E90					       ; __lseeki64_nolock+58p	...
.text:00402E90
.text:00402E90 oserrno	       = dword ptr  4
.text:00402E90
.text:00402E90		       push    esi
.text:00402E91		       call    ___doserrno
.text:00402E96		       mov     ecx, [esp+4+oserrno]
.text:00402E9A		       push    ecx	       ; oserrno
.text:00402E9B		       mov     [eax], ecx
.text:00402E9D		       call    __get_errno_from_oserr
.text:00402EA2		       pop     ecx
.text:00402EA3		       mov     esi, eax
.text:00402EA5		       call    __errno
.text:00402EAA		       mov     [eax], esi
.text:00402EAC		       pop     esi
.text:00402EAD		       retn
.text:00402EAD __dosmaperr     endp
.text:00402EAD
.text:00402EAE
.text:00402EAE ; =============== S U B R O U T I N E =======================================
.text:00402EAE
.text:00402EAE
.text:00402EAE ; int __cdecl _set_errno(int value)
.text:00402EAE __set_errno     proc near
.text:00402EAE
.text:00402EAE value	       = dword ptr  4
.text:00402EAE
.text:00402EAE		       call    __getptd_noexit
.text:00402EB3		       test    eax, eax
.text:00402EB5		       jnz     short loc_402EBB
.text:00402EB7		       push    0Ch
.text:00402EB9		       pop     eax
.text:00402EBA		       retn
.text:00402EBB ; ---------------------------------------------------------------------------
.text:00402EBB
.text:00402EBB loc_402EBB:			       ; CODE XREF: __set_errno+7j
.text:00402EBB		       call    __errno
.text:00402EC0		       mov     ecx, [esp+value]
.text:00402EC4		       mov     [eax], ecx
.text:00402EC6		       xor     eax, eax
.text:00402EC8		       retn
.text:00402EC8 __set_errno     endp
.text:00402EC8
.text:00402EC9
.text:00402EC9 ; =============== S U B R O U T I N E =======================================
.text:00402EC9
.text:00402EC9
.text:00402EC9 ; int __cdecl _get_errno(int *pValue)
.text:00402EC9 __get_errno     proc near
.text:00402EC9
.text:00402EC9 pValue	       = dword ptr  4
.text:00402EC9
.text:00402EC9		       push    esi
.text:00402ECA		       mov     esi, [esp+4+pValue]
.text:00402ECE		       xor     eax, eax
.text:00402ED0		       cmp     esi, eax
.text:00402ED2		       jnz     short loc_402EE6
.text:00402ED4		       push    eax	       ; pReserved
.text:00402ED5		       push    eax	       ; nLine
.text:00402ED6		       push    eax	       ; pszFile
.text:00402ED7		       push    eax	       ; pszFunction
.text:00402ED8		       push    eax	       ; pszExpression
.text:00402ED9		       call    __invalid_parameter
.text:00402EDE		       add     esp, 14h
.text:00402EE1		       push    16h
.text:00402EE3		       pop     eax
.text:00402EE4		       pop     esi
.text:00402EE5		       retn
.text:00402EE6 ; ---------------------------------------------------------------------------
.text:00402EE6
.text:00402EE6 loc_402EE6:			       ; CODE XREF: __get_errno+9j
.text:00402EE6		       call    __errno
.text:00402EEB		       mov     eax, [eax]
.text:00402EED		       mov     [esi], eax
.text:00402EEF		       xor     eax, eax
.text:00402EF1		       pop     esi
.text:00402EF2		       retn
.text:00402EF2 __get_errno     endp
.text:00402EF2
.text:00402EF3
.text:00402EF3 ; =============== S U B R O U T I N E =======================================
.text:00402EF3
.text:00402EF3
.text:00402EF3 ; int __cdecl _set_doserrno(unsigned int	value)
.text:00402EF3 __set_doserrno  proc near
.text:00402EF3
.text:00402EF3 value	       = dword ptr  4
.text:00402EF3
.text:00402EF3		       call    __getptd_noexit
.text:00402EF8		       test    eax, eax
.text:00402EFA		       jnz     short loc_402F00
.text:00402EFC		       push    0Ch
.text:00402EFE		       pop     eax
.text:00402EFF		       retn
.text:00402F00 ; ---------------------------------------------------------------------------
.text:00402F00
.text:00402F00 loc_402F00:			       ; CODE XREF: __set_doserrno+7j
.text:00402F00		       call    ___doserrno
.text:00402F05		       mov     ecx, [esp+value]
.text:00402F09		       mov     [eax], ecx
.text:00402F0B		       xor     eax, eax
.text:00402F0D		       retn
.text:00402F0D __set_doserrno  endp
.text:00402F0D
.text:00402F0E
.text:00402F0E ; =============== S U B R O U T I N E =======================================
.text:00402F0E
.text:00402F0E
.text:00402F0E ; int __cdecl _get_doserrno(unsigned int	*pValue)
.text:00402F0E __get_doserrno  proc near
.text:00402F0E
.text:00402F0E pValue	       = dword ptr  4
.text:00402F0E
.text:00402F0E		       push    esi
.text:00402F0F		       mov     esi, [esp+4+pValue]
.text:00402F13		       xor     eax, eax
.text:00402F15		       cmp     esi, eax
.text:00402F17		       jnz     short loc_402F2B
.text:00402F19		       push    eax	       ; pReserved
.text:00402F1A		       push    eax	       ; nLine
.text:00402F1B		       push    eax	       ; pszFile
.text:00402F1C		       push    eax	       ; pszFunction
.text:00402F1D		       push    eax	       ; pszExpression
.text:00402F1E		       call    __invalid_parameter
.text:00402F23		       add     esp, 14h
.text:00402F26		       push    16h
.text:00402F28		       pop     eax
.text:00402F29		       pop     esi
.text:00402F2A		       retn
.text:00402F2B ; ---------------------------------------------------------------------------
.text:00402F2B
.text:00402F2B loc_402F2B:			       ; CODE XREF: __get_doserrno+9j
.text:00402F2B		       call    ___doserrno
.text:00402F30		       mov     eax, [eax]
.text:00402F32		       mov     [esi], eax
.text:00402F34		       xor     eax, eax
.text:00402F36		       pop     esi
.text:00402F37		       retn
.text:00402F37 __get_doserrno  endp
.text:00402F37
.text:00402F38 ; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4. PRESS KEYPAD "+" TO	EXPAND]
.text:00402F7D ; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4. PRESS KEYPAD "+" TO	EXPAND]
.text:00402F91		       align 10h
.text:00402FA0
.text:00402FA0 ; =============== S U B R O U T I N E =======================================
.text:00402FA0
.text:00402FA0
.text:00402FA0 ; void __usercall ValidateLocalCookies(_EH4_SCOPETABLE *ScopeTable<edi>,	char *FramePointer<esi>)
.text:00402FA0 ValidateLocalCookies proc near
.text:00402FA0 ScopeTable = edi
.text:00402FA0 FramePointer = esi
.text:00402FA0		       mov     eax, [ScopeTable]
.text:00402FA2		       cmp     eax, 0FFFFFFFEh
.text:00402FA5		       jz      short loc_402FB4
.text:00402FA7		       mov     ecx, [ScopeTable+4]
.text:00402FAA		       add     ecx, FramePointer
.text:00402FAC		       xor     ecx, [eax+FramePointer] ; cookie
.text:00402FAF		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00402FB4
.text:00402FB4 loc_402FB4:			       ; CODE XREF: ValidateLocalCookies+5j
.text:00402FB4		       mov     ecx, [ScopeTable+0Ch]
.text:00402FB7		       mov     eax, [ScopeTable+8]
.text:00402FBA		       add     ecx, FramePointer
.text:00402FBC		       xor     ecx, [eax+FramePointer]
.text:00402FBF		       jmp     @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00402FBF ValidateLocalCookies endp
.text:00402FBF
.text:00402FBF ; ---------------------------------------------------------------------------
.text:00402FC4		       align 10h
.text:00402FD0
.text:00402FD0 ; =============== S U B R O U T I N E =======================================
.text:00402FD0
.text:00402FD0
.text:00402FD0 ; _EXCEPTION_DISPOSITION	__cdecl	_except_handler4(_EXCEPTION_RECORD *ExceptionRecord, _EXCEPTION_REGISTRATION_RECORD *EstablisherFrame, _CONTEXT	*ContextRecord,	void *DispatcherContext)
.text:00402FD0 __except_handler4 proc near	       ; DATA XREF: __SEH_prolog4o
.text:00402FD0					       ; __IsNonwritableInCurrentImage+Ao
.text:00402FD0
.text:00402FD0 Revalidate      = byte ptr -15h
.text:00402FD0 EnclosingLevel  = dword ptr -14h
.text:00402FD0 Disposition     = dword ptr -10h
.text:00402FD0 ExceptionPointers= _EXCEPTION_POINTERS ptr -0Ch
.text:00402FD0 var_4	       = dword ptr -4
.text:00402FD0 ExceptionRecord = dword ptr  4
.text:00402FD0 EstablisherFrame= dword ptr  8
.text:00402FD0 ContextRecord   = dword ptr  0Ch
.text:00402FD0 DispatcherContext= dword	ptr  10h
.text:00402FD0
.text:00402FD0		       sub     esp, 14h
.text:00402FD3		       push    ebx
.text:00402FD4		       mov     ebx, [esp+18h+EstablisherFrame]
.text:00402FD8		       push    ebp
.text:00402FD9		       push    esi
.text:00402FDA		       mov     esi, [ebx+8]
.text:00402FDD		       xor     esi, ___security_cookie
.text:00402FE3		       push    edi
.text:00402FE4		       mov     eax, [esi]
.text:00402FE6		       cmp     eax, 0FFFFFFFEh
.text:00402FE9		       mov     byte ptr	[esp+24h+EnclosingLevel+3], 0
.text:00402FEE		       mov     [esp+24h+ExceptionPointers.ExceptionRecord], 1
.text:00402FF6		       lea     edi, [ebx+10h]
.text:00402FF9		       jz      short loc_403008
.text:00402FFB		       mov     ecx, [esi+4]
.text:00402FFE		       add     ecx, edi
.text:00403000		       xor     ecx, [eax+edi]  ; cookie
.text:00403003		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00403008
.text:00403008 loc_403008:			       ; CODE XREF: __except_handler4+29j
.text:00403008		       mov     ecx, [esi+0Ch]
.text:0040300B		       mov     eax, [esi+8]
.text:0040300E		       add     ecx, edi
.text:00403010		       xor     ecx, [eax+edi]  ; cookie
.text:00403013		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00403018		       mov     eax, [esp+24h+ExceptionRecord]
.text:0040301C		       test    byte ptr	[eax+4], 66h
.text:00403020		       jnz     loc_403145
.text:00403026		       mov     ebp, [ebx+0Ch]
.text:00403029		       cmp     ebp, 0FFFFFFFEh
.text:0040302C		       mov     ecx, [esp+24h+ContextRecord]
.text:00403030		       lea     edx, [esp+24h+ExceptionPointers.ContextRecord]
.text:00403034		       mov     [esp+24h+ExceptionPointers.ContextRecord], eax
.text:00403038		       mov     [esp+24h+var_4],	ecx
.text:0040303C		       mov     [ebx-4],	edx
.text:0040303F		       jz      short loc_40309F
.text:00403041
.text:00403041 loc_403041:			       ; CODE XREF: __except_handler4+A2j
.text:00403041		       lea     eax, [ebp+ebp*2+0]
.text:00403045		       mov     ecx, [esi+eax*4+14h]
.text:00403049		       test    ecx, ecx
.text:0040304B		       lea     ebx, [esi+eax*4+10h]
.text:0040304F		       mov     eax, [ebx]
.text:00403051		       mov     [esp+24h+Disposition], eax
.text:00403055		       jz      short loc_40306D
.text:00403057		       mov     edx, edi
.text:00403059		       call    @_EH4_CallFilterFunc@8 ;	_EH4_CallFilterFunc(x,x)
.text:0040305E		       test    eax, eax
.text:00403060		       mov     byte ptr	[esp+24h+EnclosingLevel+3], 1
.text:00403065		       jl      short loc_4030AB
.text:00403067		       jg      short loc_4030B5
.text:00403069		       mov     eax, [esp+24h+Disposition]
.text:0040306D
.text:0040306D loc_40306D:			       ; CODE XREF: __except_handler4+85j
.text:0040306D		       cmp     eax, 0FFFFFFFEh
.text:00403070		       mov     ebp, eax
.text:00403072		       jnz     short loc_403041
.text:00403074		       cmp     byte ptr	[esp+24h+EnclosingLevel+3], 0
.text:00403079		       jz      short loc_40309F
.text:0040307B
.text:0040307B loc_40307B:			       ; CODE XREF: __except_handler4+E3j
.text:0040307B					       ; __except_handler4+191j
.text:0040307B		       mov     eax, [esi]
.text:0040307D		       cmp     eax, 0FFFFFFFEh
.text:00403080		       jz      short loc_40308F
.text:00403082		       mov     ecx, [esi+4]
.text:00403085		       add     ecx, edi
.text:00403087		       xor     ecx, [eax+edi]  ; cookie
.text:0040308A		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040308F
.text:0040308F loc_40308F:			       ; CODE XREF: __except_handler4+B0j
.text:0040308F		       mov     ecx, [esi+0Ch]
.text:00403092		       mov     eax, [esi+8]
.text:00403095		       add     ecx, edi
.text:00403097		       xor     ecx, [eax+edi]  ; cookie
.text:0040309A		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040309F
.text:0040309F loc_40309F:			       ; CODE XREF: __except_handler4+6Fj
.text:0040309F					       ; __except_handler4+A9j	...
.text:0040309F		       mov     eax, [esp+24h+ExceptionPointers.ExceptionRecord]
.text:004030A3		       pop     edi
.text:004030A4		       pop     esi
.text:004030A5		       pop     ebp
.text:004030A6		       pop     ebx
.text:004030A7		       add     esp, 14h
.text:004030AA		       retn
.text:004030AB ; ---------------------------------------------------------------------------
.text:004030AB
.text:004030AB loc_4030AB:			       ; CODE XREF: __except_handler4+95j
.text:004030AB		       mov     [esp+24h+ExceptionPointers.ExceptionRecord], 0
.text:004030B3		       jmp     short loc_40307B
.text:004030B5 ; ---------------------------------------------------------------------------
.text:004030B5
.text:004030B5 loc_4030B5:			       ; CODE XREF: __except_handler4+97j
.text:004030B5		       mov     ecx, [esp+24h+ExceptionRecord]
.text:004030B9		       cmp     dword ptr [ecx],	0E06D7363h
.text:004030BF		       jnz     short loc_4030EB
.text:004030C1		       cmp     __pDestructExceptionObject, 0
.text:004030C8		       jz      short loc_4030EB
.text:004030CA		       push    offset __pDestructExceptionObject ; pTarget
.text:004030CF		       call    __IsNonwritableInCurrentImage
.text:004030D4		       add     esp, 4
.text:004030D7		       test    eax, eax
.text:004030D9		       jz      short loc_4030EB
.text:004030DB		       mov     edx, [esp+24h+ExceptionRecord]
.text:004030DF		       push    1
.text:004030E1		       push    edx
.text:004030E2		       call    __pDestructExceptionObject
.text:004030E8		       add     esp, 8
.text:004030EB
.text:004030EB loc_4030EB:			       ; CODE XREF: __except_handler4+EFj
.text:004030EB					       ; __except_handler4+F8j	...
.text:004030EB		       mov     ecx, [esp+24h+EstablisherFrame]
.text:004030EF		       call    @_EH4_GlobalUnwind@4 ; _EH4_GlobalUnwind(x)
.text:004030F4		       mov     eax, [esp+24h+EstablisherFrame]
.text:004030F8		       cmp     [eax+0Ch], ebp
.text:004030FB		       jz      short loc_403110
.text:004030FD		       push    offset ___security_cookie
.text:00403102		       push    edi
.text:00403103		       mov     edx, ebp
.text:00403105		       mov     ecx, eax
.text:00403107		       call    @_EH4_LocalUnwind@16 ; _EH4_LocalUnwind(x,x,x,x)
.text:0040310C		       mov     eax, [esp+1Ch+DispatcherContext]
.text:00403110
.text:00403110 loc_403110:			       ; CODE XREF: __except_handler4+12Bj
.text:00403110		       mov     ecx, [esp+1Ch+ExceptionPointers.ContextRecord]
.text:00403114		       mov     [eax+0Ch], ecx
.text:00403117		       mov     eax, [esi]
.text:00403119		       cmp     eax, 0FFFFFFFEh
.text:0040311C		       jz      short loc_40312B
.text:0040311E		       mov     ecx, [esi+4]
.text:00403121		       add     ecx, edi
.text:00403123		       xor     ecx, [eax+edi]  ; cookie
.text:00403126		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040312B
.text:0040312B loc_40312B:			       ; CODE XREF: __except_handler4+14Cj
.text:0040312B		       mov     ecx, [esi+0Ch]
.text:0040312E		       mov     edx, [esi+8]
.text:00403131		       add     ecx, edi
.text:00403133		       xor     ecx, [edx+edi]  ; cookie
.text:00403136		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040313B		       mov     ecx, [ebx+8]
.text:0040313E		       mov     edx, edi
.text:00403140		       jmp     @_EH4_TransferToHandler@8 ; _EH4_TransferToHandler(x,x)
.text:00403145 ; ---------------------------------------------------------------------------
.text:00403145
.text:00403145 loc_403145:			       ; CODE XREF: __except_handler4+50j
.text:00403145		       cmp     dword ptr [ebx+0Ch], 0FFFFFFFEh
.text:00403149		       jz      loc_40309F
.text:0040314F		       push    offset ___security_cookie
.text:00403154		       push    edi
.text:00403155		       mov     ecx, ebx
.text:00403157		       mov     edx, 0FFFFFFFEh
.text:0040315C		       call    @_EH4_LocalUnwind@16 ; _EH4_LocalUnwind(x,x,x,x)
.text:00403161		       jmp     loc_40307B
.text:00403161 __except_handler4 endp ;	sp-analysis failed
.text:00403161
.text:00403166
.text:00403166 ; =============== S U B R O U T I N E =======================================
.text:00403166
.text:00403166 ; Attributes: bp-based frame
.text:00403166
.text:00403166 ; int __cdecl vprintf_helper(int	(__cdecl *outfn)(_iobuf	*, const char *, localeinfo_struct *, char *), const char *format, localeinfo_struct *plocinfo,	char *ap)
.text:00403166 _vprintf_helper proc near	       ; CODE XREF: __vprintf_l+11p
.text:00403166					       ; __vprintf_s_l+11p ...
.text:00403166
.text:00403166 retval	       = dword ptr -20h
.text:00403166 stream	       = dword ptr -1Ch
.text:00403166 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00403166 outfn	       = dword ptr  8
.text:00403166 format	       = dword ptr  0Ch
.text:00403166 plocinfo	       = dword ptr  10h
.text:00403166 ap	       = dword ptr  14h
.text:00403166
.text:00403166		       push    10h
.text:00403168		       push    offset dword_420510
.text:0040316D		       call    __SEH_prolog4
.text:00403172		       call    ___iob_func
.text:00403177		       mov     esi, eax
.text:00403179		       add     esi, 20h
.text:0040317C		       mov     [ebp+stream], esi
.text:0040317F		       xor     eax, eax
.text:00403181		       xor     edi, edi
.text:00403183		       cmp     [ebp+format], edi
.text:00403186		       setnz   al
.text:00403189		       cmp     eax, edi
.text:0040318B		       jnz     short loc_4031AA
.text:0040318D		       call    __errno
.text:00403192		       mov     dword ptr [eax],	16h
.text:00403198		       push    edi	       ; pReserved
.text:00403199		       push    edi	       ; nLine
.text:0040319A		       push    edi	       ; pszFile
.text:0040319B		       push    edi	       ; pszFunction
.text:0040319C		       push    edi	       ; pszExpression
.text:0040319D		       call    __invalid_parameter
.text:004031A2		       add     esp, 14h
.text:004031A5		       or      eax, 0FFFFFFFFh
.text:004031A8		       jmp     short loc_4031E5
.text:004031AA ; ---------------------------------------------------------------------------
.text:004031AA
.text:004031AA loc_4031AA:			       ; CODE XREF: _vprintf_helper+25j
.text:004031AA		       push    esi	       ; pf
.text:004031AB		       call    __lock_file
.text:004031B0		       pop     ecx
.text:004031B1		       mov     [ebp+ms_exc.disabled], edi
.text:004031B4		       push    esi	       ; str
.text:004031B5		       call    __stbuf
.text:004031BA		       mov     edi, eax
.text:004031BC		       push    [ebp+ap]
.text:004031BF		       push    [ebp+plocinfo]
.text:004031C2		       push    [ebp+format]
.text:004031C5		       push    esi
.text:004031C6		       call    [ebp+outfn]
.text:004031C9		       mov     [ebp+retval], eax
.text:004031CC		       push    esi	       ; str
.text:004031CD		       push    edi	       ; flag
.text:004031CE		       call    __ftbuf
.text:004031D3		       add     esp, 1Ch
.text:004031D6		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004031DD		       call    $LN8
.text:004031E2
.text:004031E2 $LN9_1:
.text:004031E2		       mov     eax, [ebp+retval]
.text:004031E5
.text:004031E5 loc_4031E5:			       ; CODE XREF: _vprintf_helper+42j
.text:004031E5		       call    __SEH_epilog4
.text:004031EA		       retn
.text:004031EB ; ---------------------------------------------------------------------------
.text:004031EB
.text:004031EB $LN6_1:				       ; DATA XREF: .rdata:00420528o
.text:004031EB		       mov     esi, [ebp+stream]
.text:004031EE
.text:004031EE $LN8:				       ; CODE XREF: _vprintf_helper+77p
.text:004031EE		       push    esi	       ; pf
.text:004031EF		       call    __unlock_file
.text:004031F4		       pop     ecx
.text:004031F5
.text:004031F5 $LN7_1:
.text:004031F5		       retn
.text:004031F5 _vprintf_helper endp ; sp-analysis failed
.text:004031F5
.text:004031F6
.text:004031F6 ; =============== S U B R O U T I N E =======================================
.text:004031F6
.text:004031F6
.text:004031F6 ; int __cdecl _vprintf_l(const char *format, localeinfo_struct *plocinfo, char *ap)
.text:004031F6 __vprintf_l     proc near	       ; CODE XREF: __printf_l+Dp
.text:004031F6
.text:004031F6 format	       = dword ptr  4
.text:004031F6 plocinfo	       = dword ptr  8
.text:004031F6 ap	       = dword ptr  0Ch
.text:004031F6
.text:004031F6		       push    [esp+ap]	       ; ap
.text:004031FA		       push    [esp+4+plocinfo]	; plocinfo
.text:004031FE		       push    [esp+8+format]  ; format
.text:00403202		       push    offset __output_l ; outfn
.text:00403207		       call    _vprintf_helper
.text:0040320C		       add     esp, 10h
.text:0040320F		       retn
.text:0040320F __vprintf_l     endp
.text:0040320F
.text:00403210
.text:00403210 ; =============== S U B R O U T I N E =======================================
.text:00403210
.text:00403210
.text:00403210 ; int __cdecl _vprintf_s_l(const	char *format, localeinfo_struct	*plocinfo, char	*ap)
.text:00403210 __vprintf_s_l   proc near	       ; CODE XREF: __printf_s_l+Dp
.text:00403210					       ; _printf_s+Bp
.text:00403210
.text:00403210 format	       = dword ptr  4
.text:00403210 plocinfo	       = dword ptr  8
.text:00403210 ap	       = dword ptr  0Ch
.text:00403210
.text:00403210		       push    [esp+ap]	       ; ap
.text:00403214		       push    [esp+4+plocinfo]	; plocinfo
.text:00403218		       push    [esp+8+format]  ; format
.text:0040321C		       push    offset __output_s_l ; outfn
.text:00403221		       call    _vprintf_helper
.text:00403226		       add     esp, 10h
.text:00403229		       retn
.text:00403229 __vprintf_s_l   endp
.text:00403229
.text:0040322A
.text:0040322A ; =============== S U B R O U T I N E =======================================
.text:0040322A
.text:0040322A
.text:0040322A ; int __cdecl _vprintf_p_l(const	char *format, localeinfo_struct	*plocinfo, char	*ap)
.text:0040322A __vprintf_p_l   proc near	       ; CODE XREF: __printf_p_l+Dp
.text:0040322A					       ; __printf_p+Bp
.text:0040322A
.text:0040322A format	       = dword ptr  4
.text:0040322A plocinfo	       = dword ptr  8
.text:0040322A ap	       = dword ptr  0Ch
.text:0040322A
.text:0040322A		       push    [esp+ap]	       ; ap
.text:0040322E		       push    [esp+4+plocinfo]	; plocinfo
.text:00403232		       push    [esp+8+format]  ; format
.text:00403236		       push    offset __output_p_l ; outfn
.text:0040323B		       call    _vprintf_helper
.text:00403240		       add     esp, 10h
.text:00403243		       retn
.text:00403243 __vprintf_p_l   endp
.text:00403243
.text:00403244
.text:00403244 ; =============== S U B R O U T I N E =======================================
.text:00403244
.text:00403244
.text:00403244 ; int __cdecl vprintf(const char	*format, char *ap)
.text:00403244 _vprintf	       proc near
.text:00403244
.text:00403244 format	       = dword ptr  4
.text:00403244 ap	       = dword ptr  8
.text:00403244
.text:00403244		       push    [esp+ap]	       ; ap
.text:00403248		       push    0	       ; plocinfo
.text:0040324A		       push    [esp+8+format]  ; format
.text:0040324E		       push    offset __output_l ; outfn
.text:00403253		       call    _vprintf_helper
.text:00403258		       add     esp, 10h
.text:0040325B		       retn
.text:0040325B _vprintf	       endp
.text:0040325B
.text:0040325C
.text:0040325C ; =============== S U B R O U T I N E =======================================
.text:0040325C
.text:0040325C
.text:0040325C ; int __cdecl vprintf_s(const char *format, char	*ap)
.text:0040325C _vprintf_s      proc near
.text:0040325C
.text:0040325C format	       = dword ptr  4
.text:0040325C ap	       = dword ptr  8
.text:0040325C
.text:0040325C		       push    [esp+ap]	       ; ap
.text:00403260		       push    0	       ; plocinfo
.text:00403262		       push    [esp+8+format]  ; format
.text:00403266		       push    offset __output_s_l ; outfn
.text:0040326B		       call    _vprintf_helper
.text:00403270		       add     esp, 10h
.text:00403273		       retn
.text:00403273 _vprintf_s      endp
.text:00403273
.text:00403274
.text:00403274 ; =============== S U B R O U T I N E =======================================
.text:00403274
.text:00403274
.text:00403274 ; int __cdecl _vprintf_p(const char *format, char *ap)
.text:00403274 __vprintf_p     proc near
.text:00403274
.text:00403274 format	       = dword ptr  4
.text:00403274 ap	       = dword ptr  8
.text:00403274
.text:00403274		       push    [esp+ap]	       ; ap
.text:00403278		       push    0	       ; plocinfo
.text:0040327A		       push    [esp+8+format]  ; format
.text:0040327E		       push    offset __output_p_l ; outfn
.text:00403283		       call    _vprintf_helper
.text:00403288		       add     esp, 10h
.text:0040328B		       retn
.text:0040328B __vprintf_p     endp
.text:0040328B
.text:0040328C
.text:0040328C ; =============== S U B R O U T I N E =======================================
.text:0040328C
.text:0040328C ; Attributes: bp-based frame
.text:0040328C
.text:0040328C ; int __cdecl use_encode_pointer()
.text:0040328C _use_encode_pointer proc	near	       ; CODE XREF: __encode_pointer+45p
.text:0040328C					       ; __decode_pointer+45p ...
.text:0040328C
.text:0040328C bEncode	       = dword ptr -8
.text:0040328C winmajor	       = dword ptr -4
.text:0040328C
.text:0040328C		       push    ebp
.text:0040328D		       mov     ebp, esp
.text:0040328F		       push    ecx
.text:00403290		       push    ecx
.text:00403291		       push    ebx
.text:00403292		       push    esi
.text:00403293		       xor     esi, esi
.text:00403295		       lea     eax, [ebp+winmajor]
.text:00403298		       inc     esi
.text:00403299		       xor     ebx, ebx
.text:0040329B		       push    eax	       ; pValue
.text:0040329C		       mov     [ebp+bEncode], esi
.text:0040329F		       mov     [ebp+winmajor], ebx
.text:004032A2		       call    __get_winmajor
.text:004032A7		       cmp     [ebp+winmajor], 5
.text:004032AB		       pop     ecx
.text:004032AC		       jle     short loc_4032B2
.text:004032AE		       mov     eax, esi
.text:004032B0		       jmp     short loc_4032F4
.text:004032B2 ; ---------------------------------------------------------------------------
.text:004032B2
.text:004032B2 loc_4032B2:			       ; CODE XREF: _use_encode_pointer+20j
.text:004032B2		       push    edi
.text:004032B3		       push    ebx	       ; lpModuleName
.text:004032B4		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:004032BA		       mov     esi, [eax+3Ch]
.text:004032BD		       add     esi, eax
.text:004032BF		       cmp     [esi+6],	bx
.text:004032C3		       movzx   eax, word ptr [esi+14h]
.text:004032C7		       lea     edi, [eax+esi+18h]
.text:004032CB		       jbe     short loc_4032F0
.text:004032CD
.text:004032CD loc_4032CD:			       ; CODE XREF: _use_encode_pointer+5Cj
.text:004032CD		       push    edi	       ; str2
.text:004032CE		       push    offset str1     ; ".mixcrt"
.text:004032D3		       call    _strcmp
.text:004032D8		       test    eax, eax
.text:004032DA		       pop     ecx
.text:004032DB		       pop     ecx
.text:004032DC		       jz      short loc_4032EC
.text:004032DE		       movzx   eax, word ptr [esi+6]
.text:004032E2		       inc     ebx
.text:004032E3		       add     edi, 28h
.text:004032E6		       cmp     ebx, eax
.text:004032E8		       jb      short loc_4032CD
.text:004032EA		       jmp     short loc_4032F0
.text:004032EC ; ---------------------------------------------------------------------------
.text:004032EC
.text:004032EC loc_4032EC:			       ; CODE XREF: _use_encode_pointer+50j
.text:004032EC		       and     [ebp+bEncode], 0
.text:004032F0
.text:004032F0 loc_4032F0:			       ; CODE XREF: _use_encode_pointer+3Fj
.text:004032F0					       ; _use_encode_pointer+5Ej
.text:004032F0		       mov     eax, [ebp+bEncode]
.text:004032F3		       pop     edi
.text:004032F4
.text:004032F4 loc_4032F4:			       ; CODE XREF: _use_encode_pointer+24j
.text:004032F4		       pop     esi
.text:004032F5		       pop     ebx
.text:004032F6		       leave
.text:004032F7		       retn
.text:004032F7 _use_encode_pointer endp
.text:004032F7
.text:004032F8
.text:004032F8 ; =============== S U B R O U T I N E =======================================
.text:004032F8
.text:004032F8
.text:004032F8 ; void *__cdecl _encode_pointer(void *ptr)
.text:004032F8 __encode_pointer	proc near	       ; CODE XREF: __init_pointers+3Dp
.text:004032F8					       ; __set_invalid_parameter_handler+12p ...
.text:004032F8
.text:004032F8 ptr	       = dword ptr  4
.text:004032F8
.text:004032F8		       push    esi
.text:004032F9		       push    ___getvalueindex	; dwTlsIndex
.text:004032FF		       mov     esi, ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:00403305		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:00403307		       test    eax, eax
.text:00403309		       jz      short loc_40332C
.text:0040330B		       mov     eax, ___flsindex
.text:00403310		       cmp     eax, 0FFFFFFFFh
.text:00403313		       jz      short loc_40332C
.text:00403315		       push    eax
.text:00403316		       push    ___getvalueindex	; dwTlsIndex
.text:0040331C		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:0040331E		       call    eax
.text:00403320		       test    eax, eax
.text:00403322		       jz      short loc_40332C
.text:00403324		       mov     eax, [eax+1F8h]
.text:0040332A		       jmp     short loc_403352
.text:0040332C ; ---------------------------------------------------------------------------
.text:0040332C
.text:0040332C loc_40332C:			       ; CODE XREF: __encode_pointer+11j
.text:0040332C					       ; __encode_pointer+1Bj ...
.text:0040332C		       push    offset aKernel32_dll_0 ;	"KERNEL32.DLL"
.text:00403331		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00403337		       mov     esi, eax
.text:00403339		       test    esi, esi
.text:0040333B		       jz      short loc_403360
.text:0040333D		       call    _use_encode_pointer
.text:00403342		       test    eax, eax
.text:00403344		       jz      short loc_403360
.text:00403346		       push    offset aEncodepointer ; "EncodePointer"
.text:0040334B		       push    esi	       ; hModule
.text:0040334C		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00403352
.text:00403352 loc_403352:			       ; CODE XREF: __encode_pointer+32j
.text:00403352		       test    eax, eax
.text:00403354		       jz      short loc_403360
.text:00403356		       push    [esp+4+ptr]
.text:0040335A		       call    eax
.text:0040335C		       mov     [esp+4+ptr], eax
.text:00403360
.text:00403360 loc_403360:			       ; CODE XREF: __encode_pointer+43j
.text:00403360					       ; __encode_pointer+4Cj ...
.text:00403360		       mov     eax, [esp+4+ptr]
.text:00403364		       pop     esi
.text:00403365		       retn
.text:00403365 __encode_pointer	endp
.text:00403365
.text:00403366
.text:00403366 ; =============== S U B R O U T I N E =======================================
.text:00403366
.text:00403366
.text:00403366 ; void *__cdecl _encoded_null()
.text:00403366 __encoded_null  proc near	       ; CODE XREF: doexit+6Ep
.text:00403366					       ; __init_pointers+1p ...
.text:00403366		       push    0	       ; ptr
.text:00403368		       call    __encode_pointer
.text:0040336D		       pop     ecx
.text:0040336E		       retn
.text:0040336E __encoded_null  endp
.text:0040336E
.text:0040336F
.text:0040336F ; =============== S U B R O U T I N E =======================================
.text:0040336F
.text:0040336F
.text:0040336F ; void *__cdecl _decode_pointer(void *codedptr)
.text:0040336F __decode_pointer	proc near	       ; CODE XREF: __amsg_exit+14p
.text:0040336F					       ; doexit+3Dp ...
.text:0040336F
.text:0040336F codedptr	       = dword ptr  4
.text:0040336F
.text:0040336F		       push    esi
.text:00403370		       push    ___getvalueindex	; dwTlsIndex
.text:00403376		       mov     esi, ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:0040337C		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:0040337E		       test    eax, eax
.text:00403380		       jz      short loc_4033A3
.text:00403382		       mov     eax, ___flsindex
.text:00403387		       cmp     eax, 0FFFFFFFFh
.text:0040338A		       jz      short loc_4033A3
.text:0040338C		       push    eax
.text:0040338D		       push    ___getvalueindex	; dwTlsIndex
.text:00403393		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:00403395		       call    eax
.text:00403397		       test    eax, eax
.text:00403399		       jz      short loc_4033A3
.text:0040339B		       mov     eax, [eax+1FCh]
.text:004033A1		       jmp     short loc_4033C9
.text:004033A3 ; ---------------------------------------------------------------------------
.text:004033A3
.text:004033A3 loc_4033A3:			       ; CODE XREF: __decode_pointer+11j
.text:004033A3					       ; __decode_pointer+1Bj ...
.text:004033A3		       push    offset aKernel32_dll_0 ;	"KERNEL32.DLL"
.text:004033A8		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:004033AE		       mov     esi, eax
.text:004033B0		       test    esi, esi
.text:004033B2		       jz      short loc_4033D7
.text:004033B4		       call    _use_encode_pointer
.text:004033B9		       test    eax, eax
.text:004033BB		       jz      short loc_4033D7
.text:004033BD		       push    offset aDecodepointer ; "DecodePointer"
.text:004033C2		       push    esi	       ; hModule
.text:004033C3		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:004033C9
.text:004033C9 loc_4033C9:			       ; CODE XREF: __decode_pointer+32j
.text:004033C9		       test    eax, eax
.text:004033CB		       jz      short loc_4033D7
.text:004033CD		       push    [esp+4+codedptr]
.text:004033D1		       call    eax
.text:004033D3		       mov     [esp+4+codedptr], eax
.text:004033D7
.text:004033D7 loc_4033D7:			       ; CODE XREF: __decode_pointer+43j
.text:004033D7					       ; __decode_pointer+4Cj ...
.text:004033D7		       mov     eax, [esp+4+codedptr]
.text:004033DB		       pop     esi
.text:004033DC		       retn
.text:004033DC __decode_pointer	endp
.text:004033DC
.text:004033DD
.text:004033DD ; =============== S U B R O U T I N E =======================================
.text:004033DD
.text:004033DD
.text:004033DD ; unsigned int __stdcall	__crtTlsAlloc(void (__stdcall *lpCallBack)(void	*))
.text:004033DD ___crtTlsAlloc@4	proc near	       ; DATA XREF: __mtinit+8Ao
.text:004033DD
.text:004033DD lpCallBack      = dword ptr  4
.text:004033DD
.text:004033DD		       call    ds:__imp__TlsAlloc@0 ; TlsAlloc()
.text:004033E3		       retn    4
.text:004033E3 ___crtTlsAlloc@4	endp
.text:004033E3
.text:004033E6
.text:004033E6 ; =============== S U B R O U T I N E =======================================
.text:004033E6
.text:004033E6
.text:004033E6 ; void *__stdcall __fls_getvalue(unsigned int dwFlsIndex)
.text:004033E6 ___fls_getvalue@4 proc near
.text:004033E6
.text:004033E6 dwFlsIndex      = dword ptr  4
.text:004033E6
.text:004033E6		       push    [esp+dwFlsIndex]
.text:004033EA		       push    ___getvalueindex	; dwTlsIndex
.text:004033F0		       call    ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:004033F6		       call    eax
.text:004033F8		       retn    4
.text:004033F8 ___fls_getvalue@4 endp
.text:004033F8
.text:004033FB
.text:004033FB ; =============== S U B R O U T I N E =======================================
.text:004033FB
.text:004033FB
.text:004033FB ; unsigned int __cdecl __get_flsindex()
.text:004033FB ___get_flsindex proc near
.text:004033FB		       mov     eax, ___flsindex
.text:00403400		       retn
.text:00403400 ___get_flsindex endp
.text:00403400
.text:00403401
.text:00403401 ; =============== S U B R O U T I N E =======================================
.text:00403401
.text:00403401
.text:00403401 ; void *(__stdcall *__cdecl __set_flsgetvalue())(unsigned int)
.text:00403401 ___set_flsgetvalue proc near	       ; CODE XREF: __getptd_noexit+10p
.text:00403401		       push    esi
.text:00403402		       push    ___getvalueindex	; dwTlsIndex
.text:00403408		       call    ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:0040340E		       mov     esi, eax
.text:00403410		       test    esi, esi
.text:00403412		       jnz     short loc_40342F
.text:00403414		       push    _gpFlsGetValue  ; codedptr
.text:0040341A		       call    __decode_pointer
.text:0040341F		       pop     ecx
.text:00403420		       mov     esi, eax
.text:00403422		       push    esi	       ; lpTlsValue
.text:00403423		       push    ___getvalueindex	; dwTlsIndex
.text:00403429		       call    ds:__imp__TlsSetValue@8 ; TlsSetValue(x,x)
.text:0040342F
.text:0040342F loc_40342F:			       ; CODE XREF: ___set_flsgetvalue+11j
.text:0040342F		       mov     eax, esi
.text:00403431		       pop     esi
.text:00403432		       retn
.text:00403432 ___set_flsgetvalue endp
.text:00403432
.text:00403433
.text:00403433 ; =============== S U B R O U T I N E =======================================
.text:00403433
.text:00403433
.text:00403433 ; int __stdcall __fls_setvalue(unsigned int dwFlsIndex, void *lpFlsData)
.text:00403433 ___fls_setvalue@8 proc near
.text:00403433
.text:00403433 dwFlsIndex      = dword ptr  4
.text:00403433 lpFlsData       = dword ptr  8
.text:00403433
.text:00403433		       push    [esp+lpFlsData]
.text:00403437		       push    [esp+4+dwFlsIndex]
.text:0040343B		       push    _gpFlsSetValue  ; codedptr
.text:00403441		       call    __decode_pointer
.text:00403446		       pop     ecx
.text:00403447		       call    eax
.text:00403449		       retn    8
.text:00403449 ___fls_setvalue@8 endp
.text:00403449
.text:0040344C
.text:0040344C ; =============== S U B R O U T I N E =======================================
.text:0040344C
.text:0040344C
.text:0040344C __mtterm	       proc near	       ; CODE XREF: __mtinit+12p
.text:0040344C					       ; __mtinit:loc_4038E7p
.text:0040344C		       mov     eax, ___flsindex
.text:00403451		       cmp     eax, 0FFFFFFFFh
.text:00403454		       jz      short loc_40346C
.text:00403456		       push    eax
.text:00403457		       push    _gpFlsFree      ; codedptr
.text:0040345D		       call    __decode_pointer
.text:00403462		       pop     ecx
.text:00403463		       call    eax
.text:00403465		       or      ___flsindex, 0FFFFFFFFh
.text:0040346C
.text:0040346C loc_40346C:			       ; CODE XREF: __mtterm+8j
.text:0040346C		       mov     eax, ___getvalueindex
.text:00403471		       cmp     eax, 0FFFFFFFFh
.text:00403474		       jz      short loc_403484
.text:00403476		       push    eax	       ; dwTlsIndex
.text:00403477		       call    ds:__imp__TlsFree@4 ; TlsFree(x)
.text:0040347D		       or      ___getvalueindex, 0FFFFFFFFh
.text:00403484
.text:00403484 loc_403484:			       ; CODE XREF: __mtterm+28j
.text:00403484		       jmp     __mtdeletelocks
.text:00403484 __mtterm	       endp
.text:00403484
.text:00403489
.text:00403489 ; =============== S U B R O U T I N E =======================================
.text:00403489
.text:00403489 ; Attributes: noreturn bp-based frame
.text:00403489
.text:00403489 ; void __cdecl _initptd(_tiddata	*ptd, threadlocaleinfostruct *ptloci)
.text:00403489 __initptd       proc near	       ; CODE XREF: __getptd_noexit+4Dp
.text:00403489					       ; __mtinit+162p
.text:00403489
.text:00403489 hKernel32       = dword ptr -1Ch
.text:00403489 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00403489 ptd	       = dword ptr  8
.text:00403489 ptloci	       = dword ptr  0Ch
.text:00403489
.text:00403489		       push    0Ch
.text:0040348B		       push    offset dword_420530
.text:00403490		       call    __SEH_prolog4
.text:00403495		       push    offset aKernel32_dll_0 ;	"KERNEL32.DLL"
.text:0040349A		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:004034A0		       mov     [ebp+hKernel32],	eax
.text:004034A3		       mov     esi, [ebp+ptd]
.text:004034A6		       mov     dword ptr [esi+5Ch], offset __XcptActTab
.text:004034AD		       xor     edi, edi
.text:004034AF		       inc     edi
.text:004034B0		       mov     [esi+14h], edi
.text:004034B3		       test    eax, eax
.text:004034B5		       jz      short loc_4034E6
.text:004034B7		       call    _use_encode_pointer
.text:004034BC		       test    eax, eax
.text:004034BE		       jz      short loc_4034E6
.text:004034C0		       push    offset aEncodepointer ; "EncodePointer"
.text:004034C5		       push    [ebp+hKernel32] ; hModule
.text:004034C8		       mov     ebx, ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:004034CE		       call    ebx ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:004034D0		       mov     [esi+1F8h], eax
.text:004034D6		       push    offset aDecodepointer ; "DecodePointer"
.text:004034DB		       push    [ebp+hKernel32] ; hModule
.text:004034DE		       call    ebx ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:004034E0		       mov     [esi+1FCh], eax
.text:004034E6
.text:004034E6 loc_4034E6:			       ; CODE XREF: __initptd+2Cj
.text:004034E6					       ; __initptd+35j
.text:004034E6		       mov     [esi+70h], edi
.text:004034E9		       mov     byte ptr	[esi+0C8h], 43h
.text:004034F0		       mov     byte ptr	[esi+14Bh], 43h
.text:004034F7		       mov     eax, offset ___initialmbcinfo
.text:004034FC		       mov     [esi+68h], eax
.text:004034FF		       push    eax	       ; lpAddend
.text:00403500		       call    ds:__imp__InterlockedIncrement@4	; InterlockedIncrement(x)
.text:00403506		       push    0Ch	       ; locknum
.text:00403508		       call    __lock
.text:0040350D		       pop     ecx
.text:0040350E		       and     [ebp+ms_exc.disabled], 0
.text:00403512		       mov     eax, [ebp+ptloci]
.text:00403515		       mov     [esi+6Ch], eax
.text:00403518		       test    eax, eax
.text:0040351A		       jnz     short loc_403524
.text:0040351C		       mov     eax, ___ptlocinfo ; ___ptlocinfo
.text:00403521		       mov     [esi+6Ch], eax
.text:00403524
.text:00403524 loc_403524:			       ; CODE XREF: __initptd+91j
.text:00403524		       push    dword ptr [esi+6Ch] ; ptloci
.text:00403527		       call    ___addlocaleref
.text:0040352C		       pop     ecx
.text:0040352D		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00403534		       call    $LN8_0
.text:00403539 ; ---------------------------------------------------------------------------
.text:00403539
.text:00403539 $LN11:
.text:00403539		       call    __SEH_epilog4
.text:0040353E		       retn
.text:0040353F ; ---------------------------------------------------------------------------
.text:0040353F
.text:0040353F $LN8_0:				       ; CODE XREF: __initptd+ABp
.text:0040353F					       ; DATA XREF: .rdata:00420548o
.text:0040353F		       push    0Ch	       ; locknum
.text:00403541		       call    __unlock
.text:00403546		       pop     ecx
.text:00403547
.text:00403547 $LN9_2:
.text:00403547		       retn
.text:00403547 __initptd       endp
.text:00403547
.text:00403548
.text:00403548 ; =============== S U B R O U T I N E =======================================
.text:00403548
.text:00403548
.text:00403548 ; _tiddata *__cdecl _getptd_noexit()
.text:00403548 __getptd_noexit proc near	       ; CODE XREF: __errnop
.text:00403548					       ; ___doserrnop ...
.text:00403548		       push    esi
.text:00403549		       push    edi
.text:0040354A		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00403550		       push    ___flsindex
.text:00403556		       mov     edi, eax
.text:00403558		       call    ___set_flsgetvalue
.text:0040355D		       call    eax
.text:0040355F		       mov     esi, eax
.text:00403561		       test    esi, esi
.text:00403563		       jnz     short loc_4035B3
.text:00403565		       push    214h	       ; size
.text:0040356A		       push    1	       ; count
.text:0040356C		       call    __calloc_crt
.text:00403571		       mov     esi, eax
.text:00403573		       test    esi, esi
.text:00403575		       pop     ecx
.text:00403576		       pop     ecx
.text:00403577		       jz      short loc_4035B3
.text:00403579		       push    esi
.text:0040357A		       push    ___flsindex
.text:00403580		       push    _gpFlsSetValue  ; codedptr
.text:00403586		       call    __decode_pointer
.text:0040358B		       pop     ecx
.text:0040358C		       call    eax
.text:0040358E		       test    eax, eax
.text:00403590		       jz      short loc_4035AA
.text:00403592		       push    0	       ; ptloci
.text:00403594		       push    esi	       ; ptd
.text:00403595		       call    __initptd
.text:0040359A ; ---------------------------------------------------------------------------
.text:0040359A		       pop     ecx
.text:0040359B		       pop     ecx
.text:0040359C		       call    ds:__imp__GetCurrentThreadId@0 ;	GetCurrentThreadId()
.text:004035A2		       or      dword ptr [esi+4], 0FFFFFFFFh
.text:004035A6		       mov     [esi], eax
.text:004035A8		       jmp     short loc_4035B3
.text:004035AA ; ---------------------------------------------------------------------------
.text:004035AA
.text:004035AA loc_4035AA:			       ; CODE XREF: __getptd_noexit+48j
.text:004035AA		       push    esi	       ; pBlock
.text:004035AB		       call    _free
.text:004035B0		       pop     ecx
.text:004035B1		       xor     esi, esi
.text:004035B3
.text:004035B3 loc_4035B3:			       ; CODE XREF: __getptd_noexit+1Bj
.text:004035B3					       ; __getptd_noexit+2Fj ...
.text:004035B3		       push    edi	       ; dwErrCode
.text:004035B4		       call    ds:__imp__SetLastError@4	; SetLastError(x)
.text:004035BA		       pop     edi
.text:004035BB		       mov     eax, esi
.text:004035BD		       pop     esi
.text:004035BE		       retn
.text:004035BE __getptd_noexit endp
.text:004035BE
.text:004035BF
.text:004035BF ; =============== S U B R O U T I N E =======================================
.text:004035BF
.text:004035BF
.text:004035BF ; _tiddata *__cdecl _getptd()
.text:004035BF __getptd	       proc near	       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+Fp
.text:004035BF					       ; terminate(void)+Cp ...
.text:004035BF		       push    esi
.text:004035C0		       call    __getptd_noexit
.text:004035C5		       mov     esi, eax
.text:004035C7		       test    esi, esi
.text:004035C9		       jnz     short loc_4035D3
.text:004035CB		       push    10h	       ; rterrnum
.text:004035CD		       call    __amsg_exit
.text:004035D2		       pop     ecx
.text:004035D3
.text:004035D3 loc_4035D3:			       ; CODE XREF: __getptd+Aj
.text:004035D3		       mov     eax, esi
.text:004035D5		       pop     esi
.text:004035D6		       retn
.text:004035D6 __getptd	       endp
.text:004035D6
.text:004035D7
.text:004035D7 ; =============== S U B R O U T I N E =======================================
.text:004035D7
.text:004035D7 ; Attributes: bp-based frame
.text:004035D7
.text:004035D7 ; void __stdcall	_freefls(void *data)
.text:004035D7 __freefls@4     proc near	       ; CODE XREF: __freeptd+4Fp
.text:004035D7					       ; DATA XREF: __mtinit+115o
.text:004035D7
.text:004035D7 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004035D7 data	       = dword ptr  8
.text:004035D7
.text:004035D7		       push    8
.text:004035D9		       push    offset dword_420550
.text:004035DE		       call    __SEH_prolog4
.text:004035E3		       mov     esi, [ebp+data]
.text:004035E6		       test    esi, esi
.text:004035E8		       jz      loc_4036D8
.text:004035EE		       mov     eax, [esi+24h]
.text:004035F1		       test    eax, eax
.text:004035F3		       jz      short loc_4035FC
.text:004035F5		       push    eax	       ; pBlock
.text:004035F6		       call    _free
.text:004035FB		       pop     ecx
.text:004035FC
.text:004035FC loc_4035FC:			       ; CODE XREF: _freefls(x)+1Cj
.text:004035FC		       mov     eax, [esi+2Ch]
.text:004035FF		       test    eax, eax
.text:00403601		       jz      short loc_40360A
.text:00403603		       push    eax	       ; pBlock
.text:00403604		       call    _free
.text:00403609		       pop     ecx
.text:0040360A
.text:0040360A loc_40360A:			       ; CODE XREF: _freefls(x)+2Aj
.text:0040360A		       mov     eax, [esi+34h]
.text:0040360D		       test    eax, eax
.text:0040360F		       jz      short loc_403618
.text:00403611		       push    eax	       ; pBlock
.text:00403612		       call    _free
.text:00403617		       pop     ecx
.text:00403618
.text:00403618 loc_403618:			       ; CODE XREF: _freefls(x)+38j
.text:00403618		       mov     eax, [esi+3Ch]
.text:0040361B		       test    eax, eax
.text:0040361D		       jz      short loc_403626
.text:0040361F		       push    eax	       ; pBlock
.text:00403620		       call    _free
.text:00403625		       pop     ecx
.text:00403626
.text:00403626 loc_403626:			       ; CODE XREF: _freefls(x)+46j
.text:00403626		       mov     eax, [esi+44h]
.text:00403629		       test    eax, eax
.text:0040362B		       jz      short loc_403634
.text:0040362D		       push    eax	       ; pBlock
.text:0040362E		       call    _free
.text:00403633		       pop     ecx
.text:00403634
.text:00403634 loc_403634:			       ; CODE XREF: _freefls(x)+54j
.text:00403634		       mov     eax, [esi+48h]
.text:00403637		       test    eax, eax
.text:00403639		       jz      short loc_403642
.text:0040363B		       push    eax	       ; pBlock
.text:0040363C		       call    _free
.text:00403641		       pop     ecx
.text:00403642
.text:00403642 loc_403642:			       ; CODE XREF: _freefls(x)+62j
.text:00403642		       mov     eax, [esi+5Ch]
.text:00403645		       cmp     eax, offset __XcptActTab
.text:0040364A		       jz      short loc_403653
.text:0040364C		       push    eax	       ; pBlock
.text:0040364D		       call    _free
.text:00403652		       pop     ecx
.text:00403653
.text:00403653 loc_403653:			       ; CODE XREF: _freefls(x)+73j
.text:00403653		       push    0Dh	       ; locknum
.text:00403655		       call    __lock
.text:0040365A		       pop     ecx
.text:0040365B		       and     [ebp+ms_exc.disabled], 0
.text:0040365F		       mov     edi, [esi+68h]
.text:00403662		       test    edi, edi
.text:00403664		       jz      short loc_403680
.text:00403666		       push    edi	       ; lpAddend
.text:00403667		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040366D		       test    eax, eax
.text:0040366F		       jnz     short loc_403680
.text:00403671		       cmp     edi, offset ___initialmbcinfo
.text:00403677		       jz      short loc_403680
.text:00403679		       push    edi	       ; pBlock
.text:0040367A		       call    _free
.text:0040367F		       pop     ecx
.text:00403680
.text:00403680 loc_403680:			       ; CODE XREF: _freefls(x)+8Dj
.text:00403680					       ; _freefls(x)+98j ...
.text:00403680		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00403687		       call    $LN19_0
.text:0040368C
.text:0040368C $LN20:				       ; locknum
.text:0040368C		       push    0Ch
.text:0040368E		       call    __lock
.text:00403693		       pop     ecx
.text:00403694		       mov     [ebp+ms_exc.disabled], 1
.text:0040369B		       mov     edi, [esi+6Ch]
.text:0040369E		       test    edi, edi
.text:004036A0		       jz      short loc_4036C5
.text:004036A2		       push    edi	       ; ptloci
.text:004036A3		       call    ___removelocaleref
.text:004036A8		       pop     ecx
.text:004036A9		       cmp     edi, ___ptlocinfo ; ___ptlocinfo
.text:004036AF		       jz      short loc_4036C5
.text:004036B1		       cmp     edi, offset ___initiallocinfo
.text:004036B7		       jz      short loc_4036C5
.text:004036B9		       cmp     dword ptr [edi],	0
.text:004036BC		       jnz     short loc_4036C5
.text:004036BE		       push    edi	       ; ptloci
.text:004036BF		       call    ___freetlocinfo
.text:004036C4		       pop     ecx
.text:004036C5
.text:004036C5 loc_4036C5:			       ; CODE XREF: _freefls(x)+C9j
.text:004036C5					       ; _freefls(x)+D8j ...
.text:004036C5		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004036CC		       call    $LN23
.text:004036D1
.text:004036D1 $LN24:				       ; pBlock
.text:004036D1		       push    esi
.text:004036D2		       call    _free
.text:004036D7		       pop     ecx
.text:004036D8
.text:004036D8 loc_4036D8:			       ; CODE XREF: _freefls(x)+11j
.text:004036D8		       call    __SEH_epilog4
.text:004036DD		       retn    4
.text:004036E0 ; ---------------------------------------------------------------------------
.text:004036E0
.text:004036E0 $LN17_1:				       ; DATA XREF: .rdata:00420568o
.text:004036E0		       mov     esi, [ebp+data]
.text:004036E3
.text:004036E3 $LN19_0:				       ; CODE XREF: _freefls(x)+B0p
.text:004036E3		       push    0Dh	       ; locknum
.text:004036E5		       call    __unlock
.text:004036EA		       pop     ecx
.text:004036EB
.text:004036EB $LN18:
.text:004036EB		       retn
.text:004036EC ; ---------------------------------------------------------------------------
.text:004036EC
.text:004036EC $LN21:				       ; DATA XREF: .rdata:00420574o
.text:004036EC		       mov     esi, [ebp+data]
.text:004036EF
.text:004036EF $LN23:				       ; CODE XREF: _freefls(x)+F5p
.text:004036EF		       push    0Ch	       ; locknum
.text:004036F1		       call    __unlock
.text:004036F6		       pop     ecx
.text:004036F7
.text:004036F7 $LN22:
.text:004036F7		       retn
.text:004036F7 __freefls@4     endp ; sp-analysis failed
.text:004036F7
.text:004036F8
.text:004036F8 ; =============== S U B R O U T I N E =======================================
.text:004036F8
.text:004036F8
.text:004036F8 ; void __cdecl _freeptd(_tiddata	*ptd)
.text:004036F8 __freeptd       proc near
.text:004036F8
.text:004036F8 ptd	       = dword ptr  4
.text:004036F8
.text:004036F8		       cmp     ___flsindex, 0FFFFFFFFh
.text:004036FF		       jz      short loc_40374D
.text:00403701		       push    edi
.text:00403702		       mov     edi, [esp+4+ptd]
.text:00403706		       test    edi, edi
.text:00403708		       jnz     short loc_403730
.text:0040370A		       push    esi
.text:0040370B		       push    ___getvalueindex	; dwTlsIndex
.text:00403711		       mov     esi, ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:00403717		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:00403719		       test    eax, eax
.text:0040371B		       jz      short loc_40372F
.text:0040371D		       push    ___flsindex
.text:00403723		       push    ___getvalueindex	; dwTlsIndex
.text:00403729		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:0040372B		       call    eax
.text:0040372D		       mov     edi, eax
.text:0040372F
.text:0040372F loc_40372F:			       ; CODE XREF: __freeptd+23j
.text:0040372F		       pop     esi
.text:00403730
.text:00403730 loc_403730:			       ; CODE XREF: __freeptd+10j
.text:00403730		       push    0
.text:00403732		       push    ___flsindex
.text:00403738		       push    _gpFlsSetValue  ; codedptr
.text:0040373E		       call    __decode_pointer
.text:00403743		       pop     ecx
.text:00403744		       call    eax
.text:00403746		       push    edi	       ; data
.text:00403747		       call    __freefls@4     ; _freefls(x)
.text:0040374C		       pop     edi
.text:0040374D
.text:0040374D loc_40374D:			       ; CODE XREF: __freeptd+7j
.text:0040374D		       mov     eax, ___getvalueindex
.text:00403752		       cmp     eax, 0FFFFFFFFh
.text:00403755		       jz      short locret_403760
.text:00403757		       push    0	       ; lpTlsValue
.text:00403759		       push    eax	       ; dwTlsIndex
.text:0040375A		       call    ds:__imp__TlsSetValue@8 ; TlsSetValue(x,x)
.text:00403760
.text:00403760 locret_403760:			       ; CODE XREF: __freeptd+5Dj
.text:00403760		       retn
.text:00403760 __freeptd       endp
.text:00403760
.text:00403761 ; [00000006 BYTES: COLLAPSED FUNCTION ___threadid. PRESS	KEYPAD "+" TO EXPAND]
.text:00403767 ; [00000006 BYTES: COLLAPSED FUNCTION ___threadhandle. PRESS KEYPAD "+" TO EXPAND]
.text:0040376D
.text:0040376D ; =============== S U B R O U T I N E =======================================
.text:0040376D
.text:0040376D
.text:0040376D ; int __cdecl _mtinit()
.text:0040376D __mtinit	       proc near	       ; CODE XREF: __tmainCRTStartup:loc_40200Ap
.text:0040376D		       push    edi
.text:0040376E		       push    offset aKernel32_dll_0 ;	"KERNEL32.DLL"
.text:00403773		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00403779		       mov     edi, eax
.text:0040377B		       test    edi, edi
.text:0040377D		       jnz     short loc_403788
.text:0040377F		       call    __mtterm
.text:00403784		       xor     eax, eax
.text:00403786		       pop     edi
.text:00403787		       retn
.text:00403788 ; ---------------------------------------------------------------------------
.text:00403788
.text:00403788 loc_403788:			       ; CODE XREF: __mtinit+10j
.text:00403788		       push    esi
.text:00403789		       mov     esi, ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:0040378F		       push    offset aFlsalloc	; "FlsAlloc"
.text:00403794		       push    edi	       ; hModule
.text:00403795		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:00403797		       push    offset aFlsgetvalue ; "FlsGetValue"
.text:0040379C		       push    edi	       ; hModule
.text:0040379D		       mov     _gpFlsAlloc, eax
.text:004037A2		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:004037A4		       push    offset aFlssetvalue ; "FlsSetValue"
.text:004037A9		       push    edi	       ; hModule
.text:004037AA		       mov     _gpFlsGetValue, eax
.text:004037AF		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:004037B1		       push    offset aFlsfree ; "FlsFree"
.text:004037B6		       push    edi	       ; hModule
.text:004037B7		       mov     _gpFlsSetValue, eax
.text:004037BC		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:004037BE		       cmp     _gpFlsAlloc, 0
.text:004037C5		       mov     esi, ds:__imp__TlsSetValue@8 ; TlsSetValue(x,x)
.text:004037CB		       mov     _gpFlsFree, eax
.text:004037D0		       jz      short loc_4037E8
.text:004037D2		       cmp     _gpFlsGetValue, 0
.text:004037D9		       jz      short loc_4037E8
.text:004037DB		       cmp     _gpFlsSetValue, 0
.text:004037E2		       jz      short loc_4037E8
.text:004037E4		       test    eax, eax
.text:004037E6		       jnz     short loc_40380C
.text:004037E8
.text:004037E8 loc_4037E8:			       ; CODE XREF: __mtinit+63j
.text:004037E8					       ; __mtinit+6Cj ...
.text:004037E8		       mov     eax, ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:004037ED		       mov     _gpFlsGetValue, eax
.text:004037F2		       mov     eax, ds:__imp__TlsFree@4	; TlsFree(x)
.text:004037F7		       mov     _gpFlsAlloc, offset ___crtTlsAlloc@4 ; __crtTlsAlloc(x)
.text:00403801		       mov     _gpFlsSetValue, esi
.text:00403807		       mov     _gpFlsFree, eax
.text:0040380C
.text:0040380C loc_40380C:			       ; CODE XREF: __mtinit+79j
.text:0040380C		       call    ds:__imp__TlsAlloc@0 ; TlsAlloc()
.text:00403812		       cmp     eax, 0FFFFFFFFh
.text:00403815		       mov     ___getvalueindex, eax
.text:0040381A		       jz      loc_4038EC
.text:00403820		       push    _gpFlsGetValue  ; lpTlsValue
.text:00403826		       push    eax	       ; dwTlsIndex
.text:00403827		       call    esi ; TlsSetValue(x,x) ;	TlsSetValue(x,x)
.text:00403829		       test    eax, eax
.text:0040382B		       jz      loc_4038EC
.text:00403831		       call    __init_pointers
.text:00403836		       push    _gpFlsAlloc     ; ptr
.text:0040383C		       call    __encode_pointer
.text:00403841		       push    _gpFlsGetValue  ; ptr
.text:00403847		       mov     _gpFlsAlloc, eax
.text:0040384C		       call    __encode_pointer
.text:00403851		       push    _gpFlsSetValue  ; ptr
.text:00403857		       mov     _gpFlsGetValue, eax
.text:0040385C		       call    __encode_pointer
.text:00403861		       push    _gpFlsFree      ; ptr
.text:00403867		       mov     _gpFlsSetValue, eax
.text:0040386C		       call    __encode_pointer
.text:00403871		       add     esp, 10h
.text:00403874		       mov     _gpFlsFree, eax
.text:00403879		       call    __mtinitlocks
.text:0040387E		       test    eax, eax
.text:00403880		       jz      short loc_4038E7
.text:00403882		       push    offset __freefls@4 ; _freefls(x)
.text:00403887		       push    _gpFlsAlloc     ; codedptr
.text:0040388D		       call    __decode_pointer
.text:00403892		       pop     ecx
.text:00403893		       call    eax
.text:00403895		       cmp     eax, 0FFFFFFFFh
.text:00403898		       mov     ___flsindex, eax
.text:0040389D		       jz      short loc_4038E7
.text:0040389F		       push    214h	       ; size
.text:004038A4		       push    1	       ; count
.text:004038A6		       call    __calloc_crt
.text:004038AB		       mov     esi, eax
.text:004038AD		       test    esi, esi
.text:004038AF		       pop     ecx
.text:004038B0		       pop     ecx
.text:004038B1		       jz      short loc_4038E7
.text:004038B3		       push    esi
.text:004038B4		       push    ___flsindex
.text:004038BA		       push    _gpFlsSetValue  ; codedptr
.text:004038C0		       call    __decode_pointer
.text:004038C5		       pop     ecx
.text:004038C6		       call    eax
.text:004038C8		       test    eax, eax
.text:004038CA		       jz      short loc_4038E7
.text:004038CC		       push    0	       ; ptloci
.text:004038CE		       push    esi	       ; ptd
.text:004038CF		       call    __initptd
.text:004038D4 ; ---------------------------------------------------------------------------
.text:004038D4		       pop     ecx
.text:004038D5		       pop     ecx
.text:004038D6		       call    ds:__imp__GetCurrentThreadId@0 ;	GetCurrentThreadId()
.text:004038DC		       or      dword ptr [esi+4], 0FFFFFFFFh
.text:004038E0		       mov     [esi], eax
.text:004038E2		       xor     eax, eax
.text:004038E4		       inc     eax
.text:004038E5		       jmp     short loc_4038EE
.text:004038E7 ; ---------------------------------------------------------------------------
.text:004038E7
.text:004038E7 loc_4038E7:			       ; CODE XREF: __mtinit+113j
.text:004038E7					       ; __mtinit+130j	...
.text:004038E7		       call    __mtterm
.text:004038EC
.text:004038EC loc_4038EC:			       ; CODE XREF: __mtinit+ADj
.text:004038EC					       ; __mtinit+BEj
.text:004038EC		       xor     eax, eax
.text:004038EE
.text:004038EE loc_4038EE:			       ; CODE XREF: __mtinit+178j
.text:004038EE		       pop     esi
.text:004038EF		       pop     edi
.text:004038F0		       retn
.text:004038F0 __mtinit	       endp
.text:004038F0
.text:004038F1
.text:004038F1 ; =============== S U B R O U T I N E =======================================
.text:004038F1
.text:004038F1 ; Attributes: bp-based frame
.text:004038F1
.text:004038F1 ; void __cdecl _invoke_watson_if_error(int _ExpressionError, const wchar_t *_Expression,	const wchar_t *_Function, const	wchar_t	*_File,	unsigned int _Line, unsigned int _Reserved)
.text:004038F1 __invoke_watson_if_error	proc near
.text:004038F1
.text:004038F1 _ExpressionError= dword ptr  8
.text:004038F1 _Expression     = dword ptr  0Ch
.text:004038F1 _Function       = dword ptr  10h
.text:004038F1 _File	       = dword ptr  14h
.text:004038F1 _Line	       = dword ptr  18h
.text:004038F1 _Reserved       = dword ptr  1Ch
.text:004038F1
.text:004038F1		       push    ebp
.text:004038F2		       mov     ebp, esp
.text:004038F4		       cmp     [ebp+_ExpressionError], 0
.text:004038F8		       jz      short loc_403911
.text:004038FA		       push    [ebp+_Reserved] ; pReserved
.text:004038FD		       push    [ebp+_Line]     ; nLine
.text:00403900		       push    [ebp+_File]     ; pszFile
.text:00403903		       push    [ebp+_Function] ; pszFunction
.text:00403906		       push    [ebp+_Expression] ; pszExpression
.text:00403909		       call    __invoke_watson
.text:0040390E		       add     esp, 14h
.text:00403911
.text:00403911 loc_403911:			       ; CODE XREF: __invoke_watson_if_error+7j
.text:00403911		       pop     ebp
.text:00403912		       retn
.text:00403912 __invoke_watson_if_error	endp
.text:00403912
.text:00403913
.text:00403913 ; =============== S U B R O U T I N E =======================================
.text:00403913
.text:00403913
.text:00403913 ; void __cdecl _NMSG_WRITE(int rterrnum)
.text:00403913 __NMSG_WRITE    proc near	       ; CODE XREF: __amsg_exit+9p
.text:00403913					       ; __heap_alloc+10p ...
.text:00403913
.text:00403913 bytes_written   = dword ptr -8
.text:00403913 NumberOfBytesWritten= dword ptr -4
.text:00403913 rterrnum	       = dword ptr  4
.text:00403913
.text:00403913		       push    ecx
.text:00403914		       push    ebx
.text:00403915		       mov     ebx, [esp+8+rterrnum]
.text:00403919		       push    esi
.text:0040391A		       push    edi
.text:0040391B		       xor     esi, esi
.text:0040391D		       xor     edi, edi
.text:0040391F
.text:0040391F loc_40391F:			       ; CODE XREF: __NMSG_WRITE+19j
.text:0040391F		       cmp     ebx, rterrs.rterrno[edi*8]
.text:00403926		       jz      short loc_40392E
.text:00403928		       inc     edi
.text:00403929		       cmp     edi, 17h
.text:0040392C		       jb      short loc_40391F
.text:0040392E
.text:0040392E loc_40392E:			       ; CODE XREF: __NMSG_WRITE+13j
.text:0040392E		       cmp     edi, 17h
.text:00403931		       jnb     loc_403AAE
.text:00403937		       push    ebp
.text:00403938		       push    3	       ; em
.text:0040393A		       call    __set_error_mode
.text:0040393F		       cmp     eax, 1
.text:00403942		       pop     ecx
.text:00403943		       jz      loc_403A7A
.text:00403949		       push    3	       ; em
.text:0040394B		       call    __set_error_mode
.text:00403950		       test    eax, eax
.text:00403952		       pop     ecx
.text:00403953		       jnz     short loc_403962
.text:00403955		       cmp     ___app_type, 1
.text:0040395C		       jz      loc_403A7A
.text:00403962
.text:00403962 loc_403962:			       ; CODE XREF: __NMSG_WRITE+40j
.text:00403962		       cmp     ebx, 0FCh
.text:00403968		       jz      loc_403AAD
.text:0040396E		       push    offset _Src     ; "Runtime Error!\n\nProgram: "
.text:00403973		       mov     ebx, 314h
.text:00403978		       push    ebx	       ; _SizeInBytes
.text:00403979		       mov     ebp, offset outmsg
.text:0040397E		       push    ebp	       ; _Dst
.text:0040397F		       call    _strcpy_s
.text:00403984		       add     esp, 0Ch
.text:00403987		       test    eax, eax
.text:00403989		       jz      short loc_403998
.text:0040398B		       push    esi	       ; pReserved
.text:0040398C		       push    esi	       ; nLine
.text:0040398D		       push    esi	       ; pszFile
.text:0040398E		       push    esi	       ; pszFunction
.text:0040398F		       push    esi	       ; pszExpression
.text:00403990		       call    __invoke_watson
.text:00403995		       add     esp, 14h
.text:00403998
.text:00403998 loc_403998:			       ; CODE XREF: __NMSG_WRITE+76j
.text:00403998		       push    104h	       ; nSize
.text:0040399D		       mov     esi, (offset outmsg+19h)
.text:004039A2		       push    esi	       ; lpFilename
.text:004039A3		       push    0	       ; hModule
.text:004039A5		       mov     outmsg+11Dh, 0
.text:004039AC		       call    ds:__imp__GetModuleFileNameA@12 ; GetModuleFileNameA(x,x,x)
.text:004039B2		       test    eax, eax
.text:004039B4		       jnz     short loc_4039DC
.text:004039B6		       push    offset aProgramNameUnk ;	"<program name unknown>"
.text:004039BB		       push    2FBh	       ; _SizeInBytes
.text:004039C0		       push    esi	       ; _Dst
.text:004039C1		       call    _strcpy_s
.text:004039C6		       add     esp, 0Ch
.text:004039C9		       test    eax, eax
.text:004039CB		       jz      short loc_4039DC
.text:004039CD		       xor     eax, eax
.text:004039CF		       push    eax	       ; pReserved
.text:004039D0		       push    eax	       ; nLine
.text:004039D1		       push    eax	       ; pszFile
.text:004039D2		       push    eax	       ; pszFunction
.text:004039D3		       push    eax	       ; pszExpression
.text:004039D4		       call    __invoke_watson
.text:004039D9		       add     esp, 14h
.text:004039DC
.text:004039DC loc_4039DC:			       ; CODE XREF: __NMSG_WRITE+A1j
.text:004039DC					       ; __NMSG_WRITE+B8j
.text:004039DC		       push    esi	       ; buf
.text:004039DD		       call    _strlen
.text:004039E2		       inc     eax
.text:004039E3		       cmp     eax, 3Ch
.text:004039E6		       pop     ecx
.text:004039E7		       jbe     short loc_403A21
.text:004039E9		       push    esi	       ; buf
.text:004039EA		       call    _strlen
.text:004039EF		       sub     esi, 3Bh
.text:004039F2		       add     eax, esi
.text:004039F4		       push    3	       ; _Count
.text:004039F6		       mov     ecx, offset dword_42278C
.text:004039FB		       push    offset a___     ; "..."
.text:00403A00		       sub     ecx, eax
.text:00403A02		       push    ecx	       ; _SizeInBytes
.text:00403A03		       push    eax	       ; _Dst
.text:00403A04		       call    _strncpy_s
.text:00403A09		       add     esp, 14h
.text:00403A0C		       test    eax, eax
.text:00403A0E		       jz      short loc_403A21
.text:00403A10		       xor     esi, esi
.text:00403A12		       push    esi	       ; pReserved
.text:00403A13		       push    esi	       ; nLine
.text:00403A14		       push    esi	       ; pszFile
.text:00403A15		       push    esi	       ; pszFunction
.text:00403A16		       push    esi	       ; pszExpression
.text:00403A17		       call    __invoke_watson
.text:00403A1C		       add     esp, 14h
.text:00403A1F		       jmp     short loc_403A23
.text:00403A21 ; ---------------------------------------------------------------------------
.text:00403A21
.text:00403A21 loc_403A21:			       ; CODE XREF: __NMSG_WRITE+D4j
.text:00403A21					       ; __NMSG_WRITE+FBj
.text:00403A21		       xor     esi, esi
.text:00403A23
.text:00403A23 loc_403A23:			       ; CODE XREF: __NMSG_WRITE+10Cj
.text:00403A23		       push    offset asc_41E300 ; "\n\n"
.text:00403A28		       push    ebx	       ; _SizeInBytes
.text:00403A29		       push    ebp	       ; _Dst
.text:00403A2A		       call    _strcat_s
.text:00403A2F		       add     esp, 0Ch
.text:00403A32		       test    eax, eax
.text:00403A34		       jz      short loc_403A43
.text:00403A36		       push    esi	       ; pReserved
.text:00403A37		       push    esi	       ; nLine
.text:00403A38		       push    esi	       ; pszFile
.text:00403A39		       push    esi	       ; pszFunction
.text:00403A3A		       push    esi	       ; pszExpression
.text:00403A3B		       call    __invoke_watson
.text:00403A40		       add     esp, 14h
.text:00403A43
.text:00403A43 loc_403A43:			       ; CODE XREF: __NMSG_WRITE+121j
.text:00403A43		       push    rterrs.rterrtxt[edi*8] ;	_Src
.text:00403A4A		       push    ebx	       ; _SizeInBytes
.text:00403A4B		       push    ebp	       ; _Dst
.text:00403A4C		       call    _strcat_s
.text:00403A51		       add     esp, 0Ch
.text:00403A54		       test    eax, eax
.text:00403A56		       jz      short loc_403A65
.text:00403A58		       push    esi	       ; pReserved
.text:00403A59		       push    esi	       ; nLine
.text:00403A5A		       push    esi	       ; pszFile
.text:00403A5B		       push    esi	       ; pszFunction
.text:00403A5C		       push    esi	       ; pszExpression
.text:00403A5D		       call    __invoke_watson
.text:00403A62		       add     esp, 14h
.text:00403A65
.text:00403A65 loc_403A65:			       ; CODE XREF: __NMSG_WRITE+143j
.text:00403A65		       push    12010h	       ; uType
.text:00403A6A		       push    offset Caption  ; "Microsoft Visual C++ Runtime Library"
.text:00403A6F		       push    ebp	       ; lpText
.text:00403A70		       call    ___crtMessageBoxA
.text:00403A75		       add     esp, 0Ch
.text:00403A78		       jmp     short loc_403AAD
.text:00403A7A ; ---------------------------------------------------------------------------
.text:00403A7A
.text:00403A7A loc_403A7A:			       ; CODE XREF: __NMSG_WRITE+30j
.text:00403A7A					       ; __NMSG_WRITE+49j
.text:00403A7A		       push    0FFFFFFF4h      ; nStdHandle
.text:00403A7C		       call    ds:__imp__GetStdHandle@4	; GetStdHandle(x)
.text:00403A82		       mov     ebp, eax
.text:00403A84		       cmp     ebp, esi
.text:00403A86		       jz      short loc_403AAD
.text:00403A88		       cmp     ebp, 0FFFFFFFFh
.text:00403A8B		       jz      short loc_403AAD
.text:00403A8D		       push    0	       ; lpOverlapped
.text:00403A8F		       lea     eax, [esp+18h+NumberOfBytesWritten]
.text:00403A93		       push    eax	       ; lpNumberOfBytesWritten
.text:00403A94		       lea     esi, ds:42149Ch[edi*8]
.text:00403A9B		       push    dword ptr [esi] ; buf
.text:00403A9D		       call    _strlen
.text:00403AA2		       pop     ecx
.text:00403AA3		       push    eax	       ; nNumberOfBytesToWrite
.text:00403AA4		       push    dword ptr [esi] ; lpBuffer
.text:00403AA6		       push    ebp	       ; hFile
.text:00403AA7		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:00403AAD
.text:00403AAD loc_403AAD:			       ; CODE XREF: __NMSG_WRITE+55j
.text:00403AAD					       ; __NMSG_WRITE+165j ...
.text:00403AAD		       pop     ebp
.text:00403AAE
.text:00403AAE loc_403AAE:			       ; CODE XREF: __NMSG_WRITE+1Ej
.text:00403AAE		       pop     edi
.text:00403AAF		       pop     esi
.text:00403AB0		       pop     ebx
.text:00403AB1		       pop     ecx
.text:00403AB2		       retn
.text:00403AB2 __NMSG_WRITE    endp
.text:00403AB2
.text:00403AB3
.text:00403AB3 ; =============== S U B R O U T I N E =======================================
.text:00403AB3
.text:00403AB3
.text:00403AB3 ; char *__cdecl _GET_RTERRMSG(int rterrnum)
.text:00403AB3 __GET_RTERRMSG  proc near
.text:00403AB3
.text:00403AB3 rterrnum	       = dword ptr  4
.text:00403AB3
.text:00403AB3		       xor     eax, eax
.text:00403AB5
.text:00403AB5 loc_403AB5:			       ; CODE XREF: __GET_RTERRMSG+13j
.text:00403AB5		       mov     ecx, [esp+rterrnum]
.text:00403AB9		       cmp     ecx, rterrs.rterrno[eax*8]
.text:00403AC0		       jz      short loc_403ACB
.text:00403AC2		       inc     eax
.text:00403AC3		       cmp     eax, 17h
.text:00403AC6		       jb      short loc_403AB5
.text:00403AC8		       xor     eax, eax
.text:00403ACA		       retn
.text:00403ACB ; ---------------------------------------------------------------------------
.text:00403ACB
.text:00403ACB loc_403ACB:			       ; CODE XREF: __GET_RTERRMSG+Dj
.text:00403ACB		       mov     eax, rterrs.rterrtxt[eax*8]
.text:00403AD2		       retn
.text:00403AD2 __GET_RTERRMSG  endp
.text:00403AD2
.text:00403AD3
.text:00403AD3 ; =============== S U B R O U T I N E =======================================
.text:00403AD3
.text:00403AD3
.text:00403AD3 __FF_MSGBANNER  proc near	       ; CODE XREF: __amsg_exitp
.text:00403AD3					       ; __heap_alloc+9p ...
.text:00403AD3		       push    3	       ; em
.text:00403AD5		       call    __set_error_mode
.text:00403ADA		       cmp     eax, 1
.text:00403ADD		       pop     ecx
.text:00403ADE		       jz      short loc_403AF5
.text:00403AE0		       push    3	       ; em
.text:00403AE2		       call    __set_error_mode
.text:00403AE7		       test    eax, eax
.text:00403AE9		       pop     ecx
.text:00403AEA		       jnz     short locret_403B0B
.text:00403AEC		       cmp     ___app_type, 1
.text:00403AF3		       jnz     short locret_403B0B
.text:00403AF5
.text:00403AF5 loc_403AF5:			       ; CODE XREF: __FF_MSGBANNER+Bj
.text:00403AF5		       push    0FCh	       ; rterrnum
.text:00403AFA		       call    __NMSG_WRITE
.text:00403AFF		       push    0FFh	       ; rterrnum
.text:00403B04		       call    __NMSG_WRITE
.text:00403B09		       pop     ecx
.text:00403B0A		       pop     ecx
.text:00403B0B
.text:00403B0B locret_403B0B:			       ; CODE XREF: __FF_MSGBANNER+17j
.text:00403B0B					       ; __FF_MSGBANNER+20j
.text:00403B0B		       retn
.text:00403B0B __FF_MSGBANNER  endp
.text:00403B0B
.text:00403B0C
.text:00403B0C ; =============== S U B R O U T I N E =======================================
.text:00403B0C
.text:00403B0C
.text:00403B0C ; int __cdecl _mtinitlocks()
.text:00403B0C __mtinitlocks   proc near	       ; CODE XREF: __mtinit+10Cp
.text:00403B0C		       push    esi
.text:00403B0D		       push    edi
.text:00403B0E		       xor     esi, esi
.text:00403B10		       mov     edi, offset lclcritsects
.text:00403B15
.text:00403B15 loc_403B15:			       ; CODE XREF: __mtinitlocks+35j
.text:00403B15		       cmp     _locktable.kind[esi*8], 1
.text:00403B1D		       jnz     short loc_403B3D
.text:00403B1F		       lea     eax, ds:421550h[esi*8]
.text:00403B26		       mov     [eax], edi
.text:00403B28		       push    0FA0h	       ; dwSpinCount
.text:00403B2D		       push    dword ptr [eax] ; lpCriticalSection
.text:00403B2F		       add     edi, 18h
.text:00403B32		       call    ___crtInitCritSecAndSpinCount
.text:00403B37		       test    eax, eax
.text:00403B39		       pop     ecx
.text:00403B3A		       pop     ecx
.text:00403B3B		       jz      short loc_403B49
.text:00403B3D
.text:00403B3D loc_403B3D:			       ; CODE XREF: __mtinitlocks+11j
.text:00403B3D		       inc     esi
.text:00403B3E		       cmp     esi, 24h
.text:00403B41		       jl      short loc_403B15
.text:00403B43		       xor     eax, eax
.text:00403B45		       inc     eax
.text:00403B46
.text:00403B46 loc_403B46:			       ; CODE XREF: __mtinitlocks+47j
.text:00403B46		       pop     edi
.text:00403B47		       pop     esi
.text:00403B48		       retn
.text:00403B49 ; ---------------------------------------------------------------------------
.text:00403B49
.text:00403B49 loc_403B49:			       ; CODE XREF: __mtinitlocks+2Fj
.text:00403B49		       and     _locktable.lock[esi*8], 0
.text:00403B51		       xor     eax, eax
.text:00403B53		       jmp     short loc_403B46
.text:00403B53 __mtinitlocks   endp
.text:00403B53
.text:00403B55
.text:00403B55 ; =============== S U B R O U T I N E =======================================
.text:00403B55
.text:00403B55
.text:00403B55 __mtdeletelocks proc near	       ; CODE XREF: __mtterm:loc_403484j
.text:00403B55		       push    ebx
.text:00403B56		       mov     ebx, ds:__imp__DeleteCriticalSection@4 ;	DeleteCriticalSection(x)
.text:00403B5C		       push    esi
.text:00403B5D		       mov     esi, offset _locktable
.text:00403B62		       push    edi
.text:00403B63
.text:00403B63 loc_403B63:			       ; CODE XREF: __mtdeletelocks+30j
.text:00403B63		       mov     edi, [esi]
.text:00403B65		       test    edi, edi
.text:00403B67		       jz      short loc_403B7C
.text:00403B69		       cmp     dword ptr [esi+4], 1
.text:00403B6D		       jz      short loc_403B7C
.text:00403B6F		       push    edi	       ; lpCriticalSection
.text:00403B70		       call    ebx ; DeleteCriticalSection(x) ;	DeleteCriticalSection(x)
.text:00403B72		       push    edi	       ; pBlock
.text:00403B73		       call    _free
.text:00403B78		       and     dword ptr [esi],	0
.text:00403B7B		       pop     ecx
.text:00403B7C
.text:00403B7C loc_403B7C:			       ; CODE XREF: __mtdeletelocks+12j
.text:00403B7C					       ; __mtdeletelocks+18j
.text:00403B7C		       add     esi, 8
.text:00403B7F		       cmp     esi, offset __cfltcvt_tab
.text:00403B85		       jl      short loc_403B63
.text:00403B87		       mov     esi, offset _locktable
.text:00403B8C		       pop     edi
.text:00403B8D
.text:00403B8D loc_403B8D:			       ; CODE XREF: __mtdeletelocks+50j
.text:00403B8D		       mov     eax, [esi]
.text:00403B8F		       test    eax, eax
.text:00403B91		       jz      short loc_403B9C
.text:00403B93		       cmp     dword ptr [esi+4], 1
.text:00403B97		       jnz     short loc_403B9C
.text:00403B99		       push    eax	       ; lpCriticalSection
.text:00403B9A		       call    ebx ; DeleteCriticalSection(x) ;	DeleteCriticalSection(x)
.text:00403B9C
.text:00403B9C loc_403B9C:			       ; CODE XREF: __mtdeletelocks+3Cj
.text:00403B9C					       ; __mtdeletelocks+42j
.text:00403B9C		       add     esi, 8
.text:00403B9F		       cmp     esi, offset __cfltcvt_tab
.text:00403BA5		       jl      short loc_403B8D
.text:00403BA7		       pop     esi
.text:00403BA8		       pop     ebx
.text:00403BA9		       retn
.text:00403BA9 __mtdeletelocks endp
.text:00403BA9
.text:00403BAA
.text:00403BAA ; =============== S U B R O U T I N E =======================================
.text:00403BAA
.text:00403BAA ; Attributes: bp-based frame
.text:00403BAA
.text:00403BAA ; void __cdecl _unlock(int locknum)
.text:00403BAA __unlock	       proc near	       ; CODE XREF: __unlockexit+2p
.text:00403BAA					       ; doexit+BCp ...
.text:00403BAA
.text:00403BAA locknum	       = dword ptr  8
.text:00403BAA
.text:00403BAA		       push    ebp
.text:00403BAB		       mov     ebp, esp
.text:00403BAD		       mov     eax, [ebp+locknum]
.text:00403BB0		       push    _locktable.lock[eax*8] ;	lpCriticalSection
.text:00403BB7		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:00403BBD		       pop     ebp
.text:00403BBE		       retn
.text:00403BBE __unlock	       endp
.text:00403BBE
.text:00403BBF
.text:00403BBF ; =============== S U B R O U T I N E =======================================
.text:00403BBF
.text:00403BBF ; Attributes: noreturn
.text:00403BBF
.text:00403BBF ; void __cdecl _lockerr_exit(char *msg)
.text:00403BBF __lockerr_exit  proc near
.text:00403BBF
.text:00403BBF msg	       = dword ptr  4
.text:00403BBF
.text:00403BBF		       push    [esp+msg]       ; lpMessageText
.text:00403BC3		       push    0	       ; uAction
.text:00403BC5		       call    ds:__imp__FatalAppExitA@8 ; FatalAppExitA(x,x)
.text:00403BCB ; ---------------------------------------------------------------------------
.text:00403BCB		       push    0FFh	       ; status
.text:00403BD0		       call    ___crtExitProcess
.text:00403BD5 ; ---------------------------------------------------------------------------
.text:00403BD5		       pop     ecx
.text:00403BD6		       retn
.text:00403BD6 __lockerr_exit  endp
.text:00403BD6
.text:00403BD7
.text:00403BD7 ; =============== S U B R O U T I N E =======================================
.text:00403BD7
.text:00403BD7 ; Attributes: bp-based frame
.text:00403BD7
.text:00403BD7 ; int __cdecl _mtinitlocknum(int	locknum)
.text:00403BD7 __mtinitlocknum proc near	       ; CODE XREF: __lock+14p
.text:00403BD7					       ; __alloc_osfhnd+17p
.text:00403BD7
.text:00403BD7 retval	       = dword ptr -1Ch
.text:00403BD7 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00403BD7 locknum	       = dword ptr  8
.text:00403BD7
.text:00403BD7		       push    0Ch
.text:00403BD9		       push    offset dword_420578
.text:00403BDE		       call    __SEH_prolog4
.text:00403BE3		       xor     edi, edi
.text:00403BE5		       inc     edi
.text:00403BE6		       mov     [ebp+retval], edi
.text:00403BE9		       xor     ebx, ebx
.text:00403BEB		       cmp     __crtheap, ebx
.text:00403BF1		       jnz     short loc_403C0B
.text:00403BF3		       call    __FF_MSGBANNER
.text:00403BF8		       push    1Eh	       ; rterrnum
.text:00403BFA		       call    __NMSG_WRITE
.text:00403BFF		       push    0FFh	       ; status
.text:00403C04		       call    ___crtExitProcess
.text:00403C09 ; ---------------------------------------------------------------------------
.text:00403C09		       pop     ecx
.text:00403C0A		       pop     ecx
.text:00403C0B
.text:00403C0B loc_403C0B:			       ; CODE XREF: __mtinitlocknum+1Aj
.text:00403C0B		       mov     esi, [ebp+locknum]
.text:00403C0E		       lea     esi, ds:421550h[esi*8]
.text:00403C15		       cmp     [esi], ebx
.text:00403C17		       jz      short loc_403C1D
.text:00403C19		       mov     eax, edi
.text:00403C1B		       jmp     short loc_403C8B
.text:00403C1D ; ---------------------------------------------------------------------------
.text:00403C1D
.text:00403C1D loc_403C1D:			       ; CODE XREF: __mtinitlocknum+40j
.text:00403C1D		       push    18h	       ; cb
.text:00403C1F		       call    __malloc_crt
.text:00403C24		       pop     ecx
.text:00403C25		       mov     edi, eax
.text:00403C27		       cmp     edi, ebx
.text:00403C29		       jnz     short loc_403C3A
.text:00403C2B		       call    __errno
.text:00403C30		       mov     dword ptr [eax],	0Ch
.text:00403C36		       xor     eax, eax
.text:00403C38		       jmp     short loc_403C8B
.text:00403C3A ; ---------------------------------------------------------------------------
.text:00403C3A
.text:00403C3A loc_403C3A:			       ; CODE XREF: __mtinitlocknum+52j
.text:00403C3A		       push    0Ah	       ; locknum
.text:00403C3C		       call    __lock
.text:00403C41		       pop     ecx
.text:00403C42		       mov     [ebp+ms_exc.disabled], ebx
.text:00403C45		       cmp     [esi], ebx
.text:00403C47		       jnz     short loc_403C75
.text:00403C49		       push    0FA0h	       ; dwSpinCount
.text:00403C4E		       push    edi	       ; lpCriticalSection
.text:00403C4F		       call    ___crtInitCritSecAndSpinCount
.text:00403C54		       pop     ecx
.text:00403C55		       pop     ecx
.text:00403C56		       test    eax, eax
.text:00403C58		       jnz     short loc_403C71
.text:00403C5A		       push    edi	       ; pBlock
.text:00403C5B		       call    _free
.text:00403C60		       pop     ecx
.text:00403C61		       call    __errno
.text:00403C66		       mov     dword ptr [eax],	0Ch
.text:00403C6C		       mov     [ebp+retval], ebx
.text:00403C6F		       jmp     short loc_403C7C
.text:00403C71 ; ---------------------------------------------------------------------------
.text:00403C71
.text:00403C71 loc_403C71:			       ; CODE XREF: __mtinitlocknum+81j
.text:00403C71		       mov     [esi], edi
.text:00403C73		       jmp     short loc_403C7C
.text:00403C75 ; ---------------------------------------------------------------------------
.text:00403C75
.text:00403C75 loc_403C75:			       ; CODE XREF: __mtinitlocknum+70j
.text:00403C75		       push    edi	       ; pBlock
.text:00403C76		       call    _free
.text:00403C7B		       pop     ecx
.text:00403C7C
.text:00403C7C loc_403C7C:			       ; CODE XREF: __mtinitlocknum+98j
.text:00403C7C					       ; __mtinitlocknum+9Cj
.text:00403C7C		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00403C83		       call    $LN12_0
.text:00403C88
.text:00403C88 $LN15_1:
.text:00403C88		       mov     eax, [ebp+retval]
.text:00403C8B
.text:00403C8B loc_403C8B:			       ; CODE XREF: __mtinitlocknum+44j
.text:00403C8B					       ; __mtinitlocknum+61j
.text:00403C8B		       call    __SEH_epilog4
.text:00403C90		       retn
.text:00403C91 ; ---------------------------------------------------------------------------
.text:00403C91
.text:00403C91 $LN12_0:				       ; CODE XREF: __mtinitlocknum+ACp
.text:00403C91					       ; DATA XREF: .rdata:00420590o
.text:00403C91		       push    0Ah	       ; locknum
.text:00403C93		       call    __unlock
.text:00403C98		       pop     ecx
.text:00403C99
.text:00403C99 $LN13_0:
.text:00403C99		       retn
.text:00403C99 __mtinitlocknum endp
.text:00403C99
.text:00403C9A
.text:00403C9A ; =============== S U B R O U T I N E =======================================
.text:00403C9A
.text:00403C9A ; Attributes: bp-based frame
.text:00403C9A
.text:00403C9A ; void __cdecl _lock(int	locknum)
.text:00403C9A __lock	       proc near	       ; CODE XREF: __lockexit+2p
.text:00403C9A					       ; doexit+Ep ...
.text:00403C9A
.text:00403C9A locknum	       = dword ptr  8
.text:00403C9A
.text:00403C9A		       push    ebp
.text:00403C9B		       mov     ebp, esp
.text:00403C9D		       mov     eax, [ebp+locknum]
.text:00403CA0		       push    esi
.text:00403CA1		       lea     esi, ds:421550h[eax*8]
.text:00403CA8		       cmp     dword ptr [esi],	0
.text:00403CAB		       jnz     short loc_403CC0
.text:00403CAD		       push    eax	       ; locknum
.text:00403CAE		       call    __mtinitlocknum
.text:00403CB3		       test    eax, eax
.text:00403CB5		       pop     ecx
.text:00403CB6		       jnz     short loc_403CC0
.text:00403CB8		       push    11h	       ; rterrnum
.text:00403CBA		       call    __amsg_exit
.text:00403CBF		       pop     ecx
.text:00403CC0
.text:00403CC0 loc_403CC0:			       ; CODE XREF: __lock+11j
.text:00403CC0					       ; __lock+1Cj
.text:00403CC0		       push    dword ptr [esi] ; lpCriticalSection
.text:00403CC2		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:00403CC8		       pop     esi
.text:00403CC9		       pop     ebp
.text:00403CCA		       retn
.text:00403CCA __lock	       endp
.text:00403CCA
.text:00403CCB
.text:00403CCB ; =============== S U B R O U T I N E =======================================
.text:00403CCB
.text:00403CCB
.text:00403CCB ; int (__cdecl *__cdecl onexit_nolock(int (__cdecl *func)()))()
.text:00403CCB _onexit_nolock  proc near	       ; CODE XREF: __onexit+18p
.text:00403CCB
.text:00403CCB onexitbegin     = dword ptr -8
.text:00403CCB ptr	       = dword ptr -4
.text:00403CCB func	       = dword ptr  4
.text:00403CCB
.text:00403CCB		       push    ecx
.text:00403CCC		       push    ebx
.text:00403CCD		       push    ebp
.text:00403CCE		       push    esi
.text:00403CCF		       push    edi
.text:00403CD0		       push    ___onexitbegin  ; codedptr
.text:00403CD6		       call    __decode_pointer
.text:00403CDB		       push    ___onexitend    ; codedptr
.text:00403CE1		       mov     esi, eax
.text:00403CE3		       mov     [esp+1Ch+ptr], esi
.text:00403CE7		       call    __decode_pointer
.text:00403CEC		       mov     edi, eax
.text:00403CEE		       cmp     edi, esi
.text:00403CF0		       pop     ecx
.text:00403CF1		       pop     ecx
.text:00403CF2		       jb      loc_403D7C
.text:00403CF8		       mov     ebx, edi
.text:00403CFA		       sub     ebx, esi
.text:00403CFC		       lea     ebp, [ebx+4]
.text:00403CFF		       cmp     ebp, 4
.text:00403D02		       jb      short loc_403D7C
.text:00403D04		       push    esi	       ; pblock
.text:00403D05		       call    __msize
.text:00403D0A		       mov     esi, eax
.text:00403D0C		       cmp     esi, ebp
.text:00403D0E		       pop     ecx
.text:00403D0F		       jnb     short loc_403D5B
.text:00403D11		       mov     eax, 800h
.text:00403D16		       cmp     esi, eax
.text:00403D18		       jnb     short loc_403D1C
.text:00403D1A		       mov     eax, esi
.text:00403D1C
.text:00403D1C loc_403D1C:			       ; CODE XREF: _onexit_nolock+4Dj
.text:00403D1C		       add     eax, esi
.text:00403D1E		       cmp     eax, esi
.text:00403D20		       jb      short loc_403D32
.text:00403D22		       push    eax	       ; size
.text:00403D23		       push    [esp+18h+ptr]   ; ptr
.text:00403D27		       call    __realloc_crt
.text:00403D2C		       test    eax, eax
.text:00403D2E		       pop     ecx
.text:00403D2F		       pop     ecx
.text:00403D30		       jnz     short loc_403D49
.text:00403D32
.text:00403D32 loc_403D32:			       ; CODE XREF: _onexit_nolock+55j
.text:00403D32		       lea     eax, [esi+10h]
.text:00403D35		       cmp     eax, esi
.text:00403D37		       jb      short loc_403D7C
.text:00403D39		       push    eax	       ; size
.text:00403D3A		       push    [esp+18h+ptr]   ; ptr
.text:00403D3E		       call    __realloc_crt
.text:00403D43		       test    eax, eax
.text:00403D45		       pop     ecx
.text:00403D46		       pop     ecx
.text:00403D47		       jz      short loc_403D7C
.text:00403D49
.text:00403D49 loc_403D49:			       ; CODE XREF: _onexit_nolock+65j
.text:00403D49		       sar     ebx, 2
.text:00403D4C		       push    eax	       ; ptr
.text:00403D4D		       lea     edi, [eax+ebx*4]
.text:00403D50		       call    __encode_pointer
.text:00403D55		       pop     ecx
.text:00403D56		       mov     ___onexitbegin, eax
.text:00403D5B
.text:00403D5B loc_403D5B:			       ; CODE XREF: _onexit_nolock+44j
.text:00403D5B		       push    [esp+14h+func]  ; ptr
.text:00403D5F		       call    __encode_pointer
.text:00403D64		       mov     [edi], eax
.text:00403D66		       add     edi, 4
.text:00403D69		       push    edi	       ; ptr
.text:00403D6A		       call    __encode_pointer
.text:00403D6F		       pop     ecx
.text:00403D70		       mov     ___onexitend, eax
.text:00403D75		       mov     eax, [esp+18h+func]
.text:00403D79		       pop     ecx
.text:00403D7A		       jmp     short loc_403D7E
.text:00403D7C ; ---------------------------------------------------------------------------
.text:00403D7C
.text:00403D7C loc_403D7C:			       ; CODE XREF: _onexit_nolock+27j
.text:00403D7C					       ; _onexit_nolock+37j ...
.text:00403D7C		       xor     eax, eax
.text:00403D7E
.text:00403D7E loc_403D7E:			       ; CODE XREF: _onexit_nolock+AFj
.text:00403D7E		       pop     edi
.text:00403D7F		       pop     esi
.text:00403D80		       pop     ebp
.text:00403D81		       pop     ebx
.text:00403D82		       pop     ecx
.text:00403D83		       retn
.text:00403D83 _onexit_nolock  endp
.text:00403D83
.text:00403D84
.text:00403D84 ; =============== S U B R O U T I N E =======================================
.text:00403D84
.text:00403D84
.text:00403D84 ; int __cdecl __onexitinit()
.text:00403D84 ___onexitinit   proc near	       ; DATA XREF: .rdata:pinit_0o
.text:00403D84		       push    esi
.text:00403D85		       push    4	       ; size
.text:00403D87		       push    20h	       ; count
.text:00403D89		       call    __calloc_crt
.text:00403D8E		       mov     esi, eax
.text:00403D90		       push    esi	       ; ptr
.text:00403D91		       call    __encode_pointer
.text:00403D96		       add     esp, 0Ch
.text:00403D99		       test    esi, esi
.text:00403D9B		       mov     ___onexitbegin, eax
.text:00403DA0		       mov     ___onexitend, eax
.text:00403DA5		       jnz     short loc_403DAC
.text:00403DA7		       push    18h
.text:00403DA9		       pop     eax
.text:00403DAA		       pop     esi
.text:00403DAB		       retn
.text:00403DAC ; ---------------------------------------------------------------------------
.text:00403DAC
.text:00403DAC loc_403DAC:			       ; CODE XREF: ___onexitinit+21j
.text:00403DAC		       and     dword ptr [esi],	0
.text:00403DAF		       xor     eax, eax
.text:00403DB1		       pop     esi
.text:00403DB2		       retn
.text:00403DB2 ___onexitinit   endp
.text:00403DB2
.text:00403DB3
.text:00403DB3 ; =============== S U B R O U T I N E =======================================
.text:00403DB3
.text:00403DB3 ; Attributes: noreturn bp-based frame
.text:00403DB3
.text:00403DB3 ; int (__cdecl *__cdecl _onexit(int (__cdecl *func)()))()
.text:00403DB3 __onexit	       proc near	       ; CODE XREF: _atexit+4p
.text:00403DB3
.text:00403DB3 retval	       = dword ptr -1Ch
.text:00403DB3 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00403DB3 func	       = dword ptr  8
.text:00403DB3
.text:00403DB3		       push    0Ch
.text:00403DB5		       push    offset dword_420598
.text:00403DBA		       call    __SEH_prolog4
.text:00403DBF		       call    __lockexit
.text:00403DC4		       and     [ebp+ms_exc.disabled], 0
.text:00403DC8		       push    [ebp+func]      ; func
.text:00403DCB		       call    _onexit_nolock
.text:00403DD0		       pop     ecx
.text:00403DD1		       mov     [ebp+retval], eax
.text:00403DD4		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00403DDB		       call    $LN5
.text:00403DE0 ; ---------------------------------------------------------------------------
.text:00403DE0
.text:00403DE0 $LN8_1:
.text:00403DE0		       mov     eax, [ebp+retval]
.text:00403DE3		       call    __SEH_epilog4
.text:00403DE8		       retn
.text:00403DE9 ; ---------------------------------------------------------------------------
.text:00403DE9
.text:00403DE9 $LN5:				       ; CODE XREF: __onexit+28p
.text:00403DE9					       ; DATA XREF: .rdata:004205B0o
.text:00403DE9		       call    __unlockexit
.text:00403DEE
.text:00403DEE $LN6_2:
.text:00403DEE		       retn
.text:00403DEE __onexit	       endp
.text:00403DEE
.text:00403DEF
.text:00403DEF ; =============== S U B R O U T I N E =======================================
.text:00403DEF
.text:00403DEF ; Attributes: noreturn
.text:00403DEF
.text:00403DEF ; int __cdecl atexit(void (__cdecl *func)())
.text:00403DEF _atexit	       proc near	       ; CODE XREF: __cinit+44p
.text:00403DEF
.text:00403DEF func	       = dword ptr  4
.text:00403DEF
.text:00403DEF		       push    [esp+func]      ; func
.text:00403DF3		       call    __onexit
.text:00403DF8 ; ---------------------------------------------------------------------------
.text:00403DF8		       neg     eax
.text:00403DFA		       sbb     eax, eax
.text:00403DFC		       neg     eax
.text:00403DFE		       pop     ecx
.text:00403DFF		       dec     eax
.text:00403E00		       retn
.text:00403E00 _atexit	       endp
.text:00403E00
.text:00403E01
.text:00403E01 ; =============== S U B R O U T I N E =======================================
.text:00403E01
.text:00403E01
.text:00403E01 __RTC_Initialize	proc near	       ; CODE XREF: __tmainCRTStartup:loc_40201Bp
.text:00403E01		       push    esi
.text:00403E02		       push    edi
.text:00403E03		       mov     eax, offset dword_420044
.text:00403E08		       mov     edi, offset ___rtc_izz
.text:00403E0D		       cmp     eax, edi
.text:00403E0F		       mov     esi, eax
.text:00403E11		       jnb     short loc_403E22
.text:00403E13
.text:00403E13 loc_403E13:			       ; CODE XREF: __RTC_Initialize+1Fj
.text:00403E13		       mov     eax, [esi]
.text:00403E15		       test    eax, eax
.text:00403E17		       jz      short loc_403E1B
.text:00403E19		       call    eax
.text:00403E1B
.text:00403E1B loc_403E1B:			       ; CODE XREF: __RTC_Initialize+16j
.text:00403E1B		       add     esi, 4
.text:00403E1E		       cmp     esi, edi
.text:00403E20		       jb      short loc_403E13
.text:00403E22
.text:00403E22 loc_403E22:			       ; CODE XREF: __RTC_Initialize+10j
.text:00403E22		       pop     edi
.text:00403E23		       pop     esi
.text:00403E24		       retn
.text:00403E24 __RTC_Initialize	endp
.text:00403E24
.text:00403E25
.text:00403E25 ; =============== S U B R O U T I N E =======================================
.text:00403E25
.text:00403E25
.text:00403E25 ; void __cdecl _RTC_Terminate()
.text:00403E25 __RTC_Terminate proc near	       ; DATA XREF: __cinit+3Fo
.text:00403E25		       push    esi
.text:00403E26		       push    edi
.text:00403E27		       mov     eax, offset dword_42024C
.text:00403E2C		       mov     edi, offset ___rtc_tzz
.text:00403E31		       cmp     eax, edi
.text:00403E33		       mov     esi, eax
.text:00403E35		       jnb     short loc_403E46
.text:00403E37
.text:00403E37 loc_403E37:			       ; CODE XREF: __RTC_Terminate+1Fj
.text:00403E37		       mov     eax, [esi]
.text:00403E39		       test    eax, eax
.text:00403E3B		       jz      short loc_403E3F
.text:00403E3D		       call    eax
.text:00403E3F
.text:00403E3F loc_403E3F:			       ; CODE XREF: __RTC_Terminate+16j
.text:00403E3F		       add     esi, 4
.text:00403E42		       cmp     esi, edi
.text:00403E44		       jb      short loc_403E37
.text:00403E46
.text:00403E46 loc_403E46:			       ; CODE XREF: __RTC_Terminate+10j
.text:00403E46		       pop     edi
.text:00403E47		       pop     esi
.text:00403E48		       retn
.text:00403E48 __RTC_Terminate endp
.text:00403E48
.text:00403E49
.text:00403E49 ; =============== S U B R O U T I N E =======================================
.text:00403E49
.text:00403E49
.text:00403E49 __initp_misc_cfltcvt_tab	proc near      ; CODE XREF: __cinit:loc_401745p
.text:00403E49		       push    esi
.text:00403E4A		       push    edi
.text:00403E4B		       xor     edi, edi
.text:00403E4D
.text:00403E4D loc_403E4D:			       ; CODE XREF: __initp_misc_cfltcvt_tab+1Aj
.text:00403E4D		       lea     esi, __cfltcvt_tab[edi]
.text:00403E53		       push    dword ptr [esi] ; ptr
.text:00403E55		       call    __encode_pointer
.text:00403E5A		       add     edi, 4
.text:00403E5D		       cmp     edi, 28h
.text:00403E60		       pop     ecx
.text:00403E61		       mov     [esi], eax
.text:00403E63		       jb      short loc_403E4D
.text:00403E65		       pop     edi
.text:00403E66		       pop     esi
.text:00403E67		       retn
.text:00403E67 __initp_misc_cfltcvt_tab	endp
.text:00403E67
.text:00403E67 ; ---------------------------------------------------------------------------
.text:00403E68		       align 10h
.text:00403E70
.text:00403E70 ; =============== S U B R O U T I N E =======================================
.text:00403E70
.text:00403E70
.text:00403E70 ; int __cdecl _ValidateImageBase(char *pImageBase)
.text:00403E70 __ValidateImageBase proc	near	       ; CODE XREF: __IsNonwritableInCurrentImage+3Fp
.text:00403E70
.text:00403E70 pImageBase      = dword ptr  4
.text:00403E70
.text:00403E70		       mov     ecx, [esp+pImageBase]
.text:00403E74		       cmp     word ptr	[ecx], 5A4Dh
.text:00403E79		       jz      short loc_403E7E
.text:00403E7B
.text:00403E7B loc_403E7B:			       ; CODE XREF: __ValidateImageBase+19j
.text:00403E7B		       xor     eax, eax
.text:00403E7D		       retn
.text:00403E7E ; ---------------------------------------------------------------------------
.text:00403E7E
.text:00403E7E loc_403E7E:			       ; CODE XREF: __ValidateImageBase+9j
.text:00403E7E		       mov     eax, [ecx+3Ch]
.text:00403E81		       add     eax, ecx
.text:00403E83		       cmp     dword ptr [eax],	4550h
.text:00403E89		       jnz     short loc_403E7B
.text:00403E8B		       xor     ecx, ecx
.text:00403E8D		       cmp     word ptr	[eax+18h], 10Bh
.text:00403E93		       setz    cl
.text:00403E96		       mov     eax, ecx
.text:00403E98		       retn
.text:00403E98 __ValidateImageBase endp
.text:00403E98
.text:00403E98 ; ---------------------------------------------------------------------------
.text:00403E99		       align 10h
.text:00403EA0
.text:00403EA0 ; =============== S U B R O U T I N E =======================================
.text:00403EA0
.text:00403EA0
.text:00403EA0 ; _IMAGE_SECTION_HEADER *__cdecl	_FindPESection(char *pImageBase, unsigned int rva)
.text:00403EA0 __FindPESection proc near	       ; CODE XREF: __IsNonwritableInCurrentImage+59p
.text:00403EA0
.text:00403EA0 pImageBase      = dword ptr  4
.text:00403EA0 rva	       = dword ptr  8
.text:00403EA0
.text:00403EA0		       mov     eax, [esp+pImageBase]
.text:00403EA4		       mov     ecx, [eax+3Ch]
.text:00403EA7		       add     ecx, eax
.text:00403EA9		       movzx   eax, word ptr [ecx+14h]
.text:00403EAD		       push    ebx
.text:00403EAE		       push    esi
.text:00403EAF		       movzx   esi, word ptr [ecx+6]
.text:00403EB3		       xor     edx, edx
.text:00403EB5		       test    esi, esi
.text:00403EB7		       push    edi
.text:00403EB8		       lea     eax, [eax+ecx+18h]
.text:00403EBC		       jbe     short loc_403EDC
.text:00403EBE		       mov     edi, [esp+0Ch+rva]
.text:00403EC2
.text:00403EC2 loc_403EC2:			       ; CODE XREF: __FindPESection+3Aj
.text:00403EC2		       mov     ecx, [eax+0Ch]
.text:00403EC5		       cmp     edi, ecx
.text:00403EC7		       jb      short loc_403ED2
.text:00403EC9		       mov     ebx, [eax+8]
.text:00403ECC		       add     ebx, ecx
.text:00403ECE		       cmp     edi, ebx
.text:00403ED0		       jb      short loc_403EDE
.text:00403ED2
.text:00403ED2 loc_403ED2:			       ; CODE XREF: __FindPESection+27j
.text:00403ED2		       add     edx, 1
.text:00403ED5		       add     eax, 28h
.text:00403ED8		       cmp     edx, esi
.text:00403EDA		       jb      short loc_403EC2
.text:00403EDC
.text:00403EDC loc_403EDC:			       ; CODE XREF: __FindPESection+1Cj
.text:00403EDC		       xor     eax, eax
.text:00403EDE
.text:00403EDE loc_403EDE:			       ; CODE XREF: __FindPESection+30j
.text:00403EDE		       pop     edi
.text:00403EDF		       pop     esi
.text:00403EE0		       pop     ebx
.text:00403EE1		       retn
.text:00403EE1 __FindPESection endp
.text:00403EE1
.text:00403EE1 ; ---------------------------------------------------------------------------
.text:00403EE2		       align 10h
.text:00403EF0
.text:00403EF0 ; =============== S U B R O U T I N E =======================================
.text:00403EF0
.text:00403EF0 ; Attributes: bp-based frame
.text:00403EF0
.text:00403EF0 ; int __cdecl _IsNonwritableInCurrentImage(char *pTarget)
.text:00403EF0 __IsNonwritableInCurrentImage proc near ; CODE XREF: __cinit+Ep
.text:00403EF0					       ; __cinit+79p ...
.text:00403EF0
.text:00403EF0 var_18	       = dword ptr -18h
.text:00403EF0 var_14	       = dword ptr -14h
.text:00403EF0 var_10	       = dword ptr -10h
.text:00403EF0 var_8	       = dword ptr -8
.text:00403EF0 var_4	       = dword ptr -4
.text:00403EF0 pTarget	       = dword ptr  8
.text:00403EF0
.text:00403EF0		       push    ebp
.text:00403EF1		       mov     ebp, esp
.text:00403EF3		       push    0FFFFFFFEh
.text:00403EF5		       push    offset dword_4205B8
.text:00403EFA		       push    offset __except_handler4
.text:00403EFF		       mov     eax, large fs:0
.text:00403F05		       push    eax
.text:00403F06		       sub     esp, 8
.text:00403F09		       push    ebx
.text:00403F0A		       push    esi
.text:00403F0B		       push    edi
.text:00403F0C		       mov     eax, ___security_cookie
.text:00403F11		       xor     [ebp+var_8], eax
.text:00403F14		       xor     eax, ebp
.text:00403F16		       push    eax
.text:00403F17		       lea     eax, [ebp+var_10]
.text:00403F1A		       mov     large fs:0, eax
.text:00403F20		       mov     [ebp+var_18], esp
.text:00403F23		       mov     [ebp+var_4], 0
.text:00403F2A		       push    400000h	       ; pImageBase
.text:00403F2F		       call    __ValidateImageBase
.text:00403F34		       add     esp, 4
.text:00403F37		       test    eax, eax
.text:00403F39		       jz      short loc_403F90
.text:00403F3B		       mov     eax, [ebp+pTarget]
.text:00403F3E		       sub     eax, 400000h
.text:00403F43		       push    eax	       ; rva
.text:00403F44		       push    400000h	       ; pImageBase
.text:00403F49		       call    __FindPESection
.text:00403F4E		       add     esp, 8
.text:00403F51		       test    eax, eax
.text:00403F53		       jz      short loc_403F90
.text:00403F55		       mov     eax, [eax+24h]
.text:00403F58		       shr     eax, 1Fh
.text:00403F5B		       not     eax
.text:00403F5D		       and     eax, 1
.text:00403F60		       mov     [ebp+var_4], 0FFFFFFFEh
.text:00403F67		       mov     ecx, [ebp+var_10]
.text:00403F6A		       mov     large fs:0, ecx
.text:00403F71		       pop     ecx
.text:00403F72		       pop     edi
.text:00403F73		       pop     esi
.text:00403F74		       pop     ebx
.text:00403F75		       mov     esp, ebp
.text:00403F77		       pop     ebp
.text:00403F78		       retn
.text:00403F79 ; ---------------------------------------------------------------------------
.text:00403F79
.text:00403F79 $LN7_2:
.text:00403F79		       mov     eax, [ebp+var_14]
.text:00403F7C		       mov     ecx, [eax]
.text:00403F7E		       mov     eax, [ecx]
.text:00403F80		       xor     edx, edx
.text:00403F82		       cmp     eax, 0C0000005h
.text:00403F87		       setz    dl
.text:00403F8A		       mov     eax, edx
.text:00403F8C
.text:00403F8C $LN11_0:
.text:00403F8C		       retn
.text:00403F8D ; ---------------------------------------------------------------------------
.text:00403F8D
.text:00403F8D $LN8_2:
.text:00403F8D		       mov     esp, [ebp+var_18]
.text:00403F90
.text:00403F90 loc_403F90:			       ; CODE XREF: __IsNonwritableInCurrentImage+49j
.text:00403F90					       ; __IsNonwritableInCurrentImage+63j
.text:00403F90		       mov     [ebp+var_4], 0FFFFFFFEh
.text:00403F97		       xor     eax, eax
.text:00403F99		       mov     ecx, [ebp+var_10]
.text:00403F9C		       mov     large fs:0, ecx
.text:00403FA3		       pop     ecx
.text:00403FA4		       pop     edi
.text:00403FA5		       pop     esi
.text:00403FA6		       pop     ebx
.text:00403FA7		       mov     esp, ebp
.text:00403FA9		       pop     ebp
.text:00403FAA		       retn
.text:00403FAA __IsNonwritableInCurrentImage endp
.text:00403FAA
.text:00403FAB
.text:00403FAB ; =============== S U B R O U T I N E =======================================
.text:00403FAB
.text:00403FAB ; Attributes: noreturn bp-based frame
.text:00403FAB
.text:00403FAB ; void __cdecl terminate()
.text:00403FAB ?terminate@@YAXXZ proc near	       ; CODE XREF: unexpected(void):loc_403FF2j
.text:00403FAB					       ; _inconsistency(void):loc_404029j ...
.text:00403FAB
.text:00403FAB ms_exc	       = CPPEH_RECORD ptr -18h
.text:00403FAB
.text:00403FAB		       push    8
.text:00403FAD		       push    offset dword_4205D8
.text:00403FB2		       call    __SEH_prolog4
.text:00403FB7		       call    __getptd
.text:00403FBC		       mov     eax, [eax+78h]
.text:00403FBF		       test    eax, eax
.text:00403FC1		       jz      short loc_403FD9
.text:00403FC3		       and     [ebp+ms_exc.disabled], 0
.text:00403FC7		       call    eax
.text:00403FC9		       jmp     short loc_403FD2
.text:00403FCB ; ---------------------------------------------------------------------------
.text:00403FCB
.text:00403FCB $LN6_3:
.text:00403FCB		       xor     eax, eax
.text:00403FCD		       inc     eax
.text:00403FCE
.text:00403FCE $LN10:
.text:00403FCE		       retn
.text:00403FCF ; ---------------------------------------------------------------------------
.text:00403FCF
.text:00403FCF $LN7_3:
.text:00403FCF		       mov     esp, [ebp+ms_exc.old_esp]
.text:00403FD2
.text:00403FD2 loc_403FD2:			       ; CODE XREF: terminate(void)+1Ej
.text:00403FD2		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00403FD9
.text:00403FD9 loc_403FD9:			       ; CODE XREF: terminate(void)+16j
.text:00403FD9		       call    _abort
.text:00403FDE ; ---------------------------------------------------------------------------
.text:00403FDE		       call    __SEH_epilog4
.text:00403FE3		       retn
.text:00403FE3 ?terminate@@YAXXZ endp
.text:00403FE3
.text:00403FE4
.text:00403FE4 ; =============== S U B R O U T I N E =======================================
.text:00403FE4
.text:00403FE4 ; Attributes: noreturn
.text:00403FE4
.text:00403FE4 ; void __cdecl unexpected()
.text:00403FE4 ?unexpected@@YAXXZ proc near
.text:00403FE4		       call    __getptd
.text:00403FE9		       mov     eax, [eax+7Ch]
.text:00403FEC		       test    eax, eax
.text:00403FEE		       jz      short loc_403FF2
.text:00403FF0		       call    eax
.text:00403FF2
.text:00403FF2 loc_403FF2:			       ; CODE XREF: unexpected(void)+Aj
.text:00403FF2		       jmp     ?terminate@@YAXXZ ; terminate(void)
.text:00403FF2 ?unexpected@@YAXXZ endp
.text:00403FF2
.text:00403FF7
.text:00403FF7 ; =============== S U B R O U T I N E =======================================
.text:00403FF7
.text:00403FF7 ; Attributes: noreturn bp-based frame
.text:00403FF7
.text:00403FF7 ; void __cdecl _inconsistency()
.text:00403FF7 ?_inconsistency@@YAXXZ proc near
.text:00403FF7
.text:00403FF7 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00403FF7
.text:00403FF7		       push    8
.text:00403FF9		       push    offset dword_4205F8
.text:00403FFE		       call    __SEH_prolog4
.text:00404003		       push    ?__pInconsistency@@3P6AXXZA ; codedptr
.text:00404009		       call    __decode_pointer
.text:0040400E		       pop     ecx
.text:0040400F		       test    eax, eax
.text:00404011		       jz      short loc_404029
.text:00404013		       and     [ebp+ms_exc.disabled], 0
.text:00404017		       call    eax
.text:00404019		       jmp     short loc_404022
.text:0040401B ; ---------------------------------------------------------------------------
.text:0040401B
.text:0040401B $LN6_4:
.text:0040401B		       xor     eax, eax
.text:0040401D		       inc     eax
.text:0040401E
.text:0040401E $LN10_0:
.text:0040401E		       retn
.text:0040401F ; ---------------------------------------------------------------------------
.text:0040401F
.text:0040401F $LN7_4:
.text:0040401F		       mov     esp, [ebp+ms_exc.old_esp]
.text:00404022
.text:00404022 loc_404022:			       ; CODE XREF: _inconsistency(void)+22j
.text:00404022		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404029
.text:00404029 loc_404029:			       ; CODE XREF: _inconsistency(void)+1Aj
.text:00404029		       jmp     ?terminate@@YAXXZ ; terminate(void)
.text:00404029 ?_inconsistency@@YAXXZ endp
.text:00404029
.text:0040402E
.text:0040402E ; =============== S U B R O U T I N E =======================================
.text:0040402E
.text:0040402E
.text:0040402E ; void __cdecl _initp_eh_hooks(void *enull)
.text:0040402E __initp_eh_hooks	proc near	       ; CODE XREF: __init_pointers+33p
.text:0040402E
.text:0040402E enull	       = dword ptr  4
.text:0040402E
.text:0040402E		       push    offset ?terminate@@YAXXZ	; ptr
.text:00404033		       call    __encode_pointer
.text:00404038		       pop     ecx
.text:00404039		       mov     ?__pInconsistency@@3P6AXXZA, eax	; void (*__pInconsistency)(void)
.text:0040403E		       retn
.text:0040403E __initp_eh_hooks	endp
.text:0040403E
.text:0040403F ; [00000001 BYTES: COLLAPSED FUNCTION __initp_misc_winxfltr. PRESS KEYPAD "+" TO	EXPAND]
.text:00404040
.text:00404040 ; =============== S U B R O U T I N E =======================================
.text:00404040
.text:00404040
.text:00404040 ; _XCPT_ACTION *__usercall xcptlookup<eax>(unsigned int xcptnum<edx>, _XCPT_ACTION *pxcptacttab)
.text:00404040 xcptlookup      proc near
.text:00404040
.text:00404040 pxcptacttab     = dword ptr  4
.text:00404040
.text:00404040 xcptnum = edx
.text:00404040		       mov     eax, [esp+pxcptacttab]
.text:00404044		       mov     ecx, __XcptActTabCount
.text:0040404A		       push    esi
.text:0040404B
.text:0040404B loc_40404B:			       ; CODE XREF: xcptlookup+1Dj
.text:0040404B		       cmp     [eax], xcptnum
.text:0040404D		       jz      short loc_40405F
.text:0040404F		       mov     esi, ecx
.text:00404051		       imul    esi, 0Ch
.text:00404054		       add     esi, [esp+4+pxcptacttab]
.text:00404058		       add     eax, 0Ch
.text:0040405B		       cmp     eax, esi
.text:0040405D		       jb      short loc_40404B
.text:0040405F
.text:0040405F loc_40405F:			       ; CODE XREF: xcptlookup+Dj
.text:0040405F		       imul    ecx, 0Ch
.text:00404062		       add     ecx, [esp+4+pxcptacttab]
.text:00404066		       pop     esi
.text:00404067		       cmp     eax, ecx
.text:00404069		       jnb     short loc_40406F
.text:0040406B		       cmp     [eax], xcptnum
.text:0040406D		       jz      short locret_404071
.text:0040406F
.text:0040406F loc_40406F:			       ; CODE XREF: xcptlookup+29j
.text:0040406F		       xor     eax, eax
.text:00404071
.text:00404071 locret_404071:			       ; CODE XREF: xcptlookup+2Dj
.text:00404071		       retn
.text:00404071 xcptlookup      endp
.text:00404071
.text:00404072
.text:00404072 ; =============== S U B R O U T I N E =======================================
.text:00404072
.text:00404072 ; Attributes: bp-based frame
.text:00404072
.text:00404072 ; int __cdecl _XcptFilter(unsigned int xcptnum, _EXCEPTION_POINTERS *pxcptinfoptrs)
.text:00404072 __XcptFilter    proc near	       ; CODE XREF: __tmainCRTStartup+184p
.text:00404072					       ; ___CppXcptFilter+10p
.text:00404072
.text:00404072 oldpxcptinfoptrs= dword ptr -8
.text:00404072 phandler	       = dword ptr -4
.text:00404072 xcptnum	       = dword ptr  8
.text:00404072 pxcptinfoptrs   = dword ptr  0Ch
.text:00404072
.text:00404072		       push    ebp
.text:00404073		       mov     ebp, esp
.text:00404075		       push    ecx
.text:00404076		       push    ecx
.text:00404077		       push    esi
.text:00404078		       call    __getptd_noexit
.text:0040407D		       mov     esi, eax
.text:0040407F		       test    esi, esi
.text:00404081		       jz      loc_4041CD
.text:00404087		       mov     edx, [esi+5Ch]
.text:0040408A		       mov     eax, __XcptActTabCount
.text:0040408F		       push    edi
.text:00404090		       mov     edi, [ebp+xcptnum]
.text:00404093		       mov     ecx, edx
.text:00404095		       push    ebx
.text:00404096
.text:00404096 loc_404096:			       ; CODE XREF: __XcptFilter+34j
.text:00404096		       cmp     [ecx], edi
.text:00404098		       jz      short loc_4040A8
.text:0040409A		       mov     ebx, eax
.text:0040409C		       imul    ebx, 0Ch
.text:0040409F		       add     ecx, 0Ch
.text:004040A2		       add     ebx, edx
.text:004040A4		       cmp     ecx, ebx
.text:004040A6		       jb      short loc_404096
.text:004040A8
.text:004040A8 loc_4040A8:			       ; CODE XREF: __XcptFilter+26j
.text:004040A8		       imul    eax, 0Ch
.text:004040AB		       add     eax, edx
.text:004040AD		       cmp     ecx, eax
.text:004040AF		       jnb     short loc_4040B9
.text:004040B1		       cmp     [ecx], edi
.text:004040B3		       jnz     short loc_4040B9
.text:004040B5		       mov     eax, ecx
.text:004040B7		       jmp     short loc_4040BB
.text:004040B9 ; ---------------------------------------------------------------------------
.text:004040B9
.text:004040B9 loc_4040B9:			       ; CODE XREF: __XcptFilter+3Dj
.text:004040B9					       ; __XcptFilter+41j
.text:004040B9		       xor     eax, eax
.text:004040BB
.text:004040BB loc_4040BB:			       ; CODE XREF: __XcptFilter+45j
.text:004040BB		       test    eax, eax
.text:004040BD		       jz      short loc_4040C9
.text:004040BF		       mov     ebx, [eax+8]
.text:004040C2		       test    ebx, ebx
.text:004040C4		       mov     [ebp+phandler], ebx
.text:004040C7		       jnz     short loc_4040D0
.text:004040C9
.text:004040C9 loc_4040C9:			       ; CODE XREF: __XcptFilter+4Bj
.text:004040C9		       xor     eax, eax
.text:004040CB		       jmp     loc_4041CB
.text:004040D0 ; ---------------------------------------------------------------------------
.text:004040D0
.text:004040D0 loc_4040D0:			       ; CODE XREF: __XcptFilter+55j
.text:004040D0		       cmp     ebx, 5
.text:004040D3		       jnz     short loc_4040E1
.text:004040D5		       and     dword ptr [eax+8], 0
.text:004040D9		       xor     eax, eax
.text:004040DB		       inc     eax
.text:004040DC		       jmp     loc_4041CB
.text:004040E1 ; ---------------------------------------------------------------------------
.text:004040E1
.text:004040E1 loc_4040E1:			       ; CODE XREF: __XcptFilter+61j
.text:004040E1		       cmp     ebx, 1
.text:004040E4		       jz      loc_4041C8
.text:004040EA		       mov     ecx, [esi+60h]
.text:004040ED		       mov     [ebp+oldpxcptinfoptrs], ecx
.text:004040F0		       mov     ecx, [ebp+pxcptinfoptrs]
.text:004040F3		       mov     [esi+60h], ecx
.text:004040F6		       mov     ecx, [eax+4]
.text:004040F9		       cmp     ecx, 8
.text:004040FC		       jnz     loc_4041BA
.text:00404102		       mov     ecx, __First_FPE_Indx
.text:00404108		       mov     edi, __Num_FPE
.text:0040410E		       mov     edx, ecx
.text:00404110		       add     edi, ecx
.text:00404112		       cmp     edx, edi
.text:00404114		       jge     short loc_40413A
.text:00404116		       imul    ecx, 0Ch
.text:00404119
.text:00404119 loc_404119:			       ; CODE XREF: __XcptFilter+C3j
.text:00404119		       mov     edi, [esi+5Ch]
.text:0040411C		       and     dword ptr [ecx+edi+8], 0
.text:00404121		       mov     edi, __First_FPE_Indx
.text:00404127		       mov     ebx, __Num_FPE
.text:0040412D		       inc     edx
.text:0040412E		       add     ebx, edi
.text:00404130		       add     ecx, 0Ch
.text:00404133		       cmp     edx, ebx
.text:00404135		       jl      short loc_404119
.text:00404137		       mov     ebx, [ebp+phandler]
.text:0040413A
.text:0040413A loc_40413A:			       ; CODE XREF: __XcptFilter+A2j
.text:0040413A		       mov     eax, [eax]
.text:0040413C		       cmp     eax, 0C000008Eh
.text:00404141		       mov     edi, [esi+64h]
.text:00404144		       jnz     short loc_40414F
.text:00404146		       mov     dword ptr [esi+64h], 83h
.text:0040414D		       jmp     short loc_4041AD
.text:0040414F ; ---------------------------------------------------------------------------
.text:0040414F
.text:0040414F loc_40414F:			       ; CODE XREF: __XcptFilter+D2j
.text:0040414F		       cmp     eax, 0C0000090h
.text:00404154		       jnz     short loc_40415F
.text:00404156		       mov     dword ptr [esi+64h], 81h
.text:0040415D		       jmp     short loc_4041AD
.text:0040415F ; ---------------------------------------------------------------------------
.text:0040415F
.text:0040415F loc_40415F:			       ; CODE XREF: __XcptFilter+E2j
.text:0040415F		       cmp     eax, 0C0000091h
.text:00404164		       jnz     short loc_40416F
.text:00404166		       mov     dword ptr [esi+64h], 84h
.text:0040416D		       jmp     short loc_4041AD
.text:0040416F ; ---------------------------------------------------------------------------
.text:0040416F
.text:0040416F loc_40416F:			       ; CODE XREF: __XcptFilter+F2j
.text:0040416F		       cmp     eax, 0C0000093h
.text:00404174		       jnz     short loc_40417F
.text:00404176		       mov     dword ptr [esi+64h], 85h
.text:0040417D		       jmp     short loc_4041AD
.text:0040417F ; ---------------------------------------------------------------------------
.text:0040417F
.text:0040417F loc_40417F:			       ; CODE XREF: __XcptFilter+102j
.text:0040417F		       cmp     eax, 0C000008Dh
.text:00404184		       jnz     short loc_40418F
.text:00404186		       mov     dword ptr [esi+64h], 82h
.text:0040418D		       jmp     short loc_4041AD
.text:0040418F ; ---------------------------------------------------------------------------
.text:0040418F
.text:0040418F loc_40418F:			       ; CODE XREF: __XcptFilter+112j
.text:0040418F		       cmp     eax, 0C000008Fh
.text:00404194		       jnz     short loc_40419F
.text:00404196		       mov     dword ptr [esi+64h], 86h
.text:0040419D		       jmp     short loc_4041AD
.text:0040419F ; ---------------------------------------------------------------------------
.text:0040419F
.text:0040419F loc_40419F:			       ; CODE XREF: __XcptFilter+122j
.text:0040419F		       cmp     eax, 0C0000092h
.text:004041A4		       jnz     short loc_4041AD
.text:004041A6		       mov     dword ptr [esi+64h], 8Ah
.text:004041AD
.text:004041AD loc_4041AD:			       ; CODE XREF: __XcptFilter+DBj
.text:004041AD					       ; __XcptFilter+EBj ...
.text:004041AD		       push    dword ptr [esi+64h]
.text:004041B0		       push    8
.text:004041B2		       call    ebx
.text:004041B4		       pop     ecx
.text:004041B5		       mov     [esi+64h], edi
.text:004041B8		       jmp     short loc_4041C1
.text:004041BA ; ---------------------------------------------------------------------------
.text:004041BA
.text:004041BA loc_4041BA:			       ; CODE XREF: __XcptFilter+8Aj
.text:004041BA		       and     dword ptr [eax+8], 0
.text:004041BE		       push    ecx
.text:004041BF		       call    ebx
.text:004041C1
.text:004041C1 loc_4041C1:			       ; CODE XREF: __XcptFilter+146j
.text:004041C1		       mov     eax, [ebp+oldpxcptinfoptrs]
.text:004041C4		       pop     ecx
.text:004041C5		       mov     [esi+60h], eax
.text:004041C8
.text:004041C8 loc_4041C8:			       ; CODE XREF: __XcptFilter+72j
.text:004041C8		       or      eax, 0FFFFFFFFh
.text:004041CB
.text:004041CB loc_4041CB:			       ; CODE XREF: __XcptFilter+59j
.text:004041CB					       ; __XcptFilter+6Aj
.text:004041CB		       pop     ebx
.text:004041CC		       pop     edi
.text:004041CD
.text:004041CD loc_4041CD:			       ; CODE XREF: __XcptFilter+Fj
.text:004041CD		       pop     esi
.text:004041CE		       leave
.text:004041CF		       retn
.text:004041CF __XcptFilter    endp
.text:004041CF
.text:004041D0
.text:004041D0 ; =============== S U B R O U T I N E =======================================
.text:004041D0
.text:004041D0
.text:004041D0 ; int __cdecl __CppXcptFilter(unsigned int xcptnum, _EXCEPTION_POINTERS *pxcptinfoptrs)
.text:004041D0 ___CppXcptFilter	proc near
.text:004041D0
.text:004041D0 xcptnum	       = dword ptr  4
.text:004041D0 pxcptinfoptrs   = dword ptr  8
.text:004041D0
.text:004041D0		       mov     eax, 0E06D7363h
.text:004041D5		       cmp     [esp+xcptnum], eax
.text:004041D9		       jnz     short loc_4041E8
.text:004041DB		       push    [esp+pxcptinfoptrs] ; pxcptinfoptrs
.text:004041DF		       push    eax	       ; xcptnum
.text:004041E0		       call    __XcptFilter
.text:004041E5		       pop     ecx
.text:004041E6		       pop     ecx
.text:004041E7		       retn
.text:004041E8 ; ---------------------------------------------------------------------------
.text:004041E8
.text:004041E8 loc_4041E8:			       ; CODE XREF: ___CppXcptFilter+9j
.text:004041E8		       xor     eax, eax
.text:004041EA		       retn
.text:004041EA ___CppXcptFilter	endp
.text:004041EA
.text:004041EB
.text:004041EB ; =============== S U B R O U T I N E =======================================
.text:004041EB
.text:004041EB
.text:004041EB ; void __cdecl _initp_misc_winsig(void *enull)
.text:004041EB __initp_misc_winsig proc	near	       ; CODE XREF: __init_pointers+27p
.text:004041EB
.text:004041EB enull	       = dword ptr  4
.text:004041EB
.text:004041EB		       mov     eax, [esp+enull]
.text:004041EF		       mov     ctrlc_action, eax
.text:004041F4		       mov     ctrlbreak_action, eax
.text:004041F9		       mov     abort_action, eax
.text:004041FE		       mov     term_action, eax
.text:00404203		       retn
.text:00404203 __initp_misc_winsig endp
.text:00404203
.text:00404204
.text:00404204 ; =============== S U B R O U T I N E =======================================
.text:00404204
.text:00404204 ; Attributes: noreturn bp-based frame
.text:00404204
.text:00404204 ; int __stdcall ctrlevent_capture(unsigned int CtrlType)
.text:00404204 ctrlevent_capture proc near	       ; DATA XREF: _signal+112o
.text:00404204
.text:00404204 sigcode	       = dword ptr -20h
.text:00404204 ctrl_action     = dword ptr -1Ch
.text:00404204 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00404204 CtrlType	       = dword ptr  8
.text:00404204
.text:00404204		       push    10h
.text:00404206		       push    offset dword_420618
.text:0040420B		       call    __SEH_prolog4
.text:00404210		       xor     edi, edi
.text:00404212		       push    edi	       ; locknum
.text:00404213		       call    __lock
.text:00404218		       pop     ecx
.text:00404219		       mov     [ebp+ms_exc.disabled], edi
.text:0040421C		       cmp     [ebp+CtrlType], edi
.text:0040421F		       jnz     short loc_40423D
.text:00404221		       mov     esi, offset ctrlc_action
.text:00404226		       push    ctrlc_action    ; codedptr
.text:0040422C		       call    __decode_pointer
.text:00404231		       mov     [ebp+ctrl_action], eax
.text:00404234		       mov     [ebp+sigcode], 2
.text:0040423B		       jmp     short loc_404257
.text:0040423D ; ---------------------------------------------------------------------------
.text:0040423D
.text:0040423D loc_40423D:			       ; CODE XREF: ctrlevent_capture+1Bj
.text:0040423D		       mov     esi, offset ctrlbreak_action
.text:00404242		       push    ctrlbreak_action	; codedptr
.text:00404248		       call    __decode_pointer
.text:0040424D		       mov     [ebp+ctrl_action], eax
.text:00404250		       mov     [ebp+sigcode], 15h
.text:00404257
.text:00404257 loc_404257:			       ; CODE XREF: ctrlevent_capture+37j
.text:00404257		       pop     ecx
.text:00404258		       cmp     eax, edi
.text:0040425A		       jz      short loc_404268
.text:0040425C		       cmp     eax, 1
.text:0040425F		       jz      short loc_404268
.text:00404261		       call    __encoded_null
.text:00404266		       mov     [esi], eax
.text:00404268
.text:00404268 loc_404268:			       ; CODE XREF: ctrlevent_capture+56j
.text:00404268					       ; ctrlevent_capture+5Bj
.text:00404268		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040426F		       call    $LN12_1
.text:00404274 ; ---------------------------------------------------------------------------
.text:00404274
.text:00404274 $LN13_1:
.text:00404274		       cmp     [ebp+ctrl_action], edi
.text:00404277		       jnz     short loc_404287
.text:00404279		       xor     eax, eax
.text:0040427B		       jmp     short loc_404297
.text:0040427D ; ---------------------------------------------------------------------------
.text:0040427D
.text:0040427D $LN10_1:				       ; DATA XREF: .rdata:00420630o
.text:0040427D		       xor     edi, edi
.text:0040427F
.text:0040427F $LN12_1:				       ; CODE XREF: ctrlevent_capture+6Bp
.text:0040427F		       push    edi	       ; locknum
.text:00404280		       call    __unlock
.text:00404285		       pop     ecx
.text:00404286
.text:00404286 $LN11_1:
.text:00404286		       retn
.text:00404287 ; ---------------------------------------------------------------------------
.text:00404287
.text:00404287 loc_404287:			       ; CODE XREF: ctrlevent_capture+73j
.text:00404287		       cmp     [ebp+ctrl_action], 1
.text:0040428B		       jz      short loc_404294
.text:0040428D		       push    [ebp+sigcode]
.text:00404290		       call    [ebp+ctrl_action]
.text:00404293		       pop     ecx
.text:00404294
.text:00404294 loc_404294:			       ; CODE XREF: ctrlevent_capture+87j
.text:00404294		       xor     eax, eax
.text:00404296		       inc     eax
.text:00404297
.text:00404297 loc_404297:			       ; CODE XREF: ctrlevent_capture+77j
.text:00404297		       call    __SEH_epilog4
.text:0040429C		       retn    4
.text:0040429C ctrlevent_capture endp ;	sp-analysis failed
.text:0040429C
.text:0040429F
.text:0040429F ; =============== S U B R O U T I N E =======================================
.text:0040429F
.text:0040429F
.text:0040429F ; _XCPT_ACTION *__usercall siglookup<eax>(int signum<edx>, _XCPT_ACTION *pxcptacttab)
.text:0040429F siglookup       proc near	       ; CODE XREF: _signal+AFp
.text:0040429F					       ; _raise+5Ap
.text:0040429F
.text:0040429F pxcptacttab     = dword ptr  4
.text:0040429F
.text:0040429F signum =	edx
.text:0040429F		       mov     eax, [esp+pxcptacttab]
.text:004042A3		       mov     ecx, __XcptActTabCount
.text:004042A9		       push    esi
.text:004042AA
.text:004042AA loc_4042AA:			       ; CODE XREF: siglookup+1Ej
.text:004042AA		       cmp     [eax+4],	signum
.text:004042AD		       jz      short loc_4042BF
.text:004042AF		       mov     esi, ecx
.text:004042B1		       imul    esi, 0Ch
.text:004042B4		       add     esi, [esp+4+pxcptacttab]
.text:004042B8		       add     eax, 0Ch
.text:004042BB		       cmp     eax, esi
.text:004042BD		       jb      short loc_4042AA
.text:004042BF
.text:004042BF loc_4042BF:			       ; CODE XREF: siglookup+Ej
.text:004042BF		       imul    ecx, 0Ch
.text:004042C2		       add     ecx, [esp+4+pxcptacttab]
.text:004042C6		       pop     esi
.text:004042C7		       cmp     eax, ecx
.text:004042C9		       jnb     short loc_4042D0
.text:004042CB		       cmp     [eax+4],	signum
.text:004042CE		       jz      short locret_4042D2
.text:004042D0
.text:004042D0 loc_4042D0:			       ; CODE XREF: siglookup+2Aj
.text:004042D0		       xor     eax, eax
.text:004042D2
.text:004042D2 locret_4042D2:			       ; CODE XREF: siglookup+2Fj
.text:004042D2		       retn
.text:004042D2 siglookup       endp
.text:004042D2
.text:004042D3
.text:004042D3 ; =============== S U B R O U T I N E =======================================
.text:004042D3
.text:004042D3
.text:004042D3 ; void (__cdecl *__cdecl	__get_sigabrt())(int)
.text:004042D3 ___get_sigabrt  proc near	       ; CODE XREF: _abort:loc_40AC0Dp
.text:004042D3		       push    abort_action    ; codedptr
.text:004042D9		       call    __decode_pointer
.text:004042DE		       pop     ecx
.text:004042DF		       retn
.text:004042DF ___get_sigabrt  endp
.text:004042DF
.text:004042E0
.text:004042E0 ; =============== S U B R O U T I N E =======================================
.text:004042E0
.text:004042E0
.text:004042E0 ; int *__cdecl __fpecode()
.text:004042E0 ___fpecode      proc near
.text:004042E0		       call    __getptd
.text:004042E5		       add     eax, 64h
.text:004042E8		       retn
.text:004042E8 ___fpecode      endp
.text:004042E8
.text:004042E9
.text:004042E9 ; =============== S U B R O U T I N E =======================================
.text:004042E9
.text:004042E9
.text:004042E9 ; void **__cdecl	__pxcptinfoptrs()
.text:004042E9 ___pxcptinfoptrs	proc near
.text:004042E9		       call    __getptd
.text:004042EE		       add     eax, 60h
.text:004042F1		       retn
.text:004042F1 ___pxcptinfoptrs	endp
.text:004042F1
.text:004042F2
.text:004042F2 ; =============== S U B R O U T I N E =======================================
.text:004042F2
.text:004042F2 ; Attributes: bp-based frame
.text:004042F2
.text:004042F2 ; void (__cdecl *__cdecl	signal(int signum, void	(__cdecl *sigact)(int)))(int)
.text:004042F2 _signal	       proc near
.text:004042F2
.text:004042F2 SetConsoleCtrlError= dword ptr -20h
.text:004042F2 oldsigact       = dword ptr -1Ch
.text:004042F2 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004042F2 signum	       = dword ptr  8
.text:004042F2 sigact	       = dword ptr  0Ch
.text:004042F2
.text:004042F2		       push    10h
.text:004042F4		       push    offset dword_420638
.text:004042F9		       call    __SEH_prolog4
.text:004042FE		       and     [ebp+SetConsoleCtrlError], 0
.text:00404302		       mov     esi, [ebp+sigact]
.text:00404305		       mov     ebx, [ebp+signum]
.text:00404308		       cmp     esi, 4
.text:0040430B		       jz      sigreterror
.text:00404311		       cmp     esi, 3
.text:00404314		       jz      sigreterror
.text:0040431A		       push    2
.text:0040431C		       pop     edi
.text:0040431D		       cmp     ebx, edi
.text:0040431F		       jz      loc_4043E4
.text:00404325		       cmp     ebx, 15h
.text:00404328		       jz      loc_4043E4
.text:0040432E		       cmp     ebx, 16h
.text:00404331		       jz      loc_4043E4
.text:00404337		       cmp     ebx, 6
.text:0040433A		       jz      loc_4043E4
.text:00404340		       cmp     ebx, 0Fh
.text:00404343		       jz      loc_4043E4
.text:00404349		       cmp     ebx, 8
.text:0040434C		       jz      short loc_40435C
.text:0040434E		       cmp     ebx, 4
.text:00404351		       jz      short loc_40435C
.text:00404353		       cmp     ebx, 0Bh
.text:00404356		       jnz     sigreterror
.text:0040435C
.text:0040435C loc_40435C:			       ; CODE XREF: _signal+5Aj
.text:0040435C					       ; _signal+5Fj
.text:0040435C		       call    __getptd_noexit
.text:00404361		       mov     esi, eax
.text:00404363		       test    esi, esi
.text:00404365		       jz      sigreterror
.text:0040436B		       mov     edi, offset __XcptActTab
.text:00404370		       cmp     [esi+5Ch], edi
.text:00404373		       jnz     short loc_40439C
.text:00404375		       push    __XcptActTabSize	; cb
.text:0040437B		       call    __malloc_crt
.text:00404380		       pop     ecx
.text:00404381		       mov     [esi+5Ch], eax
.text:00404384		       test    eax, eax
.text:00404386		       jz      sigreterror
.text:0040438C		       push    __XcptActTabSize	; count
.text:00404392		       push    edi	       ; src
.text:00404393		       push    eax	       ; dst
.text:00404394		       call    _memcpy
.text:00404399		       add     esp, 0Ch
.text:0040439C
.text:0040439C loc_40439C:			       ; CODE XREF: _signal+81j
.text:0040439C		       push    dword ptr [esi+5Ch] ; pxcptacttab
.text:0040439F		       mov     edx, ebx	       ; signum
.text:004043A1		       call    siglookup
.text:004043A6		       pop     ecx
.text:004043A7		       test    eax, eax
.text:004043A9		       jz      sigreterror
.text:004043AF		       mov     edx, [eax+8]
.text:004043B2		       mov     ecx, [ebp+sigact]
.text:004043B5		       cmp     ecx, 2
.text:004043B8		       jz      sigretok
.text:004043BE		       jmp     short loc_4043DA
.text:004043C0 ; ---------------------------------------------------------------------------
.text:004043C0
.text:004043C0 loc_4043C0:			       ; CODE XREF: _signal+EBj
.text:004043C0		       mov     [eax+8],	ecx
.text:004043C3		       add     eax, 0Ch
.text:004043C6		       mov     edi, __XcptActTabCount
.text:004043CC		       imul    edi, 0Ch
.text:004043CF		       add     edi, [esi+5Ch]
.text:004043D2		       cmp     eax, edi
.text:004043D4		       jnb     sigretok
.text:004043DA
.text:004043DA loc_4043DA:			       ; CODE XREF: _signal+CCj
.text:004043DA		       cmp     [eax+4],	ebx
.text:004043DD		       jz      short loc_4043C0
.text:004043DF		       jmp     sigretok
.text:004043E4 ; ---------------------------------------------------------------------------
.text:004043E4
.text:004043E4 loc_4043E4:			       ; CODE XREF: _signal+2Dj
.text:004043E4					       ; _signal+36j ...
.text:004043E4		       push    0	       ; locknum
.text:004043E6		       call    __lock
.text:004043EB		       pop     ecx
.text:004043EC		       and     [ebp+ms_exc.disabled], 0
.text:004043F0		       cmp     ebx, edi
.text:004043F2		       jz      short loc_4043F9
.text:004043F4		       cmp     ebx, 15h
.text:004043F7		       jnz     short loc_404437
.text:004043F9
.text:004043F9 loc_4043F9:			       ; CODE XREF: _signal+100j
.text:004043F9		       cmp     ConsoleCtrlHandler_Installed, 0
.text:00404400		       jnz     short loc_404437
.text:00404402		       push    1	       ; Add
.text:00404404		       push    offset ctrlevent_capture	; HandlerRoutine
.text:00404409		       call    ds:__imp__SetConsoleCtrlHandler@8 ; SetConsoleCtrlHandler(x,x)
.text:0040440F		       xor     ecx, ecx
.text:00404411		       inc     ecx
.text:00404412		       cmp     eax, ecx
.text:00404414		       jnz     short loc_40441E
.text:00404416		       mov     ConsoleCtrlHandler_Installed, ecx
.text:0040441C		       jmp     short loc_404437
.text:0040441E ; ---------------------------------------------------------------------------
.text:0040441E
.text:0040441E loc_40441E:			       ; CODE XREF: _signal+122j
.text:0040441E		       call    ___doserrno
.text:00404423		       mov     esi, eax
.text:00404425		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040442B		       mov     [esi], eax
.text:0040442D		       mov     [ebp+SetConsoleCtrlError], 1
.text:00404434		       mov     esi, [ebp+sigact]
.text:00404437
.text:00404437 loc_404437:			       ; CODE XREF: _signal+105j
.text:00404437					       ; _signal+10Ej ...
.text:00404437		       mov     eax, ebx
.text:00404439		       sub     eax, edi
.text:0040443B		       jz      short loc_4044AF
.text:0040443D		       sub     eax, 4
.text:00404440		       jz      short loc_40444F
.text:00404442		       sub     eax, 9
.text:00404445		       jz      short loc_40448F
.text:00404447		       sub     eax, 6
.text:0040444A		       jz      short loc_40446F
.text:0040444C		       dec     eax
.text:0040444D		       jnz     short loc_4044CE
.text:0040444F
.text:0040444F loc_40444F:			       ; CODE XREF: _signal+14Ej
.text:0040444F		       push    abort_action    ; codedptr
.text:00404455		       call    __decode_pointer
.text:0040445A		       pop     ecx
.text:0040445B		       mov     [ebp+oldsigact],	eax
.text:0040445E		       cmp     esi, edi
.text:00404460		       jz      short loc_4044CE
.text:00404462		       push    esi	       ; ptr
.text:00404463		       call    __encode_pointer
.text:00404468		       mov     abort_action, eax
.text:0040446D		       jmp     short loc_4044CD
.text:0040446F ; ---------------------------------------------------------------------------
.text:0040446F
.text:0040446F loc_40446F:			       ; CODE XREF: _signal+158j
.text:0040446F		       push    ctrlbreak_action	; codedptr
.text:00404475		       call    __decode_pointer
.text:0040447A		       pop     ecx
.text:0040447B		       mov     [ebp+oldsigact],	eax
.text:0040447E		       cmp     esi, edi
.text:00404480		       jz      short loc_4044CE
.text:00404482		       push    esi	       ; ptr
.text:00404483		       call    __encode_pointer
.text:00404488		       mov     ctrlbreak_action, eax
.text:0040448D		       jmp     short loc_4044CD
.text:0040448F ; ---------------------------------------------------------------------------
.text:0040448F
.text:0040448F loc_40448F:			       ; CODE XREF: _signal+153j
.text:0040448F		       push    term_action     ; codedptr
.text:00404495		       call    __decode_pointer
.text:0040449A		       pop     ecx
.text:0040449B		       mov     [ebp+oldsigact],	eax
.text:0040449E		       cmp     esi, edi
.text:004044A0		       jz      short loc_4044CE
.text:004044A2		       push    esi	       ; ptr
.text:004044A3		       call    __encode_pointer
.text:004044A8		       mov     term_action, eax
.text:004044AD		       jmp     short loc_4044CD
.text:004044AF ; ---------------------------------------------------------------------------
.text:004044AF
.text:004044AF loc_4044AF:			       ; CODE XREF: _signal+149j
.text:004044AF		       push    ctrlc_action    ; codedptr
.text:004044B5		       call    __decode_pointer
.text:004044BA		       pop     ecx
.text:004044BB		       mov     [ebp+oldsigact],	eax
.text:004044BE		       cmp     esi, edi
.text:004044C0		       jz      short loc_4044CE
.text:004044C2		       push    esi	       ; ptr
.text:004044C3		       call    __encode_pointer
.text:004044C8		       mov     ctrlc_action, eax
.text:004044CD
.text:004044CD loc_4044CD:			       ; CODE XREF: _signal+17Bj
.text:004044CD					       ; _signal+19Bj ...
.text:004044CD		       pop     ecx
.text:004044CE
.text:004044CE loc_4044CE:			       ; CODE XREF: _signal+15Bj
.text:004044CE					       ; _signal+16Ej ...
.text:004044CE		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004044D5		       call    $LN43
.text:004044DA
.text:004044DA $LN44:
.text:004044DA		       cmp     [ebp+SetConsoleCtrlError], 0
.text:004044DE		       jnz     short sigreterror
.text:004044E0		       mov     edx, [ebp+oldsigact]
.text:004044E3
.text:004044E3 sigretok:			       ; CODE XREF: _signal+C6j
.text:004044E3					       ; _signal+E2j ...
.text:004044E3		       mov     eax, edx
.text:004044E5		       jmp     short loc_404529
.text:004044E7 ; ---------------------------------------------------------------------------
.text:004044E7
.text:004044E7 $LN41:				       ; DATA XREF: .rdata:00420650o
.text:004044E7		       mov     ebx, [ebp+signum]
.text:004044EA
.text:004044EA $LN43:				       ; CODE XREF: _signal+1E3p
.text:004044EA		       push    0	       ; locknum
.text:004044EC		       call    __unlock
.text:004044F1		       pop     ecx
.text:004044F2
.text:004044F2 $LN42:
.text:004044F2		       retn
.text:004044F3 ; ---------------------------------------------------------------------------
.text:004044F3
.text:004044F3 sigreterror:			       ; CODE XREF: _signal+19j
.text:004044F3					       ; _signal+22j ...
.text:004044F3		       cmp     ebx, 1
.text:004044F6		       jz      short loc_404526
.text:004044F8		       cmp     ebx, 3
.text:004044FB		       jz      short loc_404526
.text:004044FD		       cmp     ebx, 0Dh
.text:00404500		       jz      short loc_404526
.text:00404502		       cmp     ebx, 0Fh
.text:00404505		       jle     short loc_40450C
.text:00404507		       cmp     ebx, 11h
.text:0040450A		       jle     short loc_404526
.text:0040450C
.text:0040450C loc_40450C:			       ; CODE XREF: _signal+213j
.text:0040450C		       call    __errno
.text:00404511		       mov     dword ptr [eax],	16h
.text:00404517		       xor     eax, eax
.text:00404519		       push    eax	       ; pReserved
.text:0040451A		       push    eax	       ; nLine
.text:0040451B		       push    eax	       ; pszFile
.text:0040451C		       push    eax	       ; pszFunction
.text:0040451D		       push    eax	       ; pszExpression
.text:0040451E		       call    __invalid_parameter
.text:00404523		       add     esp, 14h
.text:00404526
.text:00404526 loc_404526:			       ; CODE XREF: _signal+204j
.text:00404526					       ; _signal+209j ...
.text:00404526		       or      eax, 0FFFFFFFFh
.text:00404529
.text:00404529 loc_404529:			       ; CODE XREF: _signal+1F3j
.text:00404529		       call    __SEH_epilog4
.text:0040452E		       retn
.text:0040452E _signal	       endp ; sp-analysis failed
.text:0040452E
.text:0040452F
.text:0040452F ; =============== S U B R O U T I N E =======================================
.text:0040452F
.text:0040452F ; Attributes: bp-based frame
.text:0040452F
.text:0040452F ; int __cdecl raise(int signum)
.text:0040452F _raise	       proc near	       ; CODE XREF: _abort+38p
.text:0040452F
.text:0040452F oldfpecode      = dword ptr -30h
.text:0040452F oldpxcptinfoptrs= dword ptr -2Ch
.text:0040452F ptd	       = dword ptr -28h
.text:0040452F indx	       = dword ptr -24h
.text:0040452F sigact	       = dword ptr -20h
.text:0040452F siglock	       = dword ptr -1Ch
.text:0040452F ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040452F signum	       = dword ptr  8
.text:0040452F
.text:0040452F		       push    20h
.text:00404531		       push    offset dword_420658
.text:00404536		       call    __SEH_prolog4
.text:0040453B		       xor     edi, edi
.text:0040453D		       mov     [ebp+siglock], edi
.text:00404540		       mov     [ebp+ptd], edi
.text:00404543		       mov     ebx, [ebp+signum]
.text:00404546		       cmp     ebx, 0Bh
.text:00404549		       jg      short loc_404597
.text:0040454B		       jz      short loc_404562
.text:0040454D		       mov     eax, ebx
.text:0040454F		       push    2
.text:00404551		       pop     ecx
.text:00404552		       sub     eax, ecx
.text:00404554		       jz      short loc_404578
.text:00404556		       sub     eax, ecx
.text:00404558		       jz      short loc_404562
.text:0040455A		       sub     eax, ecx
.text:0040455C		       jz      short loc_4045C2
.text:0040455E		       sub     eax, ecx
.text:00404560		       jnz     short loc_4045A6
.text:00404562
.text:00404562 loc_404562:			       ; CODE XREF: _raise+1Cj
.text:00404562					       ; _raise+29j
.text:00404562		       call    __getptd_noexit
.text:00404567		       mov     edi, eax
.text:00404569		       mov     [ebp+ptd], edi
.text:0040456C		       test    edi, edi
.text:0040456E		       jnz     short loc_404584
.text:00404570
.text:00404570 loc_404570:			       ; CODE XREF: _raise+91j
.text:00404570		       or      eax, 0FFFFFFFFh
.text:00404573		       jmp     loc_4046D9
.text:00404578 ; ---------------------------------------------------------------------------
.text:00404578
.text:00404578 loc_404578:			       ; CODE XREF: _raise+25j
.text:00404578		       mov     esi, offset ctrlc_action
.text:0040457D		       mov     eax, ctrlc_action
.text:00404582		       jmp     short loc_4045E4
.text:00404584 ; ---------------------------------------------------------------------------
.text:00404584
.text:00404584 loc_404584:			       ; CODE XREF: _raise+3Fj
.text:00404584		       push    dword ptr [edi+5Ch] ; pxcptacttab
.text:00404587		       mov     edx, ebx	       ; signum
.text:00404589		       call    siglookup
.text:0040458E		       mov     esi, eax
.text:00404590		       add     esi, 8
.text:00404593		       mov     eax, [esi]
.text:00404595		       jmp     short loc_4045F1
.text:00404597 ; ---------------------------------------------------------------------------
.text:00404597
.text:00404597 loc_404597:			       ; CODE XREF: _raise+1Aj
.text:00404597		       mov     eax, ebx
.text:00404599		       sub     eax, 0Fh
.text:0040459C		       jz      short loc_4045DA
.text:0040459E		       sub     eax, 6
.text:004045A1		       jz      short loc_4045CE
.text:004045A3		       dec     eax
.text:004045A4		       jz      short loc_4045C2
.text:004045A6
.text:004045A6 loc_4045A6:			       ; CODE XREF: _raise+31j
.text:004045A6		       call    __errno
.text:004045AB		       mov     dword ptr [eax],	16h
.text:004045B1		       xor     eax, eax
.text:004045B3		       push    eax	       ; pReserved
.text:004045B4		       push    eax	       ; nLine
.text:004045B5		       push    eax	       ; pszFile
.text:004045B6		       push    eax	       ; pszFunction
.text:004045B7		       push    eax	       ; pszExpression
.text:004045B8		       call    __invalid_parameter
.text:004045BD		       add     esp, 14h
.text:004045C0		       jmp     short loc_404570
.text:004045C2 ; ---------------------------------------------------------------------------
.text:004045C2
.text:004045C2 loc_4045C2:			       ; CODE XREF: _raise+2Dj
.text:004045C2					       ; _raise+75j
.text:004045C2		       mov     esi, offset abort_action
.text:004045C7		       mov     eax, abort_action
.text:004045CC		       jmp     short loc_4045E4
.text:004045CE ; ---------------------------------------------------------------------------
.text:004045CE
.text:004045CE loc_4045CE:			       ; CODE XREF: _raise+72j
.text:004045CE		       mov     esi, offset ctrlbreak_action
.text:004045D3		       mov     eax, ctrlbreak_action
.text:004045D8		       jmp     short loc_4045E4
.text:004045DA ; ---------------------------------------------------------------------------
.text:004045DA
.text:004045DA loc_4045DA:			       ; CODE XREF: _raise+6Dj
.text:004045DA		       mov     esi, offset term_action
.text:004045DF		       mov     eax, term_action
.text:004045E4
.text:004045E4 loc_4045E4:			       ; CODE XREF: _raise+53j
.text:004045E4					       ; _raise+9Dj ...
.text:004045E4		       mov     [ebp+siglock], 1
.text:004045EB		       push    eax	       ; codedptr
.text:004045EC		       call    __decode_pointer
.text:004045F1
.text:004045F1 loc_4045F1:			       ; CODE XREF: _raise+66j
.text:004045F1		       mov     [ebp+sigact], eax
.text:004045F4		       pop     ecx
.text:004045F5
.text:004045F5 decode_done:
.text:004045F5		       xor     eax, eax
.text:004045F7		       cmp     [ebp+sigact], 1
.text:004045FB		       jz      loc_4046D9
.text:00404601		       cmp     [ebp+sigact], eax
.text:00404604		       jnz     short $LN51
.text:00404606		       push    3	       ; code
.text:00404608		       call    __exit
.text:0040460D ; ---------------------------------------------------------------------------
.text:0040460D
.text:0040460D $LN51:				       ; CODE XREF: _raise+D5j
.text:0040460D		       cmp     [ebp+siglock], eax
.text:00404610		       jz      short loc_404619
.text:00404612		       push    eax	       ; locknum
.text:00404613		       call    __lock
.text:00404618		       pop     ecx
.text:00404619
.text:00404619 loc_404619:			       ; CODE XREF: _raise+E1j
.text:00404619		       xor     eax, eax
.text:0040461B		       mov     [ebp+ms_exc.disabled], eax
.text:0040461E		       cmp     ebx, 8
.text:00404621		       jz      short loc_40462D
.text:00404623		       cmp     ebx, 0Bh
.text:00404626		       jz      short loc_40462D
.text:00404628		       cmp     ebx, 4
.text:0040462B		       jnz     short loc_404648
.text:0040462D
.text:0040462D loc_40462D:			       ; CODE XREF: _raise+F2j
.text:0040462D					       ; _raise+F7j
.text:0040462D		       mov     ecx, [edi+60h]
.text:00404630		       mov     [ebp+oldpxcptinfoptrs], ecx
.text:00404633		       mov     [edi+60h], eax
.text:00404636		       cmp     ebx, 8
.text:00404639		       jnz     short loc_40467B
.text:0040463B		       mov     ecx, [edi+64h]
.text:0040463E		       mov     [ebp+oldfpecode], ecx
.text:00404641		       mov     dword ptr [edi+64h], 8Ch
.text:00404648
.text:00404648 loc_404648:			       ; CODE XREF: _raise+FCj
.text:00404648		       cmp     ebx, 8
.text:0040464B		       jnz     short loc_40467B
.text:0040464D		       mov     ecx, __First_FPE_Indx
.text:00404653		       mov     [ebp+indx], ecx
.text:00404656
.text:00404656 loc_404656:			       ; CODE XREF: _raise+14Aj
.text:00404656		       mov     ecx, __Num_FPE
.text:0040465C		       mov     edx, __First_FPE_Indx
.text:00404662		       add     ecx, edx
.text:00404664		       cmp     [ebp+indx], ecx
.text:00404667		       jge     short loc_404682
.text:00404669		       mov     ecx, [ebp+indx]
.text:0040466C		       imul    ecx, 0Ch
.text:0040466F		       mov     edx, [edi+5Ch]
.text:00404672		       mov     [ecx+edx+8], eax
.text:00404676		       inc     [ebp+indx]
.text:00404679		       jmp     short loc_404656
.text:0040467B ; ---------------------------------------------------------------------------
.text:0040467B
.text:0040467B loc_40467B:			       ; CODE XREF: _raise+10Aj
.text:0040467B					       ; _raise+11Cj
.text:0040467B		       call    __encoded_null
.text:00404680		       mov     [esi], eax
.text:00404682
.text:00404682 loc_404682:			       ; CODE XREF: _raise+138j
.text:00404682		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404689		       call    $LN37
.text:0040468E
.text:0040468E $LN38:
.text:0040468E		       cmp     ebx, 8
.text:00404691		       jnz     short loc_4046B2
.text:00404693		       push    dword ptr [edi+64h]
.text:00404696		       push    ebx
.text:00404697		       call    [ebp+sigact]
.text:0040469A		       pop     ecx
.text:0040469B		       jmp     short loc_4046B6
.text:0040469D ; ---------------------------------------------------------------------------
.text:0040469D
.text:0040469D $LN35_0:				       ; DATA XREF: .rdata:00420670o
.text:0040469D		       mov     ebx, [ebp+signum]
.text:004046A0		       mov     edi, [ebp+ptd]
.text:004046A3
.text:004046A3 $LN37:				       ; CODE XREF: _raise+15Ap
.text:004046A3		       cmp     [ebp+siglock], 0
.text:004046A7		       jz      short $LN36_0
.text:004046A9		       push    0	       ; locknum
.text:004046AB		       call    __unlock
.text:004046B0		       pop     ecx
.text:004046B1
.text:004046B1 $LN36_0:				       ; CODE XREF: _raise+178j
.text:004046B1		       retn
.text:004046B2 ; ---------------------------------------------------------------------------
.text:004046B2
.text:004046B2 loc_4046B2:			       ; CODE XREF: _raise+162j
.text:004046B2		       push    ebx
.text:004046B3		       call    [ebp+sigact]
.text:004046B6
.text:004046B6 loc_4046B6:			       ; CODE XREF: _raise+16Cj
.text:004046B6		       pop     ecx
.text:004046B7		       cmp     ebx, 8
.text:004046BA		       jz      short loc_4046C6
.text:004046BC		       cmp     ebx, 0Bh
.text:004046BF		       jz      short loc_4046C6
.text:004046C1		       cmp     ebx, 4
.text:004046C4		       jnz     short loc_4046D7
.text:004046C6
.text:004046C6 loc_4046C6:			       ; CODE XREF: _raise+18Bj
.text:004046C6					       ; _raise+190j
.text:004046C6		       mov     eax, [ebp+oldpxcptinfoptrs]
.text:004046C9		       mov     [edi+60h], eax
.text:004046CC		       cmp     ebx, 8
.text:004046CF		       jnz     short loc_4046D7
.text:004046D1		       mov     eax, [ebp+oldfpecode]
.text:004046D4		       mov     [edi+64h], eax
.text:004046D7
.text:004046D7 loc_4046D7:			       ; CODE XREF: _raise+195j
.text:004046D7					       ; _raise+1A0j
.text:004046D7		       xor     eax, eax
.text:004046D9
.text:004046D9 loc_4046D9:			       ; CODE XREF: _raise+44j
.text:004046D9					       ; _raise+CCj
.text:004046D9		       call    __SEH_epilog4
.text:004046DE		       retn
.text:004046DE _raise	       endp ; sp-analysis failed
.text:004046DE
.text:004046DF
.text:004046DF ; =============== S U B R O U T I N E =======================================
.text:004046DF
.text:004046DF
.text:004046DF ; void __cdecl _initp_misc_rand_s(void *enull)
.text:004046DF __initp_misc_rand_s proc	near	       ; CODE XREF: __init_pointers+21p
.text:004046DF
.text:004046DF enull	       = dword ptr  4
.text:004046DF
.text:004046DF		       mov     eax, [esp+enull]
.text:004046E3		       mov     g_pfnRtlGenRandom, eax
.text:004046E8		       retn
.text:004046E8 __initp_misc_rand_s endp
.text:004046E8
.text:004046E9
.text:004046E9 ; =============== S U B R O U T I N E =======================================
.text:004046E9
.text:004046E9
.text:004046E9 ; int __cdecl rand_s(unsigned int *_RandomValue)
.text:004046E9 _rand_s	       proc near
.text:004046E9
.text:004046E9 enull	       = dword ptr  4
.text:004046E9
.text:004046E9		       push    ebp
.text:004046EA		       push    esi
.text:004046EB		       push    edi
.text:004046EC		       push    g_pfnRtlGenRandom ; codedptr
.text:004046F2		       call    __decode_pointer
.text:004046F7		       mov     ebp, [esp+10h+enull]
.text:004046FB		       xor     esi, esi
.text:004046FD		       cmp     ebp, esi
.text:004046FF		       pop     ecx
.text:00404700		       mov     edi, eax
.text:00404702		       jnz     short loc_404722
.text:00404704		       call    __errno
.text:00404709		       push    16h
.text:0040470B		       pop     edi
.text:0040470C		       push    esi	       ; pReserved
.text:0040470D		       push    esi	       ; nLine
.text:0040470E		       push    esi	       ; pszFile
.text:0040470F		       push    esi	       ; pszFunction
.text:00404710		       push    esi	       ; pszExpression
.text:00404711		       mov     [eax], edi
.text:00404713		       call    __invalid_parameter
.text:00404718		       add     esp, 14h
.text:0040471B		       mov     eax, edi
.text:0040471D		       jmp     loc_4047E9
.text:00404722 ; ---------------------------------------------------------------------------
.text:00404722
.text:00404722 loc_404722:			       ; CODE XREF: _rand_s+19j
.text:00404722		       cmp     edi, esi
.text:00404724		       push    ebx
.text:00404725		       mov     [ebp+0],	esi
.text:00404728		       jnz     loc_4047C9
.text:0040472E		       push    offset LibFileName ; "ADVAPI32.DLL"
.text:00404733		       call    ds:__imp__LoadLibraryA@4	; LoadLibraryA(x)
.text:00404739		       mov     ebx, eax
.text:0040473B		       cmp     ebx, esi
.text:0040473D		       jnz     short loc_40475D
.text:0040473F		       call    __errno
.text:00404744		       push    16h
.text:00404746		       pop     edi
.text:00404747		       push    esi	       ; pReserved
.text:00404748		       push    esi	       ; nLine
.text:00404749		       push    esi	       ; pszFile
.text:0040474A		       push    esi	       ; pszFunction
.text:0040474B		       push    esi	       ; pszExpression
.text:0040474C		       mov     [eax], edi
.text:0040474E		       call    __invalid_parameter
.text:00404753		       add     esp, 14h
.text:00404756		       mov     eax, edi
.text:00404758		       jmp     loc_4047E8
.text:0040475D ; ---------------------------------------------------------------------------
.text:0040475D
.text:0040475D loc_40475D:			       ; CODE XREF: _rand_s+54j
.text:0040475D		       push    offset aSystemfunction ;	"SystemFunction036"
.text:00404762		       push    ebx	       ; hModule
.text:00404763		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00404769		       mov     edi, eax
.text:0040476B		       cmp     edi, esi
.text:0040476D		       jnz     short loc_40479E
.text:0040476F		       call    __errno
.text:00404774		       mov     edi, ds:__imp__GetLastError@0 ; GetLastError()
.text:0040477A		       mov     ebx, eax
.text:0040477C		       call    edi ; GetLastError() ; GetLastError()
.text:0040477E		       push    eax	       ; oserrno
.text:0040477F		       call    __get_errno_from_oserr
.text:00404784		       push    esi	       ; pReserved
.text:00404785		       push    esi	       ; nLine
.text:00404786		       push    esi	       ; pszFile
.text:00404787		       push    esi	       ; pszFunction
.text:00404788		       push    esi	       ; pszExpression
.text:00404789		       mov     [ebx], eax
.text:0040478B		       call    __invalid_parameter
.text:00404790		       add     esp, 18h
.text:00404793		       call    edi ; GetLastError() ; GetLastError()
.text:00404795		       push    eax	       ; oserrno
.text:00404796		       call    __get_errno_from_oserr
.text:0040479B		       pop     ecx
.text:0040479C		       jmp     short loc_4047E8
.text:0040479E ; ---------------------------------------------------------------------------
.text:0040479E
.text:0040479E loc_40479E:			       ; CODE XREF: _rand_s+84j
.text:0040479E		       push    edi	       ; ptr
.text:0040479F		       call    __encode_pointer
.text:004047A4		       pop     ecx
.text:004047A5		       mov     esi, eax
.text:004047A7		       call    __encoded_null
.text:004047AC		       push    esi	       ; Value
.text:004047AD		       push    offset g_pfnRtlGenRandom	; Target
.text:004047B2		       mov     [esp+18h+enull],	eax
.text:004047B6		       call    ds:__imp__InterlockedExchange@8 ; InterlockedExchange(x,x)
.text:004047BC		       cmp     eax, [esp+10h+enull]
.text:004047C0		       jz      short loc_4047C9
.text:004047C2		       push    ebx	       ; hLibModule
.text:004047C3		       call    ds:__imp__FreeLibrary@4 ; FreeLibrary(x)
.text:004047C9
.text:004047C9 loc_4047C9:			       ; CODE XREF: _rand_s+3Fj
.text:004047C9					       ; _rand_s+D7j
.text:004047C9		       push    4
.text:004047CB		       push    ebp
.text:004047CC		       call    edi
.text:004047CE		       test    eax, eax
.text:004047D0		       jnz     short loc_4047E6
.text:004047D2		       call    __errno
.text:004047D7		       mov     dword ptr [eax],	0Ch
.text:004047DD		       call    __errno
.text:004047E2		       mov     eax, [eax]
.text:004047E4		       jmp     short loc_4047E8
.text:004047E6 ; ---------------------------------------------------------------------------
.text:004047E6
.text:004047E6 loc_4047E6:			       ; CODE XREF: _rand_s+E7j
.text:004047E6		       xor     eax, eax
.text:004047E8
.text:004047E8 loc_4047E8:			       ; CODE XREF: _rand_s+6Fj
.text:004047E8					       ; _rand_s+B3j ...
.text:004047E8		       pop     ebx
.text:004047E9
.text:004047E9 loc_4047E9:			       ; CODE XREF: _rand_s+34j
.text:004047E9		       pop     edi
.text:004047EA		       pop     esi
.text:004047EB		       pop     ebp
.text:004047EC		       retn
.text:004047EC _rand_s	       endp
.text:004047EC
.text:004047ED
.text:004047ED ; =============== S U B R O U T I N E =======================================
.text:004047ED
.text:004047ED ; Attributes: bp-based frame fpd=64h
.text:004047ED
.text:004047ED ; int __cdecl __getlocaleinfo(localeinfo_struct *plocinfo, int lc_type, unsigned	int localehandle, unsigned int fieldtype, void *address)
.text:004047ED ___getlocaleinfo	proc near	       ; CODE XREF: _get_lc_time+35p
.text:004047ED					       ; _get_lc_time+4Ap ...
.text:004047ED
.text:004047ED var_94	       = dword ptr -94h
.text:004047ED buffersize      = dword ptr -90h
.text:004047ED var_8C	       = dword ptr -8Ch
.text:004047ED bufferused      = dword ptr -88h
.text:004047ED cbuffer	       = byte ptr -84h
.text:004047ED var_4	       = dword ptr -4
.text:004047ED plocinfo	       = dword ptr  8
.text:004047ED lc_type	       = dword ptr  0Ch
.text:004047ED localehandle    = dword ptr  10h
.text:004047ED fieldtype       = dword ptr  14h
.text:004047ED address	       = dword ptr  18h
.text:004047ED
.text:004047ED		       push    ebp
.text:004047EE		       lea     ebp, [esp-64h]
.text:004047F2		       sub     esp, 94h
.text:004047F8		       mov     eax, ___security_cookie
.text:004047FD		       xor     eax, ebp
.text:004047FF		       mov     [ebp+64h+var_4],	eax
.text:00404802		       mov     eax, [ebp+64h+plocinfo]
.text:00404805		       push    ebx
.text:00404806		       push    esi
.text:00404807		       mov     esi, [ebp+64h+address]
.text:0040480A		       xor     ebx, ebx
.text:0040480C		       cmp     [ebp+64h+lc_type], 1
.text:00404810		       push    edi
.text:00404811		       mov     [ebp+64h+var_8C], eax
.text:00404814		       mov     [ebp+64h+var_94], esi
.text:00404817		       jnz     loc_4048FC
.text:0040481D		       push    ebx	       ; code_page
.text:0040481E		       push    80h	       ; cchData
.text:00404823		       lea     edi, [ebp+64h+cbuffer]
.text:00404826		       mov     ecx, edi
.text:00404828		       push    ecx	       ; lpLCData
.text:00404829		       push    [ebp+64h+fieldtype] ; LCType
.text:0040482C		       mov     [ebp+64h+bufferused], ebx
.text:0040482F		       push    [ebp+64h+localehandle] ;	Locale
.text:00404832		       push    eax	       ; plocinfo
.text:00404833		       call    ___crtGetLocaleInfoA
.text:00404838		       mov     esi, eax
.text:0040483A		       add     esp, 18h
.text:0040483D		       cmp     esi, ebx
.text:0040483F		       jnz     short loc_404898
.text:00404841		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00404847		       cmp     eax, 7Ah
.text:0040484A		       jnz     short loc_4048B7
.text:0040484C		       push    ebx	       ; code_page
.text:0040484D		       push    ebx	       ; cchData
.text:0040484E		       push    ebx	       ; lpLCData
.text:0040484F		       push    [ebp+64h+fieldtype] ; LCType
.text:00404852		       push    [ebp+64h+localehandle] ;	Locale
.text:00404855		       push    [ebp+64h+var_8C]	; plocinfo
.text:00404858		       call    ___crtGetLocaleInfoA
.text:0040485D		       add     esp, 18h
.text:00404860		       cmp     eax, ebx
.text:00404862		       mov     [ebp+64h+buffersize], eax
.text:00404865		       jz      short loc_4048B7
.text:00404867		       xor     esi, esi
.text:00404869		       inc     esi
.text:0040486A		       push    esi	       ; size
.text:0040486B		       push    eax	       ; count
.text:0040486C		       call    __calloc_crt
.text:00404871		       mov     edi, eax
.text:00404873		       cmp     edi, ebx
.text:00404875		       pop     ecx
.text:00404876		       pop     ecx
.text:00404877		       jz      short loc_4048B7
.text:00404879		       push    ebx	       ; code_page
.text:0040487A		       push    [ebp+64h+buffersize] ; cchData
.text:0040487D		       mov     [ebp+64h+bufferused], esi
.text:00404880		       push    edi	       ; lpLCData
.text:00404881		       push    [ebp+64h+fieldtype] ; LCType
.text:00404884		       push    [ebp+64h+localehandle] ;	Locale
.text:00404887		       push    [ebp+64h+var_8C]	; plocinfo
.text:0040488A		       call    ___crtGetLocaleInfoA
.text:0040488F		       mov     esi, eax
.text:00404891		       add     esp, 18h
.text:00404894		       cmp     esi, ebx
.text:00404896		       jz      short loc_4048B0
.text:00404898
.text:00404898 loc_404898:			       ; CODE XREF: ___getlocaleinfo+52j
.text:00404898		       push    1	       ; size
.text:0040489A		       push    esi	       ; count
.text:0040489B		       call    __calloc_crt
.text:004048A0		       cmp     eax, ebx
.text:004048A2		       pop     ecx
.text:004048A3		       pop     ecx
.text:004048A4		       mov     ecx, [ebp+64h+var_94]
.text:004048A7		       mov     [ecx], eax
.text:004048A9		       jnz     short loc_4048CC
.text:004048AB
.text:004048AB error:
.text:004048AB		       cmp     [ebp+64h+bufferused], ebx
.text:004048AE		       jz      short loc_4048B7
.text:004048B0
.text:004048B0 loc_4048B0:			       ; CODE XREF: ___getlocaleinfo+A9j
.text:004048B0		       push    edi	       ; pBlock
.text:004048B1		       call    _free
.text:004048B6		       pop     ecx
.text:004048B7
.text:004048B7 loc_4048B7:			       ; CODE XREF: ___getlocaleinfo+5Dj
.text:004048B7					       ; ___getlocaleinfo+78j ...
.text:004048B7		       or      eax, 0FFFFFFFFh
.text:004048BA
.text:004048BA loc_4048BA:			       ; CODE XREF: ___getlocaleinfo+10Dj
.text:004048BA		       mov     ecx, [ebp+64h+var_4]
.text:004048BD		       pop     edi
.text:004048BE		       pop     esi
.text:004048BF		       xor     ecx, ebp
.text:004048C1		       pop     ebx
.text:004048C2		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004048C7		       add     ebp, 64h
.text:004048CA		       leave
.text:004048CB		       retn
.text:004048CC ; ---------------------------------------------------------------------------
.text:004048CC
.text:004048CC loc_4048CC:			       ; CODE XREF: ___getlocaleinfo+BCj
.text:004048CC		       lea     ecx, [esi-1]
.text:004048CF		       push    ecx	       ; _Count
.text:004048D0		       push    edi	       ; _Src
.text:004048D1		       push    esi	       ; _SizeInBytes
.text:004048D2		       push    eax	       ; _Dst
.text:004048D3		       call    _strncpy_s
.text:004048D8		       add     esp, 10h
.text:004048DB		       test    eax, eax
.text:004048DD		       jz      short loc_4048EC
.text:004048DF		       push    ebx	       ; pReserved
.text:004048E0		       push    ebx	       ; nLine
.text:004048E1		       push    ebx	       ; pszFile
.text:004048E2		       push    ebx	       ; pszFunction
.text:004048E3		       push    ebx	       ; pszExpression
.text:004048E4		       call    __invoke_watson
.text:004048E9		       add     esp, 14h
.text:004048EC
.text:004048EC loc_4048EC:			       ; CODE XREF: ___getlocaleinfo+F0j
.text:004048EC		       cmp     [ebp+64h+bufferused], ebx
.text:004048EF		       jz      short loc_4048F8
.text:004048F1		       push    edi	       ; pBlock
.text:004048F2		       call    _free
.text:004048F7		       pop     ecx
.text:004048F8
.text:004048F8 loc_4048F8:			       ; CODE XREF: ___getlocaleinfo+102j
.text:004048F8					       ; ___getlocaleinfo+140j	...
.text:004048F8		       xor     eax, eax
.text:004048FA		       jmp     short loc_4048BA
.text:004048FC ; ---------------------------------------------------------------------------
.text:004048FC
.text:004048FC loc_4048FC:			       ; CODE XREF: ___getlocaleinfo+2Aj
.text:004048FC		       cmp     [ebp+64h+lc_type], ebx
.text:004048FF		       jnz     short loc_4048B7
.text:00404901		       push    ebx	       ; code_page
.text:00404902		       push    4	       ; cchData
.text:00404904		       mov     edi, offset wcbuffer
.text:00404909		       push    edi	       ; lpLCData
.text:0040490A		       push    [ebp+64h+fieldtype] ; LCType
.text:0040490D		       push    [ebp+64h+localehandle] ;	Locale
.text:00404910		       push    eax	       ; plocinfo
.text:00404911		       call    ___crtGetLocaleInfoW
.text:00404916		       add     esp, 18h
.text:00404919		       test    eax, eax
.text:0040491B		       jz      short loc_4048B7
.text:0040491D		       mov     [esi], bl
.text:0040491F
.text:0040491F loc_40491F:			       ; CODE XREF: ___getlocaleinfo+156j
.text:0040491F		       mov     bl, [edi]
.text:00404921		       movzx   eax, bl
.text:00404924		       push    eax	       ; c
.text:00404925		       call    _isdigit
.text:0040492A		       test    eax, eax
.text:0040492C		       pop     ecx
.text:0040492D		       jz      short loc_4048F8
.text:0040492F		       mov     al, [esi]
.text:00404931		       mov     cl, 0Ah
.text:00404933		       imul    cl
.text:00404935		       add     al, bl
.text:00404937		       sub     al, 30h
.text:00404939		       inc     edi
.text:0040493A		       inc     edi
.text:0040493B		       cmp     edi, offset ___pPurecall
.text:00404941		       mov     [esi], al
.text:00404943		       jl      short loc_40491F
.text:00404945		       jmp     short loc_4048F8
.text:00404945 ___getlocaleinfo	endp
.text:00404945
.text:00404947
.text:00404947 ; =============== S U B R O U T I N E =======================================
.text:00404947
.text:00404947
.text:00404947 ; void __cdecl _initp_misc_purevirt(void	*enull)
.text:00404947 __initp_misc_purevirt proc near	       ; CODE XREF: __init_pointers+1Bp
.text:00404947
.text:00404947 enull	       = dword ptr  4
.text:00404947
.text:00404947		       mov     eax, [esp+enull]
.text:0040494B		       mov     ___pPurecall, eax
.text:00404950		       retn
.text:00404950 __initp_misc_purevirt endp
.text:00404950
.text:00404951
.text:00404951 ; =============== S U B R O U T I N E =======================================
.text:00404951
.text:00404951
.text:00404951 ; void __cdecl _initp_misc_initcrit(void	*enull)
.text:00404951 __initp_misc_initcrit proc near	       ; CODE XREF: __init_pointers+Fp
.text:00404951
.text:00404951 enull	       = dword ptr  4
.text:00404951
.text:00404951		       mov     eax, [esp+enull]
.text:00404955		       mov     __pfnInitCritSecAndSpinCount, eax
.text:0040495A		       retn
.text:0040495A __initp_misc_initcrit endp
.text:0040495A
.text:0040495B
.text:0040495B ; =============== S U B R O U T I N E =======================================
.text:0040495B
.text:0040495B
.text:0040495B ; int __stdcall _crtInitCritSecNoSpinCount(_RTL_CRITICAL_SECTION	*lpCriticalSection, unsigned int dwSpinCount)
.text:0040495B __crtInitCritSecNoSpinCount proc	near   ; DATA XREF: ___crtInitCritSecAndSpinCount:loc_4049D0o
.text:0040495B
.text:0040495B lpCriticalSection= dword	ptr  4
.text:0040495B dwSpinCount     = dword ptr  8
.text:0040495B
.text:0040495B		       push    [esp+lpCriticalSection] ; lpCriticalSection
.text:0040495F		       call    ds:__imp__InitializeCriticalSection@4 ; InitializeCriticalSection(x)
.text:00404965		       xor     eax, eax
.text:00404967		       inc     eax
.text:00404968		       retn    8
.text:00404968 __crtInitCritSecNoSpinCount endp
.text:00404968
.text:0040496B
.text:0040496B ; =============== S U B R O U T I N E =======================================
.text:0040496B
.text:0040496B ; Attributes: bp-based frame
.text:0040496B
.text:0040496B ; int __cdecl __crtInitCritSecAndSpinCount(_RTL_CRITICAL_SECTION	*lpCriticalSection, unsigned int dwSpinCount)
.text:0040496B ___crtInitCritSecAndSpinCount proc near ; CODE XREF: __mtinitlocks+26p
.text:0040496B					       ; __mtinitlocknum+78p ...
.text:0040496B
.text:0040496B var_24	       = dword ptr -24h
.text:0040496B ret	       = dword ptr -20h
.text:0040496B osplatform      = dword ptr -1Ch
.text:0040496B ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040496B lpCriticalSection= dword	ptr  8
.text:0040496B dwSpinCount     = dword ptr  0Ch
.text:0040496B
.text:0040496B		       push    14h
.text:0040496D		       push    offset dword_420678
.text:00404972		       call    __SEH_prolog4
.text:00404977		       xor     edi, edi
.text:00404979		       mov     [ebp+osplatform], edi
.text:0040497C		       push    __pfnInitCritSecAndSpinCount ; codedptr
.text:00404982		       call    __decode_pointer
.text:00404987		       pop     ecx
.text:00404988		       mov     esi, eax
.text:0040498A		       cmp     esi, edi
.text:0040498C		       jnz     short loc_4049E1
.text:0040498E		       lea     eax, [ebp+osplatform]
.text:00404991		       push    eax	       ; pValue
.text:00404992		       call    __get_osplatform
.text:00404997		       pop     ecx
.text:00404998		       cmp     eax, edi
.text:0040499A		       jz      short loc_4049A9
.text:0040499C		       push    edi	       ; pReserved
.text:0040499D		       push    edi	       ; nLine
.text:0040499E		       push    edi	       ; pszFile
.text:0040499F		       push    edi	       ; pszFunction
.text:004049A0		       push    edi	       ; pszExpression
.text:004049A1		       call    __invoke_watson
.text:004049A6		       add     esp, 14h
.text:004049A9
.text:004049A9 loc_4049A9:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+2Fj
.text:004049A9		       cmp     [ebp+osplatform], 1
.text:004049AD		       jz      short loc_4049D0
.text:004049AF		       push    offset aKernel32_dll ; "kernel32.dll"
.text:004049B4		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:004049BA		       cmp     eax, edi
.text:004049BC		       jz      short loc_4049D0
.text:004049BE		       push    offset aInitializecrit ;	"InitializeCriticalSectionAndSpinCount"
.text:004049C3		       push    eax	       ; hModule
.text:004049C4		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:004049CA		       mov     esi, eax
.text:004049CC		       cmp     esi, edi
.text:004049CE		       jnz     short loc_4049D5
.text:004049D0
.text:004049D0 loc_4049D0:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+42j
.text:004049D0					       ; ___crtInitCritSecAndSpinCount+51j
.text:004049D0		       mov     esi, offset __crtInitCritSecNoSpinCount
.text:004049D5
.text:004049D5 loc_4049D5:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+63j
.text:004049D5		       push    esi	       ; ptr
.text:004049D6		       call    __encode_pointer
.text:004049DB		       pop     ecx
.text:004049DC		       mov     __pfnInitCritSecAndSpinCount, eax
.text:004049E1
.text:004049E1 loc_4049E1:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+21j
.text:004049E1		       mov     [ebp+ms_exc.disabled], edi
.text:004049E4		       push    [ebp+dwSpinCount]
.text:004049E7		       push    [ebp+lpCriticalSection]
.text:004049EA		       call    esi
.text:004049EC		       mov     [ebp+ret], eax
.text:004049EF		       jmp     short loc_404A20
.text:004049F1 ; ---------------------------------------------------------------------------
.text:004049F1
.text:004049F1 $LN12_2:
.text:004049F1		       mov     eax, [ebp+ms_exc.exc_ptr]
.text:004049F4		       mov     eax, [eax]
.text:004049F6		       mov     eax, [eax]
.text:004049F8		       mov     [ebp+var_24], eax
.text:004049FB		       xor     ecx, ecx
.text:004049FD		       cmp     eax, 0C0000017h
.text:00404A02		       setz    cl
.text:00404A05		       mov     eax, ecx
.text:00404A07
.text:00404A07 $LN19_1:
.text:00404A07		       retn
.text:00404A08 ; ---------------------------------------------------------------------------
.text:00404A08
.text:00404A08 $LN13_2:
.text:00404A08		       mov     esp, [ebp+ms_exc.old_esp]
.text:00404A0B		       cmp     [ebp+var_24], 0C0000017h
.text:00404A12		       jnz     short loc_404A1C
.text:00404A14		       push    8	       ; dwErrCode
.text:00404A16		       call    ds:__imp__SetLastError@4	; SetLastError(x)
.text:00404A1C
.text:00404A1C loc_404A1C:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+A7j
.text:00404A1C		       and     [ebp+ret], 0
.text:00404A20
.text:00404A20 loc_404A20:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+84j
.text:00404A20		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404A27		       mov     eax, [ebp+ret]
.text:00404A2A		       call    __SEH_epilog4
.text:00404A2F		       retn
.text:00404A2F ___crtInitCritSecAndSpinCount endp
.text:00404A2F
.text:00404A30
.text:00404A30 ; =============== S U B R O U T I N E =======================================
.text:00404A30
.text:00404A30
.text:00404A30 ; void __cdecl _initp_heap_handler(void *enull)
.text:00404A30 __initp_heap_handler proc near	       ; CODE XREF: __init_pointers+9p
.text:00404A30
.text:00404A30 enull	       = dword ptr  4
.text:00404A30
.text:00404A30		       mov     eax, [esp+enull]
.text:00404A34		       mov     ?_pnhHeap@@3P6AHI@ZA, eax ; int (*_pnhHeap)(uint)
.text:00404A39		       retn
.text:00404A39 __initp_heap_handler endp
.text:00404A39
.text:00404A3A
.text:00404A3A ; =============== S U B R O U T I N E =======================================
.text:00404A3A
.text:00404A3A
.text:00404A3A ; int (__cdecl *__cdecl _set_new_handler(int (__cdecl *pnh)(unsigned int)))(unsigned int)
.text:00404A3A ?_set_new_handler@@YAP6AHI@ZP6AHI@Z@Z proc near
.text:00404A3A					       ; CODE XREF: _set_new_handler(int)+2p
.text:00404A3A
.text:00404A3A pnh	       = dword ptr  4
.text:00404A3A
.text:00404A3A		       push    esi
.text:00404A3B		       push    4	       ; locknum
.text:00404A3D		       call    __lock
.text:00404A42		       push    ?_pnhHeap@@3P6AHI@ZA ; codedptr
.text:00404A48		       call    __decode_pointer
.text:00404A4D		       push    [esp+0Ch+pnh]   ; ptr
.text:00404A51		       mov     esi, eax
.text:00404A53		       call    __encode_pointer
.text:00404A58		       push    4	       ; locknum
.text:00404A5A		       mov     ?_pnhHeap@@3P6AHI@ZA, eax ; int (*_pnhHeap)(uint)
.text:00404A5F		       call    __unlock
.text:00404A64		       add     esp, 10h
.text:00404A67		       mov     eax, esi
.text:00404A69		       pop     esi
.text:00404A6A		       retn
.text:00404A6A ?_set_new_handler@@YAP6AHI@ZP6AHI@Z@Z endp
.text:00404A6A
.text:00404A6B
.text:00404A6B ; =============== S U B R O U T I N E =======================================
.text:00404A6B
.text:00404A6B
.text:00404A6B ; int (__cdecl *__cdecl _set_new_handler(int pnh))(unsigned int)
.text:00404A6B ?_set_new_handler@@YAP6AHI@ZH@Z proc near
.text:00404A6B
.text:00404A6B pnh	       = dword ptr  4
.text:00404A6B
.text:00404A6B		       push    0	       ; pnh
.text:00404A6D		       call    ?_set_new_handler@@YAP6AHI@ZP6AHI@Z@Z ; _set_new_handler(int (*)(uint))
.text:00404A72		       pop     ecx
.text:00404A73		       retn
.text:00404A73 ?_set_new_handler@@YAP6AHI@ZH@Z endp
.text:00404A73
.text:00404A74
.text:00404A74 ; =============== S U B R O U T I N E =======================================
.text:00404A74
.text:00404A74
.text:00404A74 ; int (__cdecl *__cdecl _query_new_handler())(unsigned int)
.text:00404A74 ?_query_new_handler@@YAP6AHI@ZXZ	proc near
.text:00404A74		       push    ?_pnhHeap@@3P6AHI@ZA ; codedptr
.text:00404A7A		       call    __decode_pointer
.text:00404A7F		       pop     ecx
.text:00404A80		       retn
.text:00404A80 ?_query_new_handler@@YAP6AHI@ZXZ	endp
.text:00404A80
.text:00404A81
.text:00404A81 ; =============== S U B R O U T I N E =======================================
.text:00404A81
.text:00404A81
.text:00404A81 ; int __cdecl _callnewh(unsigned	int size)
.text:00404A81 __callnewh      proc near	       ; CODE XREF: _malloc+8Cp
.text:00404A81					       ; _malloc+AEp ...
.text:00404A81
.text:00404A81 size	       = dword ptr  4
.text:00404A81
.text:00404A81		       push    ?_pnhHeap@@3P6AHI@ZA ; codedptr
.text:00404A87		       call    __decode_pointer
.text:00404A8C		       test    eax, eax
.text:00404A8E		       pop     ecx
.text:00404A8F		       jz      short loc_404AA0
.text:00404A91		       push    [esp+size]
.text:00404A95		       call    eax
.text:00404A97		       test    eax, eax
.text:00404A99		       pop     ecx
.text:00404A9A		       jz      short loc_404AA0
.text:00404A9C		       xor     eax, eax
.text:00404A9E		       inc     eax
.text:00404A9F		       retn
.text:00404AA0 ; ---------------------------------------------------------------------------
.text:00404AA0
.text:00404AA0 loc_404AA0:			       ; CODE XREF: __callnewh+Ej
.text:00404AA0					       ; __callnewh+19j
.text:00404AA0		       xor     eax, eax
.text:00404AA2		       retn
.text:00404AA2 __callnewh      endp
.text:00404AA2
.text:00404AA3
.text:00404AA3 ; =============== S U B R O U T I N E =======================================
.text:00404AA3
.text:00404AA3 ; Attributes: bp-based frame
.text:00404AA3
.text:00404AA3 ; int __cdecl _ioinit()
.text:00404AA3 __ioinit	       proc near	       ; CODE XREF: __tmainCRTStartup+E8p
.text:00404AA3
.text:00404AA3 StartupInfo     = _STARTUPINFOA ptr -64h
.text:00404AA3 i	       = dword ptr -20h
.text:00404AA3 posfhnd	       = dword ptr -1Ch
.text:00404AA3 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00404AA3
.text:00404AA3		       push    54h
.text:00404AA5		       push    offset dword_420698
.text:00404AAA		       call    __SEH_prolog4
.text:00404AAF		       xor     edi, edi
.text:00404AB1		       mov     [ebp+ms_exc.disabled], edi
.text:00404AB4		       lea     eax, [ebp+StartupInfo]
.text:00404AB7		       push    eax	       ; lpStartupInfo
.text:00404AB8		       call    ds:__imp__GetStartupInfoA@4 ; GetStartupInfoA(x)
.text:00404ABE		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404AC5		       push    40h	       ; size
.text:00404AC7		       push    20h
.text:00404AC9		       pop     esi
.text:00404ACA		       push    esi	       ; count
.text:00404ACB		       call    __calloc_crt
.text:00404AD0		       pop     ecx
.text:00404AD1		       pop     ecx
.text:00404AD2		       cmp     eax, edi
.text:00404AD4		       jz      loc_404CEE
.text:00404ADA		       mov     ___pioinfo, eax
.text:00404ADF		       mov     __nhandle, esi
.text:00404AE5		       lea     ecx, [eax+800h]
.text:00404AEB		       jmp     short loc_404B1D
.text:00404AED ; ---------------------------------------------------------------------------
.text:00404AED
.text:00404AED loc_404AED:			       ; CODE XREF: __ioinit+7Cj
.text:00404AED		       mov     byte ptr	[eax+4], 0
.text:00404AF1		       or      dword ptr [eax],	0FFFFFFFFh
.text:00404AF4		       mov     byte ptr	[eax+5], 0Ah
.text:00404AF8		       mov     [eax+8],	edi
.text:00404AFB		       mov     byte ptr	[eax+24h], 0
.text:00404AFF		       mov     byte ptr	[eax+25h], 0Ah
.text:00404B03		       mov     byte ptr	[eax+26h], 0Ah
.text:00404B07		       mov     [eax+38h], edi
.text:00404B0A		       mov     byte ptr	[eax+34h], 0
.text:00404B0E		       add     eax, 40h
.text:00404B11		       mov     ecx, ___pioinfo
.text:00404B17		       add     ecx, 800h
.text:00404B1D
.text:00404B1D loc_404B1D:			       ; CODE XREF: __ioinit+48j
.text:00404B1D		       cmp     eax, ecx
.text:00404B1F		       jb      short loc_404AED
.text:00404B21		       cmp     [ebp+StartupInfo.cbReserved2], di
.text:00404B25		       jz      loc_404C35
.text:00404B2B		       mov     eax, [ebp+StartupInfo.lpReserved2]
.text:00404B2E		       cmp     eax, edi
.text:00404B30		       jz      loc_404C35
.text:00404B36		       mov     edi, [eax]
.text:00404B38		       lea     ebx, [eax+4]
.text:00404B3B		       lea     eax, [ebx+edi]
.text:00404B3E		       mov     [ebp+posfhnd], eax
.text:00404B41		       mov     esi, 800h
.text:00404B46		       cmp     edi, esi
.text:00404B48		       jl      short loc_404B4C
.text:00404B4A		       mov     edi, esi
.text:00404B4C
.text:00404B4C loc_404B4C:			       ; CODE XREF: __ioinit+A5j
.text:00404B4C		       mov     [ebp+i],	1
.text:00404B53		       jmp     short loc_404BB0
.text:00404B55 ; ---------------------------------------------------------------------------
.text:00404B55
.text:00404B55 loc_404B55:			       ; CODE XREF: __ioinit+113j
.text:00404B55		       push    40h	       ; size
.text:00404B57		       push    20h	       ; count
.text:00404B59		       call    __calloc_crt
.text:00404B5E		       pop     ecx
.text:00404B5F		       pop     ecx
.text:00404B60		       test    eax, eax
.text:00404B62		       jz      short loc_404BBA
.text:00404B64		       mov     ecx, [ebp+i]
.text:00404B67		       lea     ecx, ds:422F40h[ecx*4]
.text:00404B6E		       mov     [ecx], eax
.text:00404B70		       add     __nhandle, 20h
.text:00404B77		       lea     edx, [eax+800h]
.text:00404B7D		       jmp     short loc_404BA9
.text:00404B7F ; ---------------------------------------------------------------------------
.text:00404B7F
.text:00404B7F loc_404B7F:			       ; CODE XREF: __ioinit+108j
.text:00404B7F		       mov     byte ptr	[eax+4], 0
.text:00404B83		       or      dword ptr [eax],	0FFFFFFFFh
.text:00404B86		       mov     byte ptr	[eax+5], 0Ah
.text:00404B8A		       and     dword ptr [eax+8], 0
.text:00404B8E		       and     byte ptr	[eax+24h], 80h
.text:00404B92		       mov     byte ptr	[eax+25h], 0Ah
.text:00404B96		       mov     byte ptr	[eax+26h], 0Ah
.text:00404B9A		       and     dword ptr [eax+38h], 0
.text:00404B9E		       mov     byte ptr	[eax+34h], 0
.text:00404BA2		       add     eax, 40h
.text:00404BA5		       mov     edx, [ecx]
.text:00404BA7		       add     edx, esi
.text:00404BA9
.text:00404BA9 loc_404BA9:			       ; CODE XREF: __ioinit+DAj
.text:00404BA9		       cmp     eax, edx
.text:00404BAB		       jb      short loc_404B7F
.text:00404BAD		       inc     [ebp+i]
.text:00404BB0
.text:00404BB0 loc_404BB0:			       ; CODE XREF: __ioinit+B0j
.text:00404BB0		       cmp     __nhandle, edi
.text:00404BB6		       jl      short loc_404B55
.text:00404BB8		       jmp     short loc_404BC0
.text:00404BBA ; ---------------------------------------------------------------------------
.text:00404BBA
.text:00404BBA loc_404BBA:			       ; CODE XREF: __ioinit+BFj
.text:00404BBA		       mov     edi, __nhandle
.text:00404BC0
.text:00404BC0 loc_404BC0:			       ; CODE XREF: __ioinit+115j
.text:00404BC0		       and     [ebp+i],	0
.text:00404BC4		       test    edi, edi
.text:00404BC6		       jle     short loc_404C35
.text:00404BC8
.text:00404BC8 loc_404BC8:			       ; CODE XREF: __ioinit+190j
.text:00404BC8		       mov     eax, [ebp+posfhnd]
.text:00404BCB		       mov     ecx, [eax]
.text:00404BCD		       cmp     ecx, 0FFFFFFFFh
.text:00404BD0		       jz      short loc_404C28
.text:00404BD2		       cmp     ecx, 0FFFFFFFEh
.text:00404BD5		       jz      short loc_404C28
.text:00404BD7		       mov     al, [ebx]
.text:00404BD9		       test    al, 1
.text:00404BDB		       jz      short loc_404C28
.text:00404BDD		       test    al, 8
.text:00404BDF		       jnz     short loc_404BEC
.text:00404BE1		       push    ecx	       ; hFile
.text:00404BE2		       call    ds:__imp__GetFileType@4 ; GetFileType(x)
.text:00404BE8		       test    eax, eax
.text:00404BEA		       jz      short loc_404C28
.text:00404BEC
.text:00404BEC loc_404BEC:			       ; CODE XREF: __ioinit+13Cj
.text:00404BEC		       mov     esi, [ebp+i]
.text:00404BEF		       mov     eax, esi
.text:00404BF1		       sar     eax, 5
.text:00404BF4		       and     esi, 1Fh
.text:00404BF7		       shl     esi, 6
.text:00404BFA		       add     esi, ___pioinfo[eax*4]
.text:00404C01		       mov     eax, [ebp+posfhnd]
.text:00404C04		       mov     eax, [eax]
.text:00404C06		       mov     [esi], eax
.text:00404C08		       mov     al, [ebx]
.text:00404C0A		       mov     [esi+4],	al
.text:00404C0D		       push    0FA0h	       ; dwSpinCount
.text:00404C12		       lea     eax, [esi+0Ch]
.text:00404C15		       push    eax	       ; lpCriticalSection
.text:00404C16		       call    ___crtInitCritSecAndSpinCount
.text:00404C1B		       pop     ecx
.text:00404C1C		       pop     ecx
.text:00404C1D		       test    eax, eax
.text:00404C1F		       jz      loc_404CEE
.text:00404C25		       inc     dword ptr [esi+8]
.text:00404C28
.text:00404C28 loc_404C28:			       ; CODE XREF: __ioinit+12Dj
.text:00404C28					       ; __ioinit+132j	...
.text:00404C28		       inc     [ebp+i]
.text:00404C2B		       inc     ebx
.text:00404C2C		       add     [ebp+posfhnd], 4
.text:00404C30		       cmp     [ebp+i],	edi
.text:00404C33		       jl      short loc_404BC8
.text:00404C35
.text:00404C35 loc_404C35:			       ; CODE XREF: __ioinit+82j
.text:00404C35					       ; __ioinit+8Dj ...
.text:00404C35		       xor     ebx, ebx
.text:00404C37
.text:00404C37 loc_404C37:			       ; CODE XREF: __ioinit+227j
.text:00404C37		       mov     esi, ebx
.text:00404C39		       shl     esi, 6
.text:00404C3C		       add     esi, ___pioinfo
.text:00404C42		       mov     eax, [esi]
.text:00404C44		       cmp     eax, 0FFFFFFFFh
.text:00404C47		       jz      short loc_404C54
.text:00404C49		       cmp     eax, 0FFFFFFFEh
.text:00404C4C		       jz      short loc_404C54
.text:00404C4E		       or      byte ptr	[esi+4], 80h
.text:00404C52		       jmp     short loc_404CC6
.text:00404C54 ; ---------------------------------------------------------------------------
.text:00404C54
.text:00404C54 loc_404C54:			       ; CODE XREF: __ioinit+1A4j
.text:00404C54					       ; __ioinit+1A9j
.text:00404C54		       mov     byte ptr	[esi+4], 81h
.text:00404C58		       test    ebx, ebx
.text:00404C5A		       jnz     short loc_404C61
.text:00404C5C		       push    0FFFFFFF6h
.text:00404C5E		       pop     eax
.text:00404C5F		       jmp     short loc_404C6B
.text:00404C61 ; ---------------------------------------------------------------------------
.text:00404C61
.text:00404C61 loc_404C61:			       ; CODE XREF: __ioinit+1B7j
.text:00404C61		       mov     eax, ebx
.text:00404C63		       dec     eax
.text:00404C64		       neg     eax
.text:00404C66		       sbb     eax, eax
.text:00404C68		       add     eax, 0FFFFFFF5h
.text:00404C6B
.text:00404C6B loc_404C6B:			       ; CODE XREF: __ioinit+1BCj
.text:00404C6B		       push    eax	       ; nStdHandle
.text:00404C6C		       call    ds:__imp__GetStdHandle@4	; GetStdHandle(x)
.text:00404C72		       mov     edi, eax
.text:00404C74		       cmp     edi, 0FFFFFFFFh
.text:00404C77		       jz      short loc_404CBC
.text:00404C79		       test    edi, edi
.text:00404C7B		       jz      short loc_404CBC
.text:00404C7D		       push    edi	       ; hFile
.text:00404C7E		       call    ds:__imp__GetFileType@4 ; GetFileType(x)
.text:00404C84		       test    eax, eax
.text:00404C86		       jz      short loc_404CBC
.text:00404C88		       mov     [esi], edi
.text:00404C8A		       and     eax, 0FFh
.text:00404C8F		       cmp     eax, 2
.text:00404C92		       jnz     short loc_404C9A
.text:00404C94		       or      byte ptr	[esi+4], 40h
.text:00404C98		       jmp     short loc_404CA3
.text:00404C9A ; ---------------------------------------------------------------------------
.text:00404C9A
.text:00404C9A loc_404C9A:			       ; CODE XREF: __ioinit+1EFj
.text:00404C9A		       cmp     eax, 3
.text:00404C9D		       jnz     short loc_404CA3
.text:00404C9F		       or      byte ptr	[esi+4], 8
.text:00404CA3
.text:00404CA3 loc_404CA3:			       ; CODE XREF: __ioinit+1F5j
.text:00404CA3					       ; __ioinit+1FAj
.text:00404CA3		       push    0FA0h	       ; dwSpinCount
.text:00404CA8		       lea     eax, [esi+0Ch]
.text:00404CAB		       push    eax	       ; lpCriticalSection
.text:00404CAC		       call    ___crtInitCritSecAndSpinCount
.text:00404CB1		       pop     ecx
.text:00404CB2		       pop     ecx
.text:00404CB3		       test    eax, eax
.text:00404CB5		       jz      short loc_404CEE
.text:00404CB7		       inc     dword ptr [esi+8]
.text:00404CBA		       jmp     short loc_404CC6
.text:00404CBC ; ---------------------------------------------------------------------------
.text:00404CBC
.text:00404CBC loc_404CBC:			       ; CODE XREF: __ioinit+1D4j
.text:00404CBC					       ; __ioinit+1D8j	...
.text:00404CBC		       or      byte ptr	[esi+4], 40h
.text:00404CC0		       mov     dword ptr [esi],	0FFFFFFFEh
.text:00404CC6
.text:00404CC6 loc_404CC6:			       ; CODE XREF: __ioinit+1AFj
.text:00404CC6					       ; __ioinit+217j
.text:00404CC6		       inc     ebx
.text:00404CC7		       cmp     ebx, 3
.text:00404CCA		       jl      loc_404C37
.text:00404CD0		       push    __nhandle       ; uNumber
.text:00404CD6		       call    ds:__imp__SetHandleCount@4 ; SetHandleCount(x)
.text:00404CDC		       xor     eax, eax
.text:00404CDE		       jmp     short loc_404CF1
.text:00404CE0 ; ---------------------------------------------------------------------------
.text:00404CE0
.text:00404CE0 $LN39:
.text:00404CE0		       xor     eax, eax
.text:00404CE2		       inc     eax
.text:00404CE3
.text:00404CE3 $LN64:
.text:00404CE3		       retn
.text:00404CE4 ; ---------------------------------------------------------------------------
.text:00404CE4
.text:00404CE4 $LN40:
.text:00404CE4		       mov     esp, [ebp+ms_exc.old_esp]
.text:00404CE7		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404CEE
.text:00404CEE loc_404CEE:			       ; CODE XREF: __ioinit+31j
.text:00404CEE					       ; __ioinit+17Cj	...
.text:00404CEE		       or      eax, 0FFFFFFFFh
.text:00404CF1
.text:00404CF1 loc_404CF1:			       ; CODE XREF: __ioinit+23Bj
.text:00404CF1		       call    __SEH_epilog4
.text:00404CF6		       retn
.text:00404CF6 __ioinit	       endp
.text:00404CF6
.text:00404CF7
.text:00404CF7 ; =============== S U B R O U T I N E =======================================
.text:00404CF7
.text:00404CF7
.text:00404CF7 __ioterm	       proc near
.text:00404CF7		       push    esi
.text:00404CF8		       push    edi
.text:00404CF9		       mov     esi, offset ___pioinfo
.text:00404CFE
.text:00404CFE loc_404CFE:			       ; CODE XREF: __ioterm+47j
.text:00404CFE		       mov     edi, [esi]
.text:00404D00		       test    edi, edi
.text:00404D02		       jz      short loc_404D35
.text:00404D04		       lea     eax, [edi+800h]
.text:00404D0A		       jmp     short loc_404D26
.text:00404D0C ; ---------------------------------------------------------------------------
.text:00404D0C
.text:00404D0C loc_404D0C:			       ; CODE XREF: __ioterm+31j
.text:00404D0C		       cmp     dword ptr [edi+8], 0
.text:00404D10		       jz      short loc_404D1C
.text:00404D12		       lea     eax, [edi+0Ch]
.text:00404D15		       push    eax	       ; lpCriticalSection
.text:00404D16		       call    ds:__imp__DeleteCriticalSection@4 ; DeleteCriticalSection(x)
.text:00404D1C
.text:00404D1C loc_404D1C:			       ; CODE XREF: __ioterm+19j
.text:00404D1C		       mov     eax, [esi]
.text:00404D1E		       add     edi, 40h
.text:00404D21		       add     eax, 800h
.text:00404D26
.text:00404D26 loc_404D26:			       ; CODE XREF: __ioterm+13j
.text:00404D26		       cmp     edi, eax
.text:00404D28		       jb      short loc_404D0C
.text:00404D2A		       push    dword ptr [esi] ; pBlock
.text:00404D2C		       call    _free
.text:00404D31		       and     dword ptr [esi],	0
.text:00404D34		       pop     ecx
.text:00404D35
.text:00404D35 loc_404D35:			       ; CODE XREF: __ioterm+Bj
.text:00404D35		       add     esi, 4
.text:00404D38		       cmp     esi, offset __pDestructExceptionObject
.text:00404D3E		       jl      short loc_404CFE
.text:00404D40		       pop     edi
.text:00404D41		       pop     esi
.text:00404D42		       retn
.text:00404D42 __ioterm	       endp
.text:00404D42
.text:00404D43
.text:00404D43 ; =============== S U B R O U T I N E =======================================
.text:00404D43
.text:00404D43
.text:00404D43 ; int __cdecl _fileno(_iobuf *stream)
.text:00404D43 __fileno	       proc near	       ; CODE XREF: _fprintf+63p
.text:00404D43					       ; _fprintf+6Fp ...
.text:00404D43
.text:00404D43 stream	       = dword ptr  4
.text:00404D43
.text:00404D43		       mov     eax, [esp+stream]
.text:00404D47		       push    esi
.text:00404D48		       xor     esi, esi
.text:00404D4A		       cmp     eax, esi
.text:00404D4C		       jnz     short loc_404D6B
.text:00404D4E		       call    __errno
.text:00404D53		       push    esi	       ; pReserved
.text:00404D54		       push    esi	       ; nLine
.text:00404D55		       push    esi	       ; pszFile
.text:00404D56		       push    esi	       ; pszFunction
.text:00404D57		       push    esi	       ; pszExpression
.text:00404D58		       mov     dword ptr [eax],	16h
.text:00404D5E		       call    __invalid_parameter
.text:00404D63		       add     esp, 14h
.text:00404D66		       or      eax, 0FFFFFFFFh
.text:00404D69		       pop     esi
.text:00404D6A		       retn
.text:00404D6B ; ---------------------------------------------------------------------------
.text:00404D6B
.text:00404D6B loc_404D6B:			       ; CODE XREF: __fileno+9j
.text:00404D6B		       mov     eax, [eax+10h]
.text:00404D6E		       pop     esi
.text:00404D6F		       retn
.text:00404D6F __fileno	       endp
.text:00404D6F
.text:00404D70
.text:00404D70 ; =============== S U B R O U T I N E =======================================
.text:00404D70
.text:00404D70 ; Attributes: bp-based frame
.text:00404D70
.text:00404D70 ; int __cdecl vfprintf_helper(int (__cdecl *outfn)(_iobuf *, const char *, localeinfo_struct *, char *),	_iobuf *str, const char	*format, localeinfo_struct *plocinfo, char *ap)
.text:00404D70 _vfprintf_helper	proc near	       ; CODE XREF: __vfprintf_l+15p
.text:00404D70					       ; __vfprintf_s_l+15p ...
.text:00404D70
.text:00404D70 retval	       = dword ptr -1Ch
.text:00404D70 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00404D70 outfn	       = dword ptr  8
.text:00404D70 stream	       = dword ptr  0Ch
.text:00404D70 format	       = dword ptr  10h
.text:00404D70 plocinfo	       = dword ptr  14h
.text:00404D70 ap	       = dword ptr  18h
.text:00404D70
.text:00404D70		       push    0Ch
.text:00404D72		       push    offset dword_4206B8
.text:00404D77		       call    __SEH_prolog4
.text:00404D7C		       xor     ebx, ebx
.text:00404D7E		       mov     [ebp+retval], ebx
.text:00404D81		       xor     eax, eax
.text:00404D83		       mov     esi, [ebp+stream]
.text:00404D86		       cmp     esi, ebx
.text:00404D88		       setnz   al
.text:00404D8B		       cmp     eax, ebx
.text:00404D8D		       jnz     short loc_404DAF
.text:00404D8F
.text:00404D8F loc_404D8F:			       ; CODE XREF: _vfprintf_helper+49j
.text:00404D8F		       call    __errno
.text:00404D94		       mov     dword ptr [eax],	16h
.text:00404D9A		       push    ebx	       ; pReserved
.text:00404D9B		       push    ebx	       ; nLine
.text:00404D9C		       push    ebx	       ; pszFile
.text:00404D9D		       push    ebx	       ; pszFunction
.text:00404D9E		       push    ebx	       ; pszExpression
.text:00404D9F		       call    __invalid_parameter
.text:00404DA4		       add     esp, 14h
.text:00404DA7		       or      eax, 0FFFFFFFFh
.text:00404DAA		       jmp     loc_404EAE
.text:00404DAF ; ---------------------------------------------------------------------------
.text:00404DAF
.text:00404DAF loc_404DAF:			       ; CODE XREF: _vfprintf_helper+1Dj
.text:00404DAF		       xor     eax, eax
.text:00404DB1		       cmp     [ebp+format], ebx
.text:00404DB4		       setnz   al
.text:00404DB7		       cmp     eax, ebx
.text:00404DB9		       jz      short loc_404D8F
.text:00404DBB		       mov     [ebp+stream], esi
.text:00404DBE		       push    esi	       ; pf
.text:00404DBF		       call    __lock_file
.text:00404DC4		       pop     ecx
.text:00404DC5		       mov     [ebp+ms_exc.disabled], ebx
.text:00404DC8		       test    byte ptr	[esi+0Ch], 40h
.text:00404DCC		       jnz     loc_404E78
.text:00404DD2		       push    esi	       ; stream
.text:00404DD3		       call    __fileno
.text:00404DD8		       pop     ecx
.text:00404DD9		       cmp     eax, 0FFFFFFFFh
.text:00404DDC		       jz      short loc_404E0C
.text:00404DDE		       push    esi	       ; stream
.text:00404DDF		       call    __fileno
.text:00404DE4		       pop     ecx
.text:00404DE5		       cmp     eax, 0FFFFFFFEh
.text:00404DE8		       jz      short loc_404E0C
.text:00404DEA		       push    esi	       ; stream
.text:00404DEB		       call    __fileno
.text:00404DF0		       sar     eax, 5
.text:00404DF3		       lea     edi, ds:422F40h[eax*4]
.text:00404DFA		       push    esi	       ; stream
.text:00404DFB		       call    __fileno
.text:00404E00		       pop     ecx
.text:00404E01		       pop     ecx
.text:00404E02		       and     eax, 1Fh
.text:00404E05		       shl     eax, 6
.text:00404E08		       add     eax, [edi]
.text:00404E0A		       jmp     short loc_404E11
.text:00404E0C ; ---------------------------------------------------------------------------
.text:00404E0C
.text:00404E0C loc_404E0C:			       ; CODE XREF: _vfprintf_helper+6Cj
.text:00404E0C					       ; _vfprintf_helper+78j
.text:00404E0C		       mov     eax, offset ___badioinfo
.text:00404E11
.text:00404E11 loc_404E11:			       ; CODE XREF: _vfprintf_helper+9Aj
.text:00404E11		       test    byte ptr	[eax+24h], 7Fh
.text:00404E15		       jnz     short loc_404E5C
.text:00404E17		       push    esi	       ; stream
.text:00404E18		       call    __fileno
.text:00404E1D		       pop     ecx
.text:00404E1E		       cmp     eax, 0FFFFFFFFh
.text:00404E21		       jz      short loc_404E51
.text:00404E23		       push    esi	       ; stream
.text:00404E24		       call    __fileno
.text:00404E29		       pop     ecx
.text:00404E2A		       cmp     eax, 0FFFFFFFEh
.text:00404E2D		       jz      short loc_404E51
.text:00404E2F		       push    esi	       ; stream
.text:00404E30		       call    __fileno
.text:00404E35		       sar     eax, 5
.text:00404E38		       lea     edi, ds:422F40h[eax*4]
.text:00404E3F		       push    esi	       ; stream
.text:00404E40		       call    __fileno
.text:00404E45		       pop     ecx
.text:00404E46		       pop     ecx
.text:00404E47		       and     eax, 1Fh
.text:00404E4A		       shl     eax, 6
.text:00404E4D		       add     eax, [edi]
.text:00404E4F		       jmp     short loc_404E56
.text:00404E51 ; ---------------------------------------------------------------------------
.text:00404E51
.text:00404E51 loc_404E51:			       ; CODE XREF: _vfprintf_helper+B1j
.text:00404E51					       ; _vfprintf_helper+BDj
.text:00404E51		       mov     eax, offset ___badioinfo
.text:00404E56
.text:00404E56 loc_404E56:			       ; CODE XREF: _vfprintf_helper+DFj
.text:00404E56		       test    byte ptr	[eax+24h], 80h
.text:00404E5A		       jz      short loc_404E78
.text:00404E5C
.text:00404E5C loc_404E5C:			       ; CODE XREF: _vfprintf_helper+A5j
.text:00404E5C		       call    __errno
.text:00404E61		       mov     dword ptr [eax],	16h
.text:00404E67		       push    ebx	       ; pReserved
.text:00404E68		       push    ebx	       ; nLine
.text:00404E69		       push    ebx	       ; pszFile
.text:00404E6A		       push    ebx	       ; pszFunction
.text:00404E6B		       push    ebx	       ; pszExpression
.text:00404E6C		       call    __invalid_parameter
.text:00404E71		       add     esp, 14h
.text:00404E74		       or      [ebp+retval], 0FFFFFFFFh
.text:00404E78
.text:00404E78 loc_404E78:			       ; CODE XREF: _vfprintf_helper+5Cj
.text:00404E78					       ; _vfprintf_helper+EAj
.text:00404E78		       cmp     [ebp+retval], ebx
.text:00404E7B		       jnz     short loc_404E9F
.text:00404E7D		       push    esi	       ; str
.text:00404E7E		       call    __stbuf
.text:00404E83		       mov     edi, eax
.text:00404E85		       push    [ebp+ap]
.text:00404E88		       push    [ebp+plocinfo]
.text:00404E8B		       push    [ebp+format]
.text:00404E8E		       push    esi
.text:00404E8F		       call    [ebp+outfn]
.text:00404E92		       mov     [ebp+retval], eax
.text:00404E95		       push    esi	       ; str
.text:00404E96		       push    edi	       ; flag
.text:00404E97		       call    __ftbuf
.text:00404E9C		       add     esp, 1Ch
.text:00404E9F
.text:00404E9F loc_404E9F:			       ; CODE XREF: _vfprintf_helper+10Bj
.text:00404E9F		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404EA6		       call    $LN16_2
.text:00404EAB
.text:00404EAB $LN19_2:
.text:00404EAB		       mov     eax, [ebp+retval]
.text:00404EAE
.text:00404EAE loc_404EAE:			       ; CODE XREF: _vfprintf_helper+3Aj
.text:00404EAE		       call    __SEH_epilog4
.text:00404EB3		       retn
.text:00404EB4 ; ---------------------------------------------------------------------------
.text:00404EB4
.text:00404EB4 $LN16_2:				       ; CODE XREF: _vfprintf_helper+136p
.text:00404EB4					       ; DATA XREF: .rdata:004206D0o
.text:00404EB4		       push    [ebp+stream]    ; pf
.text:00404EB7		       call    __unlock_file
.text:00404EBC		       pop     ecx
.text:00404EBD
.text:00404EBD $LN17_2:
.text:00404EBD		       retn
.text:00404EBD _vfprintf_helper	endp
.text:00404EBD
.text:00404EBE
.text:00404EBE ; =============== S U B R O U T I N E =======================================
.text:00404EBE
.text:00404EBE
.text:00404EBE ; int __cdecl _vfprintf_l(_iobuf	*str, const char *format, localeinfo_struct *plocinfo, char *ap)
.text:00404EBE __vfprintf_l    proc near	       ; CODE XREF: __fprintf_l+11p
.text:00404EBE
.text:00404EBE str	       = dword ptr  4
.text:00404EBE format	       = dword ptr  8
.text:00404EBE plocinfo	       = dword ptr  0Ch
.text:00404EBE ap	       = dword ptr  10h
.text:00404EBE
.text:00404EBE		       push    [esp+ap]	       ; ap
.text:00404EC2		       push    [esp+4+plocinfo]	; plocinfo
.text:00404EC6		       push    [esp+8+format]  ; format
.text:00404ECA		       push    [esp+0Ch+str]   ; str
.text:00404ECE		       push    offset __output_l ; outfn
.text:00404ED3		       call    _vfprintf_helper
.text:00404ED8		       add     esp, 14h
.text:00404EDB		       retn
.text:00404EDB __vfprintf_l    endp
.text:00404EDB
.text:00404EDC
.text:00404EDC ; =============== S U B R O U T I N E =======================================
.text:00404EDC
.text:00404EDC
.text:00404EDC ; int __cdecl _vfprintf_s_l(_iobuf *str,	const char *format, localeinfo_struct *plocinfo, char *ap)
.text:00404EDC __vfprintf_s_l  proc near	       ; CODE XREF: __fprintf_s_l+11p
.text:00404EDC					       ; _fprintf_s+Fp
.text:00404EDC
.text:00404EDC str	       = dword ptr  4
.text:00404EDC format	       = dword ptr  8
.text:00404EDC plocinfo	       = dword ptr  0Ch
.text:00404EDC ap	       = dword ptr  10h
.text:00404EDC
.text:00404EDC		       push    [esp+ap]	       ; ap
.text:00404EE0		       push    [esp+4+plocinfo]	; plocinfo
.text:00404EE4		       push    [esp+8+format]  ; format
.text:00404EE8		       push    [esp+0Ch+str]   ; str
.text:00404EEC		       push    offset __output_s_l ; outfn
.text:00404EF1		       call    _vfprintf_helper
.text:00404EF6		       add     esp, 14h
.text:00404EF9		       retn
.text:00404EF9 __vfprintf_s_l  endp
.text:00404EF9
.text:00404EFA
.text:00404EFA ; =============== S U B R O U T I N E =======================================
.text:00404EFA
.text:00404EFA
.text:00404EFA ; int __cdecl _vfprintf_p_l(_iobuf *str,	const char *format, localeinfo_struct *plocinfo, char *ap)
.text:00404EFA __vfprintf_p_l  proc near	       ; CODE XREF: __fprintf_p_l+11p
.text:00404EFA					       ; __fprintf_p+Fp
.text:00404EFA
.text:00404EFA str	       = dword ptr  4
.text:00404EFA format	       = dword ptr  8
.text:00404EFA plocinfo	       = dword ptr  0Ch
.text:00404EFA ap	       = dword ptr  10h
.text:00404EFA
.text:00404EFA		       push    [esp+ap]	       ; ap
.text:00404EFE		       push    [esp+4+plocinfo]	; plocinfo
.text:00404F02		       push    [esp+8+format]  ; format
.text:00404F06		       push    [esp+0Ch+str]   ; str
.text:00404F0A		       push    offset __output_p_l ; outfn
.text:00404F0F		       call    _vfprintf_helper
.text:00404F14		       add     esp, 14h
.text:00404F17		       retn
.text:00404F17 __vfprintf_p_l  endp
.text:00404F17
.text:00404F18
.text:00404F18 ; =============== S U B R O U T I N E =======================================
.text:00404F18
.text:00404F18
.text:00404F18 ; int __cdecl vfprintf(_iobuf *str, const char *format, char *ap)
.text:00404F18 _vfprintf       proc near
.text:00404F18
.text:00404F18 str	       = dword ptr  4
.text:00404F18 format	       = dword ptr  8
.text:00404F18 ap	       = dword ptr  0Ch
.text:00404F18
.text:00404F18		       push    [esp+ap]	       ; ap
.text:00404F1C		       push    0	       ; plocinfo
.text:00404F1E		       push    [esp+8+format]  ; format
.text:00404F22		       push    [esp+0Ch+str]   ; str
.text:00404F26		       push    offset __output_l ; outfn
.text:00404F2B		       call    _vfprintf_helper
.text:00404F30		       add     esp, 14h
.text:00404F33		       retn
.text:00404F33 _vfprintf       endp
.text:00404F33
.text:00404F34
.text:00404F34 ; =============== S U B R O U T I N E =======================================
.text:00404F34
.text:00404F34
.text:00404F34 ; int __cdecl vfprintf_s(_iobuf *str, const char	*format, char *ap)
.text:00404F34 _vfprintf_s     proc near
.text:00404F34
.text:00404F34 str	       = dword ptr  4
.text:00404F34 format	       = dword ptr  8
.text:00404F34 ap	       = dword ptr  0Ch
.text:00404F34
.text:00404F34		       push    [esp+ap]	       ; ap
.text:00404F38		       push    0	       ; plocinfo
.text:00404F3A		       push    [esp+8+format]  ; format
.text:00404F3E		       push    [esp+0Ch+str]   ; str
.text:00404F42		       push    offset __output_s_l ; outfn
.text:00404F47		       call    _vfprintf_helper
.text:00404F4C		       add     esp, 14h
.text:00404F4F		       retn
.text:00404F4F _vfprintf_s     endp
.text:00404F4F
.text:00404F50
.text:00404F50 ; =============== S U B R O U T I N E =======================================
.text:00404F50
.text:00404F50
.text:00404F50 ; int __cdecl _vfprintf_p(_iobuf	*str, const char *format, char *ap)
.text:00404F50 __vfprintf_p    proc near
.text:00404F50
.text:00404F50 str	       = dword ptr  4
.text:00404F50 format	       = dword ptr  8
.text:00404F50 ap	       = dword ptr  0Ch
.text:00404F50
.text:00404F50		       push    [esp+ap]	       ; ap
.text:00404F54		       push    0	       ; plocinfo
.text:00404F56		       push    [esp+8+format]  ; format
.text:00404F5A		       push    [esp+0Ch+str]   ; str
.text:00404F5E		       push    offset __output_p_l ; outfn
.text:00404F63		       call    _vfprintf_helper
.text:00404F68		       add     esp, 14h
.text:00404F6B		       retn
.text:00404F6B __vfprintf_p    endp
.text:00404F6B
.text:00404F6C
.text:00404F6C ; =============== S U B R O U T I N E =======================================
.text:00404F6C
.text:00404F6C
.text:00404F6C ; unsigned int __cdecl wait_a_bit(unsigned int WaitTime)
.text:00404F6C _wait_a_bit     proc near
.text:00404F6C
.text:00404F6C WaitTime	       = dword ptr  4
.text:00404F6C
.text:00404F6C		       push    esi
.text:00404F6D		       mov     esi, [esp+4+WaitTime]
.text:00404F71		       push    esi	       ; dwMilliseconds
.text:00404F72		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:00404F78		       add     esi, 3E8h
.text:00404F7E		       cmp     esi, __maxwait
.text:00404F84		       jbe     short loc_404F89
.text:00404F86		       or      esi, 0FFFFFFFFh
.text:00404F89
.text:00404F89 loc_404F89:			       ; CODE XREF: _wait_a_bit+18j
.text:00404F89		       mov     eax, esi
.text:00404F8B		       pop     esi
.text:00404F8C		       retn
.text:00404F8C _wait_a_bit     endp
.text:00404F8C
.text:00404F8D
.text:00404F8D ; =============== S U B R O U T I N E =======================================
.text:00404F8D
.text:00404F8D
.text:00404F8D ; unsigned int __cdecl _set_malloc_crt_max_wait(unsigned	int newvalue)
.text:00404F8D __set_malloc_crt_max_wait proc near
.text:00404F8D
.text:00404F8D newvalue	       = dword ptr  4
.text:00404F8D
.text:00404F8D		       mov     ecx, [esp+newvalue]
.text:00404F91		       mov     eax, __maxwait
.text:00404F96		       mov     __maxwait, ecx
.text:00404F9C		       retn
.text:00404F9C __set_malloc_crt_max_wait endp
.text:00404F9C
.text:00404F9D
.text:00404F9D ; =============== S U B R O U T I N E =======================================
.text:00404F9D
.text:00404F9D
.text:00404F9D ; void *__cdecl _malloc_crt(unsigned int	cb)
.text:00404F9D __malloc_crt    proc near	       ; CODE XREF: __stbuf+58p
.text:00404F9D					       ; __output_l+5D0p ...
.text:00404F9D
.text:00404F9D cb	       = dword ptr  4
.text:00404F9D
.text:00404F9D		       push    esi
.text:00404F9E		       push    edi
.text:00404F9F		       xor     esi, esi
.text:00404FA1
.text:00404FA1 Retry:				       ; CODE XREF: __malloc_crt+39j
.text:00404FA1		       push    [esp+8+cb]      ; size
.text:00404FA5		       call    _malloc
.text:00404FAA		       mov     edi, eax
.text:00404FAC		       test    edi, edi
.text:00404FAE		       pop     ecx
.text:00404FAF		       jnz     short loc_404FD8
.text:00404FB1		       cmp     __maxwait, eax
.text:00404FB7		       jbe     short loc_404FD8
.text:00404FB9		       push    esi	       ; dwMilliseconds
.text:00404FBA		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:00404FC0		       lea     eax, [esi+3E8h]
.text:00404FC6		       cmp     eax, __maxwait
.text:00404FCC		       jbe     short loc_404FD1
.text:00404FCE		       or      eax, 0FFFFFFFFh
.text:00404FD1
.text:00404FD1 loc_404FD1:			       ; CODE XREF: __malloc_crt+2Fj
.text:00404FD1		       cmp     eax, 0FFFFFFFFh
.text:00404FD4		       mov     esi, eax
.text:00404FD6		       jnz     short Retry
.text:00404FD8
.text:00404FD8 loc_404FD8:			       ; CODE XREF: __malloc_crt+12j
.text:00404FD8					       ; __malloc_crt+1Aj
.text:00404FD8		       mov     eax, edi
.text:00404FDA		       pop     edi
.text:00404FDB		       pop     esi
.text:00404FDC		       retn
.text:00404FDC __malloc_crt    endp
.text:00404FDC
.text:00404FDD
.text:00404FDD ; =============== S U B R O U T I N E =======================================
.text:00404FDD
.text:00404FDD
.text:00404FDD ; void *__cdecl _calloc_crt(unsigned int	count, unsigned	int size)
.text:00404FDD __calloc_crt    proc near	       ; CODE XREF: ___initstdio+22p
.text:00404FDD					       ; ___initstdio+3Bp ...
.text:00404FDD
.text:00404FDD count	       = dword ptr  4
.text:00404FDD size	       = dword ptr  8
.text:00404FDD
.text:00404FDD		       push    esi
.text:00404FDE		       push    edi
.text:00404FDF		       xor     esi, esi
.text:00404FE1
.text:00404FE1 Retry_0:				       ; CODE XREF: __calloc_crt+41j
.text:00404FE1		       push    0	       ; errno_tmp
.text:00404FE3		       push    [esp+0Ch+size]  ; size
.text:00404FE7		       push    [esp+10h+count] ; num
.text:00404FEB		       call    __calloc_impl
.text:00404FF0		       mov     edi, eax
.text:00404FF2		       add     esp, 0Ch
.text:00404FF5		       test    edi, edi
.text:00404FF7		       jnz     short loc_405020
.text:00404FF9		       cmp     __maxwait, eax
.text:00404FFF		       jbe     short loc_405020
.text:00405001		       push    esi	       ; dwMilliseconds
.text:00405002		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:00405008		       lea     eax, [esi+3E8h]
.text:0040500E		       cmp     eax, __maxwait
.text:00405014		       jbe     short loc_405019
.text:00405016		       or      eax, 0FFFFFFFFh
.text:00405019
.text:00405019 loc_405019:			       ; CODE XREF: __calloc_crt+37j
.text:00405019		       cmp     eax, 0FFFFFFFFh
.text:0040501C		       mov     esi, eax
.text:0040501E		       jnz     short Retry_0
.text:00405020
.text:00405020 loc_405020:			       ; CODE XREF: __calloc_crt+1Aj
.text:00405020					       ; __calloc_crt+22j
.text:00405020		       mov     eax, edi
.text:00405022		       pop     edi
.text:00405023		       pop     esi
.text:00405024		       retn
.text:00405024 __calloc_crt    endp
.text:00405024
.text:00405025
.text:00405025 ; =============== S U B R O U T I N E =======================================
.text:00405025
.text:00405025
.text:00405025 ; void *__cdecl _realloc_crt(void *ptr, unsigned	int size)
.text:00405025 __realloc_crt   proc near	       ; CODE XREF: _onexit_nolock+5Cp
.text:00405025					       ; _onexit_nolock+73p ...
.text:00405025
.text:00405025 ptr	       = dword ptr  4
.text:00405025 size	       = dword ptr  8
.text:00405025
.text:00405025		       push    esi
.text:00405026		       push    edi
.text:00405027		       xor     esi, esi
.text:00405029
.text:00405029 Retry_1:				       ; CODE XREF: __realloc_crt+44j
.text:00405029		       push    [esp+8+size]    ; newsize
.text:0040502D		       push    [esp+0Ch+ptr]   ; pBlock
.text:00405031		       call    _realloc
.text:00405036		       mov     edi, eax
.text:00405038		       test    edi, edi
.text:0040503A		       pop     ecx
.text:0040503B		       pop     ecx
.text:0040503C		       jnz     short loc_40506B
.text:0040503E		       cmp     [esp+8+size], eax
.text:00405042		       jz      short loc_40506B
.text:00405044		       cmp     __maxwait, eax
.text:0040504A		       jbe     short loc_40506B
.text:0040504C		       push    esi	       ; dwMilliseconds
.text:0040504D		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:00405053		       lea     eax, [esi+3E8h]
.text:00405059		       cmp     eax, __maxwait
.text:0040505F		       jbe     short loc_405064
.text:00405061		       or      eax, 0FFFFFFFFh
.text:00405064
.text:00405064 loc_405064:			       ; CODE XREF: __realloc_crt+3Aj
.text:00405064		       cmp     eax, 0FFFFFFFFh
.text:00405067		       mov     esi, eax
.text:00405069		       jnz     short Retry_1
.text:0040506B
.text:0040506B loc_40506B:			       ; CODE XREF: __realloc_crt+17j
.text:0040506B					       ; __realloc_crt+1Dj ...
.text:0040506B		       mov     eax, edi
.text:0040506D		       pop     edi
.text:0040506E		       pop     esi
.text:0040506F		       retn
.text:0040506F __realloc_crt   endp
.text:0040506F
.text:00405070
.text:00405070 ; =============== S U B R O U T I N E =======================================
.text:00405070
.text:00405070
.text:00405070 ; void *__cdecl _recalloc_crt(void *ptr,	unsigned int count, unsigned int size)
.text:00405070 __recalloc_crt  proc near	       ; CODE XREF: ___crtsetenv+13Ep
.text:00405070					       ; ___crtsetenv+17Ap
.text:00405070
.text:00405070 ptr	       = dword ptr  4
.text:00405070 count	       = dword ptr  8
.text:00405070 size	       = dword ptr  0Ch
.text:00405070
.text:00405070		       push    esi
.text:00405071		       push    edi
.text:00405072		       xor     esi, esi
.text:00405074
.text:00405074 Retry_2:				       ; CODE XREF: __recalloc_crt+49j
.text:00405074		       push    [esp+8+size]    ; size
.text:00405078		       push    [esp+0Ch+count] ; count
.text:0040507C		       push    [esp+10h+ptr]   ; memblock
.text:00405080		       call    __recalloc
.text:00405085		       mov     edi, eax
.text:00405087		       add     esp, 0Ch
.text:0040508A		       test    edi, edi
.text:0040508C		       jnz     short loc_4050BB
.text:0040508E		       cmp     [esp+8+size], eax
.text:00405092		       jz      short loc_4050BB
.text:00405094		       cmp     __maxwait, eax
.text:0040509A		       jbe     short loc_4050BB
.text:0040509C		       push    esi	       ; dwMilliseconds
.text:0040509D		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:004050A3		       lea     eax, [esi+3E8h]
.text:004050A9		       cmp     eax, __maxwait
.text:004050AF		       jbe     short loc_4050B4
.text:004050B1		       or      eax, 0FFFFFFFFh
.text:004050B4
.text:004050B4 loc_4050B4:			       ; CODE XREF: __recalloc_crt+3Fj
.text:004050B4		       cmp     eax, 0FFFFFFFFh
.text:004050B7		       mov     esi, eax
.text:004050B9		       jnz     short Retry_2
.text:004050BB
.text:004050BB loc_4050BB:			       ; CODE XREF: __recalloc_crt+1Cj
.text:004050BB					       ; __recalloc_crt+22j ...
.text:004050BB		       mov     eax, edi
.text:004050BD		       pop     edi
.text:004050BE		       pop     esi
.text:004050BF		       retn
.text:004050BF __recalloc_crt  endp
.text:004050BF
.text:004050C0
.text:004050C0 ; =============== S U B R O U T I N E =======================================
.text:004050C0
.text:004050C0
.text:004050C0 ; void *__fastcall _malloc_crt_fastcall(unsigned	int cb)
.text:004050C0 @_malloc_crt_fastcall@4 proc near
.text:004050C0 cb = ecx
.text:004050C0		       push    cb	       ; cb
.text:004050C1		       call    __malloc_crt
.text:004050C6		       pop     cb
.text:004050C7		       retn
.text:004050C7 @_malloc_crt_fastcall@4 endp
.text:004050C7
.text:004050C8
.text:004050C8 ; =============== S U B R O U T I N E =======================================
.text:004050C8
.text:004050C8
.text:004050C8 ; void *__fastcall _calloc_crt_fastcall(unsigned	int count, unsigned int	size)
.text:004050C8 @_calloc_crt_fastcall@8 proc near
.text:004050C8 count = ecx
.text:004050C8 size = edx
.text:004050C8		       push    size	       ; size
.text:004050C9		       push    count	       ; count
.text:004050CA		       call    __calloc_crt
.text:004050CF		       pop     count
.text:004050D0		       pop     count
.text:004050D1		       retn
.text:004050D1 @_calloc_crt_fastcall@8 endp
.text:004050D1
.text:004050D2
.text:004050D2 ; =============== S U B R O U T I N E =======================================
.text:004050D2
.text:004050D2
.text:004050D2 ; void *__fastcall _realloc_crt_fastcall(void *ptr, unsigned int	size)
.text:004050D2 @_realloc_crt_fastcall@8	proc near
.text:004050D2 ptr = ecx
.text:004050D2 size = edx
.text:004050D2		       push    size	       ; size
.text:004050D3		       push    ptr	       ; ptr
.text:004050D4		       call    __realloc_crt
.text:004050D9		       pop     ptr
.text:004050DA		       pop     ptr
.text:004050DB		       retn
.text:004050DB @_realloc_crt_fastcall@8	endp
.text:004050DB
.text:004050DC
.text:004050DC ; =============== S U B R O U T I N E =======================================
.text:004050DC
.text:004050DC ; Attributes: bp-based frame
.text:004050DC
.text:004050DC ; int __cdecl _fcloseall()
.text:004050DC __fcloseall     proc near	       ; CODE XREF: ___endstdio+Ep
.text:004050DC
.text:004050DC i	       = dword ptr -20h
.text:004050DC count	       = dword ptr -1Ch
.text:004050DC ms_exc	       = CPPEH_RECORD ptr -18h
.text:004050DC
.text:004050DC		       push    10h
.text:004050DE		       push    offset dword_4206D8
.text:004050E3		       call    __SEH_prolog4
.text:004050E8		       xor     ebx, ebx
.text:004050EA		       mov     [ebp+count], ebx
.text:004050ED		       push    1	       ; locknum
.text:004050EF		       call    __lock
.text:004050F4		       pop     ecx
.text:004050F5		       mov     [ebp+ms_exc.disabled], ebx
.text:004050F8		       push    3
.text:004050FA		       pop     edi
.text:004050FB
.text:004050FB loc_4050FB:			       ; CODE XREF: __fcloseall+7Fj
.text:004050FB		       mov     [ebp+i],	edi
.text:004050FE		       cmp     edi, __nstream
.text:00405104		       jge     short loc_40515D
.text:00405106		       mov     esi, edi
.text:00405108		       shl     esi, 2
.text:0040510B		       mov     eax, ___piob
.text:00405110		       add     eax, esi
.text:00405112		       cmp     [eax], ebx
.text:00405114		       jz      short loc_40515A
.text:00405116		       mov     eax, [eax]
.text:00405118		       test    byte ptr	[eax+0Ch], 83h
.text:0040511C		       jz      short loc_40512D
.text:0040511E		       push    eax	       ; stream
.text:0040511F		       call    _fclose
.text:00405124		       pop     ecx
.text:00405125		       cmp     eax, 0FFFFFFFFh
.text:00405128		       jz      short loc_40512D
.text:0040512A		       inc     [ebp+count]
.text:0040512D
.text:0040512D loc_40512D:			       ; CODE XREF: __fcloseall+40j
.text:0040512D					       ; __fcloseall+4Cj
.text:0040512D		       cmp     edi, 14h
.text:00405130		       jl      short loc_40515A
.text:00405132		       mov     eax, ___piob
.text:00405137		       mov     eax, [esi+eax]
.text:0040513A		       add     eax, 20h
.text:0040513D		       push    eax	       ; lpCriticalSection
.text:0040513E		       call    ds:__imp__DeleteCriticalSection@4 ; DeleteCriticalSection(x)
.text:00405144		       mov     eax, ___piob
.text:00405149		       push    dword ptr [esi+eax] ; pBlock
.text:0040514C		       call    _free
.text:00405151		       pop     ecx
.text:00405152		       mov     eax, ___piob
.text:00405157		       mov     [esi+eax], ebx
.text:0040515A
.text:0040515A loc_40515A:			       ; CODE XREF: __fcloseall+38j
.text:0040515A					       ; __fcloseall+54j
.text:0040515A		       inc     edi
.text:0040515B		       jmp     short loc_4050FB
.text:0040515D ; ---------------------------------------------------------------------------
.text:0040515D
.text:0040515D loc_40515D:			       ; CODE XREF: __fcloseall+28j
.text:0040515D		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00405164		       call    $LN11_2
.text:00405169
.text:00405169 $LN14_0:
.text:00405169		       mov     eax, [ebp+count]
.text:0040516C		       call    __SEH_epilog4
.text:00405171		       retn
.text:00405172 ; ---------------------------------------------------------------------------
.text:00405172
.text:00405172 $LN11_2:				       ; CODE XREF: __fcloseall+88p
.text:00405172					       ; DATA XREF: .rdata:004206F0o
.text:00405172		       push    1	       ; locknum
.text:00405174		       call    __unlock
.text:00405179		       pop     ecx
.text:0040517A
.text:0040517A $LN12_3:
.text:0040517A		       retn
.text:0040517A __fcloseall     endp
.text:0040517A
.text:0040517B
.text:0040517B ; =============== S U B R O U T I N E =======================================
.text:0040517B
.text:0040517B
.text:0040517B ; int __cdecl _flush(_iobuf *str)
.text:0040517B __flush	       proc near	       ; CODE XREF: __ftbuf+15p
.text:0040517B					       ; __fflush_nolock+13p ...
.text:0040517B
.text:0040517B str	       = dword ptr  4
.text:0040517B
.text:0040517B		       push    ebx
.text:0040517C		       push    esi
.text:0040517D		       mov     esi, [esp+8+str]
.text:00405181		       mov     eax, [esi+0Ch]
.text:00405184		       mov     ecx, eax
.text:00405186		       and     cl, 3
.text:00405189		       xor     ebx, ebx
.text:0040518B		       cmp     cl, 2
.text:0040518E		       jnz     short loc_4051CF
.text:00405190		       test    ax, 108h
.text:00405194		       jz      short loc_4051CF
.text:00405196		       mov     eax, [esi+8]
.text:00405199		       push    edi
.text:0040519A		       mov     edi, [esi]
.text:0040519C		       sub     edi, eax
.text:0040519E		       test    edi, edi
.text:004051A0		       jle     short loc_4051CE
.text:004051A2		       push    edi	       ; cnt
.text:004051A3		       push    eax	       ; buf
.text:004051A4		       push    esi	       ; stream
.text:004051A5		       call    __fileno
.text:004051AA		       pop     ecx
.text:004051AB		       push    eax	       ; fh
.text:004051AC		       call    __write
.text:004051B1		       add     esp, 0Ch
.text:004051B4		       cmp     eax, edi
.text:004051B6		       jnz     short loc_4051C7
.text:004051B8		       mov     eax, [esi+0Ch]
.text:004051BB		       test    al, al
.text:004051BD		       jns     short loc_4051CE
.text:004051BF		       and     eax, 0FFFFFFFDh
.text:004051C2		       mov     [esi+0Ch], eax
.text:004051C5		       jmp     short loc_4051CE
.text:004051C7 ; ---------------------------------------------------------------------------
.text:004051C7
.text:004051C7 loc_4051C7:			       ; CODE XREF: __flush+3Bj
.text:004051C7		       or      dword ptr [esi+0Ch], 20h
.text:004051CB		       or      ebx, 0FFFFFFFFh
.text:004051CE
.text:004051CE loc_4051CE:			       ; CODE XREF: __flush+25j
.text:004051CE					       ; __flush+42j ...
.text:004051CE		       pop     edi
.text:004051CF
.text:004051CF loc_4051CF:			       ; CODE XREF: __flush+13j
.text:004051CF					       ; __flush+19j
.text:004051CF		       mov     eax, [esi+8]
.text:004051D2		       and     dword ptr [esi+4], 0
.text:004051D6		       mov     [esi], eax
.text:004051D8		       pop     esi
.text:004051D9		       mov     eax, ebx
.text:004051DB		       pop     ebx
.text:004051DC		       retn
.text:004051DC __flush	       endp
.text:004051DC
.text:004051DD
.text:004051DD ; =============== S U B R O U T I N E =======================================
.text:004051DD
.text:004051DD
.text:004051DD ; int __cdecl _fflush_nolock(_iobuf *str)
.text:004051DD __fflush_nolock proc near	       ; CODE XREF: flsall+69p
.text:004051DD					       ; flsall+84p ...
.text:004051DD
.text:004051DD str	       = dword ptr  4
.text:004051DD
.text:004051DD		       push    esi
.text:004051DE		       mov     esi, [esp+4+str]
.text:004051E2		       test    esi, esi
.text:004051E4		       jnz     short loc_4051EF
.text:004051E6		       push    esi	       ; flushflag
.text:004051E7		       call    flsall
.text:004051EC		       pop     ecx
.text:004051ED		       pop     esi
.text:004051EE		       retn
.text:004051EF ; ---------------------------------------------------------------------------
.text:004051EF
.text:004051EF loc_4051EF:			       ; CODE XREF: __fflush_nolock+7j
.text:004051EF		       push    esi	       ; str
.text:004051F0		       call    __flush
.text:004051F5		       test    eax, eax
.text:004051F7		       pop     ecx
.text:004051F8		       jz      short loc_4051FF
.text:004051FA		       or      eax, 0FFFFFFFFh
.text:004051FD		       pop     esi
.text:004051FE		       retn
.text:004051FF ; ---------------------------------------------------------------------------
.text:004051FF
.text:004051FF loc_4051FF:			       ; CODE XREF: __fflush_nolock+1Bj
.text:004051FF		       test    word ptr	[esi+0Ch], 4000h
.text:00405205		       jz      short loc_40521B
.text:00405207		       push    esi	       ; stream
.text:00405208		       call    __fileno
.text:0040520D		       push    eax	       ; filedes
.text:0040520E		       call    __commit
.text:00405213		       pop     ecx
.text:00405214		       pop     ecx
.text:00405215		       neg     eax
.text:00405217		       sbb     eax, eax
.text:00405219		       pop     esi
.text:0040521A		       retn
.text:0040521B ; ---------------------------------------------------------------------------
.text:0040521B
.text:0040521B loc_40521B:			       ; CODE XREF: __fflush_nolock+28j
.text:0040521B		       xor     eax, eax
.text:0040521D		       pop     esi
.text:0040521E		       retn
.text:0040521E __fflush_nolock endp
.text:0040521E
.text:0040521F
.text:0040521F ; =============== S U B R O U T I N E =======================================
.text:0040521F
.text:0040521F ; Attributes: bp-based frame
.text:0040521F
.text:0040521F ; int __cdecl flsall(int	flushflag)
.text:0040521F flsall	       proc near	       ; CODE XREF: __fflush_nolock+Ap
.text:0040521F					       ; _fflush+14p ...
.text:0040521F
.text:0040521F err	       = dword ptr -24h
.text:0040521F i	       = dword ptr -20h
.text:0040521F count	       = dword ptr -1Ch
.text:0040521F ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040521F flushflag       = dword ptr  8
.text:0040521F
.text:0040521F		       push    14h
.text:00405221		       push    offset dword_4206F8
.text:00405226		       call    __SEH_prolog4
.text:0040522B		       xor     edi, edi
.text:0040522D		       mov     [ebp+count], edi
.text:00405230		       mov     [ebp+err], edi
.text:00405233		       push    1	       ; locknum
.text:00405235		       call    __lock
.text:0040523A		       pop     ecx
.text:0040523B		       mov     [ebp+ms_exc.disabled], edi
.text:0040523E		       xor     esi, esi
.text:00405240
.text:00405240 loc_405240:			       ; CODE XREF: flsall+9Bj
.text:00405240		       mov     [ebp+i],	esi
.text:00405243		       cmp     esi, __nstream
.text:00405249		       jge     loc_4052D2
.text:0040524F		       mov     eax, ___piob
.text:00405254		       lea     eax, [eax+esi*4]
.text:00405257		       cmp     [eax], edi
.text:00405259		       jz      short $LN25
.text:0040525B		       mov     eax, [eax]
.text:0040525D		       test    byte ptr	[eax+0Ch], 83h
.text:00405261		       jz      short $LN25
.text:00405263		       push    eax	       ; s
.text:00405264		       push    esi	       ; i
.text:00405265		       call    __lock_file2
.text:0040526A		       pop     ecx
.text:0040526B		       pop     ecx
.text:0040526C		       xor     edx, edx
.text:0040526E		       inc     edx
.text:0040526F		       mov     [ebp+ms_exc.disabled], edx
.text:00405272		       mov     eax, ___piob
.text:00405277		       mov     eax, [eax+esi*4]
.text:0040527A		       mov     ecx, [eax+0Ch]
.text:0040527D		       test    cl, 83h
.text:00405280		       jz      short loc_4052B1
.text:00405282		       cmp     [ebp+flushflag],	edx
.text:00405285		       jnz     short loc_405298
.text:00405287		       push    eax	       ; str
.text:00405288		       call    __fflush_nolock
.text:0040528D		       pop     ecx
.text:0040528E		       cmp     eax, 0FFFFFFFFh
.text:00405291		       jz      short loc_4052B1
.text:00405293		       inc     [ebp+count]
.text:00405296		       jmp     short loc_4052B1
.text:00405298 ; ---------------------------------------------------------------------------
.text:00405298
.text:00405298 loc_405298:			       ; CODE XREF: flsall+66j
.text:00405298		       cmp     [ebp+flushflag],	edi
.text:0040529B		       jnz     short loc_4052B1
.text:0040529D		       test    cl, 2
.text:004052A0		       jz      short loc_4052B1
.text:004052A2		       push    eax	       ; str
.text:004052A3		       call    __fflush_nolock
.text:004052A8		       pop     ecx
.text:004052A9		       cmp     eax, 0FFFFFFFFh
.text:004052AC		       jnz     short loc_4052B1
.text:004052AE		       or      [ebp+err], eax
.text:004052B1
.text:004052B1 loc_4052B1:			       ; CODE XREF: flsall+61j
.text:004052B1					       ; flsall+72j ...
.text:004052B1		       mov     [ebp+ms_exc.disabled], edi
.text:004052B4		       call    $LN24_0
.text:004052B9
.text:004052B9 $LN25:				       ; CODE XREF: flsall+3Aj
.text:004052B9					       ; flsall+42j
.text:004052B9		       inc     esi
.text:004052BA		       jmp     short loc_405240
.text:004052BC ; ---------------------------------------------------------------------------
.text:004052BC
.text:004052BC $LN22_0:				       ; DATA XREF: .rdata:0042071Co
.text:004052BC		       xor     edi, edi
.text:004052BE		       mov     esi, [ebp+i]
.text:004052C1
.text:004052C1 $LN24_0:				       ; CODE XREF: flsall+95p
.text:004052C1		       mov     eax, ___piob
.text:004052C6		       push    dword ptr [eax+esi*4] ; s
.text:004052C9		       push    esi	       ; i
.text:004052CA		       call    __unlock_file2
.text:004052CF		       pop     ecx
.text:004052D0		       pop     ecx
.text:004052D1
.text:004052D1 $LN23_0:
.text:004052D1		       retn
.text:004052D2 ; ---------------------------------------------------------------------------
.text:004052D2
.text:004052D2 loc_4052D2:			       ; CODE XREF: flsall+2Aj
.text:004052D2		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004052D9		       call    $LN18_0
.text:004052DE
.text:004052DE $LN21_0:
.text:004052DE		       cmp     [ebp+flushflag],	1
.text:004052E2		       mov     eax, [ebp+count]
.text:004052E5		       jz      short loc_4052EA
.text:004052E7		       mov     eax, [ebp+err]
.text:004052EA
.text:004052EA loc_4052EA:			       ; CODE XREF: flsall+C6j
.text:004052EA		       call    __SEH_epilog4
.text:004052EF		       retn
.text:004052F0 ; ---------------------------------------------------------------------------
.text:004052F0
.text:004052F0 $LN18_0:				       ; CODE XREF: flsall+BAp
.text:004052F0					       ; DATA XREF: .rdata:00420710o
.text:004052F0		       push    1	       ; locknum
.text:004052F2		       call    __unlock
.text:004052F7		       pop     ecx
.text:004052F8
.text:004052F8 $LN19_3:
.text:004052F8		       retn
.text:004052F8 flsall	       endp ; sp-analysis failed
.text:004052F8
.text:004052F9
.text:004052F9 ; =============== S U B R O U T I N E =======================================
.text:004052F9
.text:004052F9 ; Attributes: bp-based frame
.text:004052F9
.text:004052F9 ; int __cdecl fflush(_iobuf *stream)
.text:004052F9 _fflush	       proc near
.text:004052F9
.text:004052F9 rc	       = dword ptr -1Ch
.text:004052F9 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004052F9 stream	       = dword ptr  8
.text:004052F9
.text:004052F9		       push    0Ch
.text:004052FB		       push    offset dword_420720
.text:00405300		       call    __SEH_prolog4
.text:00405305		       xor     esi, esi
.text:00405307		       cmp     [ebp+stream], esi
.text:0040530A		       jnz     short loc_405315
.text:0040530C		       push    esi	       ; flushflag
.text:0040530D		       call    flsall
.text:00405312		       pop     ecx
.text:00405313		       jmp     short loc_40533C
.text:00405315 ; ---------------------------------------------------------------------------
.text:00405315
.text:00405315 loc_405315:			       ; CODE XREF: _fflush+11j
.text:00405315		       push    [ebp+stream]    ; pf
.text:00405318		       call    __lock_file
.text:0040531D		       pop     ecx
.text:0040531E		       mov     [ebp+ms_exc.disabled], esi
.text:00405321		       push    [ebp+stream]    ; str
.text:00405324		       call    __fflush_nolock
.text:00405329		       pop     ecx
.text:0040532A		       mov     [ebp+rc], eax
.text:0040532D		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00405334		       call    $LN6_5
.text:00405339
.text:00405339 $LN9_3:
.text:00405339		       mov     eax, [ebp+rc]
.text:0040533C
.text:0040533C loc_40533C:			       ; CODE XREF: _fflush+1Aj
.text:0040533C		       call    __SEH_epilog4
.text:00405341		       retn
.text:00405342 ; ---------------------------------------------------------------------------
.text:00405342
.text:00405342 $LN6_5:				       ; CODE XREF: _fflush+3Bp
.text:00405342					       ; DATA XREF: .rdata:00420738o
.text:00405342		       push    [ebp+stream]    ; pf
.text:00405345		       call    __unlock_file
.text:0040534A		       pop     ecx
.text:0040534B
.text:0040534B $LN7_5:
.text:0040534B		       retn
.text:0040534B _fflush	       endp
.text:0040534B
.text:0040534C
.text:0040534C ; =============== S U B R O U T I N E =======================================
.text:0040534C
.text:0040534C
.text:0040534C ; int __cdecl _flushall()
.text:0040534C __flushall      proc near	       ; CODE XREF: ___endstdiop
.text:0040534C		       push    1	       ; flushflag
.text:0040534E		       call    flsall
.text:00405353		       pop     ecx
.text:00405354		       retn
.text:00405354 __flushall      endp
.text:00405354
.text:00405355
.text:00405355 ; =============== S U B R O U T I N E =======================================
.text:00405355
.text:00405355
.text:00405355 ; unsigned int __cdecl _get_sbh_threshold()
.text:00405355 __get_sbh_threshold proc	near
.text:00405355		       cmp     __crtheap, 0
.text:0040535C		       jnz     short loc_405361
.text:0040535E		       xor     eax, eax
.text:00405360		       retn
.text:00405361 ; ---------------------------------------------------------------------------
.text:00405361
.text:00405361 loc_405361:			       ; CODE XREF: __get_sbh_threshold+7j
.text:00405361		       mov     eax, ___active_heap
.text:00405366		       sub     eax, 3
.text:00405369		       neg     eax
.text:0040536B		       sbb     eax, eax
.text:0040536D		       not     eax
.text:0040536F		       and     eax, ___sbh_threshold
.text:00405375		       retn
.text:00405375 __get_sbh_threshold endp
.text:00405375
.text:00405376
.text:00405376 ; =============== S U B R O U T I N E =======================================
.text:00405376
.text:00405376
.text:00405376 ; int __cdecl _set_amblksiz(unsigned int	size)
.text:00405376 __set_amblksiz  proc near
.text:00405376
.text:00405376 size	       = dword ptr  4
.text:00405376
.text:00405376		       mov     eax, [esp+size]
.text:0040537A		       lea     ecx, [eax-1]
.text:0040537D		       cmp     ecx, 0FFFFFFFEh
.text:00405380		       push    esi
.text:00405381		       jbe     short loc_4053A2
.text:00405383		       call    __errno
.text:00405388		       xor     esi, esi
.text:0040538A
.text:0040538A loc_40538A:			       ; CODE XREF: __set_amblksiz+3Bj
.text:0040538A		       push    esi	       ; pReserved
.text:0040538B		       push    esi	       ; nLine
.text:0040538C		       push    esi	       ; pszFile
.text:0040538D		       push    esi	       ; pszFunction
.text:0040538E		       push    esi	       ; pszExpression
.text:0040538F		       mov     dword ptr [eax],	16h
.text:00405395		       call    __invalid_parameter
.text:0040539A		       add     esp, 14h
.text:0040539D		       push    16h
.text:0040539F		       pop     eax
.text:004053A0		       pop     esi
.text:004053A1		       retn
.text:004053A2 ; ---------------------------------------------------------------------------
.text:004053A2
.text:004053A2 loc_4053A2:			       ; CODE XREF: __set_amblksiz+Bj
.text:004053A2		       xor     esi, esi
.text:004053A4		       cmp     __crtheap, esi
.text:004053AA		       jnz     short loc_4053B3
.text:004053AC		       call    __errno
.text:004053B1		       jmp     short loc_40538A
.text:004053B3 ; ---------------------------------------------------------------------------
.text:004053B3
.text:004053B3 loc_4053B3:			       ; CODE XREF: __set_amblksiz+34j
.text:004053B3		       mov     __amblksiz, eax
.text:004053B8		       xor     eax, eax
.text:004053BA		       pop     esi
.text:004053BB		       retn
.text:004053BB __set_amblksiz  endp
.text:004053BB
.text:004053BC
.text:004053BC ; =============== S U B R O U T I N E =======================================
.text:004053BC
.text:004053BC
.text:004053BC ; int __cdecl _get_amblksiz(unsigned int	*pSize)
.text:004053BC __get_amblksiz  proc near
.text:004053BC
.text:004053BC pSize	       = dword ptr  4
.text:004053BC
.text:004053BC		       mov     eax, [esp+pSize]
.text:004053C0		       push    esi
.text:004053C1		       xor     esi, esi
.text:004053C3		       cmp     eax, esi
.text:004053C5		       jnz     short loc_4053E4
.text:004053C7
.text:004053C7 loc_4053C7:			       ; CODE XREF: __get_amblksiz+2Ej
.text:004053C7		       call    __errno
.text:004053CC		       push    esi	       ; pReserved
.text:004053CD		       push    esi	       ; nLine
.text:004053CE		       push    esi	       ; pszFile
.text:004053CF		       push    esi	       ; pszFunction
.text:004053D0		       push    esi	       ; pszExpression
.text:004053D1		       mov     dword ptr [eax],	16h
.text:004053D7		       call    __invalid_parameter
.text:004053DC		       add     esp, 14h
.text:004053DF		       push    16h
.text:004053E1		       pop     eax
.text:004053E2		       pop     esi
.text:004053E3		       retn
.text:004053E4 ; ---------------------------------------------------------------------------
.text:004053E4
.text:004053E4 loc_4053E4:			       ; CODE XREF: __get_amblksiz+9j
.text:004053E4		       cmp     __crtheap, esi
.text:004053EA		       jz      short loc_4053C7
.text:004053EC		       mov     ecx, __amblksiz
.text:004053F2		       mov     [eax], ecx
.text:004053F4		       xor     eax, eax
.text:004053F6		       pop     esi
.text:004053F7		       retn
.text:004053F7 __get_amblksiz  endp
.text:004053F7
.text:004053F8
.text:004053F8 ; =============== S U B R O U T I N E =======================================
.text:004053F8
.text:004053F8
.text:004053F8 ; int __cdecl __sbh_heap_init(unsigned int threshold)
.text:004053F8 ___sbh_heap_init	proc near	       ; CODE XREF: __set_sbh_threshold+5Fp
.text:004053F8					       ; __heap_init+37p
.text:004053F8
.text:004053F8 threshold       = dword ptr  4
.text:004053F8
.text:004053F8		       push    140h	       ; dwBytes
.text:004053FD		       push    0	       ; dwFlags
.text:004053FF		       push    __crtheap       ; hHeap
.text:00405405		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:0040540B		       test    eax, eax
.text:0040540D		       mov     ___sbh_pHeaderList, eax
.text:00405412		       jnz     short loc_405415
.text:00405414		       retn
.text:00405415 ; ---------------------------------------------------------------------------
.text:00405415
.text:00405415 loc_405415:			       ; CODE XREF: ___sbh_heap_init+1Aj
.text:00405415		       mov     ecx, [esp+threshold]
.text:00405419		       and     ___sbh_pHeaderDefer, 0
.text:00405420		       and     ___sbh_cntHeaderList, 0
.text:00405427		       mov     ___sbh_pHeaderScan, eax
.text:0040542C		       xor     eax, eax
.text:0040542E		       mov     ___sbh_threshold, ecx
.text:00405434		       mov     ___sbh_sizeHeaderList, 10h
.text:0040543E		       inc     eax
.text:0040543F		       retn
.text:0040543F ___sbh_heap_init	endp
.text:0040543F
.text:00405440
.text:00405440 ; =============== S U B R O U T I N E =======================================
.text:00405440
.text:00405440
.text:00405440 ; tagHeader *__cdecl __sbh_find_block(void *pvAlloc)
.text:00405440 ___sbh_find_block proc near	       ; CODE XREF: _free+29p
.text:00405440					       ; __msize+4Ep ...
.text:00405440
.text:00405440 pvAlloc	       = dword ptr  4
.text:00405440
.text:00405440		       mov     ecx, ___sbh_cntHeaderList
.text:00405446		       mov     eax, ___sbh_pHeaderList
.text:0040544B		       imul    ecx, 14h
.text:0040544E		       add     ecx, eax
.text:00405450		       jmp     short loc_405464
.text:00405452 ; ---------------------------------------------------------------------------
.text:00405452
.text:00405452 loc_405452:			       ; CODE XREF: ___sbh_find_block+26j
.text:00405452		       mov     edx, [esp+pvAlloc]
.text:00405456		       sub     edx, [eax+0Ch]
.text:00405459		       cmp     edx, 100000h
.text:0040545F		       jb      short locret_40546A
.text:00405461		       add     eax, 14h
.text:00405464
.text:00405464 loc_405464:			       ; CODE XREF: ___sbh_find_block+10j
.text:00405464		       cmp     eax, ecx
.text:00405466		       jb      short loc_405452
.text:00405468		       xor     eax, eax
.text:0040546A
.text:0040546A locret_40546A:			       ; CODE XREF: ___sbh_find_block+1Fj
.text:0040546A		       retn
.text:0040546A ___sbh_find_block endp
.text:0040546A
.text:0040546B
.text:0040546B ; =============== S U B R O U T I N E =======================================
.text:0040546B
.text:0040546B ; Attributes: bp-based frame
.text:0040546B
.text:0040546B ; void __cdecl __sbh_free_block(tagHeader *pHeader, void	*pvAlloc)
.text:0040546B ___sbh_free_block proc near	       ; CODE XREF: _free+38p
.text:0040546B					       ; _realloc+B5p ...
.text:0040546B
.text:0040546B pGroup	       = dword ptr -10h
.text:0040546B sizeNext	       = dword ptr -0Ch
.text:0040546B sizePrev	       = dword ptr -8
.text:0040546B sizeEntry       = dword ptr -4
.text:0040546B indPrev	       = dword ptr  8
.text:0040546B pNext	       = dword ptr  0Ch
.text:0040546B
.text:0040546B		       push    ebp
.text:0040546C		       mov     ebp, esp
.text:0040546E		       sub     esp, 10h
.text:00405471		       mov     ecx, [ebp+indPrev]
.text:00405474		       mov     eax, [ecx+10h]
.text:00405477		       push    esi
.text:00405478		       mov     esi, [ebp+pNext]
.text:0040547B		       push    edi
.text:0040547C		       mov     edi, esi
.text:0040547E		       sub     edi, [ecx+0Ch]
.text:00405481		       add     esi, 0FFFFFFFCh
.text:00405484		       shr     edi, 0Fh
.text:00405487		       mov     ecx, edi
.text:00405489		       imul    ecx, 204h
.text:0040548F		       lea     ecx, [ecx+eax+144h]
.text:00405496		       mov     [ebp+pGroup], ecx
.text:00405499		       mov     ecx, [esi]
.text:0040549B		       dec     ecx
.text:0040549C		       test    cl, 1
.text:0040549F		       mov     [ebp+sizeEntry],	ecx
.text:004054A2		       jnz     loc_40577B
.text:004054A8		       push    ebx
.text:004054A9		       lea     ebx, [ecx+esi]
.text:004054AC		       mov     edx, [ebx]
.text:004054AE		       mov     [ebp+sizeNext], edx
.text:004054B1		       mov     edx, [esi-4]
.text:004054B4		       mov     [ebp+sizePrev], edx
.text:004054B7		       mov     edx, [ebp+sizeNext]
.text:004054BA		       test    dl, 1
.text:004054BD		       mov     [ebp+pNext], ebx
.text:004054C0		       jnz     short loc_405536
.text:004054C2		       sar     edx, 4
.text:004054C5		       dec     edx
.text:004054C6		       cmp     edx, 3Fh
.text:004054C9		       jbe     short loc_4054CE
.text:004054CB		       push    3Fh
.text:004054CD		       pop     edx
.text:004054CE
.text:004054CE loc_4054CE:			       ; CODE XREF: ___sbh_free_block+5Ej
.text:004054CE		       mov     ecx, [ebx+4]
.text:004054D1		       cmp     ecx, [ebx+8]
.text:004054D4		       jnz     short loc_405518
.text:004054D6		       cmp     edx, 20h
.text:004054D9		       mov     ebx, 80000000h
.text:004054DE		       jnb     short loc_4054F9
.text:004054E0		       mov     ecx, edx
.text:004054E2		       shr     ebx, cl
.text:004054E4		       lea     ecx, [edx+eax+4]
.text:004054E8		       not     ebx
.text:004054EA		       and     [eax+edi*4+44h],	ebx
.text:004054EE		       dec     byte ptr	[ecx]
.text:004054F0		       jnz     short loc_405515
.text:004054F2		       mov     ecx, [ebp+indPrev]
.text:004054F5		       and     [ecx], ebx
.text:004054F7		       jmp     short loc_405515
.text:004054F9 ; ---------------------------------------------------------------------------
.text:004054F9
.text:004054F9 loc_4054F9:			       ; CODE XREF: ___sbh_free_block+73j
.text:004054F9		       lea     ecx, [edx-20h]
.text:004054FC		       shr     ebx, cl
.text:004054FE		       lea     ecx, [edx+eax+4]
.text:00405502		       not     ebx
.text:00405504		       and     [eax+edi*4+0C4h], ebx
.text:0040550B		       dec     byte ptr	[ecx]
.text:0040550D		       jnz     short loc_405515
.text:0040550F		       mov     ecx, [ebp+indPrev]
.text:00405512		       and     [ecx+4],	ebx
.text:00405515
.text:00405515 loc_405515:			       ; CODE XREF: ___sbh_free_block+85j
.text:00405515					       ; ___sbh_free_block+8Cj	...
.text:00405515		       mov     ebx, [ebp+pNext]
.text:00405518
.text:00405518 loc_405518:			       ; CODE XREF: ___sbh_free_block+69j
.text:00405518		       mov     edx, [ebx+8]
.text:0040551B		       mov     ebx, [ebx+4]
.text:0040551E		       mov     ecx, [ebp+sizeEntry]
.text:00405521		       add     ecx, [ebp+sizeNext]
.text:00405524		       mov     [edx+4],	ebx
.text:00405527		       mov     edx, [ebp+pNext]
.text:0040552A		       mov     ebx, [edx+4]
.text:0040552D		       mov     edx, [edx+8]
.text:00405530		       mov     [ebx+8],	edx
.text:00405533		       mov     [ebp+sizeEntry],	ecx
.text:00405536
.text:00405536 loc_405536:			       ; CODE XREF: ___sbh_free_block+55j
.text:00405536		       mov     edx, ecx
.text:00405538		       sar     edx, 4
.text:0040553B		       dec     edx
.text:0040553C		       cmp     edx, 3Fh
.text:0040553F		       jbe     short loc_405544
.text:00405541		       push    3Fh
.text:00405543		       pop     edx
.text:00405544
.text:00405544 loc_405544:			       ; CODE XREF: ___sbh_free_block+D4j
.text:00405544		       mov     ebx, [ebp+sizePrev]
.text:00405547		       and     ebx, 1
.text:0040554A		       mov     [ebp+sizeNext], ebx
.text:0040554D		       jnz     loc_4055E2
.text:00405553		       sub     esi, [ebp+sizePrev]
.text:00405556		       mov     ebx, [ebp+sizePrev]
.text:00405559		       sar     ebx, 4
.text:0040555C		       push    3Fh
.text:0040555E		       mov     [ebp+pNext], esi
.text:00405561		       dec     ebx
.text:00405562		       pop     esi
.text:00405563		       cmp     ebx, esi
.text:00405565		       jbe     short loc_405569
.text:00405567		       mov     ebx, esi
.text:00405569
.text:00405569 loc_405569:			       ; CODE XREF: ___sbh_free_block+FAj
.text:00405569		       add     ecx, [ebp+sizePrev]
.text:0040556C		       mov     edx, ecx
.text:0040556E		       sar     edx, 4
.text:00405571		       dec     edx
.text:00405572		       cmp     edx, esi
.text:00405574		       mov     [ebp+sizeEntry],	ecx
.text:00405577		       jbe     short loc_40557B
.text:00405579		       mov     edx, esi
.text:0040557B
.text:0040557B loc_40557B:			       ; CODE XREF: ___sbh_free_block+10Cj
.text:0040557B		       cmp     ebx, edx
.text:0040557D		       jz      short loc_4055DD
.text:0040557F		       mov     ecx, [ebp+pNext]
.text:00405582		       mov     esi, [ecx+4]
.text:00405585		       cmp     esi, [ecx+8]
.text:00405588		       jnz     short loc_4055C5
.text:0040558A		       cmp     ebx, 20h
.text:0040558D		       mov     esi, 80000000h
.text:00405592		       jnb     short loc_4055AB
.text:00405594		       mov     ecx, ebx
.text:00405596		       shr     esi, cl
.text:00405598		       not     esi
.text:0040559A		       and     [eax+edi*4+44h],	esi
.text:0040559E		       dec     byte ptr	[ebx+eax+4]
.text:004055A2		       jnz     short loc_4055C5
.text:004055A4		       mov     ecx, [ebp+indPrev]
.text:004055A7		       and     [ecx], esi
.text:004055A9		       jmp     short loc_4055C5
.text:004055AB ; ---------------------------------------------------------------------------
.text:004055AB
.text:004055AB loc_4055AB:			       ; CODE XREF: ___sbh_free_block+127j
.text:004055AB		       lea     ecx, [ebx-20h]
.text:004055AE		       shr     esi, cl
.text:004055B0		       not     esi
.text:004055B2		       and     [eax+edi*4+0C4h], esi
.text:004055B9		       dec     byte ptr	[ebx+eax+4]
.text:004055BD		       jnz     short loc_4055C5
.text:004055BF		       mov     ecx, [ebp+indPrev]
.text:004055C2		       and     [ecx+4],	esi
.text:004055C5
.text:004055C5 loc_4055C5:			       ; CODE XREF: ___sbh_free_block+11Dj
.text:004055C5					       ; ___sbh_free_block+137j ...
.text:004055C5		       mov     ecx, [ebp+pNext]
.text:004055C8		       mov     esi, [ecx+8]
.text:004055CB		       mov     ecx, [ecx+4]
.text:004055CE		       mov     [esi+4],	ecx
.text:004055D1		       mov     ecx, [ebp+pNext]
.text:004055D4		       mov     esi, [ecx+4]
.text:004055D7		       mov     ecx, [ecx+8]
.text:004055DA		       mov     [esi+8],	ecx
.text:004055DD
.text:004055DD loc_4055DD:			       ; CODE XREF: ___sbh_free_block+112j
.text:004055DD		       mov     esi, [ebp+pNext]
.text:004055E0		       jmp     short loc_4055E5
.text:004055E2 ; ---------------------------------------------------------------------------
.text:004055E2
.text:004055E2 loc_4055E2:			       ; CODE XREF: ___sbh_free_block+E2j
.text:004055E2		       mov     ebx, [ebp+indPrev]
.text:004055E5
.text:004055E5 loc_4055E5:			       ; CODE XREF: ___sbh_free_block+175j
.text:004055E5		       cmp     [ebp+sizeNext], 0
.text:004055E9		       jnz     short loc_4055F3
.text:004055EB		       cmp     ebx, edx
.text:004055ED		       jz      loc_405673
.text:004055F3
.text:004055F3 loc_4055F3:			       ; CODE XREF: ___sbh_free_block+17Ej
.text:004055F3		       mov     ecx, [ebp+pGroup]
.text:004055F6		       lea     ecx, [ecx+edx*8]
.text:004055F9		       mov     ebx, [ecx+4]
.text:004055FC		       mov     [esi+8],	ecx
.text:004055FF		       mov     [esi+4],	ebx
.text:00405602		       mov     [ecx+4],	esi
.text:00405605		       mov     ecx, [esi+4]
.text:00405608		       mov     [ecx+8],	esi
.text:0040560B		       mov     ecx, [esi+4]
.text:0040560E		       cmp     ecx, [esi+8]
.text:00405611		       jnz     short loc_405673
.text:00405613		       mov     cl, [edx+eax+4]
.text:00405617		       mov     byte ptr	[ebp+pNext+3], cl
.text:0040561A		       inc     cl
.text:0040561C		       cmp     edx, 20h
.text:0040561F		       mov     [edx+eax+4], cl
.text:00405623		       jnb     short loc_40564A
.text:00405625		       cmp     byte ptr	[ebp+pNext+3], 0
.text:00405629		       jnz     short loc_405639
.text:0040562B		       mov     ecx, edx
.text:0040562D		       mov     ebx, 80000000h
.text:00405632		       shr     ebx, cl
.text:00405634		       mov     ecx, [ebp+indPrev]
.text:00405637		       or      [ecx], ebx
.text:00405639
.text:00405639 loc_405639:			       ; CODE XREF: ___sbh_free_block+1BEj
.text:00405639		       mov     ebx, 80000000h
.text:0040563E		       mov     ecx, edx
.text:00405640		       shr     ebx, cl
.text:00405642		       lea     eax, [eax+edi*4+44h]
.text:00405646		       or      [eax], ebx
.text:00405648		       jmp     short loc_405673
.text:0040564A ; ---------------------------------------------------------------------------
.text:0040564A
.text:0040564A loc_40564A:			       ; CODE XREF: ___sbh_free_block+1B8j
.text:0040564A		       cmp     byte ptr	[ebp+pNext+3], 0
.text:0040564E		       jnz     short loc_405660
.text:00405650		       lea     ecx, [edx-20h]
.text:00405653		       mov     ebx, 80000000h
.text:00405658		       shr     ebx, cl
.text:0040565A		       mov     ecx, [ebp+indPrev]
.text:0040565D		       or      [ecx+4],	ebx
.text:00405660
.text:00405660 loc_405660:			       ; CODE XREF: ___sbh_free_block+1E3j
.text:00405660		       lea     ecx, [edx-20h]
.text:00405663		       mov     edx, 80000000h
.text:00405668		       shr     edx, cl
.text:0040566A		       lea     eax, [eax+edi*4+0C4h]
.text:00405671		       or      [eax], edx
.text:00405673
.text:00405673 loc_405673:			       ; CODE XREF: ___sbh_free_block+182j
.text:00405673					       ; ___sbh_free_block+1A6j ...
.text:00405673		       mov     eax, [ebp+sizeEntry]
.text:00405676		       mov     [esi], eax
.text:00405678		       mov     [eax+esi-4], eax
.text:0040567C		       mov     eax, [ebp+pGroup]
.text:0040567F		       dec     dword ptr [eax]
.text:00405681		       jnz     loc_40577A
.text:00405687		       mov     eax, ___sbh_pHeaderDefer
.text:0040568C		       test    eax, eax
.text:0040568E		       jz      loc_40576C
.text:00405694		       mov     ecx, ___sbh_indGroupDefer
.text:0040569A		       mov     esi, ds:__imp__VirtualFree@12 ; VirtualFree(x,x,x)
.text:004056A0		       push    4000h	       ; dwFreeType
.text:004056A5		       shl     ecx, 0Fh
.text:004056A8		       add     ecx, [eax+0Ch]
.text:004056AB		       mov     ebx, 8000h
.text:004056B0		       push    ebx	       ; dwSize
.text:004056B1		       push    ecx	       ; lpAddress
.text:004056B2		       call    esi ; VirtualFree(x,x,x)	; VirtualFree(x,x,x)
.text:004056B4		       mov     ecx, ___sbh_indGroupDefer
.text:004056BA		       mov     eax, ___sbh_pHeaderDefer
.text:004056BF		       mov     edx, 80000000h
.text:004056C4		       shr     edx, cl
.text:004056C6		       or      [eax+8],	edx
.text:004056C9		       mov     eax, ___sbh_pHeaderDefer
.text:004056CE		       mov     eax, [eax+10h]
.text:004056D1		       mov     ecx, ___sbh_indGroupDefer
.text:004056D7		       and     dword ptr [eax+ecx*4+0C4h], 0
.text:004056DF		       mov     eax, ___sbh_pHeaderDefer
.text:004056E4		       mov     eax, [eax+10h]
.text:004056E7		       dec     byte ptr	[eax+43h]
.text:004056EA		       mov     eax, ___sbh_pHeaderDefer
.text:004056EF		       mov     ecx, [eax+10h]
.text:004056F2		       cmp     byte ptr	[ecx+43h], 0
.text:004056F6		       jnz     short loc_405701
.text:004056F8		       and     dword ptr [eax+4], 0FFFFFFFEh
.text:004056FC		       mov     eax, ___sbh_pHeaderDefer
.text:00405701
.text:00405701 loc_405701:			       ; CODE XREF: ___sbh_free_block+28Bj
.text:00405701		       cmp     dword ptr [eax+8], 0FFFFFFFFh
.text:00405705		       jnz     short loc_40576C
.text:00405707		       push    ebx	       ; dwFreeType
.text:00405708		       push    0	       ; dwSize
.text:0040570A		       push    dword ptr [eax+0Ch] ; lpAddress
.text:0040570D		       call    esi ; VirtualFree(x,x,x)	; VirtualFree(x,x,x)
.text:0040570F		       mov     eax, ___sbh_pHeaderDefer
.text:00405714		       push    dword ptr [eax+10h] ; lpMem
.text:00405717		       push    0	       ; dwFlags
.text:00405719		       push    __crtheap       ; hHeap
.text:0040571F		       call    ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00405725		       mov     ecx, ___sbh_cntHeaderList
.text:0040572B		       mov     eax, ___sbh_pHeaderDefer
.text:00405730		       imul    ecx, 14h
.text:00405733		       mov     edx, ___sbh_pHeaderList
.text:00405739		       sub     ecx, eax
.text:0040573B		       lea     ecx, [ecx+edx-14h]
.text:0040573F		       push    ecx	       ; count
.text:00405740		       lea     ecx, [eax+14h]
.text:00405743		       push    ecx	       ; src
.text:00405744		       push    eax	       ; dst
.text:00405745		       call    _memmove
.text:0040574A		       mov     eax, [ebp+indPrev]
.text:0040574D		       add     esp, 0Ch
.text:00405750		       dec     ___sbh_cntHeaderList
.text:00405756		       cmp     eax, ___sbh_pHeaderDefer
.text:0040575C		       jbe     short loc_405762
.text:0040575E		       sub     [ebp+indPrev], 14h
.text:00405762
.text:00405762 loc_405762:			       ; CODE XREF: ___sbh_free_block+2F1j
.text:00405762		       mov     eax, ___sbh_pHeaderList
.text:00405767		       mov     ___sbh_pHeaderScan, eax
.text:0040576C
.text:0040576C loc_40576C:			       ; CODE XREF: ___sbh_free_block+223j
.text:0040576C					       ; ___sbh_free_block+29Aj
.text:0040576C		       mov     eax, [ebp+indPrev]
.text:0040576F		       mov     ___sbh_pHeaderDefer, eax
.text:00405774		       mov     ___sbh_indGroupDefer, edi
.text:0040577A
.text:0040577A loc_40577A:			       ; CODE XREF: ___sbh_free_block+216j
.text:0040577A		       pop     ebx
.text:0040577B
.text:0040577B loc_40577B:			       ; CODE XREF: ___sbh_free_block+37j
.text:0040577B		       pop     edi
.text:0040577C		       pop     esi
.text:0040577D		       leave
.text:0040577E		       retn
.text:0040577E ___sbh_free_block endp
.text:0040577E
.text:0040577F
.text:0040577F ; =============== S U B R O U T I N E =======================================
.text:0040577F
.text:0040577F
.text:0040577F ; tagHeader *__cdecl __sbh_alloc_new_region()
.text:0040577F ___sbh_alloc_new_region proc near       ; CODE XREF: ___sbh_alloc_block+C0p
.text:0040577F		       mov     eax, ___sbh_sizeHeaderList
.text:00405784		       push    esi
.text:00405785		       mov     esi, ___sbh_cntHeaderList
.text:0040578B		       push    edi
.text:0040578C		       xor     edi, edi
.text:0040578E		       cmp     esi, eax
.text:00405790		       jnz     short loc_4057C6
.text:00405792		       add     eax, 10h
.text:00405795		       imul    eax, 14h
.text:00405798		       push    eax	       ; dwBytes
.text:00405799		       push    ___sbh_pHeaderList ; lpMem
.text:0040579F		       push    edi	       ; dwFlags
.text:004057A0		       push    __crtheap       ; hHeap
.text:004057A6		       call    ds:__imp__HeapReAlloc@16	; HeapReAlloc(x,x,x,x)
.text:004057AC		       cmp     eax, edi
.text:004057AE		       jnz     short loc_4057B4
.text:004057B0
.text:004057B0 loc_4057B0:			       ; CODE XREF: ___sbh_alloc_new_region+68j
.text:004057B0					       ; ___sbh_alloc_new_region+94j
.text:004057B0		       xor     eax, eax
.text:004057B2		       jmp     short loc_40582C
.text:004057B4 ; ---------------------------------------------------------------------------
.text:004057B4
.text:004057B4 loc_4057B4:			       ; CODE XREF: ___sbh_alloc_new_region+2Fj
.text:004057B4		       add     ___sbh_sizeHeaderList, 10h
.text:004057BB		       mov     esi, ___sbh_cntHeaderList
.text:004057C1		       mov     ___sbh_pHeaderList, eax
.text:004057C6
.text:004057C6 loc_4057C6:			       ; CODE XREF: ___sbh_alloc_new_region+11j
.text:004057C6		       imul    esi, 14h
.text:004057C9		       add     esi, ___sbh_pHeaderList
.text:004057CF		       push    41C4h	       ; dwBytes
.text:004057D4		       push    8	       ; dwFlags
.text:004057D6		       push    __crtheap       ; hHeap
.text:004057DC		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:004057E2		       cmp     eax, edi
.text:004057E4		       mov     [esi+10h], eax
.text:004057E7		       jz      short loc_4057B0
.text:004057E9		       push    4	       ; flProtect
.text:004057EB		       push    2000h	       ; flAllocationType
.text:004057F0		       push    100000h	       ; dwSize
.text:004057F5		       push    edi	       ; lpAddress
.text:004057F6		       call    ds:__imp__VirtualAlloc@16 ; VirtualAlloc(x,x,x,x)
.text:004057FC		       cmp     eax, edi
.text:004057FE		       mov     [esi+0Ch], eax
.text:00405801		       jnz     short loc_405815
.text:00405803		       push    dword ptr [esi+10h] ; lpMem
.text:00405806		       push    edi	       ; dwFlags
.text:00405807		       push    __crtheap       ; hHeap
.text:0040580D		       call    ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00405813		       jmp     short loc_4057B0
.text:00405815 ; ---------------------------------------------------------------------------
.text:00405815
.text:00405815 loc_405815:			       ; CODE XREF: ___sbh_alloc_new_region+82j
.text:00405815		       or      dword ptr [esi+8], 0FFFFFFFFh
.text:00405819		       mov     [esi], edi
.text:0040581B		       mov     [esi+4],	edi
.text:0040581E		       inc     ___sbh_cntHeaderList
.text:00405824		       mov     eax, [esi+10h]
.text:00405827		       or      dword ptr [eax],	0FFFFFFFFh
.text:0040582A		       mov     eax, esi
.text:0040582C
.text:0040582C loc_40582C:			       ; CODE XREF: ___sbh_alloc_new_region+33j
.text:0040582C		       pop     edi
.text:0040582D		       pop     esi
.text:0040582E		       retn
.text:0040582E ___sbh_alloc_new_region endp
.text:0040582E
.text:0040582F
.text:0040582F ; =============== S U B R O U T I N E =======================================
.text:0040582F
.text:0040582F ; Attributes: bp-based frame
.text:0040582F
.text:0040582F ; int __cdecl __sbh_alloc_new_group(tagHeader *pHeader)
.text:0040582F ___sbh_alloc_new_group proc near	       ; CODE XREF: ___sbh_alloc_block+D6p
.text:0040582F
.text:0040582F pGroup	       = dword ptr -8
.text:0040582F pHeapEndPage    = dword ptr -4
.text:0040582F pHeader	       = dword ptr  8
.text:0040582F
.text:0040582F		       push    ebp
.text:00405830		       mov     ebp, esp
.text:00405832		       push    ecx
.text:00405833		       push    ecx
.text:00405834		       mov     ecx, [ebp+pHeader]
.text:00405837		       mov     eax, [ecx+8]
.text:0040583A		       push    ebx
.text:0040583B		       push    esi
.text:0040583C		       mov     esi, [ecx+10h]
.text:0040583F		       push    edi
.text:00405840		       xor     ebx, ebx
.text:00405842		       jmp     short loc_405847
.text:00405844 ; ---------------------------------------------------------------------------
.text:00405844
.text:00405844 loc_405844:			       ; CODE XREF: ___sbh_alloc_new_group+1Aj
.text:00405844		       add     eax, eax
.text:00405846		       inc     ebx
.text:00405847
.text:00405847 loc_405847:			       ; CODE XREF: ___sbh_alloc_new_group+13j
.text:00405847		       test    eax, eax
.text:00405849		       jge     short loc_405844
.text:0040584B		       mov     eax, ebx
.text:0040584D		       imul    eax, 204h
.text:00405853		       lea     eax, [eax+esi+144h]
.text:0040585A		       push    3Fh
.text:0040585C		       mov     [ebp+pGroup], eax
.text:0040585F		       pop     edx
.text:00405860
.text:00405860 loc_405860:			       ; CODE XREF: ___sbh_alloc_new_group+3Bj
.text:00405860		       mov     [eax+8],	eax
.text:00405863		       mov     [eax+4],	eax
.text:00405866		       add     eax, 8
.text:00405869		       dec     edx
.text:0040586A		       jnz     short loc_405860
.text:0040586C		       push    4	       ; flProtect
.text:0040586E		       mov     edi, ebx
.text:00405870		       push    1000h	       ; flAllocationType
.text:00405875		       shl     edi, 0Fh
.text:00405878		       add     edi, [ecx+0Ch]
.text:0040587B		       push    8000h	       ; dwSize
.text:00405880		       push    edi	       ; lpAddress
.text:00405881		       call    ds:__imp__VirtualAlloc@16 ; VirtualAlloc(x,x,x,x)
.text:00405887		       test    eax, eax
.text:00405889		       jnz     short loc_405893
.text:0040588B		       or      eax, 0FFFFFFFFh
.text:0040588E		       jmp     loc_405930
.text:00405893 ; ---------------------------------------------------------------------------
.text:00405893
.text:00405893 loc_405893:			       ; CODE XREF: ___sbh_alloc_new_group+5Aj
.text:00405893		       lea     edx, [edi+7000h]
.text:00405899		       cmp     edi, edx
.text:0040589B		       mov     [ebp+pHeapEndPage], edx
.text:0040589E		       ja      short loc_4058E3
.text:004058A0		       mov     ecx, edx
.text:004058A2		       sub     ecx, edi
.text:004058A4		       shr     ecx, 0Ch
.text:004058A7		       lea     eax, [edi+10h]
.text:004058AA		       inc     ecx
.text:004058AB
.text:004058AB loc_4058AB:			       ; CODE XREF: ___sbh_alloc_new_group+AFj
.text:004058AB		       or      dword ptr [eax-8], 0FFFFFFFFh
.text:004058AF		       or      dword ptr [eax+0FECh], 0FFFFFFFFh
.text:004058B6		       lea     edx, [eax+0FFCh]
.text:004058BC		       mov     [eax], edx
.text:004058BE		       lea     edx, [eax-1004h]
.text:004058C4		       mov     dword ptr [eax-4], 0FF0h
.text:004058CB		       mov     [eax+4],	edx
.text:004058CE		       mov     dword ptr [eax+0FE8h], 0FF0h
.text:004058D8		       add     eax, 1000h
.text:004058DD		       dec     ecx
.text:004058DE		       jnz     short loc_4058AB
.text:004058E0		       mov     edx, [ebp+pHeapEndPage]
.text:004058E3
.text:004058E3 loc_4058E3:			       ; CODE XREF: ___sbh_alloc_new_group+6Fj
.text:004058E3		       mov     eax, [ebp+pGroup]
.text:004058E6		       add     eax, 1F8h
.text:004058EB		       lea     ecx, [edi+0Ch]
.text:004058EE		       mov     [eax+4],	ecx
.text:004058F1		       mov     [ecx+8],	eax
.text:004058F4		       lea     ecx, [edx+0Ch]
.text:004058F7		       mov     [eax+8],	ecx
.text:004058FA		       mov     [ecx+4],	eax
.text:004058FD		       and     dword ptr [esi+ebx*4+44h], 0
.text:00405902		       xor     edi, edi
.text:00405904		       inc     edi
.text:00405905		       mov     [esi+ebx*4+0C4h], edi
.text:0040590C		       mov     al, [esi+43h]
.text:0040590F		       mov     cl, al
.text:00405911		       inc     cl
.text:00405913		       test    al, al
.text:00405915		       mov     eax, [ebp+pHeader]
.text:00405918		       mov     [esi+43h], cl
.text:0040591B		       jnz     short loc_405920
.text:0040591D		       or      [eax+4],	edi
.text:00405920
.text:00405920 loc_405920:			       ; CODE XREF: ___sbh_alloc_new_group+ECj
.text:00405920		       mov     edx, 80000000h
.text:00405925		       mov     ecx, ebx
.text:00405927		       shr     edx, cl
.text:00405929		       not     edx
.text:0040592B		       and     [eax+8],	edx
.text:0040592E		       mov     eax, ebx
.text:00405930
.text:00405930 loc_405930:			       ; CODE XREF: ___sbh_alloc_new_group+5Fj
.text:00405930		       pop     edi
.text:00405931		       pop     esi
.text:00405932		       pop     ebx
.text:00405933		       leave
.text:00405934		       retn
.text:00405934 ___sbh_alloc_new_group endp
.text:00405934
.text:00405935
.text:00405935 ; =============== S U B R O U T I N E =======================================
.text:00405935
.text:00405935 ; Attributes: bp-based frame
.text:00405935
.text:00405935 ; int __cdecl __sbh_resize_block(tagHeader *pHeader, void *pvAlloc, int intNew)
.text:00405935 ___sbh_resize_block proc	near	       ; CODE XREF: _realloc+77p
.text:00405935
.text:00405935 pGroup	       = dword ptr -0Ch
.text:00405935 indNext	       = dword ptr -8
.text:00405935 sizeNext	       = dword ptr -4
.text:00405935 pHeader	       = dword ptr  8
.text:00405935 pvAlloc	       = dword ptr  0Ch
.text:00405935 pHead	       = dword ptr  10h
.text:00405935
.text:00405935		       push    ebp
.text:00405936		       mov     ebp, esp
.text:00405938		       sub     esp, 0Ch
.text:0040593B		       mov     ecx, [ebp+pHeader]
.text:0040593E		       mov     eax, [ecx+10h]
.text:00405941		       push    ebx
.text:00405942		       push    esi
.text:00405943		       mov     esi, [ebp+pHead]
.text:00405946		       push    edi
.text:00405947		       mov     edi, [ebp+pvAlloc]
.text:0040594A		       mov     edx, edi
.text:0040594C		       sub     edx, [ecx+0Ch]
.text:0040594F		       add     esi, 17h
.text:00405952		       shr     edx, 0Fh
.text:00405955		       mov     ecx, edx
.text:00405957		       imul    ecx, 204h
.text:0040595D		       lea     ecx, [ecx+eax+144h]
.text:00405964		       mov     [ebp+pGroup], ecx
.text:00405967		       mov     ecx, [edi-4]
.text:0040596A		       and     esi, 0FFFFFFF0h
.text:0040596D		       dec     ecx
.text:0040596E		       cmp     esi, ecx
.text:00405970		       lea     edi, [ecx+edi-4]
.text:00405974		       mov     ebx, [edi]
.text:00405976		       mov     [ebp+pHead], ecx
.text:00405979		       mov     [ebp+sizeNext], ebx
.text:0040597C		       jle     loc_405AD7
.text:00405982		       test    bl, 1
.text:00405985		       jnz     loc_405AD0
.text:0040598B		       add     ebx, ecx
.text:0040598D		       cmp     esi, ebx
.text:0040598F		       jg      loc_405AD0
.text:00405995		       mov     ecx, [ebp+sizeNext]
.text:00405998		       sar     ecx, 4
.text:0040599B		       dec     ecx
.text:0040599C		       cmp     ecx, 3Fh
.text:0040599F		       mov     [ebp+indNext], ecx
.text:004059A2		       jbe     short loc_4059AA
.text:004059A4		       push    3Fh
.text:004059A6		       pop     ecx
.text:004059A7		       mov     [ebp+indNext], ecx
.text:004059AA
.text:004059AA loc_4059AA:			       ; CODE XREF: ___sbh_resize_block+6Dj
.text:004059AA		       mov     ebx, [edi+4]
.text:004059AD		       cmp     ebx, [edi+8]
.text:004059B0		       jnz     short loc_4059F5
.text:004059B2		       cmp     ecx, 20h
.text:004059B5		       mov     ebx, 80000000h
.text:004059BA		       jnb     short loc_4059D6
.text:004059BC		       shr     ebx, cl
.text:004059BE		       mov     ecx, [ebp+indNext]
.text:004059C1		       lea     ecx, [ecx+eax+4]
.text:004059C5		       not     ebx
.text:004059C7		       and     [eax+edx*4+44h],	ebx
.text:004059CB		       dec     byte ptr	[ecx]
.text:004059CD		       jnz     short loc_4059F5
.text:004059CF		       mov     ecx, [ebp+pHeader]
.text:004059D2		       and     [ecx], ebx
.text:004059D4		       jmp     short loc_4059F5
.text:004059D6 ; ---------------------------------------------------------------------------
.text:004059D6
.text:004059D6 loc_4059D6:			       ; CODE XREF: ___sbh_resize_block+85j
.text:004059D6		       add     ecx, 0FFFFFFE0h
.text:004059D9		       shr     ebx, cl
.text:004059DB		       mov     ecx, [ebp+indNext]
.text:004059DE		       lea     ecx, [ecx+eax+4]
.text:004059E2		       not     ebx
.text:004059E4		       and     [eax+edx*4+0C4h], ebx
.text:004059EB		       dec     byte ptr	[ecx]
.text:004059ED		       jnz     short loc_4059F5
.text:004059EF		       mov     ecx, [ebp+pHeader]
.text:004059F2		       and     [ecx+4],	ebx
.text:004059F5
.text:004059F5 loc_4059F5:			       ; CODE XREF: ___sbh_resize_block+7Bj
.text:004059F5					       ; ___sbh_resize_block+98j ...
.text:004059F5		       mov     ecx, [edi+8]
.text:004059F8		       mov     ebx, [edi+4]
.text:004059FB		       mov     [ecx+4],	ebx
.text:004059FE		       mov     ecx, [edi+4]
.text:00405A01		       mov     edi, [edi+8]
.text:00405A04		       mov     [ecx+8],	edi
.text:00405A07		       mov     ecx, [ebp+pHead]
.text:00405A0A		       sub     ecx, esi
.text:00405A0C		       add     [ebp+sizeNext], ecx
.text:00405A0F		       cmp     [ebp+sizeNext], 0
.text:00405A13		       jle     loc_405ABE
.text:00405A19		       mov     edi, [ebp+sizeNext]
.text:00405A1C		       mov     ecx, [ebp+pvAlloc]
.text:00405A1F		       sar     edi, 4
.text:00405A22		       dec     edi
.text:00405A23		       cmp     edi, 3Fh
.text:00405A26		       lea     ecx, [ecx+esi-4]
.text:00405A2A		       jbe     short loc_405A2F
.text:00405A2C		       push    3Fh
.text:00405A2E		       pop     edi
.text:00405A2F
.text:00405A2F loc_405A2F:			       ; CODE XREF: ___sbh_resize_block+F5j
.text:00405A2F		       mov     ebx, [ebp+pGroup]
.text:00405A32		       lea     ebx, [ebx+edi*8]
.text:00405A35		       mov     [ebp+pHead], ebx
.text:00405A38		       mov     ebx, [ebx+4]
.text:00405A3B		       mov     [ecx+4],	ebx
.text:00405A3E		       mov     ebx, [ebp+pHead]
.text:00405A41		       mov     [ecx+8],	ebx
.text:00405A44		       mov     [ebx+4],	ecx
.text:00405A47		       mov     ebx, [ecx+4]
.text:00405A4A		       mov     [ebx+8],	ecx
.text:00405A4D		       mov     ebx, [ecx+4]
.text:00405A50		       cmp     ebx, [ecx+8]
.text:00405A53		       jnz     short loc_405AAC
.text:00405A55		       mov     cl, [edi+eax+4]
.text:00405A59		       mov     byte ptr	[ebp+pHead+3], cl
.text:00405A5C		       inc     cl
.text:00405A5E		       cmp     edi, 20h
.text:00405A61		       mov     [edi+eax+4], cl
.text:00405A65		       jnb     short loc_405A83
.text:00405A67		       cmp     byte ptr	[ebp+pHead+3], 0
.text:00405A6B		       jnz     short loc_405A7B
.text:00405A6D		       mov     ecx, edi
.text:00405A6F		       mov     ebx, 80000000h
.text:00405A74		       shr     ebx, cl
.text:00405A76		       mov     ecx, [ebp+pHeader]
.text:00405A79		       or      [ecx], ebx
.text:00405A7B
.text:00405A7B loc_405A7B:			       ; CODE XREF: ___sbh_resize_block+136j
.text:00405A7B		       lea     eax, [eax+edx*4+44h]
.text:00405A7F		       mov     ecx, edi
.text:00405A81		       jmp     short loc_405AA3
.text:00405A83 ; ---------------------------------------------------------------------------
.text:00405A83
.text:00405A83 loc_405A83:			       ; CODE XREF: ___sbh_resize_block+130j
.text:00405A83		       cmp     byte ptr	[ebp+pHead+3], 0
.text:00405A87		       jnz     short loc_405A99
.text:00405A89		       lea     ecx, [edi-20h]
.text:00405A8C		       mov     ebx, 80000000h
.text:00405A91		       shr     ebx, cl
.text:00405A93		       mov     ecx, [ebp+pHeader]
.text:00405A96		       or      [ecx+4],	ebx
.text:00405A99
.text:00405A99 loc_405A99:			       ; CODE XREF: ___sbh_resize_block+152j
.text:00405A99		       lea     eax, [eax+edx*4+0C4h]
.text:00405AA0		       lea     ecx, [edi-20h]
.text:00405AA3
.text:00405AA3 loc_405AA3:			       ; CODE XREF: ___sbh_resize_block+14Cj
.text:00405AA3		       mov     edx, 80000000h
.text:00405AA8		       shr     edx, cl
.text:00405AAA		       or      [eax], edx
.text:00405AAC
.text:00405AAC loc_405AAC:			       ; CODE XREF: ___sbh_resize_block+11Ej
.text:00405AAC		       mov     edx, [ebp+pvAlloc]
.text:00405AAF		       mov     ecx, [ebp+sizeNext]
.text:00405AB2		       lea     eax, [edx+esi-4]
.text:00405AB6		       mov     [eax], ecx
.text:00405AB8		       mov     [ecx+eax-4], ecx
.text:00405ABC		       jmp     short loc_405AC1
.text:00405ABE ; ---------------------------------------------------------------------------
.text:00405ABE
.text:00405ABE loc_405ABE:			       ; CODE XREF: ___sbh_resize_block+DEj
.text:00405ABE		       mov     edx, [ebp+pvAlloc]
.text:00405AC1
.text:00405AC1 loc_405AC1:			       ; CODE XREF: ___sbh_resize_block+187j
.text:00405AC1		       lea     eax, [esi+1]
.text:00405AC4		       mov     [edx-4],	eax
.text:00405AC7		       mov     [edx+esi-8], eax
.text:00405ACB		       jmp     loc_405C0C
.text:00405AD0 ; ---------------------------------------------------------------------------
.text:00405AD0
.text:00405AD0 loc_405AD0:			       ; CODE XREF: ___sbh_resize_block+50j
.text:00405AD0					       ; ___sbh_resize_block+5Aj
.text:00405AD0		       xor     eax, eax
.text:00405AD2		       jmp     loc_405C0F
.text:00405AD7 ; ---------------------------------------------------------------------------
.text:00405AD7
.text:00405AD7 loc_405AD7:			       ; CODE XREF: ___sbh_resize_block+47j
.text:00405AD7		       jge     loc_405C0C
.text:00405ADD		       mov     ebx, [ebp+pvAlloc]
.text:00405AE0		       sub     [ebp+pHead], esi
.text:00405AE3		       lea     ecx, [esi+1]
.text:00405AE6		       mov     [ebx-4],	ecx
.text:00405AE9		       lea     ebx, [ebx+esi-4]
.text:00405AED		       mov     esi, [ebp+pHead]
.text:00405AF0		       sar     esi, 4
.text:00405AF3		       dec     esi
.text:00405AF4		       cmp     esi, 3Fh
.text:00405AF7		       mov     [ebp+pvAlloc], ebx
.text:00405AFA		       mov     [ebx-4],	ecx
.text:00405AFD		       jbe     short loc_405B02
.text:00405AFF		       push    3Fh
.text:00405B01		       pop     esi
.text:00405B02
.text:00405B02 loc_405B02:			       ; CODE XREF: ___sbh_resize_block+1C8j
.text:00405B02		       test    byte ptr	[ebp+sizeNext],	1
.text:00405B06		       jnz     loc_405B8C
.text:00405B0C		       mov     esi, [ebp+sizeNext]
.text:00405B0F		       sar     esi, 4
.text:00405B12		       dec     esi
.text:00405B13		       cmp     esi, 3Fh
.text:00405B16		       jbe     short loc_405B1B
.text:00405B18		       push    3Fh
.text:00405B1A		       pop     esi
.text:00405B1B
.text:00405B1B loc_405B1B:			       ; CODE XREF: ___sbh_resize_block+1E1j
.text:00405B1B		       mov     ecx, [edi+4]
.text:00405B1E		       cmp     ecx, [edi+8]
.text:00405B21		       jnz     short loc_405B65
.text:00405B23		       cmp     esi, 20h
.text:00405B26		       mov     ebx, 80000000h
.text:00405B2B		       jnb     short loc_405B46
.text:00405B2D		       mov     ecx, esi
.text:00405B2F		       shr     ebx, cl
.text:00405B31		       lea     esi, [esi+eax+4]
.text:00405B35		       not     ebx
.text:00405B37		       and     [eax+edx*4+44h],	ebx
.text:00405B3B		       dec     byte ptr	[esi]
.text:00405B3D		       jnz     short loc_405B62
.text:00405B3F		       mov     ecx, [ebp+pHeader]
.text:00405B42		       and     [ecx], ebx
.text:00405B44		       jmp     short loc_405B62
.text:00405B46 ; ---------------------------------------------------------------------------
.text:00405B46
.text:00405B46 loc_405B46:			       ; CODE XREF: ___sbh_resize_block+1F6j
.text:00405B46		       lea     ecx, [esi-20h]
.text:00405B49		       shr     ebx, cl
.text:00405B4B		       lea     ecx, [esi+eax+4]
.text:00405B4F		       not     ebx
.text:00405B51		       and     [eax+edx*4+0C4h], ebx
.text:00405B58		       dec     byte ptr	[ecx]
.text:00405B5A		       jnz     short loc_405B62
.text:00405B5C		       mov     ecx, [ebp+pHeader]
.text:00405B5F		       and     [ecx+4],	ebx
.text:00405B62
.text:00405B62 loc_405B62:			       ; CODE XREF: ___sbh_resize_block+208j
.text:00405B62					       ; ___sbh_resize_block+20Fj ...
.text:00405B62		       mov     ebx, [ebp+pvAlloc]
.text:00405B65
.text:00405B65 loc_405B65:			       ; CODE XREF: ___sbh_resize_block+1ECj
.text:00405B65		       mov     ecx, [edi+8]
.text:00405B68		       mov     esi, [edi+4]
.text:00405B6B		       mov     [ecx+4],	esi
.text:00405B6E		       mov     esi, [edi+8]
.text:00405B71		       mov     ecx, [edi+4]
.text:00405B74		       mov     [ecx+8],	esi
.text:00405B77		       mov     esi, [ebp+pHead]
.text:00405B7A		       add     esi, [ebp+sizeNext]
.text:00405B7D		       mov     [ebp+pHead], esi
.text:00405B80		       sar     esi, 4
.text:00405B83		       dec     esi
.text:00405B84		       cmp     esi, 3Fh
.text:00405B87		       jbe     short loc_405B8C
.text:00405B89		       push    3Fh
.text:00405B8B		       pop     esi
.text:00405B8C
.text:00405B8C loc_405B8C:			       ; CODE XREF: ___sbh_resize_block+1D1j
.text:00405B8C					       ; ___sbh_resize_block+252j
.text:00405B8C		       mov     ecx, [ebp+pGroup]
.text:00405B8F		       lea     ecx, [ecx+esi*8]
.text:00405B92		       mov     edi, [ecx+4]
.text:00405B95		       mov     [ebx+8],	ecx
.text:00405B98		       mov     [ebx+4],	edi
.text:00405B9B		       mov     [ecx+4],	ebx
.text:00405B9E		       mov     ecx, [ebx+4]
.text:00405BA1		       mov     [ecx+8],	ebx
.text:00405BA4		       mov     ecx, [ebx+4]
.text:00405BA7		       cmp     ecx, [ebx+8]
.text:00405BAA		       jnz     short loc_405C03
.text:00405BAC		       mov     cl, [esi+eax+4]
.text:00405BB0		       mov     byte ptr	[ebp+pvAlloc+3], cl
.text:00405BB3		       inc     cl
.text:00405BB5		       cmp     esi, 20h
.text:00405BB8		       mov     [esi+eax+4], cl
.text:00405BBC		       jnb     short loc_405BDA
.text:00405BBE		       cmp     byte ptr	[ebp+pvAlloc+3], 0
.text:00405BC2		       jnz     short loc_405BD2
.text:00405BC4		       mov     ecx, esi
.text:00405BC6		       mov     edi, 80000000h
.text:00405BCB		       shr     edi, cl
.text:00405BCD		       mov     ecx, [ebp+pHeader]
.text:00405BD0		       or      [ecx], edi
.text:00405BD2
.text:00405BD2 loc_405BD2:			       ; CODE XREF: ___sbh_resize_block+28Dj
.text:00405BD2		       lea     eax, [eax+edx*4+44h]
.text:00405BD6		       mov     ecx, esi
.text:00405BD8		       jmp     short loc_405BFA
.text:00405BDA ; ---------------------------------------------------------------------------
.text:00405BDA
.text:00405BDA loc_405BDA:			       ; CODE XREF: ___sbh_resize_block+287j
.text:00405BDA		       cmp     byte ptr	[ebp+pvAlloc+3], 0
.text:00405BDE		       jnz     short loc_405BF0
.text:00405BE0		       lea     ecx, [esi-20h]
.text:00405BE3		       mov     edi, 80000000h
.text:00405BE8		       shr     edi, cl
.text:00405BEA		       mov     ecx, [ebp+pHeader]
.text:00405BED		       or      [ecx+4],	edi
.text:00405BF0
.text:00405BF0 loc_405BF0:			       ; CODE XREF: ___sbh_resize_block+2A9j
.text:00405BF0		       lea     eax, [eax+edx*4+0C4h]
.text:00405BF7		       lea     ecx, [esi-20h]
.text:00405BFA
.text:00405BFA loc_405BFA:			       ; CODE XREF: ___sbh_resize_block+2A3j
.text:00405BFA		       mov     edx, 80000000h
.text:00405BFF		       shr     edx, cl
.text:00405C01		       or      [eax], edx
.text:00405C03
.text:00405C03 loc_405C03:			       ; CODE XREF: ___sbh_resize_block+275j
.text:00405C03		       mov     eax, [ebp+pHead]
.text:00405C06		       mov     [ebx], eax
.text:00405C08		       mov     [eax+ebx-4], eax
.text:00405C0C
.text:00405C0C loc_405C0C:			       ; CODE XREF: ___sbh_resize_block+196j
.text:00405C0C					       ; ___sbh_resize_block:loc_405AD7j
.text:00405C0C		       xor     eax, eax
.text:00405C0E		       inc     eax
.text:00405C0F
.text:00405C0F loc_405C0F:			       ; CODE XREF: ___sbh_resize_block+19Dj
.text:00405C0F		       pop     edi
.text:00405C10		       pop     esi
.text:00405C11		       pop     ebx
.text:00405C12		       leave
.text:00405C13		       retn
.text:00405C13 ___sbh_resize_block endp
.text:00405C13
.text:00405C14
.text:00405C14 ; =============== S U B R O U T I N E =======================================
.text:00405C14
.text:00405C14
.text:00405C14 ___sbh_heapmin  proc near
.text:00405C14		       mov     eax, ___sbh_pHeaderDefer
.text:00405C19		       test    eax, eax
.text:00405C1B		       jz      locret_405CE0
.text:00405C21		       mov     ecx, ___sbh_indGroupDefer
.text:00405C27		       push    4000h	       ; dwFreeType
.text:00405C2C		       shl     ecx, 0Fh
.text:00405C2F		       add     ecx, [eax+0Ch]
.text:00405C32		       push    8000h	       ; dwSize
.text:00405C37		       push    ecx	       ; lpAddress
.text:00405C38		       call    ds:__imp__VirtualFree@12	; VirtualFree(x,x,x)
.text:00405C3E		       mov     ecx, ___sbh_indGroupDefer
.text:00405C44		       mov     eax, ___sbh_pHeaderDefer
.text:00405C49		       mov     edx, 80000000h
.text:00405C4E		       shr     edx, cl
.text:00405C50		       or      [eax+8],	edx
.text:00405C53		       mov     eax, ___sbh_pHeaderDefer
.text:00405C58		       mov     eax, [eax+10h]
.text:00405C5B		       mov     ecx, ___sbh_indGroupDefer
.text:00405C61		       and     dword ptr [eax+ecx*4+0C4h], 0
.text:00405C69		       mov     eax, ___sbh_pHeaderDefer
.text:00405C6E		       mov     eax, [eax+10h]
.text:00405C71		       dec     byte ptr	[eax+43h]
.text:00405C74		       mov     eax, ___sbh_pHeaderDefer
.text:00405C79		       mov     ecx, [eax+10h]
.text:00405C7C		       cmp     byte ptr	[ecx+43h], 0
.text:00405C80		       jnz     short loc_405C8B
.text:00405C82		       and     dword ptr [eax+4], 0FFFFFFFEh
.text:00405C86		       mov     eax, ___sbh_pHeaderDefer
.text:00405C8B
.text:00405C8B loc_405C8B:			       ; CODE XREF: ___sbh_heapmin+6Cj
.text:00405C8B		       cmp     dword ptr [eax+8], 0FFFFFFFFh
.text:00405C8F		       jnz     short loc_405CD9
.text:00405C91		       cmp     ___sbh_cntHeaderList, 1
.text:00405C98		       jle     short loc_405CD9
.text:00405C9A		       push    dword ptr [eax+10h] ; lpMem
.text:00405C9D		       push    0	       ; dwFlags
.text:00405C9F		       push    __crtheap       ; hHeap
.text:00405CA5		       call    ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00405CAB		       mov     ecx, ___sbh_cntHeaderList
.text:00405CB1		       mov     eax, ___sbh_pHeaderDefer
.text:00405CB6		       imul    ecx, 14h
.text:00405CB9		       mov     edx, ___sbh_pHeaderList
.text:00405CBF		       sub     ecx, eax
.text:00405CC1		       lea     ecx, [ecx+edx-14h]
.text:00405CC5		       push    ecx	       ; count
.text:00405CC6		       lea     ecx, [eax+14h]
.text:00405CC9		       push    ecx	       ; src
.text:00405CCA		       push    eax	       ; dst
.text:00405CCB		       call    _memmove
.text:00405CD0		       add     esp, 0Ch
.text:00405CD3		       dec     ___sbh_cntHeaderList
.text:00405CD9
.text:00405CD9 loc_405CD9:			       ; CODE XREF: ___sbh_heapmin+7Bj
.text:00405CD9					       ; ___sbh_heapmin+84j
.text:00405CD9		       and     ___sbh_pHeaderDefer, 0
.text:00405CE0
.text:00405CE0 locret_405CE0:			       ; CODE XREF: ___sbh_heapmin+7j
.text:00405CE0		       retn
.text:00405CE0 ___sbh_heapmin  endp
.text:00405CE0
.text:00405CE1
.text:00405CE1 ; =============== S U B R O U T I N E =======================================
.text:00405CE1
.text:00405CE1 ; Attributes: bp-based frame
.text:00405CE1
.text:00405CE1 ; int __cdecl __sbh_heap_check()
.text:00405CE1 ___sbh_heap_check proc near
.text:00405CE1
.text:00405CE1 cntFree	       = dword ptr -138h
.text:00405CE1 var_38	       = dword ptr -38h
.text:00405CE1 pHeader	       = dword ptr -34h
.text:00405CE1 var_30	       = dword ptr -30h
.text:00405CE1 pEntry	       = dword ptr -2Ch
.text:00405CE1 bitvGroupHi     = dword ptr -28h
.text:00405CE1 pGroup	       = dword ptr -24h
.text:00405CE1 bitvCommit      = dword ptr -20h
.text:00405CE1 indHeader       = dword ptr -1Ch
.text:00405CE1 bitvGroupLo     = dword ptr -18h
.text:00405CE1 bitvEntryLo     = dword ptr -14h
.text:00405CE1 bitvEntryHi     = dword ptr -10h
.text:00405CE1 indGroup	       = dword ptr -0Ch
.text:00405CE1 pHeapGroup      = dword ptr -8
.text:00405CE1 cntAllocated    = dword ptr -4
.text:00405CE1
.text:00405CE1		       push    ebp
.text:00405CE2		       mov     ebp, esp
.text:00405CE4		       mov     eax, ___sbh_pHeaderList
.text:00405CE9		       sub     esp, 138h
.text:00405CEF		       push    ebx
.text:00405CF0		       xor     ebx, ebx
.text:00405CF2		       cmp     eax, ebx
.text:00405CF4		       jnz     short loc_405CFE
.text:00405CF6		       or      eax, 0FFFFFFFFh
.text:00405CF9		       jmp     loc_405F83
.text:00405CFE ; ---------------------------------------------------------------------------
.text:00405CFE
.text:00405CFE loc_405CFE:			       ; CODE XREF: ___sbh_heap_check+13j
.text:00405CFE		       cmp     ___sbh_cntHeaderList, ebx
.text:00405D04		       push    esi
.text:00405D05		       mov     edx, eax
.text:00405D07		       push    edi
.text:00405D08		       mov     [ebp+pHeader], edx
.text:00405D0B		       mov     [ebp+indHeader],	ebx
.text:00405D0E		       jle     loc_405F7F
.text:00405D14
.text:00405D14 loc_405D14:			       ; CODE XREF: ___sbh_heap_check+298j
.text:00405D14		       mov     eax, [edx+10h]
.text:00405D17		       cmp     eax, ebx
.text:00405D19		       jz      loc_405F86
.text:00405D1F		       mov     ecx, [edx+0Ch]
.text:00405D22		       mov     [ebp+pHeapGroup], ecx
.text:00405D25		       lea     ecx, [eax+144h]
.text:00405D2B		       mov     [ebp+pGroup], ecx
.text:00405D2E		       mov     ecx, [edx+8]
.text:00405D31		       lea     esi, [eax+0C4h]
.text:00405D37		       mov     [ebp+bitvCommit], ecx
.text:00405D3A		       mov     [ebp+bitvEntryHi], ebx
.text:00405D3D		       mov     [ebp+bitvEntryLo], ebx
.text:00405D40		       mov     [ebp+indGroup], ebx
.text:00405D43		       mov     [ebp+var_38], esi
.text:00405D46
.text:00405D46 loc_405D46:			       ; CODE XREF: ___sbh_heap_check+271j
.text:00405D46		       push    40h
.text:00405D48		       xor     eax, eax
.text:00405D4A		       cmp     [ebp+bitvCommit], ebx
.text:00405D4D		       pop     ecx
.text:00405D4E		       lea     edi, [ebp+cntFree]
.text:00405D54		       mov     [ebp+bitvGroupHi], ebx
.text:00405D57		       mov     [ebp+bitvGroupLo], ebx
.text:00405D5A		       mov     [ebp+cntAllocated], ebx
.text:00405D5D		       rep stosd
.text:00405D5F		       jl      loc_405F1D
.text:00405D65		       cmp     [ebp+pHeapGroup], ebx
.text:00405D68		       jz      loc_405F8A
.text:00405D6E		       mov     edx, [ebp+pHeapGroup]
.text:00405D71		       add     edx, 0FFCh
.text:00405D77
.text:00405D77 loc_405D77:			       ; CODE XREF: ___sbh_heap_check+124j
.text:00405D77		       cmp     dword ptr [edx-0FF4h], 0FFFFFFFFh
.text:00405D7E		       lea     esi, [edx-0FF0h]
.text:00405D84		       jnz     loc_405F9A
.text:00405D8A		       cmp     dword ptr [edx],	0FFFFFFFFh
.text:00405D8D		       jnz     loc_405F9A
.text:00405D93
.text:00405D93 loc_405D93:			       ; CODE XREF: ___sbh_heap_check+112j
.text:00405D93		       mov     ecx, [esi]
.text:00405D95		       test    cl, 1
.text:00405D98		       mov     edi, ecx
.text:00405D9A		       jz      short loc_405DAE
.text:00405D9C		       dec     ecx
.text:00405D9D		       cmp     ecx, 400h
.text:00405DA3		       jg      loc_405F8E
.text:00405DA9		       inc     [ebp+cntAllocated]
.text:00405DAC		       jmp     short loc_405DC5
.text:00405DAE ; ---------------------------------------------------------------------------
.text:00405DAE
.text:00405DAE loc_405DAE:			       ; CODE XREF: ___sbh_heap_check+B9j
.text:00405DAE		       mov     eax, ecx
.text:00405DB0		       sar     eax, 4
.text:00405DB3		       dec     eax
.text:00405DB4		       cmp     eax, 3Fh
.text:00405DB7		       jle     short loc_405DBC
.text:00405DB9		       push    3Fh
.text:00405DBB		       pop     eax
.text:00405DBC
.text:00405DBC loc_405DBC:			       ; CODE XREF: ___sbh_heap_check+D6j
.text:00405DBC		       lea     eax, [ebp+eax*4+cntFree]
.text:00405DC3		       inc     dword ptr [eax]
.text:00405DC5
.text:00405DC5 loc_405DC5:			       ; CODE XREF: ___sbh_heap_check+CBj
.text:00405DC5		       cmp     ecx, 10h
.text:00405DC8		       jl      loc_405F96
.text:00405DCE		       test    cl, 0Fh
.text:00405DD1		       jnz     loc_405F96
.text:00405DD7		       cmp     ecx, 0FF0h
.text:00405DDD		       jg      loc_405F96
.text:00405DE3		       lea     eax, [ecx+esi]
.text:00405DE6		       cmp     [eax-4],	edi
.text:00405DE9		       jnz     loc_405F92
.text:00405DEF		       mov     esi, eax
.text:00405DF1		       cmp     esi, edx
.text:00405DF3		       jb      short loc_405D93
.text:00405DF5		       jnz     loc_405F92
.text:00405DFB		       add     edx, 1000h
.text:00405E01		       inc     ebx
.text:00405E02		       cmp     ebx, 8
.text:00405E05		       jl      loc_405D77
.text:00405E0B		       mov     eax, [ebp+cntAllocated]
.text:00405E0E		       mov     edi, [ebp+pGroup]
.text:00405E11		       cmp     [edi], eax
.text:00405E13		       jnz     loc_405F9E
.text:00405E19		       xor     esi, esi
.text:00405E1B
.text:00405E1B loc_405E1B:			       ; CODE XREF: ___sbh_heap_check+22Ej
.text:00405E1B		       and     [ebp+cntAllocated], 0
.text:00405E1F		       lea     ebx, [edi+8]
.text:00405E22		       mov     eax, [ebx-4]
.text:00405E25		       cmp     eax, edi
.text:00405E27		       mov     [ebp+pEntry], edi
.text:00405E2A		       mov     [ebp+var_30], ebx
.text:00405E2D		       jz      loc_405EE5
.text:00405E33
.text:00405E33 loc_405E33:			       ; CODE XREF: ___sbh_heap_check+1D7j
.text:00405E33		       mov     ecx, [ebp+cntAllocated]
.text:00405E36		       cmp     ecx, [ebp+esi*4+cntFree]
.text:00405E3D		       jz      short loc_405EBE
.text:00405E3F		       mov     ecx, [ebp+pHeapGroup]
.text:00405E42		       cmp     eax, ecx
.text:00405E44		       jb      loc_405FAE
.text:00405E4A		       add     ecx, 8000h
.text:00405E50		       cmp     eax, ecx
.text:00405E52		       jnb     loc_405FAE
.text:00405E58		       mov     ecx, eax
.text:00405E5A		       and     ecx, 0FFFFF000h
.text:00405E60		       add     ecx, 0Ch
.text:00405E63		       lea     edx, [ecx+0FF0h]
.text:00405E69		       cmp     ecx, edx
.text:00405E6B		       jz      loc_405FA2
.text:00405E71
.text:00405E71 loc_405E71:			       ; CODE XREF: ___sbh_heap_check+1A0j
.text:00405E71		       cmp     ecx, eax
.text:00405E73		       jz      short loc_405E83
.text:00405E75		       mov     ebx, [ecx]
.text:00405E77		       and     ebx, 0FFFFFFFEh
.text:00405E7A		       add     ecx, ebx
.text:00405E7C		       cmp     ecx, edx
.text:00405E7E		       mov     ebx, [ebp+var_30]
.text:00405E81		       jnz     short loc_405E71
.text:00405E83
.text:00405E83 loc_405E83:			       ; CODE XREF: ___sbh_heap_check+192j
.text:00405E83		       cmp     ecx, edx
.text:00405E85		       jz      loc_405FA2
.text:00405E8B		       mov     ecx, [eax]
.text:00405E8D		       sar     ecx, 4
.text:00405E90		       dec     ecx
.text:00405E91		       cmp     ecx, 3Fh
.text:00405E94		       jle     short loc_405E99
.text:00405E96		       push    3Fh
.text:00405E98		       pop     ecx
.text:00405E99
.text:00405E99 loc_405E99:			       ; CODE XREF: ___sbh_heap_check+1B3j
.text:00405E99		       cmp     ecx, esi
.text:00405E9B		       jnz     loc_405FA6
.text:00405EA1		       mov     ecx, [ebp+pEntry]
.text:00405EA4		       cmp     [eax+8],	ecx
.text:00405EA7		       jnz     loc_405FAA
.text:00405EAD		       inc     [ebp+cntAllocated]
.text:00405EB0		       mov     [ebp+pEntry], eax
.text:00405EB3		       mov     eax, [eax+4]
.text:00405EB6		       cmp     eax, edi
.text:00405EB8		       jnz     loc_405E33
.text:00405EBE
.text:00405EBE loc_405EBE:			       ; CODE XREF: ___sbh_heap_check+15Cj
.text:00405EBE		       cmp     [ebp+cntAllocated], 0
.text:00405EC2		       jz      short loc_405EE5
.text:00405EC4		       cmp     esi, 20h
.text:00405EC7		       mov     eax, 80000000h
.text:00405ECC		       jge     short loc_405EDA
.text:00405ECE		       mov     ecx, esi
.text:00405ED0		       shr     eax, cl
.text:00405ED2		       or      [ebp+bitvGroupHi], eax
.text:00405ED5		       or      [ebp+bitvEntryHi], eax
.text:00405ED8		       jmp     short loc_405EE5
.text:00405EDA ; ---------------------------------------------------------------------------
.text:00405EDA
.text:00405EDA loc_405EDA:			       ; CODE XREF: ___sbh_heap_check+1EBj
.text:00405EDA		       lea     ecx, [esi-20h]
.text:00405EDD		       shr     eax, cl
.text:00405EDF		       or      [ebp+bitvGroupLo], eax
.text:00405EE2		       or      [ebp+bitvEntryLo], eax
.text:00405EE5
.text:00405EE5 loc_405EE5:			       ; CODE XREF: ___sbh_heap_check+14Cj
.text:00405EE5					       ; ___sbh_heap_check+1E1j ...
.text:00405EE5		       mov     eax, [ebp+pEntry]
.text:00405EE8		       cmp     [eax+4],	edi
.text:00405EEB		       jnz     loc_405FB6
.text:00405EF1		       mov     ecx, [ebp+cntAllocated]
.text:00405EF4		       cmp     ecx, [ebp+esi*4+cntFree]
.text:00405EFB		       jnz     loc_405FB6
.text:00405F01		       cmp     [ebx], eax
.text:00405F03		       jnz     loc_405FB2
.text:00405F09		       inc     esi
.text:00405F0A		       cmp     esi, 40h
.text:00405F0D		       mov     edi, ebx
.text:00405F0F		       jl      loc_405E1B
.text:00405F15		       mov     esi, [ebp+var_38]
.text:00405F18		       mov     edx, [ebp+pHeader]
.text:00405F1B		       xor     ebx, ebx
.text:00405F1D
.text:00405F1D loc_405F1D:			       ; CODE XREF: ___sbh_heap_check+7Ej
.text:00405F1D		       mov     eax, [ebp+bitvGroupHi]
.text:00405F20		       cmp     eax, [esi-80h]
.text:00405F23		       jnz     loc_405FBA
.text:00405F29		       mov     eax, [ebp+bitvGroupLo]
.text:00405F2C		       cmp     eax, [esi]
.text:00405F2E		       jnz     loc_405FBA
.text:00405F34		       add     [ebp+pHeapGroup], 8000h
.text:00405F3B		       add     [ebp+pGroup], 204h
.text:00405F42		       shl     [ebp+bitvCommit], 1
.text:00405F45		       inc     [ebp+indGroup]
.text:00405F48		       add     esi, 4
.text:00405F4B		       cmp     [ebp+indGroup], 20h
.text:00405F4F		       mov     [ebp+var_38], esi
.text:00405F52		       jl      loc_405D46
.text:00405F58		       mov     eax, [ebp+bitvEntryHi]
.text:00405F5B		       cmp     eax, [edx]
.text:00405F5D		       jnz     short loc_405FBE
.text:00405F5F		       mov     eax, [ebp+bitvEntryLo]
.text:00405F62		       cmp     eax, [edx+4]
.text:00405F65		       jnz     short loc_405FBE
.text:00405F67		       add     edx, 14h
.text:00405F6A		       inc     [ebp+indHeader]
.text:00405F6D		       mov     eax, [ebp+indHeader]
.text:00405F70		       cmp     eax, ___sbh_cntHeaderList
.text:00405F76		       mov     [ebp+pHeader], edx
.text:00405F79		       jl      loc_405D14
.text:00405F7F
.text:00405F7F loc_405F7F:			       ; CODE XREF: ___sbh_heap_check+2Dj
.text:00405F7F		       xor     eax, eax
.text:00405F81
.text:00405F81 loc_405F81:			       ; CODE XREF: ___sbh_heap_check+2E0j
.text:00405F81		       pop     edi
.text:00405F82		       pop     esi
.text:00405F83
.text:00405F83 loc_405F83:			       ; CODE XREF: ___sbh_heap_check+18j
.text:00405F83		       pop     ebx
.text:00405F84		       leave
.text:00405F85		       retn
.text:00405F86 ; ---------------------------------------------------------------------------
.text:00405F86
.text:00405F86 loc_405F86:			       ; CODE XREF: ___sbh_heap_check+38j
.text:00405F86		       push    0FFFFFFFEh
.text:00405F88		       jmp     short loc_405FC0
.text:00405F8A ; ---------------------------------------------------------------------------
.text:00405F8A
.text:00405F8A loc_405F8A:			       ; CODE XREF: ___sbh_heap_check+87j
.text:00405F8A		       push    0FFFFFFFCh
.text:00405F8C		       jmp     short loc_405FC0
.text:00405F8E ; ---------------------------------------------------------------------------
.text:00405F8E
.text:00405F8E loc_405F8E:			       ; CODE XREF: ___sbh_heap_check+C2j
.text:00405F8E		       push    0FFFFFFFAh
.text:00405F90		       jmp     short loc_405FC0
.text:00405F92 ; ---------------------------------------------------------------------------
.text:00405F92
.text:00405F92 loc_405F92:			       ; CODE XREF: ___sbh_heap_check+108j
.text:00405F92					       ; ___sbh_heap_check+114j
.text:00405F92		       push    0FFFFFFF8h
.text:00405F94		       jmp     short loc_405FC0
.text:00405F96 ; ---------------------------------------------------------------------------
.text:00405F96
.text:00405F96 loc_405F96:			       ; CODE XREF: ___sbh_heap_check+E7j
.text:00405F96					       ; ___sbh_heap_check+F0j	...
.text:00405F96		       push    0FFFFFFF9h
.text:00405F98		       jmp     short loc_405FC0
.text:00405F9A ; ---------------------------------------------------------------------------
.text:00405F9A
.text:00405F9A loc_405F9A:			       ; CODE XREF: ___sbh_heap_check+A3j
.text:00405F9A					       ; ___sbh_heap_check+ACj
.text:00405F9A		       push    0FFFFFFFBh
.text:00405F9C		       jmp     short loc_405FC0
.text:00405F9E ; ---------------------------------------------------------------------------
.text:00405F9E
.text:00405F9E loc_405F9E:			       ; CODE XREF: ___sbh_heap_check+132j
.text:00405F9E		       push    0FFFFFFF7h
.text:00405FA0		       jmp     short loc_405FC0
.text:00405FA2 ; ---------------------------------------------------------------------------
.text:00405FA2
.text:00405FA2 loc_405FA2:			       ; CODE XREF: ___sbh_heap_check+18Aj
.text:00405FA2					       ; ___sbh_heap_check+1A4j
.text:00405FA2		       push    0FFFFFFF5h
.text:00405FA4		       jmp     short loc_405FC0
.text:00405FA6 ; ---------------------------------------------------------------------------
.text:00405FA6
.text:00405FA6 loc_405FA6:			       ; CODE XREF: ___sbh_heap_check+1BAj
.text:00405FA6		       push    0FFFFFFF4h
.text:00405FA8		       jmp     short loc_405FC0
.text:00405FAA ; ---------------------------------------------------------------------------
.text:00405FAA
.text:00405FAA loc_405FAA:			       ; CODE XREF: ___sbh_heap_check+1C6j
.text:00405FAA		       push    0FFFFFFF3h
.text:00405FAC		       jmp     short loc_405FC0
.text:00405FAE ; ---------------------------------------------------------------------------
.text:00405FAE
.text:00405FAE loc_405FAE:			       ; CODE XREF: ___sbh_heap_check+163j
.text:00405FAE					       ; ___sbh_heap_check+171j
.text:00405FAE		       push    0FFFFFFF6h
.text:00405FB0		       jmp     short loc_405FC0
.text:00405FB2 ; ---------------------------------------------------------------------------
.text:00405FB2
.text:00405FB2 loc_405FB2:			       ; CODE XREF: ___sbh_heap_check+222j
.text:00405FB2		       push    0FFFFFFF1h
.text:00405FB4		       jmp     short loc_405FC0
.text:00405FB6 ; ---------------------------------------------------------------------------
.text:00405FB6
.text:00405FB6 loc_405FB6:			       ; CODE XREF: ___sbh_heap_check+20Aj
.text:00405FB6					       ; ___sbh_heap_check+21Aj
.text:00405FB6		       push    0FFFFFFF2h
.text:00405FB8		       jmp     short loc_405FC0
.text:00405FBA ; ---------------------------------------------------------------------------
.text:00405FBA
.text:00405FBA loc_405FBA:			       ; CODE XREF: ___sbh_heap_check+242j
.text:00405FBA					       ; ___sbh_heap_check+24Dj
.text:00405FBA		       push    0FFFFFFF0h
.text:00405FBC		       jmp     short loc_405FC0
.text:00405FBE ; ---------------------------------------------------------------------------
.text:00405FBE
.text:00405FBE loc_405FBE:			       ; CODE XREF: ___sbh_heap_check+27Cj
.text:00405FBE					       ; ___sbh_heap_check+284j
.text:00405FBE		       push    0FFFFFFEFh
.text:00405FC0
.text:00405FC0 loc_405FC0:			       ; CODE XREF: ___sbh_heap_check+2A7j
.text:00405FC0					       ; ___sbh_heap_check+2ABj ...
.text:00405FC0		       pop     eax
.text:00405FC1		       jmp     short loc_405F81
.text:00405FC1 ___sbh_heap_check endp
.text:00405FC1
.text:00405FC3
.text:00405FC3 ; =============== S U B R O U T I N E =======================================
.text:00405FC3
.text:00405FC3
.text:00405FC3 ; int __cdecl _set_sbh_threshold(unsigned int threshold)
.text:00405FC3 __set_sbh_threshold proc	near
.text:00405FC3
.text:00405FC3 threshold       = dword ptr  4
.text:00405FC3
.text:00405FC3		       push    esi
.text:00405FC4		       xor     esi, esi
.text:00405FC6		       cmp     __crtheap, esi
.text:00405FCC		       jnz     short loc_405FD2
.text:00405FCE
.text:00405FCE loc_405FCE:			       ; CODE XREF: __set_sbh_threshold+3Cj
.text:00405FCE		       xor     eax, eax
.text:00405FD0		       pop     esi
.text:00405FD1		       retn
.text:00405FD2 ; ---------------------------------------------------------------------------
.text:00405FD2
.text:00405FD2 loc_405FD2:			       ; CODE XREF: __set_sbh_threshold+9j
.text:00405FD2		       mov     eax, ___active_heap
.text:00405FD7		       cmp     eax, 3
.text:00405FDA		       jnz     short loc_40600B
.text:00405FDC		       mov     eax, [esp+4+threshold]
.text:00405FE0		       cmp     eax, 3F8h
.text:00405FE5		       jbe     short loc_406001
.text:00405FE7		       call    __errno
.text:00405FEC		       push    esi	       ; pReserved
.text:00405FED		       push    esi	       ; nLine
.text:00405FEE		       push    esi	       ; pszFile
.text:00405FEF		       push    esi	       ; pszFunction
.text:00405FF0		       push    esi	       ; pszExpression
.text:00405FF1		       mov     dword ptr [eax],	16h
.text:00405FF7		       call    __invalid_parameter
.text:00405FFC		       add     esp, 14h
.text:00405FFF		       jmp     short loc_405FCE
.text:00406001 ; ---------------------------------------------------------------------------
.text:00406001
.text:00406001 loc_406001:			       ; CODE XREF: __set_sbh_threshold+22j
.text:00406001		       mov     ___sbh_threshold, eax
.text:00406006		       xor     eax, eax
.text:00406008		       inc     eax
.text:00406009		       pop     esi
.text:0040600A		       retn
.text:0040600B ; ---------------------------------------------------------------------------
.text:0040600B
.text:0040600B loc_40600B:			       ; CODE XREF: __set_sbh_threshold+17j
.text:0040600B		       push    edi
.text:0040600C		       mov     edi, [esp+8+threshold]
.text:00406010		       cmp     edi, esi
.text:00406012		       jz      short loc_406056
.text:00406014		       cmp     eax, 1
.text:00406017		       jnz     short loc_40605B
.text:00406019		       cmp     edi, 3F8h
.text:0040601F		       ja      short loc_40602C
.text:00406021		       push    edi	       ; threshold
.text:00406022		       call    ___sbh_heap_init
.text:00406027		       test    eax, eax
.text:00406029		       pop     ecx
.text:0040602A		       jnz     short loc_406046
.text:0040602C
.text:0040602C loc_40602C:			       ; CODE XREF: __set_sbh_threshold+5Cj
.text:0040602C		       call    __errno
.text:00406031		       push    esi	       ; pReserved
.text:00406032		       push    esi	       ; nLine
.text:00406033		       push    esi	       ; pszFile
.text:00406034		       push    esi	       ; pszFunction
.text:00406035		       push    esi	       ; pszExpression
.text:00406036		       mov     dword ptr [eax],	16h
.text:0040603C		       call    __invalid_parameter
.text:00406041		       add     esp, 14h
.text:00406044		       jmp     short loc_406066
.text:00406046 ; ---------------------------------------------------------------------------
.text:00406046
.text:00406046 loc_406046:			       ; CODE XREF: __set_sbh_threshold+67j
.text:00406046		       mov     ___sbh_threshold, edi
.text:0040604C		       mov     ___active_heap, 3
.text:00406056
.text:00406056 loc_406056:			       ; CODE XREF: __set_sbh_threshold+4Fj
.text:00406056		       xor     eax, eax
.text:00406058		       inc     eax
.text:00406059		       jmp     short loc_406068
.text:0040605B ; ---------------------------------------------------------------------------
.text:0040605B
.text:0040605B loc_40605B:			       ; CODE XREF: __set_sbh_threshold+54j
.text:0040605B		       call    __errno
.text:00406060		       mov     dword ptr [eax],	16h
.text:00406066
.text:00406066 loc_406066:			       ; CODE XREF: __set_sbh_threshold+81j
.text:00406066		       xor     eax, eax
.text:00406068
.text:00406068 loc_406068:			       ; CODE XREF: __set_sbh_threshold+96j
.text:00406068		       pop     edi
.text:00406069		       pop     esi
.text:0040606A		       retn
.text:0040606A __set_sbh_threshold endp
.text:0040606A
.text:0040606B
.text:0040606B ; =============== S U B R O U T I N E =======================================
.text:0040606B
.text:0040606B ; Attributes: bp-based frame
.text:0040606B
.text:0040606B ; void *__cdecl __sbh_alloc_block(int intSize)
.text:0040606B ___sbh_alloc_block proc near	       ; CODE XREF: _V6_HeapAlloc+28p
.text:0040606B					       ; __calloc_impl+88p ...
.text:0040606B
.text:0040606B var_14	       = dword ptr -14h
.text:0040606B sizeEntry       = dword ptr -10h
.text:0040606B pGroup	       = dword ptr -0Ch
.text:0040606B sizeNewFree     = dword ptr -8
.text:0040606B indGroupUse     = dword ptr -4
.text:0040606B pHeader	       = dword ptr  8
.text:0040606B
.text:0040606B		       push    ebp
.text:0040606C		       mov     ebp, esp
.text:0040606E		       sub     esp, 14h
.text:00406071		       mov     eax, ___sbh_cntHeaderList
.text:00406076		       mov     ecx, [ebp+pHeader]
.text:00406079		       imul    eax, 14h
.text:0040607C		       add     eax, ___sbh_pHeaderList
.text:00406082		       add     ecx, 17h
.text:00406085		       and     ecx, 0FFFFFFF0h
.text:00406088		       mov     [ebp+sizeEntry],	ecx
.text:0040608B		       sar     ecx, 4
.text:0040608E		       push    ebx
.text:0040608F		       dec     ecx
.text:00406090		       cmp     ecx, 20h
.text:00406093		       push    esi
.text:00406094		       push    edi
.text:00406095		       jge     short loc_4060A2
.text:00406097		       or      esi, 0FFFFFFFFh
.text:0040609A		       shr     esi, cl
.text:0040609C		       or      [ebp+sizeNewFree], 0FFFFFFFFh
.text:004060A0		       jmp     short loc_4060AF
.text:004060A2 ; ---------------------------------------------------------------------------
.text:004060A2
.text:004060A2 loc_4060A2:			       ; CODE XREF: ___sbh_alloc_block+2Aj
.text:004060A2		       add     ecx, 0FFFFFFE0h
.text:004060A5		       or      edx, 0FFFFFFFFh
.text:004060A8		       xor     esi, esi
.text:004060AA		       shr     edx, cl
.text:004060AC		       mov     [ebp+sizeNewFree], edx
.text:004060AF
.text:004060AF loc_4060AF:			       ; CODE XREF: ___sbh_alloc_block+35j
.text:004060AF		       mov     ecx, ___sbh_pHeaderScan
.text:004060B5		       mov     ebx, ecx
.text:004060B7		       jmp     short loc_4060CA
.text:004060B9 ; ---------------------------------------------------------------------------
.text:004060B9
.text:004060B9 loc_4060B9:			       ; CODE XREF: ___sbh_alloc_block+64j
.text:004060B9		       mov     edx, [ebx+4]
.text:004060BC		       mov     edi, [ebx]
.text:004060BE		       and     edx, [ebp+sizeNewFree]
.text:004060C1		       and     edi, esi
.text:004060C3		       or      edx, edi
.text:004060C5		       jnz     short loc_4060D1
.text:004060C7		       add     ebx, 14h
.text:004060CA
.text:004060CA loc_4060CA:			       ; CODE XREF: ___sbh_alloc_block+4Cj
.text:004060CA		       cmp     ebx, eax
.text:004060CC		       mov     [ebp+pHeader], ebx
.text:004060CF		       jb      short loc_4060B9
.text:004060D1
.text:004060D1 loc_4060D1:			       ; CODE XREF: ___sbh_alloc_block+5Aj
.text:004060D1		       cmp     ebx, eax
.text:004060D3		       jnz     short loc_406154
.text:004060D5		       mov     ebx, ___sbh_pHeaderList
.text:004060DB		       jmp     short loc_4060EE
.text:004060DD ; ---------------------------------------------------------------------------
.text:004060DD
.text:004060DD loc_4060DD:			       ; CODE XREF: ___sbh_alloc_block+88j
.text:004060DD		       mov     edx, [ebx+4]
.text:004060E0		       mov     edi, [ebx]
.text:004060E2		       and     edx, [ebp+sizeNewFree]
.text:004060E5		       and     edi, esi
.text:004060E7		       or      edx, edi
.text:004060E9		       jnz     short loc_4060F5
.text:004060EB		       add     ebx, 14h
.text:004060EE
.text:004060EE loc_4060EE:			       ; CODE XREF: ___sbh_alloc_block+70j
.text:004060EE		       cmp     ebx, ecx
.text:004060F0		       mov     [ebp+pHeader], ebx
.text:004060F3		       jb      short loc_4060DD
.text:004060F5
.text:004060F5 loc_4060F5:			       ; CODE XREF: ___sbh_alloc_block+7Ej
.text:004060F5		       cmp     ebx, ecx
.text:004060F7		       jnz     short loc_406154
.text:004060F9		       jmp     short loc_406107
.text:004060FB ; ---------------------------------------------------------------------------
.text:004060FB
.text:004060FB loc_4060FB:			       ; CODE XREF: ___sbh_alloc_block+9Ej
.text:004060FB		       cmp     dword ptr [ebx+8], 0
.text:004060FF		       jnz     short loc_40610B
.text:00406101		       add     ebx, 14h
.text:00406104		       mov     [ebp+pHeader], ebx
.text:00406107
.text:00406107 loc_406107:			       ; CODE XREF: ___sbh_alloc_block+8Ej
.text:00406107		       cmp     ebx, eax
.text:00406109		       jb      short loc_4060FB
.text:0040610B
.text:0040610B loc_40610B:			       ; CODE XREF: ___sbh_alloc_block+94j
.text:0040610B		       cmp     ebx, eax
.text:0040610D		       jnz     short loc_406140
.text:0040610F		       mov     ebx, ___sbh_pHeaderList
.text:00406115		       jmp     short loc_406120
.text:00406117 ; ---------------------------------------------------------------------------
.text:00406117
.text:00406117 loc_406117:			       ; CODE XREF: ___sbh_alloc_block+BAj
.text:00406117		       cmp     dword ptr [ebx+8], 0
.text:0040611B		       jnz     short loc_406127
.text:0040611D		       add     ebx, 14h
.text:00406120
.text:00406120 loc_406120:			       ; CODE XREF: ___sbh_alloc_block+AAj
.text:00406120		       cmp     ebx, ecx
.text:00406122		       mov     [ebp+pHeader], ebx
.text:00406125		       jb      short loc_406117
.text:00406127
.text:00406127 loc_406127:			       ; CODE XREF: ___sbh_alloc_block+B0j
.text:00406127		       cmp     ebx, ecx
.text:00406129		       jnz     short loc_406140
.text:0040612B		       call    ___sbh_alloc_new_region
.text:00406130		       mov     ebx, eax
.text:00406132		       test    ebx, ebx
.text:00406134		       mov     [ebp+pHeader], ebx
.text:00406137		       jnz     short loc_406140
.text:00406139
.text:00406139 loc_406139:			       ; CODE XREF: ___sbh_alloc_block+E7j
.text:00406139		       xor     eax, eax
.text:0040613B		       jmp     loc_406349
.text:00406140 ; ---------------------------------------------------------------------------
.text:00406140
.text:00406140 loc_406140:			       ; CODE XREF: ___sbh_alloc_block+A2j
.text:00406140					       ; ___sbh_alloc_block+BEj ...
.text:00406140		       push    ebx	       ; pHeader
.text:00406141		       call    ___sbh_alloc_new_group
.text:00406146		       pop     ecx
.text:00406147		       mov     ecx, [ebx+10h]
.text:0040614A		       mov     [ecx], eax
.text:0040614C		       mov     eax, [ebx+10h]
.text:0040614F		       cmp     dword ptr [eax],	0FFFFFFFFh
.text:00406152		       jz      short loc_406139
.text:00406154
.text:00406154 loc_406154:			       ; CODE XREF: ___sbh_alloc_block+68j
.text:00406154					       ; ___sbh_alloc_block+8Cj
.text:00406154		       mov     ___sbh_pHeaderScan, ebx
.text:0040615A		       mov     eax, [ebx+10h]
.text:0040615D		       mov     edx, [eax]
.text:0040615F		       cmp     edx, 0FFFFFFFFh
.text:00406162		       mov     [ebp+indGroupUse], edx
.text:00406165		       jz      short loc_40617B
.text:00406167		       mov     ecx, [eax+edx*4+0C4h]
.text:0040616E		       mov     edi, [eax+edx*4+44h]
.text:00406172		       and     ecx, [ebp+sizeNewFree]
.text:00406175		       and     edi, esi
.text:00406177		       or      ecx, edi
.text:00406179		       jnz     short loc_4061A4
.text:0040617B
.text:0040617B loc_40617B:			       ; CODE XREF: ___sbh_alloc_block+FAj
.text:0040617B		       and     [ebp+indGroupUse], 0
.text:0040617F		       mov     edx, [eax+0C4h]
.text:00406185		       lea     ecx, [eax+44h]
.text:00406188
.text:00406188 loc_406188:			       ; CODE XREF: ___sbh_alloc_block+134j
.text:00406188		       mov     edi, [ecx]
.text:0040618A		       and     edx, [ebp+sizeNewFree]
.text:0040618D		       and     edi, esi
.text:0040618F		       or      edx, edi
.text:00406191		       jnz     short loc_4061A1
.text:00406193		       inc     [ebp+indGroupUse]
.text:00406196		       mov     edx, [ecx+84h]
.text:0040619C		       add     ecx, 4
.text:0040619F		       jmp     short loc_406188
.text:004061A1 ; ---------------------------------------------------------------------------
.text:004061A1
.text:004061A1 loc_4061A1:			       ; CODE XREF: ___sbh_alloc_block+126j
.text:004061A1		       mov     edx, [ebp+indGroupUse]
.text:004061A4
.text:004061A4 loc_4061A4:			       ; CODE XREF: ___sbh_alloc_block+10Ej
.text:004061A4		       mov     ecx, edx
.text:004061A6		       imul    ecx, 204h
.text:004061AC		       lea     ecx, [ecx+eax+144h]
.text:004061B3		       mov     [ebp+pGroup], ecx
.text:004061B6		       mov     ecx, [eax+edx*4+44h]
.text:004061BA		       xor     edi, edi
.text:004061BC		       and     ecx, esi
.text:004061BE		       jnz     short loc_4061D2
.text:004061C0		       mov     ecx, [eax+edx*4+0C4h]
.text:004061C7		       and     ecx, [ebp+sizeNewFree]
.text:004061CA		       push    20h
.text:004061CC		       pop     edi
.text:004061CD		       jmp     short loc_4061D2
.text:004061CF ; ---------------------------------------------------------------------------
.text:004061CF
.text:004061CF loc_4061CF:			       ; CODE XREF: ___sbh_alloc_block+169j
.text:004061CF		       add     ecx, ecx
.text:004061D1		       inc     edi
.text:004061D2
.text:004061D2 loc_4061D2:			       ; CODE XREF: ___sbh_alloc_block+153j
.text:004061D2					       ; ___sbh_alloc_block+162j
.text:004061D2		       test    ecx, ecx
.text:004061D4		       jge     short loc_4061CF
.text:004061D6		       mov     ecx, [ebp+pGroup]
.text:004061D9		       mov     edx, [ecx+edi*8+4]
.text:004061DD		       mov     ecx, [edx]
.text:004061DF		       sub     ecx, [ebp+sizeEntry]
.text:004061E2		       mov     esi, ecx
.text:004061E4		       sar     esi, 4
.text:004061E7		       dec     esi
.text:004061E8		       cmp     esi, 3Fh
.text:004061EB		       mov     [ebp+sizeNewFree], ecx
.text:004061EE		       jle     short loc_4061F3
.text:004061F0		       push    3Fh
.text:004061F2		       pop     esi
.text:004061F3
.text:004061F3 loc_4061F3:			       ; CODE XREF: ___sbh_alloc_block+183j
.text:004061F3		       cmp     esi, edi
.text:004061F5		       jz      loc_4062FC
.text:004061FB		       mov     ecx, [edx+4]
.text:004061FE		       cmp     ecx, [edx+8]
.text:00406201		       jnz     short loc_40625F
.text:00406203		       cmp     edi, 20h
.text:00406206		       mov     ebx, 80000000h
.text:0040620B		       jge     short loc_406233
.text:0040620D		       mov     ecx, edi
.text:0040620F		       shr     ebx, cl
.text:00406211		       mov     ecx, [ebp+indGroupUse]
.text:00406214		       lea     edi, [eax+edi+4]
.text:00406218		       not     ebx
.text:0040621A		       mov     [ebp+var_14], ebx
.text:0040621D		       and     ebx, [eax+ecx*4+44h]
.text:00406221		       mov     [eax+ecx*4+44h],	ebx
.text:00406225		       dec     byte ptr	[edi]
.text:00406227		       jnz     short loc_40625C
.text:00406229		       mov     ecx, [ebp+var_14]
.text:0040622C		       mov     ebx, [ebp+pHeader]
.text:0040622F		       and     [ebx], ecx
.text:00406231		       jmp     short loc_40625F
.text:00406233 ; ---------------------------------------------------------------------------
.text:00406233
.text:00406233 loc_406233:			       ; CODE XREF: ___sbh_alloc_block+1A0j
.text:00406233		       lea     ecx, [edi-20h]
.text:00406236		       shr     ebx, cl
.text:00406238		       mov     ecx, [ebp+indGroupUse]
.text:0040623B		       lea     ecx, [eax+ecx*4+0C4h]
.text:00406242		       lea     edi, [eax+edi+4]
.text:00406246		       not     ebx
.text:00406248		       and     [ecx], ebx
.text:0040624A		       dec     byte ptr	[edi]
.text:0040624C		       mov     [ebp+var_14], ebx
.text:0040624F		       jnz     short loc_40625C
.text:00406251		       mov     ebx, [ebp+pHeader]
.text:00406254		       mov     ecx, [ebp+var_14]
.text:00406257		       and     [ebx+4],	ecx
.text:0040625A		       jmp     short loc_40625F
.text:0040625C ; ---------------------------------------------------------------------------
.text:0040625C
.text:0040625C loc_40625C:			       ; CODE XREF: ___sbh_alloc_block+1BCj
.text:0040625C					       ; ___sbh_alloc_block+1E4j
.text:0040625C		       mov     ebx, [ebp+pHeader]
.text:0040625F
.text:0040625F loc_40625F:			       ; CODE XREF: ___sbh_alloc_block+196j
.text:0040625F					       ; ___sbh_alloc_block+1C6j ...
.text:0040625F		       cmp     [ebp+sizeNewFree], 0
.text:00406263		       mov     ecx, [edx+8]
.text:00406266		       mov     edi, [edx+4]
.text:00406269		       mov     [ecx+4],	edi
.text:0040626C		       mov     ecx, [edx+4]
.text:0040626F		       mov     edi, [edx+8]
.text:00406272		       mov     [ecx+8],	edi
.text:00406275		       jz      loc_406308
.text:0040627B		       mov     ecx, [ebp+pGroup]
.text:0040627E		       lea     ecx, [ecx+esi*8]
.text:00406281		       mov     edi, [ecx+4]
.text:00406284		       mov     [edx+8],	ecx
.text:00406287		       mov     [edx+4],	edi
.text:0040628A		       mov     [ecx+4],	edx
.text:0040628D		       mov     ecx, [edx+4]
.text:00406290		       mov     [ecx+8],	edx
.text:00406293		       mov     ecx, [edx+4]
.text:00406296		       cmp     ecx, [edx+8]
.text:00406299		       jnz     short loc_4062F9
.text:0040629B		       mov     cl, [esi+eax+4]
.text:0040629F		       mov     byte ptr	[ebp+pHeader+3], cl
.text:004062A2		       inc     cl
.text:004062A4		       cmp     esi, 20h
.text:004062A7		       mov     [esi+eax+4], cl
.text:004062AB		       jge     short loc_4062D0
.text:004062AD		       cmp     byte ptr	[ebp+pHeader+3], 0
.text:004062B1		       jnz     short loc_4062BE
.text:004062B3		       mov     edi, 80000000h
.text:004062B8		       mov     ecx, esi
.text:004062BA		       shr     edi, cl
.text:004062BC		       or      [ebx], edi
.text:004062BE
.text:004062BE loc_4062BE:			       ; CODE XREF: ___sbh_alloc_block+246j
.text:004062BE		       mov     ecx, esi
.text:004062C0		       mov     edi, 80000000h
.text:004062C5		       shr     edi, cl
.text:004062C7		       mov     ecx, [ebp+indGroupUse]
.text:004062CA		       or      [eax+ecx*4+44h],	edi
.text:004062CE		       jmp     short loc_4062F9
.text:004062D0 ; ---------------------------------------------------------------------------
.text:004062D0
.text:004062D0 loc_4062D0:			       ; CODE XREF: ___sbh_alloc_block+240j
.text:004062D0		       cmp     byte ptr	[ebp+pHeader+3], 0
.text:004062D4		       jnz     short loc_4062E3
.text:004062D6		       lea     ecx, [esi-20h]
.text:004062D9		       mov     edi, 80000000h
.text:004062DE		       shr     edi, cl
.text:004062E0		       or      [ebx+4],	edi
.text:004062E3
.text:004062E3 loc_4062E3:			       ; CODE XREF: ___sbh_alloc_block+269j
.text:004062E3		       mov     ecx, [ebp+indGroupUse]
.text:004062E6		       lea     edi, [eax+ecx*4+0C4h]
.text:004062ED		       lea     ecx, [esi-20h]
.text:004062F0		       mov     esi, 80000000h
.text:004062F5		       shr     esi, cl
.text:004062F7		       or      [edi], esi
.text:004062F9
.text:004062F9 loc_4062F9:			       ; CODE XREF: ___sbh_alloc_block+22Ej
.text:004062F9					       ; ___sbh_alloc_block+263j
.text:004062F9		       mov     ecx, [ebp+sizeNewFree]
.text:004062FC
.text:004062FC loc_4062FC:			       ; CODE XREF: ___sbh_alloc_block+18Aj
.text:004062FC		       test    ecx, ecx
.text:004062FE		       jz      short loc_40630B
.text:00406300		       mov     [edx], ecx
.text:00406302		       mov     [ecx+edx-4], ecx
.text:00406306		       jmp     short loc_40630B
.text:00406308 ; ---------------------------------------------------------------------------
.text:00406308
.text:00406308 loc_406308:			       ; CODE XREF: ___sbh_alloc_block+20Aj
.text:00406308		       mov     ecx, [ebp+sizeNewFree]
.text:0040630B
.text:0040630B loc_40630B:			       ; CODE XREF: ___sbh_alloc_block+293j
.text:0040630B					       ; ___sbh_alloc_block+29Bj
.text:0040630B		       mov     esi, [ebp+sizeEntry]
.text:0040630E		       add     edx, ecx
.text:00406310		       lea     ecx, [esi+1]
.text:00406313		       mov     [edx], ecx
.text:00406315		       mov     [edx+esi-4], ecx
.text:00406319		       mov     esi, [ebp+pGroup]
.text:0040631C		       mov     ecx, [esi]
.text:0040631E		       test    ecx, ecx
.text:00406320		       lea     edi, [ecx+1]
.text:00406323		       mov     [esi], edi
.text:00406325		       jnz     short loc_406341
.text:00406327		       cmp     ebx, ___sbh_pHeaderDefer
.text:0040632D		       jnz     short loc_406341
.text:0040632F		       mov     ecx, [ebp+indGroupUse]
.text:00406332		       cmp     ecx, ___sbh_indGroupDefer
.text:00406338		       jnz     short loc_406341
.text:0040633A		       and     ___sbh_pHeaderDefer, 0
.text:00406341
.text:00406341 loc_406341:			       ; CODE XREF: ___sbh_alloc_block+2BAj
.text:00406341					       ; ___sbh_alloc_block+2C2j ...
.text:00406341		       mov     ecx, [ebp+indGroupUse]
.text:00406344		       mov     [eax], ecx
.text:00406346		       lea     eax, [edx+4]
.text:00406349
.text:00406349 loc_406349:			       ; CODE XREF: ___sbh_alloc_block+D0j
.text:00406349		       pop     edi
.text:0040634A		       pop     esi
.text:0040634B		       pop     ebx
.text:0040634C		       leave
.text:0040634D		       retn
.text:0040634D ___sbh_alloc_block endp
.text:0040634D
.text:0040634E
.text:0040634E ; =============== S U B R O U T I N E =======================================
.text:0040634E
.text:0040634E ; Attributes: bp-based frame
.text:0040634E
.text:0040634E ; int __cdecl __heap_select()
.text:0040634E ___heap_select  proc near	       ; CODE XREF: __heap_init:loc_4063CCp
.text:0040634E
.text:0040634E winmajor	       = dword ptr -8
.text:0040634E osplatform      = dword ptr -4
.text:0040634E
.text:0040634E		       push    ebp
.text:0040634F		       mov     ebp, esp
.text:00406351		       push    ecx
.text:00406352		       push    ecx
.text:00406353		       push    esi
.text:00406354		       lea     eax, [ebp+osplatform]
.text:00406357		       xor     esi, esi
.text:00406359		       push    eax	       ; pValue
.text:0040635A		       mov     [ebp+osplatform], esi
.text:0040635D		       mov     [ebp+winmajor], esi
.text:00406360		       call    __get_osplatform
.text:00406365		       test    eax, eax
.text:00406367		       pop     ecx
.text:00406368		       jz      short loc_406377
.text:0040636A		       push    esi	       ; pReserved
.text:0040636B		       push    esi	       ; nLine
.text:0040636C		       push    esi	       ; pszFile
.text:0040636D		       push    esi	       ; pszFunction
.text:0040636E		       push    esi	       ; pszExpression
.text:0040636F		       call    __invoke_watson
.text:00406374		       add     esp, 14h
.text:00406377
.text:00406377 loc_406377:			       ; CODE XREF: ___heap_select+1Aj
.text:00406377		       lea     eax, [ebp+winmajor]
.text:0040637A		       push    eax	       ; pValue
.text:0040637B		       call    __get_winmajor
.text:00406380		       test    eax, eax
.text:00406382		       pop     ecx
.text:00406383		       jz      short loc_406392
.text:00406385		       push    esi	       ; pReserved
.text:00406386		       push    esi	       ; nLine
.text:00406387		       push    esi	       ; pszFile
.text:00406388		       push    esi	       ; pszFunction
.text:00406389		       push    esi	       ; pszExpression
.text:0040638A		       call    __invoke_watson
.text:0040638F		       add     esp, 14h
.text:00406392
.text:00406392 loc_406392:			       ; CODE XREF: ___heap_select+35j
.text:00406392		       cmp     [ebp+osplatform], 2
.text:00406396		       pop     esi
.text:00406397		       jnz     short loc_4063A4
.text:00406399		       cmp     [ebp+winmajor], 5
.text:0040639D		       jb      short loc_4063A4
.text:0040639F		       xor     eax, eax
.text:004063A1		       inc     eax
.text:004063A2		       leave
.text:004063A3		       retn
.text:004063A4 ; ---------------------------------------------------------------------------
.text:004063A4
.text:004063A4 loc_4063A4:			       ; CODE XREF: ___heap_select+49j
.text:004063A4					       ; ___heap_select+4Fj
.text:004063A4		       push    3
.text:004063A6		       pop     eax
.text:004063A7		       leave
.text:004063A8		       retn
.text:004063A8 ___heap_select  endp
.text:004063A8
.text:004063A9
.text:004063A9 ; =============== S U B R O U T I N E =======================================
.text:004063A9
.text:004063A9
.text:004063A9 ; int __cdecl _heap_init(int mtflag)
.text:004063A9 __heap_init     proc near	       ; CODE XREF: __tmainCRTStartup+BCp
.text:004063A9
.text:004063A9 mtflag	       = dword ptr  4
.text:004063A9
.text:004063A9		       xor     eax, eax
.text:004063AB		       cmp     [esp+mtflag], eax
.text:004063AF		       push    0	       ; dwMaximumSize
.text:004063B1		       setz    al
.text:004063B4		       push    1000h	       ; dwInitialSize
.text:004063B9		       push    eax	       ; flOptions
.text:004063BA		       call    ds:__imp__HeapCreate@12 ; HeapCreate(x,x,x)
.text:004063C0		       test    eax, eax
.text:004063C2		       mov     __crtheap, eax
.text:004063C7		       jnz     short loc_4063CC
.text:004063C9
.text:004063C9 loc_4063C9:			       ; CODE XREF: __heap_init+54j
.text:004063C9		       xor     eax, eax
.text:004063CB		       retn
.text:004063CC ; ---------------------------------------------------------------------------
.text:004063CC
.text:004063CC loc_4063CC:			       ; CODE XREF: __heap_init+1Ej
.text:004063CC		       call    ___heap_select
.text:004063D1		       cmp     eax, 3
.text:004063D4		       mov     ___active_heap, eax
.text:004063D9		       jnz     short loc_4063FF
.text:004063DB		       push    3F8h	       ; threshold
.text:004063E0		       call    ___sbh_heap_init
.text:004063E5		       test    eax, eax
.text:004063E7		       pop     ecx
.text:004063E8		       jnz     short loc_4063FF
.text:004063EA		       push    __crtheap       ; hHeap
.text:004063F0		       call    ds:__imp__HeapDestroy@4 ; HeapDestroy(x)
.text:004063F6		       and     __crtheap, 0
.text:004063FD		       jmp     short loc_4063C9
.text:004063FF ; ---------------------------------------------------------------------------
.text:004063FF
.text:004063FF loc_4063FF:			       ; CODE XREF: __heap_init+30j
.text:004063FF					       ; __heap_init+3Fj
.text:004063FF		       xor     eax, eax
.text:00406401		       inc     eax
.text:00406402		       retn
.text:00406402 __heap_init     endp
.text:00406402
.text:00406403
.text:00406403 ; =============== S U B R O U T I N E =======================================
.text:00406403
.text:00406403
.text:00406403 __heap_term     proc near
.text:00406403		       push    ebp
.text:00406404		       xor     ebp, ebp
.text:00406406		       cmp     ___active_heap, 3
.text:0040640D		       jnz     short loc_406463
.text:0040640F		       push    ebx
.text:00406410		       mov     ebx, ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00406416		       push    edi
.text:00406417		       xor     edi, edi
.text:00406419		       cmp     ___sbh_cntHeaderList, ebp
.text:0040641F		       jle     short loc_406452
.text:00406421		       push    esi
.text:00406422		       mov     esi, ___sbh_pHeaderList
.text:00406428		       add     esi, 10h
.text:0040642B
.text:0040642B loc_40642B:			       ; CODE XREF: __heap_term+4Cj
.text:0040642B		       push    8000h	       ; dwFreeType
.text:00406430		       push    ebp	       ; dwSize
.text:00406431		       push    dword ptr [esi-4] ; lpAddress
.text:00406434		       call    ds:__imp__VirtualFree@12	; VirtualFree(x,x,x)
.text:0040643A		       push    dword ptr [esi] ; lpMem
.text:0040643C		       push    ebp	       ; dwFlags
.text:0040643D		       push    __crtheap       ; hHeap
.text:00406443		       call    ebx ; HeapFree(x,x,x) ; HeapFree(x,x,x)
.text:00406445		       add     esi, 14h
.text:00406448		       inc     edi
.text:00406449		       cmp     edi, ___sbh_cntHeaderList
.text:0040644F		       jl      short loc_40642B
.text:00406451		       pop     esi
.text:00406452
.text:00406452 loc_406452:			       ; CODE XREF: __heap_term+1Cj
.text:00406452		       push    ___sbh_pHeaderList ; lpMem
.text:00406458		       push    ebp	       ; dwFlags
.text:00406459		       push    __crtheap       ; hHeap
.text:0040645F		       call    ebx ; HeapFree(x,x,x) ; HeapFree(x,x,x)
.text:00406461		       pop     edi
.text:00406462		       pop     ebx
.text:00406463
.text:00406463 loc_406463:			       ; CODE XREF: __heap_term+Aj
.text:00406463		       push    __crtheap       ; hHeap
.text:00406469		       call    ds:__imp__HeapDestroy@4 ; HeapDestroy(x)
.text:0040646F		       mov     __crtheap, ebp
.text:00406475		       pop     ebp
.text:00406476		       retn
.text:00406476 __heap_term     endp
.text:00406476
.text:00406477
.text:00406477 ; =============== S U B R O U T I N E =======================================
.text:00406477
.text:00406477
.text:00406477 ; int __cdecl _get_heap_handle()
.text:00406477 __get_heap_handle proc near
.text:00406477		       mov     eax, __crtheap
.text:0040647C		       retn
.text:0040647C __get_heap_handle endp
.text:0040647C
.text:0040647D
.text:0040647D ; =============== S U B R O U T I N E =======================================
.text:0040647D
.text:0040647D
.text:0040647D ; int __stdcall __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *pPtrs)
.text:0040647D ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z proc near
.text:0040647D					       ; DATA XREF: ___CxxSetUnhandledExceptionFiltero
.text:0040647D
.text:0040647D pPtrs	       = dword ptr  4
.text:0040647D
.text:0040647D		       mov     eax, [esp+pPtrs]
.text:00406481		       mov     eax, [eax]
.text:00406483		       cmp     dword ptr [eax],	0E06D7363h
.text:00406489		       jnz     short $LN6_6
.text:0040648B		       cmp     dword ptr [eax+10h], 3
.text:0040648F		       jnz     short $LN6_6
.text:00406491		       mov     eax, [eax+14h]
.text:00406494		       cmp     eax, 19930520h
.text:00406499		       jz      short loc_4064B0
.text:0040649B		       cmp     eax, 19930521h
.text:004064A0		       jz      short loc_4064B0
.text:004064A2		       cmp     eax, 19930522h
.text:004064A7		       jz      short loc_4064B0
.text:004064A9		       cmp     eax, 1994000h
.text:004064AE		       jnz     short $LN6_6
.text:004064B0
.text:004064B0 loc_4064B0:			       ; CODE XREF: __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+1Cj
.text:004064B0					       ; __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+23j ...
.text:004064B0		       call    ?terminate@@YAXXZ ; terminate(void)
.text:004064B5 ; ---------------------------------------------------------------------------
.text:004064B5
.text:004064B5 $LN6_6:				       ; CODE XREF: __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+Cj
.text:004064B5					       ; __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+12j ...
.text:004064B5		       xor     eax, eax
.text:004064B7		       retn    4
.text:004064B7 ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z endp
.text:004064B7
.text:004064BA
.text:004064BA ; =============== S U B R O U T I N E =======================================
.text:004064BA
.text:004064BA
.text:004064BA ; int __cdecl __CxxSetUnhandledExceptionFilter()
.text:004064BA ___CxxSetUnhandledExceptionFilter proc near ; DATA XREF:	.rdata:pinit_4o
.text:004064BA		       push    offset ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z ; lpTopLevelExceptionFilter
.text:004064BF		       call    ds:__imp__SetUnhandledExceptionFilter@4 ; SetUnhandledExceptionFilter(x)
.text:004064C5		       xor     eax, eax
.text:004064C7		       retn
.text:004064C7 ___CxxSetUnhandledExceptionFilter endp
.text:004064C7
.text:004064C8
.text:004064C8 ; =============== S U B R O U T I N E =======================================
.text:004064C8
.text:004064C8
.text:004064C8 ; int __cdecl _setenvp()
.text:004064C8 __setenvp       proc near	       ; CODE XREF: __tmainCRTStartup:loc_40205Bp
.text:004064C8		       push    ebx
.text:004064C9		       xor     ebx, ebx
.text:004064CB		       cmp     ___mbctype_initialized, ebx
.text:004064D1		       push    esi
.text:004064D2		       push    edi
.text:004064D3		       jnz     short loc_4064DA
.text:004064D5		       call    ___initmbctable
.text:004064DA
.text:004064DA loc_4064DA:			       ; CODE XREF: __setenvp+Bj
.text:004064DA		       mov     esi, __aenvptr
.text:004064E0		       xor     edi, edi
.text:004064E2		       cmp     esi, ebx
.text:004064E4		       jnz     short loc_4064FE
.text:004064E6
.text:004064E6 loc_4064E6:			       ; CODE XREF: __setenvp+51j
.text:004064E6		       or      eax, 0FFFFFFFFh
.text:004064E9		       jmp     loc_406589
.text:004064EE ; ---------------------------------------------------------------------------
.text:004064EE
.text:004064EE loc_4064EE:			       ; CODE XREF: __setenvp+3Aj
.text:004064EE		       cmp     al, 3Dh
.text:004064F0		       jz      short loc_4064F3
.text:004064F2		       inc     edi
.text:004064F3
.text:004064F3 loc_4064F3:			       ; CODE XREF: __setenvp+28j
.text:004064F3		       push    esi	       ; buf
.text:004064F4		       call    _strlen
.text:004064F9		       pop     ecx
.text:004064FA		       lea     esi, [esi+eax+1]
.text:004064FE
.text:004064FE loc_4064FE:			       ; CODE XREF: __setenvp+1Cj
.text:004064FE		       mov     al, [esi]
.text:00406500		       cmp     al, bl
.text:00406502		       jnz     short loc_4064EE
.text:00406504		       push    4	       ; size
.text:00406506		       inc     edi
.text:00406507		       push    edi	       ; count
.text:00406508		       call    __calloc_crt
.text:0040650D		       mov     edi, eax
.text:0040650F		       cmp     edi, ebx
.text:00406511		       pop     ecx
.text:00406512		       pop     ecx
.text:00406513		       mov     __environ, edi
.text:00406519		       jz      short loc_4064E6
.text:0040651B		       mov     esi, __aenvptr
.text:00406521		       push    ebp
.text:00406522		       jmp     short loc_406564
.text:00406524 ; ---------------------------------------------------------------------------
.text:00406524
.text:00406524 loc_406524:			       ; CODE XREF: __setenvp+9Ej
.text:00406524		       push    esi	       ; buf
.text:00406525		       call    _strlen
.text:0040652A		       mov     ebp, eax
.text:0040652C		       inc     ebp
.text:0040652D		       cmp     byte ptr	[esi], 3Dh
.text:00406530		       pop     ecx
.text:00406531		       jz      short loc_406562
.text:00406533		       push    1	       ; size
.text:00406535		       push    ebp	       ; count
.text:00406536		       call    __calloc_crt
.text:0040653B		       cmp     eax, ebx
.text:0040653D		       pop     ecx
.text:0040653E		       pop     ecx
.text:0040653F		       mov     [edi], eax
.text:00406541		       jz      short loc_40658D
.text:00406543		       push    esi	       ; _Src
.text:00406544		       push    ebp	       ; _SizeInBytes
.text:00406545		       push    eax	       ; _Dst
.text:00406546		       call    _strcpy_s
.text:0040654B		       add     esp, 0Ch
.text:0040654E		       test    eax, eax
.text:00406550		       jz      short loc_40655F
.text:00406552		       push    ebx	       ; pReserved
.text:00406553		       push    ebx	       ; nLine
.text:00406554		       push    ebx	       ; pszFile
.text:00406555		       push    ebx	       ; pszFunction
.text:00406556		       push    ebx	       ; pszExpression
.text:00406557		       call    __invoke_watson
.text:0040655C		       add     esp, 14h
.text:0040655F
.text:0040655F loc_40655F:			       ; CODE XREF: __setenvp+88j
.text:0040655F		       add     edi, 4
.text:00406562
.text:00406562 loc_406562:			       ; CODE XREF: __setenvp+69j
.text:00406562		       add     esi, ebp
.text:00406564
.text:00406564 loc_406564:			       ; CODE XREF: __setenvp+5Aj
.text:00406564		       cmp     [esi], bl
.text:00406566		       jnz     short loc_406524
.text:00406568		       push    __aenvptr       ; pBlock
.text:0040656E		       call    _free
.text:00406573		       mov     __aenvptr, ebx
.text:00406579		       mov     [edi], ebx
.text:0040657B		       mov     ___env_initialized, 1
.text:00406585		       xor     eax, eax
.text:00406587
.text:00406587 loc_406587:			       ; CODE XREF: __setenvp+D9j
.text:00406587		       pop     ecx
.text:00406588		       pop     ebp
.text:00406589
.text:00406589 loc_406589:			       ; CODE XREF: __setenvp+21j
.text:00406589		       pop     edi
.text:0040658A		       pop     esi
.text:0040658B		       pop     ebx
.text:0040658C		       retn
.text:0040658D ; ---------------------------------------------------------------------------
.text:0040658D
.text:0040658D loc_40658D:			       ; CODE XREF: __setenvp+79j
.text:0040658D		       push    __environ       ; pBlock
.text:00406593		       call    _free
.text:00406598		       mov     __environ, ebx
.text:0040659E		       or      eax, 0FFFFFFFFh
.text:004065A1		       jmp     short loc_406587
.text:004065A1 __setenvp       endp
.text:004065A1
.text:004065A3
.text:004065A3 ; =============== S U B R O U T I N E =======================================
.text:004065A3
.text:004065A3
.text:004065A3 ; void __cdecl _set_pgmptr(char *_Value)
.text:004065A3 __set_pgmptr    proc near
.text:004065A3
.text:004065A3 _Value	       = dword ptr  4
.text:004065A3
.text:004065A3		       mov     eax, [esp+_Value]
.text:004065A7		       mov     __pgmptr, eax
.text:004065AC		       retn
.text:004065AC __set_pgmptr    endp
.text:004065AC
.text:004065AD
.text:004065AD ; =============== S U B R O U T I N E =======================================
.text:004065AD
.text:004065AD ; Attributes: bp-based frame
.text:004065AD
.text:004065AD ; void __usercall parse_cmdline(char *cmdstart<edx>, char **argv, char *args, int *numargs, int *numchars<edi>)
.text:004065AD parse_cmdline   proc near	       ; CODE XREF: __setargv+55p
.text:004065AD					       ; __setargv+96p
.text:004065AD
.text:004065AD inquote	       = dword ptr -4
.text:004065AD argv	       = dword ptr  8
.text:004065AD args	       = dword ptr  0Ch
.text:004065AD numargs	       = dword ptr  10h
.text:004065AD
.text:004065AD cmdstart	= edx
.text:004065AD numchars	= edi
.text:004065AD		       push    ebp
.text:004065AE		       mov     ebp, esp
.text:004065B0		       push    ecx
.text:004065B1		       mov     ecx, [ebp+numargs]
.text:004065B4		       push    ebx
.text:004065B5		       xor     eax, eax
.text:004065B7		       cmp     [ebp+argv], eax
.text:004065BA		       push    esi
.text:004065BB		       mov     [numchars], eax
.text:004065BD		       mov     esi, cmdstart
.text:004065BF		       mov     cmdstart, [ebp+args]
.text:004065C2		       mov     dword ptr [ecx],	1
.text:004065C8		       jz      short loc_4065D3
.text:004065CA		       mov     ebx, [ebp+argv]
.text:004065CD		       add     [ebp+argv], 4
.text:004065D1		       mov     [ebx], cmdstart
.text:004065D3
.text:004065D3 loc_4065D3:			       ; CODE XREF: parse_cmdline+1Bj
.text:004065D3		       mov     [ebp+inquote], eax
.text:004065D6
.text:004065D6 loc_4065D6:			       ; CODE XREF: parse_cmdline+7Ej
.text:004065D6					       ; parse_cmdline+88j
.text:004065D6		       cmp     byte ptr	[esi], 22h
.text:004065D9		       jnz     short loc_4065EB
.text:004065DB		       xor     eax, eax
.text:004065DD		       cmp     [ebp+inquote], eax
.text:004065E0		       mov     bl, 22h
.text:004065E2		       setz    al
.text:004065E5		       inc     esi
.text:004065E6		       mov     [ebp+inquote], eax
.text:004065E9		       jmp     short loc_406627
.text:004065EB ; ---------------------------------------------------------------------------
.text:004065EB
.text:004065EB loc_4065EB:			       ; CODE XREF: parse_cmdline+2Cj
.text:004065EB		       inc     dword ptr [numchars]
.text:004065ED		       test    cmdstart, cmdstart
.text:004065EF		       jz      short loc_4065F9
.text:004065F1		       mov     al, [esi]
.text:004065F3		       mov     [cmdstart], al
.text:004065F5		       inc     cmdstart
.text:004065F6		       mov     [ebp+args], cmdstart
.text:004065F9
.text:004065F9 loc_4065F9:			       ; CODE XREF: parse_cmdline+42j
.text:004065F9		       mov     bl, [esi]
.text:004065FB		       movzx   eax, bl
.text:004065FE		       push    eax	       ; tst
.text:004065FF		       inc     esi
.text:00406600		       call    __ismbblead
.text:00406605		       test    eax, eax
.text:00406607		       pop     ecx
.text:00406608		       jz      short loc_40661D
.text:0040660A		       inc     dword ptr [numchars]
.text:0040660C		       cmp     [ebp+args], 0
.text:00406610		       jz      short loc_40661C
.text:00406612		       mov     ecx, [ebp+args]
.text:00406615		       mov     al, [esi]
.text:00406617		       inc     [ebp+args]
.text:0040661A		       mov     [ecx], al
.text:0040661C
.text:0040661C loc_40661C:			       ; CODE XREF: parse_cmdline+63j
.text:0040661C		       inc     esi
.text:0040661D
.text:0040661D loc_40661D:			       ; CODE XREF: parse_cmdline+5Bj
.text:0040661D		       test    bl, bl
.text:0040661F		       mov     cmdstart, [ebp+args]
.text:00406622		       mov     ecx, [ebp+numargs]
.text:00406625		       jz      short loc_406659
.text:00406627
.text:00406627 loc_406627:			       ; CODE XREF: parse_cmdline+3Cj
.text:00406627		       cmp     [ebp+inquote], 0
.text:0040662B		       jnz     short loc_4065D6
.text:0040662D		       cmp     bl, 20h
.text:00406630		       jz      short loc_406637
.text:00406632		       cmp     bl, 9
.text:00406635		       jnz     short loc_4065D6
.text:00406637
.text:00406637 loc_406637:			       ; CODE XREF: parse_cmdline+83j
.text:00406637		       test    cmdstart, cmdstart
.text:00406639		       jz      short loc_40663F
.text:0040663B		       mov     byte ptr	[cmdstart-1], 0
.text:0040663F
.text:0040663F loc_40663F:			       ; CODE XREF: parse_cmdline+8Cj
.text:0040663F					       ; parse_cmdline+ADj
.text:0040663F		       and     [ebp+inquote], 0
.text:00406643
.text:00406643 loc_406643:			       ; CODE XREF: parse_cmdline+183j
.text:00406643		       cmp     byte ptr	[esi], 0
.text:00406646		       jz      loc_406735
.text:0040664C
.text:0040664C loc_40664C:			       ; CODE XREF: parse_cmdline+AAj
.text:0040664C		       mov     al, [esi]
.text:0040664E		       cmp     al, 20h
.text:00406650		       jz      short loc_406656
.text:00406652		       cmp     al, 9
.text:00406654		       jnz     short loc_40665C
.text:00406656
.text:00406656 loc_406656:			       ; CODE XREF: parse_cmdline+A3j
.text:00406656		       inc     esi
.text:00406657		       jmp     short loc_40664C
.text:00406659 ; ---------------------------------------------------------------------------
.text:00406659
.text:00406659 loc_406659:			       ; CODE XREF: parse_cmdline+78j
.text:00406659		       dec     esi
.text:0040665A		       jmp     short loc_40663F
.text:0040665C ; ---------------------------------------------------------------------------
.text:0040665C
.text:0040665C loc_40665C:			       ; CODE XREF: parse_cmdline+A7j
.text:0040665C		       cmp     byte ptr	[esi], 0
.text:0040665F		       jz      loc_406735
.text:00406665		       cmp     [ebp+argv], 0
.text:00406669		       jz      short loc_406674
.text:0040666B		       mov     eax, [ebp+argv]
.text:0040666E		       add     [ebp+argv], 4
.text:00406672		       mov     [eax], cmdstart
.text:00406674
.text:00406674 loc_406674:			       ; CODE XREF: parse_cmdline+BCj
.text:00406674		       inc     dword ptr [ecx]
.text:00406676
.text:00406676 loc_406676:			       ; CODE XREF: parse_cmdline+16Ej
.text:00406676		       xor     ebx, ebx
.text:00406678		       inc     ebx
.text:00406679		       xor     ecx, ecx
.text:0040667B		       jmp     short loc_40667F
.text:0040667D ; ---------------------------------------------------------------------------
.text:0040667D
.text:0040667D loc_40667D:			       ; CODE XREF: parse_cmdline+D5j
.text:0040667D		       inc     esi
.text:0040667E		       inc     ecx
.text:0040667F
.text:0040667F loc_40667F:			       ; CODE XREF: parse_cmdline+CEj
.text:0040667F		       cmp     byte ptr	[esi], 5Ch
.text:00406682		       jz      short loc_40667D
.text:00406684		       cmp     byte ptr	[esi], 22h
.text:00406687		       jnz     short loc_4066AF
.text:00406689		       test    cl, 1
.text:0040668C		       jnz     short loc_4066AD
.text:0040668E		       cmp     [ebp+inquote], 0
.text:00406692		       jz      short loc_4066A0
.text:00406694		       lea     eax, [esi+1]
.text:00406697		       cmp     byte ptr	[eax], 22h
.text:0040669A		       jnz     short loc_4066A0
.text:0040669C		       mov     esi, eax
.text:0040669E		       jmp     short loc_4066AD
.text:004066A0 ; ---------------------------------------------------------------------------
.text:004066A0
.text:004066A0 loc_4066A0:			       ; CODE XREF: parse_cmdline+E5j
.text:004066A0					       ; parse_cmdline+EDj
.text:004066A0		       xor     eax, eax
.text:004066A2		       xor     ebx, ebx
.text:004066A4		       cmp     [ebp+inquote], eax
.text:004066A7		       setz    al
.text:004066AA		       mov     [ebp+inquote], eax
.text:004066AD
.text:004066AD loc_4066AD:			       ; CODE XREF: parse_cmdline+DFj
.text:004066AD					       ; parse_cmdline+F1j
.text:004066AD		       shr     ecx, 1
.text:004066AF
.text:004066AF loc_4066AF:			       ; CODE XREF: parse_cmdline+DAj
.text:004066AF		       test    ecx, ecx
.text:004066B1		       jz      short loc_4066C5
.text:004066B3
.text:004066B3 loc_4066B3:			       ; CODE XREF: parse_cmdline+113j
.text:004066B3		       dec     ecx
.text:004066B4		       test    cmdstart, cmdstart
.text:004066B6		       jz      short loc_4066BC
.text:004066B8		       mov     byte ptr	[cmdstart], 5Ch
.text:004066BB		       inc     cmdstart
.text:004066BC
.text:004066BC loc_4066BC:			       ; CODE XREF: parse_cmdline+109j
.text:004066BC		       inc     dword ptr [numchars]
.text:004066BE		       test    ecx, ecx
.text:004066C0		       jnz     short loc_4066B3
.text:004066C2		       mov     [ebp+args], cmdstart
.text:004066C5
.text:004066C5 loc_4066C5:			       ; CODE XREF: parse_cmdline+104j
.text:004066C5		       mov     al, [esi]
.text:004066C7		       test    al, al
.text:004066C9		       jz      short loc_406720
.text:004066CB		       cmp     [ebp+inquote], 0
.text:004066CF		       jnz     short loc_4066D9
.text:004066D1		       cmp     al, 20h
.text:004066D3		       jz      short loc_406720
.text:004066D5		       cmp     al, 9
.text:004066D7		       jz      short loc_406720
.text:004066D9
.text:004066D9 loc_4066D9:			       ; CODE XREF: parse_cmdline+122j
.text:004066D9		       test    ebx, ebx
.text:004066DB		       jz      short loc_40671A
.text:004066DD		       test    cmdstart, cmdstart
.text:004066DF		       movsx   eax, al
.text:004066E2		       push    eax	       ; tst
.text:004066E3		       jz      short loc_406708
.text:004066E5		       call    __ismbblead
.text:004066EA		       test    eax, eax
.text:004066EC		       pop     ecx
.text:004066ED		       jz      short loc_4066FC
.text:004066EF		       mov     al, [esi]
.text:004066F1		       mov     ecx, [ebp+args]
.text:004066F4		       inc     [ebp+args]
.text:004066F7		       mov     [ecx], al
.text:004066F9		       inc     esi
.text:004066FA		       inc     dword ptr [numchars]
.text:004066FC
.text:004066FC loc_4066FC:			       ; CODE XREF: parse_cmdline+140j
.text:004066FC		       mov     ecx, [ebp+args]
.text:004066FF		       mov     al, [esi]
.text:00406701		       inc     [ebp+args]
.text:00406704		       mov     [ecx], al
.text:00406706		       jmp     short loc_406715
.text:00406708 ; ---------------------------------------------------------------------------
.text:00406708
.text:00406708 loc_406708:			       ; CODE XREF: parse_cmdline+136j
.text:00406708		       call    __ismbblead
.text:0040670D		       test    eax, eax
.text:0040670F		       pop     ecx
.text:00406710		       jz      short loc_406715
.text:00406712		       inc     esi
.text:00406713		       inc     dword ptr [numchars]
.text:00406715
.text:00406715 loc_406715:			       ; CODE XREF: parse_cmdline+159j
.text:00406715					       ; parse_cmdline+163j
.text:00406715		       inc     dword ptr [numchars]
.text:00406717		       mov     cmdstart, [ebp+args]
.text:0040671A
.text:0040671A loc_40671A:			       ; CODE XREF: parse_cmdline+12Ej
.text:0040671A		       inc     esi
.text:0040671B		       jmp     loc_406676
.text:00406720 ; ---------------------------------------------------------------------------
.text:00406720
.text:00406720 loc_406720:			       ; CODE XREF: parse_cmdline+11Cj
.text:00406720					       ; parse_cmdline+126j ...
.text:00406720		       test    cmdstart, cmdstart
.text:00406722		       jz      short loc_40672B
.text:00406724		       mov     byte ptr	[cmdstart], 0
.text:00406727		       inc     cmdstart
.text:00406728		       mov     [ebp+args], cmdstart
.text:0040672B
.text:0040672B loc_40672B:			       ; CODE XREF: parse_cmdline+175j
.text:0040672B		       inc     dword ptr [numchars]
.text:0040672D		       mov     ecx, [ebp+numargs]
.text:00406730		       jmp     loc_406643
.text:00406735 ; ---------------------------------------------------------------------------
.text:00406735
.text:00406735 loc_406735:			       ; CODE XREF: parse_cmdline+99j
.text:00406735					       ; parse_cmdline+B2j
.text:00406735		       mov     eax, [ebp+argv]
.text:00406738		       test    eax, eax
.text:0040673A		       pop     esi
.text:0040673B		       pop     ebx
.text:0040673C		       jz      short loc_406741
.text:0040673E		       and     dword ptr [eax],	0
.text:00406741
.text:00406741 loc_406741:			       ; CODE XREF: parse_cmdline+18Fj
.text:00406741		       inc     dword ptr [ecx]
.text:00406743		       leave
.text:00406744		       retn
.text:00406744 parse_cmdline   endp
.text:00406744
.text:00406745
.text:00406745 ; =============== S U B R O U T I N E =======================================
.text:00406745
.text:00406745 ; Attributes: bp-based frame
.text:00406745
.text:00406745 ; int __cdecl _setargv()
.text:00406745 __setargv       proc near	       ; CODE XREF: __tmainCRTStartup+10Ep
.text:00406745
.text:00406745 numchars	       = dword ptr -0Ch
.text:00406745 numargs	       = dword ptr -8
.text:00406745 cmdstart	       = dword ptr -4
.text:00406745
.text:00406745		       push    ebp
.text:00406746		       mov     ebp, esp
.text:00406748		       sub     esp, 0Ch
.text:0040674B		       push    ebx
.text:0040674C		       xor     ebx, ebx
.text:0040674E		       cmp     ___mbctype_initialized, ebx
.text:00406754		       push    esi
.text:00406755		       push    edi
.text:00406756		       jnz     short loc_40675D
.text:00406758		       call    ___initmbctable
.text:0040675D
.text:0040675D loc_40675D:			       ; CODE XREF: __setargv+11j
.text:0040675D		       push    104h	       ; nSize
.text:00406762		       mov     esi, offset _pgmname
.text:00406767		       push    esi	       ; lpFilename
.text:00406768		       push    ebx	       ; hModule
.text:00406769		       mov     _pgmname+104h, bl
.text:0040676F		       call    ds:__imp__GetModuleFileNameA@12 ; GetModuleFileNameA(x,x,x)
.text:00406775		       mov     eax, __acmdln
.text:0040677A		       cmp     eax, ebx
.text:0040677C		       mov     __pgmptr, esi
.text:00406782		       jz      short loc_40678B
.text:00406784		       cmp     [eax], bl
.text:00406786		       mov     [ebp+cmdstart], eax
.text:00406789		       jnz     short loc_40678E
.text:0040678B
.text:0040678B loc_40678B:			       ; CODE XREF: __setargv+3Dj
.text:0040678B		       mov     [ebp+cmdstart], esi
.text:0040678E
.text:0040678E loc_40678E:			       ; CODE XREF: __setargv+44j
.text:0040678E		       mov     edx, [ebp+cmdstart] ; cmdstart
.text:00406791		       lea     eax, [ebp+numargs]
.text:00406794		       push    eax	       ; numargs
.text:00406795		       push    ebx	       ; args
.text:00406796		       push    ebx	       ; argv
.text:00406797		       lea     edi, [ebp+numchars] ; numchars
.text:0040679A		       call    parse_cmdline
.text:0040679F		       mov     eax, [ebp+numargs]
.text:004067A2		       add     esp, 0Ch
.text:004067A5		       cmp     eax, 3FFFFFFFh
.text:004067AA		       jnb     short loc_4067F6
.text:004067AC		       mov     ecx, [ebp+numchars]
.text:004067AF		       cmp     ecx, 0FFFFFFFFh
.text:004067B2		       jnb     short loc_4067F6
.text:004067B4		       mov     edi, eax
.text:004067B6		       shl     edi, 2
.text:004067B9		       lea     eax, [edi+ecx]
.text:004067BC		       cmp     eax, ecx
.text:004067BE		       jb      short loc_4067F6
.text:004067C0		       push    eax	       ; cb
.text:004067C1		       call    __malloc_crt
.text:004067C6		       mov     esi, eax
.text:004067C8		       cmp     esi, ebx
.text:004067CA		       pop     ecx
.text:004067CB		       jz      short loc_4067F6
.text:004067CD		       mov     edx, [ebp+cmdstart] ; cmdstart
.text:004067D0		       lea     eax, [ebp+numargs]
.text:004067D3		       push    eax	       ; numargs
.text:004067D4		       add     edi, esi
.text:004067D6		       push    edi	       ; args
.text:004067D7		       push    esi	       ; argv
.text:004067D8		       lea     edi, [ebp+numchars] ; numchars
.text:004067DB		       call    parse_cmdline
.text:004067E0		       mov     eax, [ebp+numargs]
.text:004067E3		       add     esp, 0Ch
.text:004067E6		       dec     eax
.text:004067E7		       mov     ___argc,	eax
.text:004067EC		       mov     ___argv,	esi
.text:004067F2		       xor     eax, eax
.text:004067F4		       jmp     short loc_4067F9
.text:004067F6 ; ---------------------------------------------------------------------------
.text:004067F6
.text:004067F6 loc_4067F6:			       ; CODE XREF: __setargv+65j
.text:004067F6					       ; __setargv+6Dj	...
.text:004067F6		       or      eax, 0FFFFFFFFh
.text:004067F9
.text:004067F9 loc_4067F9:			       ; CODE XREF: __setargv+AFj
.text:004067F9		       pop     edi
.text:004067FA		       pop     esi
.text:004067FB		       pop     ebx
.text:004067FC		       leave
.text:004067FD		       retn
.text:004067FD __setargv       endp
.text:004067FD
.text:004067FE
.text:004067FE ; =============== S U B R O U T I N E =======================================
.text:004067FE
.text:004067FE
.text:004067FE ; void *__cdecl __crtGetEnvironmentStringsA()
.text:004067FE ___crtGetEnvironmentStringsA proc near  ; CODE XREF: __tmainCRTStartup+104p
.text:004067FE
.text:004067FE aEnv	       = dword ptr -0Ch
.text:004067FE nSizeW	       = dword ptr -8
.text:004067FE cchWideChar     = dword ptr -4
.text:004067FE
.text:004067FE		       push    ecx
.text:004067FF		       push    ecx
.text:00406800		       mov     eax, f_use
.text:00406805		       push    ebx
.text:00406806		       push    ebp
.text:00406807		       push    esi
.text:00406808		       push    edi
.text:00406809		       mov     edi, ds:__imp__GetEnvironmentStringsW@0 ; GetEnvironmentStringsW()
.text:0040680F		       xor     ebx, ebx
.text:00406811		       xor     esi, esi
.text:00406813		       cmp     eax, ebx
.text:00406815		       push    2
.text:00406817		       pop     ebp
.text:00406818		       jnz     short loc_406847
.text:0040681A		       call    edi ; GetEnvironmentStringsW() ;	GetEnvironmentStringsW()
.text:0040681C		       mov     esi, eax
.text:0040681E		       cmp     esi, ebx
.text:00406820		       jz      short loc_40682E
.text:00406822		       mov     f_use, 1
.text:0040682C		       jmp     short loc_406850
.text:0040682E ; ---------------------------------------------------------------------------
.text:0040682E
.text:0040682E loc_40682E:			       ; CODE XREF: ___crtGetEnvironmentStringsA+22j
.text:0040682E		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00406834		       cmp     eax, 78h
.text:00406837		       jnz     short loc_406842
.text:00406839		       mov     eax, ebp
.text:0040683B		       mov     f_use, eax
.text:00406840		       jmp     short loc_406847
.text:00406842 ; ---------------------------------------------------------------------------
.text:00406842
.text:00406842 loc_406842:			       ; CODE XREF: ___crtGetEnvironmentStringsA+39j
.text:00406842		       mov     eax, f_use
.text:00406847
.text:00406847 loc_406847:			       ; CODE XREF: ___crtGetEnvironmentStringsA+1Aj
.text:00406847					       ; ___crtGetEnvironmentStringsA+42j
.text:00406847		       cmp     eax, 1
.text:0040684A		       jnz     loc_4068D4
.text:00406850
.text:00406850 loc_406850:			       ; CODE XREF: ___crtGetEnvironmentStringsA+2Ej
.text:00406850		       cmp     esi, ebx
.text:00406852		       jnz     short loc_406863
.text:00406854		       call    edi ; GetEnvironmentStringsW() ;	GetEnvironmentStringsW()
.text:00406856		       mov     esi, eax
.text:00406858		       cmp     esi, ebx
.text:0040685A		       jnz     short loc_406863
.text:0040685C
.text:0040685C loc_40685C:			       ; CODE XREF: ___crtGetEnvironmentStringsA+DCj
.text:0040685C					       ; ___crtGetEnvironmentStringsA+E8j ...
.text:0040685C		       xor     eax, eax
.text:0040685E		       jmp     loc_40692C
.text:00406863 ; ---------------------------------------------------------------------------
.text:00406863
.text:00406863 loc_406863:			       ; CODE XREF: ___crtGetEnvironmentStringsA+54j
.text:00406863					       ; ___crtGetEnvironmentStringsA+5Cj
.text:00406863		       cmp     [esi], bx
.text:00406866		       mov     eax, esi
.text:00406868		       jz      short loc_406878
.text:0040686A
.text:0040686A loc_40686A:			       ; CODE XREF: ___crtGetEnvironmentStringsA+71j
.text:0040686A					       ; ___crtGetEnvironmentStringsA+78j
.text:0040686A		       add     eax, ebp
.text:0040686C		       cmp     [eax], bx
.text:0040686F		       jnz     short loc_40686A
.text:00406871		       add     eax, ebp
.text:00406873		       cmp     [eax], bx
.text:00406876		       jnz     short loc_40686A
.text:00406878
.text:00406878 loc_406878:			       ; CODE XREF: ___crtGetEnvironmentStringsA+6Aj
.text:00406878		       mov     edi, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040687E		       push    ebx	       ; lpUsedDefaultChar
.text:0040687F		       push    ebx	       ; lpDefaultChar
.text:00406880		       push    ebx	       ; cbMultiByte
.text:00406881		       sub     eax, esi
.text:00406883		       push    ebx	       ; lpMultiByteStr
.text:00406884		       sar     eax, 1
.text:00406886		       inc     eax
.text:00406887		       push    eax	       ; cchWideChar
.text:00406888		       push    esi	       ; lpWideCharStr
.text:00406889		       push    ebx	       ; dwFlags
.text:0040688A		       push    ebx	       ; CodePage
.text:0040688B		       mov     [esp+38h+cchWideChar], eax
.text:0040688F		       call    edi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00406891		       mov     ebp, eax
.text:00406893		       cmp     ebp, ebx
.text:00406895		       jz      short loc_4068C9
.text:00406897		       push    ebp	       ; cb
.text:00406898		       call    __malloc_crt
.text:0040689D		       cmp     eax, ebx
.text:0040689F		       pop     ecx
.text:004068A0		       mov     [esp+18h+nSizeW], eax
.text:004068A4		       jz      short loc_4068C9
.text:004068A6		       push    ebx	       ; lpUsedDefaultChar
.text:004068A7		       push    ebx	       ; lpDefaultChar
.text:004068A8		       push    ebp	       ; cbMultiByte
.text:004068A9		       push    eax	       ; lpMultiByteStr
.text:004068AA		       push    [esp+28h+cchWideChar] ; cchWideChar
.text:004068AE		       push    esi	       ; lpWideCharStr
.text:004068AF		       push    ebx	       ; dwFlags
.text:004068B0		       push    ebx	       ; CodePage
.text:004068B1		       call    edi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:004068B3		       test    eax, eax
.text:004068B5		       jnz     short loc_4068C5
.text:004068B7		       push    [esp+18h+nSizeW]	; pBlock
.text:004068BB		       call    _free
.text:004068C0		       pop     ecx
.text:004068C1		       mov     [esp+18h+nSizeW], ebx
.text:004068C5
.text:004068C5 loc_4068C5:			       ; CODE XREF: ___crtGetEnvironmentStringsA+B7j
.text:004068C5		       mov     ebx, [esp+18h+nSizeW]
.text:004068C9
.text:004068C9 loc_4068C9:			       ; CODE XREF: ___crtGetEnvironmentStringsA+97j
.text:004068C9					       ; ___crtGetEnvironmentStringsA+A6j
.text:004068C9		       push    esi	       ; LPWCH
.text:004068CA		       call    ds:__imp__FreeEnvironmentStringsW@4 ; FreeEnvironmentStringsW(x)
.text:004068D0		       mov     eax, ebx
.text:004068D2		       jmp     short loc_40692C
.text:004068D4 ; ---------------------------------------------------------------------------
.text:004068D4
.text:004068D4 loc_4068D4:			       ; CODE XREF: ___crtGetEnvironmentStringsA+4Cj
.text:004068D4		       cmp     eax, ebp
.text:004068D6		       jz      short loc_4068DC
.text:004068D8		       cmp     eax, ebx
.text:004068DA		       jnz     short loc_40685C
.text:004068DC
.text:004068DC loc_4068DC:			       ; CODE XREF: ___crtGetEnvironmentStringsA+D8j
.text:004068DC		       call    ds:__imp__GetEnvironmentStrings@0 ; GetEnvironmentStrings()
.text:004068E2		       mov     esi, eax
.text:004068E4		       cmp     esi, ebx
.text:004068E6		       jz      loc_40685C
.text:004068EC		       cmp     [esi], bl
.text:004068EE		       jz      short loc_4068FA
.text:004068F0
.text:004068F0 loc_4068F0:			       ; CODE XREF: ___crtGetEnvironmentStringsA+F5j
.text:004068F0					       ; ___crtGetEnvironmentStringsA+FAj
.text:004068F0		       inc     eax
.text:004068F1		       cmp     [eax], bl
.text:004068F3		       jnz     short loc_4068F0
.text:004068F5		       inc     eax
.text:004068F6		       cmp     [eax], bl
.text:004068F8		       jnz     short loc_4068F0
.text:004068FA
.text:004068FA loc_4068FA:			       ; CODE XREF: ___crtGetEnvironmentStringsA+F0j
.text:004068FA		       sub     eax, esi
.text:004068FC		       inc     eax
.text:004068FD		       mov     ebp, eax
.text:004068FF		       push    ebp	       ; cb
.text:00406900		       call    __malloc_crt
.text:00406905		       mov     edi, eax
.text:00406907		       cmp     edi, ebx
.text:00406909		       pop     ecx
.text:0040690A		       jnz     short loc_406918
.text:0040690C		       push    esi	       ; LPCH
.text:0040690D		       call    ds:__imp__FreeEnvironmentStringsA@4 ; FreeEnvironmentStringsA(x)
.text:00406913		       jmp     loc_40685C
.text:00406918 ; ---------------------------------------------------------------------------
.text:00406918
.text:00406918 loc_406918:			       ; CODE XREF: ___crtGetEnvironmentStringsA+10Cj
.text:00406918		       push    ebp	       ; count
.text:00406919		       push    esi	       ; src
.text:0040691A		       push    edi	       ; dst
.text:0040691B		       call    _memcpy
.text:00406920		       add     esp, 0Ch
.text:00406923		       push    esi	       ; LPCH
.text:00406924		       call    ds:__imp__FreeEnvironmentStringsA@4 ; FreeEnvironmentStringsA(x)
.text:0040692A		       mov     eax, edi
.text:0040692C
.text:0040692C loc_40692C:			       ; CODE XREF: ___crtGetEnvironmentStringsA+60j
.text:0040692C					       ; ___crtGetEnvironmentStringsA+D4j
.text:0040692C		       pop     edi
.text:0040692D		       pop     esi
.text:0040692E		       pop     ebp
.text:0040692F		       pop     ebx
.text:00406930		       pop     ecx
.text:00406931		       pop     ecx
.text:00406932		       retn
.text:00406932 ___crtGetEnvironmentStringsA endp
.text:00406932
.text:00406933
.text:00406933 ; =============== S U B R O U T I N E =======================================
.text:00406933
.text:00406933 ; Attributes: bp-based frame
.text:00406933
.text:00406933 ___security_init_cookie proc near       ; CODE XREF: _mainCRTStartupp
.text:00406933
.text:00406933 perfctr	       = _LARGE_INTEGER	ptr -10h
.text:00406933 systime	       = FT ptr	-8
.text:00406933
.text:00406933		       push    ebp
.text:00406934		       mov     ebp, esp
.text:00406936		       sub     esp, 10h
.text:00406939		       mov     eax, ___security_cookie
.text:0040693E		       and     dword ptr [ebp+systime],	0
.text:00406942		       and     dword ptr [ebp+systime+4], 0
.text:00406946		       push    ebx
.text:00406947		       push    edi
.text:00406948		       mov     edi, 0BB40E64Eh
.text:0040694D		       cmp     eax, edi
.text:0040694F		       mov     ebx, 0FFFF0000h
.text:00406954		       jz      short loc_406963
.text:00406956		       test    ebx, eax
.text:00406958		       jz      short loc_406963
.text:0040695A		       not     eax
.text:0040695C		       mov     ___security_cookie_complement, eax
.text:00406961		       jmp     short loc_4069C3
.text:00406963 ; ---------------------------------------------------------------------------
.text:00406963
.text:00406963 loc_406963:			       ; CODE XREF: ___security_init_cookie+21j
.text:00406963					       ; ___security_init_cookie+25j
.text:00406963		       push    esi
.text:00406964		       lea     eax, [ebp+systime]
.text:00406967		       push    eax	       ; lpSystemTimeAsFileTime
.text:00406968		       call    ds:__imp__GetSystemTimeAsFileTime@4 ; GetSystemTimeAsFileTime(x)
.text:0040696E		       mov     esi, dword ptr [ebp+systime+4]
.text:00406971		       xor     esi, dword ptr [ebp+systime]
.text:00406974		       call    ds:__imp__GetCurrentProcessId@0 ; GetCurrentProcessId()
.text:0040697A		       xor     esi, eax
.text:0040697C		       call    ds:__imp__GetCurrentThreadId@0 ;	GetCurrentThreadId()
.text:00406982		       xor     esi, eax
.text:00406984		       call    ds:__imp__GetTickCount@0	; GetTickCount()
.text:0040698A		       xor     esi, eax
.text:0040698C		       lea     eax, [ebp+perfctr]
.text:0040698F		       push    eax	       ; lpPerformanceCount
.text:00406990		       call    ds:__imp__QueryPerformanceCounter@4 ; QueryPerformanceCounter(x)
.text:00406996		       mov     eax, dword ptr [ebp+perfctr+4]
.text:00406999		       xor     eax, dword ptr [ebp+perfctr]
.text:0040699C		       xor     esi, eax
.text:0040699E		       cmp     esi, edi
.text:004069A0		       jnz     short loc_4069A9
.text:004069A2		       mov     esi, 0BB40E64Fh
.text:004069A7		       jmp     short loc_4069B4
.text:004069A9 ; ---------------------------------------------------------------------------
.text:004069A9
.text:004069A9 loc_4069A9:			       ; CODE XREF: ___security_init_cookie+6Dj
.text:004069A9		       test    ebx, esi
.text:004069AB		       jnz     short loc_4069B4
.text:004069AD		       mov     eax, esi
.text:004069AF		       shl     eax, 10h
.text:004069B2		       or      esi, eax
.text:004069B4
.text:004069B4 loc_4069B4:			       ; CODE XREF: ___security_init_cookie+74j
.text:004069B4					       ; ___security_init_cookie+78j
.text:004069B4		       mov     ___security_cookie, esi
.text:004069BA		       not     esi
.text:004069BC		       mov     ___security_cookie_complement, esi
.text:004069C2		       pop     esi
.text:004069C3
.text:004069C3 loc_4069C3:			       ; CODE XREF: ___security_init_cookie+2Ej
.text:004069C3		       pop     edi
.text:004069C4		       pop     ebx
.text:004069C5		       leave
.text:004069C6		       retn
.text:004069C6 ___security_init_cookie endp
.text:004069C6
.text:004069C7
.text:004069C7 ; =============== S U B R O U T I N E =======================================
.text:004069C7
.text:004069C7
.text:004069C7 ; int __cdecl _isatty(int fh)
.text:004069C7 __isatty	       proc near	       ; CODE XREF: __stbuf+Cp
.text:004069C7					       ; __flsbuf+91p ...
.text:004069C7
.text:004069C7 fh	       = dword ptr  4
.text:004069C7
.text:004069C7		       mov     eax, [esp+fh]
.text:004069CB		       cmp     eax, 0FFFFFFFEh
.text:004069CE		       jnz     short loc_4069DE
.text:004069D0		       call    __errno
.text:004069D5		       mov     dword ptr [eax],	9
.text:004069DB		       xor     eax, eax
.text:004069DD		       retn
.text:004069DE ; ---------------------------------------------------------------------------
.text:004069DE
.text:004069DE loc_4069DE:			       ; CODE XREF: __isatty+7j
.text:004069DE		       push    esi
.text:004069DF		       xor     esi, esi
.text:004069E1		       cmp     eax, esi
.text:004069E3		       jl      short loc_4069ED
.text:004069E5		       cmp     eax, __nhandle
.text:004069EB		       jb      short loc_406A09
.text:004069ED
.text:004069ED loc_4069ED:			       ; CODE XREF: __isatty+1Cj
.text:004069ED		       call    __errno
.text:004069F2		       push    esi	       ; pReserved
.text:004069F3		       push    esi	       ; nLine
.text:004069F4		       push    esi	       ; pszFile
.text:004069F5		       push    esi	       ; pszFunction
.text:004069F6		       push    esi	       ; pszExpression
.text:004069F7		       mov     dword ptr [eax],	9
.text:004069FD		       call    __invalid_parameter
.text:00406A02		       add     esp, 14h
.text:00406A05		       xor     eax, eax
.text:00406A07		       pop     esi
.text:00406A08		       retn
.text:00406A09 ; ---------------------------------------------------------------------------
.text:00406A09
.text:00406A09 loc_406A09:			       ; CODE XREF: __isatty+24j
.text:00406A09		       mov     ecx, eax
.text:00406A0B		       and     eax, 1Fh
.text:00406A0E		       sar     ecx, 5
.text:00406A11		       mov     ecx, ___pioinfo[ecx*4]
.text:00406A18		       shl     eax, 6
.text:00406A1B		       movzx   eax, byte ptr [ecx+eax+4]
.text:00406A20		       and     eax, 40h
.text:00406A23		       pop     esi
.text:00406A24		       retn
.text:00406A24 __isatty	       endp
.text:00406A24
.text:00406A25
.text:00406A25 ; =============== S U B R O U T I N E =======================================
.text:00406A25
.text:00406A25
.text:00406A25 ; int __usercall	CPtoLCID<eax>(int codepage<eax>)
.text:00406A25 CPtoLCID	       proc near	       ; CODE XREF: __setmbcp_nolock+14Cp
.text:00406A25					       ; __setmbcp_nolock+1A1p
.text:00406A25 codepage	= eax
.text:00406A25		       sub     codepage, 3A4h
.text:00406A2A		       jz      short loc_406A4E
.text:00406A2C		       sub     codepage, 4
.text:00406A2F		       jz      short loc_406A48
.text:00406A31		       sub     codepage, 0Dh
.text:00406A34		       jz      short loc_406A42
.text:00406A36		       dec     codepage
.text:00406A37		       jz      short loc_406A3C
.text:00406A39		       xor     codepage, codepage
.text:00406A3B		       retn
.text:00406A3C ; ---------------------------------------------------------------------------
.text:00406A3C
.text:00406A3C loc_406A3C:			       ; CODE XREF: CPtoLCID+12j
.text:00406A3C		       mov     codepage, 404h
.text:00406A41		       retn
.text:00406A42 ; ---------------------------------------------------------------------------
.text:00406A42
.text:00406A42 loc_406A42:			       ; CODE XREF: CPtoLCID+Fj
.text:00406A42		       mov     codepage, 412h
.text:00406A47		       retn
.text:00406A48 ; ---------------------------------------------------------------------------
.text:00406A48
.text:00406A48 loc_406A48:			       ; CODE XREF: CPtoLCID+Aj
.text:00406A48		       mov     codepage, 804h
.text:00406A4D		       retn
.text:00406A4E ; ---------------------------------------------------------------------------
.text:00406A4E
.text:00406A4E loc_406A4E:			       ; CODE XREF: CPtoLCID+5j
.text:00406A4E		       mov     codepage, 411h
.text:00406A53		       retn
.text:00406A53 CPtoLCID	       endp
.text:00406A53
.text:00406A54
.text:00406A54 ; =============== S U B R O U T I N E =======================================
.text:00406A54
.text:00406A54
.text:00406A54 ; void __usercall setSBCS(threadmbcinfostruct *ptmbci<eax>)
.text:00406A54 setSBCS	       proc near	       ; CODE XREF: __setmbcp_nolock+2Bp
.text:00406A54 ptmbci =	eax
.text:00406A54		       push    ebx
.text:00406A55		       push    ebp
.text:00406A56		       push    esi
.text:00406A57		       push    edi
.text:00406A58		       mov     ebp, 101h
.text:00406A5D		       mov     esi, ptmbci
.text:00406A5F		       push    ebp
.text:00406A60		       xor     edi, edi
.text:00406A62		       lea     ebx, [esi+1Ch]
.text:00406A65		       push    edi	       ; value
.text:00406A66		       push    ebx	       ; dst
.text:00406A67		       call    _memset
.text:00406A6C		       mov     [esi+4],	edi
.text:00406A6F		       mov     [esi+8],	edi
.text:00406A72		       mov     [esi+0Ch], edi
.text:00406A75		       xor     ptmbci, ptmbci
.text:00406A77		       lea     edi, [esi+10h]
.text:00406A7A		       stosd
.text:00406A7B		       stosd
.text:00406A7C		       stosd
.text:00406A7D		       mov     ptmbci, offset ___initialmbcinfo
.text:00406A82		       add     esp, 0Ch
.text:00406A85		       sub     ptmbci, esi
.text:00406A87
.text:00406A87 loc_406A87:			       ; CODE XREF: setSBCS+3Aj
.text:00406A87		       mov     cl, [ptmbci+ebx]
.text:00406A8A		       mov     [ebx], cl
.text:00406A8C		       inc     ebx
.text:00406A8D		       dec     ebp
.text:00406A8E		       jnz     short loc_406A87
.text:00406A90		       lea     ecx, [esi+11Dh]
.text:00406A96		       mov     esi, 100h
.text:00406A9B
.text:00406A9B loc_406A9B:			       ; CODE XREF: setSBCS+4Ej
.text:00406A9B		       mov     dl, [ecx+ptmbci]
.text:00406A9E		       mov     [ecx], dl
.text:00406AA0		       inc     ecx
.text:00406AA1		       dec     esi
.text:00406AA2		       jnz     short loc_406A9B
.text:00406AA4		       pop     edi
.text:00406AA5		       pop     esi
.text:00406AA6		       pop     ebp
.text:00406AA7		       pop     ebx
.text:00406AA8		       retn
.text:00406AA8 setSBCS	       endp
.text:00406AA8
.text:00406AA9
.text:00406AA9 ; =============== S U B R O U T I N E =======================================
.text:00406AA9
.text:00406AA9 ; Attributes: bp-based frame fpd=49Ch
.text:00406AA9
.text:00406AA9 ; void __usercall setSBUpLow(threadmbcinfostruct	*ptmbci<esi>)
.text:00406AA9 setSBUpLow      proc near	       ; CODE XREF: __setmbcp_nolock+16Fp
.text:00406AA9
.text:00406AA9 var_51C	       = dword ptr -51Ch
.text:00406AA9 cpinfo	       = _cpinfo ptr -518h
.text:00406AA9 wVector	       = word ptr -504h
.text:00406AA9 upVector	       = byte ptr -304h
.text:00406AA9 lowVector       = byte ptr -204h
.text:00406AA9 sbVector	       = byte ptr -104h
.text:00406AA9 var_4	       = dword ptr -4
.text:00406AA9
.text:00406AA9 ptmbci =	esi
.text:00406AA9		       push    ebp
.text:00406AAA		       lea     ebp, [esp-49Ch]
.text:00406AB1		       sub     esp, 51Ch
.text:00406AB7		       mov     eax, ___security_cookie
.text:00406ABC		       xor     eax, ebp
.text:00406ABE		       mov     [ebp+49Ch+var_4], eax
.text:00406AC4		       push    ebx
.text:00406AC5		       push    edi
.text:00406AC6		       lea     eax, [ebp+49Ch+cpinfo]
.text:00406AC9		       push    eax	       ; lpCPInfo
.text:00406ACA		       push    dword ptr [ptmbci+4] ; CodePage
.text:00406ACD		       call    ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:00406AD3		       test    eax, eax
.text:00406AD5		       mov     edi, 100h
.text:00406ADA		       jz      loc_406BCF
.text:00406AE0		       xor     eax, eax
.text:00406AE2
.text:00406AE2 loc_406AE2:			       ; CODE XREF: setSBUpLow+43j
.text:00406AE2		       mov     [ebp+eax+49Ch+sbVector],	al
.text:00406AE9		       inc     eax
.text:00406AEA		       cmp     eax, edi
.text:00406AEC		       jb      short loc_406AE2
.text:00406AEE		       mov     al, [ebp+49Ch+cpinfo.LeadByte]
.text:00406AF1		       test    al, al
.text:00406AF3		       mov     [ebp+49Ch+sbVector], 20h
.text:00406AFA		       jz      short loc_406B27
.text:00406AFC		       lea     ebx, [ebp+49Ch+cpinfo.LeadByte+1]
.text:00406AFF
.text:00406AFF loc_406AFF:			       ; CODE XREF: setSBUpLow+7Cj
.text:00406AFF		       movzx   ecx, al
.text:00406B02		       movzx   eax, byte ptr [ebx]
.text:00406B05		       cmp     ecx, eax
.text:00406B07		       ja      short loc_406B1F
.text:00406B09		       sub     eax, ecx
.text:00406B0B		       inc     eax
.text:00406B0C		       push    eax	       ; count
.text:00406B0D		       lea     edx, [ebp+ecx+49Ch+sbVector]
.text:00406B14		       push    20h	       ; value
.text:00406B16		       push    edx	       ; dst
.text:00406B17		       call    _memset
.text:00406B1C		       add     esp, 0Ch
.text:00406B1F
.text:00406B1F loc_406B1F:			       ; CODE XREF: setSBUpLow+5Ej
.text:00406B1F		       inc     ebx
.text:00406B20		       mov     al, [ebx]
.text:00406B22		       inc     ebx
.text:00406B23		       test    al, al
.text:00406B25		       jnz     short loc_406AFF
.text:00406B27
.text:00406B27 loc_406B27:			       ; CODE XREF: setSBUpLow+51j
.text:00406B27		       push    0	       ; bError
.text:00406B29		       push    dword ptr [ptmbci+0Ch] ;	lcid
.text:00406B2C		       lea     eax, [ebp+49Ch+wVector]
.text:00406B2F		       push    dword ptr [ptmbci+4] ; code_page
.text:00406B32		       push    eax	       ; lpCharType
.text:00406B33		       push    edi	       ; cchSrc
.text:00406B34		       lea     eax, [ebp+49Ch+sbVector]
.text:00406B3A		       push    eax	       ; lpSrcStr
.text:00406B3B		       push    1	       ; dwInfoType
.text:00406B3D		       push    0	       ; plocinfo
.text:00406B3F		       call    ___crtGetStringTypeA
.text:00406B44		       xor     ebx, ebx
.text:00406B46		       push    ebx	       ; bError
.text:00406B47		       push    dword ptr [ptmbci+4] ; code_page
.text:00406B4A		       lea     eax, [ebp+49Ch+lowVector]
.text:00406B50		       push    edi	       ; cchDest
.text:00406B51		       push    eax	       ; lpDestStr
.text:00406B52		       push    edi	       ; cchSrc
.text:00406B53		       lea     eax, [ebp+49Ch+sbVector]
.text:00406B59		       push    eax	       ; lpSrcStr
.text:00406B5A		       push    edi	       ; dwMapFlags
.text:00406B5B		       push    dword ptr [ptmbci+0Ch] ;	Locale
.text:00406B5E		       push    ebx	       ; plocinfo
.text:00406B5F		       call    ___crtLCMapStringA
.text:00406B64		       add     esp, 44h
.text:00406B67		       push    ebx	       ; bError
.text:00406B68		       push    dword ptr [ptmbci+4] ; code_page
.text:00406B6B		       lea     eax, [ebp+49Ch+upVector]
.text:00406B71		       push    edi	       ; cchDest
.text:00406B72		       push    eax	       ; lpDestStr
.text:00406B73		       push    edi	       ; cchSrc
.text:00406B74		       lea     eax, [ebp+49Ch+sbVector]
.text:00406B7A		       push    eax	       ; lpSrcStr
.text:00406B7B		       push    200h	       ; dwMapFlags
.text:00406B80		       push    dword ptr [ptmbci+0Ch] ;	Locale
.text:00406B83		       push    ebx	       ; plocinfo
.text:00406B84		       call    ___crtLCMapStringA
.text:00406B89		       add     esp, 24h
.text:00406B8C		       xor     eax, eax
.text:00406B8E
.text:00406B8E loc_406B8E:			       ; CODE XREF: setSBUpLow+122j
.text:00406B8E		       movzx   ecx, [ebp+eax*2+49Ch+wVector]
.text:00406B93		       test    cl, 1
.text:00406B96		       jz      short loc_406BA6
.text:00406B98		       or      byte ptr	[ptmbci+eax+1Dh], 10h
.text:00406B9D		       mov     cl, [ebp+eax+49Ch+lowVector]
.text:00406BA4		       jmp     short loc_406BB7
.text:00406BA6 ; ---------------------------------------------------------------------------
.text:00406BA6
.text:00406BA6 loc_406BA6:			       ; CODE XREF: setSBUpLow+EDj
.text:00406BA6		       test    cl, 2
.text:00406BA9		       jz      short loc_406BC0
.text:00406BAB		       or      byte ptr	[ptmbci+eax+1Dh], 20h
.text:00406BB0		       mov     cl, [ebp+eax+49Ch+upVector]
.text:00406BB7
.text:00406BB7 loc_406BB7:			       ; CODE XREF: setSBUpLow+FBj
.text:00406BB7		       mov     [ptmbci+eax+11Dh], cl
.text:00406BBE		       jmp     short loc_406BC8
.text:00406BC0 ; ---------------------------------------------------------------------------
.text:00406BC0
.text:00406BC0 loc_406BC0:			       ; CODE XREF: setSBUpLow+100j
.text:00406BC0		       mov     byte ptr	[ptmbci+eax+11Dh], 0
.text:00406BC8
.text:00406BC8 loc_406BC8:			       ; CODE XREF: setSBUpLow+115j
.text:00406BC8		       inc     eax
.text:00406BC9		       cmp     eax, edi
.text:00406BCB		       jb      short loc_406B8E
.text:00406BCD		       jmp     short loc_406C1C
.text:00406BCF ; ---------------------------------------------------------------------------
.text:00406BCF
.text:00406BCF loc_406BCF:			       ; CODE XREF: setSBUpLow+31j
.text:00406BCF		       lea     eax, [ptmbci+11Dh]
.text:00406BD5		       mov     [ebp+49Ch+var_51C], 0FFFFFF9Fh
.text:00406BDC		       xor     ecx, ecx
.text:00406BDE		       sub     [ebp+49Ch+var_51C], eax
.text:00406BE1
.text:00406BE1 loc_406BE1:			       ; CODE XREF: setSBUpLow+171j
.text:00406BE1		       mov     edx, [ebp+49Ch+var_51C]
.text:00406BE4		       lea     eax, [ptmbci+ecx+11Dh]
.text:00406BEB		       add     edx, eax
.text:00406BED		       lea     ebx, [edx+20h]
.text:00406BF0		       cmp     ebx, 19h
.text:00406BF3		       ja      short loc_406C01
.text:00406BF5		       or      byte ptr	[ptmbci+ecx+1Dh], 10h
.text:00406BFA		       mov     dl, cl
.text:00406BFC		       add     dl, 20h
.text:00406BFF		       jmp     short loc_406C10
.text:00406C01 ; ---------------------------------------------------------------------------
.text:00406C01
.text:00406C01 loc_406C01:			       ; CODE XREF: setSBUpLow+14Aj
.text:00406C01		       cmp     edx, 19h
.text:00406C04		       ja      short loc_406C14
.text:00406C06		       or      byte ptr	[ptmbci+ecx+1Dh], 20h
.text:00406C0B		       mov     dl, cl
.text:00406C0D		       sub     dl, 20h
.text:00406C10
.text:00406C10 loc_406C10:			       ; CODE XREF: setSBUpLow+156j
.text:00406C10		       mov     [eax], dl
.text:00406C12		       jmp     short loc_406C17
.text:00406C14 ; ---------------------------------------------------------------------------
.text:00406C14
.text:00406C14 loc_406C14:			       ; CODE XREF: setSBUpLow+15Bj
.text:00406C14		       mov     byte ptr	[eax], 0
.text:00406C17
.text:00406C17 loc_406C17:			       ; CODE XREF: setSBUpLow+169j
.text:00406C17		       inc     ecx
.text:00406C18		       cmp     ecx, edi
.text:00406C1A		       jb      short loc_406BE1
.text:00406C1C
.text:00406C1C loc_406C1C:			       ; CODE XREF: setSBUpLow+124j
.text:00406C1C		       mov     ecx, [ebp+49Ch+var_4]
.text:00406C22		       pop     edi
.text:00406C23		       xor     ecx, ebp
.text:00406C25		       pop     ebx
.text:00406C26		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00406C2B		       add     ebp, 49Ch
.text:00406C31		       leave
.text:00406C32		       retn
.text:00406C32 setSBUpLow      endp
.text:00406C32
.text:00406C33
.text:00406C33 ; =============== S U B R O U T I N E =======================================
.text:00406C33
.text:00406C33 ; Attributes: bp-based frame
.text:00406C33
.text:00406C33 ; threadmbcinfostruct *__cdecl __updatetmbcinfo()
.text:00406C33 ___updatetmbcinfo proc near	       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+57p
.text:00406C33					       ; __setmbcp+1Ap	...
.text:00406C33
.text:00406C33 ptmbci	       = dword ptr -1Ch
.text:00406C33 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00406C33
.text:00406C33		       push    0Ch
.text:00406C35		       push    offset dword_420740
.text:00406C3A		       call    __SEH_prolog4
.text:00406C3F		       call    __getptd
.text:00406C44		       mov     edi, eax
.text:00406C46		       mov     eax, ___globallocalestatus
.text:00406C4B		       test    [edi+70h], eax
.text:00406C4E		       jz      short loc_406C6D
.text:00406C50		       cmp     dword ptr [edi+6Ch], 0
.text:00406C54		       jz      short loc_406C6D
.text:00406C56		       mov     esi, [edi+68h]
.text:00406C59
.text:00406C59 $LN14_1:				       ; CODE XREF: ___updatetmbcinfo+96j
.text:00406C59		       test    esi, esi
.text:00406C5B		       jnz     short loc_406C65
.text:00406C5D		       push    20h	       ; rterrnum
.text:00406C5F		       call    __amsg_exit
.text:00406C64		       pop     ecx
.text:00406C65
.text:00406C65 loc_406C65:			       ; CODE XREF: ___updatetmbcinfo+28j
.text:00406C65		       mov     eax, esi
.text:00406C67		       call    __SEH_epilog4
.text:00406C6C		       retn
.text:00406C6D ; ---------------------------------------------------------------------------
.text:00406C6D
.text:00406C6D loc_406C6D:			       ; CODE XREF: ___updatetmbcinfo+1Bj
.text:00406C6D					       ; ___updatetmbcinfo+21j
.text:00406C6D		       push    0Dh	       ; locknum
.text:00406C6F		       call    __lock
.text:00406C74		       pop     ecx
.text:00406C75		       and     [ebp+ms_exc.disabled], 0
.text:00406C79		       mov     esi, [edi+68h]
.text:00406C7C		       mov     [ebp+ptmbci], esi
.text:00406C7F		       cmp     esi, ___ptmbcinfo ; ___ptmbcinfo
.text:00406C85		       jz      short loc_406CBD
.text:00406C87		       test    esi, esi
.text:00406C89		       jz      short loc_406CA5
.text:00406C8B		       push    esi	       ; lpAddend
.text:00406C8C		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:00406C92		       test    eax, eax
.text:00406C94		       jnz     short loc_406CA5
.text:00406C96		       cmp     esi, offset ___initialmbcinfo
.text:00406C9C		       jz      short loc_406CA5
.text:00406C9E		       push    esi	       ; pBlock
.text:00406C9F		       call    _free
.text:00406CA4		       pop     ecx
.text:00406CA5
.text:00406CA5 loc_406CA5:			       ; CODE XREF: ___updatetmbcinfo+56j
.text:00406CA5					       ; ___updatetmbcinfo+61j	...
.text:00406CA5		       mov     eax, ___ptmbcinfo ; ___ptmbcinfo
.text:00406CAA		       mov     [edi+68h], eax
.text:00406CAD		       mov     esi, ___ptmbcinfo ; ___ptmbcinfo
.text:00406CB3		       mov     [ebp+ptmbci], esi
.text:00406CB6		       push    esi	       ; lpAddend
.text:00406CB7		       call    ds:__imp__InterlockedIncrement@4	; InterlockedIncrement(x)
.text:00406CBD
.text:00406CBD loc_406CBD:			       ; CODE XREF: ___updatetmbcinfo+52j
.text:00406CBD		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00406CC4		       call    $LN13_3
.text:00406CC9		       jmp     short $LN14_1
.text:00406CCB ; ---------------------------------------------------------------------------
.text:00406CCB
.text:00406CCB $LN11_3:				       ; DATA XREF: .rdata:00420758o
.text:00406CCB		       mov     esi, [ebp+ptmbci]
.text:00406CCE
.text:00406CCE $LN13_3:				       ; CODE XREF: ___updatetmbcinfo+91p
.text:00406CCE		       push    0Dh	       ; locknum
.text:00406CD0		       call    __unlock
.text:00406CD5		       pop     ecx
.text:00406CD6
.text:00406CD6 $LN12_4:
.text:00406CD6		       retn
.text:00406CD6 ___updatetmbcinfo endp ;	sp-analysis failed
.text:00406CD6
.text:00406CD7
.text:00406CD7 ; =============== S U B R O U T I N E =======================================
.text:00406CD7
.text:00406CD7 ; Attributes: bp-based frame
.text:00406CD7
.text:00406CD7 ; int __usercall	getSystemCP<eax>(int codepage<esi>)
.text:00406CD7 getSystemCP     proc near	       ; CODE XREF: __setmbcp_nolock+19p
.text:00406CD7					       ; __setmbcp+25p
.text:00406CD7
.text:00406CD7 _loc_update     = _LocaleUpdate ptr -10h
.text:00406CD7
.text:00406CD7 codepage	= esi
.text:00406CD7		       push    ebp
.text:00406CD8		       mov     ebp, esp
.text:00406CDA		       sub     esp, 10h
.text:00406CDD		       push    ebx
.text:00406CDE		       xor     ebx, ebx
.text:00406CE0		       push    ebx	       ; plocinfo
.text:00406CE1		       lea     ecx, [ebp+_loc_update] ;	this
.text:00406CE4		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00406CE9		       cmp     codepage, 0FFFFFFFEh
.text:00406CEC		       mov     fSystemSet, ebx
.text:00406CF2		       jnz     short loc_406D12
.text:00406CF4		       mov     fSystemSet, 1
.text:00406CFE		       call    ds:__imp__GetOEMCP@0 ; GetOEMCP()
.text:00406D04
.text:00406D04 loc_406D04:			       ; CODE XREF: getSystemCP+50j
.text:00406D04					       ; getSystemCP+67j
.text:00406D04		       cmp     [ebp+_loc_update.updated], bl
.text:00406D07		       jz      short loc_406D4E
.text:00406D09		       mov     ecx, [ebp+_loc_update.ptd]
.text:00406D0C		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00406D10		       jmp     short loc_406D4E
.text:00406D12 ; ---------------------------------------------------------------------------
.text:00406D12
.text:00406D12 loc_406D12:			       ; CODE XREF: getSystemCP+1Bj
.text:00406D12		       cmp     codepage, 0FFFFFFFDh
.text:00406D15		       jnz     short loc_406D29
.text:00406D17		       mov     fSystemSet, 1
.text:00406D21		       call    ds:__imp__GetACP@0 ; GetACP()
.text:00406D27		       jmp     short loc_406D04
.text:00406D29 ; ---------------------------------------------------------------------------
.text:00406D29
.text:00406D29 loc_406D29:			       ; CODE XREF: getSystemCP+3Ej
.text:00406D29		       cmp     codepage, 0FFFFFFFCh
.text:00406D2C		       jnz     short loc_406D40
.text:00406D2E		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00406D31		       mov     eax, [eax+4]
.text:00406D34		       mov     fSystemSet, 1
.text:00406D3E		       jmp     short loc_406D04
.text:00406D40 ; ---------------------------------------------------------------------------
.text:00406D40
.text:00406D40 loc_406D40:			       ; CODE XREF: getSystemCP+55j
.text:00406D40		       cmp     [ebp+_loc_update.updated], bl
.text:00406D43		       jz      short loc_406D4C
.text:00406D45		       mov     eax, [ebp+_loc_update.ptd]
.text:00406D48		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00406D4C
.text:00406D4C loc_406D4C:			       ; CODE XREF: getSystemCP+6Cj
.text:00406D4C		       mov     eax, codepage
.text:00406D4E
.text:00406D4E loc_406D4E:			       ; CODE XREF: getSystemCP+30j
.text:00406D4E					       ; getSystemCP+39j
.text:00406D4E		       pop     ebx
.text:00406D4F		       leave
.text:00406D50		       retn
.text:00406D50 getSystemCP     endp
.text:00406D50
.text:00406D51
.text:00406D51 ; =============== S U B R O U T I N E =======================================
.text:00406D51
.text:00406D51 ; Attributes: bp-based frame
.text:00406D51
.text:00406D51 ; int __cdecl _setmbcp_nolock(int codepage, threadmbcinfostruct *ptmbci)
.text:00406D51 __setmbcp_nolock	proc near	       ; CODE XREF: __setmbcp+5Ep
.text:00406D51					       ; __create_locale+B4p
.text:00406D51
.text:00406D51 irg	       = dword ptr -20h
.text:00406D51 icp	       = dword ptr -1Ch
.text:00406D51 cpinfo	       = _cpinfo ptr -18h
.text:00406D51 var_4	       = dword ptr -4
.text:00406D51 codepage	       = dword ptr  8
.text:00406D51 ptmbci	       = dword ptr  0Ch
.text:00406D51
.text:00406D51		       push    ebp
.text:00406D52		       mov     ebp, esp
.text:00406D54		       sub     esp, 20h
.text:00406D57		       mov     eax, ___security_cookie
.text:00406D5C		       xor     eax, ebp
.text:00406D5E		       mov     [ebp+var_4], eax
.text:00406D61		       push    ebx
.text:00406D62		       mov     ebx, [ebp+ptmbci]
.text:00406D65		       push    esi
.text:00406D66		       mov     esi, [ebp+codepage] ; codepage
.text:00406D69		       push    edi
.text:00406D6A		       call    getSystemCP
.text:00406D6F		       mov     edi, eax
.text:00406D71		       xor     esi, esi
.text:00406D73		       cmp     edi, esi
.text:00406D75		       mov     [ebp+codepage], edi
.text:00406D78		       jnz     short loc_406D88
.text:00406D7A
.text:00406D7A loc_406D7A:			       ; CODE XREF: __setmbcp_nolock+1C1j
.text:00406D7A		       mov     eax, ebx	       ; ptmbci
.text:00406D7C		       call    setSBCS
.text:00406D81
.text:00406D81 loc_406D81:			       ; CODE XREF: __setmbcp_nolock+174j
.text:00406D81		       xor     eax, eax
.text:00406D83		       jmp     loc_406F1B
.text:00406D88 ; ---------------------------------------------------------------------------
.text:00406D88
.text:00406D88 loc_406D88:			       ; CODE XREF: __setmbcp_nolock+27j
.text:00406D88		       mov     [ebp+icp], esi
.text:00406D8B		       xor     eax, eax
.text:00406D8D
.text:00406D8D loc_406D8D:			       ; CODE XREF: __setmbcp_nolock+53j
.text:00406D8D		       cmp     dword ptr __rgcode_page_info.code_page[eax], edi
.text:00406D93		       jz      loc_406E2A
.text:00406D99		       inc     [ebp+icp]
.text:00406D9C		       add     eax, 30h
.text:00406D9F		       cmp     eax, 0F0h
.text:00406DA4		       jb      short loc_406D8D
.text:00406DA6		       cmp     edi, 0FDE8h
.text:00406DAC		       jz      loc_406F18
.text:00406DB2		       cmp     edi, 0FDE9h
.text:00406DB8		       jz      loc_406F18
.text:00406DBE		       movzx   eax, di
.text:00406DC1		       push    eax	       ; CodePage
.text:00406DC2		       call    ds:__imp__IsValidCodePage@4 ; IsValidCodePage(x)
.text:00406DC8		       test    eax, eax
.text:00406DCA		       jz      loc_406F18
.text:00406DD0		       lea     eax, [ebp+cpinfo]
.text:00406DD3		       push    eax	       ; lpCPInfo
.text:00406DD4		       push    edi	       ; CodePage
.text:00406DD5		       call    ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:00406DDB		       test    eax, eax
.text:00406DDD		       jz      loc_406F0C
.text:00406DE3		       push    101h	       ; count
.text:00406DE8		       lea     eax, [ebx+1Ch]
.text:00406DEB		       push    esi	       ; value
.text:00406DEC		       push    eax	       ; dst
.text:00406DED		       call    _memset
.text:00406DF2		       xor     edx, edx
.text:00406DF4		       inc     edx
.text:00406DF5		       add     esp, 0Ch
.text:00406DF8		       cmp     [ebp+cpinfo.MaxCharSize], edx
.text:00406DFB		       mov     [ebx+4],	edi
.text:00406DFE		       mov     [ebx+0Ch], esi
.text:00406E01		       jbe     loc_406EFF
.text:00406E07		       cmp     [ebp+cpinfo.LeadByte], 0
.text:00406E0B		       jz      loc_406EE0
.text:00406E11		       lea     esi, [ebp+cpinfo.LeadByte+1]
.text:00406E14
.text:00406E14 loc_406E14:			       ; CODE XREF: __setmbcp_nolock+189j
.text:00406E14		       mov     cl, [esi]
.text:00406E16		       test    cl, cl
.text:00406E18		       jz      loc_406EE0
.text:00406E1E		       movzx   eax, byte ptr [esi-1]
.text:00406E22		       movzx   ecx, cl
.text:00406E25		       jmp     loc_406ED0
.text:00406E2A ; ---------------------------------------------------------------------------
.text:00406E2A
.text:00406E2A loc_406E2A:			       ; CODE XREF: __setmbcp_nolock+42j
.text:00406E2A		       push    101h	       ; count
.text:00406E2F		       lea     eax, [ebx+1Ch]
.text:00406E32		       push    esi	       ; value
.text:00406E33		       push    eax	       ; dst
.text:00406E34		       call    _memset
.text:00406E39		       mov     ecx, [ebp+icp]
.text:00406E3C		       add     esp, 0Ch
.text:00406E3F		       imul    ecx, 30h
.text:00406E42		       mov     [ebp+irg], esi
.text:00406E45		       lea     esi, __rgcode_page_info.rgrange[ecx]
.text:00406E4B		       mov     [ebp+icp], esi
.text:00406E4E		       jmp     short loc_406E7A
.text:00406E50 ; ---------------------------------------------------------------------------
.text:00406E50
.text:00406E50 loc_406E50:			       ; CODE XREF: __setmbcp_nolock+12Cj
.text:00406E50		       mov     al, [esi+1]
.text:00406E53		       test    al, al
.text:00406E55		       jz      short loc_406E7F
.text:00406E57		       movzx   edi, byte ptr [esi]
.text:00406E5A		       movzx   eax, al
.text:00406E5D		       jmp     short loc_406E71
.text:00406E5F ; ---------------------------------------------------------------------------
.text:00406E5F
.text:00406E5F loc_406E5F:			       ; CODE XREF: __setmbcp_nolock+122j
.text:00406E5F		       mov     eax, [ebp+irg]
.text:00406E62		       mov     al, __rgctypeflag[eax]
.text:00406E68		       or      [ebx+edi+1Dh], al
.text:00406E6C		       movzx   eax, byte ptr [esi+1]
.text:00406E70		       inc     edi
.text:00406E71
.text:00406E71 loc_406E71:			       ; CODE XREF: __setmbcp_nolock+10Cj
.text:00406E71		       cmp     edi, eax
.text:00406E73		       jbe     short loc_406E5F
.text:00406E75		       mov     edi, [ebp+codepage]
.text:00406E78		       inc     esi
.text:00406E79		       inc     esi
.text:00406E7A
.text:00406E7A loc_406E7A:			       ; CODE XREF: __setmbcp_nolock+FDj
.text:00406E7A					       ; __setmbcp_nolock+13Ej
.text:00406E7A		       cmp     byte ptr	[esi], 0
.text:00406E7D		       jnz     short loc_406E50
.text:00406E7F
.text:00406E7F loc_406E7F:			       ; CODE XREF: __setmbcp_nolock+104j
.text:00406E7F		       mov     esi, [ebp+icp]
.text:00406E82		       inc     [ebp+irg]
.text:00406E85		       add     esi, 8
.text:00406E88		       cmp     [ebp+irg], 4
.text:00406E8C		       mov     [ebp+icp], esi
.text:00406E8F		       jb      short loc_406E7A
.text:00406E91		       mov     eax, edi	       ; codepage
.text:00406E93		       mov     [ebx+4],	edi
.text:00406E96		       mov     dword ptr [ebx+8], 1
.text:00406E9D		       call    CPtoLCID
.text:00406EA2		       push    6
.text:00406EA4		       mov     [ebx+0Ch], eax
.text:00406EA7		       lea     eax, [ebx+10h]
.text:00406EAA		       lea     ecx, __rgcode_page_info.mbulinfo[ecx]
.text:00406EB0		       pop     edx
.text:00406EB1
.text:00406EB1 loc_406EB1:			       ; CODE XREF: __setmbcp_nolock+16Bj
.text:00406EB1		       mov     si, [ecx]
.text:00406EB4		       inc     ecx
.text:00406EB5		       mov     [eax], si
.text:00406EB8		       inc     ecx
.text:00406EB9		       inc     eax
.text:00406EBA		       inc     eax
.text:00406EBB		       dec     edx
.text:00406EBC		       jnz     short loc_406EB1
.text:00406EBE
.text:00406EBE loc_406EBE:			       ; CODE XREF: __setmbcp_nolock+1B9j
.text:00406EBE		       mov     esi, ebx	       ; ptmbci
.text:00406EC0		       call    setSBUpLow
.text:00406EC5		       jmp     loc_406D81
.text:00406ECA ; ---------------------------------------------------------------------------
.text:00406ECA
.text:00406ECA loc_406ECA:			       ; CODE XREF: __setmbcp_nolock+181j
.text:00406ECA		       or      byte ptr	[ebx+eax+1Dh], 4
.text:00406ECF		       inc     eax
.text:00406ED0
.text:00406ED0 loc_406ED0:			       ; CODE XREF: __setmbcp_nolock+D4j
.text:00406ED0		       cmp     eax, ecx
.text:00406ED2		       jbe     short loc_406ECA
.text:00406ED4		       inc     esi
.text:00406ED5		       inc     esi
.text:00406ED6		       cmp     byte ptr	[esi-1], 0
.text:00406EDA		       jnz     loc_406E14
.text:00406EE0
.text:00406EE0 loc_406EE0:			       ; CODE XREF: __setmbcp_nolock+BAj
.text:00406EE0					       ; __setmbcp_nolock+C7j
.text:00406EE0		       lea     eax, [ebx+1Eh]
.text:00406EE3		       mov     ecx, 0FEh
.text:00406EE8
.text:00406EE8 loc_406EE8:			       ; CODE XREF: __setmbcp_nolock+19Cj
.text:00406EE8		       or      byte ptr	[eax], 8
.text:00406EEB		       inc     eax
.text:00406EEC		       dec     ecx
.text:00406EED		       jnz     short loc_406EE8
.text:00406EEF		       mov     eax, [ebx+4]    ; codepage
.text:00406EF2		       call    CPtoLCID
.text:00406EF7		       mov     [ebx+0Ch], eax
.text:00406EFA		       mov     [ebx+8],	edx
.text:00406EFD		       jmp     short loc_406F02
.text:00406EFF ; ---------------------------------------------------------------------------
.text:00406EFF
.text:00406EFF loc_406EFF:			       ; CODE XREF: __setmbcp_nolock+B0j
.text:00406EFF		       mov     [ebx+8],	esi
.text:00406F02
.text:00406F02 loc_406F02:			       ; CODE XREF: __setmbcp_nolock+1ACj
.text:00406F02		       xor     eax, eax
.text:00406F04		       lea     edi, [ebx+10h]
.text:00406F07		       stosd
.text:00406F08		       stosd
.text:00406F09		       stosd
.text:00406F0A		       jmp     short loc_406EBE
.text:00406F0C ; ---------------------------------------------------------------------------
.text:00406F0C
.text:00406F0C loc_406F0C:			       ; CODE XREF: __setmbcp_nolock+8Cj
.text:00406F0C		       cmp     fSystemSet, esi
.text:00406F12		       jnz     loc_406D7A
.text:00406F18
.text:00406F18 loc_406F18:			       ; CODE XREF: __setmbcp_nolock+5Bj
.text:00406F18					       ; __setmbcp_nolock+67j ...
.text:00406F18		       or      eax, 0FFFFFFFFh
.text:00406F1B
.text:00406F1B loc_406F1B:			       ; CODE XREF: __setmbcp_nolock+32j
.text:00406F1B		       mov     ecx, [ebp+var_4]
.text:00406F1E		       pop     edi
.text:00406F1F		       pop     esi
.text:00406F20		       xor     ecx, ebp
.text:00406F22		       pop     ebx
.text:00406F23		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00406F28		       leave
.text:00406F29		       retn
.text:00406F29 __setmbcp_nolock	endp
.text:00406F29
.text:00406F2A
.text:00406F2A ; =============== S U B R O U T I N E =======================================
.text:00406F2A
.text:00406F2A ; Attributes: bp-based frame
.text:00406F2A
.text:00406F2A ; int __cdecl _getmbcp()
.text:00406F2A __getmbcp       proc near
.text:00406F2A
.text:00406F2A _loc_update     = _LocaleUpdate ptr -10h
.text:00406F2A
.text:00406F2A		       push    ebp
.text:00406F2B		       mov     ebp, esp
.text:00406F2D		       sub     esp, 10h
.text:00406F30		       push    0	       ; plocinfo
.text:00406F32		       lea     ecx, [ebp+_loc_update] ;	this
.text:00406F35		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00406F3A		       mov     eax, [ebp+_loc_update.localeinfo.mbcinfo]
.text:00406F3D		       cmp     dword ptr [eax+8], 0
.text:00406F41		       jz      short loc_406F55
.text:00406F43		       cmp     [ebp+_loc_update.updated], 0
.text:00406F47		       mov     eax, [eax+4]
.text:00406F4A		       jz      short locret_406F64
.text:00406F4C		       mov     ecx, [ebp+_loc_update.ptd]
.text:00406F4F		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00406F53		       leave
.text:00406F54		       retn
.text:00406F55 ; ---------------------------------------------------------------------------
.text:00406F55
.text:00406F55 loc_406F55:			       ; CODE XREF: __getmbcp+17j
.text:00406F55		       cmp     [ebp+_loc_update.updated], 0
.text:00406F59		       jz      short loc_406F62
.text:00406F5B		       mov     eax, [ebp+_loc_update.ptd]
.text:00406F5E		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00406F62
.text:00406F62 loc_406F62:			       ; CODE XREF: __getmbcp+2Fj
.text:00406F62		       xor     eax, eax
.text:00406F64
.text:00406F64 locret_406F64:			       ; CODE XREF: __getmbcp+20j
.text:00406F64		       leave
.text:00406F65		       retn
.text:00406F65 __getmbcp       endp
.text:00406F65
.text:00406F66
.text:00406F66 ; =============== S U B R O U T I N E =======================================
.text:00406F66
.text:00406F66 ; Attributes: bp-based frame
.text:00406F66
.text:00406F66 ; int __cdecl _setmbcp(int codepage)
.text:00406F66 __setmbcp       proc near	       ; CODE XREF: ___initmbctable+Bp
.text:00406F66
.text:00406F66 ptd	       = dword ptr -24h
.text:00406F66 retcode	       = dword ptr -20h
.text:00406F66 i	       = dword ptr -1Ch
.text:00406F66 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00406F66 codepage	       = dword ptr  8
.text:00406F66
.text:00406F66		       push    14h
.text:00406F68		       push    offset dword_420760
.text:00406F6D		       call    __SEH_prolog4
.text:00406F72		       or      [ebp+retcode], 0FFFFFFFFh
.text:00406F76		       call    __getptd
.text:00406F7B		       mov     edi, eax
.text:00406F7D		       mov     [ebp+ptd], edi
.text:00406F80		       call    ___updatetmbcinfo
.text:00406F85		       mov     ebx, [edi+68h]
.text:00406F88		       mov     esi, [ebp+codepage] ; codepage
.text:00406F8B		       call    getSystemCP
.text:00406F90		       mov     [ebp+codepage], eax
.text:00406F93		       cmp     eax, [ebx+4]
.text:00406F96		       jz      loc_4070F3
.text:00406F9C		       push    220h	       ; cb
.text:00406FA1		       call    __malloc_crt
.text:00406FA6		       pop     ecx
.text:00406FA7		       mov     ebx, eax
.text:00406FA9		       test    ebx, ebx
.text:00406FAB		       jz      $LN28
.text:00406FB1		       mov     ecx, 88h
.text:00406FB6		       mov     esi, [edi+68h]
.text:00406FB9		       mov     edi, ebx
.text:00406FBB		       rep movsd
.text:00406FBD		       and     dword ptr [ebx],	0
.text:00406FC0		       push    ebx	       ; ptmbci
.text:00406FC1		       push    [ebp+codepage]  ; codepage
.text:00406FC4		       call    __setmbcp_nolock
.text:00406FC9		       pop     ecx
.text:00406FCA		       pop     ecx
.text:00406FCB		       mov     [ebp+retcode], eax
.text:00406FCE		       test    eax, eax
.text:00406FD0		       jnz     loc_4070D2
.text:00406FD6		       mov     esi, [ebp+ptd]
.text:00406FD9		       push    dword ptr [esi+68h] ; lpAddend
.text:00406FDC		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:00406FE2		       test    eax, eax
.text:00406FE4		       jnz     short loc_406FF7
.text:00406FE6		       mov     eax, [esi+68h]
.text:00406FE9		       cmp     eax, offset ___initialmbcinfo
.text:00406FEE		       jz      short loc_406FF7
.text:00406FF0		       push    eax	       ; pBlock
.text:00406FF1		       call    _free
.text:00406FF6		       pop     ecx
.text:00406FF7
.text:00406FF7 loc_406FF7:			       ; CODE XREF: __setmbcp+7Ej
.text:00406FF7					       ; __setmbcp+88j
.text:00406FF7		       mov     [esi+68h], ebx
.text:00406FFA		       push    ebx	       ; lpAddend
.text:00406FFB		       mov     edi, ds:__imp__InterlockedIncrement@4 ; InterlockedIncrement(x)
.text:00407001		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:00407003		       test    byte ptr	[esi+70h], 2
.text:00407007		       jnz     $LN28
.text:0040700D		       test    byte ptr	___globallocalestatus, 1
.text:00407014		       jnz     $LN28
.text:0040701A		       push    0Dh	       ; locknum
.text:0040701C		       call    __lock
.text:00407021		       pop     ecx
.text:00407022		       and     [ebp+ms_exc.disabled], 0
.text:00407026		       mov     eax, [ebx+4]
.text:00407029		       mov     ___mbcodepage, eax
.text:0040702E		       mov     eax, [ebx+8]
.text:00407031		       mov     ___ismbcodepage,	eax
.text:00407036		       mov     eax, [ebx+0Ch]
.text:00407039		       mov     ___mblcid, eax
.text:0040703E		       xor     eax, eax
.text:00407040
.text:00407040 loc_407040:			       ; CODE XREF: __setmbcp+F0j
.text:00407040		       mov     [ebp+i],	eax
.text:00407043		       cmp     eax, 5
.text:00407046		       jge     short loc_407058
.text:00407048		       mov     cx, [ebx+eax*2+10h]
.text:0040704D		       mov     ___mbulinfo[eax*2], cx
.text:00407055		       inc     eax
.text:00407056		       jmp     short loc_407040
.text:00407058 ; ---------------------------------------------------------------------------
.text:00407058
.text:00407058 loc_407058:			       ; CODE XREF: __setmbcp+E0j
.text:00407058		       xor     eax, eax
.text:0040705A
.text:0040705A loc_40705A:			       ; CODE XREF: __setmbcp+109j
.text:0040705A		       mov     [ebp+i],	eax
.text:0040705D		       cmp     eax, 101h
.text:00407062		       jge     short loc_407071
.text:00407064		       mov     cl, [eax+ebx+1Ch]
.text:00407068		       mov     __mbctype[eax], cl
.text:0040706E		       inc     eax
.text:0040706F		       jmp     short loc_40705A
.text:00407071 ; ---------------------------------------------------------------------------
.text:00407071
.text:00407071 loc_407071:			       ; CODE XREF: __setmbcp+FCj
.text:00407071		       xor     eax, eax
.text:00407073
.text:00407073 loc_407073:			       ; CODE XREF: __setmbcp+125j
.text:00407073		       mov     [ebp+i],	eax
.text:00407076		       cmp     eax, 100h
.text:0040707B		       jge     short loc_40708D
.text:0040707D		       mov     cl, [eax+ebx+11Dh]
.text:00407084		       mov     __mbcasemap[eax], cl
.text:0040708A		       inc     eax
.text:0040708B		       jmp     short loc_407073
.text:0040708D ; ---------------------------------------------------------------------------
.text:0040708D
.text:0040708D loc_40708D:			       ; CODE XREF: __setmbcp+115j
.text:0040708D		       push    ___ptmbcinfo    ; lpAddend
.text:00407093		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:00407099		       test    eax, eax
.text:0040709B		       jnz     short loc_4070B0
.text:0040709D		       mov     eax, ___ptmbcinfo ; ___ptmbcinfo
.text:004070A2		       cmp     eax, offset ___initialmbcinfo
.text:004070A7		       jz      short loc_4070B0
.text:004070A9		       push    eax	       ; pBlock
.text:004070AA		       call    _free
.text:004070AF		       pop     ecx
.text:004070B0
.text:004070B0 loc_4070B0:			       ; CODE XREF: __setmbcp+135j
.text:004070B0					       ; __setmbcp+141j
.text:004070B0		       mov     ___ptmbcinfo, ebx ; ___ptmbcinfo
.text:004070B6		       push    ebx	       ; lpAddend
.text:004070B7		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:004070B9		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004070C0		       call    $LN25_0
.text:004070C5		       jmp     short $LN28
.text:004070C7 ; ---------------------------------------------------------------------------
.text:004070C7
.text:004070C7 $LN25_0:				       ; CODE XREF: __setmbcp+15Ap
.text:004070C7					       ; DATA XREF: .rdata:00420778o
.text:004070C7		       push    0Dh	       ; locknum
.text:004070C9		       call    __unlock
.text:004070CE		       pop     ecx
.text:004070CF
.text:004070CF $LN26:
.text:004070CF		       retn
.text:004070D0 ; ---------------------------------------------------------------------------
.text:004070D0		       jmp     short $LN28
.text:004070D2 ; ---------------------------------------------------------------------------
.text:004070D2
.text:004070D2 loc_4070D2:			       ; CODE XREF: __setmbcp+6Aj
.text:004070D2		       cmp     eax, 0FFFFFFFFh
.text:004070D5		       jnz     short $LN28
.text:004070D7		       cmp     ebx, offset ___initialmbcinfo
.text:004070DD		       jz      short loc_4070E6
.text:004070DF		       push    ebx	       ; pBlock
.text:004070E0		       call    _free
.text:004070E5		       pop     ecx
.text:004070E6
.text:004070E6 loc_4070E6:			       ; CODE XREF: __setmbcp+177j
.text:004070E6		       call    __errno
.text:004070EB		       mov     dword ptr [eax],	16h
.text:004070F1		       jmp     short $LN28
.text:004070F3 ; ---------------------------------------------------------------------------
.text:004070F3
.text:004070F3 loc_4070F3:			       ; CODE XREF: __setmbcp+30j
.text:004070F3		       and     [ebp+retcode], 0
.text:004070F7
.text:004070F7 $LN28:				       ; CODE XREF: __setmbcp+45j
.text:004070F7					       ; __setmbcp+A1j	...
.text:004070F7		       mov     eax, [ebp+retcode]
.text:004070FA		       call    __SEH_epilog4
.text:004070FF		       retn
.text:004070FF __setmbcp       endp
.text:004070FF
.text:00407100
.text:00407100 ; =============== S U B R O U T I N E =======================================
.text:00407100
.text:00407100
.text:00407100 ; int __cdecl __initmbctable()
.text:00407100 ___initmbctable proc near	       ; CODE XREF: __setenvp+Dp
.text:00407100					       ; __setargv+13p
.text:00407100					       ; DATA XREF: ...
.text:00407100		       cmp     ___mbctype_initialized, 0
.text:00407107		       jnz     short loc_40711B
.text:00407109		       push    0FFFFFFFDh      ; codepage
.text:0040710B		       call    __setmbcp
.text:00407110		       pop     ecx
.text:00407111		       mov     ___mbctype_initialized, 1
.text:0040711B
.text:0040711B loc_40711B:			       ; CODE XREF: ___initmbctable+7j
.text:0040711B		       xor     eax, eax
.text:0040711D		       retn
.text:0040711D ___initmbctable endp
.text:0040711D
.text:0040711E
.text:0040711E ; =============== S U B R O U T I N E =======================================
.text:0040711E
.text:0040711E
.text:0040711E ; int __cdecl ___setlc_active_func()
.text:0040711E ____setlc_active_func proc near
.text:0040711E		       mov     eax, ___setlc_active
.text:00407123		       retn
.text:00407123 ____setlc_active_func endp
.text:00407123
.text:00407124
.text:00407124 ; =============== S U B R O U T I N E =======================================
.text:00407124
.text:00407124
.text:00407124 ; int *__cdecl ___unguarded_readlc_active_add_func()
.text:00407124 ____unguarded_readlc_active_add_func proc near
.text:00407124		       mov     eax, offset ___unguarded_readlc_active
.text:00407129		       retn
.text:00407129 ____unguarded_readlc_active_add_func endp
.text:00407129
.text:0040712A
.text:0040712A ; =============== S U B R O U T I N E =======================================
.text:0040712A
.text:0040712A
.text:0040712A ; void __cdecl __freetlocinfo(threadlocaleinfostruct *ptloci)
.text:0040712A ___freetlocinfo proc near	       ; CODE XREF: _freefls(x)+E8p
.text:0040712A					       ; _updatetlocinfoEx_nolock+31p ...
.text:0040712A
.text:0040712A ptloci	       = dword ptr  4
.text:0040712A
.text:0040712A		       push    ebx
.text:0040712B		       push    ebp
.text:0040712C		       push    esi
.text:0040712D		       mov     esi, [esp+0Ch+ptloci]
.text:00407131		       mov     eax, [esi+0BCh]
.text:00407137		       xor     ebp, ebp
.text:00407139		       cmp     eax, ebp
.text:0040713B		       push    edi
.text:0040713C		       jz      short loc_4071AD
.text:0040713E		       cmp     eax, offset ___lconv_c
.text:00407143		       jz      short loc_4071AD
.text:00407145		       mov     eax, [esi+0B0h]
.text:0040714B		       cmp     eax, ebp
.text:0040714D		       jz      short loc_4071AD
.text:0040714F		       cmp     [eax], ebp
.text:00407151		       jnz     short loc_4071AD
.text:00407153		       mov     eax, [esi+0B8h]
.text:00407159		       cmp     eax, ebp
.text:0040715B		       jz      short loc_407174
.text:0040715D		       cmp     [eax], ebp
.text:0040715F		       jnz     short loc_407174
.text:00407161		       push    eax	       ; pBlock
.text:00407162		       call    _free
.text:00407167		       push    dword ptr [esi+0BCh] ; l
.text:0040716D		       call    ___free_lconv_mon
.text:00407172		       pop     ecx
.text:00407173		       pop     ecx
.text:00407174
.text:00407174 loc_407174:			       ; CODE XREF: ___freetlocinfo+31j
.text:00407174					       ; ___freetlocinfo+35j
.text:00407174		       mov     eax, [esi+0B4h]
.text:0040717A		       cmp     eax, ebp
.text:0040717C		       jz      short loc_407195
.text:0040717E		       cmp     [eax], ebp
.text:00407180		       jnz     short loc_407195
.text:00407182		       push    eax	       ; pBlock
.text:00407183		       call    _free
.text:00407188		       push    dword ptr [esi+0BCh] ; l
.text:0040718E		       call    ___free_lconv_num
.text:00407193		       pop     ecx
.text:00407194		       pop     ecx
.text:00407195
.text:00407195 loc_407195:			       ; CODE XREF: ___freetlocinfo+52j
.text:00407195					       ; ___freetlocinfo+56j
.text:00407195		       push    dword ptr [esi+0B0h] ; pBlock
.text:0040719B		       call    _free
.text:004071A0		       push    dword ptr [esi+0BCh] ; pBlock
.text:004071A6		       call    _free
.text:004071AB		       pop     ecx
.text:004071AC		       pop     ecx
.text:004071AD
.text:004071AD loc_4071AD:			       ; CODE XREF: ___freetlocinfo+12j
.text:004071AD					       ; ___freetlocinfo+19j ...
.text:004071AD		       mov     eax, [esi+0C0h]
.text:004071B3		       cmp     eax, ebp
.text:004071B5		       jz      short loc_4071FB
.text:004071B7		       cmp     [eax], ebp
.text:004071B9		       jnz     short loc_4071FB
.text:004071BB		       mov     eax, [esi+0C4h]
.text:004071C1		       sub     eax, 0FEh
.text:004071C6		       push    eax	       ; pBlock
.text:004071C7		       call    _free
.text:004071CC		       mov     eax, [esi+0CCh]
.text:004071D2		       mov     edi, 80h
.text:004071D7		       sub     eax, edi
.text:004071D9		       push    eax	       ; pBlock
.text:004071DA		       call    _free
.text:004071DF		       mov     eax, [esi+0D0h]
.text:004071E5		       sub     eax, edi
.text:004071E7		       push    eax	       ; pBlock
.text:004071E8		       call    _free
.text:004071ED		       push    dword ptr [esi+0C0h] ; pBlock
.text:004071F3		       call    _free
.text:004071F8		       add     esp, 10h
.text:004071FB
.text:004071FB loc_4071FB:			       ; CODE XREF: ___freetlocinfo+8Bj
.text:004071FB					       ; ___freetlocinfo+8Fj
.text:004071FB		       lea     edi, [esi+0D4h]
.text:00407201		       mov     eax, [edi]
.text:00407203		       cmp     eax, offset ___lc_time_c
.text:00407208		       jz      short loc_407221
.text:0040720A		       cmp     [eax+0B4h], ebp
.text:00407210		       jnz     short loc_407221
.text:00407212		       push    eax	       ; lc_time
.text:00407213		       call    ___free_lc_time
.text:00407218		       push    dword ptr [edi] ; pBlock
.text:0040721A		       call    _free
.text:0040721F		       pop     ecx
.text:00407220		       pop     ecx
.text:00407221
.text:00407221 loc_407221:			       ; CODE XREF: ___freetlocinfo+DEj
.text:00407221					       ; ___freetlocinfo+E6j
.text:00407221		       push    6
.text:00407223		       lea     edi, [esi+50h]
.text:00407226		       pop     ebx
.text:00407227
.text:00407227 loc_407227:			       ; CODE XREF: ___freetlocinfo+132j
.text:00407227		       cmp     dword ptr [edi-8], offset ___clocalestr ; "C"
.text:0040722E		       jz      short loc_407241
.text:00407230		       mov     eax, [edi]
.text:00407232		       cmp     eax, ebp
.text:00407234		       jz      short loc_407241
.text:00407236		       cmp     [eax], ebp
.text:00407238		       jnz     short loc_407241
.text:0040723A		       push    eax	       ; pBlock
.text:0040723B		       call    _free
.text:00407240		       pop     ecx
.text:00407241
.text:00407241 loc_407241:			       ; CODE XREF: ___freetlocinfo+104j
.text:00407241					       ; ___freetlocinfo+10Aj ...
.text:00407241		       cmp     [edi-4],	ebp
.text:00407244		       jz      short loc_407258
.text:00407246		       mov     eax, [edi+4]
.text:00407249		       cmp     eax, ebp
.text:0040724B		       jz      short loc_407258
.text:0040724D		       cmp     [eax], ebp
.text:0040724F		       jnz     short loc_407258
.text:00407251		       push    eax	       ; pBlock
.text:00407252		       call    _free
.text:00407257		       pop     ecx
.text:00407258
.text:00407258 loc_407258:			       ; CODE XREF: ___freetlocinfo+11Aj
.text:00407258					       ; ___freetlocinfo+121j ...
.text:00407258		       add     edi, 10h
.text:0040725B		       dec     ebx
.text:0040725C		       jnz     short loc_407227
.text:0040725E		       push    esi	       ; pBlock
.text:0040725F		       call    _free
.text:00407264		       pop     ecx
.text:00407265		       pop     edi
.text:00407266		       pop     esi
.text:00407267		       pop     ebp
.text:00407268		       pop     ebx
.text:00407269		       retn
.text:00407269 ___freetlocinfo endp
.text:00407269
.text:0040726A
.text:0040726A ; =============== S U B R O U T I N E =======================================
.text:0040726A
.text:0040726A
.text:0040726A ; void __cdecl __addlocaleref(threadlocaleinfostruct *ptloci)
.text:0040726A ___addlocaleref proc near	       ; CODE XREF: __initptd+9Ep
.text:0040726A					       ; _copytlocinfo_nolock+1Bp ...
.text:0040726A
.text:0040726A ptloci	       = dword ptr  4
.text:0040726A
.text:0040726A		       push    ebx
.text:0040726B		       push    ebp
.text:0040726C		       push    esi
.text:0040726D		       mov     esi, [esp+0Ch+ptloci]
.text:00407271		       push    edi
.text:00407272		       mov     edi, ds:__imp__InterlockedIncrement@4 ; InterlockedIncrement(x)
.text:00407278		       push    esi	       ; lpAddend
.text:00407279		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:0040727B		       mov     eax, [esi+0B0h]
.text:00407281		       test    eax, eax
.text:00407283		       jz      short loc_407288
.text:00407285		       push    eax	       ; lpAddend
.text:00407286		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:00407288
.text:00407288 loc_407288:			       ; CODE XREF: ___addlocaleref+19j
.text:00407288		       mov     eax, [esi+0B8h]
.text:0040728E		       test    eax, eax
.text:00407290		       jz      short loc_407295
.text:00407292		       push    eax	       ; lpAddend
.text:00407293		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:00407295
.text:00407295 loc_407295:			       ; CODE XREF: ___addlocaleref+26j
.text:00407295		       mov     eax, [esi+0B4h]
.text:0040729B		       test    eax, eax
.text:0040729D		       jz      short loc_4072A2
.text:0040729F		       push    eax	       ; lpAddend
.text:004072A0		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:004072A2
.text:004072A2 loc_4072A2:			       ; CODE XREF: ___addlocaleref+33j
.text:004072A2		       mov     eax, [esi+0C0h]
.text:004072A8		       test    eax, eax
.text:004072AA		       jz      short loc_4072AF
.text:004072AC		       push    eax	       ; lpAddend
.text:004072AD		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:004072AF
.text:004072AF loc_4072AF:			       ; CODE XREF: ___addlocaleref+40j
.text:004072AF		       push    6
.text:004072B1		       lea     ebx, [esi+50h]
.text:004072B4		       pop     ebp
.text:004072B5
.text:004072B5 loc_4072B5:			       ; CODE XREF: ___addlocaleref+71j
.text:004072B5		       cmp     dword ptr [ebx-8], offset ___clocalestr ; "C"
.text:004072BC		       jz      short loc_4072C7
.text:004072BE		       mov     eax, [ebx]
.text:004072C0		       test    eax, eax
.text:004072C2		       jz      short loc_4072C7
.text:004072C4		       push    eax	       ; lpAddend
.text:004072C5		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:004072C7
.text:004072C7 loc_4072C7:			       ; CODE XREF: ___addlocaleref+52j
.text:004072C7					       ; ___addlocaleref+58j
.text:004072C7		       cmp     dword ptr [ebx-4], 0
.text:004072CB		       jz      short loc_4072D7
.text:004072CD		       mov     eax, [ebx+4]
.text:004072D0		       test    eax, eax
.text:004072D2		       jz      short loc_4072D7
.text:004072D4		       push    eax	       ; lpAddend
.text:004072D5		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:004072D7
.text:004072D7 loc_4072D7:			       ; CODE XREF: ___addlocaleref+61j
.text:004072D7					       ; ___addlocaleref+68j
.text:004072D7		       add     ebx, 10h
.text:004072DA		       dec     ebp
.text:004072DB		       jnz     short loc_4072B5
.text:004072DD		       mov     eax, [esi+0D4h]
.text:004072E3		       add     eax, 0B4h
.text:004072E8		       push    eax	       ; lpAddend
.text:004072E9		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:004072EB		       pop     edi
.text:004072EC		       pop     esi
.text:004072ED		       pop     ebp
.text:004072EE		       pop     ebx
.text:004072EF		       retn
.text:004072EF ___addlocaleref endp
.text:004072EF
.text:004072F0
.text:004072F0 ; =============== S U B R O U T I N E =======================================
.text:004072F0
.text:004072F0
.text:004072F0 ; void *__cdecl __removelocaleref(threadlocaleinfostruct	*ptloci)
.text:004072F0 ___removelocaleref proc near	       ; CODE XREF: _freefls(x)+CCp
.text:004072F0					       ; _updatetlocinfoEx_nolock+1Dp ...
.text:004072F0
.text:004072F0 ptloci	       = dword ptr  4
.text:004072F0
.text:004072F0		       push    esi
.text:004072F1		       mov     esi, [esp+4+ptloci]
.text:004072F5		       test    esi, esi
.text:004072F7		       jz      short loc_407378
.text:004072F9		       push    ebx
.text:004072FA		       push    ebp
.text:004072FB		       push    edi
.text:004072FC		       mov     edi, ds:__imp__InterlockedDecrement@4 ; InterlockedDecrement(x)
.text:00407302		       push    esi	       ; lpAddend
.text:00407303		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407305		       mov     eax, [esi+0B0h]
.text:0040730B		       test    eax, eax
.text:0040730D		       jz      short loc_407312
.text:0040730F		       push    eax	       ; lpAddend
.text:00407310		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407312
.text:00407312 loc_407312:			       ; CODE XREF: ___removelocaleref+1Dj
.text:00407312		       mov     eax, [esi+0B8h]
.text:00407318		       test    eax, eax
.text:0040731A		       jz      short loc_40731F
.text:0040731C		       push    eax	       ; lpAddend
.text:0040731D		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:0040731F
.text:0040731F loc_40731F:			       ; CODE XREF: ___removelocaleref+2Aj
.text:0040731F		       mov     eax, [esi+0B4h]
.text:00407325		       test    eax, eax
.text:00407327		       jz      short loc_40732C
.text:00407329		       push    eax	       ; lpAddend
.text:0040732A		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:0040732C
.text:0040732C loc_40732C:			       ; CODE XREF: ___removelocaleref+37j
.text:0040732C		       mov     eax, [esi+0C0h]
.text:00407332		       test    eax, eax
.text:00407334		       jz      short loc_407339
.text:00407336		       push    eax	       ; lpAddend
.text:00407337		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407339
.text:00407339 loc_407339:			       ; CODE XREF: ___removelocaleref+44j
.text:00407339		       push    6
.text:0040733B		       lea     ebx, [esi+50h]
.text:0040733E		       pop     ebp
.text:0040733F
.text:0040733F loc_40733F:			       ; CODE XREF: ___removelocaleref+75j
.text:0040733F		       cmp     dword ptr [ebx-8], offset ___clocalestr ; "C"
.text:00407346		       jz      short loc_407351
.text:00407348		       mov     eax, [ebx]
.text:0040734A		       test    eax, eax
.text:0040734C		       jz      short loc_407351
.text:0040734E		       push    eax	       ; lpAddend
.text:0040734F		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407351
.text:00407351 loc_407351:			       ; CODE XREF: ___removelocaleref+56j
.text:00407351					       ; ___removelocaleref+5Cj
.text:00407351		       cmp     dword ptr [ebx-4], 0
.text:00407355		       jz      short loc_407361
.text:00407357		       mov     eax, [ebx+4]
.text:0040735A		       test    eax, eax
.text:0040735C		       jz      short loc_407361
.text:0040735E		       push    eax	       ; lpAddend
.text:0040735F		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407361
.text:00407361 loc_407361:			       ; CODE XREF: ___removelocaleref+65j
.text:00407361					       ; ___removelocaleref+6Cj
.text:00407361		       add     ebx, 10h
.text:00407364		       dec     ebp
.text:00407365		       jnz     short loc_40733F
.text:00407367		       mov     eax, [esi+0D4h]
.text:0040736D		       add     eax, 0B4h
.text:00407372		       push    eax	       ; lpAddend
.text:00407373		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407375		       pop     edi
.text:00407376		       pop     ebp
.text:00407377		       pop     ebx
.text:00407378
.text:00407378 loc_407378:			       ; CODE XREF: ___removelocaleref+7j
.text:00407378		       mov     eax, esi
.text:0040737A		       pop     esi
.text:0040737B		       retn
.text:0040737B ___removelocaleref endp
.text:0040737B
.text:0040737C
.text:0040737C ; =============== S U B R O U T I N E =======================================
.text:0040737C
.text:0040737C
.text:0040737C ; void __usercall copytlocinfo_nolock(threadlocaleinfostruct *ptlocid<eax>, threadlocaleinfostruct *ptlocis<ecx>)
.text:0040737C _copytlocinfo_nolock proc near	       ; CODE XREF: __create_locale+7Ap
.text:0040737C					       ; _setlocale+7Bp
.text:0040737C ptlocid = eax
.text:0040737C ptlocis = ecx
.text:0040737C		       push    esi
.text:0040737D		       mov     esi, ptlocis
.text:0040737F		       test    esi, esi
.text:00407381		       jz      short loc_40739E
.text:00407383		       test    ptlocid,	ptlocid
.text:00407385		       jz      short loc_40739E
.text:00407387		       cmp     ptlocid,	esi
.text:00407389		       jz      short loc_40739E
.text:0040738B		       push    edi
.text:0040738C		       push    36h
.text:0040738E		       pop     ptlocis
.text:0040738F		       mov     edi, ptlocid
.text:00407391		       rep movsd
.text:00407393		       and     dword ptr [ptlocid], 0
.text:00407396		       push    ptlocid	       ; ptloci
.text:00407397		       call    ___addlocaleref
.text:0040739C		       pop     ptlocis
.text:0040739D		       pop     edi
.text:0040739E
.text:0040739E loc_40739E:			       ; CODE XREF: _copytlocinfo_nolock+5j
.text:0040739E					       ; _copytlocinfo_nolock+9j ...
.text:0040739E		       pop     esi
.text:0040739F		       retn
.text:0040739F _copytlocinfo_nolock endp
.text:0040739F
.text:004073A0
.text:004073A0 ; =============== S U B R O U T I N E =======================================
.text:004073A0
.text:004073A0
.text:004073A0 ; threadlocaleinfostruct	*__usercall updatetlocinfoEx_nolock<eax>(threadlocaleinfostruct	**pptlocid<eax>, threadlocaleinfostruct	*ptlocis<edi>)
.text:004073A0 _updatetlocinfoEx_nolock	proc near      ; CODE XREF: ___updatetlocinfo+54p
.text:004073A0					       ; _setlocale+D7p ...
.text:004073A0 pptlocid	= eax
.text:004073A0 ptlocis = edi
.text:004073A0		       test    ptlocis,	ptlocis
.text:004073A2		       jz      short loc_4073DB
.text:004073A4		       test    pptlocid, pptlocid
.text:004073A6		       jz      short loc_4073DB
.text:004073A8		       push    esi
.text:004073A9		       mov     esi, [pptlocid]
.text:004073AB		       cmp     esi, ptlocis
.text:004073AD		       jz      short loc_4073D7
.text:004073AF		       push    ptlocis	       ; ptloci
.text:004073B0		       mov     [pptlocid], ptlocis
.text:004073B2		       call    ___addlocaleref
.text:004073B7		       test    esi, esi
.text:004073B9		       pop     ecx
.text:004073BA		       jz      short loc_4073D7
.text:004073BC		       push    esi	       ; ptloci
.text:004073BD		       call    ___removelocaleref
.text:004073C2		       cmp     dword ptr [esi],	0
.text:004073C5		       pop     ecx
.text:004073C6		       jnz     short loc_4073D7
.text:004073C8		       cmp     esi, offset ___initiallocinfo
.text:004073CE		       jz      short loc_4073D7
.text:004073D0		       push    esi	       ; ptloci
.text:004073D1		       call    ___freetlocinfo
.text:004073D6		       pop     ecx
.text:004073D7
.text:004073D7 loc_4073D7:			       ; CODE XREF: _updatetlocinfoEx_nolock+Dj
.text:004073D7					       ; _updatetlocinfoEx_nolock+1Aj ...
.text:004073D7		       mov     pptlocid, ptlocis
.text:004073D9		       pop     esi
.text:004073DA		       retn
.text:004073DB ; ---------------------------------------------------------------------------
.text:004073DB
.text:004073DB loc_4073DB:			       ; CODE XREF: _updatetlocinfoEx_nolock+2j
.text:004073DB					       ; _updatetlocinfoEx_nolock+6j
.text:004073DB		       xor     pptlocid, pptlocid
.text:004073DD		       retn
.text:004073DD _updatetlocinfoEx_nolock	endp
.text:004073DD
.text:004073DE
.text:004073DE ; =============== S U B R O U T I N E =======================================
.text:004073DE
.text:004073DE ; Attributes: bp-based frame
.text:004073DE
.text:004073DE ; threadlocaleinfostruct	*__cdecl __updatetlocinfo()
.text:004073DE ___updatetlocinfo proc near	       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+37p
.text:004073DE					       ; __get_current_locale:loc_4075DEp ...
.text:004073DE
.text:004073DE ptloci	       = dword ptr -1Ch
.text:004073DE ms_exc	       = CPPEH_RECORD ptr -18h
.text:004073DE
.text:004073DE		       push    0Ch
.text:004073E0		       push    offset dword_420780
.text:004073E5		       call    __SEH_prolog4
.text:004073EA		       call    __getptd
.text:004073EF		       mov     esi, eax
.text:004073F1		       mov     eax, ___globallocalestatus
.text:004073F6		       test    [esi+70h], eax
.text:004073F9		       jz      short loc_40741D
.text:004073FB		       cmp     dword ptr [esi+6Ch], 0
.text:004073FF		       jz      short loc_40741D
.text:00407401		       call    __getptd
.text:00407406		       mov     esi, [eax+6Ch]
.text:00407409
.text:00407409 $LN12_5:				       ; CODE XREF: ___updatetlocinfo+68j
.text:00407409		       test    esi, esi
.text:0040740B		       jnz     short loc_407415
.text:0040740D		       push    20h	       ; rterrnum
.text:0040740F		       call    __amsg_exit
.text:00407414		       pop     ecx
.text:00407415
.text:00407415 loc_407415:			       ; CODE XREF: ___updatetlocinfo+2Dj
.text:00407415		       mov     eax, esi
.text:00407417		       call    __SEH_epilog4
.text:0040741C		       retn
.text:0040741D ; ---------------------------------------------------------------------------
.text:0040741D
.text:0040741D loc_40741D:			       ; CODE XREF: ___updatetlocinfo+1Bj
.text:0040741D					       ; ___updatetlocinfo+21j
.text:0040741D		       push    0Ch	       ; locknum
.text:0040741F		       call    __lock
.text:00407424		       pop     ecx
.text:00407425		       and     [ebp+ms_exc.disabled], 0
.text:00407429		       lea     eax, [esi+6Ch]  ; pptlocid
.text:0040742C		       mov     edi, ___ptlocinfo ; ptlocis
.text:00407432		       call    _updatetlocinfoEx_nolock
.text:00407437		       mov     [ebp+ptloci], eax
.text:0040743A		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00407441		       call    $LN9_4
.text:00407446		       jmp     short $LN12_5
.text:00407448 ; ---------------------------------------------------------------------------
.text:00407448
.text:00407448 $LN9_4:				       ; CODE XREF: ___updatetlocinfo+63p
.text:00407448					       ; DATA XREF: .rdata:00420798o
.text:00407448		       push    0Ch	       ; locknum
.text:0040744A		       call    __unlock
.text:0040744F		       pop     ecx
.text:00407450
.text:00407450 $LN10_2:
.text:00407450		       mov     esi, [ebp+ptloci]
.text:00407453		       retn
.text:00407453 ___updatetlocinfo endp
.text:00407453
.text:00407454
.text:00407454 ; =============== S U B R O U T I N E =======================================
.text:00407454
.text:00407454
.text:00407454 ; int __cdecl _configthreadlocale(int i)
.text:00407454 __configthreadlocale proc near
.text:00407454
.text:00407454 i	       = dword ptr  4
.text:00407454
.text:00407454		       push    esi
.text:00407455		       push    edi
.text:00407456		       call    __getptd
.text:0040745B		       mov     ecx, [eax+70h]
.text:0040745E		       mov     edx, ecx
.text:00407460		       and     dl, 2
.text:00407463		       neg     dl
.text:00407465		       sbb     edx, edx
.text:00407467		       inc     edx
.text:00407468		       inc     edx
.text:00407469		       mov     edi, edx
.text:0040746B		       mov     edx, [esp+8+i]
.text:0040746F		       cmp     edx, 0FFFFFFFFh
.text:00407472		       jz      short loc_4074AE
.text:00407474		       xor     esi, esi
.text:00407476		       cmp     edx, esi
.text:00407478		       jz      short loc_4074B5
.text:0040747A		       cmp     edx, 1
.text:0040747D		       jz      short loc_4074A6
.text:0040747F		       cmp     edx, 2
.text:00407482		       jz      short loc_4074A1
.text:00407484		       call    __errno
.text:00407489		       push    esi	       ; pReserved
.text:0040748A		       push    esi	       ; nLine
.text:0040748B		       push    esi	       ; pszFile
.text:0040748C		       push    esi	       ; pszFunction
.text:0040748D		       push    esi	       ; pszExpression
.text:0040748E		       mov     dword ptr [eax],	16h
.text:00407494		       call    __invalid_parameter
.text:00407499		       add     esp, 14h
.text:0040749C		       or      eax, 0FFFFFFFFh
.text:0040749F		       jmp     short loc_4074B7
.text:004074A1 ; ---------------------------------------------------------------------------
.text:004074A1
.text:004074A1 loc_4074A1:			       ; CODE XREF: __configthreadlocale+2Ej
.text:004074A1		       and     ecx, 0FFFFFFFDh
.text:004074A4		       jmp     short loc_4074A9
.text:004074A6 ; ---------------------------------------------------------------------------
.text:004074A6
.text:004074A6 loc_4074A6:			       ; CODE XREF: __configthreadlocale+29j
.text:004074A6		       or      ecx, 2
.text:004074A9
.text:004074A9 loc_4074A9:			       ; CODE XREF: __configthreadlocale+50j
.text:004074A9		       mov     [eax+70h], ecx
.text:004074AC		       jmp     short loc_4074B5
.text:004074AE ; ---------------------------------------------------------------------------
.text:004074AE
.text:004074AE loc_4074AE:			       ; CODE XREF: __configthreadlocale+1Ej
.text:004074AE		       or      ___globallocalestatus, 0FFFFFFFFh
.text:004074B5
.text:004074B5 loc_4074B5:			       ; CODE XREF: __configthreadlocale+24j
.text:004074B5					       ; __configthreadlocale+58j
.text:004074B5		       mov     eax, edi
.text:004074B7
.text:004074B7 loc_4074B7:			       ; CODE XREF: __configthreadlocale+4Bj
.text:004074B7		       pop     edi
.text:004074B8		       pop     esi
.text:004074B9		       retn
.text:004074B9 __configthreadlocale endp
.text:004074B9
.text:004074BA
.text:004074BA ; =============== S U B R O U T I N E =======================================
.text:004074BA
.text:004074BA
.text:004074BA sync_legacy_variables_lk	proc near      ; CODE XREF: _setlocale+116p
.text:004074BA		       mov     eax, ___ptlocinfo ; ___ptlocinfo
.text:004074BF		       mov     ecx, [eax+4]
.text:004074C2		       mov     ___lc_codepage, ecx
.text:004074C8		       mov     ecx, [eax+8]
.text:004074CB		       mov     ___lc_collate_cp, ecx
.text:004074D1		       mov     ecx, [eax+0A8h]
.text:004074D7		       mov     ___lc_clike, ecx
.text:004074DD		       mov     ecx, [eax+0D4h]
.text:004074E3		       mov     ___lc_time_curr,	ecx
.text:004074E9		       mov     ecx, [eax+0BCh]
.text:004074EF		       mov     ___lconv, ecx
.text:004074F5		       mov     ecx, [eax+0C8h]
.text:004074FB		       mov     __pctype, ecx
.text:00407501		       mov     eax, [eax+0ACh]
.text:00407507		       mov     ___mb_cur_max, eax
.text:0040750C		       retn
.text:0040750C sync_legacy_variables_lk	endp
.text:0040750C
.text:0040750D
.text:0040750D ; =============== S U B R O U T I N E =======================================
.text:0040750D
.text:0040750D ; Attributes: bp-based frame
.text:0040750D
.text:0040750D ; void __cdecl _free_locale(localeinfo_struct *plocinfo)
.text:0040750D __free_locale   proc near	       ; CODE XREF: ___free_localej
.text:0040750D
.text:0040750D ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040750D plocinfo	       = dword ptr  8
.text:0040750D
.text:0040750D		       push    8
.text:0040750F		       push    offset dword_4207A0
.text:00407514		       call    __SEH_prolog4
.text:00407519		       mov     esi, [ebp+plocinfo]
.text:0040751C		       xor     edi, edi
.text:0040751E		       cmp     esi, edi
.text:00407520		       jz      short loc_407591
.text:00407522		       mov     eax, [esi+4]
.text:00407525		       cmp     eax, edi
.text:00407527		       jz      short loc_407545
.text:00407529		       push    eax	       ; lpAddend
.text:0040752A		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:00407530		       test    eax, eax
.text:00407532		       jnz     short loc_407545
.text:00407534		       mov     eax, [esi+4]
.text:00407537		       cmp     eax, offset ___initialmbcinfo
.text:0040753C		       jz      short loc_407545
.text:0040753E		       push    eax	       ; pBlock
.text:0040753F		       call    _free
.text:00407544		       pop     ecx
.text:00407545
.text:00407545 loc_407545:			       ; CODE XREF: __free_locale+1Aj
.text:00407545					       ; __free_locale+25j ...
.text:00407545		       cmp     [esi], edi
.text:00407547		       jz      short $LN12_6
.text:00407549		       push    0Ch	       ; locknum
.text:0040754B		       call    __lock
.text:00407550		       pop     ecx
.text:00407551		       mov     [ebp+ms_exc.disabled], edi
.text:00407554		       push    dword ptr [esi] ; ptloci
.text:00407556		       call    ___removelocaleref
.text:0040755B		       pop     ecx
.text:0040755C		       mov     eax, [esi]
.text:0040755E		       cmp     eax, edi
.text:00407560		       jz      short loc_407574
.text:00407562		       cmp     [eax], edi
.text:00407564		       jnz     short loc_407574
.text:00407566		       cmp     eax, offset ___initiallocinfo
.text:0040756B		       jz      short loc_407574
.text:0040756D		       push    eax	       ; ptloci
.text:0040756E		       call    ___freetlocinfo
.text:00407573		       pop     ecx
.text:00407574
.text:00407574 loc_407574:			       ; CODE XREF: __free_locale+53j
.text:00407574					       ; __free_locale+57j ...
.text:00407574		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040757B		       call    $LN11_4
.text:00407580
.text:00407580 $LN12_6:				       ; CODE XREF: __free_locale+3Aj
.text:00407580		       mov     eax, 0BAADF00Dh
.text:00407585		       mov     [esi], eax
.text:00407587		       mov     [esi+4],	eax
.text:0040758A		       push    esi	       ; pBlock
.text:0040758B		       call    _free
.text:00407590		       pop     ecx
.text:00407591
.text:00407591 loc_407591:			       ; CODE XREF: __free_locale+13j
.text:00407591		       call    __SEH_epilog4
.text:00407596		       retn
.text:00407597 ; ---------------------------------------------------------------------------
.text:00407597
.text:00407597 $LN9_5:				       ; DATA XREF: .rdata:004207B8o
.text:00407597		       mov     esi, [ebp+plocinfo]
.text:0040759A
.text:0040759A $LN11_4:				       ; CODE XREF: __free_locale+6Ep
.text:0040759A		       push    0Ch	       ; locknum
.text:0040759C		       call    __unlock
.text:004075A1		       pop     ecx
.text:004075A2
.text:004075A2 $LN10_3:
.text:004075A2		       retn
.text:004075A2 __free_locale   endp ; sp-analysis failed
.text:004075A2
.text:004075A3 ; [00000005 BYTES: COLLAPSED FUNCTION ___free_locale. PRESS KEYPAD "+" TO EXPAND]
.text:004075A8
.text:004075A8 ; =============== S U B R O U T I N E =======================================
.text:004075A8
.text:004075A8 ; Attributes: bp-based frame
.text:004075A8
.text:004075A8 ; localeinfo_struct *__cdecl _get_current_locale()
.text:004075A8 __get_current_locale proc near	       ; CODE XREF: ___get_current_localej
.text:004075A8
.text:004075A8 retval	       = dword ptr -1Ch
.text:004075A8 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004075A8
.text:004075A8		       push    0Ch
.text:004075AA		       push    offset dword_4207C0
.text:004075AF		       call    __SEH_prolog4
.text:004075B4		       call    __getptd
.text:004075B9		       mov     edi, eax
.text:004075BB		       push    1	       ; size
.text:004075BD		       push    8	       ; count
.text:004075BF		       call    __calloc_crt
.text:004075C4		       pop     ecx
.text:004075C5		       pop     ecx
.text:004075C6		       mov     esi, eax
.text:004075C8		       mov     [ebp+retval], esi
.text:004075CB		       test    esi, esi
.text:004075CD		       jnz     short loc_4075DE
.text:004075CF		       call    __errno
.text:004075D4		       mov     dword ptr [eax],	0Ch
.text:004075DA		       xor     eax, eax
.text:004075DC		       jmp     short loc_40761E
.text:004075DE ; ---------------------------------------------------------------------------
.text:004075DE
.text:004075DE loc_4075DE:			       ; CODE XREF: __get_current_locale+25j
.text:004075DE		       call    ___updatetlocinfo
.text:004075E3		       call    ___updatetmbcinfo
.text:004075E8		       mov     eax, [edi+6Ch]
.text:004075EB		       mov     [esi], eax
.text:004075ED		       mov     eax, [edi+68h]
.text:004075F0		       mov     [esi+4],	eax
.text:004075F3		       push    0Ch	       ; locknum
.text:004075F5		       call    __lock
.text:004075FA		       pop     ecx
.text:004075FB		       and     [ebp+ms_exc.disabled], 0
.text:004075FF		       push    dword ptr [esi] ; ptloci
.text:00407601		       call    ___addlocaleref
.text:00407606		       pop     ecx
.text:00407607		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040760E		       call    $LN8_3
.text:00407613
.text:00407613 $LN9_6:				       ; lpAddend
.text:00407613		       push    dword ptr [esi+4]
.text:00407616		       call    ds:__imp__InterlockedIncrement@4	; InterlockedIncrement(x)
.text:0040761C		       mov     eax, esi
.text:0040761E
.text:0040761E loc_40761E:			       ; CODE XREF: __get_current_locale+34j
.text:0040761E		       call    __SEH_epilog4
.text:00407623		       retn
.text:00407624 ; ---------------------------------------------------------------------------
.text:00407624
.text:00407624 $LN6_7:				       ; DATA XREF: .rdata:004207D8o
.text:00407624		       mov     esi, [ebp+retval]
.text:00407627
.text:00407627 $LN8_3:				       ; CODE XREF: __get_current_locale+66p
.text:00407627		       push    0Ch	       ; locknum
.text:00407629		       call    __unlock
.text:0040762E		       pop     ecx
.text:0040762F
.text:0040762F $LN7_6:
.text:0040762F		       retn
.text:0040762F __get_current_locale endp ; sp-analysis failed
.text:0040762F
.text:00407630 ; [00000005 BYTES: COLLAPSED FUNCTION ___get_current_locale. PRESS KEYPAD "+" TO	EXPAND]
.text:00407635
.text:00407635 ; =============== S U B R O U T I N E =======================================
.text:00407635
.text:00407635
.text:00407635 ; int __cdecl __init_dummy(threadlocaleinfostruct *ploci)
.text:00407635 ___init_dummy   proc near	       ; CODE XREF: _setlocale_set_cat+255p
.text:00407635					       ; DATA XREF: .rdata:off_41E3E0o
.text:00407635
.text:00407635 ploci	       = dword ptr  4
.text:00407635
.text:00407635		       xor     eax, eax
.text:00407637		       retn
.text:00407637 ___init_dummy   endp
.text:00407637
.text:00407638
.text:00407638 ; =============== S U B R O U T I N E =======================================
.text:00407638
.text:00407638
.text:00407638 ; void __cdecl _strcats(char *outstr, unsigned int sizeInBytes, int n)
.text:00407638 __strcats       proc near	       ; CODE XREF: ___lc_lctostr+3Fp
.text:00407638					       ; ___lc_lctostr+61p ...
.text:00407638
.text:00407638 outstr	       = dword ptr  4
.text:00407638 sizeInBytes     = dword ptr  8
.text:00407638 n	       = dword ptr  0Ch
.text:00407638
.text:00407638		       push    ebx
.text:00407639		       push    edi
.text:0040763A		       mov     edi, [esp+8+n]
.text:0040763E		       xor     ebx, ebx
.text:00407640		       cmp     edi, ebx
.text:00407642		       jle     short loc_407673
.text:00407644		       push    esi
.text:00407645		       lea     esi, [esp+0Ch+n]
.text:00407649
.text:00407649 loc_407649:			       ; CODE XREF: __strcats+38j
.text:00407649		       add     esi, 4
.text:0040764C		       push    dword ptr [esi] ; _Src
.text:0040764E		       push    [esp+10h+sizeInBytes] ; _SizeInBytes
.text:00407652		       push    [esp+14h+outstr]	; _Dst
.text:00407656		       call    _strcat_s
.text:0040765B		       add     esp, 0Ch
.text:0040765E		       test    eax, eax
.text:00407660		       jz      short loc_40766F
.text:00407662		       push    ebx	       ; pReserved
.text:00407663		       push    ebx	       ; nLine
.text:00407664		       push    ebx	       ; pszFile
.text:00407665		       push    ebx	       ; pszFunction
.text:00407666		       push    ebx	       ; pszExpression
.text:00407667		       call    __invoke_watson
.text:0040766C		       add     esp, 14h
.text:0040766F
.text:0040766F loc_40766F:			       ; CODE XREF: __strcats+28j
.text:0040766F		       dec     edi
.text:00407670		       jnz     short loc_407649
.text:00407672		       pop     esi
.text:00407673
.text:00407673 loc_407673:			       ; CODE XREF: __strcats+Aj
.text:00407673		       pop     edi
.text:00407674		       pop     ebx
.text:00407675		       retn
.text:00407675 __strcats       endp
.text:00407675
.text:00407676
.text:00407676 ; =============== S U B R O U T I N E =======================================
.text:00407676
.text:00407676 ; Attributes: bp-based frame
.text:00407676
.text:00407676 ; int __cdecl __lc_strtolc(tagLC_STRINGS	*names,	const char *locale)
.text:00407676 ___lc_strtolc   proc near	       ; CODE XREF: __expandlocale+F9p
.text:00407676
.text:00407676 names	       = dword ptr  8
.text:00407676 i	       = dword ptr  0Ch
.text:00407676
.text:00407676		       push    ebp
.text:00407677		       mov     ebp, esp
.text:00407679		       push    ebx
.text:0040767A		       push    esi
.text:0040767B		       push    edi
.text:0040767C		       mov     edi, [ebp+names]
.text:0040767F		       push    90h	       ; count
.text:00407684		       xor     ebx, ebx
.text:00407686		       push    ebx	       ; value
.text:00407687		       push    edi	       ; dst
.text:00407688		       call    _memset
.text:0040768D		       mov     esi, [ebp+i]
.text:00407690		       mov     al, [esi]
.text:00407692		       add     esp, 0Ch
.text:00407695		       test    al, al
.text:00407697		       jnz     short loc_4076A0
.text:00407699
.text:00407699 loc_407699:			       ; CODE XREF: ___lc_strtolc+60j
.text:00407699					       ; ___lc_strtolc+F8j ...
.text:00407699		       xor     eax, eax
.text:0040769B		       jmp     loc_40779A
.text:004076A0 ; ---------------------------------------------------------------------------
.text:004076A0
.text:004076A0 loc_4076A0:			       ; CODE XREF: ___lc_strtolc+21j
.text:004076A0		       cmp     al, 2Eh
.text:004076A2		       jnz     short loc_4076D8
.text:004076A4		       lea     eax, [esi+1]
.text:004076A7		       cmp     [eax], bl
.text:004076A9		       jz      short loc_4076D8
.text:004076AB		       push    0Fh	       ; _Count
.text:004076AD		       push    eax	       ; _Src
.text:004076AE		       lea     eax, [edi+80h]
.text:004076B4		       push    10h	       ; _SizeInBytes
.text:004076B6		       push    eax	       ; _Dst
.text:004076B7		       call    _strncpy_s
.text:004076BC		       add     esp, 10h
.text:004076BF		       test    eax, eax
.text:004076C1		       jz      short loc_4076D0
.text:004076C3		       push    ebx	       ; pReserved
.text:004076C4		       push    ebx	       ; nLine
.text:004076C5		       push    ebx	       ; pszFile
.text:004076C6		       push    ebx	       ; pszFunction
.text:004076C7		       push    ebx	       ; pszExpression
.text:004076C8		       call    __invoke_watson
.text:004076CD		       add     esp, 14h
.text:004076D0
.text:004076D0 loc_4076D0:			       ; CODE XREF: ___lc_strtolc+4Bj
.text:004076D0		       mov     [edi+8Fh], bl
.text:004076D6		       jmp     short loc_407699
.text:004076D8 ; ---------------------------------------------------------------------------
.text:004076D8
.text:004076D8 loc_4076D8:			       ; CODE XREF: ___lc_strtolc+2Cj
.text:004076D8					       ; ___lc_strtolc+33j
.text:004076D8		       push    offset control  ; "_.,"
.text:004076DD		       push    esi	       ; string
.text:004076DE		       mov     [ebp+i],	ebx
.text:004076E1		       call    _strcspn
.text:004076E6		       cmp     eax, ebx
.text:004076E8		       jmp     loc_40778F
.text:004076ED ; ---------------------------------------------------------------------------
.text:004076ED
.text:004076ED loc_4076ED:			       ; CODE XREF: ___lc_strtolc+11Bj
.text:004076ED		       cmp     [ebp+i],	0
.text:004076F1		       lea     edi, [eax+esi]
.text:004076F4		       mov     bl, [edi]
.text:004076F6		       jnz     short loc_407713
.text:004076F8		       cmp     eax, 40h
.text:004076FB		       jnb     loc_407797
.text:00407701		       cmp     bl, 2Eh
.text:00407704		       jz      loc_407797
.text:0040770A		       push    eax
.text:0040770B		       push    esi
.text:0040770C		       push    40h
.text:0040770E		       push    [ebp+names]
.text:00407711		       jmp     short loc_407750
.text:00407713 ; ---------------------------------------------------------------------------
.text:00407713
.text:00407713 loc_407713:			       ; CODE XREF: ___lc_strtolc+80j
.text:00407713		       cmp     [ebp+i],	1
.text:00407717		       jnz     short loc_40772F
.text:00407719		       cmp     eax, 40h
.text:0040771C		       jnb     short loc_407797
.text:0040771E		       cmp     bl, 5Fh
.text:00407721		       jz      short loc_407797
.text:00407723		       push    eax
.text:00407724		       mov     eax, [ebp+names]
.text:00407727		       push    esi
.text:00407728		       push    40h
.text:0040772A		       add     eax, 40h
.text:0040772D		       jmp     short loc_40774F
.text:0040772F ; ---------------------------------------------------------------------------
.text:0040772F
.text:0040772F loc_40772F:			       ; CODE XREF: ___lc_strtolc+A1j
.text:0040772F		       cmp     [ebp+i],	2
.text:00407733		       jnz     short loc_407797
.text:00407735		       cmp     eax, 10h
.text:00407738		       jnb     short loc_407797
.text:0040773A		       test    bl, bl
.text:0040773C		       jz      short loc_407743
.text:0040773E		       cmp     bl, 2Ch
.text:00407741		       jnz     short loc_407797
.text:00407743
.text:00407743 loc_407743:			       ; CODE XREF: ___lc_strtolc+C6j
.text:00407743		       push    eax	       ; _Count
.text:00407744		       mov     eax, [ebp+names]
.text:00407747		       push    esi	       ; _Src
.text:00407748		       push    10h	       ; _SizeInBytes
.text:0040774A		       add     eax, 80h
.text:0040774F
.text:0040774F loc_40774F:			       ; CODE XREF: ___lc_strtolc+B7j
.text:0040774F		       push    eax	       ; _Dst
.text:00407750
.text:00407750 loc_407750:			       ; CODE XREF: ___lc_strtolc+9Bj
.text:00407750		       call    _strncpy_s
.text:00407755		       add     esp, 10h
.text:00407758		       test    eax, eax
.text:0040775A		       jz      short loc_40776B
.text:0040775C		       xor     eax, eax
.text:0040775E		       push    eax	       ; pReserved
.text:0040775F		       push    eax	       ; nLine
.text:00407760		       push    eax	       ; pszFile
.text:00407761		       push    eax	       ; pszFunction
.text:00407762		       push    eax	       ; pszExpression
.text:00407763		       call    __invoke_watson
.text:00407768		       add     esp, 14h
.text:0040776B
.text:0040776B loc_40776B:			       ; CODE XREF: ___lc_strtolc+E4j
.text:0040776B		       cmp     bl, 2Ch
.text:0040776E		       jz      loc_407699
.text:00407774		       test    bl, bl
.text:00407776		       jz      loc_407699
.text:0040777C		       inc     [ebp+i]
.text:0040777F		       lea     esi, [edi+1]
.text:00407782		       push    offset control  ; "_.,"
.text:00407787		       push    esi	       ; string
.text:00407788		       call    _strcspn
.text:0040778D		       test    eax, eax
.text:0040778F
.text:0040778F loc_40778F:			       ; CODE XREF: ___lc_strtolc+72j
.text:0040778F		       pop     ecx
.text:00407790		       pop     ecx
.text:00407791		       jnz     loc_4076ED
.text:00407797
.text:00407797 loc_407797:			       ; CODE XREF: ___lc_strtolc+85j
.text:00407797					       ; ___lc_strtolc+8Ej ...
.text:00407797		       or      eax, 0FFFFFFFFh
.text:0040779A
.text:0040779A loc_40779A:			       ; CODE XREF: ___lc_strtolc+25j
.text:0040779A		       pop     edi
.text:0040779B		       pop     esi
.text:0040779C		       pop     ebx
.text:0040779D		       pop     ebp
.text:0040779E		       retn
.text:0040779E ___lc_strtolc   endp
.text:0040779E
.text:0040779F
.text:0040779F ; =============== S U B R O U T I N E =======================================
.text:0040779F
.text:0040779F ; Attributes: bp-based frame
.text:0040779F
.text:0040779F ; void __cdecl __lc_lctostr(char	*locale, unsigned int sizeInBytes, tagLC_STRINGS *names)
.text:0040779F ___lc_lctostr   proc near	       ; CODE XREF: __expandlocale+12Fp
.text:0040779F
.text:0040779F locale	       = dword ptr  8
.text:0040779F sizeInBytes     = dword ptr  0Ch
.text:0040779F names	       = dword ptr  10h
.text:0040779F
.text:0040779F		       push    ebp
.text:004077A0		       mov     ebp, esp
.text:004077A2		       push    ebx
.text:004077A3		       push    esi
.text:004077A4		       mov     esi, [ebp+names]
.text:004077A7		       push    esi	       ; _Src
.text:004077A8		       push    [ebp+sizeInBytes] ; _SizeInBytes
.text:004077AB		       push    [ebp+locale]    ; _Dst
.text:004077AE		       call    _strcpy_s
.text:004077B3		       add     esp, 0Ch
.text:004077B6		       xor     ebx, ebx
.text:004077B8		       test    eax, eax
.text:004077BA		       jz      short loc_4077C9
.text:004077BC		       push    ebx	       ; pReserved
.text:004077BD		       push    ebx	       ; nLine
.text:004077BE		       push    ebx	       ; pszFile
.text:004077BF		       push    ebx	       ; pszFunction
.text:004077C0		       push    ebx	       ; pszExpression
.text:004077C1		       call    __invoke_watson
.text:004077C6		       add     esp, 14h
.text:004077C9
.text:004077C9 loc_4077C9:			       ; CODE XREF: ___lc_lctostr+1Bj
.text:004077C9		       lea     eax, [esi+40h]
.text:004077CC		       cmp     [eax], bl
.text:004077CE		       jz      short loc_4077E6
.text:004077D0		       push    eax
.text:004077D1		       push    offset a_       ; "_"
.text:004077D6		       push    2	       ; n
.text:004077D8		       push    [ebp+sizeInBytes] ; sizeInBytes
.text:004077DB		       push    [ebp+locale]    ; outstr
.text:004077DE		       call    __strcats
.text:004077E3		       add     esp, 14h
.text:004077E6
.text:004077E6 loc_4077E6:			       ; CODE XREF: ___lc_lctostr+2Fj
.text:004077E6		       lea     eax, [esi+80h]
.text:004077EC		       cmp     [eax], bl
.text:004077EE		       pop     esi
.text:004077EF		       pop     ebx
.text:004077F0		       jz      short loc_407808
.text:004077F2		       push    eax
.text:004077F3		       push    offset a__0     ; "."
.text:004077F8		       push    2	       ; n
.text:004077FA		       push    [ebp+sizeInBytes] ; sizeInBytes
.text:004077FD		       push    [ebp+locale]    ; outstr
.text:00407800		       call    __strcats
.text:00407805		       add     esp, 14h
.text:00407808
.text:00407808 loc_407808:			       ; CODE XREF: ___lc_lctostr+51j
.text:00407808		       pop     ebp
.text:00407809		       retn
.text:00407809 ___lc_lctostr   endp
.text:00407809
.text:0040780A
.text:0040780A ; =============== S U B R O U T I N E =======================================
.text:0040780A
.text:0040780A
.text:0040780A ; char *__usercall setlocale_get_all<eax>(threadlocaleinfostruct	*ploci<esi>)
.text:0040780A _setlocale_get_all proc near	       ; CODE XREF: _setlocale_nolock:loc_407FFCp
.text:0040780A
.text:0040780A i	       = dword ptr -10h
.text:0040780A same	       = dword ptr -0Ch
.text:0040780A refcount	       = dword ptr -8
.text:0040780A pBlock	       = dword ptr -4
.text:0040780A
.text:0040780A ploci = esi
.text:0040780A		       sub     esp, 10h
.text:0040780D		       push    ebx
.text:0040780E		       xor     ebx, ebx
.text:00407810		       inc     ebx
.text:00407811		       push    355h	       ; cb
.text:00407816		       mov     [esp+18h+refcount], ebx
.text:0040781A		       call    __malloc_crt
.text:0040781F		       test    eax, eax
.text:00407821		       pop     ecx
.text:00407822		       mov     [esp+14h+pBlock], eax
.text:00407826		       jz      loc_407976
.text:0040782C		       push    ebp
.text:0040782D		       push    edi
.text:0040782E		       lea     edi, [eax+4]
.text:00407831		       mov     byte ptr	[edi], 0
.text:00407834		       mov     [eax], ebx
.text:00407836		       lea     ebp, [ploci+10h]
.text:00407839		       mov     [esp+1Ch+same], ebx
.text:0040783D		       lea     ebx, [ebp+48h]
.text:00407840		       push    dword ptr [ebx]
.text:00407842		       push    offset asc_41E4B0 ; "="
.text:00407847		       push    ds:off_41E3E4
.text:0040784D		       push    3	       ; n
.text:0040784F		       push    351h	       ; sizeInBytes
.text:00407854		       push    edi	       ; outstr
.text:00407855		       call    __strcats
.text:0040785A		       add     esp, 18h
.text:0040785D		       mov     [esp+1Ch+i], offset off_41E3E4
.text:00407865
.text:00407865 loc_407865:			       ; CODE XREF: _setlocale_get_all+D1j
.text:00407865		       push    offset asc_41E4AC ; ";"
.text:0040786A		       push    351h	       ; _SizeInBytes
.text:0040786F		       push    edi	       ; _Dst
.text:00407870		       call    _strcat_s
.text:00407875		       add     esp, 0Ch
.text:00407878		       test    eax, eax
.text:0040787A		       jz      short loc_40788B
.text:0040787C		       xor     eax, eax
.text:0040787E		       push    eax	       ; pReserved
.text:0040787F		       push    eax	       ; nLine
.text:00407880		       push    eax	       ; pszFile
.text:00407881		       push    eax	       ; pszFunction
.text:00407882		       push    eax	       ; pszExpression
.text:00407883		       call    __invoke_watson
.text:00407888		       add     esp, 14h
.text:0040788B
.text:0040788B loc_40788B:			       ; CODE XREF: _setlocale_get_all+70j
.text:0040788B		       push    dword ptr [ebp+58h] ; str2
.text:0040788E		       push    dword ptr [ebx] ; str1
.text:00407890		       call    _strcmp
.text:00407895		       test    eax, eax
.text:00407897		       pop     ecx
.text:00407898		       pop     ecx
.text:00407899		       jz      short loc_4078A0
.text:0040789B		       and     [esp+1Ch+refcount], 0
.text:004078A0
.text:004078A0 loc_4078A0:			       ; CODE XREF: _setlocale_get_all+8Fj
.text:004078A0		       inc     [esp+1Ch+same]
.text:004078A4		       mov     eax, [esp+1Ch+same]
.text:004078A8		       add     [esp+1Ch+i], 0Ch
.text:004078AD		       shl     eax, 4
.text:004078B0		       lea     ebp, [eax+ploci]
.text:004078B3		       mov     eax, [esp+1Ch+i]
.text:004078B7		       lea     ebx, [ebp+48h]
.text:004078BA		       push    dword ptr [ebx]
.text:004078BC		       push    offset asc_41E4B0 ; "="
.text:004078C1		       push    dword ptr [eax]
.text:004078C3		       push    3	       ; n
.text:004078C5		       push    351h	       ; sizeInBytes
.text:004078CA		       push    edi	       ; outstr
.text:004078CB		       call    __strcats
.text:004078D0		       add     esp, 18h
.text:004078D3		       cmp     [esp+1Ch+i], offset off_41E414
.text:004078DB		       jl      short loc_407865
.text:004078DD		       xor     ebp, ebp
.text:004078DF		       cmp     [esp+1Ch+refcount], ebp
.text:004078E3		       jnz     short loc_407927
.text:004078E5		       mov     eax, [ploci+50h]
.text:004078E8		       cmp     eax, ebp
.text:004078EA		       mov     ebx, ds:__imp__InterlockedDecrement@4 ; InterlockedDecrement(x)
.text:004078F0		       jz      short loc_407902
.text:004078F2		       push    eax	       ; lpAddend
.text:004078F3		       call    ebx ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:004078F5		       test    eax, eax
.text:004078F7		       jnz     short loc_407902
.text:004078F9		       push    dword ptr [ploci+50h] ; pBlock
.text:004078FC		       call    _free
.text:00407901		       pop     ecx
.text:00407902
.text:00407902 loc_407902:			       ; CODE XREF: _setlocale_get_all+E6j
.text:00407902					       ; _setlocale_get_all+EDj
.text:00407902		       mov     eax, [ploci+54h]
.text:00407905		       cmp     eax, ebp
.text:00407907		       jz      short loc_407919
.text:00407909		       push    eax	       ; lpAddend
.text:0040790A		       call    ebx ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:0040790C		       test    eax, eax
.text:0040790E		       jnz     short loc_407919
.text:00407910		       push    dword ptr [ploci+54h] ; pBlock
.text:00407913		       call    _free
.text:00407918		       pop     ecx
.text:00407919
.text:00407919 loc_407919:			       ; CODE XREF: _setlocale_get_all+FDj
.text:00407919					       ; _setlocale_get_all+104j
.text:00407919		       mov     eax, [esp+1Ch+pBlock]
.text:0040791D		       mov     [ploci+50h], eax
.text:00407920		       mov     [ploci+48h], edi
.text:00407923		       mov     eax, edi
.text:00407925		       jmp     short loc_40796E
.text:00407927 ; ---------------------------------------------------------------------------
.text:00407927
.text:00407927 loc_407927:			       ; CODE XREF: _setlocale_get_all+D9j
.text:00407927		       push    [esp+1Ch+pBlock]	; pBlock
.text:0040792B		       call    _free
.text:00407930		       mov     eax, [ploci+50h]
.text:00407933		       cmp     eax, ebp
.text:00407935		       mov     edi, ds:__imp__InterlockedDecrement@4 ; InterlockedDecrement(x)
.text:0040793B		       pop     ecx
.text:0040793C		       jz      short loc_40794E
.text:0040793E		       push    eax	       ; lpAddend
.text:0040793F		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407941		       test    eax, eax
.text:00407943		       jnz     short loc_40794E
.text:00407945		       push    dword ptr [ploci+50h] ; pBlock
.text:00407948		       call    _free
.text:0040794D		       pop     ecx
.text:0040794E
.text:0040794E loc_40794E:			       ; CODE XREF: _setlocale_get_all+132j
.text:0040794E					       ; _setlocale_get_all+139j
.text:0040794E		       mov     eax, [ploci+54h]
.text:00407951		       cmp     eax, ebp
.text:00407953		       jz      short loc_407965
.text:00407955		       push    eax	       ; lpAddend
.text:00407956		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407958		       test    eax, eax
.text:0040795A		       jnz     short loc_407965
.text:0040795C		       push    dword ptr [ploci+54h] ; pBlock
.text:0040795F		       call    _free
.text:00407964		       pop     ecx
.text:00407965
.text:00407965 loc_407965:			       ; CODE XREF: _setlocale_get_all+149j
.text:00407965					       ; _setlocale_get_all+150j
.text:00407965		       mov     eax, [ploci+68h]
.text:00407968		       mov     [ploci+50h], ebp
.text:0040796B		       mov     [ploci+48h], ebp
.text:0040796E
.text:0040796E loc_40796E:			       ; CODE XREF: _setlocale_get_all+11Bj
.text:0040796E		       pop     edi
.text:0040796F		       mov     [ploci+4Ch], ebp
.text:00407972		       mov     [ploci+54h], ebp
.text:00407975		       pop     ebp
.text:00407976
.text:00407976 loc_407976:			       ; CODE XREF: _setlocale_get_all+1Cj
.text:00407976		       pop     ebx
.text:00407977		       add     esp, 10h
.text:0040797A		       retn
.text:0040797A _setlocale_get_all endp
.text:0040797A
.text:0040797B
.text:0040797B ; =============== S U B R O U T I N E =======================================
.text:0040797B
.text:0040797B ; Attributes: bp-based frame fpd=60h
.text:0040797B
.text:0040797B ; char *__cdecl _expandlocale(char *expr, char *output, unsigned	int sizeInChars, tagLC_ID *id, unsigned	int *cp, int category)
.text:0040797B __expandlocale  proc near	       ; CODE XREF: _setlocale_set_cat+41p
.text:0040797B					       ; _setlocale_nolock+168p
.text:0040797B
.text:0040797B charactersInSource= dword ptr -0B4h
.text:0040797B charactersInExpression= dword ptr -0B0h
.text:0040797B pcachecp	       = dword ptr -0ACh
.text:0040797B cachein	       = dword ptr -0A8h
.text:0040797B dst	       = dword ptr -0A4h
.text:0040797B var_A0	       = dword ptr -0A0h
.text:0040797B _Dst	       = dword ptr -9Ch
.text:0040797B cacheout	       = dword ptr -98h
.text:0040797B names	       = tagLC_STRINGS ptr -94h
.text:0040797B var_4	       = dword ptr -4
.text:0040797B expr	       = dword ptr  8
.text:0040797B output	       = dword ptr  0Ch
.text:0040797B sizeInChars     = dword ptr  10h
.text:0040797B id	       = dword ptr  14h
.text:0040797B cp	       = dword ptr  18h
.text:0040797B category	       = dword ptr  1Ch
.text:0040797B
.text:0040797B		       push    ebp
.text:0040797C		       lea     ebp, [esp-60h]
.text:00407980		       sub     esp, 0B4h
.text:00407986		       mov     eax, ___security_cookie
.text:0040798B		       xor     eax, ebp
.text:0040798D		       mov     [ebp+60h+var_4],	eax
.text:00407990		       mov     eax, [ebp+60h+output]
.text:00407993		       push    ebx
.text:00407994		       push    esi
.text:00407995		       mov     esi, [ebp+60h+expr]
.text:00407998		       push    edi
.text:00407999		       mov     edi, [ebp+60h+id]
.text:0040799C		       mov     [ebp+60h+_Dst], eax
.text:0040799F		       mov     eax, [ebp+60h+cp]
.text:004079A2		       mov     [ebp+60h+dst], edi
.text:004079A5		       mov     [ebp+60h+var_A0], eax
.text:004079A8		       call    __getptd
.text:004079AD		       add     eax, 9Ch
.text:004079B2		       lea     ecx, [eax+28h]
.text:004079B5		       mov     [ebp+60h+pcachecp], ecx
.text:004079B8		       lea     ecx, [eax+2Ch]
.text:004079BB		       lea     ebx, [eax+20h]
.text:004079BE		       add     eax, 0AFh
.text:004079C3		       test    esi, esi
.text:004079C5		       mov     [ebp+60h+cachein], ecx
.text:004079C8		       mov     [ebp+60h+cacheout], eax
.text:004079CB		       jz      loc_407B3B
.text:004079D1		       cmp     [ebp+60h+_Dst], 0
.text:004079D5		       jz      loc_407B3B
.text:004079DB		       cmp     [ebp+60h+sizeInChars], 0
.text:004079DF		       jz      loc_407B3B
.text:004079E5		       cmp     byte ptr	[esi], 43h
.text:004079E8		       jnz     short loc_407A36
.text:004079EA		       cmp     byte ptr	[esi+1], 0
.text:004079EE		       jnz     short loc_407A36
.text:004079F0		       push    offset aC       ; "C"
.text:004079F5		       push    [ebp+60h+sizeInChars] ; _SizeInBytes
.text:004079F8		       push    [ebp+60h+_Dst]  ; _Dst
.text:004079FB		       call    _strcpy_s
.text:00407A00		       add     esp, 0Ch
.text:00407A03		       xor     esi, esi
.text:00407A05		       test    eax, eax
.text:00407A07		       jz      short loc_407A16
.text:00407A09		       push    esi	       ; pReserved
.text:00407A0A		       push    esi	       ; nLine
.text:00407A0B		       push    esi	       ; pszFile
.text:00407A0C		       push    esi	       ; pszFunction
.text:00407A0D		       push    esi	       ; pszExpression
.text:00407A0E		       call    __invoke_watson
.text:00407A13		       add     esp, 14h
.text:00407A16
.text:00407A16 loc_407A16:			       ; CODE XREF: __expandlocale+8Cj
.text:00407A16		       cmp     edi, esi
.text:00407A18		       jz      short loc_407A25
.text:00407A1A		       mov     [edi], si
.text:00407A1D		       mov     [edi+2],	si
.text:00407A21		       mov     [edi+4],	si
.text:00407A25
.text:00407A25 loc_407A25:			       ; CODE XREF: __expandlocale+9Dj
.text:00407A25		       mov     eax, [ebp+60h+var_A0]
.text:00407A28		       cmp     eax, esi
.text:00407A2A		       jz      short loc_407A2E
.text:00407A2C		       mov     [eax], esi
.text:00407A2E
.text:00407A2E loc_407A2E:			       ; CODE XREF: __expandlocale+AFj
.text:00407A2E		       mov     eax, [ebp+60h+_Dst]
.text:00407A31		       jmp     loc_407B3D
.text:00407A36 ; ---------------------------------------------------------------------------
.text:00407A36
.text:00407A36 loc_407A36:			       ; CODE XREF: __expandlocale+6Dj
.text:00407A36					       ; __expandlocale+73j
.text:00407A36		       push    esi	       ; buf
.text:00407A37		       call    _strlen
.text:00407A3C		       mov     edi, 83h
.text:00407A41		       cmp     eax, edi
.text:00407A43		       pop     ecx
.text:00407A44		       mov     [ebp+60h+charactersInExpression], eax
.text:00407A47		       jnb     short loc_407A6B
.text:00407A49		       push    esi	       ; str2
.text:00407A4A		       push    [ebp+60h+cacheout] ; str1
.text:00407A4D		       call    _strcmp
.text:00407A52		       test    eax, eax
.text:00407A54		       pop     ecx
.text:00407A55		       pop     ecx
.text:00407A56		       jz      loc_407AEA
.text:00407A5C		       push    esi	       ; str2
.text:00407A5D		       push    [ebp+60h+cachein] ; str1
.text:00407A60		       call    _strcmp
.text:00407A65		       test    eax, eax
.text:00407A67		       pop     ecx
.text:00407A68		       pop     ecx
.text:00407A69		       jz      short loc_407AEA
.text:00407A6B
.text:00407A6B loc_407A6B:			       ; CODE XREF: __expandlocale+CCj
.text:00407A6B		       and     [ebp+60h+charactersInSource], 0
.text:00407A6F		       lea     eax, [ebp+60h+names]
.text:00407A72		       push    esi	       ; locale
.text:00407A73		       push    eax	       ; names
.text:00407A74		       call    ___lc_strtolc
.text:00407A79		       test    eax, eax
.text:00407A7B		       pop     ecx
.text:00407A7C		       pop     ecx
.text:00407A7D		       jnz     loc_407B3B
.text:00407A83		       lea     eax, [ebp+60h+names]
.text:00407A86		       push    eax	       ; lpOutStr
.text:00407A87		       push    ebx	       ; lpOutId
.text:00407A88		       push    eax	       ; lpInStr
.text:00407A89		       call    ___get_qualified_locale
.text:00407A8E		       add     esp, 0Ch
.text:00407A91		       test    eax, eax
.text:00407A93		       jz      loc_407B3B
.text:00407A99		       movzx   eax, word ptr [ebx+4]
.text:00407A9D		       mov     ecx, [ebp+60h+pcachecp]
.text:00407AA0		       mov     [ecx], eax
.text:00407AA2		       lea     eax, [ebp+60h+names]
.text:00407AA5		       push    eax	       ; names
.text:00407AA6		       push    edi	       ; sizeInBytes
.text:00407AA7		       push    [ebp+60h+cacheout] ; locale
.text:00407AAA		       call    ___lc_lctostr
.text:00407AAF		       add     esp, 0Ch
.text:00407AB2		       cmp     byte ptr	[esi], 0
.text:00407AB5		       jz      short loc_407ABE
.text:00407AB7		       mov     eax, [ebp+60h+charactersInExpression]
.text:00407ABA		       cmp     eax, edi
.text:00407ABC		       jb      short loc_407AC6
.text:00407ABE
.text:00407ABE loc_407ABE:			       ; CODE XREF: __expandlocale+13Aj
.text:00407ABE		       mov     eax, [ebp+60h+charactersInSource]
.text:00407AC1		       mov     esi, offset word_41E4B2
.text:00407AC6
.text:00407AC6 loc_407AC6:			       ; CODE XREF: __expandlocale+141j
.text:00407AC6		       inc     eax
.text:00407AC7		       push    eax	       ; _Count
.text:00407AC8		       push    esi	       ; _Src
.text:00407AC9		       push    edi	       ; _SizeInBytes
.text:00407ACA		       push    [ebp+60h+cachein] ; _Dst
.text:00407ACD		       call    _strncpy_s
.text:00407AD2		       add     esp, 10h
.text:00407AD5		       test    eax, eax
.text:00407AD7		       jz      short loc_407AEA
.text:00407AD9		       xor     esi, esi
.text:00407ADB		       push    esi	       ; pReserved
.text:00407ADC		       push    esi	       ; nLine
.text:00407ADD		       push    esi	       ; pszFile
.text:00407ADE		       push    esi	       ; pszFunction
.text:00407ADF		       push    esi	       ; pszExpression
.text:00407AE0		       call    __invoke_watson
.text:00407AE5		       add     esp, 14h
.text:00407AE8		       jmp     short loc_407AEC
.text:00407AEA ; ---------------------------------------------------------------------------
.text:00407AEA
.text:00407AEA loc_407AEA:			       ; CODE XREF: __expandlocale+DBj
.text:00407AEA					       ; __expandlocale+EEj ...
.text:00407AEA		       xor     esi, esi
.text:00407AEC
.text:00407AEC loc_407AEC:			       ; CODE XREF: __expandlocale+16Dj
.text:00407AEC		       cmp     [ebp+60h+dst], esi
.text:00407AEF		       jz      short loc_407AFF
.text:00407AF1		       push    6	       ; count
.text:00407AF3		       push    ebx	       ; src
.text:00407AF4		       push    [ebp+60h+dst]   ; dst
.text:00407AF7		       call    _memcpy
.text:00407AFC		       add     esp, 0Ch
.text:00407AFF
.text:00407AFF loc_407AFF:			       ; CODE XREF: __expandlocale+174j
.text:00407AFF		       cmp     [ebp+60h+var_A0], esi
.text:00407B02		       jz      short loc_407B14
.text:00407B04		       push    4	       ; count
.text:00407B06		       push    [ebp+60h+pcachecp] ; src
.text:00407B09		       push    [ebp+60h+var_A0]	; dst
.text:00407B0C		       call    _memcpy
.text:00407B11		       add     esp, 0Ch
.text:00407B14
.text:00407B14 loc_407B14:			       ; CODE XREF: __expandlocale+187j
.text:00407B14		       push    [ebp+60h+cacheout] ; _Src
.text:00407B17		       push    [ebp+60h+sizeInChars] ; _SizeInBytes
.text:00407B1A		       push    [ebp+60h+_Dst]  ; _Dst
.text:00407B1D		       call    _strcpy_s
.text:00407B22		       add     esp, 0Ch
.text:00407B25		       test    eax, eax
.text:00407B27		       jz      short loc_407B36
.text:00407B29		       push    esi	       ; pReserved
.text:00407B2A		       push    esi	       ; nLine
.text:00407B2B		       push    esi	       ; pszFile
.text:00407B2C		       push    esi	       ; pszFunction
.text:00407B2D		       push    esi	       ; pszExpression
.text:00407B2E		       call    __invoke_watson
.text:00407B33		       add     esp, 14h
.text:00407B36
.text:00407B36 loc_407B36:			       ; CODE XREF: __expandlocale+1ACj
.text:00407B36		       mov     eax, [ebp+60h+cacheout]
.text:00407B39		       jmp     short loc_407B3D
.text:00407B3B ; ---------------------------------------------------------------------------
.text:00407B3B
.text:00407B3B loc_407B3B:			       ; CODE XREF: __expandlocale+50j
.text:00407B3B					       ; __expandlocale+5Aj ...
.text:00407B3B		       xor     eax, eax
.text:00407B3D
.text:00407B3D loc_407B3D:			       ; CODE XREF: __expandlocale+B6j
.text:00407B3D					       ; __expandlocale+1BEj
.text:00407B3D		       mov     ecx, [ebp+60h+var_4]
.text:00407B40		       pop     edi
.text:00407B41		       pop     esi
.text:00407B42		       xor     ecx, ebp
.text:00407B44		       pop     ebx
.text:00407B45		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00407B4A		       add     ebp, 60h
.text:00407B4D		       leave
.text:00407B4E		       retn
.text:00407B4E __expandlocale  endp
.text:00407B4E
.text:00407B4F
.text:00407B4F ; =============== S U B R O U T I N E =======================================
.text:00407B4F
.text:00407B4F ; Attributes: bp-based frame fpd=74h
.text:00407B4F
.text:00407B4F ; char *__usercall setlocale_set_cat<eax>(threadlocaleinfostruct	*ploci<esi>, int category, const char *locale<ecx>)
.text:00407B4F _setlocale_set_cat proc near	       ; CODE XREF: _setlocale_nolock+2Bp
.text:00407B4F					       ; _setlocale_nolock+12Dp ...
.text:00407B4F
.text:00407B4F oldid	       = tagLC_ID ptr -1C4h
.text:00407B4F buf2	       = _is_ctype_compatible ptr -1BCh
.text:00407B4F oldcodepage     = dword ptr -1B4h
.text:00407B4F idtemp	       = tagLC_ID ptr -1B0h
.text:00407B4F oldhandle       = dword ptr -1A8h
.text:00407B4F oldlocale       = dword ptr -1A4h
.text:00407B4F buf1	       = _is_ctype_compatible ptr -1A0h
.text:00407B4F cptemp	       = dword ptr -198h
.text:00407B4F var_194	       = dword ptr -194h
.text:00407B4F pch	       = dword ptr -190h
.text:00407B4F i	       = dword ptr -18Ch
.text:00407B4F out	       = word ptr -188h
.text:00407B4F lctemp	       = byte ptr -88h
.text:00407B4F var_4	       = dword ptr -4
.text:00407B4F category	       = dword ptr  8
.text:00407B4F
.text:00407B4F ploci = esi
.text:00407B4F locale =	ecx
.text:00407B4F		       push    ebp
.text:00407B50		       lea     ebp, [esp-74h]
.text:00407B54		       sub     esp, 1C4h
.text:00407B5A		       mov     eax, ___security_cookie
.text:00407B5F		       xor     eax, ebp
.text:00407B61		       mov     [ebp+74h+var_4],	eax
.text:00407B64		       push    ebx
.text:00407B65		       push    edi
.text:00407B66		       mov     ebx, locale
.text:00407B68		       call    __getptd
.text:00407B6D		       push    [ebp+74h+category] ; category
.text:00407B70		       mov     edi, eax
.text:00407B72		       lea     eax, [ebp+74h+cptemp]
.text:00407B78		       push    eax	       ; cp
.text:00407B79		       lea     eax, [ebp+74h+idtemp]
.text:00407B7F		       push    eax	       ; id
.text:00407B80		       push    83h	       ; sizeInChars
.text:00407B85		       lea     eax, [ebp+74h+lctemp]
.text:00407B88		       push    eax	       ; output
.text:00407B89		       push    ebx	       ; expr
.text:00407B8A		       add     edi, 1D0h
.text:00407B90		       call    __expandlocale
.text:00407B95		       add     esp, 18h
.text:00407B98		       test    eax, eax
.text:00407B9A		       jnz     short loc_407BA3
.text:00407B9C
.text:00407B9C loc_407B9C:			       ; CODE XREF: _setlocale_set_cat+95j
.text:00407B9C					       ; _setlocale_set_cat+28Cj
.text:00407B9C		       xor     eax, eax
.text:00407B9E		       jmp     loc_407E34
.text:00407BA3 ; ---------------------------------------------------------------------------
.text:00407BA3
.text:00407BA3 loc_407BA3:			       ; CODE XREF: _setlocale_set_cat+4Bj
.text:00407BA3		       mov     eax, [ebp+74h+category]
.text:00407BA6		       shl     eax, 4
.text:00407BA9		       lea     ebx, [eax+ploci]
.text:00407BAC		       push    dword ptr [ebx+48h] ; str2
.text:00407BAF		       lea     eax, [ebp+74h+lctemp]
.text:00407BB2		       push    eax	       ; str1
.text:00407BB3		       call    _strcmp
.text:00407BB8		       test    eax, eax
.text:00407BBA		       pop     locale
.text:00407BBB		       pop     locale
.text:00407BBC		       jz      loc_407E31
.text:00407BC2		       lea     eax, [ebp+74h+lctemp]
.text:00407BC5		       push    eax	       ; buf
.text:00407BC6		       call    _strlen
.text:00407BCB		       add     eax, 5
.text:00407BCE		       push    eax	       ; cb
.text:00407BCF		       mov     [ebp+74h+i], eax
.text:00407BD5		       call    __malloc_crt
.text:00407BDA		       test    eax, eax
.text:00407BDC		       pop     locale
.text:00407BDD		       pop     locale
.text:00407BDE		       mov     [ebp+74h+pch], eax
.text:00407BE4		       jz      short loc_407B9C
.text:00407BE6		       mov     eax, [ebx+48h]
.text:00407BE9		       mov     locale, [ebp+74h+category]
.text:00407BEC		       mov     [ebp+74h+oldlocale], eax
.text:00407BF2		       lea     eax, [ploci+locale*4+0Ch]
.text:00407BF6		       add     locale, 6
.text:00407BF9		       imul    locale, 6
.text:00407BFC		       mov     [ebp+74h+var_194], eax
.text:00407C02		       mov     eax, [eax]
.text:00407C04		       mov     [ebp+74h+oldhandle], eax
.text:00407C0A		       lea     eax, [locale+ploci]
.text:00407C0D		       push    6	       ; count
.text:00407C0F		       push    eax	       ; src
.text:00407C10		       mov     [ebp+74h+buf1.is_clike],	eax
.text:00407C16		       lea     eax, [ebp+74h+oldid]
.text:00407C1C		       push    eax	       ; dst
.text:00407C1D		       call    _memcpy
.text:00407C22		       mov     eax, [ploci+4]
.text:00407C25		       lea     locale, [ebp+74h+lctemp]
.text:00407C28		       push    locale	       ; _Src
.text:00407C29		       mov     locale, [ebp+74h+i]
.text:00407C2F		       mov     [ebp+74h+oldcodepage], eax
.text:00407C35		       mov     eax, [ebp+74h+pch]
.text:00407C3B		       add     locale, 0FFFFFFFCh
.text:00407C3E		       add     eax, 4
.text:00407C41		       push    locale	       ; _SizeInBytes
.text:00407C42		       push    eax	       ; _Dst
.text:00407C43		       call    _strcpy_s
.text:00407C48		       add     esp, 18h
.text:00407C4B		       test    eax, eax
.text:00407C4D		       jz      short loc_407C5E
.text:00407C4F		       xor     eax, eax
.text:00407C51		       push    eax	       ; pReserved
.text:00407C52		       push    eax	       ; nLine
.text:00407C53		       push    eax	       ; pszFile
.text:00407C54		       push    eax	       ; pszFunction
.text:00407C55		       push    eax	       ; pszExpression
.text:00407C56		       call    __invoke_watson
.text:00407C5B		       add     esp, 14h
.text:00407C5E
.text:00407C5E loc_407C5E:			       ; CODE XREF: _setlocale_set_cat+FEj
.text:00407C5E		       mov     eax, [ebp+74h+pch]
.text:00407C64		       mov     locale, [ebp+74h+var_194]
.text:00407C6A		       add     eax, 4
.text:00407C6D		       mov     [ebx+48h], eax
.text:00407C70		       movzx   eax, [ebp+74h+idtemp.wLanguage]
.text:00407C77		       mov     [locale], eax
.text:00407C79		       push    6	       ; count
.text:00407C7B		       lea     eax, [ebp+74h+idtemp]
.text:00407C81		       push    eax	       ; src
.text:00407C82		       push    [ebp+74h+buf1.is_clike] ; dst
.text:00407C88		       call    _memcpy
.text:00407C8D		       add     esp, 0Ch
.text:00407C90		       cmp     [ebp+74h+category], 2
.text:00407C94		       jnz     loc_407D8E
.text:00407C9A		       mov     eax, [ebp+74h+cptemp]
.text:00407CA0		       and     [ebp+74h+i], 0
.text:00407CA7		       mov     [ploci+4], eax
.text:00407CAA		       mov     eax, [edi+24h]
.text:00407CAD		       mov     locale, [edi+20h]
.text:00407CB0		       mov     [ebp+74h+buf1.is_clike],	eax
.text:00407CB6		       mov     eax, edi
.text:00407CB8
.text:00407CB8 loc_407CB8:			       ; CODE XREF: _setlocale_set_cat+1A2j
.text:00407CB8		       mov     edx, [ploci+4]
.text:00407CBB		       cmp     edx, [eax]
.text:00407CBD		       jz      short loc_407CF5
.text:00407CBF		       mov     edx, [eax]
.text:00407CC1		       inc     [ebp+74h+i]
.text:00407CC7		       mov     [eax], locale
.text:00407CC9		       mov     locale, [ebp+74h+buf1.is_clike]
.text:00407CCF		       mov     [ebp+74h+buf2.id], edx
.text:00407CD5		       mov     edx, [eax+4]
.text:00407CD8		       mov     [eax+4],	locale
.text:00407CDB		       mov     locale, [ebp+74h+buf2.id]
.text:00407CE1		       add     eax, 8
.text:00407CE4		       cmp     [ebp+74h+i], 5
.text:00407CEB		       mov     [ebp+74h+buf1.is_clike],	edx
.text:00407CF1		       jl      short loc_407CB8
.text:00407CF3		       jmp     short loc_407D17
.text:00407CF5 ; ---------------------------------------------------------------------------
.text:00407CF5
.text:00407CF5 loc_407CF5:			       ; CODE XREF: _setlocale_set_cat+16Ej
.text:00407CF5		       mov     eax, [ebp+74h+i]
.text:00407CFB		       test    eax, eax
.text:00407CFD		       jz      short loc_407D17
.text:00407CFF		       lea     eax, [edi+eax*8]
.text:00407D02		       mov     edx, [eax]
.text:00407D04		       mov     [edi], edx
.text:00407D06		       mov     edx, [eax+4]
.text:00407D09		       mov     [edi+4],	edx
.text:00407D0C		       mov     [eax], locale
.text:00407D0E		       mov     locale, [ebp+74h+buf1.is_clike]
.text:00407D14		       mov     [eax+4],	locale
.text:00407D17
.text:00407D17 loc_407D17:			       ; CODE XREF: _setlocale_set_cat+1A4j
.text:00407D17					       ; _setlocale_set_cat+1AEj
.text:00407D17		       cmp     [ebp+74h+i], 5
.text:00407D1E		       jnz     short loc_407D85
.text:00407D20		       push    1	       ; bError
.text:00407D22		       push    dword ptr [ploci+14h] ; lcid
.text:00407D25		       lea     eax, [ebp+74h+out]
.text:00407D2B		       push    dword ptr [ploci+4] ; code_page
.text:00407D2E		       push    eax	       ; lpCharType
.text:00407D2F		       push    7Fh	       ; cchSrc
.text:00407D31		       push    offset _first_127char ; lpSrcStr
.text:00407D36		       push    1	       ; dwInfoType
.text:00407D38		       push    0	       ; plocinfo
.text:00407D3A		       call    ___crtGetStringTypeA
.text:00407D3F		       add     esp, 20h
.text:00407D42		       test    eax, eax
.text:00407D44		       jz      short loc_407D7C
.text:00407D46		       xor     eax, eax
.text:00407D48
.text:00407D48 loc_407D48:			       ; CODE XREF: _setlocale_set_cat+207j
.text:00407D48		       and     [ebp+eax*2+74h+out], 1FFh
.text:00407D52		       inc     eax
.text:00407D53		       cmp     eax, 7Fh
.text:00407D56		       jb      short loc_407D48
.text:00407D58		       push    0FEh	       ; siz
.text:00407D5D		       push    _ctype_loc_style	; rhs
.text:00407D63		       lea     eax, [ebp+74h+out]
.text:00407D69		       push    eax	       ; lhs
.text:00407D6A		       call    _memcmp
.text:00407D6F		       add     esp, 0Ch
.text:00407D72		       neg     eax
.text:00407D74		       sbb     eax, eax
.text:00407D76		       inc     eax
.text:00407D77		       mov     [edi+4],	eax
.text:00407D7A		       jmp     short loc_407D80
.text:00407D7C ; ---------------------------------------------------------------------------
.text:00407D7C
.text:00407D7C loc_407D7C:			       ; CODE XREF: _setlocale_set_cat+1F5j
.text:00407D7C		       and     dword ptr [edi+4], 0
.text:00407D80
.text:00407D80 loc_407D80:			       ; CODE XREF: _setlocale_set_cat+22Bj
.text:00407D80		       mov     eax, [ploci+4]
.text:00407D83		       mov     [edi], eax
.text:00407D85
.text:00407D85 loc_407D85:			       ; CODE XREF: _setlocale_set_cat+1CFj
.text:00407D85		       mov     eax, [edi+4]
.text:00407D88		       mov     [ploci+0A8h], eax
.text:00407D8E
.text:00407D8E loc_407D8E:			       ; CODE XREF: _setlocale_set_cat+145j
.text:00407D8E		       cmp     [ebp+74h+category], 1
.text:00407D92		       jnz     short loc_407D9D
.text:00407D94		       mov     eax, [ebp+74h+cptemp]
.text:00407D9A		       mov     [ploci+8], eax
.text:00407D9D
.text:00407D9D loc_407D9D:			       ; CODE XREF: _setlocale_set_cat+243j
.text:00407D9D		       mov     eax, [ebp+74h+category]
.text:00407DA0		       imul    eax, 0Ch
.text:00407DA3		       push    ploci	       ; ploci
.text:00407DA4		       call    ds:off_41E3E0[eax]
.text:00407DAA		       test    eax, eax
.text:00407DAC		       pop     locale
.text:00407DAD		       jz      short loc_407DE0
.text:00407DAF		       mov     eax, [ebp+74h+oldlocale]
.text:00407DB5		       push    [ebp+74h+pch]   ; pBlock
.text:00407DBB		       mov     [ebx+48h], eax
.text:00407DBE		       call    _free
.text:00407DC3		       mov     eax, [ebp+74h+oldhandle]
.text:00407DC9		       pop     locale
.text:00407DCA		       mov     locale, [ebp+74h+var_194]
.text:00407DD0		       mov     [locale], eax
.text:00407DD2		       mov     eax, [ebp+74h+oldcodepage]
.text:00407DD8		       mov     [ploci+4], eax
.text:00407DDB		       jmp     loc_407B9C
.text:00407DE0 ; ---------------------------------------------------------------------------
.text:00407DE0
.text:00407DE0 loc_407DE0:			       ; CODE XREF: _setlocale_set_cat+25Ej
.text:00407DE0		       cmp     [ebp+74h+oldlocale], offset ___clocalestr ; "C"
.text:00407DEA		       jz      short loc_407E19
.text:00407DEC		       mov     eax, [ebp+74h+category]
.text:00407DEF		       add     eax, 5
.text:00407DF2		       shl     eax, 4
.text:00407DF5		       lea     edi, [eax+ploci]
.text:00407DF8		       push    dword ptr [edi] ; lpAddend
.text:00407DFA		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:00407E00		       test    eax, eax
.text:00407E02		       jnz     short loc_407E19
.text:00407E04		       push    dword ptr [edi] ; pBlock
.text:00407E06		       call    _free
.text:00407E0B		       push    dword ptr [ebx+54h] ; pBlock
.text:00407E0E		       call    _free
.text:00407E13		       and     dword ptr [ebx+4Ch], 0
.text:00407E17		       pop     locale
.text:00407E18		       pop     locale
.text:00407E19
.text:00407E19 loc_407E19:			       ; CODE XREF: _setlocale_set_cat+29Bj
.text:00407E19					       ; _setlocale_set_cat+2B3j
.text:00407E19		       mov     locale, [ebp+74h+category]
.text:00407E1C		       mov     eax, [ebp+74h+pch]
.text:00407E22		       add     locale, 5
.text:00407E25		       shl     locale, 4
.text:00407E28		       mov     dword ptr [eax],	1
.text:00407E2E		       mov     [locale+ploci], eax
.text:00407E31
.text:00407E31 loc_407E31:			       ; CODE XREF: _setlocale_set_cat+6Dj
.text:00407E31		       mov     eax, [ebx+48h]
.text:00407E34
.text:00407E34 loc_407E34:			       ; CODE XREF: _setlocale_set_cat+4Fj
.text:00407E34		       mov     locale, [ebp+74h+var_4]
.text:00407E37		       pop     edi
.text:00407E38		       xor     locale, ebp
.text:00407E3A		       pop     ebx
.text:00407E3B		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00407E40		       add     ebp, 74h
.text:00407E43		       leave
.text:00407E44		       retn
.text:00407E44 _setlocale_set_cat endp
.text:00407E44
.text:00407E45
.text:00407E45 ; =============== S U B R O U T I N E =======================================
.text:00407E45
.text:00407E45 ; Attributes: bp-based frame fpd=74h
.text:00407E45
.text:00407E45 ; char *__usercall setlocale_nolock<eax>(threadlocaleinfostruct *ploci<edx>, int	_category, const char *_locale<ecx>)
.text:00407E45 _setlocale_nolock proc near	       ; CODE XREF: __create_locale+89p
.text:00407E45					       ; _setlocale+90p
.text:00407E45
.text:00407E45 ploci	       = dword ptr -98h
.text:00407E45 i	       = dword ptr -94h
.text:00407E45 len	       = dword ptr -90h
.text:00407E45 fLocaleSet      = dword ptr -8Ch
.text:00407E45 lctemp	       = byte ptr -88h
.text:00407E45 var_4	       = dword ptr -4
.text:00407E45 _category       = dword ptr  8
.text:00407E45
.text:00407E45 ploci = edx
.text:00407E45 _locale = ecx
.text:00407E45		       push    ebp
.text:00407E46		       lea     ebp, [esp-74h]
.text:00407E4A		       sub     esp, 98h
.text:00407E50		       mov     eax, ___security_cookie
.text:00407E55		       xor     eax, ebp
.text:00407E57		       mov     [ebp+74h+var_4],	eax
.text:00407E5A		       mov     eax, [ebp+74h+_category]
.text:00407E5D		       push    ebx
.text:00407E5E		       push    esi
.text:00407E5F		       xor     ebx, ebx
.text:00407E61		       cmp     eax, ebx
.text:00407E63		       mov     esi, ploci      ; ploci
.text:00407E65		       push    edi
.text:00407E66		       mov     [ebp+74h+ploci],	esi
.text:00407E69		       jz      short loc_407E87
.text:00407E6B		       cmp     _locale,	ebx
.text:00407E6D		       jz      short loc_407E7B
.text:00407E6F		       push    eax	       ; category
.text:00407E70		       call    _setlocale_set_cat
.text:00407E75		       pop     _locale
.text:00407E76		       jmp     loc_408001
.text:00407E7B ; ---------------------------------------------------------------------------
.text:00407E7B
.text:00407E7B loc_407E7B:			       ; CODE XREF: _setlocale_nolock+28j
.text:00407E7B		       shl     eax, 4
.text:00407E7E		       mov     eax, [eax+esi+48h]
.text:00407E82		       jmp     loc_408001
.text:00407E87 ; ---------------------------------------------------------------------------
.text:00407E87
.text:00407E87 loc_407E87:			       ; CODE XREF: _setlocale_nolock+24j
.text:00407E87		       cmp     _locale,	ebx
.text:00407E89		       mov     [ebp+74h+len], 1
.text:00407E90		       mov     [ebp+74h+fLocaleSet], ebx
.text:00407E93		       jz      loc_407FFC
.text:00407E99		       cmp     byte ptr	[_locale], 4Ch
.text:00407E9C		       jnz     loc_407FA0
.text:00407EA2		       cmp     byte ptr	[_locale+1], 43h
.text:00407EA6		       jnz     loc_407FA0
.text:00407EAC		       cmp     byte ptr	[_locale+2], 5Fh
.text:00407EB0		       jnz     loc_407FA0
.text:00407EB6		       mov     edi, _locale
.text:00407EB8
.text:00407EB8 loc_407EB8:			       ; CODE XREF: _setlocale_nolock+145j
.text:00407EB8		       push    offset asc_41E4B8 ; "=;"
.text:00407EBD		       push    edi	       ; string
.text:00407EBE		       call    _strpbrk
.text:00407EC3		       mov     ebx, eax
.text:00407EC5		       test    ebx, ebx
.text:00407EC7		       pop     _locale
.text:00407EC8		       pop     _locale
.text:00407EC9		       jz      loc_407F9C
.text:00407ECF		       sub     eax, edi
.text:00407ED1		       mov     [ebp+74h+len], eax
.text:00407ED4		       jz      loc_407F9C
.text:00407EDA		       cmp     byte ptr	[ebx], 3Bh
.text:00407EDD		       jz      loc_407F9C
.text:00407EE3		       mov     [ebp+74h+i], 1
.text:00407EEA		       mov     esi, offset off_41E3E4
.text:00407EEF		       jmp     short loc_407EF4
.text:00407EF1 ; ---------------------------------------------------------------------------
.text:00407EF1
.text:00407EF1 loc_407EF1:			       ; CODE XREF: _setlocale_nolock+D8j
.text:00407EF1		       mov     eax, [ebp+74h+len]
.text:00407EF4
.text:00407EF4 loc_407EF4:			       ; CODE XREF: _setlocale_nolock+AAj
.text:00407EF4		       push    eax	       ; count
.text:00407EF5		       push    edi	       ; last
.text:00407EF6		       push    dword ptr [esi] ; first
.text:00407EF8		       call    _strncmp
.text:00407EFD		       add     esp, 0Ch
.text:00407F00		       test    eax, eax
.text:00407F02		       jnz     short loc_407F11
.text:00407F04		       push    dword ptr [esi] ; buf
.text:00407F06		       call    _strlen
.text:00407F0B		       cmp     [ebp+74h+len], eax
.text:00407F0E		       pop     _locale
.text:00407F0F		       jz      short loc_407F1F
.text:00407F11
.text:00407F11 loc_407F11:			       ; CODE XREF: _setlocale_nolock+BDj
.text:00407F11		       inc     [ebp+74h+i]
.text:00407F14		       add     esi, 0Ch
.text:00407F17		       cmp     esi, offset off_41E414
.text:00407F1D		       jle     short loc_407EF1
.text:00407F1F
.text:00407F1F loc_407F1F:			       ; CODE XREF: _setlocale_nolock+CAj
.text:00407F1F		       inc     ebx
.text:00407F20		       push    offset asc_41E4AC ; ";"
.text:00407F25		       push    ebx	       ; string
.text:00407F26		       call    _strcspn
.text:00407F2B		       mov     edi, eax
.text:00407F2D		       xor     esi, esi
.text:00407F2F		       cmp     edi, esi
.text:00407F31		       pop     _locale
.text:00407F32		       pop     _locale
.text:00407F33		       jnz     short loc_407F3A
.text:00407F35		       cmp     byte ptr	[ebx], 3Bh
.text:00407F38		       jnz     short loc_407F9C
.text:00407F3A
.text:00407F3A loc_407F3A:			       ; CODE XREF: _setlocale_nolock+EEj
.text:00407F3A		       cmp     [ebp+74h+i], 5
.text:00407F3E		       jg      short loc_407F7F
.text:00407F40		       push    edi	       ; _Count
.text:00407F41		       push    ebx	       ; _Src
.text:00407F42		       lea     eax, [ebp+74h+lctemp]
.text:00407F45		       push    83h	       ; _SizeInBytes
.text:00407F4A		       push    eax	       ; _Dst
.text:00407F4B		       call    _strncpy_s
.text:00407F50		       add     esp, 10h
.text:00407F53		       test    eax, eax
.text:00407F55		       jz      short loc_407F64
.text:00407F57		       push    esi	       ; pReserved
.text:00407F58		       push    esi	       ; nLine
.text:00407F59		       push    esi	       ; pszFile
.text:00407F5A		       push    esi	       ; pszFunction
.text:00407F5B		       push    esi	       ; pszExpression
.text:00407F5C		       call    __invoke_watson
.text:00407F61		       add     esp, 14h
.text:00407F64
.text:00407F64 loc_407F64:			       ; CODE XREF: _setlocale_nolock+110j
.text:00407F64		       push    [ebp+74h+i]     ; category
.text:00407F67		       mov     esi, [ebp+74h+ploci] ; ploci
.text:00407F6A		       lea     _locale,	[ebp+74h+lctemp] ; locale
.text:00407F6D		       mov     [ebp+edi+74h+lctemp], 0
.text:00407F72		       call    _setlocale_set_cat
.text:00407F77		       test    eax, eax
.text:00407F79		       pop     _locale
.text:00407F7A		       jz      short loc_407F7F
.text:00407F7C		       inc     [ebp+74h+fLocaleSet]
.text:00407F7F
.text:00407F7F loc_407F7F:			       ; CODE XREF: _setlocale_nolock+F9j
.text:00407F7F					       ; _setlocale_nolock+135j
.text:00407F7F		       add     edi, ebx
.text:00407F81		       cmp     byte ptr	[edi], 0
.text:00407F84		       jz      short loc_407F90
.text:00407F86		       inc     edi
.text:00407F87		       cmp     byte ptr	[edi], 0
.text:00407F8A		       jnz     loc_407EB8
.text:00407F90
.text:00407F90 loc_407F90:			       ; CODE XREF: _setlocale_nolock+13Fj
.text:00407F90		       xor     eax, eax
.text:00407F92		       cmp     [ebp+74h+fLocaleSet], eax
.text:00407F95		       jz      short loc_408001
.text:00407F97		       mov     esi, [ebp+74h+ploci] ; ploci
.text:00407F9A		       jmp     short loc_407FFC
.text:00407F9C ; ---------------------------------------------------------------------------
.text:00407F9C
.text:00407F9C loc_407F9C:			       ; CODE XREF: _setlocale_nolock+84j
.text:00407F9C					       ; _setlocale_nolock+8Fj	...
.text:00407F9C		       xor     eax, eax
.text:00407F9E		       jmp     short loc_408001
.text:00407FA0 ; ---------------------------------------------------------------------------
.text:00407FA0
.text:00407FA0 loc_407FA0:			       ; CODE XREF: _setlocale_nolock+57j
.text:00407FA0					       ; _setlocale_nolock+61j	...
.text:00407FA0		       push    ebx	       ; category
.text:00407FA1		       push    ebx	       ; cp
.text:00407FA2		       push    ebx	       ; id
.text:00407FA3		       push    83h	       ; sizeInChars
.text:00407FA8		       lea     eax, [ebp+74h+lctemp]
.text:00407FAB		       push    eax	       ; output
.text:00407FAC		       push    _locale	       ; expr
.text:00407FAD		       call    __expandlocale
.text:00407FB2		       add     esp, 18h
.text:00407FB5		       cmp     eax, ebx
.text:00407FB7		       jz      short loc_408001
.text:00407FB9		       lea     edi, [esi+48h]
.text:00407FBC
.text:00407FBC loc_407FBC:			       ; CODE XREF: _setlocale_nolock+1A9j
.text:00407FBC		       test    ebx, ebx
.text:00407FBE		       jz      short loc_407FE7
.text:00407FC0		       push    dword ptr [edi] ; str2
.text:00407FC2		       lea     eax, [ebp+74h+lctemp]
.text:00407FC5		       push    eax	       ; str1
.text:00407FC6		       call    _strcmp
.text:00407FCB		       test    eax, eax
.text:00407FCD		       pop     _locale
.text:00407FCE		       pop     _locale
.text:00407FCF		       jz      short loc_407FE4
.text:00407FD1		       push    ebx	       ; category
.text:00407FD2		       lea     _locale,	[ebp+74h+lctemp] ; locale
.text:00407FD5		       call    _setlocale_set_cat
.text:00407FDA		       test    eax, eax
.text:00407FDC		       pop     _locale
.text:00407FDD		       jnz     short loc_407FE4
.text:00407FDF		       and     [ebp+74h+len], eax
.text:00407FE2		       jmp     short loc_407FE7
.text:00407FE4 ; ---------------------------------------------------------------------------
.text:00407FE4
.text:00407FE4 loc_407FE4:			       ; CODE XREF: _setlocale_nolock+18Aj
.text:00407FE4					       ; _setlocale_nolock+198j
.text:00407FE4		       inc     [ebp+74h+fLocaleSet]
.text:00407FE7
.text:00407FE7 loc_407FE7:			       ; CODE XREF: _setlocale_nolock+179j
.text:00407FE7					       ; _setlocale_nolock+19Dj
.text:00407FE7		       inc     ebx
.text:00407FE8		       add     edi, 10h
.text:00407FEB		       cmp     ebx, 5
.text:00407FEE		       jle     short loc_407FBC
.text:00407FF0		       xor     eax, eax
.text:00407FF2		       cmp     [ebp+74h+len], eax
.text:00407FF5		       jnz     short loc_407FFC
.text:00407FF7		       cmp     [ebp+74h+fLocaleSet], eax
.text:00407FFA		       jz      short loc_408001
.text:00407FFC
.text:00407FFC loc_407FFC:			       ; CODE XREF: _setlocale_nolock+4Ej
.text:00407FFC					       ; _setlocale_nolock+155j ...
.text:00407FFC		       call    _setlocale_get_all
.text:00408001
.text:00408001 loc_408001:			       ; CODE XREF: _setlocale_nolock+31j
.text:00408001					       ; _setlocale_nolock+3Dj	...
.text:00408001		       mov     _locale,	[ebp+74h+var_4]
.text:00408004		       pop     edi
.text:00408005		       pop     esi
.text:00408006		       xor     _locale,	ebp
.text:00408008		       pop     ebx
.text:00408009		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040800E		       add     ebp, 74h
.text:00408011		       leave
.text:00408012		       retn
.text:00408012 _setlocale_nolock endp
.text:00408012
.text:00408013
.text:00408013 ; =============== S U B R O U T I N E =======================================
.text:00408013
.text:00408013
.text:00408013 ; localeinfo_struct *__cdecl _create_locale(int _category, const	char *_locale)
.text:00408013 __create_locale proc near	       ; CODE XREF: ___create_localej
.text:00408013
.text:00408013 _category       = dword ptr  4
.text:00408013 _locale	       = dword ptr  8
.text:00408013
.text:00408013		       cmp     [esp+_category],	5
.text:00408018		       push    esi
.text:00408019		       push    edi
.text:0040801A		       ja      short loc_408041
.text:0040801C		       cmp     [esp+8+_locale],	0
.text:00408021		       jz      short loc_408041
.text:00408023		       xor     edi, edi
.text:00408025		       inc     edi
.text:00408026		       push    edi	       ; size
.text:00408027		       push    8	       ; count
.text:00408029		       call    __calloc_crt
.text:0040802E		       mov     esi, eax
.text:00408030		       test    esi, esi
.text:00408032		       pop     ecx
.text:00408033		       pop     ecx
.text:00408034		       jnz     short loc_408046
.text:00408036
.text:00408036 loc_408036:			       ; CODE XREF: __create_locale+4Dj
.text:00408036		       call    __errno
.text:0040803B		       mov     dword ptr [eax],	0Ch
.text:00408041
.text:00408041 loc_408041:			       ; CODE XREF: __create_locale+7j
.text:00408041					       ; __create_locale+Ej
.text:00408041		       xor     eax, eax
.text:00408043
.text:00408043 loc_408043:			       ; CODE XREF: __create_locale+EEj
.text:00408043		       pop     edi
.text:00408044		       pop     esi
.text:00408045		       retn
.text:00408046 ; ---------------------------------------------------------------------------
.text:00408046
.text:00408046 loc_408046:			       ; CODE XREF: __create_locale+21j
.text:00408046		       push    edi	       ; size
.text:00408047		       push    0D8h	       ; count
.text:0040804C		       call    __calloc_crt
.text:00408051		       pop     ecx
.text:00408052		       pop     ecx
.text:00408053		       mov     [esi], eax
.text:00408055		       test    eax, eax
.text:00408057		       jnz     short loc_408062
.text:00408059		       push    esi	       ; pBlock
.text:0040805A		       call    _free
.text:0040805F
.text:0040805F loc_40805F:			       ; CODE XREF: __create_locale+71j
.text:0040805F		       pop     ecx
.text:00408060		       jmp     short loc_408036
.text:00408062 ; ---------------------------------------------------------------------------
.text:00408062
.text:00408062 loc_408062:			       ; CODE XREF: __create_locale+44j
.text:00408062		       push    edi	       ; size
.text:00408063		       push    220h	       ; count
.text:00408068		       call    __calloc_crt
.text:0040806D		       test    eax, eax
.text:0040806F		       pop     ecx
.text:00408070		       pop     ecx
.text:00408071		       mov     [esi+4],	eax
.text:00408074		       jnz     short loc_408086
.text:00408076		       push    dword ptr [esi] ; pBlock
.text:00408078		       call    _free
.text:0040807D		       push    esi	       ; pBlock
.text:0040807E		       call    _free
.text:00408083		       pop     ecx
.text:00408084		       jmp     short loc_40805F
.text:00408086 ; ---------------------------------------------------------------------------
.text:00408086
.text:00408086 loc_408086:			       ; CODE XREF: __create_locale+61j
.text:00408086		       mov     eax, [esi]      ; ptlocid
.text:00408088		       mov     ecx, offset ___initiallocinfo ; ptlocis
.text:0040808D		       call    _copytlocinfo_nolock
.text:00408092		       push    [esp+8+_category] ; _category
.text:00408096		       mov     ecx, [esp+0Ch+_locale] ;	_locale
.text:0040809A		       mov     edx, [esi]      ; ploci
.text:0040809C		       call    _setlocale_nolock
.text:004080A1		       test    eax, eax
.text:004080A3		       pop     ecx
.text:004080A4		       jnz     short loc_4080BF
.text:004080A6		       push    dword ptr [esi] ; ptloci
.text:004080A8		       call    ___removelocaleref
.text:004080AD		       push    dword ptr [esi] ; ptloci
.text:004080AF		       call    ___freetlocinfo
.text:004080B4		       push    esi	       ; pBlock
.text:004080B5		       call    _free
.text:004080BA		       add     esp, 0Ch
.text:004080BD		       jmp     short loc_4080F1
.text:004080BF ; ---------------------------------------------------------------------------
.text:004080BF
.text:004080BF loc_4080BF:			       ; CODE XREF: __create_locale+91j
.text:004080BF		       push    dword ptr [esi+4] ; ptmbci
.text:004080C2		       mov     eax, [esi]
.text:004080C4		       push    dword ptr [eax+4] ; codepage
.text:004080C7		       call    __setmbcp_nolock
.text:004080CC		       test    eax, eax
.text:004080CE		       pop     ecx
.text:004080CF		       pop     ecx
.text:004080D0		       jz      short loc_4080F5
.text:004080D2		       push    dword ptr [esi+4] ; pBlock
.text:004080D5		       call    _free
.text:004080DA		       push    dword ptr [esi] ; ptloci
.text:004080DC		       call    ___removelocaleref
.text:004080E1		       push    dword ptr [esi] ; ptloci
.text:004080E3		       call    ___freetlocinfo
.text:004080E8		       push    esi	       ; pBlock
.text:004080E9		       call    _free
.text:004080EE		       add     esp, 10h
.text:004080F1
.text:004080F1 loc_4080F1:			       ; CODE XREF: __create_locale+AAj
.text:004080F1		       xor     esi, esi
.text:004080F3		       jmp     short loc_4080FF
.text:004080F5 ; ---------------------------------------------------------------------------
.text:004080F5
.text:004080F5 loc_4080F5:			       ; CODE XREF: __create_locale+BDj
.text:004080F5		       mov     eax, [esi+4]
.text:004080F8		       mov     [eax], edi
.text:004080FA		       mov     eax, [esi+4]
.text:004080FD		       mov     [eax], edi
.text:004080FF
.text:004080FF loc_4080FF:			       ; CODE XREF: __create_locale+E0j
.text:004080FF		       mov     eax, esi
.text:00408101		       jmp     loc_408043
.text:00408101 __create_locale endp
.text:00408101
.text:00408106 ; [00000005 BYTES: COLLAPSED FUNCTION ___create_locale. PRESS KEYPAD "+"	TO EXPAND]
.text:0040810B
.text:0040810B ; =============== S U B R O U T I N E =======================================
.text:0040810B
.text:0040810B ; Attributes: bp-based frame
.text:0040810B
.text:0040810B ; char *__cdecl setlocale(int _category,	const char *_locale)
.text:0040810B _setlocale      proc near
.text:0040810B
.text:0040810B ptloci	       = dword ptr -24h
.text:0040810B retval	       = dword ptr -20h
.text:0040810B ptd	       = dword ptr -1Ch
.text:0040810B ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040810B _category       = dword ptr  8
.text:0040810B _locale	       = dword ptr  0Ch
.text:0040810B
.text:0040810B		       push    14h
.text:0040810D		       push    offset dword_4207E0
.text:00408112		       call    __SEH_prolog4
.text:00408117		       xor     ebx, ebx
.text:00408119		       mov     [ebp+retval], ebx
.text:0040811C		       cmp     [ebp+_category],	5
.text:00408120		       jbe     short loc_408141
.text:00408122		       call    __errno
.text:00408127		       mov     dword ptr [eax],	16h
.text:0040812D		       push    ebx	       ; pReserved
.text:0040812E		       push    ebx	       ; nLine
.text:0040812F		       push    ebx	       ; pszFile
.text:00408130		       push    ebx	       ; pszFunction
.text:00408131		       push    ebx	       ; pszExpression
.text:00408132		       call    __invalid_parameter
.text:00408137		       add     esp, 14h
.text:0040813A		       xor     eax, eax
.text:0040813C		       jmp     loc_40826D
.text:00408141 ; ---------------------------------------------------------------------------
.text:00408141
.text:00408141 loc_408141:			       ; CODE XREF: _setlocale+15j
.text:00408141		       call    __getptd
.text:00408146		       mov     esi, eax
.text:00408148		       mov     [ebp+ptd], esi
.text:0040814B		       call    ___updatetlocinfo
.text:00408150		       or      dword ptr [esi+70h], 10h
.text:00408154		       mov     [ebp+ms_exc.disabled], ebx
.text:00408157		       push    1	       ; size
.text:00408159		       push    0D8h	       ; count
.text:0040815E		       call    __calloc_crt
.text:00408163		       pop     ecx
.text:00408164		       pop     ecx
.text:00408165		       mov     edi, eax	       ; ptlocis
.text:00408167		       mov     [ebp+ptloci], edi
.text:0040816A		       cmp     edi, ebx
.text:0040816C		       jz      $LN26_0
.text:00408172		       push    0Ch	       ; locknum
.text:00408174		       call    __lock
.text:00408179		       pop     ecx
.text:0040817A		       mov     [ebp+ms_exc.disabled], 1
.text:00408181		       mov     ecx, [esi+6Ch]  ; ptlocis
.text:00408184		       mov     eax, edi	       ; ptlocid
.text:00408186		       call    _copytlocinfo_nolock
.text:0040818B		       mov     [ebp+ms_exc.disabled], ebx
.text:0040818E		       call    $LN21_1
.text:00408193
.text:00408193 $LN22_1:				       ; _category
.text:00408193		       push    [ebp+_category]
.text:00408196		       mov     ecx, [ebp+_locale] ; _locale
.text:00408199		       mov     edx, edi	       ; ploci
.text:0040819B		       call    _setlocale_nolock
.text:004081A0		       pop     ecx
.text:004081A1		       mov     [ebp+retval], eax
.text:004081A4		       cmp     eax, ebx
.text:004081A6		       jz      loc_408250
.text:004081AC		       cmp     [ebp+_locale], ebx
.text:004081AF		       jz      short loc_4081CE
.text:004081B1		       push    offset ___clocalestr ; "C"
.text:004081B6		       push    [ebp+_locale]   ; str1
.text:004081B9		       call    _strcmp
.text:004081BE		       pop     ecx
.text:004081BF		       pop     ecx
.text:004081C0		       test    eax, eax
.text:004081C2		       jz      short loc_4081CE
.text:004081C4		       mov     ___locale_changed, 1
.text:004081CE
.text:004081CE loc_4081CE:			       ; CODE XREF: _setlocale+A4j
.text:004081CE					       ; _setlocale+B7j
.text:004081CE		       push    0Ch	       ; locknum
.text:004081D0		       call    __lock
.text:004081D5		       pop     ecx
.text:004081D6		       mov     [ebp+ms_exc.disabled], 2
.text:004081DD		       lea     ebx, [esi+6Ch]
.text:004081E0		       mov     eax, ebx	       ; pptlocid
.text:004081E2		       call    _updatetlocinfoEx_nolock
.text:004081E7		       push    edi	       ; ptloci
.text:004081E8		       call    ___removelocaleref
.text:004081ED		       pop     ecx
.text:004081EE		       test    byte ptr	[esi+70h], 2
.text:004081F2		       jnz     short loc_408226
.text:004081F4		       test    byte ptr	___globallocalestatus, 1
.text:004081FB		       jnz     short loc_408226
.text:004081FD		       mov     edi, [ebx]      ; ptlocis
.text:004081FF		       mov     eax, offset ___ptlocinfo	; pptlocid
.text:00408204		       call    _updatetlocinfoEx_nolock
.text:00408209		       push    18h	       ; count
.text:0040820B		       mov     eax, ___ptlocinfo ; ___ptlocinfo
.text:00408210		       add     eax, 0Ch
.text:00408213		       push    eax	       ; src
.text:00408214		       push    offset ___lc_handle ; dst
.text:00408219		       call    _memcpy
.text:0040821E		       add     esp, 0Ch
.text:00408221		       call    sync_legacy_variables_lk
.text:00408226
.text:00408226 loc_408226:			       ; CODE XREF: _setlocale+E7j
.text:00408226					       ; _setlocale+F0j
.text:00408226		       and     [ebp+ms_exc.disabled], 0
.text:0040822A		       call    $LN25_1
.text:0040822F		       jmp     short $LN26_0
.text:00408231 ; ---------------------------------------------------------------------------
.text:00408231
.text:00408231 $LN19_4:				       ; DATA XREF: .rdata:00420804o
.text:00408231		       mov     edi, [ebp+ptloci]
.text:00408234		       mov     esi, [ebp+ptd]
.text:00408237		       xor     ebx, ebx
.text:00408239
.text:00408239 $LN21_1:				       ; CODE XREF: _setlocale+83p
.text:00408239		       push    0Ch	       ; locknum
.text:0040823B		       call    __unlock
.text:00408240		       pop     ecx
.text:00408241
.text:00408241 $LN20_0:
.text:00408241		       retn
.text:00408242 ; ---------------------------------------------------------------------------
.text:00408242
.text:00408242 $LN23_1:				       ; DATA XREF: .rdata:00420810o
.text:00408242		       mov     esi, [ebp+ptd]
.text:00408245
.text:00408245 $LN25_1:				       ; CODE XREF: _setlocale+11Fp
.text:00408245		       push    0Ch	       ; locknum
.text:00408247		       call    __unlock
.text:0040824C		       pop     ecx
.text:0040824D
.text:0040824D $LN24_1:
.text:0040824D		       retn
.text:0040824E ; ---------------------------------------------------------------------------
.text:0040824E		       jmp     short $LN26_0
.text:00408250 ; ---------------------------------------------------------------------------
.text:00408250
.text:00408250 loc_408250:			       ; CODE XREF: _setlocale+9Bj
.text:00408250		       push    edi	       ; ptloci
.text:00408251		       call    ___removelocaleref
.text:00408256		       push    edi	       ; ptloci
.text:00408257		       call    ___freetlocinfo
.text:0040825C		       pop     ecx
.text:0040825D		       pop     ecx
.text:0040825E
.text:0040825E $LN26_0:				       ; CODE XREF: _setlocale+61j
.text:0040825E					       ; _setlocale+124j ...
.text:0040825E		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00408265		       call    $LN17_3
.text:0040826A
.text:0040826A $LN18_1:
.text:0040826A		       mov     eax, [ebp+retval]
.text:0040826D
.text:0040826D loc_40826D:			       ; CODE XREF: _setlocale+31j
.text:0040826D		       call    __SEH_epilog4
.text:00408272		       retn
.text:00408273 ; ---------------------------------------------------------------------------
.text:00408273
.text:00408273 $LN15_2:				       ; DATA XREF: .rdata:004207F8o
.text:00408273		       mov     esi, [ebp+ptd]
.text:00408276
.text:00408276 $LN17_3:				       ; CODE XREF: _setlocale+15Ap
.text:00408276		       and     dword ptr [esi+70h], 0FFFFFFEFh
.text:0040827A
.text:0040827A $LN16_3:
.text:0040827A		       retn
.text:0040827A _setlocale      endp ; sp-analysis failed
.text:0040827A
.text:0040827B
.text:0040827B ; =============== S U B R O U T I N E =======================================
.text:0040827B
.text:0040827B ; Attributes: bp-based frame
.text:0040827B
.text:0040827B ; int __cdecl _flsbuf(int ch, _iobuf *str)
.text:0040827B __flsbuf	       proc near	       ; CODE XREF: write_char+21p
.text:0040827B					       ; write_char_0+21p ...
.text:0040827B
.text:0040827B written	       = dword ptr -4
.text:0040827B buf	       = dword ptr  8
.text:0040827B fh	       = dword ptr  0Ch
.text:0040827B
.text:0040827B		       push    ebp
.text:0040827C		       mov     ebp, esp
.text:0040827E		       push    ecx
.text:0040827F		       push    esi
.text:00408280		       mov     esi, [ebp+fh]
.text:00408283		       push    esi	       ; stream
.text:00408284		       call    __fileno
.text:00408289		       mov     [ebp+fh], eax
.text:0040828C		       mov     eax, [esi+0Ch]
.text:0040828F		       test    al, 82h
.text:00408291		       pop     ecx
.text:00408292		       jnz     short loc_4082AB
.text:00408294		       call    __errno
.text:00408299		       mov     dword ptr [eax],	9
.text:0040829F
.text:0040829F loc_40829F:			       ; CODE XREF: __flsbuf+3Fj
.text:0040829F		       or      dword ptr [esi+0Ch], 20h
.text:004082A3		       or      eax, 0FFFFFFFFh
.text:004082A6		       jmp     loc_4083D8
.text:004082AB ; ---------------------------------------------------------------------------
.text:004082AB
.text:004082AB loc_4082AB:			       ; CODE XREF: __flsbuf+17j
.text:004082AB		       test    al, 40h
.text:004082AD		       jz      short loc_4082BC
.text:004082AF		       call    __errno
.text:004082B4		       mov     dword ptr [eax],	22h
.text:004082BA		       jmp     short loc_40829F
.text:004082BC ; ---------------------------------------------------------------------------
.text:004082BC
.text:004082BC loc_4082BC:			       ; CODE XREF: __flsbuf+32j
.text:004082BC		       push    ebx
.text:004082BD		       xor     ebx, ebx
.text:004082BF		       test    al, 1
.text:004082C1		       jz      short loc_4082D9
.text:004082C3		       test    al, 10h
.text:004082C5		       mov     [esi+4],	ebx
.text:004082C8		       jz      loc_408353
.text:004082CE		       mov     ecx, [esi+8]
.text:004082D1		       and     eax, 0FFFFFFFEh
.text:004082D4		       mov     [esi], ecx
.text:004082D6		       mov     [esi+0Ch], eax
.text:004082D9
.text:004082D9 loc_4082D9:			       ; CODE XREF: __flsbuf+46j
.text:004082D9		       mov     eax, [esi+0Ch]
.text:004082DC		       and     eax, 0FFFFFFEFh
.text:004082DF		       or      eax, 2
.text:004082E2		       test    ax, 10Ch
.text:004082E6		       mov     [esi+0Ch], eax
.text:004082E9		       mov     [esi+4],	ebx
.text:004082EC		       mov     [ebp+written], ebx
.text:004082EF		       jnz     short loc_40831D
.text:004082F1		       call    ___iob_func
.text:004082F6		       add     eax, 20h
.text:004082F9		       cmp     esi, eax
.text:004082FB		       jz      short loc_408309
.text:004082FD		       call    ___iob_func
.text:00408302		       add     eax, 40h
.text:00408305		       cmp     esi, eax
.text:00408307		       jnz     short loc_408316
.text:00408309
.text:00408309 loc_408309:			       ; CODE XREF: __flsbuf+80j
.text:00408309		       push    [ebp+fh]	       ; fh
.text:0040830C		       call    __isatty
.text:00408311		       test    eax, eax
.text:00408313		       pop     ecx
.text:00408314		       jnz     short loc_40831D
.text:00408316
.text:00408316 loc_408316:			       ; CODE XREF: __flsbuf+8Cj
.text:00408316		       push    esi	       ; str
.text:00408317		       call    __getbuf
.text:0040831C		       pop     ecx
.text:0040831D
.text:0040831D loc_40831D:			       ; CODE XREF: __flsbuf+74j
.text:0040831D					       ; __flsbuf+99j
.text:0040831D		       test    word ptr	[esi+0Ch], 108h
.text:00408323		       push    edi
.text:00408324		       jz      loc_4083AA
.text:0040832A		       mov     eax, [esi+8]
.text:0040832D		       mov     edi, [esi]
.text:0040832F		       lea     ecx, [eax+1]
.text:00408332		       mov     [esi], ecx
.text:00408334		       mov     ecx, [esi+18h]
.text:00408337		       sub     edi, eax
.text:00408339		       dec     ecx
.text:0040833A		       cmp     edi, ebx
.text:0040833C		       mov     [esi+4],	ecx
.text:0040833F		       jle     short loc_40835E
.text:00408341		       push    edi	       ; cnt
.text:00408342		       push    eax	       ; buf
.text:00408343		       push    [ebp+fh]	       ; fh
.text:00408346		       call    __write
.text:0040834B		       add     esp, 0Ch
.text:0040834E		       mov     [ebp+written], eax
.text:00408351		       jmp     short loc_4083A0
.text:00408353 ; ---------------------------------------------------------------------------
.text:00408353
.text:00408353 loc_408353:			       ; CODE XREF: __flsbuf+4Dj
.text:00408353		       or      eax, 20h
.text:00408356		       mov     [esi+0Ch], eax
.text:00408359		       or      eax, 0FFFFFFFFh
.text:0040835C		       jmp     short loc_4083D7
.text:0040835E ; ---------------------------------------------------------------------------
.text:0040835E
.text:0040835E loc_40835E:			       ; CODE XREF: __flsbuf+C4j
.text:0040835E		       mov     ecx, [ebp+fh]
.text:00408361		       cmp     ecx, 0FFFFFFFFh
.text:00408364		       jz      short loc_408381
.text:00408366		       cmp     ecx, 0FFFFFFFEh
.text:00408369		       jz      short loc_408381
.text:0040836B		       mov     eax, ecx
.text:0040836D		       and     eax, 1Fh
.text:00408370		       mov     edx, ecx
.text:00408372		       sar     edx, 5
.text:00408375		       shl     eax, 6
.text:00408378		       add     eax, ___pioinfo[edx*4]
.text:0040837F		       jmp     short loc_408386
.text:00408381 ; ---------------------------------------------------------------------------
.text:00408381
.text:00408381 loc_408381:			       ; CODE XREF: __flsbuf+E9j
.text:00408381					       ; __flsbuf+EEj
.text:00408381		       mov     eax, offset ___badioinfo
.text:00408386
.text:00408386 loc_408386:			       ; CODE XREF: __flsbuf+104j
.text:00408386		       test    byte ptr	[eax+4], 20h
.text:0040838A		       jz      short loc_4083A0
.text:0040838C		       push    2	       ; mthd
.text:0040838E		       push    ebx
.text:0040838F		       push    ebx	       ; pos
.text:00408390		       push    ecx	       ; fh
.text:00408391		       call    __lseeki64
.text:00408396		       and     eax, edx
.text:00408398		       add     esp, 10h
.text:0040839B		       cmp     eax, 0FFFFFFFFh
.text:0040839E		       jz      short loc_4083C5
.text:004083A0
.text:004083A0 loc_4083A0:			       ; CODE XREF: __flsbuf+D6j
.text:004083A0					       ; __flsbuf+10Fj
.text:004083A0		       mov     eax, [esi+8]
.text:004083A3		       mov     cl, byte	ptr [ebp+buf]
.text:004083A6		       mov     [eax], cl
.text:004083A8		       jmp     short loc_4083C0
.text:004083AA ; ---------------------------------------------------------------------------
.text:004083AA
.text:004083AA loc_4083AA:			       ; CODE XREF: __flsbuf+A9j
.text:004083AA		       xor     edi, edi
.text:004083AC		       inc     edi
.text:004083AD		       push    edi	       ; cnt
.text:004083AE		       lea     eax, [ebp+buf]
.text:004083B1		       push    eax	       ; buf
.text:004083B2		       push    [ebp+fh]	       ; fh
.text:004083B5		       call    __write
.text:004083BA		       add     esp, 0Ch
.text:004083BD		       mov     [ebp+written], eax
.text:004083C0
.text:004083C0 loc_4083C0:			       ; CODE XREF: __flsbuf+12Dj
.text:004083C0		       cmp     [ebp+written], edi
.text:004083C3		       jz      short loc_4083CE
.text:004083C5
.text:004083C5 loc_4083C5:			       ; CODE XREF: __flsbuf+123j
.text:004083C5		       or      dword ptr [esi+0Ch], 20h
.text:004083C9		       or      eax, 0FFFFFFFFh
.text:004083CC		       jmp     short loc_4083D6
.text:004083CE ; ---------------------------------------------------------------------------
.text:004083CE
.text:004083CE loc_4083CE:			       ; CODE XREF: __flsbuf+148j
.text:004083CE		       mov     eax, [ebp+buf]
.text:004083D1		       and     eax, 0FFh
.text:004083D6
.text:004083D6 loc_4083D6:			       ; CODE XREF: __flsbuf+151j
.text:004083D6		       pop     edi
.text:004083D7
.text:004083D7 loc_4083D7:			       ; CODE XREF: __flsbuf+E1j
.text:004083D7		       pop     ebx
.text:004083D8
.text:004083D8 loc_4083D8:			       ; CODE XREF: __flsbuf+2Bj
.text:004083D8		       pop     esi
.text:004083D9		       leave
.text:004083DA		       retn
.text:004083DA __flsbuf	       endp
.text:004083DA
.text:004083DA ; ---------------------------------------------------------------------------
.text:004083DB		       align 10h
.text:004083E0
.text:004083E0 ; =============== S U B R O U T I N E =======================================
.text:004083E0
.text:004083E0
.text:004083E0 ; void __cdecl strlen(char *buf)
.text:004083E0 _strlen	       proc near	       ; CODE XREF: __output_l:loc_402817p
.text:004083E0					       ; __NMSG_WRITE+CAp ...
.text:004083E0
.text:004083E0 arg_0	       = dword ptr  4
.text:004083E0 buf	       = dword ptr  8
.text:004083E0
.text:004083E0		       mov     ecx, [esp+arg_0]
.text:004083E4		       test    ecx, 3
.text:004083EA		       jz      short main_loop
.text:004083EC
.text:004083EC str_misaligned:			       ; CODE XREF: _strlen+1Bj
.text:004083EC		       mov     al, [ecx]
.text:004083EE		       add     ecx, 1
.text:004083F1		       test    al, al
.text:004083F3		       jz      short loc_408443
.text:004083F5		       test    ecx, 3
.text:004083FB		       jnz     short str_misaligned
.text:004083FD		       add     eax, 0
.text:00408402		       lea     esp, [esp+0]
.text:00408409		       lea     esp, [esp+0]
.text:00408410
.text:00408410 main_loop:			       ; CODE XREF: _strlen+Aj
.text:00408410					       ; _strlen+46j ...
.text:00408410		       mov     eax, [ecx]
.text:00408412		       mov     edx, 7EFEFEFFh
.text:00408417		       add     edx, eax
.text:00408419		       xor     eax, 0FFFFFFFFh
.text:0040841C		       xor     eax, edx
.text:0040841E		       add     ecx, 4
.text:00408421		       test    eax, 81010100h
.text:00408426		       jz      short main_loop
.text:00408428		       mov     eax, [ecx-4]
.text:0040842B		       test    al, al
.text:0040842D		       jz      short loc_408461
.text:0040842F		       test    ah, ah
.text:00408431		       jz      short loc_408457
.text:00408433		       test    eax, 0FF0000h
.text:00408438		       jz      short loc_40844D
.text:0040843A		       test    eax, 0FF000000h
.text:0040843F		       jz      short loc_408443
.text:00408441		       jmp     short main_loop
.text:00408443 ; ---------------------------------------------------------------------------
.text:00408443
.text:00408443 loc_408443:			       ; CODE XREF: _strlen+13j
.text:00408443					       ; _strlen+5Fj
.text:00408443		       lea     eax, [ecx-1]
.text:00408446		       mov     ecx, [esp+arg_0]
.text:0040844A		       sub     eax, ecx
.text:0040844C		       retn
.text:0040844D ; ---------------------------------------------------------------------------
.text:0040844D
.text:0040844D loc_40844D:			       ; CODE XREF: _strlen+58j
.text:0040844D		       lea     eax, [ecx-2]
.text:00408450		       mov     ecx, [esp+arg_0]
.text:00408454		       sub     eax, ecx
.text:00408456		       retn
.text:00408457 ; ---------------------------------------------------------------------------
.text:00408457
.text:00408457 loc_408457:			       ; CODE XREF: _strlen+51j
.text:00408457		       lea     eax, [ecx-3]
.text:0040845A		       mov     ecx, [esp+arg_0]
.text:0040845E		       sub     eax, ecx
.text:00408460		       retn
.text:00408461 ; ---------------------------------------------------------------------------
.text:00408461
.text:00408461 loc_408461:			       ; CODE XREF: _strlen+4Dj
.text:00408461		       lea     eax, [ecx-4]
.text:00408464		       mov     ecx, [esp+arg_0]
.text:00408468		       sub     eax, ecx
.text:0040846A		       retn
.text:0040846A _strlen	       endp
.text:0040846A
.text:0040846B
.text:0040846B ; =============== S U B R O U T I N E =======================================
.text:0040846B
.text:0040846B ; Attributes: bp-based frame
.text:0040846B
.text:0040846B ; int __cdecl _wctomb_s_l(int *pRetValue, char *dst, unsigned int sizeInBytes, wchar_t wchar, localeinfo_struct *plocinfo)
.text:0040846B __wctomb_s_l    proc near	       ; CODE XREF: _wctomb_s+12p
.text:0040846B					       ; __wctomb_l+2Cp ...
.text:0040846B
.text:0040846B _loc_update     = _LocaleUpdate ptr -10h
.text:0040846B pRetValue       = dword ptr  8
.text:0040846B defused	       = dword ptr  0Ch
.text:0040846B sizeInBytes     = dword ptr  10h
.text:0040846B wchar	       = word ptr  14h
.text:0040846B plocinfo	       = dword ptr  18h
.text:0040846B
.text:0040846B		       push    ebp
.text:0040846C		       mov     ebp, esp
.text:0040846E		       sub     esp, 10h
.text:00408471		       push    ebx
.text:00408472		       push    esi
.text:00408473		       mov     esi, [ebp+defused]
.text:00408476		       xor     ebx, ebx
.text:00408478		       cmp     esi, ebx
.text:0040847A		       push    edi
.text:0040847B		       mov     edi, [ebp+sizeInBytes]
.text:0040847E		       jnz     short loc_408491
.text:00408480		       cmp     edi, ebx
.text:00408482		       jbe     short loc_408491
.text:00408484		       mov     eax, [ebp+pRetValue]
.text:00408487		       cmp     eax, ebx
.text:00408489		       jz      short loc_40848D
.text:0040848B		       mov     [eax], ebx
.text:0040848D
.text:0040848D loc_40848D:			       ; CODE XREF: __wctomb_s_l+1Ej
.text:0040848D					       ; __wctomb_s_l+ECj ...
.text:0040848D		       xor     eax, eax
.text:0040848F		       jmp     short loc_408510
.text:00408491 ; ---------------------------------------------------------------------------
.text:00408491
.text:00408491 loc_408491:			       ; CODE XREF: __wctomb_s_l+13j
.text:00408491					       ; __wctomb_s_l+17j
.text:00408491		       mov     eax, [ebp+pRetValue]
.text:00408494		       cmp     eax, ebx
.text:00408496		       jz      short loc_40849B
.text:00408498		       or      dword ptr [eax],	0FFFFFFFFh
.text:0040849B
.text:0040849B loc_40849B:			       ; CODE XREF: __wctomb_s_l+2Bj
.text:0040849B		       cmp     edi, 7FFFFFFFh
.text:004084A1		       jbe     short loc_4084BE
.text:004084A3		       call    __errno
.text:004084A8		       push    16h
.text:004084AA		       pop     esi
.text:004084AB		       push    ebx	       ; pReserved
.text:004084AC		       push    ebx	       ; nLine
.text:004084AD		       push    ebx	       ; pszFile
.text:004084AE		       push    ebx	       ; pszFunction
.text:004084AF		       push    ebx	       ; pszExpression
.text:004084B0		       mov     [eax], esi
.text:004084B2		       call    __invalid_parameter
.text:004084B7		       add     esp, 14h
.text:004084BA
.text:004084BA loc_4084BA:			       ; CODE XREF: __wctomb_s_l+CCj
.text:004084BA					       ; __wctomb_s_l+D5j
.text:004084BA		       mov     eax, esi
.text:004084BC		       jmp     short loc_408510
.text:004084BE ; ---------------------------------------------------------------------------
.text:004084BE
.text:004084BE loc_4084BE:			       ; CODE XREF: __wctomb_s_l+36j
.text:004084BE		       push    [ebp+plocinfo]  ; plocinfo
.text:004084C1		       lea     ecx, [ebp+_loc_update] ;	this
.text:004084C4		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004084C9		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004084CC		       cmp     [eax+14h], ebx
.text:004084CF		       jnz     loc_408569
.text:004084D5		       mov     ax, [ebp+wchar]
.text:004084D9		       cmp     ax, 0FFh
.text:004084DD		       jbe     short loc_408515
.text:004084DF		       cmp     esi, ebx
.text:004084E1		       jz      short loc_4084F2
.text:004084E3		       cmp     edi, ebx
.text:004084E5		       jbe     short loc_4084F2
.text:004084E7		       push    edi	       ; count
.text:004084E8		       push    ebx	       ; value
.text:004084E9		       push    esi	       ; dst
.text:004084EA		       call    _memset
.text:004084EF		       add     esp, 0Ch
.text:004084F2
.text:004084F2 loc_4084F2:			       ; CODE XREF: __wctomb_s_l+76j
.text:004084F2					       ; __wctomb_s_l+7Aj ...
.text:004084F2		       call    __errno
.text:004084F7		       mov     dword ptr [eax],	2Ah
.text:004084FD		       call    __errno
.text:00408502		       cmp     [ebp+_loc_update.updated], bl
.text:00408505		       mov     eax, [eax]
.text:00408507		       jz      short loc_408510
.text:00408509		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040850C		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00408510
.text:00408510 loc_408510:			       ; CODE XREF: __wctomb_s_l+24j
.text:00408510					       ; __wctomb_s_l+51j ...
.text:00408510		       pop     edi
.text:00408511		       pop     esi
.text:00408512		       pop     ebx
.text:00408513		       leave
.text:00408514		       retn
.text:00408515 ; ---------------------------------------------------------------------------
.text:00408515
.text:00408515 loc_408515:			       ; CODE XREF: __wctomb_s_l+72j
.text:00408515		       cmp     esi, ebx
.text:00408517		       jz      short loc_408547
.text:00408519		       cmp     edi, ebx
.text:0040851B		       ja      short loc_408545
.text:0040851D
.text:0040851D loc_40851D:			       ; CODE XREF: __wctomb_s_l+141j
.text:0040851D					       ; __wctomb_s_l+149j ...
.text:0040851D		       call    __errno
.text:00408522		       push    22h
.text:00408524		       pop     esi
.text:00408525		       push    ebx	       ; pReserved
.text:00408526		       push    ebx	       ; nLine
.text:00408527		       push    ebx	       ; pszFile
.text:00408528		       push    ebx	       ; pszFunction
.text:00408529		       push    ebx	       ; pszExpression
.text:0040852A		       mov     [eax], esi
.text:0040852C		       call    __invalid_parameter
.text:00408531		       add     esp, 14h
.text:00408534		       cmp     [ebp+_loc_update.updated], bl
.text:00408537		       jz      short loc_4084BA
.text:00408539		       mov     eax, [ebp+_loc_update.ptd]
.text:0040853C		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00408540		       jmp     loc_4084BA
.text:00408545 ; ---------------------------------------------------------------------------
.text:00408545
.text:00408545 loc_408545:			       ; CODE XREF: __wctomb_s_l+B0j
.text:00408545		       mov     [esi], al
.text:00408547
.text:00408547 loc_408547:			       ; CODE XREF: __wctomb_s_l+ACj
.text:00408547		       mov     eax, [ebp+pRetValue]
.text:0040854A		       cmp     eax, ebx
.text:0040854C		       jz      short loc_408554
.text:0040854E		       mov     dword ptr [eax],	1
.text:00408554
.text:00408554 loc_408554:			       ; CODE XREF: __wctomb_s_l+E1j
.text:00408554					       ; __wctomb_s_l+12Aj ...
.text:00408554		       cmp     [ebp+_loc_update.updated], bl
.text:00408557		       jz      loc_40848D
.text:0040855D		       mov     eax, [ebp+_loc_update.ptd]
.text:00408560		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00408564		       jmp     loc_40848D
.text:00408569 ; ---------------------------------------------------------------------------
.text:00408569
.text:00408569 loc_408569:			       ; CODE XREF: __wctomb_s_l+64j
.text:00408569		       lea     ecx, [ebp+defused]
.text:0040856C		       push    ecx	       ; lpUsedDefaultChar
.text:0040856D		       push    ebx	       ; lpDefaultChar
.text:0040856E		       push    edi	       ; cbMultiByte
.text:0040856F		       push    esi	       ; lpMultiByteStr
.text:00408570		       push    1	       ; cchWideChar
.text:00408572		       lea     ecx, [ebp+wchar]
.text:00408575		       push    ecx	       ; lpWideCharStr
.text:00408576		       push    ebx	       ; dwFlags
.text:00408577		       mov     [ebp+defused], ebx
.text:0040857A		       push    dword ptr [eax+4] ; CodePage
.text:0040857D		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00408583		       cmp     eax, ebx
.text:00408585		       jz      short loc_40859B
.text:00408587		       cmp     [ebp+defused], ebx
.text:0040858A		       jnz     loc_4084F2
.text:00408590		       mov     ecx, [ebp+pRetValue]
.text:00408593		       cmp     ecx, ebx
.text:00408595		       jz      short loc_408554
.text:00408597		       mov     [ecx], eax
.text:00408599		       jmp     short loc_408554
.text:0040859B ; ---------------------------------------------------------------------------
.text:0040859B
.text:0040859B loc_40859B:			       ; CODE XREF: __wctomb_s_l+11Aj
.text:0040859B		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:004085A1		       cmp     eax, 7Ah
.text:004085A4		       jnz     loc_4084F2
.text:004085AA		       cmp     esi, ebx
.text:004085AC		       jz      loc_40851D
.text:004085B2		       cmp     edi, ebx
.text:004085B4		       jbe     loc_40851D
.text:004085BA		       push    edi	       ; count
.text:004085BB		       push    ebx	       ; value
.text:004085BC		       push    esi	       ; dst
.text:004085BD		       call    _memset
.text:004085C2		       add     esp, 0Ch
.text:004085C5		       jmp     loc_40851D
.text:004085C5 __wctomb_s_l    endp
.text:004085C5
.text:004085CA
.text:004085CA ; =============== S U B R O U T I N E =======================================
.text:004085CA
.text:004085CA
.text:004085CA ; int __cdecl wctomb_s(int *pRetValue, char *dst, unsigned int sizeInBytes, wchar_t wchar)
.text:004085CA _wctomb_s       proc near	       ; CODE XREF: __output_l+487p
.text:004085CA					       ; __output_l+8B0p ...
.text:004085CA
.text:004085CA pRetValue       = dword ptr  4
.text:004085CA dst	       = dword ptr  8
.text:004085CA sizeInBytes     = dword ptr  0Ch
.text:004085CA wchar	       = dword ptr  10h
.text:004085CA
.text:004085CA		       push    0	       ; plocinfo
.text:004085CC		       push    [esp+4+wchar]   ; wchar
.text:004085D0		       push    [esp+8+sizeInBytes] ; sizeInBytes
.text:004085D4		       push    [esp+0Ch+dst]   ; dst
.text:004085D8		       push    [esp+10h+pRetValue] ; pRetValue
.text:004085DC		       call    __wctomb_s_l
.text:004085E1		       add     esp, 14h
.text:004085E4		       retn
.text:004085E4 _wctomb_s       endp
.text:004085E4
.text:004085E5
.text:004085E5 ; =============== S U B R O U T I N E =======================================
.text:004085E5
.text:004085E5 ; Attributes: bp-based frame
.text:004085E5
.text:004085E5 ; int __cdecl _wctomb_l(char *s,	wchar_t	wchar, localeinfo_struct *plocinfo)
.text:004085E5 __wctomb_l      proc near
.text:004085E5
.text:004085E5 _loc_update     = _LocaleUpdate ptr -14h
.text:004085E5 retval	       = dword ptr -4
.text:004085E5 s	       = dword ptr  8
.text:004085E5 wchar	       = dword ptr  0Ch
.text:004085E5 plocinfo	       = dword ptr  10h
.text:004085E5
.text:004085E5		       push    ebp
.text:004085E6		       mov     ebp, esp
.text:004085E8		       sub     esp, 14h
.text:004085EB		       push    [ebp+plocinfo]  ; plocinfo
.text:004085EE		       or      [ebp+retval], 0FFFFFFFFh
.text:004085F2		       lea     ecx, [ebp+_loc_update] ;	this
.text:004085F5		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004085FA		       lea     eax, [ebp+_loc_update]
.text:004085FD		       push    eax	       ; plocinfo
.text:004085FE		       push    [ebp+wchar]     ; wchar
.text:00408601		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00408604		       push    dword ptr [eax+0ACh] ; sizeInBytes
.text:0040860A		       lea     eax, [ebp+retval]
.text:0040860D		       push    [ebp+s]	       ; dst
.text:00408610		       push    eax	       ; pRetValue
.text:00408611		       call    __wctomb_s_l
.text:00408616		       add     esp, 14h
.text:00408619		       test    eax, eax
.text:0040861B		       jnz     short loc_408622
.text:0040861D		       mov     eax, [ebp+retval]
.text:00408620		       jmp     short loc_408625
.text:00408622 ; ---------------------------------------------------------------------------
.text:00408622
.text:00408622 loc_408622:			       ; CODE XREF: __wctomb_l+36j
.text:00408622		       or      eax, 0FFFFFFFFh
.text:00408625
.text:00408625 loc_408625:			       ; CODE XREF: __wctomb_l+3Bj
.text:00408625		       cmp     [ebp+_loc_update.updated], 0
.text:00408629		       jz      short locret_408632
.text:0040862B		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040862E		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00408632
.text:00408632 locret_408632:			       ; CODE XREF: __wctomb_l+44j
.text:00408632		       leave
.text:00408633		       retn
.text:00408633 __wctomb_l      endp
.text:00408633
.text:00408634
.text:00408634 ; =============== S U B R O U T I N E =======================================
.text:00408634
.text:00408634 ; Attributes: bp-based frame
.text:00408634
.text:00408634 ; int __cdecl wctomb(char *s, wchar_t wchar)
.text:00408634 _wctomb	       proc near
.text:00408634
.text:00408634 retval	       = dword ptr -4
.text:00408634 s	       = dword ptr  8
.text:00408634 wchar	       = dword ptr  0Ch
.text:00408634
.text:00408634		       push    ebp
.text:00408635		       mov     ebp, esp
.text:00408637		       push    ecx
.text:00408638		       or      [ebp+retval], 0FFFFFFFFh
.text:0040863C		       push    0	       ; plocinfo
.text:0040863E		       push    [ebp+wchar]     ; wchar
.text:00408641		       call    ____mb_cur_max_func
.text:00408646		       push    eax	       ; sizeInBytes
.text:00408647		       push    [ebp+s]	       ; dst
.text:0040864A		       lea     eax, [ebp+retval]
.text:0040864D		       push    eax	       ; pRetValue
.text:0040864E		       call    __wctomb_s_l
.text:00408653		       add     esp, 14h
.text:00408656		       test    eax, eax
.text:00408658		       jnz     short loc_40865F
.text:0040865A		       mov     eax, [ebp+retval]
.text:0040865D		       leave
.text:0040865E		       retn
.text:0040865F ; ---------------------------------------------------------------------------
.text:0040865F
.text:0040865F loc_40865F:			       ; CODE XREF: _wctomb+24j
.text:0040865F		       or      eax, 0FFFFFFFFh
.text:00408662		       leave
.text:00408663		       retn
.text:00408663 _wctomb	       endp
.text:00408663
.text:00408664
.text:00408664 ; =============== S U B R O U T I N E =======================================
.text:00408664
.text:00408664 ; Attributes: bp-based frame
.text:00408664
.text:00408664 ; int __cdecl _isleadbyte_l(int c, localeinfo_struct *plocinfo)
.text:00408664 __isleadbyte_l  proc near	       ; CODE XREF: __output_l+34Dp
.text:00408664					       ; _isleadbyte+6p ...
.text:00408664
.text:00408664 _loc_update     = _LocaleUpdate ptr -10h
.text:00408664 c	       = dword ptr  8
.text:00408664 plocinfo	       = dword ptr  0Ch
.text:00408664
.text:00408664		       push    ebp
.text:00408665		       mov     ebp, esp
.text:00408667		       sub     esp, 10h
.text:0040866A		       push    [ebp+plocinfo]  ; plocinfo
.text:0040866D		       lea     ecx, [ebp+_loc_update] ;	this
.text:00408670		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00408675		       movzx   eax, byte ptr [ebp+c]
.text:00408679		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:0040867C		       mov     ecx, [ecx+0C8h]
.text:00408682		       movzx   eax, word ptr [ecx+eax*2]
.text:00408686		       and     eax, 8000h
.text:0040868B		       cmp     [ebp+_loc_update.updated], 0
.text:0040868F		       jz      short locret_408698
.text:00408691		       mov     ecx, [ebp+_loc_update.ptd]
.text:00408694		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00408698
.text:00408698 locret_408698:			       ; CODE XREF: __isleadbyte_l+2Bj
.text:00408698		       leave
.text:00408699		       retn
.text:00408699 __isleadbyte_l  endp
.text:00408699
.text:0040869A
.text:0040869A ; =============== S U B R O U T I N E =======================================
.text:0040869A
.text:0040869A
.text:0040869A ; int __cdecl isleadbyte(int c)
.text:0040869A _isleadbyte     proc near	       ; CODE XREF: __write_nolock+1AAp
.text:0040869A
.text:0040869A c	       = dword ptr  4
.text:0040869A
.text:0040869A		       push    0	       ; plocinfo
.text:0040869C		       push    [esp+4+c]       ; c
.text:004086A0		       call    __isleadbyte_l
.text:004086A5		       pop     ecx
.text:004086A6		       pop     ecx
.text:004086A7		       retn
.text:004086A7 _isleadbyte     endp
.text:004086A7
.text:004086A8
.text:004086A8 ; =============== S U B R O U T I N E =======================================
.text:004086A8
.text:004086A8
.text:004086A8 ; int __cdecl _iswalpha_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:004086A8 __iswalpha_l    proc near
.text:004086A8
.text:004086A8 c	       = dword ptr  4
.text:004086A8 plocinfo	       = dword ptr  8
.text:004086A8
.text:004086A8		       push    [esp+plocinfo]  ; plocinfo
.text:004086AC		       push    103h	       ; mask
.text:004086B1		       push    [esp+8+c]       ; c
.text:004086B5		       call    __iswctype_l
.text:004086BA		       add     esp, 0Ch
.text:004086BD		       retn
.text:004086BD __iswalpha_l    endp
.text:004086BD
.text:004086BE
.text:004086BE ; =============== S U B R O U T I N E =======================================
.text:004086BE
.text:004086BE
.text:004086BE ; int __cdecl iswalpha(unsigned __int16 c)
.text:004086BE _iswalpha       proc near
.text:004086BE
.text:004086BE c	       = dword ptr  4
.text:004086BE
.text:004086BE		       push    103h	       ; mask
.text:004086C3		       push    [esp+4+c]       ; c
.text:004086C7		       call    _iswctype
.text:004086CC		       pop     ecx
.text:004086CD		       pop     ecx
.text:004086CE		       retn
.text:004086CE _iswalpha       endp
.text:004086CE
.text:004086CF
.text:004086CF ; =============== S U B R O U T I N E =======================================
.text:004086CF
.text:004086CF
.text:004086CF ; int __cdecl _iswupper_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:004086CF __iswupper_l    proc near
.text:004086CF
.text:004086CF c	       = dword ptr  4
.text:004086CF plocinfo	       = dword ptr  8
.text:004086CF
.text:004086CF		       push    [esp+plocinfo]  ; plocinfo
.text:004086D3		       push    1	       ; mask
.text:004086D5		       push    [esp+8+c]       ; c
.text:004086D9		       call    __iswctype_l
.text:004086DE		       add     esp, 0Ch
.text:004086E1		       retn
.text:004086E1 __iswupper_l    endp
.text:004086E1
.text:004086E2
.text:004086E2 ; =============== S U B R O U T I N E =======================================
.text:004086E2
.text:004086E2
.text:004086E2 ; int __cdecl iswupper(unsigned __int16 c)
.text:004086E2 _iswupper       proc near
.text:004086E2
.text:004086E2 c	       = dword ptr  4
.text:004086E2
.text:004086E2		       push    1	       ; mask
.text:004086E4		       push    [esp+4+c]       ; c
.text:004086E8		       call    _iswctype
.text:004086ED		       pop     ecx
.text:004086EE		       pop     ecx
.text:004086EF		       retn
.text:004086EF _iswupper       endp
.text:004086EF
.text:004086F0
.text:004086F0 ; =============== S U B R O U T I N E =======================================
.text:004086F0
.text:004086F0
.text:004086F0 ; int __cdecl _iswlower_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:004086F0 __iswlower_l    proc near
.text:004086F0
.text:004086F0 c	       = dword ptr  4
.text:004086F0 plocinfo	       = dword ptr  8
.text:004086F0
.text:004086F0		       push    [esp+plocinfo]  ; plocinfo
.text:004086F4		       push    2	       ; mask
.text:004086F6		       push    [esp+8+c]       ; c
.text:004086FA		       call    __iswctype_l
.text:004086FF		       add     esp, 0Ch
.text:00408702		       retn
.text:00408702 __iswlower_l    endp
.text:00408702
.text:00408703
.text:00408703 ; =============== S U B R O U T I N E =======================================
.text:00408703
.text:00408703
.text:00408703 ; int __cdecl iswlower(unsigned __int16 c)
.text:00408703 _iswlower       proc near
.text:00408703
.text:00408703 c	       = dword ptr  4
.text:00408703
.text:00408703		       push    2	       ; mask
.text:00408705		       push    [esp+4+c]       ; c
.text:00408709		       call    _iswctype
.text:0040870E		       pop     ecx
.text:0040870F		       pop     ecx
.text:00408710		       retn
.text:00408710 _iswlower       endp
.text:00408710
.text:00408711
.text:00408711 ; =============== S U B R O U T I N E =======================================
.text:00408711
.text:00408711
.text:00408711 ; int __cdecl _iswdigit_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408711 __iswdigit_l    proc near
.text:00408711
.text:00408711 c	       = dword ptr  4
.text:00408711 plocinfo	       = dword ptr  8
.text:00408711
.text:00408711		       push    [esp+plocinfo]  ; plocinfo
.text:00408715		       push    4	       ; mask
.text:00408717		       push    [esp+8+c]       ; c
.text:0040871B		       call    __iswctype_l
.text:00408720		       add     esp, 0Ch
.text:00408723		       retn
.text:00408723 __iswdigit_l    endp
.text:00408723
.text:00408724
.text:00408724 ; =============== S U B R O U T I N E =======================================
.text:00408724
.text:00408724
.text:00408724 ; int __cdecl iswdigit(unsigned __int16 c)
.text:00408724 _iswdigit       proc near
.text:00408724
.text:00408724 c	       = dword ptr  4
.text:00408724
.text:00408724		       push    4	       ; mask
.text:00408726		       push    [esp+4+c]       ; c
.text:0040872A		       call    _iswctype
.text:0040872F		       pop     ecx
.text:00408730		       pop     ecx
.text:00408731		       retn
.text:00408731 _iswdigit       endp
.text:00408731
.text:00408732
.text:00408732 ; =============== S U B R O U T I N E =======================================
.text:00408732
.text:00408732
.text:00408732 ; int __cdecl _iswxdigit_l(unsigned __int16 c, localeinfo_struct	*plocinfo)
.text:00408732 __iswxdigit_l   proc near
.text:00408732
.text:00408732 c	       = dword ptr  4
.text:00408732 plocinfo	       = dword ptr  8
.text:00408732
.text:00408732		       push    [esp+plocinfo]  ; plocinfo
.text:00408736		       push    80h	       ; mask
.text:0040873B		       push    [esp+8+c]       ; c
.text:0040873F		       call    __iswctype_l
.text:00408744		       add     esp, 0Ch
.text:00408747		       retn
.text:00408747 __iswxdigit_l   endp
.text:00408747
.text:00408748
.text:00408748 ; =============== S U B R O U T I N E =======================================
.text:00408748
.text:00408748
.text:00408748 ; int __cdecl iswxdigit(unsigned	__int16	c)
.text:00408748 _iswxdigit      proc near
.text:00408748
.text:00408748 c	       = dword ptr  4
.text:00408748
.text:00408748		       push    80h	       ; mask
.text:0040874D		       push    [esp+4+c]       ; c
.text:00408751		       call    _iswctype
.text:00408756		       pop     ecx
.text:00408757		       pop     ecx
.text:00408758		       retn
.text:00408758 _iswxdigit      endp
.text:00408758
.text:00408759
.text:00408759 ; =============== S U B R O U T I N E =======================================
.text:00408759
.text:00408759
.text:00408759 ; int __cdecl _iswspace_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408759 __iswspace_l    proc near
.text:00408759
.text:00408759 c	       = dword ptr  4
.text:00408759 plocinfo	       = dword ptr  8
.text:00408759
.text:00408759		       push    [esp+plocinfo]  ; plocinfo
.text:0040875D		       push    8	       ; mask
.text:0040875F		       push    [esp+8+c]       ; c
.text:00408763		       call    __iswctype_l
.text:00408768		       add     esp, 0Ch
.text:0040876B		       retn
.text:0040876B __iswspace_l    endp
.text:0040876B
.text:0040876C
.text:0040876C ; =============== S U B R O U T I N E =======================================
.text:0040876C
.text:0040876C
.text:0040876C ; int __cdecl iswspace(unsigned __int16 c)
.text:0040876C _iswspace       proc near
.text:0040876C
.text:0040876C c	       = dword ptr  4
.text:0040876C
.text:0040876C		       push    8	       ; mask
.text:0040876E		       push    [esp+4+c]       ; c
.text:00408772		       call    _iswctype
.text:00408777		       pop     ecx
.text:00408778		       pop     ecx
.text:00408779		       retn
.text:00408779 _iswspace       endp
.text:00408779
.text:0040877A
.text:0040877A ; =============== S U B R O U T I N E =======================================
.text:0040877A
.text:0040877A
.text:0040877A ; int __cdecl _iswpunct_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:0040877A __iswpunct_l    proc near
.text:0040877A
.text:0040877A c	       = dword ptr  4
.text:0040877A plocinfo	       = dword ptr  8
.text:0040877A
.text:0040877A		       push    [esp+plocinfo]  ; plocinfo
.text:0040877E		       push    10h	       ; mask
.text:00408780		       push    [esp+8+c]       ; c
.text:00408784		       call    __iswctype_l
.text:00408789		       add     esp, 0Ch
.text:0040878C		       retn
.text:0040878C __iswpunct_l    endp
.text:0040878C
.text:0040878D
.text:0040878D ; =============== S U B R O U T I N E =======================================
.text:0040878D
.text:0040878D
.text:0040878D ; int __cdecl iswpunct(unsigned __int16 c)
.text:0040878D _iswpunct       proc near
.text:0040878D
.text:0040878D c	       = dword ptr  4
.text:0040878D
.text:0040878D		       push    10h	       ; mask
.text:0040878F		       push    [esp+4+c]       ; c
.text:00408793		       call    _iswctype
.text:00408798		       pop     ecx
.text:00408799		       pop     ecx
.text:0040879A		       retn
.text:0040879A _iswpunct       endp
.text:0040879A
.text:0040879B
.text:0040879B ; =============== S U B R O U T I N E =======================================
.text:0040879B
.text:0040879B
.text:0040879B ; int __cdecl _iswalnum_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:0040879B __iswalnum_l    proc near
.text:0040879B
.text:0040879B c	       = dword ptr  4
.text:0040879B plocinfo	       = dword ptr  8
.text:0040879B
.text:0040879B		       push    [esp+plocinfo]  ; plocinfo
.text:0040879F		       push    107h	       ; mask
.text:004087A4		       push    [esp+8+c]       ; c
.text:004087A8		       call    __iswctype_l
.text:004087AD		       add     esp, 0Ch
.text:004087B0		       retn
.text:004087B0 __iswalnum_l    endp
.text:004087B0
.text:004087B1
.text:004087B1 ; =============== S U B R O U T I N E =======================================
.text:004087B1
.text:004087B1
.text:004087B1 ; int __cdecl iswalnum(unsigned __int16 c)
.text:004087B1 _iswalnum       proc near
.text:004087B1
.text:004087B1 c	       = dword ptr  4
.text:004087B1
.text:004087B1		       push    107h	       ; mask
.text:004087B6		       push    [esp+4+c]       ; c
.text:004087BA		       call    _iswctype
.text:004087BF		       pop     ecx
.text:004087C0		       pop     ecx
.text:004087C1		       retn
.text:004087C1 _iswalnum       endp
.text:004087C1
.text:004087C2
.text:004087C2 ; =============== S U B R O U T I N E =======================================
.text:004087C2
.text:004087C2
.text:004087C2 ; int __cdecl _iswprint_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:004087C2 __iswprint_l    proc near
.text:004087C2
.text:004087C2 c	       = dword ptr  4
.text:004087C2 plocinfo	       = dword ptr  8
.text:004087C2
.text:004087C2		       push    [esp+plocinfo]  ; plocinfo
.text:004087C6		       push    157h	       ; mask
.text:004087CB		       push    [esp+8+c]       ; c
.text:004087CF		       call    __iswctype_l
.text:004087D4		       add     esp, 0Ch
.text:004087D7		       retn
.text:004087D7 __iswprint_l    endp
.text:004087D7
.text:004087D8
.text:004087D8 ; =============== S U B R O U T I N E =======================================
.text:004087D8
.text:004087D8
.text:004087D8 ; int __cdecl iswprint(unsigned __int16 c)
.text:004087D8 _iswprint       proc near
.text:004087D8
.text:004087D8 c	       = dword ptr  4
.text:004087D8
.text:004087D8		       push    157h	       ; mask
.text:004087DD		       push    [esp+4+c]       ; c
.text:004087E1		       call    _iswctype
.text:004087E6		       pop     ecx
.text:004087E7		       pop     ecx
.text:004087E8		       retn
.text:004087E8 _iswprint       endp
.text:004087E8
.text:004087E9
.text:004087E9 ; =============== S U B R O U T I N E =======================================
.text:004087E9
.text:004087E9
.text:004087E9 ; int __cdecl _iswgraph_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:004087E9 __iswgraph_l    proc near
.text:004087E9
.text:004087E9 c	       = dword ptr  4
.text:004087E9 plocinfo	       = dword ptr  8
.text:004087E9
.text:004087E9		       push    [esp+plocinfo]  ; plocinfo
.text:004087ED		       push    117h	       ; mask
.text:004087F2		       push    [esp+8+c]       ; c
.text:004087F6		       call    __iswctype_l
.text:004087FB		       add     esp, 0Ch
.text:004087FE		       retn
.text:004087FE __iswgraph_l    endp
.text:004087FE
.text:004087FF
.text:004087FF ; =============== S U B R O U T I N E =======================================
.text:004087FF
.text:004087FF
.text:004087FF ; int __cdecl iswgraph(unsigned __int16 c)
.text:004087FF _iswgraph       proc near
.text:004087FF
.text:004087FF c	       = dword ptr  4
.text:004087FF
.text:004087FF		       push    117h	       ; mask
.text:00408804		       push    [esp+4+c]       ; c
.text:00408808		       call    _iswctype
.text:0040880D		       pop     ecx
.text:0040880E		       pop     ecx
.text:0040880F		       retn
.text:0040880F _iswgraph       endp
.text:0040880F
.text:00408810
.text:00408810 ; =============== S U B R O U T I N E =======================================
.text:00408810
.text:00408810
.text:00408810 ; int __cdecl _iswcntrl_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408810 __iswcntrl_l    proc near
.text:00408810
.text:00408810 c	       = dword ptr  4
.text:00408810 plocinfo	       = dword ptr  8
.text:00408810
.text:00408810		       push    [esp+plocinfo]  ; plocinfo
.text:00408814		       push    20h	       ; mask
.text:00408816		       push    [esp+8+c]       ; c
.text:0040881A		       call    __iswctype_l
.text:0040881F		       add     esp, 0Ch
.text:00408822		       retn
.text:00408822 __iswcntrl_l    endp
.text:00408822
.text:00408823
.text:00408823 ; =============== S U B R O U T I N E =======================================
.text:00408823
.text:00408823
.text:00408823 ; int __cdecl iswcntrl(unsigned __int16 c)
.text:00408823 _iswcntrl       proc near
.text:00408823
.text:00408823 c	       = dword ptr  4
.text:00408823
.text:00408823		       push    20h	       ; mask
.text:00408825		       push    [esp+4+c]       ; c
.text:00408829		       call    _iswctype
.text:0040882E		       pop     ecx
.text:0040882F		       pop     ecx
.text:00408830		       retn
.text:00408830 _iswcntrl       endp
.text:00408830
.text:00408831
.text:00408831 ; =============== S U B R O U T I N E =======================================
.text:00408831
.text:00408831
.text:00408831 ; int __cdecl iswascii(unsigned __int16 c)
.text:00408831 _iswascii       proc near
.text:00408831
.text:00408831 c	       = word ptr  4
.text:00408831
.text:00408831		       cmp     [esp+c],	80h
.text:00408838		       sbb     eax, eax
.text:0040883A		       neg     eax
.text:0040883C		       retn
.text:0040883C _iswascii       endp
.text:0040883C
.text:0040883D
.text:0040883D ; =============== S U B R O U T I N E =======================================
.text:0040883D
.text:0040883D
.text:0040883D ; int __cdecl _iswcsym_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:0040883D __iswcsym_l     proc near
.text:0040883D
.text:0040883D c	       = dword ptr  4
.text:0040883D plocinfo	       = dword ptr  8
.text:0040883D
.text:0040883D		       push    [esp+plocinfo]  ; plocinfo
.text:00408841		       push    107h	       ; mask
.text:00408846		       push    [esp+8+c]       ; c
.text:0040884A		       call    __iswctype_l
.text:0040884F		       add     esp, 0Ch
.text:00408852		       test    eax, eax
.text:00408854		       jnz     short loc_40885F
.text:00408856		       cmp     word ptr	[esp+c], 5Fh
.text:0040885C		       jz      short loc_40885F
.text:0040885E		       retn
.text:0040885F ; ---------------------------------------------------------------------------
.text:0040885F
.text:0040885F loc_40885F:			       ; CODE XREF: __iswcsym_l+17j
.text:0040885F					       ; __iswcsym_l+1Fj
.text:0040885F		       xor     eax, eax
.text:00408861		       inc     eax
.text:00408862		       retn
.text:00408862 __iswcsym_l     endp
.text:00408862
.text:00408863
.text:00408863 ; =============== S U B R O U T I N E =======================================
.text:00408863
.text:00408863
.text:00408863 ; int __cdecl __iswcsym(unsigned	__int16	c)
.text:00408863 ___iswcsym      proc near
.text:00408863
.text:00408863 c	       = dword ptr  4
.text:00408863
.text:00408863		       push    107h	       ; mask
.text:00408868		       push    [esp+4+c]       ; c
.text:0040886C		       call    _iswctype
.text:00408871		       test    eax, eax
.text:00408873		       pop     ecx
.text:00408874		       pop     ecx
.text:00408875		       jnz     short loc_408880
.text:00408877		       cmp     word ptr	[esp+c], 5Fh
.text:0040887D		       jz      short loc_408880
.text:0040887F		       retn
.text:00408880 ; ---------------------------------------------------------------------------
.text:00408880
.text:00408880 loc_408880:			       ; CODE XREF: ___iswcsym+12j
.text:00408880					       ; ___iswcsym+1Aj
.text:00408880		       xor     eax, eax
.text:00408882		       inc     eax
.text:00408883		       retn
.text:00408883 ___iswcsym      endp
.text:00408883
.text:00408884
.text:00408884 ; =============== S U B R O U T I N E =======================================
.text:00408884
.text:00408884
.text:00408884 ; int __cdecl _iswcsymf_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408884 __iswcsymf_l    proc near
.text:00408884
.text:00408884 c	       = dword ptr  4
.text:00408884 plocinfo	       = dword ptr  8
.text:00408884
.text:00408884		       push    [esp+plocinfo]  ; plocinfo
.text:00408888		       push    103h	       ; mask
.text:0040888D		       push    [esp+8+c]       ; c
.text:00408891		       call    __iswctype_l
.text:00408896		       add     esp, 0Ch
.text:00408899		       test    eax, eax
.text:0040889B		       jnz     short loc_4088A6
.text:0040889D		       cmp     word ptr	[esp+c], 5Fh
.text:004088A3		       jz      short loc_4088A6
.text:004088A5		       retn
.text:004088A6 ; ---------------------------------------------------------------------------
.text:004088A6
.text:004088A6 loc_4088A6:			       ; CODE XREF: __iswcsymf_l+17j
.text:004088A6					       ; __iswcsymf_l+1Fj
.text:004088A6		       xor     eax, eax
.text:004088A8		       inc     eax
.text:004088A9		       retn
.text:004088A9 __iswcsymf_l    endp
.text:004088A9
.text:004088AA
.text:004088AA ; =============== S U B R O U T I N E =======================================
.text:004088AA
.text:004088AA
.text:004088AA ; int __cdecl __iswcsymf(unsigned __int16 c)
.text:004088AA ___iswcsymf     proc near
.text:004088AA
.text:004088AA c	       = dword ptr  4
.text:004088AA
.text:004088AA		       push    103h	       ; mask
.text:004088AF		       push    [esp+4+c]       ; c
.text:004088B3		       call    _iswctype
.text:004088B8		       test    eax, eax
.text:004088BA		       pop     ecx
.text:004088BB		       pop     ecx
.text:004088BC		       jnz     short loc_4088C7
.text:004088BE		       cmp     word ptr	[esp+c], 5Fh
.text:004088C4		       jz      short loc_4088C7
.text:004088C6		       retn
.text:004088C7 ; ---------------------------------------------------------------------------
.text:004088C7
.text:004088C7 loc_4088C7:			       ; CODE XREF: ___iswcsymf+12j
.text:004088C7					       ; ___iswcsymf+1Aj
.text:004088C7		       xor     eax, eax
.text:004088C9		       inc     eax
.text:004088CA		       retn
.text:004088CA ___iswcsymf     endp
.text:004088CA
.text:004088CB
.text:004088CB ; =============== S U B R O U T I N E =======================================
.text:004088CB
.text:004088CB
.text:004088CB ; void __fastcall __security_check_cookie(unsigned int cookie)
.text:004088CB @__security_check_cookie@4 proc near    ; CODE XREF: __output_l+967p
.text:004088CB					       ; __invoke_watson+EFp ...
.text:004088CB cookie =	ecx
.text:004088CB		       cmp     cookie, ___security_cookie
.text:004088D1		       jnz     short failure
.text:004088D3		       rep retn
.text:004088D5 ; ---------------------------------------------------------------------------
.text:004088D5
.text:004088D5 failure:				       ; CODE XREF: __security_check_cookie(x)+6j
.text:004088D5		       jmp     ___report_gsfailure
.text:004088D5 @__security_check_cookie@4 endp
.text:004088D5
.text:004088D5 ; ---------------------------------------------------------------------------
.text:004088DA		       align 10h
.text:004088E0
.text:004088E0 ; =============== S U B R O U T I N E =======================================
.text:004088E0
.text:004088E0
.text:004088E0 __aulldvrm      proc near	       ; CODE XREF: __output_l+785p
.text:004088E0					       ; __output_s_l+791p ...
.text:004088E0
.text:004088E0 arg_0	       = dword ptr  4
.text:004088E0 arg_4	       = dword ptr  8
.text:004088E0 arg_8	       = dword ptr  0Ch
.text:004088E0 arg_C	       = dword ptr  10h
.text:004088E0
.text:004088E0		       push    esi
.text:004088E1		       mov     eax, [esp+4+arg_C]
.text:004088E5		       or      eax, eax
.text:004088E7		       jnz     short L1
.text:004088E9		       mov     ecx, [esp+4+arg_8]
.text:004088ED		       mov     eax, [esp+4+arg_4]
.text:004088F1		       xor     edx, edx
.text:004088F3		       div     ecx
.text:004088F5		       mov     ebx, eax
.text:004088F7		       mov     eax, [esp+4+arg_0]
.text:004088FB		       div     ecx
.text:004088FD		       mov     esi, eax
.text:004088FF		       mov     eax, ebx
.text:00408901		       mul     [esp+4+arg_8]
.text:00408905		       mov     ecx, eax
.text:00408907		       mov     eax, esi
.text:00408909		       mul     [esp+4+arg_8]
.text:0040890D		       add     edx, ecx
.text:0040890F		       jmp     short L2
.text:00408911 ; ---------------------------------------------------------------------------
.text:00408911
.text:00408911 L1:				       ; CODE XREF: __aulldvrm+7j
.text:00408911		       mov     ecx, eax
.text:00408913		       mov     ebx, [esp+4+arg_8]
.text:00408917		       mov     edx, [esp+4+arg_4]
.text:0040891B		       mov     eax, [esp+4+arg_0]
.text:0040891F
.text:0040891F L3:				       ; CODE XREF: __aulldvrm+49j
.text:0040891F		       shr     ecx, 1
.text:00408921		       rcr     ebx, 1
.text:00408923		       shr     edx, 1
.text:00408925		       rcr     eax, 1
.text:00408927		       or      ecx, ecx
.text:00408929		       jnz     short L3
.text:0040892B		       div     ebx
.text:0040892D		       mov     esi, eax
.text:0040892F		       mul     [esp+4+arg_C]
.text:00408933		       mov     ecx, eax
.text:00408935		       mov     eax, [esp+4+arg_8]
.text:00408939		       mul     esi
.text:0040893B		       add     edx, ecx
.text:0040893D		       jb      short L4
.text:0040893F		       cmp     edx, [esp+4+arg_4]
.text:00408943		       ja      short L4
.text:00408945		       jb      short L5
.text:00408947		       cmp     eax, [esp+4+arg_0]
.text:0040894B		       jbe     short L5
.text:0040894D
.text:0040894D L4:				       ; CODE XREF: __aulldvrm+5Dj
.text:0040894D					       ; __aulldvrm+63j
.text:0040894D		       dec     esi
.text:0040894E		       sub     eax, [esp+4+arg_8]
.text:00408952		       sbb     edx, [esp+4+arg_C]
.text:00408956
.text:00408956 L5:				       ; CODE XREF: __aulldvrm+65j
.text:00408956					       ; __aulldvrm+6Bj
.text:00408956		       xor     ebx, ebx
.text:00408958
.text:00408958 L2:				       ; CODE XREF: __aulldvrm+2Fj
.text:00408958		       sub     eax, [esp+4+arg_0]
.text:0040895C		       sbb     edx, [esp+4+arg_4]
.text:00408960		       neg     edx
.text:00408962		       neg     eax
.text:00408964		       sbb     edx, 0
.text:00408967		       mov     ecx, edx
.text:00408969		       mov     edx, ebx
.text:0040896B		       mov     ebx, ecx
.text:0040896D		       mov     ecx, eax
.text:0040896F		       mov     eax, esi
.text:00408971		       pop     esi
.text:00408972		       retn    10h
.text:00408972 __aulldvrm      endp
.text:00408972
.text:00408975
.text:00408975 ; =============== S U B R O U T I N E =======================================
.text:00408975
.text:00408975
.text:00408975 ; void __cdecl _crt_debugger_hook(int _Reserved)
.text:00408975 __crt_debugger_hook proc	near	       ; CODE XREF: __invoke_watson+CEp
.text:00408975					       ; __invalid_parameter+18p ...
.text:00408975
.text:00408975 _Reserved       = dword ptr  4
.text:00408975
.text:00408975		       and     __debugger_hook_dummy, 0
.text:0040897C		       retn
.text:0040897C __crt_debugger_hook endp
.text:0040897C
.text:0040897C ; ---------------------------------------------------------------------------
.text:0040897D		       align 10h
.text:00408980
.text:00408980 ; =============== S U B R O U T I N E =======================================
.text:00408980
.text:00408980
.text:00408980 ; void __cdecl memset(char *dst,	char value, unsigned int count)
.text:00408980 _memset	       proc near	       ; CODE XREF: __invoke_watson+8Cp
.text:00408980					       ; setSBCS+13p ...
.text:00408980
.text:00408980 arg_0	       = dword ptr  4
.text:00408980 dst	       = dword ptr  8
.text:00408980 value	       = dword ptr  0Ch
.text:00408980 count	       = dword ptr  10h
.text:00408980
.text:00408980		       mov     edx, [esp+value]
.text:00408984		       mov     ecx, [esp+arg_0]
.text:00408988		       test    edx, edx
.text:0040898A		       jz      short toend
.text:0040898C		       xor     eax, eax
.text:0040898E		       mov     al, byte	ptr [esp+dst]
.text:00408992		       test    al, al
.text:00408994		       jnz     short dword_align
.text:00408996		       cmp     edx, 100h
.text:0040899C		       jb      short dword_align
.text:0040899E		       cmp     ___sse2_available, 0
.text:004089A5		       jz      short dword_align
.text:004089A7		       jmp     __VEC_memzero
.text:004089AC ; ---------------------------------------------------------------------------
.text:004089AC
.text:004089AC dword_align:			       ; CODE XREF: _memset+14j
.text:004089AC					       ; _memset+1Cj ...
.text:004089AC		       push    edi
.text:004089AD		       mov     edi, ecx
.text:004089AF		       cmp     edx, 4
.text:004089B2		       jb      short tail
.text:004089B4		       neg     ecx
.text:004089B6		       and     ecx, 3
.text:004089B9		       jz      short dwords
.text:004089BB		       sub     edx, ecx
.text:004089BD
.text:004089BD adjust_loop:			       ; CODE XREF: _memset+45j
.text:004089BD		       mov     [edi], al
.text:004089BF		       add     edi, 1
.text:004089C2		       sub     ecx, 1
.text:004089C5		       jnz     short adjust_loop
.text:004089C7
.text:004089C7 dwords:				       ; CODE XREF: _memset+39j
.text:004089C7		       mov     ecx, eax
.text:004089C9		       shl     eax, 8
.text:004089CC		       add     eax, ecx
.text:004089CE		       mov     ecx, eax
.text:004089D0		       shl     eax, 10h
.text:004089D3		       add     eax, ecx
.text:004089D5		       mov     ecx, edx
.text:004089D7		       and     edx, 3
.text:004089DA		       shr     ecx, 2
.text:004089DD		       jz      short tail
.text:004089DF		       rep stosd
.text:004089E1
.text:004089E1 main_loop_tail:
.text:004089E1		       test    edx, edx
.text:004089E3		       jz      short finish
.text:004089E5
.text:004089E5 tail:				       ; CODE XREF: _memset+32j
.text:004089E5					       ; _memset+5Dj ...
.text:004089E5		       mov     [edi], al
.text:004089E7		       add     edi, 1
.text:004089EA		       sub     edx, 1
.text:004089ED		       jnz     short tail
.text:004089EF
.text:004089EF finish:				       ; CODE XREF: _memset+63j
.text:004089EF		       mov     eax, [esp+4+arg_0]
.text:004089F3		       pop     edi
.text:004089F4		       retn
.text:004089F5 ; ---------------------------------------------------------------------------
.text:004089F5
.text:004089F5 toend:				       ; CODE XREF: _memset+Aj
.text:004089F5		       mov     eax, [esp+arg_0]
.text:004089F9		       retn
.text:004089F9 _memset	       endp
.text:004089F9
.text:004089F9 ; ---------------------------------------------------------------------------
.text:004089FA		       align 4
.text:004089FC
.text:004089FC ; =============== S U B R O U T I N E =======================================
.text:004089FC
.text:004089FC
.text:004089FC __local_unwind4 proc near	       ; CODE XREF: _unwind_handler4+2Dp
.text:004089FC					       ; _seh_longjmp_unwind4(x)+10p ...
.text:004089FC
.text:004089FC var_20	       = dword ptr -20h
.text:004089FC arg_0	       = dword ptr  4
.text:004089FC arg_4	       = dword ptr  8
.text:004089FC arg_8	       = dword ptr  0Ch
.text:004089FC
.text:004089FC		       push    ebx
.text:004089FD		       push    esi
.text:004089FE		       push    edi
.text:004089FF		       mov     edx, [esp+0Ch+arg_0]
.text:00408A03		       mov     eax, [esp+0Ch+arg_4]
.text:00408A07		       mov     ecx, [esp+0Ch+arg_8]
.text:00408A0B		       push    ebp
.text:00408A0C		       push    edx
.text:00408A0D		       push    eax
.text:00408A0E		       push    ecx
.text:00408A0F		       push    ecx
.text:00408A10		       push    offset _unwind_handler4
.text:00408A15		       push    large dword ptr fs:0
.text:00408A1C		       mov     eax, ___security_cookie
.text:00408A21		       xor     eax, esp
.text:00408A23		       mov     [esp+28h+var_20], eax
.text:00408A27		       mov     large fs:0, esp
.text:00408A2E
.text:00408A2E _lu_top:				       ; CODE XREF: __local_unwind4+64j
.text:00408A2E					       ; __local_unwind4+80j
.text:00408A2E		       mov     eax, [esp+28h+arg_4]
.text:00408A32		       mov     ebx, [eax+8]
.text:00408A35		       mov     ecx, [esp+28h+arg_0]
.text:00408A39		       xor     ebx, [ecx]
.text:00408A3B		       mov     esi, [eax+0Ch]
.text:00408A3E		       cmp     esi, 0FFFFFFFEh
.text:00408A41		       jz      short _lu_done
.text:00408A43		       mov     edx, [esp+28h+arg_8]
.text:00408A47		       cmp     edx, 0FFFFFFFEh
.text:00408A4A		       jz      short loc_408A50
.text:00408A4C		       cmp     esi, edx
.text:00408A4E		       jbe     short _lu_done
.text:00408A50
.text:00408A50 loc_408A50:			       ; CODE XREF: __local_unwind4+4Ej
.text:00408A50		       lea     esi, [esi+esi*2]
.text:00408A53		       lea     ebx, [ebx+esi*4+10h]
.text:00408A57		       mov     ecx, [ebx]
.text:00408A59		       mov     [eax+0Ch], ecx
.text:00408A5C		       cmp     dword ptr [ebx+4], 0
.text:00408A60		       jnz     short _lu_top
.text:00408A62		       push    101h
.text:00408A67		       mov     eax, [ebx+8]
.text:00408A6A		       call    __NLG_Notify
.text:00408A6F		       mov     ecx, 1
.text:00408A74		       mov     eax, [ebx+8]
.text:00408A77		       call    __NLG_Call
.text:00408A7C		       jmp     short _lu_top
.text:00408A7E ; ---------------------------------------------------------------------------
.text:00408A7E
.text:00408A7E _lu_done:			       ; CODE XREF: __local_unwind4+45j
.text:00408A7E					       ; __local_unwind4+52j
.text:00408A7E		       pop     large dword ptr fs:0
.text:00408A85		       add     esp, 18h
.text:00408A88		       pop     edi
.text:00408A89		       pop     esi
.text:00408A8A		       pop     ebx
.text:00408A8B		       retn
.text:00408A8B __local_unwind4 endp
.text:00408A8B
.text:00408A8C
.text:00408A8C ; =============== S U B R O U T I N E =======================================
.text:00408A8C
.text:00408A8C
.text:00408A8C _unwind_handler4	proc near	       ; DATA XREF: __local_unwind4+14o
.text:00408A8C
.text:00408A8C arg_0	       = dword ptr  4
.text:00408A8C arg_4	       = dword ptr  8
.text:00408A8C arg_C	       = dword ptr  10h
.text:00408A8C
.text:00408A8C		       mov     ecx, [esp+arg_0]
.text:00408A90		       test    dword ptr [ecx+4], 6
.text:00408A97		       mov     eax, 1
.text:00408A9C		       jz      short locret_408AD1
.text:00408A9E		       mov     eax, [esp+arg_4]
.text:00408AA2		       mov     ecx, [eax+8]
.text:00408AA5		       xor     ecx, eax	       ; cookie
.text:00408AA7		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00408AAC		       push    ebp
.text:00408AAD		       mov     ebp, [eax+18h]
.text:00408AB0		       push    dword ptr [eax+0Ch]
.text:00408AB3		       push    dword ptr [eax+10h]
.text:00408AB6		       push    dword ptr [eax+14h]
.text:00408AB9		       call    __local_unwind4
.text:00408ABE		       add     esp, 0Ch
.text:00408AC1		       pop     ebp
.text:00408AC2		       mov     eax, [esp+arg_4]
.text:00408AC6		       mov     edx, [esp+arg_C]
.text:00408ACA		       mov     [edx], eax
.text:00408ACC		       mov     eax, 3
.text:00408AD1
.text:00408AD1 locret_408AD1:			       ; CODE XREF: _unwind_handler4+10j
.text:00408AD1		       retn
.text:00408AD1 _unwind_handler4	endp
.text:00408AD1
.text:00408AD2
.text:00408AD2 ; =============== S U B R O U T I N E =======================================
.text:00408AD2
.text:00408AD2
.text:00408AD2 ; void __stdcall	_seh_longjmp_unwind4(unsigned int Dummy)
.text:00408AD2 __seh_longjmp_unwind4@4 proc near
.text:00408AD2
.text:00408AD2 arg_0	       = dword ptr  4
.text:00408AD2 Dummy	       = dword ptr  8
.text:00408AD2
.text:00408AD2		       push    ebp
.text:00408AD3		       mov     ecx, [esp+4+arg_0]
.text:00408AD7		       mov     ebp, [ecx]
.text:00408AD9		       push    dword ptr [ecx+1Ch]
.text:00408ADC		       push    dword ptr [ecx+18h]
.text:00408ADF		       push    dword ptr [ecx+28h]
.text:00408AE2		       call    __local_unwind4
.text:00408AE7		       add     esp, 0Ch
.text:00408AEA		       pop     ebp
.text:00408AEB		       retn    4
.text:00408AEB __seh_longjmp_unwind4@4 endp
.text:00408AEB
.text:00408AEE
.text:00408AEE ; =============== S U B R O U T I N E =======================================
.text:00408AEE
.text:00408AEE
.text:00408AEE ; __fastcall _EH4_CallFilterFunc(x, x)
.text:00408AEE @_EH4_CallFilterFunc@8 proc near	       ; CODE XREF: __except_handler4+89p
.text:00408AEE		       push    ebp
.text:00408AEF		       push    esi
.text:00408AF0		       push    edi
.text:00408AF1		       push    ebx
.text:00408AF2		       mov     ebp, edx
.text:00408AF4		       xor     eax, eax
.text:00408AF6		       xor     ebx, ebx
.text:00408AF8		       xor     edx, edx
.text:00408AFA		       xor     esi, esi
.text:00408AFC		       xor     edi, edi
.text:00408AFE		       call    ecx
.text:00408B00		       pop     ebx
.text:00408B01		       pop     edi
.text:00408B02		       pop     esi
.text:00408B03		       pop     ebp
.text:00408B04		       retn
.text:00408B04 @_EH4_CallFilterFunc@8 endp
.text:00408B04
.text:00408B05
.text:00408B05 ; =============== S U B R O U T I N E =======================================
.text:00408B05
.text:00408B05
.text:00408B05 ; __fastcall _EH4_TransferToHandler(x, x)
.text:00408B05 @_EH4_TransferToHandler@8 proc near     ; CODE XREF: __except_handler4+170j
.text:00408B05		       mov     ebp, edx
.text:00408B07		       mov     esi, ecx
.text:00408B09		       mov     eax, ecx
.text:00408B0B		       push    1
.text:00408B0D		       call    __NLG_Notify
.text:00408B12		       xor     eax, eax
.text:00408B14		       xor     ebx, ebx
.text:00408B16		       xor     ecx, ecx
.text:00408B18		       xor     edx, edx
.text:00408B1A		       xor     edi, edi
.text:00408B1C		       jmp     esi
.text:00408B1C @_EH4_TransferToHandler@8 endp
.text:00408B1C
.text:00408B1E
.text:00408B1E ; =============== S U B R O U T I N E =======================================
.text:00408B1E
.text:00408B1E ; Attributes: bp-based frame
.text:00408B1E
.text:00408B1E ; __fastcall _EH4_GlobalUnwind(x)
.text:00408B1E @_EH4_GlobalUnwind@4 proc near	       ; CODE XREF: __except_handler4+11Fp
.text:00408B1E		       push    ebp
.text:00408B1F		       mov     ebp, esp
.text:00408B21		       push    ebx
.text:00408B22		       push    esi
.text:00408B23		       push    edi
.text:00408B24		       push    0
.text:00408B26		       push    0
.text:00408B28		       push    offset ReturnPoint
.text:00408B2D		       push    ecx
.text:00408B2E		       call    _RtlUnwind@16   ; RtlUnwind(x,x,x,x)
.text:00408B33
.text:00408B33 ReturnPoint:			       ; DATA XREF: _EH4_GlobalUnwind(x)+Ao
.text:00408B33		       pop     edi
.text:00408B34		       pop     esi
.text:00408B35		       pop     ebx
.text:00408B36		       pop     ebp
.text:00408B37		       retn
.text:00408B37 @_EH4_GlobalUnwind@4 endp
.text:00408B37
.text:00408B38
.text:00408B38 ; =============== S U B R O U T I N E =======================================
.text:00408B38
.text:00408B38
.text:00408B38 ; __fastcall _EH4_LocalUnwind(x,	x, x, x)
.text:00408B38 @_EH4_LocalUnwind@16 proc near	       ; CODE XREF: __except_handler4+137p
.text:00408B38					       ; __except_handler4+18Cp
.text:00408B38
.text:00408B38 arg_0	       = dword ptr  4
.text:00408B38 arg_4	       = dword ptr  8
.text:00408B38
.text:00408B38		       push    ebp
.text:00408B39		       mov     ebp, [esp+4+arg_0]
.text:00408B3D		       push    edx
.text:00408B3E		       push    ecx
.text:00408B3F		       push    [esp+0Ch+arg_4]
.text:00408B43		       call    __local_unwind4
.text:00408B48		       add     esp, 0Ch
.text:00408B4B		       pop     ebp
.text:00408B4C		       retn    8
.text:00408B4C @_EH4_LocalUnwind@16 endp
.text:00408B4C
.text:00408B4F
.text:00408B4F ; =============== S U B R O U T I N E =======================================
.text:00408B4F
.text:00408B4F
.text:00408B4F ; void __usercall write_char_0(char ch<al>, _iobuf *f<ecx>, int *pnumwritten<esi>)
.text:00408B4F write_char_0    proc near	       ; CODE XREF: write_multi_char_0+11p
.text:00408B4F					       ; write_string_0+22p ...
.text:00408B4F f = ecx
.text:00408B4F pnumwritten = esi
.text:00408B4F		       test    byte ptr	[f+0Ch], 40h
.text:00408B53		       jz      short loc_408B5B
.text:00408B55		       cmp     dword ptr [f+8],	0
.text:00408B59		       jz      short loc_408B7F
.text:00408B5B
.text:00408B5B loc_408B5B:			       ; CODE XREF: write_char_0+4j
.text:00408B5B		       dec     dword ptr [f+4]
.text:00408B5E		       js      short loc_408B6B
.text:00408B60		       mov     edx, [f]
.text:00408B62		       mov     [edx], al
.text:00408B64		       inc     dword ptr [f]
.text:00408B66		       movzx   eax, al
.text:00408B69		       jmp     short loc_408B77
.text:00408B6B ; ---------------------------------------------------------------------------
.text:00408B6B
.text:00408B6B loc_408B6B:			       ; CODE XREF: write_char_0+Fj
.text:00408B6B		       movsx   eax, al
.text:00408B6E		       push    f	       ; str
.text:00408B6F		       push    eax	       ; ch
.text:00408B70		       call    __flsbuf
.text:00408B75		       pop     f
.text:00408B76		       pop     f
.text:00408B77
.text:00408B77 loc_408B77:			       ; CODE XREF: write_char_0+1Aj
.text:00408B77		       cmp     eax, 0FFFFFFFFh
.text:00408B7A		       jnz     short loc_408B7F
.text:00408B7C		       or      [pnumwritten], eax
.text:00408B7E		       retn
.text:00408B7F ; ---------------------------------------------------------------------------
.text:00408B7F
.text:00408B7F loc_408B7F:			       ; CODE XREF: write_char_0+Aj
.text:00408B7F					       ; write_char_0+2Bj
.text:00408B7F		       inc     dword ptr [pnumwritten]
.text:00408B81		       retn
.text:00408B81 write_char_0    endp
.text:00408B81
.text:00408B82
.text:00408B82 ; =============== S U B R O U T I N E =======================================
.text:00408B82
.text:00408B82 ; Attributes: bp-based frame
.text:00408B82
.text:00408B82 ; void __usercall write_multi_char_0(char ch, int num, _iobuf *f, int *pnumwritten<eax>)
.text:00408B82 write_multi_char_0 proc near	       ; CODE XREF: __output_s_l+85Fp
.text:00408B82					       ; __output_s_l+88Cp ...
.text:00408B82
.text:00408B82 arg_0	       = byte ptr  8
.text:00408B82 num	       = dword ptr  0Ch
.text:00408B82 f	       = dword ptr  10h
.text:00408B82
.text:00408B82 pnumwritten = eax
.text:00408B82		       push    ebp
.text:00408B83		       mov     ebp, esp
.text:00408B85		       push    esi
.text:00408B86		       mov     esi, pnumwritten	; pnumwritten
.text:00408B88		       jmp     short loc_408B9D
.text:00408B8A ; ---------------------------------------------------------------------------
.text:00408B8A
.text:00408B8A loc_408B8A:			       ; CODE XREF: write_multi_char_0+1Fj
.text:00408B8A		       mov     ecx, [ebp+f]    ; f
.text:00408B8D		       mov     al, [ebp+arg_0] ; ch
.text:00408B90		       dec     [ebp+num]
.text:00408B93		       call    write_char_0
.text:00408B98		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00408B9B		       jz      short loc_408BA3
.text:00408B9D
.text:00408B9D loc_408B9D:			       ; CODE XREF: write_multi_char_0+6j
.text:00408B9D		       cmp     [ebp+num], 0
.text:00408BA1		       jg      short loc_408B8A
.text:00408BA3
.text:00408BA3 loc_408BA3:			       ; CODE XREF: write_multi_char_0+19j
.text:00408BA3		       pop     esi
.text:00408BA4		       pop     ebp
.text:00408BA5		       retn
.text:00408BA5 write_multi_char_0 endp
.text:00408BA5
.text:00408BA6
.text:00408BA6 ; =============== S U B R O U T I N E =======================================
.text:00408BA6
.text:00408BA6
.text:00408BA6 ; void __usercall write_string_0(char *string<ecx>, int len, _iobuf *f<edi>, int	*pnumwritten<eax>)
.text:00408BA6 write_string_0  proc near	       ; CODE XREF: __output_s_l+873p
.text:00408BA6					       ; __output_s_l+8DAp ...
.text:00408BA6
.text:00408BA6 len	       = dword ptr  4
.text:00408BA6
.text:00408BA6 string =	ecx
.text:00408BA6 f = edi
.text:00408BA6 pnumwritten = eax
.text:00408BA6		       test    byte ptr	[f+0Ch], 40h
.text:00408BAA		       push    ebx
.text:00408BAB		       push    esi
.text:00408BAC		       mov     esi, pnumwritten	; pnumwritten
.text:00408BAE		       mov     ebx, string
.text:00408BB0		       jz      short loc_408BE6
.text:00408BB2		       cmp     dword ptr [f+8],	0
.text:00408BB6		       jnz     short loc_408BE6
.text:00408BB8		       mov     pnumwritten, [esp+8+len]
.text:00408BBC		       add     [esi], pnumwritten
.text:00408BBE		       jmp     short loc_408BED
.text:00408BC0 ; ---------------------------------------------------------------------------
.text:00408BC0
.text:00408BC0 loc_408BC0:			       ; CODE XREF: write_string_0+45j
.text:00408BC0		       mov     al, [ebx]       ; ch
.text:00408BC2		       dec     [esp+8+len]
.text:00408BC6		       mov     string, f       ; f
.text:00408BC8		       call    write_char_0
.text:00408BCD		       inc     ebx
.text:00408BCE		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00408BD1		       jnz     short loc_408BE6
.text:00408BD3		       call    __errno
.text:00408BD8		       cmp     dword ptr [pnumwritten],	2Ah
.text:00408BDB		       jnz     short loc_408BED
.text:00408BDD		       mov     string, f       ; f
.text:00408BDF		       mov     al, 3Fh	       ; ch
.text:00408BE1		       call    write_char_0
.text:00408BE6
.text:00408BE6 loc_408BE6:			       ; CODE XREF: write_string_0+Aj
.text:00408BE6					       ; write_string_0+10j ...
.text:00408BE6		       cmp     [esp+8+len], 0
.text:00408BEB		       jg      short loc_408BC0
.text:00408BED
.text:00408BED loc_408BED:			       ; CODE XREF: write_string_0+18j
.text:00408BED					       ; write_string_0+35j
.text:00408BED		       pop     esi
.text:00408BEE		       pop     ebx
.text:00408BEF		       retn
.text:00408BEF write_string_0  endp
.text:00408BEF
.text:00408BF0
.text:00408BF0 ; =============== S U B R O U T I N E =======================================
.text:00408BF0
.text:00408BF0 ; Attributes: bp-based frame fpd=1F8h
.text:00408BF0
.text:00408BF0 ; int __cdecl _output_s_l(_iobuf	*stream, const char *format, localeinfo_struct *plocinfo, char *argptr)
.text:00408BF0 __output_s_l    proc near	       ; DATA XREF: __vprintf_s_l+Co
.text:00408BF0					       ; _vprintf_s+Ao	...
.text:00408BF0
.text:00408BF0 tmp	       = _CRT_DOUBLE ptr -278h
.text:00408BF0 retval	       = dword ptr -270h
.text:00408BF0 capexp	       = dword ptr -26Ch
.text:00408BF0 count	       = dword ptr -264h
.text:00408BF0 no_output       = dword ptr -260h
.text:00408BF0 hexadd	       = dword ptr -25Ch
.text:00408BF0 heapbuf	       = dword ptr -258h
.text:00408BF0 _loc_update     = _LocaleUpdate ptr -254h
.text:00408BF0 var_244	       = dword ptr -244h
.text:00408BF0 state	       = dword ptr -240h
.text:00408BF0 bufferiswide    = dword ptr -23Ch
.text:00408BF0 fldwidth	       = dword ptr -238h
.text:00408BF0 prefixlen       = dword ptr -234h
.text:00408BF0 prefix	       = byte ptr -230h
.text:00408BF0 charsout	       = dword ptr -22Ch
.text:00408BF0 f	       = dword ptr -228h
.text:00408BF0 var_224	       = dword ptr -224h
.text:00408BF0 radix	       = dword ptr -220h
.text:00408BF0 text	       = $12F061FBE778B92DEB8200A0ACF7A038 ptr -21Ch
.text:00408BF0 precision       = dword ptr -218h
.text:00408BF0 var_211	       = byte ptr -211h
.text:00408BF0 flags	       = dword ptr -210h
.text:00408BF0 buffer	       = $C8014B43F160BFD769FAE3F15553333C ptr -20Ch
.text:00408BF0 L_buffer	       = byte ptr -0Ch
.text:00408BF0 var_4	       = dword ptr -4
.text:00408BF0 stream	       = dword ptr  8
.text:00408BF0 format	       = dword ptr  0Ch
.text:00408BF0 plocinfo	       = dword ptr  10h
.text:00408BF0 argptr	       = dword ptr  14h
.text:00408BF0
.text:00408BF0		       push    ebp
.text:00408BF1		       lea     ebp, [esp-1F8h]
.text:00408BF8		       sub     esp, 278h
.text:00408BFE		       mov     eax, ___security_cookie
.text:00408C03		       xor     eax, ebp
.text:00408C05		       mov     [ebp+1F8h+var_4], eax
.text:00408C0B		       mov     eax, [ebp+1F8h+stream]
.text:00408C11		       push    ebx
.text:00408C12		       mov     ebx, [ebp+1F8h+format]
.text:00408C18		       push    esi
.text:00408C19		       xor     esi, esi
.text:00408C1B		       push    edi
.text:00408C1C		       mov     edi, [ebp+1F8h+argptr]
.text:00408C22		       push    [ebp+1F8h+plocinfo] ; plocinfo
.text:00408C28		       lea     ecx, [ebp+1F8h+_loc_update] ; this
.text:00408C2B		       mov     [ebp+1F8h+f], eax
.text:00408C2E		       mov     [ebp+1F8h+var_224], edi
.text:00408C31		       mov     [ebp+1F8h+hexadd], esi
.text:00408C34		       mov     [ebp+1F8h+flags], esi
.text:00408C37		       mov     [ebp+1F8h+fldwidth], esi
.text:00408C3A		       mov     [ebp+1F8h+precision], esi
.text:00408C3D		       mov     [ebp+1F8h+prefixlen], esi
.text:00408C40		       mov     [ebp+1F8h+no_output], esi
.text:00408C43		       mov     [ebp+1F8h+bufferiswide],	esi
.text:00408C46		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00408C4B		       cmp     [ebp+1F8h+f], esi
.text:00408C4E		       jnz     short loc_408C7D
.text:00408C50
.text:00408C50 loc_408C50:			       ; CODE XREF: __output_s_l+E5j
.text:00408C50					       ; __output_s_l+138j ...
.text:00408C50		       call    __errno
.text:00408C55		       push    esi	       ; pReserved
.text:00408C56		       push    esi	       ; nLine
.text:00408C57		       push    esi	       ; pszFile
.text:00408C58		       push    esi	       ; pszFunction
.text:00408C59		       mov     dword ptr [eax],	16h
.text:00408C5F		       push    esi	       ; pszExpression
.text:00408C60
.text:00408C60 loc_408C60:			       ; CODE XREF: __output_s_l+951j
.text:00408C60		       call    __invalid_parameter
.text:00408C65		       add     esp, 14h
.text:00408C68		       cmp     [ebp+1F8h+_loc_update.updated], 0
.text:00408C6C		       jz      short loc_408C75
.text:00408C6E		       mov     eax, [ebp+1F8h+_loc_update.ptd]
.text:00408C71		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00408C75
.text:00408C75 loc_408C75:			       ; CODE XREF: __output_s_l+7Cj
.text:00408C75		       or      eax, 0FFFFFFFFh
.text:00408C78		       jmp     loc_409567
.text:00408C7D ; ---------------------------------------------------------------------------
.text:00408C7D
.text:00408C7D loc_408C7D:			       ; CODE XREF: __output_s_l+5Ej
.text:00408C7D		       mov     eax, [ebp+1F8h+f]
.text:00408C80		       test    byte ptr	[eax+0Ch], 40h
.text:00408C84		       jnz     loc_408D2E
.text:00408C8A		       push    eax	       ; stream
.text:00408C8B		       call    __fileno
.text:00408C90		       cmp     eax, 0FFFFFFFFh
.text:00408C93		       pop     ecx
.text:00408C94		       jz      short loc_408CCC
.text:00408C96		       push    [ebp+1F8h+f]    ; stream
.text:00408C99		       call    __fileno
.text:00408C9E		       cmp     eax, 0FFFFFFFEh
.text:00408CA1		       pop     ecx
.text:00408CA2		       jz      short loc_408CCC
.text:00408CA4		       push    [ebp+1F8h+f]    ; stream
.text:00408CA7		       call    __fileno
.text:00408CAC		       push    [ebp+1F8h+f]    ; stream
.text:00408CAF		       sar     eax, 5
.text:00408CB2		       lea     esi, ds:422F40h[eax*4]
.text:00408CB9		       call    __fileno
.text:00408CBE		       and     eax, 1Fh
.text:00408CC1		       shl     eax, 6
.text:00408CC4		       add     eax, [esi]
.text:00408CC6		       pop     ecx
.text:00408CC7		       pop     ecx
.text:00408CC8		       xor     esi, esi
.text:00408CCA		       jmp     short loc_408CD1
.text:00408CCC ; ---------------------------------------------------------------------------
.text:00408CCC
.text:00408CCC loc_408CCC:			       ; CODE XREF: __output_s_l+A4j
.text:00408CCC					       ; __output_s_l+B2j
.text:00408CCC		       mov     eax, offset ___badioinfo
.text:00408CD1
.text:00408CD1 loc_408CD1:			       ; CODE XREF: __output_s_l+DAj
.text:00408CD1		       test    byte ptr	[eax+24h], 7Fh
.text:00408CD5		       jnz     loc_408C50
.text:00408CDB		       push    [ebp+1F8h+f]    ; stream
.text:00408CDE		       call    __fileno
.text:00408CE3		       cmp     eax, 0FFFFFFFFh
.text:00408CE6		       pop     ecx
.text:00408CE7		       jz      short loc_408D1F
.text:00408CE9		       push    [ebp+1F8h+f]    ; stream
.text:00408CEC		       call    __fileno
.text:00408CF1		       cmp     eax, 0FFFFFFFEh
.text:00408CF4		       pop     ecx
.text:00408CF5		       jz      short loc_408D1F
.text:00408CF7		       push    [ebp+1F8h+f]    ; stream
.text:00408CFA		       call    __fileno
.text:00408CFF		       push    [ebp+1F8h+f]    ; stream
.text:00408D02		       sar     eax, 5
.text:00408D05		       lea     esi, ds:422F40h[eax*4]
.text:00408D0C		       call    __fileno
.text:00408D11		       and     eax, 1Fh
.text:00408D14		       shl     eax, 6
.text:00408D17		       add     eax, [esi]
.text:00408D19		       pop     ecx
.text:00408D1A		       pop     ecx
.text:00408D1B		       xor     esi, esi
.text:00408D1D		       jmp     short loc_408D24
.text:00408D1F ; ---------------------------------------------------------------------------
.text:00408D1F
.text:00408D1F loc_408D1F:			       ; CODE XREF: __output_s_l+F7j
.text:00408D1F					       ; __output_s_l+105j
.text:00408D1F		       mov     eax, offset ___badioinfo
.text:00408D24
.text:00408D24 loc_408D24:			       ; CODE XREF: __output_s_l+12Dj
.text:00408D24		       test    byte ptr	[eax+24h], 80h
.text:00408D28		       jnz     loc_408C50
.text:00408D2E
.text:00408D2E loc_408D2E:			       ; CODE XREF: __output_s_l+94j
.text:00408D2E		       cmp     ebx, esi
.text:00408D30		       jz      loc_408C50
.text:00408D36		       mov     dl, [ebx]
.text:00408D38		       test    dl, dl
.text:00408D3A		       mov     [ebp+1F8h+charsout], esi
.text:00408D3D		       mov     [ebp+1F8h+radix], esi
.text:00408D40		       mov     [ebp+1F8h+state], esi
.text:00408D43		       mov     [ebp+1F8h+heapbuf], esi
.text:00408D46		       mov     [ebp+1F8h+var_211], dl
.text:00408D49		       jz      loc_409557
.text:00408D4F
.text:00408D4F loc_408D4F:			       ; CODE XREF: __output_s_l+93Aj
.text:00408D4F		       inc     ebx
.text:00408D50		       xor     eax, eax
.text:00408D52		       cmp     [ebp+1F8h+charsout], eax
.text:00408D55		       mov     [ebp+1F8h+var_244], ebx
.text:00408D58		       jl      loc_409546
.text:00408D5E		       mov     cl, dl
.text:00408D60		       sub     cl, 20h
.text:00408D63		       cmp     cl, 58h
.text:00408D66		       ja      short loc_408D75
.text:00408D68		       movsx   eax, dl
.text:00408D6B		       movzx   eax, byte ptr ds:control[eax] ; "_.,"
.text:00408D72		       and     eax, 0Fh
.text:00408D75
.text:00408D75 loc_408D75:			       ; CODE XREF: __output_s_l+176j
.text:00408D75		       mov     ecx, [ebp+1F8h+state]
.text:00408D78		       imul    eax, 9
.text:00408D7B		       movzx   eax, ds:___lookuptable_s[eax+ecx]
.text:00408D83		       push    8
.text:00408D85		       shr     eax, 4
.text:00408D88		       pop     esi
.text:00408D89		       cmp     eax, esi
.text:00408D8B		       mov     [ebp+1F8h+state], eax
.text:00408D8E		       jz      loc_40952F
.text:00408D94		       push    7
.text:00408D96		       pop     ecx
.text:00408D97		       cmp     eax, ecx	       ; switch	8 cases
.text:00408D99		       ja      loc_409519      ; default
.text:00408D9F		       jmp     ds:off_409580[eax*4] ; switch jump
.text:00408DA6
.text:00408DA6 $LN131:				       ; DATA XREF: __output_s_l:off_409580o
.text:00408DA6		       xor     eax, eax	       ; jumptable 00408D9F case 1
.text:00408DA8		       or      [ebp+1F8h+precision], 0FFFFFFFFh
.text:00408DAC		       mov     [ebp+1F8h+capexp], eax
.text:00408DAF		       mov     [ebp+1F8h+no_output], eax
.text:00408DB2		       mov     [ebp+1F8h+fldwidth], eax
.text:00408DB5		       mov     [ebp+1F8h+prefixlen], eax
.text:00408DB8		       mov     [ebp+1F8h+flags], eax
.text:00408DBB		       mov     [ebp+1F8h+bufferiswide],	eax
.text:00408DBE		       jmp     loc_409519      ; default
.text:00408DC3 ; ---------------------------------------------------------------------------
.text:00408DC3
.text:00408DC3 $LN130_0:			       ; CODE XREF: __output_s_l+1AFj
.text:00408DC3					       ; DATA XREF: __output_s_l:off_409580o
.text:00408DC3		       movsx   eax, dl	       ; jumptable 00408D9F case 2
.text:00408DC6		       sub     eax, 20h
.text:00408DC9		       jz      short loc_408E07
.text:00408DCB		       sub     eax, 3
.text:00408DCE		       jz      short loc_408DFB
.text:00408DD0		       sub     eax, esi
.text:00408DD2		       jz      short loc_408DF2
.text:00408DD4		       dec     eax
.text:00408DD5		       dec     eax
.text:00408DD6		       jz      short loc_408DE9
.text:00408DD8		       sub     eax, 3
.text:00408DDB		       jnz     loc_409519      ; default
.text:00408DE1		       or      [ebp+1F8h+flags], esi
.text:00408DE4		       jmp     loc_409519      ; default
.text:00408DE9 ; ---------------------------------------------------------------------------
.text:00408DE9
.text:00408DE9 loc_408DE9:			       ; CODE XREF: __output_s_l+1E6j
.text:00408DE9		       or      [ebp+1F8h+flags], 4
.text:00408DED		       jmp     loc_409519      ; default
.text:00408DF2 ; ---------------------------------------------------------------------------
.text:00408DF2
.text:00408DF2 loc_408DF2:			       ; CODE XREF: __output_s_l+1E2j
.text:00408DF2		       or      [ebp+1F8h+flags], 1
.text:00408DF6		       jmp     loc_409519      ; default
.text:00408DFB ; ---------------------------------------------------------------------------
.text:00408DFB
.text:00408DFB loc_408DFB:			       ; CODE XREF: __output_s_l+1DEj
.text:00408DFB		       or      [ebp+1F8h+flags], 80h
.text:00408E02		       jmp     loc_409519      ; default
.text:00408E07 ; ---------------------------------------------------------------------------
.text:00408E07
.text:00408E07 loc_408E07:			       ; CODE XREF: __output_s_l+1D9j
.text:00408E07		       or      [ebp+1F8h+flags], 2
.text:00408E0B		       jmp     loc_409519      ; default
.text:00408E10 ; ---------------------------------------------------------------------------
.text:00408E10
.text:00408E10 $LN122:				       ; CODE XREF: __output_s_l+1AFj
.text:00408E10					       ; DATA XREF: __output_s_l:off_409580o
.text:00408E10		       cmp     dl, 2Ah	       ; jumptable 00408D9F case 3
.text:00408E13		       jnz     short loc_408E35
.text:00408E15		       add     edi, 4
.text:00408E18		       mov     [ebp+1F8h+var_224], edi
.text:00408E1B		       mov     edi, [edi-4]
.text:00408E1E		       test    edi, edi
.text:00408E20		       mov     [ebp+1F8h+fldwidth], edi
.text:00408E23		       jge     loc_409519      ; default
.text:00408E29		       or      [ebp+1F8h+flags], 4
.text:00408E2D		       neg     [ebp+1F8h+fldwidth]
.text:00408E30		       jmp     loc_409519      ; default
.text:00408E35 ; ---------------------------------------------------------------------------
.text:00408E35
.text:00408E35 loc_408E35:			       ; CODE XREF: __output_s_l+223j
.text:00408E35		       mov     eax, [ebp+1F8h+fldwidth]
.text:00408E38		       imul    eax, 0Ah
.text:00408E3B		       movsx   ecx, dl
.text:00408E3E		       lea     eax, [eax+ecx-30h]
.text:00408E42		       mov     [ebp+1F8h+fldwidth], eax
.text:00408E45		       jmp     loc_409519      ; default
.text:00408E4A ; ---------------------------------------------------------------------------
.text:00408E4A
.text:00408E4A $LN118:				       ; CODE XREF: __output_s_l+1AFj
.text:00408E4A					       ; DATA XREF: __output_s_l:off_409580o
.text:00408E4A		       and     [ebp+1F8h+precision], 0 ; jumptable 00408D9F case 4
.text:00408E4E		       jmp     loc_409519      ; default
.text:00408E53 ; ---------------------------------------------------------------------------
.text:00408E53
.text:00408E53 $LN117_0:			       ; CODE XREF: __output_s_l+1AFj
.text:00408E53					       ; DATA XREF: __output_s_l:off_409580o
.text:00408E53		       cmp     dl, 2Ah	       ; jumptable 00408D9F case 5
.text:00408E56		       jnz     short loc_408E75
.text:00408E58		       add     edi, 4
.text:00408E5B		       mov     [ebp+1F8h+var_224], edi
.text:00408E5E		       mov     edi, [edi-4]
.text:00408E61		       test    edi, edi
.text:00408E63		       mov     [ebp+1F8h+precision], edi
.text:00408E66		       jge     loc_409519      ; default
.text:00408E6C		       or      [ebp+1F8h+precision], 0FFFFFFFFh
.text:00408E70		       jmp     loc_409519      ; default
.text:00408E75 ; ---------------------------------------------------------------------------
.text:00408E75
.text:00408E75 loc_408E75:			       ; CODE XREF: __output_s_l+266j
.text:00408E75		       mov     eax, [ebp+1F8h+precision]
.text:00408E78		       imul    eax, 0Ah
.text:00408E7B		       movsx   ecx, dl
.text:00408E7E		       lea     eax, [eax+ecx-30h]
.text:00408E82		       mov     [ebp+1F8h+precision], eax
.text:00408E85		       jmp     loc_409519      ; default
.text:00408E8A ; ---------------------------------------------------------------------------
.text:00408E8A
.text:00408E8A $LN113:				       ; CODE XREF: __output_s_l+1AFj
.text:00408E8A					       ; DATA XREF: __output_s_l:off_409580o
.text:00408E8A		       cmp     dl, 49h	       ; jumptable 00408D9F case 6
.text:00408E8D		       jz      short loc_408ED5
.text:00408E8F		       cmp     dl, 68h
.text:00408E92		       jz      short loc_408ECC
.text:00408E94		       cmp     dl, 6Ch
.text:00408E97		       jz      short loc_408EAE
.text:00408E99		       cmp     dl, 77h
.text:00408E9C		       jnz     loc_409519      ; default
.text:00408EA2		       or      [ebp+1F8h+flags], 800h
.text:00408EA9		       jmp     loc_409519      ; default
.text:00408EAE ; ---------------------------------------------------------------------------
.text:00408EAE
.text:00408EAE loc_408EAE:			       ; CODE XREF: __output_s_l+2A7j
.text:00408EAE		       cmp     byte ptr	[ebx], 6Ch
.text:00408EB1		       jnz     short loc_408EC3
.text:00408EB3		       inc     ebx
.text:00408EB4		       or      [ebp+1F8h+flags], 1000h
.text:00408EBB		       mov     [ebp+1F8h+var_244], ebx
.text:00408EBE		       jmp     loc_409519      ; default
.text:00408EC3 ; ---------------------------------------------------------------------------
.text:00408EC3
.text:00408EC3 loc_408EC3:			       ; CODE XREF: __output_s_l+2C1j
.text:00408EC3		       or      [ebp+1F8h+flags], 10h
.text:00408EC7		       jmp     loc_409519      ; default
.text:00408ECC ; ---------------------------------------------------------------------------
.text:00408ECC
.text:00408ECC loc_408ECC:			       ; CODE XREF: __output_s_l+2A2j
.text:00408ECC		       or      [ebp+1F8h+flags], 20h
.text:00408ED0		       jmp     loc_409519      ; default
.text:00408ED5 ; ---------------------------------------------------------------------------
.text:00408ED5
.text:00408ED5 loc_408ED5:			       ; CODE XREF: __output_s_l+29Dj
.text:00408ED5		       mov     al, [ebx]
.text:00408ED7		       cmp     al, 36h
.text:00408ED9		       jnz     short loc_408EF2
.text:00408EDB		       cmp     byte ptr	[ebx+1], 34h
.text:00408EDF		       jnz     short loc_408EF2
.text:00408EE1		       inc     ebx
.text:00408EE2		       inc     ebx
.text:00408EE3		       or      [ebp+1F8h+flags], 8000h
.text:00408EEA		       mov     [ebp+1F8h+var_244], ebx
.text:00408EED		       jmp     loc_409519      ; default
.text:00408EF2 ; ---------------------------------------------------------------------------
.text:00408EF2
.text:00408EF2 loc_408EF2:			       ; CODE XREF: __output_s_l+2E9j
.text:00408EF2					       ; __output_s_l+2EFj
.text:00408EF2		       cmp     al, 33h
.text:00408EF4		       jnz     short loc_408F0D
.text:00408EF6		       cmp     byte ptr	[ebx+1], 32h
.text:00408EFA		       jnz     short loc_408F0D
.text:00408EFC		       inc     ebx
.text:00408EFD		       inc     ebx
.text:00408EFE		       and     [ebp+1F8h+flags], 0FFFF7FFFh
.text:00408F05		       mov     [ebp+1F8h+var_244], ebx
.text:00408F08		       jmp     loc_409519      ; default
.text:00408F0D ; ---------------------------------------------------------------------------
.text:00408F0D
.text:00408F0D loc_408F0D:			       ; CODE XREF: __output_s_l+304j
.text:00408F0D					       ; __output_s_l+30Aj
.text:00408F0D		       cmp     al, 64h
.text:00408F0F		       jz      loc_409519      ; default
.text:00408F15		       cmp     al, 69h
.text:00408F17		       jz      loc_409519      ; default
.text:00408F1D		       cmp     al, 6Fh
.text:00408F1F		       jz      loc_409519      ; default
.text:00408F25		       cmp     al, 75h
.text:00408F27		       jz      loc_409519      ; default
.text:00408F2D		       cmp     al, 78h
.text:00408F2F		       jz      loc_409519      ; default
.text:00408F35		       cmp     al, 58h
.text:00408F37		       jz      loc_409519      ; default
.text:00408F3D		       and     [ebp+1F8h+state], 0
.text:00408F41
.text:00408F41 NORMAL_STATE_0:			       ; CODE XREF: __output_s_l+1AFj
.text:00408F41					       ; DATA XREF: __output_s_l:off_409580o
.text:00408F41		       and     [ebp+1F8h+bufferiswide],	0 ; jumptable 00408D9F case 0
.text:00408F45		       lea     eax, [ebp+1F8h+_loc_update] ; ch
.text:00408F48		       push    eax	       ; plocinfo
.text:00408F49		       movzx   eax, dl
.text:00408F4C		       push    eax	       ; c
.text:00408F4D		       call    __isleadbyte_l
.text:00408F52		       pop     ecx
.text:00408F53		       test    eax, eax
.text:00408F55		       mov     al, [ebp+1F8h+var_211]
.text:00408F58		       pop     ecx
.text:00408F59		       jz      short loc_408F74
.text:00408F5B		       mov     ecx, [ebp+1F8h+f] ; f
.text:00408F5E		       lea     esi, [ebp+1F8h+charsout]	; pnumwritten
.text:00408F61		       call    write_char_0
.text:00408F66		       mov     al, [ebx]       ; ch
.text:00408F68		       inc     ebx
.text:00408F69		       test    al, al
.text:00408F6B		       mov     [ebp+1F8h+var_244], ebx
.text:00408F6E		       jz      loc_40952F
.text:00408F74
.text:00408F74 loc_408F74:			       ; CODE XREF: __output_s_l+369j
.text:00408F74		       mov     ecx, [ebp+1F8h+f] ; f
.text:00408F77		       lea     esi, [ebp+1F8h+charsout]	; pnumwritten
.text:00408F7A		       call    write_char_0
.text:00408F7F		       jmp     loc_409519      ; default
.text:00408F84 ; ---------------------------------------------------------------------------
.text:00408F84
.text:00408F84 $LN97:				       ; CODE XREF: __output_s_l+1AFj
.text:00408F84					       ; DATA XREF: __output_s_l:off_409580o
.text:00408F84		       movsx   eax, dl	       ; jumptable 00408D9F case 7
.text:00408F87		       cmp     eax, 64h
.text:00408F8A		       jg      loc_409104
.text:00408F90		       jz      loc_40917F
.text:00408F96		       cmp     eax, 53h
.text:00408F99		       jg      loc_40904B
.text:00408F9F		       jz      short loc_408FFC
.text:00408FA1		       sub     eax, 41h
.text:00408FA4		       jz      short loc_408FB6
.text:00408FA6		       dec     eax
.text:00408FA7		       dec     eax
.text:00408FA8		       jz      short loc_408FEB
.text:00408FAA		       dec     eax
.text:00408FAB		       dec     eax
.text:00408FAC		       jz      short loc_408FB6
.text:00408FAE		       dec     eax
.text:00408FAF		       dec     eax
.text:00408FB0		       jnz     loc_409401
.text:00408FB6
.text:00408FB6 loc_408FB6:			       ; CODE XREF: __output_s_l+3B4j
.text:00408FB6					       ; __output_s_l+3BCj
.text:00408FB6		       add     dl, 20h
.text:00408FB9		       mov     [ebp+1F8h+capexp], 1
.text:00408FC0		       mov     [ebp+1F8h+var_211], dl
.text:00408FC3
.text:00408FC3 loc_408FC3:			       ; CODE XREF: __output_s_l+46Aj
.text:00408FC3					       ; __output_s_l+52Fj
.text:00408FC3		       or      [ebp+1F8h+flags], 40h
.text:00408FC7		       cmp     [ebp+1F8h+precision], 0
.text:00408FCB		       lea     ebx, [ebp+1F8h+buffer]
.text:00408FCE		       mov     eax, 200h
.text:00408FD3		       mov     dword ptr [ebp+1F8h+text], ebx
.text:00408FD6		       mov     [ebp+1F8h+count], eax
.text:00408FD9		       jge     loc_4091A3
.text:00408FDF		       mov     [ebp+1F8h+precision], 6
.text:00408FE6		       jmp     loc_4091F2
.text:00408FEB ; ---------------------------------------------------------------------------
.text:00408FEB
.text:00408FEB loc_408FEB:			       ; CODE XREF: __output_s_l+3B8j
.text:00408FEB		       test    word ptr	[ebp+1F8h+flags], 830h
.text:00408FF1		       jnz     short loc_409068
.text:00408FF3		       or      [ebp+1F8h+flags], 800h
.text:00408FFA		       jmp     short loc_409068
.text:00408FFC ; ---------------------------------------------------------------------------
.text:00408FFC
.text:00408FFC loc_408FFC:			       ; CODE XREF: __output_s_l+3AFj
.text:00408FFC		       test    word ptr	[ebp+1F8h+flags], 830h
.text:00409002		       jnz     short loc_40900B
.text:00409004		       or      [ebp+1F8h+flags], 800h
.text:0040900B
.text:0040900B loc_40900B:			       ; CODE XREF: __output_s_l+412j
.text:0040900B					       ; __output_s_l+6A0j
.text:0040900B		       mov     ecx, [ebp+1F8h+precision]
.text:0040900E		       cmp     ecx, 0FFFFFFFFh
.text:00409011		       jnz     short loc_409018
.text:00409013		       mov     ecx, 7FFFFFFFh
.text:00409018
.text:00409018 loc_409018:			       ; CODE XREF: __output_s_l+421j
.text:00409018		       add     edi, 4
.text:0040901B		       test    word ptr	[ebp+1F8h+flags], 810h
.text:00409021		       mov     [ebp+1F8h+var_224], edi
.text:00409024		       mov     edi, [edi-4]
.text:00409027		       mov     dword ptr [ebp+1F8h+text], edi
.text:0040902A		       jz      loc_4093DF
.text:00409030		       test    edi, edi
.text:00409032		       jnz     short loc_40903C
.text:00409034		       mov     eax, ___wnullstring
.text:00409039		       mov     dword ptr [ebp+1F8h+text], eax
.text:0040903C
.text:0040903C loc_40903C:			       ; CODE XREF: __output_s_l+442j
.text:0040903C		       mov     eax, dword ptr [ebp+1F8h+text]
.text:0040903F		       mov     [ebp+1F8h+bufferiswide],	1
.text:00409046		       jmp     loc_4093D4
.text:0040904B ; ---------------------------------------------------------------------------
.text:0040904B
.text:0040904B loc_40904B:			       ; CODE XREF: __output_s_l+3A9j
.text:0040904B		       sub     eax, 58h
.text:0040904E		       jz      loc_409288
.text:00409054		       dec     eax
.text:00409055		       dec     eax
.text:00409056		       jz      short loc_4090B5
.text:00409058		       sub     eax, ecx
.text:0040905A		       jz      loc_408FC3
.text:00409060		       dec     eax
.text:00409061		       dec     eax
.text:00409062		       jnz     loc_409401
.text:00409068
.text:00409068 loc_409068:			       ; CODE XREF: __output_s_l+401j
.text:00409068					       ; __output_s_l+40Aj
.text:00409068		       add     edi, 4
.text:0040906B		       test    word ptr	[ebp+1F8h+flags], 810h
.text:00409071		       mov     [ebp+1F8h+var_224], edi
.text:00409074		       jz      short loc_40909D
.text:00409076		       movzx   eax, word ptr [edi-4]
.text:0040907A		       push    eax	       ; wchar
.text:0040907B		       push    200h	       ; sizeInBytes
.text:00409080		       lea     eax, [ebp+1F8h+buffer]
.text:00409083		       push    eax	       ; dst
.text:00409084		       lea     eax, [ebp+1F8h+radix]
.text:00409087		       push    eax	       ; pRetValue
.text:00409088		       call    _wctomb_s
.text:0040908D		       add     esp, 10h
.text:00409090		       test    eax, eax
.text:00409092		       jz      short loc_4090AA
.text:00409094		       mov     [ebp+1F8h+no_output], 1
.text:0040909B		       jmp     short loc_4090AA
.text:0040909D ; ---------------------------------------------------------------------------
.text:0040909D
.text:0040909D loc_40909D:			       ; CODE XREF: __output_s_l+484j
.text:0040909D		       mov     al, [edi-4]
.text:004090A0		       mov     byte ptr	[ebp+1F8h+buffer], al
.text:004090A3		       mov     [ebp+1F8h+radix], 1
.text:004090AA
.text:004090AA loc_4090AA:			       ; CODE XREF: __output_s_l+4A2j
.text:004090AA					       ; __output_s_l+4ABj
.text:004090AA		       lea     eax, [ebp+1F8h+buffer]
.text:004090AD		       mov     dword ptr [ebp+1F8h+text], eax
.text:004090B0		       jmp     loc_409401
.text:004090B5 ; ---------------------------------------------------------------------------
.text:004090B5
.text:004090B5 loc_4090B5:			       ; CODE XREF: __output_s_l+466j
.text:004090B5		       mov     eax, [edi]
.text:004090B7		       add     edi, 4
.text:004090BA		       test    eax, eax
.text:004090BC		       mov     [ebp+1F8h+var_224], edi
.text:004090BF		       jz      short loc_4090F0
.text:004090C1		       mov     ecx, [eax+4]
.text:004090C4		       test    ecx, ecx
.text:004090C6		       jz      short loc_4090F0
.text:004090C8		       test    word ptr	[ebp+1F8h+flags], 800h
.text:004090CE		       movsx   eax, word ptr [eax]
.text:004090D1		       mov     dword ptr [ebp+1F8h+text], ecx
.text:004090D4		       jz      short loc_4090E7
.text:004090D6		       cdq
.text:004090D7		       sub     eax, edx
.text:004090D9		       sar     eax, 1
.text:004090DB		       mov     [ebp+1F8h+bufferiswide],	1
.text:004090E2		       jmp     loc_4093FE
.text:004090E7 ; ---------------------------------------------------------------------------
.text:004090E7
.text:004090E7 loc_4090E7:			       ; CODE XREF: __output_s_l+4E4j
.text:004090E7		       and     [ebp+1F8h+bufferiswide],	0
.text:004090EB		       jmp     loc_4093FE
.text:004090F0 ; ---------------------------------------------------------------------------
.text:004090F0
.text:004090F0 loc_4090F0:			       ; CODE XREF: __output_s_l+4CFj
.text:004090F0					       ; __output_s_l+4D6j
.text:004090F0		       mov     eax, ___nullstring
.text:004090F5		       mov     dword ptr [ebp+1F8h+text], eax
.text:004090F8		       push    eax	       ; buf
.text:004090F9
.text:004090F9 loc_4090F9:			       ; CODE XREF: __output_s_l+690j
.text:004090F9		       call    _strlen
.text:004090FE		       pop     ecx
.text:004090FF		       jmp     loc_4093FE
.text:00409104 ; ---------------------------------------------------------------------------
.text:00409104
.text:00409104 loc_409104:			       ; CODE XREF: __output_s_l+39Aj
.text:00409104		       cmp     eax, 70h
.text:00409107		       jg      loc_40928D
.text:0040910D		       jz      loc_409285
.text:00409113		       cmp     eax, 65h
.text:00409116		       jl      loc_409401
.text:0040911C		       cmp     eax, 67h
.text:0040911F		       jle     loc_408FC3
.text:00409125		       cmp     eax, 69h
.text:00409128		       jz      short loc_40917F
.text:0040912A		       cmp     eax, 6Eh
.text:0040912D		       jz      short loc_40914A
.text:0040912F		       cmp     eax, 6Fh
.text:00409132		       jnz     loc_409401
.text:00409138		       test    byte ptr	[ebp+1F8h+flags], 80h
.text:0040913C		       mov     [ebp+1F8h+radix], esi
.text:0040913F		       jz      short COMMON_INT_0
.text:00409141		       or      [ebp+1F8h+flags], 200h
.text:00409148		       jmp     short COMMON_INT_0
.text:0040914A ; ---------------------------------------------------------------------------
.text:0040914A
.text:0040914A loc_40914A:			       ; CODE XREF: __output_s_l+53Dj
.text:0040914A		       mov     esi, [edi]
.text:0040914C		       add     edi, 4
.text:0040914F		       mov     [ebp+1F8h+var_224], edi
.text:00409152		       call    __get_printf_count_output
.text:00409157		       test    eax, eax
.text:00409159		       jz      loc_40952F
.text:0040915F		       test    byte ptr	[ebp+1F8h+flags], 20h
.text:00409163		       jz      short loc_40916E
.text:00409165		       mov     ax, word	ptr [ebp+1F8h+charsout]
.text:00409169		       mov     [esi], ax
.text:0040916C		       jmp     short loc_409173
.text:0040916E ; ---------------------------------------------------------------------------
.text:0040916E
.text:0040916E loc_40916E:			       ; CODE XREF: __output_s_l+573j
.text:0040916E		       mov     eax, [ebp+1F8h+charsout]
.text:00409171		       mov     [esi], eax
.text:00409173
.text:00409173 loc_409173:			       ; CODE XREF: __output_s_l+57Cj
.text:00409173		       mov     [ebp+1F8h+no_output], 1
.text:0040917A		       jmp     loc_409506
.text:0040917F ; ---------------------------------------------------------------------------
.text:0040917F
.text:0040917F loc_40917F:			       ; CODE XREF: __output_s_l+3A0j
.text:0040917F					       ; __output_s_l+538j
.text:0040917F		       or      [ebp+1F8h+flags], 40h
.text:00409183
.text:00409183 loc_409183:			       ; CODE XREF: __output_s_l+6A8j
.text:00409183		       mov     [ebp+1F8h+radix], 0Ah
.text:0040918A
.text:0040918A COMMON_INT_0:			       ; CODE XREF: __output_s_l+54Fj
.text:0040918A					       ; __output_s_l+558j ...
.text:0040918A		       mov     ecx, [ebp+1F8h+flags]
.text:0040918D		       test    cx, cx
.text:00409190		       jns     loc_4092D7
.text:00409196
.text:00409196 loc_409196:			       ; CODE XREF: __output_s_l+6ECj
.text:00409196		       add     edi, esi
.text:00409198		       mov     eax, [edi-8]
.text:0040919B		       mov     edx, [edi-4]
.text:0040919E		       jmp     loc_40930C
.text:004091A3 ; ---------------------------------------------------------------------------
.text:004091A3
.text:004091A3 loc_4091A3:			       ; CODE XREF: __output_s_l+3E9j
.text:004091A3		       jnz     short loc_4091B3
.text:004091A5		       cmp     dl, 67h
.text:004091A8		       jnz     short loc_4091F2
.text:004091AA		       mov     [ebp+1F8h+precision], 1
.text:004091B1		       jmp     short loc_4091F2
.text:004091B3 ; ---------------------------------------------------------------------------
.text:004091B3
.text:004091B3 loc_4091B3:			       ; CODE XREF: __output_s_l:loc_4091A3j
.text:004091B3		       cmp     [ebp+1F8h+precision], eax
.text:004091B6		       jle     short loc_4091BB
.text:004091B8		       mov     [ebp+1F8h+precision], eax
.text:004091BB
.text:004091BB loc_4091BB:			       ; CODE XREF: __output_s_l+5C6j
.text:004091BB		       cmp     [ebp+1F8h+precision], 0A3h
.text:004091C2		       jle     short loc_4091F2
.text:004091C4		       mov     esi, [ebp+1F8h+precision]
.text:004091C7		       add     esi, 15Dh
.text:004091CD		       push    esi	       ; cb
.text:004091CE		       call    __malloc_crt
.text:004091D3		       test    eax, eax
.text:004091D5		       mov     dl, [ebp+1F8h+var_211]
.text:004091D8		       pop     ecx
.text:004091D9		       mov     [ebp+1F8h+heapbuf], eax
.text:004091DC		       push    8
.text:004091DE		       jz      short loc_4091EA
.text:004091E0		       mov     dword ptr [ebp+1F8h+text], eax
.text:004091E3		       mov     [ebp+1F8h+count], esi
.text:004091E6		       mov     ebx, eax
.text:004091E8		       jmp     short loc_4091F1
.text:004091EA ; ---------------------------------------------------------------------------
.text:004091EA
.text:004091EA loc_4091EA:			       ; CODE XREF: __output_s_l+5EEj
.text:004091EA		       mov     [ebp+1F8h+precision], 0A3h
.text:004091F1
.text:004091F1 loc_4091F1:			       ; CODE XREF: __output_s_l+5F8j
.text:004091F1		       pop     esi
.text:004091F2
.text:004091F2 loc_4091F2:			       ; CODE XREF: __output_s_l+3F6j
.text:004091F2					       ; __output_s_l+5B8j ...
.text:004091F2		       add     edi, esi
.text:004091F4		       mov     eax, [edi-8]
.text:004091F7		       mov     dword ptr [ebp+1F8h+tmp.x], eax
.text:004091FA		       mov     eax, [edi-4]
.text:004091FD		       mov     dword ptr [ebp+1F8h+tmp.x+4], eax
.text:00409200		       lea     eax, [ebp+1F8h+_loc_update]
.text:00409203		       push    eax
.text:00409204		       push    [ebp+1F8h+capexp]
.text:00409207		       movsx   eax, dl
.text:0040920A		       push    [ebp+1F8h+precision]
.text:0040920D		       mov     [ebp+1F8h+var_224], edi
.text:00409210		       push    eax
.text:00409211		       push    [ebp+1F8h+count]
.text:00409214		       lea     eax, [ebp+1F8h+tmp]
.text:00409217		       push    ebx
.text:00409218		       push    eax
.text:00409219		       push    codedptr	       ; codedptr
.text:0040921F		       call    __decode_pointer
.text:00409224		       pop     ecx
.text:00409225		       call    eax
.text:00409227		       mov     edi, [ebp+1F8h+flags]
.text:0040922A		       add     esp, 1Ch
.text:0040922D		       and     edi, 80h
.text:00409233		       jz      short loc_409250
.text:00409235		       cmp     [ebp+1F8h+precision], 0
.text:00409239		       jnz     short loc_409250
.text:0040923B		       lea     eax, [ebp+1F8h+_loc_update]
.text:0040923E		       push    eax
.text:0040923F		       push    ebx
.text:00409240		       push    off_421694      ; codedptr
.text:00409246		       call    __decode_pointer
.text:0040924B		       pop     ecx
.text:0040924C		       call    eax
.text:0040924E		       pop     ecx
.text:0040924F		       pop     ecx
.text:00409250
.text:00409250 loc_409250:			       ; CODE XREF: __output_s_l+643j
.text:00409250					       ; __output_s_l+649j
.text:00409250		       cmp     [ebp+1F8h+var_211], 67h
.text:00409254		       jnz     short loc_40926F
.text:00409256		       test    edi, edi
.text:00409258		       jnz     short loc_40926F
.text:0040925A		       lea     eax, [ebp+1F8h+_loc_update]
.text:0040925D		       push    eax
.text:0040925E		       push    ebx
.text:0040925F		       push    off_421690      ; codedptr
.text:00409265		       call    __decode_pointer
.text:0040926A		       pop     ecx
.text:0040926B		       call    eax
.text:0040926D		       pop     ecx
.text:0040926E		       pop     ecx
.text:0040926F
.text:0040926F loc_40926F:			       ; CODE XREF: __output_s_l+664j
.text:0040926F					       ; __output_s_l+668j
.text:0040926F		       cmp     byte ptr	[ebx], 2Dh
.text:00409272		       jnz     short loc_40927F
.text:00409274		       or      [ebp+1F8h+flags], 100h
.text:0040927B		       inc     ebx
.text:0040927C		       mov     dword ptr [ebp+1F8h+text], ebx
.text:0040927F
.text:0040927F loc_40927F:			       ; CODE XREF: __output_s_l+682j
.text:0040927F		       push    ebx
.text:00409280		       jmp     loc_4090F9
.text:00409285 ; ---------------------------------------------------------------------------
.text:00409285
.text:00409285 loc_409285:			       ; CODE XREF: __output_s_l+51Dj
.text:00409285		       mov     [ebp+1F8h+precision], esi
.text:00409288
.text:00409288 loc_409288:			       ; CODE XREF: __output_s_l+45Ej
.text:00409288		       mov     [ebp+1F8h+hexadd], ecx
.text:0040928B		       jmp     short COMMON_HEX_0
.text:0040928D ; ---------------------------------------------------------------------------
.text:0040928D
.text:0040928D loc_40928D:			       ; CODE XREF: __output_s_l+517j
.text:0040928D		       sub     eax, 73h
.text:00409290		       jz      loc_40900B
.text:00409296		       dec     eax
.text:00409297		       dec     eax
.text:00409298		       jz      loc_409183
.text:0040929E		       sub     eax, 3
.text:004092A1		       jnz     loc_409401
.text:004092A7		       mov     [ebp+1F8h+hexadd], 27h
.text:004092AE
.text:004092AE COMMON_HEX_0:			       ; CODE XREF: __output_s_l+69Bj
.text:004092AE		       test    byte ptr	[ebp+1F8h+flags], 80h
.text:004092B2		       mov     [ebp+1F8h+radix], 10h
.text:004092B9		       jz      COMMON_INT_0
.text:004092BF		       mov     al, byte	ptr [ebp+1F8h+hexadd]
.text:004092C2		       add     al, 51h
.text:004092C4		       mov     [ebp+1F8h+prefix], 30h
.text:004092C8		       mov     [ebp+1F8h+prefix+1], al
.text:004092CB		       mov     [ebp+1F8h+prefixlen], 2
.text:004092D2		       jmp     COMMON_INT_0
.text:004092D7 ; ---------------------------------------------------------------------------
.text:004092D7
.text:004092D7 loc_4092D7:			       ; CODE XREF: __output_s_l+5A0j
.text:004092D7		       test    cx, 1000h
.text:004092DC		       jnz     loc_409196
.text:004092E2		       add     edi, 4
.text:004092E5		       test    cl, 20h
.text:004092E8		       jz      short loc_4092FF
.text:004092EA		       test    cl, 40h
.text:004092ED		       mov     [ebp+1F8h+var_224], edi
.text:004092F0		       jz      short loc_4092F8
.text:004092F2		       movsx   eax, word ptr [edi-4]
.text:004092F6		       jmp     short loc_4092FC
.text:004092F8 ; ---------------------------------------------------------------------------
.text:004092F8
.text:004092F8 loc_4092F8:			       ; CODE XREF: __output_s_l+700j
.text:004092F8		       movzx   eax, word ptr [edi-4]
.text:004092FC
.text:004092FC loc_4092FC:			       ; CODE XREF: __output_s_l+706j
.text:004092FC		       cdq
.text:004092FD		       jmp     short loc_40930F
.text:004092FF ; ---------------------------------------------------------------------------
.text:004092FF
.text:004092FF loc_4092FF:			       ; CODE XREF: __output_s_l+6F8j
.text:004092FF		       test    cl, 40h
.text:00409302		       mov     eax, [edi-4]
.text:00409305		       jz      short loc_40930A
.text:00409307		       cdq
.text:00409308		       jmp     short loc_40930C
.text:0040930A ; ---------------------------------------------------------------------------
.text:0040930A
.text:0040930A loc_40930A:			       ; CODE XREF: __output_s_l+715j
.text:0040930A		       xor     edx, edx
.text:0040930C
.text:0040930C loc_40930C:			       ; CODE XREF: __output_s_l+5AEj
.text:0040930C					       ; __output_s_l+718j
.text:0040930C		       mov     [ebp+1F8h+var_224], edi
.text:0040930F
.text:0040930F loc_40930F:			       ; CODE XREF: __output_s_l+70Dj
.text:0040930F		       test    cl, 40h
.text:00409312		       jz      short loc_40932C
.text:00409314		       test    edx, edx
.text:00409316		       jg      short loc_40932C
.text:00409318		       jl      short loc_40931E
.text:0040931A		       test    eax, eax
.text:0040931C		       jnb     short loc_40932C
.text:0040931E
.text:0040931E loc_40931E:			       ; CODE XREF: __output_s_l+728j
.text:0040931E		       neg     eax
.text:00409320		       adc     edx, 0
.text:00409323		       neg     edx
.text:00409325		       or      [ebp+1F8h+flags], 100h
.text:0040932C
.text:0040932C loc_40932C:			       ; CODE XREF: __output_s_l+722j
.text:0040932C					       ; __output_s_l+726j ...
.text:0040932C		       test    word ptr	[ebp+1F8h+flags], 9000h
.text:00409332		       mov     ebx, edx
.text:00409334		       mov     edi, eax
.text:00409336		       jnz     short loc_40933A
.text:00409338		       xor     ebx, ebx
.text:0040933A
.text:0040933A loc_40933A:			       ; CODE XREF: __output_s_l+746j
.text:0040933A		       cmp     [ebp+1F8h+precision], 0
.text:0040933E		       jge     short loc_409349
.text:00409340		       mov     [ebp+1F8h+precision], 1
.text:00409347		       jmp     short loc_40935A
.text:00409349 ; ---------------------------------------------------------------------------
.text:00409349
.text:00409349 loc_409349:			       ; CODE XREF: __output_s_l+74Ej
.text:00409349		       and     [ebp+1F8h+flags], 0FFFFFFF7h
.text:0040934D		       mov     eax, 200h
.text:00409352		       cmp     [ebp+1F8h+precision], eax
.text:00409355		       jle     short loc_40935A
.text:00409357		       mov     [ebp+1F8h+precision], eax
.text:0040935A
.text:0040935A loc_40935A:			       ; CODE XREF: __output_s_l+757j
.text:0040935A					       ; __output_s_l+765j
.text:0040935A		       mov     eax, edi
.text:0040935C		       or      eax, ebx
.text:0040935E		       jnz     short loc_409363
.text:00409360		       and     [ebp+1F8h+prefixlen], eax
.text:00409363
.text:00409363 loc_409363:			       ; CODE XREF: __output_s_l+76Ej
.text:00409363		       lea     esi, [ebp+1F8h+buffer+1FFh]
.text:00409369
.text:00409369 loc_409369:			       ; CODE XREF: __output_s_l+7ABj
.text:00409369		       mov     eax, [ebp+1F8h+precision]
.text:0040936C		       dec     [ebp+1F8h+precision]
.text:0040936F		       test    eax, eax
.text:00409371		       jg      short loc_409379
.text:00409373		       mov     eax, edi
.text:00409375		       or      eax, ebx
.text:00409377		       jz      short loc_40939D
.text:00409379
.text:00409379 loc_409379:			       ; CODE XREF: __output_s_l+781j
.text:00409379		       mov     eax, [ebp+1F8h+radix]
.text:0040937C		       cdq
.text:0040937D		       push    edx
.text:0040937E		       push    eax
.text:0040937F		       push    ebx
.text:00409380		       push    edi
.text:00409381		       call    __aulldvrm
.text:00409386		       add     ecx, 30h
.text:00409389		       cmp     ecx, 39h
.text:0040938C		       mov     [ebp+1F8h+count], ebx
.text:0040938F		       mov     edi, eax	       ; f
.text:00409391		       mov     ebx, edx
.text:00409393		       jle     short loc_409398
.text:00409395		       add     ecx, [ebp+1F8h+hexadd]
.text:00409398
.text:00409398 loc_409398:			       ; CODE XREF: __output_s_l+7A3j
.text:00409398		       mov     [esi], cl
.text:0040939A		       dec     esi
.text:0040939B		       jmp     short loc_409369
.text:0040939D ; ---------------------------------------------------------------------------
.text:0040939D
.text:0040939D loc_40939D:			       ; CODE XREF: __output_s_l+787j
.text:0040939D		       lea     eax, [ebp+1F8h+buffer+1FFh]
.text:004093A3		       sub     eax, esi
.text:004093A5		       inc     esi
.text:004093A6		       test    word ptr	[ebp+1F8h+flags], 200h
.text:004093AC		       mov     [ebp+1F8h+radix], eax
.text:004093AF		       mov     dword ptr [ebp+1F8h+text], esi
.text:004093B2		       jz      short loc_409401
.text:004093B4		       test    eax, eax
.text:004093B6		       jz      short loc_4093BF
.text:004093B8		       mov     ecx, esi
.text:004093BA		       cmp     byte ptr	[ecx], 30h
.text:004093BD		       jz      short loc_409401
.text:004093BF
.text:004093BF loc_4093BF:			       ; CODE XREF: __output_s_l+7C6j
.text:004093BF		       dec     dword ptr [ebp+1F8h+text]
.text:004093C2		       mov     ecx, dword ptr [ebp+1F8h+text]
.text:004093C5		       mov     byte ptr	[ecx], 30h
.text:004093C8		       inc     eax
.text:004093C9		       jmp     short loc_4093FE
.text:004093CB ; ---------------------------------------------------------------------------
.text:004093CB
.text:004093CB loc_4093CB:			       ; CODE XREF: __output_s_l+7E6j
.text:004093CB		       dec     ecx
.text:004093CC		       cmp     word ptr	[eax], 0
.text:004093D0		       jz      short loc_4093D8
.text:004093D2		       inc     eax
.text:004093D3		       inc     eax
.text:004093D4
.text:004093D4 loc_4093D4:			       ; CODE XREF: __output_s_l+456j
.text:004093D4		       test    ecx, ecx
.text:004093D6		       jnz     short loc_4093CB
.text:004093D8
.text:004093D8 loc_4093D8:			       ; CODE XREF: __output_s_l+7E0j
.text:004093D8		       sub     eax, dword ptr [ebp+1F8h+text]
.text:004093DB		       sar     eax, 1
.text:004093DD		       jmp     short loc_4093FE
.text:004093DF ; ---------------------------------------------------------------------------
.text:004093DF
.text:004093DF loc_4093DF:			       ; CODE XREF: __output_s_l+43Aj
.text:004093DF		       test    edi, edi
.text:004093E1		       jnz     short loc_4093EB
.text:004093E3		       mov     eax, ___nullstring
.text:004093E8		       mov     dword ptr [ebp+1F8h+text], eax
.text:004093EB
.text:004093EB loc_4093EB:			       ; CODE XREF: __output_s_l+7F1j
.text:004093EB		       mov     eax, dword ptr [ebp+1F8h+text]
.text:004093EE		       jmp     short loc_4093F7
.text:004093F0 ; ---------------------------------------------------------------------------
.text:004093F0
.text:004093F0 loc_4093F0:			       ; CODE XREF: __output_s_l+809j
.text:004093F0		       dec     ecx
.text:004093F1		       cmp     byte ptr	[eax], 0
.text:004093F4		       jz      short loc_4093FB
.text:004093F6		       inc     eax
.text:004093F7
.text:004093F7 loc_4093F7:			       ; CODE XREF: __output_s_l+7FEj
.text:004093F7		       test    ecx, ecx
.text:004093F9		       jnz     short loc_4093F0
.text:004093FB
.text:004093FB loc_4093FB:			       ; CODE XREF: __output_s_l+804j
.text:004093FB		       sub     eax, dword ptr [ebp+1F8h+text]
.text:004093FE
.text:004093FE loc_4093FE:			       ; CODE XREF: __output_s_l+4F2j
.text:004093FE					       ; __output_s_l+4FBj ...
.text:004093FE		       mov     [ebp+1F8h+radix], eax
.text:00409401
.text:00409401 loc_409401:			       ; CODE XREF: __output_s_l+3C0j
.text:00409401					       ; __output_s_l+472j ...
.text:00409401		       cmp     [ebp+1F8h+no_output], 0
.text:00409405		       jnz     loc_409506
.text:0040940B		       mov     eax, [ebp+1F8h+flags]
.text:0040940E		       test    al, 40h
.text:00409410		       jz      short loc_409437
.text:00409412		       test    ax, 100h
.text:00409416		       jz      short loc_40941E
.text:00409418		       mov     [ebp+1F8h+prefix], 2Dh
.text:0040941C		       jmp     short loc_409430
.text:0040941E ; ---------------------------------------------------------------------------
.text:0040941E
.text:0040941E loc_40941E:			       ; CODE XREF: __output_s_l+826j
.text:0040941E		       test    al, 1
.text:00409420		       jz      short loc_409428
.text:00409422		       mov     [ebp+1F8h+prefix], 2Bh
.text:00409426		       jmp     short loc_409430
.text:00409428 ; ---------------------------------------------------------------------------
.text:00409428
.text:00409428 loc_409428:			       ; CODE XREF: __output_s_l+830j
.text:00409428		       test    al, 2
.text:0040942A		       jz      short loc_409437
.text:0040942C		       mov     [ebp+1F8h+prefix], 20h
.text:00409430
.text:00409430 loc_409430:			       ; CODE XREF: __output_s_l+82Cj
.text:00409430					       ; __output_s_l+836j
.text:00409430		       mov     [ebp+1F8h+prefixlen], 1
.text:00409437
.text:00409437 loc_409437:			       ; CODE XREF: __output_s_l+820j
.text:00409437					       ; __output_s_l+83Aj
.text:00409437		       mov     ebx, [ebp+1F8h+fldwidth]
.text:0040943A		       sub     ebx, [ebp+1F8h+radix]
.text:0040943D		       sub     ebx, [ebp+1F8h+prefixlen]
.text:00409440		       test    byte ptr	[ebp+1F8h+flags], 0Ch
.text:00409444		       jnz     short loc_409457
.text:00409446		       push    [ebp+1F8h+f]    ; f
.text:00409449		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:0040944C		       push    ebx	       ; num
.text:0040944D		       push    20h	       ; ch
.text:0040944F		       call    write_multi_char_0
.text:00409454		       add     esp, 0Ch
.text:00409457
.text:00409457 loc_409457:			       ; CODE XREF: __output_s_l+854j
.text:00409457		       push    [ebp+1F8h+prefixlen] ; len
.text:0040945A		       mov     edi, [ebp+1F8h+f] ; f
.text:0040945D		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00409460		       lea     ecx, [ebp+1F8h+prefix] ;	string
.text:00409463		       call    write_string_0
.text:00409468		       test    byte ptr	[ebp+1F8h+flags], 8
.text:0040946C		       pop     ecx
.text:0040946D		       jz      short loc_409484
.text:0040946F		       test    byte ptr	[ebp+1F8h+flags], 4
.text:00409473		       jnz     short loc_409484
.text:00409475		       push    edi	       ; f
.text:00409476		       push    ebx	       ; num
.text:00409477		       push    30h	       ; ch
.text:00409479		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:0040947C		       call    write_multi_char_0
.text:00409481		       add     esp, 0Ch
.text:00409484
.text:00409484 loc_409484:			       ; CODE XREF: __output_s_l+87Dj
.text:00409484					       ; __output_s_l+883j
.text:00409484		       cmp     [ebp+1F8h+bufferiswide],	0
.text:00409488		       mov     eax, [ebp+1F8h+radix]
.text:0040948B		       jz      short loc_4094DE
.text:0040948D		       test    eax, eax
.text:0040948F		       jle     short loc_4094DE
.text:00409491		       mov     esi, dword ptr [ebp+1F8h+text]
.text:00409494		       mov     [ebp+1F8h+count], eax
.text:00409497
.text:00409497 loc_409497:			       ; CODE XREF: __output_s_l+8E4j
.text:00409497		       movzx   eax, word ptr [esi]
.text:0040949A		       dec     [ebp+1F8h+count]
.text:0040949D		       push    eax	       ; wchar
.text:0040949E		       push    6	       ; sizeInBytes
.text:004094A0		       lea     eax, [ebp+1F8h+L_buffer]
.text:004094A6		       push    eax	       ; dst
.text:004094A7		       lea     eax, [ebp+1F8h+retval]
.text:004094AA		       inc     esi
.text:004094AB		       push    eax	       ; pRetValue
.text:004094AC		       inc     esi
.text:004094AD		       call    _wctomb_s
.text:004094B2		       add     esp, 10h
.text:004094B5		       test    eax, eax
.text:004094B7		       jnz     short loc_4094D8
.text:004094B9		       cmp     [ebp+1F8h+retval], eax
.text:004094BC		       jz      short loc_4094D8
.text:004094BE		       push    [ebp+1F8h+retval] ; len
.text:004094C1		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:004094C4		       lea     ecx, [ebp+1F8h+L_buffer]	; string
.text:004094CA		       call    write_string_0
.text:004094CF		       cmp     [ebp+1F8h+count], 0
.text:004094D3		       pop     ecx
.text:004094D4		       jnz     short loc_409497
.text:004094D6		       jmp     short loc_4094EB
.text:004094D8 ; ---------------------------------------------------------------------------
.text:004094D8
.text:004094D8 loc_4094D8:			       ; CODE XREF: __output_s_l+8C7j
.text:004094D8					       ; __output_s_l+8CCj
.text:004094D8		       or      [ebp+1F8h+charsout], 0FFFFFFFFh
.text:004094DC		       jmp     short loc_4094EB
.text:004094DE ; ---------------------------------------------------------------------------
.text:004094DE
.text:004094DE loc_4094DE:			       ; CODE XREF: __output_s_l+89Bj
.text:004094DE					       ; __output_s_l+89Fj
.text:004094DE		       mov     ecx, dword ptr [ebp+1F8h+text] ;	string
.text:004094E1		       push    eax	       ; len
.text:004094E2		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:004094E5		       call    write_string_0
.text:004094EA		       pop     ecx
.text:004094EB
.text:004094EB loc_4094EB:			       ; CODE XREF: __output_s_l+8E6j
.text:004094EB					       ; __output_s_l+8ECj
.text:004094EB		       cmp     [ebp+1F8h+charsout], 0
.text:004094EF		       jl      short loc_409506
.text:004094F1		       test    byte ptr	[ebp+1F8h+flags], 4
.text:004094F5		       jz      short loc_409506
.text:004094F7		       push    edi	       ; f
.text:004094F8		       push    ebx	       ; num
.text:004094F9		       push    20h	       ; ch
.text:004094FB		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:004094FE		       call    write_multi_char_0
.text:00409503		       add     esp, 0Ch
.text:00409506
.text:00409506 loc_409506:			       ; CODE XREF: __output_s_l+58Aj
.text:00409506					       ; __output_s_l+815j ...
.text:00409506		       cmp     [ebp+1F8h+heapbuf], 0
.text:0040950A		       jz      short loc_409519	; default
.text:0040950C		       push    [ebp+1F8h+heapbuf] ; pBlock
.text:0040950F		       call    _free
.text:00409514		       and     [ebp+1F8h+heapbuf], 0
.text:00409518		       pop     ecx
.text:00409519
.text:00409519 loc_409519:			       ; CODE XREF: __output_s_l+1A9j
.text:00409519					       ; __output_s_l+1CEj ...
.text:00409519		       mov     ebx, [ebp+1F8h+var_244] ; default
.text:0040951C		       mov     al, [ebx]
.text:0040951E		       test    al, al
.text:00409520		       mov     [ebp+1F8h+var_211], al
.text:00409523		       jz      short loc_409546
.text:00409525		       mov     edi, [ebp+1F8h+var_224]
.text:00409528		       mov     dl, al
.text:0040952A		       jmp     loc_408D4F
.text:0040952F ; ---------------------------------------------------------------------------
.text:0040952F
.text:0040952F loc_40952F:			       ; CODE XREF: __output_s_l+19Ej
.text:0040952F					       ; __output_s_l+37Ej ...
.text:0040952F		       call    __errno
.text:00409534		       mov     dword ptr [eax],	16h
.text:0040953A		       xor     eax, eax
.text:0040953C		       push    eax
.text:0040953D		       push    eax
.text:0040953E		       push    eax
.text:0040953F		       push    eax
.text:00409540		       push    eax
.text:00409541		       jmp     loc_408C60
.text:00409546 ; ---------------------------------------------------------------------------
.text:00409546
.text:00409546 loc_409546:			       ; CODE XREF: __output_s_l+168j
.text:00409546					       ; __output_s_l+933j
.text:00409546		       xor     esi, esi
.text:00409548		       cmp     [ebp+1F8h+state], esi
.text:0040954B		       jz      short loc_409557
.text:0040954D		       cmp     [ebp+1F8h+state], 7
.text:00409551		       jnz     loc_408C50
.text:00409557
.text:00409557 loc_409557:			       ; CODE XREF: __output_s_l+159j
.text:00409557					       ; __output_s_l+95Bj
.text:00409557		       cmp     [ebp+1F8h+_loc_update.updated], 0
.text:0040955B		       jz      short loc_409564
.text:0040955D		       mov     eax, [ebp+1F8h+_loc_update.ptd]
.text:00409560		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00409564
.text:00409564 loc_409564:			       ; CODE XREF: __output_s_l+96Bj
.text:00409564		       mov     eax, [ebp+1F8h+charsout]
.text:00409567
.text:00409567 loc_409567:			       ; CODE XREF: __output_s_l+88j
.text:00409567		       mov     ecx, [ebp+1F8h+var_4]
.text:0040956D		       pop     edi
.text:0040956E		       pop     esi
.text:0040956F		       xor     ecx, ebp
.text:00409571		       pop     ebx
.text:00409572		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00409577		       add     ebp, 1F8h
.text:0040957D		       leave
.text:0040957E		       retn
.text:0040957E ; ---------------------------------------------------------------------------
.text:0040957F		       align 10h
.text:00409580 off_409580      dd offset NORMAL_STATE_0	; DATA XREF: __output_s_l+1AFr
.text:00409580		       dd offset $LN131	       ; jump table for	switch statement
.text:00409580		       dd offset $LN130_0
.text:00409580		       dd offset $LN122
.text:00409580		       dd offset $LN118
.text:00409580		       dd offset $LN117_0
.text:00409580		       dd offset $LN113
.text:00409580		       dd offset $LN97
.text:00409580 __output_s_l    endp
.text:00409580
.text:004095A0
.text:004095A0 ; =============== S U B R O U T I N E =======================================
.text:004095A0
.text:004095A0 ; Attributes: bp-based frame
.text:004095A0
.text:004095A0 ; int __cdecl _validate_param_reuseA(positional_param *pos, ARG_TYPE get_fn_type, char cur_type,	int cur_flags)
.text:004095A0 __validate_param_reuseA proc near       ; CODE XREF: __output_p_l+8CBp
.text:004095A0					       ; __output_p_l+C01p
.text:004095A0
.text:004095A0 pos	       = dword ptr  8
.text:004095A0 get_fn_type     = dword ptr  0Ch
.text:004095A0 cur_type	       = byte ptr  10h
.text:004095A0 cur_flags       = dword ptr  14h
.text:004095A0
.text:004095A0		       push    ebp
.text:004095A1		       mov     ebp, esp
.text:004095A3		       mov     dl, [ebp+cur_type]
.text:004095A6		       push    esi
.text:004095A7		       push    edi
.text:004095A8		       mov     edi, [ebp+pos]
.text:004095AB		       mov     al, [edi+8]
.text:004095AE		       cmp     al, 70h
.text:004095B0		       jz      loc_4096BC
.text:004095B6		       cmp     dl, 70h
.text:004095B9		       jz      loc_4096BC
.text:004095BF		       cmp     al, 73h
.text:004095C1		       jz      short loc_4095CB
.text:004095C3		       cmp     al, 53h
.text:004095C5		       jz      short loc_4095CB
.text:004095C7		       xor     esi, esi
.text:004095C9		       jmp     short loc_4095CE
.text:004095CB ; ---------------------------------------------------------------------------
.text:004095CB
.text:004095CB loc_4095CB:			       ; CODE XREF: __validate_param_reuseA+21j
.text:004095CB					       ; __validate_param_reuseA+25j
.text:004095CB		       xor     esi, esi
.text:004095CD		       inc     esi
.text:004095CE
.text:004095CE loc_4095CE:			       ; CODE XREF: __validate_param_reuseA+29j
.text:004095CE		       cmp     dl, 73h
.text:004095D1		       jz      short loc_4095DC
.text:004095D3		       cmp     dl, 53h
.text:004095D6		       jz      short loc_4095DC
.text:004095D8		       xor     ecx, ecx
.text:004095DA		       jmp     short loc_4095DF
.text:004095DC ; ---------------------------------------------------------------------------
.text:004095DC
.text:004095DC loc_4095DC:			       ; CODE XREF: __validate_param_reuseA+31j
.text:004095DC					       ; __validate_param_reuseA+36j
.text:004095DC		       xor     ecx, ecx
.text:004095DE		       inc     ecx
.text:004095DF
.text:004095DF loc_4095DF:			       ; CODE XREF: __validate_param_reuseA+3Aj
.text:004095DF		       test    esi, esi
.text:004095E1		       jnz     loc_409690
.text:004095E7		       test    ecx, ecx
.text:004095E9		       jnz     loc_4096B8
.text:004095EF		       cmp     al, 64h
.text:004095F1		       jz      short loc_409641
.text:004095F3		       cmp     al, 69h
.text:004095F5		       jz      short loc_409625
.text:004095F7		       cmp     al, 6Fh
.text:004095F9		       jz      short loc_409625
.text:004095FB		       cmp     al, 75h
.text:004095FD		       jz      short loc_409625
.text:004095FF		       cmp     al, 78h
.text:00409601		       jz      short loc_409625
.text:00409603		       cmp     al, 58h
.text:00409605		       jz      short loc_409625
.text:00409607		       cmp     dl, 64h
.text:0040960A		       jz      short loc_409625
.text:0040960C		       cmp     dl, 69h
.text:0040960F		       jz      short loc_409625
.text:00409611		       cmp     dl, 6Fh
.text:00409614		       jz      short loc_409625
.text:00409616		       cmp     dl, 75h
.text:00409619		       jz      short loc_409625
.text:0040961B		       cmp     dl, 78h
.text:0040961E		       jz      short loc_409625
.text:00409620		       cmp     dl, 58h
.text:00409623		       jnz     short loc_409684
.text:00409625
.text:00409625 loc_409625:			       ; CODE XREF: __validate_param_reuseA+55j
.text:00409625					       ; __validate_param_reuseA+59j ...
.text:00409625		       cmp     al, 64h
.text:00409627		       jz      short loc_409641
.text:00409629		       cmp     al, 69h
.text:0040962B		       jz      short loc_409641
.text:0040962D		       cmp     al, 6Fh
.text:0040962F		       jz      short loc_409641
.text:00409631		       cmp     al, 75h
.text:00409633		       jz      short loc_409641
.text:00409635		       cmp     al, 78h
.text:00409637		       jz      short loc_409641
.text:00409639		       cmp     al, 58h
.text:0040963B		       jz      short loc_409641
.text:0040963D		       xor     ecx, ecx
.text:0040963F		       jmp     short loc_409644
.text:00409641 ; ---------------------------------------------------------------------------
.text:00409641
.text:00409641 loc_409641:			       ; CODE XREF: __validate_param_reuseA+51j
.text:00409641					       ; __validate_param_reuseA+87j ...
.text:00409641		       xor     ecx, ecx
.text:00409643		       inc     ecx
.text:00409644
.text:00409644 loc_409644:			       ; CODE XREF: __validate_param_reuseA+9Fj
.text:00409644		       cmp     dl, 64h
.text:00409647		       jz      short loc_409666
.text:00409649		       cmp     dl, 69h
.text:0040964C		       jz      short loc_409666
.text:0040964E		       cmp     dl, 6Fh
.text:00409651		       jz      short loc_409666
.text:00409653		       cmp     dl, 75h
.text:00409656		       jz      short loc_409666
.text:00409658		       cmp     dl, 78h
.text:0040965B		       jz      short loc_409666
.text:0040965D		       cmp     dl, 58h
.text:00409660		       jz      short loc_409666
.text:00409662		       xor     eax, eax
.text:00409664		       jmp     short loc_409669
.text:00409666 ; ---------------------------------------------------------------------------
.text:00409666
.text:00409666 loc_409666:			       ; CODE XREF: __validate_param_reuseA+A7j
.text:00409666					       ; __validate_param_reuseA+ACj ...
.text:00409666		       xor     eax, eax
.text:00409668		       inc     eax
.text:00409669
.text:00409669 loc_409669:			       ; CODE XREF: __validate_param_reuseA+C4j
.text:00409669		       cmp     ecx, eax
.text:0040966B		       jnz     short loc_4096B8
.text:0040966D		       mov     eax, [edi+0Ch]
.text:00409670		       mov     ecx, eax
.text:00409672		       xor     ecx, [ebp+cur_flags]
.text:00409675		       test    ecx, 10000h
.text:0040967B		       jnz     short loc_4096B8
.text:0040967D		       xor     eax, [ebp+cur_flags]
.text:00409680		       test    al, 20h
.text:00409682		       jnz     short loc_4096B8
.text:00409684
.text:00409684 loc_409684:			       ; CODE XREF: __validate_param_reuseA+83j
.text:00409684		       mov     ecx, [edi]
.text:00409686		       xor     eax, eax
.text:00409688		       cmp     ecx, [ebp+get_fn_type]
.text:0040968B		       setz    al
.text:0040968E		       jmp     short loc_4096C5
.text:00409690 ; ---------------------------------------------------------------------------
.text:00409690
.text:00409690 loc_409690:			       ; CODE XREF: __validate_param_reuseA+41j
.text:00409690		       cmp     esi, ecx
.text:00409692		       jnz     short loc_4096B8
.text:00409694		       mov     ecx, [edi+0Ch]
.text:00409697		       mov     edx, [ebp+cur_flags]
.text:0040969A		       mov     eax, 810h
.text:0040969F		       and     ecx, eax
.text:004096A1		       neg     ecx
.text:004096A3		       sbb     ecx, ecx
.text:004096A5		       and     edx, eax
.text:004096A7		       neg     ecx
.text:004096A9		       neg     edx
.text:004096AB		       sbb     edx, edx
.text:004096AD		       neg     edx
.text:004096AF		       cmp     ecx, edx
.text:004096B1		       jnz     short loc_4096B8
.text:004096B3		       xor     eax, eax
.text:004096B5		       inc     eax
.text:004096B6		       jmp     short loc_4096C5
.text:004096B8 ; ---------------------------------------------------------------------------
.text:004096B8
.text:004096B8 loc_4096B8:			       ; CODE XREF: __validate_param_reuseA+49j
.text:004096B8					       ; __validate_param_reuseA+CBj ...
.text:004096B8		       xor     eax, eax
.text:004096BA		       jmp     short loc_4096C5
.text:004096BC ; ---------------------------------------------------------------------------
.text:004096BC
.text:004096BC loc_4096BC:			       ; CODE XREF: __validate_param_reuseA+10j
.text:004096BC					       ; __validate_param_reuseA+19j
.text:004096BC		       xor     ecx, ecx
.text:004096BE		       cmp     al, dl
.text:004096C0		       setz    cl
.text:004096C3		       mov     eax, ecx
.text:004096C5
.text:004096C5 loc_4096C5:			       ; CODE XREF: __validate_param_reuseA+EEj
.text:004096C5					       ; __validate_param_reuseA+116j ...
.text:004096C5		       pop     edi
.text:004096C6		       pop     esi
.text:004096C7		       pop     ebp
.text:004096C8		       retn
.text:004096C8 __validate_param_reuseA endp
.text:004096C8
.text:004096C9
.text:004096C9 ; =============== S U B R O U T I N E =======================================
.text:004096C9
.text:004096C9
.text:004096C9 ; void __usercall write_char_1(char ch<al>, _iobuf *f<ecx>, int *pnumwritten<esi>)
.text:004096C9 write_char_1    proc near	       ; CODE XREF: write_multi_char_1+11p
.text:004096C9					       ; write_string_1+22p ...
.text:004096C9 f = ecx
.text:004096C9 pnumwritten = esi
.text:004096C9		       test    byte ptr	[f+0Ch], 40h
.text:004096CD		       jz      short loc_4096D5
.text:004096CF		       cmp     dword ptr [f+8],	0
.text:004096D3		       jz      short loc_4096F9
.text:004096D5
.text:004096D5 loc_4096D5:			       ; CODE XREF: write_char_1+4j
.text:004096D5		       dec     dword ptr [f+4]
.text:004096D8		       js      short loc_4096E5
.text:004096DA		       mov     edx, [f]
.text:004096DC		       mov     [edx], al
.text:004096DE		       inc     dword ptr [f]
.text:004096E0		       movzx   eax, al
.text:004096E3		       jmp     short loc_4096F1
.text:004096E5 ; ---------------------------------------------------------------------------
.text:004096E5
.text:004096E5 loc_4096E5:			       ; CODE XREF: write_char_1+Fj
.text:004096E5		       movsx   eax, al
.text:004096E8		       push    f	       ; str
.text:004096E9		       push    eax	       ; ch
.text:004096EA		       call    __flsbuf
.text:004096EF		       pop     f
.text:004096F0		       pop     f
.text:004096F1
.text:004096F1 loc_4096F1:			       ; CODE XREF: write_char_1+1Aj
.text:004096F1		       cmp     eax, 0FFFFFFFFh
.text:004096F4		       jnz     short loc_4096F9
.text:004096F6		       or      [pnumwritten], eax
.text:004096F8		       retn
.text:004096F9 ; ---------------------------------------------------------------------------
.text:004096F9
.text:004096F9 loc_4096F9:			       ; CODE XREF: write_char_1+Aj
.text:004096F9					       ; write_char_1+2Bj
.text:004096F9		       inc     dword ptr [pnumwritten]
.text:004096FB		       retn
.text:004096FB write_char_1    endp
.text:004096FB
.text:004096FC
.text:004096FC ; =============== S U B R O U T I N E =======================================
.text:004096FC
.text:004096FC ; Attributes: bp-based frame
.text:004096FC
.text:004096FC ; void __usercall write_multi_char_1(char ch, int num, _iobuf *f, int *pnumwritten<eax>)
.text:004096FC write_multi_char_1 proc near	       ; CODE XREF: __output_p_l+DECp
.text:004096FC					       ; __output_p_l+E1Fp ...
.text:004096FC
.text:004096FC arg_0	       = byte ptr  8
.text:004096FC num	       = dword ptr  0Ch
.text:004096FC f	       = dword ptr  10h
.text:004096FC
.text:004096FC pnumwritten = eax
.text:004096FC		       push    ebp
.text:004096FD		       mov     ebp, esp
.text:004096FF		       push    esi
.text:00409700		       mov     esi, pnumwritten	; pnumwritten
.text:00409702		       jmp     short loc_409717
.text:00409704 ; ---------------------------------------------------------------------------
.text:00409704
.text:00409704 loc_409704:			       ; CODE XREF: write_multi_char_1+1Fj
.text:00409704		       mov     ecx, [ebp+f]    ; f
.text:00409707		       mov     al, [ebp+arg_0] ; ch
.text:0040970A		       dec     [ebp+num]
.text:0040970D		       call    write_char_1
.text:00409712		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00409715		       jz      short loc_40971D
.text:00409717
.text:00409717 loc_409717:			       ; CODE XREF: write_multi_char_1+6j
.text:00409717		       cmp     [ebp+num], 0
.text:0040971B		       jg      short loc_409704
.text:0040971D
.text:0040971D loc_40971D:			       ; CODE XREF: write_multi_char_1+19j
.text:0040971D		       pop     esi
.text:0040971E		       pop     ebp
.text:0040971F		       retn
.text:0040971F write_multi_char_1 endp
.text:0040971F
.text:00409720
.text:00409720 ; =============== S U B R O U T I N E =======================================
.text:00409720
.text:00409720
.text:00409720 ; void __usercall write_string_1(char *string<ecx>, int len, _iobuf *f<edi>, int	*pnumwritten<eax>)
.text:00409720 write_string_1  proc near	       ; CODE XREF: __output_p_l+E00p
.text:00409720					       ; __output_p_l+E6Dp ...
.text:00409720
.text:00409720 len	       = dword ptr  4
.text:00409720
.text:00409720 string =	ecx
.text:00409720 f = edi
.text:00409720 pnumwritten = eax
.text:00409720		       test    byte ptr	[f+0Ch], 40h
.text:00409724		       push    ebx
.text:00409725		       push    esi
.text:00409726		       mov     esi, pnumwritten	; pnumwritten
.text:00409728		       mov     ebx, string
.text:0040972A		       jz      short loc_409760
.text:0040972C		       cmp     dword ptr [f+8],	0
.text:00409730		       jnz     short loc_409760
.text:00409732		       mov     pnumwritten, [esp+8+len]
.text:00409736		       add     [esi], pnumwritten
.text:00409738		       jmp     short loc_409767
.text:0040973A ; ---------------------------------------------------------------------------
.text:0040973A
.text:0040973A loc_40973A:			       ; CODE XREF: write_string_1+45j
.text:0040973A		       mov     al, [ebx]       ; ch
.text:0040973C		       dec     [esp+8+len]
.text:00409740		       mov     string, f       ; f
.text:00409742		       call    write_char_1
.text:00409747		       inc     ebx
.text:00409748		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:0040974B		       jnz     short loc_409760
.text:0040974D		       call    __errno
.text:00409752		       cmp     dword ptr [pnumwritten],	2Ah
.text:00409755		       jnz     short loc_409767
.text:00409757		       mov     string, f       ; f
.text:00409759		       mov     al, 3Fh	       ; ch
.text:0040975B		       call    write_char_1
.text:00409760
.text:00409760 loc_409760:			       ; CODE XREF: write_string_1+Aj
.text:00409760					       ; write_string_1+10j ...
.text:00409760		       cmp     [esp+8+len], 0
.text:00409765		       jg      short loc_40973A
.text:00409767
.text:00409767 loc_409767:			       ; CODE XREF: write_string_1+18j
.text:00409767					       ; write_string_1+35j
.text:00409767		       pop     esi
.text:00409768		       pop     ebx
.text:00409769		       retn
.text:00409769 write_string_1  endp
.text:00409769
.text:0040976A
.text:0040976A ; =============== S U B R O U T I N E =======================================
.text:0040976A
.text:0040976A
.text:0040976A ; _CRT_DOUBLE __cdecl get_crtdouble_arg(char **pargptr)
.text:0040976A _get_crtdouble_arg proc near
.text:0040976A
.text:0040976A pargptr	       = dword ptr  4
.text:0040976A
.text:0040976A		       mov     eax, [esp+pargptr]
.text:0040976E		       add     dword ptr [eax],	8
.text:00409771		       mov     ecx, [eax]
.text:00409773		       mov     eax, [ecx-8]
.text:00409776		       mov     edx, [ecx-4]
.text:00409779		       retn
.text:00409779 _get_crtdouble_arg endp
.text:00409779
.text:0040977A
.text:0040977A ; =============== S U B R O U T I N E =======================================
.text:0040977A
.text:0040977A ; Attributes: bp-based frame fpd=290h
.text:0040977A
.text:0040977A ; int __cdecl _output_p_l(_iobuf	*stream, const char *format, localeinfo_struct *plocinfo, char *argptr)
.text:0040977A __output_p_l    proc near	       ; DATA XREF: __vprintf_p_l+Co
.text:0040977A					       ; __vprintf_p+Ao ...
.text:0040977A
.text:0040977A pos_value       = positional_param ptr -8D0h
.text:0040977A saved_format    = dword ptr -290h
.text:0040977A tmp	       = _CRT_DOUBLE ptr -28Ch
.text:0040977A retval	       = dword ptr -284h
.text:0040977A capexp	       = dword ptr -280h
.text:0040977A heapbuf	       = dword ptr -27Ch
.text:0040977A no_output       = dword ptr -278h
.text:0040977A hexadd	       = dword ptr -274h
.text:0040977A f	       = dword ptr -270h
.text:0040977A textlen	       = dword ptr -268h
.text:0040977A state	       = dword ptr -264h
.text:0040977A bufferiswide    = dword ptr -260h
.text:0040977A end_pos	       = dword ptr -25Ch
.text:0040977A prefixlen       = dword ptr -258h
.text:0040977A max_pos	       = dword ptr -254h
.text:0040977A fldwidth	       = dword ptr -250h
.text:0040977A count	       = dword ptr -24Ch
.text:0040977A prefix	       = byte ptr -248h
.text:0040977A charsout	       = dword ptr -244h
.text:0040977A var_240	       = dword ptr -240h
.text:0040977A _loc_update     = _LocaleUpdate ptr -23Ch
.text:0040977A cur_type	       = byte ptr -22Ch
.text:0040977A pass	       = dword ptr -228h
.text:0040977A format_type     = dword ptr -224h
.text:0040977A precision       = dword ptr -220h
.text:0040977A text	       = $12F061FBE778B92DEB8200A0ACF7A038 ptr -21Ch
.text:0040977A type_pos	       = dword ptr -218h
.text:0040977A var_214	       = dword ptr -214h
.text:0040977A flags	       = dword ptr -210h
.text:0040977A buffer	       = $C8014B43F160BFD769FAE3F15553333C ptr -20Ch
.text:0040977A L_buffer	       = byte ptr -0Ch
.text:0040977A var_4	       = dword ptr -4
.text:0040977A stream	       = dword ptr  8
.text:0040977A format	       = dword ptr  0Ch
.text:0040977A plocinfo	       = dword ptr  10h
.text:0040977A argptr	       = dword ptr  14h
.text:0040977A
.text:0040977A		       push    ebp
.text:0040977B		       lea     ebp, [esp-290h]
.text:00409782		       sub     esp, 8D0h
.text:00409788		       mov     eax, ___security_cookie
.text:0040978D		       xor     eax, ebp
.text:0040978F		       mov     [ebp+290h+var_4], eax
.text:00409795		       mov     eax, [ebp+290h+argptr]
.text:0040979B		       push    ebx
.text:0040979C		       push    esi
.text:0040979D		       mov     esi, [ebp+290h+format]
.text:004097A3		       push    edi
.text:004097A4		       mov     edi, [ebp+290h+stream]
.text:004097AA		       push    [ebp+290h+plocinfo] ; plocinfo
.text:004097B0		       xor     ebx, ebx
.text:004097B2		       lea     ecx, [ebp+290h+_loc_update] ; this
.text:004097B5		       mov     [ebp+290h+f], edi
.text:004097B8		       mov     [ebp+290h+var_240], esi
.text:004097BB		       mov     [ebp+290h+var_214], eax
.text:004097BE		       mov     [ebp+290h+hexadd], ebx
.text:004097C1		       mov     [ebp+290h+flags], ebx
.text:004097C7		       mov     [ebp+290h+prefixlen], ebx
.text:004097CA		       mov     [ebp+290h+no_output], ebx
.text:004097CD		       mov     [ebp+290h+bufferiswide],	ebx
.text:004097D0		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004097D5		       or      [ebp+290h+format_type], 0FFFFFFFFh
.text:004097D9		       cmp     edi, ebx
.text:004097DB		       mov     [ebp+290h+end_pos], ebx
.text:004097DE		       jnz     short loc_40980C
.text:004097E0
.text:004097E0 loc_4097E0:			       ; CODE XREF: __output_p_l+DFj
.text:004097E0					       ; __output_p_l+124j ...
.text:004097E0		       call    __errno
.text:004097E5		       push    ebx	       ; pReserved
.text:004097E6		       push    ebx	       ; nLine
.text:004097E7		       push    ebx	       ; pszFile
.text:004097E8		       push    ebx	       ; pszFunction
.text:004097E9		       push    ebx	       ; pszExpression
.text:004097EA		       mov     dword ptr [eax],	16h
.text:004097F0		       call    __invalid_parameter
.text:004097F5		       add     esp, 14h
.text:004097F8		       cmp     [ebp+290h+_loc_update.updated], bl
.text:004097FB
.text:004097FB loc_4097FB:			       ; CODE XREF: __output_p_l+8F7j
.text:004097FB		       jz      short loc_409804
.text:004097FD		       mov     eax, [ebp+290h+_loc_update.ptd]
.text:00409800		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00409804
.text:00409804 loc_409804:			       ; CODE XREF: __output_p_l:loc_4097FBj
.text:00409804		       or      eax, 0FFFFFFFFh
.text:00409807		       jmp     loc_40A6CA
.text:0040980C ; ---------------------------------------------------------------------------
.text:0040980C
.text:0040980C loc_40980C:			       ; CODE XREF: __output_p_l+64j
.text:0040980C		       test    byte ptr	[edi+0Ch], 40h
.text:00409810		       jnz     loc_4098A7
.text:00409816		       push    edi	       ; stream
.text:00409817		       call    __fileno
.text:0040981C		       cmp     eax, 0FFFFFFFFh
.text:0040981F		       pop     ecx
.text:00409820		       jz      short loc_409850
.text:00409822		       push    edi	       ; stream
.text:00409823		       call    __fileno
.text:00409828		       cmp     eax, 0FFFFFFFEh
.text:0040982B		       pop     ecx
.text:0040982C		       jz      short loc_409850
.text:0040982E		       push    edi	       ; stream
.text:0040982F		       call    __fileno
.text:00409834		       sar     eax, 5
.text:00409837		       push    edi	       ; stream
.text:00409838		       lea     esi, ds:422F40h[eax*4]
.text:0040983F		       call    __fileno
.text:00409844		       and     eax, 1Fh
.text:00409847		       pop     ecx
.text:00409848		       shl     eax, 6
.text:0040984B		       add     eax, [esi]
.text:0040984D		       pop     ecx
.text:0040984E		       jmp     short loc_409855
.text:00409850 ; ---------------------------------------------------------------------------
.text:00409850
.text:00409850 loc_409850:			       ; CODE XREF: __output_p_l+A6j
.text:00409850					       ; __output_p_l+B2j
.text:00409850		       mov     eax, offset ___badioinfo
.text:00409855
.text:00409855 loc_409855:			       ; CODE XREF: __output_p_l+D4j
.text:00409855		       test    byte ptr	[eax+24h], 7Fh
.text:00409859		       jnz     short loc_4097E0
.text:0040985B		       push    edi	       ; stream
.text:0040985C		       call    __fileno
.text:00409861		       cmp     eax, 0FFFFFFFFh
.text:00409864		       pop     ecx
.text:00409865		       jz      short loc_409895
.text:00409867		       push    edi	       ; stream
.text:00409868		       call    __fileno
.text:0040986D		       cmp     eax, 0FFFFFFFEh
.text:00409870		       pop     ecx
.text:00409871		       jz      short loc_409895
.text:00409873		       push    edi	       ; stream
.text:00409874		       call    __fileno
.text:00409879		       sar     eax, 5
.text:0040987C		       push    edi	       ; stream
.text:0040987D		       lea     esi, ds:422F40h[eax*4]
.text:00409884		       call    __fileno
.text:00409889		       and     eax, 1Fh
.text:0040988C		       pop     ecx
.text:0040988D		       shl     eax, 6
.text:00409890		       add     eax, [esi]
.text:00409892		       pop     ecx
.text:00409893		       jmp     short loc_40989A
.text:00409895 ; ---------------------------------------------------------------------------
.text:00409895
.text:00409895 loc_409895:			       ; CODE XREF: __output_p_l+EBj
.text:00409895					       ; __output_p_l+F7j
.text:00409895		       mov     eax, offset ___badioinfo
.text:0040989A
.text:0040989A loc_40989A:			       ; CODE XREF: __output_p_l+119j
.text:0040989A		       test    byte ptr	[eax+24h], 80h
.text:0040989E		       jnz     loc_4097E0
.text:004098A4		       mov     esi, [ebp+290h+var_240]
.text:004098A7
.text:004098A7 loc_4098A7:			       ; CODE XREF: __output_p_l+96j
.text:004098A7		       cmp     esi, ebx
.text:004098A9		       jz      loc_4097E0
.text:004098AF		       mov     [ebp+290h+charsout], ebx
.text:004098B2		       mov     [ebp+290h+saved_format],	esi
.text:004098B5		       mov     [ebp+290h+pass],	ebx
.text:004098B8
.text:004098B8 loc_4098B8:			       ; CODE XREF: __output_p_l+F3Bj
.text:004098B8		       cmp     [ebp+290h+pass],	1
.text:004098BC		       jnz     short loc_4098C9
.text:004098BE		       cmp     [ebp+290h+format_type], ebx
.text:004098C1		       jz      loc_40A6BA
.text:004098C7		       xor     ebx, ebx
.text:004098C9
.text:004098C9 loc_4098C9:			       ; CODE XREF: __output_p_l+142j
.text:004098C9		       mov     eax, [ebp+290h+saved_format]
.text:004098CC		       or      [ebp+290h+max_pos], 0FFFFFFFFh
.text:004098D0		       or      [ebp+290h+type_pos], 0FFFFFFFFh
.text:004098D4		       or      [ebp+290h+format_type], 0FFFFFFFFh
.text:004098D8		       mov     [ebp+290h+textlen], ebx
.text:004098DB		       mov     dl, [eax]
.text:004098DD		       test    dl, dl
.text:004098DF		       mov     [ebp+290h+state], ebx
.text:004098E2		       mov     [ebp+290h+heapbuf], ebx
.text:004098E5		       mov     [ebp+290h+fldwidth], ebx
.text:004098E8		       mov     [ebp+290h+precision], ebx
.text:004098EB		       mov     [ebp+290h+var_240], eax
.text:004098EE		       mov     [ebp+290h+cur_type], dl
.text:004098F1		       jz      loc_40A6AA
.text:004098F7		       mov     esi, eax
.text:004098F9		       jmp     short loc_4098FE
.text:004098FB ; ---------------------------------------------------------------------------
.text:004098FB
.text:004098FB loc_4098FB:			       ; CODE XREF: __output_p_l+EC9j
.text:004098FB		       mov     dl, [ebp+290h+cur_type]
.text:004098FE
.text:004098FE loc_4098FE:			       ; CODE XREF: __output_p_l+17Fj
.text:004098FE		       inc     esi
.text:004098FF		       xor     edi, edi
.text:00409901		       cmp     [ebp+290h+charsout], edi
.text:00409904		       mov     [ebp+290h+var_240], esi
.text:00409907		       jl      loc_40A64B
.text:0040990D		       mov     al, dl
.text:0040990F		       sub     al, 20h
.text:00409911		       cmp     al, 58h
.text:00409913		       ja      short loc_409924
.text:00409915		       movsx   eax, dl
.text:00409918		       movzx   eax, byte ptr ds:control[eax] ; "_.,"
.text:0040991F		       and     eax, 0Fh
.text:00409922		       jmp     short loc_409926
.text:00409924 ; ---------------------------------------------------------------------------
.text:00409924
.text:00409924 loc_409924:			       ; CODE XREF: __output_p_l+199j
.text:00409924		       xor     eax, eax
.text:00409926
.text:00409926 loc_409926:			       ; CODE XREF: __output_p_l+1A8j
.text:00409926		       mov     ecx, [ebp+290h+state]
.text:00409929		       imul    eax, 9
.text:0040992C		       movzx   eax, ds:___lookuptable_s[eax+ecx]
.text:00409934		       xor     ebx, ebx
.text:00409936		       shr     eax, 4
.text:00409939		       inc     ebx
.text:0040993A		       cmp     eax, ebx
.text:0040993C		       mov     [ebp+290h+state], eax
.text:0040993F		       jnz     loc_4099EB
.text:00409945		       cmp     byte ptr	[esi], 25h
.text:00409948		       jz      loc_4099E1
.text:0040994E		       cmp     [ebp+290h+format_type], 0FFFFFFFFh
.text:00409952		       jnz     short loc_409994
.text:00409954		       push    0Ah	       ; ibase
.text:00409956		       lea     eax, [ebp+290h+end_pos]
.text:00409959		       push    eax	       ; endptr
.text:0040995A		       push    esi	       ; nptr
.text:0040995B		       call    _strtol
.text:00409960		       add     esp, 0Ch
.text:00409963		       test    eax, eax
.text:00409965		       jle     short loc_40998E
.text:00409967		       mov     eax, [ebp+290h+end_pos]
.text:0040996A		       cmp     byte ptr	[eax], 24h
.text:0040996D		       jnz     short loc_40998E
.text:0040996F		       cmp     [ebp+290h+pass],	edi
.text:00409972		       jnz     short loc_409989
.text:00409974		       push    640h	       ; count
.text:00409979		       lea     eax, [ebp+290h+pos_value]
.text:0040997F		       push    edi	       ; value
.text:00409980		       push    eax	       ; dst
.text:00409981		       call    _memset
.text:00409986		       add     esp, 0Ch
.text:00409989
.text:00409989 loc_409989:			       ; CODE XREF: __output_p_l+1F8j
.text:00409989		       mov     [ebp+290h+format_type], ebx
.text:0040998C		       jmp     short loc_409999
.text:0040998E ; ---------------------------------------------------------------------------
.text:0040998E
.text:0040998E loc_40998E:			       ; CODE XREF: __output_p_l+1EBj
.text:0040998E					       ; __output_p_l+1F3j
.text:0040998E		       mov     dl, [ebp+290h+cur_type]
.text:00409991		       mov     [ebp+290h+format_type], edi
.text:00409994
.text:00409994 loc_409994:			       ; CODE XREF: __output_p_l+1D8j
.text:00409994		       cmp     [ebp+290h+format_type], ebx
.text:00409997		       jnz     short loc_4099E1
.text:00409999
.text:00409999 loc_409999:			       ; CODE XREF: __output_p_l+212j
.text:00409999		       push    0Ah	       ; ibase
.text:0040999B		       lea     eax, [ebp+290h+end_pos]
.text:0040999E		       push    eax	       ; endptr
.text:0040999F		       push    esi	       ; nptr
.text:004099A0		       call    _strtol
.text:004099A5		       mov     ecx, [ebp+290h+end_pos]
.text:004099A8		       add     esp, 0Ch
.text:004099AB		       dec     eax
.text:004099AC		       cmp     [ebp+290h+pass],	edi
.text:004099AF		       lea     edx, [ecx+1]
.text:004099B2		       mov     [ebp+290h+type_pos], eax
.text:004099B5		       mov     [ebp+290h+var_240], edx
.text:004099B8		       jnz     short loc_4099DC
.text:004099BA		       cmp     eax, edi
.text:004099BC		       jl      loc_40A055
.text:004099C2		       cmp     byte ptr	[ecx], 24h
.text:004099C5		       jnz     loc_40A055
.text:004099CB		       cmp     eax, 64h
.text:004099CE		       jge     loc_40A055
.text:004099D4		       cmp     eax, [ebp+290h+max_pos]
.text:004099D7		       jle     short loc_4099DC
.text:004099D9		       mov     [ebp+290h+max_pos], eax
.text:004099DC
.text:004099DC loc_4099DC:			       ; CODE XREF: __output_p_l+23Ej
.text:004099DC					       ; __output_p_l+25Dj
.text:004099DC		       mov     esi, edx
.text:004099DE		       mov     dl, [ebp+290h+cur_type]
.text:004099E1
.text:004099E1 loc_4099E1:			       ; CODE XREF: __output_p_l+1CEj
.text:004099E1					       ; __output_p_l+21Dj ...
.text:004099E1		       mov     eax, [ebp+290h+state]
.text:004099E4		       jmp     ds:off_40A6E2[eax*4]
.text:004099EB ; ---------------------------------------------------------------------------
.text:004099EB
.text:004099EB loc_4099EB:			       ; CODE XREF: __output_p_l+1C5j
.text:004099EB		       cmp     eax, 8
.text:004099EE		       jz      loc_40A055
.text:004099F4		       cmp     eax, 7
.text:004099F7		       ja      loc_40A639
.text:004099FD		       jmp     short loc_4099E1
.text:004099FF ; ---------------------------------------------------------------------------
.text:004099FF
.text:004099FF $LN265:				       ; CODE XREF: __output_p_l+26Aj
.text:004099FF					       ; DATA XREF: __output_p_l:off_40A6E2o
.text:004099FF		       cmp     [ebp+290h+pass],	edi
.text:00409A02		       jnz     short loc_409A0D
.text:00409A04		       cmp     [ebp+290h+format_type], ebx
.text:00409A07		       jz      loc_40A639
.text:00409A0D
.text:00409A0D loc_409A0D:			       ; CODE XREF: __output_p_l+288j
.text:00409A0D		       cmp     [ebp+290h+pass],	ebx
.text:00409A10		       jnz     NORMAL_STATE_1
.text:00409A16		       cmp     [ebp+290h+format_type], 0FFFFFFFFh
.text:00409A1A		       jnz     NORMAL_STATE_1
.text:00409A20		       jmp     loc_40A639
.text:00409A25 ; ---------------------------------------------------------------------------
.text:00409A25
.text:00409A25 $LN259:				       ; CODE XREF: __output_p_l+26Aj
.text:00409A25					       ; DATA XREF: __output_p_l+F6Co
.text:00409A25		       or      [ebp+290h+precision], 0FFFFFFFFh
.text:00409A29		       mov     [ebp+290h+capexp], edi
.text:00409A2C		       mov     [ebp+290h+no_output], edi
.text:00409A2F		       mov     [ebp+290h+fldwidth], edi
.text:00409A32		       mov     [ebp+290h+prefixlen], edi
.text:00409A35		       mov     [ebp+290h+flags], edi
.text:00409A3B		       mov     [ebp+290h+bufferiswide],	edi
.text:00409A3E		       jmp     loc_40A639
.text:00409A43 ; ---------------------------------------------------------------------------
.text:00409A43
.text:00409A43 $LN258:				       ; CODE XREF: __output_p_l+26Aj
.text:00409A43					       ; DATA XREF: __output_p_l+F70o
.text:00409A43		       movsx   eax, dl
.text:00409A46		       sub     eax, 20h
.text:00409A49		       jz      short loc_409A94
.text:00409A4B		       sub     eax, 3
.text:00409A4E		       jz      short loc_409A85
.text:00409A50		       sub     eax, 8
.text:00409A53		       jz      short loc_409A7A
.text:00409A55		       dec     eax
.text:00409A56		       dec     eax
.text:00409A57		       jz      short loc_409A6E
.text:00409A59		       sub     eax, 3
.text:00409A5C		       jnz     loc_40A639
.text:00409A62		       or      [ebp+290h+flags], 8
.text:00409A69		       jmp     loc_40A639
.text:00409A6E ; ---------------------------------------------------------------------------
.text:00409A6E
.text:00409A6E loc_409A6E:			       ; CODE XREF: __output_p_l+2DDj
.text:00409A6E		       or      [ebp+290h+flags], 4
.text:00409A75		       jmp     loc_40A639
.text:00409A7A ; ---------------------------------------------------------------------------
.text:00409A7A
.text:00409A7A loc_409A7A:			       ; CODE XREF: __output_p_l+2D9j
.text:00409A7A		       or      [ebp+290h+flags], ebx
.text:00409A80		       jmp     loc_40A639
.text:00409A85 ; ---------------------------------------------------------------------------
.text:00409A85
.text:00409A85 loc_409A85:			       ; CODE XREF: __output_p_l+2D4j
.text:00409A85		       or      [ebp+290h+flags], 80h
.text:00409A8F		       jmp     loc_40A639
.text:00409A94 ; ---------------------------------------------------------------------------
.text:00409A94
.text:00409A94 loc_409A94:			       ; CODE XREF: __output_p_l+2CFj
.text:00409A94		       or      [ebp+290h+flags], 2
.text:00409A9B		       jmp     loc_40A639
.text:00409AA0 ; ---------------------------------------------------------------------------
.text:00409AA0
.text:00409AA0 $LN250:				       ; CODE XREF: __output_p_l+26Aj
.text:00409AA0					       ; DATA XREF: __output_p_l+F74o
.text:00409AA0		       cmp     dl, 2Ah
.text:00409AA3		       jnz     loc_409B41
.text:00409AA9		       cmp     [ebp+290h+format_type], edi
.text:00409AAC		       jnz     short loc_409ABA
.text:00409AAE		       add     [ebp+290h+var_214], 4
.text:00409AB2		       mov     eax, [ebp+290h+var_214]
.text:00409AB5		       mov     eax, [eax-4]
.text:00409AB8		       jmp     short loc_409B27
.text:00409ABA ; ---------------------------------------------------------------------------
.text:00409ABA
.text:00409ABA loc_409ABA:			       ; CODE XREF: __output_p_l+332j
.text:00409ABA		       push    0Ah	       ; ibase
.text:00409ABC		       lea     eax, [ebp+290h+end_pos]
.text:00409ABF		       push    eax	       ; endptr
.text:00409AC0		       push    esi	       ; nptr
.text:00409AC1		       call    _strtol
.text:00409AC6		       mov     ecx, [ebp+290h+end_pos]
.text:00409AC9		       add     esp, 0Ch
.text:00409ACC		       dec     eax
.text:00409ACD		       cmp     [ebp+290h+pass],	edi
.text:00409AD0		       lea     edx, [ecx+1]
.text:00409AD3		       mov     [ebp+290h+var_240], edx
.text:00409AD6		       jnz     short loc_409B1B
.text:00409AD8
.text:00409AD8 loc_409AD8:			       ; CODE XREF: __output_p_l+416j
.text:00409AD8		       cmp     eax, edi
.text:00409ADA		       jl      loc_40A055
.text:00409AE0		       cmp     byte ptr	[ecx], 24h
.text:00409AE3		       jnz     loc_40A055
.text:00409AE9		       cmp     [ebp+290h+type_pos], 64h
.text:00409AED		       jge     loc_40A055
.text:00409AF3		       cmp     eax, [ebp+290h+max_pos]
.text:00409AF6		       jle     short loc_409AFB
.text:00409AF8		       mov     [ebp+290h+max_pos], eax
.text:00409AFB
.text:00409AFB loc_409AFB:			       ; CODE XREF: __output_p_l+37Cj
.text:00409AFB		       shl     eax, 4
.text:00409AFE		       lea     ecx, [ebp+eax+290h+pos_value]
.text:00409B05		       cmp     [ecx], edi
.text:00409B07		       jz      loc_409BB6
.text:00409B0D		       push    [ebp+290h+flags]
.text:00409B13		       push    2Ah
.text:00409B15		       push    ebx
.text:00409B16		       jmp     loc_40A044
.text:00409B1B ; ---------------------------------------------------------------------------
.text:00409B1B
.text:00409B1B loc_409B1B:			       ; CODE XREF: __output_p_l+35Cj
.text:00409B1B		       shl     eax, 4
.text:00409B1E		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:00409B25		       mov     eax, [eax]
.text:00409B27
.text:00409B27 loc_409B27:			       ; CODE XREF: __output_p_l+33Ej
.text:00409B27		       cmp     eax, edi
.text:00409B29		       mov     [ebp+290h+fldwidth], eax
.text:00409B2C		       jge     loc_40A639
.text:00409B32		       or      [ebp+290h+flags], 4
.text:00409B39		       neg     [ebp+290h+fldwidth]
.text:00409B3C		       jmp     loc_40A639
.text:00409B41 ; ---------------------------------------------------------------------------
.text:00409B41
.text:00409B41 loc_409B41:			       ; CODE XREF: __output_p_l+329j
.text:00409B41		       mov     eax, [ebp+290h+fldwidth]
.text:00409B44		       imul    eax, 0Ah
.text:00409B47		       movsx   ecx, dl
.text:00409B4A		       lea     eax, [eax+ecx-30h]
.text:00409B4E		       mov     [ebp+290h+fldwidth], eax
.text:00409B51		       jmp     loc_40A639
.text:00409B56 ; ---------------------------------------------------------------------------
.text:00409B56
.text:00409B56 $LN238:				       ; CODE XREF: __output_p_l+26Aj
.text:00409B56					       ; DATA XREF: __output_p_l+F78o
.text:00409B56		       mov     [ebp+290h+precision], edi
.text:00409B59		       jmp     loc_40A639
.text:00409B5E ; ---------------------------------------------------------------------------
.text:00409B5E
.text:00409B5E $LN237:				       ; CODE XREF: __output_p_l+26Aj
.text:00409B5E					       ; DATA XREF: __output_p_l+F7Co
.text:00409B5E		       cmp     dl, 2Ah
.text:00409B61		       jnz     short loc_409BD2
.text:00409B63		       cmp     [ebp+290h+format_type], edi
.text:00409B66		       jnz     short loc_409B74
.text:00409B68		       add     [ebp+290h+var_214], 4
.text:00409B6C		       mov     eax, [ebp+290h+var_214]
.text:00409B6F		       mov     eax, [eax-4]
.text:00409B72		       jmp     short loc_409BA2
.text:00409B74 ; ---------------------------------------------------------------------------
.text:00409B74
.text:00409B74 loc_409B74:			       ; CODE XREF: __output_p_l+3ECj
.text:00409B74		       push    0Ah	       ; ibase
.text:00409B76		       lea     eax, [ebp+290h+end_pos]
.text:00409B79		       push    eax	       ; endptr
.text:00409B7A		       push    esi	       ; nptr
.text:00409B7B		       call    _strtol
.text:00409B80		       mov     ecx, [ebp+290h+end_pos]
.text:00409B83		       add     esp, 0Ch
.text:00409B86		       dec     eax
.text:00409B87		       cmp     [ebp+290h+pass],	edi
.text:00409B8A		       lea     edx, [ecx+1]
.text:00409B8D		       mov     [ebp+290h+var_240], edx
.text:00409B90		       jz      loc_409AD8
.text:00409B96		       shl     eax, 4
.text:00409B99		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:00409BA0		       mov     eax, [eax]
.text:00409BA2
.text:00409BA2 loc_409BA2:			       ; CODE XREF: __output_p_l+3F8j
.text:00409BA2		       cmp     eax, edi
.text:00409BA4		       mov     [ebp+290h+precision], eax
.text:00409BA7		       jge     loc_40A639
.text:00409BAD		       or      [ebp+290h+precision], 0FFFFFFFFh
.text:00409BB1		       jmp     loc_40A639
.text:00409BB6 ; ---------------------------------------------------------------------------
.text:00409BB6
.text:00409BB6 loc_409BB6:			       ; CODE XREF: __output_p_l+38Dj
.text:00409BB6		       mov     [ecx], ebx
.text:00409BB8		       mov     [ebp+eax+290h+pos_value.type], 2Ah
.text:00409BC0
.text:00409BC0 loc_409BC0:			       ; CODE XREF: __output_p_l+5F7j
.text:00409BC0		       mov     ecx, [ebp+290h+flags]
.text:00409BC6		       mov     [ebp+eax+290h+pos_value.flags], ecx
.text:00409BCD		       jmp     loc_40A639
.text:00409BD2 ; ---------------------------------------------------------------------------
.text:00409BD2
.text:00409BD2 loc_409BD2:			       ; CODE XREF: __output_p_l+3E7j
.text:00409BD2		       mov     eax, [ebp+290h+precision]
.text:00409BD5		       imul    eax, 0Ah
.text:00409BD8		       movsx   ecx, dl
.text:00409BDB		       lea     eax, [eax+ecx-30h]
.text:00409BDF		       mov     [ebp+290h+precision], eax
.text:00409BE2		       jmp     loc_40A639
.text:00409BE7 ; ---------------------------------------------------------------------------
.text:00409BE7
.text:00409BE7 $LN225:				       ; CODE XREF: __output_p_l+26Aj
.text:00409BE7					       ; DATA XREF: __output_p_l+F80o
.text:00409BE7		       cmp     dl, 49h
.text:00409BEA		       jz      short loc_409C3E
.text:00409BEC		       cmp     dl, 68h
.text:00409BEF		       jz      short loc_409C32
.text:00409BF1		       cmp     dl, 6Ch
.text:00409BF4		       jz      short loc_409C0E
.text:00409BF6		       cmp     dl, 77h
.text:00409BF9		       jnz     loc_40A639
.text:00409BFF		       or      [ebp+290h+flags], 800h
.text:00409C09		       jmp     loc_40A639
.text:00409C0E ; ---------------------------------------------------------------------------
.text:00409C0E
.text:00409C0E loc_409C0E:			       ; CODE XREF: __output_p_l+47Aj
.text:00409C0E		       cmp     byte ptr	[esi], 6Ch
.text:00409C11		       jnz     short loc_409C26
.text:00409C13		       inc     esi
.text:00409C14		       or      [ebp+290h+flags], 1000h
.text:00409C1E		       mov     [ebp+290h+var_240], esi
.text:00409C21		       jmp     loc_40A639
.text:00409C26 ; ---------------------------------------------------------------------------
.text:00409C26
.text:00409C26 loc_409C26:			       ; CODE XREF: __output_p_l+497j
.text:00409C26		       or      [ebp+290h+flags], 10h
.text:00409C2D		       jmp     loc_40A639
.text:00409C32 ; ---------------------------------------------------------------------------
.text:00409C32
.text:00409C32 loc_409C32:			       ; CODE XREF: __output_p_l+475j
.text:00409C32		       or      [ebp+290h+flags], 20h
.text:00409C39		       jmp     loc_40A639
.text:00409C3E ; ---------------------------------------------------------------------------
.text:00409C3E
.text:00409C3E loc_409C3E:			       ; CODE XREF: __output_p_l+470j
.text:00409C3E		       mov     al, [esi]
.text:00409C40		       cmp     al, 36h
.text:00409C42		       jnz     short loc_409C5E
.text:00409C44		       cmp     byte ptr	[esi+1], 34h
.text:00409C48		       jnz     short loc_409C5E
.text:00409C4A		       inc     esi
.text:00409C4B		       inc     esi
.text:00409C4C		       or      [ebp+290h+flags], 8000h
.text:00409C56		       mov     [ebp+290h+var_240], esi
.text:00409C59		       jmp     loc_40A639
.text:00409C5E ; ---------------------------------------------------------------------------
.text:00409C5E
.text:00409C5E loc_409C5E:			       ; CODE XREF: __output_p_l+4C8j
.text:00409C5E					       ; __output_p_l+4CEj
.text:00409C5E		       cmp     al, 33h
.text:00409C60		       jnz     short loc_409C7C
.text:00409C62		       cmp     byte ptr	[esi+1], 32h
.text:00409C66		       jnz     short loc_409C7C
.text:00409C68		       inc     esi
.text:00409C69		       inc     esi
.text:00409C6A		       and     [ebp+290h+flags], 0FFFF7FFFh
.text:00409C74		       mov     [ebp+290h+var_240], esi
.text:00409C77		       jmp     loc_40A639
.text:00409C7C ; ---------------------------------------------------------------------------
.text:00409C7C
.text:00409C7C loc_409C7C:			       ; CODE XREF: __output_p_l+4E6j
.text:00409C7C					       ; __output_p_l+4ECj
.text:00409C7C		       cmp     al, 64h
.text:00409C7E		       jz      short loc_409CDB
.text:00409C80		       cmp     al, 69h
.text:00409C82		       jz      short loc_409CDB
.text:00409C84		       cmp     al, 6Fh
.text:00409C86		       jz      short loc_409CDB
.text:00409C88		       cmp     al, 75h
.text:00409C8A		       jz      short loc_409CDB
.text:00409C8C		       cmp     al, 78h
.text:00409C8E		       jz      short loc_409CDB
.text:00409C90		       cmp     al, 58h
.text:00409C92		       jz      short loc_409CDB
.text:00409C94		       mov     [ebp+290h+state], edi
.text:00409C97
.text:00409C97 NORMAL_STATE_1:			       ; CODE XREF: __output_p_l+296j
.text:00409C97					       ; __output_p_l+2A0j
.text:00409C97		       lea     eax, [ebp+290h+_loc_update] ; ch
.text:00409C9A		       push    eax	       ; plocinfo
.text:00409C9B		       movzx   eax, dl
.text:00409C9E		       push    eax	       ; c
.text:00409C9F		       mov     [ebp+290h+bufferiswide],	edi
.text:00409CA2		       call    __isleadbyte_l
.text:00409CA7		       pop     ecx
.text:00409CA8		       test    eax, eax
.text:00409CAA		       mov     al, [ebp+290h+cur_type]
.text:00409CAD		       pop     ecx
.text:00409CAE		       jz      short loc_409CCB
.text:00409CB0		       mov     ecx, [ebp+290h+f] ; f
.text:00409CB3		       lea     esi, [ebp+290h+charsout]	; pnumwritten
.text:00409CB6		       call    write_char_1
.text:00409CBB		       mov     eax, [ebp+290h+var_240]
.text:00409CBE		       mov     al, [eax]       ; ch
.text:00409CC0		       inc     [ebp+290h+var_240]
.text:00409CC3		       test    al, al
.text:00409CC5		       jz      loc_40A055
.text:00409CCB
.text:00409CCB loc_409CCB:			       ; CODE XREF: __output_p_l+534j
.text:00409CCB		       mov     ecx, [ebp+290h+f] ; f
.text:00409CCE		       lea     esi, [ebp+290h+charsout]	; pnumwritten
.text:00409CD1		       call    write_char_1
.text:00409CD6		       jmp     loc_40A639
.text:00409CDB ; ---------------------------------------------------------------------------
.text:00409CDB
.text:00409CDB loc_409CDB:			       ; CODE XREF: __output_p_l+504j
.text:00409CDB					       ; __output_p_l+508j ...
.text:00409CDB		       or      [ebp+290h+flags], 10000h
.text:00409CE5		       jmp     loc_40A639
.text:00409CEA ; ---------------------------------------------------------------------------
.text:00409CEA
.text:00409CEA $LN209:				       ; CODE XREF: __output_p_l+26Aj
.text:00409CEA					       ; DATA XREF: __output_p_l+F84o
.text:00409CEA		       movsx   eax, dl
.text:00409CED		       cmp     eax, 64h
.text:00409CF0		       jg      loc_409F2F
.text:00409CF6		       jz      loc_40A000
.text:00409CFC		       cmp     eax, 53h
.text:00409CFF		       jg      loc_409DC7
.text:00409D05		       jz      loc_409D8D
.text:00409D0B		       sub     eax, 41h
.text:00409D0E		       jz      short loc_409D23
.text:00409D10		       push    2
.text:00409D12		       pop     esi
.text:00409D13		       sub     eax, esi
.text:00409D15		       jz      short loc_409D76
.text:00409D17		       sub     eax, esi
.text:00409D19		       jz      short loc_409D23
.text:00409D1B		       sub     eax, esi
.text:00409D1D		       jnz     loc_40A507
.text:00409D23
.text:00409D23 loc_409D23:			       ; CODE XREF: __output_p_l+594j
.text:00409D23					       ; __output_p_l+59Fj
.text:00409D23		       add     dl, 20h
.text:00409D26		       mov     [ebp+290h+capexp], ebx
.text:00409D29		       mov     [ebp+290h+cur_type], dl
.text:00409D2C
.text:00409D2C loc_409D2C:			       ; CODE XREF: __output_p_l+661j
.text:00409D2C					       ; __output_p_l+7D0j
.text:00409D2C		       or      [ebp+290h+flags], 40h
.text:00409D33		       cmp     [ebp+290h+format_type], ebx
.text:00409D36		       jnz     loc_40A076
.text:00409D3C		       cmp     [ebp+290h+pass],	edi
.text:00409D3F		       jnz     loc_40A076
.text:00409D45		       cmp     [ebp+290h+type_pos], 63h
.text:00409D49		       ja      loc_40A055
.text:00409D4F		       mov     eax, [ebp+290h+type_pos]
.text:00409D52		       shl     eax, 4
.text:00409D55		       lea     ecx, [ebp+eax+290h+pos_value]
.text:00409D5C		       cmp     [ecx], edi
.text:00409D5E		       jnz     loc_40A039
.text:00409D64		       mov     dword ptr [ecx],	8
.text:00409D6A		       mov     [ebp+eax+290h+pos_value.type], dl
.text:00409D71		       jmp     loc_409BC0
.text:00409D76 ; ---------------------------------------------------------------------------
.text:00409D76
.text:00409D76 loc_409D76:			       ; CODE XREF: __output_p_l+59Bj
.text:00409D76		       test    word ptr	[ebp+290h+flags], 830h
.text:00409D7F		       jnz     short loc_409DEC
.text:00409D81		       or      [ebp+290h+flags], 800h
.text:00409D8B		       jmp     short loc_409DEC
.text:00409D8D ; ---------------------------------------------------------------------------
.text:00409D8D
.text:00409D8D loc_409D8D:			       ; CODE XREF: __output_p_l+58Bj
.text:00409D8D		       test    word ptr	[ebp+290h+flags], 830h
.text:00409D96		       jnz     short loc_409DA2
.text:00409D98		       or      [ebp+290h+flags], 800h
.text:00409DA2
.text:00409DA2 loc_409DA2:			       ; CODE XREF: __output_p_l+61Cj
.text:00409DA2					       ; __output_p_l+A33j
.text:00409DA2		       mov     ecx, [ebp+290h+precision]
.text:00409DA5		       cmp     ecx, 0FFFFFFFFh
.text:00409DA8		       jnz     short loc_409DAF
.text:00409DAA		       mov     ecx, 7FFFFFFFh
.text:00409DAF
.text:00409DAF loc_409DAF:			       ; CODE XREF: __output_p_l+62Ej
.text:00409DAF		       cmp     [ebp+290h+format_type], edi
.text:00409DB2		       jnz     loc_40A472
.text:00409DB8		       add     [ebp+290h+var_214], 4
.text:00409DBC		       mov     eax, [ebp+290h+var_214]
.text:00409DBF		       mov     eax, [eax-4]
.text:00409DC2		       jmp     loc_40A493
.text:00409DC7 ; ---------------------------------------------------------------------------
.text:00409DC7
.text:00409DC7 loc_409DC7:			       ; CODE XREF: __output_p_l+585j
.text:00409DC7		       sub     eax, 58h
.text:00409DCA		       jz      loc_40A1A1
.text:00409DD0		       dec     eax
.text:00409DD1		       dec     eax
.text:00409DD2		       jz      loc_409EB7
.text:00409DD8		       sub     eax, 7
.text:00409DDB		       jz      loc_409D2C
.text:00409DE1		       dec     eax
.text:00409DE2		       dec     eax
.text:00409DE3		       jnz     loc_40A507
.text:00409DE9		       push    2
.text:00409DEB		       pop     esi
.text:00409DEC
.text:00409DEC loc_409DEC:			       ; CODE XREF: __output_p_l+605j
.text:00409DEC					       ; __output_p_l+611j
.text:00409DEC		       test    word ptr	[ebp+290h+flags], 810h
.text:00409DF5		       jz      short loc_409E6B
.text:00409DF7		       cmp     [ebp+290h+format_type], edi
.text:00409DFA		       jnz     short loc_409E09
.text:00409DFC		       add     [ebp+290h+var_214], 4
.text:00409E00		       mov     eax, [ebp+290h+var_214]
.text:00409E03		       movzx   eax, word ptr [eax-4]
.text:00409E07		       jmp     short loc_409E49
.text:00409E09 ; ---------------------------------------------------------------------------
.text:00409E09
.text:00409E09 loc_409E09:			       ; CODE XREF: __output_p_l+680j
.text:00409E09		       cmp     [ebp+290h+type_pos], 63h
.text:00409E0D		       ja      loc_40A055
.text:00409E13		       mov     eax, [ebp+290h+type_pos]
.text:00409E16		       shl     eax, 4
.text:00409E19		       cmp     [ebp+290h+pass],	edi
.text:00409E1C		       jnz     short loc_409E3F
.text:00409E1E		       lea     ecx, [ebp+eax+290h+pos_value]
.text:00409E25		       cmp     [ecx], edi
.text:00409E27		       jnz     short loc_409E30
.text:00409E29		       mov     [ecx], esi
.text:00409E2B		       jmp     loc_40A4BB
.text:00409E30 ; ---------------------------------------------------------------------------
.text:00409E30
.text:00409E30 loc_409E30:			       ; CODE XREF: __output_p_l+6ADj
.text:00409E30		       push    [ebp+290h+flags]
.text:00409E36		       push    dword ptr [ebp+290h+cur_type]
.text:00409E39		       push    esi
.text:00409E3A		       jmp     loc_40A37A
.text:00409E3F ; ---------------------------------------------------------------------------
.text:00409E3F
.text:00409E3F loc_409E3F:			       ; CODE XREF: __output_p_l+6A2j
.text:00409E3F		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:00409E46		       movzx   eax, word ptr [eax]
.text:00409E49
.text:00409E49 loc_409E49:			       ; CODE XREF: __output_p_l+68Dj
.text:00409E49		       push    eax	       ; wchar
.text:00409E4A		       push    200h	       ; sizeInBytes
.text:00409E4F		       lea     eax, [ebp+290h+buffer]
.text:00409E55		       push    eax	       ; dst
.text:00409E56		       lea     eax, [ebp+290h+textlen]
.text:00409E59		       push    eax	       ; pRetValue
.text:00409E5A		       call    _wctomb_s
.text:00409E5F		       add     esp, 10h
.text:00409E62		       test    eax, eax
.text:00409E64		       jz      short loc_409EA9
.text:00409E66		       mov     [ebp+290h+no_output], ebx
.text:00409E69		       jmp     short loc_409EA9
.text:00409E6B ; ---------------------------------------------------------------------------
.text:00409E6B
.text:00409E6B loc_409E6B:			       ; CODE XREF: __output_p_l+67Bj
.text:00409E6B		       cmp     [ebp+290h+format_type], edi
.text:00409E6E		       jnz     short loc_409E7D
.text:00409E70		       add     [ebp+290h+var_214], 4
.text:00409E74		       mov     eax, [ebp+290h+var_214]
.text:00409E77		       movzx   eax, word ptr [eax-4]
.text:00409E7B		       jmp     short loc_409EA0
.text:00409E7D ; ---------------------------------------------------------------------------
.text:00409E7D
.text:00409E7D loc_409E7D:			       ; CODE XREF: __output_p_l+6F4j
.text:00409E7D		       cmp     [ebp+290h+type_pos], 63h
.text:00409E81		       ja      loc_40A055
.text:00409E87		       mov     eax, [ebp+290h+type_pos]
.text:00409E8A		       shl     eax, 4
.text:00409E8D		       cmp     [ebp+290h+pass],	edi
.text:00409E90		       jz      loc_40A35E
.text:00409E96		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:00409E9D		       movzx   eax, word ptr [eax]
.text:00409EA0
.text:00409EA0 loc_409EA0:			       ; CODE XREF: __output_p_l+701j
.text:00409EA0		       mov     byte ptr	[ebp+290h+buffer], al
.text:00409EA6		       mov     [ebp+290h+textlen], ebx
.text:00409EA9
.text:00409EA9 loc_409EA9:			       ; CODE XREF: __output_p_l+6EAj
.text:00409EA9					       ; __output_p_l+6EFj
.text:00409EA9		       lea     eax, [ebp+290h+buffer]
.text:00409EAF		       mov     dword ptr [ebp+290h+text], eax
.text:00409EB2		       jmp     loc_40A507
.text:00409EB7 ; ---------------------------------------------------------------------------
.text:00409EB7
.text:00409EB7 loc_409EB7:			       ; CODE XREF: __output_p_l+658j
.text:00409EB7		       cmp     [ebp+290h+format_type], edi
.text:00409EBA		       jnz     short loc_409EC8
.text:00409EBC		       add     [ebp+290h+var_214], 4
.text:00409EC0		       mov     eax, [ebp+290h+var_214]
.text:00409EC3		       mov     eax, [eax-4]
.text:00409EC6		       jmp     short loc_409EEA
.text:00409EC8 ; ---------------------------------------------------------------------------
.text:00409EC8
.text:00409EC8 loc_409EC8:			       ; CODE XREF: __output_p_l+740j
.text:00409EC8		       cmp     [ebp+290h+type_pos], 63h
.text:00409ECC		       ja      loc_40A055
.text:00409ED2		       mov     eax, [ebp+290h+type_pos]
.text:00409ED5		       shl     eax, 4
.text:00409ED8		       cmp     [ebp+290h+pass],	edi
.text:00409EDB		       jz      loc_409FB0
.text:00409EE1		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:00409EE8		       mov     eax, [eax]
.text:00409EEA
.text:00409EEA loc_409EEA:			       ; CODE XREF: __output_p_l+74Cj
.text:00409EEA		       cmp     eax, edi
.text:00409EEC		       jz      short loc_409F1B
.text:00409EEE		       mov     ecx, [eax+4]
.text:00409EF1		       cmp     ecx, edi
.text:00409EF3		       jz      short loc_409F1B
.text:00409EF5		       test    word ptr	[ebp+290h+flags], 800h
.text:00409EFE		       movsx   eax, word ptr [eax]
.text:00409F01		       mov     dword ptr [ebp+290h+text], ecx
.text:00409F04		       jz      short loc_409F13
.text:00409F06		       cdq
.text:00409F07		       sub     eax, edx
.text:00409F09		       sar     eax, 1
.text:00409F0B		       mov     [ebp+290h+bufferiswide],	ebx
.text:00409F0E		       jmp     loc_40A504
.text:00409F13 ; ---------------------------------------------------------------------------
.text:00409F13
.text:00409F13 loc_409F13:			       ; CODE XREF: __output_p_l+78Aj
.text:00409F13		       mov     [ebp+290h+bufferiswide],	edi
.text:00409F16		       jmp     loc_40A504
.text:00409F1B ; ---------------------------------------------------------------------------
.text:00409F1B
.text:00409F1B loc_409F1B:			       ; CODE XREF: __output_p_l+772j
.text:00409F1B					       ; __output_p_l+779j
.text:00409F1B		       mov     eax, ___nullstring
.text:00409F20		       mov     dword ptr [ebp+290h+text], eax
.text:00409F23		       push    eax	       ; buf
.text:00409F24
.text:00409F24 loc_409F24:			       ; CODE XREF: __output_p_l+A1Bj
.text:00409F24		       call    _strlen
.text:00409F29		       pop     ecx
.text:00409F2A		       jmp     loc_40A504
.text:00409F2F ; ---------------------------------------------------------------------------
.text:00409F2F
.text:00409F2F loc_409F2F:			       ; CODE XREF: __output_p_l+576j
.text:00409F2F		       cmp     eax, 70h
.text:00409F32		       jg      loc_40A1AA
.text:00409F38		       jz      loc_40A19A
.text:00409F3E		       cmp     eax, 65h
.text:00409F41		       jl      loc_40A507
.text:00409F47		       cmp     eax, 67h
.text:00409F4A		       jle     loc_409D2C
.text:00409F50		       cmp     eax, 69h
.text:00409F53		       jz      loc_40A000
.text:00409F59		       cmp     eax, 6Eh
.text:00409F5C		       jz      short loc_409F8A
.text:00409F5E		       cmp     eax, 6Fh
.text:00409F61		       jnz     loc_40A507
.text:00409F67		       test    byte ptr	[ebp+290h+flags], 80h
.text:00409F6E		       mov     [ebp+290h+count], 8
.text:00409F75		       jz      COMMON_INT_1
.text:00409F7B		       or      [ebp+290h+flags], 200h
.text:00409F85		       jmp     COMMON_INT_1
.text:00409F8A ; ---------------------------------------------------------------------------
.text:00409F8A
.text:00409F8A loc_409F8A:			       ; CODE XREF: __output_p_l+7E2j
.text:00409F8A		       cmp     [ebp+290h+format_type], edi
.text:00409F8D		       jnz     short loc_409F9B
.text:00409F8F		       add     [ebp+290h+var_214], 4
.text:00409F93		       mov     eax, [ebp+290h+var_214]
.text:00409F96		       mov     esi, [eax-4]
.text:00409F99		       jmp     short loc_409FD8
.text:00409F9B ; ---------------------------------------------------------------------------
.text:00409F9B
.text:00409F9B loc_409F9B:			       ; CODE XREF: __output_p_l+813j
.text:00409F9B		       cmp     [ebp+290h+type_pos], 63h
.text:00409F9F		       ja      loc_40A055
.text:00409FA5		       mov     eax, [ebp+290h+type_pos]
.text:00409FA8		       shl     eax, 4
.text:00409FAB		       cmp     [ebp+290h+pass],	edi
.text:00409FAE		       jnz     short loc_409FCF
.text:00409FB0
.text:00409FB0 loc_409FB0:			       ; CODE XREF: __output_p_l+761j
.text:00409FB0					       ; __output_p_l+D0Aj
.text:00409FB0		       lea     ecx, [ebp+eax+290h+pos_value]
.text:00409FB7		       cmp     [ecx], edi
.text:00409FB9		       jz      loc_40A4B5
.text:00409FBF		       push    [ebp+290h+flags]
.text:00409FC5		       push    dword ptr [ebp+290h+cur_type]
.text:00409FC8		       push    3
.text:00409FCA		       jmp     loc_40A37A
.text:00409FCF ; ---------------------------------------------------------------------------
.text:00409FCF
.text:00409FCF loc_409FCF:			       ; CODE XREF: __output_p_l+834j
.text:00409FCF		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:00409FD6		       mov     esi, [eax]
.text:00409FD8
.text:00409FD8 loc_409FD8:			       ; CODE XREF: __output_p_l+81Fj
.text:00409FD8		       call    __get_printf_count_output
.text:00409FDD		       test    eax, eax
.text:00409FDF		       jz      short loc_40A055
.text:00409FE1		       test    byte ptr	[ebp+290h+flags], 20h
.text:00409FE8		       jz      short loc_409FF3
.text:00409FEA		       mov     ax, word	ptr [ebp+290h+charsout]
.text:00409FEE		       mov     [esi], ax
.text:00409FF1		       jmp     short loc_409FF8
.text:00409FF3 ; ---------------------------------------------------------------------------
.text:00409FF3
.text:00409FF3 loc_409FF3:			       ; CODE XREF: __output_p_l+86Ej
.text:00409FF3		       mov     eax, [ebp+290h+charsout]
.text:00409FF6		       mov     [esi], eax
.text:00409FF8
.text:00409FF8 loc_409FF8:			       ; CODE XREF: __output_p_l+877j
.text:00409FF8		       mov     [ebp+290h+no_output], ebx
.text:00409FFB		       jmp     loc_40A507
.text:0040A000 ; ---------------------------------------------------------------------------
.text:0040A000
.text:0040A000 loc_40A000:			       ; CODE XREF: __output_p_l+57Cj
.text:0040A000					       ; __output_p_l+7D9j
.text:0040A000		       or      [ebp+290h+flags], 40h
.text:0040A007
.text:0040A007 loc_40A007:			       ; CODE XREF: __output_p_l+A3Bj
.text:0040A007		       mov     [ebp+290h+count], 0Ah
.text:0040A00E
.text:0040A00E COMMON_INT_1:			       ; CODE XREF: __output_p_l+7FBj
.text:0040A00E					       ; __output_p_l+80Bj ...
.text:0040A00E		       mov     eax, [ebp+290h+flags]
.text:0040A014		       test    ax, ax
.text:0040A017		       jns     loc_40A232
.text:0040A01D		       cmp     [ebp+290h+format_type], edi
.text:0040A020		       jnz     loc_40A1F7
.text:0040A026
.text:0040A026 loc_40A026:			       ; CODE XREF: __output_p_l+AC1j
.text:0040A026		       mov     ecx, [ebp+290h+var_214]
.text:0040A029		       mov     eax, [ecx]
.text:0040A02B		       mov     edx, [ecx+4]
.text:0040A02E		       add     ecx, 8
.text:0040A031		       mov     [ebp+290h+var_214], ecx
.text:0040A034		       jmp     loc_40A39B
.text:0040A039 ; ---------------------------------------------------------------------------
.text:0040A039
.text:0040A039 loc_40A039:			       ; CODE XREF: __output_p_l+5E4j
.text:0040A039		       push    [ebp+290h+flags]	; cur_flags
.text:0040A03F		       push    dword ptr [ebp+290h+cur_type] ; cur_type
.text:0040A042		       push    8	       ; get_fn_type
.text:0040A044
.text:0040A044 loc_40A044:			       ; CODE XREF: __output_p_l+39Cj
.text:0040A044		       push    ecx	       ; pos
.text:0040A045		       call    __validate_param_reuseA
.text:0040A04A		       add     esp, 10h
.text:0040A04D		       test    eax, eax
.text:0040A04F		       jnz     loc_40A639
.text:0040A055
.text:0040A055 loc_40A055:			       ; CODE XREF: __output_p_l+242j
.text:0040A055					       ; __output_p_l+24Bj ...
.text:0040A055		       call    __errno
.text:0040A05A		       push    edi	       ; pReserved
.text:0040A05B		       push    edi	       ; nLine
.text:0040A05C		       push    edi	       ; pszFile
.text:0040A05D		       push    edi	       ; pszFunction
.text:0040A05E		       push    edi	       ; pszExpression
.text:0040A05F		       mov     dword ptr [eax],	16h
.text:0040A065		       call    __invalid_parameter
.text:0040A06A		       add     esp, 14h
.text:0040A06D		       cmp     [ebp+290h+_loc_update.updated], 0
.text:0040A071		       jmp     loc_4097FB
.text:0040A076 ; ---------------------------------------------------------------------------
.text:0040A076
.text:0040A076 loc_40A076:			       ; CODE XREF: __output_p_l+5BCj
.text:0040A076					       ; __output_p_l+5C5j
.text:0040A076		       cmp     [ebp+290h+precision], edi
.text:0040A079		       lea     eax, [ebp+290h+buffer]
.text:0040A07F		       mov     dword ptr [ebp+290h+text], eax
.text:0040A082		       mov     eax, 200h
.text:0040A087		       mov     [ebp+290h+count], eax
.text:0040A08A		       jge     short loc_40A095
.text:0040A08C		       mov     [ebp+290h+precision], 6
.text:0040A093		       jmp     short loc_40A09F
.text:0040A095 ; ---------------------------------------------------------------------------
.text:0040A095
.text:0040A095 loc_40A095:			       ; CODE XREF: __output_p_l+910j
.text:0040A095		       jnz     short loc_40A0AF
.text:0040A097		       cmp     dl, 67h
.text:0040A09A		       jnz     short loc_40A09F
.text:0040A09C
.text:0040A09C loc_40A09C:			       ; CODE XREF: __output_p_l+95Fj
.text:0040A09C		       mov     [ebp+290h+precision], ebx
.text:0040A09F
.text:0040A09F loc_40A09F:			       ; CODE XREF: __output_p_l+919j
.text:0040A09F					       ; __output_p_l+920j ...
.text:0040A09F		       cmp     [ebp+290h+format_type], edi
.text:0040A0A2		       jnz     short loc_40A0E3
.text:0040A0A4		       mov     eax, [ebp+290h+var_214]
.text:0040A0A7		       add     eax, 8
.text:0040A0AA		       mov     [ebp+290h+var_214], eax
.text:0040A0AD		       jmp     short loc_40A0FD
.text:0040A0AF ; ---------------------------------------------------------------------------
.text:0040A0AF
.text:0040A0AF loc_40A0AF:			       ; CODE XREF: __output_p_l:loc_40A095j
.text:0040A0AF		       cmp     [ebp+290h+precision], eax
.text:0040A0B2		       jle     short loc_40A0B7
.text:0040A0B4		       mov     [ebp+290h+precision], eax
.text:0040A0B7
.text:0040A0B7 loc_40A0B7:			       ; CODE XREF: __output_p_l+938j
.text:0040A0B7		       mov     ebx, 0A3h
.text:0040A0BC		       cmp     [ebp+290h+precision], ebx
.text:0040A0BF		       jle     short loc_40A09F
.text:0040A0C1		       mov     esi, [ebp+290h+precision]
.text:0040A0C4		       add     esi, 15Dh
.text:0040A0CA		       push    esi	       ; cb
.text:0040A0CB		       call    __malloc_crt
.text:0040A0D0		       cmp     eax, edi
.text:0040A0D2		       mov     dl, [ebp+290h+cur_type]
.text:0040A0D5		       pop     ecx
.text:0040A0D6		       mov     [ebp+290h+heapbuf], eax
.text:0040A0D9		       jz      short loc_40A09C
.text:0040A0DB		       mov     dword ptr [ebp+290h+text], eax
.text:0040A0DE		       mov     [ebp+290h+count], esi
.text:0040A0E1		       jmp     short loc_40A09F
.text:0040A0E3 ; ---------------------------------------------------------------------------
.text:0040A0E3
.text:0040A0E3 loc_40A0E3:			       ; CODE XREF: __output_p_l+928j
.text:0040A0E3		       cmp     [ebp+290h+type_pos], 63h
.text:0040A0E7		       ja      loc_40A055
.text:0040A0ED		       mov     eax, [ebp+290h+type_pos]
.text:0040A0F0		       shl     eax, 4
.text:0040A0F3		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A0FA		       add     eax, 8
.text:0040A0FD
.text:0040A0FD loc_40A0FD:			       ; CODE XREF: __output_p_l+933j
.text:0040A0FD		       mov     ecx, [eax-8]
.text:0040A100		       mov     dword ptr [ebp+290h+tmp.x], ecx
.text:0040A103		       mov     eax, [eax-4]
.text:0040A106		       mov     dword ptr [ebp+290h+tmp.x+4], eax
.text:0040A109		       lea     eax, [ebp+290h+_loc_update]
.text:0040A10C		       push    eax
.text:0040A10D		       push    [ebp+290h+capexp]
.text:0040A110		       movsx   eax, dl
.text:0040A113		       push    [ebp+290h+precision]
.text:0040A116		       push    eax
.text:0040A117		       push    [ebp+290h+count]
.text:0040A11A		       lea     eax, [ebp+290h+tmp]
.text:0040A11D		       push    dword ptr [ebp+290h+text]
.text:0040A120		       push    eax
.text:0040A121		       push    codedptr	       ; codedptr
.text:0040A127		       call    __decode_pointer
.text:0040A12C		       pop     ecx
.text:0040A12D		       call    eax
.text:0040A12F		       mov     esi, [ebp+290h+flags]
.text:0040A135		       add     esp, 1Ch
.text:0040A138		       and     esi, 80h
.text:0040A13E		       jz      short loc_40A15C
.text:0040A140		       cmp     [ebp+290h+precision], edi
.text:0040A143		       jnz     short loc_40A15C
.text:0040A145		       lea     eax, [ebp+290h+_loc_update]
.text:0040A148		       push    eax
.text:0040A149		       push    dword ptr [ebp+290h+text]
.text:0040A14C		       push    off_421694      ; codedptr
.text:0040A152		       call    __decode_pointer
.text:0040A157		       pop     ecx
.text:0040A158		       call    eax
.text:0040A15A		       pop     ecx
.text:0040A15B		       pop     ecx
.text:0040A15C
.text:0040A15C loc_40A15C:			       ; CODE XREF: __output_p_l+9C4j
.text:0040A15C					       ; __output_p_l+9C9j
.text:0040A15C		       cmp     [ebp+290h+cur_type], 67h
.text:0040A160		       jnz     short loc_40A17D
.text:0040A162		       cmp     esi, edi
.text:0040A164		       jnz     short loc_40A17D
.text:0040A166		       lea     eax, [ebp+290h+_loc_update]
.text:0040A169		       push    eax
.text:0040A16A		       push    dword ptr [ebp+290h+text]
.text:0040A16D		       push    off_421690      ; codedptr
.text:0040A173		       call    __decode_pointer
.text:0040A178		       pop     ecx
.text:0040A179		       call    eax
.text:0040A17B		       pop     ecx
.text:0040A17C		       pop     ecx
.text:0040A17D
.text:0040A17D loc_40A17D:			       ; CODE XREF: __output_p_l+9E6j
.text:0040A17D					       ; __output_p_l+9EAj
.text:0040A17D		       mov     eax, dword ptr [ebp+290h+text]
.text:0040A180		       cmp     byte ptr	[eax], 2Dh
.text:0040A183		       jnz     short loc_40A192
.text:0040A185		       or      [ebp+290h+flags], 100h
.text:0040A18F		       inc     dword ptr [ebp+290h+text]
.text:0040A192
.text:0040A192 loc_40A192:			       ; CODE XREF: __output_p_l+A09j
.text:0040A192		       push    dword ptr [ebp+290h+text]
.text:0040A195		       jmp     loc_409F24
.text:0040A19A ; ---------------------------------------------------------------------------
.text:0040A19A
.text:0040A19A loc_40A19A:			       ; CODE XREF: __output_p_l+7BEj
.text:0040A19A		       mov     [ebp+290h+precision], 8
.text:0040A1A1
.text:0040A1A1 loc_40A1A1:			       ; CODE XREF: __output_p_l+650j
.text:0040A1A1		       mov     [ebp+290h+hexadd], 7
.text:0040A1A8		       jmp     short COMMON_HEX_1
.text:0040A1AA ; ---------------------------------------------------------------------------
.text:0040A1AA
.text:0040A1AA loc_40A1AA:			       ; CODE XREF: __output_p_l+7B8j
.text:0040A1AA		       sub     eax, 73h
.text:0040A1AD		       jz      loc_409DA2
.text:0040A1B3		       dec     eax
.text:0040A1B4		       dec     eax
.text:0040A1B5		       jz      loc_40A007
.text:0040A1BB		       sub     eax, 3
.text:0040A1BE		       jnz     loc_40A507
.text:0040A1C4		       mov     [ebp+290h+hexadd], 27h
.text:0040A1CB
.text:0040A1CB COMMON_HEX_1:			       ; CODE XREF: __output_p_l+A2Ej
.text:0040A1CB		       test    byte ptr	[ebp+290h+flags], 80h
.text:0040A1D2		       mov     [ebp+290h+count], 10h
.text:0040A1D9		       jz      COMMON_INT_1
.text:0040A1DF		       mov     al, byte	ptr [ebp+290h+hexadd]
.text:0040A1E2		       add     al, 51h
.text:0040A1E4		       mov     [ebp+290h+prefix], 30h
.text:0040A1E8		       mov     [ebp+290h+prefix+1], al
.text:0040A1EB		       mov     [ebp+290h+prefixlen], 2
.text:0040A1F2		       jmp     COMMON_INT_1
.text:0040A1F7 ; ---------------------------------------------------------------------------
.text:0040A1F7
.text:0040A1F7 loc_40A1F7:			       ; CODE XREF: __output_p_l+8A6j
.text:0040A1F7		       cmp     [ebp+290h+type_pos], 63h
.text:0040A1FB		       ja      loc_40A055
.text:0040A201		       mov     eax, [ebp+290h+type_pos]
.text:0040A204		       shl     eax, 4
.text:0040A207		       cmp     [ebp+290h+pass],	edi
.text:0040A20A		       jnz     short loc_40A27C
.text:0040A20C		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A213		       cmp     [ecx], edi
.text:0040A215		       jnz     short loc_40A222
.text:0040A217		       mov     dword ptr [ecx],	4
.text:0040A21D		       jmp     loc_40A4BB
.text:0040A222 ; ---------------------------------------------------------------------------
.text:0040A222
.text:0040A222 loc_40A222:			       ; CODE XREF: __output_p_l+A9Bj
.text:0040A222		       push    [ebp+290h+flags]
.text:0040A228		       push    dword ptr [ebp+290h+cur_type]
.text:0040A22B		       push    4
.text:0040A22D		       jmp     loc_40A37A
.text:0040A232 ; ---------------------------------------------------------------------------
.text:0040A232
.text:0040A232 loc_40A232:			       ; CODE XREF: __output_p_l+89Dj
.text:0040A232		       test    ax, 1000h
.text:0040A236		       jz      short loc_40A28D
.text:0040A238		       cmp     [ebp+290h+format_type], edi
.text:0040A23B		       jz      loc_40A026
.text:0040A241		       cmp     [ebp+290h+type_pos], 63h
.text:0040A245		       ja      loc_40A055
.text:0040A24B		       mov     eax, [ebp+290h+type_pos]
.text:0040A24E		       shl     eax, 4
.text:0040A251		       cmp     [ebp+290h+pass],	edi
.text:0040A254		       jnz     short loc_40A27C
.text:0040A256		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A25D		       cmp     [ecx], edi
.text:0040A25F		       jnz     short loc_40A26C
.text:0040A261		       mov     dword ptr [ecx],	5
.text:0040A267		       jmp     loc_40A4BB
.text:0040A26C ; ---------------------------------------------------------------------------
.text:0040A26C
.text:0040A26C loc_40A26C:			       ; CODE XREF: __output_p_l+AE5j
.text:0040A26C		       push    [ebp+290h+flags]
.text:0040A272		       push    dword ptr [ebp+290h+cur_type]
.text:0040A275		       push    5
.text:0040A277		       jmp     loc_40A37A
.text:0040A27C ; ---------------------------------------------------------------------------
.text:0040A27C
.text:0040A27C loc_40A27C:			       ; CODE XREF: __output_p_l+A90j
.text:0040A27C					       ; __output_p_l+ADAj
.text:0040A27C		       mov     ecx, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A283		       mov     eax, [ecx]
.text:0040A285		       mov     edx, [ecx+4]
.text:0040A288		       jmp     loc_40A39B
.text:0040A28D ; ---------------------------------------------------------------------------
.text:0040A28D
.text:0040A28D loc_40A28D:			       ; CODE XREF: __output_p_l+ABCj
.text:0040A28D		       test    al, 20h
.text:0040A28F		       jz      short loc_40A302
.text:0040A291		       test    al, 40h
.text:0040A293		       jz      short loc_40A2CF
.text:0040A295		       cmp     [ebp+290h+format_type], edi
.text:0040A298		       jnz     short loc_40A2AA
.text:0040A29A		       add     [ebp+290h+var_214], 4
.text:0040A29E		       mov     eax, [ebp+290h+var_214]
.text:0040A2A1		       movsx   eax, word ptr [eax-4]
.text:0040A2A5		       jmp     loc_40A335
.text:0040A2AA ; ---------------------------------------------------------------------------
.text:0040A2AA
.text:0040A2AA loc_40A2AA:			       ; CODE XREF: __output_p_l+B1Ej
.text:0040A2AA		       cmp     [ebp+290h+type_pos], 63h
.text:0040A2AE		       ja      loc_40A055
.text:0040A2B4		       mov     eax, [ebp+290h+type_pos]
.text:0040A2B7		       shl     eax, 4
.text:0040A2BA		       cmp     [ebp+290h+pass],	edi
.text:0040A2BD		       jz      loc_40A35E
.text:0040A2C3		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A2CA		       movsx   eax, word ptr [eax]
.text:0040A2CD		       jmp     short loc_40A335
.text:0040A2CF ; ---------------------------------------------------------------------------
.text:0040A2CF
.text:0040A2CF loc_40A2CF:			       ; CODE XREF: __output_p_l+B19j
.text:0040A2CF		       cmp     [ebp+290h+format_type], edi
.text:0040A2D2		       jnz     short loc_40A2E1
.text:0040A2D4		       add     [ebp+290h+var_214], 4
.text:0040A2D8		       mov     eax, [ebp+290h+var_214]
.text:0040A2DB		       movzx   eax, word ptr [eax-4]
.text:0040A2DF		       jmp     short loc_40A335
.text:0040A2E1 ; ---------------------------------------------------------------------------
.text:0040A2E1
.text:0040A2E1 loc_40A2E1:			       ; CODE XREF: __output_p_l+B58j
.text:0040A2E1		       cmp     [ebp+290h+type_pos], 63h
.text:0040A2E5		       ja      loc_40A055
.text:0040A2EB		       mov     eax, [ebp+290h+type_pos]
.text:0040A2EE		       shl     eax, 4
.text:0040A2F1		       cmp     [ebp+290h+pass],	edi
.text:0040A2F4		       jz      short loc_40A35E
.text:0040A2F6		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A2FD		       movzx   eax, word ptr [eax]
.text:0040A300		       jmp     short loc_40A335
.text:0040A302 ; ---------------------------------------------------------------------------
.text:0040A302
.text:0040A302 loc_40A302:			       ; CODE XREF: __output_p_l+B15j
.text:0040A302		       test    al, 40h
.text:0040A304		       jz      short loc_40A338
.text:0040A306		       cmp     [ebp+290h+format_type], edi
.text:0040A309		       jnz     short loc_40A317
.text:0040A30B		       add     [ebp+290h+var_214], 4
.text:0040A30F		       mov     eax, [ebp+290h+var_214]
.text:0040A312		       mov     eax, [eax-4]
.text:0040A315		       jmp     short loc_40A335
.text:0040A317 ; ---------------------------------------------------------------------------
.text:0040A317
.text:0040A317 loc_40A317:			       ; CODE XREF: __output_p_l+B8Fj
.text:0040A317		       cmp     [ebp+290h+type_pos], 63h
.text:0040A31B		       ja      loc_40A055
.text:0040A321		       mov     eax, [ebp+290h+type_pos]
.text:0040A324		       shl     eax, 4
.text:0040A327		       cmp     [ebp+290h+pass],	edi
.text:0040A32A		       jz      short loc_40A35E
.text:0040A32C		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A333		       mov     eax, [eax]
.text:0040A335
.text:0040A335 loc_40A335:			       ; CODE XREF: __output_p_l+B2Bj
.text:0040A335					       ; __output_p_l+B53j ...
.text:0040A335		       cdq
.text:0040A336		       jmp     short loc_40A39B
.text:0040A338 ; ---------------------------------------------------------------------------
.text:0040A338
.text:0040A338 loc_40A338:			       ; CODE XREF: __output_p_l+B8Aj
.text:0040A338		       cmp     [ebp+290h+format_type], edi
.text:0040A33B		       jnz     short loc_40A349
.text:0040A33D		       add     [ebp+290h+var_214], 4
.text:0040A341		       mov     eax, [ebp+290h+var_214]
.text:0040A344		       mov     eax, [eax-4]
.text:0040A347		       jmp     short loc_40A399
.text:0040A349 ; ---------------------------------------------------------------------------
.text:0040A349
.text:0040A349 loc_40A349:			       ; CODE XREF: __output_p_l+BC1j
.text:0040A349		       cmp     [ebp+290h+type_pos], 63h
.text:0040A34D		       ja      loc_40A055
.text:0040A353		       mov     eax, [ebp+290h+type_pos]
.text:0040A356		       shl     eax, 4
.text:0040A359		       cmp     [ebp+290h+pass],	edi
.text:0040A35C		       jnz     short loc_40A390
.text:0040A35E
.text:0040A35E loc_40A35E:			       ; CODE XREF: __output_p_l+716j
.text:0040A35E					       ; __output_p_l+B43j ...
.text:0040A35E		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A365		       cmp     [ecx], edi
.text:0040A367		       jnz     short loc_40A370
.text:0040A369		       mov     [ecx], ebx
.text:0040A36B		       jmp     loc_40A4BB
.text:0040A370 ; ---------------------------------------------------------------------------
.text:0040A370
.text:0040A370 loc_40A370:			       ; CODE XREF: __output_p_l+BEDj
.text:0040A370		       push    [ebp+290h+flags]	; cur_flags
.text:0040A376		       push    dword ptr [ebp+290h+cur_type] ; cur_type
.text:0040A379		       push    ebx	       ; get_fn_type
.text:0040A37A
.text:0040A37A loc_40A37A:			       ; CODE XREF: __output_p_l+6C0j
.text:0040A37A					       ; __output_p_l+850j ...
.text:0040A37A		       push    ecx	       ; pos
.text:0040A37B		       call    __validate_param_reuseA
.text:0040A380		       add     esp, 10h
.text:0040A383		       test    eax, eax
.text:0040A385		       jz      loc_40A055
.text:0040A38B		       jmp     loc_40A507
.text:0040A390 ; ---------------------------------------------------------------------------
.text:0040A390
.text:0040A390 loc_40A390:			       ; CODE XREF: __output_p_l+BE2j
.text:0040A390		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A397		       mov     eax, [eax]
.text:0040A399
.text:0040A399 loc_40A399:			       ; CODE XREF: __output_p_l+BCDj
.text:0040A399		       xor     edx, edx
.text:0040A39B
.text:0040A39B loc_40A39B:			       ; CODE XREF: __output_p_l+8BAj
.text:0040A39B					       ; __output_p_l+B0Ej ...
.text:0040A39B		       test    byte ptr	[ebp+290h+flags], 40h
.text:0040A3A2		       jz      short loc_40A3BF
.text:0040A3A4		       cmp     edx, edi
.text:0040A3A6		       jg      short loc_40A3BF
.text:0040A3A8		       jl      short loc_40A3AE
.text:0040A3AA		       cmp     eax, edi
.text:0040A3AC		       jnb     short loc_40A3BF
.text:0040A3AE
.text:0040A3AE loc_40A3AE:			       ; CODE XREF: __output_p_l+C2Ej
.text:0040A3AE		       neg     eax
.text:0040A3B0		       adc     edx, 0
.text:0040A3B3		       neg     edx
.text:0040A3B5		       or      [ebp+290h+flags], 100h
.text:0040A3BF
.text:0040A3BF loc_40A3BF:			       ; CODE XREF: __output_p_l+C28j
.text:0040A3BF					       ; __output_p_l+C2Cj ...
.text:0040A3BF		       test    word ptr	[ebp+290h+flags], 9000h
.text:0040A3C8		       mov     ebx, edx
.text:0040A3CA		       mov     edi, eax
.text:0040A3CC		       jnz     short loc_40A3D0
.text:0040A3CE		       xor     ebx, ebx
.text:0040A3D0
.text:0040A3D0 loc_40A3D0:			       ; CODE XREF: __output_p_l+C52j
.text:0040A3D0		       cmp     [ebp+290h+precision], 0
.text:0040A3D4		       jge     short loc_40A3DF
.text:0040A3D6		       mov     [ebp+290h+precision], 1
.text:0040A3DD		       jmp     short loc_40A3F3
.text:0040A3DF ; ---------------------------------------------------------------------------
.text:0040A3DF
.text:0040A3DF loc_40A3DF:			       ; CODE XREF: __output_p_l+C5Aj
.text:0040A3DF		       and     [ebp+290h+flags], 0FFFFFFF7h
.text:0040A3E6		       mov     eax, 200h
.text:0040A3EB		       cmp     [ebp+290h+precision], eax
.text:0040A3EE		       jle     short loc_40A3F3
.text:0040A3F0		       mov     [ebp+290h+precision], eax
.text:0040A3F3
.text:0040A3F3 loc_40A3F3:			       ; CODE XREF: __output_p_l+C63j
.text:0040A3F3					       ; __output_p_l+C74j
.text:0040A3F3		       mov     eax, edi
.text:0040A3F5		       or      eax, ebx
.text:0040A3F7		       jnz     short loc_40A3FC
.text:0040A3F9		       and     [ebp+290h+prefixlen], eax
.text:0040A3FC
.text:0040A3FC loc_40A3FC:			       ; CODE XREF: __output_p_l+C7Dj
.text:0040A3FC		       lea     esi, [ebp+290h+buffer+1FFh]
.text:0040A402
.text:0040A402 loc_40A402:			       ; CODE XREF: __output_p_l+CBAj
.text:0040A402		       mov     eax, [ebp+290h+precision]
.text:0040A405		       dec     [ebp+290h+precision]
.text:0040A408		       test    eax, eax
.text:0040A40A		       jg      short loc_40A412
.text:0040A40C		       mov     eax, edi
.text:0040A40E		       or      eax, ebx
.text:0040A410		       jz      short loc_40A436
.text:0040A412
.text:0040A412 loc_40A412:			       ; CODE XREF: __output_p_l+C90j
.text:0040A412		       mov     eax, [ebp+290h+count]
.text:0040A415		       cdq
.text:0040A416		       push    edx
.text:0040A417		       push    eax
.text:0040A418		       push    ebx
.text:0040A419		       push    edi
.text:0040A41A		       call    __aulldvrm
.text:0040A41F		       add     ecx, 30h
.text:0040A422		       cmp     ecx, 39h
.text:0040A425		       mov     [ebp+290h+textlen], ebx
.text:0040A428		       mov     edi, eax	       ; f
.text:0040A42A		       mov     ebx, edx
.text:0040A42C		       jle     short loc_40A431
.text:0040A42E		       add     ecx, [ebp+290h+hexadd]
.text:0040A431
.text:0040A431 loc_40A431:			       ; CODE XREF: __output_p_l+CB2j
.text:0040A431		       mov     [esi], cl
.text:0040A433		       dec     esi
.text:0040A434		       jmp     short loc_40A402
.text:0040A436 ; ---------------------------------------------------------------------------
.text:0040A436
.text:0040A436 loc_40A436:			       ; CODE XREF: __output_p_l+C96j
.text:0040A436		       lea     eax, [ebp+290h+buffer+1FFh]
.text:0040A43C		       sub     eax, esi
.text:0040A43E		       inc     esi
.text:0040A43F		       test    word ptr	[ebp+290h+flags], 200h
.text:0040A448		       mov     [ebp+290h+textlen], eax
.text:0040A44B		       mov     dword ptr [ebp+290h+text], esi
.text:0040A44E		       jz      loc_40A507
.text:0040A454		       test    eax, eax
.text:0040A456		       jz      short loc_40A463
.text:0040A458		       mov     ecx, esi
.text:0040A45A		       cmp     byte ptr	[ecx], 30h
.text:0040A45D		       jz      loc_40A507
.text:0040A463
.text:0040A463 loc_40A463:			       ; CODE XREF: __output_p_l+CDCj
.text:0040A463		       dec     dword ptr [ebp+290h+text]
.text:0040A466		       mov     ecx, dword ptr [ebp+290h+text]
.text:0040A469		       mov     byte ptr	[ecx], 30h
.text:0040A46C		       inc     eax
.text:0040A46D		       jmp     loc_40A504
.text:0040A472 ; ---------------------------------------------------------------------------
.text:0040A472
.text:0040A472 loc_40A472:			       ; CODE XREF: __output_p_l+638j
.text:0040A472		       mov     eax, [ebp+290h+type_pos]
.text:0040A475		       cmp     eax, 63h
.text:0040A478		       ja      loc_40A055
.text:0040A47E		       shl     eax, 4
.text:0040A481		       cmp     [ebp+290h+pass],	edi
.text:0040A484		       jz      loc_409FB0
.text:0040A48A		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A491		       mov     eax, [eax]
.text:0040A493
.text:0040A493 loc_40A493:			       ; CODE XREF: __output_p_l+648j
.text:0040A493		       test    word ptr	[ebp+290h+flags], 810h
.text:0040A49C		       mov     dword ptr [ebp+290h+text], eax
.text:0040A49F		       jz      short loc_40A4E4
.text:0040A4A1		       cmp     eax, edi
.text:0040A4A3		       jnz     short loc_40A4AD
.text:0040A4A5		       mov     eax, ___wnullstring
.text:0040A4AA		       mov     dword ptr [ebp+290h+text], eax
.text:0040A4AD
.text:0040A4AD loc_40A4AD:			       ; CODE XREF: __output_p_l+D29j
.text:0040A4AD		       mov     eax, dword ptr [ebp+290h+text]
.text:0040A4B0		       mov     [ebp+290h+bufferiswide],	ebx
.text:0040A4B3		       jmp     short loc_40A4D9
.text:0040A4B5 ; ---------------------------------------------------------------------------
.text:0040A4B5
.text:0040A4B5 loc_40A4B5:			       ; CODE XREF: __output_p_l+83Fj
.text:0040A4B5		       mov     dword ptr [ecx],	3
.text:0040A4BB
.text:0040A4BB loc_40A4BB:			       ; CODE XREF: __output_p_l+6B1j
.text:0040A4BB					       ; __output_p_l+AA3j ...
.text:0040A4BB		       mov     ecx, [ebp+290h+flags]
.text:0040A4C1		       mov     [ebp+eax+290h+pos_value.type], dl
.text:0040A4C8		       mov     [ebp+eax+290h+pos_value.flags], ecx
.text:0040A4CF		       jmp     short loc_40A507
.text:0040A4D1 ; ---------------------------------------------------------------------------
.text:0040A4D1
.text:0040A4D1 loc_40A4D1:			       ; CODE XREF: __output_p_l+D61j
.text:0040A4D1		       dec     ecx
.text:0040A4D2		       cmp     [eax], di
.text:0040A4D5		       jz      short loc_40A4DD
.text:0040A4D7		       inc     eax
.text:0040A4D8		       inc     eax
.text:0040A4D9
.text:0040A4D9 loc_40A4D9:			       ; CODE XREF: __output_p_l+D39j
.text:0040A4D9		       cmp     ecx, edi
.text:0040A4DB		       jnz     short loc_40A4D1
.text:0040A4DD
.text:0040A4DD loc_40A4DD:			       ; CODE XREF: __output_p_l+D5Bj
.text:0040A4DD		       sub     eax, dword ptr [ebp+290h+text]
.text:0040A4E0		       sar     eax, 1
.text:0040A4E2		       jmp     short loc_40A504
.text:0040A4E4 ; ---------------------------------------------------------------------------
.text:0040A4E4
.text:0040A4E4 loc_40A4E4:			       ; CODE XREF: __output_p_l+D25j
.text:0040A4E4		       cmp     dword ptr [ebp+290h+text], edi
.text:0040A4E7		       jnz     short loc_40A4F1
.text:0040A4E9		       mov     eax, ___nullstring
.text:0040A4EE		       mov     dword ptr [ebp+290h+text], eax
.text:0040A4F1
.text:0040A4F1 loc_40A4F1:			       ; CODE XREF: __output_p_l+D6Dj
.text:0040A4F1		       mov     eax, dword ptr [ebp+290h+text]
.text:0040A4F4		       jmp     short loc_40A4FD
.text:0040A4F6 ; ---------------------------------------------------------------------------
.text:0040A4F6
.text:0040A4F6 loc_40A4F6:			       ; CODE XREF: __output_p_l+D85j
.text:0040A4F6		       dec     ecx
.text:0040A4F7		       cmp     byte ptr	[eax], 0
.text:0040A4FA		       jz      short loc_40A501
.text:0040A4FC		       inc     eax
.text:0040A4FD
.text:0040A4FD loc_40A4FD:			       ; CODE XREF: __output_p_l+D7Aj
.text:0040A4FD		       cmp     ecx, edi
.text:0040A4FF		       jnz     short loc_40A4F6
.text:0040A501
.text:0040A501 loc_40A501:			       ; CODE XREF: __output_p_l+D80j
.text:0040A501		       sub     eax, dword ptr [ebp+290h+text]
.text:0040A504
.text:0040A504 loc_40A504:			       ; CODE XREF: __output_p_l+794j
.text:0040A504					       ; __output_p_l+79Cj ...
.text:0040A504		       mov     [ebp+290h+textlen], eax
.text:0040A507
.text:0040A507 loc_40A507:			       ; CODE XREF: __output_p_l+5A3j
.text:0040A507					       ; __output_p_l+669j ...
.text:0040A507		       cmp     [ebp+290h+format_type], 1
.text:0040A50B		       jnz     short loc_40A517
.text:0040A50D		       cmp     [ebp+290h+pass],	0
.text:0040A511		       jz      loc_40A639
.text:0040A517
.text:0040A517 loc_40A517:			       ; CODE XREF: __output_p_l+D91j
.text:0040A517		       cmp     [ebp+290h+no_output], 0
.text:0040A51B		       jnz     loc_40A626
.text:0040A521		       mov     eax, [ebp+290h+flags]
.text:0040A527		       test    al, 40h
.text:0040A529		       jz      short loc_40A550
.text:0040A52B		       test    ax, 100h
.text:0040A52F		       jz      short loc_40A537
.text:0040A531		       mov     [ebp+290h+prefix], 2Dh
.text:0040A535		       jmp     short loc_40A549
.text:0040A537 ; ---------------------------------------------------------------------------
.text:0040A537
.text:0040A537 loc_40A537:			       ; CODE XREF: __output_p_l+DB5j
.text:0040A537		       test    al, 1
.text:0040A539		       jz      short loc_40A541
.text:0040A53B		       mov     [ebp+290h+prefix], 2Bh
.text:0040A53F		       jmp     short loc_40A549
.text:0040A541 ; ---------------------------------------------------------------------------
.text:0040A541
.text:0040A541 loc_40A541:			       ; CODE XREF: __output_p_l+DBFj
.text:0040A541		       test    al, 2
.text:0040A543		       jz      short loc_40A550
.text:0040A545		       mov     [ebp+290h+prefix], 20h
.text:0040A549
.text:0040A549 loc_40A549:			       ; CODE XREF: __output_p_l+DBBj
.text:0040A549					       ; __output_p_l+DC5j
.text:0040A549		       mov     [ebp+290h+prefixlen], 1
.text:0040A550
.text:0040A550 loc_40A550:			       ; CODE XREF: __output_p_l+DAFj
.text:0040A550					       ; __output_p_l+DC9j
.text:0040A550		       mov     ebx, [ebp+290h+fldwidth]
.text:0040A553		       sub     ebx, [ebp+290h+textlen]
.text:0040A556		       sub     ebx, [ebp+290h+prefixlen]
.text:0040A559		       test    al, 0Ch
.text:0040A55B		       jnz     short loc_40A56E
.text:0040A55D		       push    [ebp+290h+f]    ; f
.text:0040A560		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A563		       push    ebx	       ; num
.text:0040A564		       push    20h	       ; ch
.text:0040A566		       call    write_multi_char_1
.text:0040A56B		       add     esp, 0Ch
.text:0040A56E
.text:0040A56E loc_40A56E:			       ; CODE XREF: __output_p_l+DE1j
.text:0040A56E		       push    [ebp+290h+prefixlen] ; len
.text:0040A571		       mov     edi, [ebp+290h+f] ; f
.text:0040A574		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A577		       lea     ecx, [ebp+290h+prefix] ;	string
.text:0040A57A		       call    write_string_1
.text:0040A57F		       test    byte ptr	[ebp+290h+flags], 8
.text:0040A586		       pop     ecx
.text:0040A587		       jz      short loc_40A5A1
.text:0040A589		       test    byte ptr	[ebp+290h+flags], 4
.text:0040A590		       jnz     short loc_40A5A1
.text:0040A592		       push    edi	       ; f
.text:0040A593		       push    ebx	       ; num
.text:0040A594		       push    30h	       ; ch
.text:0040A596		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A599		       call    write_multi_char_1
.text:0040A59E		       add     esp, 0Ch
.text:0040A5A1
.text:0040A5A1 loc_40A5A1:			       ; CODE XREF: __output_p_l+E0Dj
.text:0040A5A1					       ; __output_p_l+E16j
.text:0040A5A1		       cmp     [ebp+290h+bufferiswide],	0
.text:0040A5A5		       mov     eax, [ebp+290h+textlen]
.text:0040A5A8		       jz      short loc_40A5FB
.text:0040A5AA		       test    eax, eax
.text:0040A5AC		       jle     short loc_40A5FB
.text:0040A5AE		       mov     esi, dword ptr [ebp+290h+text]
.text:0040A5B1		       mov     [ebp+290h+count], eax
.text:0040A5B4
.text:0040A5B4 loc_40A5B4:			       ; CODE XREF: __output_p_l+E77j
.text:0040A5B4		       movzx   eax, word ptr [esi]
.text:0040A5B7		       dec     [ebp+290h+count]
.text:0040A5BA		       push    eax	       ; wchar
.text:0040A5BB		       push    6	       ; sizeInBytes
.text:0040A5BD		       lea     eax, [ebp+290h+L_buffer]
.text:0040A5C3		       push    eax	       ; dst
.text:0040A5C4		       lea     eax, [ebp+290h+retval]
.text:0040A5C7		       inc     esi
.text:0040A5C8		       push    eax	       ; pRetValue
.text:0040A5C9		       inc     esi
.text:0040A5CA		       call    _wctomb_s
.text:0040A5CF		       add     esp, 10h
.text:0040A5D2		       test    eax, eax
.text:0040A5D4		       jnz     short loc_40A5F5
.text:0040A5D6		       cmp     [ebp+290h+retval], eax
.text:0040A5D9		       jz      short loc_40A5F5
.text:0040A5DB		       push    [ebp+290h+retval] ; len
.text:0040A5DE		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A5E1		       lea     ecx, [ebp+290h+L_buffer]	; string
.text:0040A5E7		       call    write_string_1
.text:0040A5EC		       cmp     [ebp+290h+count], 0
.text:0040A5F0		       pop     ecx
.text:0040A5F1		       jnz     short loc_40A5B4
.text:0040A5F3		       jmp     short loc_40A608
.text:0040A5F5 ; ---------------------------------------------------------------------------
.text:0040A5F5
.text:0040A5F5 loc_40A5F5:			       ; CODE XREF: __output_p_l+E5Aj
.text:0040A5F5					       ; __output_p_l+E5Fj
.text:0040A5F5		       or      [ebp+290h+charsout], 0FFFFFFFFh
.text:0040A5F9		       jmp     short loc_40A608
.text:0040A5FB ; ---------------------------------------------------------------------------
.text:0040A5FB
.text:0040A5FB loc_40A5FB:			       ; CODE XREF: __output_p_l+E2Ej
.text:0040A5FB					       ; __output_p_l+E32j
.text:0040A5FB		       mov     ecx, dword ptr [ebp+290h+text] ;	string
.text:0040A5FE		       push    eax	       ; len
.text:0040A5FF		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A602		       call    write_string_1
.text:0040A607		       pop     ecx
.text:0040A608
.text:0040A608 loc_40A608:			       ; CODE XREF: __output_p_l+E79j
.text:0040A608					       ; __output_p_l+E7Fj
.text:0040A608		       cmp     [ebp+290h+charsout], 0
.text:0040A60C		       jl      short loc_40A626
.text:0040A60E		       test    byte ptr	[ebp+290h+flags], 4
.text:0040A615		       jz      short loc_40A626
.text:0040A617		       push    edi	       ; f
.text:0040A618		       push    ebx	       ; num
.text:0040A619		       push    20h	       ; ch
.text:0040A61B		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A61E		       call    write_multi_char_1
.text:0040A623		       add     esp, 0Ch
.text:0040A626
.text:0040A626 loc_40A626:			       ; CODE XREF: __output_p_l+DA1j
.text:0040A626					       ; __output_p_l+E92j ...
.text:0040A626		       cmp     [ebp+290h+heapbuf], 0
.text:0040A62A		       jz      short loc_40A639
.text:0040A62C		       push    [ebp+290h+heapbuf] ; pBlock
.text:0040A62F		       call    _free
.text:0040A634		       and     [ebp+290h+heapbuf], 0
.text:0040A638		       pop     ecx
.text:0040A639
.text:0040A639 loc_40A639:			       ; CODE XREF: __output_p_l+27Dj
.text:0040A639					       ; __output_p_l+28Dj ...
.text:0040A639		       mov     esi, [ebp+290h+var_240]
.text:0040A63C		       mov     al, [esi]
.text:0040A63E		       test    al, al
.text:0040A640		       mov     [ebp+290h+cur_type], al
.text:0040A643		       jnz     loc_4098FB
.text:0040A649		       xor     edi, edi
.text:0040A64B
.text:0040A64B loc_40A64B:			       ; CODE XREF: __output_p_l+18Dj
.text:0040A64B		       cmp     [ebp+290h+state], edi
.text:0040A64E		       jz      short loc_40A65A
.text:0040A650		       cmp     [ebp+290h+state], 7
.text:0040A654		       jnz     loc_40A055
.text:0040A65A
.text:0040A65A loc_40A65A:			       ; CODE XREF: __output_p_l+ED4j
.text:0040A65A		       cmp     [ebp+290h+format_type], 1
.text:0040A65E		       jnz     short loc_40A6AA
.text:0040A660		       cmp     [ebp+290h+pass],	edi
.text:0040A663		       jnz     short loc_40A6AA
.text:0040A665		       xor     esi, esi
.text:0040A667		       cmp     [ebp+290h+max_pos], edi
.text:0040A66A		       jl      short loc_40A6AA
.text:0040A66C		       mov     edx, [ebp+290h+var_214]
.text:0040A66F		       lea     eax, [ebp+290h+pos_value.arg_ptr]
.text:0040A675
.text:0040A675 loc_40A675:			       ; CODE XREF: __output_p_l+F2Ej
.text:0040A675		       mov     ecx, [eax-4]
.text:0040A678		       dec     ecx
.text:0040A679		       jz      short loc_40A699
.text:0040A67B		       dec     ecx
.text:0040A67C		       jz      short loc_40A699
.text:0040A67E		       dec     ecx
.text:0040A67F		       jz      short loc_40A699
.text:0040A681		       dec     ecx
.text:0040A682		       jz      short loc_40A692
.text:0040A684		       dec     ecx
.text:0040A685		       jz      short loc_40A692
.text:0040A687		       dec     ecx
.text:0040A688		       jz      short loc_40A699
.text:0040A68A		       dec     ecx
.text:0040A68B		       dec     ecx
.text:0040A68C		       jnz     loc_40A055
.text:0040A692
.text:0040A692 loc_40A692:			       ; CODE XREF: __output_p_l+F08j
.text:0040A692					       ; __output_p_l+F0Bj
.text:0040A692		       mov     [eax], edx
.text:0040A694		       add     edx, 8
.text:0040A697		       jmp     short loc_40A69E
.text:0040A699 ; ---------------------------------------------------------------------------
.text:0040A699
.text:0040A699 loc_40A699:			       ; CODE XREF: __output_p_l+EFFj
.text:0040A699					       ; __output_p_l+F02j ...
.text:0040A699		       mov     [eax], edx
.text:0040A69B		       add     edx, 4
.text:0040A69E
.text:0040A69E loc_40A69E:			       ; CODE XREF: __output_p_l+F1Dj
.text:0040A69E		       inc     esi
.text:0040A69F		       add     eax, 10h
.text:0040A6A2		       cmp     esi, [ebp+290h+max_pos]
.text:0040A6A5		       mov     [ebp+290h+var_214], edx
.text:0040A6A8		       jle     short loc_40A675
.text:0040A6AA
.text:0040A6AA loc_40A6AA:			       ; CODE XREF: __output_p_l+177j
.text:0040A6AA					       ; __output_p_l+EE4j ...
.text:0040A6AA		       inc     [ebp+290h+pass]
.text:0040A6AD		       cmp     [ebp+290h+pass],	2
.text:0040A6B1		       jge     short loc_40A6BA
.text:0040A6B3		       xor     ebx, ebx
.text:0040A6B5		       jmp     loc_4098B8
.text:0040A6BA ; ---------------------------------------------------------------------------
.text:0040A6BA
.text:0040A6BA loc_40A6BA:			       ; CODE XREF: __output_p_l+147j
.text:0040A6BA					       ; __output_p_l+F37j
.text:0040A6BA		       cmp     [ebp+290h+_loc_update.updated], 0
.text:0040A6BE		       jz      short loc_40A6C7
.text:0040A6C0		       mov     eax, [ebp+290h+_loc_update.ptd]
.text:0040A6C3		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040A6C7
.text:0040A6C7 loc_40A6C7:			       ; CODE XREF: __output_p_l+F44j
.text:0040A6C7		       mov     eax, [ebp+290h+charsout]
.text:0040A6CA
.text:0040A6CA loc_40A6CA:			       ; CODE XREF: __output_p_l+8Dj
.text:0040A6CA		       mov     ecx, [ebp+290h+var_4]
.text:0040A6D0		       pop     edi
.text:0040A6D1		       pop     esi
.text:0040A6D2		       xor     ecx, ebp
.text:0040A6D4		       pop     ebx
.text:0040A6D5		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040A6DA		       add     ebp, 290h
.text:0040A6E0		       leave
.text:0040A6E1		       retn
.text:0040A6E1 ; ---------------------------------------------------------------------------
.text:0040A6E2 off_40A6E2      dd offset $LN265	       ; DATA XREF: __output_p_l+26Ar
.text:0040A6E6		       dd offset $LN259
.text:0040A6EA		       dd offset $LN258
.text:0040A6EE		       dd offset $LN250
.text:0040A6F2		       dd offset $LN238
.text:0040A6F6		       dd offset $LN237
.text:0040A6FA		       dd offset $LN225
.text:0040A6FE		       dd offset $LN209
.text:0040A6FE __output_p_l    endp
.text:0040A6FE
.text:0040A702		       align 10h
.text:0040A710
.text:0040A710 ; =============== S U B R O U T I N E =======================================
.text:0040A710
.text:0040A710
.text:0040A710 ; void __cdecl strcmp(char *str1, char *str2)
.text:0040A710 _strcmp	       proc near	       ; CODE XREF: _use_encode_pointer+47p
.text:0040A710					       ; _setlocale_get_all+86p ...
.text:0040A710
.text:0040A710 arg_0	       = dword ptr  4
.text:0040A710 str1	       = dword ptr  8
.text:0040A710 str2	       = dword ptr  0Ch
.text:0040A710
.text:0040A710		       mov     edx, [esp+arg_0]
.text:0040A714		       mov     ecx, [esp+str1]
.text:0040A718		       test    edx, 3
.text:0040A71E		       jnz     short dopartial
.text:0040A720
.text:0040A720 dodwords:			       ; CODE XREF: _strcmp+3Cj
.text:0040A720					       ; _strcmp+6Aj ...
.text:0040A720		       mov     eax, [edx]
.text:0040A722		       cmp     al, [ecx]
.text:0040A724		       jnz     short donene
.text:0040A726		       or      al, al
.text:0040A728		       jz      short doneeq
.text:0040A72A		       cmp     ah, [ecx+1]
.text:0040A72D		       jnz     short donene
.text:0040A72F		       or      ah, ah
.text:0040A731		       jz      short doneeq
.text:0040A733		       shr     eax, 10h
.text:0040A736		       cmp     al, [ecx+2]
.text:0040A739		       jnz     short donene
.text:0040A73B		       or      al, al
.text:0040A73D		       jz      short doneeq
.text:0040A73F		       cmp     ah, [ecx+3]
.text:0040A742		       jnz     short donene
.text:0040A744		       add     ecx, 4
.text:0040A747		       add     edx, 4
.text:0040A74A		       or      ah, ah
.text:0040A74C		       jnz     short dodwords
.text:0040A74E		       mov     edi, edi
.text:0040A750
.text:0040A750 doneeq:				       ; CODE XREF: _strcmp+18j
.text:0040A750					       ; _strcmp+21j ...
.text:0040A750		       xor     eax, eax
.text:0040A752		       retn
.text:0040A752 ; ---------------------------------------------------------------------------
.text:0040A753		       align 4
.text:0040A754
.text:0040A754 donene:				       ; CODE XREF: _strcmp+14j
.text:0040A754					       ; _strcmp+1Dj ...
.text:0040A754		       sbb     eax, eax
.text:0040A756		       shl     eax, 1
.text:0040A758		       add     eax, 1
.text:0040A75B		       retn
.text:0040A75C ; ---------------------------------------------------------------------------
.text:0040A75C
.text:0040A75C dopartial:			       ; CODE XREF: _strcmp+Ej
.text:0040A75C		       test    edx, 1
.text:0040A762		       jz      short doword
.text:0040A764		       mov     al, [edx]
.text:0040A766		       add     edx, 1
.text:0040A769		       cmp     al, [ecx]
.text:0040A76B		       jnz     short donene
.text:0040A76D		       add     ecx, 1
.text:0040A770		       or      al, al
.text:0040A772		       jz      short doneeq
.text:0040A774		       test    edx, 2
.text:0040A77A		       jz      short dodwords
.text:0040A77C
.text:0040A77C doword:				       ; CODE XREF: _strcmp+52j
.text:0040A77C		       mov     ax, [edx]
.text:0040A77F		       add     edx, 2
.text:0040A782		       cmp     al, [ecx]
.text:0040A784		       jnz     short donene
.text:0040A786		       or      al, al
.text:0040A788		       jz      short doneeq
.text:0040A78A		       cmp     ah, [ecx+1]
.text:0040A78D		       jnz     short donene
.text:0040A78F		       or      ah, ah
.text:0040A791		       jz      short doneeq
.text:0040A793		       add     ecx, 2
.text:0040A796		       jmp     short dodwords
.text:0040A796 _strcmp	       endp
.text:0040A796
.text:0040A798
.text:0040A798 ; =============== S U B R O U T I N E =======================================
.text:0040A798
.text:0040A798 ; Attributes: bp-based frame
.text:0040A798
.text:0040A798 ; int __cdecl __crtMessageBoxA(const char *lpText, const	char *lpCaption, unsigned int uType)
.text:0040A798 ___crtMessageBoxA proc near	       ; CODE XREF: __NMSG_WRITE+15Dp
.text:0040A798
.text:0040A798 var_30	       = dword ptr -30h
.text:0040A798 uof	       = tagUSEROBJECTFLAGS ptr	-20h
.text:0040A798 nDummy	       = dword ptr -14h
.text:0040A798 winmajor	       = dword ptr -10h
.text:0040A798 osplatform      = dword ptr -0Ch
.text:0040A798 enull	       = dword ptr -8
.text:0040A798 hWndParent      = dword ptr -4
.text:0040A798 lpText	       = dword ptr  8
.text:0040A798 lpCaption       = dword ptr  0Ch
.text:0040A798 uType	       = dword ptr  10h
.text:0040A798
.text:0040A798		       push    ebp
.text:0040A799		       mov     ebp, esp
.text:0040A79B		       sub     esp, 20h
.text:0040A79E		       push    ebx
.text:0040A79F		       push    esi
.text:0040A7A0		       push    edi
.text:0040A7A1		       call    __encoded_null
.text:0040A7A6		       xor     ebx, ebx
.text:0040A7A8		       cmp     pfnMessageBox, ebx
.text:0040A7AE		       mov     [ebp+enull], eax
.text:0040A7B1		       mov     [ebp+hWndParent], ebx
.text:0040A7B4		       mov     [ebp+osplatform], ebx
.text:0040A7B7		       mov     [ebp+winmajor], ebx
.text:0040A7BA		       jnz     loc_40A86E
.text:0040A7C0		       push    offset aUser32_dll ; "USER32.DLL"
.text:0040A7C5		       call    ds:__imp__LoadLibraryA@4	; LoadLibraryA(x)
.text:0040A7CB		       mov     edi, eax
.text:0040A7CD		       cmp     edi, ebx
.text:0040A7CF		       jz      loc_40A94E
.text:0040A7D5		       mov     esi, ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:0040A7DB		       push    offset aMessageboxa ; "MessageBoxA"
.text:0040A7E0		       push    edi	       ; hModule
.text:0040A7E1		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040A7E3		       cmp     eax, ebx
.text:0040A7E5		       jz      loc_40A94E
.text:0040A7EB		       push    eax	       ; lpProcName
.text:0040A7EC		       call    __encode_pointer
.text:0040A7F1		       mov     [esp+30h+var_30], offset	aGetactivewindo	; "GetActiveWindow"
.text:0040A7F8		       push    edi	       ; hModule
.text:0040A7F9		       mov     pfnMessageBox, eax
.text:0040A7FE		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040A800		       push    eax	       ; lpProcName
.text:0040A801		       call    __encode_pointer
.text:0040A806		       mov     [esp+30h+var_30], offset	aGetlastactivep	; "GetLastActivePopup"
.text:0040A80D		       push    edi	       ; hModule
.text:0040A80E		       mov     pfnGetActiveWindow, eax
.text:0040A813		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040A815		       push    eax	       ; ptr
.text:0040A816		       call    __encode_pointer
.text:0040A81B		       mov     pfnGetLastActivePopup, eax
.text:0040A820		       lea     eax, [ebp+osplatform]
.text:0040A823		       push    eax	       ; pValue
.text:0040A824		       call    __get_osplatform
.text:0040A829		       test    eax, eax
.text:0040A82B		       pop     ecx
.text:0040A82C		       pop     ecx
.text:0040A82D		       jz      short loc_40A83C
.text:0040A82F		       push    ebx	       ; pReserved
.text:0040A830		       push    ebx	       ; nLine
.text:0040A831		       push    ebx	       ; pszFile
.text:0040A832		       push    ebx	       ; pszFunction
.text:0040A833		       push    ebx	       ; pszExpression
.text:0040A834		       call    __invoke_watson
.text:0040A839		       add     esp, 14h
.text:0040A83C
.text:0040A83C loc_40A83C:			       ; CODE XREF: ___crtMessageBoxA+95j
.text:0040A83C		       cmp     [ebp+osplatform], 2
.text:0040A840		       jnz     short loc_40A86E
.text:0040A842		       push    offset aGetuserobjecti ;	"GetUserObjectInformationA"
.text:0040A847		       push    edi	       ; hModule
.text:0040A848		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040A84A		       push    eax	       ; ptr
.text:0040A84B		       call    __encode_pointer
.text:0040A850		       cmp     eax, ebx
.text:0040A852		       pop     ecx
.text:0040A853		       mov     pfnGetUserObjectInformation, eax
.text:0040A858		       jz      short loc_40A86E
.text:0040A85A		       push    offset aGetprocesswind ;	"GetProcessWindowStation"
.text:0040A85F		       push    edi	       ; hModule
.text:0040A860		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040A862		       push    eax	       ; ptr
.text:0040A863		       call    __encode_pointer
.text:0040A868		       pop     ecx
.text:0040A869		       mov     pfnGetProcessWindowStation, eax
.text:0040A86E
.text:0040A86E loc_40A86E:			       ; CODE XREF: ___crtMessageBoxA+22j
.text:0040A86E					       ; ___crtMessageBoxA+A8j	...
.text:0040A86E		       mov     eax, pfnGetProcessWindowStation
.text:0040A873		       mov     ecx, [ebp+enull]
.text:0040A876		       cmp     eax, ecx
.text:0040A878		       jz      short loc_40A8F3
.text:0040A87A		       cmp     pfnGetUserObjectInformation, ecx
.text:0040A880		       jz      short loc_40A8F3
.text:0040A882		       push    eax	       ; codedptr
.text:0040A883		       call    __decode_pointer
.text:0040A888		       push    pfnGetUserObjectInformation ; codedptr
.text:0040A88E		       mov     esi, eax
.text:0040A890		       call    __decode_pointer
.text:0040A895		       cmp     esi, ebx
.text:0040A897		       pop     ecx
.text:0040A898		       pop     ecx
.text:0040A899		       mov     edi, eax
.text:0040A89B		       jz      short loc_40A8F3
.text:0040A89D		       cmp     edi, ebx
.text:0040A89F		       jz      short loc_40A8F3
.text:0040A8A1		       call    esi
.text:0040A8A3		       cmp     eax, ebx
.text:0040A8A5		       jz      short loc_40A8C0
.text:0040A8A7		       lea     ecx, [ebp+nDummy]
.text:0040A8AA		       push    ecx
.text:0040A8AB		       push    0Ch
.text:0040A8AD		       lea     ecx, [ebp+uof]
.text:0040A8B0		       push    ecx
.text:0040A8B1		       push    1
.text:0040A8B3		       push    eax
.text:0040A8B4		       call    edi
.text:0040A8B6		       test    eax, eax
.text:0040A8B8		       jz      short loc_40A8C0
.text:0040A8BA		       test    byte ptr	[ebp+uof.dwFlags], 1
.text:0040A8BE		       jnz     short loc_40A8F3
.text:0040A8C0
.text:0040A8C0 loc_40A8C0:			       ; CODE XREF: ___crtMessageBoxA+10Dj
.text:0040A8C0					       ; ___crtMessageBoxA+120j
.text:0040A8C0		       lea     eax, [ebp+winmajor]
.text:0040A8C3		       push    eax	       ; pValue
.text:0040A8C4		       call    __get_winmajor
.text:0040A8C9		       test    eax, eax
.text:0040A8CB		       pop     ecx
.text:0040A8CC		       jz      short loc_40A8DB
.text:0040A8CE		       push    ebx	       ; pReserved
.text:0040A8CF		       push    ebx	       ; nLine
.text:0040A8D0		       push    ebx	       ; pszFile
.text:0040A8D1		       push    ebx	       ; pszFunction
.text:0040A8D2		       push    ebx	       ; pszExpression
.text:0040A8D3		       call    __invoke_watson
.text:0040A8D8		       add     esp, 14h
.text:0040A8DB
.text:0040A8DB loc_40A8DB:			       ; CODE XREF: ___crtMessageBoxA+134j
.text:0040A8DB		       cmp     [ebp+winmajor], 4
.text:0040A8DF		       jb      short loc_40A8EA
.text:0040A8E1		       or      [ebp+uType], 200000h
.text:0040A8E8		       jmp     short loc_40A92E
.text:0040A8EA ; ---------------------------------------------------------------------------
.text:0040A8EA
.text:0040A8EA loc_40A8EA:			       ; CODE XREF: ___crtMessageBoxA+147j
.text:0040A8EA		       or      [ebp+uType], 40000h
.text:0040A8F1		       jmp     short loc_40A92E
.text:0040A8F3 ; ---------------------------------------------------------------------------
.text:0040A8F3
.text:0040A8F3 loc_40A8F3:			       ; CODE XREF: ___crtMessageBoxA+E0j
.text:0040A8F3					       ; ___crtMessageBoxA+E8j	...
.text:0040A8F3		       mov     eax, pfnGetActiveWindow
.text:0040A8F8		       cmp     eax, [ebp+enull]
.text:0040A8FB		       jz      short loc_40A92E
.text:0040A8FD		       push    eax	       ; codedptr
.text:0040A8FE		       call    __decode_pointer
.text:0040A903		       cmp     eax, ebx
.text:0040A905		       pop     ecx
.text:0040A906		       jz      short loc_40A92E
.text:0040A908		       call    eax
.text:0040A90A		       cmp     eax, ebx
.text:0040A90C		       mov     [ebp+hWndParent], eax
.text:0040A90F		       jz      short loc_40A92E
.text:0040A911		       mov     eax, pfnGetLastActivePopup
.text:0040A916		       cmp     eax, [ebp+enull]
.text:0040A919		       jz      short loc_40A92E
.text:0040A91B		       push    eax	       ; codedptr
.text:0040A91C		       call    __decode_pointer
.text:0040A921		       cmp     eax, ebx
.text:0040A923		       pop     ecx
.text:0040A924		       jz      short loc_40A92E
.text:0040A926		       push    [ebp+hWndParent]
.text:0040A929		       call    eax
.text:0040A92B		       mov     [ebp+hWndParent], eax
.text:0040A92E
.text:0040A92E loc_40A92E:			       ; CODE XREF: ___crtMessageBoxA+150j
.text:0040A92E					       ; ___crtMessageBoxA+159j ...
.text:0040A92E		       push    pfnMessageBox   ; codedptr
.text:0040A934		       call    __decode_pointer
.text:0040A939		       cmp     eax, ebx
.text:0040A93B		       pop     ecx
.text:0040A93C		       jz      short loc_40A94E
.text:0040A93E		       push    [ebp+uType]
.text:0040A941		       push    [ebp+lpCaption]
.text:0040A944		       push    [ebp+lpText]
.text:0040A947		       push    [ebp+hWndParent]
.text:0040A94A		       call    eax
.text:0040A94C		       jmp     short loc_40A950
.text:0040A94E ; ---------------------------------------------------------------------------
.text:0040A94E
.text:0040A94E loc_40A94E:			       ; CODE XREF: ___crtMessageBoxA+37j
.text:0040A94E					       ; ___crtMessageBoxA+4Dj	...
.text:0040A94E		       xor     eax, eax
.text:0040A950
.text:0040A950 loc_40A950:			       ; CODE XREF: ___crtMessageBoxA+1B4j
.text:0040A950		       pop     edi
.text:0040A951		       pop     esi
.text:0040A952		       pop     ebx
.text:0040A953		       leave
.text:0040A954		       retn
.text:0040A954 ___crtMessageBoxA endp
.text:0040A954
.text:0040A955
.text:0040A955 ; =============== S U B R O U T I N E =======================================
.text:0040A955
.text:0040A955
.text:0040A955 ; int __cdecl strcat_s(char *_Dst, unsigned int _SizeInBytes, const char	*_Src)
.text:0040A955 _strcat_s       proc near	       ; CODE XREF: __NMSG_WRITE+117p
.text:0040A955					       ; __NMSG_WRITE+139p ...
.text:0040A955
.text:0040A955 _Dst	       = dword ptr  4
.text:0040A955 _SizeInBytes    = dword ptr  8
.text:0040A955 _Src	       = dword ptr  0Ch
.text:0040A955
.text:0040A955		       mov     eax, [esp+_Dst]
.text:0040A959		       push    ebx
.text:0040A95A		       xor     ebx, ebx
.text:0040A95C		       cmp     eax, ebx
.text:0040A95E		       push    esi
.text:0040A95F		       push    edi
.text:0040A960		       jz      short loc_40A96A
.text:0040A962		       mov     edi, [esp+0Ch+_SizeInBytes]
.text:0040A966		       cmp     edi, ebx
.text:0040A968		       ja      short loc_40A985
.text:0040A96A
.text:0040A96A loc_40A96A:			       ; CODE XREF: _strcat_s+Bj
.text:0040A96A					       ; _strcat_s+3Aj
.text:0040A96A		       call    __errno
.text:0040A96F		       push    16h
.text:0040A971		       pop     esi
.text:0040A972		       mov     [eax], esi
.text:0040A974
.text:0040A974 loc_40A974:			       ; CODE XREF: _strcat_s+69j
.text:0040A974		       push    ebx	       ; pReserved
.text:0040A975		       push    ebx	       ; nLine
.text:0040A976		       push    ebx	       ; pszFile
.text:0040A977		       push    ebx	       ; pszFunction
.text:0040A978		       push    ebx	       ; pszExpression
.text:0040A979		       call    __invalid_parameter
.text:0040A97E		       add     esp, 14h
.text:0040A981		       mov     eax, esi
.text:0040A983		       jmp     short loc_40A9C2
.text:0040A985 ; ---------------------------------------------------------------------------
.text:0040A985
.text:0040A985 loc_40A985:			       ; CODE XREF: _strcat_s+13j
.text:0040A985		       mov     esi, [esp+0Ch+_Src]
.text:0040A989		       cmp     esi, ebx
.text:0040A98B		       jnz     short loc_40A991
.text:0040A98D
.text:0040A98D loc_40A98D:			       ; CODE XREF: _strcat_s+48j
.text:0040A98D		       mov     [eax], bl
.text:0040A98F		       jmp     short loc_40A96A
.text:0040A991 ; ---------------------------------------------------------------------------
.text:0040A991
.text:0040A991 loc_40A991:			       ; CODE XREF: _strcat_s+36j
.text:0040A991		       mov     edx, eax
.text:0040A993
.text:0040A993 loc_40A993:			       ; CODE XREF: _strcat_s+44j
.text:0040A993		       cmp     [edx], bl
.text:0040A995		       jz      short loc_40A99B
.text:0040A997		       inc     edx
.text:0040A998		       dec     edi
.text:0040A999		       jnz     short loc_40A993
.text:0040A99B
.text:0040A99B loc_40A99B:			       ; CODE XREF: _strcat_s+40j
.text:0040A99B		       cmp     edi, ebx
.text:0040A99D		       jz      short loc_40A98D
.text:0040A99F
.text:0040A99F loc_40A99F:			       ; CODE XREF: _strcat_s+55j
.text:0040A99F		       mov     cl, [esi]
.text:0040A9A1		       mov     [edx], cl
.text:0040A9A3		       inc     edx
.text:0040A9A4		       inc     esi
.text:0040A9A5		       cmp     cl, bl
.text:0040A9A7		       jz      short loc_40A9AC
.text:0040A9A9		       dec     edi
.text:0040A9AA		       jnz     short loc_40A99F
.text:0040A9AC
.text:0040A9AC loc_40A9AC:			       ; CODE XREF: _strcat_s+52j
.text:0040A9AC		       cmp     edi, ebx
.text:0040A9AE		       jnz     short loc_40A9C0
.text:0040A9B0		       mov     [eax], bl
.text:0040A9B2		       call    __errno
.text:0040A9B7		       push    22h
.text:0040A9B9		       pop     ecx
.text:0040A9BA		       mov     [eax], ecx
.text:0040A9BC		       mov     esi, ecx
.text:0040A9BE		       jmp     short loc_40A974
.text:0040A9C0 ; ---------------------------------------------------------------------------
.text:0040A9C0
.text:0040A9C0 loc_40A9C0:			       ; CODE XREF: _strcat_s+59j
.text:0040A9C0		       xor     eax, eax
.text:0040A9C2
.text:0040A9C2 loc_40A9C2:			       ; CODE XREF: _strcat_s+2Ej
.text:0040A9C2		       pop     edi
.text:0040A9C3		       pop     esi
.text:0040A9C4		       pop     ebx
.text:0040A9C5		       retn
.text:0040A9C5 _strcat_s       endp
.text:0040A9C5
.text:0040A9C6
.text:0040A9C6 ; =============== S U B R O U T I N E =======================================
.text:0040A9C6
.text:0040A9C6 ; Attributes: bp-based frame
.text:0040A9C6
.text:0040A9C6 ; int __cdecl strncpy_s(char *_Dst, unsigned int	_SizeInBytes, const char *_Src,	unsigned int _Count)
.text:0040A9C6 _strncpy_s      proc near	       ; CODE XREF: __NMSG_WRITE+F1p
.text:0040A9C6					       ; ___getlocaleinfo+E6p ...
.text:0040A9C6
.text:0040A9C6 _Dst	       = dword ptr  8
.text:0040A9C6 _SizeInBytes    = dword ptr  0Ch
.text:0040A9C6 _Src	       = dword ptr  10h
.text:0040A9C6 _Count	       = dword ptr  14h
.text:0040A9C6
.text:0040A9C6		       push    ebp
.text:0040A9C7		       mov     ebp, esp
.text:0040A9C9		       push    ebx
.text:0040A9CA		       push    esi
.text:0040A9CB		       mov     esi, [ebp+_Dst]
.text:0040A9CE		       xor     ebx, ebx
.text:0040A9D0		       cmp     [ebp+_Count], ebx
.text:0040A9D3		       push    edi
.text:0040A9D4		       jnz     short loc_40A9E6
.text:0040A9D6		       cmp     esi, ebx
.text:0040A9D8		       jnz     short loc_40A9EA
.text:0040A9DA		       cmp     [ebp+_SizeInBytes], ebx
.text:0040A9DD		       jnz     short loc_40A9F1
.text:0040A9DF
.text:0040A9DF loc_40A9DF:			       ; CODE XREF: _strncpy_s+4Dj
.text:0040A9DF					       ; _strncpy_s+8Cj
.text:0040A9DF		       xor     eax, eax
.text:0040A9E1
.text:0040A9E1 loc_40A9E1:			       ; CODE XREF: _strncpy_s+44j
.text:0040A9E1					       ; _strncpy_s+9Ej
.text:0040A9E1		       pop     edi
.text:0040A9E2		       pop     esi
.text:0040A9E3		       pop     ebx
.text:0040A9E4		       pop     ebp
.text:0040A9E5		       retn
.text:0040A9E6 ; ---------------------------------------------------------------------------
.text:0040A9E6
.text:0040A9E6 loc_40A9E6:			       ; CODE XREF: _strncpy_s+Ej
.text:0040A9E6		       cmp     esi, ebx
.text:0040A9E8		       jz      short loc_40A9F1
.text:0040A9EA
.text:0040A9EA loc_40A9EA:			       ; CODE XREF: _strncpy_s+12j
.text:0040A9EA		       mov     edi, [ebp+_SizeInBytes]
.text:0040A9ED		       cmp     edi, ebx
.text:0040A9EF		       ja      short loc_40AA0C
.text:0040A9F1
.text:0040A9F1 loc_40A9F1:			       ; CODE XREF: _strncpy_s+17j
.text:0040A9F1					       ; _strncpy_s+22j ...
.text:0040A9F1		       call    __errno
.text:0040A9F6		       push    16h
.text:0040A9F8		       pop     esi
.text:0040A9F9		       mov     [eax], esi
.text:0040A9FB
.text:0040A9FB loc_40A9FB:			       ; CODE XREF: _strncpy_s+B1j
.text:0040A9FB		       push    ebx	       ; pReserved
.text:0040A9FC		       push    ebx	       ; nLine
.text:0040A9FD		       push    ebx	       ; pszFile
.text:0040A9FE		       push    ebx	       ; pszFunction
.text:0040A9FF		       push    ebx	       ; pszExpression
.text:0040AA00		       call    __invalid_parameter
.text:0040AA05		       add     esp, 14h
.text:0040AA08		       mov     eax, esi
.text:0040AA0A		       jmp     short loc_40A9E1
.text:0040AA0C ; ---------------------------------------------------------------------------
.text:0040AA0C
.text:0040AA0C loc_40AA0C:			       ; CODE XREF: _strncpy_s+29j
.text:0040AA0C		       cmp     [ebp+_Count], ebx
.text:0040AA0F		       jnz     short loc_40AA15
.text:0040AA11		       mov     [esi], bl
.text:0040AA13		       jmp     short loc_40A9DF
.text:0040AA15 ; ---------------------------------------------------------------------------
.text:0040AA15
.text:0040AA15 loc_40AA15:			       ; CODE XREF: _strncpy_s+49j
.text:0040AA15		       mov     edx, [ebp+_Src]
.text:0040AA18		       cmp     edx, ebx
.text:0040AA1A		       jnz     short loc_40AA20
.text:0040AA1C		       mov     [esi], bl
.text:0040AA1E		       jmp     short loc_40A9F1
.text:0040AA20 ; ---------------------------------------------------------------------------
.text:0040AA20
.text:0040AA20 loc_40AA20:			       ; CODE XREF: _strncpy_s+54j
.text:0040AA20		       cmp     [ebp+_Count], 0FFFFFFFFh
.text:0040AA24		       mov     eax, esi
.text:0040AA26		       jnz     short loc_40AA37
.text:0040AA28
.text:0040AA28 loc_40AA28:			       ; CODE XREF: _strncpy_s+6Dj
.text:0040AA28		       mov     cl, [edx]
.text:0040AA2A		       mov     [eax], cl
.text:0040AA2C		       inc     eax
.text:0040AA2D		       inc     edx
.text:0040AA2E		       cmp     cl, bl
.text:0040AA30		       jz      short loc_40AA50
.text:0040AA32		       dec     edi
.text:0040AA33		       jnz     short loc_40AA28
.text:0040AA35		       jmp     short loc_40AA50
.text:0040AA37 ; ---------------------------------------------------------------------------
.text:0040AA37
.text:0040AA37 loc_40AA37:			       ; CODE XREF: _strncpy_s+60j
.text:0040AA37					       ; _strncpy_s+81j
.text:0040AA37		       mov     cl, [edx]
.text:0040AA39		       mov     [eax], cl
.text:0040AA3B		       inc     eax
.text:0040AA3C		       inc     edx
.text:0040AA3D		       cmp     cl, bl
.text:0040AA3F		       jz      short loc_40AA49
.text:0040AA41		       dec     edi
.text:0040AA42		       jz      short loc_40AA49
.text:0040AA44		       dec     [ebp+_Count]
.text:0040AA47		       jnz     short loc_40AA37
.text:0040AA49
.text:0040AA49 loc_40AA49:			       ; CODE XREF: _strncpy_s+79j
.text:0040AA49					       ; _strncpy_s+7Cj
.text:0040AA49		       cmp     [ebp+_Count], ebx
.text:0040AA4C		       jnz     short loc_40AA50
.text:0040AA4E		       mov     [eax], bl
.text:0040AA50
.text:0040AA50 loc_40AA50:			       ; CODE XREF: _strncpy_s+6Aj
.text:0040AA50					       ; _strncpy_s+6Fj ...
.text:0040AA50		       cmp     edi, ebx
.text:0040AA52		       jnz     short loc_40A9DF
.text:0040AA54		       cmp     [ebp+_Count], 0FFFFFFFFh
.text:0040AA58		       jnz     short loc_40AA69
.text:0040AA5A		       mov     eax, [ebp+_SizeInBytes]
.text:0040AA5D		       push    50h
.text:0040AA5F		       mov     [esi+eax-1], bl
.text:0040AA63		       pop     eax
.text:0040AA64		       jmp     loc_40A9E1
.text:0040AA69 ; ---------------------------------------------------------------------------
.text:0040AA69
.text:0040AA69 loc_40AA69:			       ; CODE XREF: _strncpy_s+92j
.text:0040AA69		       mov     [esi], bl
.text:0040AA6B		       call    __errno
.text:0040AA70		       push    22h
.text:0040AA72		       pop     ecx
.text:0040AA73		       mov     [eax], ecx
.text:0040AA75		       mov     esi, ecx
.text:0040AA77		       jmp     short loc_40A9FB
.text:0040AA77 _strncpy_s      endp
.text:0040AA77
.text:0040AA79
.text:0040AA79 ; =============== S U B R O U T I N E =======================================
.text:0040AA79
.text:0040AA79
.text:0040AA79 ; int __cdecl strcpy_s(char *_Dst, unsigned int _SizeInBytes, const char	*_Src)
.text:0040AA79 _strcpy_s       proc near	       ; CODE XREF: __NMSG_WRITE+6Cp
.text:0040AA79					       ; __NMSG_WRITE+AEp ...
.text:0040AA79
.text:0040AA79 _Dst	       = dword ptr  4
.text:0040AA79 _SizeInBytes    = dword ptr  8
.text:0040AA79 _Src	       = dword ptr  0Ch
.text:0040AA79
.text:0040AA79		       mov     ecx, [esp+_Dst]
.text:0040AA7D		       push    ebx
.text:0040AA7E		       xor     ebx, ebx
.text:0040AA80		       cmp     ecx, ebx
.text:0040AA82		       push    esi
.text:0040AA83		       push    edi
.text:0040AA84		       jz      short loc_40AA8E
.text:0040AA86		       mov     edi, [esp+0Ch+_SizeInBytes]
.text:0040AA8A		       cmp     edi, ebx
.text:0040AA8C		       ja      short loc_40AAA9
.text:0040AA8E
.text:0040AA8E loc_40AA8E:			       ; CODE XREF: _strcpy_s+Bj
.text:0040AA8E					       ; _strcpy_s+3Aj
.text:0040AA8E		       call    __errno
.text:0040AA93		       push    16h
.text:0040AA95		       pop     esi
.text:0040AA96		       mov     [eax], esi
.text:0040AA98
.text:0040AA98 loc_40AA98:			       ; CODE XREF: _strcpy_s+5Dj
.text:0040AA98		       push    ebx	       ; pReserved
.text:0040AA99		       push    ebx	       ; nLine
.text:0040AA9A		       push    ebx	       ; pszFile
.text:0040AA9B		       push    ebx	       ; pszFunction
.text:0040AA9C		       push    ebx	       ; pszExpression
.text:0040AA9D		       call    __invalid_parameter
.text:0040AAA2		       add     esp, 14h
.text:0040AAA5		       mov     eax, esi
.text:0040AAA7		       jmp     short loc_40AADA
.text:0040AAA9 ; ---------------------------------------------------------------------------
.text:0040AAA9
.text:0040AAA9 loc_40AAA9:			       ; CODE XREF: _strcpy_s+13j
.text:0040AAA9		       mov     esi, [esp+0Ch+_Src]
.text:0040AAAD		       cmp     esi, ebx
.text:0040AAAF		       jnz     short loc_40AAB5
.text:0040AAB1		       mov     [ecx], bl
.text:0040AAB3		       jmp     short loc_40AA8E
.text:0040AAB5 ; ---------------------------------------------------------------------------
.text:0040AAB5
.text:0040AAB5 loc_40AAB5:			       ; CODE XREF: _strcpy_s+36j
.text:0040AAB5		       mov     edx, ecx
.text:0040AAB7
.text:0040AAB7 loc_40AAB7:			       ; CODE XREF: _strcpy_s+49j
.text:0040AAB7		       mov     al, [esi]
.text:0040AAB9		       mov     [edx], al
.text:0040AABB		       inc     edx
.text:0040AABC		       inc     esi
.text:0040AABD		       cmp     al, bl
.text:0040AABF		       jz      short loc_40AAC4
.text:0040AAC1		       dec     edi
.text:0040AAC2		       jnz     short loc_40AAB7
.text:0040AAC4
.text:0040AAC4 loc_40AAC4:			       ; CODE XREF: _strcpy_s+46j
.text:0040AAC4		       cmp     edi, ebx
.text:0040AAC6		       jnz     short loc_40AAD8
.text:0040AAC8		       mov     [ecx], bl
.text:0040AACA		       call    __errno
.text:0040AACF		       push    22h
.text:0040AAD1		       pop     ecx
.text:0040AAD2		       mov     [eax], ecx
.text:0040AAD4		       mov     esi, ecx
.text:0040AAD6		       jmp     short loc_40AA98
.text:0040AAD8 ; ---------------------------------------------------------------------------
.text:0040AAD8
.text:0040AAD8 loc_40AAD8:			       ; CODE XREF: _strcpy_s+4Dj
.text:0040AAD8		       xor     eax, eax
.text:0040AADA
.text:0040AADA loc_40AADA:			       ; CODE XREF: _strcpy_s+2Ej
.text:0040AADA		       pop     edi
.text:0040AADB		       pop     esi
.text:0040AADC		       pop     ebx
.text:0040AADD		       retn
.text:0040AADD _strcpy_s       endp
.text:0040AADD
.text:0040AADE
.text:0040AADE ; =============== S U B R O U T I N E =======================================
.text:0040AADE
.text:0040AADE
.text:0040AADE ; int __cdecl _set_error_mode(int em)
.text:0040AADE __set_error_mode	proc near	       ; CODE XREF: __NMSG_WRITE+27p
.text:0040AADE					       ; __NMSG_WRITE+38p ...
.text:0040AADE
.text:0040AADE em	       = dword ptr  4
.text:0040AADE
.text:0040AADE		       mov     ecx, [esp+em]
.text:0040AAE2		       push    esi
.text:0040AAE3		       xor     esi, esi
.text:0040AAE5		       cmp     ecx, esi
.text:0040AAE7		       jl      short loc_40AB07
.text:0040AAE9		       cmp     ecx, 2
.text:0040AAEC		       jle     short loc_40AAFA
.text:0040AAEE		       cmp     ecx, 3
.text:0040AAF1		       jnz     short loc_40AB07
.text:0040AAF3		       mov     eax, ___error_mode
.text:0040AAF8		       pop     esi
.text:0040AAF9		       retn
.text:0040AAFA ; ---------------------------------------------------------------------------
.text:0040AAFA
.text:0040AAFA loc_40AAFA:			       ; CODE XREF: __set_error_mode+Ej
.text:0040AAFA		       mov     eax, ___error_mode
.text:0040AAFF		       mov     ___error_mode, ecx
.text:0040AB05		       pop     esi
.text:0040AB06		       retn
.text:0040AB07 ; ---------------------------------------------------------------------------
.text:0040AB07
.text:0040AB07 loc_40AB07:			       ; CODE XREF: __set_error_mode+9j
.text:0040AB07					       ; __set_error_mode+13j
.text:0040AB07		       call    __errno
.text:0040AB0C		       push    esi	       ; pReserved
.text:0040AB0D		       push    esi	       ; nLine
.text:0040AB0E		       push    esi	       ; pszFile
.text:0040AB0F		       push    esi	       ; pszFunction
.text:0040AB10		       push    esi	       ; pszExpression
.text:0040AB11		       mov     dword ptr [eax],	16h
.text:0040AB17		       call    __invalid_parameter
.text:0040AB1C		       add     esp, 14h
.text:0040AB1F		       or      eax, 0FFFFFFFFh
.text:0040AB22		       pop     esi
.text:0040AB23		       retn
.text:0040AB23 __set_error_mode	endp
.text:0040AB23
.text:0040AB24
.text:0040AB24 ; =============== S U B R O U T I N E =======================================
.text:0040AB24
.text:0040AB24
.text:0040AB24 ; void __cdecl __set_app_type(int at)
.text:0040AB24 ___set_app_type proc near
.text:0040AB24
.text:0040AB24 at	       = dword ptr  4
.text:0040AB24
.text:0040AB24		       mov     eax, [esp+at]
.text:0040AB28		       mov     ___app_type, eax
.text:0040AB2D		       retn
.text:0040AB2D ___set_app_type endp
.text:0040AB2D
.text:0040AB2E
.text:0040AB2E ; =============== S U B R O U T I N E =======================================
.text:0040AB2E
.text:0040AB2E
.text:0040AB2E ; int __cdecl __get_app_type()
.text:0040AB2E ___get_app_type proc near
.text:0040AB2E		       mov     eax, ___app_type
.text:0040AB33		       retn
.text:0040AB33 ___get_app_type endp
.text:0040AB33
.text:0040AB34
.text:0040AB34 ; =============== S U B R O U T I N E =======================================
.text:0040AB34
.text:0040AB34 ; Attributes: bp-based frame
.text:0040AB34
.text:0040AB34 ; unsigned int __cdecl _msize(void *pblock)
.text:0040AB34 __msize	       proc near	       ; CODE XREF: _onexit_nolock+3Ap
.text:0040AB34					       ; __recalloc+45p
.text:0040AB34
.text:0040AB34 pHeader	       = dword ptr -20h
.text:0040AB34 retval	       = dword ptr -1Ch
.text:0040AB34 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040AB34 pblock	       = dword ptr  8
.text:0040AB34
.text:0040AB34		       push    10h
.text:0040AB36		       push    offset dword_420818
.text:0040AB3B		       call    __SEH_prolog4
.text:0040AB40		       xor     eax, eax
.text:0040AB42		       mov     ebx, [ebp+pblock]
.text:0040AB45		       xor     edi, edi
.text:0040AB47		       cmp     ebx, edi
.text:0040AB49		       setnz   al
.text:0040AB4C		       cmp     eax, edi
.text:0040AB4E		       jnz     short loc_40AB6D
.text:0040AB50		       call    __errno
.text:0040AB55		       mov     dword ptr [eax],	16h
.text:0040AB5B		       push    edi	       ; pReserved
.text:0040AB5C		       push    edi	       ; nLine
.text:0040AB5D		       push    edi	       ; pszFile
.text:0040AB5E		       push    edi	       ; pszFunction
.text:0040AB5F		       push    edi	       ; pszExpression
.text:0040AB60		       call    __invalid_parameter
.text:0040AB65		       add     esp, 14h
.text:0040AB68		       or      eax, 0FFFFFFFFh
.text:0040AB6B		       jmp     short loc_40ABC0
.text:0040AB6D ; ---------------------------------------------------------------------------
.text:0040AB6D
.text:0040AB6D loc_40AB6D:			       ; CODE XREF: __msize+1Aj
.text:0040AB6D		       cmp     ___active_heap, 3
.text:0040AB74		       jnz     short loc_40ABAE
.text:0040AB76		       push    4	       ; locknum
.text:0040AB78		       call    __lock
.text:0040AB7D		       pop     ecx
.text:0040AB7E		       mov     [ebp+ms_exc.disabled], edi
.text:0040AB81		       push    ebx	       ; pvAlloc
.text:0040AB82		       call    ___sbh_find_block
.text:0040AB87		       pop     ecx
.text:0040AB88		       mov     [ebp+pHeader], eax
.text:0040AB8B		       cmp     eax, edi
.text:0040AB8D		       jz      short loc_40AB9A
.text:0040AB8F		       mov     esi, [ebx-4]
.text:0040AB92		       sub     esi, 9
.text:0040AB95		       mov     [ebp+retval], esi
.text:0040AB98		       jmp     short loc_40AB9D
.text:0040AB9A ; ---------------------------------------------------------------------------
.text:0040AB9A
.text:0040AB9A loc_40AB9A:			       ; CODE XREF: __msize+59j
.text:0040AB9A		       mov     esi, [ebp+retval]
.text:0040AB9D
.text:0040AB9D loc_40AB9D:			       ; CODE XREF: __msize+64j
.text:0040AB9D		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040ABA4		       call    $LN12_7
.text:0040ABA9
.text:0040ABA9 $LN13_4:
.text:0040ABA9		       cmp     [ebp+pHeader], edi
.text:0040ABAC		       jnz     short loc_40ABBE
.text:0040ABAE
.text:0040ABAE loc_40ABAE:			       ; CODE XREF: __msize+40j
.text:0040ABAE		       push    ebx	       ; lpMem
.text:0040ABAF		       push    edi	       ; dwFlags
.text:0040ABB0		       push    __crtheap       ; hHeap
.text:0040ABB6		       call    ds:__imp__HeapSize@12 ; HeapSize(x,x,x)
.text:0040ABBC		       mov     esi, eax
.text:0040ABBE
.text:0040ABBE loc_40ABBE:			       ; CODE XREF: __msize+78j
.text:0040ABBE		       mov     eax, esi
.text:0040ABC0
.text:0040ABC0 loc_40ABC0:			       ; CODE XREF: __msize+37j
.text:0040ABC0		       call    __SEH_epilog4
.text:0040ABC5		       retn
.text:0040ABC6 ; ---------------------------------------------------------------------------
.text:0040ABC6
.text:0040ABC6 $LN10_4:				       ; DATA XREF: .rdata:00420830o
.text:0040ABC6		       xor     edi, edi
.text:0040ABC8		       mov     ebx, [ebp+pblock]
.text:0040ABCB		       mov     esi, [ebp+retval]
.text:0040ABCE
.text:0040ABCE $LN12_7:				       ; CODE XREF: __msize+70p
.text:0040ABCE		       push    4	       ; locknum
.text:0040ABD0		       call    __unlock
.text:0040ABD5		       pop     ecx
.text:0040ABD6
.text:0040ABD6 $LN11_5:
.text:0040ABD6		       retn
.text:0040ABD6 __msize	       endp ; sp-analysis failed
.text:0040ABD6
.text:0040ABD7
.text:0040ABD7 ; =============== S U B R O U T I N E =======================================
.text:0040ABD7
.text:0040ABD7
.text:0040ABD7 __fptrap	       proc near	       ; DATA XREF: .data:__cfltcvt_tabo
.text:0040ABD7					       ; .data:00421674o ...
.text:0040ABD7		       push    2	       ; rterrnum
.text:0040ABD9		       call    __amsg_exit
.text:0040ABDE		       pop     ecx
.text:0040ABDF		       retn
.text:0040ABDF __fptrap	       endp
.text:0040ABDF
.text:0040ABE0
.text:0040ABE0 ; =============== S U B R O U T I N E =======================================
.text:0040ABE0
.text:0040ABE0 ; Attributes: noreturn bp-based frame fpd=2A8h
.text:0040ABE0
.text:0040ABE0 ; void __cdecl abort()
.text:0040ABE0 _abort	       proc near	       ; CODE XREF: terminate(void):loc_403FD9p
.text:0040ABE0
.text:0040ABE0 ExceptionRecord = _EXCEPTION_RECORD ptr -328h
.text:0040ABE0 ExceptionPointers= _EXCEPTION_POINTERS ptr -2D8h
.text:0040ABE0 ContextRecord   = _CONTEXT ptr -2D0h
.text:0040ABE0 var_4	       = dword ptr -4
.text:0040ABE0
.text:0040ABE0		       push    ebp
.text:0040ABE1		       lea     ebp, [esp-2A8h]
.text:0040ABE8		       sub     esp, 328h
.text:0040ABEE		       mov     eax, ___security_cookie
.text:0040ABF3		       xor     eax, ebp
.text:0040ABF5		       mov     [ebp+2A8h+var_4], eax
.text:0040ABFB		       test    byte ptr	___abort_behavior, 1
.text:0040AC02		       push    esi
.text:0040AC03		       jz      short loc_40AC0D
.text:0040AC05		       push    0Ah	       ; rterrnum
.text:0040AC07		       call    __NMSG_WRITE
.text:0040AC0C		       pop     ecx
.text:0040AC0D
.text:0040AC0D loc_40AC0D:			       ; CODE XREF: _abort+23j
.text:0040AC0D		       call    ___get_sigabrt
.text:0040AC12		       test    eax, eax
.text:0040AC14		       jz      short loc_40AC1E
.text:0040AC16		       push    16h	       ; signum
.text:0040AC18		       call    _raise
.text:0040AC1D		       pop     ecx
.text:0040AC1E
.text:0040AC1E loc_40AC1E:			       ; CODE XREF: _abort+34j
.text:0040AC1E		       test    byte ptr	___abort_behavior, 2
.text:0040AC25		       jz      loc_40ACCB
.text:0040AC2B		       mov     [ebp+2A8h+ContextRecord._Eax], eax
.text:0040AC31		       mov     [ebp+2A8h+ContextRecord._Ecx], ecx
.text:0040AC37		       mov     [ebp+2A8h+ContextRecord._Edx], edx
.text:0040AC3D		       mov     [ebp+2A8h+ContextRecord._Ebx], ebx
.text:0040AC40		       mov     [ebp+2A8h+ContextRecord._Esi], esi
.text:0040AC43		       mov     [ebp+2A8h+ContextRecord._Edi], edi
.text:0040AC46		       mov     word ptr	[ebp+2A8h+ContextRecord.SegSs],	ss
.text:0040AC4D		       mov     word ptr	[ebp+2A8h+ContextRecord.SegCs],	cs
.text:0040AC54		       mov     word ptr	[ebp+2A8h+ContextRecord.SegDs],	ds
.text:0040AC58		       mov     word ptr	[ebp+2A8h+ContextRecord.SegEs],	es
.text:0040AC5C		       mov     word ptr	[ebp+2A8h+ContextRecord.SegFs],	fs
.text:0040AC60		       mov     word ptr	[ebp+2A8h+ContextRecord.SegGs],	gs
.text:0040AC64		       pushf
.text:0040AC65		       pop     [ebp+2A8h+ContextRecord.EFlags]
.text:0040AC6B		       mov     esi, [ebp+2ACh]
.text:0040AC71		       lea     eax, [ebp+2ACh]
.text:0040AC77		       mov     [ebp+2A8h+ContextRecord._Esp], eax
.text:0040AC7D		       mov     [ebp+2A8h+ContextRecord.ContextFlags], 10001h
.text:0040AC84		       mov     [ebp+2A8h+ContextRecord._Eip], esi
.text:0040AC8A		       mov     eax, [eax-4]
.text:0040AC8D		       push    50h	       ; count
.text:0040AC8F		       mov     [ebp+2A8h+ContextRecord._Ebp], eax
.text:0040AC95		       lea     eax, [ebp+2A8h+ExceptionRecord]
.text:0040AC98		       push    0	       ; value
.text:0040AC9A		       push    eax	       ; dst
.text:0040AC9B		       call    _memset
.text:0040ACA0		       lea     eax, [ebp+2A8h+ExceptionRecord]
.text:0040ACA3		       add     esp, 0Ch
.text:0040ACA6		       mov     [ebp+2A8h+ExceptionPointers.ExceptionRecord], eax
.text:0040ACA9		       lea     eax, [ebp+2A8h+ContextRecord]
.text:0040ACAC		       push    0	       ; lpTopLevelExceptionFilter
.text:0040ACAE		       mov     [ebp+2A8h+ExceptionRecord.ExceptionCode], 40000015h
.text:0040ACB5		       mov     [ebp+2A8h+ExceptionRecord.ExceptionAddress], esi
.text:0040ACB8		       mov     [ebp+2A8h+ExceptionPointers.ContextRecord], eax
.text:0040ACBB		       call    ds:__imp__SetUnhandledExceptionFilter@4 ; SetUnhandledExceptionFilter(x)
.text:0040ACC1		       lea     eax, [ebp+2A8h+ExceptionPointers]
.text:0040ACC4		       push    eax	       ; ExceptionInfo
.text:0040ACC5		       call    ds:__imp__UnhandledExceptionFilter@4 ; UnhandledExceptionFilter(x)
.text:0040ACCB
.text:0040ACCB loc_40ACCB:			       ; CODE XREF: _abort+45j
.text:0040ACCB		       push    3	       ; code
.text:0040ACCD		       call    __exit
.text:0040ACCD ; ---------------------------------------------------------------------------
.text:0040ACD2 $LN7_7	       db 0CCh
.text:0040ACD2 _abort	       endp
.text:0040ACD2
.text:0040ACD3
.text:0040ACD3 ; =============== S U B R O U T I N E =======================================
.text:0040ACD3
.text:0040ACD3
.text:0040ACD3 ; unsigned int __cdecl _set_abort_behavior(unsigned int flags, unsigned int mask)
.text:0040ACD3 __set_abort_behavior proc near
.text:0040ACD3
.text:0040ACD3 flags	       = dword ptr  4
.text:0040ACD3 mask	       = dword ptr  8
.text:0040ACD3
.text:0040ACD3		       mov     ecx, [esp+mask]
.text:0040ACD7		       mov     eax, ___abort_behavior
.text:0040ACDC		       mov     edx, [esp+flags]
.text:0040ACE0		       and     edx, [esp+mask]
.text:0040ACE4		       not     ecx
.text:0040ACE6		       and     ecx, eax
.text:0040ACE8		       or      ecx, edx
.text:0040ACEA		       mov     ___abort_behavior, ecx
.text:0040ACF0		       retn
.text:0040ACF0 __set_abort_behavior endp
.text:0040ACF0
.text:0040ACF0 ; ---------------------------------------------------------------------------
.text:0040ACF1		       align 10h
.text:0040AD00
.text:0040AD00 ; =============== S U B R O U T I N E =======================================
.text:0040AD00
.text:0040AD00 ; Attributes: bp-based frame
.text:0040AD00
.text:0040AD00 ; void __cdecl memcpy(char *dst,	char *src, unsigned int	count)
.text:0040AD00 _memcpy	       proc near	       ; CODE XREF: _signal+A2p
.text:0040AD00					       ; ___crtGetEnvironmentStringsA+11Dp ...
.text:0040AD00
.text:0040AD00 dst	       = dword ptr  8
.text:0040AD00 src	       = dword ptr  0Ch
.text:0040AD00 count	       = dword ptr  10h
.text:0040AD00
.text:0040AD00		       push    ebp
.text:0040AD01		       mov     ebp, esp
.text:0040AD03		       push    edi
.text:0040AD04		       push    esi
.text:0040AD05		       mov     esi, [ebp+src]
.text:0040AD08		       mov     ecx, [ebp+count]
.text:0040AD0B		       mov     edi, [ebp+dst]
.text:0040AD0E		       mov     eax, ecx
.text:0040AD10		       mov     edx, ecx
.text:0040AD12		       add     eax, esi
.text:0040AD14		       cmp     edi, esi
.text:0040AD16		       jbe     short CopyUp
.text:0040AD18		       cmp     edi, eax
.text:0040AD1A		       jb      CopyDown
.text:0040AD20
.text:0040AD20 CopyUp:				       ; CODE XREF: _memcpy+16j
.text:0040AD20		       cmp     ecx, 100h
.text:0040AD26		       jb      short Dword_align
.text:0040AD28		       cmp     ___sse2_available, 0
.text:0040AD2F		       jz      short Dword_align
.text:0040AD31		       push    edi
.text:0040AD32		       push    esi
.text:0040AD33		       and     edi, 0Fh
.text:0040AD36		       and     esi, 0Fh
.text:0040AD39		       cmp     edi, esi
.text:0040AD3B		       pop     esi
.text:0040AD3C		       pop     edi
.text:0040AD3D		       jnz     short Dword_align
.text:0040AD3F		       pop     esi
.text:0040AD40		       pop     edi
.text:0040AD41		       pop     ebp
.text:0040AD42		       jmp     __VEC_memcpy
.text:0040AD47 ; ---------------------------------------------------------------------------
.text:0040AD47
.text:0040AD47 Dword_align:			       ; CODE XREF: _memcpy+26j
.text:0040AD47					       ; _memcpy+2Fj ...
.text:0040AD47		       test    edi, 3
.text:0040AD4D		       jnz     short CopyLeadUp
.text:0040AD4F		       shr     ecx, 2
.text:0040AD52		       and     edx, 3
.text:0040AD55		       cmp     ecx, 8
.text:0040AD58		       jb      short CopyUnwindUp
.text:0040AD5A		       rep movsd
.text:0040AD5C		       jmp     ds:TrailUpVec[edx*4]
.text:0040AD5C ; ---------------------------------------------------------------------------
.text:0040AD63		       align 4
.text:0040AD64
.text:0040AD64 CopyLeadUp:			       ; CODE XREF: _memcpy+4Dj
.text:0040AD64		       mov     eax, edi
.text:0040AD66		       mov     edx, 3
.text:0040AD6B		       sub     ecx, 4
.text:0040AD6E		       jb      short ByteCopyUp
.text:0040AD70		       and     eax, 3
.text:0040AD73		       add     ecx, eax
.text:0040AD75		       jmp     dword ptr ds:CopyUnwindUp+4[eax*4]
.text:0040AD7C ; ---------------------------------------------------------------------------
.text:0040AD7C
.text:0040AD7C ByteCopyUp:			       ; CODE XREF: _memcpy+6Ej
.text:0040AD7C		       jmp     ds:TrailUp0[ecx*4]
.text:0040AD7C ; ---------------------------------------------------------------------------
.text:0040AD83		       align 4
.text:0040AD84
.text:0040AD84 CopyUnwindUp:			       ; CODE XREF: _memcpy+58j
.text:0040AD84					       ; _memcpy+B6j ...
.text:0040AD84		       jmp     ds:UnwindUpVec[ecx*4]
.text:0040AD84 ; ---------------------------------------------------------------------------
.text:0040AD8B		       align 4
.text:0040AD8C ; unsigned int LeadUpVec
.text:0040AD8C LeadUpVec       dd offset LeadUp1
.text:0040AD90		       dd offset LeadUp2
.text:0040AD94		       dd offset LeadUp3
.text:0040AD98 ; ---------------------------------------------------------------------------
.text:0040AD98
.text:0040AD98 LeadUp1:				       ; DATA XREF: _memcpy:LeadUpVeco
.text:0040AD98		       and     edx, ecx
.text:0040AD9A		       mov     al, [esi]
.text:0040AD9C		       mov     [edi], al
.text:0040AD9E		       mov     al, [esi+1]
.text:0040ADA1		       mov     [edi+1],	al
.text:0040ADA4		       mov     al, [esi+2]
.text:0040ADA7		       shr     ecx, 2
.text:0040ADAA		       mov     [edi+2],	al
.text:0040ADAD		       add     esi, 3
.text:0040ADB0		       add     edi, 3
.text:0040ADB3		       cmp     ecx, 8
.text:0040ADB6		       jb      short CopyUnwindUp
.text:0040ADB8		       rep movsd
.text:0040ADBA		       jmp     ds:TrailUpVec[edx*4]
.text:0040ADBA ; ---------------------------------------------------------------------------
.text:0040ADC1		       align 4
.text:0040ADC4
.text:0040ADC4 LeadUp2:				       ; DATA XREF: _memcpy+90o
.text:0040ADC4		       and     edx, ecx
.text:0040ADC6		       mov     al, [esi]
.text:0040ADC8		       mov     [edi], al
.text:0040ADCA		       mov     al, [esi+1]
.text:0040ADCD		       shr     ecx, 2
.text:0040ADD0		       mov     [edi+1],	al
.text:0040ADD3		       add     esi, 2
.text:0040ADD6		       add     edi, 2
.text:0040ADD9		       cmp     ecx, 8
.text:0040ADDC		       jb      short CopyUnwindUp
.text:0040ADDE		       rep movsd
.text:0040ADE0		       jmp     ds:TrailUpVec[edx*4]
.text:0040ADE0 ; ---------------------------------------------------------------------------
.text:0040ADE7		       align 4
.text:0040ADE8
.text:0040ADE8 LeadUp3:				       ; DATA XREF: _memcpy+94o
.text:0040ADE8		       and     edx, ecx
.text:0040ADEA		       mov     al, [esi]
.text:0040ADEC		       mov     [edi], al
.text:0040ADEE		       add     esi, 1
.text:0040ADF1		       shr     ecx, 2
.text:0040ADF4		       add     edi, 1
.text:0040ADF7		       cmp     ecx, 8
.text:0040ADFA		       jb      short CopyUnwindUp
.text:0040ADFC		       rep movsd
.text:0040ADFE		       jmp     ds:TrailUpVec[edx*4]
.text:0040ADFE ; ---------------------------------------------------------------------------
.text:0040AE05		       align 4
.text:0040AE08 ; unsigned int UnwindUpVec
.text:0040AE08 UnwindUpVec     dd offset UnwindUp0     ; DATA XREF: _memcpy:CopyUnwindUpr
.text:0040AE0C		       dd offset UnwindUp1
.text:0040AE10		       dd offset UnwindUp2
.text:0040AE14		       dd offset UnwindUp3
.text:0040AE18		       dd offset UnwindUp4
.text:0040AE1C		       dd offset UnwindUp5
.text:0040AE20		       dd offset UnwindUp6
.text:0040AE24		       dd offset UnwindUp7
.text:0040AE28 ; ---------------------------------------------------------------------------
.text:0040AE28
.text:0040AE28 UnwindUp7:			       ; CODE XREF: _memcpy:CopyUnwindUpj
.text:0040AE28					       ; DATA XREF: _memcpy+124o
.text:0040AE28		       mov     eax, [esi+ecx*4-1Ch]
.text:0040AE2C		       mov     [edi+ecx*4-1Ch],	eax
.text:0040AE30
.text:0040AE30 UnwindUp6:			       ; CODE XREF: _memcpy:CopyUnwindUpj
.text:0040AE30					       ; DATA XREF: _memcpy+120o
.text:0040AE30		       mov     eax, [esi+ecx*4-18h]
.text:0040AE34		       mov     [edi+ecx*4-18h],	eax
.text:0040AE38
.text:0040AE38 UnwindUp5:			       ; CODE XREF: _memcpy:CopyUnwindUpj
.text:0040AE38					       ; DATA XREF: _memcpy+11Co
.text:0040AE38		       mov     eax, [esi+ecx*4-14h]
.text:0040AE3C		       mov     [edi+ecx*4-14h],	eax
.text:0040AE40
.text:0040AE40 UnwindUp4:			       ; CODE XREF: _memcpy:CopyUnwindUpj
.text:0040AE40					       ; DATA XREF: _memcpy+118o
.text:0040AE40		       mov     eax, [esi+ecx*4-10h]
.text:0040AE44		       mov     [edi+ecx*4-10h],	eax
.text:0040AE48
.text:0040AE48 UnwindUp3:			       ; CODE XREF: _memcpy:CopyUnwindUpj
.text:0040AE48					       ; DATA XREF: _memcpy+114o
.text:0040AE48		       mov     eax, [esi+ecx*4-0Ch]
.text:0040AE4C		       mov     [edi+ecx*4-0Ch],	eax
.text:0040AE50
.text:0040AE50 UnwindUp2:			       ; CODE XREF: _memcpy:CopyUnwindUpj
.text:0040AE50					       ; DATA XREF: _memcpy+110o
.text:0040AE50		       mov     eax, [esi+ecx*4-8]
.text:0040AE54		       mov     [edi+ecx*4-8], eax
.text:0040AE58
.text:0040AE58 UnwindUp1:			       ; CODE XREF: _memcpy:CopyUnwindUpj
.text:0040AE58					       ; DATA XREF: _memcpy+10Co
.text:0040AE58		       mov     eax, [esi+ecx*4-4]
.text:0040AE5C		       mov     [edi+ecx*4-4], eax
.text:0040AE60		       lea     eax, ds:0[ecx*4]
.text:0040AE67		       add     esi, eax
.text:0040AE69		       add     edi, eax
.text:0040AE6B
.text:0040AE6B UnwindUp0:			       ; CODE XREF: _memcpy:CopyUnwindUpj
.text:0040AE6B					       ; DATA XREF: _memcpy:UnwindUpVeco
.text:0040AE6B		       jmp     ds:TrailUpVec[edx*4]
.text:0040AE6B ; ---------------------------------------------------------------------------
.text:0040AE72		       align 4
.text:0040AE74 ; unsigned int TrailUpVec
.text:0040AE74 TrailUpVec      dd offset TrailUp0      ; DATA XREF: _memcpy+5Cr
.text:0040AE74					       ; _memcpy+BAr ...
.text:0040AE78		       dd offset TrailUp1
.text:0040AE7C		       dd offset TrailUp2
.text:0040AE80		       dd offset TrailUp3
.text:0040AE84 TrailUp0	       dd 5E08458Bh	       ; CODE XREF: _memcpy+5Cj
.text:0040AE84					       ; DATA XREF: _memcpy:ByteCopyUpr ...
.text:0040AE88 ; ---------------------------------------------------------------------------
.text:0040AE88		       pop     edi
.text:0040AE89		       leave
.text:0040AE8A		       retn
.text:0040AE8A ; ---------------------------------------------------------------------------
.text:0040AE8B		       align 4
.text:0040AE8C
.text:0040AE8C TrailUp1:			       ; CODE XREF: _memcpy+5Cj
.text:0040AE8C					       ; DATA XREF: _memcpy+178o
.text:0040AE8C		       mov     al, [esi]
.text:0040AE8E		       mov     [edi], al
.text:0040AE90		       mov     eax, [ebp+dst]
.text:0040AE93		       pop     esi
.text:0040AE94		       pop     edi
.text:0040AE95		       leave
.text:0040AE96		       retn
.text:0040AE96 ; ---------------------------------------------------------------------------
.text:0040AE97		       align 4
.text:0040AE98
.text:0040AE98 TrailUp2:			       ; CODE XREF: _memcpy+5Cj
.text:0040AE98					       ; DATA XREF: _memcpy+17Co
.text:0040AE98		       mov     al, [esi]
.text:0040AE9A		       mov     [edi], al
.text:0040AE9C		       mov     al, [esi+1]
.text:0040AE9F		       mov     [edi+1],	al
.text:0040AEA2		       mov     eax, [ebp+dst]
.text:0040AEA5		       pop     esi
.text:0040AEA6		       pop     edi
.text:0040AEA7		       leave
.text:0040AEA8		       retn
.text:0040AEA8 ; ---------------------------------------------------------------------------
.text:0040AEA9		       align 4
.text:0040AEAC
.text:0040AEAC TrailUp3:			       ; CODE XREF: _memcpy+5Cj
.text:0040AEAC					       ; DATA XREF: _memcpy+180o
.text:0040AEAC		       mov     al, [esi]
.text:0040AEAE		       mov     [edi], al
.text:0040AEB0		       mov     al, [esi+1]
.text:0040AEB3		       mov     [edi+1],	al
.text:0040AEB6		       mov     al, [esi+2]
.text:0040AEB9		       mov     [edi+2],	al
.text:0040AEBC		       mov     eax, [ebp+dst]
.text:0040AEBF		       pop     esi
.text:0040AEC0		       pop     edi
.text:0040AEC1		       leave
.text:0040AEC2		       retn
.text:0040AEC2 ; ---------------------------------------------------------------------------
.text:0040AEC3		       align 4
.text:0040AEC4
.text:0040AEC4 CopyDown:			       ; CODE XREF: _memcpy+1Aj
.text:0040AEC4		       lea     esi, [ecx+esi-4]
.text:0040AEC8		       lea     edi, [ecx+edi-4]
.text:0040AECC		       test    edi, 3
.text:0040AED2		       jnz     short CopyLeadDown
.text:0040AED4		       shr     ecx, 2
.text:0040AED7		       and     edx, 3
.text:0040AEDA		       cmp     ecx, 8
.text:0040AEDD		       jb      short CopyUnwindDown
.text:0040AEDF		       std
.text:0040AEE0		       rep movsd
.text:0040AEE2		       cld
.text:0040AEE3		       jmp     ds:TrailDownVec[edx*4]
.text:0040AEE3 ; ---------------------------------------------------------------------------
.text:0040AEEA		       align 4
.text:0040AEEC
.text:0040AEEC CopyUnwindDown:			       ; CODE XREF: _memcpy+1DDj
.text:0040AEEC					       ; _memcpy+238j ...
.text:0040AEEC		       neg     ecx
.text:0040AEEE		       jmp     ds:off_40AFC0[ecx*4]
.text:0040AEEE ; ---------------------------------------------------------------------------
.text:0040AEF5		       align 4
.text:0040AEF8
.text:0040AEF8 CopyLeadDown:			       ; CODE XREF: _memcpy+1D2j
.text:0040AEF8		       mov     eax, edi
.text:0040AEFA		       mov     edx, 3
.text:0040AEFF		       cmp     ecx, 4
.text:0040AF02		       jb      short ByteCopyDown
.text:0040AF04		       and     eax, 3
.text:0040AF07		       sub     ecx, eax
.text:0040AF09		       jmp     dword ptr ds:ByteCopyDown+4[eax*4]
.text:0040AF10 ; ---------------------------------------------------------------------------
.text:0040AF10
.text:0040AF10 ByteCopyDown:			       ; CODE XREF: _memcpy+202j
.text:0040AF10					       ; DATA XREF: _memcpy+209r
.text:0040AF10		       jmp     ds:TrailDownVec[ecx*4]
.text:0040AF10 ; ---------------------------------------------------------------------------
.text:0040AF17		       align 4
.text:0040AF18 ; unsigned int LeadDownVec
.text:0040AF18 LeadDownVec     dd offset LeadDown1
.text:0040AF1C		       dd offset LeadDown2
.text:0040AF20		       dd offset LeadDown3
.text:0040AF24 ; ---------------------------------------------------------------------------
.text:0040AF24
.text:0040AF24 LeadDown1:			       ; DATA XREF: _memcpy:LeadDownVeco
.text:0040AF24		       mov     al, [esi+3]
.text:0040AF27		       and     edx, ecx
.text:0040AF29		       mov     [edi+3],	al
.text:0040AF2C		       sub     esi, 1
.text:0040AF2F		       shr     ecx, 2
.text:0040AF32		       sub     edi, 1
.text:0040AF35		       cmp     ecx, 8
.text:0040AF38		       jb      short CopyUnwindDown
.text:0040AF3A		       std
.text:0040AF3B		       rep movsd
.text:0040AF3D		       cld
.text:0040AF3E		       jmp     ds:TrailDownVec[edx*4]
.text:0040AF3E ; ---------------------------------------------------------------------------
.text:0040AF45		       align 4
.text:0040AF48
.text:0040AF48 LeadDown2:			       ; DATA XREF: _memcpy+21Co
.text:0040AF48		       mov     al, [esi+3]
.text:0040AF4B		       and     edx, ecx
.text:0040AF4D		       mov     [edi+3],	al
.text:0040AF50		       mov     al, [esi+2]
.text:0040AF53		       shr     ecx, 2
.text:0040AF56		       mov     [edi+2],	al
.text:0040AF59		       sub     esi, 2
.text:0040AF5C		       sub     edi, 2
.text:0040AF5F		       cmp     ecx, 8
.text:0040AF62		       jb      short CopyUnwindDown
.text:0040AF64		       std
.text:0040AF65		       rep movsd
.text:0040AF67		       cld
.text:0040AF68		       jmp     ds:TrailDownVec[edx*4]
.text:0040AF68 ; ---------------------------------------------------------------------------
.text:0040AF6F		       align 10h
.text:0040AF70
.text:0040AF70 LeadDown3:			       ; DATA XREF: _memcpy+220o
.text:0040AF70		       mov     al, [esi+3]
.text:0040AF73		       and     edx, ecx
.text:0040AF75		       mov     [edi+3],	al
.text:0040AF78		       mov     al, [esi+2]
.text:0040AF7B		       mov     [edi+2],	al
.text:0040AF7E		       mov     al, [esi+1]
.text:0040AF81		       shr     ecx, 2
.text:0040AF84		       mov     [edi+1],	al
.text:0040AF87		       sub     esi, 3
.text:0040AF8A		       sub     edi, 3
.text:0040AF8D		       cmp     ecx, 8
.text:0040AF90		       jb      CopyUnwindDown
.text:0040AF96		       std
.text:0040AF97		       rep movsd
.text:0040AF99		       cld
.text:0040AF9A		       jmp     ds:TrailDownVec[edx*4]
.text:0040AF9A ; ---------------------------------------------------------------------------
.text:0040AFA1		       align 4
.text:0040AFA4 ; unsigned int UnwindDownVec
.text:0040AFA4 UnwindDownVec   dd offset UnwindDown7
.text:0040AFA8		       dd offset UnwindDown6
.text:0040AFAC		       dd offset UnwindDown5
.text:0040AFB0		       dd offset UnwindDown4
.text:0040AFB4		       dd offset UnwindDown3
.text:0040AFB8		       dd offset UnwindDown2
.text:0040AFBC		       dd offset UnwindDown1
.text:0040AFC0 off_40AFC0      dd offset UnwindDown0   ; DATA XREF: _memcpy+1EEr
.text:0040AFC4 ; ---------------------------------------------------------------------------
.text:0040AFC4
.text:0040AFC4 UnwindDown7:			       ; DATA XREF: _memcpy:UnwindDownVeco
.text:0040AFC4		       mov     eax, [esi+ecx*4+1Ch]
.text:0040AFC8		       mov     [edi+ecx*4+1Ch],	eax
.text:0040AFCC
.text:0040AFCC UnwindDown6:			       ; DATA XREF: _memcpy+2A8o
.text:0040AFCC		       mov     eax, [esi+ecx*4+18h]
.text:0040AFD0		       mov     [edi+ecx*4+18h],	eax
.text:0040AFD4
.text:0040AFD4 UnwindDown5:			       ; DATA XREF: _memcpy+2ACo
.text:0040AFD4		       mov     eax, [esi+ecx*4+14h]
.text:0040AFD8		       mov     [edi+ecx*4+14h],	eax
.text:0040AFDC
.text:0040AFDC UnwindDown4:			       ; DATA XREF: _memcpy+2B0o
.text:0040AFDC		       mov     eax, [esi+ecx*4+10h]
.text:0040AFE0		       mov     [edi+ecx*4+10h],	eax
.text:0040AFE4
.text:0040AFE4 UnwindDown3:			       ; DATA XREF: _memcpy+2B4o
.text:0040AFE4		       mov     eax, [esi+ecx*4+0Ch]
.text:0040AFE8		       mov     [edi+ecx*4+0Ch],	eax
.text:0040AFEC
.text:0040AFEC UnwindDown2:			       ; DATA XREF: _memcpy+2B8o
.text:0040AFEC		       mov     eax, [esi+ecx*4+8]
.text:0040AFF0		       mov     [edi+ecx*4+8], eax
.text:0040AFF4
.text:0040AFF4 UnwindDown1:			       ; DATA XREF: _memcpy+2BCo
.text:0040AFF4		       mov     eax, [esi+ecx*4+4]
.text:0040AFF8		       mov     [edi+ecx*4+4], eax
.text:0040AFFC		       lea     eax, ds:0[ecx*4]
.text:0040B003		       add     esi, eax
.text:0040B005		       add     edi, eax
.text:0040B007
.text:0040B007 UnwindDown0:			       ; CODE XREF: _memcpy+1EEj
.text:0040B007					       ; DATA XREF: _memcpy:off_40AFC0o
.text:0040B007		       jmp     ds:TrailDownVec[edx*4]
.text:0040B007 ; ---------------------------------------------------------------------------
.text:0040B00E		       align 10h
.text:0040B010 ; unsigned int TrailDownVec
.text:0040B010 TrailDownVec    dd offset TrailDown0    ; DATA XREF: _memcpy+1E3r
.text:0040B010					       ; _memcpy:ByteCopyDownr	...
.text:0040B014		       dd offset TrailDown1
.text:0040B018		       dd offset TrailDown2
.text:0040B01C		       dd offset TrailDown3
.text:0040B020 ; ---------------------------------------------------------------------------
.text:0040B020
.text:0040B020 TrailDown0:			       ; CODE XREF: _memcpy+1E3j
.text:0040B020					       ; _memcpy:ByteCopyDownj	...
.text:0040B020		       mov     eax, [ebp+dst]
.text:0040B023		       pop     esi
.text:0040B024		       pop     edi
.text:0040B025		       leave
.text:0040B026		       retn
.text:0040B026 ; ---------------------------------------------------------------------------
.text:0040B027		       align 4
.text:0040B028
.text:0040B028 TrailDown1:			       ; CODE XREF: _memcpy+1E3j
.text:0040B028					       ; _memcpy:ByteCopyDownj	...
.text:0040B028		       mov     al, [esi+3]
.text:0040B02B		       mov     [edi+3],	al
.text:0040B02E		       mov     eax, [ebp+dst]
.text:0040B031		       pop     esi
.text:0040B032		       pop     edi
.text:0040B033		       leave
.text:0040B034		       retn
.text:0040B034 ; ---------------------------------------------------------------------------
.text:0040B035		       align 4
.text:0040B038
.text:0040B038 TrailDown2:			       ; CODE XREF: _memcpy+1E3j
.text:0040B038					       ; _memcpy:ByteCopyDownj	...
.text:0040B038		       mov     al, [esi+3]
.text:0040B03B		       mov     [edi+3],	al
.text:0040B03E		       mov     al, [esi+2]
.text:0040B041		       mov     [edi+2],	al
.text:0040B044		       mov     eax, [ebp+dst]
.text:0040B047		       pop     esi
.text:0040B048		       pop     edi
.text:0040B049		       leave
.text:0040B04A		       retn
.text:0040B04A ; ---------------------------------------------------------------------------
.text:0040B04B		       align 4
.text:0040B04C
.text:0040B04C TrailDown3:			       ; CODE XREF: _memcpy+1E3j
.text:0040B04C					       ; _memcpy:ByteCopyDownj	...
.text:0040B04C		       mov     al, [esi+3]
.text:0040B04F		       mov     [edi+3],	al
.text:0040B052		       mov     al, [esi+2]
.text:0040B055		       mov     [edi+2],	al
.text:0040B058		       mov     al, [esi+1]
.text:0040B05B		       mov     [edi+1],	al
.text:0040B05E		       mov     eax, [ebp+dst]
.text:0040B061		       pop     esi
.text:0040B062		       pop     edi
.text:0040B063		       leave
.text:0040B064		       retn
.text:0040B064 _memcpy	       endp
.text:0040B064
.text:0040B065
.text:0040B065 ; =============== S U B R O U T I N E =======================================
.text:0040B065
.text:0040B065 ; Attributes: bp-based frame
.text:0040B065
.text:0040B065 ; int __cdecl _isalpha_l(int c, localeinfo_struct *plocinfo)
.text:0040B065 __isalpha_l     proc near	       ; CODE XREF: _isalpha+23p
.text:0040B065					       ; __iscsymf_l+8p
.text:0040B065
.text:0040B065 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B065 c	       = dword ptr  8
.text:0040B065 plocinfo	       = dword ptr  0Ch
.text:0040B065
.text:0040B065		       push    ebp
.text:0040B066		       mov     ebp, esp
.text:0040B068		       sub     esp, 10h
.text:0040B06B		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B06E		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B071		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B076		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B079		       cmp     dword ptr [eax+0ACh], 1
.text:0040B080		       jle     short loc_40B098
.text:0040B082		       lea     eax, [ebp+_loc_update]
.text:0040B085		       push    eax	       ; plocinfo
.text:0040B086		       push    103h	       ; mask
.text:0040B08B		       push    [ebp+c]	       ; c
.text:0040B08E		       call    __isctype_l
.text:0040B093		       add     esp, 0Ch
.text:0040B096		       jmp     short loc_40B0AA
.text:0040B098 ; ---------------------------------------------------------------------------
.text:0040B098
.text:0040B098 loc_40B098:			       ; CODE XREF: __isalpha_l+1Bj
.text:0040B098		       mov     eax, [eax+0C8h]
.text:0040B09E		       mov     ecx, [ebp+c]
.text:0040B0A1		       movzx   eax, word ptr [eax+ecx*2]
.text:0040B0A5		       and     eax, 103h
.text:0040B0AA
.text:0040B0AA loc_40B0AA:			       ; CODE XREF: __isalpha_l+31j
.text:0040B0AA		       cmp     [ebp+_loc_update.updated], 0
.text:0040B0AE		       jz      short locret_40B0B7
.text:0040B0B0		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B0B3		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B0B7
.text:0040B0B7 locret_40B0B7:			       ; CODE XREF: __isalpha_l+49j
.text:0040B0B7		       leave
.text:0040B0B8		       retn
.text:0040B0B8 __isalpha_l     endp
.text:0040B0B8
.text:0040B0B9
.text:0040B0B9 ; =============== S U B R O U T I N E =======================================
.text:0040B0B9
.text:0040B0B9
.text:0040B0B9 ; int __cdecl isalpha(int c)
.text:0040B0B9 _isalpha	       proc near	       ; CODE XREF: ___iscsymf+4p
.text:0040B0B9
.text:0040B0B9 c	       = dword ptr  4
.text:0040B0B9
.text:0040B0B9		       cmp     ___locale_changed, 0
.text:0040B0C0		       jnz     short loc_40B0D6
.text:0040B0C2		       mov     eax, [esp+c]
.text:0040B0C6		       mov     ecx, ___initiallocinfo.pctype
.text:0040B0CC		       movzx   eax, word ptr [ecx+eax*2]
.text:0040B0D0		       and     eax, 103h
.text:0040B0D5		       retn
.text:0040B0D6 ; ---------------------------------------------------------------------------
.text:0040B0D6
.text:0040B0D6 loc_40B0D6:			       ; CODE XREF: _isalpha+7j
.text:0040B0D6		       push    0	       ; plocinfo
.text:0040B0D8		       push    [esp+4+c]       ; c
.text:0040B0DC		       call    __isalpha_l
.text:0040B0E1		       pop     ecx
.text:0040B0E2		       pop     ecx
.text:0040B0E3		       retn
.text:0040B0E3 _isalpha	       endp
.text:0040B0E3
.text:0040B0E4
.text:0040B0E4 ; =============== S U B R O U T I N E =======================================
.text:0040B0E4
.text:0040B0E4 ; Attributes: bp-based frame
.text:0040B0E4
.text:0040B0E4 ; int __cdecl _isupper_l(int c, localeinfo_struct *plocinfo)
.text:0040B0E4 __isupper_l     proc near	       ; CODE XREF: _isupper+21p
.text:0040B0E4
.text:0040B0E4 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B0E4 c	       = dword ptr  8
.text:0040B0E4 plocinfo	       = dword ptr  0Ch
.text:0040B0E4
.text:0040B0E4		       push    ebp
.text:0040B0E5		       mov     ebp, esp
.text:0040B0E7		       sub     esp, 10h
.text:0040B0EA		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B0ED		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B0F0		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B0F5		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B0F8		       cmp     dword ptr [eax+0ACh], 1
.text:0040B0FF		       jle     short loc_40B114
.text:0040B101		       lea     eax, [ebp+_loc_update]
.text:0040B104		       push    eax	       ; plocinfo
.text:0040B105		       push    1	       ; mask
.text:0040B107		       push    [ebp+c]	       ; c
.text:0040B10A		       call    __isctype_l
.text:0040B10F		       add     esp, 0Ch
.text:0040B112		       jmp     short loc_40B124
.text:0040B114 ; ---------------------------------------------------------------------------
.text:0040B114
.text:0040B114 loc_40B114:			       ; CODE XREF: __isupper_l+1Bj
.text:0040B114		       mov     eax, [eax+0C8h]
.text:0040B11A		       mov     ecx, [ebp+c]
.text:0040B11D		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B121		       and     eax, 1
.text:0040B124
.text:0040B124 loc_40B124:			       ; CODE XREF: __isupper_l+2Ej
.text:0040B124		       cmp     [ebp+_loc_update.updated], 0
.text:0040B128		       jz      short locret_40B131
.text:0040B12A		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B12D		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B131
.text:0040B131 locret_40B131:			       ; CODE XREF: __isupper_l+44j
.text:0040B131		       leave
.text:0040B132		       retn
.text:0040B132 __isupper_l     endp
.text:0040B132
.text:0040B133
.text:0040B133 ; =============== S U B R O U T I N E =======================================
.text:0040B133
.text:0040B133
.text:0040B133 ; int __cdecl isupper(int c)
.text:0040B133 _isupper	       proc near
.text:0040B133
.text:0040B133 c	       = dword ptr  4
.text:0040B133
.text:0040B133		       cmp     ___locale_changed, 0
.text:0040B13A		       jnz     short loc_40B14E
.text:0040B13C		       mov     eax, [esp+c]
.text:0040B140		       mov     ecx, ___initiallocinfo.pctype
.text:0040B146		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B14A		       and     eax, 1
.text:0040B14D		       retn
.text:0040B14E ; ---------------------------------------------------------------------------
.text:0040B14E
.text:0040B14E loc_40B14E:			       ; CODE XREF: _isupper+7j
.text:0040B14E		       push    0	       ; plocinfo
.text:0040B150		       push    [esp+4+c]       ; c
.text:0040B154		       call    __isupper_l
.text:0040B159		       pop     ecx
.text:0040B15A		       pop     ecx
.text:0040B15B		       retn
.text:0040B15B _isupper	       endp
.text:0040B15B
.text:0040B15C
.text:0040B15C ; =============== S U B R O U T I N E =======================================
.text:0040B15C
.text:0040B15C ; Attributes: bp-based frame
.text:0040B15C
.text:0040B15C ; int __cdecl _islower_l(int c, localeinfo_struct *plocinfo)
.text:0040B15C __islower_l     proc near	       ; CODE XREF: _islower+21p
.text:0040B15C
.text:0040B15C _loc_update     = _LocaleUpdate ptr -10h
.text:0040B15C c	       = dword ptr  8
.text:0040B15C plocinfo	       = dword ptr  0Ch
.text:0040B15C
.text:0040B15C		       push    ebp
.text:0040B15D		       mov     ebp, esp
.text:0040B15F		       sub     esp, 10h
.text:0040B162		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B165		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B168		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B16D		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B170		       cmp     dword ptr [eax+0ACh], 1
.text:0040B177		       jle     short loc_40B18C
.text:0040B179		       lea     eax, [ebp+_loc_update]
.text:0040B17C		       push    eax	       ; plocinfo
.text:0040B17D		       push    2	       ; mask
.text:0040B17F		       push    [ebp+c]	       ; c
.text:0040B182		       call    __isctype_l
.text:0040B187		       add     esp, 0Ch
.text:0040B18A		       jmp     short loc_40B19C
.text:0040B18C ; ---------------------------------------------------------------------------
.text:0040B18C
.text:0040B18C loc_40B18C:			       ; CODE XREF: __islower_l+1Bj
.text:0040B18C		       mov     eax, [eax+0C8h]
.text:0040B192		       mov     ecx, [ebp+c]
.text:0040B195		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B199		       and     eax, 2
.text:0040B19C
.text:0040B19C loc_40B19C:			       ; CODE XREF: __islower_l+2Ej
.text:0040B19C		       cmp     [ebp+_loc_update.updated], 0
.text:0040B1A0		       jz      short locret_40B1A9
.text:0040B1A2		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B1A5		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B1A9
.text:0040B1A9 locret_40B1A9:			       ; CODE XREF: __islower_l+44j
.text:0040B1A9		       leave
.text:0040B1AA		       retn
.text:0040B1AA __islower_l     endp
.text:0040B1AA
.text:0040B1AB
.text:0040B1AB ; =============== S U B R O U T I N E =======================================
.text:0040B1AB
.text:0040B1AB
.text:0040B1AB ; int __cdecl islower(int c)
.text:0040B1AB _islower	       proc near
.text:0040B1AB
.text:0040B1AB c	       = dword ptr  4
.text:0040B1AB
.text:0040B1AB		       cmp     ___locale_changed, 0
.text:0040B1B2		       jnz     short loc_40B1C6
.text:0040B1B4		       mov     eax, [esp+c]
.text:0040B1B8		       mov     ecx, ___initiallocinfo.pctype
.text:0040B1BE		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B1C2		       and     eax, 2
.text:0040B1C5		       retn
.text:0040B1C6 ; ---------------------------------------------------------------------------
.text:0040B1C6
.text:0040B1C6 loc_40B1C6:			       ; CODE XREF: _islower+7j
.text:0040B1C6		       push    0	       ; plocinfo
.text:0040B1C8		       push    [esp+4+c]       ; c
.text:0040B1CC		       call    __islower_l
.text:0040B1D1		       pop     ecx
.text:0040B1D2		       pop     ecx
.text:0040B1D3		       retn
.text:0040B1D3 _islower	       endp
.text:0040B1D3
.text:0040B1D4
.text:0040B1D4 ; =============== S U B R O U T I N E =======================================
.text:0040B1D4
.text:0040B1D4 ; Attributes: bp-based frame
.text:0040B1D4
.text:0040B1D4 ; int __cdecl _isdigit_l(int c, localeinfo_struct *plocinfo)
.text:0040B1D4 __isdigit_l     proc near	       ; CODE XREF: _isdigit+21p
.text:0040B1D4
.text:0040B1D4 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B1D4 c	       = dword ptr  8
.text:0040B1D4 plocinfo	       = dword ptr  0Ch
.text:0040B1D4
.text:0040B1D4		       push    ebp
.text:0040B1D5		       mov     ebp, esp
.text:0040B1D7		       sub     esp, 10h
.text:0040B1DA		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B1DD		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B1E0		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B1E5		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B1E8		       cmp     dword ptr [eax+0ACh], 1
.text:0040B1EF		       jle     short loc_40B204
.text:0040B1F1		       lea     eax, [ebp+_loc_update]
.text:0040B1F4		       push    eax	       ; plocinfo
.text:0040B1F5		       push    4	       ; mask
.text:0040B1F7		       push    [ebp+c]	       ; c
.text:0040B1FA		       call    __isctype_l
.text:0040B1FF		       add     esp, 0Ch
.text:0040B202		       jmp     short loc_40B214
.text:0040B204 ; ---------------------------------------------------------------------------
.text:0040B204
.text:0040B204 loc_40B204:			       ; CODE XREF: __isdigit_l+1Bj
.text:0040B204		       mov     eax, [eax+0C8h]
.text:0040B20A		       mov     ecx, [ebp+c]
.text:0040B20D		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B211		       and     eax, 4
.text:0040B214
.text:0040B214 loc_40B214:			       ; CODE XREF: __isdigit_l+2Ej
.text:0040B214		       cmp     [ebp+_loc_update.updated], 0
.text:0040B218		       jz      short locret_40B221
.text:0040B21A		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B21D		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B221
.text:0040B221 locret_40B221:			       ; CODE XREF: __isdigit_l+44j
.text:0040B221		       leave
.text:0040B222		       retn
.text:0040B222 __isdigit_l     endp
.text:0040B222
.text:0040B223
.text:0040B223 ; =============== S U B R O U T I N E =======================================
.text:0040B223
.text:0040B223
.text:0040B223 ; int __cdecl isdigit(int c)
.text:0040B223 _isdigit	       proc near	       ; CODE XREF: ___getlocaleinfo+138p
.text:0040B223
.text:0040B223 c	       = dword ptr  4
.text:0040B223
.text:0040B223		       cmp     ___locale_changed, 0
.text:0040B22A		       jnz     short loc_40B23E
.text:0040B22C		       mov     eax, [esp+c]
.text:0040B230		       mov     ecx, ___initiallocinfo.pctype
.text:0040B236		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B23A		       and     eax, 4
.text:0040B23D		       retn
.text:0040B23E ; ---------------------------------------------------------------------------
.text:0040B23E
.text:0040B23E loc_40B23E:			       ; CODE XREF: _isdigit+7j
.text:0040B23E		       push    0	       ; plocinfo
.text:0040B240		       push    [esp+4+c]       ; c
.text:0040B244		       call    __isdigit_l
.text:0040B249		       pop     ecx
.text:0040B24A		       pop     ecx
.text:0040B24B		       retn
.text:0040B24B _isdigit	       endp
.text:0040B24B
.text:0040B24C
.text:0040B24C ; =============== S U B R O U T I N E =======================================
.text:0040B24C
.text:0040B24C ; Attributes: bp-based frame
.text:0040B24C
.text:0040B24C ; int __cdecl _isxdigit_l(int c,	localeinfo_struct *plocinfo)
.text:0040B24C __isxdigit_l    proc near	       ; CODE XREF: _isxdigit+23p
.text:0040B24C
.text:0040B24C _loc_update     = _LocaleUpdate ptr -10h
.text:0040B24C c	       = dword ptr  8
.text:0040B24C plocinfo	       = dword ptr  0Ch
.text:0040B24C
.text:0040B24C		       push    ebp
.text:0040B24D		       mov     ebp, esp
.text:0040B24F		       sub     esp, 10h
.text:0040B252		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B255		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B258		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B25D		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B260		       cmp     dword ptr [eax+0ACh], 1
.text:0040B267		       jle     short loc_40B27F
.text:0040B269		       lea     eax, [ebp+_loc_update]
.text:0040B26C		       push    eax	       ; plocinfo
.text:0040B26D		       push    80h	       ; mask
.text:0040B272		       push    [ebp+c]	       ; c
.text:0040B275		       call    __isctype_l
.text:0040B27A		       add     esp, 0Ch
.text:0040B27D		       jmp     short loc_40B291
.text:0040B27F ; ---------------------------------------------------------------------------
.text:0040B27F
.text:0040B27F loc_40B27F:			       ; CODE XREF: __isxdigit_l+1Bj
.text:0040B27F		       mov     eax, [eax+0C8h]
.text:0040B285		       mov     ecx, [ebp+c]
.text:0040B288		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B28C		       and     eax, 80h
.text:0040B291
.text:0040B291 loc_40B291:			       ; CODE XREF: __isxdigit_l+31j
.text:0040B291		       cmp     [ebp+_loc_update.updated], 0
.text:0040B295		       jz      short locret_40B29E
.text:0040B297		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B29A		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B29E
.text:0040B29E locret_40B29E:			       ; CODE XREF: __isxdigit_l+49j
.text:0040B29E		       leave
.text:0040B29F		       retn
.text:0040B29F __isxdigit_l    endp
.text:0040B29F
.text:0040B2A0
.text:0040B2A0 ; =============== S U B R O U T I N E =======================================
.text:0040B2A0
.text:0040B2A0
.text:0040B2A0 ; int __cdecl isxdigit(int c)
.text:0040B2A0 _isxdigit       proc near
.text:0040B2A0
.text:0040B2A0 c	       = dword ptr  4
.text:0040B2A0
.text:0040B2A0		       cmp     ___locale_changed, 0
.text:0040B2A7		       jnz     short loc_40B2BD
.text:0040B2A9		       mov     eax, [esp+c]
.text:0040B2AD		       mov     ecx, ___initiallocinfo.pctype
.text:0040B2B3		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B2B7		       and     eax, 80h
.text:0040B2BC		       retn
.text:0040B2BD ; ---------------------------------------------------------------------------
.text:0040B2BD
.text:0040B2BD loc_40B2BD:			       ; CODE XREF: _isxdigit+7j
.text:0040B2BD		       push    0	       ; plocinfo
.text:0040B2BF		       push    [esp+4+c]       ; c
.text:0040B2C3		       call    __isxdigit_l
.text:0040B2C8		       pop     ecx
.text:0040B2C9		       pop     ecx
.text:0040B2CA		       retn
.text:0040B2CA _isxdigit       endp
.text:0040B2CA
.text:0040B2CB
.text:0040B2CB ; =============== S U B R O U T I N E =======================================
.text:0040B2CB
.text:0040B2CB ; Attributes: bp-based frame
.text:0040B2CB
.text:0040B2CB ; int __cdecl _isspace_l(int c, localeinfo_struct *plocinfo)
.text:0040B2CB __isspace_l     proc near	       ; CODE XREF: _isspace+21p
.text:0040B2CB
.text:0040B2CB _loc_update     = _LocaleUpdate ptr -10h
.text:0040B2CB c	       = dword ptr  8
.text:0040B2CB plocinfo	       = dword ptr  0Ch
.text:0040B2CB
.text:0040B2CB		       push    ebp
.text:0040B2CC		       mov     ebp, esp
.text:0040B2CE		       sub     esp, 10h
.text:0040B2D1		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B2D4		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B2D7		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B2DC		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B2DF		       cmp     dword ptr [eax+0ACh], 1
.text:0040B2E6		       jle     short loc_40B2FB
.text:0040B2E8		       lea     eax, [ebp+_loc_update]
.text:0040B2EB		       push    eax	       ; plocinfo
.text:0040B2EC		       push    8	       ; mask
.text:0040B2EE		       push    [ebp+c]	       ; c
.text:0040B2F1		       call    __isctype_l
.text:0040B2F6		       add     esp, 0Ch
.text:0040B2F9		       jmp     short loc_40B30B
.text:0040B2FB ; ---------------------------------------------------------------------------
.text:0040B2FB
.text:0040B2FB loc_40B2FB:			       ; CODE XREF: __isspace_l+1Bj
.text:0040B2FB		       mov     eax, [eax+0C8h]
.text:0040B301		       mov     ecx, [ebp+c]
.text:0040B304		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B308		       and     eax, 8
.text:0040B30B
.text:0040B30B loc_40B30B:			       ; CODE XREF: __isspace_l+2Ej
.text:0040B30B		       cmp     [ebp+_loc_update.updated], 0
.text:0040B30F		       jz      short locret_40B318
.text:0040B311		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B314		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B318
.text:0040B318 locret_40B318:			       ; CODE XREF: __isspace_l+44j
.text:0040B318		       leave
.text:0040B319		       retn
.text:0040B319 __isspace_l     endp
.text:0040B319
.text:0040B31A
.text:0040B31A ; =============== S U B R O U T I N E =======================================
.text:0040B31A
.text:0040B31A
.text:0040B31A ; int __cdecl isspace(int c)
.text:0040B31A _isspace	       proc near
.text:0040B31A
.text:0040B31A c	       = dword ptr  4
.text:0040B31A
.text:0040B31A		       cmp     ___locale_changed, 0
.text:0040B321		       jnz     short loc_40B335
.text:0040B323		       mov     eax, [esp+c]
.text:0040B327		       mov     ecx, ___initiallocinfo.pctype
.text:0040B32D		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B331		       and     eax, 8
.text:0040B334		       retn
.text:0040B335 ; ---------------------------------------------------------------------------
.text:0040B335
.text:0040B335 loc_40B335:			       ; CODE XREF: _isspace+7j
.text:0040B335		       push    0	       ; plocinfo
.text:0040B337		       push    [esp+4+c]       ; c
.text:0040B33B		       call    __isspace_l
.text:0040B340		       pop     ecx
.text:0040B341		       pop     ecx
.text:0040B342		       retn
.text:0040B342 _isspace	       endp
.text:0040B342
.text:0040B343
.text:0040B343 ; =============== S U B R O U T I N E =======================================
.text:0040B343
.text:0040B343 ; Attributes: bp-based frame
.text:0040B343
.text:0040B343 ; int __cdecl _ispunct_l(int c, localeinfo_struct *plocinfo)
.text:0040B343 __ispunct_l     proc near	       ; CODE XREF: _ispunct+21p
.text:0040B343
.text:0040B343 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B343 c	       = dword ptr  8
.text:0040B343 plocinfo	       = dword ptr  0Ch
.text:0040B343
.text:0040B343		       push    ebp
.text:0040B344		       mov     ebp, esp
.text:0040B346		       sub     esp, 10h
.text:0040B349		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B34C		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B34F		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B354		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B357		       cmp     dword ptr [eax+0ACh], 1
.text:0040B35E		       jle     short loc_40B373
.text:0040B360		       lea     eax, [ebp+_loc_update]
.text:0040B363		       push    eax	       ; plocinfo
.text:0040B364		       push    10h	       ; mask
.text:0040B366		       push    [ebp+c]	       ; c
.text:0040B369		       call    __isctype_l
.text:0040B36E		       add     esp, 0Ch
.text:0040B371		       jmp     short loc_40B383
.text:0040B373 ; ---------------------------------------------------------------------------
.text:0040B373
.text:0040B373 loc_40B373:			       ; CODE XREF: __ispunct_l+1Bj
.text:0040B373		       mov     eax, [eax+0C8h]
.text:0040B379		       mov     ecx, [ebp+c]
.text:0040B37C		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B380		       and     eax, 10h
.text:0040B383
.text:0040B383 loc_40B383:			       ; CODE XREF: __ispunct_l+2Ej
.text:0040B383		       cmp     [ebp+_loc_update.updated], 0
.text:0040B387		       jz      short locret_40B390
.text:0040B389		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B38C		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B390
.text:0040B390 locret_40B390:			       ; CODE XREF: __ispunct_l+44j
.text:0040B390		       leave
.text:0040B391		       retn
.text:0040B391 __ispunct_l     endp
.text:0040B391
.text:0040B392
.text:0040B392 ; =============== S U B R O U T I N E =======================================
.text:0040B392
.text:0040B392
.text:0040B392 ; int __cdecl ispunct(int c)
.text:0040B392 _ispunct	       proc near
.text:0040B392
.text:0040B392 c	       = dword ptr  4
.text:0040B392
.text:0040B392		       cmp     ___locale_changed, 0
.text:0040B399		       jnz     short loc_40B3AD
.text:0040B39B		       mov     eax, [esp+c]
.text:0040B39F		       mov     ecx, ___initiallocinfo.pctype
.text:0040B3A5		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B3A9		       and     eax, 10h
.text:0040B3AC		       retn
.text:0040B3AD ; ---------------------------------------------------------------------------
.text:0040B3AD
.text:0040B3AD loc_40B3AD:			       ; CODE XREF: _ispunct+7j
.text:0040B3AD		       push    0	       ; plocinfo
.text:0040B3AF		       push    [esp+4+c]       ; c
.text:0040B3B3		       call    __ispunct_l
.text:0040B3B8		       pop     ecx
.text:0040B3B9		       pop     ecx
.text:0040B3BA		       retn
.text:0040B3BA _ispunct	       endp
.text:0040B3BA
.text:0040B3BB
.text:0040B3BB ; =============== S U B R O U T I N E =======================================
.text:0040B3BB
.text:0040B3BB ; Attributes: bp-based frame
.text:0040B3BB
.text:0040B3BB ; int __cdecl _isalnum_l(int c, localeinfo_struct *plocinfo)
.text:0040B3BB __isalnum_l     proc near	       ; CODE XREF: _isalnum+23p
.text:0040B3BB					       ; __iscsym_l+8p
.text:0040B3BB
.text:0040B3BB _loc_update     = _LocaleUpdate ptr -10h
.text:0040B3BB c	       = dword ptr  8
.text:0040B3BB plocinfo	       = dword ptr  0Ch
.text:0040B3BB
.text:0040B3BB		       push    ebp
.text:0040B3BC		       mov     ebp, esp
.text:0040B3BE		       sub     esp, 10h
.text:0040B3C1		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B3C4		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B3C7		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B3CC		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B3CF		       cmp     dword ptr [eax+0ACh], 1
.text:0040B3D6		       jle     short loc_40B3EE
.text:0040B3D8		       lea     eax, [ebp+_loc_update]
.text:0040B3DB		       push    eax	       ; plocinfo
.text:0040B3DC		       push    107h	       ; mask
.text:0040B3E1		       push    [ebp+c]	       ; c
.text:0040B3E4		       call    __isctype_l
.text:0040B3E9		       add     esp, 0Ch
.text:0040B3EC		       jmp     short loc_40B400
.text:0040B3EE ; ---------------------------------------------------------------------------
.text:0040B3EE
.text:0040B3EE loc_40B3EE:			       ; CODE XREF: __isalnum_l+1Bj
.text:0040B3EE		       mov     eax, [eax+0C8h]
.text:0040B3F4		       mov     ecx, [ebp+c]
.text:0040B3F7		       movzx   eax, word ptr [eax+ecx*2]
.text:0040B3FB		       and     eax, 107h
.text:0040B400
.text:0040B400 loc_40B400:			       ; CODE XREF: __isalnum_l+31j
.text:0040B400		       cmp     [ebp+_loc_update.updated], 0
.text:0040B404		       jz      short locret_40B40D
.text:0040B406		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B409		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B40D
.text:0040B40D locret_40B40D:			       ; CODE XREF: __isalnum_l+49j
.text:0040B40D		       leave
.text:0040B40E		       retn
.text:0040B40E __isalnum_l     endp
.text:0040B40E
.text:0040B40F
.text:0040B40F ; =============== S U B R O U T I N E =======================================
.text:0040B40F
.text:0040B40F
.text:0040B40F ; int __cdecl isalnum(int c)
.text:0040B40F _isalnum	       proc near	       ; CODE XREF: ___iscsym+6p
.text:0040B40F
.text:0040B40F c	       = dword ptr  4
.text:0040B40F
.text:0040B40F		       cmp     ___locale_changed, 0
.text:0040B416		       jnz     short loc_40B42C
.text:0040B418		       mov     eax, [esp+c]
.text:0040B41C		       mov     ecx, ___initiallocinfo.pctype
.text:0040B422		       movzx   eax, word ptr [ecx+eax*2]
.text:0040B426		       and     eax, 107h
.text:0040B42B		       retn
.text:0040B42C ; ---------------------------------------------------------------------------
.text:0040B42C
.text:0040B42C loc_40B42C:			       ; CODE XREF: _isalnum+7j
.text:0040B42C		       push    0	       ; plocinfo
.text:0040B42E		       push    [esp+4+c]       ; c
.text:0040B432		       call    __isalnum_l
.text:0040B437		       pop     ecx
.text:0040B438		       pop     ecx
.text:0040B439		       retn
.text:0040B439 _isalnum	       endp
.text:0040B439
.text:0040B43A
.text:0040B43A ; =============== S U B R O U T I N E =======================================
.text:0040B43A
.text:0040B43A ; Attributes: bp-based frame
.text:0040B43A
.text:0040B43A ; int __cdecl _isprint_l(int c, localeinfo_struct *plocinfo)
.text:0040B43A __isprint_l     proc near	       ; CODE XREF: _isprint+23p
.text:0040B43A
.text:0040B43A _loc_update     = _LocaleUpdate ptr -10h
.text:0040B43A c	       = dword ptr  8
.text:0040B43A plocinfo	       = dword ptr  0Ch
.text:0040B43A
.text:0040B43A		       push    ebp
.text:0040B43B		       mov     ebp, esp
.text:0040B43D		       sub     esp, 10h
.text:0040B440		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B443		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B446		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B44B		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B44E		       cmp     dword ptr [eax+0ACh], 1
.text:0040B455		       jle     short loc_40B46D
.text:0040B457		       lea     eax, [ebp+_loc_update]
.text:0040B45A		       push    eax	       ; plocinfo
.text:0040B45B		       push    157h	       ; mask
.text:0040B460		       push    [ebp+c]	       ; c
.text:0040B463		       call    __isctype_l
.text:0040B468		       add     esp, 0Ch
.text:0040B46B		       jmp     short loc_40B47F
.text:0040B46D ; ---------------------------------------------------------------------------
.text:0040B46D
.text:0040B46D loc_40B46D:			       ; CODE XREF: __isprint_l+1Bj
.text:0040B46D		       mov     eax, [eax+0C8h]
.text:0040B473		       mov     ecx, [ebp+c]
.text:0040B476		       movzx   eax, word ptr [eax+ecx*2]
.text:0040B47A		       and     eax, 157h
.text:0040B47F
.text:0040B47F loc_40B47F:			       ; CODE XREF: __isprint_l+31j
.text:0040B47F		       cmp     [ebp+_loc_update.updated], 0
.text:0040B483		       jz      short locret_40B48C
.text:0040B485		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B488		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B48C
.text:0040B48C locret_40B48C:			       ; CODE XREF: __isprint_l+49j
.text:0040B48C		       leave
.text:0040B48D		       retn
.text:0040B48D __isprint_l     endp
.text:0040B48D
.text:0040B48E
.text:0040B48E ; =============== S U B R O U T I N E =======================================
.text:0040B48E
.text:0040B48E
.text:0040B48E ; int __cdecl isprint(int c)
.text:0040B48E _isprint	       proc near
.text:0040B48E
.text:0040B48E c	       = dword ptr  4
.text:0040B48E
.text:0040B48E		       cmp     ___locale_changed, 0
.text:0040B495		       jnz     short loc_40B4AB
.text:0040B497		       mov     eax, [esp+c]
.text:0040B49B		       mov     ecx, ___initiallocinfo.pctype
.text:0040B4A1		       movzx   eax, word ptr [ecx+eax*2]
.text:0040B4A5		       and     eax, 157h
.text:0040B4AA		       retn
.text:0040B4AB ; ---------------------------------------------------------------------------
.text:0040B4AB
.text:0040B4AB loc_40B4AB:			       ; CODE XREF: _isprint+7j
.text:0040B4AB		       push    0	       ; plocinfo
.text:0040B4AD		       push    [esp+4+c]       ; c
.text:0040B4B1		       call    __isprint_l
.text:0040B4B6		       pop     ecx
.text:0040B4B7		       pop     ecx
.text:0040B4B8		       retn
.text:0040B4B8 _isprint	       endp
.text:0040B4B8
.text:0040B4B9
.text:0040B4B9 ; =============== S U B R O U T I N E =======================================
.text:0040B4B9
.text:0040B4B9 ; Attributes: bp-based frame
.text:0040B4B9
.text:0040B4B9 ; int __cdecl _isgraph_l(int c, localeinfo_struct *plocinfo)
.text:0040B4B9 __isgraph_l     proc near	       ; CODE XREF: _isgraph+23p
.text:0040B4B9
.text:0040B4B9 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B4B9 c	       = dword ptr  8
.text:0040B4B9 plocinfo	       = dword ptr  0Ch
.text:0040B4B9
.text:0040B4B9		       push    ebp
.text:0040B4BA		       mov     ebp, esp
.text:0040B4BC		       sub     esp, 10h
.text:0040B4BF		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B4C2		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B4C5		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B4CA		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B4CD		       cmp     dword ptr [eax+0ACh], 1
.text:0040B4D4		       jle     short loc_40B4EC
.text:0040B4D6		       lea     eax, [ebp+_loc_update]
.text:0040B4D9		       push    eax	       ; plocinfo
.text:0040B4DA		       push    117h	       ; mask
.text:0040B4DF		       push    [ebp+c]	       ; c
.text:0040B4E2		       call    __isctype_l
.text:0040B4E7		       add     esp, 0Ch
.text:0040B4EA		       jmp     short loc_40B4FE
.text:0040B4EC ; ---------------------------------------------------------------------------
.text:0040B4EC
.text:0040B4EC loc_40B4EC:			       ; CODE XREF: __isgraph_l+1Bj
.text:0040B4EC		       mov     eax, [eax+0C8h]
.text:0040B4F2		       mov     ecx, [ebp+c]
.text:0040B4F5		       movzx   eax, word ptr [eax+ecx*2]
.text:0040B4F9		       and     eax, 117h
.text:0040B4FE
.text:0040B4FE loc_40B4FE:			       ; CODE XREF: __isgraph_l+31j
.text:0040B4FE		       cmp     [ebp+_loc_update.updated], 0
.text:0040B502		       jz      short locret_40B50B
.text:0040B504		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B507		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B50B
.text:0040B50B locret_40B50B:			       ; CODE XREF: __isgraph_l+49j
.text:0040B50B		       leave
.text:0040B50C		       retn
.text:0040B50C __isgraph_l     endp
.text:0040B50C
.text:0040B50D
.text:0040B50D ; =============== S U B R O U T I N E =======================================
.text:0040B50D
.text:0040B50D
.text:0040B50D ; int __cdecl isgraph(int c)
.text:0040B50D _isgraph	       proc near
.text:0040B50D
.text:0040B50D c	       = dword ptr  4
.text:0040B50D
.text:0040B50D		       cmp     ___locale_changed, 0
.text:0040B514		       jnz     short loc_40B52A
.text:0040B516		       mov     eax, [esp+c]
.text:0040B51A		       mov     ecx, ___initiallocinfo.pctype
.text:0040B520		       movzx   eax, word ptr [ecx+eax*2]
.text:0040B524		       and     eax, 117h
.text:0040B529		       retn
.text:0040B52A ; ---------------------------------------------------------------------------
.text:0040B52A
.text:0040B52A loc_40B52A:			       ; CODE XREF: _isgraph+7j
.text:0040B52A		       push    0	       ; plocinfo
.text:0040B52C		       push    [esp+4+c]       ; c
.text:0040B530		       call    __isgraph_l
.text:0040B535		       pop     ecx
.text:0040B536		       pop     ecx
.text:0040B537		       retn
.text:0040B537 _isgraph	       endp
.text:0040B537
.text:0040B538
.text:0040B538 ; =============== S U B R O U T I N E =======================================
.text:0040B538
.text:0040B538 ; Attributes: bp-based frame
.text:0040B538
.text:0040B538 ; int __cdecl _iscntrl_l(int c, localeinfo_struct *plocinfo)
.text:0040B538 __iscntrl_l     proc near	       ; CODE XREF: _iscntrl+21p
.text:0040B538
.text:0040B538 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B538 c	       = dword ptr  8
.text:0040B538 plocinfo	       = dword ptr  0Ch
.text:0040B538
.text:0040B538		       push    ebp
.text:0040B539		       mov     ebp, esp
.text:0040B53B		       sub     esp, 10h
.text:0040B53E		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B541		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B544		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B549		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B54C		       cmp     dword ptr [eax+0ACh], 1
.text:0040B553		       jle     short loc_40B568
.text:0040B555		       lea     eax, [ebp+_loc_update]
.text:0040B558		       push    eax	       ; plocinfo
.text:0040B559		       push    20h	       ; mask
.text:0040B55B		       push    [ebp+c]	       ; c
.text:0040B55E		       call    __isctype_l
.text:0040B563		       add     esp, 0Ch
.text:0040B566		       jmp     short loc_40B578
.text:0040B568 ; ---------------------------------------------------------------------------
.text:0040B568
.text:0040B568 loc_40B568:			       ; CODE XREF: __iscntrl_l+1Bj
.text:0040B568		       mov     eax, [eax+0C8h]
.text:0040B56E		       mov     ecx, [ebp+c]
.text:0040B571		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B575		       and     eax, 20h
.text:0040B578
.text:0040B578 loc_40B578:			       ; CODE XREF: __iscntrl_l+2Ej
.text:0040B578		       cmp     [ebp+_loc_update.updated], 0
.text:0040B57C		       jz      short locret_40B585
.text:0040B57E		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B581		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B585
.text:0040B585 locret_40B585:			       ; CODE XREF: __iscntrl_l+44j
.text:0040B585		       leave
.text:0040B586		       retn
.text:0040B586 __iscntrl_l     endp
.text:0040B586
.text:0040B587
.text:0040B587 ; =============== S U B R O U T I N E =======================================
.text:0040B587
.text:0040B587
.text:0040B587 ; int __cdecl iscntrl(int c)
.text:0040B587 _iscntrl	       proc near
.text:0040B587
.text:0040B587 c	       = dword ptr  4
.text:0040B587
.text:0040B587		       cmp     ___locale_changed, 0
.text:0040B58E		       jnz     short loc_40B5A2
.text:0040B590		       mov     eax, [esp+c]
.text:0040B594		       mov     ecx, ___initiallocinfo.pctype
.text:0040B59A		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B59E		       and     eax, 20h
.text:0040B5A1		       retn
.text:0040B5A2 ; ---------------------------------------------------------------------------
.text:0040B5A2
.text:0040B5A2 loc_40B5A2:			       ; CODE XREF: _iscntrl+7j
.text:0040B5A2		       push    0	       ; plocinfo
.text:0040B5A4		       push    [esp+4+c]       ; c
.text:0040B5A8		       call    __iscntrl_l
.text:0040B5AD		       pop     ecx
.text:0040B5AE		       pop     ecx
.text:0040B5AF		       retn
.text:0040B5AF _iscntrl	       endp
.text:0040B5AF
.text:0040B5B0
.text:0040B5B0 ; =============== S U B R O U T I N E =======================================
.text:0040B5B0
.text:0040B5B0
.text:0040B5B0 ; int __cdecl __isascii(int c)
.text:0040B5B0 ___isascii      proc near
.text:0040B5B0
.text:0040B5B0 c	       = dword ptr  4
.text:0040B5B0
.text:0040B5B0		       cmp     [esp+c],	80h
.text:0040B5B8		       sbb     eax, eax
.text:0040B5BA		       neg     eax
.text:0040B5BC		       retn
.text:0040B5BC ___isascii      endp
.text:0040B5BC
.text:0040B5BD
.text:0040B5BD ; =============== S U B R O U T I N E =======================================
.text:0040B5BD
.text:0040B5BD
.text:0040B5BD ; int __cdecl __toascii(int c)
.text:0040B5BD ___toascii      proc near
.text:0040B5BD
.text:0040B5BD c	       = dword ptr  4
.text:0040B5BD
.text:0040B5BD		       mov     eax, [esp+c]
.text:0040B5C1		       and     eax, 7Fh
.text:0040B5C4		       retn
.text:0040B5C4 ___toascii      endp
.text:0040B5C4
.text:0040B5C5
.text:0040B5C5 ; =============== S U B R O U T I N E =======================================
.text:0040B5C5
.text:0040B5C5
.text:0040B5C5 ; int __cdecl _iscsymf_l(int c, localeinfo_struct *plocinfo)
.text:0040B5C5 __iscsymf_l     proc near
.text:0040B5C5
.text:0040B5C5 c	       = dword ptr  4
.text:0040B5C5 plocinfo	       = dword ptr  8
.text:0040B5C5
.text:0040B5C5		       push    [esp+plocinfo]  ; plocinfo
.text:0040B5C9		       push    [esp+4+c]       ; c
.text:0040B5CD		       call    __isalpha_l
.text:0040B5D2		       test    eax, eax
.text:0040B5D4		       pop     ecx
.text:0040B5D5		       pop     ecx
.text:0040B5D6		       jnz     short loc_40B5E0
.text:0040B5D8		       cmp     [esp+c],	5Fh
.text:0040B5DD		       jz      short loc_40B5E0
.text:0040B5DF		       retn
.text:0040B5E0 ; ---------------------------------------------------------------------------
.text:0040B5E0
.text:0040B5E0 loc_40B5E0:			       ; CODE XREF: __iscsymf_l+11j
.text:0040B5E0					       ; __iscsymf_l+18j
.text:0040B5E0		       xor     eax, eax
.text:0040B5E2		       inc     eax
.text:0040B5E3		       retn
.text:0040B5E3 __iscsymf_l     endp
.text:0040B5E3
.text:0040B5E4
.text:0040B5E4 ; =============== S U B R O U T I N E =======================================
.text:0040B5E4
.text:0040B5E4
.text:0040B5E4 ; int __cdecl __iscsymf(int c)
.text:0040B5E4 ___iscsymf      proc near
.text:0040B5E4
.text:0040B5E4 c	       = dword ptr  4
.text:0040B5E4
.text:0040B5E4		       push    [esp+c]	       ; c
.text:0040B5E8		       call    _isalpha
.text:0040B5ED		       test    eax, eax
.text:0040B5EF		       pop     ecx
.text:0040B5F0		       jnz     short loc_40B5FA
.text:0040B5F2		       cmp     [esp+c],	5Fh
.text:0040B5F7		       jz      short loc_40B5FA
.text:0040B5F9		       retn
.text:0040B5FA ; ---------------------------------------------------------------------------
.text:0040B5FA
.text:0040B5FA loc_40B5FA:			       ; CODE XREF: ___iscsymf+Cj
.text:0040B5FA					       ; ___iscsymf+13j
.text:0040B5FA		       xor     eax, eax
.text:0040B5FC		       inc     eax
.text:0040B5FD		       retn
.text:0040B5FD ___iscsymf      endp
.text:0040B5FD
.text:0040B5FE
.text:0040B5FE ; =============== S U B R O U T I N E =======================================
.text:0040B5FE
.text:0040B5FE
.text:0040B5FE ; int __cdecl _iscsym_l(int c, localeinfo_struct	*plocinfo)
.text:0040B5FE __iscsym_l      proc near
.text:0040B5FE
.text:0040B5FE c	       = dword ptr  4
.text:0040B5FE plocinfo	       = dword ptr  8
.text:0040B5FE
.text:0040B5FE		       push    [esp+plocinfo]  ; plocinfo
.text:0040B602		       push    [esp+4+c]       ; c
.text:0040B606		       call    __isalnum_l
.text:0040B60B		       test    eax, eax
.text:0040B60D		       pop     ecx
.text:0040B60E		       pop     ecx
.text:0040B60F		       jnz     short loc_40B619
.text:0040B611		       cmp     [esp+c],	5Fh
.text:0040B616		       jz      short loc_40B619
.text:0040B618		       retn
.text:0040B619 ; ---------------------------------------------------------------------------
.text:0040B619
.text:0040B619 loc_40B619:			       ; CODE XREF: __iscsym_l+11j
.text:0040B619					       ; __iscsym_l+18j
.text:0040B619		       xor     eax, eax
.text:0040B61B		       inc     eax
.text:0040B61C		       retn
.text:0040B61C __iscsym_l      endp
.text:0040B61C
.text:0040B61D
.text:0040B61D ; =============== S U B R O U T I N E =======================================
.text:0040B61D
.text:0040B61D
.text:0040B61D ; int __cdecl __iscsym(int c)
.text:0040B61D ___iscsym       proc near
.text:0040B61D
.text:0040B61D c	       = dword ptr  4
.text:0040B61D
.text:0040B61D		       movzx   eax, byte ptr [esp+c]
.text:0040B622		       push    eax	       ; c
.text:0040B623		       call    _isalnum
.text:0040B628		       test    eax, eax
.text:0040B62A		       pop     ecx
.text:0040B62B		       jnz     short loc_40B635
.text:0040B62D		       cmp     byte ptr	[esp+c], 5Fh
.text:0040B632		       jz      short loc_40B635
.text:0040B634		       retn
.text:0040B635 ; ---------------------------------------------------------------------------
.text:0040B635
.text:0040B635 loc_40B635:			       ; CODE XREF: ___iscsym+Ej
.text:0040B635					       ; ___iscsym+15j
.text:0040B635		       xor     eax, eax
.text:0040B637		       inc     eax
.text:0040B638		       retn
.text:0040B638 ___iscsym       endp
.text:0040B638
.text:0040B639
.text:0040B639 ; =============== S U B R O U T I N E =======================================
.text:0040B639
.text:0040B639
.text:0040B639 ; void *__cdecl _MarkAllocaS(void *_Ptr,	unsigned int _Marker)
.text:0040B639 __MarkAllocaS   proc near
.text:0040B639
.text:0040B639 _Ptr	       = dword ptr  4
.text:0040B639 _Marker	       = dword ptr  8
.text:0040B639
.text:0040B639		       mov     eax, [esp+_Ptr]
.text:0040B63D		       test    eax, eax
.text:0040B63F		       jz      short locret_40B64A
.text:0040B641		       mov     ecx, [esp+_Marker]
.text:0040B645		       mov     [eax], ecx
.text:0040B647		       add     eax, 8
.text:0040B64A
.text:0040B64A locret_40B64A:			       ; CODE XREF: __MarkAllocaS+6j
.text:0040B64A		       retn
.text:0040B64A __MarkAllocaS   endp
.text:0040B64A
.text:0040B64B
.text:0040B64B ; =============== S U B R O U T I N E =======================================
.text:0040B64B
.text:0040B64B
.text:0040B64B ; void __cdecl _freea(void *_Memory)
.text:0040B64B __freea	       proc near	       ; CODE XREF: __crtGetLocaleInfoW_stat+120p
.text:0040B64B					       ; __crtGetLocaleInfoA_stat+10Fp	...
.text:0040B64B
.text:0040B64B _Memory	       = dword ptr  4
.text:0040B64B
.text:0040B64B		       mov     eax, [esp+_Memory]
.text:0040B64F		       test    eax, eax
.text:0040B651		       jz      short locret_40B665
.text:0040B653		       sub     eax, 8
.text:0040B656		       cmp     dword ptr [eax],	0DDDDh
.text:0040B65C		       jnz     short locret_40B665
.text:0040B65E		       push    eax	       ; pBlock
.text:0040B65F		       call    _free
.text:0040B664		       pop     ecx
.text:0040B665
.text:0040B665 locret_40B665:			       ; CODE XREF: __freea+6j
.text:0040B665					       ; __freea+11j
.text:0040B665		       retn
.text:0040B665 __freea	       endp
.text:0040B665
.text:0040B666
.text:0040B666 ; =============== S U B R O U T I N E =======================================
.text:0040B666
.text:0040B666 ; Attributes: bp-based frame
.text:0040B666
.text:0040B666 ; int __cdecl _crtGetLocaleInfoW_stat(localeinfo_struct *plocinfo, unsigned int Locale, unsigned	int LCType, wchar_t *lpLCData, int cchData, int	code_page)
.text:0040B666 __crtGetLocaleInfoW_stat	proc near      ; CODE XREF: ___crtGetLocaleInfoW+24p
.text:0040B666
.text:0040B666 retval	       = dword ptr -8
.text:0040B666 var_4	       = dword ptr -4
.text:0040B666 plocinfo	       = dword ptr  8
.text:0040B666 Locale	       = dword ptr  0Ch
.text:0040B666 LCType	       = dword ptr  10h
.text:0040B666 lpLCData	       = dword ptr  14h
.text:0040B666 cchData	       = dword ptr  18h
.text:0040B666 code_page       = dword ptr  1Ch
.text:0040B666
.text:0040B666		       push    ebp
.text:0040B667		       mov     ebp, esp
.text:0040B669		       push    ecx
.text:0040B66A		       push    ecx
.text:0040B66B		       mov     eax, ___security_cookie
.text:0040B670		       xor     eax, ebp
.text:0040B672		       mov     [ebp+var_4], eax
.text:0040B675		       mov     eax, f_use_0
.text:0040B67A		       push    ebx
.text:0040B67B		       push    esi
.text:0040B67C		       mov     esi, ds:__imp__GetLocaleInfoW@16	; GetLocaleInfoW(x,x,x,x)
.text:0040B682		       push    edi
.text:0040B683		       xor     edi, edi
.text:0040B685		       cmp     eax, edi
.text:0040B687		       jnz     short loc_40B6B8
.text:0040B689		       push    edi	       ; cchData
.text:0040B68A		       push    edi	       ; lpLCData
.text:0040B68B		       xor     ebx, ebx
.text:0040B68D		       inc     ebx
.text:0040B68E		       push    ebx	       ; LCType
.text:0040B68F		       push    edi	       ; Locale
.text:0040B690		       call    esi ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040B692		       test    eax, eax
.text:0040B694		       jz      short loc_40B69E
.text:0040B696		       mov     f_use_0,	ebx
.text:0040B69C		       jmp     short loc_40B6BD
.text:0040B69E ; ---------------------------------------------------------------------------
.text:0040B69E
.text:0040B69E loc_40B69E:			       ; CODE XREF: __crtGetLocaleInfoW_stat+2Ej
.text:0040B69E		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040B6A4		       cmp     eax, 78h
.text:0040B6A7		       jnz     short loc_40B6B3
.text:0040B6A9		       push    2
.text:0040B6AB		       pop     eax
.text:0040B6AC		       mov     f_use_0,	eax
.text:0040B6B1		       jmp     short loc_40B6B8
.text:0040B6B3 ; ---------------------------------------------------------------------------
.text:0040B6B3
.text:0040B6B3 loc_40B6B3:			       ; CODE XREF: __crtGetLocaleInfoW_stat+41j
.text:0040B6B3		       mov     eax, f_use_0
.text:0040B6B8
.text:0040B6B8 loc_40B6B8:			       ; CODE XREF: __crtGetLocaleInfoW_stat+21j
.text:0040B6B8					       ; __crtGetLocaleInfoW_stat+4Bj
.text:0040B6B8		       cmp     eax, 1
.text:0040B6BB		       jnz     short loc_40B6D0
.text:0040B6BD
.text:0040B6BD loc_40B6BD:			       ; CODE XREF: __crtGetLocaleInfoW_stat+36j
.text:0040B6BD		       push    [ebp+cchData]   ; cchData
.text:0040B6C0		       push    [ebp+lpLCData]  ; lpLCData
.text:0040B6C3		       push    [ebp+LCType]    ; LCType
.text:0040B6C6		       push    [ebp+Locale]    ; Locale
.text:0040B6C9		       call    esi ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040B6CB		       jmp     loc_40B78F
.text:0040B6D0 ; ---------------------------------------------------------------------------
.text:0040B6D0
.text:0040B6D0 loc_40B6D0:			       ; CODE XREF: __crtGetLocaleInfoW_stat+55j
.text:0040B6D0		       cmp     eax, 2
.text:0040B6D3		       jz      short loc_40B6D9
.text:0040B6D5		       cmp     eax, edi
.text:0040B6D7		       jnz     short loc_40B702
.text:0040B6D9
.text:0040B6D9 loc_40B6D9:			       ; CODE XREF: __crtGetLocaleInfoW_stat+6Dj
.text:0040B6D9		       cmp     [ebp+code_page],	edi
.text:0040B6DC		       mov     [ebp+retval], edi
.text:0040B6DF		       jnz     short loc_40B6EC
.text:0040B6E1		       mov     eax, [ebp+plocinfo]
.text:0040B6E4		       mov     eax, [eax]
.text:0040B6E6		       mov     eax, [eax+4]
.text:0040B6E9		       mov     [ebp+code_page],	eax
.text:0040B6EC
.text:0040B6EC loc_40B6EC:			       ; CODE XREF: __crtGetLocaleInfoW_stat+79j
.text:0040B6EC		       push    edi	       ; cchData
.text:0040B6ED		       push    edi	       ; lpLCData
.text:0040B6EE		       push    [ebp+LCType]    ; LCType
.text:0040B6F1		       mov     edi, ds:__imp__GetLocaleInfoA@16	; GetLocaleInfoA(x,x,x,x)
.text:0040B6F7		       push    [ebp+Locale]    ; Locale
.text:0040B6FA		       call    edi ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040B6FC		       mov     ebx, eax
.text:0040B6FE		       test    ebx, ebx
.text:0040B700		       jnz     short loc_40B709
.text:0040B702
.text:0040B702 loc_40B702:			       ; CODE XREF: __crtGetLocaleInfoW_stat+71j
.text:0040B702					       ; __crtGetLocaleInfoW_stat+C4j ...
.text:0040B702		       xor     eax, eax
.text:0040B704		       jmp     loc_40B78F
.text:0040B709 ; ---------------------------------------------------------------------------
.text:0040B709
.text:0040B709 loc_40B709:			       ; CODE XREF: __crtGetLocaleInfoW_stat+9Aj
.text:0040B709		       jle     short loc_40B74F
.text:0040B70B		       push    0FFFFFFE0h
.text:0040B70D		       xor     edx, edx
.text:0040B70F		       pop     eax
.text:0040B710		       div     ebx
.text:0040B712		       cmp     eax, 1
.text:0040B715		       jb      short loc_40B74F
.text:0040B717		       lea     eax, [ebx+8]
.text:0040B71A		       cmp     eax, 400h
.text:0040B71F		       ja      short loc_40B737
.text:0040B721		       call    __alloca_probe_16
.text:0040B726		       mov     esi, esp
.text:0040B728		       test    esi, esi
.text:0040B72A		       jz      short loc_40B702
.text:0040B72C		       mov     dword ptr [esi],	0CCCCh
.text:0040B732		       add     esi, 8
.text:0040B735		       jmp     short loc_40B751
.text:0040B737 ; ---------------------------------------------------------------------------
.text:0040B737
.text:0040B737 loc_40B737:			       ; CODE XREF: __crtGetLocaleInfoW_stat+B9j
.text:0040B737		       push    eax	       ; size
.text:0040B738		       call    _malloc
.text:0040B73D		       test    eax, eax
.text:0040B73F		       pop     ecx
.text:0040B740		       jz      short loc_40B74B
.text:0040B742		       mov     dword ptr [eax],	0DDDDh
.text:0040B748		       add     eax, 8
.text:0040B74B
.text:0040B74B loc_40B74B:			       ; CODE XREF: __crtGetLocaleInfoW_stat+DAj
.text:0040B74B		       mov     esi, eax
.text:0040B74D		       jmp     short loc_40B751
.text:0040B74F ; ---------------------------------------------------------------------------
.text:0040B74F
.text:0040B74F loc_40B74F:			       ; CODE XREF: __crtGetLocaleInfoW_stat:loc_40B709j
.text:0040B74F					       ; __crtGetLocaleInfoW_stat+AFj
.text:0040B74F		       xor     esi, esi
.text:0040B751
.text:0040B751 loc_40B751:			       ; CODE XREF: __crtGetLocaleInfoW_stat+CFj
.text:0040B751					       ; __crtGetLocaleInfoW_stat+E7j
.text:0040B751		       test    esi, esi
.text:0040B753		       jz      short loc_40B702
.text:0040B755		       push    ebx	       ; cchData
.text:0040B756		       push    esi	       ; lpLCData
.text:0040B757		       push    [ebp+LCType]    ; LCType
.text:0040B75A		       push    [ebp+Locale]    ; Locale
.text:0040B75D		       call    edi ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040B75F		       test    eax, eax
.text:0040B761		       jz      short error_cleanup
.text:0040B763		       xor     eax, eax
.text:0040B765		       cmp     [ebp+cchData], eax
.text:0040B768		       jnz     short loc_40B76E
.text:0040B76A		       push    eax
.text:0040B76B		       push    eax
.text:0040B76C		       jmp     short loc_40B774
.text:0040B76E ; ---------------------------------------------------------------------------
.text:0040B76E
.text:0040B76E loc_40B76E:			       ; CODE XREF: __crtGetLocaleInfoW_stat+102j
.text:0040B76E		       push    [ebp+cchData]   ; cchWideChar
.text:0040B771		       push    [ebp+lpLCData]  ; lpWideCharStr
.text:0040B774
.text:0040B774 loc_40B774:			       ; CODE XREF: __crtGetLocaleInfoW_stat+106j
.text:0040B774		       push    0FFFFFFFFh      ; cbMultiByte
.text:0040B776		       push    esi	       ; lpMultiByteStr
.text:0040B777		       push    1	       ; dwFlags
.text:0040B779		       push    [ebp+code_page] ; CodePage
.text:0040B77C		       call    ds:__imp__MultiByteToWideChar@24	; MultiByteToWideChar(x,x,x,x,x,x)
.text:0040B782		       mov     [ebp+retval], eax
.text:0040B785
.text:0040B785 error_cleanup:			       ; CODE XREF: __crtGetLocaleInfoW_stat+FBj
.text:0040B785		       push    esi	       ; _Memory
.text:0040B786		       call    __freea
.text:0040B78B		       mov     eax, [ebp+retval]
.text:0040B78E		       pop     ecx
.text:0040B78F
.text:0040B78F loc_40B78F:			       ; CODE XREF: __crtGetLocaleInfoW_stat+65j
.text:0040B78F					       ; __crtGetLocaleInfoW_stat+9Ej
.text:0040B78F		       lea     esp, [ebp-14h]
.text:0040B792		       pop     edi
.text:0040B793		       pop     esi
.text:0040B794		       pop     ebx
.text:0040B795		       mov     ecx, [ebp+var_4]
.text:0040B798		       xor     ecx, ebp	       ; cookie
.text:0040B79A		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040B79F		       leave
.text:0040B7A0		       retn
.text:0040B7A0 __crtGetLocaleInfoW_stat	endp
.text:0040B7A0
.text:0040B7A1
.text:0040B7A1 ; =============== S U B R O U T I N E =======================================
.text:0040B7A1
.text:0040B7A1 ; Attributes: bp-based frame
.text:0040B7A1
.text:0040B7A1 ; int __cdecl __crtGetLocaleInfoW(localeinfo_struct *plocinfo, unsigned int Locale, unsigned int	LCType,	wchar_t	*lpLCData, int cchData,	int code_page)
.text:0040B7A1 ___crtGetLocaleInfoW proc near	       ; CODE XREF: ___getlocaleinfo+124p
.text:0040B7A1
.text:0040B7A1 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B7A1 plocinfo	       = dword ptr  8
.text:0040B7A1 Locale	       = dword ptr  0Ch
.text:0040B7A1 LCType	       = dword ptr  10h
.text:0040B7A1 lpLCData	       = dword ptr  14h
.text:0040B7A1 cchData	       = dword ptr  18h
.text:0040B7A1 code_page       = dword ptr  1Ch
.text:0040B7A1
.text:0040B7A1		       push    ebp
.text:0040B7A2		       mov     ebp, esp
.text:0040B7A4		       sub     esp, 10h
.text:0040B7A7		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B7AA		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B7AD		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B7B2		       push    [ebp+code_page] ; code_page
.text:0040B7B5		       lea     eax, [ebp+_loc_update]
.text:0040B7B8		       push    [ebp+cchData]   ; cchData
.text:0040B7BB		       push    [ebp+lpLCData]  ; lpLCData
.text:0040B7BE		       push    [ebp+LCType]    ; LCType
.text:0040B7C1		       push    [ebp+Locale]    ; Locale
.text:0040B7C4		       push    eax	       ; plocinfo
.text:0040B7C5		       call    __crtGetLocaleInfoW_stat
.text:0040B7CA		       add     esp, 18h
.text:0040B7CD		       cmp     [ebp+_loc_update.updated], 0
.text:0040B7D1		       jz      short locret_40B7DA
.text:0040B7D3		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B7D6		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B7DA
.text:0040B7DA locret_40B7DA:			       ; CODE XREF: ___crtGetLocaleInfoW+30j
.text:0040B7DA		       leave
.text:0040B7DB		       retn
.text:0040B7DB ___crtGetLocaleInfoW endp
.text:0040B7DB
.text:0040B7DC
.text:0040B7DC ; =============== S U B R O U T I N E =======================================
.text:0040B7DC
.text:0040B7DC ; Attributes: bp-based frame
.text:0040B7DC
.text:0040B7DC ; int __cdecl _crtGetLocaleInfoA_stat(localeinfo_struct *plocinfo, unsigned int Locale, unsigned	int LCType, char *lpLCData, int	cchData, int code_page)
.text:0040B7DC __crtGetLocaleInfoA_stat	proc near      ; CODE XREF: ___crtGetLocaleInfoA+24p
.text:0040B7DC
.text:0040B7DC buff_size       = dword ptr -8
.text:0040B7DC var_4	       = dword ptr -4
.text:0040B7DC plocinfo	       = dword ptr  8
.text:0040B7DC Locale	       = dword ptr  0Ch
.text:0040B7DC LCType	       = dword ptr  10h
.text:0040B7DC lpLCData	       = dword ptr  14h
.text:0040B7DC cchData	       = dword ptr  18h
.text:0040B7DC code_page       = dword ptr  1Ch
.text:0040B7DC
.text:0040B7DC		       push    ebp
.text:0040B7DD		       mov     ebp, esp
.text:0040B7DF		       push    ecx
.text:0040B7E0		       push    ecx
.text:0040B7E1		       mov     eax, ___security_cookie
.text:0040B7E6		       xor     eax, ebp
.text:0040B7E8		       mov     [ebp+var_4], eax
.text:0040B7EB		       mov     eax, f_use_1
.text:0040B7F0		       push    ebx
.text:0040B7F1		       mov     ebx, ds:__imp__GetLocaleInfoW@16	; GetLocaleInfoW(x,x,x,x)
.text:0040B7F7		       push    esi
.text:0040B7F8		       push    edi
.text:0040B7F9		       xor     edi, edi
.text:0040B7FB		       xor     esi, esi
.text:0040B7FD		       inc     edi
.text:0040B7FE		       cmp     eax, esi
.text:0040B800		       jnz     short loc_40B82E
.text:0040B802		       push    esi	       ; cchData
.text:0040B803		       push    esi	       ; lpLCData
.text:0040B804		       push    edi	       ; LCType
.text:0040B805		       push    esi	       ; Locale
.text:0040B806		       call    ebx ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040B808		       test    eax, eax
.text:0040B80A		       jz      short loc_40B814
.text:0040B80C		       mov     f_use_1,	edi
.text:0040B812		       jmp     short loc_40B843
.text:0040B814 ; ---------------------------------------------------------------------------
.text:0040B814
.text:0040B814 loc_40B814:			       ; CODE XREF: __crtGetLocaleInfoA_stat+2Ej
.text:0040B814		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040B81A		       cmp     eax, 78h
.text:0040B81D		       jnz     short loc_40B829
.text:0040B81F		       push    2
.text:0040B821		       pop     eax
.text:0040B822		       mov     f_use_1,	eax
.text:0040B827		       jmp     short loc_40B82E
.text:0040B829 ; ---------------------------------------------------------------------------
.text:0040B829
.text:0040B829 loc_40B829:			       ; CODE XREF: __crtGetLocaleInfoA_stat+41j
.text:0040B829		       mov     eax, f_use_1
.text:0040B82E
.text:0040B82E loc_40B82E:			       ; CODE XREF: __crtGetLocaleInfoA_stat+24j
.text:0040B82E					       ; __crtGetLocaleInfoA_stat+4Bj
.text:0040B82E		       cmp     eax, 2
.text:0040B831		       jz      loc_40B8F5
.text:0040B837		       cmp     eax, esi
.text:0040B839		       jz      loc_40B8F5
.text:0040B83F		       cmp     eax, edi
.text:0040B841		       jnz     short loc_40B866
.text:0040B843
.text:0040B843 loc_40B843:			       ; CODE XREF: __crtGetLocaleInfoA_stat+36j
.text:0040B843		       cmp     [ebp+code_page],	esi
.text:0040B846		       jnz     short loc_40B853
.text:0040B848		       mov     eax, [ebp+plocinfo]
.text:0040B84B		       mov     eax, [eax]
.text:0040B84D		       mov     eax, [eax+4]
.text:0040B850		       mov     [ebp+code_page],	eax
.text:0040B853
.text:0040B853 loc_40B853:			       ; CODE XREF: __crtGetLocaleInfoA_stat+6Aj
.text:0040B853		       push    esi	       ; cchData
.text:0040B854		       push    esi	       ; lpLCData
.text:0040B855		       push    [ebp+LCType]    ; LCType
.text:0040B858		       push    [ebp+Locale]    ; Locale
.text:0040B85B		       call    ebx ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040B85D		       mov     ecx, eax
.text:0040B85F		       cmp     ecx, esi
.text:0040B861		       mov     [ebp+buff_size],	ecx
.text:0040B864		       jnz     short loc_40B86D
.text:0040B866
.text:0040B866 loc_40B866:			       ; CODE XREF: __crtGetLocaleInfoA_stat+65j
.text:0040B866					       ; __crtGetLocaleInfoA_stat+B3j ...
.text:0040B866		       xor     eax, eax
.text:0040B868		       jmp     loc_40B907
.text:0040B86D ; ---------------------------------------------------------------------------
.text:0040B86D
.text:0040B86D loc_40B86D:			       ; CODE XREF: __crtGetLocaleInfoA_stat+88j
.text:0040B86D		       jle     short loc_40B8B4
.text:0040B86F		       push    0FFFFFFE0h
.text:0040B871		       xor     edx, edx
.text:0040B873		       pop     eax
.text:0040B874		       div     ecx
.text:0040B876		       cmp     eax, 2
.text:0040B879		       jb      short loc_40B8B4
.text:0040B87B		       lea     eax, [ecx+ecx+8]
.text:0040B87F		       cmp     eax, 400h
.text:0040B884		       ja      short loc_40B89C
.text:0040B886		       call    __alloca_probe_16
.text:0040B88B		       mov     edi, esp
.text:0040B88D		       cmp     edi, esi
.text:0040B88F		       jz      short loc_40B866
.text:0040B891		       mov     dword ptr [edi],	0CCCCh
.text:0040B897		       add     edi, 8
.text:0040B89A		       jmp     short loc_40B8B6
.text:0040B89C ; ---------------------------------------------------------------------------
.text:0040B89C
.text:0040B89C loc_40B89C:			       ; CODE XREF: __crtGetLocaleInfoA_stat+A8j
.text:0040B89C		       push    eax	       ; size
.text:0040B89D		       call    _malloc
.text:0040B8A2		       cmp     eax, esi
.text:0040B8A4		       pop     ecx
.text:0040B8A5		       jz      short loc_40B8B0
.text:0040B8A7		       mov     dword ptr [eax],	0DDDDh
.text:0040B8AD		       add     eax, 8
.text:0040B8B0
.text:0040B8B0 loc_40B8B0:			       ; CODE XREF: __crtGetLocaleInfoA_stat+C9j
.text:0040B8B0		       mov     edi, eax
.text:0040B8B2		       jmp     short loc_40B8B6
.text:0040B8B4 ; ---------------------------------------------------------------------------
.text:0040B8B4
.text:0040B8B4 loc_40B8B4:			       ; CODE XREF: __crtGetLocaleInfoA_stat:loc_40B86Dj
.text:0040B8B4					       ; __crtGetLocaleInfoA_stat+9Dj
.text:0040B8B4		       xor     edi, edi
.text:0040B8B6
.text:0040B8B6 loc_40B8B6:			       ; CODE XREF: __crtGetLocaleInfoA_stat+BEj
.text:0040B8B6					       ; __crtGetLocaleInfoA_stat+D6j
.text:0040B8B6		       cmp     edi, esi
.text:0040B8B8		       jz      short loc_40B866
.text:0040B8BA		       push    [ebp+buff_size] ; cchData
.text:0040B8BD		       push    edi	       ; lpLCData
.text:0040B8BE		       push    [ebp+LCType]    ; LCType
.text:0040B8C1		       push    [ebp+Locale]    ; Locale
.text:0040B8C4		       call    ebx ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040B8C6		       test    eax, eax
.text:0040B8C8		       jz      short error_cleanup_0
.text:0040B8CA		       cmp     [ebp+cchData], esi
.text:0040B8CD		       push    esi	       ; lpUsedDefaultChar
.text:0040B8CE		       push    esi	       ; lpDefaultChar
.text:0040B8CF		       jnz     short loc_40B8D5
.text:0040B8D1		       push    esi
.text:0040B8D2		       push    esi
.text:0040B8D3		       jmp     short loc_40B8DB
.text:0040B8D5 ; ---------------------------------------------------------------------------
.text:0040B8D5
.text:0040B8D5 loc_40B8D5:			       ; CODE XREF: __crtGetLocaleInfoA_stat+F3j
.text:0040B8D5		       push    [ebp+cchData]   ; cbMultiByte
.text:0040B8D8		       push    [ebp+lpLCData]  ; lpMultiByteStr
.text:0040B8DB
.text:0040B8DB loc_40B8DB:			       ; CODE XREF: __crtGetLocaleInfoA_stat+F7j
.text:0040B8DB		       push    0FFFFFFFFh      ; cchWideChar
.text:0040B8DD		       push    edi	       ; lpWideCharStr
.text:0040B8DE		       push    esi	       ; dwFlags
.text:0040B8DF		       push    [ebp+code_page] ; CodePage
.text:0040B8E2		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040B8E8		       mov     esi, eax
.text:0040B8EA
.text:0040B8EA error_cleanup_0:			       ; CODE XREF: __crtGetLocaleInfoA_stat+ECj
.text:0040B8EA		       push    edi	       ; _Memory
.text:0040B8EB		       call    __freea
.text:0040B8F0		       pop     ecx
.text:0040B8F1		       mov     eax, esi
.text:0040B8F3		       jmp     short loc_40B907
.text:0040B8F5 ; ---------------------------------------------------------------------------
.text:0040B8F5
.text:0040B8F5 loc_40B8F5:			       ; CODE XREF: __crtGetLocaleInfoA_stat+55j
.text:0040B8F5					       ; __crtGetLocaleInfoA_stat+5Dj
.text:0040B8F5		       push    [ebp+cchData]   ; cchData
.text:0040B8F8		       push    [ebp+lpLCData]  ; lpLCData
.text:0040B8FB		       push    [ebp+LCType]    ; LCType
.text:0040B8FE		       push    [ebp+Locale]    ; Locale
.text:0040B901		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040B907
.text:0040B907 loc_40B907:			       ; CODE XREF: __crtGetLocaleInfoA_stat+8Cj
.text:0040B907					       ; __crtGetLocaleInfoA_stat+117j
.text:0040B907		       lea     esp, [ebp-14h]
.text:0040B90A		       pop     edi
.text:0040B90B		       pop     esi
.text:0040B90C		       pop     ebx
.text:0040B90D		       mov     ecx, [ebp+var_4]
.text:0040B910		       xor     ecx, ebp	       ; cookie
.text:0040B912		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040B917		       leave
.text:0040B918		       retn
.text:0040B918 __crtGetLocaleInfoA_stat	endp
.text:0040B918
.text:0040B919
.text:0040B919 ; =============== S U B R O U T I N E =======================================
.text:0040B919
.text:0040B919 ; Attributes: bp-based frame
.text:0040B919
.text:0040B919 ; int __cdecl __crtGetLocaleInfoA(localeinfo_struct *plocinfo, unsigned int Locale, unsigned int	LCType,	char *lpLCData,	int cchData, int code_page)
.text:0040B919 ___crtGetLocaleInfoA proc near	       ; CODE XREF: ___getlocaleinfo+46p
.text:0040B919					       ; ___getlocaleinfo+6Bp ...
.text:0040B919
.text:0040B919 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B919 plocinfo	       = dword ptr  8
.text:0040B919 Locale	       = dword ptr  0Ch
.text:0040B919 LCType	       = dword ptr  10h
.text:0040B919 lpLCData	       = dword ptr  14h
.text:0040B919 cchData	       = dword ptr  18h
.text:0040B919 code_page       = dword ptr  1Ch
.text:0040B919
.text:0040B919		       push    ebp
.text:0040B91A		       mov     ebp, esp
.text:0040B91C		       sub     esp, 10h
.text:0040B91F		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B922		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B925		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B92A		       push    [ebp+code_page] ; code_page
.text:0040B92D		       lea     eax, [ebp+_loc_update]
.text:0040B930		       push    [ebp+cchData]   ; cchData
.text:0040B933		       push    [ebp+lpLCData]  ; lpLCData
.text:0040B936		       push    [ebp+LCType]    ; LCType
.text:0040B939		       push    [ebp+Locale]    ; Locale
.text:0040B93C		       push    eax	       ; plocinfo
.text:0040B93D		       call    __crtGetLocaleInfoA_stat
.text:0040B942		       add     esp, 18h
.text:0040B945		       cmp     [ebp+_loc_update.updated], 0
.text:0040B949		       jz      short locret_40B952
.text:0040B94B		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B94E		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B952
.text:0040B952 locret_40B952:			       ; CODE XREF: ___crtGetLocaleInfoA+30j
.text:0040B952		       leave
.text:0040B953		       retn
.text:0040B953 ___crtGetLocaleInfoA endp
.text:0040B953
.text:0040B954
.text:0040B954 ; =============== S U B R O U T I N E =======================================
.text:0040B954
.text:0040B954 ; Attributes: bp-based frame
.text:0040B954
.text:0040B954 ; void *__cdecl _calloc_impl(unsigned int num, unsigned int size, int *errno_tmp)
.text:0040B954 __calloc_impl   proc near	       ; CODE XREF: __calloc_crt+Ep
.text:0040B954					       ; _calloc+13p
.text:0040B954
.text:0040B954 pvReturn	       = dword ptr -1Ch
.text:0040B954 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040B954 _Expr_val       = dword ptr  8
.text:0040B954 size	       = dword ptr  0Ch
.text:0040B954 errno_tmp       = dword ptr  10h
.text:0040B954
.text:0040B954		       push    0Ch
.text:0040B956		       push    offset dword_420838
.text:0040B95B		       call    __SEH_prolog4
.text:0040B960		       mov     ecx, [ebp+_Expr_val]
.text:0040B963		       xor     edi, edi
.text:0040B965		       cmp     ecx, edi
.text:0040B967		       jbe     short loc_40B997
.text:0040B969		       push    0FFFFFFE0h
.text:0040B96B		       pop     eax
.text:0040B96C		       xor     edx, edx
.text:0040B96E		       div     ecx
.text:0040B970		       cmp     eax, [ebp+size]
.text:0040B973		       sbb     eax, eax
.text:0040B975		       inc     eax
.text:0040B976		       jnz     short loc_40B997
.text:0040B978		       call    __errno
.text:0040B97D		       mov     dword ptr [eax],	0Ch
.text:0040B983		       push    edi	       ; pReserved
.text:0040B984		       push    edi	       ; nLine
.text:0040B985		       push    edi	       ; pszFile
.text:0040B986		       push    edi	       ; pszFunction
.text:0040B987		       push    edi	       ; pszExpression
.text:0040B988		       call    __invalid_parameter
.text:0040B98D		       add     esp, 14h
.text:0040B990
.text:0040B990 loc_40B990:			       ; CODE XREF: __calloc_impl+E6j
.text:0040B990					       ; __calloc_impl+F2j
.text:0040B990		       xor     eax, eax
.text:0040B992		       jmp     loc_40BA6C
.text:0040B997 ; ---------------------------------------------------------------------------
.text:0040B997
.text:0040B997 loc_40B997:			       ; CODE XREF: __calloc_impl+13j
.text:0040B997					       ; __calloc_impl+22j
.text:0040B997		       imul    ecx, [ebp+size]
.text:0040B99B		       mov     esi, ecx
.text:0040B99D		       mov     [ebp+_Expr_val],	esi
.text:0040B9A0		       cmp     esi, edi
.text:0040B9A2		       jnz     short loc_40B9A7
.text:0040B9A4		       xor     esi, esi
.text:0040B9A6		       inc     esi
.text:0040B9A7
.text:0040B9A7 loc_40B9A7:			       ; CODE XREF: __calloc_impl+4Ej
.text:0040B9A7					       ; __calloc_impl+DBj
.text:0040B9A7		       xor     ebx, ebx
.text:0040B9A9		       mov     [ebp+pvReturn], ebx
.text:0040B9AC		       cmp     esi, 0FFFFFFE0h
.text:0040B9AF		       ja      short loc_40BA1A
.text:0040B9B1		       cmp     ___active_heap, 3
.text:0040B9B8		       jnz     short loc_40BA05
.text:0040B9BA		       add     esi, 0Fh
.text:0040B9BD		       and     esi, 0FFFFFFF0h
.text:0040B9C0		       mov     [ebp+size], esi
.text:0040B9C3		       mov     eax, [ebp+_Expr_val]
.text:0040B9C6		       cmp     eax, ___sbh_threshold
.text:0040B9CC		       ja      short loc_40BA05
.text:0040B9CE		       push    4	       ; locknum
.text:0040B9D0		       call    __lock
.text:0040B9D5		       pop     ecx
.text:0040B9D6		       mov     [ebp+ms_exc.disabled], edi
.text:0040B9D9		       push    [ebp+_Expr_val] ; intSize
.text:0040B9DC		       call    ___sbh_alloc_block
.text:0040B9E1		       pop     ecx
.text:0040B9E2		       mov     [ebp+pvReturn], eax
.text:0040B9E5		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040B9EC		       call    $LN24_2
.text:0040B9F1
.text:0040B9F1 $LN25_2:
.text:0040B9F1		       mov     ebx, [ebp+pvReturn]
.text:0040B9F4		       cmp     ebx, edi
.text:0040B9F6		       jz      short loc_40BA09
.text:0040B9F8		       push    [ebp+_Expr_val] ; count
.text:0040B9FB		       push    edi	       ; value
.text:0040B9FC		       push    ebx	       ; dst
.text:0040B9FD		       call    _memset
.text:0040BA02		       add     esp, 0Ch
.text:0040BA05
.text:0040BA05 loc_40BA05:			       ; CODE XREF: __calloc_impl+64j
.text:0040BA05					       ; __calloc_impl+78j
.text:0040BA05		       cmp     ebx, edi
.text:0040BA07		       jnz     short loc_40BA6A
.text:0040BA09
.text:0040BA09 loc_40BA09:			       ; CODE XREF: __calloc_impl+A2j
.text:0040BA09		       push    esi	       ; dwBytes
.text:0040BA0A		       push    8	       ; dwFlags
.text:0040BA0C		       push    __crtheap       ; hHeap
.text:0040BA12		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:0040BA18		       mov     ebx, eax
.text:0040BA1A
.text:0040BA1A loc_40BA1A:			       ; CODE XREF: __calloc_impl+5Bj
.text:0040BA1A		       cmp     ebx, edi
.text:0040BA1C		       jnz     short loc_40BA6A
.text:0040BA1E		       cmp     __newmode, edi
.text:0040BA24		       jz      short loc_40BA59
.text:0040BA26		       push    esi	       ; size
.text:0040BA27		       call    __callnewh
.text:0040BA2C		       pop     ecx
.text:0040BA2D		       test    eax, eax
.text:0040BA2F		       jnz     loc_40B9A7
.text:0040BA35		       mov     eax, [ebp+errno_tmp]
.text:0040BA38		       cmp     eax, edi
.text:0040BA3A		       jz      loc_40B990
.text:0040BA40		       mov     dword ptr [eax],	0Ch
.text:0040BA46		       jmp     loc_40B990
.text:0040BA4B ; ---------------------------------------------------------------------------
.text:0040BA4B
.text:0040BA4B $LN22_2:				       ; DATA XREF: .rdata:00420850o
.text:0040BA4B		       xor     edi, edi
.text:0040BA4D		       mov     esi, [ebp+size]
.text:0040BA50
.text:0040BA50 $LN24_2:				       ; CODE XREF: __calloc_impl+98p
.text:0040BA50		       push    4	       ; locknum
.text:0040BA52		       call    __unlock
.text:0040BA57		       pop     ecx
.text:0040BA58
.text:0040BA58 $LN23_2:
.text:0040BA58		       retn
.text:0040BA59 ; ---------------------------------------------------------------------------
.text:0040BA59
.text:0040BA59 loc_40BA59:			       ; CODE XREF: __calloc_impl+D0j
.text:0040BA59		       cmp     ebx, edi
.text:0040BA5B		       jnz     short loc_40BA6A
.text:0040BA5D		       mov     eax, [ebp+errno_tmp]
.text:0040BA60		       cmp     eax, edi
.text:0040BA62		       jz      short loc_40BA6A
.text:0040BA64		       mov     dword ptr [eax],	0Ch
.text:0040BA6A
.text:0040BA6A loc_40BA6A:			       ; CODE XREF: __calloc_impl+B3j
.text:0040BA6A					       ; __calloc_impl+C8j ...
.text:0040BA6A		       mov     eax, ebx
.text:0040BA6C
.text:0040BA6C loc_40BA6C:			       ; CODE XREF: __calloc_impl+3Ej
.text:0040BA6C		       call    __SEH_epilog4
.text:0040BA71		       retn
.text:0040BA71 __calloc_impl   endp ; sp-analysis failed
.text:0040BA71
.text:0040BA72
.text:0040BA72 ; =============== S U B R O U T I N E =======================================
.text:0040BA72
.text:0040BA72 ; Attributes: bp-based frame
.text:0040BA72
.text:0040BA72 ; void *__cdecl calloc(unsigned int num,	unsigned int size)
.text:0040BA72 _calloc	       proc near	       ; CODE XREF: _dupenv_s_helper+53p
.text:0040BA72					       ; __dupenv_s+79p
.text:0040BA72
.text:0040BA72 errno_tmp       = dword ptr -4
.text:0040BA72 num	       = dword ptr  8
.text:0040BA72 size	       = dword ptr  0Ch
.text:0040BA72
.text:0040BA72		       push    ebp
.text:0040BA73		       mov     ebp, esp
.text:0040BA75		       push    ecx
.text:0040BA76		       and     [ebp+errno_tmp],	0
.text:0040BA7A		       push    edi
.text:0040BA7B		       lea     eax, [ebp+errno_tmp]
.text:0040BA7E		       push    eax	       ; errno_tmp
.text:0040BA7F		       push    [ebp+size]      ; size
.text:0040BA82		       push    [ebp+num]       ; num
.text:0040BA85		       call    __calloc_impl
.text:0040BA8A		       mov     edi, eax
.text:0040BA8C		       add     esp, 0Ch
.text:0040BA8F		       test    edi, edi
.text:0040BA91		       jnz     short loc_40BAAC
.text:0040BA93		       push    esi
.text:0040BA94		       mov     esi, [ebp+errno_tmp]
.text:0040BA97		       test    esi, esi
.text:0040BA99		       jz      short loc_40BAAB
.text:0040BA9B		       call    __errno
.text:0040BAA0		       test    eax, eax
.text:0040BAA2		       jz      short loc_40BAAB
.text:0040BAA4		       call    __errno
.text:0040BAA9		       mov     [eax], esi
.text:0040BAAB
.text:0040BAAB loc_40BAAB:			       ; CODE XREF: _calloc+27j
.text:0040BAAB					       ; _calloc+30j
.text:0040BAAB		       pop     esi
.text:0040BAAC
.text:0040BAAC loc_40BAAC:			       ; CODE XREF: _calloc+1Fj
.text:0040BAAC		       mov     eax, edi
.text:0040BAAE		       pop     edi
.text:0040BAAF		       leave
.text:0040BAB0		       retn
.text:0040BAB0 _calloc	       endp
.text:0040BAB0
.text:0040BAB1
.text:0040BAB1 ; =============== S U B R O U T I N E =======================================
.text:0040BAB1
.text:0040BAB1 ; Attributes: bp-based frame
.text:0040BAB1
.text:0040BAB1 ; void *__cdecl realloc(void *pBlock, unsigned int newsize)
.text:0040BAB1 _realloc	       proc near	       ; CODE XREF: __realloc_crt+Cp
.text:0040BAB1					       ; __recalloc+51p
.text:0040BAB1
.text:0040BAB1 pHeader	       = dword ptr -20h
.text:0040BAB1 pvReturn	       = dword ptr -1Ch
.text:0040BAB1 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040BAB1 pBlock	       = dword ptr  8
.text:0040BAB1 newsize	       = dword ptr  0Ch
.text:0040BAB1
.text:0040BAB1		       push    10h
.text:0040BAB3		       push    offset dword_420858
.text:0040BAB8		       call    __SEH_prolog4
.text:0040BABD		       mov     ebx, [ebp+pBlock]
.text:0040BAC0		       test    ebx, ebx
.text:0040BAC2		       jnz     short loc_40BAD2
.text:0040BAC4		       push    [ebp+newsize]   ; size
.text:0040BAC7		       call    _malloc
.text:0040BACC		       pop     ecx
.text:0040BACD		       jmp     loc_40BC9E
.text:0040BAD2 ; ---------------------------------------------------------------------------
.text:0040BAD2
.text:0040BAD2 loc_40BAD2:			       ; CODE XREF: _realloc+11j
.text:0040BAD2		       mov     esi, [ebp+newsize]
.text:0040BAD5		       test    esi, esi
.text:0040BAD7		       jnz     short loc_40BAE5
.text:0040BAD9		       push    ebx	       ; pBlock
.text:0040BADA		       call    _free
.text:0040BADF		       pop     ecx
.text:0040BAE0		       jmp     loc_40BC9C
.text:0040BAE5 ; ---------------------------------------------------------------------------
.text:0040BAE5
.text:0040BAE5 loc_40BAE5:			       ; CODE XREF: _realloc+26j
.text:0040BAE5		       cmp     ___active_heap, 3
.text:0040BAEC		       jnz     loc_40BC85
.text:0040BAF2
.text:0040BAF2 loc_40BAF2:			       ; CODE XREF: _realloc+169j
.text:0040BAF2		       xor     edi, edi
.text:0040BAF4		       mov     [ebp+pvReturn], edi
.text:0040BAF7		       cmp     esi, 0FFFFFFE0h
.text:0040BAFA		       ja      loc_40BC8A
.text:0040BB00		       push    4	       ; locknum
.text:0040BB02		       call    __lock
.text:0040BB07		       pop     ecx
.text:0040BB08		       mov     [ebp+ms_exc.disabled], edi
.text:0040BB0B		       push    ebx	       ; pvAlloc
.text:0040BB0C		       call    ___sbh_find_block
.text:0040BB11		       pop     ecx
.text:0040BB12		       mov     [ebp+pHeader], eax
.text:0040BB15		       cmp     eax, edi
.text:0040BB17		       jz      loc_40BBBB
.text:0040BB1D		       cmp     esi, ___sbh_threshold
.text:0040BB23		       ja      short loc_40BB6E
.text:0040BB25		       push    esi	       ; intNew
.text:0040BB26		       push    ebx	       ; pvAlloc
.text:0040BB27		       push    eax	       ; pHeader
.text:0040BB28		       call    ___sbh_resize_block
.text:0040BB2D		       add     esp, 0Ch
.text:0040BB30		       test    eax, eax
.text:0040BB32		       jz      short loc_40BB39
.text:0040BB34		       mov     [ebp+pvReturn], ebx
.text:0040BB37		       jmp     short loc_40BB6E
.text:0040BB39 ; ---------------------------------------------------------------------------
.text:0040BB39
.text:0040BB39 loc_40BB39:			       ; CODE XREF: _realloc+81j
.text:0040BB39		       push    esi	       ; intSize
.text:0040BB3A		       call    ___sbh_alloc_block
.text:0040BB3F		       pop     ecx
.text:0040BB40		       mov     [ebp+pvReturn], eax
.text:0040BB43		       cmp     eax, edi
.text:0040BB45		       jz      short loc_40BB6E
.text:0040BB47		       mov     eax, [ebx-4]
.text:0040BB4A		       dec     eax
.text:0040BB4B		       cmp     eax, esi
.text:0040BB4D		       jb      short loc_40BB51
.text:0040BB4F		       mov     eax, esi
.text:0040BB51
.text:0040BB51 loc_40BB51:			       ; CODE XREF: _realloc+9Cj
.text:0040BB51		       push    eax	       ; count
.text:0040BB52		       push    ebx	       ; src
.text:0040BB53		       push    [ebp+pvReturn]  ; dst
.text:0040BB56		       call    _memcpy
.text:0040BB5B		       push    ebx	       ; pvAlloc
.text:0040BB5C		       call    ___sbh_find_block
.text:0040BB61		       mov     [ebp+pHeader], eax
.text:0040BB64		       push    ebx	       ; pvAlloc
.text:0040BB65		       push    eax	       ; pHeader
.text:0040BB66		       call    ___sbh_free_block
.text:0040BB6B		       add     esp, 18h
.text:0040BB6E
.text:0040BB6E loc_40BB6E:			       ; CODE XREF: _realloc+72j
.text:0040BB6E					       ; _realloc+86j ...
.text:0040BB6E		       cmp     [ebp+pvReturn], edi
.text:0040BB71		       jnz     short loc_40BBBB
.text:0040BB73		       cmp     esi, edi
.text:0040BB75		       jnz     short loc_40BB7D
.text:0040BB77		       xor     esi, esi
.text:0040BB79		       inc     esi
.text:0040BB7A		       mov     [ebp+newsize], esi
.text:0040BB7D
.text:0040BB7D loc_40BB7D:			       ; CODE XREF: _realloc+C4j
.text:0040BB7D		       add     esi, 0Fh
.text:0040BB80		       and     esi, 0FFFFFFF0h
.text:0040BB83		       mov     [ebp+newsize], esi
.text:0040BB86		       push    esi	       ; dwBytes
.text:0040BB87		       push    edi	       ; dwFlags
.text:0040BB88		       push    __crtheap       ; hHeap
.text:0040BB8E		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:0040BB94		       mov     [ebp+pvReturn], eax
.text:0040BB97		       cmp     eax, edi
.text:0040BB99		       jz      short loc_40BBBB
.text:0040BB9B		       mov     eax, [ebx-4]
.text:0040BB9E		       dec     eax
.text:0040BB9F		       cmp     eax, esi
.text:0040BBA1		       jb      short loc_40BBA5
.text:0040BBA3		       mov     eax, esi
.text:0040BBA5
.text:0040BBA5 loc_40BBA5:			       ; CODE XREF: _realloc+F0j
.text:0040BBA5		       push    eax	       ; count
.text:0040BBA6		       push    ebx	       ; src
.text:0040BBA7		       push    [ebp+pvReturn]  ; dst
.text:0040BBAA		       call    _memcpy
.text:0040BBAF		       push    ebx	       ; pvAlloc
.text:0040BBB0		       push    [ebp+pHeader]   ; pHeader
.text:0040BBB3		       call    ___sbh_free_block
.text:0040BBB8		       add     esp, 14h
.text:0040BBBB
.text:0040BBBB loc_40BBBB:			       ; CODE XREF: _realloc+66j
.text:0040BBBB					       ; _realloc+C0j ...
.text:0040BBBB		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040BBC2		       call    $LN48
.text:0040BBC7
.text:0040BBC7 $LN49:
.text:0040BBC7		       cmp     [ebp+pHeader], 0
.text:0040BBCB		       jnz     short loc_40BBFE
.text:0040BBCD		       test    esi, esi
.text:0040BBCF		       jnz     short loc_40BBD2
.text:0040BBD1		       inc     esi
.text:0040BBD2
.text:0040BBD2 loc_40BBD2:			       ; CODE XREF: _realloc+11Ej
.text:0040BBD2		       add     esi, 0Fh
.text:0040BBD5		       and     esi, 0FFFFFFF0h
.text:0040BBD8		       mov     [ebp+newsize], esi
.text:0040BBDB		       push    esi	       ; dwBytes
.text:0040BBDC		       push    ebx	       ; lpMem
.text:0040BBDD		       push    0	       ; dwFlags
.text:0040BBDF		       push    __crtheap       ; hHeap
.text:0040BBE5		       call    ds:__imp__HeapReAlloc@16	; HeapReAlloc(x,x,x,x)
.text:0040BBEB		       mov     edi, eax
.text:0040BBED		       jmp     short loc_40BC01
.text:0040BBEF ; ---------------------------------------------------------------------------
.text:0040BBEF
.text:0040BBEF $LN46:				       ; DATA XREF: .rdata:00420870o
.text:0040BBEF		       mov     esi, [ebp+newsize]
.text:0040BBF2		       mov     ebx, [ebp+pBlock]
.text:0040BBF5
.text:0040BBF5 $LN48:				       ; CODE XREF: _realloc+111p
.text:0040BBF5		       push    4	       ; locknum
.text:0040BBF7		       call    __unlock
.text:0040BBFC		       pop     ecx
.text:0040BBFD
.text:0040BBFD $LN47:
.text:0040BBFD		       retn
.text:0040BBFE ; ---------------------------------------------------------------------------
.text:0040BBFE
.text:0040BBFE loc_40BBFE:			       ; CODE XREF: _realloc+11Aj
.text:0040BBFE		       mov     edi, [ebp+pvReturn]
.text:0040BC01
.text:0040BC01 loc_40BC01:			       ; CODE XREF: _realloc+13Cj
.text:0040BC01		       test    edi, edi
.text:0040BC03		       jnz     loc_40BCC8
.text:0040BC09		       cmp     __newmode, edi
.text:0040BC0F		       jz      short loc_40BC3D
.text:0040BC11		       push    esi	       ; size
.text:0040BC12		       call    __callnewh
.text:0040BC17		       pop     ecx
.text:0040BC18		       test    eax, eax
.text:0040BC1A		       jnz     loc_40BAF2
.text:0040BC20		       call    __errno
.text:0040BC25		       cmp     [ebp+pHeader], edi
.text:0040BC28		       jnz     short loc_40BC96
.text:0040BC2A
.text:0040BC2A loc_40BC2A:			       ; CODE XREF: _realloc+1F8j
.text:0040BC2A		       mov     esi, eax
.text:0040BC2C		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040BC32		       push    eax	       ; oserrno
.text:0040BC33		       call    __get_errno_from_oserr
.text:0040BC38		       pop     ecx
.text:0040BC39		       mov     [esi], eax
.text:0040BC3B		       jmp     short loc_40BC9C
.text:0040BC3D ; ---------------------------------------------------------------------------
.text:0040BC3D
.text:0040BC3D loc_40BC3D:			       ; CODE XREF: _realloc+15Ej
.text:0040BC3D		       test    edi, edi
.text:0040BC3F		       jnz     loc_40BCC8
.text:0040BC45		       call    __errno
.text:0040BC4A		       cmp     [ebp+pHeader], edi
.text:0040BC4D		       jz      short loc_40BCB7
.text:0040BC4F		       mov     dword ptr [eax],	0Ch
.text:0040BC55		       jmp     short loc_40BCC8
.text:0040BC57 ; ---------------------------------------------------------------------------
.text:0040BC57
.text:0040BC57 loc_40BC57:			       ; CODE XREF: _realloc+1D7j
.text:0040BC57		       test    esi, esi
.text:0040BC59		       jnz     short loc_40BC5C
.text:0040BC5B		       inc     esi
.text:0040BC5C
.text:0040BC5C loc_40BC5C:			       ; CODE XREF: _realloc+1A8j
.text:0040BC5C		       push    esi	       ; dwBytes
.text:0040BC5D		       push    ebx	       ; lpMem
.text:0040BC5E		       push    0	       ; dwFlags
.text:0040BC60		       push    __crtheap       ; hHeap
.text:0040BC66		       call    ds:__imp__HeapReAlloc@16	; HeapReAlloc(x,x,x,x)
.text:0040BC6C		       mov     edi, eax
.text:0040BC6E		       test    edi, edi
.text:0040BC70		       jnz     short loc_40BCC8
.text:0040BC72		       cmp     __newmode, eax
.text:0040BC78		       jz      short loc_40BCAE
.text:0040BC7A		       push    esi	       ; size
.text:0040BC7B		       call    __callnewh
.text:0040BC80		       pop     ecx
.text:0040BC81		       test    eax, eax
.text:0040BC83		       jz      short loc_40BCA4
.text:0040BC85
.text:0040BC85 loc_40BC85:			       ; CODE XREF: _realloc+3Bj
.text:0040BC85		       cmp     esi, 0FFFFFFE0h
.text:0040BC88		       jbe     short loc_40BC57
.text:0040BC8A
.text:0040BC8A loc_40BC8A:			       ; CODE XREF: _realloc+49j
.text:0040BC8A		       push    esi	       ; size
.text:0040BC8B		       call    __callnewh
.text:0040BC90		       pop     ecx
.text:0040BC91		       call    __errno
.text:0040BC96
.text:0040BC96 loc_40BC96:			       ; CODE XREF: _realloc+177j
.text:0040BC96		       mov     dword ptr [eax],	0Ch
.text:0040BC9C
.text:0040BC9C loc_40BC9C:			       ; CODE XREF: _realloc+2Fj
.text:0040BC9C					       ; _realloc+18Aj
.text:0040BC9C		       xor     eax, eax
.text:0040BC9E
.text:0040BC9E loc_40BC9E:			       ; CODE XREF: _realloc+1Cj
.text:0040BC9E					       ; _realloc+219j
.text:0040BC9E		       call    __SEH_epilog4
.text:0040BCA3		       retn
.text:0040BCA4 ; ---------------------------------------------------------------------------
.text:0040BCA4
.text:0040BCA4 loc_40BCA4:			       ; CODE XREF: _realloc+1D2j
.text:0040BCA4		       call    __errno
.text:0040BCA9		       jmp     loc_40BC2A
.text:0040BCAE ; ---------------------------------------------------------------------------
.text:0040BCAE
.text:0040BCAE loc_40BCAE:			       ; CODE XREF: _realloc+1C7j
.text:0040BCAE		       test    edi, edi
.text:0040BCB0		       jnz     short loc_40BCC8
.text:0040BCB2		       call    __errno
.text:0040BCB7
.text:0040BCB7 loc_40BCB7:			       ; CODE XREF: _realloc+19Cj
.text:0040BCB7		       mov     esi, eax
.text:0040BCB9		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040BCBF		       push    eax	       ; oserrno
.text:0040BCC0		       call    __get_errno_from_oserr
.text:0040BCC5		       mov     [esi], eax
.text:0040BCC7		       pop     ecx
.text:0040BCC8
.text:0040BCC8 loc_40BCC8:			       ; CODE XREF: _realloc+152j
.text:0040BCC8					       ; _realloc+18Ej	...
.text:0040BCC8		       mov     eax, edi
.text:0040BCCA		       jmp     short loc_40BC9E
.text:0040BCCA _realloc	       endp ; sp-analysis failed
.text:0040BCCA
.text:0040BCCC
.text:0040BCCC ; =============== S U B R O U T I N E =======================================
.text:0040BCCC
.text:0040BCCC ; Attributes: bp-based frame
.text:0040BCCC
.text:0040BCCC ; void *__cdecl _recalloc(void *memblock, unsigned int count, unsigned int size)
.text:0040BCCC __recalloc      proc near	       ; CODE XREF: __recalloc_crt+10p
.text:0040BCCC
.text:0040BCCC memblock	       = dword ptr  8
.text:0040BCCC count	       = dword ptr  0Ch
.text:0040BCCC size	       = dword ptr  10h
.text:0040BCCC
.text:0040BCCC		       push    ebp
.text:0040BCCD		       mov     ebp, esp
.text:0040BCCF		       mov     ecx, [ebp+count]
.text:0040BCD2		       push    ebx
.text:0040BCD3		       xor     ebx, ebx
.text:0040BCD5		       cmp     ecx, ebx
.text:0040BCD7		       jbe     short loc_40BD01
.text:0040BCD9		       push    0FFFFFFE0h
.text:0040BCDB		       xor     edx, edx
.text:0040BCDD		       pop     eax
.text:0040BCDE		       div     ecx
.text:0040BCE0		       cmp     eax, [ebp+size]
.text:0040BCE3		       jnb     short loc_40BD01
.text:0040BCE5		       call    __errno
.text:0040BCEA		       push    ebx	       ; pReserved
.text:0040BCEB		       push    ebx	       ; nLine
.text:0040BCEC		       push    ebx	       ; pszFile
.text:0040BCED		       push    ebx	       ; pszFunction
.text:0040BCEE		       push    ebx	       ; pszExpression
.text:0040BCEF		       mov     dword ptr [eax],	0Ch
.text:0040BCF5		       call    __invalid_parameter
.text:0040BCFA		       add     esp, 14h
.text:0040BCFD		       xor     eax, eax
.text:0040BCFF		       jmp     short loc_40BD42
.text:0040BD01 ; ---------------------------------------------------------------------------
.text:0040BD01
.text:0040BD01 loc_40BD01:			       ; CODE XREF: __recalloc+Bj
.text:0040BD01					       ; __recalloc+17j
.text:0040BD01		       imul    ecx, [ebp+size]
.text:0040BD05		       cmp     [ebp+memblock], ebx
.text:0040BD08		       push    esi
.text:0040BD09		       push    edi
.text:0040BD0A		       mov     esi, ecx
.text:0040BD0C		       jz      short loc_40BD19
.text:0040BD0E		       push    [ebp+memblock]  ; pblock
.text:0040BD11		       call    __msize
.text:0040BD16		       pop     ecx
.text:0040BD17		       mov     ebx, eax
.text:0040BD19
.text:0040BD19 loc_40BD19:			       ; CODE XREF: __recalloc+40j
.text:0040BD19		       push    esi	       ; newsize
.text:0040BD1A		       push    [ebp+memblock]  ; pBlock
.text:0040BD1D		       call    _realloc
.text:0040BD22		       mov     edi, eax
.text:0040BD24		       test    edi, edi
.text:0040BD26		       pop     ecx
.text:0040BD27		       pop     ecx
.text:0040BD28		       jz      short loc_40BD3E
.text:0040BD2A		       cmp     ebx, esi
.text:0040BD2C		       jnb     short loc_40BD3E
.text:0040BD2E		       sub     esi, ebx
.text:0040BD30		       push    esi	       ; count
.text:0040BD31		       push    0	       ; value
.text:0040BD33		       add     ebx, edi
.text:0040BD35		       push    ebx	       ; dst
.text:0040BD36		       call    _memset
.text:0040BD3B		       add     esp, 0Ch
.text:0040BD3E
.text:0040BD3E loc_40BD3E:			       ; CODE XREF: __recalloc+5Cj
.text:0040BD3E					       ; __recalloc+60j
.text:0040BD3E		       mov     eax, edi
.text:0040BD40		       pop     edi
.text:0040BD41		       pop     esi
.text:0040BD42
.text:0040BD42 loc_40BD42:			       ; CODE XREF: __recalloc+33j
.text:0040BD42		       pop     ebx
.text:0040BD43		       pop     ebp
.text:0040BD44		       retn
.text:0040BD44 __recalloc      endp
.text:0040BD44
.text:0040BD45
.text:0040BD45 ; =============== S U B R O U T I N E =======================================
.text:0040BD45
.text:0040BD45
.text:0040BD45 ; int __cdecl _fclose_nolock(_iobuf *str)
.text:0040BD45 __fclose_nolock proc near	       ; CODE XREF: _fclose+5Ap
.text:0040BD45
.text:0040BD45 str	       = dword ptr  4
.text:0040BD45
.text:0040BD45		       push    ebx
.text:0040BD46		       push    esi
.text:0040BD47		       mov     esi, [esp+8+str]
.text:0040BD4B		       push    edi
.text:0040BD4C		       xor     edi, edi
.text:0040BD4E		       or      ebx, 0FFFFFFFFh
.text:0040BD51		       cmp     esi, edi
.text:0040BD53		       jnz     short loc_40BD71
.text:0040BD55		       call    __errno
.text:0040BD5A		       push    edi	       ; pReserved
.text:0040BD5B		       push    edi	       ; nLine
.text:0040BD5C		       push    edi	       ; pszFile
.text:0040BD5D		       push    edi	       ; pszFunction
.text:0040BD5E		       push    edi	       ; pszExpression
.text:0040BD5F		       mov     dword ptr [eax],	16h
.text:0040BD65		       call    __invalid_parameter
.text:0040BD6A		       add     esp, 14h
.text:0040BD6D		       or      eax, ebx
.text:0040BD6F		       jmp     short loc_40BDB3
.text:0040BD71 ; ---------------------------------------------------------------------------
.text:0040BD71
.text:0040BD71 loc_40BD71:			       ; CODE XREF: __fclose_nolock+Ej
.text:0040BD71		       test    byte ptr	[esi+0Ch], 83h
.text:0040BD75		       jz      short loc_40BDAE
.text:0040BD77		       push    esi	       ; str
.text:0040BD78		       call    __flush
.text:0040BD7D		       push    esi	       ; stream
.text:0040BD7E		       mov     ebx, eax
.text:0040BD80		       call    __freebuf
.text:0040BD85		       push    esi	       ; stream
.text:0040BD86		       call    __fileno
.text:0040BD8B		       push    eax	       ; fh
.text:0040BD8C		       call    __close
.text:0040BD91		       add     esp, 10h
.text:0040BD94		       test    eax, eax
.text:0040BD96		       jge     short loc_40BD9D
.text:0040BD98		       or      ebx, 0FFFFFFFFh
.text:0040BD9B		       jmp     short loc_40BDAE
.text:0040BD9D ; ---------------------------------------------------------------------------
.text:0040BD9D
.text:0040BD9D loc_40BD9D:			       ; CODE XREF: __fclose_nolock+51j
.text:0040BD9D		       mov     eax, [esi+1Ch]
.text:0040BDA0		       cmp     eax, edi
.text:0040BDA2		       jz      short loc_40BDAE
.text:0040BDA4		       push    eax	       ; pBlock
.text:0040BDA5		       call    _free
.text:0040BDAA		       pop     ecx
.text:0040BDAB		       mov     [esi+1Ch], edi
.text:0040BDAE
.text:0040BDAE loc_40BDAE:			       ; CODE XREF: __fclose_nolock+30j
.text:0040BDAE					       ; __fclose_nolock+56j ...
.text:0040BDAE		       mov     [esi+0Ch], edi
.text:0040BDB1		       mov     eax, ebx
.text:0040BDB3
.text:0040BDB3 loc_40BDB3:			       ; CODE XREF: __fclose_nolock+2Aj
.text:0040BDB3		       pop     edi
.text:0040BDB4		       pop     esi
.text:0040BDB5		       pop     ebx
.text:0040BDB6		       retn
.text:0040BDB6 __fclose_nolock endp
.text:0040BDB6
.text:0040BDB7
.text:0040BDB7 ; =============== S U B R O U T I N E =======================================
.text:0040BDB7
.text:0040BDB7 ; Attributes: bp-based frame
.text:0040BDB7
.text:0040BDB7 ; int __cdecl fclose(_iobuf *stream)
.text:0040BDB7 _fclose	       proc near	       ; CODE XREF: __fcloseall+43p
.text:0040BDB7
.text:0040BDB7 result	       = dword ptr -1Ch
.text:0040BDB7 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040BDB7 stream	       = dword ptr  8
.text:0040BDB7
.text:0040BDB7		       push    0Ch
.text:0040BDB9		       push    offset dword_420878
.text:0040BDBE		       call    __SEH_prolog4
.text:0040BDC3		       or      [ebp+result], 0FFFFFFFFh
.text:0040BDC7		       xor     eax, eax
.text:0040BDC9		       mov     esi, [ebp+stream]
.text:0040BDCC		       xor     edi, edi
.text:0040BDCE		       cmp     esi, edi
.text:0040BDD0		       setnz   al
.text:0040BDD3		       cmp     eax, edi
.text:0040BDD5		       jnz     short loc_40BDF4
.text:0040BDD7		       call    __errno
.text:0040BDDC		       mov     dword ptr [eax],	16h
.text:0040BDE2		       push    edi	       ; pReserved
.text:0040BDE3		       push    edi	       ; nLine
.text:0040BDE4		       push    edi	       ; pszFile
.text:0040BDE5		       push    edi	       ; pszFunction
.text:0040BDE6		       push    edi	       ; pszExpression
.text:0040BDE7		       call    __invalid_parameter
.text:0040BDEC		       add     esp, 14h
.text:0040BDEF		       or      eax, 0FFFFFFFFh
.text:0040BDF2		       jmp     short loc_40BE00
.text:0040BDF4 ; ---------------------------------------------------------------------------
.text:0040BDF4
.text:0040BDF4 loc_40BDF4:			       ; CODE XREF: _fclose+1Ej
.text:0040BDF4		       test    byte ptr	[esi+0Ch], 40h
.text:0040BDF8		       jz      short loc_40BE06
.text:0040BDFA		       mov     [esi+0Ch], edi
.text:0040BDFD
.text:0040BDFD $LN11_6:				       ; CODE XREF: _fclose+6Fj
.text:0040BDFD		       mov     eax, [ebp+result]
.text:0040BE00
.text:0040BE00 loc_40BE00:			       ; CODE XREF: _fclose+3Bj
.text:0040BE00		       call    __SEH_epilog4
.text:0040BE05		       retn
.text:0040BE06 ; ---------------------------------------------------------------------------
.text:0040BE06
.text:0040BE06 loc_40BE06:			       ; CODE XREF: _fclose+41j
.text:0040BE06		       push    esi	       ; pf
.text:0040BE07		       call    __lock_file
.text:0040BE0C		       pop     ecx
.text:0040BE0D		       mov     [ebp+ms_exc.disabled], edi
.text:0040BE10		       push    esi	       ; str
.text:0040BE11		       call    __fclose_nolock
.text:0040BE16		       pop     ecx
.text:0040BE17		       mov     [ebp+result], eax
.text:0040BE1A		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040BE21		       call    $LN10_5
.text:0040BE26		       jmp     short $LN11_6
.text:0040BE28 ; ---------------------------------------------------------------------------
.text:0040BE28
.text:0040BE28 $LN8_4:				       ; DATA XREF: .rdata:00420890o
.text:0040BE28		       mov     esi, [ebp+stream]
.text:0040BE2B
.text:0040BE2B $LN10_5:				       ; CODE XREF: _fclose+6Ap
.text:0040BE2B		       push    esi	       ; pf
.text:0040BE2C		       call    __unlock_file
.text:0040BE31		       pop     ecx
.text:0040BE32
.text:0040BE32 $LN9_7:
.text:0040BE32		       retn
.text:0040BE32 _fclose	       endp ; sp-analysis failed
.text:0040BE32
.text:0040BE33
.text:0040BE33 ; =============== S U B R O U T I N E =======================================
.text:0040BE33
.text:0040BE33 ; Attributes: bp-based frame fpd=514h
.text:0040BE33
.text:0040BE33 ; int __cdecl _write_nolock(int fh, const void *buf, unsigned int cnt)
.text:0040BE33 __write_nolock  proc near	       ; CODE XREF: __write+9Ap
.text:0040BE33
.text:0040BE33 consoleCP       = dword ptr -590h
.text:0040BE33 bCR	       = dword ptr -58Ch
.text:0040BE33 tmode	       = byte ptr -585h
.text:0040BE33 var_584	       = dword ptr -584h
.text:0040BE33 written	       = dword ptr -580h
.text:0040BE33 lfcount	       = dword ptr -57Ch
.text:0040BE33 lpBuffer	       = dword ptr -578h
.text:0040BE33 charcount       = dword ptr -574h
.text:0040BE33 p	       = dword ptr -570h
.text:0040BE33 tmpchar	       = dword ptr -56Ch
.text:0040BE33 pu	       = dword ptr -568h
.text:0040BE33 utf8_buf	       = byte ptr -564h
.text:0040BE33 utf16_buf       = word ptr -160h
.text:0040BE33 mboutbuf	       = byte ptr -0Ch
.text:0040BE33 var_4	       = dword ptr -4
.text:0040BE33 fh	       = dword ptr  8
.text:0040BE33 buf	       = dword ptr  0Ch
.text:0040BE33 cnt	       = dword ptr  10h
.text:0040BE33
.text:0040BE33		       push    ebp
.text:0040BE34		       lea     ebp, [esp-514h]
.text:0040BE3B		       sub     esp, 590h
.text:0040BE41		       mov     eax, ___security_cookie
.text:0040BE46		       xor     eax, ebp
.text:0040BE48		       mov     [ebp+514h+var_4], eax
.text:0040BE4E		       mov     eax, [ebp+514h+buf]
.text:0040BE54		       push    esi
.text:0040BE55		       xor     esi, esi
.text:0040BE57		       cmp     [ebp+514h+cnt], esi
.text:0040BE5D		       mov     [ebp+514h+lpBuffer], eax
.text:0040BE60		       mov     [ebp+514h+charcount], esi
.text:0040BE63		       mov     [ebp+514h+lfcount], esi
.text:0040BE66		       jnz     short loc_40BE6F
.text:0040BE68		       xor     eax, eax
.text:0040BE6A		       jmp     loc_40C43F
.text:0040BE6F ; ---------------------------------------------------------------------------
.text:0040BE6F
.text:0040BE6F loc_40BE6F:			       ; CODE XREF: __write_nolock+33j
.text:0040BE6F		       cmp     eax, esi
.text:0040BE71		       jnz     short loc_40BE9A
.text:0040BE73		       call    ___doserrno
.text:0040BE78		       mov     [eax], esi
.text:0040BE7A		       call    __errno
.text:0040BE7F		       push    esi	       ; pReserved
.text:0040BE80		       push    esi	       ; nLine
.text:0040BE81		       push    esi	       ; pszFile
.text:0040BE82		       push    esi	       ; pszFunction
.text:0040BE83		       push    esi	       ; pszExpression
.text:0040BE84		       mov     dword ptr [eax],	16h
.text:0040BE8A		       call    __invalid_parameter
.text:0040BE8F		       add     esp, 14h
.text:0040BE92		       or      eax, 0FFFFFFFFh
.text:0040BE95		       jmp     loc_40C43F
.text:0040BE9A ; ---------------------------------------------------------------------------
.text:0040BE9A
.text:0040BE9A loc_40BE9A:			       ; CODE XREF: __write_nolock+3Ej
.text:0040BE9A		       push    ebx
.text:0040BE9B		       push    edi
.text:0040BE9C		       mov     edi, [ebp+514h+fh]
.text:0040BEA2		       mov     eax, edi
.text:0040BEA4		       sar     eax, 5
.text:0040BEA7		       lea     esi, ds:422F40h[eax*4]
.text:0040BEAE		       mov     eax, [esi]
.text:0040BEB0		       and     edi, 1Fh
.text:0040BEB3		       shl     edi, 6
.text:0040BEB6		       add     eax, edi
.text:0040BEB8		       mov     bl, [eax+24h]
.text:0040BEBB		       add     bl, bl
.text:0040BEBD		       sar     bl, 1
.text:0040BEBF		       cmp     bl, 2
.text:0040BEC2		       mov     [ebp+514h+var_584], esi
.text:0040BEC5		       mov     [ebp+514h+tmode], bl
.text:0040BEC8		       jz      short loc_40BECF
.text:0040BECA		       cmp     bl, 1
.text:0040BECD		       jnz     short loc_40BF02
.text:0040BECF
.text:0040BECF loc_40BECF:			       ; CODE XREF: __write_nolock+95j
.text:0040BECF		       mov     ecx, [ebp+514h+cnt]
.text:0040BED5		       not     ecx
.text:0040BED7		       test    cl, 1
.text:0040BEDA		       jnz     short loc_40BF02
.text:0040BEDC		       call    ___doserrno
.text:0040BEE1		       xor     esi, esi
.text:0040BEE3		       mov     [eax], esi
.text:0040BEE5		       call    __errno
.text:0040BEEA		       push    esi	       ; pReserved
.text:0040BEEB		       push    esi	       ; nLine
.text:0040BEEC		       push    esi	       ; pszFile
.text:0040BEED		       push    esi	       ; pszFunction
.text:0040BEEE		       push    esi	       ; pszExpression
.text:0040BEEF		       mov     dword ptr [eax],	16h
.text:0040BEF5		       call    __invalid_parameter
.text:0040BEFA		       add     esp, 14h
.text:0040BEFD		       jmp     loc_40C432
.text:0040BF02 ; ---------------------------------------------------------------------------
.text:0040BF02
.text:0040BF02 loc_40BF02:			       ; CODE XREF: __write_nolock+9Aj
.text:0040BF02					       ; __write_nolock+A7j
.text:0040BF02		       test    byte ptr	[eax+4], 20h
.text:0040BF06		       jz      short loc_40BF1C
.text:0040BF08		       push    2	       ; mthd
.text:0040BF0A		       push    0
.text:0040BF0C		       push    0	       ; pos
.text:0040BF0E		       push    [ebp+514h+fh]   ; fh
.text:0040BF14		       call    __lseeki64_nolock
.text:0040BF19		       add     esp, 10h
.text:0040BF1C
.text:0040BF1C loc_40BF1C:			       ; CODE XREF: __write_nolock+D3j
.text:0040BF1C		       push    [ebp+514h+fh]   ; fh
.text:0040BF22		       call    __isatty
.text:0040BF27		       test    eax, eax
.text:0040BF29		       pop     ecx
.text:0040BF2A		       jz      loc_40C169
.text:0040BF30		       mov     eax, [esi]
.text:0040BF32		       test    byte ptr	[edi+eax+4], 80h
.text:0040BF37		       jz      loc_40C169
.text:0040BF3D		       call    __getptd
.text:0040BF42		       mov     eax, [eax+6Ch]
.text:0040BF45		       xor     ecx, ecx
.text:0040BF47		       cmp     [eax+14h], ecx
.text:0040BF4A		       lea     eax, [ebp+514h+consoleCP]
.text:0040BF4D		       setz    cl
.text:0040BF50		       push    eax	       ; lpMode
.text:0040BF51		       mov     eax, [esi]
.text:0040BF53		       push    dword ptr [edi+eax] ; hConsoleHandle
.text:0040BF56		       mov     [ebp+514h+bCR], ecx
.text:0040BF59		       call    ds:__imp__GetConsoleMode@8 ; GetConsoleMode(x,x)
.text:0040BF5F		       test    eax, eax
.text:0040BF61		       jz      loc_40C169
.text:0040BF67		       xor     ecx, ecx
.text:0040BF69		       cmp     [ebp+514h+bCR], ecx
.text:0040BF6C		       jz      short loc_40BF76
.text:0040BF6E		       test    bl, bl
.text:0040BF70		       jz      loc_40C16B
.text:0040BF76
.text:0040BF76 loc_40BF76:			       ; CODE XREF: __write_nolock+139j
.text:0040BF76		       call    ds:__imp__GetConsoleCP@0	; GetConsoleCP()
.text:0040BF7C		       mov     ebx, [ebp+514h+lpBuffer]
.text:0040BF7F		       mov     [ebp+514h+consoleCP], eax
.text:0040BF82		       xor     eax, eax
.text:0040BF84		       cmp     [ebp+514h+cnt], eax
.text:0040BF8A		       mov     [ebp+514h+p], eax
.text:0040BF8D		       jbe     loc_40C3DA
.text:0040BF93		       mov     [ebp+514h+pu], eax
.text:0040BF96
.text:0040BF96 loc_40BF96:			       ; CODE XREF: __write_nolock+315j
.text:0040BF96		       mov     al, [ebp+514h+tmode]
.text:0040BF99		       test    al, al
.text:0040BF9B		       jnz     loc_40C0DE
.text:0040BFA1		       mov     cl, [ebx]
.text:0040BFA3		       mov     esi, [ebp+514h+var_584]
.text:0040BFA6		       xor     eax, eax
.text:0040BFA8		       cmp     cl, 0Ah
.text:0040BFAB		       setz    al
.text:0040BFAE		       mov     [ebp+514h+bCR], eax
.text:0040BFB1		       mov     eax, [esi]
.text:0040BFB3		       add     eax, edi
.text:0040BFB5		       cmp     dword ptr [eax+38h], 0
.text:0040BFB9		       jz      short loc_40BFD9
.text:0040BFBB		       mov     dl, [eax+34h]
.text:0040BFBE		       mov     [ebp+514h+mboutbuf], dl
.text:0040BFC4		       mov     [ebp+514h+mboutbuf+1], cl
.text:0040BFCA		       and     dword ptr [eax+38h], 0
.text:0040BFCE		       push    2
.text:0040BFD0		       lea     eax, [ebp+514h+mboutbuf]
.text:0040BFD6		       push    eax
.text:0040BFD7		       jmp     short loc_40C01E
.text:0040BFD9 ; ---------------------------------------------------------------------------
.text:0040BFD9
.text:0040BFD9 loc_40BFD9:			       ; CODE XREF: __write_nolock+186j
.text:0040BFD9		       movsx   eax, cl
.text:0040BFDC		       push    eax	       ; c
.text:0040BFDD		       call    _isleadbyte
.text:0040BFE2		       test    eax, eax
.text:0040BFE4		       pop     ecx
.text:0040BFE5		       jz      short loc_40C01B
.text:0040BFE7		       mov     ecx, [ebp+514h+lpBuffer]
.text:0040BFEA		       sub     ecx, ebx
.text:0040BFEC		       add     ecx, [ebp+514h+cnt]
.text:0040BFF2		       xor     eax, eax
.text:0040BFF4		       inc     eax
.text:0040BFF5		       cmp     ecx, eax
.text:0040BFF7		       jbe     loc_40C153
.text:0040BFFD		       push    2	       ; n
.text:0040BFFF		       lea     eax, [ebp+514h+tmpchar]
.text:0040C002		       push    ebx	       ; s
.text:0040C003		       push    eax	       ; pwc
.text:0040C004		       call    _mbtowc
.text:0040C009		       add     esp, 0Ch
.text:0040C00C		       cmp     eax, 0FFFFFFFFh
.text:0040C00F		       jz      loc_40C3D4
.text:0040C015		       inc     ebx
.text:0040C016		       inc     [ebp+514h+pu]
.text:0040C019		       jmp     short loc_40C033
.text:0040C01B ; ---------------------------------------------------------------------------
.text:0040C01B
.text:0040C01B loc_40C01B:			       ; CODE XREF: __write_nolock+1B2j
.text:0040C01B		       push    1	       ; n
.text:0040C01D		       push    ebx	       ; s
.text:0040C01E
.text:0040C01E loc_40C01E:			       ; CODE XREF: __write_nolock+1A4j
.text:0040C01E		       lea     eax, [ebp+514h+tmpchar]
.text:0040C021		       push    eax	       ; pwc
.text:0040C022		       call    _mbtowc
.text:0040C027		       add     esp, 0Ch
.text:0040C02A		       cmp     eax, 0FFFFFFFFh
.text:0040C02D		       jz      loc_40C3D4
.text:0040C033
.text:0040C033 loc_40C033:			       ; CODE XREF: __write_nolock+1E6j
.text:0040C033		       xor     eax, eax
.text:0040C035		       push    eax	       ; lpUsedDefaultChar
.text:0040C036		       push    eax	       ; lpDefaultChar
.text:0040C037		       push    5	       ; cbMultiByte
.text:0040C039		       lea     ecx, [ebp+514h+mboutbuf]
.text:0040C03F		       push    ecx	       ; lpMultiByteStr
.text:0040C040		       push    1	       ; cchWideChar
.text:0040C042		       lea     ecx, [ebp+514h+tmpchar]
.text:0040C045		       push    ecx	       ; lpWideCharStr
.text:0040C046		       push    eax	       ; dwFlags
.text:0040C047		       push    [ebp+514h+consoleCP] ; CodePage
.text:0040C04A		       inc     ebx
.text:0040C04B		       inc     [ebp+514h+pu]
.text:0040C04E		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040C054		       mov     esi, eax
.text:0040C056		       test    esi, esi
.text:0040C058		       jz      loc_40C3D4
.text:0040C05E		       push    0	       ; lpOverlapped
.text:0040C060		       lea     eax, [ebp+514h+p]
.text:0040C063		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C064		       push    esi	       ; nNumberOfBytesToWrite
.text:0040C065		       lea     eax, [ebp+514h+mboutbuf]
.text:0040C06B		       push    eax	       ; lpBuffer
.text:0040C06C		       mov     eax, [ebp+514h+var_584]
.text:0040C06F		       mov     eax, [eax]
.text:0040C071		       push    dword ptr [edi+eax] ; hFile
.text:0040C074		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C07A		       test    eax, eax
.text:0040C07C		       jz      loc_40C3CB
.text:0040C082		       mov     eax, [ebp+514h+pu]
.text:0040C085		       mov     ecx, [ebp+514h+lfcount]
.text:0040C088		       add     eax, ecx
.text:0040C08A		       cmp     [ebp+514h+p], esi
.text:0040C08D		       mov     [ebp+514h+charcount], eax
.text:0040C090		       jl      loc_40C3D4
.text:0040C096		       cmp     [ebp+514h+bCR], 0
.text:0040C09A		       jz      loc_40C13F
.text:0040C0A0		       push    0	       ; lpOverlapped
.text:0040C0A2		       lea     eax, [ebp+514h+p]
.text:0040C0A5		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C0A6		       push    1	       ; nNumberOfBytesToWrite
.text:0040C0A8		       lea     eax, [ebp+514h+mboutbuf]
.text:0040C0AE		       push    eax	       ; lpBuffer
.text:0040C0AF		       mov     eax, [ebp+514h+var_584]
.text:0040C0B2		       mov     eax, [eax]
.text:0040C0B4		       mov     [ebp+514h+mboutbuf], 0Dh
.text:0040C0BB		       push    dword ptr [edi+eax] ; hFile
.text:0040C0BE		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C0C4		       test    eax, eax
.text:0040C0C6		       jz      loc_40C3CB
.text:0040C0CC		       cmp     [ebp+514h+p], 1
.text:0040C0D0		       jl      loc_40C3D4
.text:0040C0D6		       inc     [ebp+514h+lfcount]
.text:0040C0D9		       inc     [ebp+514h+charcount]
.text:0040C0DC		       jmp     short loc_40C13F
.text:0040C0DE ; ---------------------------------------------------------------------------
.text:0040C0DE
.text:0040C0DE loc_40C0DE:			       ; CODE XREF: __write_nolock+168j
.text:0040C0DE		       cmp     al, 1
.text:0040C0E0		       jz      short loc_40C0E6
.text:0040C0E2		       cmp     al, 2
.text:0040C0E4		       jnz     short loc_40C0FE
.text:0040C0E6
.text:0040C0E6 loc_40C0E6:			       ; CODE XREF: __write_nolock+2ADj
.text:0040C0E6		       movzx   esi, word ptr [ebx]
.text:0040C0E9		       xor     ecx, ecx
.text:0040C0EB		       cmp     si, 0Ah
.text:0040C0EF		       setz    cl
.text:0040C0F2		       inc     ebx
.text:0040C0F3		       inc     ebx
.text:0040C0F4		       add     [ebp+514h+pu], 2
.text:0040C0F8		       mov     [ebp+514h+tmpchar], esi
.text:0040C0FB		       mov     [ebp+514h+bCR], ecx
.text:0040C0FE
.text:0040C0FE loc_40C0FE:			       ; CODE XREF: __write_nolock+2B1j
.text:0040C0FE		       cmp     al, 1
.text:0040C100		       jz      short loc_40C106
.text:0040C102		       cmp     al, 2
.text:0040C104		       jnz     short loc_40C13F
.text:0040C106
.text:0040C106 loc_40C106:			       ; CODE XREF: __write_nolock+2CDj
.text:0040C106		       push    [ebp+514h+tmpchar] ; ch
.text:0040C109		       call    __putwch_nolock
.text:0040C10E		       cmp     ax, word	ptr [ebp+514h+tmpchar]
.text:0040C112		       pop     ecx
.text:0040C113		       jnz     loc_40C3CB
.text:0040C119		       inc     [ebp+514h+charcount]
.text:0040C11C		       cmp     [ebp+514h+bCR], 0
.text:0040C120		       jz      short loc_40C13F
.text:0040C122		       push    0Dh
.text:0040C124		       pop     eax
.text:0040C125		       push    eax	       ; ch
.text:0040C126		       mov     [ebp+514h+tmpchar], eax
.text:0040C129		       call    __putwch_nolock
.text:0040C12E		       cmp     ax, word	ptr [ebp+514h+tmpchar]
.text:0040C132		       pop     ecx
.text:0040C133		       jnz     loc_40C3CB
.text:0040C139		       inc     [ebp+514h+charcount]
.text:0040C13C		       inc     [ebp+514h+lfcount]
.text:0040C13F
.text:0040C13F loc_40C13F:			       ; CODE XREF: __write_nolock+267j
.text:0040C13F					       ; __write_nolock+2A9j ...
.text:0040C13F		       mov     eax, [ebp+514h+cnt]
.text:0040C145		       cmp     [ebp+514h+pu], eax
.text:0040C148		       jb      loc_40BF96
.text:0040C14E		       jmp     loc_40C3D4
.text:0040C153 ; ---------------------------------------------------------------------------
.text:0040C153
.text:0040C153 loc_40C153:			       ; CODE XREF: __write_nolock+1C4j
.text:0040C153		       mov     ecx, [esi]
.text:0040C155		       mov     dl, [ebx]
.text:0040C157		       inc     [ebp+514h+charcount]
.text:0040C15A		       mov     [edi+ecx+34h], dl
.text:0040C15E		       mov     ecx, [esi]
.text:0040C160		       mov     [edi+ecx+38h], eax
.text:0040C164		       jmp     loc_40C3D4
.text:0040C169 ; ---------------------------------------------------------------------------
.text:0040C169
.text:0040C169 loc_40C169:			       ; CODE XREF: __write_nolock+F7j
.text:0040C169					       ; __write_nolock+104j ...
.text:0040C169		       xor     ecx, ecx
.text:0040C16B
.text:0040C16B loc_40C16B:			       ; CODE XREF: __write_nolock+13Dj
.text:0040C16B		       mov     eax, [esi]
.text:0040C16D		       add     eax, edi
.text:0040C16F		       test    byte ptr	[eax+4], 80h
.text:0040C173		       jz      loc_40C3A4
.text:0040C179		       test    bl, bl
.text:0040C17B		       mov     eax, [ebp+514h+lpBuffer]
.text:0040C17E		       mov     [ebp+514h+tmpchar], ecx
.text:0040C181		       jnz     loc_40C21D
.text:0040C187		       cmp     [ebp+514h+cnt], ecx
.text:0040C18D		       mov     [ebp+514h+p], eax
.text:0040C190		       jbe     loc_40C40A
.text:0040C196		       jmp     short loc_40C19B
.text:0040C198 ; ---------------------------------------------------------------------------
.text:0040C198
.text:0040C198 loc_40C198:			       ; CODE XREF: __write_nolock+3E3j
.text:0040C198		       mov     esi, [ebp+514h+var_584]
.text:0040C19B
.text:0040C19B loc_40C19B:			       ; CODE XREF: __write_nolock+363j
.text:0040C19B		       mov     ecx, [ebp+514h+p]
.text:0040C19E		       and     [ebp+514h+pu], 0
.text:0040C1A2		       sub     ecx, [ebp+514h+lpBuffer]
.text:0040C1A5		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C1A8
.text:0040C1A8 loc_40C1A8:			       ; CODE XREF: __write_nolock+3A2j
.text:0040C1A8		       cmp     ecx, [ebp+514h+cnt]
.text:0040C1AE		       jnb     short loc_40C1D7
.text:0040C1B0		       mov     edx, [ebp+514h+p]
.text:0040C1B3		       inc     [ebp+514h+p]
.text:0040C1B6		       mov     dl, [edx]
.text:0040C1B8		       inc     ecx
.text:0040C1B9		       cmp     dl, 0Ah
.text:0040C1BC		       jnz     short loc_40C1C8
.text:0040C1BE		       inc     [ebp+514h+lfcount]
.text:0040C1C1		       mov     byte ptr	[eax], 0Dh
.text:0040C1C4		       inc     eax
.text:0040C1C5		       inc     [ebp+514h+pu]
.text:0040C1C8
.text:0040C1C8 loc_40C1C8:			       ; CODE XREF: __write_nolock+389j
.text:0040C1C8		       mov     [eax], dl
.text:0040C1CA		       inc     eax
.text:0040C1CB		       inc     [ebp+514h+pu]
.text:0040C1CE		       cmp     [ebp+514h+pu], 400h
.text:0040C1D5		       jb      short loc_40C1A8
.text:0040C1D7
.text:0040C1D7 loc_40C1D7:			       ; CODE XREF: __write_nolock+37Bj
.text:0040C1D7		       mov     ebx, eax
.text:0040C1D9		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C1DC		       sub     ebx, eax
.text:0040C1DE		       push    0	       ; lpOverlapped
.text:0040C1E0		       lea     eax, [ebp+514h+written]
.text:0040C1E3		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C1E4		       push    ebx	       ; nNumberOfBytesToWrite
.text:0040C1E5		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C1E8		       push    eax	       ; lpBuffer
.text:0040C1E9		       mov     eax, [esi]
.text:0040C1EB		       push    dword ptr [edi+eax] ; hFile
.text:0040C1EE		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C1F4		       test    eax, eax
.text:0040C1F6		       jz      loc_40C3CB
.text:0040C1FC		       mov     eax, [ebp+514h+written]
.text:0040C1FF		       add     [ebp+514h+charcount], eax
.text:0040C202		       cmp     eax, ebx
.text:0040C204		       jl      loc_40C3D4
.text:0040C20A		       mov     eax, [ebp+514h+p]
.text:0040C20D		       sub     eax, [ebp+514h+lpBuffer]
.text:0040C210		       cmp     eax, [ebp+514h+cnt]
.text:0040C216		       jb      short loc_40C198
.text:0040C218		       jmp     loc_40C3D4
.text:0040C21D ; ---------------------------------------------------------------------------
.text:0040C21D
.text:0040C21D loc_40C21D:			       ; CODE XREF: __write_nolock+34Ej
.text:0040C21D		       cmp     bl, 2
.text:0040C220		       mov     [ebp+514h+pu], eax
.text:0040C223		       jnz     loc_40C2CC
.text:0040C229		       cmp     [ebp+514h+cnt], ecx
.text:0040C22F		       jbe     loc_40C40A
.text:0040C235		       jmp     short loc_40C23A
.text:0040C237 ; ---------------------------------------------------------------------------
.text:0040C237
.text:0040C237 loc_40C237:			       ; CODE XREF: __write_nolock+48Ej
.text:0040C237		       mov     esi, [ebp+514h+var_584]
.text:0040C23A
.text:0040C23A loc_40C23A:			       ; CODE XREF: __write_nolock+402j
.text:0040C23A		       mov     ecx, [ebp+514h+pu]
.text:0040C23D		       and     [ebp+514h+p], 0
.text:0040C241		       sub     ecx, [ebp+514h+lpBuffer]
.text:0040C244		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C247
.text:0040C247 loc_40C247:			       ; CODE XREF: __write_nolock+44Dj
.text:0040C247		       cmp     ecx, [ebp+514h+cnt]
.text:0040C24D		       jnb     short loc_40C282
.text:0040C24F		       mov     edx, [ebp+514h+pu]
.text:0040C252		       add     [ebp+514h+pu], 2
.text:0040C256		       movzx   edx, word ptr [edx]
.text:0040C259		       inc     ecx
.text:0040C25A		       inc     ecx
.text:0040C25B		       cmp     dx, 0Ah
.text:0040C25F		       jnz     short loc_40C270
.text:0040C261		       add     [ebp+514h+lfcount], 2
.text:0040C265		       mov     word ptr	[eax], 0Dh
.text:0040C26A		       inc     eax
.text:0040C26B		       inc     eax
.text:0040C26C		       add     [ebp+514h+p], 2
.text:0040C270
.text:0040C270 loc_40C270:			       ; CODE XREF: __write_nolock+42Cj
.text:0040C270		       add     [ebp+514h+p], 2
.text:0040C274		       mov     [eax], dx
.text:0040C277		       inc     eax
.text:0040C278		       inc     eax
.text:0040C279		       cmp     [ebp+514h+p], 3FFh
.text:0040C280		       jb      short loc_40C247
.text:0040C282
.text:0040C282 loc_40C282:			       ; CODE XREF: __write_nolock+41Aj
.text:0040C282		       mov     ebx, eax
.text:0040C284		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C287		       sub     ebx, eax
.text:0040C289		       push    0	       ; lpOverlapped
.text:0040C28B		       lea     eax, [ebp+514h+written]
.text:0040C28E		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C28F		       push    ebx	       ; nNumberOfBytesToWrite
.text:0040C290		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C293		       push    eax	       ; lpBuffer
.text:0040C294		       mov     eax, [esi]
.text:0040C296		       push    dword ptr [edi+eax] ; hFile
.text:0040C299		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C29F		       test    eax, eax
.text:0040C2A1		       jz      loc_40C3CB
.text:0040C2A7		       mov     eax, [ebp+514h+written]
.text:0040C2AA		       add     [ebp+514h+charcount], eax
.text:0040C2AD		       cmp     eax, ebx
.text:0040C2AF		       jl      loc_40C3D4
.text:0040C2B5		       mov     eax, [ebp+514h+pu]
.text:0040C2B8		       sub     eax, [ebp+514h+lpBuffer]
.text:0040C2BB		       cmp     eax, [ebp+514h+cnt]
.text:0040C2C1		       jb      loc_40C237
.text:0040C2C7		       jmp     loc_40C3D4
.text:0040C2CC ; ---------------------------------------------------------------------------
.text:0040C2CC
.text:0040C2CC loc_40C2CC:			       ; CODE XREF: __write_nolock+3F0j
.text:0040C2CC		       cmp     [ebp+514h+cnt], ecx
.text:0040C2D2		       jbe     loc_40C40A
.text:0040C2D8
.text:0040C2D8 loc_40C2D8:			       ; CODE XREF: __write_nolock+569j
.text:0040C2D8		       mov     ecx, [ebp+514h+pu]
.text:0040C2DB		       and     [ebp+514h+p], 0
.text:0040C2DF		       sub     ecx, [ebp+514h+lpBuffer]
.text:0040C2E2		       push    2
.text:0040C2E4		       lea     eax, [ebp+514h+utf16_buf]
.text:0040C2EA		       pop     esi
.text:0040C2EB
.text:0040C2EB loc_40C2EB:			       ; CODE XREF: __write_nolock+4EAj
.text:0040C2EB		       cmp     ecx, [ebp+514h+cnt]
.text:0040C2F1		       jnb     short loc_40C31F
.text:0040C2F3		       mov     edx, [ebp+514h+pu]
.text:0040C2F6		       movzx   edx, word ptr [edx]
.text:0040C2F9		       add     [ebp+514h+pu], esi
.text:0040C2FC		       add     ecx, esi
.text:0040C2FE		       cmp     dx, 0Ah
.text:0040C302		       jnz     short loc_40C30E
.text:0040C304		       mov     word ptr	[eax], 0Dh
.text:0040C309		       add     eax, esi
.text:0040C30B		       add     [ebp+514h+p], esi
.text:0040C30E
.text:0040C30E loc_40C30E:			       ; CODE XREF: __write_nolock+4CFj
.text:0040C30E		       add     [ebp+514h+p], esi
.text:0040C311		       mov     [eax], dx
.text:0040C314		       add     eax, esi
.text:0040C316		       cmp     [ebp+514h+p], 152h
.text:0040C31D		       jb      short loc_40C2EB
.text:0040C31F
.text:0040C31F loc_40C31F:			       ; CODE XREF: __write_nolock+4BEj
.text:0040C31F		       xor     esi, esi
.text:0040C321		       push    esi	       ; lpUsedDefaultChar
.text:0040C322		       push    esi	       ; lpDefaultChar
.text:0040C323		       push    2ABh	       ; cbMultiByte
.text:0040C328		       lea     ecx, [ebp+514h+utf8_buf+154h]
.text:0040C32E		       push    ecx	       ; lpMultiByteStr
.text:0040C32F		       lea     ecx, [ebp+514h+utf16_buf]
.text:0040C335		       sub     eax, ecx
.text:0040C337		       cdq
.text:0040C338		       sub     eax, edx
.text:0040C33A		       sar     eax, 1
.text:0040C33C		       push    eax	       ; cchWideChar
.text:0040C33D		       mov     eax, ecx
.text:0040C33F		       push    eax	       ; lpWideCharStr
.text:0040C340		       push    esi	       ; dwFlags
.text:0040C341		       push    0FDE9h	       ; CodePage
.text:0040C346		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040C34C		       mov     ebx, eax
.text:0040C34E		       cmp     ebx, esi
.text:0040C350		       jz      short loc_40C3CB
.text:0040C352
.text:0040C352 loc_40C352:			       ; CODE XREF: __write_nolock+549j
.text:0040C352		       push    0	       ; lpOverlapped
.text:0040C354		       lea     eax, [ebp+514h+written]
.text:0040C357		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C358		       mov     eax, ebx
.text:0040C35A		       sub     eax, esi
.text:0040C35C		       push    eax	       ; nNumberOfBytesToWrite
.text:0040C35D		       lea     eax, [ebp+esi+514h+utf8_buf+154h]
.text:0040C364		       push    eax	       ; lpBuffer
.text:0040C365		       mov     eax, [ebp+514h+var_584]
.text:0040C368		       mov     eax, [eax]
.text:0040C36A		       push    dword ptr [edi+eax] ; hFile
.text:0040C36D		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C373		       test    eax, eax
.text:0040C375		       jz      short loc_40C380
.text:0040C377		       add     esi, [ebp+514h+written]
.text:0040C37A		       cmp     ebx, esi
.text:0040C37C		       jg      short loc_40C352
.text:0040C37E		       jmp     short loc_40C389
.text:0040C380 ; ---------------------------------------------------------------------------
.text:0040C380
.text:0040C380 loc_40C380:			       ; CODE XREF: __write_nolock+542j
.text:0040C380		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040C386		       mov     [ebp+514h+tmpchar], eax
.text:0040C389
.text:0040C389 loc_40C389:			       ; CODE XREF: __write_nolock+54Bj
.text:0040C389		       cmp     ebx, esi
.text:0040C38B		       jg      short loc_40C3D4
.text:0040C38D		       mov     eax, [ebp+514h+pu]
.text:0040C390		       sub     eax, [ebp+514h+lpBuffer]
.text:0040C393		       cmp     eax, [ebp+514h+cnt]
.text:0040C399		       mov     [ebp+514h+charcount], eax
.text:0040C39C		       jb      loc_40C2D8
.text:0040C3A2		       jmp     short loc_40C3D4
.text:0040C3A4 ; ---------------------------------------------------------------------------
.text:0040C3A4
.text:0040C3A4 loc_40C3A4:			       ; CODE XREF: __write_nolock+340j
.text:0040C3A4		       push    0	       ; lpOverlapped
.text:0040C3A6		       lea     ecx, [ebp+514h+written]
.text:0040C3A9		       push    ecx	       ; lpNumberOfBytesWritten
.text:0040C3AA		       push    [ebp+514h+cnt]  ; nNumberOfBytesToWrite
.text:0040C3B0		       push    [ebp+514h+lpBuffer] ; lpBuffer
.text:0040C3B3		       push    dword ptr [eax] ; hFile
.text:0040C3B5		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C3BB		       test    eax, eax
.text:0040C3BD		       jz      short loc_40C3CB
.text:0040C3BF		       mov     eax, [ebp+514h+written]
.text:0040C3C2		       and     [ebp+514h+tmpchar], 0
.text:0040C3C6		       mov     [ebp+514h+charcount], eax
.text:0040C3C9		       jmp     short loc_40C3D4
.text:0040C3CB ; ---------------------------------------------------------------------------
.text:0040C3CB
.text:0040C3CB loc_40C3CB:			       ; CODE XREF: __write_nolock+249j
.text:0040C3CB					       ; __write_nolock+293j ...
.text:0040C3CB		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040C3D1		       mov     [ebp+514h+tmpchar], eax
.text:0040C3D4
.text:0040C3D4 loc_40C3D4:			       ; CODE XREF: __write_nolock+1DCj
.text:0040C3D4					       ; __write_nolock+1FAj ...
.text:0040C3D4		       cmp     [ebp+514h+charcount], 0
.text:0040C3D8		       jnz     short loc_40C437
.text:0040C3DA
.text:0040C3DA loc_40C3DA:			       ; CODE XREF: __write_nolock+15Aj
.text:0040C3DA		       cmp     [ebp+514h+tmpchar], 0
.text:0040C3DE		       jz      short loc_40C407
.text:0040C3E0		       push    5
.text:0040C3E2		       pop     esi
.text:0040C3E3		       cmp     [ebp+514h+tmpchar], esi
.text:0040C3E6		       jnz     short loc_40C3FC
.text:0040C3E8		       call    __errno
.text:0040C3ED		       mov     dword ptr [eax],	9
.text:0040C3F3		       call    ___doserrno
.text:0040C3F8		       mov     [eax], esi
.text:0040C3FA		       jmp     short loc_40C432
.text:0040C3FC ; ---------------------------------------------------------------------------
.text:0040C3FC
.text:0040C3FC loc_40C3FC:			       ; CODE XREF: __write_nolock+5B3j
.text:0040C3FC		       push    [ebp+514h+tmpchar] ; oserrno
.text:0040C3FF		       call    __dosmaperr
.text:0040C404		       pop     ecx
.text:0040C405		       jmp     short loc_40C432
.text:0040C407 ; ---------------------------------------------------------------------------
.text:0040C407
.text:0040C407 loc_40C407:			       ; CODE XREF: __write_nolock+5ABj
.text:0040C407		       mov     esi, [ebp+514h+var_584]
.text:0040C40A
.text:0040C40A loc_40C40A:			       ; CODE XREF: __write_nolock+35Dj
.text:0040C40A					       ; __write_nolock+3FCj ...
.text:0040C40A		       mov     eax, [esi]
.text:0040C40C		       test    byte ptr	[edi+eax+4], 40h
.text:0040C411		       jz      short loc_40C41F
.text:0040C413		       mov     eax, [ebp+514h+lpBuffer]
.text:0040C416		       cmp     byte ptr	[eax], 1Ah
.text:0040C419		       jnz     short loc_40C41F
.text:0040C41B		       xor     eax, eax
.text:0040C41D		       jmp     short loc_40C43D
.text:0040C41F ; ---------------------------------------------------------------------------
.text:0040C41F
.text:0040C41F loc_40C41F:			       ; CODE XREF: __write_nolock+5DEj
.text:0040C41F					       ; __write_nolock+5E6j
.text:0040C41F		       call    __errno
.text:0040C424		       mov     dword ptr [eax],	1Ch
.text:0040C42A		       call    ___doserrno
.text:0040C42F		       and     dword ptr [eax],	0
.text:0040C432
.text:0040C432 loc_40C432:			       ; CODE XREF: __write_nolock+CAj
.text:0040C432					       ; __write_nolock+5C7j ...
.text:0040C432		       or      eax, 0FFFFFFFFh
.text:0040C435		       jmp     short loc_40C43D
.text:0040C437 ; ---------------------------------------------------------------------------
.text:0040C437
.text:0040C437 loc_40C437:			       ; CODE XREF: __write_nolock+5A5j
.text:0040C437		       mov     eax, [ebp+514h+charcount]
.text:0040C43A		       sub     eax, [ebp+514h+lfcount]
.text:0040C43D
.text:0040C43D loc_40C43D:			       ; CODE XREF: __write_nolock+5EAj
.text:0040C43D					       ; __write_nolock+602j
.text:0040C43D		       pop     edi
.text:0040C43E		       pop     ebx
.text:0040C43F
.text:0040C43F loc_40C43F:			       ; CODE XREF: __write_nolock+37j
.text:0040C43F					       ; __write_nolock+62j
.text:0040C43F		       mov     ecx, [ebp+514h+var_4]
.text:0040C445		       xor     ecx, ebp
.text:0040C447		       pop     esi
.text:0040C448		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040C44D		       add     ebp, 514h
.text:0040C453		       leave
.text:0040C454		       retn
.text:0040C454 __write_nolock  endp
.text:0040C454
.text:0040C455
.text:0040C455 ; =============== S U B R O U T I N E =======================================
.text:0040C455
.text:0040C455 ; Attributes: bp-based frame
.text:0040C455
.text:0040C455 ; int __cdecl _write(int	fh, const void *buf, unsigned int cnt)
.text:0040C455 __write	       proc near	       ; CODE XREF: __flush+31p
.text:0040C455					       ; __flsbuf+CBp ...
.text:0040C455
.text:0040C455 _Expr_val       = dword ptr -20h
.text:0040C455 r	       = dword ptr -1Ch
.text:0040C455 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040C455 fh	       = dword ptr  8
.text:0040C455 buf	       = dword ptr  0Ch
.text:0040C455 cnt	       = dword ptr  10h
.text:0040C455
.text:0040C455		       push    10h
.text:0040C457		       push    offset dword_420898
.text:0040C45C		       call    __SEH_prolog4
.text:0040C461		       mov     eax, [ebp+fh]
.text:0040C464		       cmp     eax, 0FFFFFFFEh
.text:0040C467		       jnz     short loc_40C484
.text:0040C469		       call    ___doserrno
.text:0040C46E		       and     dword ptr [eax],	0
.text:0040C471		       call    __errno
.text:0040C476		       mov     dword ptr [eax],	9
.text:0040C47C
.text:0040C47C loc_40C47C:			       ; CODE XREF: __write+5Cj
.text:0040C47C		       or      eax, 0FFFFFFFFh
.text:0040C47F		       jmp     loc_40C521
.text:0040C484 ; ---------------------------------------------------------------------------
.text:0040C484
.text:0040C484 loc_40C484:			       ; CODE XREF: __write+12j
.text:0040C484		       xor     edi, edi
.text:0040C486		       cmp     eax, edi
.text:0040C488		       jl      short loc_40C492
.text:0040C48A		       cmp     eax, __nhandle
.text:0040C490		       jb      short loc_40C4B3
.text:0040C492
.text:0040C492 loc_40C492:			       ; CODE XREF: __write+33j
.text:0040C492					       ; __write+7Cj
.text:0040C492		       call    ___doserrno
.text:0040C497		       mov     [eax], edi
.text:0040C499		       call    __errno
.text:0040C49E		       mov     dword ptr [eax],	9
.text:0040C4A4		       push    edi	       ; pReserved
.text:0040C4A5		       push    edi	       ; nLine
.text:0040C4A6		       push    edi	       ; pszFile
.text:0040C4A7		       push    edi	       ; pszFunction
.text:0040C4A8		       push    edi	       ; pszExpression
.text:0040C4A9		       call    __invalid_parameter
.text:0040C4AE		       add     esp, 14h
.text:0040C4B1		       jmp     short loc_40C47C
.text:0040C4B3 ; ---------------------------------------------------------------------------
.text:0040C4B3
.text:0040C4B3 loc_40C4B3:			       ; CODE XREF: __write+3Bj
.text:0040C4B3		       mov     ecx, eax
.text:0040C4B5		       sar     ecx, 5
.text:0040C4B8		       lea     ebx, ds:422F40h[ecx*4]
.text:0040C4BF		       mov     esi, eax
.text:0040C4C1		       and     esi, 1Fh
.text:0040C4C4		       shl     esi, 6
.text:0040C4C7		       mov     ecx, [ebx]
.text:0040C4C9		       movzx   ecx, byte ptr [ecx+esi+4]
.text:0040C4CE		       and     ecx, 1
.text:0040C4D1		       jz      short loc_40C492
.text:0040C4D3		       push    eax	       ; fh
.text:0040C4D4		       call    ___lock_fhandle
.text:0040C4D9		       pop     ecx
.text:0040C4DA		       mov     [ebp+ms_exc.disabled], edi
.text:0040C4DD		       mov     eax, [ebx]
.text:0040C4DF		       test    byte ptr	[eax+esi+4], 1
.text:0040C4E4		       jz      short loc_40C4FC
.text:0040C4E6		       push    [ebp+cnt]       ; cnt
.text:0040C4E9		       push    [ebp+buf]       ; buf
.text:0040C4EC		       push    [ebp+fh]	       ; fh
.text:0040C4EF		       call    __write_nolock
.text:0040C4F4		       add     esp, 0Ch
.text:0040C4F7		       mov     [ebp+r],	eax
.text:0040C4FA		       jmp     short loc_40C512
.text:0040C4FC ; ---------------------------------------------------------------------------
.text:0040C4FC
.text:0040C4FC loc_40C4FC:			       ; CODE XREF: __write+8Fj
.text:0040C4FC		       call    __errno
.text:0040C501		       mov     dword ptr [eax],	9
.text:0040C507		       call    ___doserrno
.text:0040C50C		       mov     [eax], edi
.text:0040C50E		       or      [ebp+r],	0FFFFFFFFh
.text:0040C512
.text:0040C512 loc_40C512:			       ; CODE XREF: __write+A5j
.text:0040C512		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040C519		       call    $LN12_8
.text:0040C51E
.text:0040C51E $LN15_3:
.text:0040C51E		       mov     eax, [ebp+r]
.text:0040C521
.text:0040C521 loc_40C521:			       ; CODE XREF: __write+2Aj
.text:0040C521		       call    __SEH_epilog4
.text:0040C526		       retn
.text:0040C527 ; ---------------------------------------------------------------------------
.text:0040C527
.text:0040C527 $LN12_8:				       ; CODE XREF: __write+C4p
.text:0040C527					       ; DATA XREF: .rdata:004208B0o
.text:0040C527		       push    [ebp+fh]	       ; fh
.text:0040C52A		       call    __unlock_fhandle
.text:0040C52F		       pop     ecx
.text:0040C530
.text:0040C530 $LN13_5:
.text:0040C530		       retn
.text:0040C530 __write	       endp
.text:0040C530
.text:0040C531
.text:0040C531 ; =============== S U B R O U T I N E =======================================
.text:0040C531
.text:0040C531 ; Attributes: bp-based frame
.text:0040C531
.text:0040C531 ; int __cdecl _commit(int filedes)
.text:0040C531 __commit	       proc near	       ; CODE XREF: __fflush_nolock+31p
.text:0040C531
.text:0040C531 _Expr_val       = dword ptr -20h
.text:0040C531 retval	       = dword ptr -1Ch
.text:0040C531 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040C531 filedes	       = dword ptr  8
.text:0040C531
.text:0040C531		       push    10h
.text:0040C533		       push    offset dword_4208B8
.text:0040C538		       call    __SEH_prolog4
.text:0040C53D		       mov     eax, [ebp+filedes]
.text:0040C540		       cmp     eax, 0FFFFFFFEh
.text:0040C543		       jnz     short loc_40C558
.text:0040C545		       call    __errno
.text:0040C54A		       mov     dword ptr [eax],	9
.text:0040C550
.text:0040C550 loc_40C550:			       ; CODE XREF: __commit+4Dj
.text:0040C550		       or      eax, 0FFFFFFFFh
.text:0040C553		       jmp     loc_40C602
.text:0040C558 ; ---------------------------------------------------------------------------
.text:0040C558
.text:0040C558 loc_40C558:			       ; CODE XREF: __commit+12j
.text:0040C558		       xor     ebx, ebx
.text:0040C55A		       cmp     eax, ebx
.text:0040C55C		       jl      short loc_40C566
.text:0040C55E		       cmp     eax, __nhandle
.text:0040C564		       jb      short loc_40C580
.text:0040C566
.text:0040C566 loc_40C566:			       ; CODE XREF: __commit+2Bj
.text:0040C566					       ; __commit+6Dj
.text:0040C566		       call    __errno
.text:0040C56B		       mov     dword ptr [eax],	9
.text:0040C571		       push    ebx	       ; pReserved
.text:0040C572		       push    ebx	       ; nLine
.text:0040C573		       push    ebx	       ; pszFile
.text:0040C574		       push    ebx	       ; pszFunction
.text:0040C575		       push    ebx	       ; pszExpression
.text:0040C576		       call    __invalid_parameter
.text:0040C57B		       add     esp, 14h
.text:0040C57E		       jmp     short loc_40C550
.text:0040C580 ; ---------------------------------------------------------------------------
.text:0040C580
.text:0040C580 loc_40C580:			       ; CODE XREF: __commit+33j
.text:0040C580		       mov     ecx, eax
.text:0040C582		       sar     ecx, 5
.text:0040C585		       lea     edi, ds:422F40h[ecx*4]
.text:0040C58C		       mov     esi, eax
.text:0040C58E		       and     esi, 1Fh
.text:0040C591		       shl     esi, 6
.text:0040C594		       mov     ecx, [edi]
.text:0040C596		       movzx   ecx, byte ptr [esi+ecx+4]
.text:0040C59B		       and     ecx, 1
.text:0040C59E		       jz      short loc_40C566
.text:0040C5A0		       push    eax	       ; fh
.text:0040C5A1		       call    ___lock_fhandle
.text:0040C5A6		       pop     ecx
.text:0040C5A7		       mov     [ebp+ms_exc.disabled], ebx
.text:0040C5AA		       mov     eax, [edi]
.text:0040C5AC		       test    byte ptr	[esi+eax+4], 1
.text:0040C5B1		       jz      short loc_40C5E4
.text:0040C5B3		       push    [ebp+filedes]   ; fh
.text:0040C5B6		       call    __get_osfhandle
.text:0040C5BB		       pop     ecx
.text:0040C5BC		       push    eax	       ; hFile
.text:0040C5BD		       call    ds:__imp__FlushFileBuffers@4 ; FlushFileBuffers(x)
.text:0040C5C3		       test    eax, eax
.text:0040C5C5		       jnz     short loc_40C5D2
.text:0040C5C7		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040C5CD		       mov     [ebp+retval], eax
.text:0040C5D0		       jmp     short loc_40C5D5
.text:0040C5D2 ; ---------------------------------------------------------------------------
.text:0040C5D2
.text:0040C5D2 loc_40C5D2:			       ; CODE XREF: __commit+94j
.text:0040C5D2		       mov     [ebp+retval], ebx
.text:0040C5D5
.text:0040C5D5 loc_40C5D5:			       ; CODE XREF: __commit+9Fj
.text:0040C5D5		       cmp     [ebp+retval], ebx
.text:0040C5D8		       jz      short good
.text:0040C5DA		       call    ___doserrno
.text:0040C5DF		       mov     ecx, [ebp+retval]
.text:0040C5E2		       mov     [eax], ecx
.text:0040C5E4
.text:0040C5E4 loc_40C5E4:			       ; CODE XREF: __commit+80j
.text:0040C5E4		       call    __errno
.text:0040C5E9		       mov     dword ptr [eax],	9
.text:0040C5EF		       or      [ebp+retval], 0FFFFFFFFh
.text:0040C5F3
.text:0040C5F3 good:				       ; CODE XREF: __commit+A7j
.text:0040C5F3		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040C5FA		       call    $LN14_2
.text:0040C5FF
.text:0040C5FF $LN17_4:
.text:0040C5FF		       mov     eax, [ebp+retval]
.text:0040C602
.text:0040C602 loc_40C602:			       ; CODE XREF: __commit+22j
.text:0040C602		       call    __SEH_epilog4
.text:0040C607		       retn
.text:0040C608 ; ---------------------------------------------------------------------------
.text:0040C608
.text:0040C608 $LN14_2:				       ; CODE XREF: __commit+C9p
.text:0040C608					       ; DATA XREF: .rdata:004208D0o
.text:0040C608		       push    [ebp+filedes]   ; fh
.text:0040C60B		       call    __unlock_fhandle
.text:0040C610		       pop     ecx
.text:0040C611
.text:0040C611 $LN15_4:
.text:0040C611		       retn
.text:0040C611 __commit	       endp
.text:0040C611
.text:0040C611 ; ---------------------------------------------------------------------------
.text:0040C612		       align 10h
.text:0040C620
.text:0040C620 ; =============== S U B R O U T I N E =======================================
.text:0040C620
.text:0040C620 ; Attributes: bp-based frame
.text:0040C620
.text:0040C620 ; void __cdecl memmove(char *dst, char *src, unsigned int count)
.text:0040C620 _memmove	       proc near	       ; CODE XREF: ___sbh_free_block+2DAp
.text:0040C620					       ; ___sbh_heapmin+B7p ...
.text:0040C620
.text:0040C620 dst	       = dword ptr  8
.text:0040C620 src	       = dword ptr  0Ch
.text:0040C620 count	       = dword ptr  10h
.text:0040C620
.text:0040C620		       push    ebp
.text:0040C621		       mov     ebp, esp
.text:0040C623		       push    edi
.text:0040C624		       push    esi
.text:0040C625		       mov     esi, [ebp+src]
.text:0040C628		       mov     ecx, [ebp+count]
.text:0040C62B		       mov     edi, [ebp+dst]
.text:0040C62E		       mov     eax, ecx
.text:0040C630		       mov     edx, ecx
.text:0040C632		       add     eax, esi
.text:0040C634		       cmp     edi, esi
.text:0040C636		       jbe     short CopyUp_0
.text:0040C638		       cmp     edi, eax
.text:0040C63A		       jb      CopyDown_0
.text:0040C640
.text:0040C640 CopyUp_0:			       ; CODE XREF: _memmove+16j
.text:0040C640		       cmp     ecx, 100h
.text:0040C646		       jb      short Dword_align_0
.text:0040C648		       cmp     ___sse2_available, 0
.text:0040C64F		       jz      short Dword_align_0
.text:0040C651		       push    edi
.text:0040C652		       push    esi
.text:0040C653		       and     edi, 0Fh
.text:0040C656		       and     esi, 0Fh
.text:0040C659		       cmp     edi, esi
.text:0040C65B		       pop     esi
.text:0040C65C		       pop     edi
.text:0040C65D		       jnz     short Dword_align_0
.text:0040C65F		       pop     esi
.text:0040C660		       pop     edi
.text:0040C661		       pop     ebp
.text:0040C662		       jmp     __VEC_memcpy
.text:0040C667 ; ---------------------------------------------------------------------------
.text:0040C667
.text:0040C667 Dword_align_0:			       ; CODE XREF: _memmove+26j
.text:0040C667					       ; _memmove+2Fj ...
.text:0040C667		       test    edi, 3
.text:0040C66D		       jnz     short CopyLeadUp_0
.text:0040C66F		       shr     ecx, 2
.text:0040C672		       and     edx, 3
.text:0040C675		       cmp     ecx, 8
.text:0040C678		       jb      short CopyUnwindUp_0
.text:0040C67A		       rep movsd
.text:0040C67C		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040C67C ; ---------------------------------------------------------------------------
.text:0040C683		       align 4
.text:0040C684
.text:0040C684 CopyLeadUp_0:			       ; CODE XREF: _memmove+4Dj
.text:0040C684		       mov     eax, edi
.text:0040C686		       mov     edx, 3
.text:0040C68B		       sub     ecx, 4
.text:0040C68E		       jb      short ByteCopyUp_0
.text:0040C690		       and     eax, 3
.text:0040C693		       add     ecx, eax
.text:0040C695		       jmp     dword ptr ds:CopyUnwindUp_0+4[eax*4]
.text:0040C69C ; ---------------------------------------------------------------------------
.text:0040C69C
.text:0040C69C ByteCopyUp_0:			       ; CODE XREF: _memmove+6Ej
.text:0040C69C		       jmp     ds:TrailUp0_0[ecx*4]
.text:0040C69C ; ---------------------------------------------------------------------------
.text:0040C6A3		       align 4
.text:0040C6A4
.text:0040C6A4 CopyUnwindUp_0:			       ; CODE XREF: _memmove+58j
.text:0040C6A4					       ; _memmove+B6j ...
.text:0040C6A4		       jmp     ds:UnwindUpVec_0[ecx*4]
.text:0040C6A4 ; ---------------------------------------------------------------------------
.text:0040C6AB		       align 4
.text:0040C6AC ; unsigned int LeadUpVec_0
.text:0040C6AC LeadUpVec_0     dd offset LeadUp1_0
.text:0040C6B0		       dd offset LeadUp2_0
.text:0040C6B4		       dd offset LeadUp3_0
.text:0040C6B8 ; ---------------------------------------------------------------------------
.text:0040C6B8
.text:0040C6B8 LeadUp1_0:			       ; DATA XREF: _memmove:LeadUpVec_0o
.text:0040C6B8		       and     edx, ecx
.text:0040C6BA		       mov     al, [esi]
.text:0040C6BC		       mov     [edi], al
.text:0040C6BE		       mov     al, [esi+1]
.text:0040C6C1		       mov     [edi+1],	al
.text:0040C6C4		       mov     al, [esi+2]
.text:0040C6C7		       shr     ecx, 2
.text:0040C6CA		       mov     [edi+2],	al
.text:0040C6CD		       add     esi, 3
.text:0040C6D0		       add     edi, 3
.text:0040C6D3		       cmp     ecx, 8
.text:0040C6D6		       jb      short CopyUnwindUp_0
.text:0040C6D8		       rep movsd
.text:0040C6DA		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040C6DA ; ---------------------------------------------------------------------------
.text:0040C6E1		       align 4
.text:0040C6E4
.text:0040C6E4 LeadUp2_0:			       ; DATA XREF: _memmove+90o
.text:0040C6E4		       and     edx, ecx
.text:0040C6E6		       mov     al, [esi]
.text:0040C6E8		       mov     [edi], al
.text:0040C6EA		       mov     al, [esi+1]
.text:0040C6ED		       shr     ecx, 2
.text:0040C6F0		       mov     [edi+1],	al
.text:0040C6F3		       add     esi, 2
.text:0040C6F6		       add     edi, 2
.text:0040C6F9		       cmp     ecx, 8
.text:0040C6FC		       jb      short CopyUnwindUp_0
.text:0040C6FE		       rep movsd
.text:0040C700		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040C700 ; ---------------------------------------------------------------------------
.text:0040C707		       align 4
.text:0040C708
.text:0040C708 LeadUp3_0:			       ; DATA XREF: _memmove+94o
.text:0040C708		       and     edx, ecx
.text:0040C70A		       mov     al, [esi]
.text:0040C70C		       mov     [edi], al
.text:0040C70E		       add     esi, 1
.text:0040C711		       shr     ecx, 2
.text:0040C714		       add     edi, 1
.text:0040C717		       cmp     ecx, 8
.text:0040C71A		       jb      short CopyUnwindUp_0
.text:0040C71C		       rep movsd
.text:0040C71E		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040C71E ; ---------------------------------------------------------------------------
.text:0040C725		       align 4
.text:0040C728 ; unsigned int UnwindUpVec_0
.text:0040C728 UnwindUpVec_0   dd offset UnwindUp0_0   ; DATA XREF: _memmove:CopyUnwindUp_0r
.text:0040C72C		       dd offset UnwindUp1_0
.text:0040C730		       dd offset UnwindUp2_0
.text:0040C734		       dd offset UnwindUp3_0
.text:0040C738		       dd offset UnwindUp4_0
.text:0040C73C		       dd offset UnwindUp5_0
.text:0040C740		       dd offset UnwindUp6_0
.text:0040C744		       dd offset UnwindUp7_0
.text:0040C748 ; ---------------------------------------------------------------------------
.text:0040C748
.text:0040C748 UnwindUp7_0:			       ; CODE XREF: _memmove:CopyUnwindUp_0j
.text:0040C748					       ; DATA XREF: _memmove+124o
.text:0040C748		       mov     eax, [esi+ecx*4-1Ch]
.text:0040C74C		       mov     [edi+ecx*4-1Ch],	eax
.text:0040C750
.text:0040C750 UnwindUp6_0:			       ; CODE XREF: _memmove:CopyUnwindUp_0j
.text:0040C750					       ; DATA XREF: _memmove+120o
.text:0040C750		       mov     eax, [esi+ecx*4-18h]
.text:0040C754		       mov     [edi+ecx*4-18h],	eax
.text:0040C758
.text:0040C758 UnwindUp5_0:			       ; CODE XREF: _memmove:CopyUnwindUp_0j
.text:0040C758					       ; DATA XREF: _memmove+11Co
.text:0040C758		       mov     eax, [esi+ecx*4-14h]
.text:0040C75C		       mov     [edi+ecx*4-14h],	eax
.text:0040C760
.text:0040C760 UnwindUp4_0:			       ; CODE XREF: _memmove:CopyUnwindUp_0j
.text:0040C760					       ; DATA XREF: _memmove+118o
.text:0040C760		       mov     eax, [esi+ecx*4-10h]
.text:0040C764		       mov     [edi+ecx*4-10h],	eax
.text:0040C768
.text:0040C768 UnwindUp3_0:			       ; CODE XREF: _memmove:CopyUnwindUp_0j
.text:0040C768					       ; DATA XREF: _memmove+114o
.text:0040C768		       mov     eax, [esi+ecx*4-0Ch]
.text:0040C76C		       mov     [edi+ecx*4-0Ch],	eax
.text:0040C770
.text:0040C770 UnwindUp2_0:			       ; CODE XREF: _memmove:CopyUnwindUp_0j
.text:0040C770					       ; DATA XREF: _memmove+110o
.text:0040C770		       mov     eax, [esi+ecx*4-8]
.text:0040C774		       mov     [edi+ecx*4-8], eax
.text:0040C778
.text:0040C778 UnwindUp1_0:			       ; CODE XREF: _memmove:CopyUnwindUp_0j
.text:0040C778					       ; DATA XREF: _memmove+10Co
.text:0040C778		       mov     eax, [esi+ecx*4-4]
.text:0040C77C		       mov     [edi+ecx*4-4], eax
.text:0040C780		       lea     eax, ds:0[ecx*4]
.text:0040C787		       add     esi, eax
.text:0040C789		       add     edi, eax
.text:0040C78B
.text:0040C78B UnwindUp0_0:			       ; CODE XREF: _memmove:CopyUnwindUp_0j
.text:0040C78B					       ; DATA XREF: _memmove:UnwindUpVec_0o
.text:0040C78B		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040C78B ; ---------------------------------------------------------------------------
.text:0040C792		       align 4
.text:0040C794 ; unsigned int TrailUpVec_0
.text:0040C794 TrailUpVec_0    dd offset TrailUp0_0    ; DATA XREF: _memmove+5Cr
.text:0040C794					       ; _memmove+BAr ...
.text:0040C798		       dd offset TrailUp1_0
.text:0040C79C		       dd offset TrailUp2_0
.text:0040C7A0		       dd offset TrailUp3_0
.text:0040C7A4 TrailUp0_0      dd 5E08458Bh	       ; CODE XREF: _memmove+5Cj
.text:0040C7A4					       ; DATA XREF: _memmove:ByteCopyUp_0r ...
.text:0040C7A8 ; ---------------------------------------------------------------------------
.text:0040C7A8		       pop     edi
.text:0040C7A9		       leave
.text:0040C7AA		       retn
.text:0040C7AA ; ---------------------------------------------------------------------------
.text:0040C7AB		       align 4
.text:0040C7AC
.text:0040C7AC TrailUp1_0:			       ; CODE XREF: _memmove+5Cj
.text:0040C7AC					       ; DATA XREF: _memmove+178o
.text:0040C7AC		       mov     al, [esi]
.text:0040C7AE		       mov     [edi], al
.text:0040C7B0		       mov     eax, [ebp+dst]
.text:0040C7B3		       pop     esi
.text:0040C7B4		       pop     edi
.text:0040C7B5		       leave
.text:0040C7B6		       retn
.text:0040C7B6 ; ---------------------------------------------------------------------------
.text:0040C7B7		       align 4
.text:0040C7B8
.text:0040C7B8 TrailUp2_0:			       ; CODE XREF: _memmove+5Cj
.text:0040C7B8					       ; DATA XREF: _memmove+17Co
.text:0040C7B8		       mov     al, [esi]
.text:0040C7BA		       mov     [edi], al
.text:0040C7BC		       mov     al, [esi+1]
.text:0040C7BF		       mov     [edi+1],	al
.text:0040C7C2		       mov     eax, [ebp+dst]
.text:0040C7C5		       pop     esi
.text:0040C7C6		       pop     edi
.text:0040C7C7		       leave
.text:0040C7C8		       retn
.text:0040C7C8 ; ---------------------------------------------------------------------------
.text:0040C7C9		       align 4
.text:0040C7CC
.text:0040C7CC TrailUp3_0:			       ; CODE XREF: _memmove+5Cj
.text:0040C7CC					       ; DATA XREF: _memmove+180o
.text:0040C7CC		       mov     al, [esi]
.text:0040C7CE		       mov     [edi], al
.text:0040C7D0		       mov     al, [esi+1]
.text:0040C7D3		       mov     [edi+1],	al
.text:0040C7D6		       mov     al, [esi+2]
.text:0040C7D9		       mov     [edi+2],	al
.text:0040C7DC		       mov     eax, [ebp+dst]
.text:0040C7DF		       pop     esi
.text:0040C7E0		       pop     edi
.text:0040C7E1		       leave
.text:0040C7E2		       retn
.text:0040C7E2 ; ---------------------------------------------------------------------------
.text:0040C7E3		       align 4
.text:0040C7E4
.text:0040C7E4 CopyDown_0:			       ; CODE XREF: _memmove+1Aj
.text:0040C7E4		       lea     esi, [ecx+esi-4]
.text:0040C7E8		       lea     edi, [ecx+edi-4]
.text:0040C7EC		       test    edi, 3
.text:0040C7F2		       jnz     short CopyLeadDown_0
.text:0040C7F4		       shr     ecx, 2
.text:0040C7F7		       and     edx, 3
.text:0040C7FA		       cmp     ecx, 8
.text:0040C7FD		       jb      short CopyUnwindDown_0
.text:0040C7FF		       std
.text:0040C800		       rep movsd
.text:0040C802		       cld
.text:0040C803		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040C803 ; ---------------------------------------------------------------------------
.text:0040C80A		       align 4
.text:0040C80C
.text:0040C80C CopyUnwindDown_0:		       ; CODE XREF: _memmove+1DDj
.text:0040C80C					       ; _memmove+238j	...
.text:0040C80C		       neg     ecx
.text:0040C80E		       jmp     ds:off_40C8E0[ecx*4]
.text:0040C80E ; ---------------------------------------------------------------------------
.text:0040C815		       align 4
.text:0040C818
.text:0040C818 CopyLeadDown_0:			       ; CODE XREF: _memmove+1D2j
.text:0040C818		       mov     eax, edi
.text:0040C81A		       mov     edx, 3
.text:0040C81F		       cmp     ecx, 4
.text:0040C822		       jb      short ByteCopyDown_0
.text:0040C824		       and     eax, 3
.text:0040C827		       sub     ecx, eax
.text:0040C829		       jmp     dword ptr ds:ByteCopyDown_0+4[eax*4]
.text:0040C830 ; ---------------------------------------------------------------------------
.text:0040C830
.text:0040C830 ByteCopyDown_0:			       ; CODE XREF: _memmove+202j
.text:0040C830					       ; DATA XREF: _memmove+209r
.text:0040C830		       jmp     ds:TrailDownVec_0[ecx*4]
.text:0040C830 ; ---------------------------------------------------------------------------
.text:0040C837		       align 4
.text:0040C838 ; unsigned int LeadDownVec_0
.text:0040C838 LeadDownVec_0   dd offset LeadDown1_0
.text:0040C83C		       dd offset LeadDown2_0
.text:0040C840		       dd offset LeadDown3_0
.text:0040C844 ; ---------------------------------------------------------------------------
.text:0040C844
.text:0040C844 LeadDown1_0:			       ; DATA XREF: _memmove:LeadDownVec_0o
.text:0040C844		       mov     al, [esi+3]
.text:0040C847		       and     edx, ecx
.text:0040C849		       mov     [edi+3],	al
.text:0040C84C		       sub     esi, 1
.text:0040C84F		       shr     ecx, 2
.text:0040C852		       sub     edi, 1
.text:0040C855		       cmp     ecx, 8
.text:0040C858		       jb      short CopyUnwindDown_0
.text:0040C85A		       std
.text:0040C85B		       rep movsd
.text:0040C85D		       cld
.text:0040C85E		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040C85E ; ---------------------------------------------------------------------------
.text:0040C865		       align 4
.text:0040C868
.text:0040C868 LeadDown2_0:			       ; DATA XREF: _memmove+21Co
.text:0040C868		       mov     al, [esi+3]
.text:0040C86B		       and     edx, ecx
.text:0040C86D		       mov     [edi+3],	al
.text:0040C870		       mov     al, [esi+2]
.text:0040C873		       shr     ecx, 2
.text:0040C876		       mov     [edi+2],	al
.text:0040C879		       sub     esi, 2
.text:0040C87C		       sub     edi, 2
.text:0040C87F		       cmp     ecx, 8
.text:0040C882		       jb      short CopyUnwindDown_0
.text:0040C884		       std
.text:0040C885		       rep movsd
.text:0040C887		       cld
.text:0040C888		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040C888 ; ---------------------------------------------------------------------------
.text:0040C88F		       align 10h
.text:0040C890
.text:0040C890 LeadDown3_0:			       ; DATA XREF: _memmove+220o
.text:0040C890		       mov     al, [esi+3]
.text:0040C893		       and     edx, ecx
.text:0040C895		       mov     [edi+3],	al
.text:0040C898		       mov     al, [esi+2]
.text:0040C89B		       mov     [edi+2],	al
.text:0040C89E		       mov     al, [esi+1]
.text:0040C8A1		       shr     ecx, 2
.text:0040C8A4		       mov     [edi+1],	al
.text:0040C8A7		       sub     esi, 3
.text:0040C8AA		       sub     edi, 3
.text:0040C8AD		       cmp     ecx, 8
.text:0040C8B0		       jb      CopyUnwindDown_0
.text:0040C8B6		       std
.text:0040C8B7		       rep movsd
.text:0040C8B9		       cld
.text:0040C8BA		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040C8BA ; ---------------------------------------------------------------------------
.text:0040C8C1		       align 4
.text:0040C8C4 ; unsigned int UnwindDownVec_0
.text:0040C8C4 UnwindDownVec_0 dd offset UnwindDown7_0
.text:0040C8C8		       dd offset UnwindDown6_0
.text:0040C8CC		       dd offset UnwindDown5_0
.text:0040C8D0		       dd offset UnwindDown4_0
.text:0040C8D4		       dd offset UnwindDown3_0
.text:0040C8D8		       dd offset UnwindDown2_0
.text:0040C8DC		       dd offset UnwindDown1_0
.text:0040C8E0 off_40C8E0      dd offset UnwindDown0_0 ; DATA XREF: _memmove+1EEr
.text:0040C8E4 ; ---------------------------------------------------------------------------
.text:0040C8E4
.text:0040C8E4 UnwindDown7_0:			       ; DATA XREF: _memmove:UnwindDownVec_0o
.text:0040C8E4		       mov     eax, [esi+ecx*4+1Ch]
.text:0040C8E8		       mov     [edi+ecx*4+1Ch],	eax
.text:0040C8EC
.text:0040C8EC UnwindDown6_0:			       ; DATA XREF: _memmove+2A8o
.text:0040C8EC		       mov     eax, [esi+ecx*4+18h]
.text:0040C8F0		       mov     [edi+ecx*4+18h],	eax
.text:0040C8F4
.text:0040C8F4 UnwindDown5_0:			       ; DATA XREF: _memmove+2ACo
.text:0040C8F4		       mov     eax, [esi+ecx*4+14h]
.text:0040C8F8		       mov     [edi+ecx*4+14h],	eax
.text:0040C8FC
.text:0040C8FC UnwindDown4_0:			       ; DATA XREF: _memmove+2B0o
.text:0040C8FC		       mov     eax, [esi+ecx*4+10h]
.text:0040C900		       mov     [edi+ecx*4+10h],	eax
.text:0040C904
.text:0040C904 UnwindDown3_0:			       ; DATA XREF: _memmove+2B4o
.text:0040C904		       mov     eax, [esi+ecx*4+0Ch]
.text:0040C908		       mov     [edi+ecx*4+0Ch],	eax
.text:0040C90C
.text:0040C90C UnwindDown2_0:			       ; DATA XREF: _memmove+2B8o
.text:0040C90C		       mov     eax, [esi+ecx*4+8]
.text:0040C910		       mov     [edi+ecx*4+8], eax
.text:0040C914
.text:0040C914 UnwindDown1_0:			       ; DATA XREF: _memmove+2BCo
.text:0040C914		       mov     eax, [esi+ecx*4+4]
.text:0040C918		       mov     [edi+ecx*4+4], eax
.text:0040C91C		       lea     eax, ds:0[ecx*4]
.text:0040C923		       add     esi, eax
.text:0040C925		       add     edi, eax
.text:0040C927
.text:0040C927 UnwindDown0_0:			       ; CODE XREF: _memmove+1EEj
.text:0040C927					       ; DATA XREF: _memmove:off_40C8E0o
.text:0040C927		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040C927 ; ---------------------------------------------------------------------------
.text:0040C92E		       align 10h
.text:0040C930 ; unsigned int TrailDownVec_0
.text:0040C930 TrailDownVec_0  dd offset TrailDown0_0  ; DATA XREF: _memmove+1E3r
.text:0040C930					       ; _memmove:ByteCopyDown_0r ...
.text:0040C934		       dd offset TrailDown1_0
.text:0040C938		       dd offset TrailDown2_0
.text:0040C93C		       dd offset TrailDown3_0
.text:0040C940 ; ---------------------------------------------------------------------------
.text:0040C940
.text:0040C940 TrailDown0_0:			       ; CODE XREF: _memmove+1E3j
.text:0040C940					       ; _memmove:ByteCopyDown_0j ...
.text:0040C940		       mov     eax, [ebp+dst]
.text:0040C943		       pop     esi
.text:0040C944		       pop     edi
.text:0040C945		       leave
.text:0040C946		       retn
.text:0040C946 ; ---------------------------------------------------------------------------
.text:0040C947		       align 4
.text:0040C948
.text:0040C948 TrailDown1_0:			       ; CODE XREF: _memmove+1E3j
.text:0040C948					       ; _memmove:ByteCopyDown_0j ...
.text:0040C948		       mov     al, [esi+3]
.text:0040C94B		       mov     [edi+3],	al
.text:0040C94E		       mov     eax, [ebp+dst]
.text:0040C951		       pop     esi
.text:0040C952		       pop     edi
.text:0040C953		       leave
.text:0040C954		       retn
.text:0040C954 ; ---------------------------------------------------------------------------
.text:0040C955		       align 4
.text:0040C958
.text:0040C958 TrailDown2_0:			       ; CODE XREF: _memmove+1E3j
.text:0040C958					       ; _memmove:ByteCopyDown_0j ...
.text:0040C958		       mov     al, [esi+3]
.text:0040C95B		       mov     [edi+3],	al
.text:0040C95E		       mov     al, [esi+2]
.text:0040C961		       mov     [edi+2],	al
.text:0040C964		       mov     eax, [ebp+dst]
.text:0040C967		       pop     esi
.text:0040C968		       pop     edi
.text:0040C969		       leave
.text:0040C96A		       retn
.text:0040C96A ; ---------------------------------------------------------------------------
.text:0040C96B		       align 4
.text:0040C96C
.text:0040C96C TrailDown3_0:			       ; CODE XREF: _memmove+1E3j
.text:0040C96C					       ; _memmove:ByteCopyDown_0j ...
.text:0040C96C		       mov     al, [esi+3]
.text:0040C96F		       mov     [edi+3],	al
.text:0040C972		       mov     al, [esi+2]
.text:0040C975		       mov     [edi+2],	al
.text:0040C978		       mov     al, [esi+1]
.text:0040C97B		       mov     [edi+1],	al
.text:0040C97E		       mov     eax, [ebp+dst]
.text:0040C981		       pop     esi
.text:0040C982		       pop     edi
.text:0040C983		       leave
.text:0040C984		       retn
.text:0040C984 _memmove	       endp
.text:0040C984
.text:0040C985
.text:0040C985 ; =============== S U B R O U T I N E =======================================
.text:0040C985
.text:0040C985 ; Attributes: bp-based frame
.text:0040C985
.text:0040C985 ; int __cdecl x_ismbbtype_l(localeinfo_struct *plocinfo,	unsigned int tst, int cmask, int kmask)
.text:0040C985 x_ismbbtype_l   proc near	       ; CODE XREF: __ismbbkalnum_l+Cp
.text:0040C985					       ; __ismbbkalnum+Ap ...
.text:0040C985
.text:0040C985 _loc_update     = _LocaleUpdate ptr -10h
.text:0040C985 plocinfo	       = dword ptr  8
.text:0040C985 tst	       = dword ptr  0Ch
.text:0040C985 cmask	       = dword ptr  10h
.text:0040C985 kmask	       = dword ptr  14h
.text:0040C985
.text:0040C985		       push    ebp
.text:0040C986		       mov     ebp, esp
.text:0040C988		       sub     esp, 10h
.text:0040C98B		       push    [ebp+plocinfo]  ; plocinfo
.text:0040C98E		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040C991		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040C996		       movzx   eax, byte ptr [ebp+tst]
.text:0040C99A		       mov     ecx, [ebp+_loc_update.localeinfo.mbcinfo]
.text:0040C99D		       mov     dl, byte	ptr [ebp+kmask]
.text:0040C9A0		       test    [ecx+eax+1Dh], dl
.text:0040C9A4		       jnz     short loc_40C9C4
.text:0040C9A6		       cmp     [ebp+cmask], 0
.text:0040C9AA		       jz      short loc_40C9BE
.text:0040C9AC		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:0040C9AF		       mov     ecx, [ecx+0C8h]
.text:0040C9B5		       movzx   eax, word ptr [ecx+eax*2]
.text:0040C9B9		       and     eax, [ebp+cmask]
.text:0040C9BC		       jmp     short loc_40C9C0
.text:0040C9BE ; ---------------------------------------------------------------------------
.text:0040C9BE
.text:0040C9BE loc_40C9BE:			       ; CODE XREF: x_ismbbtype_l+25j
.text:0040C9BE		       xor     eax, eax
.text:0040C9C0
.text:0040C9C0 loc_40C9C0:			       ; CODE XREF: x_ismbbtype_l+37j
.text:0040C9C0		       test    eax, eax
.text:0040C9C2		       jz      short loc_40C9C7
.text:0040C9C4
.text:0040C9C4 loc_40C9C4:			       ; CODE XREF: x_ismbbtype_l+1Fj
.text:0040C9C4		       xor     eax, eax
.text:0040C9C6		       inc     eax
.text:0040C9C7
.text:0040C9C7 loc_40C9C7:			       ; CODE XREF: x_ismbbtype_l+3Dj
.text:0040C9C7		       cmp     [ebp+_loc_update.updated], 0
.text:0040C9CB		       jz      short locret_40C9D4
.text:0040C9CD		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040C9D0		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040C9D4
.text:0040C9D4 locret_40C9D4:			       ; CODE XREF: x_ismbbtype_l+46j
.text:0040C9D4		       leave
.text:0040C9D5		       retn
.text:0040C9D5 x_ismbbtype_l   endp
.text:0040C9D5
.text:0040C9D6
.text:0040C9D6 ; =============== S U B R O U T I N E =======================================
.text:0040C9D6
.text:0040C9D6
.text:0040C9D6 ; int __cdecl _ismbbkalnum_l(unsigned int tst, localeinfo_struct	*plocinfo)
.text:0040C9D6 __ismbbkalnum_l proc near
.text:0040C9D6
.text:0040C9D6 tst	       = dword ptr  4
.text:0040C9D6 plocinfo	       = dword ptr  8
.text:0040C9D6
.text:0040C9D6		       push    1	       ; kmask
.text:0040C9D8		       push    0	       ; cmask
.text:0040C9DA		       push    [esp+8+tst]     ; tst
.text:0040C9DE		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040C9E2		       call    x_ismbbtype_l
.text:0040C9E7		       add     esp, 10h
.text:0040C9EA		       retn
.text:0040C9EA __ismbbkalnum_l endp
.text:0040C9EA
.text:0040C9EB
.text:0040C9EB ; =============== S U B R O U T I N E =======================================
.text:0040C9EB
.text:0040C9EB
.text:0040C9EB ; int __cdecl _ismbbkalnum(unsigned int tst)
.text:0040C9EB __ismbbkalnum   proc near
.text:0040C9EB
.text:0040C9EB tst	       = dword ptr  4
.text:0040C9EB
.text:0040C9EB		       push    1	       ; kmask
.text:0040C9ED		       push    0	       ; cmask
.text:0040C9EF		       push    [esp+8+tst]     ; tst
.text:0040C9F3		       push    0	       ; plocinfo
.text:0040C9F5		       call    x_ismbbtype_l
.text:0040C9FA		       add     esp, 10h
.text:0040C9FD		       retn
.text:0040C9FD __ismbbkalnum   endp
.text:0040C9FD
.text:0040C9FE
.text:0040C9FE ; =============== S U B R O U T I N E =======================================
.text:0040C9FE
.text:0040C9FE
.text:0040C9FE ; int __cdecl _ismbbkprint_l(unsigned int tst, localeinfo_struct	*plocinfo)
.text:0040C9FE __ismbbkprint_l proc near
.text:0040C9FE
.text:0040C9FE tst	       = dword ptr  4
.text:0040C9FE plocinfo	       = dword ptr  8
.text:0040C9FE
.text:0040C9FE		       push    3	       ; kmask
.text:0040CA00		       push    0	       ; cmask
.text:0040CA02		       push    [esp+8+tst]     ; tst
.text:0040CA06		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CA0A		       call    x_ismbbtype_l
.text:0040CA0F		       add     esp, 10h
.text:0040CA12		       retn
.text:0040CA12 __ismbbkprint_l endp
.text:0040CA12
.text:0040CA13
.text:0040CA13 ; =============== S U B R O U T I N E =======================================
.text:0040CA13
.text:0040CA13
.text:0040CA13 ; int __cdecl _ismbbkprint(unsigned int tst)
.text:0040CA13 __ismbbkprint   proc near
.text:0040CA13
.text:0040CA13 tst	       = dword ptr  4
.text:0040CA13
.text:0040CA13		       push    3	       ; kmask
.text:0040CA15		       push    0	       ; cmask
.text:0040CA17		       push    [esp+8+tst]     ; tst
.text:0040CA1B		       push    0	       ; plocinfo
.text:0040CA1D		       call    x_ismbbtype_l
.text:0040CA22		       add     esp, 10h
.text:0040CA25		       retn
.text:0040CA25 __ismbbkprint   endp
.text:0040CA25
.text:0040CA26
.text:0040CA26 ; =============== S U B R O U T I N E =======================================
.text:0040CA26
.text:0040CA26
.text:0040CA26 ; int __cdecl _ismbbkpunct_l(unsigned int tst, localeinfo_struct	*plocinfo)
.text:0040CA26 __ismbbkpunct_l proc near
.text:0040CA26
.text:0040CA26 tst	       = dword ptr  4
.text:0040CA26 plocinfo	       = dword ptr  8
.text:0040CA26
.text:0040CA26		       push    2	       ; kmask
.text:0040CA28		       push    0	       ; cmask
.text:0040CA2A		       push    [esp+8+tst]     ; tst
.text:0040CA2E		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CA32		       call    x_ismbbtype_l
.text:0040CA37		       add     esp, 10h
.text:0040CA3A		       retn
.text:0040CA3A __ismbbkpunct_l endp
.text:0040CA3A
.text:0040CA3B
.text:0040CA3B ; =============== S U B R O U T I N E =======================================
.text:0040CA3B
.text:0040CA3B
.text:0040CA3B ; int __cdecl _ismbbkpunct(unsigned int tst)
.text:0040CA3B __ismbbkpunct   proc near
.text:0040CA3B
.text:0040CA3B tst	       = dword ptr  4
.text:0040CA3B
.text:0040CA3B		       push    2	       ; kmask
.text:0040CA3D		       push    0	       ; cmask
.text:0040CA3F		       push    [esp+8+tst]     ; tst
.text:0040CA43		       push    0	       ; plocinfo
.text:0040CA45		       call    x_ismbbtype_l
.text:0040CA4A		       add     esp, 10h
.text:0040CA4D		       retn
.text:0040CA4D __ismbbkpunct   endp
.text:0040CA4D
.text:0040CA4E
.text:0040CA4E ; =============== S U B R O U T I N E =======================================
.text:0040CA4E
.text:0040CA4E
.text:0040CA4E ; int __cdecl _ismbbalnum_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CA4E __ismbbalnum_l  proc near
.text:0040CA4E
.text:0040CA4E tst	       = dword ptr  4
.text:0040CA4E plocinfo	       = dword ptr  8
.text:0040CA4E
.text:0040CA4E		       push    1	       ; kmask
.text:0040CA50		       push    107h	       ; cmask
.text:0040CA55		       push    [esp+8+tst]     ; tst
.text:0040CA59		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CA5D		       call    x_ismbbtype_l
.text:0040CA62		       add     esp, 10h
.text:0040CA65		       retn
.text:0040CA65 __ismbbalnum_l  endp
.text:0040CA65
.text:0040CA66
.text:0040CA66 ; =============== S U B R O U T I N E =======================================
.text:0040CA66
.text:0040CA66
.text:0040CA66 ; int __cdecl _ismbbalnum(unsigned int tst)
.text:0040CA66 __ismbbalnum    proc near
.text:0040CA66
.text:0040CA66 tst	       = dword ptr  4
.text:0040CA66
.text:0040CA66		       push    1	       ; kmask
.text:0040CA68		       push    107h	       ; cmask
.text:0040CA6D		       push    [esp+8+tst]     ; tst
.text:0040CA71		       push    0	       ; plocinfo
.text:0040CA73		       call    x_ismbbtype_l
.text:0040CA78		       add     esp, 10h
.text:0040CA7B		       retn
.text:0040CA7B __ismbbalnum    endp
.text:0040CA7B
.text:0040CA7C
.text:0040CA7C ; =============== S U B R O U T I N E =======================================
.text:0040CA7C
.text:0040CA7C
.text:0040CA7C ; int __cdecl _ismbbalpha_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CA7C __ismbbalpha_l  proc near
.text:0040CA7C
.text:0040CA7C tst	       = dword ptr  4
.text:0040CA7C plocinfo	       = dword ptr  8
.text:0040CA7C
.text:0040CA7C		       push    1	       ; kmask
.text:0040CA7E		       push    103h	       ; cmask
.text:0040CA83		       push    [esp+8+tst]     ; tst
.text:0040CA87		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CA8B		       call    x_ismbbtype_l
.text:0040CA90		       add     esp, 10h
.text:0040CA93		       retn
.text:0040CA93 __ismbbalpha_l  endp
.text:0040CA93
.text:0040CA94
.text:0040CA94 ; =============== S U B R O U T I N E =======================================
.text:0040CA94
.text:0040CA94
.text:0040CA94 ; int __cdecl _ismbbalpha(unsigned int tst)
.text:0040CA94 __ismbbalpha    proc near
.text:0040CA94
.text:0040CA94 tst	       = dword ptr  4
.text:0040CA94
.text:0040CA94		       push    1	       ; kmask
.text:0040CA96		       push    103h	       ; cmask
.text:0040CA9B		       push    [esp+8+tst]     ; tst
.text:0040CA9F		       push    0	       ; plocinfo
.text:0040CAA1		       call    x_ismbbtype_l
.text:0040CAA6		       add     esp, 10h
.text:0040CAA9		       retn
.text:0040CAA9 __ismbbalpha    endp
.text:0040CAA9
.text:0040CAAA
.text:0040CAAA ; =============== S U B R O U T I N E =======================================
.text:0040CAAA
.text:0040CAAA
.text:0040CAAA ; int __cdecl _ismbbgraph_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CAAA __ismbbgraph_l  proc near
.text:0040CAAA
.text:0040CAAA tst	       = dword ptr  4
.text:0040CAAA plocinfo	       = dword ptr  8
.text:0040CAAA
.text:0040CAAA		       push    3	       ; kmask
.text:0040CAAC		       push    117h	       ; cmask
.text:0040CAB1		       push    [esp+8+tst]     ; tst
.text:0040CAB5		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CAB9		       call    x_ismbbtype_l
.text:0040CABE		       add     esp, 10h
.text:0040CAC1		       retn
.text:0040CAC1 __ismbbgraph_l  endp
.text:0040CAC1
.text:0040CAC2
.text:0040CAC2 ; =============== S U B R O U T I N E =======================================
.text:0040CAC2
.text:0040CAC2
.text:0040CAC2 ; int __cdecl _ismbbgraph(unsigned int tst)
.text:0040CAC2 __ismbbgraph    proc near
.text:0040CAC2
.text:0040CAC2 tst	       = dword ptr  4
.text:0040CAC2
.text:0040CAC2		       push    3	       ; kmask
.text:0040CAC4		       push    117h	       ; cmask
.text:0040CAC9		       push    [esp+8+tst]     ; tst
.text:0040CACD		       push    0	       ; plocinfo
.text:0040CACF		       call    x_ismbbtype_l
.text:0040CAD4		       add     esp, 10h
.text:0040CAD7		       retn
.text:0040CAD7 __ismbbgraph    endp
.text:0040CAD7
.text:0040CAD8
.text:0040CAD8 ; =============== S U B R O U T I N E =======================================
.text:0040CAD8
.text:0040CAD8
.text:0040CAD8 ; int __cdecl _ismbbprint_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CAD8 __ismbbprint_l  proc near
.text:0040CAD8
.text:0040CAD8 tst	       = dword ptr  4
.text:0040CAD8 plocinfo	       = dword ptr  8
.text:0040CAD8
.text:0040CAD8		       push    3	       ; kmask
.text:0040CADA		       push    157h	       ; cmask
.text:0040CADF		       push    [esp+8+tst]     ; tst
.text:0040CAE3		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CAE7		       call    x_ismbbtype_l
.text:0040CAEC		       add     esp, 10h
.text:0040CAEF		       retn
.text:0040CAEF __ismbbprint_l  endp
.text:0040CAEF
.text:0040CAF0
.text:0040CAF0 ; =============== S U B R O U T I N E =======================================
.text:0040CAF0
.text:0040CAF0
.text:0040CAF0 ; int __cdecl _ismbbprint(unsigned int tst)
.text:0040CAF0 __ismbbprint    proc near
.text:0040CAF0
.text:0040CAF0 tst	       = dword ptr  4
.text:0040CAF0
.text:0040CAF0		       push    3	       ; kmask
.text:0040CAF2		       push    157h	       ; cmask
.text:0040CAF7		       push    [esp+8+tst]     ; tst
.text:0040CAFB		       push    0	       ; plocinfo
.text:0040CAFD		       call    x_ismbbtype_l
.text:0040CB02		       add     esp, 10h
.text:0040CB05		       retn
.text:0040CB05 __ismbbprint    endp
.text:0040CB05
.text:0040CB06
.text:0040CB06 ; =============== S U B R O U T I N E =======================================
.text:0040CB06
.text:0040CB06
.text:0040CB06 ; int __cdecl _ismbbpunct_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CB06 __ismbbpunct_l  proc near
.text:0040CB06
.text:0040CB06 tst	       = dword ptr  4
.text:0040CB06 plocinfo	       = dword ptr  8
.text:0040CB06
.text:0040CB06		       push    2	       ; kmask
.text:0040CB08		       push    10h	       ; cmask
.text:0040CB0A		       push    [esp+8+tst]     ; tst
.text:0040CB0E		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CB12		       call    x_ismbbtype_l
.text:0040CB17		       add     esp, 10h
.text:0040CB1A		       retn
.text:0040CB1A __ismbbpunct_l  endp
.text:0040CB1A
.text:0040CB1B
.text:0040CB1B ; =============== S U B R O U T I N E =======================================
.text:0040CB1B
.text:0040CB1B
.text:0040CB1B ; int __cdecl _ismbbpunct(unsigned int tst)
.text:0040CB1B __ismbbpunct    proc near
.text:0040CB1B
.text:0040CB1B tst	       = dword ptr  4
.text:0040CB1B
.text:0040CB1B		       push    2	       ; kmask
.text:0040CB1D		       push    10h	       ; cmask
.text:0040CB1F		       push    [esp+8+tst]     ; tst
.text:0040CB23		       push    0	       ; plocinfo
.text:0040CB25		       call    x_ismbbtype_l
.text:0040CB2A		       add     esp, 10h
.text:0040CB2D		       retn
.text:0040CB2D __ismbbpunct    endp
.text:0040CB2D
.text:0040CB2E
.text:0040CB2E ; =============== S U B R O U T I N E =======================================
.text:0040CB2E
.text:0040CB2E
.text:0040CB2E ; int __cdecl _ismbblead_l(unsigned int tst, localeinfo_struct *plocinfo)
.text:0040CB2E __ismbblead_l   proc near
.text:0040CB2E
.text:0040CB2E tst	       = dword ptr  4
.text:0040CB2E plocinfo	       = dword ptr  8
.text:0040CB2E
.text:0040CB2E		       push    4	       ; kmask
.text:0040CB30		       push    0	       ; cmask
.text:0040CB32		       push    [esp+8+tst]     ; tst
.text:0040CB36		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CB3A		       call    x_ismbbtype_l
.text:0040CB3F		       add     esp, 10h
.text:0040CB42		       retn
.text:0040CB42 __ismbblead_l   endp
.text:0040CB42
.text:0040CB43
.text:0040CB43 ; =============== S U B R O U T I N E =======================================
.text:0040CB43
.text:0040CB43
.text:0040CB43 ; int __cdecl _ismbblead(unsigned int tst)
.text:0040CB43 __ismbblead     proc near	       ; CODE XREF: parse_cmdline+53p
.text:0040CB43					       ; parse_cmdline+138p ...
.text:0040CB43
.text:0040CB43 tst	       = dword ptr  4
.text:0040CB43
.text:0040CB43		       push    4	       ; kmask
.text:0040CB45		       push    0	       ; cmask
.text:0040CB47		       push    [esp+8+tst]     ; tst
.text:0040CB4B		       push    0	       ; plocinfo
.text:0040CB4D		       call    x_ismbbtype_l
.text:0040CB52		       add     esp, 10h
.text:0040CB55		       retn
.text:0040CB55 __ismbblead     endp
.text:0040CB55
.text:0040CB56
.text:0040CB56 ; =============== S U B R O U T I N E =======================================
.text:0040CB56
.text:0040CB56
.text:0040CB56 ; int __cdecl _ismbbtrail_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CB56 __ismbbtrail_l  proc near
.text:0040CB56
.text:0040CB56 tst	       = dword ptr  4
.text:0040CB56 plocinfo	       = dword ptr  8
.text:0040CB56
.text:0040CB56		       push    8	       ; kmask
.text:0040CB58		       push    0	       ; cmask
.text:0040CB5A		       push    [esp+8+tst]     ; tst
.text:0040CB5E		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CB62		       call    x_ismbbtype_l
.text:0040CB67		       add     esp, 10h
.text:0040CB6A		       retn
.text:0040CB6A __ismbbtrail_l  endp
.text:0040CB6A
.text:0040CB6B
.text:0040CB6B ; =============== S U B R O U T I N E =======================================
.text:0040CB6B
.text:0040CB6B
.text:0040CB6B ; int __cdecl _ismbbtrail(unsigned int tst)
.text:0040CB6B __ismbbtrail    proc near
.text:0040CB6B
.text:0040CB6B tst	       = dword ptr  4
.text:0040CB6B
.text:0040CB6B		       push    8	       ; kmask
.text:0040CB6D		       push    0	       ; cmask
.text:0040CB6F		       push    [esp+8+tst]     ; tst
.text:0040CB73		       push    0	       ; plocinfo
.text:0040CB75		       call    x_ismbbtype_l
.text:0040CB7A		       add     esp, 10h
.text:0040CB7D		       retn
.text:0040CB7D __ismbbtrail    endp
.text:0040CB7D
.text:0040CB7E
.text:0040CB7E ; =============== S U B R O U T I N E =======================================
.text:0040CB7E
.text:0040CB7E ; Attributes: bp-based frame
.text:0040CB7E
.text:0040CB7E ; int __cdecl _ismbbkana_l(unsigned int tst, localeinfo_struct *plocinfo)
.text:0040CB7E __ismbbkana_l   proc near	       ; CODE XREF: __ismbbkana+6p
.text:0040CB7E
.text:0040CB7E _loc_update     = _LocaleUpdate ptr -10h
.text:0040CB7E tst	       = dword ptr  8
.text:0040CB7E plocinfo	       = dword ptr  0Ch
.text:0040CB7E
.text:0040CB7E		       push    ebp
.text:0040CB7F		       mov     ebp, esp
.text:0040CB81		       sub     esp, 10h
.text:0040CB84		       push    [ebp+plocinfo]  ; plocinfo
.text:0040CB87		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040CB8A		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040CB8F		       mov     eax, [ebp+_loc_update.localeinfo.mbcinfo]
.text:0040CB92		       test    eax, eax
.text:0040CB94		       jz      short loc_40CBC0
.text:0040CB96		       cmp     dword ptr [eax+4], 3A4h
.text:0040CB9D		       jnz     short loc_40CBC0
.text:0040CB9F		       push    3	       ; kmask
.text:0040CBA1		       push    0	       ; cmask
.text:0040CBA3		       push    [ebp+tst]       ; tst
.text:0040CBA6		       push    [ebp+plocinfo]  ; plocinfo
.text:0040CBA9		       call    x_ismbbtype_l
.text:0040CBAE		       add     esp, 10h
.text:0040CBB1		       cmp     [ebp+_loc_update.updated], 0
.text:0040CBB5		       jz      short locret_40CBCF
.text:0040CBB7		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040CBBA		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040CBBE		       leave
.text:0040CBBF		       retn
.text:0040CBC0 ; ---------------------------------------------------------------------------
.text:0040CBC0
.text:0040CBC0 loc_40CBC0:			       ; CODE XREF: __ismbbkana_l+16j
.text:0040CBC0					       ; __ismbbkana_l+1Fj
.text:0040CBC0		       cmp     [ebp+_loc_update.updated], 0
.text:0040CBC4		       jz      short loc_40CBCD
.text:0040CBC6		       mov     eax, [ebp+_loc_update.ptd]
.text:0040CBC9		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040CBCD
.text:0040CBCD loc_40CBCD:			       ; CODE XREF: __ismbbkana_l+46j
.text:0040CBCD		       xor     eax, eax
.text:0040CBCF
.text:0040CBCF locret_40CBCF:			       ; CODE XREF: __ismbbkana_l+37j
.text:0040CBCF		       leave
.text:0040CBD0		       retn
.text:0040CBD0 __ismbbkana_l   endp
.text:0040CBD0
.text:0040CBD1
.text:0040CBD1 ; =============== S U B R O U T I N E =======================================
.text:0040CBD1
.text:0040CBD1
.text:0040CBD1 ; int __cdecl _ismbbkana(unsigned int tst)
.text:0040CBD1 __ismbbkana     proc near
.text:0040CBD1
.text:0040CBD1 tst	       = dword ptr  4
.text:0040CBD1
.text:0040CBD1		       push    0	       ; plocinfo
.text:0040CBD3		       push    [esp+4+tst]     ; tst
.text:0040CBD7		       call    __ismbbkana_l
.text:0040CBDC		       pop     ecx
.text:0040CBDD		       pop     ecx
.text:0040CBDE		       retn
.text:0040CBDE __ismbbkana     endp
.text:0040CBDE
.text:0040CBDF
.text:0040CBDF ; =============== S U B R O U T I N E =======================================
.text:0040CBDF
.text:0040CBDF
.text:0040CBDF ; int __usercall	strncnt<eax>(const char	*string<eax>, int cnt)
.text:0040CBDF strncnt	       proc near
.text:0040CBDF
.text:0040CBDF cnt	       = dword ptr  4
.text:0040CBDF
.text:0040CBDF string =	eax
.text:0040CBDF		       mov     ecx, [esp+cnt]
.text:0040CBE3		       jmp     short loc_40CBEC
.text:0040CBE5 ; ---------------------------------------------------------------------------
.text:0040CBE5
.text:0040CBE5 loc_40CBE5:			       ; CODE XREF: strncnt+Fj
.text:0040CBE5		       dec     ecx
.text:0040CBE6		       cmp     byte ptr	[string], 0
.text:0040CBE9		       jz      short loc_40CBF1
.text:0040CBEB		       inc     string
.text:0040CBEC
.text:0040CBEC loc_40CBEC:			       ; CODE XREF: strncnt+4j
.text:0040CBEC		       test    ecx, ecx
.text:0040CBEE		       jnz     short loc_40CBE5
.text:0040CBF0		       dec     ecx
.text:0040CBF1
.text:0040CBF1 loc_40CBF1:			       ; CODE XREF: strncnt+Aj
.text:0040CBF1		       mov     string, [esp+cnt]
.text:0040CBF5		       sub     string, ecx
.text:0040CBF7		       dec     string
.text:0040CBF8		       retn
.text:0040CBF8 strncnt	       endp
.text:0040CBF8
.text:0040CBF9
.text:0040CBF9 ; =============== S U B R O U T I N E =======================================
.text:0040CBF9
.text:0040CBF9 ; Attributes: bp-based frame
.text:0040CBF9
.text:0040CBF9 ; int __usercall	_crtLCMapStringA_stat<eax>(localeinfo_struct *plocinfo<ecx>, unsigned int Locale, unsigned int dwMapFlags, const char *lpSrcStr, int cchSrc, char *lpDestStr, int cchDest, int code_page, int bError)
.text:0040CBF9 __crtLCMapStringA_stat proc near	       ; CODE XREF: ___crtLCMapStringA+2Cp
.text:0040CBF9
.text:0040CBF9 AnsiCP	       = dword ptr -14h
.text:0040CBF9 cbuffer2	       = dword ptr -10h
.text:0040CBF9 inwbuffer       = dword ptr -0Ch
.text:0040CBF9 retval	       = dword ptr -8
.text:0040CBF9 var_4	       = dword ptr -4
.text:0040CBF9 Locale	       = dword ptr  8
.text:0040CBF9 dwMapFlags      = dword ptr  0Ch
.text:0040CBF9 lpSrcStr	       = dword ptr  10h
.text:0040CBF9 cchSrc	       = dword ptr  14h
.text:0040CBF9 lpDestStr       = dword ptr  18h
.text:0040CBF9 cchDest	       = dword ptr  1Ch
.text:0040CBF9 code_page       = dword ptr  20h
.text:0040CBF9 bError	       = dword ptr  24h
.text:0040CBF9
.text:0040CBF9 plocinfo	= ecx
.text:0040CBF9		       push    ebp
.text:0040CBFA		       mov     ebp, esp
.text:0040CBFC		       sub     esp, 14h
.text:0040CBFF		       mov     eax, ___security_cookie
.text:0040CC04		       xor     eax, ebp
.text:0040CC06		       mov     [ebp+var_4], eax
.text:0040CC09		       push    ebx
.text:0040CC0A		       push    esi
.text:0040CC0B		       xor     ebx, ebx
.text:0040CC0D		       cmp     f_use_2,	ebx
.text:0040CC13		       push    edi
.text:0040CC14		       mov     esi, plocinfo
.text:0040CC16		       jnz     short loc_40CC50
.text:0040CC18		       push    ebx	       ; cchDest
.text:0040CC19		       push    ebx	       ; lpDestStr
.text:0040CC1A		       xor     edi, edi
.text:0040CC1C		       inc     edi
.text:0040CC1D		       push    edi	       ; cchSrc
.text:0040CC1E		       push    offset SrcStr   ; lpSrcStr
.text:0040CC23		       push    100h	       ; dwMapFlags
.text:0040CC28		       push    ebx	       ; Locale
.text:0040CC29		       call    ds:__imp__LCMapStringW@24 ; LCMapStringW(x,x,x,x,x,x)
.text:0040CC2F		       test    eax, eax
.text:0040CC31		       jz      short loc_40CC3B
.text:0040CC33		       mov     f_use_2,	edi
.text:0040CC39		       jmp     short loc_40CC50
.text:0040CC3B ; ---------------------------------------------------------------------------
.text:0040CC3B
.text:0040CC3B loc_40CC3B:			       ; CODE XREF: __crtLCMapStringA_stat+38j
.text:0040CC3B		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040CC41		       cmp     eax, 78h
.text:0040CC44		       jnz     short loc_40CC50
.text:0040CC46		       mov     f_use_2,	2
.text:0040CC50
.text:0040CC50 loc_40CC50:			       ; CODE XREF: __crtLCMapStringA_stat+1Dj
.text:0040CC50					       ; __crtLCMapStringA_stat+40j ...
.text:0040CC50		       cmp     [ebp+cchSrc], ebx
.text:0040CC53		       jle     short loc_40CC77
.text:0040CC55		       mov     plocinfo, [ebp+cchSrc]
.text:0040CC58		       mov     eax, [ebp+lpSrcStr]
.text:0040CC5B
.text:0040CC5B loc_40CC5B:			       ; CODE XREF: __crtLCMapStringA_stat+6Aj
.text:0040CC5B		       dec     plocinfo
.text:0040CC5C		       cmp     [eax], bl
.text:0040CC5E		       jz      short loc_40CC68
.text:0040CC60		       inc     eax
.text:0040CC61		       cmp     plocinfo, ebx
.text:0040CC63		       jnz     short loc_40CC5B
.text:0040CC65		       or      plocinfo, 0FFFFFFFFh
.text:0040CC68
.text:0040CC68 loc_40CC68:			       ; CODE XREF: __crtLCMapStringA_stat+65j
.text:0040CC68		       mov     eax, [ebp+cchSrc]
.text:0040CC6B		       sub     eax, plocinfo
.text:0040CC6D		       dec     eax
.text:0040CC6E		       cmp     eax, [ebp+cchSrc]
.text:0040CC71		       jge     short loc_40CC74
.text:0040CC73		       inc     eax
.text:0040CC74
.text:0040CC74 loc_40CC74:			       ; CODE XREF: __crtLCMapStringA_stat+78j
.text:0040CC74		       mov     [ebp+cchSrc], eax
.text:0040CC77
.text:0040CC77 loc_40CC77:			       ; CODE XREF: __crtLCMapStringA_stat+5Aj
.text:0040CC77		       mov     eax, f_use_2
.text:0040CC7C		       cmp     eax, 2
.text:0040CC7F		       jz      loc_40CE30
.text:0040CC85		       cmp     eax, ebx
.text:0040CC87		       jz      loc_40CE30
.text:0040CC8D		       cmp     eax, 1
.text:0040CC90		       jnz     loc_40CE61
.text:0040CC96		       cmp     [ebp+code_page],	ebx
.text:0040CC99		       mov     [ebp+retval], ebx
.text:0040CC9C		       jnz     short loc_40CCA6
.text:0040CC9E		       mov     eax, [esi]
.text:0040CCA0		       mov     eax, [eax+4]
.text:0040CCA3		       mov     [ebp+code_page],	eax
.text:0040CCA6
.text:0040CCA6 loc_40CCA6:			       ; CODE XREF: __crtLCMapStringA_stat+A3j
.text:0040CCA6		       mov     esi, ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
.text:0040CCAC		       xor     eax, eax
.text:0040CCAE		       cmp     [ebp+bError], ebx
.text:0040CCB1		       push    ebx	       ; cchWideChar
.text:0040CCB2		       push    ebx	       ; lpWideCharStr
.text:0040CCB3		       push    [ebp+cchSrc]    ; cbMultiByte
.text:0040CCB6		       setnz   al
.text:0040CCB9		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0040CCBC		       lea     eax, ds:1[eax*8]
.text:0040CCC3		       push    eax	       ; dwFlags
.text:0040CCC4		       push    [ebp+code_page] ; CodePage
.text:0040CCC7		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0040CCC9		       mov     edi, eax
.text:0040CCCB		       cmp     edi, ebx
.text:0040CCCD		       jz      loc_40CE61
.text:0040CCD3		       jle     short loc_40CD18
.text:0040CCD5		       push    0FFFFFFE0h
.text:0040CCD7		       xor     edx, edx
.text:0040CCD9		       pop     eax
.text:0040CCDA		       div     edi
.text:0040CCDC		       cmp     eax, 2
.text:0040CCDF		       jb      short loc_40CD18
.text:0040CCE1		       lea     eax, [edi+edi+8]
.text:0040CCE5		       cmp     eax, 400h
.text:0040CCEA		       ja      short loc_40CCFF
.text:0040CCEC		       call    __alloca_probe_16
.text:0040CCF1		       mov     eax, esp
.text:0040CCF3		       cmp     eax, ebx
.text:0040CCF5		       jz      short loc_40CD13
.text:0040CCF7		       mov     dword ptr [eax],	0CCCCh
.text:0040CCFD		       jmp     short loc_40CD10
.text:0040CCFF ; ---------------------------------------------------------------------------
.text:0040CCFF
.text:0040CCFF loc_40CCFF:			       ; CODE XREF: __crtLCMapStringA_stat+F1j
.text:0040CCFF		       push    eax	       ; size
.text:0040CD00		       call    _malloc
.text:0040CD05		       cmp     eax, ebx
.text:0040CD07		       pop     plocinfo
.text:0040CD08		       jz      short loc_40CD13
.text:0040CD0A		       mov     dword ptr [eax],	0DDDDh
.text:0040CD10
.text:0040CD10 loc_40CD10:			       ; CODE XREF: __crtLCMapStringA_stat+104j
.text:0040CD10		       add     eax, 8
.text:0040CD13
.text:0040CD13 loc_40CD13:			       ; CODE XREF: __crtLCMapStringA_stat+FCj
.text:0040CD13					       ; __crtLCMapStringA_stat+10Fj
.text:0040CD13		       mov     [ebp+inwbuffer],	eax
.text:0040CD16		       jmp     short loc_40CD1B
.text:0040CD18 ; ---------------------------------------------------------------------------
.text:0040CD18
.text:0040CD18 loc_40CD18:			       ; CODE XREF: __crtLCMapStringA_stat+DAj
.text:0040CD18					       ; __crtLCMapStringA_stat+E6j
.text:0040CD18		       mov     [ebp+inwbuffer],	ebx
.text:0040CD1B
.text:0040CD1B loc_40CD1B:			       ; CODE XREF: __crtLCMapStringA_stat+11Dj
.text:0040CD1B		       cmp     [ebp+inwbuffer],	ebx
.text:0040CD1E		       jz      loc_40CE61
.text:0040CD24		       push    edi	       ; cchWideChar
.text:0040CD25		       push    [ebp+inwbuffer] ; lpWideCharStr
.text:0040CD28		       push    [ebp+cchSrc]    ; cbMultiByte
.text:0040CD2B		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0040CD2E		       push    1	       ; dwFlags
.text:0040CD30		       push    [ebp+code_page] ; CodePage
.text:0040CD33		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0040CD35		       test    eax, eax
.text:0040CD37		       jz      loc_40CE1F
.text:0040CD3D		       mov     esi, ds:__imp__LCMapStringW@24 ;	LCMapStringW(x,x,x,x,x,x)
.text:0040CD43		       push    ebx	       ; cchDest
.text:0040CD44		       push    ebx	       ; lpDestStr
.text:0040CD45		       push    edi	       ; cchSrc
.text:0040CD46		       push    [ebp+inwbuffer] ; lpSrcStr
.text:0040CD49		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040CD4C		       push    [ebp+Locale]    ; Locale
.text:0040CD4F		       call    esi ; LCMapStringW(x,x,x,x,x,x) ; LCMapStringW(x,x,x,x,x,x)
.text:0040CD51		       mov     plocinfo, eax
.text:0040CD53		       cmp     plocinfo, ebx
.text:0040CD55		       mov     [ebp+retval], plocinfo
.text:0040CD58		       jz      loc_40CE1F
.text:0040CD5E		       test    word ptr	[ebp+dwMapFlags], 400h
.text:0040CD64		       jz      short loc_40CD8F
.text:0040CD66		       cmp     [ebp+cchDest], ebx
.text:0040CD69		       jz      loc_40CE1F
.text:0040CD6F		       cmp     plocinfo, [ebp+cchDest]
.text:0040CD72		       jg      loc_40CE1F
.text:0040CD78		       push    [ebp+cchDest]   ; cchDest
.text:0040CD7B		       push    [ebp+lpDestStr] ; lpDestStr
.text:0040CD7E		       push    edi	       ; cchSrc
.text:0040CD7F		       push    [ebp+inwbuffer] ; lpSrcStr
.text:0040CD82		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040CD85		       push    [ebp+Locale]    ; Locale
.text:0040CD88		       call    esi ; LCMapStringW(x,x,x,x,x,x) ; LCMapStringW(x,x,x,x,x,x)
.text:0040CD8A		       jmp     loc_40CE1F
.text:0040CD8F ; ---------------------------------------------------------------------------
.text:0040CD8F
.text:0040CD8F loc_40CD8F:			       ; CODE XREF: __crtLCMapStringA_stat+16Bj
.text:0040CD8F		       cmp     plocinfo, ebx
.text:0040CD91		       jle     short loc_40CDD8
.text:0040CD93		       push    0FFFFFFE0h
.text:0040CD95		       xor     edx, edx
.text:0040CD97		       pop     eax
.text:0040CD98		       div     plocinfo
.text:0040CD9A		       cmp     eax, 2
.text:0040CD9D		       jb      short loc_40CDD8
.text:0040CD9F		       lea     eax, [plocinfo+plocinfo+8]
.text:0040CDA3		       cmp     eax, 400h
.text:0040CDA8		       ja      short loc_40CDC0
.text:0040CDAA		       call    __alloca_probe_16
.text:0040CDAF		       mov     esi, esp
.text:0040CDB1		       cmp     esi, ebx
.text:0040CDB3		       jz      short loc_40CE1F
.text:0040CDB5		       mov     dword ptr [esi],	0CCCCh
.text:0040CDBB		       add     esi, 8
.text:0040CDBE		       jmp     short loc_40CDDA
.text:0040CDC0 ; ---------------------------------------------------------------------------
.text:0040CDC0
.text:0040CDC0 loc_40CDC0:			       ; CODE XREF: __crtLCMapStringA_stat+1AFj
.text:0040CDC0		       push    eax	       ; size
.text:0040CDC1		       call    _malloc
.text:0040CDC6		       cmp     eax, ebx
.text:0040CDC8		       pop     plocinfo
.text:0040CDC9		       jz      short loc_40CDD4
.text:0040CDCB		       mov     dword ptr [eax],	0DDDDh
.text:0040CDD1		       add     eax, 8
.text:0040CDD4
.text:0040CDD4 loc_40CDD4:			       ; CODE XREF: __crtLCMapStringA_stat+1D0j
.text:0040CDD4		       mov     esi, eax
.text:0040CDD6		       jmp     short loc_40CDDA
.text:0040CDD8 ; ---------------------------------------------------------------------------
.text:0040CDD8
.text:0040CDD8 loc_40CDD8:			       ; CODE XREF: __crtLCMapStringA_stat+198j
.text:0040CDD8					       ; __crtLCMapStringA_stat+1A4j
.text:0040CDD8		       xor     esi, esi
.text:0040CDDA
.text:0040CDDA loc_40CDDA:			       ; CODE XREF: __crtLCMapStringA_stat+1C5j
.text:0040CDDA					       ; __crtLCMapStringA_stat+1DDj
.text:0040CDDA		       cmp     esi, ebx
.text:0040CDDC		       jz      short loc_40CE1F
.text:0040CDDE		       push    [ebp+retval]    ; cchDest
.text:0040CDE1		       push    esi	       ; lpDestStr
.text:0040CDE2		       push    edi	       ; cchSrc
.text:0040CDE3		       push    [ebp+inwbuffer] ; lpSrcStr
.text:0040CDE6		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040CDE9		       push    [ebp+Locale]    ; Locale
.text:0040CDEC		       call    ds:__imp__LCMapStringW@24 ; LCMapStringW(x,x,x,x,x,x)
.text:0040CDF2		       test    eax, eax
.text:0040CDF4		       jz      short error_cleanup_1
.text:0040CDF6		       cmp     [ebp+cchDest], ebx
.text:0040CDF9		       push    ebx	       ; lpUsedDefaultChar
.text:0040CDFA		       push    ebx	       ; lpDefaultChar
.text:0040CDFB		       jnz     short loc_40CE01
.text:0040CDFD		       push    ebx
.text:0040CDFE		       push    ebx
.text:0040CDFF		       jmp     short loc_40CE07
.text:0040CE01 ; ---------------------------------------------------------------------------
.text:0040CE01
.text:0040CE01 loc_40CE01:			       ; CODE XREF: __crtLCMapStringA_stat+202j
.text:0040CE01		       push    [ebp+cchDest]   ; cbMultiByte
.text:0040CE04		       push    [ebp+lpDestStr] ; lpMultiByteStr
.text:0040CE07
.text:0040CE07 loc_40CE07:			       ; CODE XREF: __crtLCMapStringA_stat+206j
.text:0040CE07		       push    [ebp+retval]    ; cchWideChar
.text:0040CE0A		       push    esi	       ; lpWideCharStr
.text:0040CE0B		       push    ebx	       ; dwFlags
.text:0040CE0C		       push    [ebp+code_page] ; CodePage
.text:0040CE0F		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040CE15		       mov     [ebp+retval], eax
.text:0040CE18
.text:0040CE18 error_cleanup_1:			       ; CODE XREF: __crtLCMapStringA_stat+1FBj
.text:0040CE18		       push    esi	       ; _Memory
.text:0040CE19		       call    __freea
.text:0040CE1E		       pop     plocinfo
.text:0040CE1F
.text:0040CE1F loc_40CE1F:			       ; CODE XREF: __crtLCMapStringA_stat+13Ej
.text:0040CE1F					       ; __crtLCMapStringA_stat+15Fj ...
.text:0040CE1F		       push    [ebp+inwbuffer] ; _Memory
.text:0040CE22		       call    __freea
.text:0040CE27		       mov     eax, [ebp+retval]
.text:0040CE2A		       pop     plocinfo
.text:0040CE2B		       jmp     loc_40CF89
.text:0040CE30 ; ---------------------------------------------------------------------------
.text:0040CE30
.text:0040CE30 loc_40CE30:			       ; CODE XREF: __crtLCMapStringA_stat+86j
.text:0040CE30					       ; __crtLCMapStringA_stat+8Ej
.text:0040CE30		       cmp     [ebp+Locale], ebx
.text:0040CE33		       mov     [ebp+inwbuffer],	ebx
.text:0040CE36		       mov     [ebp+cbuffer2], ebx
.text:0040CE39		       jnz     short loc_40CE43
.text:0040CE3B		       mov     eax, [esi]
.text:0040CE3D		       mov     eax, [eax+14h]
.text:0040CE40		       mov     [ebp+Locale], eax
.text:0040CE43
.text:0040CE43 loc_40CE43:			       ; CODE XREF: __crtLCMapStringA_stat+240j
.text:0040CE43		       cmp     [ebp+code_page],	ebx
.text:0040CE46		       jnz     short loc_40CE50
.text:0040CE48		       mov     eax, [esi]
.text:0040CE4A		       mov     eax, [eax+4]
.text:0040CE4D		       mov     [ebp+code_page],	eax
.text:0040CE50
.text:0040CE50 loc_40CE50:			       ; CODE XREF: __crtLCMapStringA_stat+24Dj
.text:0040CE50		       push    [ebp+Locale]    ; lcid
.text:0040CE53		       call    ___ansicp
.text:0040CE58		       cmp     eax, 0FFFFFFFFh
.text:0040CE5B		       pop     plocinfo
.text:0040CE5C		       mov     [ebp+AnsiCP], eax
.text:0040CE5F		       jnz     short loc_40CE68
.text:0040CE61
.text:0040CE61 loc_40CE61:			       ; CODE XREF: __crtLCMapStringA_stat+97j
.text:0040CE61					       ; __crtLCMapStringA_stat+D4j ...
.text:0040CE61		       xor     eax, eax
.text:0040CE63		       jmp     loc_40CF89
.text:0040CE68 ; ---------------------------------------------------------------------------
.text:0040CE68
.text:0040CE68 loc_40CE68:			       ; CODE XREF: __crtLCMapStringA_stat+266j
.text:0040CE68		       cmp     eax, [ebp+code_page]
.text:0040CE6B		       jz      loc_40CF4C
.text:0040CE71		       push    ebx	       ; cchDest
.text:0040CE72		       push    ebx	       ; lpDestStr
.text:0040CE73		       lea     plocinfo, [ebp+cchSrc]
.text:0040CE76		       push    plocinfo	       ; pcchSrc
.text:0040CE77		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040CE7A		       push    eax	       ; toCP
.text:0040CE7B		       push    [ebp+code_page] ; fromCP
.text:0040CE7E		       call    ___convertcp
.text:0040CE83		       add     esp, 18h
.text:0040CE86		       cmp     eax, ebx
.text:0040CE88		       mov     [ebp+inwbuffer],	eax
.text:0040CE8B		       jz      short loc_40CE61
.text:0040CE8D		       mov     esi, ds:__imp__LCMapStringA@24 ;	LCMapStringA(x,x,x,x,x,x)
.text:0040CE93		       push    ebx	       ; cchDest
.text:0040CE94		       push    ebx	       ; lpDestStr
.text:0040CE95		       push    [ebp+cchSrc]    ; cchSrc
.text:0040CE98		       push    eax	       ; lpSrcStr
.text:0040CE99		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040CE9C		       push    [ebp+Locale]    ; Locale
.text:0040CE9F		       call    esi ; LCMapStringA(x,x,x,x,x,x) ; LCMapStringA(x,x,x,x,x,x)
.text:0040CEA1		       cmp     eax, ebx
.text:0040CEA3		       mov     [ebp+retval], eax
.text:0040CEA6		       jnz     short loc_40CEAF
.text:0040CEA8
.text:0040CEA8 loc_40CEA8:			       ; CODE XREF: __crtLCMapStringA_stat+2D0j
.text:0040CEA8					       ; __crtLCMapStringA_stat+2F9j
.text:0040CEA8		       xor     esi, esi
.text:0040CEAA		       jmp     loc_40CF66
.text:0040CEAF ; ---------------------------------------------------------------------------
.text:0040CEAF
.text:0040CEAF loc_40CEAF:			       ; CODE XREF: __crtLCMapStringA_stat+2ADj
.text:0040CEAF		       jle     short loc_40CEEE
.text:0040CEB1		       cmp     eax, 0FFFFFFE0h
.text:0040CEB4		       ja      short loc_40CEEE
.text:0040CEB6		       add     eax, 8
.text:0040CEB9		       cmp     eax, 400h
.text:0040CEBE		       ja      short loc_40CED6
.text:0040CEC0		       call    __alloca_probe_16
.text:0040CEC5		       mov     edi, esp
.text:0040CEC7		       cmp     edi, ebx
.text:0040CEC9		       jz      short loc_40CEA8
.text:0040CECB		       mov     dword ptr [edi],	0CCCCh
.text:0040CED1		       add     edi, 8
.text:0040CED4		       jmp     short loc_40CEF0
.text:0040CED6 ; ---------------------------------------------------------------------------
.text:0040CED6
.text:0040CED6 loc_40CED6:			       ; CODE XREF: __crtLCMapStringA_stat+2C5j
.text:0040CED6		       push    eax	       ; size
.text:0040CED7		       call    _malloc
.text:0040CEDC		       cmp     eax, ebx
.text:0040CEDE		       pop     plocinfo
.text:0040CEDF		       jz      short loc_40CEEA
.text:0040CEE1		       mov     dword ptr [eax],	0DDDDh
.text:0040CEE7		       add     eax, 8
.text:0040CEEA
.text:0040CEEA loc_40CEEA:			       ; CODE XREF: __crtLCMapStringA_stat+2E6j
.text:0040CEEA		       mov     edi, eax
.text:0040CEEC		       jmp     short loc_40CEF0
.text:0040CEEE ; ---------------------------------------------------------------------------
.text:0040CEEE
.text:0040CEEE loc_40CEEE:			       ; CODE XREF: __crtLCMapStringA_stat:loc_40CEAFj
.text:0040CEEE					       ; __crtLCMapStringA_stat+2BBj
.text:0040CEEE		       xor     edi, edi
.text:0040CEF0
.text:0040CEF0 loc_40CEF0:			       ; CODE XREF: __crtLCMapStringA_stat+2DBj
.text:0040CEF0					       ; __crtLCMapStringA_stat+2F3j
.text:0040CEF0		       cmp     edi, ebx
.text:0040CEF2		       jz      short loc_40CEA8
.text:0040CEF4		       push    [ebp+retval]    ; count
.text:0040CEF7		       push    ebx	       ; value
.text:0040CEF8		       push    edi	       ; dst
.text:0040CEF9		       call    _memset
.text:0040CEFE		       add     esp, 0Ch
.text:0040CF01		       push    [ebp+retval]    ; cchDest
.text:0040CF04		       push    edi	       ; lpDestStr
.text:0040CF05		       push    [ebp+cchSrc]    ; cchSrc
.text:0040CF08		       push    [ebp+inwbuffer] ; lpSrcStr
.text:0040CF0B		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040CF0E		       push    [ebp+Locale]    ; Locale
.text:0040CF11		       call    esi ; LCMapStringA(x,x,x,x,x,x) ; LCMapStringA(x,x,x,x,x,x)
.text:0040CF13		       cmp     eax, ebx
.text:0040CF15		       mov     [ebp+retval], eax
.text:0040CF18		       jnz     short loc_40CF1E
.text:0040CF1A		       xor     esi, esi
.text:0040CF1C		       jmp     short cleanupA
.text:0040CF1E ; ---------------------------------------------------------------------------
.text:0040CF1E
.text:0040CF1E loc_40CF1E:			       ; CODE XREF: __crtLCMapStringA_stat+31Fj
.text:0040CF1E		       push    [ebp+cchDest]   ; cchDest
.text:0040CF21		       lea     eax, [ebp+retval]
.text:0040CF24		       push    [ebp+lpDestStr] ; lpDestStr
.text:0040CF27		       push    eax	       ; pcchSrc
.text:0040CF28		       push    edi	       ; lpSrcStr
.text:0040CF29		       push    [ebp+code_page] ; toCP
.text:0040CF2C		       push    [ebp+AnsiCP]    ; fromCP
.text:0040CF2F		       call    ___convertcp
.text:0040CF34		       mov     esi, eax
.text:0040CF36		       mov     [ebp+cbuffer2], esi
.text:0040CF39		       add     esp, 18h
.text:0040CF3C		       neg     esi
.text:0040CF3E		       sbb     esi, esi
.text:0040CF40		       and     esi, [ebp+retval]
.text:0040CF43
.text:0040CF43 cleanupA:			       ; CODE XREF: __crtLCMapStringA_stat+323j
.text:0040CF43		       push    edi	       ; _Memory
.text:0040CF44		       call    __freea
.text:0040CF49		       pop     plocinfo
.text:0040CF4A		       jmp     short loc_40CF66
.text:0040CF4C ; ---------------------------------------------------------------------------
.text:0040CF4C
.text:0040CF4C loc_40CF4C:			       ; CODE XREF: __crtLCMapStringA_stat+272j
.text:0040CF4C		       push    [ebp+cchDest]   ; cchDest
.text:0040CF4F		       push    [ebp+lpDestStr] ; lpDestStr
.text:0040CF52		       push    [ebp+cchSrc]    ; cchSrc
.text:0040CF55		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040CF58		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040CF5B		       push    [ebp+Locale]    ; Locale
.text:0040CF5E		       call    ds:__imp__LCMapStringA@24 ; LCMapStringA(x,x,x,x,x,x)
.text:0040CF64		       mov     esi, eax
.text:0040CF66
.text:0040CF66 loc_40CF66:			       ; CODE XREF: __crtLCMapStringA_stat+2B1j
.text:0040CF66					       ; __crtLCMapStringA_stat+351j
.text:0040CF66		       cmp     [ebp+inwbuffer],	ebx
.text:0040CF69		       jz      short loc_40CF74
.text:0040CF6B		       push    [ebp+inwbuffer] ; pBlock
.text:0040CF6E		       call    _free
.text:0040CF73		       pop     plocinfo
.text:0040CF74
.text:0040CF74 loc_40CF74:			       ; CODE XREF: __crtLCMapStringA_stat+370j
.text:0040CF74		       mov     eax, [ebp+cbuffer2]
.text:0040CF77		       cmp     eax, ebx
.text:0040CF79		       jz      short loc_40CF87
.text:0040CF7B		       cmp     [ebp+lpDestStr],	eax
.text:0040CF7E		       jz      short loc_40CF87
.text:0040CF80		       push    eax	       ; pBlock
.text:0040CF81		       call    _free
.text:0040CF86		       pop     plocinfo
.text:0040CF87
.text:0040CF87 loc_40CF87:			       ; CODE XREF: __crtLCMapStringA_stat+380j
.text:0040CF87					       ; __crtLCMapStringA_stat+385j
.text:0040CF87		       mov     eax, esi
.text:0040CF89
.text:0040CF89 loc_40CF89:			       ; CODE XREF: __crtLCMapStringA_stat+232j
.text:0040CF89					       ; __crtLCMapStringA_stat+26Aj
.text:0040CF89		       lea     esp, [ebp-20h]
.text:0040CF8C		       pop     edi
.text:0040CF8D		       pop     esi
.text:0040CF8E		       pop     ebx
.text:0040CF8F		       mov     plocinfo, [ebp+var_4]
.text:0040CF92		       xor     plocinfo, ebp   ; cookie
.text:0040CF94		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040CF99		       leave
.text:0040CF9A		       retn
.text:0040CF9A __crtLCMapStringA_stat endp
.text:0040CF9A
.text:0040CF9B
.text:0040CF9B ; =============== S U B R O U T I N E =======================================
.text:0040CF9B
.text:0040CF9B ; Attributes: bp-based frame
.text:0040CF9B
.text:0040CF9B ; int __cdecl __crtLCMapStringA(localeinfo_struct *plocinfo, unsigned int Locale, unsigned int dwMapFlags, const	char *lpSrcStr,	int cchSrc, char *lpDestStr, int cchDest, int code_page, int bError)
.text:0040CF9B ___crtLCMapStringA proc near	       ; CODE XREF: setSBUpLow+B6p
.text:0040CF9B					       ; setSBUpLow+DBp ...
.text:0040CF9B
.text:0040CF9B _loc_update     = _LocaleUpdate ptr -10h
.text:0040CF9B plocinfo	       = dword ptr  8
.text:0040CF9B Locale	       = dword ptr  0Ch
.text:0040CF9B dwMapFlags      = dword ptr  10h
.text:0040CF9B lpSrcStr	       = dword ptr  14h
.text:0040CF9B cchSrc	       = dword ptr  18h
.text:0040CF9B lpDestStr       = dword ptr  1Ch
.text:0040CF9B cchDest	       = dword ptr  20h
.text:0040CF9B code_page       = dword ptr  24h
.text:0040CF9B bError	       = dword ptr  28h
.text:0040CF9B
.text:0040CF9B		       push    ebp
.text:0040CF9C		       mov     ebp, esp
.text:0040CF9E		       sub     esp, 10h
.text:0040CFA1		       push    [ebp+plocinfo]  ; plocinfo
.text:0040CFA4		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040CFA7		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040CFAC		       push    [ebp+bError]    ; bError
.text:0040CFAF		       lea     ecx, [ebp+_loc_update] ;	plocinfo
.text:0040CFB2		       push    [ebp+code_page] ; code_page
.text:0040CFB5		       push    [ebp+cchDest]   ; cchDest
.text:0040CFB8		       push    [ebp+lpDestStr] ; lpDestStr
.text:0040CFBB		       push    [ebp+cchSrc]    ; cchSrc
.text:0040CFBE		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040CFC1		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040CFC4		       push    [ebp+Locale]    ; Locale
.text:0040CFC7		       call    __crtLCMapStringA_stat
.text:0040CFCC		       add     esp, 20h
.text:0040CFCF		       cmp     [ebp+_loc_update.updated], 0
.text:0040CFD3		       jz      short locret_40CFDC
.text:0040CFD5		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040CFD8		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040CFDC
.text:0040CFDC locret_40CFDC:			       ; CODE XREF: ___crtLCMapStringA+38j
.text:0040CFDC		       leave
.text:0040CFDD		       retn
.text:0040CFDD ___crtLCMapStringA endp
.text:0040CFDD
.text:0040CFDE
.text:0040CFDE ; =============== S U B R O U T I N E =======================================
.text:0040CFDE
.text:0040CFDE ; Attributes: bp-based frame
.text:0040CFDE
.text:0040CFDE ; int __usercall	_crtGetStringTypeA_stat<eax>(localeinfo_struct *plocinfo<ecx>, unsigned	int dwInfoType,	const char *lpSrcStr, int cchSrc, unsigned __int16 *lpCharType,	int code_page, int lcid, int bError)
.text:0040CFDE __crtGetStringTypeA_stat	proc near      ; CODE XREF: ___crtGetStringTypeA+29p
.text:0040CFDE
.text:0040CFDE retval2	       = dword ptr -8
.text:0040CFDE var_4	       = dword ptr -4
.text:0040CFDE dwInfoType      = dword ptr  8
.text:0040CFDE lpSrcStr	       = dword ptr  0Ch
.text:0040CFDE cchSrc	       = dword ptr  10h
.text:0040CFDE lpCharType      = dword ptr  14h
.text:0040CFDE code_page       = dword ptr  18h
.text:0040CFDE lcid	       = dword ptr  1Ch
.text:0040CFDE bError	       = dword ptr  20h
.text:0040CFDE
.text:0040CFDE plocinfo	= ecx
.text:0040CFDE		       push    ebp
.text:0040CFDF		       mov     ebp, esp
.text:0040CFE1		       push    plocinfo
.text:0040CFE2		       push    plocinfo
.text:0040CFE3		       mov     eax, ___security_cookie
.text:0040CFE8		       xor     eax, ebp
.text:0040CFEA		       mov     [ebp+var_4], eax
.text:0040CFED		       mov     eax, f_use_3
.text:0040CFF2		       push    ebx
.text:0040CFF3		       push    esi
.text:0040CFF4		       xor     ebx, ebx
.text:0040CFF6		       cmp     eax, ebx
.text:0040CFF8		       push    edi
.text:0040CFF9		       mov     edi, plocinfo
.text:0040CFFB		       jnz     short loc_40D037
.text:0040CFFD		       lea     eax, [ebp+retval2]
.text:0040D000		       push    eax	       ; lpCharType
.text:0040D001		       xor     esi, esi
.text:0040D003		       inc     esi
.text:0040D004		       push    esi	       ; cchSrc
.text:0040D005		       push    offset SrcStr   ; lpSrcStr
.text:0040D00A		       push    esi	       ; dwInfoType
.text:0040D00B		       call    ds:__imp__GetStringTypeW@16 ; GetStringTypeW(x,x,x,x)
.text:0040D011		       test    eax, eax
.text:0040D013		       jz      short loc_40D01D
.text:0040D015		       mov     f_use_3,	esi
.text:0040D01B		       jmp     short loc_40D051
.text:0040D01D ; ---------------------------------------------------------------------------
.text:0040D01D
.text:0040D01D loc_40D01D:			       ; CODE XREF: __crtGetStringTypeA_stat+35j
.text:0040D01D		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040D023		       cmp     eax, 78h
.text:0040D026		       jnz     short loc_40D032
.text:0040D028		       push    2
.text:0040D02A		       pop     eax
.text:0040D02B		       mov     f_use_3,	eax
.text:0040D030		       jmp     short loc_40D037
.text:0040D032 ; ---------------------------------------------------------------------------
.text:0040D032
.text:0040D032 loc_40D032:			       ; CODE XREF: __crtGetStringTypeA_stat+48j
.text:0040D032		       mov     eax, f_use_3
.text:0040D037
.text:0040D037 loc_40D037:			       ; CODE XREF: __crtGetStringTypeA_stat+1Dj
.text:0040D037					       ; __crtGetStringTypeA_stat+52j
.text:0040D037		       cmp     eax, 2
.text:0040D03A		       jz      loc_40D10F
.text:0040D040		       cmp     eax, ebx
.text:0040D042		       jz      loc_40D10F
.text:0040D048		       cmp     eax, 1
.text:0040D04B		       jnz     loc_40D139
.text:0040D051
.text:0040D051 loc_40D051:			       ; CODE XREF: __crtGetStringTypeA_stat+3Dj
.text:0040D051		       cmp     [ebp+code_page],	ebx
.text:0040D054		       mov     [ebp+retval2], ebx
.text:0040D057		       jnz     short loc_40D061
.text:0040D059		       mov     eax, [edi]
.text:0040D05B		       mov     eax, [eax+4]
.text:0040D05E		       mov     [ebp+code_page],	eax
.text:0040D061
.text:0040D061 loc_40D061:			       ; CODE XREF: __crtGetStringTypeA_stat+79j
.text:0040D061		       mov     esi, ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D067		       xor     eax, eax
.text:0040D069		       cmp     [ebp+bError], ebx
.text:0040D06C		       push    ebx	       ; cchWideChar
.text:0040D06D		       push    ebx	       ; lpWideCharStr
.text:0040D06E		       push    [ebp+cchSrc]    ; cbMultiByte
.text:0040D071		       setnz   al
.text:0040D074		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0040D077		       lea     eax, ds:1[eax*8]
.text:0040D07E		       push    eax	       ; dwFlags
.text:0040D07F		       push    [ebp+code_page] ; CodePage
.text:0040D082		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D084		       mov     edi, eax
.text:0040D086		       cmp     edi, ebx
.text:0040D088		       jz      loc_40D139
.text:0040D08E		       jle     short loc_40D0CC
.text:0040D090		       cmp     edi, 7FFFFFF0h
.text:0040D096		       ja      short loc_40D0CC
.text:0040D098		       lea     eax, [edi+edi+8]
.text:0040D09C		       cmp     eax, 400h
.text:0040D0A1		       ja      short loc_40D0B6
.text:0040D0A3		       call    __alloca_probe_16
.text:0040D0A8		       mov     eax, esp
.text:0040D0AA		       cmp     eax, ebx
.text:0040D0AC		       jz      short loc_40D0CA
.text:0040D0AE		       mov     dword ptr [eax],	0CCCCh
.text:0040D0B4		       jmp     short loc_40D0C7
.text:0040D0B6 ; ---------------------------------------------------------------------------
.text:0040D0B6
.text:0040D0B6 loc_40D0B6:			       ; CODE XREF: __crtGetStringTypeA_stat+C3j
.text:0040D0B6		       push    eax	       ; size
.text:0040D0B7		       call    _malloc
.text:0040D0BC		       cmp     eax, ebx
.text:0040D0BE		       pop     plocinfo
.text:0040D0BF		       jz      short loc_40D0CA
.text:0040D0C1		       mov     dword ptr [eax],	0DDDDh
.text:0040D0C7
.text:0040D0C7 loc_40D0C7:			       ; CODE XREF: __crtGetStringTypeA_stat+D6j
.text:0040D0C7		       add     eax, 8
.text:0040D0CA
.text:0040D0CA loc_40D0CA:			       ; CODE XREF: __crtGetStringTypeA_stat+CEj
.text:0040D0CA					       ; __crtGetStringTypeA_stat+E1j
.text:0040D0CA		       mov     ebx, eax
.text:0040D0CC
.text:0040D0CC loc_40D0CC:			       ; CODE XREF: __crtGetStringTypeA_stat+B0j
.text:0040D0CC					       ; __crtGetStringTypeA_stat+B8j
.text:0040D0CC		       test    ebx, ebx
.text:0040D0CE		       jz      short loc_40D139
.text:0040D0D0		       lea     eax, [edi+edi]
.text:0040D0D3		       push    eax	       ; count
.text:0040D0D4		       push    0	       ; value
.text:0040D0D6		       push    ebx	       ; dst
.text:0040D0D7		       call    _memset
.text:0040D0DC		       add     esp, 0Ch
.text:0040D0DF		       push    edi	       ; cchWideChar
.text:0040D0E0		       push    ebx	       ; lpWideCharStr
.text:0040D0E1		       push    [ebp+cchSrc]    ; cbMultiByte
.text:0040D0E4		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0040D0E7		       push    1	       ; dwFlags
.text:0040D0E9		       push    [ebp+code_page] ; CodePage
.text:0040D0EC		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D0EE		       test    eax, eax
.text:0040D0F0		       jz      short loc_40D103
.text:0040D0F2		       push    [ebp+lpCharType]	; lpCharType
.text:0040D0F5		       push    eax	       ; cchSrc
.text:0040D0F6		       push    ebx	       ; lpSrcStr
.text:0040D0F7		       push    [ebp+dwInfoType]	; dwInfoType
.text:0040D0FA		       call    ds:__imp__GetStringTypeW@16 ; GetStringTypeW(x,x,x,x)
.text:0040D100		       mov     [ebp+retval2], eax
.text:0040D103
.text:0040D103 loc_40D103:			       ; CODE XREF: __crtGetStringTypeA_stat+112j
.text:0040D103		       push    ebx	       ; _Memory
.text:0040D104		       call    __freea
.text:0040D109		       mov     eax, [ebp+retval2]
.text:0040D10C		       pop     plocinfo
.text:0040D10D		       jmp     short loc_40D184
.text:0040D10F ; ---------------------------------------------------------------------------
.text:0040D10F
.text:0040D10F loc_40D10F:			       ; CODE XREF: __crtGetStringTypeA_stat+5Cj
.text:0040D10F					       ; __crtGetStringTypeA_stat+64j
.text:0040D10F		       xor     esi, esi
.text:0040D111		       cmp     [ebp+lcid], ebx
.text:0040D114		       jnz     short loc_40D11E
.text:0040D116		       mov     eax, [edi]
.text:0040D118		       mov     eax, [eax+14h]
.text:0040D11B		       mov     [ebp+lcid], eax
.text:0040D11E
.text:0040D11E loc_40D11E:			       ; CODE XREF: __crtGetStringTypeA_stat+136j
.text:0040D11E		       cmp     [ebp+code_page],	ebx
.text:0040D121		       jnz     short loc_40D12B
.text:0040D123		       mov     eax, [edi]
.text:0040D125		       mov     eax, [eax+4]
.text:0040D128		       mov     [ebp+code_page],	eax
.text:0040D12B
.text:0040D12B loc_40D12B:			       ; CODE XREF: __crtGetStringTypeA_stat+143j
.text:0040D12B		       push    [ebp+lcid]      ; lcid
.text:0040D12E		       call    ___ansicp
.text:0040D133		       cmp     eax, 0FFFFFFFFh
.text:0040D136		       pop     plocinfo
.text:0040D137		       jnz     short loc_40D13D
.text:0040D139
.text:0040D139 loc_40D139:			       ; CODE XREF: __crtGetStringTypeA_stat+6Dj
.text:0040D139					       ; __crtGetStringTypeA_stat+AAj ...
.text:0040D139		       xor     eax, eax
.text:0040D13B		       jmp     short loc_40D184
.text:0040D13D ; ---------------------------------------------------------------------------
.text:0040D13D
.text:0040D13D loc_40D13D:			       ; CODE XREF: __crtGetStringTypeA_stat+159j
.text:0040D13D		       cmp     eax, [ebp+code_page]
.text:0040D140		       jz      short loc_40D160
.text:0040D142		       push    ebx	       ; cchDest
.text:0040D143		       push    ebx	       ; lpDestStr
.text:0040D144		       lea     plocinfo, [ebp+cchSrc]
.text:0040D147		       push    plocinfo	       ; pcchSrc
.text:0040D148		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D14B		       push    eax	       ; toCP
.text:0040D14C		       push    [ebp+code_page] ; fromCP
.text:0040D14F		       call    ___convertcp
.text:0040D154		       mov     esi, eax
.text:0040D156		       add     esp, 18h
.text:0040D159		       cmp     esi, ebx
.text:0040D15B		       jz      short loc_40D139
.text:0040D15D		       mov     [ebp+lpSrcStr], esi
.text:0040D160
.text:0040D160 loc_40D160:			       ; CODE XREF: __crtGetStringTypeA_stat+162j
.text:0040D160		       push    [ebp+lpCharType]	; lpCharType
.text:0040D163		       push    [ebp+cchSrc]    ; cchSrc
.text:0040D166		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D169		       push    [ebp+dwInfoType]	; dwInfoType
.text:0040D16C		       push    [ebp+lcid]      ; Locale
.text:0040D16F		       call    ds:__imp__GetStringTypeA@20 ; GetStringTypeA(x,x,x,x,x)
.text:0040D175		       cmp     esi, ebx
.text:0040D177		       mov     edi, eax
.text:0040D179		       jz      short loc_40D182
.text:0040D17B		       push    esi	       ; pBlock
.text:0040D17C		       call    _free
.text:0040D181		       pop     plocinfo
.text:0040D182
.text:0040D182 loc_40D182:			       ; CODE XREF: __crtGetStringTypeA_stat+19Bj
.text:0040D182		       mov     eax, edi
.text:0040D184
.text:0040D184 loc_40D184:			       ; CODE XREF: __crtGetStringTypeA_stat+12Fj
.text:0040D184					       ; __crtGetStringTypeA_stat+15Dj
.text:0040D184		       lea     esp, [ebp-14h]
.text:0040D187		       pop     edi
.text:0040D188		       pop     esi
.text:0040D189		       pop     ebx
.text:0040D18A		       mov     plocinfo, [ebp+var_4]
.text:0040D18D		       xor     plocinfo, ebp   ; cookie
.text:0040D18F		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040D194		       leave
.text:0040D195		       retn
.text:0040D195 __crtGetStringTypeA_stat	endp
.text:0040D195
.text:0040D196
.text:0040D196 ; =============== S U B R O U T I N E =======================================
.text:0040D196
.text:0040D196 ; Attributes: bp-based frame
.text:0040D196
.text:0040D196 ; int __cdecl __crtGetStringTypeA(localeinfo_struct *plocinfo, unsigned int dwInfoType, const char *lpSrcStr, int cchSrc, unsigned __int16 *lpCharType, int code_page, int lcid,	int bError)
.text:0040D196 ___crtGetStringTypeA proc near	       ; CODE XREF: setSBUpLow+96p
.text:0040D196					       ; _setlocale_set_cat+1EBp ...
.text:0040D196
.text:0040D196 _loc_update     = _LocaleUpdate ptr -10h
.text:0040D196 plocinfo	       = dword ptr  8
.text:0040D196 dwInfoType      = dword ptr  0Ch
.text:0040D196 lpSrcStr	       = dword ptr  10h
.text:0040D196 cchSrc	       = dword ptr  14h
.text:0040D196 lpCharType      = dword ptr  18h
.text:0040D196 code_page       = dword ptr  1Ch
.text:0040D196 lcid	       = dword ptr  20h
.text:0040D196 bError	       = dword ptr  24h
.text:0040D196
.text:0040D196		       push    ebp
.text:0040D197		       mov     ebp, esp
.text:0040D199		       sub     esp, 10h
.text:0040D19C		       push    [ebp+plocinfo]  ; plocinfo
.text:0040D19F		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040D1A2		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040D1A7		       push    [ebp+bError]    ; bError
.text:0040D1AA		       lea     ecx, [ebp+_loc_update] ;	plocinfo
.text:0040D1AD		       push    [ebp+lcid]      ; lcid
.text:0040D1B0		       push    [ebp+code_page] ; code_page
.text:0040D1B3		       push    [ebp+lpCharType]	; lpCharType
.text:0040D1B6		       push    [ebp+cchSrc]    ; cchSrc
.text:0040D1B9		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D1BC		       push    [ebp+dwInfoType]	; dwInfoType
.text:0040D1BF		       call    __crtGetStringTypeA_stat
.text:0040D1C4		       add     esp, 1Ch
.text:0040D1C7		       cmp     [ebp+_loc_update.updated], 0
.text:0040D1CB		       jz      short locret_40D1D4
.text:0040D1CD		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040D1D0		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040D1D4
.text:0040D1D4 locret_40D1D4:			       ; CODE XREF: ___crtGetStringTypeA+35j
.text:0040D1D4		       leave
.text:0040D1D5		       retn
.text:0040D1D5 ___crtGetStringTypeA endp
.text:0040D1D5
.text:0040D1D6
.text:0040D1D6 ; =============== S U B R O U T I N E =======================================
.text:0040D1D6
.text:0040D1D6
.text:0040D1D6 ; const unsigned	__int16	*__cdecl __pwctype_func()
.text:0040D1D6 ___pwctype_func proc near
.text:0040D1D6		       mov     eax, __pwctype
.text:0040D1DB		       retn
.text:0040D1DB ___pwctype_func endp
.text:0040D1DB
.text:0040D1DC
.text:0040D1DC ; =============== S U B R O U T I N E =======================================
.text:0040D1DC
.text:0040D1DC
.text:0040D1DC ; const unsigned	__int16	*__cdecl __pctype_func()
.text:0040D1DC ___pctype_func  proc near
.text:0040D1DC		       call    __getptd
.text:0040D1E1		       mov     ecx, eax
.text:0040D1E3		       mov     eax, [ecx+6Ch]
.text:0040D1E6		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040D1EC		       jz      short loc_40D1FE
.text:0040D1EE		       mov     edx, ___globallocalestatus
.text:0040D1F4		       test    [ecx+70h], edx
.text:0040D1F7		       jnz     short loc_40D1FE
.text:0040D1F9		       call    ___updatetlocinfo
.text:0040D1FE
.text:0040D1FE loc_40D1FE:			       ; CODE XREF: ___pctype_func+10j
.text:0040D1FE					       ; ___pctype_func+1Bj
.text:0040D1FE		       mov     eax, [eax+0C8h]
.text:0040D204		       retn
.text:0040D204 ___pctype_func  endp
.text:0040D204
.text:0040D205
.text:0040D205 ; =============== S U B R O U T I N E =======================================
.text:0040D205
.text:0040D205 ; Attributes: bp-based frame
.text:0040D205
.text:0040D205 ; int __usercall	get_lc_time<eax>(__lc_time_data	*lc_time<esi>, threadlocaleinfostruct *ploci<eax>)
.text:0040D205 _get_lc_time    proc near	       ; CODE XREF: ___init_time+2Fp
.text:0040D205
.text:0040D205 locinfo	       = localeinfo_struct ptr -10h
.text:0040D205 ctryid	       = dword ptr -8
.text:0040D205 langid	       = dword ptr -4
.text:0040D205
.text:0040D205 lc_time = esi
.text:0040D205 ploci = eax
.text:0040D205		       push    ebp
.text:0040D206		       mov     ebp, esp
.text:0040D208		       sub     esp, 10h
.text:0040D20B		       test    lc_time,	lc_time
.text:0040D20D		       movzx   ecx, word ptr [ploci+42h]
.text:0040D211		       movzx   edx, word ptr [ploci+44h]
.text:0040D215		       mov     [ebp+langid], ecx
.text:0040D218		       mov     [ebp+ctryid], edx
.text:0040D21B		       jnz     short loc_40D222
.text:0040D21D		       or      ploci, 0FFFFFFFFh
.text:0040D220		       leave
.text:0040D221		       retn
.text:0040D222 ; ---------------------------------------------------------------------------
.text:0040D222
.text:0040D222 loc_40D222:			       ; CODE XREF: _get_lc_time+16j
.text:0040D222		       and     [ebp+locinfo.mbcinfo], 0
.text:0040D226		       push    ebx
.text:0040D227		       push    edi
.text:0040D228		       mov     [ebp+locinfo.locinfo], ploci
.text:0040D22B		       lea     ploci, [lc_time+4]
.text:0040D22E		       push    ploci	       ; address
.text:0040D22F		       push    31h	       ; fieldtype
.text:0040D231		       push    ecx	       ; localehandle
.text:0040D232		       xor     ebx, ebx
.text:0040D234		       inc     ebx
.text:0040D235		       lea     ploci, [ebp+locinfo]
.text:0040D238		       push    ebx	       ; lc_type
.text:0040D239		       push    ploci	       ; plocinfo
.text:0040D23A		       call    ___getlocaleinfo
.text:0040D23F		       mov     edi, ploci
.text:0040D241		       lea     ploci, [lc_time+8]
.text:0040D244		       push    ploci	       ; address
.text:0040D245		       push    32h	       ; fieldtype
.text:0040D247		       push    [ebp+langid]    ; localehandle
.text:0040D24A		       lea     ploci, [ebp+locinfo]
.text:0040D24D		       push    ebx	       ; lc_type
.text:0040D24E		       push    ploci	       ; plocinfo
.text:0040D24F		       call    ___getlocaleinfo
.text:0040D254		       or      edi, ploci
.text:0040D256		       lea     ploci, [lc_time+0Ch]
.text:0040D259		       push    ploci	       ; address
.text:0040D25A		       push    33h	       ; fieldtype
.text:0040D25C		       push    [ebp+langid]    ; localehandle
.text:0040D25F		       lea     ploci, [ebp+locinfo]
.text:0040D262		       push    ebx	       ; lc_type
.text:0040D263		       push    ploci	       ; plocinfo
.text:0040D264		       call    ___getlocaleinfo
.text:0040D269		       or      edi, ploci
.text:0040D26B		       lea     ploci, [lc_time+10h]
.text:0040D26E		       push    ploci	       ; address
.text:0040D26F		       push    34h	       ; fieldtype
.text:0040D271		       push    [ebp+langid]    ; localehandle
.text:0040D274		       lea     ploci, [ebp+locinfo]
.text:0040D277		       push    ebx	       ; lc_type
.text:0040D278		       push    ploci	       ; plocinfo
.text:0040D279		       call    ___getlocaleinfo
.text:0040D27E		       add     esp, 50h
.text:0040D281		       or      edi, ploci
.text:0040D283		       lea     ploci, [lc_time+14h]
.text:0040D286		       push    ploci	       ; address
.text:0040D287		       push    35h	       ; fieldtype
.text:0040D289		       push    [ebp+langid]    ; localehandle
.text:0040D28C		       lea     ploci, [ebp+locinfo]
.text:0040D28F		       push    ebx	       ; lc_type
.text:0040D290		       push    ploci	       ; plocinfo
.text:0040D291		       call    ___getlocaleinfo
.text:0040D296		       or      edi, ploci
.text:0040D298		       lea     ploci, [lc_time+18h]
.text:0040D29B		       push    ploci	       ; address
.text:0040D29C		       push    36h	       ; fieldtype
.text:0040D29E		       push    [ebp+langid]    ; localehandle
.text:0040D2A1		       lea     ploci, [ebp+locinfo]
.text:0040D2A4		       push    ebx	       ; lc_type
.text:0040D2A5		       push    ploci	       ; plocinfo
.text:0040D2A6		       call    ___getlocaleinfo
.text:0040D2AB		       push    lc_time	       ; address
.text:0040D2AC		       push    37h	       ; fieldtype
.text:0040D2AE		       push    [ebp+langid]    ; localehandle
.text:0040D2B1		       or      edi, ploci
.text:0040D2B3		       lea     ploci, [ebp+locinfo]
.text:0040D2B6		       push    ebx	       ; lc_type
.text:0040D2B7		       push    ploci	       ; plocinfo
.text:0040D2B8		       call    ___getlocaleinfo
.text:0040D2BD		       or      edi, ploci
.text:0040D2BF		       lea     ploci, [lc_time+20h]
.text:0040D2C2		       push    ploci	       ; address
.text:0040D2C3		       push    2Ah	       ; fieldtype
.text:0040D2C5		       push    [ebp+langid]    ; localehandle
.text:0040D2C8		       lea     ploci, [ebp+locinfo]
.text:0040D2CB		       push    ebx	       ; lc_type
.text:0040D2CC		       push    ploci	       ; plocinfo
.text:0040D2CD		       call    ___getlocaleinfo
.text:0040D2D2		       add     esp, 50h
.text:0040D2D5		       or      edi, ploci
.text:0040D2D7		       lea     ploci, [lc_time+24h]
.text:0040D2DA		       push    ploci	       ; address
.text:0040D2DB		       push    2Bh	       ; fieldtype
.text:0040D2DD		       push    [ebp+langid]    ; localehandle
.text:0040D2E0		       lea     ploci, [ebp+locinfo]
.text:0040D2E3		       push    ebx	       ; lc_type
.text:0040D2E4		       push    ploci	       ; plocinfo
.text:0040D2E5		       call    ___getlocaleinfo
.text:0040D2EA		       or      edi, ploci
.text:0040D2EC		       lea     ploci, [lc_time+28h]
.text:0040D2EF		       push    ploci	       ; address
.text:0040D2F0		       push    2Ch	       ; fieldtype
.text:0040D2F2		       push    [ebp+langid]    ; localehandle
.text:0040D2F5		       lea     ploci, [ebp+locinfo]
.text:0040D2F8		       push    ebx	       ; lc_type
.text:0040D2F9		       push    ploci	       ; plocinfo
.text:0040D2FA		       call    ___getlocaleinfo
.text:0040D2FF		       or      edi, ploci
.text:0040D301		       lea     ploci, [lc_time+2Ch]
.text:0040D304		       push    ploci	       ; address
.text:0040D305		       push    2Dh	       ; fieldtype
.text:0040D307		       push    [ebp+langid]    ; localehandle
.text:0040D30A		       lea     ploci, [ebp+locinfo]
.text:0040D30D		       push    ebx	       ; lc_type
.text:0040D30E		       push    ploci	       ; plocinfo
.text:0040D30F		       call    ___getlocaleinfo
.text:0040D314		       or      edi, ploci
.text:0040D316		       lea     ploci, [lc_time+30h]
.text:0040D319		       push    ploci	       ; address
.text:0040D31A		       push    2Eh	       ; fieldtype
.text:0040D31C		       push    [ebp+langid]    ; localehandle
.text:0040D31F		       lea     ploci, [ebp+locinfo]
.text:0040D322		       push    ebx	       ; lc_type
.text:0040D323		       push    ploci	       ; plocinfo
.text:0040D324		       call    ___getlocaleinfo
.text:0040D329		       add     esp, 50h
.text:0040D32C		       or      edi, ploci
.text:0040D32E		       lea     ploci, [lc_time+34h]
.text:0040D331		       push    ploci	       ; address
.text:0040D332		       push    2Fh	       ; fieldtype
.text:0040D334		       push    [ebp+langid]    ; localehandle
.text:0040D337		       lea     ploci, [ebp+locinfo]
.text:0040D33A		       push    ebx	       ; lc_type
.text:0040D33B		       push    ploci	       ; plocinfo
.text:0040D33C		       call    ___getlocaleinfo
.text:0040D341		       or      edi, ploci
.text:0040D343		       lea     ploci, [lc_time+1Ch]
.text:0040D346		       push    ploci	       ; address
.text:0040D347		       push    30h	       ; fieldtype
.text:0040D349		       push    [ebp+langid]    ; localehandle
.text:0040D34C		       lea     ploci, [ebp+locinfo]
.text:0040D34F		       push    ebx	       ; lc_type
.text:0040D350		       push    ploci	       ; plocinfo
.text:0040D351		       call    ___getlocaleinfo
.text:0040D356		       or      edi, ploci
.text:0040D358		       lea     ploci, [lc_time+38h]
.text:0040D35B		       push    ploci	       ; address
.text:0040D35C		       push    44h	       ; fieldtype
.text:0040D35E		       push    [ebp+langid]    ; localehandle
.text:0040D361		       lea     ploci, [ebp+locinfo]
.text:0040D364		       push    ebx	       ; lc_type
.text:0040D365		       push    ploci	       ; plocinfo
.text:0040D366		       call    ___getlocaleinfo
.text:0040D36B		       or      edi, ploci
.text:0040D36D		       lea     ploci, [lc_time+3Ch]
.text:0040D370		       push    ploci	       ; address
.text:0040D371		       push    45h	       ; fieldtype
.text:0040D373		       push    [ebp+langid]    ; localehandle
.text:0040D376		       lea     ploci, [ebp+locinfo]
.text:0040D379		       push    ebx	       ; lc_type
.text:0040D37A		       push    ploci	       ; plocinfo
.text:0040D37B		       call    ___getlocaleinfo
.text:0040D380		       add     esp, 50h
.text:0040D383		       or      edi, ploci
.text:0040D385		       lea     ploci, [lc_time+40h]
.text:0040D388		       push    ploci	       ; address
.text:0040D389		       push    46h	       ; fieldtype
.text:0040D38B		       push    [ebp+langid]    ; localehandle
.text:0040D38E		       lea     ploci, [ebp+locinfo]
.text:0040D391		       push    ebx	       ; lc_type
.text:0040D392		       push    ploci	       ; plocinfo
.text:0040D393		       call    ___getlocaleinfo
.text:0040D398		       or      edi, ploci
.text:0040D39A		       lea     ploci, [lc_time+44h]
.text:0040D39D		       push    ploci	       ; address
.text:0040D39E		       push    47h	       ; fieldtype
.text:0040D3A0		       push    [ebp+langid]    ; localehandle
.text:0040D3A3		       lea     ploci, [ebp+locinfo]
.text:0040D3A6		       push    ebx	       ; lc_type
.text:0040D3A7		       push    ploci	       ; plocinfo
.text:0040D3A8		       call    ___getlocaleinfo
.text:0040D3AD		       or      edi, ploci
.text:0040D3AF		       lea     ploci, [lc_time+48h]
.text:0040D3B2		       push    ploci	       ; address
.text:0040D3B3		       push    48h	       ; fieldtype
.text:0040D3B5		       push    [ebp+langid]    ; localehandle
.text:0040D3B8		       lea     ploci, [ebp+locinfo]
.text:0040D3BB		       push    ebx	       ; lc_type
.text:0040D3BC		       push    ploci	       ; plocinfo
.text:0040D3BD		       call    ___getlocaleinfo
.text:0040D3C2		       or      edi, ploci
.text:0040D3C4		       lea     ploci, [lc_time+4Ch]
.text:0040D3C7		       push    ploci	       ; address
.text:0040D3C8		       push    49h	       ; fieldtype
.text:0040D3CA		       push    [ebp+langid]    ; localehandle
.text:0040D3CD		       lea     ploci, [ebp+locinfo]
.text:0040D3D0		       push    ebx	       ; lc_type
.text:0040D3D1		       push    ploci	       ; plocinfo
.text:0040D3D2		       call    ___getlocaleinfo
.text:0040D3D7		       add     esp, 50h
.text:0040D3DA		       or      edi, ploci
.text:0040D3DC		       lea     ploci, [lc_time+50h]
.text:0040D3DF		       push    ploci	       ; address
.text:0040D3E0		       push    4Ah	       ; fieldtype
.text:0040D3E2		       push    [ebp+langid]    ; localehandle
.text:0040D3E5		       lea     ploci, [ebp+locinfo]
.text:0040D3E8		       push    ebx	       ; lc_type
.text:0040D3E9		       push    ploci	       ; plocinfo
.text:0040D3EA		       call    ___getlocaleinfo
.text:0040D3EF		       or      edi, ploci
.text:0040D3F1		       lea     ploci, [lc_time+54h]
.text:0040D3F4		       push    ploci	       ; address
.text:0040D3F5		       push    4Bh	       ; fieldtype
.text:0040D3F7		       push    [ebp+langid]    ; localehandle
.text:0040D3FA		       lea     ploci, [ebp+locinfo]
.text:0040D3FD		       push    ebx	       ; lc_type
.text:0040D3FE		       push    ploci	       ; plocinfo
.text:0040D3FF		       call    ___getlocaleinfo
.text:0040D404		       or      edi, ploci
.text:0040D406		       lea     ploci, [lc_time+58h]
.text:0040D409		       push    ploci	       ; address
.text:0040D40A		       push    4Ch	       ; fieldtype
.text:0040D40C		       push    [ebp+langid]    ; localehandle
.text:0040D40F		       lea     ploci, [ebp+locinfo]
.text:0040D412		       push    ebx	       ; lc_type
.text:0040D413		       push    ploci	       ; plocinfo
.text:0040D414		       call    ___getlocaleinfo
.text:0040D419		       or      edi, ploci
.text:0040D41B		       lea     ploci, [lc_time+5Ch]
.text:0040D41E		       push    ploci	       ; address
.text:0040D41F		       push    4Dh	       ; fieldtype
.text:0040D421		       push    [ebp+langid]    ; localehandle
.text:0040D424		       lea     ploci, [ebp+locinfo]
.text:0040D427		       push    ebx	       ; lc_type
.text:0040D428		       push    ploci	       ; plocinfo
.text:0040D429		       call    ___getlocaleinfo
.text:0040D42E		       add     esp, 50h
.text:0040D431		       or      edi, ploci
.text:0040D433		       lea     ploci, [lc_time+60h]
.text:0040D436		       push    ploci	       ; address
.text:0040D437		       push    4Eh	       ; fieldtype
.text:0040D439		       push    [ebp+langid]    ; localehandle
.text:0040D43C		       lea     ploci, [ebp+locinfo]
.text:0040D43F		       push    ebx	       ; lc_type
.text:0040D440		       push    ploci	       ; plocinfo
.text:0040D441		       call    ___getlocaleinfo
.text:0040D446		       or      edi, ploci
.text:0040D448		       lea     ploci, [lc_time+64h]
.text:0040D44B		       push    ploci	       ; address
.text:0040D44C		       push    4Fh	       ; fieldtype
.text:0040D44E		       push    [ebp+langid]    ; localehandle
.text:0040D451		       lea     ploci, [ebp+locinfo]
.text:0040D454		       push    ebx	       ; lc_type
.text:0040D455		       push    ploci	       ; plocinfo
.text:0040D456		       call    ___getlocaleinfo
.text:0040D45B		       or      edi, ploci
.text:0040D45D		       lea     ploci, [lc_time+68h]
.text:0040D460		       push    ploci	       ; address
.text:0040D461		       push    38h	       ; fieldtype
.text:0040D463		       push    [ebp+langid]    ; localehandle
.text:0040D466		       lea     ploci, [ebp+locinfo]
.text:0040D469		       push    ebx	       ; lc_type
.text:0040D46A		       push    ploci	       ; plocinfo
.text:0040D46B		       call    ___getlocaleinfo
.text:0040D470		       or      edi, ploci
.text:0040D472		       lea     ploci, [lc_time+6Ch]
.text:0040D475		       push    ploci	       ; address
.text:0040D476		       push    39h	       ; fieldtype
.text:0040D478		       push    [ebp+langid]    ; localehandle
.text:0040D47B		       lea     ploci, [ebp+locinfo]
.text:0040D47E		       push    ebx	       ; lc_type
.text:0040D47F		       push    ploci	       ; plocinfo
.text:0040D480		       call    ___getlocaleinfo
.text:0040D485		       add     esp, 50h
.text:0040D488		       or      edi, ploci
.text:0040D48A		       lea     ploci, [lc_time+70h]
.text:0040D48D		       push    ploci	       ; address
.text:0040D48E		       push    3Ah	       ; fieldtype
.text:0040D490		       push    [ebp+langid]    ; localehandle
.text:0040D493		       lea     ploci, [ebp+locinfo]
.text:0040D496		       push    ebx	       ; lc_type
.text:0040D497		       push    ploci	       ; plocinfo
.text:0040D498		       call    ___getlocaleinfo
.text:0040D49D		       or      edi, ploci
.text:0040D49F		       lea     ploci, [lc_time+74h]
.text:0040D4A2		       push    ploci	       ; address
.text:0040D4A3		       push    3Bh	       ; fieldtype
.text:0040D4A5		       push    [ebp+langid]    ; localehandle
.text:0040D4A8		       lea     ploci, [ebp+locinfo]
.text:0040D4AB		       push    ebx	       ; lc_type
.text:0040D4AC		       push    ploci	       ; plocinfo
.text:0040D4AD		       call    ___getlocaleinfo
.text:0040D4B2		       or      edi, ploci
.text:0040D4B4		       lea     ploci, [lc_time+78h]
.text:0040D4B7		       push    ploci	       ; address
.text:0040D4B8		       push    3Ch	       ; fieldtype
.text:0040D4BA		       push    [ebp+langid]    ; localehandle
.text:0040D4BD		       lea     ploci, [ebp+locinfo]
.text:0040D4C0		       push    ebx	       ; lc_type
.text:0040D4C1		       push    ploci	       ; plocinfo
.text:0040D4C2		       call    ___getlocaleinfo
.text:0040D4C7		       or      edi, ploci
.text:0040D4C9		       lea     ploci, [lc_time+7Ch]
.text:0040D4CC		       push    ploci	       ; address
.text:0040D4CD		       push    3Dh	       ; fieldtype
.text:0040D4CF		       push    [ebp+langid]    ; localehandle
.text:0040D4D2		       lea     ploci, [ebp+locinfo]
.text:0040D4D5		       push    ebx	       ; lc_type
.text:0040D4D6		       push    ploci	       ; plocinfo
.text:0040D4D7		       call    ___getlocaleinfo
.text:0040D4DC		       add     esp, 50h
.text:0040D4DF		       or      edi, ploci
.text:0040D4E1		       lea     ploci, [lc_time+80h]
.text:0040D4E7		       push    ploci	       ; address
.text:0040D4E8		       push    3Eh	       ; fieldtype
.text:0040D4EA		       push    [ebp+langid]    ; localehandle
.text:0040D4ED		       lea     ploci, [ebp+locinfo]
.text:0040D4F0		       push    ebx	       ; lc_type
.text:0040D4F1		       push    ploci	       ; plocinfo
.text:0040D4F2		       call    ___getlocaleinfo
.text:0040D4F7		       or      edi, ploci
.text:0040D4F9		       lea     ploci, [lc_time+84h]
.text:0040D4FF		       push    ploci	       ; address
.text:0040D500		       push    3Fh	       ; fieldtype
.text:0040D502		       push    [ebp+langid]    ; localehandle
.text:0040D505		       lea     ploci, [ebp+locinfo]
.text:0040D508		       push    ebx	       ; lc_type
.text:0040D509		       push    ploci	       ; plocinfo
.text:0040D50A		       call    ___getlocaleinfo
.text:0040D50F		       or      edi, ploci
.text:0040D511		       lea     ploci, [lc_time+88h]
.text:0040D517		       push    ploci	       ; address
.text:0040D518		       push    40h	       ; fieldtype
.text:0040D51A		       push    [ebp+langid]    ; localehandle
.text:0040D51D		       push    ebx	       ; lc_type
.text:0040D51E		       lea     ploci, [ebp+locinfo]
.text:0040D521		       push    ploci	       ; plocinfo
.text:0040D522		       call    ___getlocaleinfo
.text:0040D527		       or      edi, ploci
.text:0040D529		       lea     ploci, [lc_time+8Ch]
.text:0040D52F		       push    ploci	       ; address
.text:0040D530		       push    41h	       ; fieldtype
.text:0040D532		       push    [ebp+langid]    ; localehandle
.text:0040D535		       lea     ploci, [ebp+locinfo]
.text:0040D538		       push    ebx	       ; lc_type
.text:0040D539		       push    ploci	       ; plocinfo
.text:0040D53A		       call    ___getlocaleinfo
.text:0040D53F		       add     esp, 50h
.text:0040D542		       or      edi, ploci
.text:0040D544		       lea     ploci, [lc_time+90h]
.text:0040D54A		       push    ploci	       ; address
.text:0040D54B		       push    42h	       ; fieldtype
.text:0040D54D		       push    [ebp+langid]    ; localehandle
.text:0040D550		       lea     ploci, [ebp+locinfo]
.text:0040D553		       push    ebx	       ; lc_type
.text:0040D554		       push    ploci	       ; plocinfo
.text:0040D555		       call    ___getlocaleinfo
.text:0040D55A		       or      edi, ploci
.text:0040D55C		       lea     ploci, [lc_time+94h]
.text:0040D562		       push    ploci	       ; address
.text:0040D563		       push    43h	       ; fieldtype
.text:0040D565		       push    [ebp+langid]    ; localehandle
.text:0040D568		       lea     ploci, [ebp+locinfo]
.text:0040D56B		       push    ebx	       ; lc_type
.text:0040D56C		       push    ploci	       ; plocinfo
.text:0040D56D		       call    ___getlocaleinfo
.text:0040D572		       or      edi, ploci
.text:0040D574		       lea     ploci, [lc_time+98h]
.text:0040D57A		       push    ploci	       ; address
.text:0040D57B		       push    28h	       ; fieldtype
.text:0040D57D		       push    [ebp+langid]    ; localehandle
.text:0040D580		       lea     ploci, [ebp+locinfo]
.text:0040D583		       push    ebx	       ; lc_type
.text:0040D584		       push    ploci	       ; plocinfo
.text:0040D585		       call    ___getlocaleinfo
.text:0040D58A		       or      edi, ploci
.text:0040D58C		       lea     ploci, [lc_time+9Ch]
.text:0040D592		       push    ploci	       ; address
.text:0040D593		       push    29h	       ; fieldtype
.text:0040D595		       push    [ebp+langid]    ; localehandle
.text:0040D598		       lea     ploci, [ebp+locinfo]
.text:0040D59B		       push    ebx	       ; lc_type
.text:0040D59C		       push    ploci	       ; plocinfo
.text:0040D59D		       call    ___getlocaleinfo
.text:0040D5A2		       add     esp, 50h
.text:0040D5A5		       or      edi, ploci
.text:0040D5A7		       lea     ploci, [lc_time+0A0h]
.text:0040D5AD		       push    ploci	       ; address
.text:0040D5AE		       push    1Fh	       ; fieldtype
.text:0040D5B0		       push    [ebp+ctryid]    ; localehandle
.text:0040D5B3		       lea     ploci, [ebp+locinfo]
.text:0040D5B6		       push    ebx	       ; lc_type
.text:0040D5B7		       push    ploci	       ; plocinfo
.text:0040D5B8		       call    ___getlocaleinfo
.text:0040D5BD		       or      edi, ploci
.text:0040D5BF		       lea     ploci, [lc_time+0A4h]
.text:0040D5C5		       push    ploci	       ; address
.text:0040D5C6		       push    20h	       ; fieldtype
.text:0040D5C8		       push    [ebp+ctryid]    ; localehandle
.text:0040D5CB		       lea     ploci, [ebp+locinfo]
.text:0040D5CE		       push    ebx	       ; lc_type
.text:0040D5CF		       push    ploci	       ; plocinfo
.text:0040D5D0		       call    ___getlocaleinfo
.text:0040D5D5		       or      edi, ploci
.text:0040D5D7		       lea     ploci, [lc_time+0A8h]
.text:0040D5DD		       push    ploci	       ; address
.text:0040D5DE		       push    1003h	       ; fieldtype
.text:0040D5E3		       push    [ebp+ctryid]    ; localehandle
.text:0040D5E6		       lea     ploci, [ebp+locinfo]
.text:0040D5E9		       push    ebx	       ; lc_type
.text:0040D5EA		       push    ploci	       ; plocinfo
.text:0040D5EB		       call    ___getlocaleinfo
.text:0040D5F0		       or      edi, ploci
.text:0040D5F2		       lea     ploci, [lc_time+0B0h]
.text:0040D5F8		       push    ploci	       ; address
.text:0040D5F9		       push    1009h	       ; fieldtype
.text:0040D5FE		       mov     ebx, [ebp+ctryid]
.text:0040D601		       push    ebx	       ; localehandle
.text:0040D602		       lea     ploci, [ebp+locinfo]
.text:0040D605		       push    0	       ; lc_type
.text:0040D607		       push    ploci	       ; plocinfo
.text:0040D608		       call    ___getlocaleinfo
.text:0040D60D		       add     esp, 50h
.text:0040D610		       or      edi, ploci
.text:0040D612		       mov     ploci, edi
.text:0040D614		       pop     edi
.text:0040D615		       mov     [lc_time+0ACh], ebx
.text:0040D61B		       pop     ebx
.text:0040D61C		       leave
.text:0040D61D		       retn
.text:0040D61D _get_lc_time    endp
.text:0040D61D
.text:0040D61E
.text:0040D61E ; =============== S U B R O U T I N E =======================================
.text:0040D61E
.text:0040D61E
.text:0040D61E ; void __cdecl __free_lc_time(__lc_time_data *lc_time)
.text:0040D61E ___free_lc_time proc near	       ; CODE XREF: ___freetlocinfo+E9p
.text:0040D61E					       ; ___init_time+39p
.text:0040D61E
.text:0040D61E lc_time	       = dword ptr  4
.text:0040D61E
.text:0040D61E		       push    esi
.text:0040D61F		       mov     esi, [esp+4+lc_time]
.text:0040D623		       test    esi, esi
.text:0040D625		       jz      loc_40D7AC
.text:0040D62B		       push    dword ptr [esi+4] ; pBlock
.text:0040D62E		       call    _free
.text:0040D633		       push    dword ptr [esi+8] ; pBlock
.text:0040D636		       call    _free
.text:0040D63B		       push    dword ptr [esi+0Ch] ; pBlock
.text:0040D63E		       call    _free
.text:0040D643		       push    dword ptr [esi+10h] ; pBlock
.text:0040D646		       call    _free
.text:0040D64B		       push    dword ptr [esi+14h] ; pBlock
.text:0040D64E		       call    _free
.text:0040D653		       push    dword ptr [esi+18h] ; pBlock
.text:0040D656		       call    _free
.text:0040D65B		       push    dword ptr [esi] ; pBlock
.text:0040D65D		       call    _free
.text:0040D662		       push    dword ptr [esi+20h] ; pBlock
.text:0040D665		       call    _free
.text:0040D66A		       push    dword ptr [esi+24h] ; pBlock
.text:0040D66D		       call    _free
.text:0040D672		       push    dword ptr [esi+28h] ; pBlock
.text:0040D675		       call    _free
.text:0040D67A		       push    dword ptr [esi+2Ch] ; pBlock
.text:0040D67D		       call    _free
.text:0040D682		       push    dword ptr [esi+30h] ; pBlock
.text:0040D685		       call    _free
.text:0040D68A		       push    dword ptr [esi+34h] ; pBlock
.text:0040D68D		       call    _free
.text:0040D692		       push    dword ptr [esi+1Ch] ; pBlock
.text:0040D695		       call    _free
.text:0040D69A		       push    dword ptr [esi+38h] ; pBlock
.text:0040D69D		       call    _free
.text:0040D6A2		       push    dword ptr [esi+3Ch] ; pBlock
.text:0040D6A5		       call    _free
.text:0040D6AA		       add     esp, 40h
.text:0040D6AD		       push    dword ptr [esi+40h] ; pBlock
.text:0040D6B0		       call    _free
.text:0040D6B5		       push    dword ptr [esi+44h] ; pBlock
.text:0040D6B8		       call    _free
.text:0040D6BD		       push    dword ptr [esi+48h] ; pBlock
.text:0040D6C0		       call    _free
.text:0040D6C5		       push    dword ptr [esi+4Ch] ; pBlock
.text:0040D6C8		       call    _free
.text:0040D6CD		       push    dword ptr [esi+50h] ; pBlock
.text:0040D6D0		       call    _free
.text:0040D6D5		       push    dword ptr [esi+54h] ; pBlock
.text:0040D6D8		       call    _free
.text:0040D6DD		       push    dword ptr [esi+58h] ; pBlock
.text:0040D6E0		       call    _free
.text:0040D6E5		       push    dword ptr [esi+5Ch] ; pBlock
.text:0040D6E8		       call    _free
.text:0040D6ED		       push    dword ptr [esi+60h] ; pBlock
.text:0040D6F0		       call    _free
.text:0040D6F5		       push    dword ptr [esi+64h] ; pBlock
.text:0040D6F8		       call    _free
.text:0040D6FD		       push    dword ptr [esi+68h] ; pBlock
.text:0040D700		       call    _free
.text:0040D705		       push    dword ptr [esi+6Ch] ; pBlock
.text:0040D708		       call    _free
.text:0040D70D		       push    dword ptr [esi+70h] ; pBlock
.text:0040D710		       call    _free
.text:0040D715		       push    dword ptr [esi+74h] ; pBlock
.text:0040D718		       call    _free
.text:0040D71D		       push    dword ptr [esi+78h] ; pBlock
.text:0040D720		       call    _free
.text:0040D725		       push    dword ptr [esi+7Ch] ; pBlock
.text:0040D728		       call    _free
.text:0040D72D		       add     esp, 40h
.text:0040D730		       push    dword ptr [esi+80h] ; pBlock
.text:0040D736		       call    _free
.text:0040D73B		       push    dword ptr [esi+84h] ; pBlock
.text:0040D741		       call    _free
.text:0040D746		       push    dword ptr [esi+88h] ; pBlock
.text:0040D74C		       call    _free
.text:0040D751		       push    dword ptr [esi+8Ch] ; pBlock
.text:0040D757		       call    _free
.text:0040D75C		       push    dword ptr [esi+90h] ; pBlock
.text:0040D762		       call    _free
.text:0040D767		       push    dword ptr [esi+94h] ; pBlock
.text:0040D76D		       call    _free
.text:0040D772		       push    dword ptr [esi+98h] ; pBlock
.text:0040D778		       call    _free
.text:0040D77D		       push    dword ptr [esi+9Ch] ; pBlock
.text:0040D783		       call    _free
.text:0040D788		       push    dword ptr [esi+0A0h] ; pBlock
.text:0040D78E		       call    _free
.text:0040D793		       push    dword ptr [esi+0A4h] ; pBlock
.text:0040D799		       call    _free
.text:0040D79E		       push    dword ptr [esi+0A8h] ; pBlock
.text:0040D7A4		       call    _free
.text:0040D7A9		       add     esp, 2Ch
.text:0040D7AC
.text:0040D7AC loc_40D7AC:			       ; CODE XREF: ___free_lc_time+7j
.text:0040D7AC		       pop     esi
.text:0040D7AD		       retn
.text:0040D7AD ___free_lc_time endp
.text:0040D7AD
.text:0040D7AE
.text:0040D7AE ; =============== S U B R O U T I N E =======================================
.text:0040D7AE
.text:0040D7AE
.text:0040D7AE ; int __cdecl __init_time(threadlocaleinfostruct	*ploci)
.text:0040D7AE ___init_time    proc near	       ; DATA XREF: .rdata:0041E41Co
.text:0040D7AE
.text:0040D7AE ploci	       = dword ptr  4
.text:0040D7AE
.text:0040D7AE		       push    ebx
.text:0040D7AF		       push    ebp
.text:0040D7B0		       push    esi
.text:0040D7B1		       push    edi
.text:0040D7B2		       mov     edi, [esp+10h+ploci]
.text:0040D7B6		       cmp     dword ptr [edi+20h], 0
.text:0040D7BA		       mov     ebx, offset ___lc_time_c
.text:0040D7BF		       jz      short loc_40D7FE
.text:0040D7C1		       xor     ebp, ebp
.text:0040D7C3		       push    0B8h	       ; size
.text:0040D7C8		       inc     ebp
.text:0040D7C9		       push    ebp	       ; count
.text:0040D7CA		       call    __calloc_crt
.text:0040D7CF		       mov     esi, eax
.text:0040D7D1		       test    esi, esi
.text:0040D7D3		       pop     ecx
.text:0040D7D4		       pop     ecx
.text:0040D7D5		       jnz     short loc_40D7DB
.text:0040D7D7
.text:0040D7D7 loc_40D7D7:			       ; CODE XREF: ___init_time+46j
.text:0040D7D7		       mov     eax, ebp
.text:0040D7D9		       jmp     short loc_40D81C
.text:0040D7DB ; ---------------------------------------------------------------------------
.text:0040D7DB
.text:0040D7DB loc_40D7DB:			       ; CODE XREF: ___init_time+27j
.text:0040D7DB		       mov     eax, edi	       ; ploci
.text:0040D7DD		       call    _get_lc_time
.text:0040D7E2		       test    eax, eax
.text:0040D7E4		       jz      short loc_40D7F6
.text:0040D7E6		       push    esi	       ; lc_time
.text:0040D7E7		       call    ___free_lc_time
.text:0040D7EC		       push    esi	       ; pBlock
.text:0040D7ED		       call    _free
.text:0040D7F2		       pop     ecx
.text:0040D7F3		       pop     ecx
.text:0040D7F4		       jmp     short loc_40D7D7
.text:0040D7F6 ; ---------------------------------------------------------------------------
.text:0040D7F6
.text:0040D7F6 loc_40D7F6:			       ; CODE XREF: ___init_time+36j
.text:0040D7F6		       mov     [esi+0B4h], ebp
.text:0040D7FC		       jmp     short loc_40D800
.text:0040D7FE ; ---------------------------------------------------------------------------
.text:0040D7FE
.text:0040D7FE loc_40D7FE:			       ; CODE XREF: ___init_time+11j
.text:0040D7FE		       mov     esi, ebx
.text:0040D800
.text:0040D800 loc_40D800:			       ; CODE XREF: ___init_time+4Ej
.text:0040D800		       add     edi, 0D4h
.text:0040D806		       mov     eax, [edi]
.text:0040D808		       cmp     eax, ebx
.text:0040D80A		       jz      short loc_40D818
.text:0040D80C		       add     eax, 0B4h
.text:0040D811		       push    eax	       ; lpAddend
.text:0040D812		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040D818
.text:0040D818 loc_40D818:			       ; CODE XREF: ___init_time+5Cj
.text:0040D818		       mov     [edi], esi
.text:0040D81A		       xor     eax, eax
.text:0040D81C
.text:0040D81C loc_40D81C:			       ; CODE XREF: ___init_time+2Bj
.text:0040D81C		       pop     edi
.text:0040D81D		       pop     esi
.text:0040D81E		       pop     ebp
.text:0040D81F		       pop     ebx
.text:0040D820		       retn
.text:0040D820 ___init_time    endp
.text:0040D820
.text:0040D821
.text:0040D821 ; =============== S U B R O U T I N E =======================================
.text:0040D821
.text:0040D821
.text:0040D821 ; void __usercall fix_grouping(char *grouping<ecx>)
.text:0040D821 fix_grouping    proc near
.text:0040D821 grouping	= ecx
.text:0040D821		       xor     dl, dl
.text:0040D823		       cmp     [grouping], dl
.text:0040D825		       jz      short locret_40D83E
.text:0040D827		       push    ebx
.text:0040D828		       push    esi
.text:0040D829
.text:0040D829 loc_40D829:			       ; CODE XREF: fix_grouping+19j
.text:0040D829		       mov     al, [grouping]
.text:0040D82B		       cmp     al, 30h
.text:0040D82D		       jl      short loc_40D83F
.text:0040D82F		       cmp     al, 39h
.text:0040D831		       jg      short loc_40D83F
.text:0040D833		       sub     al, 30h
.text:0040D835		       mov     [grouping], al
.text:0040D837
.text:0040D837 loc_40D837:			       ; CODE XREF: fix_grouping+20j
.text:0040D837		       inc     grouping
.text:0040D838
.text:0040D838 loc_40D838:			       ; CODE XREF: fix_grouping+31j
.text:0040D838		       cmp     [grouping], dl
.text:0040D83A		       jnz     short loc_40D829
.text:0040D83C		       pop     esi
.text:0040D83D		       pop     ebx
.text:0040D83E
.text:0040D83E locret_40D83E:			       ; CODE XREF: fix_grouping+4j
.text:0040D83E		       retn
.text:0040D83F ; ---------------------------------------------------------------------------
.text:0040D83F
.text:0040D83F loc_40D83F:			       ; CODE XREF: fix_grouping+Cj
.text:0040D83F					       ; fix_grouping+10j
.text:0040D83F		       cmp     al, 3Bh
.text:0040D841		       jnz     short loc_40D837
.text:0040D843		       mov     eax, grouping
.text:0040D845
.text:0040D845 loc_40D845:			       ; CODE XREF: fix_grouping+2Fj
.text:0040D845		       lea     esi, [eax+1]
.text:0040D848		       mov     bl, [esi]
.text:0040D84A		       mov     [eax], bl
.text:0040D84C		       mov     eax, esi
.text:0040D84E		       cmp     [eax], dl
.text:0040D850		       jnz     short loc_40D845
.text:0040D852		       jmp     short loc_40D838
.text:0040D852 fix_grouping    endp
.text:0040D852
.text:0040D854
.text:0040D854 ; =============== S U B R O U T I N E =======================================
.text:0040D854
.text:0040D854
.text:0040D854 ; void __cdecl __free_lconv_num(lconv *l)
.text:0040D854 ___free_lconv_num proc near	       ; CODE XREF: ___freetlocinfo+64p
.text:0040D854					       ; ___init_numeric+F7p
.text:0040D854
.text:0040D854 l	       = dword ptr  4
.text:0040D854
.text:0040D854		       push    esi
.text:0040D855		       mov     esi, [esp+4+l]
.text:0040D859		       test    esi, esi
.text:0040D85B		       jz      short loc_40D892
.text:0040D85D		       mov     eax, [esi]
.text:0040D85F		       cmp     eax, ___lconv_c
.text:0040D865		       jz      short loc_40D86E
.text:0040D867		       push    eax	       ; pBlock
.text:0040D868		       call    _free
.text:0040D86D		       pop     ecx
.text:0040D86E
.text:0040D86E loc_40D86E:			       ; CODE XREF: ___free_lconv_num+11j
.text:0040D86E		       mov     eax, [esi+4]
.text:0040D871		       cmp     eax, off_421E5C
.text:0040D877		       jz      short loc_40D880
.text:0040D879		       push    eax	       ; pBlock
.text:0040D87A		       call    _free
.text:0040D87F		       pop     ecx
.text:0040D880
.text:0040D880 loc_40D880:			       ; CODE XREF: ___free_lconv_num+23j
.text:0040D880		       mov     esi, [esi+8]
.text:0040D883		       cmp     esi, off_421E60
.text:0040D889		       jz      short loc_40D892
.text:0040D88B		       push    esi	       ; pBlock
.text:0040D88C		       call    _free
.text:0040D891		       pop     ecx
.text:0040D892
.text:0040D892 loc_40D892:			       ; CODE XREF: ___free_lconv_num+7j
.text:0040D892					       ; ___free_lconv_num+35j
.text:0040D892		       pop     esi
.text:0040D893		       retn
.text:0040D893 ___free_lconv_num endp
.text:0040D893
.text:0040D894
.text:0040D894 ; =============== S U B R O U T I N E =======================================
.text:0040D894
.text:0040D894 ; Attributes: bp-based frame
.text:0040D894
.text:0040D894 ; int __cdecl __init_numeric(threadlocaleinfostruct *ploci)
.text:0040D894 ___init_numeric proc near	       ; DATA XREF: .rdata:0041E410o
.text:0040D894
.text:0040D894 locinfo	       = localeinfo_struct ptr -18h
.text:0040D894 var_10	       = dword ptr -10h
.text:0040D894 ret	       = dword ptr -0Ch
.text:0040D894 lc_refcount     = dword ptr -8
.text:0040D894 lconv_num_refcount= dword ptr -4
.text:0040D894 lc	       = dword ptr  8
.text:0040D894
.text:0040D894		       push    ebp
.text:0040D895		       mov     ebp, esp
.text:0040D897		       sub     esp, 18h
.text:0040D89A		       push    ebx
.text:0040D89B		       mov     ebx, [ebp+lc]
.text:0040D89E		       push    esi
.text:0040D89F		       xor     esi, esi
.text:0040D8A1		       cmp     [ebx+1Ch], esi
.text:0040D8A4		       push    edi
.text:0040D8A5		       mov     [ebp+locinfo.locinfo], ebx
.text:0040D8A8		       mov     [ebp+locinfo.mbcinfo], esi
.text:0040D8AB		       jnz     short loc_40D8C4
.text:0040D8AD		       cmp     [ebx+18h], esi
.text:0040D8B0		       jnz     short loc_40D8C4
.text:0040D8B2		       mov     [ebp+lconv_num_refcount], esi
.text:0040D8B5		       mov     [ebp+lc_refcount], esi
.text:0040D8B8		       mov     [ebp+lc], offset	___lconv_c
.text:0040D8BF		       jmp     loc_40D9FE
.text:0040D8C4 ; ---------------------------------------------------------------------------
.text:0040D8C4
.text:0040D8C4 loc_40D8C4:			       ; CODE XREF: ___init_numeric+17j
.text:0040D8C4					       ; ___init_numeric+1Cj
.text:0040D8C4		       push    30h	       ; size
.text:0040D8C6		       push    1	       ; count
.text:0040D8C8		       call    __calloc_crt
.text:0040D8CD		       mov     edi, eax
.text:0040D8CF		       cmp     edi, esi
.text:0040D8D1		       pop     ecx
.text:0040D8D2		       pop     ecx
.text:0040D8D3		       mov     [ebp+lc], edi
.text:0040D8D6		       jnz     short loc_40D8E0
.text:0040D8D8
.text:0040D8D8 loc_40D8D8:			       ; CODE XREF: ___init_numeric+71j
.text:0040D8D8		       xor     eax, eax
.text:0040D8DA		       inc     eax
.text:0040D8DB		       jmp     loc_40DA57
.text:0040D8E0 ; ---------------------------------------------------------------------------
.text:0040D8E0
.text:0040D8E0 loc_40D8E0:			       ; CODE XREF: ___init_numeric+42j
.text:0040D8E0		       mov     esi, [ebx+0BCh]
.text:0040D8E6		       push    0Ch
.text:0040D8E8		       pop     ecx
.text:0040D8E9		       push    4	       ; cb
.text:0040D8EB		       rep movsd
.text:0040D8ED		       call    __malloc_crt
.text:0040D8F2		       xor     esi, esi
.text:0040D8F4		       cmp     eax, esi
.text:0040D8F6		       pop     ecx
.text:0040D8F7		       mov     [ebp+lc_refcount], eax
.text:0040D8FA		       jnz     short loc_40D907
.text:0040D8FC		       push    [ebp+lc]	       ; pBlock
.text:0040D8FF		       call    _free
.text:0040D904		       pop     ecx
.text:0040D905		       jmp     short loc_40D8D8
.text:0040D907 ; ---------------------------------------------------------------------------
.text:0040D907
.text:0040D907 loc_40D907:			       ; CODE XREF: ___init_numeric+66j
.text:0040D907		       mov     [eax], esi
.text:0040D909		       cmp     [ebx+1Ch], esi
.text:0040D90C		       jz      loc_40D9CD
.text:0040D912		       push    4	       ; cb
.text:0040D914		       call    __malloc_crt
.text:0040D919		       cmp     eax, esi
.text:0040D91B		       pop     ecx
.text:0040D91C		       mov     [ebp+lconv_num_refcount], eax
.text:0040D91F		       jnz     short loc_40D93D
.text:0040D921		       xor     esi, esi
.text:0040D923		       inc     esi
.text:0040D924
.text:0040D924 loc_40D924:			       ; CODE XREF: ___init_numeric+100j
.text:0040D924		       push    [ebp+lc]	       ; pBlock
.text:0040D927		       call    _free
.text:0040D92C		       push    [ebp+lc_refcount] ; pBlock
.text:0040D92F		       call    _free
.text:0040D934		       pop     ecx
.text:0040D935		       pop     ecx
.text:0040D936		       mov     eax, esi
.text:0040D938		       jmp     loc_40DA57
.text:0040D93D ; ---------------------------------------------------------------------------
.text:0040D93D
.text:0040D93D loc_40D93D:			       ; CODE XREF: ___init_numeric+8Bj
.text:0040D93D		       mov     [eax], esi
.text:0040D93F		       mov     esi, [ebp+lc]
.text:0040D942		       movzx   edi, word ptr [ebx+3Eh]
.text:0040D946		       push    esi	       ; address
.text:0040D947		       push    0Eh	       ; fieldtype
.text:0040D949		       push    edi	       ; localehandle
.text:0040D94A		       lea     eax, [ebp+locinfo]
.text:0040D94D		       push    1	       ; lc_type
.text:0040D94F		       push    eax	       ; plocinfo
.text:0040D950		       call    ___getlocaleinfo
.text:0040D955		       mov     [ebp+ret], eax
.text:0040D958		       lea     eax, [esi+4]
.text:0040D95B		       push    eax	       ; address
.text:0040D95C		       push    0Fh	       ; fieldtype
.text:0040D95E		       push    edi	       ; localehandle
.text:0040D95F		       lea     eax, [ebp+locinfo]
.text:0040D962		       push    1	       ; lc_type
.text:0040D964		       push    eax	       ; plocinfo
.text:0040D965		       call    ___getlocaleinfo
.text:0040D96A		       or      [ebp+ret], eax
.text:0040D96D		       lea     eax, [esi+8]
.text:0040D970		       push    eax	       ; address
.text:0040D971		       push    10h	       ; fieldtype
.text:0040D973		       push    edi	       ; localehandle
.text:0040D974		       mov     [ebp+var_10], eax
.text:0040D977		       lea     eax, [ebp+locinfo]
.text:0040D97A		       push    1	       ; lc_type
.text:0040D97C		       push    eax	       ; plocinfo
.text:0040D97D		       call    ___getlocaleinfo
.text:0040D982		       add     esp, 3Ch
.text:0040D985		       or      eax, [ebp+ret]
.text:0040D988		       jz      short loc_40D996
.text:0040D98A		       push    esi	       ; l
.text:0040D98B		       call    ___free_lconv_num
.text:0040D990		       pop     ecx
.text:0040D991		       or      esi, 0FFFFFFFFh
.text:0040D994		       jmp     short loc_40D924
.text:0040D996 ; ---------------------------------------------------------------------------
.text:0040D996
.text:0040D996 loc_40D996:			       ; CODE XREF: ___init_numeric+F4j
.text:0040D996		       mov     eax, [ebp+var_10]
.text:0040D999		       mov     eax, [eax]
.text:0040D99B		       jmp     short loc_40D9AF
.text:0040D99D ; ---------------------------------------------------------------------------
.text:0040D99D
.text:0040D99D loc_40D99D:			       ; CODE XREF: ___init_numeric+11Ej
.text:0040D99D		       mov     cl, [eax]
.text:0040D99F		       cmp     cl, 30h
.text:0040D9A2		       jl      short loc_40D9B6
.text:0040D9A4		       cmp     cl, 39h
.text:0040D9A7		       jg      short loc_40D9B6
.text:0040D9A9		       sub     cl, 30h
.text:0040D9AC		       mov     [eax], cl
.text:0040D9AE
.text:0040D9AE loc_40D9AE:			       ; CODE XREF: ___init_numeric+125j
.text:0040D9AE		       inc     eax
.text:0040D9AF
.text:0040D9AF loc_40D9AF:			       ; CODE XREF: ___init_numeric+107j
.text:0040D9AF					       ; ___init_numeric+137j
.text:0040D9AF		       cmp     byte ptr	[eax], 0
.text:0040D9B2		       jnz     short loc_40D99D
.text:0040D9B4		       jmp     short loc_40D9ED
.text:0040D9B6 ; ---------------------------------------------------------------------------
.text:0040D9B6
.text:0040D9B6 loc_40D9B6:			       ; CODE XREF: ___init_numeric+10Ej
.text:0040D9B6					       ; ___init_numeric+113j
.text:0040D9B6		       cmp     cl, 3Bh
.text:0040D9B9		       jnz     short loc_40D9AE
.text:0040D9BB		       mov     esi, eax
.text:0040D9BD
.text:0040D9BD loc_40D9BD:			       ; CODE XREF: ___init_numeric+135j
.text:0040D9BD		       lea     edi, [esi+1]
.text:0040D9C0		       mov     cl, [edi]
.text:0040D9C2		       mov     [esi], cl
.text:0040D9C4		       mov     esi, edi
.text:0040D9C6		       cmp     byte ptr	[esi], 0
.text:0040D9C9		       jnz     short loc_40D9BD
.text:0040D9CB		       jmp     short loc_40D9AF
.text:0040D9CD ; ---------------------------------------------------------------------------
.text:0040D9CD
.text:0040D9CD loc_40D9CD:			       ; CODE XREF: ___init_numeric+78j
.text:0040D9CD		       mov     ecx, ___lconv_c
.text:0040D9D3		       mov     eax, [ebp+lc]
.text:0040D9D6		       mov     [eax], ecx
.text:0040D9D8		       mov     ecx, off_421E5C
.text:0040D9DE		       mov     [eax+4],	ecx
.text:0040D9E1		       mov     ecx, off_421E60
.text:0040D9E7		       mov     [ebp+lconv_num_refcount], esi
.text:0040D9EA		       mov     [eax+8],	ecx
.text:0040D9ED
.text:0040D9ED loc_40D9ED:			       ; CODE XREF: ___init_numeric+120j
.text:0040D9ED		       mov     eax, [ebp+lc_refcount]
.text:0040D9F0		       xor     ecx, ecx
.text:0040D9F2		       inc     ecx
.text:0040D9F3		       mov     [eax], ecx
.text:0040D9F5		       mov     eax, [ebp+lconv_num_refcount]
.text:0040D9F8		       test    eax, eax
.text:0040D9FA		       jz      short loc_40D9FE
.text:0040D9FC		       mov     [eax], ecx
.text:0040D9FE
.text:0040D9FE loc_40D9FE:			       ; CODE XREF: ___init_numeric+2Bj
.text:0040D9FE					       ; ___init_numeric+166j
.text:0040D9FE		       mov     eax, [ebx+0B4h]
.text:0040DA04		       test    eax, eax
.text:0040DA06		       mov     esi, ds:__imp__InterlockedDecrement@4 ; InterlockedDecrement(x)
.text:0040DA0C		       jz      short loc_40DA11
.text:0040DA0E		       push    eax	       ; lpAddend
.text:0040DA0F		       call    esi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:0040DA11
.text:0040DA11 loc_40DA11:			       ; CODE XREF: ___init_numeric+178j
.text:0040DA11		       mov     eax, [ebx+0B0h]
.text:0040DA17		       test    eax, eax
.text:0040DA19		       jz      short loc_40DA3A
.text:0040DA1B		       push    eax	       ; lpAddend
.text:0040DA1C		       call    esi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:0040DA1E		       test    eax, eax
.text:0040DA20		       jnz     short loc_40DA3A
.text:0040DA22		       push    dword ptr [ebx+0B0h] ; pBlock
.text:0040DA28		       call    _free
.text:0040DA2D		       push    dword ptr [ebx+0BCh] ; pBlock
.text:0040DA33		       call    _free
.text:0040DA38		       pop     ecx
.text:0040DA39		       pop     ecx
.text:0040DA3A
.text:0040DA3A loc_40DA3A:			       ; CODE XREF: ___init_numeric+185j
.text:0040DA3A					       ; ___init_numeric+18Cj
.text:0040DA3A		       mov     eax, [ebp+lconv_num_refcount]
.text:0040DA3D		       mov     [ebx+0B4h], eax
.text:0040DA43		       mov     eax, [ebp+lc_refcount]
.text:0040DA46		       mov     [ebx+0B0h], eax
.text:0040DA4C		       mov     eax, [ebp+lc]
.text:0040DA4F		       mov     [ebx+0BCh], eax
.text:0040DA55		       xor     eax, eax
.text:0040DA57
.text:0040DA57 loc_40DA57:			       ; CODE XREF: ___init_numeric+47j
.text:0040DA57					       ; ___init_numeric+A4j
.text:0040DA57		       pop     edi
.text:0040DA58		       pop     esi
.text:0040DA59		       pop     ebx
.text:0040DA5A		       leave
.text:0040DA5B		       retn
.text:0040DA5B ___init_numeric endp
.text:0040DA5B
.text:0040DA5C
.text:0040DA5C ; =============== S U B R O U T I N E =======================================
.text:0040DA5C
.text:0040DA5C
.text:0040DA5C ; void __usercall fix_grouping_0(char *grouping<ecx>)
.text:0040DA5C fix_grouping_0  proc near
.text:0040DA5C grouping	= ecx
.text:0040DA5C		       xor     dl, dl
.text:0040DA5E		       cmp     [grouping], dl
.text:0040DA60		       jz      short locret_40DA79
.text:0040DA62		       push    ebx
.text:0040DA63		       push    esi
.text:0040DA64
.text:0040DA64 loc_40DA64:			       ; CODE XREF: fix_grouping_0+19j
.text:0040DA64		       mov     al, [grouping]
.text:0040DA66		       cmp     al, 30h
.text:0040DA68		       jl      short loc_40DA7A
.text:0040DA6A		       cmp     al, 39h
.text:0040DA6C		       jg      short loc_40DA7A
.text:0040DA6E		       sub     al, 30h
.text:0040DA70		       mov     [grouping], al
.text:0040DA72
.text:0040DA72 loc_40DA72:			       ; CODE XREF: fix_grouping_0+20j
.text:0040DA72		       inc     grouping
.text:0040DA73
.text:0040DA73 loc_40DA73:			       ; CODE XREF: fix_grouping_0+31j
.text:0040DA73		       cmp     [grouping], dl
.text:0040DA75		       jnz     short loc_40DA64
.text:0040DA77		       pop     esi
.text:0040DA78		       pop     ebx
.text:0040DA79
.text:0040DA79 locret_40DA79:			       ; CODE XREF: fix_grouping_0+4j
.text:0040DA79		       retn
.text:0040DA7A ; ---------------------------------------------------------------------------
.text:0040DA7A
.text:0040DA7A loc_40DA7A:			       ; CODE XREF: fix_grouping_0+Cj
.text:0040DA7A					       ; fix_grouping_0+10j
.text:0040DA7A		       cmp     al, 3Bh
.text:0040DA7C		       jnz     short loc_40DA72
.text:0040DA7E		       mov     eax, grouping
.text:0040DA80
.text:0040DA80 loc_40DA80:			       ; CODE XREF: fix_grouping_0+2Fj
.text:0040DA80		       lea     esi, [eax+1]
.text:0040DA83		       mov     bl, [esi]
.text:0040DA85		       mov     [eax], bl
.text:0040DA87		       mov     eax, esi
.text:0040DA89		       cmp     [eax], dl
.text:0040DA8B		       jnz     short loc_40DA80
.text:0040DA8D		       jmp     short loc_40DA73
.text:0040DA8D fix_grouping_0  endp
.text:0040DA8D
.text:0040DA8F
.text:0040DA8F ; =============== S U B R O U T I N E =======================================
.text:0040DA8F
.text:0040DA8F
.text:0040DA8F ; void __cdecl __free_lconv_mon(lconv *l)
.text:0040DA8F ___free_lconv_mon proc near	       ; CODE XREF: ___freetlocinfo+43p
.text:0040DA8F					       ; ___init_monetary+1CEp
.text:0040DA8F
.text:0040DA8F l	       = dword ptr  4
.text:0040DA8F
.text:0040DA8F		       push    esi
.text:0040DA90		       mov     esi, [esp+4+l]
.text:0040DA94		       test    esi, esi
.text:0040DA96		       jz      short loc_40DB16
.text:0040DA98		       mov     eax, [esi+0Ch]
.text:0040DA9B		       cmp     eax, off_421E64
.text:0040DAA1		       jz      short loc_40DAAA
.text:0040DAA3		       push    eax	       ; pBlock
.text:0040DAA4		       call    _free
.text:0040DAA9		       pop     ecx
.text:0040DAAA
.text:0040DAAA loc_40DAAA:			       ; CODE XREF: ___free_lconv_mon+12j
.text:0040DAAA		       mov     eax, [esi+10h]
.text:0040DAAD		       cmp     eax, off_421E68
.text:0040DAB3		       jz      short loc_40DABC
.text:0040DAB5		       push    eax	       ; pBlock
.text:0040DAB6		       call    _free
.text:0040DABB		       pop     ecx
.text:0040DABC
.text:0040DABC loc_40DABC:			       ; CODE XREF: ___free_lconv_mon+24j
.text:0040DABC		       mov     eax, [esi+14h]
.text:0040DABF		       cmp     eax, off_421E6C
.text:0040DAC5		       jz      short loc_40DACE
.text:0040DAC7		       push    eax	       ; pBlock
.text:0040DAC8		       call    _free
.text:0040DACD		       pop     ecx
.text:0040DACE
.text:0040DACE loc_40DACE:			       ; CODE XREF: ___free_lconv_mon+36j
.text:0040DACE		       mov     eax, [esi+18h]
.text:0040DAD1		       cmp     eax, off_421E70
.text:0040DAD7		       jz      short loc_40DAE0
.text:0040DAD9		       push    eax	       ; pBlock
.text:0040DADA		       call    _free
.text:0040DADF		       pop     ecx
.text:0040DAE0
.text:0040DAE0 loc_40DAE0:			       ; CODE XREF: ___free_lconv_mon+48j
.text:0040DAE0		       mov     eax, [esi+1Ch]
.text:0040DAE3		       cmp     eax, off_421E74
.text:0040DAE9		       jz      short loc_40DAF2
.text:0040DAEB		       push    eax	       ; pBlock
.text:0040DAEC		       call    _free
.text:0040DAF1		       pop     ecx
.text:0040DAF2
.text:0040DAF2 loc_40DAF2:			       ; CODE XREF: ___free_lconv_mon+5Aj
.text:0040DAF2		       mov     eax, [esi+20h]
.text:0040DAF5		       cmp     eax, off_421E78
.text:0040DAFB		       jz      short loc_40DB04
.text:0040DAFD		       push    eax	       ; pBlock
.text:0040DAFE		       call    _free
.text:0040DB03		       pop     ecx
.text:0040DB04
.text:0040DB04 loc_40DB04:			       ; CODE XREF: ___free_lconv_mon+6Cj
.text:0040DB04		       mov     esi, [esi+24h]
.text:0040DB07		       cmp     esi, off_421E7C
.text:0040DB0D		       jz      short loc_40DB16
.text:0040DB0F		       push    esi	       ; pBlock
.text:0040DB10		       call    _free
.text:0040DB15		       pop     ecx
.text:0040DB16
.text:0040DB16 loc_40DB16:			       ; CODE XREF: ___free_lconv_mon+7j
.text:0040DB16					       ; ___free_lconv_mon+7Ej
.text:0040DB16		       pop     esi
.text:0040DB17		       retn
.text:0040DB17 ___free_lconv_mon endp
.text:0040DB17
.text:0040DB18
.text:0040DB18 ; =============== S U B R O U T I N E =======================================
.text:0040DB18
.text:0040DB18 ; Attributes: bp-based frame
.text:0040DB18
.text:0040DB18 ; int __cdecl __init_monetary(threadlocaleinfostruct *ploci)
.text:0040DB18 ___init_monetary	proc near	       ; DATA XREF: .rdata:0041E404o
.text:0040DB18
.text:0040DB18 locinfo	       = localeinfo_struct ptr -10h
.text:0040DB18 lc_refcount     = dword ptr -8
.text:0040DB18 lconv_mon_refcount= dword ptr -4
.text:0040DB18 ploci	       = dword ptr  8
.text:0040DB18
.text:0040DB18		       push    ebp
.text:0040DB19		       mov     ebp, esp
.text:0040DB1B		       sub     esp, 10h
.text:0040DB1E		       push    ebx
.text:0040DB1F		       push    esi
.text:0040DB20		       mov     esi, [ebp+ploci]
.text:0040DB23		       push    edi
.text:0040DB24		       xor     edi, edi
.text:0040DB26		       cmp     [esi+18h], edi
.text:0040DB29		       mov     [ebp+lconv_mon_refcount], edi
.text:0040DB2C		       mov     [ebp+locinfo.locinfo], esi
.text:0040DB2F		       mov     [ebp+locinfo.mbcinfo], edi
.text:0040DB32		       jnz     short loc_40DB49
.text:0040DB34		       cmp     [esi+1Ch], edi
.text:0040DB37		       jnz     short loc_40DB49
.text:0040DB39		       mov     [ebp+lconv_mon_refcount], edi
.text:0040DB3C		       mov     [ebp+lc_refcount], edi
.text:0040DB3F		       mov     ebx, offset ___lconv_c
.text:0040DB44		       jmp     loc_40DD7F
.text:0040DB49 ; ---------------------------------------------------------------------------
.text:0040DB49
.text:0040DB49 loc_40DB49:			       ; CODE XREF: ___init_monetary+1Aj
.text:0040DB49					       ; ___init_monetary+1Fj
.text:0040DB49		       push    30h	       ; size
.text:0040DB4B		       push    1	       ; count
.text:0040DB4D		       call    __calloc_crt
.text:0040DB52		       mov     ebx, eax
.text:0040DB54		       cmp     ebx, edi
.text:0040DB56		       pop     ecx
.text:0040DB57		       pop     ecx
.text:0040DB58		       jnz     short loc_40DB62
.text:0040DB5A
.text:0040DB5A loc_40DB5A:			       ; CODE XREF: ___init_monetary+60j
.text:0040DB5A					       ; ___init_monetary+1ECj
.text:0040DB5A		       xor     eax, eax
.text:0040DB5C		       inc     eax
.text:0040DB5D		       jmp     loc_40DDD7
.text:0040DB62 ; ---------------------------------------------------------------------------
.text:0040DB62
.text:0040DB62 loc_40DB62:			       ; CODE XREF: ___init_monetary+40j
.text:0040DB62		       push    4	       ; cb
.text:0040DB64		       call    __malloc_crt
.text:0040DB69		       cmp     eax, edi
.text:0040DB6B		       pop     ecx
.text:0040DB6C		       mov     [ebp+lc_refcount], eax
.text:0040DB6F		       jnz     short loc_40DB7A
.text:0040DB71		       push    ebx	       ; pBlock
.text:0040DB72		       call    _free
.text:0040DB77
.text:0040DB77 loc_40DB77:			       ; CODE XREF: ___init_monetary+8Bj
.text:0040DB77		       pop     ecx
.text:0040DB78		       jmp     short loc_40DB5A
.text:0040DB7A ; ---------------------------------------------------------------------------
.text:0040DB7A
.text:0040DB7A loc_40DB7A:			       ; CODE XREF: ___init_monetary+57j
.text:0040DB7A		       mov     [eax], edi
.text:0040DB7C		       cmp     [esi+18h], edi
.text:0040DB7F		       jz      loc_40DD3E
.text:0040DB85		       push    4	       ; cb
.text:0040DB87		       call    __malloc_crt
.text:0040DB8C		       cmp     eax, edi
.text:0040DB8E		       pop     ecx
.text:0040DB8F		       mov     [ebp+lconv_mon_refcount], eax
.text:0040DB92		       jnz     short loc_40DBA5
.text:0040DB94		       push    ebx	       ; pBlock
.text:0040DB95		       call    _free
.text:0040DB9A		       push    [ebp+lc_refcount] ; pBlock
.text:0040DB9D		       call    _free
.text:0040DBA2		       pop     ecx
.text:0040DBA3		       jmp     short loc_40DB77
.text:0040DBA5 ; ---------------------------------------------------------------------------
.text:0040DBA5
.text:0040DBA5 loc_40DBA5:			       ; CODE XREF: ___init_monetary+7Aj
.text:0040DBA5		       mov     [eax], edi
.text:0040DBA7		       movzx   esi, word ptr [esi+38h]
.text:0040DBAB		       lea     eax, [ebx+0Ch]
.text:0040DBAE		       push    eax	       ; address
.text:0040DBAF		       push    15h	       ; fieldtype
.text:0040DBB1		       push    esi	       ; localehandle
.text:0040DBB2		       lea     eax, [ebp+locinfo]
.text:0040DBB5		       push    1	       ; lc_type
.text:0040DBB7		       push    eax	       ; plocinfo
.text:0040DBB8		       call    ___getlocaleinfo
.text:0040DBBD		       mov     edi, eax
.text:0040DBBF		       lea     eax, [ebx+10h]
.text:0040DBC2		       push    eax	       ; address
.text:0040DBC3		       push    14h	       ; fieldtype
.text:0040DBC5		       push    esi	       ; localehandle
.text:0040DBC6		       lea     eax, [ebp+locinfo]
.text:0040DBC9		       push    1	       ; lc_type
.text:0040DBCB		       push    eax	       ; plocinfo
.text:0040DBCC		       call    ___getlocaleinfo
.text:0040DBD1		       or      edi, eax
.text:0040DBD3		       lea     eax, [ebx+14h]
.text:0040DBD6		       push    eax	       ; address
.text:0040DBD7		       push    16h	       ; fieldtype
.text:0040DBD9		       push    esi	       ; localehandle
.text:0040DBDA		       lea     eax, [ebp+locinfo]
.text:0040DBDD		       push    1	       ; lc_type
.text:0040DBDF		       push    eax	       ; plocinfo
.text:0040DBE0		       call    ___getlocaleinfo
.text:0040DBE5		       or      edi, eax
.text:0040DBE7		       lea     eax, [ebx+18h]
.text:0040DBEA		       push    eax	       ; address
.text:0040DBEB		       push    17h	       ; fieldtype
.text:0040DBED		       push    esi	       ; localehandle
.text:0040DBEE		       lea     eax, [ebp+locinfo]
.text:0040DBF1		       push    1	       ; lc_type
.text:0040DBF3		       push    eax	       ; plocinfo
.text:0040DBF4		       call    ___getlocaleinfo
.text:0040DBF9		       add     esp, 50h
.text:0040DBFC		       or      edi, eax
.text:0040DBFE		       lea     eax, [ebx+1Ch]
.text:0040DC01		       push    eax	       ; address
.text:0040DC02		       push    18h	       ; fieldtype
.text:0040DC04		       push    esi	       ; localehandle
.text:0040DC05		       lea     eax, [ebp+locinfo]
.text:0040DC08		       push    1	       ; lc_type
.text:0040DC0A		       push    eax	       ; plocinfo
.text:0040DC0B		       call    ___getlocaleinfo
.text:0040DC10		       or      edi, eax
.text:0040DC12		       lea     eax, [ebx+20h]
.text:0040DC15		       push    eax	       ; address
.text:0040DC16		       push    50h	       ; fieldtype
.text:0040DC18		       push    esi	       ; localehandle
.text:0040DC19		       lea     eax, [ebp+locinfo]
.text:0040DC1C		       push    1	       ; lc_type
.text:0040DC1E		       push    eax	       ; plocinfo
.text:0040DC1F		       call    ___getlocaleinfo
.text:0040DC24		       or      edi, eax
.text:0040DC26		       lea     eax, [ebx+24h]
.text:0040DC29		       push    eax	       ; address
.text:0040DC2A		       push    51h	       ; fieldtype
.text:0040DC2C		       push    esi	       ; localehandle
.text:0040DC2D		       lea     eax, [ebp+locinfo]
.text:0040DC30		       push    1	       ; lc_type
.text:0040DC32		       push    eax	       ; plocinfo
.text:0040DC33		       call    ___getlocaleinfo
.text:0040DC38		       or      edi, eax
.text:0040DC3A		       lea     eax, [ebx+28h]
.text:0040DC3D		       push    eax	       ; address
.text:0040DC3E		       push    1Ah	       ; fieldtype
.text:0040DC40		       push    esi	       ; localehandle
.text:0040DC41		       lea     eax, [ebp+locinfo]
.text:0040DC44		       push    0	       ; lc_type
.text:0040DC46		       push    eax	       ; plocinfo
.text:0040DC47		       call    ___getlocaleinfo
.text:0040DC4C		       add     esp, 50h
.text:0040DC4F		       or      edi, eax
.text:0040DC51		       lea     eax, [ebx+29h]
.text:0040DC54		       push    eax	       ; address
.text:0040DC55		       push    19h	       ; fieldtype
.text:0040DC57		       push    esi	       ; localehandle
.text:0040DC58		       push    0	       ; lc_type
.text:0040DC5A		       lea     eax, [ebp+locinfo]
.text:0040DC5D		       push    eax	       ; plocinfo
.text:0040DC5E		       call    ___getlocaleinfo
.text:0040DC63		       or      edi, eax
.text:0040DC65		       lea     eax, [ebx+2Ah]
.text:0040DC68		       push    eax	       ; address
.text:0040DC69		       push    54h	       ; fieldtype
.text:0040DC6B		       push    esi	       ; localehandle
.text:0040DC6C		       lea     eax, [ebp+locinfo]
.text:0040DC6F		       push    0	       ; lc_type
.text:0040DC71		       push    eax	       ; plocinfo
.text:0040DC72		       call    ___getlocaleinfo
.text:0040DC77		       or      edi, eax
.text:0040DC79		       lea     eax, [ebx+2Bh]
.text:0040DC7C		       push    eax	       ; address
.text:0040DC7D		       push    55h	       ; fieldtype
.text:0040DC7F		       push    esi	       ; localehandle
.text:0040DC80		       lea     eax, [ebp+locinfo]
.text:0040DC83		       push    0	       ; lc_type
.text:0040DC85		       push    eax	       ; plocinfo
.text:0040DC86		       call    ___getlocaleinfo
.text:0040DC8B		       or      edi, eax
.text:0040DC8D		       lea     eax, [ebx+2Ch]
.text:0040DC90		       push    eax	       ; address
.text:0040DC91		       push    56h	       ; fieldtype
.text:0040DC93		       push    esi	       ; localehandle
.text:0040DC94		       lea     eax, [ebp+locinfo]
.text:0040DC97		       push    0	       ; lc_type
.text:0040DC99		       push    eax	       ; plocinfo
.text:0040DC9A		       call    ___getlocaleinfo
.text:0040DC9F		       add     esp, 50h
.text:0040DCA2		       or      edi, eax
.text:0040DCA4		       lea     eax, [ebx+2Dh]
.text:0040DCA7		       push    eax	       ; address
.text:0040DCA8		       push    57h	       ; fieldtype
.text:0040DCAA		       push    esi	       ; localehandle
.text:0040DCAB		       lea     eax, [ebp+locinfo]
.text:0040DCAE		       push    0	       ; lc_type
.text:0040DCB0		       push    eax	       ; plocinfo
.text:0040DCB1		       call    ___getlocaleinfo
.text:0040DCB6		       or      edi, eax
.text:0040DCB8		       lea     eax, [ebx+2Eh]
.text:0040DCBB		       push    eax	       ; address
.text:0040DCBC		       push    52h	       ; fieldtype
.text:0040DCBE		       push    esi	       ; localehandle
.text:0040DCBF		       lea     eax, [ebp+locinfo]
.text:0040DCC2		       push    0	       ; lc_type
.text:0040DCC4		       push    eax	       ; plocinfo
.text:0040DCC5		       call    ___getlocaleinfo
.text:0040DCCA		       or      edi, eax
.text:0040DCCC		       lea     eax, [ebx+2Fh]
.text:0040DCCF		       push    eax	       ; address
.text:0040DCD0		       push    53h	       ; fieldtype
.text:0040DCD2		       push    esi	       ; localehandle
.text:0040DCD3		       lea     eax, [ebp+locinfo]
.text:0040DCD6		       push    0	       ; lc_type
.text:0040DCD8		       push    eax	       ; plocinfo
.text:0040DCD9		       call    ___getlocaleinfo
.text:0040DCDE		       add     esp, 3Ch
.text:0040DCE1		       or      eax, edi
.text:0040DCE3		       jz      short loc_40DD09
.text:0040DCE5		       push    ebx	       ; l
.text:0040DCE6		       call    ___free_lconv_mon
.text:0040DCEB		       push    ebx	       ; pBlock
.text:0040DCEC		       call    _free
.text:0040DCF1		       push    [ebp+lc_refcount] ; pBlock
.text:0040DCF4		       call    _free
.text:0040DCF9		       push    [ebp+lconv_mon_refcount]	; pBlock
.text:0040DCFC		       call    _free
.text:0040DD01		       add     esp, 10h
.text:0040DD04		       jmp     loc_40DB5A
.text:0040DD09 ; ---------------------------------------------------------------------------
.text:0040DD09
.text:0040DD09 loc_40DD09:			       ; CODE XREF: ___init_monetary+1CBj
.text:0040DD09		       mov     eax, [ebx+1Ch]
.text:0040DD0C		       jmp     short loc_40DD20
.text:0040DD0E ; ---------------------------------------------------------------------------
.text:0040DD0E
.text:0040DD0E loc_40DD0E:			       ; CODE XREF: ___init_monetary+20Bj
.text:0040DD0E		       mov     cl, [eax]
.text:0040DD10		       cmp     cl, 30h
.text:0040DD13		       jl      short loc_40DD27
.text:0040DD15		       cmp     cl, 39h
.text:0040DD18		       jg      short loc_40DD27
.text:0040DD1A		       sub     cl, 30h
.text:0040DD1D		       mov     [eax], cl
.text:0040DD1F
.text:0040DD1F loc_40DD1F:			       ; CODE XREF: ___init_monetary+212j
.text:0040DD1F		       inc     eax
.text:0040DD20
.text:0040DD20 loc_40DD20:			       ; CODE XREF: ___init_monetary+1F4j
.text:0040DD20					       ; ___init_monetary+224j
.text:0040DD20		       cmp     byte ptr	[eax], 0
.text:0040DD23		       jnz     short loc_40DD0E
.text:0040DD25		       jmp     short loc_40DD4A
.text:0040DD27 ; ---------------------------------------------------------------------------
.text:0040DD27
.text:0040DD27 loc_40DD27:			       ; CODE XREF: ___init_monetary+1FBj
.text:0040DD27					       ; ___init_monetary+200j
.text:0040DD27		       cmp     cl, 3Bh
.text:0040DD2A		       jnz     short loc_40DD1F
.text:0040DD2C		       mov     esi, eax
.text:0040DD2E
.text:0040DD2E loc_40DD2E:			       ; CODE XREF: ___init_monetary+222j
.text:0040DD2E		       lea     edi, [esi+1]
.text:0040DD31		       mov     cl, [edi]
.text:0040DD33		       mov     [esi], cl
.text:0040DD35		       mov     esi, edi
.text:0040DD37		       cmp     byte ptr	[esi], 0
.text:0040DD3A		       jnz     short loc_40DD2E
.text:0040DD3C		       jmp     short loc_40DD20
.text:0040DD3E ; ---------------------------------------------------------------------------
.text:0040DD3E
.text:0040DD3E loc_40DD3E:			       ; CODE XREF: ___init_monetary+67j
.text:0040DD3E		       push    0Ch
.text:0040DD40		       pop     ecx
.text:0040DD41		       mov     esi, offset ___lconv_c
.text:0040DD46		       mov     edi, ebx
.text:0040DD48		       rep movsd
.text:0040DD4A
.text:0040DD4A loc_40DD4A:			       ; CODE XREF: ___init_monetary+20Dj
.text:0040DD4A		       mov     eax, [ebp+ploci]
.text:0040DD4D		       mov     esi, [ebp+ploci]
.text:0040DD50		       add     eax, 0BCh
.text:0040DD55		       mov     ecx, [eax]
.text:0040DD57		       mov     ecx, [ecx]
.text:0040DD59		       mov     [ebx], ecx
.text:0040DD5B		       mov     ecx, [eax]
.text:0040DD5D		       mov     ecx, [ecx+4]
.text:0040DD60		       mov     [ebx+4],	ecx
.text:0040DD63		       mov     eax, [eax]
.text:0040DD65		       mov     eax, [eax+8]
.text:0040DD68		       mov     ecx, [ebp+lc_refcount]
.text:0040DD6B		       mov     [ebx+8],	eax
.text:0040DD6E		       xor     eax, eax
.text:0040DD70		       inc     eax
.text:0040DD71		       xor     edi, edi
.text:0040DD73		       cmp     [ebp+lconv_mon_refcount], edi
.text:0040DD76		       mov     [ecx], eax
.text:0040DD78		       jz      short loc_40DD7F
.text:0040DD7A		       mov     ecx, [ebp+lconv_mon_refcount]
.text:0040DD7D		       mov     [ecx], eax
.text:0040DD7F
.text:0040DD7F loc_40DD7F:			       ; CODE XREF: ___init_monetary+2Cj
.text:0040DD7F					       ; ___init_monetary+260j
.text:0040DD7F		       mov     eax, [esi+0B8h]
.text:0040DD85		       cmp     eax, edi
.text:0040DD87		       jz      short loc_40DD90
.text:0040DD89		       push    eax	       ; lpAddend
.text:0040DD8A		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040DD90
.text:0040DD90 loc_40DD90:			       ; CODE XREF: ___init_monetary+26Fj
.text:0040DD90		       mov     eax, [esi+0B0h]
.text:0040DD96		       cmp     eax, edi
.text:0040DD98		       jz      short loc_40DDBD
.text:0040DD9A		       push    eax	       ; lpAddend
.text:0040DD9B		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040DDA1		       test    eax, eax
.text:0040DDA3		       jnz     short loc_40DDBD
.text:0040DDA5		       push    dword ptr [esi+0BCh] ; pBlock
.text:0040DDAB		       call    _free
.text:0040DDB0		       push    dword ptr [esi+0B0h] ; pBlock
.text:0040DDB6		       call    _free
.text:0040DDBB		       pop     ecx
.text:0040DDBC		       pop     ecx
.text:0040DDBD
.text:0040DDBD loc_40DDBD:			       ; CODE XREF: ___init_monetary+280j
.text:0040DDBD					       ; ___init_monetary+28Bj
.text:0040DDBD		       mov     eax, [ebp+lconv_mon_refcount]
.text:0040DDC0		       mov     [esi+0B8h], eax
.text:0040DDC6		       mov     eax, [ebp+lc_refcount]
.text:0040DDC9		       mov     [esi+0B0h], eax
.text:0040DDCF		       mov     [esi+0BCh], ebx
.text:0040DDD5		       xor     eax, eax
.text:0040DDD7
.text:0040DDD7 loc_40DDD7:			       ; CODE XREF: ___init_monetary+45j
.text:0040DDD7		       pop     edi
.text:0040DDD8		       pop     esi
.text:0040DDD9		       pop     ebx
.text:0040DDDA		       leave
.text:0040DDDB		       retn
.text:0040DDDB ___init_monetary	endp
.text:0040DDDB
.text:0040DDDC
.text:0040DDDC ; =============== S U B R O U T I N E =======================================
.text:0040DDDC
.text:0040DDDC ; Attributes: bp-based frame
.text:0040DDDC
.text:0040DDDC ; int __cdecl __init_ctype(threadlocaleinfostruct *ploci)
.text:0040DDDC ___init_ctype   proc near	       ; DATA XREF: .rdata:0041E3F8o
.text:0040DDDC
.text:0040DDDC locinfo	       = localeinfo_struct ptr -48h
.text:0040DDDC var_40	       = dword ptr -40h
.text:0040DDDC var_3C	       = dword ptr -3Ch
.text:0040DDDC var_38	       = dword ptr -38h
.text:0040DDDC var_34	       = dword ptr -34h
.text:0040DDDC mb_cur_max      = dword ptr -30h
.text:0040DDDC refcount	       = dword ptr -2Ch
.text:0040DDDC newcumap	       = dword ptr -28h
.text:0040DDDC newctype1       = dword ptr -24h
.text:0040DDDC cbuffer	       = dword ptr -20h
.text:0040DDDC newclmap	       = dword ptr -1Ch
.text:0040DDDC lpCPInfo	       = _cpinfo ptr -18h
.text:0040DDDC var_4	       = dword ptr -4
.text:0040DDDC ploci	       = dword ptr  8
.text:0040DDDC
.text:0040DDDC		       push    ebp
.text:0040DDDD		       mov     ebp, esp
.text:0040DDDF		       sub     esp, 48h
.text:0040DDE2		       mov     eax, ___security_cookie
.text:0040DDE7		       xor     eax, ebp
.text:0040DDE9		       mov     [ebp+var_4], eax
.text:0040DDEC		       push    ebx
.text:0040DDED		       xor     ebx, ebx
.text:0040DDEF		       push    esi
.text:0040DDF0		       mov     esi, [ebp+ploci]
.text:0040DDF3		       cmp     [esi+14h], ebx
.text:0040DDF6		       push    edi
.text:0040DDF7		       mov     [ebp+refcount], ebx
.text:0040DDFA		       mov     [ebp+newctype1],	ebx
.text:0040DDFD		       mov     [ebp+newclmap], ebx
.text:0040DE00		       mov     [ebp+newcumap], ebx
.text:0040DE03		       mov     [ebp+cbuffer], ebx
.text:0040DE06		       mov     [ebp+locinfo.locinfo], esi
.text:0040DE09		       mov     [ebp+locinfo.mbcinfo], ebx
.text:0040DE0C		       jz      loc_40E11D
.text:0040DE12		       lea     eax, [esi+4]
.text:0040DE15		       cmp     [eax], ebx
.text:0040DE17		       jnz     short loc_40DE39
.text:0040DE19		       push    eax	       ; address
.text:0040DE1A		       movzx   eax, word ptr [esi+30h]
.text:0040DE1E		       push    1004h	       ; fieldtype
.text:0040DE23		       push    eax	       ; localehandle
.text:0040DE24		       lea     eax, [ebp+locinfo]
.text:0040DE27		       push    ebx	       ; lc_type
.text:0040DE28		       push    eax	       ; plocinfo
.text:0040DE29		       call    ___getlocaleinfo
.text:0040DE2E		       add     esp, 14h
.text:0040DE31		       test    eax, eax
.text:0040DE33		       jnz     error_cleanup_2
.text:0040DE39
.text:0040DE39 loc_40DE39:			       ; CODE XREF: ___init_ctype+3Bj
.text:0040DE39		       push    4	       ; cb
.text:0040DE3B		       call    __malloc_crt
.text:0040DE40		       push    2	       ; size
.text:0040DE42		       mov     edi, 180h
.text:0040DE47		       push    edi	       ; count
.text:0040DE48		       mov     [ebp+refcount], eax
.text:0040DE4B		       call    __calloc_crt
.text:0040DE50		       push    1	       ; size
.text:0040DE52		       push    edi	       ; count
.text:0040DE53		       mov     [ebp+newctype1],	eax
.text:0040DE56		       call    __calloc_crt
.text:0040DE5B		       push    1	       ; size
.text:0040DE5D		       push    edi	       ; count
.text:0040DE5E		       mov     [ebp+newclmap], eax
.text:0040DE61		       call    __calloc_crt
.text:0040DE66		       push    1	       ; size
.text:0040DE68		       push    101h	       ; count
.text:0040DE6D		       mov     [ebp+newcumap], eax
.text:0040DE70		       call    __calloc_crt
.text:0040DE75		       add     esp, 24h
.text:0040DE78		       cmp     [ebp+refcount], ebx
.text:0040DE7B		       mov     [ebp+cbuffer], eax
.text:0040DE7E		       jz      error_cleanup_2
.text:0040DE84		       cmp     [ebp+newctype1],	ebx
.text:0040DE87		       jz      error_cleanup_2
.text:0040DE8D		       cmp     eax, ebx
.text:0040DE8F		       jz      error_cleanup_2
.text:0040DE95		       cmp     [ebp+newclmap], ebx
.text:0040DE98		       jz      error_cleanup_2
.text:0040DE9E		       cmp     [ebp+newcumap], ebx
.text:0040DEA1		       jz      error_cleanup_2
.text:0040DEA7		       mov     eax, [ebp+refcount]
.text:0040DEAA		       mov     [eax], ebx
.text:0040DEAC		       xor     eax, eax
.text:0040DEAE
.text:0040DEAE loc_40DEAE:			       ; CODE XREF: ___init_ctype+DEj
.text:0040DEAE		       mov     ecx, [ebp+cbuffer]
.text:0040DEB1		       mov     [eax+ecx], al
.text:0040DEB4		       inc     eax
.text:0040DEB5		       cmp     eax, 100h
.text:0040DEBA		       jl      short loc_40DEAE
.text:0040DEBC		       lea     eax, [ebp+lpCPInfo]
.text:0040DEBF		       push    eax	       ; lpCPInfo
.text:0040DEC0		       push    dword ptr [esi+4] ; CodePage
.text:0040DEC3		       call    ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:0040DEC9		       test    eax, eax
.text:0040DECB		       jz      error_cleanup_2
.text:0040DED1		       cmp     [ebp+lpCPInfo.MaxCharSize], 5
.text:0040DED5		       ja      error_cleanup_2
.text:0040DEDB		       movzx   eax, word ptr [ebp+lpCPInfo.MaxCharSize]
.text:0040DEDF		       cmp     eax, 1
.text:0040DEE2		       mov     [ebp+mb_cur_max], eax
.text:0040DEE5		       jle     short loc_40DF14
.text:0040DEE7		       cmp     [ebp+lpCPInfo.LeadByte],	bl
.text:0040DEEA		       jz      short loc_40DF14
.text:0040DEEC		       lea     eax, [ebp+lpCPInfo.LeadByte+1]
.text:0040DEEF
.text:0040DEEF loc_40DEEF:			       ; CODE XREF: ___init_ctype+136j
.text:0040DEEF		       mov     cl, [eax]
.text:0040DEF1		       cmp     cl, bl
.text:0040DEF3		       jz      short loc_40DF14
.text:0040DEF5		       movzx   edi, byte ptr [eax-1]
.text:0040DEF9		       movzx   ecx, cl
.text:0040DEFC		       jmp     short loc_40DF09
.text:0040DEFE ; ---------------------------------------------------------------------------
.text:0040DEFE
.text:0040DEFE loc_40DEFE:			       ; CODE XREF: ___init_ctype+12Fj
.text:0040DEFE		       mov     ecx, [ebp+cbuffer]
.text:0040DF01		       mov     byte ptr	[edi+ecx], 20h
.text:0040DF05		       movzx   ecx, byte ptr [eax]
.text:0040DF08		       inc     edi
.text:0040DF09
.text:0040DF09 loc_40DF09:			       ; CODE XREF: ___init_ctype+120j
.text:0040DF09		       cmp     edi, ecx
.text:0040DF0B		       jle     short loc_40DEFE
.text:0040DF0D		       inc     eax
.text:0040DF0E		       inc     eax
.text:0040DF0F		       cmp     [eax-1],	bl
.text:0040DF12		       jnz     short loc_40DEEF
.text:0040DF14
.text:0040DF14 loc_40DF14:			       ; CODE XREF: ___init_ctype+109j
.text:0040DF14					       ; ___init_ctype+10Ej ...
.text:0040DF14		       mov     eax, [ebp+newctype1]
.text:0040DF17		       push    ebx	       ; bError
.text:0040DF18		       push    ebx	       ; lcid
.text:0040DF19		       push    dword ptr [esi+4] ; code_page
.text:0040DF1C		       add     eax, 100h
.text:0040DF21		       push    eax	       ; lpCharType
.text:0040DF22		       push    100h	       ; cchSrc
.text:0040DF27		       push    [ebp+cbuffer]   ; lpSrcStr
.text:0040DF2A		       mov     [ebp+var_3C], eax
.text:0040DF2D		       push    1	       ; dwInfoType
.text:0040DF2F		       push    ebx	       ; plocinfo
.text:0040DF30		       call    ___crtGetStringTypeA
.text:0040DF35		       add     esp, 20h
.text:0040DF38		       test    eax, eax
.text:0040DF3A		       jz      error_cleanup_2
.text:0040DF40		       mov     ecx, [ebp+newclmap]
.text:0040DF43		       mov     eax, [ebp+cbuffer]
.text:0040DF46		       push    ebx	       ; bError
.text:0040DF47		       push    dword ptr [esi+4] ; code_page
.text:0040DF4A		       mov     edi, 0FFh
.text:0040DF4F		       push    edi	       ; cchDest
.text:0040DF50		       add     ecx, 81h
.text:0040DF56		       push    ecx	       ; lpDestStr
.text:0040DF57		       push    edi	       ; cchSrc
.text:0040DF58		       inc     eax
.text:0040DF59		       push    eax	       ; lpSrcStr
.text:0040DF5A		       push    100h	       ; dwMapFlags
.text:0040DF5F		       push    dword ptr [esi+14h] ; Locale
.text:0040DF62		       push    ebx	       ; plocinfo
.text:0040DF63		       call    ___crtLCMapStringA
.text:0040DF68		       add     esp, 24h
.text:0040DF6B		       test    eax, eax
.text:0040DF6D		       jz      error_cleanup_2
.text:0040DF73		       mov     eax, [ebp+newcumap]
.text:0040DF76		       push    ebx	       ; bError
.text:0040DF77		       push    dword ptr [esi+4] ; code_page
.text:0040DF7A		       add     eax, 81h
.text:0040DF7F		       push    edi	       ; cchDest
.text:0040DF80		       push    eax	       ; lpDestStr
.text:0040DF81		       mov     eax, [ebp+cbuffer]
.text:0040DF84		       push    edi	       ; cchSrc
.text:0040DF85		       inc     eax
.text:0040DF86		       push    eax	       ; lpSrcStr
.text:0040DF87		       push    200h	       ; dwMapFlags
.text:0040DF8C		       push    dword ptr [esi+14h] ; Locale
.text:0040DF8F		       push    ebx	       ; plocinfo
.text:0040DF90		       call    ___crtLCMapStringA
.text:0040DF95		       add     esp, 24h
.text:0040DF98		       test    eax, eax
.text:0040DF9A		       jz      error_cleanup_2
.text:0040DFA0		       cmp     [ebp+mb_cur_max], 1
.text:0040DFA4		       mov     eax, [ebp+newctype1]
.text:0040DFA7		       mov     edi, [ebp+newclmap]
.text:0040DFAA		       mov     edx, [ebp+newcumap]
.text:0040DFAD		       lea     ecx, [eax+0FEh]
.text:0040DFB3		       mov     [ecx], bx
.text:0040DFB6		       mov     [ebp+var_38], ecx
.text:0040DFB9		       lea     ecx, [edi+80h]
.text:0040DFBF		       mov     [edi+7Fh], bl
.text:0040DFC2		       mov     [edx+7Fh], bl
.text:0040DFC5		       mov     [ecx], bl
.text:0040DFC7		       mov     [ebp+var_40], ecx
.text:0040DFCA		       lea     ecx, [edx+80h]
.text:0040DFD0		       mov     [ebp+var_34], ecx
.text:0040DFD3		       mov     [ecx], bl
.text:0040DFD5		       jle     short loc_40E021
.text:0040DFD7		       cmp     [ebp+lpCPInfo.LeadByte],	bl
.text:0040DFDA		       jz      short loc_40E021
.text:0040DFDC		       lea     ecx, [ebp+lpCPInfo.LeadByte+1]
.text:0040DFDF		       mov     [ebp+newclmap], ecx
.text:0040DFE2
.text:0040DFE2 loc_40DFE2:			       ; CODE XREF: ___init_ctype+243j
.text:0040DFE2		       mov     dl, [ecx]
.text:0040DFE4		       cmp     dl, bl
.text:0040DFE6		       jz      short loc_40E021
.text:0040DFE8		       movzx   ecx, byte ptr [ecx-1]
.text:0040DFEC		       movzx   edx, dl
.text:0040DFEF		       cmp     ecx, edx
.text:0040DFF1		       jg      short loc_40E014
.text:0040DFF3		       lea     edx, [eax+ecx*2+100h]
.text:0040DFFA		       jmp     short loc_40DFFF
.text:0040DFFC ; ---------------------------------------------------------------------------
.text:0040DFFC
.text:0040DFFC loc_40DFFC:			       ; CODE XREF: ___init_ctype+236j
.text:0040DFFC		       mov     edx, [ebp+newctype1]
.text:0040DFFF
.text:0040DFFF loc_40DFFF:			       ; CODE XREF: ___init_ctype+21Ej
.text:0040DFFF		       mov     word ptr	[edx], 8000h
.text:0040E004		       inc     ecx
.text:0040E005		       inc     edx
.text:0040E006		       inc     edx
.text:0040E007		       mov     [ebp+newctype1],	edx
.text:0040E00A		       mov     edx, [ebp+newclmap]
.text:0040E00D		       movzx   edx, byte ptr [edx]
.text:0040E010		       cmp     ecx, edx
.text:0040E012		       jle     short loc_40DFFC
.text:0040E014
.text:0040E014 loc_40E014:			       ; CODE XREF: ___init_ctype+215j
.text:0040E014		       mov     ecx, [ebp+newclmap]
.text:0040E017		       inc     ecx
.text:0040E018		       inc     ecx
.text:0040E019		       cmp     [ecx-1],	bl
.text:0040E01C		       mov     [ebp+newclmap], ecx
.text:0040E01F		       jnz     short loc_40DFE2
.text:0040E021
.text:0040E021 loc_40E021:			       ; CODE XREF: ___init_ctype+1F9j
.text:0040E021					       ; ___init_ctype+1FEj ...
.text:0040E021		       push    0FEh	       ; count
.text:0040E026		       lea     ecx, [eax+200h]
.text:0040E02C		       push    ecx	       ; src
.text:0040E02D		       push    eax	       ; dst
.text:0040E02E		       call    _memcpy
.text:0040E033		       push    7Fh	       ; count
.text:0040E035		       lea     eax, [edi+100h]
.text:0040E03B		       push    eax	       ; src
.text:0040E03C		       push    edi	       ; dst
.text:0040E03D		       call    _memcpy
.text:0040E042		       mov     eax, [ebp+newcumap]
.text:0040E045		       push    7Fh	       ; count
.text:0040E047		       lea     ecx, [eax+100h]
.text:0040E04D		       push    ecx	       ; src
.text:0040E04E		       push    eax	       ; dst
.text:0040E04F		       call    _memcpy
.text:0040E054		       mov     eax, [esi+0C0h]
.text:0040E05A		       add     esp, 24h
.text:0040E05D		       cmp     eax, ebx
.text:0040E05F		       jz      short loc_40E0AC
.text:0040E061		       push    eax	       ; lpAddend
.text:0040E062		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040E068		       test    eax, eax
.text:0040E06A		       jnz     short loc_40E0AC
.text:0040E06C		       mov     eax, [esi+0C4h]
.text:0040E072		       sub     eax, 0FEh
.text:0040E077		       push    eax	       ; pBlock
.text:0040E078		       call    _free
.text:0040E07D		       mov     eax, [esi+0CCh]
.text:0040E083		       mov     edi, 80h
.text:0040E088		       sub     eax, edi
.text:0040E08A		       push    eax	       ; pBlock
.text:0040E08B		       call    _free
.text:0040E090		       mov     eax, [esi+0D0h]
.text:0040E096		       sub     eax, edi
.text:0040E098		       push    eax	       ; pBlock
.text:0040E099		       call    _free
.text:0040E09E		       push    dword ptr [esi+0C0h] ; pBlock
.text:0040E0A4		       call    _free
.text:0040E0A9		       add     esp, 10h
.text:0040E0AC
.text:0040E0AC loc_40E0AC:			       ; CODE XREF: ___init_ctype+283j
.text:0040E0AC					       ; ___init_ctype+28Ej
.text:0040E0AC		       mov     eax, [ebp+refcount]
.text:0040E0AF		       mov     dword ptr [eax],	1
.text:0040E0B5		       mov     [esi+0C0h], eax
.text:0040E0BB		       mov     eax, [ebp+var_3C]
.text:0040E0BE		       mov     [esi+0C8h], eax
.text:0040E0C4		       mov     eax, [ebp+var_38]
.text:0040E0C7		       mov     [esi+0C4h], eax
.text:0040E0CD		       mov     eax, [ebp+var_40]
.text:0040E0D0		       mov     [esi+0CCh], eax
.text:0040E0D6		       mov     eax, [ebp+var_34]
.text:0040E0D9		       mov     [esi+0D0h], eax
.text:0040E0DF		       mov     eax, [ebp+mb_cur_max]
.text:0040E0E2		       mov     [esi+0ACh], eax
.text:0040E0E8
.text:0040E0E8 loc_40E0E8:			       ; CODE XREF: ___init_ctype+33Fj
.text:0040E0E8		       push    [ebp+cbuffer]   ; pBlock
.text:0040E0EB		       call    _free
.text:0040E0F0		       pop     ecx
.text:0040E0F1		       mov     eax, ebx
.text:0040E0F3		       jmp     short loc_40E162
.text:0040E0F5 ; ---------------------------------------------------------------------------
.text:0040E0F5
.text:0040E0F5 error_cleanup_2:			       ; CODE XREF: ___init_ctype+57j
.text:0040E0F5					       ; ___init_ctype+A2j ...
.text:0040E0F5		       push    [ebp+refcount]  ; pBlock
.text:0040E0F8		       call    _free
.text:0040E0FD		       push    [ebp+newctype1] ; pBlock
.text:0040E100		       call    _free
.text:0040E105		       push    [ebp+newclmap]  ; pBlock
.text:0040E108		       call    _free
.text:0040E10D		       push    [ebp+newcumap]  ; pBlock
.text:0040E110		       call    _free
.text:0040E115		       xor     ebx, ebx
.text:0040E117		       add     esp, 10h
.text:0040E11A		       inc     ebx
.text:0040E11B		       jmp     short loc_40E0E8
.text:0040E11D ; ---------------------------------------------------------------------------
.text:0040E11D
.text:0040E11D loc_40E11D:			       ; CODE XREF: ___init_ctype+30j
.text:0040E11D		       lea     edi, [esi+0C0h]
.text:0040E123		       mov     eax, [edi]
.text:0040E125		       cmp     eax, ebx
.text:0040E127		       jz      short loc_40E130
.text:0040E129		       push    eax	       ; lpAddend
.text:0040E12A		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040E130
.text:0040E130 loc_40E130:			       ; CODE XREF: ___init_ctype+34Bj
.text:0040E130		       mov     [edi], ebx
.text:0040E132		       mov     [esi+0C4h], ebx
.text:0040E138		       mov     dword ptr [esi+0C8h], offset asc_41E690 ; "	   (((((		  H"
.text:0040E142		       mov     dword ptr [esi+0CCh], offset dword_41EB18
.text:0040E14C		       mov     dword ptr [esi+0D0h], offset dword_41EC98
.text:0040E156		       mov     dword ptr [esi+0ACh], 1
.text:0040E160		       xor     eax, eax
.text:0040E162
.text:0040E162 loc_40E162:			       ; CODE XREF: ___init_ctype+317j
.text:0040E162		       mov     ecx, [ebp+var_4]
.text:0040E165		       pop     edi
.text:0040E166		       pop     esi
.text:0040E167		       xor     ecx, ebp
.text:0040E169		       pop     ebx
.text:0040E16A		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040E16F		       leave
.text:0040E170		       retn
.text:0040E170 ___init_ctype   endp
.text:0040E170
.text:0040E171
.text:0040E171 ; =============== S U B R O U T I N E =======================================
.text:0040E171
.text:0040E171
.text:0040E171 ; int __cdecl ___mb_cur_max_func()
.text:0040E171 ____mb_cur_max_func proc	near	       ; CODE XREF: _wctomb+Dp
.text:0040E171					       ; ____mb_cur_max_l_func+8j
.text:0040E171		       call    __getptd
.text:0040E176		       mov     ecx, eax
.text:0040E178		       mov     eax, [ecx+6Ch]
.text:0040E17B		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040E181		       jz      short loc_40E193
.text:0040E183		       mov     edx, ___globallocalestatus
.text:0040E189		       test    [ecx+70h], edx
.text:0040E18C		       jnz     short loc_40E193
.text:0040E18E		       call    ___updatetlocinfo
.text:0040E193
.text:0040E193 loc_40E193:			       ; CODE XREF: ____mb_cur_max_func+10j
.text:0040E193					       ; ____mb_cur_max_func+1Bj
.text:0040E193		       mov     eax, [eax+0ACh]
.text:0040E199		       retn
.text:0040E199 ____mb_cur_max_func endp
.text:0040E199
.text:0040E19A
.text:0040E19A ; =============== S U B R O U T I N E =======================================
.text:0040E19A
.text:0040E19A
.text:0040E19A ; int __cdecl ___mb_cur_max_l_func(localeinfo_struct *loc)
.text:0040E19A ____mb_cur_max_l_func proc near
.text:0040E19A
.text:0040E19A loc	       = dword ptr  4
.text:0040E19A
.text:0040E19A		       mov     eax, [esp+loc]
.text:0040E19E		       test    eax, eax
.text:0040E1A0		       jnz     short loc_40E1A7
.text:0040E1A2		       jmp     ____mb_cur_max_func
.text:0040E1A7 ; ---------------------------------------------------------------------------
.text:0040E1A7
.text:0040E1A7 loc_40E1A7:			       ; CODE XREF: ____mb_cur_max_l_func+6j
.text:0040E1A7		       mov     eax, [eax]
.text:0040E1A9		       mov     eax, [eax+0ACh]
.text:0040E1AF		       retn
.text:0040E1AF ____mb_cur_max_l_func endp
.text:0040E1AF
.text:0040E1B0
.text:0040E1B0 ; =============== S U B R O U T I N E =======================================
.text:0040E1B0
.text:0040E1B0
.text:0040E1B0 ; unsigned int __cdecl ___lc_codepage_func()
.text:0040E1B0 ____lc_codepage_func proc near	       ; CODE XREF: _tzset_nolock:loc_414050p
.text:0040E1B0		       call    __getptd
.text:0040E1B5		       mov     ecx, eax
.text:0040E1B7		       mov     eax, [ecx+6Ch]
.text:0040E1BA		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040E1C0		       jz      short loc_40E1D2
.text:0040E1C2		       mov     edx, ___globallocalestatus
.text:0040E1C8		       test    [ecx+70h], edx
.text:0040E1CB		       jnz     short loc_40E1D2
.text:0040E1CD		       call    ___updatetlocinfo
.text:0040E1D2
.text:0040E1D2 loc_40E1D2:			       ; CODE XREF: ____lc_codepage_func+10j
.text:0040E1D2					       ; ____lc_codepage_func+1Bj
.text:0040E1D2		       mov     eax, [eax+4]
.text:0040E1D5		       retn
.text:0040E1D5 ____lc_codepage_func endp
.text:0040E1D5
.text:0040E1D6
.text:0040E1D6 ; =============== S U B R O U T I N E =======================================
.text:0040E1D6
.text:0040E1D6
.text:0040E1D6 ; unsigned int __cdecl ___lc_collate_cp_func()
.text:0040E1D6 ____lc_collate_cp_func proc near
.text:0040E1D6		       call    __getptd
.text:0040E1DB		       mov     ecx, eax
.text:0040E1DD		       mov     eax, [ecx+6Ch]
.text:0040E1E0		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040E1E6		       jz      short loc_40E1F8
.text:0040E1E8		       mov     edx, ___globallocalestatus
.text:0040E1EE		       test    [ecx+70h], edx
.text:0040E1F1		       jnz     short loc_40E1F8
.text:0040E1F3		       call    ___updatetlocinfo
.text:0040E1F8
.text:0040E1F8 loc_40E1F8:			       ; CODE XREF: ____lc_collate_cp_func+10j
.text:0040E1F8					       ; ____lc_collate_cp_func+1Bj
.text:0040E1F8		       mov     eax, [eax+8]
.text:0040E1FB		       retn
.text:0040E1FB ____lc_collate_cp_func endp
.text:0040E1FB
.text:0040E1FC
.text:0040E1FC ; =============== S U B R O U T I N E =======================================
.text:0040E1FC
.text:0040E1FC
.text:0040E1FC ; unsigned int *__cdecl ___lc_handle_func()
.text:0040E1FC ____lc_handle_func proc near
.text:0040E1FC		       call    __getptd
.text:0040E201		       mov     ecx, eax
.text:0040E203		       mov     eax, [ecx+6Ch]
.text:0040E206		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040E20C		       jz      short loc_40E21E
.text:0040E20E		       mov     edx, ___globallocalestatus
.text:0040E214		       test    [ecx+70h], edx
.text:0040E217		       jnz     short loc_40E21E
.text:0040E219		       call    ___updatetlocinfo
.text:0040E21E
.text:0040E21E loc_40E21E:			       ; CODE XREF: ____lc_handle_func+10j
.text:0040E21E					       ; ____lc_handle_func+1Bj
.text:0040E21E		       add     eax, 0Ch
.text:0040E221		       retn
.text:0040E221 ____lc_handle_func endp
.text:0040E221
.text:0040E222
.text:0040E222 ; =============== S U B R O U T I N E =======================================
.text:0040E222
.text:0040E222
.text:0040E222 ; int __cdecl __init_collate(threadlocaleinfostruct *ploci)
.text:0040E222 ___init_collate proc near	       ; DATA XREF: .rdata:0041E3ECo
.text:0040E222
.text:0040E222 ploci	       = dword ptr  4
.text:0040E222
.text:0040E222		       xor     eax, eax
.text:0040E224		       retn
.text:0040E224 ___init_collate endp
.text:0040E224
.text:0040E225
.text:0040E225 ; =============== S U B R O U T I N E =======================================
.text:0040E225
.text:0040E225 ; Attributes: bp-based frame
.text:0040E225
.text:0040E225 ; char *__cdecl _Getdays_l(localeinfo_struct *plocinfo)
.text:0040E225 __Getdays_l     proc near	       ; CODE XREF: __Getdays+2p
.text:0040E225
.text:0040E225 _loc_update     = _LocaleUpdate ptr -18h
.text:0040E225 p	       = dword ptr -8
.text:0040E225 n	       = dword ptr -4
.text:0040E225 plocinfo	       = dword ptr  8
.text:0040E225
.text:0040E225		       push    ebp
.text:0040E226		       mov     ebp, esp
.text:0040E228		       sub     esp, 18h
.text:0040E22B		       push    ebx
.text:0040E22C		       push    esi
.text:0040E22D		       push    edi
.text:0040E22E		       push    [ebp+plocinfo]  ; plocinfo
.text:0040E231		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040E234		       xor     ebx, ebx
.text:0040E236		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040E23B		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040E23E		       mov     edi, [eax+0D4h]
.text:0040E244		       mov     [ebp+n],	ebx
.text:0040E247
.text:0040E247 loc_40E247:			       ; CODE XREF: __Getdays_l+4Ej
.text:0040E247		       mov     esi, [ebp+n]
.text:0040E24A		       shl     esi, 2
.text:0040E24D		       push    dword ptr [esi+edi+1Ch] ; buf
.text:0040E251		       call    _strlen
.text:0040E256		       push    dword ptr [esi+edi] ; buf
.text:0040E259		       mov     [ebp+p],	eax
.text:0040E25C		       call    _strlen
.text:0040E261		       add     eax, ebx
.text:0040E263		       inc     [ebp+n]
.text:0040E266		       cmp     [ebp+n],	7
.text:0040E26A		       pop     ecx
.text:0040E26B		       pop     ecx
.text:0040E26C		       mov     ecx, [ebp+p]
.text:0040E26F		       lea     ebx, [eax+ecx+2]
.text:0040E273		       jb      short loc_40E247
.text:0040E275		       lea     eax, [ebx+1]
.text:0040E278		       push    eax	       ; cb
.text:0040E279		       call    __malloc_crt
.text:0040E27E		       mov     esi, eax
.text:0040E280		       test    esi, esi
.text:0040E282		       pop     ecx
.text:0040E283		       mov     [ebp+p],	esi
.text:0040E286		       jz      loc_40E30E
.text:0040E28C		       and     [ebp+n],	0
.text:0040E290
.text:0040E290 loc_40E290:			       ; CODE XREF: __Getdays_l+E4j
.text:0040E290		       mov     eax, [ebp+n]
.text:0040E293		       mov     byte ptr	[esi], 3Ah
.text:0040E296		       push    dword ptr [edi+eax*4] ; _Src
.text:0040E299		       mov     eax, [ebp+p]
.text:0040E29C		       inc     esi
.text:0040E29D		       sub     eax, esi
.text:0040E29F		       lea     eax, [eax+ebx+1]
.text:0040E2A3		       push    eax	       ; _SizeInBytes
.text:0040E2A4		       push    esi	       ; _Dst
.text:0040E2A5		       call    _strcpy_s
.text:0040E2AA		       add     esp, 0Ch
.text:0040E2AD		       test    eax, eax
.text:0040E2AF		       jz      short loc_40E2C0
.text:0040E2B1		       xor     eax, eax
.text:0040E2B3		       push    eax	       ; pReserved
.text:0040E2B4		       push    eax	       ; nLine
.text:0040E2B5		       push    eax	       ; pszFile
.text:0040E2B6		       push    eax	       ; pszFunction
.text:0040E2B7		       push    eax	       ; pszExpression
.text:0040E2B8		       call    __invoke_watson
.text:0040E2BD		       add     esp, 14h
.text:0040E2C0
.text:0040E2C0 loc_40E2C0:			       ; CODE XREF: __Getdays_l+8Aj
.text:0040E2C0		       push    esi	       ; buf
.text:0040E2C1		       call    _strlen
.text:0040E2C6		       add     esi, eax
.text:0040E2C8		       mov     eax, [ebp+n]
.text:0040E2CB		       mov     byte ptr	[esi], 3Ah
.text:0040E2CE		       push    dword ptr [edi+eax*4+1Ch] ; _Src
.text:0040E2D2		       mov     eax, [ebp+p]
.text:0040E2D5		       inc     esi
.text:0040E2D6		       sub     eax, esi
.text:0040E2D8		       lea     eax, [eax+ebx+1]
.text:0040E2DC		       push    eax	       ; _SizeInBytes
.text:0040E2DD		       push    esi	       ; _Dst
.text:0040E2DE		       call    _strcpy_s
.text:0040E2E3		       add     esp, 10h
.text:0040E2E6		       test    eax, eax
.text:0040E2E8		       jz      short loc_40E2F9
.text:0040E2EA		       xor     eax, eax
.text:0040E2EC		       push    eax	       ; pReserved
.text:0040E2ED		       push    eax	       ; nLine
.text:0040E2EE		       push    eax	       ; pszFile
.text:0040E2EF		       push    eax	       ; pszFunction
.text:0040E2F0		       push    eax	       ; pszExpression
.text:0040E2F1		       call    __invoke_watson
.text:0040E2F6		       add     esp, 14h
.text:0040E2F9
.text:0040E2F9 loc_40E2F9:			       ; CODE XREF: __Getdays_l+C3j
.text:0040E2F9		       push    esi	       ; buf
.text:0040E2FA		       call    _strlen
.text:0040E2FF		       add     esi, eax
.text:0040E301		       inc     [ebp+n]
.text:0040E304		       cmp     [ebp+n],	7
.text:0040E308		       pop     ecx
.text:0040E309		       jb      short loc_40E290
.text:0040E30B		       mov     byte ptr	[esi], 0
.text:0040E30E
.text:0040E30E loc_40E30E:			       ; CODE XREF: __Getdays_l+61j
.text:0040E30E		       cmp     [ebp+_loc_update.updated], 0
.text:0040E312		       pop     edi
.text:0040E313		       pop     esi
.text:0040E314		       pop     ebx
.text:0040E315		       jz      short loc_40E31E
.text:0040E317		       mov     eax, [ebp+_loc_update.ptd]
.text:0040E31A		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040E31E
.text:0040E31E loc_40E31E:			       ; CODE XREF: __Getdays_l+F0j
.text:0040E31E		       mov     eax, [ebp+p]
.text:0040E321		       leave
.text:0040E322		       retn
.text:0040E322 __Getdays_l     endp
.text:0040E322
.text:0040E323
.text:0040E323 ; =============== S U B R O U T I N E =======================================
.text:0040E323
.text:0040E323
.text:0040E323 ; char *__cdecl _Getdays()
.text:0040E323 __Getdays       proc near
.text:0040E323		       push    0	       ; plocinfo
.text:0040E325		       call    __Getdays_l
.text:0040E32A		       pop     ecx
.text:0040E32B		       retn
.text:0040E32B __Getdays       endp
.text:0040E32B
.text:0040E32C
.text:0040E32C ; =============== S U B R O U T I N E =======================================
.text:0040E32C
.text:0040E32C ; Attributes: bp-based frame
.text:0040E32C
.text:0040E32C ; char *__cdecl _Getmonths_l(localeinfo_struct *plocinfo)
.text:0040E32C __Getmonths_l   proc near	       ; CODE XREF: __Getmonths+2p
.text:0040E32C
.text:0040E32C _loc_update     = _LocaleUpdate ptr -1Ch
.text:0040E32C var_C	       = dword ptr -0Ch
.text:0040E32C var_8	       = dword ptr -8
.text:0040E32C p	       = dword ptr -4
.text:0040E32C plocinfo	       = dword ptr  8
.text:0040E32C
.text:0040E32C		       push    ebp
.text:0040E32D		       mov     ebp, esp
.text:0040E32F		       sub     esp, 1Ch
.text:0040E332		       push    ebx
.text:0040E333		       push    esi
.text:0040E334		       push    edi
.text:0040E335		       push    [ebp+plocinfo]  ; plocinfo
.text:0040E338		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040E33B		       xor     ebx, ebx
.text:0040E33D		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040E342		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040E345		       mov     edi, [eax+0D4h]
.text:0040E34B		       lea     esi, [edi+38h]
.text:0040E34E		       mov     [ebp+p],	esi
.text:0040E351		       mov     [ebp+var_8], 0Ch
.text:0040E358
.text:0040E358 loc_40E358:			       ; CODE XREF: __Getmonths_l+55j
.text:0040E358		       push    dword ptr [esi+30h] ; buf
.text:0040E35B		       call    _strlen
.text:0040E360		       push    dword ptr [esi] ; buf
.text:0040E362		       mov     [ebp+var_C], eax
.text:0040E365		       call    _strlen
.text:0040E36A		       mov     esi, [ebp+p]
.text:0040E36D		       pop     ecx
.text:0040E36E		       pop     ecx
.text:0040E36F		       mov     ecx, [ebp+var_C]
.text:0040E372		       add     eax, ebx
.text:0040E374		       add     esi, 4
.text:0040E377		       dec     [ebp+var_8]
.text:0040E37A		       lea     ebx, [eax+ecx+2]
.text:0040E37E		       mov     [ebp+p],	esi
.text:0040E381		       jnz     short loc_40E358
.text:0040E383		       lea     eax, [ebx+1]
.text:0040E386		       push    eax	       ; cb
.text:0040E387		       call    __malloc_crt
.text:0040E38C		       mov     esi, eax
.text:0040E38E		       test    esi, esi
.text:0040E390		       pop     ecx
.text:0040E391		       mov     [ebp+p],	esi
.text:0040E394		       jz      short loc_40E415
.text:0040E396		       add     edi, 68h
.text:0040E399		       mov     [ebp+var_8], 0Ch
.text:0040E3A0
.text:0040E3A0 loc_40E3A0:			       ; CODE XREF: __Getmonths_l+E4j
.text:0040E3A0		       mov     eax, [ebp+p]
.text:0040E3A3		       mov     byte ptr	[esi], 3Ah
.text:0040E3A6		       push    dword ptr [edi-30h] ; _Src
.text:0040E3A9		       inc     esi
.text:0040E3AA		       sub     eax, esi
.text:0040E3AC		       lea     eax, [eax+ebx+1]
.text:0040E3B0		       push    eax	       ; _SizeInBytes
.text:0040E3B1		       push    esi	       ; _Dst
.text:0040E3B2		       call    _strcpy_s
.text:0040E3B7		       add     esp, 0Ch
.text:0040E3BA		       test    eax, eax
.text:0040E3BC		       jz      short loc_40E3CD
.text:0040E3BE		       xor     eax, eax
.text:0040E3C0		       push    eax	       ; pReserved
.text:0040E3C1		       push    eax	       ; nLine
.text:0040E3C2		       push    eax	       ; pszFile
.text:0040E3C3		       push    eax	       ; pszFunction
.text:0040E3C4		       push    eax	       ; pszExpression
.text:0040E3C5		       call    __invoke_watson
.text:0040E3CA		       add     esp, 14h
.text:0040E3CD
.text:0040E3CD loc_40E3CD:			       ; CODE XREF: __Getmonths_l+90j
.text:0040E3CD		       push    esi	       ; buf
.text:0040E3CE		       call    _strlen
.text:0040E3D3		       add     esi, eax
.text:0040E3D5		       mov     eax, [ebp+p]
.text:0040E3D8		       mov     byte ptr	[esi], 3Ah
.text:0040E3DB		       push    dword ptr [edi] ; _Src
.text:0040E3DD		       inc     esi
.text:0040E3DE		       sub     eax, esi
.text:0040E3E0		       lea     eax, [eax+ebx+1]
.text:0040E3E4		       push    eax	       ; _SizeInBytes
.text:0040E3E5		       push    esi	       ; _Dst
.text:0040E3E6		       call    _strcpy_s
.text:0040E3EB		       add     esp, 10h
.text:0040E3EE		       test    eax, eax
.text:0040E3F0		       jz      short loc_40E401
.text:0040E3F2		       xor     eax, eax
.text:0040E3F4		       push    eax	       ; pReserved
.text:0040E3F5		       push    eax	       ; nLine
.text:0040E3F6		       push    eax	       ; pszFile
.text:0040E3F7		       push    eax	       ; pszFunction
.text:0040E3F8		       push    eax	       ; pszExpression
.text:0040E3F9		       call    __invoke_watson
.text:0040E3FE		       add     esp, 14h
.text:0040E401
.text:0040E401 loc_40E401:			       ; CODE XREF: __Getmonths_l+C4j
.text:0040E401		       push    esi	       ; buf
.text:0040E402		       call    _strlen
.text:0040E407		       add     esi, eax
.text:0040E409		       add     edi, 4
.text:0040E40C		       dec     [ebp+var_8]
.text:0040E40F		       pop     ecx
.text:0040E410		       jnz     short loc_40E3A0
.text:0040E412		       mov     byte ptr	[esi], 0
.text:0040E415
.text:0040E415 loc_40E415:			       ; CODE XREF: __Getmonths_l+68j
.text:0040E415		       cmp     [ebp+_loc_update.updated], 0
.text:0040E419		       pop     edi
.text:0040E41A		       pop     esi
.text:0040E41B		       pop     ebx
.text:0040E41C		       jz      short loc_40E425
.text:0040E41E		       mov     eax, [ebp+_loc_update.ptd]
.text:0040E421		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040E425
.text:0040E425 loc_40E425:			       ; CODE XREF: __Getmonths_l+F0j
.text:0040E425		       mov     eax, [ebp+p]
.text:0040E428		       leave
.text:0040E429		       retn
.text:0040E429 __Getmonths_l   endp
.text:0040E429
.text:0040E42A
.text:0040E42A ; =============== S U B R O U T I N E =======================================
.text:0040E42A
.text:0040E42A
.text:0040E42A ; char *__cdecl _Getmonths()
.text:0040E42A __Getmonths     proc near
.text:0040E42A		       push    0	       ; plocinfo
.text:0040E42C		       call    __Getmonths_l
.text:0040E431		       pop     ecx
.text:0040E432		       retn
.text:0040E432 __Getmonths     endp
.text:0040E432
.text:0040E433
.text:0040E433 ; =============== S U B R O U T I N E =======================================
.text:0040E433
.text:0040E433 ; Attributes: bp-based frame
.text:0040E433
.text:0040E433 ; void *__cdecl _Gettnames_l(localeinfo_struct *plocinfo)
.text:0040E433 __Gettnames_l   proc near	       ; CODE XREF: __Gettnames+2p
.text:0040E433
.text:0040E433 _loc_update     = _LocaleUpdate ptr -24h
.text:0040E433 var_14	       = dword ptr -14h
.text:0040E433 var_10	       = dword ptr -10h
.text:0040E433 var_C	       = dword ptr -0Ch
.text:0040E433 len	       = dword ptr -8
.text:0040E433 n	       = dword ptr -4
.text:0040E433 plocinfo	       = dword ptr  8
.text:0040E433
.text:0040E433		       push    ebp
.text:0040E434		       mov     ebp, esp
.text:0040E436		       sub     esp, 24h
.text:0040E439		       push    ebx
.text:0040E43A		       push    esi
.text:0040E43B		       push    edi
.text:0040E43C		       push    [ebp+plocinfo]  ; plocinfo
.text:0040E43F		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040E442		       xor     edi, edi
.text:0040E444		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040E449		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040E44C		       mov     esi, [eax+0D4h]
.text:0040E452		       mov     [ebp+n],	edi
.text:0040E455
.text:0040E455 loc_40E455:			       ; CODE XREF: __Gettnames_l+4Ej
.text:0040E455		       mov     ebx, [ebp+n]
.text:0040E458		       shl     ebx, 2
.text:0040E45B		       push    dword ptr [ebx+esi+1Ch] ; buf
.text:0040E45F		       call    _strlen
.text:0040E464		       push    dword ptr [ebx+esi] ; buf
.text:0040E467		       mov     [ebp+var_14], eax
.text:0040E46A		       call    _strlen
.text:0040E46F		       add     eax, edi
.text:0040E471		       inc     [ebp+n]
.text:0040E474		       cmp     [ebp+n],	7
.text:0040E478		       pop     ecx
.text:0040E479		       pop     ecx
.text:0040E47A		       mov     ecx, [ebp+var_14]
.text:0040E47D		       lea     edi, [eax+ecx+2]
.text:0040E481		       jb      short loc_40E455
.text:0040E483		       lea     eax, [esi+38h]
.text:0040E486		       mov     [ebp+var_10], eax
.text:0040E489		       mov     [ebp+var_C], 0Ch
.text:0040E490
.text:0040E490 loc_40E490:			       ; CODE XREF: __Gettnames_l+84j
.text:0040E490		       mov     ebx, [ebp+var_10]
.text:0040E493		       push    dword ptr [ebx+30h] ; buf
.text:0040E496		       call    _strlen
.text:0040E49B		       push    dword ptr [ebx] ; buf
.text:0040E49D		       mov     [ebp+var_14], eax
.text:0040E4A0		       call    _strlen
.text:0040E4A5		       add     [ebp+var_10], 4
.text:0040E4A9		       pop     ecx
.text:0040E4AA		       pop     ecx
.text:0040E4AB		       mov     ecx, [ebp+var_14]
.text:0040E4AE		       add     eax, edi
.text:0040E4B0		       dec     [ebp+var_C]
.text:0040E4B3		       lea     edi, [eax+ecx+2]
.text:0040E4B7		       jnz     short loc_40E490
.text:0040E4B9		       push    dword ptr [esi+9Ch] ; buf
.text:0040E4BF		       call    _strlen
.text:0040E4C4		       push    dword ptr [esi+98h] ; buf
.text:0040E4CA		       mov     ebx, eax
.text:0040E4CC		       call    _strlen
.text:0040E4D1		       push    dword ptr [esi+0A0h] ; buf
.text:0040E4D7		       add     eax, edi
.text:0040E4D9		       lea     edi, [eax+ebx+2]
.text:0040E4DD		       call    _strlen
.text:0040E4E2		       push    dword ptr [esi+0A4h] ; buf
.text:0040E4E8		       lea     edi, [edi+eax+1]
.text:0040E4EC		       call    _strlen
.text:0040E4F1		       push    dword ptr [esi+0A8h] ; buf
.text:0040E4F7		       lea     edi, [edi+eax+1]
.text:0040E4FB		       call    _strlen
.text:0040E500		       lea     eax, [edi+eax+0B9h]
.text:0040E507		       push    eax	       ; cb
.text:0040E508		       mov     [ebp+len], eax
.text:0040E50B		       call    __malloc_crt
.text:0040E510		       mov     ebx, eax
.text:0040E512		       add     esp, 18h
.text:0040E515		       test    ebx, ebx
.text:0040E517		       jz      loc_40E774
.text:0040E51D		       push    0B8h	       ; count
.text:0040E522		       push    esi	       ; src
.text:0040E523		       push    ebx	       ; dst
.text:0040E524		       lea     edi, [ebx+0B8h]
.text:0040E52A		       call    _memcpy
.text:0040E52F		       and     [ebp+n],	0
.text:0040E533		       lea     eax, [esi+1Ch]
.text:0040E536		       mov     [ebp+var_10], ebx
.text:0040E539		       add     esp, 0Ch
.text:0040E53C		       sub     [ebp+var_10], esi
.text:0040E53F		       mov     [ebp+var_C], eax
.text:0040E542
.text:0040E542 loc_40E542:			       ; CODE XREF: __Gettnames_l+18Ej
.text:0040E542		       mov     eax, [ebp+n]
.text:0040E545		       mov     [ebx+eax*4], edi
.text:0040E548		       mov     eax, [ebp+var_C]
.text:0040E54B		       push    dword ptr [eax-1Ch] ; _Src
.text:0040E54E		       mov     eax, ebx
.text:0040E550		       sub     eax, edi
.text:0040E552		       add     eax, [ebp+len]
.text:0040E555		       push    eax	       ; _SizeInBytes
.text:0040E556		       push    edi	       ; _Dst
.text:0040E557		       call    _strcpy_s
.text:0040E55C		       add     esp, 0Ch
.text:0040E55F		       test    eax, eax
.text:0040E561		       jz      short loc_40E572
.text:0040E563		       xor     eax, eax
.text:0040E565		       push    eax	       ; pReserved
.text:0040E566		       push    eax	       ; nLine
.text:0040E567		       push    eax	       ; pszFile
.text:0040E568		       push    eax	       ; pszFunction
.text:0040E569		       push    eax	       ; pszExpression
.text:0040E56A		       call    __invoke_watson
.text:0040E56F		       add     esp, 14h
.text:0040E572
.text:0040E572 loc_40E572:			       ; CODE XREF: __Gettnames_l+12Ej
.text:0040E572		       push    edi	       ; buf
.text:0040E573		       call    _strlen
.text:0040E578		       mov     ecx, [ebp+var_10]
.text:0040E57B		       lea     edi, [edi+eax+1]
.text:0040E57F		       mov     eax, [ebp+var_C]
.text:0040E582		       mov     [ecx+eax], edi
.text:0040E585		       push    dword ptr [eax] ; _Src
.text:0040E587		       mov     eax, ebx
.text:0040E589		       sub     eax, edi
.text:0040E58B		       add     eax, [ebp+len]
.text:0040E58E		       push    eax	       ; _SizeInBytes
.text:0040E58F		       push    edi	       ; _Dst
.text:0040E590		       call    _strcpy_s
.text:0040E595		       add     esp, 10h
.text:0040E598		       test    eax, eax
.text:0040E59A		       jz      short loc_40E5AB
.text:0040E59C		       xor     eax, eax
.text:0040E59E		       push    eax	       ; pReserved
.text:0040E59F		       push    eax	       ; nLine
.text:0040E5A0		       push    eax	       ; pszFile
.text:0040E5A1		       push    eax	       ; pszFunction
.text:0040E5A2		       push    eax	       ; pszExpression
.text:0040E5A3		       call    __invoke_watson
.text:0040E5A8		       add     esp, 14h
.text:0040E5AB
.text:0040E5AB loc_40E5AB:			       ; CODE XREF: __Gettnames_l+167j
.text:0040E5AB		       push    edi	       ; buf
.text:0040E5AC		       call    _strlen
.text:0040E5B1		       inc     [ebp+n]
.text:0040E5B4		       add     [ebp+var_C], 4
.text:0040E5B8		       cmp     [ebp+n],	7
.text:0040E5BC		       pop     ecx
.text:0040E5BD		       lea     edi, [edi+eax+1]
.text:0040E5C1		       jb      loc_40E542
.text:0040E5C7		       lea     eax, [ebx+68h]
.text:0040E5CA		       mov     [ebp+n],	eax
.text:0040E5CD		       lea     eax, [esi+38h]
.text:0040E5D0		       mov     [ebp+var_C], eax
.text:0040E5D3		       mov     [ebp+var_14], 0Ch
.text:0040E5DA		       jmp     short loc_40E5DF
.text:0040E5DC ; ---------------------------------------------------------------------------
.text:0040E5DC
.text:0040E5DC loc_40E5DC:			       ; CODE XREF: __Gettnames_l+227j
.text:0040E5DC		       mov     eax, [ebp+var_C]
.text:0040E5DF
.text:0040E5DF loc_40E5DF:			       ; CODE XREF: __Gettnames_l+1A7j
.text:0040E5DF		       mov     ecx, [ebp+var_10]
.text:0040E5E2		       mov     [eax+ecx], edi
.text:0040E5E5		       push    dword ptr [eax] ; _Src
.text:0040E5E7		       mov     eax, ebx
.text:0040E5E9		       sub     eax, edi
.text:0040E5EB		       add     eax, [ebp+len]
.text:0040E5EE		       push    eax	       ; _SizeInBytes
.text:0040E5EF		       push    edi	       ; _Dst
.text:0040E5F0		       call    _strcpy_s
.text:0040E5F5		       add     esp, 0Ch
.text:0040E5F8		       test    eax, eax
.text:0040E5FA		       jz      short loc_40E60B
.text:0040E5FC		       xor     eax, eax
.text:0040E5FE		       push    eax	       ; pReserved
.text:0040E5FF		       push    eax	       ; nLine
.text:0040E600		       push    eax	       ; pszFile
.text:0040E601		       push    eax	       ; pszFunction
.text:0040E602		       push    eax	       ; pszExpression
.text:0040E603		       call    __invoke_watson
.text:0040E608		       add     esp, 14h
.text:0040E60B
.text:0040E60B loc_40E60B:			       ; CODE XREF: __Gettnames_l+1C7j
.text:0040E60B		       push    edi	       ; buf
.text:0040E60C		       call    _strlen
.text:0040E611		       lea     edi, [edi+eax+1]
.text:0040E615		       mov     eax, [ebp+n]
.text:0040E618		       mov     [eax], edi
.text:0040E61A		       mov     eax, [ebp+var_C]
.text:0040E61D		       push    dword ptr [eax+30h] ; _Src
.text:0040E620		       mov     eax, ebx
.text:0040E622		       sub     eax, edi
.text:0040E624		       add     eax, [ebp+len]
.text:0040E627		       push    eax	       ; _SizeInBytes
.text:0040E628		       push    edi	       ; _Dst
.text:0040E629		       call    _strcpy_s
.text:0040E62E		       add     esp, 10h
.text:0040E631		       test    eax, eax
.text:0040E633		       jz      short loc_40E644
.text:0040E635		       xor     eax, eax
.text:0040E637		       push    eax	       ; pReserved
.text:0040E638		       push    eax	       ; nLine
.text:0040E639		       push    eax	       ; pszFile
.text:0040E63A		       push    eax	       ; pszFunction
.text:0040E63B		       push    eax	       ; pszExpression
.text:0040E63C		       call    __invoke_watson
.text:0040E641		       add     esp, 14h
.text:0040E644
.text:0040E644 loc_40E644:			       ; CODE XREF: __Gettnames_l+200j
.text:0040E644		       push    edi	       ; buf
.text:0040E645		       call    _strlen
.text:0040E64A		       add     [ebp+var_C], 4
.text:0040E64E		       add     [ebp+n],	4
.text:0040E652		       dec     [ebp+var_14]
.text:0040E655		       pop     ecx
.text:0040E656		       lea     edi, [edi+eax+1]
.text:0040E65A		       jnz     short loc_40E5DC
.text:0040E65C		       mov     eax, ebx
.text:0040E65E		       sub     eax, edi
.text:0040E660		       add     eax, [ebp+len]
.text:0040E663		       mov     [ebx+98h], edi
.text:0040E669		       push    dword ptr [esi+98h] ; _Src
.text:0040E66F		       push    eax	       ; _SizeInBytes
.text:0040E670		       push    edi	       ; _Dst
.text:0040E671		       call    _strcpy_s
.text:0040E676		       add     esp, 0Ch
.text:0040E679		       test    eax, eax
.text:0040E67B		       jz      short loc_40E68C
.text:0040E67D		       xor     eax, eax
.text:0040E67F		       push    eax	       ; pReserved
.text:0040E680		       push    eax	       ; nLine
.text:0040E681		       push    eax	       ; pszFile
.text:0040E682		       push    eax	       ; pszFunction
.text:0040E683		       push    eax	       ; pszExpression
.text:0040E684		       call    __invoke_watson
.text:0040E689		       add     esp, 14h
.text:0040E68C
.text:0040E68C loc_40E68C:			       ; CODE XREF: __Gettnames_l+248j
.text:0040E68C		       push    edi	       ; buf
.text:0040E68D		       call    _strlen
.text:0040E692		       lea     edi, [edi+eax+1]
.text:0040E696		       mov     eax, ebx
.text:0040E698		       sub     eax, edi
.text:0040E69A		       add     eax, [ebp+len]
.text:0040E69D		       mov     [ebx+9Ch], edi
.text:0040E6A3		       push    dword ptr [esi+9Ch] ; _Src
.text:0040E6A9		       push    eax	       ; _SizeInBytes
.text:0040E6AA		       push    edi	       ; _Dst
.text:0040E6AB		       call    _strcpy_s
.text:0040E6B0		       add     esp, 10h
.text:0040E6B3		       test    eax, eax
.text:0040E6B5		       jz      short loc_40E6C6
.text:0040E6B7		       xor     eax, eax
.text:0040E6B9		       push    eax	       ; pReserved
.text:0040E6BA		       push    eax	       ; nLine
.text:0040E6BB		       push    eax	       ; pszFile
.text:0040E6BC		       push    eax	       ; pszFunction
.text:0040E6BD		       push    eax	       ; pszExpression
.text:0040E6BE		       call    __invoke_watson
.text:0040E6C3		       add     esp, 14h
.text:0040E6C6
.text:0040E6C6 loc_40E6C6:			       ; CODE XREF: __Gettnames_l+282j
.text:0040E6C6		       push    edi	       ; buf
.text:0040E6C7		       call    _strlen
.text:0040E6CC		       lea     edi, [edi+eax+1]
.text:0040E6D0		       mov     eax, ebx
.text:0040E6D2		       sub     eax, edi
.text:0040E6D4		       add     eax, [ebp+len]
.text:0040E6D7		       mov     [ebx+0A0h], edi
.text:0040E6DD		       push    dword ptr [esi+0A0h] ; _Src
.text:0040E6E3		       push    eax	       ; _SizeInBytes
.text:0040E6E4		       push    edi	       ; _Dst
.text:0040E6E5		       call    _strcpy_s
.text:0040E6EA		       add     esp, 10h
.text:0040E6ED		       test    eax, eax
.text:0040E6EF		       jz      short loc_40E700
.text:0040E6F1		       xor     eax, eax
.text:0040E6F3		       push    eax	       ; pReserved
.text:0040E6F4		       push    eax	       ; nLine
.text:0040E6F5		       push    eax	       ; pszFile
.text:0040E6F6		       push    eax	       ; pszFunction
.text:0040E6F7		       push    eax	       ; pszExpression
.text:0040E6F8		       call    __invoke_watson
.text:0040E6FD		       add     esp, 14h
.text:0040E700
.text:0040E700 loc_40E700:			       ; CODE XREF: __Gettnames_l+2BCj
.text:0040E700		       push    edi	       ; buf
.text:0040E701		       call    _strlen
.text:0040E706		       lea     edi, [edi+eax+1]
.text:0040E70A		       mov     eax, ebx
.text:0040E70C		       sub     eax, edi
.text:0040E70E		       add     eax, [ebp+len]
.text:0040E711		       mov     [ebx+0A4h], edi
.text:0040E717		       push    dword ptr [esi+0A4h] ; _Src
.text:0040E71D		       push    eax	       ; _SizeInBytes
.text:0040E71E		       push    edi	       ; _Dst
.text:0040E71F		       call    _strcpy_s
.text:0040E724		       add     esp, 10h
.text:0040E727		       test    eax, eax
.text:0040E729		       jz      short loc_40E73A
.text:0040E72B		       xor     eax, eax
.text:0040E72D		       push    eax	       ; pReserved
.text:0040E72E		       push    eax	       ; nLine
.text:0040E72F		       push    eax	       ; pszFile
.text:0040E730		       push    eax	       ; pszFunction
.text:0040E731		       push    eax	       ; pszExpression
.text:0040E732		       call    __invoke_watson
.text:0040E737		       add     esp, 14h
.text:0040E73A
.text:0040E73A loc_40E73A:			       ; CODE XREF: __Gettnames_l+2F6j
.text:0040E73A		       push    edi	       ; buf
.text:0040E73B		       call    _strlen
.text:0040E740		       lea     eax, [edi+eax+1]
.text:0040E744		       mov     ecx, ebx
.text:0040E746		       sub     ecx, eax
.text:0040E748		       add     ecx, [ebp+len]
.text:0040E74B		       mov     [ebx+0A8h], eax
.text:0040E751		       push    dword ptr [esi+0A8h] ; _Src
.text:0040E757		       push    ecx	       ; _SizeInBytes
.text:0040E758		       push    eax	       ; _Dst
.text:0040E759		       call    _strcpy_s
.text:0040E75E		       add     esp, 10h
.text:0040E761		       test    eax, eax
.text:0040E763		       jz      short loc_40E774
.text:0040E765		       xor     eax, eax
.text:0040E767		       push    eax	       ; pReserved
.text:0040E768		       push    eax	       ; nLine
.text:0040E769		       push    eax	       ; pszFile
.text:0040E76A		       push    eax	       ; pszFunction
.text:0040E76B		       push    eax	       ; pszExpression
.text:0040E76C		       call    __invoke_watson
.text:0040E771		       add     esp, 14h
.text:0040E774
.text:0040E774 loc_40E774:			       ; CODE XREF: __Gettnames_l+E4j
.text:0040E774					       ; __Gettnames_l+330j
.text:0040E774		       cmp     [ebp+_loc_update.updated], 0
.text:0040E778		       jz      short loc_40E781
.text:0040E77A		       mov     eax, [ebp+_loc_update.ptd]
.text:0040E77D		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040E781
.text:0040E781 loc_40E781:			       ; CODE XREF: __Gettnames_l+345j
.text:0040E781		       pop     edi
.text:0040E782		       pop     esi
.text:0040E783		       mov     eax, ebx
.text:0040E785		       pop     ebx
.text:0040E786		       leave
.text:0040E787		       retn
.text:0040E787 __Gettnames_l   endp
.text:0040E787
.text:0040E788
.text:0040E788 ; =============== S U B R O U T I N E =======================================
.text:0040E788
.text:0040E788
.text:0040E788 ; void *__cdecl _Gettnames()
.text:0040E788 __Gettnames     proc near
.text:0040E788		       push    0	       ; plocinfo
.text:0040E78A		       call    __Gettnames_l
.text:0040E78F		       pop     ecx
.text:0040E790		       retn
.text:0040E790 __Gettnames     endp
.text:0040E790
.text:0040E791
.text:0040E791 ; =============== S U B R O U T I N E =======================================
.text:0040E791
.text:0040E791
.text:0040E791 ; void __usercall store_str(char	*in<edx>, char **out<ecx>, unsigned int	*count<eax>)
.text:0040E791 _store_str      proc near	       ; CODE XREF: _expandtime+3D9p
.text:0040E791 in = edx
.text:0040E791 out = ecx
.text:0040E791 count = eax
.text:0040E791		       cmp     dword ptr [count], 0
.text:0040E794		       push    esi
.text:0040E795		       mov     esi, in
.text:0040E797		       jz      short loc_40E7AF
.text:0040E799		       push    edi
.text:0040E79A
.text:0040E79A loc_40E79A:			       ; CODE XREF: _store_str+1Bj
.text:0040E79A		       mov     dl, [esi]
.text:0040E79C		       test    dl, dl
.text:0040E79E		       jz      short loc_40E7AE
.text:0040E7A0		       mov     edi, [out]
.text:0040E7A2		       mov     [edi], dl
.text:0040E7A4		       inc     dword ptr [out]
.text:0040E7A6		       inc     esi
.text:0040E7A7		       dec     dword ptr [count]
.text:0040E7A9		       cmp     dword ptr [count], 0
.text:0040E7AC		       jnz     short loc_40E79A
.text:0040E7AE
.text:0040E7AE loc_40E7AE:			       ; CODE XREF: _store_str+Dj
.text:0040E7AE		       pop     edi
.text:0040E7AF
.text:0040E7AF loc_40E7AF:			       ; CODE XREF: _store_str+6j
.text:0040E7AF		       pop     esi
.text:0040E7B0		       retn
.text:0040E7B0 _store_str      endp
.text:0040E7B0
.text:0040E7B1
.text:0040E7B1 ; =============== S U B R O U T I N E =======================================
.text:0040E7B1
.text:0040E7B1
.text:0040E7B1 ; void __usercall store_number(int num<eax>, char **out<edi>, unsigned int *count<esi>)
.text:0040E7B1 _store_number   proc near
.text:0040E7B1 num = eax
.text:0040E7B1 out = edi
.text:0040E7B1 count = esi
.text:0040E7B1		       cmp     dword ptr [count], 1
.text:0040E7B4		       mov     ecx, [out]
.text:0040E7B6		       push    ebx
.text:0040E7B7		       jbe     short loc_40E7D2
.text:0040E7B9
.text:0040E7B9 loc_40E7B9:			       ; CODE XREF: _store_number+1Fj
.text:0040E7B9		       push    0Ah
.text:0040E7BB		       cdq
.text:0040E7BC		       pop     ebx
.text:0040E7BD		       idiv    ebx
.text:0040E7BF		       add     dl, 30h
.text:0040E7C2		       mov     [ecx], dl
.text:0040E7C4		       inc     ecx
.text:0040E7C5		       dec     dword ptr [count]
.text:0040E7C7		       test    num, num
.text:0040E7C9		       mov     edx, [count]
.text:0040E7CB		       jle     short loc_40E7D2
.text:0040E7CD		       cmp     edx, 1
.text:0040E7D0		       ja      short loc_40E7B9
.text:0040E7D2
.text:0040E7D2 loc_40E7D2:			       ; CODE XREF: _store_number+6j
.text:0040E7D2					       ; _store_number+1Aj
.text:0040E7D2		       mov     num, [out]
.text:0040E7D4		       mov     [out], ecx
.text:0040E7D6		       dec     ecx
.text:0040E7D7
.text:0040E7D7 loc_40E7D7:			       ; CODE XREF: _store_number+32j
.text:0040E7D7		       mov     bl, [num]
.text:0040E7D9		       mov     dl, [ecx]
.text:0040E7DB		       mov     [ecx], bl
.text:0040E7DD		       dec     ecx
.text:0040E7DE		       mov     [num], dl
.text:0040E7E0		       inc     num
.text:0040E7E1		       cmp     num, ecx
.text:0040E7E3		       jb      short loc_40E7D7
.text:0040E7E5		       pop     ebx
.text:0040E7E6		       retn
.text:0040E7E6 _store_number   endp
.text:0040E7E6
.text:0040E7E7
.text:0040E7E7 ; =============== S U B R O U T I N E =======================================
.text:0040E7E7
.text:0040E7E7 ; Attributes: bp-based frame
.text:0040E7E7
.text:0040E7E7 ; void __usercall store_num(int num<eax>, int digits<edx>, char **out<edi>, unsigned int	*count<ecx>, unsigned int no_lead_zeros)
.text:0040E7E7 _store_num      proc near	       ; CODE XREF: _expandtime+250p
.text:0040E7E7
.text:0040E7E7 temp	       = dword ptr -4
.text:0040E7E7 no_lead_zeros   = dword ptr  8
.text:0040E7E7
.text:0040E7E7 num = eax
.text:0040E7E7 digits =	edx
.text:0040E7E7 out = edi
.text:0040E7E7 count = ecx
.text:0040E7E7		       push    ebp
.text:0040E7E8		       mov     ebp, esp
.text:0040E7EA		       push    count
.text:0040E7EB		       push    ebx
.text:0040E7EC		       push    esi
.text:0040E7ED		       mov     esi, digits
.text:0040E7EF		       xor     digits, digits
.text:0040E7F1		       cmp     [ebp+no_lead_zeros], digits
.text:0040E7F4		       mov     [ebp+temp], digits
.text:0040E7F7		       jz      short loc_40E82E
.text:0040E7F9		       cmp     dword ptr [count], 1
.text:0040E7FC		       mov     esi, [out]
.text:0040E7FE		       jbe     short loc_40E819
.text:0040E800
.text:0040E800 loc_40E800:			       ; CODE XREF: _store_num+30j
.text:0040E800		       push    0Ah
.text:0040E802		       cdq
.text:0040E803		       pop     ebx
.text:0040E804		       idiv    ebx
.text:0040E806		       add     dl, 30h
.text:0040E809		       mov     [esi], dl
.text:0040E80B		       inc     esi
.text:0040E80C		       dec     dword ptr [count]
.text:0040E80E		       test    num, num
.text:0040E810		       mov     digits, [count]
.text:0040E812		       jle     short loc_40E819
.text:0040E814		       cmp     digits, 1
.text:0040E817		       ja      short loc_40E800
.text:0040E819
.text:0040E819 loc_40E819:			       ; CODE XREF: _store_num+17j
.text:0040E819					       ; _store_num+2Bj
.text:0040E819		       mov     num, [out]
.text:0040E81B		       mov     [out], esi
.text:0040E81D		       dec     esi
.text:0040E81E
.text:0040E81E loc_40E81E:			       ; CODE XREF: _store_num+43j
.text:0040E81E		       mov     dl, [num]
.text:0040E820		       mov     cl, [esi]
.text:0040E822		       mov     [esi], dl
.text:0040E824		       dec     esi
.text:0040E825		       mov     [num], cl
.text:0040E827		       inc     num
.text:0040E828		       cmp     num, esi
.text:0040E82A		       jb      short loc_40E81E
.text:0040E82C		       jmp     short loc_40E85C
.text:0040E82E ; ---------------------------------------------------------------------------
.text:0040E82E
.text:0040E82E loc_40E82E:			       ; CODE XREF: _store_num+10j
.text:0040E82E		       cmp     esi, [count]
.text:0040E830		       jnb     short loc_40E85A
.text:0040E832		       dec     esi
.text:0040E833		       lea     digits, [esi+1]
.text:0040E836		       test    digits, digits
.text:0040E838		       jz      short loc_40E851
.text:0040E83A
.text:0040E83A loc_40E83A:			       ; CODE XREF: _store_num+68j
.text:0040E83A		       push    0Ah
.text:0040E83C		       cdq
.text:0040E83D		       pop     ebx
.text:0040E83E		       idiv    ebx
.text:0040E840		       mov     ebx, [out]
.text:0040E842		       add     dl, 30h
.text:0040E845		       inc     [ebp+temp]
.text:0040E848		       mov     [esi+ebx], dl
.text:0040E84B		       dec     esi
.text:0040E84C		       cmp     esi, 0FFFFFFFFh
.text:0040E84F		       jnz     short loc_40E83A
.text:0040E851
.text:0040E851 loc_40E851:			       ; CODE XREF: _store_num+51j
.text:0040E851		       mov     num, [ebp+temp]
.text:0040E854		       add     [out], num
.text:0040E856		       sub     [count],	num
.text:0040E858		       jmp     short loc_40E85C
.text:0040E85A ; ---------------------------------------------------------------------------
.text:0040E85A
.text:0040E85A loc_40E85A:			       ; CODE XREF: _store_num+49j
.text:0040E85A		       mov     [count],	digits
.text:0040E85C
.text:0040E85C loc_40E85C:			       ; CODE XREF: _store_num+45j
.text:0040E85C					       ; _store_num+71j
.text:0040E85C		       pop     esi
.text:0040E85D		       pop     ebx
.text:0040E85E		       leave
.text:0040E85F		       retn
.text:0040E85F _store_num      endp
.text:0040E85F
.text:0040E860
.text:0040E860 ; =============== S U B R O U T I N E =======================================
.text:0040E860
.text:0040E860 ; Attributes: bp-based frame
.text:0040E860
.text:0040E860 ; int __usercall	expandtime<eax>(localeinfo_struct *plocinfo, char specifier<al>, tm *timeptr<edx>, char	**string<ecx>, unsigned	int *left, __lc_time_data *lc_time, unsigned int alternate_form)
.text:0040E860 _expandtime     proc near	       ; CODE XREF: _store_winword+442p
.text:0040E860					       ; __Strftime_l+11Bp
.text:0040E860
.text:0040E860 var_4	       = dword ptr -4
.text:0040E860 plocinfo	       = dword ptr  8
.text:0040E860 left	       = dword ptr  0Ch
.text:0040E860 lc_time	       = dword ptr  10h
.text:0040E860 alternate_form  = dword ptr  14h
.text:0040E860
.text:0040E860 specifier = al
.text:0040E860 timeptr = edx
.text:0040E860 string =	ecx
.text:0040E860		       push    ebp
.text:0040E861		       mov     ebp, esp
.text:0040E863		       push    string
.text:0040E864		       push    ebx
.text:0040E865		       movsx   eax, specifier
.text:0040E868		       cmp     eax, 59h
.text:0040E86B		       push    esi
.text:0040E86C		       push    edi
.text:0040E86D		       mov     ebx, string
.text:0040E86F		       mov     esi, timeptr
.text:0040E871		       jg      loc_40EA34
.text:0040E877		       jz      loc_40EA02
.text:0040E87D		       cmp     eax, 49h
.text:0040E880		       jg      loc_40E951
.text:0040E886		       jz      loc_40E924
.text:0040E88C		       sub     eax, 4
.text:0040E88F		       jz      loc_40EC3E
.text:0040E895		       sub     eax, 9
.text:0040E898		       jz      loc_40EC3E
.text:0040E89E		       sub     eax, 18h
.text:0040E8A1		       jz      short loc_40E913
.text:0040E8A3		       sub     eax, 1Ch
.text:0040E8A6		       jz      short loc_40E8F1
.text:0040E8A8		       dec     eax
.text:0040E8A9		       jz      short loc_40E8CF
.text:0040E8AB		       sub     eax, 6
.text:0040E8AE		       jnz     loc_40EB4E
.text:0040E8B4		       mov     eax, [esi+8]
.text:0040E8B7		       xor     edi, edi
.text:0040E8B9		       cmp     eax, edi
.text:0040E8BB		       jl      loc_40EB36
.text:0040E8C1		       cmp     eax, 17h
.text:0040E8C4
.text:0040E8C4 loc_40E8C4:			       ; CODE XREF: _expandtime+198j
.text:0040E8C4		       jg      loc_40EB36
.text:0040E8CA		       jmp     loc_40EAA5
.text:0040E8CF ; ---------------------------------------------------------------------------
.text:0040E8CF
.text:0040E8CF loc_40E8CF:			       ; CODE XREF: _expandtime+49j
.text:0040E8CF		       mov     esi, [esi+10h]
.text:0040E8D2		       xor     edi, edi
.text:0040E8D4		       cmp     esi, edi
.text:0040E8D6		       jl      loc_40EB36
.text:0040E8DC		       cmp     esi, 0Bh
.text:0040E8DF		       jg      loc_40EB36
.text:0040E8E5		       mov     timeptr,	[ebp+lc_time]
.text:0040E8E8		       mov     timeptr,	[timeptr+esi*4+68h]
.text:0040E8EC		       jmp     loc_40EC36
.text:0040E8F1 ; ---------------------------------------------------------------------------
.text:0040E8F1
.text:0040E8F1 loc_40E8F1:			       ; CODE XREF: _expandtime+46j
.text:0040E8F1		       mov     esi, [esi+18h]
.text:0040E8F4		       xor     edi, edi
.text:0040E8F6		       cmp     esi, edi
.text:0040E8F8		       jl      loc_40EB36
.text:0040E8FE		       cmp     esi, 6
.text:0040E901		       jg      loc_40EB36
.text:0040E907		       mov     timeptr,	[ebp+lc_time]
.text:0040E90A		       mov     timeptr,	[timeptr+esi*4+1Ch]
.text:0040E90E		       jmp     loc_40EC36
.text:0040E913 ; ---------------------------------------------------------------------------
.text:0040E913
.text:0040E913 loc_40E913:			       ; CODE XREF: _expandtime+41j
.text:0040E913		       mov     eax, [ebx]
.text:0040E915		       mov     byte ptr	[eax], 25h
.text:0040E918		       mov     eax, [ebp+left]
.text:0040E91B		       inc     dword ptr [ebx]
.text:0040E91D		       dec     dword ptr [eax]
.text:0040E91F		       jmp     loc_40EC3E
.text:0040E924 ; ---------------------------------------------------------------------------
.text:0040E924
.text:0040E924 loc_40E924:			       ; CODE XREF: _expandtime+26j
.text:0040E924		       mov     eax, [esi+8]
.text:0040E927		       xor     edi, edi
.text:0040E929		       cmp     eax, edi
.text:0040E92B		       jl      loc_40EB36
.text:0040E931		       cmp     eax, 17h
.text:0040E934		       jg      loc_40EB36
.text:0040E93A		       cdq
.text:0040E93B		       push    0Ch
.text:0040E93D		       pop     string
.text:0040E93E		       idiv    string
.text:0040E940		       mov     eax, timeptr
.text:0040E942		       cmp     eax, edi
.text:0040E944		       jnz     loc_40EAA5
.text:0040E94A		       push    string
.text:0040E94B		       pop     eax
.text:0040E94C		       jmp     loc_40EAA5
.text:0040E951 ; ---------------------------------------------------------------------------
.text:0040E951
.text:0040E951 loc_40E951:			       ; CODE XREF: _expandtime+20j
.text:0040E951		       sub     eax, 4Dh
.text:0040E954		       jz      loc_40E9FD
.text:0040E95A		       push    6
.text:0040E95C		       pop     string
.text:0040E95D		       sub     eax, string
.text:0040E95F		       jz      loc_40E9E9
.text:0040E965		       dec     eax
.text:0040E966		       dec     eax
.text:0040E967		       jz      short loc_40E99D
.text:0040E969		       dec     eax
.text:0040E96A		       dec     eax
.text:0040E96B		       jz      short loc_40E97F
.text:0040E96D		       dec     eax
.text:0040E96E		       jnz     loc_40EB4E
.text:0040E974		       push    [ebp+lc_time]
.text:0040E977		       push    [ebp+left]
.text:0040E97A		       jmp     loc_40EAF2
.text:0040E97F ; ---------------------------------------------------------------------------
.text:0040E97F
.text:0040E97F loc_40E97F:			       ; CODE XREF: _expandtime+10Bj
.text:0040E97F		       mov     eax, [esi+18h]
.text:0040E982		       xor     edi, edi
.text:0040E984		       cmp     eax, edi
.text:0040E986		       jl      loc_40EB36
.text:0040E98C		       cmp     eax, string
.text:0040E98E		       jg      loc_40EB36
.text:0040E994		       cmp     eax, edi
.text:0040E996		       jz      short weeknum
.text:0040E998		       lea     string, [eax-1]
.text:0040E99B		       jmp     short weeknum
.text:0040E99D ; ---------------------------------------------------------------------------
.text:0040E99D
.text:0040E99D loc_40E99D:			       ; CODE XREF: _expandtime+107j
.text:0040E99D		       mov     eax, [esi+18h]
.text:0040E9A0		       xor     edi, edi
.text:0040E9A2		       cmp     eax, edi
.text:0040E9A4		       jl      loc_40EB36
.text:0040E9AA		       cmp     eax, string
.text:0040E9AC		       jg      loc_40EB36
.text:0040E9B2		       mov     string, eax
.text:0040E9B4
.text:0040E9B4 weeknum:				       ; CODE XREF: _expandtime+136j
.text:0040E9B4					       ; _expandtime+13Bj
.text:0040E9B4		       mov     eax, [esi+1Ch]
.text:0040E9B7		       cmp     eax, edi
.text:0040E9B9		       jl      loc_40EB36
.text:0040E9BF		       cmp     eax, 16Dh
.text:0040E9C4		       jg      loc_40EB36
.text:0040E9CA		       cmp     eax, string
.text:0040E9CC		       jge     short loc_40E9D5
.text:0040E9CE		       xor     eax, eax
.text:0040E9D0		       jmp     loc_40EAA5
.text:0040E9D5 ; ---------------------------------------------------------------------------
.text:0040E9D5
.text:0040E9D5 loc_40E9D5:			       ; CODE XREF: _expandtime+16Cj
.text:0040E9D5		       push    7
.text:0040E9D7		       cdq
.text:0040E9D8		       pop     esi
.text:0040E9D9		       idiv    esi
.text:0040E9DB		       cmp     timeptr,	string
.text:0040E9DD		       jl      loc_40EAA5
.text:0040E9E3		       inc     eax
.text:0040E9E4		       jmp     loc_40EAA5
.text:0040E9E9 ; ---------------------------------------------------------------------------
.text:0040E9E9
.text:0040E9E9 loc_40E9E9:			       ; CODE XREF: _expandtime+FFj
.text:0040E9E9		       mov     eax, [esi]
.text:0040E9EB
.text:0040E9EB loc_40E9EB:			       ; CODE XREF: _expandtime+1A0j
.text:0040E9EB		       xor     edi, edi
.text:0040E9ED		       cmp     eax, edi
.text:0040E9EF		       jl      loc_40EB36
.text:0040E9F5		       cmp     eax, 3Bh
.text:0040E9F8		       jmp     loc_40E8C4
.text:0040E9FD ; ---------------------------------------------------------------------------
.text:0040E9FD
.text:0040E9FD loc_40E9FD:			       ; CODE XREF: _expandtime+F4j
.text:0040E9FD		       mov     eax, [esi+4]
.text:0040EA00		       jmp     short loc_40E9EB
.text:0040EA02 ; ---------------------------------------------------------------------------
.text:0040EA02
.text:0040EA02 loc_40EA02:			       ; CODE XREF: _expandtime+17j
.text:0040EA02		       mov     eax, [esi+14h]
.text:0040EA05		       cmp     eax, 0FFFFF894h
.text:0040EA0A		       jl      short loc_40EA13
.text:0040EA0C		       cmp     eax, 1FA3h
.text:0040EA11		       jle     short loc_40EA1F
.text:0040EA13
.text:0040EA13 loc_40EA13:			       ; CODE XREF: _expandtime+1AAj
.text:0040EA13					       ; _expandtime+234j ...
.text:0040EA13		       call    __errno
.text:0040EA18		       xor     edi, edi
.text:0040EA1A		       jmp     loc_40EB3B
.text:0040EA1F ; ---------------------------------------------------------------------------
.text:0040EA1F
.text:0040EA1F loc_40EA1F:			       ; CODE XREF: _expandtime+1B1j
.text:0040EA1F		       cdq		       ; digits
.text:0040EA20		       push    64h
.text:0040EA22		       pop     string
.text:0040EA23		       idiv    string
.text:0040EA25		       push    [ebp+alternate_form]
.text:0040EA28		       push    4
.text:0040EA2A		       add     eax, 13h
.text:0040EA2D		       imul    eax, 64h
.text:0040EA30		       add     eax, timeptr
.text:0040EA32		       jmp     short loc_40EAAA
.text:0040EA34 ; ---------------------------------------------------------------------------
.text:0040EA34
.text:0040EA34 loc_40EA34:			       ; CODE XREF: _expandtime+11j
.text:0040EA34		       cmp     eax, 6Dh
.text:0040EA37		       jg      loc_40EB76
.text:0040EA3D		       jz      loc_40EB60
.text:0040EA43		       sub     eax, 5Ah
.text:0040EA46		       jz      loc_40EB8D
.text:0040EA4C		       sub     eax, 7
.text:0040EA4F		       jz      loc_40EB28
.text:0040EA55		       dec     eax
.text:0040EA56		       jz      loc_40EB0E
.text:0040EA5C		       dec     eax
.text:0040EA5D		       jz      short loc_40EABB
.text:0040EA5F		       dec     eax
.text:0040EA60		       jz      short loc_40EA8E
.text:0040EA62		       sub     eax, 6
.text:0040EA65		       jnz     loc_40EB4E
.text:0040EA6B		       mov     esi, [esi+1Ch]
.text:0040EA6E		       xor     edi, edi
.text:0040EA70		       cmp     esi, edi
.text:0040EA72		       jl      loc_40EB36
.text:0040EA78		       cmp     esi, 16Dh
.text:0040EA7E		       jg      loc_40EB36
.text:0040EA84		       push    [ebp+alternate_form]
.text:0040EA87		       lea     eax, [esi+1]
.text:0040EA8A		       push    3
.text:0040EA8C		       jmp     short loc_40EAAA
.text:0040EA8E ; ---------------------------------------------------------------------------
.text:0040EA8E
.text:0040EA8E loc_40EA8E:			       ; CODE XREF: _expandtime+200j
.text:0040EA8E		       mov     esi, [esi+0Ch]
.text:0040EA91		       cmp     esi, 1
.text:0040EA94		       jl      loc_40EA13
.text:0040EA9A		       cmp     esi, 1Fh
.text:0040EA9D		       jg      loc_40EA13
.text:0040EAA3		       mov     eax, esi	       ; num
.text:0040EAA5
.text:0040EAA5 loc_40EAA5:			       ; CODE XREF: _expandtime+6Aj
.text:0040EAA5					       ; _expandtime+E4j ...
.text:0040EAA5		       push    [ebp+alternate_form] ; no_lead_zeros
.text:0040EAA8
.text:0040EAA8 loc_40EAA8:			       ; CODE XREF: _expandtime+368j
.text:0040EAA8		       push    2
.text:0040EAAA
.text:0040EAAA loc_40EAAA:			       ; CODE XREF: _expandtime+1D2j
.text:0040EAAA					       ; _expandtime+22Cj
.text:0040EAAA		       pop     timeptr
.text:0040EAAB
.text:0040EAAB loc_40EAAB:			       ; CODE XREF: _expandtime+3A5j
.text:0040EAAB		       mov     string, [ebp+left] ; count
.text:0040EAAE		       mov     edi, ebx	       ; out
.text:0040EAB0		       call    _store_num
.text:0040EAB5		       pop     string
.text:0040EAB6		       jmp     loc_40EC3E
.text:0040EABB ; ---------------------------------------------------------------------------
.text:0040EABB
.text:0040EABB loc_40EABB:			       ; CODE XREF: _expandtime+1FDj
.text:0040EABB		       push    [ebp+lc_time]   ; lc_time
.text:0040EABE		       xor     edi, edi
.text:0040EAC0		       cmp     [ebp+alternate_form], edi
.text:0040EAC3		       push    [ebp+left]      ; count
.text:0040EAC6		       push    ebx	       ; out
.text:0040EAC7		       push    esi	       ; tmptr
.text:0040EAC8		       jz      short loc_40EB0B
.text:0040EACA		       push    1	       ; field_code
.text:0040EACC
.text:0040EACC loc_40EACC:			       ; CODE XREF: _expandtime+2ACj
.text:0040EACC		       push    [ebp+plocinfo]  ; plocinfo
.text:0040EACF		       call    _store_winword
.text:0040EAD4		       add     esp, 18h
.text:0040EAD7		       test    eax, eax
.text:0040EAD9		       jz      short loc_40EB4E
.text:0040EADB		       mov     eax, [ebp+left]
.text:0040EADE		       cmp     [eax], edi
.text:0040EAE0		       jz      short loc_40EB4E
.text:0040EAE2		       mov     eax, [ebx]
.text:0040EAE4		       push    [ebp+lc_time]   ; lc_time
.text:0040EAE7		       mov     byte ptr	[eax], 20h
.text:0040EAEA		       mov     eax, [ebp+left]
.text:0040EAED		       inc     dword ptr [ebx]
.text:0040EAEF		       dec     dword ptr [eax]
.text:0040EAF1		       push    eax	       ; count
.text:0040EAF2
.text:0040EAF2 loc_40EAF2:			       ; CODE XREF: _expandtime+11Aj
.text:0040EAF2		       push    ebx	       ; out
.text:0040EAF3		       push    esi	       ; tmptr
.text:0040EAF4		       push    2	       ; field_code
.text:0040EAF6
.text:0040EAF6 loc_40EAF6:			       ; CODE XREF: _expandtime+37Ej
.text:0040EAF6					       ; _expandtime+384j
.text:0040EAF6		       push    [ebp+plocinfo]  ; plocinfo
.text:0040EAF9		       call    _store_winword
.text:0040EAFE		       add     esp, 18h
.text:0040EB01		       test    eax, eax
.text:0040EB03		       jnz     loc_40EC3E
.text:0040EB09		       jmp     short loc_40EB4E
.text:0040EB0B ; ---------------------------------------------------------------------------
.text:0040EB0B
.text:0040EB0B loc_40EB0B:			       ; CODE XREF: _expandtime+268j
.text:0040EB0B		       push    edi
.text:0040EB0C		       jmp     short loc_40EACC
.text:0040EB0E ; ---------------------------------------------------------------------------
.text:0040EB0E
.text:0040EB0E loc_40EB0E:			       ; CODE XREF: _expandtime+1F6j
.text:0040EB0E		       mov     esi, [esi+10h]
.text:0040EB11		       xor     edi, edi
.text:0040EB13		       cmp     esi, edi
.text:0040EB15		       jl      short loc_40EB36
.text:0040EB17		       cmp     esi, 0Bh
.text:0040EB1A		       jg      short loc_40EB36
.text:0040EB1C		       mov     timeptr,	[ebp+lc_time]
.text:0040EB1F		       mov     timeptr,	[timeptr+esi*4+38h]
.text:0040EB23		       jmp     loc_40EC36
.text:0040EB28 ; ---------------------------------------------------------------------------
.text:0040EB28
.text:0040EB28 loc_40EB28:			       ; CODE XREF: _expandtime+1EFj
.text:0040EB28		       mov     esi, [esi+18h]
.text:0040EB2B		       xor     edi, edi
.text:0040EB2D		       cmp     esi, edi
.text:0040EB2F		       jl      short loc_40EB36
.text:0040EB31		       cmp     esi, 6
.text:0040EB34		       jle     short loc_40EB55
.text:0040EB36
.text:0040EB36 loc_40EB36:			       ; CODE XREF: _expandtime+5Bj
.text:0040EB36					       ; _expandtime:loc_40E8C4j ...
.text:0040EB36		       call    __errno
.text:0040EB3B
.text:0040EB3B loc_40EB3B:			       ; CODE XREF: _expandtime+1BAj
.text:0040EB3B		       push    edi	       ; pReserved
.text:0040EB3C		       push    edi	       ; nLine
.text:0040EB3D		       push    edi	       ; pszFile
.text:0040EB3E		       push    edi	       ; pszFunction
.text:0040EB3F		       push    edi	       ; pszExpression
.text:0040EB40		       mov     dword ptr [eax],	16h
.text:0040EB46		       call    __invalid_parameter
.text:0040EB4B		       add     esp, 14h
.text:0040EB4E
.text:0040EB4E loc_40EB4E:			       ; CODE XREF: _expandtime+4Ej
.text:0040EB4E					       ; _expandtime+10Ej ...
.text:0040EB4E		       xor     eax, eax
.text:0040EB50		       jmp     loc_40EC41
.text:0040EB55 ; ---------------------------------------------------------------------------
.text:0040EB55
.text:0040EB55 loc_40EB55:			       ; CODE XREF: _expandtime+2D4j
.text:0040EB55		       mov     timeptr,	[ebp+lc_time]
.text:0040EB58		       mov     timeptr,	[timeptr+esi*4]
.text:0040EB5B		       jmp     loc_40EC36
.text:0040EB60 ; ---------------------------------------------------------------------------
.text:0040EB60
.text:0040EB60 loc_40EB60:			       ; CODE XREF: _expandtime+1DDj
.text:0040EB60		       mov     esi, [esi+10h]
.text:0040EB63		       xor     edi, edi
.text:0040EB65		       cmp     esi, edi
.text:0040EB67		       jl      short loc_40EB36
.text:0040EB69		       cmp     esi, 0Bh
.text:0040EB6C		       jg      short loc_40EB36
.text:0040EB6E		       lea     eax, [esi+1]
.text:0040EB71		       jmp     loc_40EAA5
.text:0040EB76 ; ---------------------------------------------------------------------------
.text:0040EB76
.text:0040EB76 loc_40EB76:			       ; CODE XREF: _expandtime+1D7j
.text:0040EB76		       sub     eax, 70h
.text:0040EB79		       jz      loc_40EC0A
.text:0040EB7F		       sub     eax, 7
.text:0040EB82		       jz      short loc_40EBE9
.text:0040EB84		       dec     eax
.text:0040EB85		       jz      short loc_40EBCD
.text:0040EB87		       dec     eax
.text:0040EB88		       jz      short loc_40EBB0
.text:0040EB8A		       dec     eax
.text:0040EB8B		       jnz     short loc_40EB4E
.text:0040EB8D
.text:0040EB8D loc_40EB8D:			       ; CODE XREF: _expandtime+1E6j
.text:0040EB8D		       call    ___tzset
.text:0040EB92		       call    ___tzname
.text:0040EB97		       mov     timeptr,	eax
.text:0040EB99		       xor     eax, eax
.text:0040EB9B		       cmp     [esi+20h], eax
.text:0040EB9E		       mov     string, ebx     ; out
.text:0040EBA0		       setnz   specifier
.text:0040EBA3		       mov     ebx, eax
.text:0040EBA5		       mov     timeptr,	[timeptr+ebx*4]
.text:0040EBA8		       mov     [ebp+var_4], eax
.text:0040EBAB		       jmp     loc_40EC36
.text:0040EBB0 ; ---------------------------------------------------------------------------
.text:0040EBB0
.text:0040EBB0 loc_40EBB0:			       ; CODE XREF: _expandtime+328j
.text:0040EBB0		       mov     eax, [esi+14h]
.text:0040EBB3		       xor     edi, edi
.text:0040EBB5		       cmp     eax, edi
.text:0040EBB7		       jl      loc_40EB36
.text:0040EBBD		       push    [ebp+alternate_form]
.text:0040EBC0		       cdq
.text:0040EBC1		       push    64h
.text:0040EBC3		       pop     string
.text:0040EBC4		       idiv    string
.text:0040EBC6		       mov     eax, timeptr
.text:0040EBC8		       jmp     loc_40EAA8
.text:0040EBCD ; ---------------------------------------------------------------------------
.text:0040EBCD
.text:0040EBCD loc_40EBCD:			       ; CODE XREF: _expandtime+325j
.text:0040EBCD		       push    [ebp+lc_time]
.text:0040EBD0		       xor     edi, edi
.text:0040EBD2		       cmp     [ebp+alternate_form], edi
.text:0040EBD5		       push    [ebp+left]
.text:0040EBD8		       push    ebx
.text:0040EBD9		       push    esi
.text:0040EBDA		       jz      short loc_40EBE3
.text:0040EBDC		       push    1
.text:0040EBDE		       jmp     loc_40EAF6
.text:0040EBE3 ; ---------------------------------------------------------------------------
.text:0040EBE3
.text:0040EBE3 loc_40EBE3:			       ; CODE XREF: _expandtime+37Aj
.text:0040EBE3		       push    edi
.text:0040EBE4		       jmp     loc_40EAF6
.text:0040EBE9 ; ---------------------------------------------------------------------------
.text:0040EBE9
.text:0040EBE9 loc_40EBE9:			       ; CODE XREF: _expandtime+322j
.text:0040EBE9		       mov     eax, [esi+18h]
.text:0040EBEC		       xor     edi, edi
.text:0040EBEE		       cmp     eax, edi
.text:0040EBF0		       jl      loc_40EB36
.text:0040EBF6		       cmp     eax, 6
.text:0040EBF9		       jg      loc_40EB36
.text:0040EBFF		       push    [ebp+alternate_form]
.text:0040EC02		       xor     timeptr,	timeptr
.text:0040EC04		       inc     timeptr
.text:0040EC05		       jmp     loc_40EAAB
.text:0040EC0A ; ---------------------------------------------------------------------------
.text:0040EC0A
.text:0040EC0A loc_40EC0A:			       ; CODE XREF: _expandtime+319j
.text:0040EC0A		       mov     esi, [esi+8]
.text:0040EC0D		       xor     edi, edi
.text:0040EC0F		       cmp     esi, edi
.text:0040EC11		       jl      loc_40EB36
.text:0040EC17		       cmp     esi, 17h
.text:0040EC1A		       jg      loc_40EB36
.text:0040EC20		       cmp     esi, 0Bh
.text:0040EC23		       mov     timeptr,	[ebp+lc_time]
.text:0040EC26		       jg      short loc_40EC30
.text:0040EC28		       mov     timeptr,	[timeptr+98h]
.text:0040EC2E		       jmp     short loc_40EC36
.text:0040EC30 ; ---------------------------------------------------------------------------
.text:0040EC30
.text:0040EC30 loc_40EC30:			       ; CODE XREF: _expandtime+3C6j
.text:0040EC30		       mov     timeptr,	[timeptr+9Ch] ;	in
.text:0040EC36
.text:0040EC36 loc_40EC36:			       ; CODE XREF: _expandtime+8Cj
.text:0040EC36					       ; _expandtime+AEj ...
.text:0040EC36		       mov     eax, [ebp+left] ; count
.text:0040EC39		       call    _store_str
.text:0040EC3E
.text:0040EC3E loc_40EC3E:			       ; CODE XREF: _expandtime+2Fj
.text:0040EC3E					       ; _expandtime+38j ...
.text:0040EC3E		       xor     eax, eax
.text:0040EC40		       inc     eax
.text:0040EC41
.text:0040EC41 loc_40EC41:			       ; CODE XREF: _expandtime+2F0j
.text:0040EC41		       pop     edi
.text:0040EC42		       pop     esi
.text:0040EC43		       pop     ebx
.text:0040EC44		       leave
.text:0040EC45		       retn
.text:0040EC45 _expandtime     endp
.text:0040EC45
.text:0040EC46
.text:0040EC46 ; =============== S U B R O U T I N E =======================================
.text:0040EC46
.text:0040EC46 ; Attributes: bp-based frame
.text:0040EC46
.text:0040EC46 ; int __cdecl store_winword(localeinfo_struct *plocinfo,	int field_code,	tm *tmptr, char	**out, unsigned	int *count, __lc_time_data *lc_time)
.text:0040EC46 _store_winword  proc near	       ; CODE XREF: _expandtime+26Fp
.text:0040EC46					       ; _expandtime+299p
.text:0040EC46
.text:0040EC46 SystemTime      = _SYSTEMTIME ptr -20h
.text:0040EC46 cch	       = dword ptr -10h
.text:0040EC46 FormatFunc      = dword ptr -0Ch
.text:0040EC46 buffer	       = dword ptr -8
.text:0040EC46 var_4	       = dword ptr -4
.text:0040EC46 plocinfo	       = dword ptr  8
.text:0040EC46 field_code      = dword ptr  0Ch
.text:0040EC46 tmptr	       = dword ptr  10h
.text:0040EC46 out	       = dword ptr  14h
.text:0040EC46 count	       = dword ptr  18h
.text:0040EC46 lc_time	       = dword ptr  1Ch
.text:0040EC46
.text:0040EC46		       push    ebp
.text:0040EC47		       mov     ebp, esp
.text:0040EC49		       sub     esp, 20h
.text:0040EC4C		       mov     eax, ___security_cookie
.text:0040EC51		       xor     eax, ebp
.text:0040EC53		       mov     [ebp+var_4], eax
.text:0040EC56		       mov     eax, [ebp+field_code]
.text:0040EC59		       push    ebx
.text:0040EC5A		       push    esi
.text:0040EC5B		       mov     esi, [ebp+lc_time]
.text:0040EC5E		       xor     ebx, ebx
.text:0040EC60		       sub     eax, ebx
.text:0040EC62		       push    edi
.text:0040EC63		       jz      short loc_40EC78
.text:0040EC65		       dec     eax
.text:0040EC66		       jz      short loc_40EC70
.text:0040EC68		       mov     edi, [esi+0A8h]
.text:0040EC6E		       jmp     short loc_40EC7E
.text:0040EC70 ; ---------------------------------------------------------------------------
.text:0040EC70
.text:0040EC70 loc_40EC70:			       ; CODE XREF: _store_winword+20j
.text:0040EC70		       mov     edi, [esi+0A4h]
.text:0040EC76		       jmp     short loc_40EC7E
.text:0040EC78 ; ---------------------------------------------------------------------------
.text:0040EC78
.text:0040EC78 loc_40EC78:			       ; CODE XREF: _store_winword+1Dj
.text:0040EC78		       mov     edi, [esi+0A0h]
.text:0040EC7E
.text:0040EC7E loc_40EC7E:			       ; CODE XREF: _store_winword+28j
.text:0040EC7E					       ; _store_winword+30j
.text:0040EC7E		       cmp     dword ptr [esi+0B0h], 1
.text:0040EC85		       mov     eax, [ebp+tmptr]
.text:0040EC88		       jz      loc_40ED8A
.text:0040EC8E		       cmp     [ebp+field_code], 2
.text:0040EC92		       mov     ecx, ds:__imp__GetDateFormatA@24	; GetDateFormatA(x,x,x,x,x,x)
.text:0040EC98		       jnz     short loc_40ECA0
.text:0040EC9A		       mov     ecx, ds:__imp__GetTimeFormatA@24	; GetTimeFormatA(x,x,x,x,x,x)
.text:0040ECA0
.text:0040ECA0 loc_40ECA0:			       ; CODE XREF: _store_winword+52j
.text:0040ECA0		       mov     dx, [eax+14h]
.text:0040ECA4		       add     dx, 76Ch
.text:0040ECA9		       mov     [ebp+SystemTime.wYear], dx
.text:0040ECAD		       mov     dx, [eax+10h]
.text:0040ECB1		       inc     dx
.text:0040ECB3		       mov     [ebp+SystemTime.wMonth],	dx
.text:0040ECB7		       mov     dx, [eax+0Ch]
.text:0040ECBB		       mov     [ebp+SystemTime.wDay], dx
.text:0040ECBF		       mov     dx, [eax+8]
.text:0040ECC3		       push    ebx	       ; cchDate
.text:0040ECC4		       mov     [ebp+SystemTime.wHour], dx
.text:0040ECC8		       mov     dx, [eax+4]
.text:0040ECCC		       mov     ax, [eax]
.text:0040ECCF		       push    ebx	       ; lpDateStr
.text:0040ECD0		       push    edi	       ; lpFormat
.text:0040ECD1		       mov     [ebp+SystemTime.wSecond], ax
.text:0040ECD5		       lea     eax, [ebp+SystemTime]
.text:0040ECD8		       push    eax	       ; lpDate
.text:0040ECD9		       push    ebx	       ; dwFlags
.text:0040ECDA		       push    dword ptr [esi+0ACh] ; Locale
.text:0040ECE0		       mov     [ebp+FormatFunc], ecx
.text:0040ECE3		       mov     [ebp+SystemTime.wMinute], dx
.text:0040ECE7		       mov     [ebp+SystemTime.wMilliseconds], bx
.text:0040ECEB		       call    ecx ; GetDateFormatA(x,x,x,x,x,x) ; GetDateFormatA(x,x,x,x,x,x)
.text:0040ECED		       cmp     eax, ebx
.text:0040ECEF		       mov     [ebp+cch], eax
.text:0040ECF2		       jz      loc_40ED8A
.text:0040ECF8		       add     eax, 8
.text:0040ECFB		       cmp     eax, 400h
.text:0040ED00		       jg      short loc_40ED15
.text:0040ED02		       call    __alloca_probe_16
.text:0040ED07		       mov     eax, esp
.text:0040ED09		       cmp     eax, ebx
.text:0040ED0B		       jz      short loc_40ED29
.text:0040ED0D		       mov     dword ptr [eax],	0CCCCh
.text:0040ED13		       jmp     short loc_40ED26
.text:0040ED15 ; ---------------------------------------------------------------------------
.text:0040ED15
.text:0040ED15 loc_40ED15:			       ; CODE XREF: _store_winword+BAj
.text:0040ED15		       push    eax	       ; size
.text:0040ED16		       call    _malloc
.text:0040ED1B		       cmp     eax, ebx
.text:0040ED1D		       pop     ecx
.text:0040ED1E		       jz      short loc_40ED29
.text:0040ED20		       mov     dword ptr [eax],	0DDDDh
.text:0040ED26
.text:0040ED26 loc_40ED26:			       ; CODE XREF: _store_winword+CDj
.text:0040ED26		       add     eax, 8
.text:0040ED29
.text:0040ED29 loc_40ED29:			       ; CODE XREF: _store_winword+C5j
.text:0040ED29					       ; _store_winword+D8j
.text:0040ED29		       cmp     eax, ebx
.text:0040ED2B		       mov     [ebp+buffer], eax
.text:0040ED2E		       jz      short loc_40ED8A
.text:0040ED30		       push    [ebp+cch]
.text:0040ED33		       mov     ebx, eax
.text:0040ED35		       push    ebx
.text:0040ED36		       push    edi
.text:0040ED37		       lea     eax, [ebp+SystemTime]
.text:0040ED3A		       push    eax
.text:0040ED3B		       push    0
.text:0040ED3D		       push    dword ptr [esi+0ACh]
.text:0040ED43		       call    [ebp+FormatFunc]
.text:0040ED46		       dec     eax
.text:0040ED47		       test    eax, eax
.text:0040ED49		       jle     short loc_40ED6C
.text:0040ED4B		       mov     esi, [ebp+count]
.text:0040ED4E		       mov     ecx, [ebp+out]
.text:0040ED51
.text:0040ED51 loc_40ED51:			       ; CODE XREF: _store_winword+124j
.text:0040ED51		       cmp     dword ptr [esi],	0
.text:0040ED54		       jbe     short loc_40ED6C
.text:0040ED56		       mov     edx, [ecx]
.text:0040ED58		       mov     [ebp+cch], eax
.text:0040ED5B		       mov     al, [ebx]
.text:0040ED5D		       mov     [edx], al
.text:0040ED5F		       inc     dword ptr [ecx]
.text:0040ED61		       mov     eax, [ebp+cch]
.text:0040ED64		       inc     ebx
.text:0040ED65		       dec     dword ptr [esi]
.text:0040ED67		       dec     eax
.text:0040ED68		       test    eax, eax
.text:0040ED6A		       jg      short loc_40ED51
.text:0040ED6C
.text:0040ED6C loc_40ED6C:			       ; CODE XREF: _store_winword+103j
.text:0040ED6C					       ; _store_winword+10Ej
.text:0040ED6C		       push    [ebp+buffer]    ; _Memory
.text:0040ED6F		       call    __freea
.text:0040ED74		       pop     ecx
.text:0040ED75
.text:0040ED75 loc_40ED75:			       ; CODE XREF: _store_winword+148j
.text:0040ED75					       ; _store_winword+153j ...
.text:0040ED75		       xor     eax, eax
.text:0040ED77		       inc     eax
.text:0040ED78
.text:0040ED78 loc_40ED78:			       ; CODE XREF: _store_winword+458j
.text:0040ED78		       lea     esp, [ebp-2Ch]
.text:0040ED7B		       pop     edi
.text:0040ED7C		       pop     esi
.text:0040ED7D		       pop     ebx
.text:0040ED7E		       mov     ecx, [ebp+var_4]
.text:0040ED81		       xor     ecx, ebp	       ; cookie
.text:0040ED83		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040ED88		       leave
.text:0040ED89		       retn
.text:0040ED8A ; ---------------------------------------------------------------------------
.text:0040ED8A
.text:0040ED8A loc_40ED8A:			       ; CODE XREF: _store_winword+42j
.text:0040ED8A					       ; _store_winword+ACj ...
.text:0040ED8A		       mov     al, [edi]
.text:0040ED8C		       test    al, al
.text:0040ED8E		       jz      short loc_40ED75
.text:0040ED90		       mov     ebx, [ebp+count]
.text:0040ED93		       mov     esi, [ebp+out]
.text:0040ED96
.text:0040ED96 loc_40ED96:			       ; CODE XREF: _store_winword+1D7j
.text:0040ED96		       cmp     dword ptr [ebx],	0
.text:0040ED99		       jz      short loc_40ED75
.text:0040ED9B		       xor     edx, edx
.text:0040ED9D		       mov     [ebp+buffer], edx
.text:0040EDA0		       mov     ecx, edi
.text:0040EDA2
.text:0040EDA2 loc_40EDA2:			       ; CODE XREF: _store_winword+160j
.text:0040EDA2		       inc     ecx
.text:0040EDA3		       inc     edx
.text:0040EDA4		       cmp     [ecx], al
.text:0040EDA6		       jz      short loc_40EDA2
.text:0040EDA8		       mov     [ebp+FormatFunc], ecx
.text:0040EDAB		       movsx   ecx, al
.text:0040EDAE		       cmp     ecx, 64h
.text:0040EDB1		       jg      loc_40EF39
.text:0040EDB7		       jz      loc_40EF0B
.text:0040EDBD		       cmp     ecx, 27h
.text:0040EDC0		       jz      loc_40EE9E
.text:0040EDC6		       cmp     ecx, 41h
.text:0040EDC9		       jz      loc_40EE6A
.text:0040EDCF		       cmp     ecx, 48h
.text:0040EDD2		       jz      short loc_40EE52
.text:0040EDD4		       cmp     ecx, 4Dh
.text:0040EDD7		       jz      short loc_40EE28
.text:0040EDD9		       cmp     ecx, 61h
.text:0040EDDC		       jz      loc_40EE6A
.text:0040EDE2
.text:0040EDE2 loc_40EDE2:			       ; CODE XREF: _store_winword+1EEj
.text:0040EDE2					       ; _store_winword+214j ...
.text:0040EDE2		       push    [ebp+plocinfo]  ; plocinfo
.text:0040EDE5		       push    ecx	       ; c
.text:0040EDE6		       call    __isleadbyte_l
.text:0040EDEB		       test    eax, eax
.text:0040EDED		       pop     ecx
.text:0040EDEE		       pop     ecx
.text:0040EDEF		       jz      short loc_40EE0E
.text:0040EDF1		       cmp     dword ptr [ebx],	1
.text:0040EDF4		       jbe     short loc_40EE0E
.text:0040EDF6		       lea     eax, [edi+1]
.text:0040EDF9		       cmp     byte ptr	[eax], 0
.text:0040EDFC		       jz      loc_40F09C
.text:0040EE02		       mov     dl, [edi]
.text:0040EE04		       mov     ecx, [esi]
.text:0040EE06		       mov     [ecx], dl
.text:0040EE08		       inc     dword ptr [esi]
.text:0040EE0A		       dec     dword ptr [ebx]
.text:0040EE0C		       mov     edi, eax
.text:0040EE0E
.text:0040EE0E loc_40EE0E:			       ; CODE XREF: _store_winword+1A9j
.text:0040EE0E					       ; _store_winword+1AEj
.text:0040EE0E		       mov     cl, [edi]
.text:0040EE10		       mov     eax, [esi]
.text:0040EE12		       mov     [eax], cl
.text:0040EE14		       inc     dword ptr [esi]
.text:0040EE16		       inc     edi
.text:0040EE17		       dec     dword ptr [ebx]
.text:0040EE19
.text:0040EE19 loc_40EE19:			       ; CODE XREF: _store_winword+25Dj
.text:0040EE19					       ; _store_winword+270j ...
.text:0040EE19		       mov     al, [edi]
.text:0040EE1B		       test    al, al
.text:0040EE1D		       jnz     loc_40ED96
.text:0040EE23		       jmp     loc_40ED75
.text:0040EE28 ; ---------------------------------------------------------------------------
.text:0040EE28
.text:0040EE28 loc_40EE28:			       ; CODE XREF: _store_winword+191j
.text:0040EE28		       mov     eax, edx
.text:0040EE2A		       dec     eax
.text:0040EE2B		       jz      short loc_40EE44
.text:0040EE2D		       dec     eax
.text:0040EE2E		       jz      short loc_40EE4B
.text:0040EE30		       dec     eax
.text:0040EE31		       jz      short loc_40EE3D
.text:0040EE33		       dec     eax
.text:0040EE34		       jnz     short loc_40EDE2
.text:0040EE36		       mov     al, 42h
.text:0040EE38		       jmp     loc_40F079
.text:0040EE3D ; ---------------------------------------------------------------------------
.text:0040EE3D
.text:0040EE3D loc_40EE3D:			       ; CODE XREF: _store_winword+1EBj
.text:0040EE3D		       mov     al, 62h
.text:0040EE3F		       jmp     loc_40F079
.text:0040EE44 ; ---------------------------------------------------------------------------
.text:0040EE44
.text:0040EE44 loc_40EE44:			       ; CODE XREF: _store_winword+1E5j
.text:0040EE44		       mov     [ebp+buffer], 1
.text:0040EE4B
.text:0040EE4B loc_40EE4B:			       ; CODE XREF: _store_winword+1E8j
.text:0040EE4B		       mov     al, 6Dh
.text:0040EE4D		       jmp     loc_40F079
.text:0040EE52 ; ---------------------------------------------------------------------------
.text:0040EE52
.text:0040EE52 loc_40EE52:			       ; CODE XREF: _store_winword+18Cj
.text:0040EE52		       mov     eax, edx
.text:0040EE54		       dec     eax
.text:0040EE55		       jz      short loc_40EE5C
.text:0040EE57		       dec     eax
.text:0040EE58		       jz      short loc_40EE63
.text:0040EE5A		       jmp     short loc_40EDE2
.text:0040EE5C ; ---------------------------------------------------------------------------
.text:0040EE5C
.text:0040EE5C loc_40EE5C:			       ; CODE XREF: _store_winword+20Fj
.text:0040EE5C		       mov     [ebp+buffer], 1
.text:0040EE63
.text:0040EE63 loc_40EE63:			       ; CODE XREF: _store_winword+212j
.text:0040EE63		       mov     al, 48h
.text:0040EE65		       jmp     loc_40F079
.text:0040EE6A ; ---------------------------------------------------------------------------
.text:0040EE6A
.text:0040EE6A loc_40EE6A:			       ; CODE XREF: _store_winword+183j
.text:0040EE6A					       ; _store_winword+196j
.text:0040EE6A		       push    offset src      ; "am/pm"
.text:0040EE6F		       push    edi	       ; dst
.text:0040EE70		       call    ___ascii_stricmp
.text:0040EE75		       test    eax, eax
.text:0040EE77		       pop     ecx
.text:0040EE78		       pop     ecx
.text:0040EE79		       jnz     short loc_40EE80
.text:0040EE7B		       add     edi, 5
.text:0040EE7E		       jmp     short loc_40EE94
.text:0040EE80 ; ---------------------------------------------------------------------------
.text:0040EE80
.text:0040EE80 loc_40EE80:			       ; CODE XREF: _store_winword+233j
.text:0040EE80		       push    offset aAP      ; "a/p"
.text:0040EE85		       push    edi	       ; dst
.text:0040EE86		       call    ___ascii_stricmp
.text:0040EE8B		       test    eax, eax
.text:0040EE8D		       pop     ecx
.text:0040EE8E		       pop     ecx
.text:0040EE8F		       jnz     short loc_40EE97
.text:0040EE91		       add     edi, 3
.text:0040EE94
.text:0040EE94 loc_40EE94:			       ; CODE XREF: _store_winword+238j
.text:0040EE94		       mov     [ebp+FormatFunc], edi
.text:0040EE97
.text:0040EE97 loc_40EE97:			       ; CODE XREF: _store_winword+249j
.text:0040EE97		       mov     al, 70h
.text:0040EE99		       jmp     loc_40F079
.text:0040EE9E ; ---------------------------------------------------------------------------
.text:0040EE9E
.text:0040EE9E loc_40EE9E:			       ; CODE XREF: _store_winword+17Aj
.text:0040EE9E		       add     edi, edx
.text:0040EEA0		       test    dl, 1
.text:0040EEA3		       jz      loc_40EE19
.text:0040EEA9		       mov     al, [edi]
.text:0040EEAB		       test    al, al
.text:0040EEAD		       jz      loc_40ED75
.text:0040EEB3
.text:0040EEB3 loc_40EEB3:			       ; CODE XREF: _store_winword+2B8j
.text:0040EEB3		       cmp     dword ptr [ebx],	0
.text:0040EEB6		       jz      loc_40EE19
.text:0040EEBC		       cmp     al, 27h
.text:0040EEBE		       jz      short loc_40EF05
.text:0040EEC0		       push    [ebp+plocinfo]  ; plocinfo
.text:0040EEC3		       movsx   eax, al
.text:0040EEC6		       push    eax	       ; c
.text:0040EEC7		       call    __isleadbyte_l
.text:0040EECC		       test    eax, eax
.text:0040EECE		       pop     ecx
.text:0040EECF		       pop     ecx
.text:0040EED0		       jz      short loc_40EEEF
.text:0040EED2		       cmp     dword ptr [ebx],	1
.text:0040EED5		       jbe     short loc_40EEEF
.text:0040EED7		       lea     eax, [edi+1]
.text:0040EEDA		       cmp     byte ptr	[eax], 0
.text:0040EEDD		       jz      loc_40F09C
.text:0040EEE3		       mov     dl, [edi]
.text:0040EEE5		       mov     ecx, [esi]
.text:0040EEE7		       mov     [ecx], dl
.text:0040EEE9		       inc     dword ptr [esi]
.text:0040EEEB		       dec     dword ptr [ebx]
.text:0040EEED		       mov     edi, eax
.text:0040EEEF
.text:0040EEEF loc_40EEEF:			       ; CODE XREF: _store_winword+28Aj
.text:0040EEEF					       ; _store_winword+28Fj
.text:0040EEEF		       mov     eax, [esi]
.text:0040EEF1		       mov     cl, [edi]
.text:0040EEF3		       mov     [eax], cl
.text:0040EEF5		       inc     dword ptr [esi]
.text:0040EEF7		       inc     edi
.text:0040EEF8		       dec     dword ptr [ebx]
.text:0040EEFA		       mov     al, [edi]
.text:0040EEFC		       test    al, al
.text:0040EEFE		       jnz     short loc_40EEB3
.text:0040EF00		       jmp     loc_40EE19
.text:0040EF05 ; ---------------------------------------------------------------------------
.text:0040EF05
.text:0040EF05 loc_40EF05:			       ; CODE XREF: _store_winword+278j
.text:0040EF05		       inc     edi
.text:0040EF06		       jmp     loc_40EE19
.text:0040EF0B ; ---------------------------------------------------------------------------
.text:0040EF0B
.text:0040EF0B loc_40EF0B:			       ; CODE XREF: _store_winword+171j
.text:0040EF0B		       mov     eax, edx
.text:0040EF0D		       dec     eax
.text:0040EF0E		       jz      short loc_40EF2B
.text:0040EF10		       dec     eax
.text:0040EF11		       jz      short loc_40EF32
.text:0040EF13		       dec     eax
.text:0040EF14		       jz      short loc_40EF24
.text:0040EF16		       dec     eax
.text:0040EF17		       jnz     loc_40EDE2
.text:0040EF1D		       mov     al, 41h
.text:0040EF1F		       jmp     loc_40F079
.text:0040EF24 ; ---------------------------------------------------------------------------
.text:0040EF24
.text:0040EF24 loc_40EF24:			       ; CODE XREF: _store_winword+2CEj
.text:0040EF24		       mov     al, 61h
.text:0040EF26		       jmp     loc_40F079
.text:0040EF2B ; ---------------------------------------------------------------------------
.text:0040EF2B
.text:0040EF2B loc_40EF2B:			       ; CODE XREF: _store_winword+2C8j
.text:0040EF2B		       mov     [ebp+buffer], 1
.text:0040EF32
.text:0040EF32 loc_40EF32:			       ; CODE XREF: _store_winword+2CBj
.text:0040EF32		       mov     al, 64h
.text:0040EF34		       jmp     loc_40F079
.text:0040EF39 ; ---------------------------------------------------------------------------
.text:0040EF39
.text:0040EF39 loc_40EF39:			       ; CODE XREF: _store_winword+16Bj
.text:0040EF39		       mov     eax, ecx
.text:0040EF3B		       sub     eax, 68h
.text:0040EF3E		       jz      loc_40F063
.text:0040EF44		       sub     eax, 5
.text:0040EF47		       jz      loc_40F04B
.text:0040EF4D		       sub     eax, 6
.text:0040EF50		       jz      loc_40F033
.text:0040EF56		       dec     eax
.text:0040EF57		       jz      short loc_40EF7E
.text:0040EF59		       sub     eax, 5
.text:0040EF5C		       jnz     loc_40EDE2
.text:0040EF62		       mov     eax, edx
.text:0040EF64		       dec     eax
.text:0040EF65		       dec     eax
.text:0040EF66		       jz      short loc_40EF77
.text:0040EF68		       dec     eax
.text:0040EF69		       dec     eax
.text:0040EF6A		       jnz     loc_40EDE2
.text:0040EF70		       mov     al, 59h
.text:0040EF72		       jmp     loc_40F079
.text:0040EF77 ; ---------------------------------------------------------------------------
.text:0040EF77
.text:0040EF77 loc_40EF77:			       ; CODE XREF: _store_winword+320j
.text:0040EF77		       mov     al, 79h
.text:0040EF79		       jmp     loc_40F079
.text:0040EF7E ; ---------------------------------------------------------------------------
.text:0040EF7E
.text:0040EF7E loc_40EF7E:			       ; CODE XREF: _store_winword+311j
.text:0040EF7E		       mov     eax, [ebp+tmptr]
.text:0040EF81		       cmp     dword ptr [eax+8], 0Bh
.text:0040EF85		       mov     eax, [ebp+lc_time]
.text:0040EF88		       jg      short loc_40EF92
.text:0040EF8A		       mov     edi, [eax+98h]
.text:0040EF90		       jmp     short loc_40EF98
.text:0040EF92 ; ---------------------------------------------------------------------------
.text:0040EF92
.text:0040EF92 loc_40EF92:			       ; CODE XREF: _store_winword+342j
.text:0040EF92		       mov     edi, [eax+9Ch]
.text:0040EF98
.text:0040EF98 loc_40EF98:			       ; CODE XREF: _store_winword+34Aj
.text:0040EF98		       cmp     edx, 1
.text:0040EF9B		       jnz     loc_40F02B
.text:0040EFA1		       cmp     dword ptr [ebx],	0
.text:0040EFA4		       jbe     loc_40F02B
.text:0040EFAA		       movsx   eax, byte ptr [edi]
.text:0040EFAD		       push    [ebp+plocinfo]  ; plocinfo
.text:0040EFB0		       push    eax	       ; c
.text:0040EFB1		       call    __isleadbyte_l
.text:0040EFB6		       test    eax, eax
.text:0040EFB8		       pop     ecx
.text:0040EFB9		       pop     ecx
.text:0040EFBA		       jz      short loc_40EFD9
.text:0040EFBC		       cmp     dword ptr [ebx],	1
.text:0040EFBF		       jbe     short loc_40EFD9
.text:0040EFC1		       lea     eax, [edi+1]
.text:0040EFC4		       cmp     byte ptr	[eax], 0
.text:0040EFC7		       jz      loc_40F09C
.text:0040EFCD		       mov     dl, [edi]
.text:0040EFCF		       mov     ecx, [esi]
.text:0040EFD1		       mov     [ecx], dl
.text:0040EFD3		       inc     dword ptr [esi]
.text:0040EFD5		       dec     dword ptr [ebx]
.text:0040EFD7		       mov     edi, eax
.text:0040EFD9
.text:0040EFD9 loc_40EFD9:			       ; CODE XREF: _store_winword+374j
.text:0040EFD9					       ; _store_winword+379j
.text:0040EFD9		       mov     eax, [esi]
.text:0040EFDB		       mov     cl, [edi]
.text:0040EFDD		       mov     [eax], cl
.text:0040EFDF		       inc     dword ptr [esi]
.text:0040EFE1		       dec     dword ptr [ebx]
.text:0040EFE3		       jmp     loc_40F094
.text:0040EFE8 ; ---------------------------------------------------------------------------
.text:0040EFE8
.text:0040EFE8 loc_40EFE8:			       ; CODE XREF: _store_winword+3E9j
.text:0040EFE8		       cmp     dword ptr [ebx],	0
.text:0040EFEB		       jbe     loc_40F094
.text:0040EFF1		       push    [ebp+plocinfo]  ; plocinfo
.text:0040EFF4		       movsx   eax, al
.text:0040EFF7		       push    eax	       ; c
.text:0040EFF8		       call    __isleadbyte_l
.text:0040EFFD		       test    eax, eax
.text:0040EFFF		       pop     ecx
.text:0040F000		       pop     ecx
.text:0040F001		       jz      short loc_40F020
.text:0040F003		       cmp     dword ptr [ebx],	1
.text:0040F006		       jbe     short loc_40F020
.text:0040F008		       lea     eax, [edi+1]
.text:0040F00B		       cmp     byte ptr	[eax], 0
.text:0040F00E		       jz      loc_40F09C
.text:0040F014		       mov     dl, [edi]
.text:0040F016		       mov     ecx, [esi]
.text:0040F018		       mov     [ecx], dl
.text:0040F01A		       inc     dword ptr [esi]
.text:0040F01C		       dec     dword ptr [ebx]
.text:0040F01E		       mov     edi, eax
.text:0040F020
.text:0040F020 loc_40F020:			       ; CODE XREF: _store_winword+3BBj
.text:0040F020					       ; _store_winword+3C0j
.text:0040F020		       mov     cl, [edi]
.text:0040F022		       mov     eax, [esi]
.text:0040F024		       mov     [eax], cl
.text:0040F026		       inc     dword ptr [esi]
.text:0040F028		       inc     edi
.text:0040F029		       dec     dword ptr [ebx]
.text:0040F02B
.text:0040F02B loc_40F02B:			       ; CODE XREF: _store_winword+355j
.text:0040F02B					       ; _store_winword+35Ej
.text:0040F02B		       mov     al, [edi]
.text:0040F02D		       test    al, al
.text:0040F02F		       jnz     short loc_40EFE8
.text:0040F031		       jmp     short loc_40F094
.text:0040F033 ; ---------------------------------------------------------------------------
.text:0040F033
.text:0040F033 loc_40F033:			       ; CODE XREF: _store_winword+30Aj
.text:0040F033		       mov     eax, edx
.text:0040F035		       dec     eax
.text:0040F036		       jz      short loc_40F040
.text:0040F038		       dec     eax
.text:0040F039		       jz      short loc_40F047
.text:0040F03B		       jmp     loc_40EDE2
.text:0040F040 ; ---------------------------------------------------------------------------
.text:0040F040
.text:0040F040 loc_40F040:			       ; CODE XREF: _store_winword+3F0j
.text:0040F040		       mov     [ebp+buffer], 1
.text:0040F047
.text:0040F047 loc_40F047:			       ; CODE XREF: _store_winword+3F3j
.text:0040F047		       mov     al, 53h
.text:0040F049		       jmp     short loc_40F079
.text:0040F04B ; ---------------------------------------------------------------------------
.text:0040F04B
.text:0040F04B loc_40F04B:			       ; CODE XREF: _store_winword+301j
.text:0040F04B		       mov     eax, edx
.text:0040F04D		       dec     eax
.text:0040F04E		       jz      short loc_40F058
.text:0040F050		       dec     eax
.text:0040F051		       jz      short loc_40F05F
.text:0040F053		       jmp     loc_40EDE2
.text:0040F058 ; ---------------------------------------------------------------------------
.text:0040F058
.text:0040F058 loc_40F058:			       ; CODE XREF: _store_winword+408j
.text:0040F058		       mov     [ebp+buffer], 1
.text:0040F05F
.text:0040F05F loc_40F05F:			       ; CODE XREF: _store_winword+40Bj
.text:0040F05F		       mov     al, 4Dh
.text:0040F061		       jmp     short loc_40F079
.text:0040F063 ; ---------------------------------------------------------------------------
.text:0040F063
.text:0040F063 loc_40F063:			       ; CODE XREF: _store_winword+2F8j
.text:0040F063		       mov     eax, edx
.text:0040F065		       dec     eax
.text:0040F066		       jz      short loc_40F070
.text:0040F068		       dec     eax
.text:0040F069		       jz      short loc_40F077
.text:0040F06B		       jmp     loc_40EDE2
.text:0040F070 ; ---------------------------------------------------------------------------
.text:0040F070
.text:0040F070 loc_40F070:			       ; CODE XREF: _store_winword+420j
.text:0040F070		       mov     [ebp+buffer], 1
.text:0040F077
.text:0040F077 loc_40F077:			       ; CODE XREF: _store_winword+423j
.text:0040F077		       mov     al, 49h	       ; specifier
.text:0040F079
.text:0040F079 loc_40F079:			       ; CODE XREF: _store_winword+1F2j
.text:0040F079					       ; _store_winword+1F9j ...
.text:0040F079		       push    [ebp+buffer]    ; alternate_form
.text:0040F07C		       mov     edx, [ebp+tmptr]	; timeptr
.text:0040F07F		       push    [ebp+lc_time]   ; lc_time
.text:0040F082		       mov     ecx, esi	       ; string
.text:0040F084		       push    ebx	       ; left
.text:0040F085		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F088		       call    _expandtime
.text:0040F08D		       add     esp, 10h
.text:0040F090		       test    eax, eax
.text:0040F092		       jz      short loc_40F09C
.text:0040F094
.text:0040F094 loc_40F094:			       ; CODE XREF: _store_winword+39Dj
.text:0040F094					       ; _store_winword+3A5j ...
.text:0040F094		       mov     edi, [ebp+FormatFunc]
.text:0040F097		       jmp     loc_40EE19
.text:0040F09C ; ---------------------------------------------------------------------------
.text:0040F09C
.text:0040F09C loc_40F09C:			       ; CODE XREF: _store_winword+1B6j
.text:0040F09C					       ; _store_winword+297j ...
.text:0040F09C		       xor     eax, eax
.text:0040F09E		       jmp     loc_40ED78
.text:0040F09E _store_winword  endp
.text:0040F09E
.text:0040F0A3
.text:0040F0A3 ; =============== S U B R O U T I N E =======================================
.text:0040F0A3
.text:0040F0A3 ; Attributes: bp-based frame
.text:0040F0A3
.text:0040F0A3 ; unsigned int __cdecl _Strftime_l(char *string,	unsigned int maxsize, const char *format, tm *timeptr, void *lc_time_arg, localeinfo_struct *plocinfo)
.text:0040F0A3 __Strftime_l    proc near	       ; CODE XREF: __strftime_l+14p
.text:0040F0A3					       ; _strftime+14p	...
.text:0040F0A3
.text:0040F0A3 _loc_update     = _LocaleUpdate ptr -20h
.text:0040F0A3 strstart	       = dword ptr -10h
.text:0040F0A3 lc_time	       = dword ptr -0Ch
.text:0040F0A3 failed	       = dword ptr -8
.text:0040F0A3 left	       = dword ptr -4
.text:0040F0A3 string	       = dword ptr  8
.text:0040F0A3 maxsize	       = dword ptr  0Ch
.text:0040F0A3 format	       = dword ptr  10h
.text:0040F0A3 timeptr	       = dword ptr  14h
.text:0040F0A3 lc_time_arg     = dword ptr  18h
.text:0040F0A3 plocinfo	       = dword ptr  1Ch
.text:0040F0A3
.text:0040F0A3		       push    ebp
.text:0040F0A4		       mov     ebp, esp
.text:0040F0A6		       sub     esp, 20h
.text:0040F0A9		       mov     eax, [ebp+string]
.text:0040F0AC		       push    ebx
.text:0040F0AD		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F0B0		       xor     ebx, ebx
.text:0040F0B2		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040F0B5		       mov     [ebp+failed], ebx
.text:0040F0B8		       mov     [ebp+strstart], eax
.text:0040F0BB		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040F0C0		       mov     eax, [ebp+string]
.text:0040F0C3		       cmp     eax, ebx
.text:0040F0C5		       jnz     short loc_40F0F2
.text:0040F0C7		       call    __errno
.text:0040F0CC		       push    ebx	       ; pReserved
.text:0040F0CD		       push    ebx	       ; nLine
.text:0040F0CE		       push    ebx	       ; pszFile
.text:0040F0CF		       push    ebx	       ; pszFunction
.text:0040F0D0		       push    ebx	       ; pszExpression
.text:0040F0D1		       mov     dword ptr [eax],	16h
.text:0040F0D7		       call    __invalid_parameter
.text:0040F0DC		       add     esp, 14h
.text:0040F0DF		       cmp     [ebp+_loc_update.updated], bl
.text:0040F0E2		       jz      short loc_40F0EB
.text:0040F0E4		       mov     eax, [ebp+_loc_update.ptd]
.text:0040F0E7		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040F0EB
.text:0040F0EB loc_40F0EB:			       ; CODE XREF: __Strftime_l+3Fj
.text:0040F0EB		       xor     eax, eax
.text:0040F0ED		       jmp     loc_40F24F
.text:0040F0F2 ; ---------------------------------------------------------------------------
.text:0040F0F2
.text:0040F0F2 loc_40F0F2:			       ; CODE XREF: __Strftime_l+22j
.text:0040F0F2		       push    edi
.text:0040F0F3		       mov     edi, [ebp+maxsize]
.text:0040F0F6		       cmp     edi, ebx
.text:0040F0F8		       jnz     short loc_40F125
.text:0040F0FA		       call    __errno
.text:0040F0FF		       push    ebx	       ; pReserved
.text:0040F100		       push    ebx	       ; nLine
.text:0040F101		       push    ebx	       ; pszFile
.text:0040F102		       push    ebx	       ; pszFunction
.text:0040F103		       push    ebx	       ; pszExpression
.text:0040F104		       mov     dword ptr [eax],	16h
.text:0040F10A		       call    __invalid_parameter
.text:0040F10F		       add     esp, 14h
.text:0040F112		       cmp     [ebp+_loc_update.updated], bl
.text:0040F115		       jz      short loc_40F11E
.text:0040F117		       mov     eax, [ebp+_loc_update.ptd]
.text:0040F11A		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040F11E
.text:0040F11E loc_40F11E:			       ; CODE XREF: __Strftime_l+72j
.text:0040F11E		       xor     eax, eax
.text:0040F120		       jmp     loc_40F24E
.text:0040F125 ; ---------------------------------------------------------------------------
.text:0040F125
.text:0040F125 loc_40F125:			       ; CODE XREF: __Strftime_l+55j
.text:0040F125		       push    esi
.text:0040F126		       mov     esi, [ebp+format]
.text:0040F129		       cmp     esi, ebx
.text:0040F12B		       mov     [eax], bl
.text:0040F12D		       jz      loc_40F227
.text:0040F133		       mov     eax, [ebp+lc_time_arg]
.text:0040F136		       cmp     eax, ebx
.text:0040F138		       jnz     short loc_40F143
.text:0040F13A		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040F13D		       mov     eax, [eax+0D4h]
.text:0040F143
.text:0040F143 loc_40F143:			       ; CODE XREF: __Strftime_l+95j
.text:0040F143		       cmp     edi, ebx
.text:0040F145		       mov     [ebp+lc_time], eax
.text:0040F148		       mov     [ebp+left], edi
.text:0040F14B		       jbe     loc_40F1F0
.text:0040F151
.text:0040F151 loc_40F151:			       ; CODE XREF: __Strftime_l+12Bj
.text:0040F151		       mov     al, [esi]
.text:0040F153		       cmp     al, bl
.text:0040F155		       jz      short loc_40F1D0
.text:0040F157		       cmp     al, 25h
.text:0040F159		       jz      short loc_40F19C
.text:0040F15B		       lea     ecx, [ebp+_loc_update]
.text:0040F15E		       movsx   eax, al
.text:0040F161		       push    ecx	       ; plocinfo
.text:0040F162		       push    eax	       ; c
.text:0040F163		       call    __isleadbyte_l
.text:0040F168		       test    eax, eax
.text:0040F16A		       pop     ecx
.text:0040F16B		       pop     ecx
.text:0040F16C		       jz      short loc_40F18C
.text:0040F16E		       xor     ecx, ecx
.text:0040F170		       inc     ecx
.text:0040F171		       cmp     [ebp+left], ecx
.text:0040F174		       jbe     short loc_40F18C
.text:0040F176		       lea     eax, [esi+1]
.text:0040F179		       cmp     [eax], bl
.text:0040F17B		       jz      short loc_40F1ED
.text:0040F17D		       mov     cl, [esi]
.text:0040F17F		       mov     edx, [ebp+string]
.text:0040F182		       mov     [edx], cl
.text:0040F184		       inc     [ebp+string]
.text:0040F187		       dec     [ebp+left]
.text:0040F18A		       mov     esi, eax
.text:0040F18C
.text:0040F18C loc_40F18C:			       ; CODE XREF: __Strftime_l+C9j
.text:0040F18C					       ; __Strftime_l+D1j
.text:0040F18C		       mov     al, [esi]
.text:0040F18E		       mov     ecx, [ebp+string]
.text:0040F191		       mov     [ecx], al
.text:0040F193		       inc     [ebp+string]
.text:0040F196		       inc     esi
.text:0040F197		       dec     [ebp+left]
.text:0040F19A		       jmp     short loc_40F1CB
.text:0040F19C ; ---------------------------------------------------------------------------
.text:0040F19C
.text:0040F19C loc_40F19C:			       ; CODE XREF: __Strftime_l+B6j
.text:0040F19C		       mov     edx, [ebp+timeptr] ; timeptr
.text:0040F19F		       cmp     edx, ebx
.text:0040F1A1		       jz      short loc_40F20C
.text:0040F1A3		       inc     esi
.text:0040F1A4		       xor     eax, eax
.text:0040F1A6		       cmp     byte ptr	[esi], 23h
.text:0040F1A9		       jnz     short loc_40F1AD
.text:0040F1AB		       inc     eax
.text:0040F1AC		       inc     esi
.text:0040F1AD
.text:0040F1AD loc_40F1AD:			       ; CODE XREF: __Strftime_l+106j
.text:0040F1AD		       push    eax	       ; alternate_form
.text:0040F1AE		       push    [ebp+lc_time]   ; lc_time
.text:0040F1B1		       lea     eax, [ebp+left]
.text:0040F1B4		       push    eax	       ; left
.text:0040F1B5		       lea     eax, [ebp+_loc_update]
.text:0040F1B8		       push    eax	       ; plocinfo
.text:0040F1B9		       mov     al, [esi]       ; specifier
.text:0040F1BB		       lea     ecx, [ebp+string] ; string
.text:0040F1BE		       call    _expandtime
.text:0040F1C3		       add     esp, 10h
.text:0040F1C6		       test    eax, eax
.text:0040F1C8		       jz      short loc_40F219
.text:0040F1CA		       inc     esi
.text:0040F1CB
.text:0040F1CB loc_40F1CB:			       ; CODE XREF: __Strftime_l+F7j
.text:0040F1CB		       cmp     [ebp+left], ebx
.text:0040F1CE		       ja      short loc_40F151
.text:0040F1D0
.text:0040F1D0 loc_40F1D0:			       ; CODE XREF: __Strftime_l+B2j
.text:0040F1D0		       cmp     [ebp+left], ebx
.text:0040F1D3		       jbe     short loc_40F1F0
.text:0040F1D5		       mov     eax, [ebp+string]
.text:0040F1D8		       mov     [eax], bl
.text:0040F1DA		       sub     edi, [ebp+left]
.text:0040F1DD		       cmp     [ebp+_loc_update.updated], bl
.text:0040F1E0		       mov     eax, edi
.text:0040F1E2		       jz      short loc_40F24D
.text:0040F1E4		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040F1E7		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040F1EB		       jmp     short loc_40F24D
.text:0040F1ED ; ---------------------------------------------------------------------------
.text:0040F1ED
.text:0040F1ED loc_40F1ED:			       ; CODE XREF: __Strftime_l+D8j
.text:0040F1ED		       mov     [ebp+failed], ecx
.text:0040F1F0
.text:0040F1F0 loc_40F1F0:			       ; CODE XREF: __Strftime_l+A8j
.text:0040F1F0					       ; __Strftime_l+130j ...
.text:0040F1F0		       cmp     [ebp+failed], ebx
.text:0040F1F3		       mov     eax, [ebp+strstart]
.text:0040F1F6		       mov     [eax], bl
.text:0040F1F8		       jnz     short loc_40F227
.text:0040F1FA		       cmp     [ebp+left], ebx
.text:0040F1FD		       ja      short loc_40F227
.text:0040F1FF		       call    __errno
.text:0040F204		       mov     dword ptr [eax],	22h
.text:0040F20A		       jmp     short loc_40F23F
.text:0040F20C ; ---------------------------------------------------------------------------
.text:0040F20C
.text:0040F20C loc_40F20C:			       ; CODE XREF: __Strftime_l+FEj
.text:0040F20C		       call    __errno
.text:0040F211		       mov     dword ptr [eax],	16h
.text:0040F217		       jmp     short loc_40F23F
.text:0040F219 ; ---------------------------------------------------------------------------
.text:0040F219
.text:0040F219 loc_40F219:			       ; CODE XREF: __Strftime_l+125j
.text:0040F219		       cmp     [ebp+left], ebx
.text:0040F21C		       jbe     short loc_40F1F0
.text:0040F21E		       mov     [ebp+failed], 1
.text:0040F225
.text:0040F225 done:
.text:0040F225		       jmp     short loc_40F1F0
.text:0040F227 ; ---------------------------------------------------------------------------
.text:0040F227
.text:0040F227 loc_40F227:			       ; CODE XREF: __Strftime_l+8Aj
.text:0040F227					       ; __Strftime_l+155j ...
.text:0040F227		       call    __errno
.text:0040F22C		       push    ebx	       ; pReserved
.text:0040F22D		       push    ebx	       ; nLine
.text:0040F22E		       push    ebx	       ; pszFile
.text:0040F22F		       push    ebx	       ; pszFunction
.text:0040F230		       push    ebx	       ; pszExpression
.text:0040F231		       mov     dword ptr [eax],	16h
.text:0040F237		       call    __invalid_parameter
.text:0040F23C		       add     esp, 14h
.text:0040F23F
.text:0040F23F loc_40F23F:			       ; CODE XREF: __Strftime_l+167j
.text:0040F23F					       ; __Strftime_l+174j
.text:0040F23F		       cmp     [ebp+_loc_update.updated], bl
.text:0040F242		       jz      short loc_40F24B
.text:0040F244		       mov     eax, [ebp+_loc_update.ptd]
.text:0040F247		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040F24B
.text:0040F24B loc_40F24B:			       ; CODE XREF: __Strftime_l+19Fj
.text:0040F24B		       xor     eax, eax
.text:0040F24D
.text:0040F24D loc_40F24D:			       ; CODE XREF: __Strftime_l+13Fj
.text:0040F24D					       ; __Strftime_l+148j
.text:0040F24D		       pop     esi
.text:0040F24E
.text:0040F24E loc_40F24E:			       ; CODE XREF: __Strftime_l+7Dj
.text:0040F24E		       pop     edi
.text:0040F24F
.text:0040F24F loc_40F24F:			       ; CODE XREF: __Strftime_l+4Aj
.text:0040F24F		       pop     ebx
.text:0040F250		       leave
.text:0040F251		       retn
.text:0040F251 __Strftime_l    endp
.text:0040F251
.text:0040F252
.text:0040F252 ; =============== S U B R O U T I N E =======================================
.text:0040F252
.text:0040F252 ; Attributes: bp-based frame
.text:0040F252
.text:0040F252 ; unsigned int __cdecl _strftime_l(char *string,	unsigned int maxsize, const char *format, tm *timeptr, localeinfo_struct *plocinfo)
.text:0040F252 __strftime_l    proc near
.text:0040F252
.text:0040F252 string	       = dword ptr  8
.text:0040F252 maxsize	       = dword ptr  0Ch
.text:0040F252 format	       = dword ptr  10h
.text:0040F252 timeptr	       = dword ptr  14h
.text:0040F252 plocinfo	       = dword ptr  18h
.text:0040F252
.text:0040F252		       push    ebp
.text:0040F253		       mov     ebp, esp
.text:0040F255		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F258		       push    0	       ; lc_time_arg
.text:0040F25A		       push    [ebp+timeptr]   ; timeptr
.text:0040F25D		       push    [ebp+format]    ; format
.text:0040F260		       push    [ebp+maxsize]   ; maxsize
.text:0040F263		       push    [ebp+string]    ; string
.text:0040F266		       call    __Strftime_l
.text:0040F26B		       add     esp, 18h
.text:0040F26E		       pop     ebp
.text:0040F26F		       retn
.text:0040F26F __strftime_l    endp
.text:0040F26F
.text:0040F270
.text:0040F270 ; =============== S U B R O U T I N E =======================================
.text:0040F270
.text:0040F270
.text:0040F270 ; unsigned int __cdecl strftime(char *string, unsigned int maxsize, const char *format, tm *timeptr)
.text:0040F270 _strftime       proc near
.text:0040F270
.text:0040F270 string	       = dword ptr  4
.text:0040F270 maxsize	       = dword ptr  8
.text:0040F270 format	       = dword ptr  0Ch
.text:0040F270 timeptr	       = dword ptr  10h
.text:0040F270
.text:0040F270		       push    0	       ; plocinfo
.text:0040F272		       push    0	       ; lc_time_arg
.text:0040F274		       push    [esp+8+timeptr] ; timeptr
.text:0040F278		       push    [esp+0Ch+format]	; format
.text:0040F27C		       push    [esp+10h+maxsize] ; maxsize
.text:0040F280		       push    [esp+14h+string]	; string
.text:0040F284		       call    __Strftime_l
.text:0040F289		       add     esp, 18h
.text:0040F28C		       retn
.text:0040F28C _strftime       endp
.text:0040F28C
.text:0040F28D
.text:0040F28D ; =============== S U B R O U T I N E =======================================
.text:0040F28D
.text:0040F28D ; Attributes: bp-based frame
.text:0040F28D
.text:0040F28D ; unsigned int __cdecl _Strftime(char *string, unsigned int maxsize, const char *format,	tm *timeptr, void *lc_time_arg)
.text:0040F28D __Strftime      proc near
.text:0040F28D
.text:0040F28D string	       = dword ptr  8
.text:0040F28D maxsize	       = dword ptr  0Ch
.text:0040F28D format	       = dword ptr  10h
.text:0040F28D timeptr	       = dword ptr  14h
.text:0040F28D lc_time_arg     = dword ptr  18h
.text:0040F28D
.text:0040F28D		       push    ebp
.text:0040F28E		       mov     ebp, esp
.text:0040F290		       push    0	       ; plocinfo
.text:0040F292		       push    [ebp+lc_time_arg] ; lc_time_arg
.text:0040F295		       push    [ebp+timeptr]   ; timeptr
.text:0040F298		       push    [ebp+format]    ; format
.text:0040F29B		       push    [ebp+maxsize]   ; maxsize
.text:0040F29E		       push    [ebp+string]    ; string
.text:0040F2A1		       call    __Strftime_l
.text:0040F2A6		       add     esp, 18h
.text:0040F2A9		       pop     ebp
.text:0040F2AA		       retn
.text:0040F2AA __Strftime      endp
.text:0040F2AA
.text:0040F2AB
.text:0040F2AB ; =============== S U B R O U T I N E =======================================
.text:0040F2AB
.text:0040F2AB
.text:0040F2AB ; lconv *__cdecl	localeconv()
.text:0040F2AB _localeconv     proc near
.text:0040F2AB		       call    __getptd
.text:0040F2B0		       mov     ecx, [eax+6Ch]
.text:0040F2B3		       cmp     ecx, ___ptlocinfo ; ___ptlocinfo
.text:0040F2B9		       jz      short loc_40F2CB
.text:0040F2BB		       mov     ecx, ___globallocalestatus
.text:0040F2C1		       test    [eax+70h], ecx
.text:0040F2C4		       jnz     short loc_40F2CB
.text:0040F2C6		       call    ___updatetlocinfo
.text:0040F2CB
.text:0040F2CB loc_40F2CB:			       ; CODE XREF: _localeconv+Ej
.text:0040F2CB					       ; _localeconv+19j
.text:0040F2CB		       mov     eax, ___lconv
.text:0040F2D0		       retn
.text:0040F2D0 _localeconv     endp
.text:0040F2D0
.text:0040F2D0 ; ---------------------------------------------------------------------------
.text:0040F2D1		       align 10h
.text:0040F2E0
.text:0040F2E0 ; =============== S U B R O U T I N E =======================================
.text:0040F2E0
.text:0040F2E0 ; Attributes: bp-based frame
.text:0040F2E0
.text:0040F2E0 ; void __cdecl strcspn(char *string, char *control)
.text:0040F2E0 _strcspn	       proc near	       ; CODE XREF: ___lc_strtolc+6Bp
.text:0040F2E0					       ; ___lc_strtolc+112p ...
.text:0040F2E0
.text:0040F2E0 var_24	       = dword ptr -24h
.text:0040F2E0 string	       = dword ptr  8
.text:0040F2E0 control	       = dword ptr  0Ch
.text:0040F2E0
.text:0040F2E0		       push    ebp
.text:0040F2E1		       mov     ebp, esp
.text:0040F2E3		       push    esi
.text:0040F2E4		       xor     eax, eax
.text:0040F2E6		       push    eax
.text:0040F2E7		       push    eax
.text:0040F2E8		       push    eax
.text:0040F2E9		       push    eax
.text:0040F2EA		       push    eax
.text:0040F2EB		       push    eax
.text:0040F2EC		       push    eax
.text:0040F2ED		       push    eax
.text:0040F2EE		       mov     edx, [ebp+control]
.text:0040F2F1		       lea     ecx, [ecx+0]
.text:0040F2F4
.text:0040F2F4 listnext:			       ; CODE XREF: _strcspn+21j
.text:0040F2F4		       mov     al, [edx]
.text:0040F2F6		       or      al, al
.text:0040F2F8		       jz      short listdone
.text:0040F2FA		       add     edx, 1
.text:0040F2FD		       bts     [esp+24h+var_24], eax
.text:0040F301		       jmp     short listnext
.text:0040F303 ; ---------------------------------------------------------------------------
.text:0040F303
.text:0040F303 listdone:			       ; CODE XREF: _strcspn+18j
.text:0040F303		       mov     esi, [ebp+string]
.text:0040F306		       or      ecx, 0FFFFFFFFh
.text:0040F309		       lea     ecx, [ecx+0]
.text:0040F30C
.text:0040F30C dstnext:				       ; CODE XREF: _strcspn+3Cj
.text:0040F30C		       add     ecx, 1
.text:0040F30F		       mov     al, [esi]
.text:0040F311		       or      al, al
.text:0040F313		       jz      short dstdone
.text:0040F315		       add     esi, 1
.text:0040F318		       bt      [esp+24h+var_24], eax
.text:0040F31C		       jnb     short dstnext
.text:0040F31E
.text:0040F31E dstdone:				       ; CODE XREF: _strcspn+33j
.text:0040F31E		       mov     eax, ecx
.text:0040F320		       add     esp, 20h
.text:0040F323		       pop     esi
.text:0040F324		       leave
.text:0040F325		       retn
.text:0040F325 _strcspn	       endp
.text:0040F325
.text:0040F326
.text:0040F326 ; =============== S U B R O U T I N E =======================================
.text:0040F326
.text:0040F326 ; Attributes: bp-based frame
.text:0040F326
.text:0040F326 ; int __cdecl TranslateName(tagLOCALETAB	*lpTable, int high, const char **ppchName)
.text:0040F326 TranslateName   proc near	       ; CODE XREF: ___get_qualified_locale+41p
.text:0040F326					       ; ___get_qualified_locale+79p
.text:0040F326
.text:0040F326 lpTable	       = dword ptr  8
.text:0040F326 high	       = dword ptr  0Ch
.text:0040F326 ppchName	       = dword ptr  10h
.text:0040F326
.text:0040F326		       push    ebp
.text:0040F327		       mov     ebp, esp
.text:0040F329		       xor     eax, eax
.text:0040F32B		       push    ebx
.text:0040F32C		       xor     ebx, ebx
.text:0040F32E		       inc     eax
.text:0040F32F		       cmp     [ebp+high], ebx
.text:0040F332		       jl      short loc_40F37A
.text:0040F334		       push    esi
.text:0040F335		       push    edi
.text:0040F336
.text:0040F336 loc_40F336:			       ; CODE XREF: TranslateName+50j
.text:0040F336		       test    eax, eax
.text:0040F338		       jz      short loc_40F378
.text:0040F33A		       mov     eax, [ebp+high]
.text:0040F33D		       add     eax, ebx
.text:0040F33F		       cdq
.text:0040F340		       sub     eax, edx
.text:0040F342		       mov     esi, eax
.text:0040F344		       mov     eax, [ebp+lpTable]
.text:0040F347		       sar     esi, 1
.text:0040F349		       lea     edi, [eax+esi*8]
.text:0040F34C		       push    dword ptr [edi] ; src
.text:0040F34E		       mov     eax, [ebp+ppchName]
.text:0040F351		       push    dword ptr [eax] ; dst
.text:0040F353		       call    __stricmp
.text:0040F358		       test    eax, eax
.text:0040F35A		       pop     ecx
.text:0040F35B		       pop     ecx
.text:0040F35C		       jnz     short loc_40F368
.text:0040F35E		       mov     ecx, [ebp+ppchName]
.text:0040F361		       add     edi, 4
.text:0040F364		       mov     [ecx], edi
.text:0040F366		       jmp     short loc_40F373
.text:0040F368 ; ---------------------------------------------------------------------------
.text:0040F368
.text:0040F368 loc_40F368:			       ; CODE XREF: TranslateName+36j
.text:0040F368		       jge     short loc_40F370
.text:0040F36A		       dec     esi
.text:0040F36B		       mov     [ebp+high], esi
.text:0040F36E		       jmp     short loc_40F373
.text:0040F370 ; ---------------------------------------------------------------------------
.text:0040F370
.text:0040F370 loc_40F370:			       ; CODE XREF: TranslateName:loc_40F368j
.text:0040F370		       lea     ebx, [esi+1]
.text:0040F373
.text:0040F373 loc_40F373:			       ; CODE XREF: TranslateName+40j
.text:0040F373					       ; TranslateName+48j
.text:0040F373		       cmp     ebx, [ebp+high]
.text:0040F376		       jle     short loc_40F336
.text:0040F378
.text:0040F378 loc_40F378:			       ; CODE XREF: TranslateName+12j
.text:0040F378		       pop     edi
.text:0040F379		       pop     esi
.text:0040F37A
.text:0040F37A loc_40F37A:			       ; CODE XREF: TranslateName+Cj
.text:0040F37A		       xor     ecx, ecx
.text:0040F37C		       test    eax, eax
.text:0040F37E		       setz    cl
.text:0040F381		       pop     ebx
.text:0040F382		       mov     eax, ecx
.text:0040F384		       pop     ebp
.text:0040F385		       retn
.text:0040F385 TranslateName   endp
.text:0040F385
.text:0040F386
.text:0040F386 ; =============== S U B R O U T I N E =======================================
.text:0040F386
.text:0040F386
.text:0040F386 ; void __usercall GetLcidFromDefault(setloc_struct *_psetloc_data<esi>)
.text:0040F386 GetLcidFromDefault proc near
.text:0040F386 _psetloc_data = esi
.text:0040F386		       or      dword ptr [_psetloc_data+8], 104h
.text:0040F38D		       call    ds:__imp__GetUserDefaultLCID@0 ;	GetUserDefaultLCID()
.text:0040F393		       mov     [_psetloc_data+1Ch], eax
.text:0040F396		       mov     [_psetloc_data+18h], eax
.text:0040F399		       retn
.text:0040F399 GetLcidFromDefault endp
.text:0040F399
.text:0040F39A
.text:0040F39A ; =============== S U B R O U T I N E =======================================
.text:0040F39A
.text:0040F39A ; Attributes: bp-based frame
.text:0040F39A
.text:0040F39A ; int __usercall	ProcessCodePage<eax>(char *lpCodePageStr<ecx>, setloc_struct *_psetloc_data<edi>)
.text:0040F39A ProcessCodePage proc near	       ; CODE XREF: ___get_qualified_locale+FDp
.text:0040F39A
.text:0040F39A chCodePage      = byte ptr -0Ch
.text:0040F39A var_4	       = dword ptr -4
.text:0040F39A
.text:0040F39A lpCodePageStr = ecx
.text:0040F39A _psetloc_data = edi
.text:0040F39A		       push    ebp
.text:0040F39B		       mov     ebp, esp
.text:0040F39D		       sub     esp, 0Ch
.text:0040F3A0		       mov     eax, ___security_cookie
.text:0040F3A5		       xor     eax, ebp
.text:0040F3A7		       mov     [ebp+var_4], eax
.text:0040F3AA		       push    esi
.text:0040F3AB		       mov     esi, lpCodePageStr
.text:0040F3AD		       test    esi, esi
.text:0040F3AF		       jz      short loc_40F3E2
.text:0040F3B1		       cmp     byte ptr	[esi], 0
.text:0040F3B4		       jz      short loc_40F3E2
.text:0040F3B6		       push    offset str2     ; "ACP"
.text:0040F3BB		       push    esi	       ; str1
.text:0040F3BC		       call    _strcmp
.text:0040F3C1		       test    eax, eax
.text:0040F3C3		       pop     lpCodePageStr
.text:0040F3C4		       pop     lpCodePageStr
.text:0040F3C5		       jz      short loc_40F3E2
.text:0040F3C7		       push    offset aOcp     ; "OCP"
.text:0040F3CC		       push    esi	       ; str1
.text:0040F3CD		       call    _strcmp
.text:0040F3D2		       test    eax, eax
.text:0040F3D4		       pop     lpCodePageStr
.text:0040F3D5		       pop     lpCodePageStr
.text:0040F3D6		       jnz     short loc_40F3FD
.text:0040F3D8		       push    8
.text:0040F3DA		       lea     eax, [ebp+chCodePage]
.text:0040F3DD		       push    eax
.text:0040F3DE		       push    0Bh
.text:0040F3E0		       jmp     short loc_40F3ED
.text:0040F3E2 ; ---------------------------------------------------------------------------
.text:0040F3E2
.text:0040F3E2 loc_40F3E2:			       ; CODE XREF: ProcessCodePage+15j
.text:0040F3E2					       ; ProcessCodePage+1Aj ...
.text:0040F3E2		       push    8	       ; cchData
.text:0040F3E4		       lea     eax, [ebp+chCodePage]
.text:0040F3E7		       push    eax	       ; lpLCData
.text:0040F3E8		       push    1004h	       ; LCType
.text:0040F3ED
.text:0040F3ED loc_40F3ED:			       ; CODE XREF: ProcessCodePage+46j
.text:0040F3ED		       push    dword ptr [_psetloc_data+1Ch] ; Locale
.text:0040F3F0		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040F3F6		       test    eax, eax
.text:0040F3F8		       jz      short loc_40F404
.text:0040F3FA		       lea     esi, [ebp+chCodePage]
.text:0040F3FD
.text:0040F3FD loc_40F3FD:			       ; CODE XREF: ProcessCodePage+3Cj
.text:0040F3FD		       push    esi	       ; nptr
.text:0040F3FE		       call    _atol
.text:0040F403		       pop     lpCodePageStr
.text:0040F404
.text:0040F404 loc_40F404:			       ; CODE XREF: ProcessCodePage+5Ej
.text:0040F404		       mov     lpCodePageStr, [ebp+var_4]
.text:0040F407		       xor     lpCodePageStr, ebp
.text:0040F409		       pop     esi
.text:0040F40A		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F40F		       leave
.text:0040F410		       retn
.text:0040F410 ProcessCodePage endp
.text:0040F410
.text:0040F411
.text:0040F411 ; =============== S U B R O U T I N E =======================================
.text:0040F411
.text:0040F411
.text:0040F411 ; int __cdecl TestDefaultCountry(unsigned int lcid)
.text:0040F411 TestDefaultCountry proc near	       ; CODE XREF: CountryEnumProc+67p
.text:0040F411					       ; LangCountryEnumProc+F1p
.text:0040F411
.text:0040F411 lcid	       = dword ptr  4
.text:0040F411
.text:0040F411		       xor     eax, eax
.text:0040F413
.text:0040F413 loc_40F413:			       ; CODE XREF: TestDefaultCountry+15j
.text:0040F413		       mov     cx, word	ptr [esp+lcid]
.text:0040F418		       cmp     cx, ds:___rglangidNotDefault[eax]
.text:0040F41F		       jz      short loc_40F42C
.text:0040F421		       inc     eax
.text:0040F422		       inc     eax
.text:0040F423		       cmp     eax, 14h
.text:0040F426		       jb      short loc_40F413
.text:0040F428		       xor     eax, eax
.text:0040F42A		       inc     eax
.text:0040F42B		       retn
.text:0040F42C ; ---------------------------------------------------------------------------
.text:0040F42C
.text:0040F42C loc_40F42C:			       ; CODE XREF: TestDefaultCountry+Ej
.text:0040F42C		       xor     eax, eax
.text:0040F42E		       retn
.text:0040F42E TestDefaultCountry endp
.text:0040F42E
.text:0040F42F
.text:0040F42F ; =============== S U B R O U T I N E =======================================
.text:0040F42F
.text:0040F42F
.text:0040F42F ; unsigned int __usercall LcidFromHexString<eax>(char *lpHexString<edx>)
.text:0040F42F LcidFromHexString proc near	       ; CODE XREF: CountryEnumProc+24p
.text:0040F42F					       ; TestDefaultLanguage+3Ap ...
.text:0040F42F lpHexString = edx
.text:0040F42F		       push    esi
.text:0040F430		       xor     esi, esi
.text:0040F432		       jmp     short loc_40F457
.text:0040F434 ; ---------------------------------------------------------------------------
.text:0040F434
.text:0040F434 loc_40F434:			       ; CODE XREF: LcidFromHexString+2Cj
.text:0040F434		       mov     al, cl
.text:0040F436		       sub     al, 61h
.text:0040F438		       inc     lpHexString
.text:0040F439		       cmp     al, 5
.text:0040F43B		       ja      short loc_40F442
.text:0040F43D		       add     cl, 0D9h
.text:0040F440		       jmp     short loc_40F44D
.text:0040F442 ; ---------------------------------------------------------------------------
.text:0040F442
.text:0040F442 loc_40F442:			       ; CODE XREF: LcidFromHexString+Cj
.text:0040F442		       mov     al, cl
.text:0040F444		       sub     al, 41h
.text:0040F446		       cmp     al, 5
.text:0040F448		       ja      short loc_40F44D
.text:0040F44A		       add     cl, 0F9h
.text:0040F44D
.text:0040F44D loc_40F44D:			       ; CODE XREF: LcidFromHexString+11j
.text:0040F44D					       ; LcidFromHexString+19j
.text:0040F44D		       movsx   eax, cl
.text:0040F450		       shl     esi, 4
.text:0040F453		       lea     esi, [esi+eax-30h]
.text:0040F457
.text:0040F457 loc_40F457:			       ; CODE XREF: LcidFromHexString+3j
.text:0040F457		       mov     cl, [lpHexString]
.text:0040F459		       test    cl, cl
.text:0040F45B		       jnz     short loc_40F434
.text:0040F45D		       mov     eax, esi
.text:0040F45F		       pop     esi
.text:0040F460		       retn
.text:0040F460 LcidFromHexString endp
.text:0040F460
.text:0040F461
.text:0040F461 ; =============== S U B R O U T I N E =======================================
.text:0040F461
.text:0040F461
.text:0040F461 ; int __usercall	GetPrimaryLen<eax>(char	*pchLanguage<edx>)
.text:0040F461 GetPrimaryLen   proc near	       ; CODE XREF: TestDefaultLanguage+4Fp
.text:0040F461					       ; GetLcidFromLangCountry+38p ...
.text:0040F461 pchLanguage = edx
.text:0040F461		       xor     eax, eax
.text:0040F463
.text:0040F463 loc_40F463:			       ; CODE XREF: GetPrimaryLen+18j
.text:0040F463		       mov     cl, [pchLanguage]
.text:0040F465		       inc     pchLanguage
.text:0040F466		       cmp     cl, 41h
.text:0040F469		       jl      short loc_40F470
.text:0040F46B		       cmp     cl, 5Ah
.text:0040F46E		       jle     short loc_40F478
.text:0040F470
.text:0040F470 loc_40F470:			       ; CODE XREF: GetPrimaryLen+8j
.text:0040F470		       sub     cl, 61h
.text:0040F473		       cmp     cl, 19h
.text:0040F476		       ja      short locret_40F47B
.text:0040F478
.text:0040F478 loc_40F478:			       ; CODE XREF: GetPrimaryLen+Dj
.text:0040F478		       inc     eax
.text:0040F479		       jmp     short loc_40F463
.text:0040F47B ; ---------------------------------------------------------------------------
.text:0040F47B
.text:0040F47B locret_40F47B:			       ; CODE XREF: GetPrimaryLen+15j
.text:0040F47B		       retn
.text:0040F47B GetPrimaryLen   endp
.text:0040F47B
.text:0040F47C
.text:0040F47C ; =============== S U B R O U T I N E =======================================
.text:0040F47C
.text:0040F47C ; Attributes: bp-based frame
.text:0040F47C
.text:0040F47C ; int __stdcall CountryEnumProc(char *lpLcidString)
.text:0040F47C CountryEnumProc proc near	       ; DATA XREF: GetLcidFromCountry+13o
.text:0040F47C					       ; ___get_qualified_locale+B8o
.text:0040F47C
.text:0040F47C rgcInfo	       = byte ptr -7Ch
.text:0040F47C var_4	       = dword ptr -4
.text:0040F47C lpLcidString    = dword ptr  8
.text:0040F47C
.text:0040F47C		       push    ebp
.text:0040F47D		       mov     ebp, esp
.text:0040F47F		       sub     esp, 7Ch
.text:0040F482		       mov     eax, ___security_cookie
.text:0040F487		       xor     eax, ebp
.text:0040F489		       mov     [ebp+var_4], eax
.text:0040F48C		       push    esi
.text:0040F48D		       push    edi
.text:0040F48E		       mov     edi, [ebp+lpLcidString]
.text:0040F491		       call    __getptd
.text:0040F496		       mov     esi, eax
.text:0040F498		       mov     edx, edi	       ; lpHexString
.text:0040F49A		       add     esi, 9Ch
.text:0040F4A0		       call    LcidFromHexString
.text:0040F4A5		       mov     edi, eax
.text:0040F4A7		       push    78h	       ; cchData
.text:0040F4A9		       lea     eax, [ebp+rgcInfo]
.text:0040F4AC		       push    eax	       ; lpLCData
.text:0040F4AD		       mov     eax, [esi+14h]
.text:0040F4B0		       neg     eax
.text:0040F4B2		       sbb     eax, eax
.text:0040F4B4		       and     eax, 0FFFFF005h
.text:0040F4B9		       add     eax, 1002h
.text:0040F4BE		       push    eax	       ; LCType
.text:0040F4BF		       push    edi	       ; Locale
.text:0040F4C0		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040F4C6		       test    eax, eax
.text:0040F4C8		       jnz     short loc_40F4D0
.text:0040F4CA		       and     [esi+8],	eax
.text:0040F4CD		       inc     eax
.text:0040F4CE		       jmp     short loc_40F502
.text:0040F4D0 ; ---------------------------------------------------------------------------
.text:0040F4D0
.text:0040F4D0 loc_40F4D0:			       ; CODE XREF: CountryEnumProc+4Cj
.text:0040F4D0		       lea     eax, [ebp+rgcInfo]
.text:0040F4D3		       push    eax	       ; src
.text:0040F4D4		       push    dword ptr [esi+4] ; dst
.text:0040F4D7		       call    __stricmp
.text:0040F4DC		       test    eax, eax
.text:0040F4DE		       pop     ecx
.text:0040F4DF		       pop     ecx
.text:0040F4E0		       jnz     short loc_40F4F7
.text:0040F4E2		       push    edi	       ; lcid
.text:0040F4E3		       call    TestDefaultCountry
.text:0040F4E8		       test    eax, eax
.text:0040F4EA		       pop     ecx
.text:0040F4EB		       jz      short loc_40F4F7
.text:0040F4ED		       or      dword ptr [esi+8], 4
.text:0040F4F1		       mov     [esi+1Ch], edi
.text:0040F4F4		       mov     [esi+18h], edi
.text:0040F4F7
.text:0040F4F7 loc_40F4F7:			       ; CODE XREF: CountryEnumProc+64j
.text:0040F4F7					       ; CountryEnumProc+6Fj
.text:0040F4F7		       mov     eax, [esi+8]
.text:0040F4FA		       shr     eax, 2
.text:0040F4FD		       not     eax
.text:0040F4FF		       and     eax, 1
.text:0040F502
.text:0040F502 loc_40F502:			       ; CODE XREF: CountryEnumProc+52j
.text:0040F502		       mov     ecx, [ebp+var_4]
.text:0040F505		       pop     edi
.text:0040F506		       xor     ecx, ebp
.text:0040F508		       pop     esi
.text:0040F509		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F50E		       leave
.text:0040F50F		       retn    4
.text:0040F50F CountryEnumProc endp
.text:0040F50F
.text:0040F512
.text:0040F512 ; =============== S U B R O U T I N E =======================================
.text:0040F512
.text:0040F512 ; Attributes: bp-based frame
.text:0040F512
.text:0040F512 ; int __usercall	TestDefaultLanguage<eax>(unsigned int lcid, int	bTestPrimary, setloc_struct *_psetloc_data<ecx>)
.text:0040F512 TestDefaultLanguage proc	near	       ; CODE XREF: LangCountryEnumProc+19Ap
.text:0040F512					       ; LanguageEnumProc+8Fp
.text:0040F512
.text:0040F512 rgcInfo	       = byte ptr -7Ch
.text:0040F512 var_4	       = dword ptr -4
.text:0040F512 lcid	       = dword ptr  8
.text:0040F512 bTestPrimary    = dword ptr  0Ch
.text:0040F512
.text:0040F512 _psetloc_data = ecx
.text:0040F512		       push    ebp
.text:0040F513		       mov     ebp, esp
.text:0040F515		       sub     esp, 7Ch
.text:0040F518		       mov     eax, ___security_cookie
.text:0040F51D		       xor     eax, ebp
.text:0040F51F		       mov     [ebp+var_4], eax
.text:0040F522		       push    esi
.text:0040F523		       push    78h	       ; cchData
.text:0040F525		       lea     eax, [ebp+rgcInfo]
.text:0040F528		       push    eax	       ; lpLCData
.text:0040F529		       mov     eax, [ebp+lcid]
.text:0040F52C		       and     eax, 3FFh
.text:0040F531		       push    1	       ; LCType
.text:0040F533		       or      eax, 400h
.text:0040F538		       push    eax	       ; Locale
.text:0040F539		       mov     esi, _psetloc_data
.text:0040F53B		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040F541		       test    eax, eax
.text:0040F543		       jnz     short loc_40F549
.text:0040F545
.text:0040F545 loc_40F545:			       ; CODE XREF: TestDefaultLanguage+60j
.text:0040F545		       xor     eax, eax
.text:0040F547		       jmp     short loc_40F577
.text:0040F549 ; ---------------------------------------------------------------------------
.text:0040F549
.text:0040F549 loc_40F549:			       ; CODE XREF: TestDefaultLanguage+31j
.text:0040F549		       lea     edx, [ebp+rgcInfo] ; lpHexString
.text:0040F54C		       call    LcidFromHexString
.text:0040F551		       cmp     [ebp+lcid], eax
.text:0040F554		       jz      short loc_40F574
.text:0040F556		       cmp     [ebp+bTestPrimary], 0
.text:0040F55A		       jz      short loc_40F574
.text:0040F55C		       mov     esi, [esi]
.text:0040F55E		       push    edi
.text:0040F55F		       mov     edx, esi	       ; pchLanguage
.text:0040F561		       call    GetPrimaryLen
.text:0040F566		       push    esi	       ; buf
.text:0040F567		       mov     edi, eax
.text:0040F569		       call    _strlen
.text:0040F56E		       pop     _psetloc_data
.text:0040F56F		       cmp     edi, eax
.text:0040F571		       pop     edi
.text:0040F572		       jz      short loc_40F545
.text:0040F574
.text:0040F574 loc_40F574:			       ; CODE XREF: TestDefaultLanguage+42j
.text:0040F574					       ; TestDefaultLanguage+48j
.text:0040F574		       xor     eax, eax
.text:0040F576		       inc     eax
.text:0040F577
.text:0040F577 loc_40F577:			       ; CODE XREF: TestDefaultLanguage+35j
.text:0040F577		       mov     _psetloc_data, [ebp+var_4]
.text:0040F57A		       xor     _psetloc_data, ebp
.text:0040F57C		       pop     esi
.text:0040F57D		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F582		       leave
.text:0040F583		       retn
.text:0040F583 TestDefaultLanguage endp
.text:0040F583
.text:0040F584
.text:0040F584 ; =============== S U B R O U T I N E =======================================
.text:0040F584
.text:0040F584 ; Attributes: bp-based frame
.text:0040F584
.text:0040F584 ; int __stdcall LangCountryEnumProc(char	*lpLcidString)
.text:0040F584 LangCountryEnumProc proc	near	       ; DATA XREF: GetLcidFromLangCountry+3Fo
.text:0040F584
.text:0040F584 rgcInfo	       = byte ptr -7Ch
.text:0040F584 var_4	       = dword ptr -4
.text:0040F584 lpLcidString    = dword ptr  8
.text:0040F584
.text:0040F584		       push    ebp
.text:0040F585		       mov     ebp, esp
.text:0040F587		       sub     esp, 7Ch
.text:0040F58A		       mov     eax, ___security_cookie
.text:0040F58F		       xor     eax, ebp
.text:0040F591		       mov     [ebp+var_4], eax
.text:0040F594		       push    ebx
.text:0040F595		       push    esi
.text:0040F596		       push    edi
.text:0040F597		       mov     edi, [ebp+lpLcidString]
.text:0040F59A		       call    __getptd
.text:0040F59F		       mov     esi, eax
.text:0040F5A1		       mov     edx, edi	       ; lpHexString
.text:0040F5A3		       add     esi, 9Ch
.text:0040F5A9		       call    LcidFromHexString
.text:0040F5AE		       mov     ebx, ds:__imp__GetLocaleInfoA@16	; GetLocaleInfoA(x,x,x,x)
.text:0040F5B4		       mov     edi, eax
.text:0040F5B6		       push    78h	       ; cchData
.text:0040F5B8		       lea     eax, [ebp+rgcInfo]
.text:0040F5BB		       push    eax	       ; lpLCData
.text:0040F5BC		       mov     eax, [esi+14h]
.text:0040F5BF		       neg     eax
.text:0040F5C1		       sbb     eax, eax
.text:0040F5C3		       and     eax, 0FFFFF005h
.text:0040F5C8		       add     eax, 1002h
.text:0040F5CD		       push    eax	       ; LCType
.text:0040F5CE		       push    edi	       ; Locale
.text:0040F5CF		       call    ebx ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040F5D1		       test    eax, eax
.text:0040F5D3		       jnz     short loc_40F5E1
.text:0040F5D5
.text:0040F5D5 loc_40F5D5:			       ; CODE XREF: LangCountryEnumProc+90j
.text:0040F5D5					       ; LangCountryEnumProc+133j
.text:0040F5D5		       and     dword ptr [esi+8], 0
.text:0040F5D9		       xor     eax, eax
.text:0040F5DB		       inc     eax
.text:0040F5DC		       jmp     loc_40F743
.text:0040F5E1 ; ---------------------------------------------------------------------------
.text:0040F5E1
.text:0040F5E1 loc_40F5E1:			       ; CODE XREF: LangCountryEnumProc+4Fj
.text:0040F5E1		       lea     eax, [ebp+rgcInfo]
.text:0040F5E4		       push    eax	       ; src
.text:0040F5E5		       push    dword ptr [esi+4] ; dst
.text:0040F5E8		       call    __stricmp
.text:0040F5ED		       test    eax, eax
.text:0040F5EF		       pop     ecx
.text:0040F5F0		       pop     ecx
.text:0040F5F1		       jnz     loc_40F688
.text:0040F5F7		       push    78h	       ; cchData
.text:0040F5F9		       lea     eax, [ebp+rgcInfo]
.text:0040F5FC		       push    eax	       ; lpLCData
.text:0040F5FD		       mov     eax, [esi+10h]
.text:0040F600		       neg     eax
.text:0040F602		       sbb     eax, eax
.text:0040F604		       and     eax, 0FFFFF002h
.text:0040F609		       add     eax, 1001h
.text:0040F60E		       push    eax	       ; LCType
.text:0040F60F		       push    edi	       ; Locale
.text:0040F610		       call    ebx ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040F612		       test    eax, eax
.text:0040F614		       jz      short loc_40F5D5
.text:0040F616		       lea     eax, [ebp+rgcInfo]
.text:0040F619		       push    eax	       ; src
.text:0040F61A		       push    dword ptr [esi] ; dst
.text:0040F61C		       call    __stricmp
.text:0040F621		       test    eax, eax
.text:0040F623		       pop     ecx
.text:0040F624		       pop     ecx
.text:0040F625		       jnz     short loc_40F633
.text:0040F627		       or      dword ptr [esi+8], 304h
.text:0040F62E		       mov     [esi+18h], edi
.text:0040F631		       jmp     short loc_40F685
.text:0040F633 ; ---------------------------------------------------------------------------
.text:0040F633
.text:0040F633 loc_40F633:			       ; CODE XREF: LangCountryEnumProc+A1j
.text:0040F633		       test    byte ptr	[esi+8], 2
.text:0040F637		       jnz     short loc_40F688
.text:0040F639		       mov     eax, [esi+0Ch]
.text:0040F63C		       test    eax, eax
.text:0040F63E		       jz      short loc_40F66C
.text:0040F640		       push    eax	       ; count
.text:0040F641		       lea     eax, [ebp+rgcInfo]
.text:0040F644		       push    eax	       ; src
.text:0040F645		       push    dword ptr [esi] ; dst
.text:0040F647		       call    __strnicmp
.text:0040F64C		       add     esp, 0Ch
.text:0040F64F		       test    eax, eax
.text:0040F651		       jnz     short loc_40F66C
.text:0040F653		       push    dword ptr [esi] ; buf
.text:0040F655		       or      dword ptr [esi+8], 2
.text:0040F659		       mov     [esi+1Ch], edi
.text:0040F65C		       call    _strlen
.text:0040F661		       cmp     eax, [esi+0Ch]
.text:0040F664		       pop     ecx
.text:0040F665		       jnz     short loc_40F688
.text:0040F667		       mov     [esi+18h], edi
.text:0040F66A		       jmp     short loc_40F688
.text:0040F66C ; ---------------------------------------------------------------------------
.text:0040F66C
.text:0040F66C loc_40F66C:			       ; CODE XREF: LangCountryEnumProc+BAj
.text:0040F66C					       ; LangCountryEnumProc+CDj
.text:0040F66C		       mov     edx, [esi+8]
.text:0040F66F		       test    dl, 1
.text:0040F672		       jnz     short loc_40F688
.text:0040F674		       push    edi	       ; lcid
.text:0040F675		       call    TestDefaultCountry
.text:0040F67A		       test    eax, eax
.text:0040F67C		       pop     ecx
.text:0040F67D		       jz      short loc_40F688
.text:0040F67F		       or      edx, 1
.text:0040F682		       mov     [esi+8],	edx
.text:0040F685
.text:0040F685 loc_40F685:			       ; CODE XREF: LangCountryEnumProc+ADj
.text:0040F685		       mov     [esi+1Ch], edi
.text:0040F688
.text:0040F688 loc_40F688:			       ; CODE XREF: LangCountryEnumProc+6Dj
.text:0040F688					       ; LangCountryEnumProc+B3j ...
.text:0040F688		       mov     ecx, [esi+8]
.text:0040F68B		       mov     eax, 300h
.text:0040F690		       and     ecx, eax
.text:0040F692		       cmp     ecx, eax
.text:0040F694		       jz      loc_40F738
.text:0040F69A		       push    78h	       ; cchData
.text:0040F69C		       lea     eax, [ebp+rgcInfo]
.text:0040F69F		       push    eax	       ; lpLCData
.text:0040F6A0		       mov     eax, [esi+10h]
.text:0040F6A3		       neg     eax
.text:0040F6A5		       sbb     eax, eax
.text:0040F6A7		       and     eax, 0FFFFF002h
.text:0040F6AC		       add     eax, 1001h
.text:0040F6B1		       push    eax	       ; LCType
.text:0040F6B2		       push    edi	       ; Locale
.text:0040F6B3		       call    ebx ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040F6B5		       test    eax, eax
.text:0040F6B7		       jz      loc_40F5D5
.text:0040F6BD		       lea     eax, [ebp+rgcInfo]
.text:0040F6C0		       push    eax	       ; src
.text:0040F6C1		       push    dword ptr [esi] ; dst
.text:0040F6C3		       call    __stricmp
.text:0040F6C8		       pop     ecx
.text:0040F6C9		       xor     ebx, ebx
.text:0040F6CB		       test    eax, eax
.text:0040F6CD		       pop     ecx
.text:0040F6CE		       jnz     short loc_40F6FF
.text:0040F6D0		       or      dword ptr [esi+8], 200h
.text:0040F6D7		       cmp     [esi+10h], ebx
.text:0040F6DA		       mov     eax, [esi+8]
.text:0040F6DD		       jz      short loc_40F6E9
.text:0040F6DF		       or      eax, 100h
.text:0040F6E4		       mov     [esi+8],	eax
.text:0040F6E7		       jmp     short loc_40F730
.text:0040F6E9 ; ---------------------------------------------------------------------------
.text:0040F6E9
.text:0040F6E9 loc_40F6E9:			       ; CODE XREF: LangCountryEnumProc+159j
.text:0040F6E9		       cmp     [esi+0Ch], ebx
.text:0040F6EC		       jz      short loc_40F729
.text:0040F6EE		       push    dword ptr [esi] ; buf
.text:0040F6F0		       call    _strlen
.text:0040F6F5		       cmp     eax, [esi+0Ch]
.text:0040F6F8		       pop     ecx
.text:0040F6F9		       jnz     short loc_40F729
.text:0040F6FB		       push    1
.text:0040F6FD		       jmp     short loc_40F71B
.text:0040F6FF ; ---------------------------------------------------------------------------
.text:0040F6FF
.text:0040F6FF loc_40F6FF:			       ; CODE XREF: LangCountryEnumProc+14Aj
.text:0040F6FF		       cmp     [esi+10h], ebx
.text:0040F702		       jnz     short loc_40F738
.text:0040F704		       cmp     [esi+0Ch], ebx
.text:0040F707		       jz      short loc_40F738
.text:0040F709		       lea     eax, [ebp+rgcInfo]
.text:0040F70C		       push    eax	       ; src
.text:0040F70D		       push    dword ptr [esi] ; dst
.text:0040F70F		       call    __stricmp
.text:0040F714		       test    eax, eax
.text:0040F716		       pop     ecx
.text:0040F717		       pop     ecx
.text:0040F718		       jnz     short loc_40F738
.text:0040F71A		       push    ebx	       ; bTestPrimary
.text:0040F71B
.text:0040F71B loc_40F71B:			       ; CODE XREF: LangCountryEnumProc+179j
.text:0040F71B		       push    edi	       ; lcid
.text:0040F71C		       mov     ecx, esi	       ; _psetloc_data
.text:0040F71E		       call    TestDefaultLanguage
.text:0040F723		       test    eax, eax
.text:0040F725		       pop     ecx
.text:0040F726		       pop     ecx
.text:0040F727		       jz      short loc_40F738
.text:0040F729
.text:0040F729 loc_40F729:			       ; CODE XREF: LangCountryEnumProc+168j
.text:0040F729					       ; LangCountryEnumProc+175j
.text:0040F729		       or      dword ptr [esi+8], 100h
.text:0040F730
.text:0040F730 loc_40F730:			       ; CODE XREF: LangCountryEnumProc+163j
.text:0040F730		       cmp     [esi+18h], ebx
.text:0040F733		       jnz     short loc_40F738
.text:0040F735		       mov     [esi+18h], edi
.text:0040F738
.text:0040F738 loc_40F738:			       ; CODE XREF: LangCountryEnumProc+110j
.text:0040F738					       ; LangCountryEnumProc+17Ej ...
.text:0040F738		       mov     eax, [esi+8]
.text:0040F73B		       shr     eax, 2
.text:0040F73E		       not     eax
.text:0040F740		       and     eax, 1
.text:0040F743
.text:0040F743 loc_40F743:			       ; CODE XREF: LangCountryEnumProc+58j
.text:0040F743		       mov     ecx, [ebp+var_4]
.text:0040F746		       pop     edi
.text:0040F747		       pop     esi
.text:0040F748		       xor     ecx, ebp
.text:0040F74A		       pop     ebx
.text:0040F74B		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F750		       leave
.text:0040F751		       retn    4
.text:0040F751 LangCountryEnumProc endp
.text:0040F751
.text:0040F754
.text:0040F754 ; =============== S U B R O U T I N E =======================================
.text:0040F754
.text:0040F754 ; Attributes: bp-based frame
.text:0040F754
.text:0040F754 ; int __stdcall LanguageEnumProc(char *lpLcidString)
.text:0040F754 LanguageEnumProc	proc near	       ; DATA XREF: GetLcidFromLanguage+23o
.text:0040F754
.text:0040F754 rgcInfo	       = byte ptr -7Ch
.text:0040F754 var_4	       = dword ptr -4
.text:0040F754 lpLcidString    = dword ptr  8
.text:0040F754
.text:0040F754		       push    ebp
.text:0040F755		       mov     ebp, esp
.text:0040F757		       sub     esp, 7Ch
.text:0040F75A		       mov     eax, ___security_cookie
.text:0040F75F		       xor     eax, ebp
.text:0040F761		       mov     [ebp+var_4], eax
.text:0040F764		       push    esi
.text:0040F765		       push    edi
.text:0040F766		       mov     edi, [ebp+lpLcidString]
.text:0040F769		       call    __getptd
.text:0040F76E		       mov     esi, eax
.text:0040F770		       mov     edx, edi	       ; lpHexString
.text:0040F772		       add     esi, 9Ch
.text:0040F778		       call    LcidFromHexString
.text:0040F77D		       mov     edi, eax
.text:0040F77F		       push    78h	       ; cchData
.text:0040F781		       lea     eax, [ebp+rgcInfo]
.text:0040F784		       push    eax	       ; lpLCData
.text:0040F785		       mov     eax, [esi+10h]
.text:0040F788		       neg     eax
.text:0040F78A		       sbb     eax, eax
.text:0040F78C		       and     eax, 0FFFFF002h
.text:0040F791		       add     eax, 1001h
.text:0040F796		       push    eax	       ; LCType
.text:0040F797		       push    edi	       ; Locale
.text:0040F798		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040F79E		       test    eax, eax
.text:0040F7A0		       jnz     short loc_40F7A8
.text:0040F7A2		       and     [esi+8],	eax
.text:0040F7A5		       inc     eax
.text:0040F7A6		       jmp     short loc_40F803
.text:0040F7A8 ; ---------------------------------------------------------------------------
.text:0040F7A8
.text:0040F7A8 loc_40F7A8:			       ; CODE XREF: LanguageEnumProc+4Cj
.text:0040F7A8		       lea     eax, [ebp+rgcInfo]
.text:0040F7AB		       push    eax	       ; src
.text:0040F7AC		       push    dword ptr [esi] ; dst
.text:0040F7AE		       call    __stricmp
.text:0040F7B3		       test    eax, eax
.text:0040F7B5		       pop     ecx
.text:0040F7B6		       pop     ecx
.text:0040F7B7		       jnz     short loc_40F7C2
.text:0040F7B9		       cmp     [esi+10h], eax
.text:0040F7BC		       jnz     short loc_40F7EE
.text:0040F7BE		       push    1
.text:0040F7C0		       jmp     short loc_40F7E0
.text:0040F7C2 ; ---------------------------------------------------------------------------
.text:0040F7C2
.text:0040F7C2 loc_40F7C2:			       ; CODE XREF: LanguageEnumProc+63j
.text:0040F7C2		       cmp     dword ptr [esi+10h], 0
.text:0040F7C6		       jnz     short loc_40F7F8
.text:0040F7C8		       cmp     dword ptr [esi+0Ch], 0
.text:0040F7CC		       jz      short loc_40F7F8
.text:0040F7CE		       lea     eax, [ebp+rgcInfo]
.text:0040F7D1		       push    eax	       ; src
.text:0040F7D2		       push    dword ptr [esi] ; dst
.text:0040F7D4		       call    __stricmp
.text:0040F7D9		       test    eax, eax
.text:0040F7DB		       pop     ecx
.text:0040F7DC		       pop     ecx
.text:0040F7DD		       jnz     short loc_40F7F8
.text:0040F7DF		       push    eax	       ; bTestPrimary
.text:0040F7E0
.text:0040F7E0 loc_40F7E0:			       ; CODE XREF: LanguageEnumProc+6Cj
.text:0040F7E0		       push    edi	       ; lcid
.text:0040F7E1		       mov     ecx, esi	       ; _psetloc_data
.text:0040F7E3		       call    TestDefaultLanguage
.text:0040F7E8		       test    eax, eax
.text:0040F7EA		       pop     ecx
.text:0040F7EB		       pop     ecx
.text:0040F7EC		       jz      short loc_40F7F8
.text:0040F7EE
.text:0040F7EE loc_40F7EE:			       ; CODE XREF: LanguageEnumProc+68j
.text:0040F7EE		       or      dword ptr [esi+8], 4
.text:0040F7F2		       mov     [esi+18h], edi
.text:0040F7F5		       mov     [esi+1Ch], edi
.text:0040F7F8
.text:0040F7F8 loc_40F7F8:			       ; CODE XREF: LanguageEnumProc+72j
.text:0040F7F8					       ; LanguageEnumProc+78j ...
.text:0040F7F8		       mov     eax, [esi+8]
.text:0040F7FB		       shr     eax, 2
.text:0040F7FE		       not     eax
.text:0040F800		       and     eax, 1
.text:0040F803
.text:0040F803 loc_40F803:			       ; CODE XREF: LanguageEnumProc+52j
.text:0040F803		       mov     ecx, [ebp+var_4]
.text:0040F806		       pop     edi
.text:0040F807		       xor     ecx, ebp
.text:0040F809		       pop     esi
.text:0040F80A		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F80F		       leave
.text:0040F810		       retn    4
.text:0040F810 LanguageEnumProc	endp
.text:0040F810
.text:0040F813
.text:0040F813 ; =============== S U B R O U T I N E =======================================
.text:0040F813
.text:0040F813
.text:0040F813 ; void __usercall GetLcidFromCountry(setloc_struct *_psetloc_data<esi>)
.text:0040F813 GetLcidFromCountry proc near
.text:0040F813 _psetloc_data = esi
.text:0040F813		       push    dword ptr [_psetloc_data+4] ; buf
.text:0040F816		       call    _strlen
.text:0040F81B		       sub     eax, 3
.text:0040F81E		       neg     eax
.text:0040F820		       pop     ecx
.text:0040F821		       sbb     eax, eax
.text:0040F823		       push    1	       ; dwFlags
.text:0040F825		       inc     eax
.text:0040F826		       push    offset CountryEnumProc ;	lpLocaleEnumProc
.text:0040F82B		       mov     [_psetloc_data+14h], eax
.text:0040F82E		       call    ds:__imp__EnumSystemLocalesA@8 ;	EnumSystemLocalesA(x,x)
.text:0040F834		       test    byte ptr	[_psetloc_data+8], 4
.text:0040F838		       jnz     short locret_40F83E
.text:0040F83A		       and     dword ptr [_psetloc_data+8], 0
.text:0040F83E
.text:0040F83E locret_40F83E:			       ; CODE XREF: GetLcidFromCountry+25j
.text:0040F83E		       retn
.text:0040F83E GetLcidFromCountry endp
.text:0040F83E
.text:0040F83F
.text:0040F83F ; =============== S U B R O U T I N E =======================================
.text:0040F83F
.text:0040F83F
.text:0040F83F ; void __usercall GetLcidFromLangCountry(setloc_struct *_psetloc_data<esi>)
.text:0040F83F GetLcidFromLangCountry proc near	       ; CODE XREF: ___get_qualified_locale+60p
.text:0040F83F					       ; ___get_qualified_locale+8Fp
.text:0040F83F _psetloc_data = esi
.text:0040F83F		       push    dword ptr [_psetloc_data] ; buf
.text:0040F841		       call    _strlen
.text:0040F846		       push    dword ptr [_psetloc_data+4] ; buf
.text:0040F849		       sub     eax, 3
.text:0040F84C		       neg     eax
.text:0040F84E		       sbb     eax, eax
.text:0040F850		       inc     eax
.text:0040F851		       mov     [_psetloc_data+10h], eax
.text:0040F854		       call    _strlen
.text:0040F859		       sub     eax, 3
.text:0040F85C		       neg     eax
.text:0040F85E		       sbb     eax, eax
.text:0040F860		       and     dword ptr [_psetloc_data+18h], 0
.text:0040F864		       inc     eax
.text:0040F865		       cmp     dword ptr [_psetloc_data+10h], 0
.text:0040F869		       pop     ecx
.text:0040F86A		       pop     ecx
.text:0040F86B		       mov     [_psetloc_data+14h], eax
.text:0040F86E		       jz      short loc_40F875
.text:0040F870		       push    2
.text:0040F872		       pop     eax
.text:0040F873		       jmp     short loc_40F87C
.text:0040F875 ; ---------------------------------------------------------------------------
.text:0040F875
.text:0040F875 loc_40F875:			       ; CODE XREF: GetLcidFromLangCountry+2Fj
.text:0040F875		       mov     edx, [_psetloc_data] ; pchLanguage
.text:0040F877		       call    GetPrimaryLen
.text:0040F87C
.text:0040F87C loc_40F87C:			       ; CODE XREF: GetLcidFromLangCountry+34j
.text:0040F87C		       push    1	       ; dwFlags
.text:0040F87E		       push    offset LangCountryEnumProc ; lpLocaleEnumProc
.text:0040F883		       mov     [_psetloc_data+0Ch], eax
.text:0040F886		       call    ds:__imp__EnumSystemLocalesA@8 ;	EnumSystemLocalesA(x,x)
.text:0040F88C		       mov     eax, [_psetloc_data+8]
.text:0040F88F		       test    ax, 100h
.text:0040F893		       jz      short loc_40F89F
.text:0040F895		       test    ax, 200h
.text:0040F899		       jz      short loc_40F89F
.text:0040F89B		       test    al, 7
.text:0040F89D		       jnz     short locret_40F8A3
.text:0040F89F
.text:0040F89F loc_40F89F:			       ; CODE XREF: GetLcidFromLangCountry+54j
.text:0040F89F					       ; GetLcidFromLangCountry+5Aj
.text:0040F89F		       and     dword ptr [_psetloc_data+8], 0
.text:0040F8A3
.text:0040F8A3 locret_40F8A3:			       ; CODE XREF: GetLcidFromLangCountry+5Ej
.text:0040F8A3		       retn
.text:0040F8A3 GetLcidFromLangCountry endp
.text:0040F8A3
.text:0040F8A4
.text:0040F8A4 ; =============== S U B R O U T I N E =======================================
.text:0040F8A4
.text:0040F8A4
.text:0040F8A4 ; void __usercall GetLcidFromLanguage(setloc_struct *_psetloc_data<esi>)
.text:0040F8A4 GetLcidFromLanguage proc	near	       ; CODE XREF: ___get_qualified_locale:loc_40F947p
.text:0040F8A4					       ; ___get_qualified_locale:loc_40F976p
.text:0040F8A4 _psetloc_data = esi
.text:0040F8A4		       push    dword ptr [_psetloc_data] ; buf
.text:0040F8A6		       call    _strlen
.text:0040F8AB		       sub     eax, 3
.text:0040F8AE		       neg     eax
.text:0040F8B0		       sbb     eax, eax
.text:0040F8B2		       inc     eax
.text:0040F8B3		       pop     ecx
.text:0040F8B4		       mov     [_psetloc_data+10h], eax
.text:0040F8B7		       jz      short loc_40F8BE
.text:0040F8B9		       push    2
.text:0040F8BB		       pop     eax
.text:0040F8BC		       jmp     short loc_40F8C5
.text:0040F8BE ; ---------------------------------------------------------------------------
.text:0040F8BE
.text:0040F8BE loc_40F8BE:			       ; CODE XREF: GetLcidFromLanguage+13j
.text:0040F8BE		       mov     edx, [_psetloc_data] ; pchLanguage
.text:0040F8C0		       call    GetPrimaryLen
.text:0040F8C5
.text:0040F8C5 loc_40F8C5:			       ; CODE XREF: GetLcidFromLanguage+18j
.text:0040F8C5		       push    1	       ; dwFlags
.text:0040F8C7		       push    offset LanguageEnumProc ; lpLocaleEnumProc
.text:0040F8CC		       mov     [_psetloc_data+0Ch], eax
.text:0040F8CF		       call    ds:__imp__EnumSystemLocalesA@8 ;	EnumSystemLocalesA(x,x)
.text:0040F8D5		       test    byte ptr	[_psetloc_data+8], 4
.text:0040F8D9		       jnz     short locret_40F8DF
.text:0040F8DB		       and     dword ptr [_psetloc_data+8], 0
.text:0040F8DF
.text:0040F8DF locret_40F8DF:			       ; CODE XREF: GetLcidFromLanguage+35j
.text:0040F8DF		       retn
.text:0040F8DF GetLcidFromLanguage endp
.text:0040F8DF
.text:0040F8E0
.text:0040F8E0 ; =============== S U B R O U T I N E =======================================
.text:0040F8E0
.text:0040F8E0
.text:0040F8E0 ; int __cdecl __get_qualified_locale(tagLC_STRINGS *const lpInStr, tagLC_ID *lpOutId, tagLC_STRINGS *lpOutStr)
.text:0040F8E0 ___get_qualified_locale proc near       ; CODE XREF: __expandlocale+10Ep
.text:0040F8E0
.text:0040F8E0 lpInStr	       = dword ptr  4
.text:0040F8E0 lpOutId	       = dword ptr  8
.text:0040F8E0 lpOutStr	       = dword ptr  0Ch
.text:0040F8E0
.text:0040F8E0		       push    ebx
.text:0040F8E1		       push    ebp
.text:0040F8E2		       push    esi
.text:0040F8E3		       push    edi
.text:0040F8E4		       call    __getptd
.text:0040F8E9		       mov     ebp, [esp+10h+lpInStr]
.text:0040F8ED		       mov     esi, eax
.text:0040F8EF		       xor     ebx, ebx
.text:0040F8F1		       add     esi, 9Ch	       ; _psetloc_data
.text:0040F8F7		       cmp     ebp, ebx
.text:0040F8F9		       jnz     short loc_40F907
.text:0040F8FB		       or      dword ptr [esi+8], 104h
.text:0040F902		       jmp     loc_40F9B8
.text:0040F907 ; ---------------------------------------------------------------------------
.text:0040F907
.text:0040F907 loc_40F907:			       ; CODE XREF: ___get_qualified_locale+19j
.text:0040F907		       lea     eax, [ebp+40h]
.text:0040F90A		       cmp     eax, ebx
.text:0040F90C		       lea     edi, [esi+4]
.text:0040F90F		       mov     [esi], ebp
.text:0040F911		       mov     [edi], eax
.text:0040F913		       jz      short loc_40F929
.text:0040F915		       cmp     [eax], bl
.text:0040F917		       jz      short loc_40F929
.text:0040F919		       push    edi	       ; ppchName
.text:0040F91A		       push    16h	       ; high
.text:0040F91C		       push    offset ___rg_country ; lpTable
.text:0040F921		       call    TranslateName
.text:0040F926		       add     esp, 0Ch
.text:0040F929
.text:0040F929 loc_40F929:			       ; CODE XREF: ___get_qualified_locale+33j
.text:0040F929					       ; ___get_qualified_locale+37j
.text:0040F929		       mov     eax, [esi]
.text:0040F92B		       cmp     eax, ebx
.text:0040F92D		       mov     [esi+8],	ebx
.text:0040F930		       jz      short loc_40F97D
.text:0040F932		       cmp     [eax], bl
.text:0040F934		       jz      short loc_40F97D
.text:0040F936		       mov     eax, [edi]
.text:0040F938		       cmp     eax, ebx
.text:0040F93A		       jz      short loc_40F947
.text:0040F93C		       cmp     [eax], bl
.text:0040F93E		       jz      short loc_40F947
.text:0040F940		       call    GetLcidFromLangCountry
.text:0040F945		       jmp     short loc_40F94C
.text:0040F947 ; ---------------------------------------------------------------------------
.text:0040F947
.text:0040F947 loc_40F947:			       ; CODE XREF: ___get_qualified_locale+5Aj
.text:0040F947					       ; ___get_qualified_locale+5Ej
.text:0040F947		       call    GetLcidFromLanguage
.text:0040F94C
.text:0040F94C loc_40F94C:			       ; CODE XREF: ___get_qualified_locale+65j
.text:0040F94C		       cmp     [esi+8],	ebx
.text:0040F94F		       jnz     short loc_40F9CD
.text:0040F951		       push    esi	       ; ppchName
.text:0040F952		       push    40h	       ; high
.text:0040F954		       push    offset ___rg_language ; lpTable
.text:0040F959		       call    TranslateName
.text:0040F95E		       add     esp, 0Ch
.text:0040F961		       test    eax, eax
.text:0040F963		       jz      short loc_40F9C4
.text:0040F965		       mov     edi, [edi]
.text:0040F967		       cmp     edi, ebx
.text:0040F969		       jz      short loc_40F976
.text:0040F96B		       cmp     [edi], bl
.text:0040F96D		       jz      short loc_40F976
.text:0040F96F		       call    GetLcidFromLangCountry
.text:0040F974		       jmp     short loc_40F9C4
.text:0040F976 ; ---------------------------------------------------------------------------
.text:0040F976
.text:0040F976 loc_40F976:			       ; CODE XREF: ___get_qualified_locale+89j
.text:0040F976					       ; ___get_qualified_locale+8Dj
.text:0040F976		       call    GetLcidFromLanguage
.text:0040F97B		       jmp     short loc_40F9C4
.text:0040F97D ; ---------------------------------------------------------------------------
.text:0040F97D
.text:0040F97D loc_40F97D:			       ; CODE XREF: ___get_qualified_locale+50j
.text:0040F97D					       ; ___get_qualified_locale+54j
.text:0040F97D		       mov     edi, [edi]
.text:0040F97F		       cmp     edi, ebx
.text:0040F981		       jz      short loc_40F9B1
.text:0040F983		       cmp     [edi], bl
.text:0040F985		       jz      short loc_40F9B1
.text:0040F987		       push    edi	       ; buf
.text:0040F988		       call    _strlen
.text:0040F98D		       sub     eax, 3
.text:0040F990		       neg     eax
.text:0040F992		       pop     ecx
.text:0040F993		       sbb     eax, eax
.text:0040F995		       push    1	       ; dwFlags
.text:0040F997		       inc     eax
.text:0040F998		       push    offset CountryEnumProc ;	lpLocaleEnumProc
.text:0040F99D		       mov     [esi+14h], eax
.text:0040F9A0		       call    ds:__imp__EnumSystemLocalesA@8 ;	EnumSystemLocalesA(x,x)
.text:0040F9A6		       test    byte ptr	[esi+8], 4
.text:0040F9AA		       jnz     short loc_40F9C4
.text:0040F9AC		       mov     [esi+8],	ebx
.text:0040F9AF		       jmp     short loc_40F9C4
.text:0040F9B1 ; ---------------------------------------------------------------------------
.text:0040F9B1
.text:0040F9B1 loc_40F9B1:			       ; CODE XREF: ___get_qualified_locale+A1j
.text:0040F9B1					       ; ___get_qualified_locale+A5j
.text:0040F9B1		       mov     dword ptr [esi+8], 104h
.text:0040F9B8
.text:0040F9B8 loc_40F9B8:			       ; CODE XREF: ___get_qualified_locale+22j
.text:0040F9B8		       call    ds:__imp__GetUserDefaultLCID@0 ;	GetUserDefaultLCID()
.text:0040F9BE		       mov     [esi+18h], eax
.text:0040F9C1		       mov     [esi+1Ch], eax
.text:0040F9C4
.text:0040F9C4 loc_40F9C4:			       ; CODE XREF: ___get_qualified_locale+83j
.text:0040F9C4					       ; ___get_qualified_locale+94j ...
.text:0040F9C4		       cmp     [esi+8],	ebx
.text:0040F9C7		       jz      loc_40FABC
.text:0040F9CD
.text:0040F9CD loc_40F9CD:			       ; CODE XREF: ___get_qualified_locale+6Fj
.text:0040F9CD		       mov     ecx, ebp
.text:0040F9CF		       add     ebp, 80h
.text:0040F9D5		       neg     ecx
.text:0040F9D7		       sbb     ecx, ecx
.text:0040F9D9		       and     ecx, ebp	       ; lpCodePageStr
.text:0040F9DB		       mov     edi, esi	       ; _psetloc_data
.text:0040F9DD		       call    ProcessCodePage
.text:0040F9E2		       mov     ebx, eax
.text:0040F9E4		       test    ebx, ebx
.text:0040F9E6		       jz      loc_40FABC
.text:0040F9EC		       cmp     ebx, 0FDE8h
.text:0040F9F2		       jz      loc_40FABC
.text:0040F9F8		       cmp     ebx, 0FDE9h
.text:0040F9FE		       jz      loc_40FABC
.text:0040FA04		       movzx   eax, bx
.text:0040FA07		       push    eax	       ; CodePage
.text:0040FA08		       call    ds:__imp__IsValidCodePage@4 ; IsValidCodePage(x)
.text:0040FA0E		       test    eax, eax
.text:0040FA10		       jz      loc_40FABC
.text:0040FA16		       push    1	       ; dwFlags
.text:0040FA18		       push    dword ptr [esi+18h] ; Locale
.text:0040FA1B		       call    ds:__imp__IsValidLocale@8 ; IsValidLocale(x,x)
.text:0040FA21		       test    eax, eax
.text:0040FA23		       jz      loc_40FABC
.text:0040FA29		       mov     eax, [esp+10h+lpOutId]
.text:0040FA2D		       test    eax, eax
.text:0040FA2F		       jz      short loc_40FA44
.text:0040FA31		       mov     cx, [esi+18h]
.text:0040FA35		       mov     [eax], cx
.text:0040FA38		       mov     cx, [esi+1Ch]
.text:0040FA3C		       mov     [eax+2],	cx
.text:0040FA40		       mov     [eax+4],	bx
.text:0040FA44
.text:0040FA44 loc_40FA44:			       ; CODE XREF: ___get_qualified_locale+14Fj
.text:0040FA44		       mov     edi, [esp+10h+lpOutStr]
.text:0040FA48		       test    edi, edi
.text:0040FA4A		       jz      short loc_40FAB7
.text:0040FA4C		       cmp     word ptr	[eax], 814h
.text:0040FA51		       mov     ebp, ds:__imp__GetLocaleInfoA@16	; GetLocaleInfoA(x,x,x,x)
.text:0040FA57		       jnz     short loc_40FA7E
.text:0040FA59		       push    offset aNorwegianNynor ;	"Norwegian-Nynorsk"
.text:0040FA5E		       push    40h	       ; _SizeInBytes
.text:0040FA60		       push    edi	       ; _Dst
.text:0040FA61		       call    _strcpy_s
.text:0040FA66		       add     esp, 0Ch
.text:0040FA69		       test    eax, eax
.text:0040FA6B		       jz      short loc_40FA8F
.text:0040FA6D		       xor     eax, eax
.text:0040FA6F		       push    eax	       ; pReserved
.text:0040FA70		       push    eax	       ; nLine
.text:0040FA71		       push    eax	       ; pszFile
.text:0040FA72		       push    eax	       ; pszFunction
.text:0040FA73		       push    eax	       ; pszExpression
.text:0040FA74		       call    __invoke_watson
.text:0040FA79		       add     esp, 14h
.text:0040FA7C		       jmp     short loc_40FA8F
.text:0040FA7E ; ---------------------------------------------------------------------------
.text:0040FA7E
.text:0040FA7E loc_40FA7E:			       ; CODE XREF: ___get_qualified_locale+177j
.text:0040FA7E		       push    40h	       ; cchData
.text:0040FA80		       push    edi	       ; lpLCData
.text:0040FA81		       push    1001h	       ; LCType
.text:0040FA86		       push    dword ptr [esi+18h] ; Locale
.text:0040FA89		       call    ebp ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040FA8B		       test    eax, eax
.text:0040FA8D		       jz      short loc_40FABC
.text:0040FA8F
.text:0040FA8F loc_40FA8F:			       ; CODE XREF: ___get_qualified_locale+18Bj
.text:0040FA8F					       ; ___get_qualified_locale+19Cj
.text:0040FA8F		       push    40h	       ; cchData
.text:0040FA91		       lea     eax, [edi+40h]
.text:0040FA94		       push    eax	       ; lpLCData
.text:0040FA95		       push    1002h	       ; LCType
.text:0040FA9A		       push    dword ptr [esi+1Ch] ; Locale
.text:0040FA9D		       call    ebp ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040FA9F		       test    eax, eax
.text:0040FAA1		       jz      short loc_40FABC
.text:0040FAA3		       push    0Ah	       ; radix
.text:0040FAA5		       push    10h	       ; sizeInTChars
.text:0040FAA7		       add     edi, 80h
.text:0040FAAD		       push    edi	       ; buf
.text:0040FAAE		       push    ebx	       ; val
.text:0040FAAF		       call    __itoa_s
.text:0040FAB4		       add     esp, 10h
.text:0040FAB7
.text:0040FAB7 loc_40FAB7:			       ; CODE XREF: ___get_qualified_locale+16Aj
.text:0040FAB7		       xor     eax, eax
.text:0040FAB9		       inc     eax
.text:0040FABA		       jmp     short loc_40FABE
.text:0040FABC ; ---------------------------------------------------------------------------
.text:0040FABC
.text:0040FABC loc_40FABC:			       ; CODE XREF: ___get_qualified_locale+E7j
.text:0040FABC					       ; ___get_qualified_locale+106j ...
.text:0040FABC		       xor     eax, eax
.text:0040FABE
.text:0040FABE loc_40FABE:			       ; CODE XREF: ___get_qualified_locale+1DAj
.text:0040FABE		       pop     edi
.text:0040FABF		       pop     esi
.text:0040FAC0		       pop     ebp
.text:0040FAC1		       pop     ebx
.text:0040FAC2		       retn
.text:0040FAC2 ___get_qualified_locale endp
.text:0040FAC2
.text:0040FAC3
.text:0040FAC3 ; =============== S U B R O U T I N E =======================================
.text:0040FAC3
.text:0040FAC3
.text:0040FAC3 ; int __usercall	cmpResult<eax>(int cmp<eax>)
.text:0040FAC3 cmpResult       proc near
.text:0040FAC3 cmp = eax
.text:0040FAC3		       test    cmp, cmp
.text:0040FAC5		       jz      short locret_40FAD4
.text:0040FAC7		       xor     ecx, ecx
.text:0040FAC9		       test    cmp, cmp
.text:0040FACB		       setnle  cl
.text:0040FACE		       lea     ecx, [ecx+ecx-1]
.text:0040FAD2		       mov     cmp, ecx
.text:0040FAD4
.text:0040FAD4 locret_40FAD4:			       ; CODE XREF: cmpResult+2j
.text:0040FAD4		       retn
.text:0040FAD4 cmpResult       endp
.text:0040FAD4
.text:0040FAD5
.text:0040FAD5 ; =============== S U B R O U T I N E =======================================
.text:0040FAD5
.text:0040FAD5
.text:0040FAD5 ; int __usercall	cmpBYTE<eax>(const void	*lhs<eax>, const void *rhs<ecx>)
.text:0040FAD5 cmpBYTE	       proc near
.text:0040FAD5 lhs = eax
.text:0040FAD5 rhs = ecx
.text:0040FAD5		       movzx   lhs, byte ptr [lhs]
.text:0040FAD8		       movzx   rhs, byte ptr [rhs]
.text:0040FADB		       sub     lhs, rhs
.text:0040FADD		       jz      short locret_40FAEC
.text:0040FADF		       xor     rhs, rhs
.text:0040FAE1		       test    lhs, lhs
.text:0040FAE3		       setnle  cl
.text:0040FAE6		       lea     rhs, [rhs+rhs-1]
.text:0040FAEA		       mov     lhs, rhs
.text:0040FAEC
.text:0040FAEC locret_40FAEC:			       ; CODE XREF: cmpBYTE+8j
.text:0040FAEC		       retn
.text:0040FAEC cmpBYTE	       endp
.text:0040FAEC
.text:0040FAED
.text:0040FAED ; =============== S U B R O U T I N E =======================================
.text:0040FAED
.text:0040FAED
.text:0040FAED ; int __usercall	cmpWORD<eax>(const void	*lhs<esi>, const void *rhs<ecx>)
.text:0040FAED cmpWORD	       proc near
.text:0040FAED lhs = esi
.text:0040FAED rhs = ecx
.text:0040FAED		       mov     ax, [lhs]
.text:0040FAF0		       cmp     ax, [rhs]
.text:0040FAF3		       jz      short loc_40FB2A
.text:0040FAF5		       movzx   edx, byte ptr [rhs]
.text:0040FAF8		       movzx   eax, al
.text:0040FAFB		       sub     eax, edx
.text:0040FAFD		       jz      short loc_40FB10
.text:0040FAFF		       xor     edx, edx
.text:0040FB01		       test    eax, eax
.text:0040FB03		       setnle  dl
.text:0040FB06		       lea     edx, [edx+edx-1]
.text:0040FB0A		       mov     eax, edx
.text:0040FB0C		       test    eax, eax
.text:0040FB0E		       jnz     short locret_40FB2C
.text:0040FB10
.text:0040FB10 loc_40FB10:			       ; CODE XREF: cmpWORD+10j
.text:0040FB10		       movzx   eax, byte ptr [lhs+1]
.text:0040FB14		       movzx   rhs, byte ptr [rhs+1]
.text:0040FB18		       sub     eax, rhs
.text:0040FB1A		       jz      short locret_40FB2C
.text:0040FB1C		       xor     rhs, rhs
.text:0040FB1E		       test    eax, eax
.text:0040FB20		       setnle  cl
.text:0040FB23		       lea     rhs, [rhs+rhs-1]
.text:0040FB27		       mov     eax, rhs
.text:0040FB29		       retn
.text:0040FB2A ; ---------------------------------------------------------------------------
.text:0040FB2A
.text:0040FB2A loc_40FB2A:			       ; CODE XREF: cmpWORD+6j
.text:0040FB2A		       xor     eax, eax
.text:0040FB2C
.text:0040FB2C locret_40FB2C:			       ; CODE XREF: cmpWORD+21j
.text:0040FB2C					       ; cmpWORD+2Dj
.text:0040FB2C		       retn
.text:0040FB2C cmpWORD	       endp
.text:0040FB2C
.text:0040FB2D
.text:0040FB2D ; =============== S U B R O U T I N E =======================================
.text:0040FB2D
.text:0040FB2D
.text:0040FB2D ; int __usercall	cmpDWORD<eax>(const void *lhs<esi>, const void *rhs<ecx>)
.text:0040FB2D cmpDWORD	       proc near
.text:0040FB2D lhs = esi
.text:0040FB2D rhs = ecx
.text:0040FB2D		       mov     eax, [lhs]
.text:0040FB2F		       cmp     eax, [rhs]
.text:0040FB31		       jz      short loc_40FBA2
.text:0040FB33		       movzx   edx, byte ptr [rhs]
.text:0040FB36		       movzx   eax, al
.text:0040FB39		       sub     eax, edx
.text:0040FB3B		       jz      short loc_40FB4E
.text:0040FB3D		       xor     edx, edx
.text:0040FB3F		       test    eax, eax
.text:0040FB41		       setnle  dl
.text:0040FB44		       lea     edx, [edx+edx-1]
.text:0040FB48		       mov     eax, edx
.text:0040FB4A		       test    eax, eax
.text:0040FB4C		       jnz     short locret_40FBA4
.text:0040FB4E
.text:0040FB4E loc_40FB4E:			       ; CODE XREF: cmpDWORD+Ej
.text:0040FB4E		       movzx   eax, byte ptr [lhs+1]
.text:0040FB52		       movzx   edx, byte ptr [rhs+1]
.text:0040FB56		       sub     eax, edx
.text:0040FB58		       jz      short loc_40FB6B
.text:0040FB5A		       xor     edx, edx
.text:0040FB5C		       test    eax, eax
.text:0040FB5E		       setnle  dl
.text:0040FB61		       lea     edx, [edx+edx-1]
.text:0040FB65		       mov     eax, edx
.text:0040FB67		       test    eax, eax
.text:0040FB69		       jnz     short locret_40FBA4
.text:0040FB6B
.text:0040FB6B loc_40FB6B:			       ; CODE XREF: cmpDWORD+2Bj
.text:0040FB6B		       movzx   eax, byte ptr [lhs+2]
.text:0040FB6F		       movzx   edx, byte ptr [rhs+2]
.text:0040FB73		       sub     eax, edx
.text:0040FB75		       jz      short loc_40FB88
.text:0040FB77		       xor     edx, edx
.text:0040FB79		       test    eax, eax
.text:0040FB7B		       setnle  dl
.text:0040FB7E		       lea     edx, [edx+edx-1]
.text:0040FB82		       mov     eax, edx
.text:0040FB84		       test    eax, eax
.text:0040FB86		       jnz     short locret_40FBA4
.text:0040FB88
.text:0040FB88 loc_40FB88:			       ; CODE XREF: cmpDWORD+48j
.text:0040FB88		       movzx   eax, byte ptr [lhs+3]
.text:0040FB8C		       movzx   rhs, byte ptr [rhs+3]
.text:0040FB90		       sub     eax, rhs
.text:0040FB92		       jz      short locret_40FBA4
.text:0040FB94		       xor     rhs, rhs
.text:0040FB96		       test    eax, eax
.text:0040FB98		       setnle  cl
.text:0040FB9B		       lea     rhs, [rhs+rhs-1]
.text:0040FB9F		       mov     eax, rhs
.text:0040FBA1		       retn
.text:0040FBA2 ; ---------------------------------------------------------------------------
.text:0040FBA2
.text:0040FBA2 loc_40FBA2:			       ; CODE XREF: cmpDWORD+4j
.text:0040FBA2		       xor     eax, eax
.text:0040FBA4
.text:0040FBA4 locret_40FBA4:			       ; CODE XREF: cmpDWORD+1Fj
.text:0040FBA4					       ; cmpDWORD+3Cj ...
.text:0040FBA4		       retn
.text:0040FBA4 cmpDWORD	       endp
.text:0040FBA4
.text:0040FBA5
.text:0040FBA5 ; =============== S U B R O U T I N E =======================================
.text:0040FBA5
.text:0040FBA5
.text:0040FBA5 ; int __usercall	unaligned_memcmp<eax>(const char *bLHS<ecx>, const char	*bRHS<edx>, unsigned int siz<eax>)
.text:0040FBA5 unaligned_memcmp	proc near
.text:0040FBA5 bLHS = ecx
.text:0040FBA5 bRHS = edx
.text:0040FBA5 siz = eax
.text:0040FBA5		       push    esi
.text:0040FBA6		       push    edi
.text:0040FBA7		       mov     edi, siz
.text:0040FBA9		       jmp     loc_41000C
.text:0040FBAE ; ---------------------------------------------------------------------------
.text:0040FBAE
.text:0040FBAE loc_40FBAE:			       ; CODE XREF: unaligned_memcmp+46Aj
.text:0040FBAE		       mov     siz, [bLHS]
.text:0040FBB0		       cmp     siz, [bRHS]
.text:0040FBB2		       jz      short loc_40FC2C
.text:0040FBB4		       movzx   esi, al
.text:0040FBB7		       movzx   siz, byte ptr [bRHS]
.text:0040FBBA		       sub     esi, siz
.text:0040FBBC		       jz      short loc_40FBD1
.text:0040FBBE		       xor     siz, siz
.text:0040FBC0		       test    esi, esi
.text:0040FBC2		       setnle  al
.text:0040FBC5		       lea     siz, [siz+siz-1]
.text:0040FBC9		       test    siz, siz
.text:0040FBCB		       jnz     loc_4103E3
.text:0040FBD1
.text:0040FBD1 loc_40FBD1:			       ; CODE XREF: unaligned_memcmp+17j
.text:0040FBD1		       movzx   esi, byte ptr [bLHS+1]
.text:0040FBD5		       movzx   siz, byte ptr [bRHS+1]
.text:0040FBD9		       sub     esi, siz
.text:0040FBDB		       jz      short loc_40FBF0
.text:0040FBDD		       xor     siz, siz
.text:0040FBDF		       test    esi, esi
.text:0040FBE1		       setnle  al
.text:0040FBE4		       lea     siz, [siz+siz-1]
.text:0040FBE8		       test    siz, siz
.text:0040FBEA		       jnz     loc_4103E3
.text:0040FBF0
.text:0040FBF0 loc_40FBF0:			       ; CODE XREF: unaligned_memcmp+36j
.text:0040FBF0		       movzx   esi, byte ptr [bLHS+2]
.text:0040FBF4		       movzx   siz, byte ptr [bRHS+2]
.text:0040FBF8		       sub     esi, siz
.text:0040FBFA		       jz      short loc_40FC0F
.text:0040FBFC		       xor     siz, siz
.text:0040FBFE		       test    esi, esi
.text:0040FC00		       setnle  al
.text:0040FC03		       lea     siz, [siz+siz-1]
.text:0040FC07		       test    siz, siz
.text:0040FC09		       jnz     loc_4103E3
.text:0040FC0F
.text:0040FC0F loc_40FC0F:			       ; CODE XREF: unaligned_memcmp+55j
.text:0040FC0F		       movzx   esi, byte ptr [bLHS+3]
.text:0040FC13		       movzx   siz, byte ptr [bRHS+3]
.text:0040FC17		       sub     esi, siz
.text:0040FC19		       jz      short loc_40FC28
.text:0040FC1B		       xor     siz, siz
.text:0040FC1D		       test    esi, esi
.text:0040FC1F		       setnle  al
.text:0040FC22		       lea     siz, [siz+siz-1]
.text:0040FC26		       mov     esi, siz
.text:0040FC28
.text:0040FC28 loc_40FC28:			       ; CODE XREF: unaligned_memcmp+74j
.text:0040FC28		       mov     siz, esi
.text:0040FC2A		       jmp     short loc_40FC2E
.text:0040FC2C ; ---------------------------------------------------------------------------
.text:0040FC2C
.text:0040FC2C loc_40FC2C:			       ; CODE XREF: unaligned_memcmp+Dj
.text:0040FC2C		       xor     siz, siz
.text:0040FC2E
.text:0040FC2E loc_40FC2E:			       ; CODE XREF: unaligned_memcmp+85j
.text:0040FC2E		       test    siz, siz
.text:0040FC30		       jnz     loc_4103E3
.text:0040FC36		       mov     siz, [bLHS+4]
.text:0040FC39		       cmp     siz, [bRHS+4]
.text:0040FC3C		       jz      short loc_40FCB7
.text:0040FC3E		       movzx   esi, al
.text:0040FC41		       movzx   siz, byte ptr [bRHS+4]
.text:0040FC45		       sub     esi, siz
.text:0040FC47		       jz      short loc_40FC5C
.text:0040FC49		       xor     siz, siz
.text:0040FC4B		       test    esi, esi
.text:0040FC4D		       setnle  al
.text:0040FC50		       lea     siz, [siz+siz-1]
.text:0040FC54		       test    siz, siz
.text:0040FC56		       jnz     loc_4103E3
.text:0040FC5C
.text:0040FC5C loc_40FC5C:			       ; CODE XREF: unaligned_memcmp+A2j
.text:0040FC5C		       movzx   esi, byte ptr [bLHS+5]
.text:0040FC60		       movzx   siz, byte ptr [bRHS+5]
.text:0040FC64		       sub     esi, siz
.text:0040FC66		       jz      short loc_40FC7B
.text:0040FC68		       xor     siz, siz
.text:0040FC6A		       test    esi, esi
.text:0040FC6C		       setnle  al
.text:0040FC6F		       lea     siz, [siz+siz-1]
.text:0040FC73		       test    siz, siz
.text:0040FC75		       jnz     loc_4103E3
.text:0040FC7B
.text:0040FC7B loc_40FC7B:			       ; CODE XREF: unaligned_memcmp+C1j
.text:0040FC7B		       movzx   esi, byte ptr [bLHS+6]
.text:0040FC7F		       movzx   siz, byte ptr [bRHS+6]
.text:0040FC83		       sub     esi, siz
.text:0040FC85		       jz      short loc_40FC9A
.text:0040FC87		       xor     siz, siz
.text:0040FC89		       test    esi, esi
.text:0040FC8B		       setnle  al
.text:0040FC8E		       lea     siz, [siz+siz-1]
.text:0040FC92		       test    siz, siz
.text:0040FC94		       jnz     loc_4103E3
.text:0040FC9A
.text:0040FC9A loc_40FC9A:			       ; CODE XREF: unaligned_memcmp+E0j
.text:0040FC9A		       movzx   esi, byte ptr [bLHS+7]
.text:0040FC9E		       movzx   siz, byte ptr [bRHS+7]
.text:0040FCA2		       sub     esi, siz
.text:0040FCA4		       jz      short loc_40FCB3
.text:0040FCA6		       xor     siz, siz
.text:0040FCA8		       test    esi, esi
.text:0040FCAA		       setnle  al
.text:0040FCAD		       lea     siz, [siz+siz-1]
.text:0040FCB1		       mov     esi, siz
.text:0040FCB3
.text:0040FCB3 loc_40FCB3:			       ; CODE XREF: unaligned_memcmp+FFj
.text:0040FCB3		       mov     siz, esi
.text:0040FCB5		       jmp     short loc_40FCB9
.text:0040FCB7 ; ---------------------------------------------------------------------------
.text:0040FCB7
.text:0040FCB7 loc_40FCB7:			       ; CODE XREF: unaligned_memcmp+97j
.text:0040FCB7		       xor     siz, siz
.text:0040FCB9
.text:0040FCB9 loc_40FCB9:			       ; CODE XREF: unaligned_memcmp+110j
.text:0040FCB9		       test    siz, siz
.text:0040FCBB		       jnz     loc_4103E3
.text:0040FCC1		       mov     siz, [bLHS+8]
.text:0040FCC4		       cmp     siz, [bRHS+8]
.text:0040FCC7		       jz      short loc_40FD42
.text:0040FCC9		       movzx   esi, al
.text:0040FCCC		       movzx   siz, byte ptr [bRHS+8]
.text:0040FCD0		       sub     esi, siz
.text:0040FCD2		       jz      short loc_40FCE7
.text:0040FCD4		       xor     siz, siz
.text:0040FCD6		       test    esi, esi
.text:0040FCD8		       setnle  al
.text:0040FCDB		       lea     siz, [siz+siz-1]
.text:0040FCDF		       test    siz, siz
.text:0040FCE1		       jnz     loc_4103E3
.text:0040FCE7
.text:0040FCE7 loc_40FCE7:			       ; CODE XREF: unaligned_memcmp+12Dj
.text:0040FCE7		       movzx   esi, byte ptr [bLHS+9]
.text:0040FCEB		       movzx   siz, byte ptr [bRHS+9]
.text:0040FCEF		       sub     esi, siz
.text:0040FCF1		       jz      short loc_40FD06
.text:0040FCF3		       xor     siz, siz
.text:0040FCF5		       test    esi, esi
.text:0040FCF7		       setnle  al
.text:0040FCFA		       lea     siz, [siz+siz-1]
.text:0040FCFE		       test    siz, siz
.text:0040FD00		       jnz     loc_4103E3
.text:0040FD06
.text:0040FD06 loc_40FD06:			       ; CODE XREF: unaligned_memcmp+14Cj
.text:0040FD06		       movzx   esi, byte ptr [bLHS+0Ah]
.text:0040FD0A		       movzx   siz, byte ptr [bRHS+0Ah]
.text:0040FD0E		       sub     esi, siz
.text:0040FD10		       jz      short loc_40FD25
.text:0040FD12		       xor     siz, siz
.text:0040FD14		       test    esi, esi
.text:0040FD16		       setnle  al
.text:0040FD19		       lea     siz, [siz+siz-1]
.text:0040FD1D		       test    siz, siz
.text:0040FD1F		       jnz     loc_4103E3
.text:0040FD25
.text:0040FD25 loc_40FD25:			       ; CODE XREF: unaligned_memcmp+16Bj
.text:0040FD25		       movzx   esi, byte ptr [bLHS+0Bh]
.text:0040FD29		       movzx   siz, byte ptr [bRHS+0Bh]
.text:0040FD2D		       sub     esi, siz
.text:0040FD2F		       jz      short loc_40FD3E
.text:0040FD31		       xor     siz, siz
.text:0040FD33		       test    esi, esi
.text:0040FD35		       setnle  al
.text:0040FD38		       lea     siz, [siz+siz-1]
.text:0040FD3C		       mov     esi, siz
.text:0040FD3E
.text:0040FD3E loc_40FD3E:			       ; CODE XREF: unaligned_memcmp+18Aj
.text:0040FD3E		       mov     siz, esi
.text:0040FD40		       jmp     short loc_40FD44
.text:0040FD42 ; ---------------------------------------------------------------------------
.text:0040FD42
.text:0040FD42 loc_40FD42:			       ; CODE XREF: unaligned_memcmp+122j
.text:0040FD42		       xor     siz, siz
.text:0040FD44
.text:0040FD44 loc_40FD44:			       ; CODE XREF: unaligned_memcmp+19Bj
.text:0040FD44		       test    siz, siz
.text:0040FD46		       jnz     loc_4103E3
.text:0040FD4C		       mov     siz, [bLHS+0Ch]
.text:0040FD4F		       cmp     siz, [bRHS+0Ch]
.text:0040FD52		       jz      short loc_40FDCD
.text:0040FD54		       movzx   esi, al
.text:0040FD57		       movzx   siz, byte ptr [bRHS+0Ch]
.text:0040FD5B		       sub     esi, siz
.text:0040FD5D		       jz      short loc_40FD72
.text:0040FD5F		       xor     siz, siz
.text:0040FD61		       test    esi, esi
.text:0040FD63		       setnle  al
.text:0040FD66		       lea     siz, [siz+siz-1]
.text:0040FD6A		       test    siz, siz
.text:0040FD6C		       jnz     loc_4103E3
.text:0040FD72
.text:0040FD72 loc_40FD72:			       ; CODE XREF: unaligned_memcmp+1B8j
.text:0040FD72		       movzx   esi, byte ptr [bLHS+0Dh]
.text:0040FD76		       movzx   siz, byte ptr [bRHS+0Dh]
.text:0040FD7A		       sub     esi, siz
.text:0040FD7C		       jz      short loc_40FD91
.text:0040FD7E		       xor     siz, siz
.text:0040FD80		       test    esi, esi
.text:0040FD82		       setnle  al
.text:0040FD85		       lea     siz, [siz+siz-1]
.text:0040FD89		       test    siz, siz
.text:0040FD8B		       jnz     loc_4103E3
.text:0040FD91
.text:0040FD91 loc_40FD91:			       ; CODE XREF: unaligned_memcmp+1D7j
.text:0040FD91		       movzx   esi, byte ptr [bLHS+0Eh]
.text:0040FD95		       movzx   siz, byte ptr [bRHS+0Eh]
.text:0040FD99		       sub     esi, siz
.text:0040FD9B		       jz      short loc_40FDB0
.text:0040FD9D		       xor     siz, siz
.text:0040FD9F		       test    esi, esi
.text:0040FDA1		       setnle  al
.text:0040FDA4		       lea     siz, [siz+siz-1]
.text:0040FDA8		       test    siz, siz
.text:0040FDAA		       jnz     loc_4103E3
.text:0040FDB0
.text:0040FDB0 loc_40FDB0:			       ; CODE XREF: unaligned_memcmp+1F6j
.text:0040FDB0		       movzx   esi, byte ptr [bLHS+0Fh]
.text:0040FDB4		       movzx   siz, byte ptr [bRHS+0Fh]
.text:0040FDB8		       sub     esi, siz
.text:0040FDBA		       jz      short loc_40FDC9
.text:0040FDBC		       xor     siz, siz
.text:0040FDBE		       test    esi, esi
.text:0040FDC0		       setnle  al
.text:0040FDC3		       lea     siz, [siz+siz-1]
.text:0040FDC7		       mov     esi, siz
.text:0040FDC9
.text:0040FDC9 loc_40FDC9:			       ; CODE XREF: unaligned_memcmp+215j
.text:0040FDC9		       mov     siz, esi
.text:0040FDCB		       jmp     short loc_40FDCF
.text:0040FDCD ; ---------------------------------------------------------------------------
.text:0040FDCD
.text:0040FDCD loc_40FDCD:			       ; CODE XREF: unaligned_memcmp+1ADj
.text:0040FDCD		       xor     siz, siz
.text:0040FDCF
.text:0040FDCF loc_40FDCF:			       ; CODE XREF: unaligned_memcmp+226j
.text:0040FDCF		       test    siz, siz
.text:0040FDD1		       jnz     loc_4103E3
.text:0040FDD7		       mov     siz, [bLHS+10h]
.text:0040FDDA		       cmp     siz, [bRHS+10h]
.text:0040FDDD		       jz      short loc_40FE58
.text:0040FDDF		       movzx   esi, al
.text:0040FDE2		       movzx   siz, byte ptr [bRHS+10h]
.text:0040FDE6		       sub     esi, siz
.text:0040FDE8		       jz      short loc_40FDFD
.text:0040FDEA		       xor     siz, siz
.text:0040FDEC		       test    esi, esi
.text:0040FDEE		       setnle  al
.text:0040FDF1		       lea     siz, [siz+siz-1]
.text:0040FDF5		       test    siz, siz
.text:0040FDF7		       jnz     loc_4103E3
.text:0040FDFD
.text:0040FDFD loc_40FDFD:			       ; CODE XREF: unaligned_memcmp+243j
.text:0040FDFD		       movzx   esi, byte ptr [bLHS+11h]
.text:0040FE01		       movzx   siz, byte ptr [bRHS+11h]
.text:0040FE05		       sub     esi, siz
.text:0040FE07		       jz      short loc_40FE1C
.text:0040FE09		       xor     siz, siz
.text:0040FE0B		       test    esi, esi
.text:0040FE0D		       setnle  al
.text:0040FE10		       lea     siz, [siz+siz-1]
.text:0040FE14		       test    siz, siz
.text:0040FE16		       jnz     loc_4103E3
.text:0040FE1C
.text:0040FE1C loc_40FE1C:			       ; CODE XREF: unaligned_memcmp+262j
.text:0040FE1C		       movzx   esi, byte ptr [bLHS+12h]
.text:0040FE20		       movzx   siz, byte ptr [bRHS+12h]
.text:0040FE24		       sub     esi, siz
.text:0040FE26		       jz      short loc_40FE3B
.text:0040FE28		       xor     siz, siz
.text:0040FE2A		       test    esi, esi
.text:0040FE2C		       setnle  al
.text:0040FE2F		       lea     siz, [siz+siz-1]
.text:0040FE33		       test    siz, siz
.text:0040FE35		       jnz     loc_4103E3
.text:0040FE3B
.text:0040FE3B loc_40FE3B:			       ; CODE XREF: unaligned_memcmp+281j
.text:0040FE3B		       movzx   esi, byte ptr [bLHS+13h]
.text:0040FE3F		       movzx   siz, byte ptr [bRHS+13h]
.text:0040FE43		       sub     esi, siz
.text:0040FE45		       jz      short loc_40FE54
.text:0040FE47		       xor     siz, siz
.text:0040FE49		       test    esi, esi
.text:0040FE4B		       setnle  al
.text:0040FE4E		       lea     siz, [siz+siz-1]
.text:0040FE52		       mov     esi, siz
.text:0040FE54
.text:0040FE54 loc_40FE54:			       ; CODE XREF: unaligned_memcmp+2A0j
.text:0040FE54		       mov     siz, esi
.text:0040FE56		       jmp     short loc_40FE5A
.text:0040FE58 ; ---------------------------------------------------------------------------
.text:0040FE58
.text:0040FE58 loc_40FE58:			       ; CODE XREF: unaligned_memcmp+238j
.text:0040FE58		       xor     siz, siz
.text:0040FE5A
.text:0040FE5A loc_40FE5A:			       ; CODE XREF: unaligned_memcmp+2B1j
.text:0040FE5A		       test    siz, siz
.text:0040FE5C		       jnz     loc_4103E3
.text:0040FE62		       mov     siz, [bLHS+14h]
.text:0040FE65		       cmp     siz, [bRHS+14h]
.text:0040FE68		       jz      short loc_40FEE3
.text:0040FE6A		       movzx   esi, al
.text:0040FE6D		       movzx   siz, byte ptr [bRHS+14h]
.text:0040FE71		       sub     esi, siz
.text:0040FE73		       jz      short loc_40FE88
.text:0040FE75		       xor     siz, siz
.text:0040FE77		       test    esi, esi
.text:0040FE79		       setnle  al
.text:0040FE7C		       lea     siz, [siz+siz-1]
.text:0040FE80		       test    siz, siz
.text:0040FE82		       jnz     loc_4103E3
.text:0040FE88
.text:0040FE88 loc_40FE88:			       ; CODE XREF: unaligned_memcmp+2CEj
.text:0040FE88		       movzx   esi, byte ptr [bLHS+15h]
.text:0040FE8C		       movzx   siz, byte ptr [bRHS+15h]
.text:0040FE90		       sub     esi, siz
.text:0040FE92		       jz      short loc_40FEA7
.text:0040FE94		       xor     siz, siz
.text:0040FE96		       test    esi, esi
.text:0040FE98		       setnle  al
.text:0040FE9B		       lea     siz, [siz+siz-1]
.text:0040FE9F		       test    siz, siz
.text:0040FEA1		       jnz     loc_4103E3
.text:0040FEA7
.text:0040FEA7 loc_40FEA7:			       ; CODE XREF: unaligned_memcmp+2EDj
.text:0040FEA7		       movzx   esi, byte ptr [bLHS+16h]
.text:0040FEAB		       movzx   siz, byte ptr [bRHS+16h]
.text:0040FEAF		       sub     esi, siz
.text:0040FEB1		       jz      short loc_40FEC6
.text:0040FEB3		       xor     siz, siz
.text:0040FEB5		       test    esi, esi
.text:0040FEB7		       setnle  al
.text:0040FEBA		       lea     siz, [siz+siz-1]
.text:0040FEBE		       test    siz, siz
.text:0040FEC0		       jnz     loc_4103E3
.text:0040FEC6
.text:0040FEC6 loc_40FEC6:			       ; CODE XREF: unaligned_memcmp+30Cj
.text:0040FEC6		       movzx   esi, byte ptr [bLHS+17h]
.text:0040FECA		       movzx   siz, byte ptr [bRHS+17h]
.text:0040FECE		       sub     esi, siz
.text:0040FED0		       jz      short loc_40FEDF
.text:0040FED2		       xor     siz, siz
.text:0040FED4		       test    esi, esi
.text:0040FED6		       setnle  al
.text:0040FED9		       lea     siz, [siz+siz-1]
.text:0040FEDD		       mov     esi, siz
.text:0040FEDF
.text:0040FEDF loc_40FEDF:			       ; CODE XREF: unaligned_memcmp+32Bj
.text:0040FEDF		       mov     siz, esi
.text:0040FEE1		       jmp     short loc_40FEE5
.text:0040FEE3 ; ---------------------------------------------------------------------------
.text:0040FEE3
.text:0040FEE3 loc_40FEE3:			       ; CODE XREF: unaligned_memcmp+2C3j
.text:0040FEE3		       xor     siz, siz
.text:0040FEE5
.text:0040FEE5 loc_40FEE5:			       ; CODE XREF: unaligned_memcmp+33Cj
.text:0040FEE5		       test    siz, siz
.text:0040FEE7		       jnz     loc_4103E3
.text:0040FEED		       mov     siz, [bLHS+18h]
.text:0040FEF0		       cmp     siz, [bRHS+18h]
.text:0040FEF3		       jz      short loc_40FF6E
.text:0040FEF5		       movzx   esi, al
.text:0040FEF8		       movzx   siz, byte ptr [bRHS+18h]
.text:0040FEFC		       sub     esi, siz
.text:0040FEFE		       jz      short loc_40FF13
.text:0040FF00		       xor     siz, siz
.text:0040FF02		       test    esi, esi
.text:0040FF04		       setnle  al
.text:0040FF07		       lea     siz, [siz+siz-1]
.text:0040FF0B		       test    siz, siz
.text:0040FF0D		       jnz     loc_4103E3
.text:0040FF13
.text:0040FF13 loc_40FF13:			       ; CODE XREF: unaligned_memcmp+359j
.text:0040FF13		       movzx   esi, byte ptr [bLHS+19h]
.text:0040FF17		       movzx   siz, byte ptr [bRHS+19h]
.text:0040FF1B		       sub     esi, siz
.text:0040FF1D		       jz      short loc_40FF32
.text:0040FF1F		       xor     siz, siz
.text:0040FF21		       test    esi, esi
.text:0040FF23		       setnle  al
.text:0040FF26		       lea     siz, [siz+siz-1]
.text:0040FF2A		       test    siz, siz
.text:0040FF2C		       jnz     loc_4103E3
.text:0040FF32
.text:0040FF32 loc_40FF32:			       ; CODE XREF: unaligned_memcmp+378j
.text:0040FF32		       movzx   esi, byte ptr [bLHS+1Ah]
.text:0040FF36		       movzx   siz, byte ptr [bRHS+1Ah]
.text:0040FF3A		       sub     esi, siz
.text:0040FF3C		       jz      short loc_40FF51
.text:0040FF3E		       xor     siz, siz
.text:0040FF40		       test    esi, esi
.text:0040FF42		       setnle  al
.text:0040FF45		       lea     siz, [siz+siz-1]
.text:0040FF49		       test    siz, siz
.text:0040FF4B		       jnz     loc_4103E3
.text:0040FF51
.text:0040FF51 loc_40FF51:			       ; CODE XREF: unaligned_memcmp+397j
.text:0040FF51		       movzx   esi, byte ptr [bLHS+1Bh]
.text:0040FF55		       movzx   siz, byte ptr [bRHS+1Bh]
.text:0040FF59		       sub     esi, siz
.text:0040FF5B		       jz      short loc_40FF6A
.text:0040FF5D		       xor     siz, siz
.text:0040FF5F		       test    esi, esi
.text:0040FF61		       setnle  al
.text:0040FF64		       lea     siz, [siz+siz-1]
.text:0040FF68		       mov     esi, siz
.text:0040FF6A
.text:0040FF6A loc_40FF6A:			       ; CODE XREF: unaligned_memcmp+3B6j
.text:0040FF6A		       mov     siz, esi
.text:0040FF6C		       jmp     short loc_40FF70
.text:0040FF6E ; ---------------------------------------------------------------------------
.text:0040FF6E
.text:0040FF6E loc_40FF6E:			       ; CODE XREF: unaligned_memcmp+34Ej
.text:0040FF6E		       xor     siz, siz
.text:0040FF70
.text:0040FF70 loc_40FF70:			       ; CODE XREF: unaligned_memcmp+3C7j
.text:0040FF70		       test    siz, siz
.text:0040FF72		       jnz     loc_4103E3
.text:0040FF78		       mov     siz, [bLHS+1Ch]
.text:0040FF7B		       cmp     siz, [bRHS+1Ch]
.text:0040FF7E		       jz      short loc_40FFF9
.text:0040FF80		       movzx   esi, al
.text:0040FF83		       movzx   siz, byte ptr [bRHS+1Ch]
.text:0040FF87		       sub     esi, siz
.text:0040FF89		       jz      short loc_40FF9E
.text:0040FF8B		       xor     siz, siz
.text:0040FF8D		       test    esi, esi
.text:0040FF8F		       setnle  al
.text:0040FF92		       lea     siz, [siz+siz-1]
.text:0040FF96		       test    siz, siz
.text:0040FF98		       jnz     loc_4103E3
.text:0040FF9E
.text:0040FF9E loc_40FF9E:			       ; CODE XREF: unaligned_memcmp+3E4j
.text:0040FF9E		       movzx   esi, byte ptr [bLHS+1Dh]
.text:0040FFA2		       movzx   siz, byte ptr [bRHS+1Dh]
.text:0040FFA6		       sub     esi, siz
.text:0040FFA8		       jz      short loc_40FFBD
.text:0040FFAA		       xor     siz, siz
.text:0040FFAC		       test    esi, esi
.text:0040FFAE		       setnle  al
.text:0040FFB1		       lea     siz, [siz+siz-1]
.text:0040FFB5		       test    siz, siz
.text:0040FFB7		       jnz     loc_4103E3
.text:0040FFBD
.text:0040FFBD loc_40FFBD:			       ; CODE XREF: unaligned_memcmp+403j
.text:0040FFBD		       movzx   esi, byte ptr [bLHS+1Eh]
.text:0040FFC1		       movzx   siz, byte ptr [bRHS+1Eh]
.text:0040FFC5		       sub     esi, siz
.text:0040FFC7		       jz      short loc_40FFDC
.text:0040FFC9		       xor     siz, siz
.text:0040FFCB		       test    esi, esi
.text:0040FFCD		       setnle  al
.text:0040FFD0		       lea     siz, [siz+siz-1]
.text:0040FFD4		       test    siz, siz
.text:0040FFD6		       jnz     loc_4103E3
.text:0040FFDC
.text:0040FFDC loc_40FFDC:			       ; CODE XREF: unaligned_memcmp+422j
.text:0040FFDC		       movzx   esi, byte ptr [bLHS+1Fh]
.text:0040FFE0		       movzx   siz, byte ptr [bRHS+1Fh]
.text:0040FFE4		       sub     esi, siz
.text:0040FFE6		       jz      short loc_40FFF5
.text:0040FFE8		       xor     siz, siz
.text:0040FFEA		       test    esi, esi
.text:0040FFEC		       setnle  al
.text:0040FFEF		       lea     siz, [siz+siz-1]
.text:0040FFF3		       mov     esi, siz
.text:0040FFF5
.text:0040FFF5 loc_40FFF5:			       ; CODE XREF: unaligned_memcmp+441j
.text:0040FFF5		       mov     siz, esi
.text:0040FFF7		       jmp     short loc_40FFFB
.text:0040FFF9 ; ---------------------------------------------------------------------------
.text:0040FFF9
.text:0040FFF9 loc_40FFF9:			       ; CODE XREF: unaligned_memcmp+3D9j
.text:0040FFF9		       xor     siz, siz
.text:0040FFFB
.text:0040FFFB loc_40FFFB:			       ; CODE XREF: unaligned_memcmp+452j
.text:0040FFFB		       test    siz, siz
.text:0040FFFD		       jnz     loc_4103E3
.text:00410003		       add     bLHS, 20h
.text:00410006		       add     bRHS, 20h
.text:00410009		       sub     edi, 20h
.text:0041000C
.text:0041000C loc_41000C:			       ; CODE XREF: unaligned_memcmp+4j
.text:0041000C		       cmp     edi, 20h
.text:0041000F		       jnb     loc_40FBAE
.text:00410015		       add     bLHS, edi
.text:00410017		       add     bRHS, edi
.text:00410019		       cmp     edi, 1Fh	       ; switch	32 cases
.text:0041001C		       ja      $LN61	       ; default
.text:0041001C					       ; jumptable 00410022 case 0
.text:00410022		       jmp     ds:off_410FB5[edi*4] ; switch jump
.text:00410029
.text:00410029 $LN60:				       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410029		       mov     siz, [bLHS-1Ch] ; jumptable 00410022 case 28
.text:0041002C		       cmp     siz, [bRHS-1Ch]
.text:0041002F		       jz      short loc_4100AB
.text:00410031		       movzx   siz, byte ptr [bRHS-1Ch]
.text:00410035		       movzx   esi, byte ptr [bLHS-1Ch]
.text:00410039		       sub     esi, siz
.text:0041003B		       jz      short loc_410050
.text:0041003D		       xor     siz, siz
.text:0041003F		       test    esi, esi
.text:00410041		       setnle  al
.text:00410044		       lea     siz, [siz+siz-1]
.text:00410048		       test    siz, siz
.text:0041004A		       jnz     loc_4103E3
.text:00410050
.text:00410050 loc_410050:			       ; CODE XREF: unaligned_memcmp+496j
.text:00410050		       movzx   esi, byte ptr [bLHS-1Bh]
.text:00410054		       movzx   siz, byte ptr [bRHS-1Bh]
.text:00410058		       sub     esi, siz
.text:0041005A		       jz      short loc_41006F
.text:0041005C		       xor     siz, siz
.text:0041005E		       test    esi, esi
.text:00410060		       setnle  al
.text:00410063		       lea     siz, [siz+siz-1]
.text:00410067		       test    siz, siz
.text:00410069		       jnz     loc_4103E3
.text:0041006F
.text:0041006F loc_41006F:			       ; CODE XREF: unaligned_memcmp+4B5j
.text:0041006F		       movzx   esi, byte ptr [bLHS-1Ah]
.text:00410073		       movzx   siz, byte ptr [bRHS-1Ah]
.text:00410077		       sub     esi, siz
.text:00410079		       jz      short loc_41008E
.text:0041007B		       xor     siz, siz
.text:0041007D		       test    esi, esi
.text:0041007F		       setnle  al
.text:00410082		       lea     siz, [siz+siz-1]
.text:00410086		       test    siz, siz
.text:00410088		       jnz     loc_4103E3
.text:0041008E
.text:0041008E loc_41008E:			       ; CODE XREF: unaligned_memcmp+4D4j
.text:0041008E		       movzx   esi, byte ptr [bLHS-19h]
.text:00410092		       movzx   siz, byte ptr [bRHS-19h]
.text:00410096		       sub     esi, siz
.text:00410098		       jz      short loc_4100A7
.text:0041009A		       xor     siz, siz
.text:0041009C		       test    esi, esi
.text:0041009E		       setnle  al
.text:004100A1		       lea     siz, [siz+siz-1]
.text:004100A5		       mov     esi, siz
.text:004100A7
.text:004100A7 loc_4100A7:			       ; CODE XREF: unaligned_memcmp+4F3j
.text:004100A7		       mov     siz, esi
.text:004100A9		       jmp     short loc_4100AD
.text:004100AB ; ---------------------------------------------------------------------------
.text:004100AB
.text:004100AB loc_4100AB:			       ; CODE XREF: unaligned_memcmp+48Aj
.text:004100AB		       xor     siz, siz
.text:004100AD
.text:004100AD loc_4100AD:			       ; CODE XREF: unaligned_memcmp+504j
.text:004100AD		       test    siz, siz
.text:004100AF		       jnz     loc_4103E3
.text:004100B5
.text:004100B5 $LN1169:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004100B5					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:004100B5		       mov     siz, [bLHS-18h] ; jumptable 00410022 case 24
.text:004100B8		       cmp     siz, [bRHS-18h]
.text:004100BB		       jz      short loc_410136
.text:004100BD		       movzx   esi, al
.text:004100C0		       movzx   siz, byte ptr [bRHS-18h]
.text:004100C4		       sub     esi, siz
.text:004100C6		       jz      short loc_4100DB
.text:004100C8		       xor     siz, siz
.text:004100CA		       test    esi, esi
.text:004100CC		       setnle  al
.text:004100CF		       lea     siz, [siz+siz-1]
.text:004100D3		       test    siz, siz
.text:004100D5		       jnz     loc_4103E3
.text:004100DB
.text:004100DB loc_4100DB:			       ; CODE XREF: unaligned_memcmp+521j
.text:004100DB		       movzx   esi, byte ptr [bLHS-17h]
.text:004100DF		       movzx   siz, byte ptr [bRHS-17h]
.text:004100E3		       sub     esi, siz
.text:004100E5		       jz      short loc_4100FA
.text:004100E7		       xor     siz, siz
.text:004100E9		       test    esi, esi
.text:004100EB		       setnle  al
.text:004100EE		       lea     siz, [siz+siz-1]
.text:004100F2		       test    siz, siz
.text:004100F4		       jnz     loc_4103E3
.text:004100FA
.text:004100FA loc_4100FA:			       ; CODE XREF: unaligned_memcmp+540j
.text:004100FA		       movzx   esi, byte ptr [bLHS-16h]
.text:004100FE		       movzx   siz, byte ptr [bRHS-16h]
.text:00410102		       sub     esi, siz
.text:00410104		       jz      short loc_410119
.text:00410106		       xor     siz, siz
.text:00410108		       test    esi, esi
.text:0041010A		       setnle  al
.text:0041010D		       lea     siz, [siz+siz-1]
.text:00410111		       test    siz, siz
.text:00410113		       jnz     loc_4103E3
.text:00410119
.text:00410119 loc_410119:			       ; CODE XREF: unaligned_memcmp+55Fj
.text:00410119		       movzx   esi, byte ptr [bLHS-15h]
.text:0041011D		       movzx   siz, byte ptr [bRHS-15h]
.text:00410121		       sub     esi, siz
.text:00410123		       jz      short loc_410132
.text:00410125		       xor     siz, siz
.text:00410127		       test    esi, esi
.text:00410129		       setnle  al
.text:0041012C		       lea     siz, [siz+siz-1]
.text:00410130		       mov     esi, siz
.text:00410132
.text:00410132 loc_410132:			       ; CODE XREF: unaligned_memcmp+57Ej
.text:00410132		       mov     siz, esi
.text:00410134		       jmp     short loc_410138
.text:00410136 ; ---------------------------------------------------------------------------
.text:00410136
.text:00410136 loc_410136:			       ; CODE XREF: unaligned_memcmp+516j
.text:00410136		       xor     siz, siz
.text:00410138
.text:00410138 loc_410138:			       ; CODE XREF: unaligned_memcmp+58Fj
.text:00410138		       test    siz, siz
.text:0041013A		       jnz     loc_4103E3
.text:00410140
.text:00410140 $LN1170:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410140					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410140		       mov     siz, [bLHS-14h] ; jumptable 00410022 case 20
.text:00410143		       cmp     siz, [bRHS-14h]
.text:00410146		       jz      short loc_4101C1
.text:00410148		       movzx   esi, al
.text:0041014B		       movzx   siz, byte ptr [bRHS-14h]
.text:0041014F		       sub     esi, siz
.text:00410151		       jz      short loc_410166
.text:00410153		       xor     siz, siz
.text:00410155		       test    esi, esi
.text:00410157		       setnle  al
.text:0041015A		       lea     siz, [siz+siz-1]
.text:0041015E		       test    siz, siz
.text:00410160		       jnz     loc_4103E3
.text:00410166
.text:00410166 loc_410166:			       ; CODE XREF: unaligned_memcmp+5ACj
.text:00410166		       movzx   esi, byte ptr [bLHS-13h]
.text:0041016A		       movzx   siz, byte ptr [bRHS-13h]
.text:0041016E		       sub     esi, siz
.text:00410170		       jz      short loc_410185
.text:00410172		       xor     siz, siz
.text:00410174		       test    esi, esi
.text:00410176		       setnle  al
.text:00410179		       lea     siz, [siz+siz-1]
.text:0041017D		       test    siz, siz
.text:0041017F		       jnz     loc_4103E3
.text:00410185
.text:00410185 loc_410185:			       ; CODE XREF: unaligned_memcmp+5CBj
.text:00410185		       movzx   esi, byte ptr [bLHS-12h]
.text:00410189		       movzx   siz, byte ptr [bRHS-12h]
.text:0041018D		       sub     esi, siz
.text:0041018F		       jz      short loc_4101A4
.text:00410191		       xor     siz, siz
.text:00410193		       test    esi, esi
.text:00410195		       setnle  al
.text:00410198		       lea     siz, [siz+siz-1]
.text:0041019C		       test    siz, siz
.text:0041019E		       jnz     loc_4103E3
.text:004101A4
.text:004101A4 loc_4101A4:			       ; CODE XREF: unaligned_memcmp+5EAj
.text:004101A4		       movzx   esi, byte ptr [bLHS-11h]
.text:004101A8		       movzx   siz, byte ptr [bRHS-11h]
.text:004101AC		       sub     esi, siz
.text:004101AE		       jz      short loc_4101BD
.text:004101B0		       xor     siz, siz
.text:004101B2		       test    esi, esi
.text:004101B4		       setnle  al
.text:004101B7		       lea     siz, [siz+siz-1]
.text:004101BB		       mov     esi, siz
.text:004101BD
.text:004101BD loc_4101BD:			       ; CODE XREF: unaligned_memcmp+609j
.text:004101BD		       mov     siz, esi
.text:004101BF		       jmp     short loc_4101C3
.text:004101C1 ; ---------------------------------------------------------------------------
.text:004101C1
.text:004101C1 loc_4101C1:			       ; CODE XREF: unaligned_memcmp+5A1j
.text:004101C1		       xor     siz, siz
.text:004101C3
.text:004101C3 loc_4101C3:			       ; CODE XREF: unaligned_memcmp+61Aj
.text:004101C3		       test    siz, siz
.text:004101C5		       jnz     loc_4103E3
.text:004101CB
.text:004101CB $LN1171:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004101CB					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:004101CB		       mov     siz, [bLHS-10h] ; jumptable 00410022 case 16
.text:004101CE		       cmp     siz, [bRHS-10h]
.text:004101D1		       jz      short loc_41024C
.text:004101D3		       movzx   esi, al
.text:004101D6		       movzx   siz, byte ptr [bRHS-10h]
.text:004101DA		       sub     esi, siz
.text:004101DC		       jz      short loc_4101F1
.text:004101DE		       xor     siz, siz
.text:004101E0		       test    esi, esi
.text:004101E2		       setnle  al
.text:004101E5		       lea     siz, [siz+siz-1]
.text:004101E9		       test    siz, siz
.text:004101EB		       jnz     loc_4103E3
.text:004101F1
.text:004101F1 loc_4101F1:			       ; CODE XREF: unaligned_memcmp+637j
.text:004101F1		       movzx   esi, byte ptr [bLHS-0Fh]
.text:004101F5		       movzx   siz, byte ptr [bRHS-0Fh]
.text:004101F9		       sub     esi, siz
.text:004101FB		       jz      short loc_410210
.text:004101FD		       xor     siz, siz
.text:004101FF		       test    esi, esi
.text:00410201		       setnle  al
.text:00410204		       lea     siz, [siz+siz-1]
.text:00410208		       test    siz, siz
.text:0041020A		       jnz     loc_4103E3
.text:00410210
.text:00410210 loc_410210:			       ; CODE XREF: unaligned_memcmp+656j
.text:00410210		       movzx   esi, byte ptr [bLHS-0Eh]
.text:00410214		       movzx   siz, byte ptr [bRHS-0Eh]
.text:00410218		       sub     esi, siz
.text:0041021A		       jz      short loc_41022F
.text:0041021C		       xor     siz, siz
.text:0041021E		       test    esi, esi
.text:00410220		       setnle  al
.text:00410223		       lea     siz, [siz+siz-1]
.text:00410227		       test    siz, siz
.text:00410229		       jnz     loc_4103E3
.text:0041022F
.text:0041022F loc_41022F:			       ; CODE XREF: unaligned_memcmp+675j
.text:0041022F		       movzx   esi, byte ptr [bLHS-0Dh]
.text:00410233		       movzx   siz, byte ptr [bRHS-0Dh]
.text:00410237		       sub     esi, siz
.text:00410239		       jz      short loc_410248
.text:0041023B		       xor     siz, siz
.text:0041023D		       test    esi, esi
.text:0041023F		       setnle  al
.text:00410242		       lea     siz, [siz+siz-1]
.text:00410246		       mov     esi, siz
.text:00410248
.text:00410248 loc_410248:			       ; CODE XREF: unaligned_memcmp+694j
.text:00410248		       mov     siz, esi
.text:0041024A		       jmp     short loc_41024E
.text:0041024C ; ---------------------------------------------------------------------------
.text:0041024C
.text:0041024C loc_41024C:			       ; CODE XREF: unaligned_memcmp+62Cj
.text:0041024C		       xor     siz, siz
.text:0041024E
.text:0041024E loc_41024E:			       ; CODE XREF: unaligned_memcmp+6A5j
.text:0041024E		       test    siz, siz
.text:00410250		       jnz     loc_4103E3
.text:00410256
.text:00410256 $LN1172:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410256					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410256		       mov     siz, [bLHS-0Ch] ; jumptable 00410022 case 12
.text:00410259		       cmp     siz, [bRHS-0Ch]
.text:0041025C		       jz      short loc_4102D7
.text:0041025E		       movzx   esi, al
.text:00410261		       movzx   siz, byte ptr [bRHS-0Ch]
.text:00410265		       sub     esi, siz
.text:00410267		       jz      short loc_41027C
.text:00410269		       xor     siz, siz
.text:0041026B		       test    esi, esi
.text:0041026D		       setnle  al
.text:00410270		       lea     siz, [siz+siz-1]
.text:00410274		       test    siz, siz
.text:00410276		       jnz     loc_4103E3
.text:0041027C
.text:0041027C loc_41027C:			       ; CODE XREF: unaligned_memcmp+6C2j
.text:0041027C		       movzx   esi, byte ptr [bLHS-0Bh]
.text:00410280		       movzx   siz, byte ptr [bRHS-0Bh]
.text:00410284		       sub     esi, siz
.text:00410286		       jz      short loc_41029B
.text:00410288		       xor     siz, siz
.text:0041028A		       test    esi, esi
.text:0041028C		       setnle  al
.text:0041028F		       lea     siz, [siz+siz-1]
.text:00410293		       test    siz, siz
.text:00410295		       jnz     loc_4103E3
.text:0041029B
.text:0041029B loc_41029B:			       ; CODE XREF: unaligned_memcmp+6E1j
.text:0041029B		       movzx   esi, byte ptr [bLHS-0Ah]
.text:0041029F		       movzx   siz, byte ptr [bRHS-0Ah]
.text:004102A3		       sub     esi, siz
.text:004102A5		       jz      short loc_4102BA
.text:004102A7		       xor     siz, siz
.text:004102A9		       test    esi, esi
.text:004102AB		       setnle  al
.text:004102AE		       lea     siz, [siz+siz-1]
.text:004102B2		       test    siz, siz
.text:004102B4		       jnz     loc_4103E3
.text:004102BA
.text:004102BA loc_4102BA:			       ; CODE XREF: unaligned_memcmp+700j
.text:004102BA		       movzx   esi, byte ptr [bLHS-9]
.text:004102BE		       movzx   siz, byte ptr [bRHS-9]
.text:004102C2		       sub     esi, siz
.text:004102C4		       jz      short loc_4102D3
.text:004102C6		       xor     siz, siz
.text:004102C8		       test    esi, esi
.text:004102CA		       setnle  al
.text:004102CD		       lea     siz, [siz+siz-1]
.text:004102D1		       mov     esi, siz
.text:004102D3
.text:004102D3 loc_4102D3:			       ; CODE XREF: unaligned_memcmp+71Fj
.text:004102D3		       mov     siz, esi
.text:004102D5		       jmp     short loc_4102D9
.text:004102D7 ; ---------------------------------------------------------------------------
.text:004102D7
.text:004102D7 loc_4102D7:			       ; CODE XREF: unaligned_memcmp+6B7j
.text:004102D7		       xor     siz, siz
.text:004102D9
.text:004102D9 loc_4102D9:			       ; CODE XREF: unaligned_memcmp+730j
.text:004102D9		       test    siz, siz
.text:004102DB		       jnz     loc_4103E3
.text:004102E1
.text:004102E1 $LN1173:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004102E1					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:004102E1		       mov     siz, [bLHS-8]   ; jumptable 00410022 case 8
.text:004102E4		       cmp     siz, [bRHS-8]
.text:004102E7		       jz      short loc_410362
.text:004102E9		       movzx   esi, al
.text:004102EC		       movzx   siz, byte ptr [bRHS-8]
.text:004102F0		       sub     esi, siz
.text:004102F2		       jz      short loc_410307
.text:004102F4		       xor     siz, siz
.text:004102F6		       test    esi, esi
.text:004102F8		       setnle  al
.text:004102FB		       lea     siz, [siz+siz-1]
.text:004102FF		       test    siz, siz
.text:00410301		       jnz     loc_4103E3
.text:00410307
.text:00410307 loc_410307:			       ; CODE XREF: unaligned_memcmp+74Dj
.text:00410307		       movzx   esi, byte ptr [bLHS-7]
.text:0041030B		       movzx   siz, byte ptr [bRHS-7]
.text:0041030F		       sub     esi, siz
.text:00410311		       jz      short loc_410326
.text:00410313		       xor     siz, siz
.text:00410315		       test    esi, esi
.text:00410317		       setnle  al
.text:0041031A		       lea     siz, [siz+siz-1]
.text:0041031E		       test    siz, siz
.text:00410320		       jnz     loc_4103E3
.text:00410326
.text:00410326 loc_410326:			       ; CODE XREF: unaligned_memcmp+76Cj
.text:00410326		       movzx   esi, byte ptr [bLHS-6]
.text:0041032A		       movzx   siz, byte ptr [bRHS-6]
.text:0041032E		       sub     esi, siz
.text:00410330		       jz      short loc_410345
.text:00410332		       xor     siz, siz
.text:00410334		       test    esi, esi
.text:00410336		       setnle  al
.text:00410339		       lea     siz, [siz+siz-1]
.text:0041033D		       test    siz, siz
.text:0041033F		       jnz     loc_4103E3
.text:00410345
.text:00410345 loc_410345:			       ; CODE XREF: unaligned_memcmp+78Bj
.text:00410345		       movzx   esi, byte ptr [bLHS-5]
.text:00410349		       movzx   siz, byte ptr [bRHS-5]
.text:0041034D		       sub     esi, siz
.text:0041034F		       jz      short loc_41035E
.text:00410351		       xor     siz, siz
.text:00410353		       test    esi, esi
.text:00410355		       setnle  al
.text:00410358		       lea     siz, [siz+siz-1]
.text:0041035C		       mov     esi, siz
.text:0041035E
.text:0041035E loc_41035E:			       ; CODE XREF: unaligned_memcmp+7AAj
.text:0041035E		       mov     siz, esi
.text:00410360		       jmp     short loc_410364
.text:00410362 ; ---------------------------------------------------------------------------
.text:00410362
.text:00410362 loc_410362:			       ; CODE XREF: unaligned_memcmp+742j
.text:00410362		       xor     siz, siz
.text:00410364
.text:00410364 loc_410364:			       ; CODE XREF: unaligned_memcmp+7BBj
.text:00410364		       test    siz, siz
.text:00410366		       jnz     short loc_4103E3
.text:00410368
.text:00410368 $LN1174:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410368					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410368		       mov     siz, [bLHS-4]   ; jumptable 00410022 case 4
.text:0041036B		       cmp     siz, [bRHS-4]
.text:0041036E		       jz      short loc_4103DB
.text:00410370		       movzx   esi, al
.text:00410373		       movzx   siz, byte ptr [bRHS-4]
.text:00410377		       sub     esi, siz
.text:00410379		       jz      short loc_41038A
.text:0041037B		       xor     siz, siz
.text:0041037D		       test    esi, esi
.text:0041037F		       setnle  al
.text:00410382		       lea     siz, [siz+siz-1]
.text:00410386		       test    siz, siz
.text:00410388		       jnz     short loc_4103E3
.text:0041038A
.text:0041038A loc_41038A:			       ; CODE XREF: unaligned_memcmp+7D4j
.text:0041038A		       movzx   esi, byte ptr [bLHS-3]
.text:0041038E		       movzx   siz, byte ptr [bRHS-3]
.text:00410392		       sub     esi, siz
.text:00410394		       jz      short loc_4103A5
.text:00410396		       xor     siz, siz
.text:00410398		       test    esi, esi
.text:0041039A		       setnle  al
.text:0041039D		       lea     siz, [siz+siz-1]
.text:004103A1		       test    siz, siz
.text:004103A3		       jnz     short loc_4103E3
.text:004103A5
.text:004103A5 loc_4103A5:			       ; CODE XREF: unaligned_memcmp+7EFj
.text:004103A5		       movzx   esi, byte ptr [bLHS-2]
.text:004103A9		       movzx   siz, byte ptr [bRHS-2]
.text:004103AD		       sub     esi, siz
.text:004103AF		       jz      short loc_4103C0
.text:004103B1		       xor     siz, siz
.text:004103B3		       test    esi, esi
.text:004103B5		       setnle  al
.text:004103B8		       lea     siz, [siz+siz-1]
.text:004103BC		       test    siz, siz
.text:004103BE		       jnz     short loc_4103E3
.text:004103C0
.text:004103C0 loc_4103C0:			       ; CODE XREF: unaligned_memcmp+80Aj
.text:004103C0		       movzx   siz, byte ptr [bLHS-1]
.text:004103C4		       movzx   bLHS, byte ptr [bRHS-1]
.text:004103C8		       sub     siz, bLHS
.text:004103CA		       jz      short loc_4103DD
.text:004103CC		       xor     bLHS, bLHS
.text:004103CE		       test    siz, siz
.text:004103D0		       setnle  cl
.text:004103D3		       lea     bLHS, [bLHS+bLHS-1]
.text:004103D7		       mov     siz, bLHS
.text:004103D9		       jmp     short loc_4103DD
.text:004103DB ; ---------------------------------------------------------------------------
.text:004103DB
.text:004103DB loc_4103DB:			       ; CODE XREF: unaligned_memcmp+7C9j
.text:004103DB		       xor     siz, siz
.text:004103DD
.text:004103DD loc_4103DD:			       ; CODE XREF: unaligned_memcmp+825j
.text:004103DD					       ; unaligned_memcmp+834j
.text:004103DD		       test    siz, siz
.text:004103DF		       jnz     short loc_4103E3
.text:004103E1
.text:004103E1 $LN61:				       ; CODE XREF: unaligned_memcmp+477j
.text:004103E1					       ; unaligned_memcmp+47Dj	...
.text:004103E1		       xor     siz, siz	       ; default
.text:004103E1					       ; jumptable 00410022 case 0
.text:004103E3
.text:004103E3 loc_4103E3:			       ; CODE XREF: unaligned_memcmp+26j
.text:004103E3					       ; unaligned_memcmp+45j ...
.text:004103E3		       pop     edi
.text:004103E4		       pop     esi
.text:004103E5		       retn
.text:004103E6 ; ---------------------------------------------------------------------------
.text:004103E6
.text:004103E6 $LN45:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004103E6					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:004103E6		       mov     siz, [bLHS-1Dh] ; jumptable 00410022 case 29
.text:004103E9		       cmp     siz, [bRHS-1Dh]
.text:004103EC		       jz      short loc_41045B
.text:004103EE		       movzx   esi, al
.text:004103F1		       movzx   siz, byte ptr [bRHS-1Dh]
.text:004103F5		       sub     esi, siz
.text:004103F7		       jz      short loc_410408
.text:004103F9		       xor     siz, siz
.text:004103FB		       test    esi, esi
.text:004103FD		       setnle  al
.text:00410400		       lea     siz, [siz+siz-1]
.text:00410404		       test    siz, siz
.text:00410406		       jnz     short loc_4103E3
.text:00410408
.text:00410408 loc_410408:			       ; CODE XREF: unaligned_memcmp+852j
.text:00410408		       movzx   esi, byte ptr [bLHS-1Ch]
.text:0041040C		       movzx   siz, byte ptr [bRHS-1Ch]
.text:00410410		       sub     esi, siz
.text:00410412		       jz      short loc_410423
.text:00410414		       xor     siz, siz
.text:00410416		       test    esi, esi
.text:00410418		       setnle  al
.text:0041041B		       lea     siz, [siz+siz-1]
.text:0041041F		       test    siz, siz
.text:00410421		       jnz     short loc_4103E3
.text:00410423
.text:00410423 loc_410423:			       ; CODE XREF: unaligned_memcmp+86Dj
.text:00410423		       movzx   esi, byte ptr [bLHS-1Bh]
.text:00410427		       movzx   siz, byte ptr [bRHS-1Bh]
.text:0041042B		       sub     esi, siz
.text:0041042D		       jz      short loc_41043E
.text:0041042F		       xor     siz, siz
.text:00410431		       test    esi, esi
.text:00410433		       setnle  al
.text:00410436		       lea     siz, [siz+siz-1]
.text:0041043A		       test    siz, siz
.text:0041043C		       jnz     short loc_4103E3
.text:0041043E
.text:0041043E loc_41043E:			       ; CODE XREF: unaligned_memcmp+888j
.text:0041043E		       movzx   esi, byte ptr [bLHS-1Ah]
.text:00410442		       movzx   siz, byte ptr [bRHS-1Ah]
.text:00410446		       sub     esi, siz
.text:00410448		       jz      short loc_410457
.text:0041044A		       xor     siz, siz
.text:0041044C		       test    esi, esi
.text:0041044E		       setnle  al
.text:00410451		       lea     siz, [siz+siz-1]
.text:00410455		       mov     esi, siz
.text:00410457
.text:00410457 loc_410457:			       ; CODE XREF: unaligned_memcmp+8A3j
.text:00410457		       mov     siz, esi
.text:00410459		       jmp     short loc_41045D
.text:0041045B ; ---------------------------------------------------------------------------
.text:0041045B
.text:0041045B loc_41045B:			       ; CODE XREF: unaligned_memcmp+847j
.text:0041045B		       xor     siz, siz
.text:0041045D
.text:0041045D loc_41045D:			       ; CODE XREF: unaligned_memcmp+8B4j
.text:0041045D		       test    siz, siz
.text:0041045F		       jnz     short loc_4103E3
.text:00410461
.text:00410461 $LN1176:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410461					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410461		       mov     siz, [bLHS-19h] ; jumptable 00410022 case 25
.text:00410464		       cmp     siz, [bRHS-19h]
.text:00410467		       jz      short loc_4104E3
.text:00410469		       movzx   siz, byte ptr [bRHS-19h]
.text:0041046D		       movzx   esi, byte ptr [bLHS-19h]
.text:00410471		       sub     esi, siz
.text:00410473		       jz      short loc_410488
.text:00410475		       xor     siz, siz
.text:00410477		       test    esi, esi
.text:00410479		       setnle  al
.text:0041047C		       lea     siz, [siz+siz-1]
.text:00410480		       test    siz, siz
.text:00410482		       jnz     loc_4103E3
.text:00410488
.text:00410488 loc_410488:			       ; CODE XREF: unaligned_memcmp+8CEj
.text:00410488		       movzx   esi, byte ptr [bLHS-18h]
.text:0041048C		       movzx   siz, byte ptr [bRHS-18h]
.text:00410490		       sub     esi, siz
.text:00410492		       jz      short loc_4104A7
.text:00410494		       xor     siz, siz
.text:00410496		       test    esi, esi
.text:00410498		       setnle  al
.text:0041049B		       lea     siz, [siz+siz-1]
.text:0041049F		       test    siz, siz
.text:004104A1		       jnz     loc_4103E3
.text:004104A7
.text:004104A7 loc_4104A7:			       ; CODE XREF: unaligned_memcmp+8EDj
.text:004104A7		       movzx   esi, byte ptr [bLHS-17h]
.text:004104AB		       movzx   siz, byte ptr [bRHS-17h]
.text:004104AF		       sub     esi, siz
.text:004104B1		       jz      short loc_4104C6
.text:004104B3		       xor     siz, siz
.text:004104B5		       test    esi, esi
.text:004104B7		       setnle  al
.text:004104BA		       lea     siz, [siz+siz-1]
.text:004104BE		       test    siz, siz
.text:004104C0		       jnz     loc_4103E3
.text:004104C6
.text:004104C6 loc_4104C6:			       ; CODE XREF: unaligned_memcmp+90Cj
.text:004104C6		       movzx   esi, byte ptr [bLHS-16h]
.text:004104CA		       movzx   siz, byte ptr [bRHS-16h]
.text:004104CE		       sub     esi, siz
.text:004104D0		       jz      short loc_4104DF
.text:004104D2		       xor     siz, siz
.text:004104D4		       test    esi, esi
.text:004104D6		       setnle  al
.text:004104D9		       lea     siz, [siz+siz-1]
.text:004104DD		       mov     esi, siz
.text:004104DF
.text:004104DF loc_4104DF:			       ; CODE XREF: unaligned_memcmp+92Bj
.text:004104DF		       mov     siz, esi
.text:004104E1		       jmp     short loc_4104E5
.text:004104E3 ; ---------------------------------------------------------------------------
.text:004104E3
.text:004104E3 loc_4104E3:			       ; CODE XREF: unaligned_memcmp+8C2j
.text:004104E3		       xor     siz, siz
.text:004104E5
.text:004104E5 loc_4104E5:			       ; CODE XREF: unaligned_memcmp+93Cj
.text:004104E5		       test    siz, siz
.text:004104E7		       jnz     loc_4103E3
.text:004104ED
.text:004104ED $LN1177:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004104ED					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:004104ED		       mov     siz, [bLHS-15h] ; jumptable 00410022 case 21
.text:004104F0		       cmp     siz, [bRHS-15h]
.text:004104F3		       jz      short loc_41056E
.text:004104F5		       movzx   esi, al
.text:004104F8		       movzx   siz, byte ptr [bRHS-15h]
.text:004104FC		       sub     esi, siz
.text:004104FE		       jz      short loc_410513
.text:00410500		       xor     siz, siz
.text:00410502		       test    esi, esi
.text:00410504		       setnle  al
.text:00410507		       lea     siz, [siz+siz-1]
.text:0041050B		       test    siz, siz
.text:0041050D		       jnz     loc_4103E3
.text:00410513
.text:00410513 loc_410513:			       ; CODE XREF: unaligned_memcmp+959j
.text:00410513		       movzx   esi, byte ptr [bLHS-14h]
.text:00410517		       movzx   siz, byte ptr [bRHS-14h]
.text:0041051B		       sub     esi, siz
.text:0041051D		       jz      short loc_410532
.text:0041051F		       xor     siz, siz
.text:00410521		       test    esi, esi
.text:00410523		       setnle  al
.text:00410526		       lea     siz, [siz+siz-1]
.text:0041052A		       test    siz, siz
.text:0041052C		       jnz     loc_4103E3
.text:00410532
.text:00410532 loc_410532:			       ; CODE XREF: unaligned_memcmp+978j
.text:00410532		       movzx   esi, byte ptr [bLHS-13h]
.text:00410536		       movzx   siz, byte ptr [bRHS-13h]
.text:0041053A		       sub     esi, siz
.text:0041053C		       jz      short loc_410551
.text:0041053E		       xor     siz, siz
.text:00410540		       test    esi, esi
.text:00410542		       setnle  al
.text:00410545		       lea     siz, [siz+siz-1]
.text:00410549		       test    siz, siz
.text:0041054B		       jnz     loc_4103E3
.text:00410551
.text:00410551 loc_410551:			       ; CODE XREF: unaligned_memcmp+997j
.text:00410551		       movzx   esi, byte ptr [bLHS-12h]
.text:00410555		       movzx   siz, byte ptr [bRHS-12h]
.text:00410559		       sub     esi, siz
.text:0041055B		       jz      short loc_41056A
.text:0041055D		       xor     siz, siz
.text:0041055F		       test    esi, esi
.text:00410561		       setnle  al
.text:00410564		       lea     siz, [siz+siz-1]
.text:00410568		       mov     esi, siz
.text:0041056A
.text:0041056A loc_41056A:			       ; CODE XREF: unaligned_memcmp+9B6j
.text:0041056A		       mov     siz, esi
.text:0041056C		       jmp     short loc_410570
.text:0041056E ; ---------------------------------------------------------------------------
.text:0041056E
.text:0041056E loc_41056E:			       ; CODE XREF: unaligned_memcmp+94Ej
.text:0041056E		       xor     siz, siz
.text:00410570
.text:00410570 loc_410570:			       ; CODE XREF: unaligned_memcmp+9C7j
.text:00410570		       test    siz, siz
.text:00410572		       jnz     loc_4103E3
.text:00410578
.text:00410578 $LN1178:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410578					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410578		       mov     siz, [bLHS-11h] ; jumptable 00410022 case 17
.text:0041057B		       cmp     siz, [bRHS-11h]
.text:0041057E		       jz      short loc_4105F9
.text:00410580		       movzx   esi, al
.text:00410583		       movzx   siz, byte ptr [bRHS-11h]
.text:00410587		       sub     esi, siz
.text:00410589		       jz      short loc_41059E
.text:0041058B		       xor     siz, siz
.text:0041058D		       test    esi, esi
.text:0041058F		       setnle  al
.text:00410592		       lea     siz, [siz+siz-1]
.text:00410596		       test    siz, siz
.text:00410598		       jnz     loc_4103E3
.text:0041059E
.text:0041059E loc_41059E:			       ; CODE XREF: unaligned_memcmp+9E4j
.text:0041059E		       movzx   esi, byte ptr [bLHS-10h]
.text:004105A2		       movzx   siz, byte ptr [bRHS-10h]
.text:004105A6		       sub     esi, siz
.text:004105A8		       jz      short loc_4105BD
.text:004105AA		       xor     siz, siz
.text:004105AC		       test    esi, esi
.text:004105AE		       setnle  al
.text:004105B1		       lea     siz, [siz+siz-1]
.text:004105B5		       test    siz, siz
.text:004105B7		       jnz     loc_4103E3
.text:004105BD
.text:004105BD loc_4105BD:			       ; CODE XREF: unaligned_memcmp+A03j
.text:004105BD		       movzx   esi, byte ptr [bLHS-0Fh]
.text:004105C1		       movzx   siz, byte ptr [bRHS-0Fh]
.text:004105C5		       sub     esi, siz
.text:004105C7		       jz      short loc_4105DC
.text:004105C9		       xor     siz, siz
.text:004105CB		       test    esi, esi
.text:004105CD		       setnle  al
.text:004105D0		       lea     siz, [siz+siz-1]
.text:004105D4		       test    siz, siz
.text:004105D6		       jnz     loc_4103E3
.text:004105DC
.text:004105DC loc_4105DC:			       ; CODE XREF: unaligned_memcmp+A22j
.text:004105DC		       movzx   esi, byte ptr [bLHS-0Eh]
.text:004105E0		       movzx   siz, byte ptr [bRHS-0Eh]
.text:004105E4		       sub     esi, siz
.text:004105E6		       jz      short loc_4105F5
.text:004105E8		       xor     siz, siz
.text:004105EA		       test    esi, esi
.text:004105EC		       setnle  al
.text:004105EF		       lea     siz, [siz+siz-1]
.text:004105F3		       mov     esi, siz
.text:004105F5
.text:004105F5 loc_4105F5:			       ; CODE XREF: unaligned_memcmp+A41j
.text:004105F5		       mov     siz, esi
.text:004105F7		       jmp     short loc_4105FB
.text:004105F9 ; ---------------------------------------------------------------------------
.text:004105F9
.text:004105F9 loc_4105F9:			       ; CODE XREF: unaligned_memcmp+9D9j
.text:004105F9		       xor     siz, siz
.text:004105FB
.text:004105FB loc_4105FB:			       ; CODE XREF: unaligned_memcmp+A52j
.text:004105FB		       test    siz, siz
.text:004105FD		       jnz     loc_4103E3
.text:00410603
.text:00410603 $LN1179:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410603					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410603		       mov     siz, [bLHS-0Dh] ; jumptable 00410022 case 13
.text:00410606		       cmp     siz, [bRHS-0Dh]
.text:00410609		       jz      short loc_410684
.text:0041060B		       movzx   esi, al
.text:0041060E		       movzx   siz, byte ptr [bRHS-0Dh]
.text:00410612		       sub     esi, siz
.text:00410614		       jz      short loc_410629
.text:00410616		       xor     siz, siz
.text:00410618		       test    esi, esi
.text:0041061A		       setnle  al
.text:0041061D		       lea     siz, [siz+siz-1]
.text:00410621		       test    siz, siz
.text:00410623		       jnz     loc_4103E3
.text:00410629
.text:00410629 loc_410629:			       ; CODE XREF: unaligned_memcmp+A6Fj
.text:00410629		       movzx   esi, byte ptr [bLHS-0Ch]
.text:0041062D		       movzx   siz, byte ptr [bRHS-0Ch]
.text:00410631		       sub     esi, siz
.text:00410633		       jz      short loc_410648
.text:00410635		       xor     siz, siz
.text:00410637		       test    esi, esi
.text:00410639		       setnle  al
.text:0041063C		       lea     siz, [siz+siz-1]
.text:00410640		       test    siz, siz
.text:00410642		       jnz     loc_4103E3
.text:00410648
.text:00410648 loc_410648:			       ; CODE XREF: unaligned_memcmp+A8Ej
.text:00410648		       movzx   esi, byte ptr [bLHS-0Bh]
.text:0041064C		       movzx   siz, byte ptr [bRHS-0Bh]
.text:00410650		       sub     esi, siz
.text:00410652		       jz      short loc_410667
.text:00410654		       xor     siz, siz
.text:00410656		       test    esi, esi
.text:00410658		       setnle  al
.text:0041065B		       lea     siz, [siz+siz-1]
.text:0041065F		       test    siz, siz
.text:00410661		       jnz     loc_4103E3
.text:00410667
.text:00410667 loc_410667:			       ; CODE XREF: unaligned_memcmp+AADj
.text:00410667		       movzx   esi, byte ptr [bLHS-0Ah]
.text:0041066B		       movzx   siz, byte ptr [bRHS-0Ah]
.text:0041066F		       sub     esi, siz
.text:00410671		       jz      short loc_410680
.text:00410673		       xor     siz, siz
.text:00410675		       test    esi, esi
.text:00410677		       setnle  al
.text:0041067A		       lea     siz, [siz+siz-1]
.text:0041067E		       mov     esi, siz
.text:00410680
.text:00410680 loc_410680:			       ; CODE XREF: unaligned_memcmp+ACCj
.text:00410680		       mov     siz, esi
.text:00410682		       jmp     short loc_410686
.text:00410684 ; ---------------------------------------------------------------------------
.text:00410684
.text:00410684 loc_410684:			       ; CODE XREF: unaligned_memcmp+A64j
.text:00410684		       xor     siz, siz
.text:00410686
.text:00410686 loc_410686:			       ; CODE XREF: unaligned_memcmp+ADDj
.text:00410686		       test    siz, siz
.text:00410688		       jnz     loc_4103E3
.text:0041068E
.text:0041068E $LN1180:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:0041068E					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:0041068E		       mov     siz, [bLHS-9]   ; jumptable 00410022 case 9
.text:00410691		       cmp     siz, [bRHS-9]
.text:00410694		       jz      short loc_41070F
.text:00410696		       movzx   esi, al
.text:00410699		       movzx   siz, byte ptr [bRHS-9]
.text:0041069D		       sub     esi, siz
.text:0041069F		       jz      short loc_4106B4
.text:004106A1		       xor     siz, siz
.text:004106A3		       test    esi, esi
.text:004106A5		       setnle  al
.text:004106A8		       lea     siz, [siz+siz-1]
.text:004106AC		       test    siz, siz
.text:004106AE		       jnz     loc_4103E3
.text:004106B4
.text:004106B4 loc_4106B4:			       ; CODE XREF: unaligned_memcmp+AFAj
.text:004106B4		       movzx   esi, byte ptr [bLHS-8]
.text:004106B8		       movzx   siz, byte ptr [bRHS-8]
.text:004106BC		       sub     esi, siz
.text:004106BE		       jz      short loc_4106D3
.text:004106C0		       xor     siz, siz
.text:004106C2		       test    esi, esi
.text:004106C4		       setnle  al
.text:004106C7		       lea     siz, [siz+siz-1]
.text:004106CB		       test    siz, siz
.text:004106CD		       jnz     loc_4103E3
.text:004106D3
.text:004106D3 loc_4106D3:			       ; CODE XREF: unaligned_memcmp+B19j
.text:004106D3		       movzx   esi, byte ptr [bLHS-7]
.text:004106D7		       movzx   siz, byte ptr [bRHS-7]
.text:004106DB		       sub     esi, siz
.text:004106DD		       jz      short loc_4106F2
.text:004106DF		       xor     siz, siz
.text:004106E1		       test    esi, esi
.text:004106E3		       setnle  al
.text:004106E6		       lea     siz, [siz+siz-1]
.text:004106EA		       test    siz, siz
.text:004106EC		       jnz     loc_4103E3
.text:004106F2
.text:004106F2 loc_4106F2:			       ; CODE XREF: unaligned_memcmp+B38j
.text:004106F2		       movzx   esi, byte ptr [bLHS-6]
.text:004106F6		       movzx   siz, byte ptr [bRHS-6]
.text:004106FA		       sub     esi, siz
.text:004106FC		       jz      short loc_41070B
.text:004106FE		       xor     siz, siz
.text:00410700		       test    esi, esi
.text:00410702		       setnle  al
.text:00410705		       lea     siz, [siz+siz-1]
.text:00410709		       mov     esi, siz
.text:0041070B
.text:0041070B loc_41070B:			       ; CODE XREF: unaligned_memcmp+B57j
.text:0041070B		       mov     siz, esi
.text:0041070D		       jmp     short loc_410711
.text:0041070F ; ---------------------------------------------------------------------------
.text:0041070F
.text:0041070F loc_41070F:			       ; CODE XREF: unaligned_memcmp+AEFj
.text:0041070F		       xor     siz, siz
.text:00410711
.text:00410711 loc_410711:			       ; CODE XREF: unaligned_memcmp+B68j
.text:00410711		       test    siz, siz
.text:00410713		       jnz     loc_4103E3
.text:00410719
.text:00410719 $LN1181:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410719					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410719		       mov     siz, [bLHS-5]   ; jumptable 00410022 case 5
.text:0041071C		       cmp     siz, [bRHS-5]
.text:0041071F		       jz      short loc_41079A
.text:00410721		       movzx   esi, al
.text:00410724		       movzx   siz, byte ptr [bRHS-5]
.text:00410728		       sub     esi, siz
.text:0041072A		       jz      short loc_41073F
.text:0041072C		       xor     siz, siz
.text:0041072E		       test    esi, esi
.text:00410730		       setnle  al
.text:00410733		       lea     siz, [siz+siz-1]
.text:00410737		       test    siz, siz
.text:00410739		       jnz     loc_4103E3
.text:0041073F
.text:0041073F loc_41073F:			       ; CODE XREF: unaligned_memcmp+B85j
.text:0041073F		       movzx   esi, byte ptr [bLHS-4]
.text:00410743		       movzx   siz, byte ptr [bRHS-4]
.text:00410747		       sub     esi, siz
.text:00410749		       jz      short loc_41075E
.text:0041074B		       xor     siz, siz
.text:0041074D		       test    esi, esi
.text:0041074F		       setnle  al
.text:00410752		       lea     siz, [siz+siz-1]
.text:00410756		       test    siz, siz
.text:00410758		       jnz     loc_4103E3
.text:0041075E
.text:0041075E loc_41075E:			       ; CODE XREF: unaligned_memcmp+BA4j
.text:0041075E		       movzx   esi, byte ptr [bLHS-3]
.text:00410762		       movzx   siz, byte ptr [bRHS-3]
.text:00410766		       sub     esi, siz
.text:00410768		       jz      short loc_41077D
.text:0041076A		       xor     siz, siz
.text:0041076C		       test    esi, esi
.text:0041076E		       setnle  al
.text:00410771		       lea     siz, [siz+siz-1]
.text:00410775		       test    siz, siz
.text:00410777		       jnz     loc_4103E3
.text:0041077D
.text:0041077D loc_41077D:			       ; CODE XREF: unaligned_memcmp+BC3j
.text:0041077D		       movzx   esi, byte ptr [bLHS-2]
.text:00410781		       movzx   siz, byte ptr [bRHS-2]
.text:00410785		       sub     esi, siz
.text:00410787		       jz      short loc_410796
.text:00410789		       xor     siz, siz
.text:0041078B		       test    esi, esi
.text:0041078D		       setnle  al
.text:00410790		       lea     siz, [siz+siz-1]
.text:00410794		       mov     esi, siz
.text:00410796
.text:00410796 loc_410796:			       ; CODE XREF: unaligned_memcmp+BE2j
.text:00410796		       mov     siz, esi
.text:00410798		       jmp     short loc_41079C
.text:0041079A ; ---------------------------------------------------------------------------
.text:0041079A
.text:0041079A loc_41079A:			       ; CODE XREF: unaligned_memcmp+B7Aj
.text:0041079A		       xor     siz, siz
.text:0041079C
.text:0041079C loc_41079C:			       ; CODE XREF: unaligned_memcmp+BF3j
.text:0041079C					       ; unaligned_memcmp+140Aj
.text:0041079C		       test    siz, siz
.text:0041079E		       jnz     loc_4103E3
.text:004107A4
.text:004107A4 $LN1182:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004107A4					       ; unaligned_memcmp+13F9j
.text:004107A4					       ; DATA XREF: ...
.text:004107A4		       movzx   siz, byte ptr [bLHS-1] ;	jumptable 00410022 case	1
.text:004107A8		       movzx   bLHS, byte ptr [bRHS-1]
.text:004107AC		       sub     siz, bLHS
.text:004107AE		       jz      loc_4103E3
.text:004107B4		       xor     bLHS, bLHS
.text:004107B6		       test    siz, siz
.text:004107B8		       setnle  cl
.text:004107BB		       lea     bLHS, [bLHS+bLHS-1]
.text:004107BF		       mov     siz, bLHS
.text:004107C1		       jmp     loc_4103E3
.text:004107C6 ; ---------------------------------------------------------------------------
.text:004107C6
.text:004107C6 $LN30_0:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004107C6					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:004107C6		       mov     siz, [bLHS-1Eh] ; jumptable 00410022 case 30
.text:004107C9		       cmp     siz, [bRHS-1Eh]
.text:004107CC		       jz      short loc_410847
.text:004107CE		       movzx   esi, al
.text:004107D1		       movzx   siz, byte ptr [bRHS-1Eh]
.text:004107D5		       sub     esi, siz
.text:004107D7		       jz      short loc_4107EC
.text:004107D9		       xor     siz, siz
.text:004107DB		       test    esi, esi
.text:004107DD		       setnle  al
.text:004107E0		       lea     siz, [siz+siz-1]
.text:004107E4		       test    siz, siz
.text:004107E6		       jnz     loc_4103E3
.text:004107EC
.text:004107EC loc_4107EC:			       ; CODE XREF: unaligned_memcmp+C32j
.text:004107EC		       movzx   esi, byte ptr [bLHS-1Dh]
.text:004107F0		       movzx   siz, byte ptr [bRHS-1Dh]
.text:004107F4		       sub     esi, siz
.text:004107F6		       jz      short loc_41080B
.text:004107F8		       xor     siz, siz
.text:004107FA		       test    esi, esi
.text:004107FC		       setnle  al
.text:004107FF		       lea     siz, [siz+siz-1]
.text:00410803		       test    siz, siz
.text:00410805		       jnz     loc_4103E3
.text:0041080B
.text:0041080B loc_41080B:			       ; CODE XREF: unaligned_memcmp+C51j
.text:0041080B		       movzx   esi, byte ptr [bLHS-1Ch]
.text:0041080F		       movzx   siz, byte ptr [bRHS-1Ch]
.text:00410813		       sub     esi, siz
.text:00410815		       jz      short loc_41082A
.text:00410817		       xor     siz, siz
.text:00410819		       test    esi, esi
.text:0041081B		       setnle  al
.text:0041081E		       lea     siz, [siz+siz-1]
.text:00410822		       test    siz, siz
.text:00410824		       jnz     loc_4103E3
.text:0041082A
.text:0041082A loc_41082A:			       ; CODE XREF: unaligned_memcmp+C70j
.text:0041082A		       movzx   esi, byte ptr [bLHS-1Bh]
.text:0041082E		       movzx   siz, byte ptr [bRHS-1Bh]
.text:00410832		       sub     esi, siz
.text:00410834		       jz      short loc_410843
.text:00410836		       xor     siz, siz
.text:00410838		       test    esi, esi
.text:0041083A		       setnle  al
.text:0041083D		       lea     siz, [siz+siz-1]
.text:00410841		       mov     esi, siz
.text:00410843
.text:00410843 loc_410843:			       ; CODE XREF: unaligned_memcmp+C8Fj
.text:00410843		       mov     siz, esi
.text:00410845		       jmp     short loc_410849
.text:00410847 ; ---------------------------------------------------------------------------
.text:00410847
.text:00410847 loc_410847:			       ; CODE XREF: unaligned_memcmp+C27j
.text:00410847		       xor     siz, siz
.text:00410849
.text:00410849 loc_410849:			       ; CODE XREF: unaligned_memcmp+CA0j
.text:00410849		       test    siz, siz
.text:0041084B		       jnz     loc_4103E3
.text:00410851
.text:00410851 $LN1184:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410851					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410851		       mov     siz, [bLHS-1Ah] ; jumptable 00410022 case 26
.text:00410854		       cmp     siz, [bRHS-1Ah]
.text:00410857		       jz      short loc_4108D3
.text:00410859		       movzx   siz, byte ptr [bRHS-1Ah]
.text:0041085D		       movzx   esi, byte ptr [bLHS-1Ah]
.text:00410861		       sub     esi, siz
.text:00410863		       jz      short loc_410878
.text:00410865		       xor     siz, siz
.text:00410867		       test    esi, esi
.text:00410869		       setnle  al
.text:0041086C		       lea     siz, [siz+siz-1]
.text:00410870		       test    siz, siz
.text:00410872		       jnz     loc_4103E3
.text:00410878
.text:00410878 loc_410878:			       ; CODE XREF: unaligned_memcmp+CBEj
.text:00410878		       movzx   esi, byte ptr [bLHS-19h]
.text:0041087C		       movzx   siz, byte ptr [bRHS-19h]
.text:00410880		       sub     esi, siz
.text:00410882		       jz      short loc_410897
.text:00410884		       xor     siz, siz
.text:00410886		       test    esi, esi
.text:00410888		       setnle  al
.text:0041088B		       lea     siz, [siz+siz-1]
.text:0041088F		       test    siz, siz
.text:00410891		       jnz     loc_4103E3
.text:00410897
.text:00410897 loc_410897:			       ; CODE XREF: unaligned_memcmp+CDDj
.text:00410897		       movzx   esi, byte ptr [bLHS-18h]
.text:0041089B		       movzx   siz, byte ptr [bRHS-18h]
.text:0041089F		       sub     esi, siz
.text:004108A1		       jz      short loc_4108B6
.text:004108A3		       xor     siz, siz
.text:004108A5		       test    esi, esi
.text:004108A7		       setnle  al
.text:004108AA		       lea     siz, [siz+siz-1]
.text:004108AE		       test    siz, siz
.text:004108B0		       jnz     loc_4103E3
.text:004108B6
.text:004108B6 loc_4108B6:			       ; CODE XREF: unaligned_memcmp+CFCj
.text:004108B6		       movzx   esi, byte ptr [bLHS-17h]
.text:004108BA		       movzx   siz, byte ptr [bRHS-17h]
.text:004108BE		       sub     esi, siz
.text:004108C0		       jz      short loc_4108CF
.text:004108C2		       xor     siz, siz
.text:004108C4		       test    esi, esi
.text:004108C6		       setnle  al
.text:004108C9		       lea     siz, [siz+siz-1]
.text:004108CD		       mov     esi, siz
.text:004108CF
.text:004108CF loc_4108CF:			       ; CODE XREF: unaligned_memcmp+D1Bj
.text:004108CF		       mov     siz, esi
.text:004108D1		       jmp     short loc_4108D5
.text:004108D3 ; ---------------------------------------------------------------------------
.text:004108D3
.text:004108D3 loc_4108D3:			       ; CODE XREF: unaligned_memcmp+CB2j
.text:004108D3		       xor     siz, siz
.text:004108D5
.text:004108D5 loc_4108D5:			       ; CODE XREF: unaligned_memcmp+D2Cj
.text:004108D5		       test    siz, siz
.text:004108D7		       jnz     loc_4103E3
.text:004108DD
.text:004108DD $LN1185:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004108DD					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:004108DD		       mov     siz, [bLHS-16h] ; jumptable 00410022 case 22
.text:004108E0		       cmp     siz, [bRHS-16h]
.text:004108E3		       jz      short loc_41095E
.text:004108E5		       movzx   esi, al
.text:004108E8		       movzx   siz, byte ptr [bRHS-16h]
.text:004108EC		       sub     esi, siz
.text:004108EE		       jz      short loc_410903
.text:004108F0		       xor     siz, siz
.text:004108F2		       test    esi, esi
.text:004108F4		       setnle  al
.text:004108F7		       lea     siz, [siz+siz-1]
.text:004108FB		       test    siz, siz
.text:004108FD		       jnz     loc_4103E3
.text:00410903
.text:00410903 loc_410903:			       ; CODE XREF: unaligned_memcmp+D49j
.text:00410903		       movzx   esi, byte ptr [bLHS-15h]
.text:00410907		       movzx   siz, byte ptr [bRHS-15h]
.text:0041090B		       sub     esi, siz
.text:0041090D		       jz      short loc_410922
.text:0041090F		       xor     siz, siz
.text:00410911		       test    esi, esi
.text:00410913		       setnle  al
.text:00410916		       lea     siz, [siz+siz-1]
.text:0041091A		       test    siz, siz
.text:0041091C		       jnz     loc_4103E3
.text:00410922
.text:00410922 loc_410922:			       ; CODE XREF: unaligned_memcmp+D68j
.text:00410922		       movzx   esi, byte ptr [bLHS-14h]
.text:00410926		       movzx   siz, byte ptr [bRHS-14h]
.text:0041092A		       sub     esi, siz
.text:0041092C		       jz      short loc_410941
.text:0041092E		       xor     siz, siz
.text:00410930		       test    esi, esi
.text:00410932		       setnle  al
.text:00410935		       lea     siz, [siz+siz-1]
.text:00410939		       test    siz, siz
.text:0041093B		       jnz     loc_4103E3
.text:00410941
.text:00410941 loc_410941:			       ; CODE XREF: unaligned_memcmp+D87j
.text:00410941		       movzx   esi, byte ptr [bLHS-13h]
.text:00410945		       movzx   siz, byte ptr [bRHS-13h]
.text:00410949		       sub     esi, siz
.text:0041094B		       jz      short loc_41095A
.text:0041094D		       xor     siz, siz
.text:0041094F		       test    esi, esi
.text:00410951		       setnle  al
.text:00410954		       lea     siz, [siz+siz-1]
.text:00410958		       mov     esi, siz
.text:0041095A
.text:0041095A loc_41095A:			       ; CODE XREF: unaligned_memcmp+DA6j
.text:0041095A		       mov     siz, esi
.text:0041095C		       jmp     short loc_410960
.text:0041095E ; ---------------------------------------------------------------------------
.text:0041095E
.text:0041095E loc_41095E:			       ; CODE XREF: unaligned_memcmp+D3Ej
.text:0041095E		       xor     siz, siz
.text:00410960
.text:00410960 loc_410960:			       ; CODE XREF: unaligned_memcmp+DB7j
.text:00410960		       test    siz, siz
.text:00410962		       jnz     loc_4103E3
.text:00410968
.text:00410968 $LN1186:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410968					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410968		       mov     siz, [bLHS-12h] ; jumptable 00410022 case 18
.text:0041096B		       cmp     siz, [bRHS-12h]
.text:0041096E		       jz      short loc_4109E9
.text:00410970		       movzx   esi, al
.text:00410973		       movzx   siz, byte ptr [bRHS-12h]
.text:00410977		       sub     esi, siz
.text:00410979		       jz      short loc_41098E
.text:0041097B		       xor     siz, siz
.text:0041097D		       test    esi, esi
.text:0041097F		       setnle  al
.text:00410982		       lea     siz, [siz+siz-1]
.text:00410986		       test    siz, siz
.text:00410988		       jnz     loc_4103E3
.text:0041098E
.text:0041098E loc_41098E:			       ; CODE XREF: unaligned_memcmp+DD4j
.text:0041098E		       movzx   esi, byte ptr [bLHS-11h]
.text:00410992		       movzx   siz, byte ptr [bRHS-11h]
.text:00410996		       sub     esi, siz
.text:00410998		       jz      short loc_4109AD
.text:0041099A		       xor     siz, siz
.text:0041099C		       test    esi, esi
.text:0041099E		       setnle  al
.text:004109A1		       lea     siz, [siz+siz-1]
.text:004109A5		       test    siz, siz
.text:004109A7		       jnz     loc_4103E3
.text:004109AD
.text:004109AD loc_4109AD:			       ; CODE XREF: unaligned_memcmp+DF3j
.text:004109AD		       movzx   esi, byte ptr [bLHS-10h]
.text:004109B1		       movzx   siz, byte ptr [bRHS-10h]
.text:004109B5		       sub     esi, siz
.text:004109B7		       jz      short loc_4109CC
.text:004109B9		       xor     siz, siz
.text:004109BB		       test    esi, esi
.text:004109BD		       setnle  al
.text:004109C0		       lea     siz, [siz+siz-1]
.text:004109C4		       test    siz, siz
.text:004109C6		       jnz     loc_4103E3
.text:004109CC
.text:004109CC loc_4109CC:			       ; CODE XREF: unaligned_memcmp+E12j
.text:004109CC		       movzx   esi, byte ptr [bLHS-0Fh]
.text:004109D0		       movzx   siz, byte ptr [bRHS-0Fh]
.text:004109D4		       sub     esi, siz
.text:004109D6		       jz      short loc_4109E5
.text:004109D8		       xor     siz, siz
.text:004109DA		       test    esi, esi
.text:004109DC		       setnle  al
.text:004109DF		       lea     siz, [siz+siz-1]
.text:004109E3		       mov     esi, siz
.text:004109E5
.text:004109E5 loc_4109E5:			       ; CODE XREF: unaligned_memcmp+E31j
.text:004109E5		       mov     siz, esi
.text:004109E7		       jmp     short loc_4109EB
.text:004109E9 ; ---------------------------------------------------------------------------
.text:004109E9
.text:004109E9 loc_4109E9:			       ; CODE XREF: unaligned_memcmp+DC9j
.text:004109E9		       xor     siz, siz
.text:004109EB
.text:004109EB loc_4109EB:			       ; CODE XREF: unaligned_memcmp+E42j
.text:004109EB		       test    siz, siz
.text:004109ED		       jnz     loc_4103E3
.text:004109F3
.text:004109F3 $LN1187:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004109F3					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:004109F3		       mov     siz, [bLHS-0Eh] ; jumptable 00410022 case 14
.text:004109F6		       cmp     siz, [bRHS-0Eh]
.text:004109F9		       jz      short loc_410A74
.text:004109FB		       movzx   esi, al
.text:004109FE		       movzx   siz, byte ptr [bRHS-0Eh]
.text:00410A02		       sub     esi, siz
.text:00410A04		       jz      short loc_410A19
.text:00410A06		       xor     siz, siz
.text:00410A08		       test    esi, esi
.text:00410A0A		       setnle  al
.text:00410A0D		       lea     siz, [siz+siz-1]
.text:00410A11		       test    siz, siz
.text:00410A13		       jnz     loc_4103E3
.text:00410A19
.text:00410A19 loc_410A19:			       ; CODE XREF: unaligned_memcmp+E5Fj
.text:00410A19		       movzx   esi, byte ptr [bLHS-0Dh]
.text:00410A1D		       movzx   siz, byte ptr [bRHS-0Dh]
.text:00410A21		       sub     esi, siz
.text:00410A23		       jz      short loc_410A38
.text:00410A25		       xor     siz, siz
.text:00410A27		       test    esi, esi
.text:00410A29		       setnle  al
.text:00410A2C		       lea     siz, [siz+siz-1]
.text:00410A30		       test    siz, siz
.text:00410A32		       jnz     loc_4103E3
.text:00410A38
.text:00410A38 loc_410A38:			       ; CODE XREF: unaligned_memcmp+E7Ej
.text:00410A38		       movzx   esi, byte ptr [bLHS-0Ch]
.text:00410A3C		       movzx   siz, byte ptr [bRHS-0Ch]
.text:00410A40		       sub     esi, siz
.text:00410A42		       jz      short loc_410A57
.text:00410A44		       xor     siz, siz
.text:00410A46		       test    esi, esi
.text:00410A48		       setnle  al
.text:00410A4B		       lea     siz, [siz+siz-1]
.text:00410A4F		       test    siz, siz
.text:00410A51		       jnz     loc_4103E3
.text:00410A57
.text:00410A57 loc_410A57:			       ; CODE XREF: unaligned_memcmp+E9Dj
.text:00410A57		       movzx   esi, byte ptr [bLHS-0Bh]
.text:00410A5B		       movzx   siz, byte ptr [bRHS-0Bh]
.text:00410A5F		       sub     esi, siz
.text:00410A61		       jz      short loc_410A70
.text:00410A63		       xor     siz, siz
.text:00410A65		       test    esi, esi
.text:00410A67		       setnle  al
.text:00410A6A		       lea     siz, [siz+siz-1]
.text:00410A6E		       mov     esi, siz
.text:00410A70
.text:00410A70 loc_410A70:			       ; CODE XREF: unaligned_memcmp+EBCj
.text:00410A70		       mov     siz, esi
.text:00410A72		       jmp     short loc_410A76
.text:00410A74 ; ---------------------------------------------------------------------------
.text:00410A74
.text:00410A74 loc_410A74:			       ; CODE XREF: unaligned_memcmp+E54j
.text:00410A74		       xor     siz, siz
.text:00410A76
.text:00410A76 loc_410A76:			       ; CODE XREF: unaligned_memcmp+ECDj
.text:00410A76		       test    siz, siz
.text:00410A78		       jnz     loc_4103E3
.text:00410A7E
.text:00410A7E $LN1188:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410A7E					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410A7E		       mov     siz, [bLHS-0Ah] ; jumptable 00410022 case 10
.text:00410A81		       cmp     siz, [bRHS-0Ah]
.text:00410A84		       jz      short loc_410AFF
.text:00410A86		       movzx   esi, al
.text:00410A89		       movzx   siz, byte ptr [bRHS-0Ah]
.text:00410A8D		       sub     esi, siz
.text:00410A8F		       jz      short loc_410AA4
.text:00410A91		       xor     siz, siz
.text:00410A93		       test    esi, esi
.text:00410A95		       setnle  al
.text:00410A98		       lea     siz, [siz+siz-1]
.text:00410A9C		       test    siz, siz
.text:00410A9E		       jnz     loc_4103E3
.text:00410AA4
.text:00410AA4 loc_410AA4:			       ; CODE XREF: unaligned_memcmp+EEAj
.text:00410AA4		       movzx   esi, byte ptr [bLHS-9]
.text:00410AA8		       movzx   siz, byte ptr [bRHS-9]
.text:00410AAC		       sub     esi, siz
.text:00410AAE		       jz      short loc_410AC3
.text:00410AB0		       xor     siz, siz
.text:00410AB2		       test    esi, esi
.text:00410AB4		       setnle  al
.text:00410AB7		       lea     siz, [siz+siz-1]
.text:00410ABB		       test    siz, siz
.text:00410ABD		       jnz     loc_4103E3
.text:00410AC3
.text:00410AC3 loc_410AC3:			       ; CODE XREF: unaligned_memcmp+F09j
.text:00410AC3		       movzx   esi, byte ptr [bLHS-8]
.text:00410AC7		       movzx   siz, byte ptr [bRHS-8]
.text:00410ACB		       sub     esi, siz
.text:00410ACD		       jz      short loc_410AE2
.text:00410ACF		       xor     siz, siz
.text:00410AD1		       test    esi, esi
.text:00410AD3		       setnle  al
.text:00410AD6		       lea     siz, [siz+siz-1]
.text:00410ADA		       test    siz, siz
.text:00410ADC		       jnz     loc_4103E3
.text:00410AE2
.text:00410AE2 loc_410AE2:			       ; CODE XREF: unaligned_memcmp+F28j
.text:00410AE2		       movzx   esi, byte ptr [bLHS-7]
.text:00410AE6		       movzx   siz, byte ptr [bRHS-7]
.text:00410AEA		       sub     esi, siz
.text:00410AEC		       jz      short loc_410AFB
.text:00410AEE		       xor     siz, siz
.text:00410AF0		       test    esi, esi
.text:00410AF2		       setnle  al
.text:00410AF5		       lea     siz, [siz+siz-1]
.text:00410AF9		       mov     esi, siz
.text:00410AFB
.text:00410AFB loc_410AFB:			       ; CODE XREF: unaligned_memcmp+F47j
.text:00410AFB		       mov     siz, esi
.text:00410AFD		       jmp     short loc_410B01
.text:00410AFF ; ---------------------------------------------------------------------------
.text:00410AFF
.text:00410AFF loc_410AFF:			       ; CODE XREF: unaligned_memcmp+EDFj
.text:00410AFF		       xor     siz, siz
.text:00410B01
.text:00410B01 loc_410B01:			       ; CODE XREF: unaligned_memcmp+F58j
.text:00410B01		       test    siz, siz
.text:00410B03		       jnz     loc_4103E3
.text:00410B09
.text:00410B09 $LN1189:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410B09					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410B09		       mov     siz, [bLHS-6]   ; jumptable 00410022 case 6
.text:00410B0C		       cmp     siz, [bRHS-6]
.text:00410B0F		       jz      short loc_410B8A
.text:00410B11		       movzx   esi, al
.text:00410B14		       movzx   siz, byte ptr [bRHS-6]
.text:00410B18		       sub     esi, siz
.text:00410B1A		       jz      short loc_410B2F
.text:00410B1C		       xor     siz, siz
.text:00410B1E		       test    esi, esi
.text:00410B20		       setnle  al
.text:00410B23		       lea     siz, [siz+siz-1]
.text:00410B27		       test    siz, siz
.text:00410B29		       jnz     loc_4103E3
.text:00410B2F
.text:00410B2F loc_410B2F:			       ; CODE XREF: unaligned_memcmp+F75j
.text:00410B2F		       movzx   esi, byte ptr [bLHS-5]
.text:00410B33		       movzx   siz, byte ptr [bRHS-5]
.text:00410B37		       sub     esi, siz
.text:00410B39		       jz      short loc_410B4E
.text:00410B3B		       xor     siz, siz
.text:00410B3D		       test    esi, esi
.text:00410B3F		       setnle  al
.text:00410B42		       lea     siz, [siz+siz-1]
.text:00410B46		       test    siz, siz
.text:00410B48		       jnz     loc_4103E3
.text:00410B4E
.text:00410B4E loc_410B4E:			       ; CODE XREF: unaligned_memcmp+F94j
.text:00410B4E		       movzx   esi, byte ptr [bLHS-4]
.text:00410B52		       movzx   siz, byte ptr [bRHS-4]
.text:00410B56		       sub     esi, siz
.text:00410B58		       jz      short loc_410B6D
.text:00410B5A		       xor     siz, siz
.text:00410B5C		       test    esi, esi
.text:00410B5E		       setnle  al
.text:00410B61		       lea     siz, [siz+siz-1]
.text:00410B65		       test    siz, siz
.text:00410B67		       jnz     loc_4103E3
.text:00410B6D
.text:00410B6D loc_410B6D:			       ; CODE XREF: unaligned_memcmp+FB3j
.text:00410B6D		       movzx   esi, byte ptr [bLHS-3]
.text:00410B71		       movzx   siz, byte ptr [bRHS-3]
.text:00410B75		       sub     esi, siz
.text:00410B77		       jz      short loc_410B86
.text:00410B79		       xor     siz, siz
.text:00410B7B		       test    esi, esi
.text:00410B7D		       setnle  al
.text:00410B80		       lea     siz, [siz+siz-1]
.text:00410B84		       mov     esi, siz
.text:00410B86
.text:00410B86 loc_410B86:			       ; CODE XREF: unaligned_memcmp+FD2j
.text:00410B86		       mov     siz, esi
.text:00410B88		       jmp     short loc_410B8C
.text:00410B8A ; ---------------------------------------------------------------------------
.text:00410B8A
.text:00410B8A loc_410B8A:			       ; CODE XREF: unaligned_memcmp+F6Aj
.text:00410B8A		       xor     siz, siz
.text:00410B8C
.text:00410B8C loc_410B8C:			       ; CODE XREF: unaligned_memcmp+FE3j
.text:00410B8C		       test    siz, siz
.text:00410B8E		       jnz     loc_4103E3
.text:00410B94
.text:00410B94 $LN1190:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410B94					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410B94		       mov     ax, [bLHS-2]    ; jumptable 00410022 case 2
.text:00410B98		       cmp     ax, [bRHS-2]
.text:00410B9C		       jz      $LN61	       ; default
.text:00410B9C					       ; jumptable 00410022 case 0
.text:00410BA2		       jmp     loc_410F94
.text:00410BA7 ; ---------------------------------------------------------------------------
.text:00410BA7
.text:00410BA7 $LN15_5:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410BA7					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410BA7		       mov     siz, [bLHS-1Fh] ; jumptable 00410022 case 31
.text:00410BAA		       cmp     siz, [bRHS-1Fh]
.text:00410BAD		       jz      short loc_410C29
.text:00410BAF		       movzx   siz, byte ptr [bRHS-1Fh]
.text:00410BB3		       movzx   esi, byte ptr [bLHS-1Fh]
.text:00410BB7		       sub     esi, siz
.text:00410BB9		       jz      short loc_410BCE
.text:00410BBB		       xor     siz, siz
.text:00410BBD		       test    esi, esi
.text:00410BBF		       setnle  al
.text:00410BC2		       lea     siz, [siz+siz-1]
.text:00410BC6		       test    siz, siz
.text:00410BC8		       jnz     loc_4103E3
.text:00410BCE
.text:00410BCE loc_410BCE:			       ; CODE XREF: unaligned_memcmp+1014j
.text:00410BCE		       movzx   esi, byte ptr [bLHS-1Eh]
.text:00410BD2		       movzx   siz, byte ptr [bRHS-1Eh]
.text:00410BD6		       sub     esi, siz
.text:00410BD8		       jz      short loc_410BED
.text:00410BDA		       xor     siz, siz
.text:00410BDC		       test    esi, esi
.text:00410BDE		       setnle  al
.text:00410BE1		       lea     siz, [siz+siz-1]
.text:00410BE5		       test    siz, siz
.text:00410BE7		       jnz     loc_4103E3
.text:00410BED
.text:00410BED loc_410BED:			       ; CODE XREF: unaligned_memcmp+1033j
.text:00410BED		       movzx   esi, byte ptr [bLHS-1Dh]
.text:00410BF1		       movzx   siz, byte ptr [bRHS-1Dh]
.text:00410BF5		       sub     esi, siz
.text:00410BF7		       jz      short loc_410C0C
.text:00410BF9		       xor     siz, siz
.text:00410BFB		       test    esi, esi
.text:00410BFD		       setnle  al
.text:00410C00		       lea     siz, [siz+siz-1]
.text:00410C04		       test    siz, siz
.text:00410C06		       jnz     loc_4103E3
.text:00410C0C
.text:00410C0C loc_410C0C:			       ; CODE XREF: unaligned_memcmp+1052j
.text:00410C0C		       movzx   esi, byte ptr [bLHS-1Ch]
.text:00410C10		       movzx   siz, byte ptr [bRHS-1Ch]
.text:00410C14		       sub     esi, siz
.text:00410C16		       jz      short loc_410C25
.text:00410C18		       xor     siz, siz
.text:00410C1A		       test    esi, esi
.text:00410C1C		       setnle  al
.text:00410C1F		       lea     siz, [siz+siz-1]
.text:00410C23		       mov     esi, siz
.text:00410C25
.text:00410C25 loc_410C25:			       ; CODE XREF: unaligned_memcmp+1071j
.text:00410C25		       mov     siz, esi
.text:00410C27		       jmp     short loc_410C2B
.text:00410C29 ; ---------------------------------------------------------------------------
.text:00410C29
.text:00410C29 loc_410C29:			       ; CODE XREF: unaligned_memcmp+1008j
.text:00410C29		       xor     siz, siz
.text:00410C2B
.text:00410C2B loc_410C2B:			       ; CODE XREF: unaligned_memcmp+1082j
.text:00410C2B		       test    siz, siz
.text:00410C2D		       jnz     loc_4103E3
.text:00410C33
.text:00410C33 $LN1192:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410C33					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410C33		       mov     siz, [bLHS-1Bh] ; jumptable 00410022 case 27
.text:00410C36		       cmp     siz, [bRHS-1Bh]
.text:00410C39		       jz      short loc_410CB4
.text:00410C3B		       movzx   esi, al
.text:00410C3E		       movzx   siz, byte ptr [bRHS-1Bh]
.text:00410C42		       sub     esi, siz
.text:00410C44		       jz      short loc_410C59
.text:00410C46		       xor     siz, siz
.text:00410C48		       test    esi, esi
.text:00410C4A		       setnle  al
.text:00410C4D		       lea     siz, [siz+siz-1]
.text:00410C51		       test    siz, siz
.text:00410C53		       jnz     loc_4103E3
.text:00410C59
.text:00410C59 loc_410C59:			       ; CODE XREF: unaligned_memcmp+109Fj
.text:00410C59		       movzx   esi, byte ptr [bLHS-1Ah]
.text:00410C5D		       movzx   siz, byte ptr [bRHS-1Ah]
.text:00410C61		       sub     esi, siz
.text:00410C63		       jz      short loc_410C78
.text:00410C65		       xor     siz, siz
.text:00410C67		       test    esi, esi
.text:00410C69		       setnle  al
.text:00410C6C		       lea     siz, [siz+siz-1]
.text:00410C70		       test    siz, siz
.text:00410C72		       jnz     loc_4103E3
.text:00410C78
.text:00410C78 loc_410C78:			       ; CODE XREF: unaligned_memcmp+10BEj
.text:00410C78		       movzx   esi, byte ptr [bLHS-19h]
.text:00410C7C		       movzx   siz, byte ptr [bRHS-19h]
.text:00410C80		       sub     esi, siz
.text:00410C82		       jz      short loc_410C97
.text:00410C84		       xor     siz, siz
.text:00410C86		       test    esi, esi
.text:00410C88		       setnle  al
.text:00410C8B		       lea     siz, [siz+siz-1]
.text:00410C8F		       test    siz, siz
.text:00410C91		       jnz     loc_4103E3
.text:00410C97
.text:00410C97 loc_410C97:			       ; CODE XREF: unaligned_memcmp+10DDj
.text:00410C97		       movzx   esi, byte ptr [bLHS-18h]
.text:00410C9B		       movzx   siz, byte ptr [bRHS-18h]
.text:00410C9F		       sub     esi, siz
.text:00410CA1		       jz      short loc_410CB0
.text:00410CA3		       xor     siz, siz
.text:00410CA5		       test    esi, esi
.text:00410CA7		       setnle  al
.text:00410CAA		       lea     siz, [siz+siz-1]
.text:00410CAE		       mov     esi, siz
.text:00410CB0
.text:00410CB0 loc_410CB0:			       ; CODE XREF: unaligned_memcmp+10FCj
.text:00410CB0		       mov     siz, esi
.text:00410CB2		       jmp     short loc_410CB6
.text:00410CB4 ; ---------------------------------------------------------------------------
.text:00410CB4
.text:00410CB4 loc_410CB4:			       ; CODE XREF: unaligned_memcmp+1094j
.text:00410CB4		       xor     siz, siz
.text:00410CB6
.text:00410CB6 loc_410CB6:			       ; CODE XREF: unaligned_memcmp+110Dj
.text:00410CB6		       test    siz, siz
.text:00410CB8		       jnz     loc_4103E3
.text:00410CBE
.text:00410CBE $LN1193:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410CBE					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410CBE		       mov     siz, [bLHS-17h] ; jumptable 00410022 case 23
.text:00410CC1		       cmp     siz, [bRHS-17h]
.text:00410CC4		       jz      short loc_410D3F
.text:00410CC6		       movzx   esi, al
.text:00410CC9		       movzx   siz, byte ptr [bRHS-17h]
.text:00410CCD		       sub     esi, siz
.text:00410CCF		       jz      short loc_410CE4
.text:00410CD1		       xor     siz, siz
.text:00410CD3		       test    esi, esi
.text:00410CD5		       setnle  al
.text:00410CD8		       lea     siz, [siz+siz-1]
.text:00410CDC		       test    siz, siz
.text:00410CDE		       jnz     loc_4103E3
.text:00410CE4
.text:00410CE4 loc_410CE4:			       ; CODE XREF: unaligned_memcmp+112Aj
.text:00410CE4		       movzx   esi, byte ptr [bLHS-16h]
.text:00410CE8		       movzx   siz, byte ptr [bRHS-16h]
.text:00410CEC		       sub     esi, siz
.text:00410CEE		       jz      short loc_410D03
.text:00410CF0		       xor     siz, siz
.text:00410CF2		       test    esi, esi
.text:00410CF4		       setnle  al
.text:00410CF7		       lea     siz, [siz+siz-1]
.text:00410CFB		       test    siz, siz
.text:00410CFD		       jnz     loc_4103E3
.text:00410D03
.text:00410D03 loc_410D03:			       ; CODE XREF: unaligned_memcmp+1149j
.text:00410D03		       movzx   esi, byte ptr [bLHS-15h]
.text:00410D07		       movzx   siz, byte ptr [bRHS-15h]
.text:00410D0B		       sub     esi, siz
.text:00410D0D		       jz      short loc_410D22
.text:00410D0F		       xor     siz, siz
.text:00410D11		       test    esi, esi
.text:00410D13		       setnle  al
.text:00410D16		       lea     siz, [siz+siz-1]
.text:00410D1A		       test    siz, siz
.text:00410D1C		       jnz     loc_4103E3
.text:00410D22
.text:00410D22 loc_410D22:			       ; CODE XREF: unaligned_memcmp+1168j
.text:00410D22		       movzx   esi, byte ptr [bLHS-14h]
.text:00410D26		       movzx   siz, byte ptr [bRHS-14h]
.text:00410D2A		       sub     esi, siz
.text:00410D2C		       jz      short loc_410D3B
.text:00410D2E		       xor     siz, siz
.text:00410D30		       test    esi, esi
.text:00410D32		       setnle  al
.text:00410D35		       lea     siz, [siz+siz-1]
.text:00410D39		       mov     esi, siz
.text:00410D3B
.text:00410D3B loc_410D3B:			       ; CODE XREF: unaligned_memcmp+1187j
.text:00410D3B		       mov     siz, esi
.text:00410D3D		       jmp     short loc_410D41
.text:00410D3F ; ---------------------------------------------------------------------------
.text:00410D3F
.text:00410D3F loc_410D3F:			       ; CODE XREF: unaligned_memcmp+111Fj
.text:00410D3F		       xor     siz, siz
.text:00410D41
.text:00410D41 loc_410D41:			       ; CODE XREF: unaligned_memcmp+1198j
.text:00410D41		       test    siz, siz
.text:00410D43		       jnz     loc_4103E3
.text:00410D49
.text:00410D49 $LN1194:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410D49					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410D49		       mov     siz, [bLHS-13h] ; jumptable 00410022 case 19
.text:00410D4C		       cmp     siz, [bRHS-13h]
.text:00410D4F		       jz      short loc_410DCA
.text:00410D51		       movzx   esi, al
.text:00410D54		       movzx   siz, byte ptr [bRHS-13h]
.text:00410D58		       sub     esi, siz
.text:00410D5A		       jz      short loc_410D6F
.text:00410D5C		       xor     siz, siz
.text:00410D5E		       test    esi, esi
.text:00410D60		       setnle  al
.text:00410D63		       lea     siz, [siz+siz-1]
.text:00410D67		       test    siz, siz
.text:00410D69		       jnz     loc_4103E3
.text:00410D6F
.text:00410D6F loc_410D6F:			       ; CODE XREF: unaligned_memcmp+11B5j
.text:00410D6F		       movzx   esi, byte ptr [bLHS-12h]
.text:00410D73		       movzx   siz, byte ptr [bRHS-12h]
.text:00410D77		       sub     esi, siz
.text:00410D79		       jz      short loc_410D8E
.text:00410D7B		       xor     siz, siz
.text:00410D7D		       test    esi, esi
.text:00410D7F		       setnle  al
.text:00410D82		       lea     siz, [siz+siz-1]
.text:00410D86		       test    siz, siz
.text:00410D88		       jnz     loc_4103E3
.text:00410D8E
.text:00410D8E loc_410D8E:			       ; CODE XREF: unaligned_memcmp+11D4j
.text:00410D8E		       movzx   esi, byte ptr [bLHS-11h]
.text:00410D92		       movzx   siz, byte ptr [bRHS-11h]
.text:00410D96		       sub     esi, siz
.text:00410D98		       jz      short loc_410DAD
.text:00410D9A		       xor     siz, siz
.text:00410D9C		       test    esi, esi
.text:00410D9E		       setnle  al
.text:00410DA1		       lea     siz, [siz+siz-1]
.text:00410DA5		       test    siz, siz
.text:00410DA7		       jnz     loc_4103E3
.text:00410DAD
.text:00410DAD loc_410DAD:			       ; CODE XREF: unaligned_memcmp+11F3j
.text:00410DAD		       movzx   esi, byte ptr [bLHS-10h]
.text:00410DB1		       movzx   siz, byte ptr [bRHS-10h]
.text:00410DB5		       sub     esi, siz
.text:00410DB7		       jz      short loc_410DC6
.text:00410DB9		       xor     siz, siz
.text:00410DBB		       test    esi, esi
.text:00410DBD		       setnle  al
.text:00410DC0		       lea     siz, [siz+siz-1]
.text:00410DC4		       mov     esi, siz
.text:00410DC6
.text:00410DC6 loc_410DC6:			       ; CODE XREF: unaligned_memcmp+1212j
.text:00410DC6		       mov     siz, esi
.text:00410DC8		       jmp     short loc_410DCC
.text:00410DCA ; ---------------------------------------------------------------------------
.text:00410DCA
.text:00410DCA loc_410DCA:			       ; CODE XREF: unaligned_memcmp+11AAj
.text:00410DCA		       xor     siz, siz
.text:00410DCC
.text:00410DCC loc_410DCC:			       ; CODE XREF: unaligned_memcmp+1223j
.text:00410DCC		       test    siz, siz
.text:00410DCE		       jnz     loc_4103E3
.text:00410DD4
.text:00410DD4 $LN1195:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410DD4					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410DD4		       mov     siz, [bLHS-0Fh] ; jumptable 00410022 case 15
.text:00410DD7		       cmp     siz, [bRHS-0Fh]
.text:00410DDA		       jz      short loc_410E55
.text:00410DDC		       movzx   esi, al
.text:00410DDF		       movzx   siz, byte ptr [bRHS-0Fh]
.text:00410DE3		       sub     esi, siz
.text:00410DE5		       jz      short loc_410DFA
.text:00410DE7		       xor     siz, siz
.text:00410DE9		       test    esi, esi
.text:00410DEB		       setnle  al
.text:00410DEE		       lea     siz, [siz+siz-1]
.text:00410DF2		       test    siz, siz
.text:00410DF4		       jnz     loc_4103E3
.text:00410DFA
.text:00410DFA loc_410DFA:			       ; CODE XREF: unaligned_memcmp+1240j
.text:00410DFA		       movzx   esi, byte ptr [bLHS-0Eh]
.text:00410DFE		       movzx   siz, byte ptr [bRHS-0Eh]
.text:00410E02		       sub     esi, siz
.text:00410E04		       jz      short loc_410E19
.text:00410E06		       xor     siz, siz
.text:00410E08		       test    esi, esi
.text:00410E0A		       setnle  al
.text:00410E0D		       lea     siz, [siz+siz-1]
.text:00410E11		       test    siz, siz
.text:00410E13		       jnz     loc_4103E3
.text:00410E19
.text:00410E19 loc_410E19:			       ; CODE XREF: unaligned_memcmp+125Fj
.text:00410E19		       movzx   esi, byte ptr [bLHS-0Dh]
.text:00410E1D		       movzx   siz, byte ptr [bRHS-0Dh]
.text:00410E21		       sub     esi, siz
.text:00410E23		       jz      short loc_410E38
.text:00410E25		       xor     siz, siz
.text:00410E27		       test    esi, esi
.text:00410E29		       setnle  al
.text:00410E2C		       lea     siz, [siz+siz-1]
.text:00410E30		       test    siz, siz
.text:00410E32		       jnz     loc_4103E3
.text:00410E38
.text:00410E38 loc_410E38:			       ; CODE XREF: unaligned_memcmp+127Ej
.text:00410E38		       movzx   esi, byte ptr [bLHS-0Ch]
.text:00410E3C		       movzx   siz, byte ptr [bRHS-0Ch]
.text:00410E40		       sub     esi, siz
.text:00410E42		       jz      short loc_410E51
.text:00410E44		       xor     siz, siz
.text:00410E46		       test    esi, esi
.text:00410E48		       setnle  al
.text:00410E4B		       lea     siz, [siz+siz-1]
.text:00410E4F		       mov     esi, siz
.text:00410E51
.text:00410E51 loc_410E51:			       ; CODE XREF: unaligned_memcmp+129Dj
.text:00410E51		       mov     siz, esi
.text:00410E53		       jmp     short loc_410E57
.text:00410E55 ; ---------------------------------------------------------------------------
.text:00410E55
.text:00410E55 loc_410E55:			       ; CODE XREF: unaligned_memcmp+1235j
.text:00410E55		       xor     siz, siz
.text:00410E57
.text:00410E57 loc_410E57:			       ; CODE XREF: unaligned_memcmp+12AEj
.text:00410E57		       test    siz, siz
.text:00410E59		       jnz     loc_4103E3
.text:00410E5F
.text:00410E5F $LN1196:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410E5F					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410E5F		       mov     siz, [bLHS-0Bh] ; jumptable 00410022 case 11
.text:00410E62		       cmp     siz, [bRHS-0Bh]
.text:00410E65		       jz      short loc_410EE0
.text:00410E67		       movzx   esi, al
.text:00410E6A		       movzx   siz, byte ptr [bRHS-0Bh]
.text:00410E6E		       sub     esi, siz
.text:00410E70		       jz      short loc_410E85
.text:00410E72		       xor     siz, siz
.text:00410E74		       test    esi, esi
.text:00410E76		       setnle  al
.text:00410E79		       lea     siz, [siz+siz-1]
.text:00410E7D		       test    siz, siz
.text:00410E7F		       jnz     loc_4103E3
.text:00410E85
.text:00410E85 loc_410E85:			       ; CODE XREF: unaligned_memcmp+12CBj
.text:00410E85		       movzx   esi, byte ptr [bLHS-0Ah]
.text:00410E89		       movzx   siz, byte ptr [bRHS-0Ah]
.text:00410E8D		       sub     esi, siz
.text:00410E8F		       jz      short loc_410EA4
.text:00410E91		       xor     siz, siz
.text:00410E93		       test    esi, esi
.text:00410E95		       setnle  al
.text:00410E98		       lea     siz, [siz+siz-1]
.text:00410E9C		       test    siz, siz
.text:00410E9E		       jnz     loc_4103E3
.text:00410EA4
.text:00410EA4 loc_410EA4:			       ; CODE XREF: unaligned_memcmp+12EAj
.text:00410EA4		       movzx   esi, byte ptr [bLHS-9]
.text:00410EA8		       movzx   siz, byte ptr [bRHS-9]
.text:00410EAC		       sub     esi, siz
.text:00410EAE		       jz      short loc_410EC3
.text:00410EB0		       xor     siz, siz
.text:00410EB2		       test    esi, esi
.text:00410EB4		       setnle  al
.text:00410EB7		       lea     siz, [siz+siz-1]
.text:00410EBB		       test    siz, siz
.text:00410EBD		       jnz     loc_4103E3
.text:00410EC3
.text:00410EC3 loc_410EC3:			       ; CODE XREF: unaligned_memcmp+1309j
.text:00410EC3		       movzx   esi, byte ptr [bLHS-8]
.text:00410EC7		       movzx   siz, byte ptr [bRHS-8]
.text:00410ECB		       sub     esi, siz
.text:00410ECD		       jz      short loc_410EDC
.text:00410ECF		       xor     siz, siz
.text:00410ED1		       test    esi, esi
.text:00410ED3		       setnle  al
.text:00410ED6		       lea     siz, [siz+siz-1]
.text:00410EDA		       mov     esi, siz
.text:00410EDC
.text:00410EDC loc_410EDC:			       ; CODE XREF: unaligned_memcmp+1328j
.text:00410EDC		       mov     siz, esi
.text:00410EDE		       jmp     short loc_410EE2
.text:00410EE0 ; ---------------------------------------------------------------------------
.text:00410EE0
.text:00410EE0 loc_410EE0:			       ; CODE XREF: unaligned_memcmp+12C0j
.text:00410EE0		       xor     siz, siz
.text:00410EE2
.text:00410EE2 loc_410EE2:			       ; CODE XREF: unaligned_memcmp+1339j
.text:00410EE2		       test    siz, siz
.text:00410EE4		       jnz     loc_4103E3
.text:00410EEA
.text:00410EEA $LN1197:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410EEA					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410EEA		       mov     siz, [bLHS-7]   ; jumptable 00410022 case 7
.text:00410EED		       cmp     siz, [bRHS-7]
.text:00410EF0		       jz      short loc_410F6B
.text:00410EF2		       movzx   esi, al
.text:00410EF5		       movzx   siz, byte ptr [bRHS-7]
.text:00410EF9		       sub     esi, siz
.text:00410EFB		       jz      short loc_410F10
.text:00410EFD		       xor     siz, siz
.text:00410EFF		       test    esi, esi
.text:00410F01		       setnle  al
.text:00410F04		       lea     siz, [siz+siz-1]
.text:00410F08		       test    siz, siz
.text:00410F0A		       jnz     loc_4103E3
.text:00410F10
.text:00410F10 loc_410F10:			       ; CODE XREF: unaligned_memcmp+1356j
.text:00410F10		       movzx   esi, byte ptr [bLHS-6]
.text:00410F14		       movzx   siz, byte ptr [bRHS-6]
.text:00410F18		       sub     esi, siz
.text:00410F1A		       jz      short loc_410F2F
.text:00410F1C		       xor     siz, siz
.text:00410F1E		       test    esi, esi
.text:00410F20		       setnle  al
.text:00410F23		       lea     siz, [siz+siz-1]
.text:00410F27		       test    siz, siz
.text:00410F29		       jnz     loc_4103E3
.text:00410F2F
.text:00410F2F loc_410F2F:			       ; CODE XREF: unaligned_memcmp+1375j
.text:00410F2F		       movzx   esi, byte ptr [bLHS-5]
.text:00410F33		       movzx   siz, byte ptr [bRHS-5]
.text:00410F37		       sub     esi, siz
.text:00410F39		       jz      short loc_410F4E
.text:00410F3B		       xor     siz, siz
.text:00410F3D		       test    esi, esi
.text:00410F3F		       setnle  al
.text:00410F42		       lea     siz, [siz+siz-1]
.text:00410F46		       test    siz, siz
.text:00410F48		       jnz     loc_4103E3
.text:00410F4E
.text:00410F4E loc_410F4E:			       ; CODE XREF: unaligned_memcmp+1394j
.text:00410F4E		       movzx   esi, byte ptr [bLHS-4]
.text:00410F52		       movzx   siz, byte ptr [bRHS-4]
.text:00410F56		       sub     esi, siz
.text:00410F58		       jz      short loc_410F67
.text:00410F5A		       xor     siz, siz
.text:00410F5C		       test    esi, esi
.text:00410F5E		       setnle  al
.text:00410F61		       lea     siz, [siz+siz-1]
.text:00410F65		       mov     esi, siz
.text:00410F67
.text:00410F67 loc_410F67:			       ; CODE XREF: unaligned_memcmp+13B3j
.text:00410F67		       mov     siz, esi
.text:00410F69		       jmp     short loc_410F6D
.text:00410F6B ; ---------------------------------------------------------------------------
.text:00410F6B
.text:00410F6B loc_410F6B:			       ; CODE XREF: unaligned_memcmp+134Bj
.text:00410F6B		       xor     siz, siz
.text:00410F6D
.text:00410F6D loc_410F6D:			       ; CODE XREF: unaligned_memcmp+13C4j
.text:00410F6D		       test    siz, siz
.text:00410F6F		       jnz     loc_4103E3
.text:00410F75
.text:00410F75 $LN1198:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410F75					       ; DATA XREF: unaligned_memcmp:off_410FB5o
.text:00410F75		       movzx   esi, byte ptr [bLHS-3] ;	jumptable 00410022 case	3
.text:00410F79		       movzx   siz, byte ptr [bRHS-3]
.text:00410F7D		       sub     esi, siz
.text:00410F7F		       jz      short loc_410F94
.text:00410F81		       xor     siz, siz
.text:00410F83		       test    esi, esi
.text:00410F85		       setnle  al
.text:00410F88		       lea     siz, [siz+siz-1]
.text:00410F8C		       test    siz, siz
.text:00410F8E		       jnz     loc_4103E3
.text:00410F94
.text:00410F94 loc_410F94:			       ; CODE XREF: unaligned_memcmp+FFDj
.text:00410F94					       ; unaligned_memcmp+13DAj
.text:00410F94		       movzx   esi, byte ptr [bLHS-2]
.text:00410F98		       movzx   siz, byte ptr [bRHS-2]
.text:00410F9C		       sub     esi, siz
.text:00410F9E		       jz      $LN1182	       ; jumptable 00410022 case 1
.text:00410FA4		       xor     siz, siz
.text:00410FA6		       test    esi, esi
.text:00410FA8		       setnle  al
.text:00410FAB		       lea     siz, [siz+siz-1]
.text:00410FAF		       jmp     loc_41079C
.text:00410FAF ; ---------------------------------------------------------------------------
.text:00410FB4		       db 90h
.text:00410FB5 off_410FB5      dd offset $LN61	       ; DATA XREF: unaligned_memcmp+47Dr
.text:00410FB5		       dd offset $LN1182       ; jump table for	switch statement
.text:00410FB5		       dd offset $LN1190
.text:00410FB5		       dd offset $LN1198
.text:00410FB5		       dd offset $LN1174
.text:00410FB5		       dd offset $LN1181
.text:00410FB5		       dd offset $LN1189
.text:00410FB5		       dd offset $LN1197
.text:00410FB5		       dd offset $LN1173
.text:00410FB5		       dd offset $LN1180
.text:00410FB5		       dd offset $LN1188
.text:00410FB5		       dd offset $LN1196
.text:00410FB5		       dd offset $LN1172
.text:00410FB5		       dd offset $LN1179
.text:00410FB5		       dd offset $LN1187
.text:00410FB5		       dd offset $LN1195
.text:00410FB5		       dd offset $LN1171
.text:00410FB5		       dd offset $LN1178
.text:00410FB5		       dd offset $LN1186
.text:00410FB5		       dd offset $LN1194
.text:00410FB5		       dd offset $LN1170
.text:00410FB5		       dd offset $LN1177
.text:00410FB5		       dd offset $LN1185
.text:00410FB5		       dd offset $LN1193
.text:00410FB5		       dd offset $LN1169
.text:00410FB5		       dd offset $LN1176
.text:00410FB5		       dd offset $LN1184
.text:00410FB5		       dd offset $LN1192
.text:00410FB5		       dd offset $LN60
.text:00410FB5		       dd offset $LN45
.text:00410FB5		       dd offset $LN30_0
.text:00410FB5		       dd offset $LN15_5
.text:00410FB5 unaligned_memcmp	endp
.text:00410FB5
.text:00411035
.text:00411035 ; =============== S U B R O U T I N E =======================================
.text:00411035
.text:00411035 ; Attributes: bp-based frame
.text:00411035
.text:00411035 ; int __cdecl memcmp(const void *lhs, const void	*rhs, unsigned int siz)
.text:00411035 _memcmp	       proc near	       ; CODE XREF: _setlocale_set_cat+21Bp
.text:00411035
.text:00411035 lhs	       = dword ptr  8
.text:00411035 rhs	       = dword ptr  0Ch
.text:00411035 siz	       = dword ptr  10h
.text:00411035
.text:00411035		       push    ebp
.text:00411036		       mov     ebp, esp
.text:00411038		       push    esi
.text:00411039		       push    edi
.text:0041103A		       mov     edi, [ebp+siz]
.text:0041103D		       mov     eax, edi
.text:0041103F		       sub     eax, 0
.text:00411042		       jz      loc_41262D
.text:00411048		       dec     eax
.text:00411049		       jz      loc_41261C
.text:0041104F		       dec     eax
.text:00411050		       jz      loc_4125EE
.text:00411056		       dec     eax
.text:00411057		       jz      loc_4125A6
.text:0041105D		       dec     eax
.text:0041105E		       jz      loc_41251D
.text:00411064		       mov     ecx, [ebp+rhs]
.text:00411067		       mov     eax, [ebp+lhs]
.text:0041106A		       push    ebx
.text:0041106B		       push    20h
.text:0041106D		       pop     edx
.text:0041106E		       jmp     loc_4114E5
.text:00411073 ; ---------------------------------------------------------------------------
.text:00411073
.text:00411073 loc_411073:			       ; CODE XREF: _memcmp+4B2j
.text:00411073		       mov     esi, [eax]
.text:00411075		       cmp     esi, [ecx]
.text:00411077		       jz      short loc_4110F5
.text:00411079		       movzx   esi, byte ptr [eax]
.text:0041107C		       movzx   ebx, byte ptr [ecx]
.text:0041107F		       sub     esi, ebx
.text:00411081		       jz      short loc_411098
.text:00411083		       xor     ebx, ebx
.text:00411085		       test    esi, esi
.text:00411087		       setnle  bl
.text:0041108A		       lea     ebx, [ebx+ebx-1]
.text:0041108E		       mov     esi, ebx
.text:00411090		       test    esi, esi
.text:00411092		       jnz     loc_411501
.text:00411098
.text:00411098 loc_411098:			       ; CODE XREF: _memcmp+4Cj
.text:00411098		       movzx   esi, byte ptr [eax+1]
.text:0041109C		       movzx   ebx, byte ptr [ecx+1]
.text:004110A0		       sub     esi, ebx
.text:004110A2		       jz      short loc_4110B9
.text:004110A4		       xor     ebx, ebx
.text:004110A6		       test    esi, esi
.text:004110A8		       setnle  bl
.text:004110AB		       lea     ebx, [ebx+ebx-1]
.text:004110AF		       mov     esi, ebx
.text:004110B1		       test    esi, esi
.text:004110B3		       jnz     loc_411501
.text:004110B9
.text:004110B9 loc_4110B9:			       ; CODE XREF: _memcmp+6Dj
.text:004110B9		       movzx   esi, byte ptr [eax+2]
.text:004110BD		       movzx   ebx, byte ptr [ecx+2]
.text:004110C1		       sub     esi, ebx
.text:004110C3		       jz      short loc_4110DA
.text:004110C5		       xor     ebx, ebx
.text:004110C7		       test    esi, esi
.text:004110C9		       setnle  bl
.text:004110CC		       lea     ebx, [ebx+ebx-1]
.text:004110D0		       mov     esi, ebx
.text:004110D2		       test    esi, esi
.text:004110D4		       jnz     loc_411501
.text:004110DA
.text:004110DA loc_4110DA:			       ; CODE XREF: _memcmp+8Ej
.text:004110DA		       movzx   esi, byte ptr [eax+3]
.text:004110DE		       movzx   ebx, byte ptr [ecx+3]
.text:004110E2		       sub     esi, ebx
.text:004110E4		       jz      short loc_4110F7
.text:004110E6		       xor     ebx, ebx
.text:004110E8		       test    esi, esi
.text:004110EA		       setnle  bl
.text:004110ED		       lea     ebx, [ebx+ebx-1]
.text:004110F1		       mov     esi, ebx
.text:004110F3		       jmp     short loc_4110F7
.text:004110F5 ; ---------------------------------------------------------------------------
.text:004110F5
.text:004110F5 loc_4110F5:			       ; CODE XREF: _memcmp+42j
.text:004110F5		       xor     esi, esi
.text:004110F7
.text:004110F7 loc_4110F7:			       ; CODE XREF: _memcmp+AFj
.text:004110F7					       ; _memcmp+BEj
.text:004110F7		       test    esi, esi
.text:004110F9		       jnz     loc_411501
.text:004110FF		       mov     esi, [eax+4]
.text:00411102		       cmp     esi, [ecx+4]
.text:00411105		       jz      short loc_411185
.text:00411107		       movzx   esi, byte ptr [eax+4]
.text:0041110B		       movzx   ebx, byte ptr [ecx+4]
.text:0041110F		       sub     esi, ebx
.text:00411111		       jz      short loc_411128
.text:00411113		       xor     ebx, ebx
.text:00411115		       test    esi, esi
.text:00411117		       setnle  bl
.text:0041111A		       lea     ebx, [ebx+ebx-1]
.text:0041111E		       mov     esi, ebx
.text:00411120		       test    esi, esi
.text:00411122		       jnz     loc_411501
.text:00411128
.text:00411128 loc_411128:			       ; CODE XREF: _memcmp+DCj
.text:00411128		       movzx   esi, byte ptr [eax+5]
.text:0041112C		       movzx   ebx, byte ptr [ecx+5]
.text:00411130		       sub     esi, ebx
.text:00411132		       jz      short loc_411149
.text:00411134		       xor     ebx, ebx
.text:00411136		       test    esi, esi
.text:00411138		       setnle  bl
.text:0041113B		       lea     ebx, [ebx+ebx-1]
.text:0041113F		       mov     esi, ebx
.text:00411141		       test    esi, esi
.text:00411143		       jnz     loc_411501
.text:00411149
.text:00411149 loc_411149:			       ; CODE XREF: _memcmp+FDj
.text:00411149		       movzx   esi, byte ptr [eax+6]
.text:0041114D		       movzx   ebx, byte ptr [ecx+6]
.text:00411151		       sub     esi, ebx
.text:00411153		       jz      short loc_41116A
.text:00411155		       xor     ebx, ebx
.text:00411157		       test    esi, esi
.text:00411159		       setnle  bl
.text:0041115C		       lea     ebx, [ebx+ebx-1]
.text:00411160		       mov     esi, ebx
.text:00411162		       test    esi, esi
.text:00411164		       jnz     loc_411501
.text:0041116A
.text:0041116A loc_41116A:			       ; CODE XREF: _memcmp+11Ej
.text:0041116A		       movzx   esi, byte ptr [eax+7]
.text:0041116E		       movzx   ebx, byte ptr [ecx+7]
.text:00411172		       sub     esi, ebx
.text:00411174		       jz      short loc_411187
.text:00411176		       xor     ebx, ebx
.text:00411178		       test    esi, esi
.text:0041117A		       setnle  bl
.text:0041117D		       lea     ebx, [ebx+ebx-1]
.text:00411181		       mov     esi, ebx
.text:00411183		       jmp     short loc_411187
.text:00411185 ; ---------------------------------------------------------------------------
.text:00411185
.text:00411185 loc_411185:			       ; CODE XREF: _memcmp+D0j
.text:00411185		       xor     esi, esi
.text:00411187
.text:00411187 loc_411187:			       ; CODE XREF: _memcmp+13Fj
.text:00411187					       ; _memcmp+14Ej
.text:00411187		       test    esi, esi
.text:00411189		       jnz     loc_411501
.text:0041118F		       mov     esi, [eax+8]
.text:00411192		       cmp     esi, [ecx+8]
.text:00411195		       jz      short loc_411215
.text:00411197		       movzx   esi, byte ptr [eax+8]
.text:0041119B		       movzx   ebx, byte ptr [ecx+8]
.text:0041119F		       sub     esi, ebx
.text:004111A1		       jz      short loc_4111B8
.text:004111A3		       xor     ebx, ebx
.text:004111A5		       test    esi, esi
.text:004111A7		       setnle  bl
.text:004111AA		       lea     ebx, [ebx+ebx-1]
.text:004111AE		       mov     esi, ebx
.text:004111B0		       test    esi, esi
.text:004111B2		       jnz     loc_411501
.text:004111B8
.text:004111B8 loc_4111B8:			       ; CODE XREF: _memcmp+16Cj
.text:004111B8		       movzx   esi, byte ptr [eax+9]
.text:004111BC		       movzx   ebx, byte ptr [ecx+9]
.text:004111C0		       sub     esi, ebx
.text:004111C2		       jz      short loc_4111D9
.text:004111C4		       xor     ebx, ebx
.text:004111C6		       test    esi, esi
.text:004111C8		       setnle  bl
.text:004111CB		       lea     ebx, [ebx+ebx-1]
.text:004111CF		       mov     esi, ebx
.text:004111D1		       test    esi, esi
.text:004111D3		       jnz     loc_411501
.text:004111D9
.text:004111D9 loc_4111D9:			       ; CODE XREF: _memcmp+18Dj
.text:004111D9		       movzx   esi, byte ptr [eax+0Ah]
.text:004111DD		       movzx   ebx, byte ptr [ecx+0Ah]
.text:004111E1		       sub     esi, ebx
.text:004111E3		       jz      short loc_4111FA
.text:004111E5		       xor     ebx, ebx
.text:004111E7		       test    esi, esi
.text:004111E9		       setnle  bl
.text:004111EC		       lea     ebx, [ebx+ebx-1]
.text:004111F0		       mov     esi, ebx
.text:004111F2		       test    esi, esi
.text:004111F4		       jnz     loc_411501
.text:004111FA
.text:004111FA loc_4111FA:			       ; CODE XREF: _memcmp+1AEj
.text:004111FA		       movzx   esi, byte ptr [eax+0Bh]
.text:004111FE		       movzx   ebx, byte ptr [ecx+0Bh]
.text:00411202		       sub     esi, ebx
.text:00411204		       jz      short loc_411217
.text:00411206		       xor     ebx, ebx
.text:00411208		       test    esi, esi
.text:0041120A		       setnle  bl
.text:0041120D		       lea     ebx, [ebx+ebx-1]
.text:00411211		       mov     esi, ebx
.text:00411213		       jmp     short loc_411217
.text:00411215 ; ---------------------------------------------------------------------------
.text:00411215
.text:00411215 loc_411215:			       ; CODE XREF: _memcmp+160j
.text:00411215		       xor     esi, esi
.text:00411217
.text:00411217 loc_411217:			       ; CODE XREF: _memcmp+1CFj
.text:00411217					       ; _memcmp+1DEj
.text:00411217		       test    esi, esi
.text:00411219		       jnz     loc_411501
.text:0041121F		       mov     esi, [eax+0Ch]
.text:00411222		       cmp     esi, [ecx+0Ch]
.text:00411225		       jz      short loc_4112A5
.text:00411227		       movzx   esi, byte ptr [eax+0Ch]
.text:0041122B		       movzx   ebx, byte ptr [ecx+0Ch]
.text:0041122F		       sub     esi, ebx
.text:00411231		       jz      short loc_411248
.text:00411233		       xor     ebx, ebx
.text:00411235		       test    esi, esi
.text:00411237		       setnle  bl
.text:0041123A		       lea     ebx, [ebx+ebx-1]
.text:0041123E		       mov     esi, ebx
.text:00411240		       test    esi, esi
.text:00411242		       jnz     loc_411501
.text:00411248
.text:00411248 loc_411248:			       ; CODE XREF: _memcmp+1FCj
.text:00411248		       movzx   esi, byte ptr [eax+0Dh]
.text:0041124C		       movzx   ebx, byte ptr [ecx+0Dh]
.text:00411250		       sub     esi, ebx
.text:00411252		       jz      short loc_411269
.text:00411254		       xor     ebx, ebx
.text:00411256		       test    esi, esi
.text:00411258		       setnle  bl
.text:0041125B		       lea     ebx, [ebx+ebx-1]
.text:0041125F		       mov     esi, ebx
.text:00411261		       test    esi, esi
.text:00411263		       jnz     loc_411501
.text:00411269
.text:00411269 loc_411269:			       ; CODE XREF: _memcmp+21Dj
.text:00411269		       movzx   esi, byte ptr [eax+0Eh]
.text:0041126D		       movzx   ebx, byte ptr [ecx+0Eh]
.text:00411271		       sub     esi, ebx
.text:00411273		       jz      short loc_41128A
.text:00411275		       xor     ebx, ebx
.text:00411277		       test    esi, esi
.text:00411279		       setnle  bl
.text:0041127C		       lea     ebx, [ebx+ebx-1]
.text:00411280		       mov     esi, ebx
.text:00411282		       test    esi, esi
.text:00411284		       jnz     loc_411501
.text:0041128A
.text:0041128A loc_41128A:			       ; CODE XREF: _memcmp+23Ej
.text:0041128A		       movzx   esi, byte ptr [eax+0Fh]
.text:0041128E		       movzx   ebx, byte ptr [ecx+0Fh]
.text:00411292		       sub     esi, ebx
.text:00411294		       jz      short loc_4112A7
.text:00411296		       xor     ebx, ebx
.text:00411298		       test    esi, esi
.text:0041129A		       setnle  bl
.text:0041129D		       lea     ebx, [ebx+ebx-1]
.text:004112A1		       mov     esi, ebx
.text:004112A3		       jmp     short loc_4112A7
.text:004112A5 ; ---------------------------------------------------------------------------
.text:004112A5
.text:004112A5 loc_4112A5:			       ; CODE XREF: _memcmp+1F0j
.text:004112A5		       xor     esi, esi
.text:004112A7
.text:004112A7 loc_4112A7:			       ; CODE XREF: _memcmp+25Fj
.text:004112A7					       ; _memcmp+26Ej
.text:004112A7		       test    esi, esi
.text:004112A9		       jnz     loc_411501
.text:004112AF		       mov     esi, [eax+10h]
.text:004112B2		       cmp     esi, [ecx+10h]
.text:004112B5		       jz      short loc_411335
.text:004112B7		       movzx   ebx, byte ptr [ecx+10h]
.text:004112BB		       movzx   esi, byte ptr [eax+10h]
.text:004112BF		       sub     esi, ebx
.text:004112C1		       jz      short loc_4112D8
.text:004112C3		       xor     ebx, ebx
.text:004112C5		       test    esi, esi
.text:004112C7		       setnle  bl
.text:004112CA		       lea     ebx, [ebx+ebx-1]
.text:004112CE		       mov     esi, ebx
.text:004112D0		       test    esi, esi
.text:004112D2		       jnz     loc_411501
.text:004112D8
.text:004112D8 loc_4112D8:			       ; CODE XREF: _memcmp+28Cj
.text:004112D8		       movzx   esi, byte ptr [eax+11h]
.text:004112DC		       movzx   ebx, byte ptr [ecx+11h]
.text:004112E0		       sub     esi, ebx
.text:004112E2		       jz      short loc_4112F9
.text:004112E4		       xor     ebx, ebx
.text:004112E6		       test    esi, esi
.text:004112E8		       setnle  bl
.text:004112EB		       lea     ebx, [ebx+ebx-1]
.text:004112EF		       mov     esi, ebx
.text:004112F1		       test    esi, esi
.text:004112F3		       jnz     loc_411501
.text:004112F9
.text:004112F9 loc_4112F9:			       ; CODE XREF: _memcmp+2ADj
.text:004112F9		       movzx   esi, byte ptr [eax+12h]
.text:004112FD		       movzx   ebx, byte ptr [ecx+12h]
.text:00411301		       sub     esi, ebx
.text:00411303		       jz      short loc_41131A
.text:00411305		       xor     ebx, ebx
.text:00411307		       test    esi, esi
.text:00411309		       setnle  bl
.text:0041130C		       lea     ebx, [ebx+ebx-1]
.text:00411310		       mov     esi, ebx
.text:00411312		       test    esi, esi
.text:00411314		       jnz     loc_411501
.text:0041131A
.text:0041131A loc_41131A:			       ; CODE XREF: _memcmp+2CEj
.text:0041131A		       movzx   esi, byte ptr [eax+13h]
.text:0041131E		       movzx   ebx, byte ptr [ecx+13h]
.text:00411322		       sub     esi, ebx
.text:00411324		       jz      short loc_411337
.text:00411326		       xor     ebx, ebx
.text:00411328		       test    esi, esi
.text:0041132A		       setnle  bl
.text:0041132D		       lea     ebx, [ebx+ebx-1]
.text:00411331		       mov     esi, ebx
.text:00411333		       jmp     short loc_411337
.text:00411335 ; ---------------------------------------------------------------------------
.text:00411335
.text:00411335 loc_411335:			       ; CODE XREF: _memcmp+280j
.text:00411335		       xor     esi, esi
.text:00411337
.text:00411337 loc_411337:			       ; CODE XREF: _memcmp+2EFj
.text:00411337					       ; _memcmp+2FEj
.text:00411337		       test    esi, esi
.text:00411339		       jnz     loc_411501
.text:0041133F		       mov     esi, [eax+14h]
.text:00411342		       cmp     esi, [ecx+14h]
.text:00411345		       jz      short loc_4113C5
.text:00411347		       movzx   esi, byte ptr [eax+14h]
.text:0041134B		       movzx   ebx, byte ptr [ecx+14h]
.text:0041134F		       sub     esi, ebx
.text:00411351		       jz      short loc_411368
.text:00411353		       xor     ebx, ebx
.text:00411355		       test    esi, esi
.text:00411357		       setnle  bl
.text:0041135A		       lea     ebx, [ebx+ebx-1]
.text:0041135E		       mov     esi, ebx
.text:00411360		       test    esi, esi
.text:00411362		       jnz     loc_411501
.text:00411368
.text:00411368 loc_411368:			       ; CODE XREF: _memcmp+31Cj
.text:00411368		       movzx   esi, byte ptr [eax+15h]
.text:0041136C		       movzx   ebx, byte ptr [ecx+15h]
.text:00411370		       sub     esi, ebx
.text:00411372		       jz      short loc_411389
.text:00411374		       xor     ebx, ebx
.text:00411376		       test    esi, esi
.text:00411378		       setnle  bl
.text:0041137B		       lea     ebx, [ebx+ebx-1]
.text:0041137F		       mov     esi, ebx
.text:00411381		       test    esi, esi
.text:00411383		       jnz     loc_411501
.text:00411389
.text:00411389 loc_411389:			       ; CODE XREF: _memcmp+33Dj
.text:00411389		       movzx   esi, byte ptr [eax+16h]
.text:0041138D		       movzx   ebx, byte ptr [ecx+16h]
.text:00411391		       sub     esi, ebx
.text:00411393		       jz      short loc_4113AA
.text:00411395		       xor     ebx, ebx
.text:00411397		       test    esi, esi
.text:00411399		       setnle  bl
.text:0041139C		       lea     ebx, [ebx+ebx-1]
.text:004113A0		       mov     esi, ebx
.text:004113A2		       test    esi, esi
.text:004113A4		       jnz     loc_411501
.text:004113AA
.text:004113AA loc_4113AA:			       ; CODE XREF: _memcmp+35Ej
.text:004113AA		       movzx   esi, byte ptr [eax+17h]
.text:004113AE		       movzx   ebx, byte ptr [ecx+17h]
.text:004113B2		       sub     esi, ebx
.text:004113B4		       jz      short loc_4113C7
.text:004113B6		       xor     ebx, ebx
.text:004113B8		       test    esi, esi
.text:004113BA		       setnle  bl
.text:004113BD		       lea     ebx, [ebx+ebx-1]
.text:004113C1		       mov     esi, ebx
.text:004113C3		       jmp     short loc_4113C7
.text:004113C5 ; ---------------------------------------------------------------------------
.text:004113C5
.text:004113C5 loc_4113C5:			       ; CODE XREF: _memcmp+310j
.text:004113C5		       xor     esi, esi
.text:004113C7
.text:004113C7 loc_4113C7:			       ; CODE XREF: _memcmp+37Fj
.text:004113C7					       ; _memcmp+38Ej
.text:004113C7		       test    esi, esi
.text:004113C9		       jnz     loc_411501
.text:004113CF		       mov     esi, [eax+18h]
.text:004113D2		       cmp     esi, [ecx+18h]
.text:004113D5		       jz      short loc_411455
.text:004113D7		       movzx   esi, byte ptr [eax+18h]
.text:004113DB		       movzx   ebx, byte ptr [ecx+18h]
.text:004113DF		       sub     esi, ebx
.text:004113E1		       jz      short loc_4113F8
.text:004113E3		       xor     ebx, ebx
.text:004113E5		       test    esi, esi
.text:004113E7		       setnle  bl
.text:004113EA		       lea     ebx, [ebx+ebx-1]
.text:004113EE		       mov     esi, ebx
.text:004113F0		       test    esi, esi
.text:004113F2		       jnz     loc_411501
.text:004113F8
.text:004113F8 loc_4113F8:			       ; CODE XREF: _memcmp+3ACj
.text:004113F8		       movzx   esi, byte ptr [eax+19h]
.text:004113FC		       movzx   ebx, byte ptr [ecx+19h]
.text:00411400		       sub     esi, ebx
.text:00411402		       jz      short loc_411419
.text:00411404		       xor     ebx, ebx
.text:00411406		       test    esi, esi
.text:00411408		       setnle  bl
.text:0041140B		       lea     ebx, [ebx+ebx-1]
.text:0041140F		       mov     esi, ebx
.text:00411411		       test    esi, esi
.text:00411413		       jnz     loc_411501
.text:00411419
.text:00411419 loc_411419:			       ; CODE XREF: _memcmp+3CDj
.text:00411419		       movzx   esi, byte ptr [eax+1Ah]
.text:0041141D		       movzx   ebx, byte ptr [ecx+1Ah]
.text:00411421		       sub     esi, ebx
.text:00411423		       jz      short loc_41143A
.text:00411425		       xor     ebx, ebx
.text:00411427		       test    esi, esi
.text:00411429		       setnle  bl
.text:0041142C		       lea     ebx, [ebx+ebx-1]
.text:00411430		       mov     esi, ebx
.text:00411432		       test    esi, esi
.text:00411434		       jnz     loc_411501
.text:0041143A
.text:0041143A loc_41143A:			       ; CODE XREF: _memcmp+3EEj
.text:0041143A		       movzx   esi, byte ptr [eax+1Bh]
.text:0041143E		       movzx   ebx, byte ptr [ecx+1Bh]
.text:00411442		       sub     esi, ebx
.text:00411444		       jz      short loc_411457
.text:00411446		       xor     ebx, ebx
.text:00411448		       test    esi, esi
.text:0041144A		       setnle  bl
.text:0041144D		       lea     ebx, [ebx+ebx-1]
.text:00411451		       mov     esi, ebx
.text:00411453		       jmp     short loc_411457
.text:00411455 ; ---------------------------------------------------------------------------
.text:00411455
.text:00411455 loc_411455:			       ; CODE XREF: _memcmp+3A0j
.text:00411455		       xor     esi, esi
.text:00411457
.text:00411457 loc_411457:			       ; CODE XREF: _memcmp+40Fj
.text:00411457					       ; _memcmp+41Ej
.text:00411457		       test    esi, esi
.text:00411459		       jnz     loc_411501
.text:0041145F		       mov     esi, [eax+1Ch]
.text:00411462		       cmp     esi, [ecx+1Ch]
.text:00411465		       jz      short loc_4114D9
.text:00411467		       movzx   esi, byte ptr [eax+1Ch]
.text:0041146B		       movzx   ebx, byte ptr [ecx+1Ch]
.text:0041146F		       sub     esi, ebx
.text:00411471		       jz      short loc_411484
.text:00411473		       xor     ebx, ebx
.text:00411475		       test    esi, esi
.text:00411477		       setnle  bl
.text:0041147A		       lea     ebx, [ebx+ebx-1]
.text:0041147E		       mov     esi, ebx
.text:00411480		       test    esi, esi
.text:00411482		       jnz     short loc_411501
.text:00411484
.text:00411484 loc_411484:			       ; CODE XREF: _memcmp+43Cj
.text:00411484		       movzx   esi, byte ptr [eax+1Dh]
.text:00411488		       movzx   ebx, byte ptr [ecx+1Dh]
.text:0041148C		       sub     esi, ebx
.text:0041148E		       jz      short loc_4114A1
.text:00411490		       xor     ebx, ebx
.text:00411492		       test    esi, esi
.text:00411494		       setnle  bl
.text:00411497		       lea     ebx, [ebx+ebx-1]
.text:0041149B		       mov     esi, ebx
.text:0041149D		       test    esi, esi
.text:0041149F		       jnz     short loc_411501
.text:004114A1
.text:004114A1 loc_4114A1:			       ; CODE XREF: _memcmp+459j
.text:004114A1		       movzx   esi, byte ptr [eax+1Eh]
.text:004114A5		       movzx   ebx, byte ptr [ecx+1Eh]
.text:004114A9		       sub     esi, ebx
.text:004114AB		       jz      short loc_4114BE
.text:004114AD		       xor     ebx, ebx
.text:004114AF		       test    esi, esi
.text:004114B1		       setnle  bl
.text:004114B4		       lea     ebx, [ebx+ebx-1]
.text:004114B8		       mov     esi, ebx
.text:004114BA		       test    esi, esi
.text:004114BC		       jnz     short loc_411501
.text:004114BE
.text:004114BE loc_4114BE:			       ; CODE XREF: _memcmp+476j
.text:004114BE		       movzx   esi, byte ptr [eax+1Fh]
.text:004114C2		       movzx   ebx, byte ptr [ecx+1Fh]
.text:004114C6		       sub     esi, ebx
.text:004114C8		       jz      short loc_4114DB
.text:004114CA		       xor     ebx, ebx
.text:004114CC		       test    esi, esi
.text:004114CE		       setnle  bl
.text:004114D1		       lea     ebx, [ebx+ebx-1]
.text:004114D5		       mov     esi, ebx
.text:004114D7		       jmp     short loc_4114DB
.text:004114D9 ; ---------------------------------------------------------------------------
.text:004114D9
.text:004114D9 loc_4114D9:			       ; CODE XREF: _memcmp+430j
.text:004114D9		       xor     esi, esi
.text:004114DB
.text:004114DB loc_4114DB:			       ; CODE XREF: _memcmp+493j
.text:004114DB					       ; _memcmp+4A2j
.text:004114DB		       test    esi, esi
.text:004114DD		       jnz     short loc_411501
.text:004114DF		       add     eax, edx
.text:004114E1		       add     ecx, edx
.text:004114E3		       sub     edi, edx
.text:004114E5
.text:004114E5 loc_4114E5:			       ; CODE XREF: _memcmp+39j
.text:004114E5		       cmp     edi, edx
.text:004114E7		       jnb     loc_411073
.text:004114ED		       add     eax, edi
.text:004114EF		       add     ecx, edi
.text:004114F1		       cmp     edi, 1Fh	       ; switch	32 cases
.text:004114F4		       ja      $LN132	       ; default
.text:004114F4					       ; jumptable 004114FA case 0
.text:004114FA		       jmp     ds:off_412635[edi*4] ; switch jump
.text:00411501 ; ---------------------------------------------------------------------------
.text:00411501
.text:00411501 loc_411501:			       ; CODE XREF: _memcmp+5Dj
.text:00411501					       ; _memcmp+7Ej ...
.text:00411501		       mov     eax, esi
.text:00411503		       jmp     loc_4118D6
.text:00411508 ; ---------------------------------------------------------------------------
.text:00411508
.text:00411508 $LN131_0:			       ; CODE XREF: _memcmp+4C5j
.text:00411508					       ; DATA XREF: _memcmp:off_412635o
.text:00411508		       mov     edx, [eax-1Ch]  ; jumptable 004114FA case 28
.text:0041150B		       cmp     edx, [ecx-1Ch]
.text:0041150E		       jz      short loc_411581
.text:00411510		       movzx   esi, dl
.text:00411513		       movzx   edx, byte ptr [ecx-1Ch]
.text:00411517		       sub     esi, edx
.text:00411519		       jz      short loc_41152C
.text:0041151B		       xor     edx, edx
.text:0041151D		       test    esi, esi
.text:0041151F		       setnle  dl
.text:00411522		       lea     edx, [edx+edx-1]
.text:00411526		       mov     esi, edx
.text:00411528		       test    esi, esi
.text:0041152A		       jnz     short loc_411501
.text:0041152C
.text:0041152C loc_41152C:			       ; CODE XREF: _memcmp+4E4j
.text:0041152C		       movzx   esi, byte ptr [eax-1Bh]
.text:00411530		       movzx   edx, byte ptr [ecx-1Bh]
.text:00411534		       sub     esi, edx
.text:00411536		       jz      short loc_411549
.text:00411538		       xor     edx, edx
.text:0041153A		       test    esi, esi
.text:0041153C		       setnle  dl
.text:0041153F		       lea     edx, [edx+edx-1]
.text:00411543		       mov     esi, edx
.text:00411545		       test    esi, esi
.text:00411547		       jnz     short loc_411501
.text:00411549
.text:00411549 loc_411549:			       ; CODE XREF: _memcmp+501j
.text:00411549		       movzx   esi, byte ptr [eax-1Ah]
.text:0041154D		       movzx   edx, byte ptr [ecx-1Ah]
.text:00411551		       sub     esi, edx
.text:00411553		       jz      short loc_411566
.text:00411555		       xor     edx, edx
.text:00411557		       test    esi, esi
.text:00411559		       setnle  dl
.text:0041155C		       lea     edx, [edx+edx-1]
.text:00411560		       mov     esi, edx
.text:00411562		       test    esi, esi
.text:00411564		       jnz     short loc_411501
.text:00411566
.text:00411566 loc_411566:			       ; CODE XREF: _memcmp+51Ej
.text:00411566		       movzx   esi, byte ptr [eax-19h]
.text:0041156A		       movzx   edx, byte ptr [ecx-19h]
.text:0041156E		       sub     esi, edx
.text:00411570		       jz      short loc_411583
.text:00411572		       xor     edx, edx
.text:00411574		       test    esi, esi
.text:00411576		       setnle  dl
.text:00411579		       lea     edx, [edx+edx-1]
.text:0041157D		       mov     esi, edx
.text:0041157F		       jmp     short loc_411583
.text:00411581 ; ---------------------------------------------------------------------------
.text:00411581
.text:00411581 loc_411581:			       ; CODE XREF: _memcmp+4D9j
.text:00411581		       xor     esi, esi
.text:00411583
.text:00411583 loc_411583:			       ; CODE XREF: _memcmp+53Bj
.text:00411583					       ; _memcmp+54Aj
.text:00411583		       test    esi, esi
.text:00411585		       jnz     loc_411501
.text:0041158B
.text:0041158B $LN130_1:			       ; CODE XREF: _memcmp+4C5j
.text:0041158B					       ; DATA XREF: _memcmp:off_412635o
.text:0041158B		       mov     edx, [eax-18h]  ; jumptable 004114FA case 24
.text:0041158E		       cmp     edx, [ecx-18h]
.text:00411591		       jz      short loc_411610
.text:00411593		       movzx   esi, dl
.text:00411596		       movzx   edx, byte ptr [ecx-18h]
.text:0041159A		       sub     esi, edx
.text:0041159C		       jz      short loc_4115B3
.text:0041159E		       xor     edx, edx
.text:004115A0		       test    esi, esi
.text:004115A2		       setnle  dl
.text:004115A5		       lea     edx, [edx+edx-1]
.text:004115A9		       mov     esi, edx
.text:004115AB		       test    esi, esi
.text:004115AD		       jnz     loc_411501
.text:004115B3
.text:004115B3 loc_4115B3:			       ; CODE XREF: _memcmp+567j
.text:004115B3		       movzx   esi, byte ptr [eax-17h]
.text:004115B7		       movzx   edx, byte ptr [ecx-17h]
.text:004115BB		       sub     esi, edx
.text:004115BD		       jz      short loc_4115D4
.text:004115BF		       xor     edx, edx
.text:004115C1		       test    esi, esi
.text:004115C3		       setnle  dl
.text:004115C6		       lea     edx, [edx+edx-1]
.text:004115CA		       mov     esi, edx
.text:004115CC		       test    esi, esi
.text:004115CE		       jnz     loc_411501
.text:004115D4
.text:004115D4 loc_4115D4:			       ; CODE XREF: _memcmp+588j
.text:004115D4		       movzx   esi, byte ptr [eax-16h]
.text:004115D8		       movzx   edx, byte ptr [ecx-16h]
.text:004115DC		       sub     esi, edx
.text:004115DE		       jz      short loc_4115F5
.text:004115E0		       xor     edx, edx
.text:004115E2		       test    esi, esi
.text:004115E4		       setnle  dl
.text:004115E7		       lea     edx, [edx+edx-1]
.text:004115EB		       mov     esi, edx
.text:004115ED		       test    esi, esi
.text:004115EF		       jnz     loc_411501
.text:004115F5
.text:004115F5 loc_4115F5:			       ; CODE XREF: _memcmp+5A9j
.text:004115F5		       movzx   esi, byte ptr [eax-15h]
.text:004115F9		       movzx   edx, byte ptr [ecx-15h]
.text:004115FD		       sub     esi, edx
.text:004115FF		       jz      short loc_411612
.text:00411601		       xor     edx, edx
.text:00411603		       test    esi, esi
.text:00411605		       setnle  dl
.text:00411608		       lea     edx, [edx+edx-1]
.text:0041160C		       mov     esi, edx
.text:0041160E		       jmp     short loc_411612
.text:00411610 ; ---------------------------------------------------------------------------
.text:00411610
.text:00411610 loc_411610:			       ; CODE XREF: _memcmp+55Cj
.text:00411610		       xor     esi, esi
.text:00411612
.text:00411612 loc_411612:			       ; CODE XREF: _memcmp+5CAj
.text:00411612					       ; _memcmp+5D9j
.text:00411612		       test    esi, esi
.text:00411614		       jnz     loc_411501
.text:0041161A
.text:0041161A $LN128:				       ; CODE XREF: _memcmp+4C5j
.text:0041161A					       ; DATA XREF: _memcmp:off_412635o
.text:0041161A		       mov     edx, [eax-14h]  ; jumptable 004114FA case 20
.text:0041161D		       cmp     edx, [ecx-14h]
.text:00411620		       jz      short loc_41169F
.text:00411622		       movzx   esi, dl
.text:00411625		       movzx   edx, byte ptr [ecx-14h]
.text:00411629		       sub     esi, edx
.text:0041162B		       jz      short loc_411642
.text:0041162D		       xor     edx, edx
.text:0041162F		       test    esi, esi
.text:00411631		       setnle  dl
.text:00411634		       lea     edx, [edx+edx-1]
.text:00411638		       mov     esi, edx
.text:0041163A		       test    esi, esi
.text:0041163C		       jnz     loc_411501
.text:00411642
.text:00411642 loc_411642:			       ; CODE XREF: _memcmp+5F6j
.text:00411642		       movzx   esi, byte ptr [eax-13h]
.text:00411646		       movzx   edx, byte ptr [ecx-13h]
.text:0041164A		       sub     esi, edx
.text:0041164C		       jz      short loc_411663
.text:0041164E		       xor     edx, edx
.text:00411650		       test    esi, esi
.text:00411652		       setnle  dl
.text:00411655		       lea     edx, [edx+edx-1]
.text:00411659		       mov     esi, edx
.text:0041165B		       test    esi, esi
.text:0041165D		       jnz     loc_411501
.text:00411663
.text:00411663 loc_411663:			       ; CODE XREF: _memcmp+617j
.text:00411663		       movzx   esi, byte ptr [eax-12h]
.text:00411667		       movzx   edx, byte ptr [ecx-12h]
.text:0041166B		       sub     esi, edx
.text:0041166D		       jz      short loc_411684
.text:0041166F		       xor     edx, edx
.text:00411671		       test    esi, esi
.text:00411673		       setnle  dl
.text:00411676		       lea     edx, [edx+edx-1]
.text:0041167A		       mov     esi, edx
.text:0041167C		       test    esi, esi
.text:0041167E		       jnz     loc_411501
.text:00411684
.text:00411684 loc_411684:			       ; CODE XREF: _memcmp+638j
.text:00411684		       movzx   esi, byte ptr [eax-11h]
.text:00411688		       movzx   edx, byte ptr [ecx-11h]
.text:0041168C		       sub     esi, edx
.text:0041168E		       jz      short loc_4116A1
.text:00411690		       xor     edx, edx
.text:00411692		       test    esi, esi
.text:00411694		       setnle  dl
.text:00411697		       lea     edx, [edx+edx-1]
.text:0041169B		       mov     esi, edx
.text:0041169D		       jmp     short loc_4116A1
.text:0041169F ; ---------------------------------------------------------------------------
.text:0041169F
.text:0041169F loc_41169F:			       ; CODE XREF: _memcmp+5EBj
.text:0041169F		       xor     esi, esi
.text:004116A1
.text:004116A1 loc_4116A1:			       ; CODE XREF: _memcmp+659j
.text:004116A1					       ; _memcmp+668j
.text:004116A1		       test    esi, esi
.text:004116A3		       jnz     loc_411501
.text:004116A9
.text:004116A9 $LN126:				       ; CODE XREF: _memcmp+4C5j
.text:004116A9					       ; DATA XREF: _memcmp:off_412635o
.text:004116A9		       mov     edx, [eax-10h]  ; jumptable 004114FA case 16
.text:004116AC		       cmp     edx, [ecx-10h]
.text:004116AF		       jz      short loc_41172E
.text:004116B1		       movzx   esi, dl
.text:004116B4		       movzx   edx, byte ptr [ecx-10h]
.text:004116B8		       sub     esi, edx
.text:004116BA		       jz      short loc_4116D1
.text:004116BC		       xor     edx, edx
.text:004116BE		       test    esi, esi
.text:004116C0		       setnle  dl
.text:004116C3		       lea     edx, [edx+edx-1]
.text:004116C7		       mov     esi, edx
.text:004116C9		       test    esi, esi
.text:004116CB		       jnz     loc_411501
.text:004116D1
.text:004116D1 loc_4116D1:			       ; CODE XREF: _memcmp+685j
.text:004116D1		       movzx   esi, byte ptr [eax-0Fh]
.text:004116D5		       movzx   edx, byte ptr [ecx-0Fh]
.text:004116D9		       sub     esi, edx
.text:004116DB		       jz      short loc_4116F2
.text:004116DD		       xor     edx, edx
.text:004116DF		       test    esi, esi
.text:004116E1		       setnle  dl
.text:004116E4		       lea     edx, [edx+edx-1]
.text:004116E8		       mov     esi, edx
.text:004116EA		       test    esi, esi
.text:004116EC		       jnz     loc_411501
.text:004116F2
.text:004116F2 loc_4116F2:			       ; CODE XREF: _memcmp+6A6j
.text:004116F2		       movzx   esi, byte ptr [eax-0Eh]
.text:004116F6		       movzx   edx, byte ptr [ecx-0Eh]
.text:004116FA		       sub     esi, edx
.text:004116FC		       jz      short loc_411713
.text:004116FE		       xor     edx, edx
.text:00411700		       test    esi, esi
.text:00411702		       setnle  dl
.text:00411705		       lea     edx, [edx+edx-1]
.text:00411709		       mov     esi, edx
.text:0041170B		       test    esi, esi
.text:0041170D		       jnz     loc_411501
.text:00411713
.text:00411713 loc_411713:			       ; CODE XREF: _memcmp+6C7j
.text:00411713		       movzx   esi, byte ptr [eax-0Dh]
.text:00411717		       movzx   edx, byte ptr [ecx-0Dh]
.text:0041171B		       sub     esi, edx
.text:0041171D		       jz      short loc_411730
.text:0041171F		       xor     edx, edx
.text:00411721		       test    esi, esi
.text:00411723		       setnle  dl
.text:00411726		       lea     edx, [edx+edx-1]
.text:0041172A		       mov     esi, edx
.text:0041172C		       jmp     short loc_411730
.text:0041172E ; ---------------------------------------------------------------------------
.text:0041172E
.text:0041172E loc_41172E:			       ; CODE XREF: _memcmp+67Aj
.text:0041172E		       xor     esi, esi
.text:00411730
.text:00411730 loc_411730:			       ; CODE XREF: _memcmp+6E8j
.text:00411730					       ; _memcmp+6F7j
.text:00411730		       test    esi, esi
.text:00411732		       jnz     loc_411501
.text:00411738
.text:00411738 $LN124:				       ; CODE XREF: _memcmp+4C5j
.text:00411738					       ; DATA XREF: _memcmp:off_412635o
.text:00411738		       mov     edx, [eax-0Ch]  ; jumptable 004114FA case 12
.text:0041173B		       cmp     edx, [ecx-0Ch]
.text:0041173E		       jz      short loc_4117BE
.text:00411740		       movzx   edx, byte ptr [ecx-0Ch]
.text:00411744		       movzx   esi, byte ptr [eax-0Ch]
.text:00411748		       sub     esi, edx
.text:0041174A		       jz      short loc_411761
.text:0041174C		       xor     edx, edx
.text:0041174E		       test    esi, esi
.text:00411750		       setnle  dl
.text:00411753		       lea     edx, [edx+edx-1]
.text:00411757		       mov     esi, edx
.text:00411759		       test    esi, esi
.text:0041175B		       jnz     loc_411501
.text:00411761
.text:00411761 loc_411761:			       ; CODE XREF: _memcmp+715j
.text:00411761		       movzx   esi, byte ptr [eax-0Bh]
.text:00411765		       movzx   edx, byte ptr [ecx-0Bh]
.text:00411769		       sub     esi, edx
.text:0041176B		       jz      short loc_411782
.text:0041176D		       xor     edx, edx
.text:0041176F		       test    esi, esi
.text:00411771		       setnle  dl
.text:00411774		       lea     edx, [edx+edx-1]
.text:00411778		       mov     esi, edx
.text:0041177A		       test    esi, esi
.text:0041177C		       jnz     loc_411501
.text:00411782
.text:00411782 loc_411782:			       ; CODE XREF: _memcmp+736j
.text:00411782		       movzx   esi, byte ptr [eax-0Ah]
.text:00411786		       movzx   edx, byte ptr [ecx-0Ah]
.text:0041178A		       sub     esi, edx
.text:0041178C		       jz      short loc_4117A3
.text:0041178E		       xor     edx, edx
.text:00411790		       test    esi, esi
.text:00411792		       setnle  dl
.text:00411795		       lea     edx, [edx+edx-1]
.text:00411799		       mov     esi, edx
.text:0041179B		       test    esi, esi
.text:0041179D		       jnz     loc_411501
.text:004117A3
.text:004117A3 loc_4117A3:			       ; CODE XREF: _memcmp+757j
.text:004117A3		       movzx   esi, byte ptr [eax-9]
.text:004117A7		       movzx   edx, byte ptr [ecx-9]
.text:004117AB		       sub     esi, edx
.text:004117AD		       jz      short loc_4117C0
.text:004117AF		       xor     edx, edx
.text:004117B1		       test    esi, esi
.text:004117B3		       setnle  dl
.text:004117B6		       lea     edx, [edx+edx-1]
.text:004117BA		       mov     esi, edx
.text:004117BC		       jmp     short loc_4117C0
.text:004117BE ; ---------------------------------------------------------------------------
.text:004117BE
.text:004117BE loc_4117BE:			       ; CODE XREF: _memcmp+709j
.text:004117BE		       xor     esi, esi
.text:004117C0
.text:004117C0 loc_4117C0:			       ; CODE XREF: _memcmp+778j
.text:004117C0					       ; _memcmp+787j
.text:004117C0		       test    esi, esi
.text:004117C2		       jnz     loc_411501
.text:004117C8
.text:004117C8 $LN122_0:			       ; CODE XREF: _memcmp+4C5j
.text:004117C8					       ; DATA XREF: _memcmp:off_412635o
.text:004117C8		       mov     edx, [eax-8]    ; jumptable 004114FA case 8
.text:004117CB		       cmp     edx, [ecx-8]
.text:004117CE		       jz      short loc_41184D
.text:004117D0		       movzx   esi, dl
.text:004117D3		       movzx   edx, byte ptr [ecx-8]
.text:004117D7		       sub     esi, edx
.text:004117D9		       jz      short loc_4117F0
.text:004117DB		       xor     edx, edx
.text:004117DD		       test    esi, esi
.text:004117DF		       setnle  dl
.text:004117E2		       lea     edx, [edx+edx-1]
.text:004117E6		       mov     esi, edx
.text:004117E8		       test    esi, esi
.text:004117EA		       jnz     loc_411501
.text:004117F0
.text:004117F0 loc_4117F0:			       ; CODE XREF: _memcmp+7A4j
.text:004117F0		       movzx   esi, byte ptr [eax-7]
.text:004117F4		       movzx   edx, byte ptr [ecx-7]
.text:004117F8		       sub     esi, edx
.text:004117FA		       jz      short loc_411811
.text:004117FC		       xor     edx, edx
.text:004117FE		       test    esi, esi
.text:00411800		       setnle  dl
.text:00411803		       lea     edx, [edx+edx-1]
.text:00411807		       mov     esi, edx
.text:00411809		       test    esi, esi
.text:0041180B		       jnz     loc_411501
.text:00411811
.text:00411811 loc_411811:			       ; CODE XREF: _memcmp+7C5j
.text:00411811		       movzx   esi, byte ptr [eax-6]
.text:00411815		       movzx   edx, byte ptr [ecx-6]
.text:00411819		       sub     esi, edx
.text:0041181B		       jz      short loc_411832
.text:0041181D		       xor     edx, edx
.text:0041181F		       test    esi, esi
.text:00411821		       setnle  dl
.text:00411824		       lea     edx, [edx+edx-1]
.text:00411828		       mov     esi, edx
.text:0041182A		       test    esi, esi
.text:0041182C		       jnz     loc_411501
.text:00411832
.text:00411832 loc_411832:			       ; CODE XREF: _memcmp+7E6j
.text:00411832		       movzx   esi, byte ptr [eax-5]
.text:00411836		       movzx   edx, byte ptr [ecx-5]
.text:0041183A		       sub     esi, edx
.text:0041183C		       jz      short loc_41184F
.text:0041183E		       xor     edx, edx
.text:00411840		       test    esi, esi
.text:00411842		       setnle  dl
.text:00411845		       lea     edx, [edx+edx-1]
.text:00411849		       mov     esi, edx
.text:0041184B		       jmp     short loc_41184F
.text:0041184D ; ---------------------------------------------------------------------------
.text:0041184D
.text:0041184D loc_41184D:			       ; CODE XREF: _memcmp+799j
.text:0041184D		       xor     esi, esi
.text:0041184F
.text:0041184F loc_41184F:			       ; CODE XREF: _memcmp+807j
.text:0041184F					       ; _memcmp+816j
.text:0041184F		       test    esi, esi
.text:00411851		       jnz     loc_411501
.text:00411857
.text:00411857 $LN120:				       ; CODE XREF: _memcmp+4C5j
.text:00411857					       ; DATA XREF: _memcmp:off_412635o
.text:00411857		       mov     edx, [eax-4]    ; jumptable 004114FA case 4
.text:0041185A		       cmp     edx, [ecx-4]
.text:0041185D		       jz      short loc_4118CE
.text:0041185F		       movzx   esi, dl
.text:00411862		       movzx   edx, byte ptr [ecx-4]
.text:00411866		       sub     esi, edx
.text:00411868		       jz      short loc_411879
.text:0041186A		       xor     edx, edx
.text:0041186C		       test    esi, esi
.text:0041186E		       setnle  dl
.text:00411871		       lea     edx, [edx+edx-1]
.text:00411875		       test    edx, edx
.text:00411877		       jnz     short loc_4118AF
.text:00411879
.text:00411879 loc_411879:			       ; CODE XREF: _memcmp+833j
.text:00411879		       movzx   esi, byte ptr [eax-3]
.text:0041187D		       movzx   edx, byte ptr [ecx-3]
.text:00411881		       sub     esi, edx
.text:00411883		       jz      short loc_411894
.text:00411885		       xor     edx, edx
.text:00411887		       test    esi, esi
.text:00411889		       setnle  dl
.text:0041188C		       lea     edx, [edx+edx-1]
.text:00411890		       test    edx, edx
.text:00411892		       jnz     short loc_4118AF
.text:00411894
.text:00411894 loc_411894:			       ; CODE XREF: _memcmp+84Ej
.text:00411894		       movzx   esi, byte ptr [eax-2]
.text:00411898		       movzx   edx, byte ptr [ecx-2]
.text:0041189C		       sub     esi, edx
.text:0041189E		       jz      short loc_4118B3
.text:004118A0		       xor     edx, edx
.text:004118A2		       test    esi, esi
.text:004118A4		       setnle  dl
.text:004118A7		       lea     edx, [edx+edx-1]
.text:004118AB		       test    edx, edx
.text:004118AD		       jz      short loc_4118B3
.text:004118AF
.text:004118AF loc_4118AF:			       ; CODE XREF: _memcmp+842j
.text:004118AF					       ; _memcmp+85Dj
.text:004118AF		       mov     eax, edx
.text:004118B1		       jmp     short loc_4118D0
.text:004118B3 ; ---------------------------------------------------------------------------
.text:004118B3
.text:004118B3 loc_4118B3:			       ; CODE XREF: _memcmp+869j
.text:004118B3					       ; _memcmp+878j
.text:004118B3		       movzx   eax, byte ptr [eax-1]
.text:004118B7		       movzx   ecx, byte ptr [ecx-1]
.text:004118BB		       sub     eax, ecx
.text:004118BD		       jz      short loc_4118D0
.text:004118BF		       xor     ecx, ecx
.text:004118C1		       test    eax, eax
.text:004118C3		       setnle  cl
.text:004118C6		       lea     ecx, [ecx+ecx-1]
.text:004118CA		       mov     eax, ecx
.text:004118CC		       jmp     short loc_4118D0
.text:004118CE ; ---------------------------------------------------------------------------
.text:004118CE
.text:004118CE loc_4118CE:			       ; CODE XREF: _memcmp+828j
.text:004118CE		       xor     eax, eax
.text:004118D0
.text:004118D0 loc_4118D0:			       ; CODE XREF: _memcmp+87Cj
.text:004118D0					       ; _memcmp+888j ...
.text:004118D0		       test    eax, eax
.text:004118D2		       jnz     short loc_4118D6
.text:004118D4
.text:004118D4 $LN132:				       ; CODE XREF: _memcmp+4BFj
.text:004118D4					       ; _memcmp+4C5j ...
.text:004118D4		       xor     eax, eax	       ; default
.text:004118D4					       ; jumptable 004114FA case 0
.text:004118D6
.text:004118D6 loc_4118D6:			       ; CODE XREF: _memcmp+4CEj
.text:004118D6					       ; _memcmp+89Dj ...
.text:004118D6		       pop     ebx
.text:004118D7		       jmp     loc_41262F
.text:004118DC ; ---------------------------------------------------------------------------
.text:004118DC
.text:004118DC $LN116_0:			       ; CODE XREF: _memcmp+4C5j
.text:004118DC					       ; DATA XREF: _memcmp:off_412635o
.text:004118DC		       mov     edx, [eax-1Dh]  ; jumptable 004114FA case 29
.text:004118DF		       cmp     edx, [ecx-1Dh]
.text:004118E2		       jz      short loc_411961
.text:004118E4		       movzx   esi, dl
.text:004118E7		       movzx   edx, byte ptr [ecx-1Dh]
.text:004118EB		       sub     esi, edx
.text:004118ED		       jz      short loc_411904
.text:004118EF		       xor     edx, edx
.text:004118F1		       test    esi, esi
.text:004118F3		       setnle  dl
.text:004118F6		       lea     edx, [edx+edx-1]
.text:004118FA		       mov     esi, edx
.text:004118FC		       test    esi, esi
.text:004118FE		       jnz     loc_411501
.text:00411904
.text:00411904 loc_411904:			       ; CODE XREF: _memcmp+8B8j
.text:00411904		       movzx   esi, byte ptr [eax-1Ch]
.text:00411908		       movzx   edx, byte ptr [ecx-1Ch]
.text:0041190C		       sub     esi, edx
.text:0041190E		       jz      short loc_411925
.text:00411910		       xor     edx, edx
.text:00411912		       test    esi, esi
.text:00411914		       setnle  dl
.text:00411917		       lea     edx, [edx+edx-1]
.text:0041191B		       mov     esi, edx
.text:0041191D		       test    esi, esi
.text:0041191F		       jnz     loc_411501
.text:00411925
.text:00411925 loc_411925:			       ; CODE XREF: _memcmp+8D9j
.text:00411925		       movzx   esi, byte ptr [eax-1Bh]
.text:00411929		       movzx   edx, byte ptr [ecx-1Bh]
.text:0041192D		       sub     esi, edx
.text:0041192F		       jz      short loc_411946
.text:00411931		       xor     edx, edx
.text:00411933		       test    esi, esi
.text:00411935		       setnle  dl
.text:00411938		       lea     edx, [edx+edx-1]
.text:0041193C		       mov     esi, edx
.text:0041193E		       test    esi, esi
.text:00411940		       jnz     loc_411501
.text:00411946
.text:00411946 loc_411946:			       ; CODE XREF: _memcmp+8FAj
.text:00411946		       movzx   esi, byte ptr [eax-1Ah]
.text:0041194A		       movzx   edx, byte ptr [ecx-1Ah]
.text:0041194E		       sub     esi, edx
.text:00411950		       jz      short loc_411963
.text:00411952		       xor     edx, edx
.text:00411954		       test    esi, esi
.text:00411956		       setnle  dl
.text:00411959		       lea     edx, [edx+edx-1]
.text:0041195D		       mov     esi, edx
.text:0041195F		       jmp     short loc_411963
.text:00411961 ; ---------------------------------------------------------------------------
.text:00411961
.text:00411961 loc_411961:			       ; CODE XREF: _memcmp+8ADj
.text:00411961		       xor     esi, esi
.text:00411963
.text:00411963 loc_411963:			       ; CODE XREF: _memcmp+91Bj
.text:00411963					       ; _memcmp+92Aj
.text:00411963		       test    esi, esi
.text:00411965		       jnz     loc_411501
.text:0041196B
.text:0041196B $LN115:				       ; CODE XREF: _memcmp+4C5j
.text:0041196B					       ; DATA XREF: _memcmp:off_412635o
.text:0041196B		       mov     edx, [eax-19h]  ; jumptable 004114FA case 25
.text:0041196E		       cmp     edx, [ecx-19h]
.text:00411971		       jz      short loc_4119F0
.text:00411973		       movzx   esi, dl
.text:00411976		       movzx   edx, byte ptr [ecx-19h]
.text:0041197A		       sub     esi, edx
.text:0041197C		       jz      short loc_411993
.text:0041197E		       xor     edx, edx
.text:00411980		       test    esi, esi
.text:00411982		       setnle  dl
.text:00411985		       lea     edx, [edx+edx-1]
.text:00411989		       mov     esi, edx
.text:0041198B		       test    esi, esi
.text:0041198D		       jnz     loc_411501
.text:00411993
.text:00411993 loc_411993:			       ; CODE XREF: _memcmp+947j
.text:00411993		       movzx   esi, byte ptr [eax-18h]
.text:00411997		       movzx   edx, byte ptr [ecx-18h]
.text:0041199B		       sub     esi, edx
.text:0041199D		       jz      short loc_4119B4
.text:0041199F		       xor     edx, edx
.text:004119A1		       test    esi, esi
.text:004119A3		       setnle  dl
.text:004119A6		       lea     edx, [edx+edx-1]
.text:004119AA		       mov     esi, edx
.text:004119AC		       test    esi, esi
.text:004119AE		       jnz     loc_411501
.text:004119B4
.text:004119B4 loc_4119B4:			       ; CODE XREF: _memcmp+968j
.text:004119B4		       movzx   esi, byte ptr [eax-17h]
.text:004119B8		       movzx   edx, byte ptr [ecx-17h]
.text:004119BC		       sub     esi, edx
.text:004119BE		       jz      short loc_4119D5
.text:004119C0		       xor     edx, edx
.text:004119C2		       test    esi, esi
.text:004119C4		       setnle  dl
.text:004119C7		       lea     edx, [edx+edx-1]
.text:004119CB		       mov     esi, edx
.text:004119CD		       test    esi, esi
.text:004119CF		       jnz     loc_411501
.text:004119D5
.text:004119D5 loc_4119D5:			       ; CODE XREF: _memcmp+989j
.text:004119D5		       movzx   esi, byte ptr [eax-16h]
.text:004119D9		       movzx   edx, byte ptr [ecx-16h]
.text:004119DD		       sub     esi, edx
.text:004119DF		       jz      short loc_4119F2
.text:004119E1		       xor     edx, edx
.text:004119E3		       test    esi, esi
.text:004119E5		       setnle  dl
.text:004119E8		       lea     edx, [edx+edx-1]
.text:004119EC		       mov     esi, edx
.text:004119EE		       jmp     short loc_4119F2
.text:004119F0 ; ---------------------------------------------------------------------------
.text:004119F0
.text:004119F0 loc_4119F0:			       ; CODE XREF: _memcmp+93Cj
.text:004119F0		       xor     esi, esi
.text:004119F2
.text:004119F2 loc_4119F2:			       ; CODE XREF: _memcmp+9AAj
.text:004119F2					       ; _memcmp+9B9j
.text:004119F2		       test    esi, esi
.text:004119F4		       jnz     loc_411501
.text:004119FA
.text:004119FA $LN113_0:			       ; CODE XREF: _memcmp+4C5j
.text:004119FA					       ; DATA XREF: _memcmp:off_412635o
.text:004119FA		       mov     edx, [eax-15h]  ; jumptable 004114FA case 21
.text:004119FD		       cmp     edx, [ecx-15h]
.text:00411A00		       jz      short loc_411A7F
.text:00411A02		       movzx   esi, dl
.text:00411A05		       movzx   edx, byte ptr [ecx-15h]
.text:00411A09		       sub     esi, edx
.text:00411A0B		       jz      short loc_411A22
.text:00411A0D		       xor     edx, edx
.text:00411A0F		       test    esi, esi
.text:00411A11		       setnle  dl
.text:00411A14		       lea     edx, [edx+edx-1]
.text:00411A18		       mov     esi, edx
.text:00411A1A		       test    esi, esi
.text:00411A1C		       jnz     loc_411501
.text:00411A22
.text:00411A22 loc_411A22:			       ; CODE XREF: _memcmp+9D6j
.text:00411A22		       movzx   esi, byte ptr [eax-14h]
.text:00411A26		       movzx   edx, byte ptr [ecx-14h]
.text:00411A2A		       sub     esi, edx
.text:00411A2C		       jz      short loc_411A43
.text:00411A2E		       xor     edx, edx
.text:00411A30		       test    esi, esi
.text:00411A32		       setnle  dl
.text:00411A35		       lea     edx, [edx+edx-1]
.text:00411A39		       mov     esi, edx
.text:00411A3B		       test    esi, esi
.text:00411A3D		       jnz     loc_411501
.text:00411A43
.text:00411A43 loc_411A43:			       ; CODE XREF: _memcmp+9F7j
.text:00411A43		       movzx   esi, byte ptr [eax-13h]
.text:00411A47		       movzx   edx, byte ptr [ecx-13h]
.text:00411A4B		       sub     esi, edx
.text:00411A4D		       jz      short loc_411A64
.text:00411A4F		       xor     edx, edx
.text:00411A51		       test    esi, esi
.text:00411A53		       setnle  dl
.text:00411A56		       lea     edx, [edx+edx-1]
.text:00411A5A		       mov     esi, edx
.text:00411A5C		       test    esi, esi
.text:00411A5E		       jnz     loc_411501
.text:00411A64
.text:00411A64 loc_411A64:			       ; CODE XREF: _memcmp+A18j
.text:00411A64		       movzx   esi, byte ptr [eax-12h]
.text:00411A68		       movzx   edx, byte ptr [ecx-12h]
.text:00411A6C		       sub     esi, edx
.text:00411A6E		       jz      short loc_411A81
.text:00411A70		       xor     edx, edx
.text:00411A72		       test    esi, esi
.text:00411A74		       setnle  dl
.text:00411A77		       lea     edx, [edx+edx-1]
.text:00411A7B		       mov     esi, edx
.text:00411A7D		       jmp     short loc_411A81
.text:00411A7F ; ---------------------------------------------------------------------------
.text:00411A7F
.text:00411A7F loc_411A7F:			       ; CODE XREF: _memcmp+9CBj
.text:00411A7F		       xor     esi, esi
.text:00411A81
.text:00411A81 loc_411A81:			       ; CODE XREF: _memcmp+A39j
.text:00411A81					       ; _memcmp+A48j
.text:00411A81		       test    esi, esi
.text:00411A83		       jnz     loc_411501
.text:00411A89
.text:00411A89 $LN111:				       ; CODE XREF: _memcmp+4C5j
.text:00411A89					       ; DATA XREF: _memcmp:off_412635o
.text:00411A89		       mov     edx, [eax-11h]  ; jumptable 004114FA case 17
.text:00411A8C		       cmp     edx, [ecx-11h]
.text:00411A8F		       jz      short loc_411B0E
.text:00411A91		       movzx   esi, dl
.text:00411A94		       movzx   edx, byte ptr [ecx-11h]
.text:00411A98		       sub     esi, edx
.text:00411A9A		       jz      short loc_411AB1
.text:00411A9C		       xor     edx, edx
.text:00411A9E		       test    esi, esi
.text:00411AA0		       setnle  dl
.text:00411AA3		       lea     edx, [edx+edx-1]
.text:00411AA7		       mov     esi, edx
.text:00411AA9		       test    esi, esi
.text:00411AAB		       jnz     loc_411501
.text:00411AB1
.text:00411AB1 loc_411AB1:			       ; CODE XREF: _memcmp+A65j
.text:00411AB1		       movzx   esi, byte ptr [eax-10h]
.text:00411AB5		       movzx   edx, byte ptr [ecx-10h]
.text:00411AB9		       sub     esi, edx
.text:00411ABB		       jz      short loc_411AD2
.text:00411ABD		       xor     edx, edx
.text:00411ABF		       test    esi, esi
.text:00411AC1		       setnle  dl
.text:00411AC4		       lea     edx, [edx+edx-1]
.text:00411AC8		       mov     esi, edx
.text:00411ACA		       test    esi, esi
.text:00411ACC		       jnz     loc_411501
.text:00411AD2
.text:00411AD2 loc_411AD2:			       ; CODE XREF: _memcmp+A86j
.text:00411AD2		       movzx   esi, byte ptr [eax-0Fh]
.text:00411AD6		       movzx   edx, byte ptr [ecx-0Fh]
.text:00411ADA		       sub     esi, edx
.text:00411ADC		       jz      short loc_411AF3
.text:00411ADE		       xor     edx, edx
.text:00411AE0		       test    esi, esi
.text:00411AE2		       setnle  dl
.text:00411AE5		       lea     edx, [edx+edx-1]
.text:00411AE9		       mov     esi, edx
.text:00411AEB		       test    esi, esi
.text:00411AED		       jnz     loc_411501
.text:00411AF3
.text:00411AF3 loc_411AF3:			       ; CODE XREF: _memcmp+AA7j
.text:00411AF3		       movzx   esi, byte ptr [eax-0Eh]
.text:00411AF7		       movzx   edx, byte ptr [ecx-0Eh]
.text:00411AFB		       sub     esi, edx
.text:00411AFD		       jz      short loc_411B10
.text:00411AFF		       xor     edx, edx
.text:00411B01		       test    esi, esi
.text:00411B03		       setnle  dl
.text:00411B06		       lea     edx, [edx+edx-1]
.text:00411B0A		       mov     esi, edx
.text:00411B0C		       jmp     short loc_411B10
.text:00411B0E ; ---------------------------------------------------------------------------
.text:00411B0E
.text:00411B0E loc_411B0E:			       ; CODE XREF: _memcmp+A5Aj
.text:00411B0E		       xor     esi, esi
.text:00411B10
.text:00411B10 loc_411B10:			       ; CODE XREF: _memcmp+AC8j
.text:00411B10					       ; _memcmp+AD7j
.text:00411B10		       test    esi, esi
.text:00411B12		       jnz     loc_411501
.text:00411B18
.text:00411B18 $LN109:				       ; CODE XREF: _memcmp+4C5j
.text:00411B18					       ; DATA XREF: _memcmp:off_412635o
.text:00411B18		       mov     edx, [eax-0Dh]  ; jumptable 004114FA case 13
.text:00411B1B		       cmp     edx, [ecx-0Dh]
.text:00411B1E		       jz      short loc_411B9D
.text:00411B20		       movzx   esi, dl
.text:00411B23		       movzx   edx, byte ptr [ecx-0Dh]
.text:00411B27		       sub     esi, edx
.text:00411B29		       jz      short loc_411B40
.text:00411B2B		       xor     edx, edx
.text:00411B2D		       test    esi, esi
.text:00411B2F		       setnle  dl
.text:00411B32		       lea     edx, [edx+edx-1]
.text:00411B36		       mov     esi, edx
.text:00411B38		       test    esi, esi
.text:00411B3A		       jnz     loc_411501
.text:00411B40
.text:00411B40 loc_411B40:			       ; CODE XREF: _memcmp+AF4j
.text:00411B40		       movzx   esi, byte ptr [eax-0Ch]
.text:00411B44		       movzx   edx, byte ptr [ecx-0Ch]
.text:00411B48		       sub     esi, edx
.text:00411B4A		       jz      short loc_411B61
.text:00411B4C		       xor     edx, edx
.text:00411B4E		       test    esi, esi
.text:00411B50		       setnle  dl
.text:00411B53		       lea     edx, [edx+edx-1]
.text:00411B57		       mov     esi, edx
.text:00411B59		       test    esi, esi
.text:00411B5B		       jnz     loc_411501
.text:00411B61
.text:00411B61 loc_411B61:			       ; CODE XREF: _memcmp+B15j
.text:00411B61		       movzx   esi, byte ptr [eax-0Bh]
.text:00411B65		       movzx   edx, byte ptr [ecx-0Bh]
.text:00411B69		       sub     esi, edx
.text:00411B6B		       jz      short loc_411B82
.text:00411B6D		       xor     edx, edx
.text:00411B6F		       test    esi, esi
.text:00411B71		       setnle  dl
.text:00411B74		       lea     edx, [edx+edx-1]
.text:00411B78		       mov     esi, edx
.text:00411B7A		       test    esi, esi
.text:00411B7C		       jnz     loc_411501
.text:00411B82
.text:00411B82 loc_411B82:			       ; CODE XREF: _memcmp+B36j
.text:00411B82		       movzx   esi, byte ptr [eax-0Ah]
.text:00411B86		       movzx   edx, byte ptr [ecx-0Ah]
.text:00411B8A		       sub     esi, edx
.text:00411B8C		       jz      short loc_411B9F
.text:00411B8E		       xor     edx, edx
.text:00411B90		       test    esi, esi
.text:00411B92		       setnle  dl
.text:00411B95		       lea     edx, [edx+edx-1]
.text:00411B99		       mov     esi, edx
.text:00411B9B		       jmp     short loc_411B9F
.text:00411B9D ; ---------------------------------------------------------------------------
.text:00411B9D
.text:00411B9D loc_411B9D:			       ; CODE XREF: _memcmp+AE9j
.text:00411B9D		       xor     esi, esi
.text:00411B9F
.text:00411B9F loc_411B9F:			       ; CODE XREF: _memcmp+B57j
.text:00411B9F					       ; _memcmp+B66j
.text:00411B9F		       test    esi, esi
.text:00411BA1		       jnz     loc_411501
.text:00411BA7
.text:00411BA7 $LN107:				       ; CODE XREF: _memcmp+4C5j
.text:00411BA7					       ; DATA XREF: _memcmp:off_412635o
.text:00411BA7		       mov     edx, [eax-9]    ; jumptable 004114FA case 9
.text:00411BAA		       cmp     edx, [ecx-9]
.text:00411BAD		       jz      short loc_411C2D
.text:00411BAF		       movzx   edx, byte ptr [ecx-9]
.text:00411BB3		       movzx   esi, byte ptr [eax-9]
.text:00411BB7		       sub     esi, edx
.text:00411BB9		       jz      short loc_411BD0
.text:00411BBB		       xor     edx, edx
.text:00411BBD		       test    esi, esi
.text:00411BBF		       setnle  dl
.text:00411BC2		       lea     edx, [edx+edx-1]
.text:00411BC6		       mov     esi, edx
.text:00411BC8		       test    esi, esi
.text:00411BCA		       jnz     loc_411501
.text:00411BD0
.text:00411BD0 loc_411BD0:			       ; CODE XREF: _memcmp+B84j
.text:00411BD0		       movzx   esi, byte ptr [eax-8]
.text:00411BD4		       movzx   edx, byte ptr [ecx-8]
.text:00411BD8		       sub     esi, edx
.text:00411BDA		       jz      short loc_411BF1
.text:00411BDC		       xor     edx, edx
.text:00411BDE		       test    esi, esi
.text:00411BE0		       setnle  dl
.text:00411BE3		       lea     edx, [edx+edx-1]
.text:00411BE7		       mov     esi, edx
.text:00411BE9		       test    esi, esi
.text:00411BEB		       jnz     loc_411501
.text:00411BF1
.text:00411BF1 loc_411BF1:			       ; CODE XREF: _memcmp+BA5j
.text:00411BF1		       movzx   esi, byte ptr [eax-7]
.text:00411BF5		       movzx   edx, byte ptr [ecx-7]
.text:00411BF9		       sub     esi, edx
.text:00411BFB		       jz      short loc_411C12
.text:00411BFD		       xor     edx, edx
.text:00411BFF		       test    esi, esi
.text:00411C01		       setnle  dl
.text:00411C04		       lea     edx, [edx+edx-1]
.text:00411C08		       mov     esi, edx
.text:00411C0A		       test    esi, esi
.text:00411C0C		       jnz     loc_411501
.text:00411C12
.text:00411C12 loc_411C12:			       ; CODE XREF: _memcmp+BC6j
.text:00411C12		       movzx   esi, byte ptr [eax-6]
.text:00411C16		       movzx   edx, byte ptr [ecx-6]
.text:00411C1A		       sub     esi, edx
.text:00411C1C		       jz      short loc_411C2F
.text:00411C1E		       xor     edx, edx
.text:00411C20		       test    esi, esi
.text:00411C22		       setnle  dl
.text:00411C25		       lea     edx, [edx+edx-1]
.text:00411C29		       mov     esi, edx
.text:00411C2B		       jmp     short loc_411C2F
.text:00411C2D ; ---------------------------------------------------------------------------
.text:00411C2D
.text:00411C2D loc_411C2D:			       ; CODE XREF: _memcmp+B78j
.text:00411C2D		       xor     esi, esi
.text:00411C2F
.text:00411C2F loc_411C2F:			       ; CODE XREF: _memcmp+BE7j
.text:00411C2F					       ; _memcmp+BF6j
.text:00411C2F		       test    esi, esi
.text:00411C31		       jnz     loc_411501
.text:00411C37
.text:00411C37 $LN105:				       ; CODE XREF: _memcmp+4C5j
.text:00411C37					       ; DATA XREF: _memcmp:off_412635o
.text:00411C37		       mov     edx, [eax-5]    ; jumptable 004114FA case 5
.text:00411C3A		       cmp     edx, [ecx-5]
.text:00411C3D		       jz      short loc_411CBC
.text:00411C3F		       movzx   esi, dl
.text:00411C42		       movzx   edx, byte ptr [ecx-5]
.text:00411C46		       sub     esi, edx
.text:00411C48		       jz      short loc_411C5F
.text:00411C4A		       xor     edx, edx
.text:00411C4C		       test    esi, esi
.text:00411C4E		       setnle  dl
.text:00411C51		       lea     edx, [edx+edx-1]
.text:00411C55		       mov     esi, edx
.text:00411C57		       test    esi, esi
.text:00411C59		       jnz     loc_411501
.text:00411C5F
.text:00411C5F loc_411C5F:			       ; CODE XREF: _memcmp+C13j
.text:00411C5F		       movzx   esi, byte ptr [eax-4]
.text:00411C63		       movzx   edx, byte ptr [ecx-4]
.text:00411C67		       sub     esi, edx
.text:00411C69		       jz      short loc_411C80
.text:00411C6B		       xor     edx, edx
.text:00411C6D		       test    esi, esi
.text:00411C6F		       setnle  dl
.text:00411C72		       lea     edx, [edx+edx-1]
.text:00411C76		       mov     esi, edx
.text:00411C78		       test    esi, esi
.text:00411C7A		       jnz     loc_411501
.text:00411C80
.text:00411C80 loc_411C80:			       ; CODE XREF: _memcmp+C34j
.text:00411C80		       movzx   esi, byte ptr [eax-3]
.text:00411C84		       movzx   edx, byte ptr [ecx-3]
.text:00411C88		       sub     esi, edx
.text:00411C8A		       jz      short loc_411CA1
.text:00411C8C		       xor     edx, edx
.text:00411C8E		       test    esi, esi
.text:00411C90		       setnle  dl
.text:00411C93		       lea     edx, [edx+edx-1]
.text:00411C97		       mov     esi, edx
.text:00411C99		       test    esi, esi
.text:00411C9B		       jnz     loc_411501
.text:00411CA1
.text:00411CA1 loc_411CA1:			       ; CODE XREF: _memcmp+C55j
.text:00411CA1		       movzx   esi, byte ptr [eax-2]
.text:00411CA5		       movzx   edx, byte ptr [ecx-2]
.text:00411CA9		       sub     esi, edx
.text:00411CAB		       jz      short loc_411CBE
.text:00411CAD		       xor     edx, edx
.text:00411CAF		       test    esi, esi
.text:00411CB1		       setnle  dl
.text:00411CB4		       lea     edx, [edx+edx-1]
.text:00411CB8		       mov     esi, edx
.text:00411CBA		       jmp     short loc_411CBE
.text:00411CBC ; ---------------------------------------------------------------------------
.text:00411CBC
.text:00411CBC loc_411CBC:			       ; CODE XREF: _memcmp+C08j
.text:00411CBC		       xor     esi, esi
.text:00411CBE
.text:00411CBE loc_411CBE:			       ; CODE XREF: _memcmp+C76j
.text:00411CBE					       ; _memcmp+C85j
.text:00411CBE		       test    esi, esi
.text:00411CC0		       jnz     loc_411501
.text:00411CC6
.text:00411CC6 $LN103:				       ; CODE XREF: _memcmp+4C5j
.text:00411CC6					       ; _memcmp+10B5j	...
.text:00411CC6		       movzx   ecx, byte ptr [ecx-1] ; jumptable 004114FA case 1
.text:00411CCA		       movzx   eax, byte ptr [eax-1]
.text:00411CCE		       sub     eax, ecx
.text:00411CD0		       jz      loc_4118D6
.text:00411CD6		       xor     ecx, ecx
.text:00411CD8		       test    eax, eax
.text:00411CDA		       setnle  cl
.text:00411CDD		       lea     ecx, [ecx+ecx-1]
.text:00411CE1		       mov     eax, ecx
.text:00411CE3		       jmp     loc_4118D6
.text:00411CE8 ; ---------------------------------------------------------------------------
.text:00411CE8
.text:00411CE8 $LN101:				       ; CODE XREF: _memcmp+4C5j
.text:00411CE8					       ; DATA XREF: _memcmp:off_412635o
.text:00411CE8		       mov     edx, [eax-1Eh]  ; jumptable 004114FA case 30
.text:00411CEB		       cmp     edx, [ecx-1Eh]
.text:00411CEE		       jz      short loc_411D6D
.text:00411CF0		       movzx   esi, dl
.text:00411CF3		       movzx   edx, byte ptr [ecx-1Eh]
.text:00411CF7		       sub     esi, edx
.text:00411CF9		       jz      short loc_411D10
.text:00411CFB		       xor     edx, edx
.text:00411CFD		       test    esi, esi
.text:00411CFF		       setnle  dl
.text:00411D02		       lea     edx, [edx+edx-1]
.text:00411D06		       mov     esi, edx
.text:00411D08		       test    esi, esi
.text:00411D0A		       jnz     loc_411501
.text:00411D10
.text:00411D10 loc_411D10:			       ; CODE XREF: _memcmp+CC4j
.text:00411D10		       movzx   esi, byte ptr [eax-1Dh]
.text:00411D14		       movzx   edx, byte ptr [ecx-1Dh]
.text:00411D18		       sub     esi, edx
.text:00411D1A		       jz      short loc_411D31
.text:00411D1C		       xor     edx, edx
.text:00411D1E		       test    esi, esi
.text:00411D20		       setnle  dl
.text:00411D23		       lea     edx, [edx+edx-1]
.text:00411D27		       mov     esi, edx
.text:00411D29		       test    esi, esi
.text:00411D2B		       jnz     loc_411501
.text:00411D31
.text:00411D31 loc_411D31:			       ; CODE XREF: _memcmp+CE5j
.text:00411D31		       movzx   esi, byte ptr [eax-1Ch]
.text:00411D35		       movzx   edx, byte ptr [ecx-1Ch]
.text:00411D39		       sub     esi, edx
.text:00411D3B		       jz      short loc_411D52
.text:00411D3D		       xor     edx, edx
.text:00411D3F		       test    esi, esi
.text:00411D41		       setnle  dl
.text:00411D44		       lea     edx, [edx+edx-1]
.text:00411D48		       mov     esi, edx
.text:00411D4A		       test    esi, esi
.text:00411D4C		       jnz     loc_411501
.text:00411D52
.text:00411D52 loc_411D52:			       ; CODE XREF: _memcmp+D06j
.text:00411D52		       movzx   esi, byte ptr [eax-1Bh]
.text:00411D56		       movzx   edx, byte ptr [ecx-1Bh]
.text:00411D5A		       sub     esi, edx
.text:00411D5C		       jz      short loc_411D6F
.text:00411D5E		       xor     edx, edx
.text:00411D60		       test    esi, esi
.text:00411D62		       setnle  dl
.text:00411D65		       lea     edx, [edx+edx-1]
.text:00411D69		       mov     esi, edx
.text:00411D6B		       jmp     short loc_411D6F
.text:00411D6D ; ---------------------------------------------------------------------------
.text:00411D6D
.text:00411D6D loc_411D6D:			       ; CODE XREF: _memcmp+CB9j
.text:00411D6D		       xor     esi, esi
.text:00411D6F
.text:00411D6F loc_411D6F:			       ; CODE XREF: _memcmp+D27j
.text:00411D6F					       ; _memcmp+D36j
.text:00411D6F		       test    esi, esi
.text:00411D71		       jnz     loc_411501
.text:00411D77
.text:00411D77 $LN100:				       ; CODE XREF: _memcmp+4C5j
.text:00411D77					       ; DATA XREF: _memcmp:off_412635o
.text:00411D77		       mov     edx, [eax-1Ah]  ; jumptable 004114FA case 26
.text:00411D7A		       cmp     edx, [ecx-1Ah]
.text:00411D7D		       jz      short loc_411DFC
.text:00411D7F		       movzx   esi, dl
.text:00411D82		       movzx   edx, byte ptr [ecx-1Ah]
.text:00411D86		       sub     esi, edx
.text:00411D88		       jz      short loc_411D9F
.text:00411D8A		       xor     edx, edx
.text:00411D8C		       test    esi, esi
.text:00411D8E		       setnle  dl
.text:00411D91		       lea     edx, [edx+edx-1]
.text:00411D95		       mov     esi, edx
.text:00411D97		       test    esi, esi
.text:00411D99		       jnz     loc_411501
.text:00411D9F
.text:00411D9F loc_411D9F:			       ; CODE XREF: _memcmp+D53j
.text:00411D9F		       movzx   esi, byte ptr [eax-19h]
.text:00411DA3		       movzx   edx, byte ptr [ecx-19h]
.text:00411DA7		       sub     esi, edx
.text:00411DA9		       jz      short loc_411DC0
.text:00411DAB		       xor     edx, edx
.text:00411DAD		       test    esi, esi
.text:00411DAF		       setnle  dl
.text:00411DB2		       lea     edx, [edx+edx-1]
.text:00411DB6		       mov     esi, edx
.text:00411DB8		       test    esi, esi
.text:00411DBA		       jnz     loc_411501
.text:00411DC0
.text:00411DC0 loc_411DC0:			       ; CODE XREF: _memcmp+D74j
.text:00411DC0		       movzx   esi, byte ptr [eax-18h]
.text:00411DC4		       movzx   edx, byte ptr [ecx-18h]
.text:00411DC8		       sub     esi, edx
.text:00411DCA		       jz      short loc_411DE1
.text:00411DCC		       xor     edx, edx
.text:00411DCE		       test    esi, esi
.text:00411DD0		       setnle  dl
.text:00411DD3		       lea     edx, [edx+edx-1]
.text:00411DD7		       mov     esi, edx
.text:00411DD9		       test    esi, esi
.text:00411DDB		       jnz     loc_411501
.text:00411DE1
.text:00411DE1 loc_411DE1:			       ; CODE XREF: _memcmp+D95j
.text:00411DE1		       movzx   esi, byte ptr [eax-17h]
.text:00411DE5		       movzx   edx, byte ptr [ecx-17h]
.text:00411DE9		       sub     esi, edx
.text:00411DEB		       jz      short loc_411DFE
.text:00411DED		       xor     edx, edx
.text:00411DEF		       test    esi, esi
.text:00411DF1		       setnle  dl
.text:00411DF4		       lea     edx, [edx+edx-1]
.text:00411DF8		       mov     esi, edx
.text:00411DFA		       jmp     short loc_411DFE
.text:00411DFC ; ---------------------------------------------------------------------------
.text:00411DFC
.text:00411DFC loc_411DFC:			       ; CODE XREF: _memcmp+D48j
.text:00411DFC		       xor     esi, esi
.text:00411DFE
.text:00411DFE loc_411DFE:			       ; CODE XREF: _memcmp+DB6j
.text:00411DFE					       ; _memcmp+DC5j
.text:00411DFE		       test    esi, esi
.text:00411E00		       jnz     loc_411501
.text:00411E06
.text:00411E06 $LN98:				       ; CODE XREF: _memcmp+4C5j
.text:00411E06					       ; DATA XREF: _memcmp:off_412635o
.text:00411E06		       mov     edx, [eax-16h]  ; jumptable 004114FA case 22
.text:00411E09		       cmp     edx, [ecx-16h]
.text:00411E0C		       jz      short loc_411E8B
.text:00411E0E		       movzx   esi, dl
.text:00411E11		       movzx   edx, byte ptr [ecx-16h]
.text:00411E15		       sub     esi, edx
.text:00411E17		       jz      short loc_411E2E
.text:00411E19		       xor     edx, edx
.text:00411E1B		       test    esi, esi
.text:00411E1D		       setnle  dl
.text:00411E20		       lea     edx, [edx+edx-1]
.text:00411E24		       mov     esi, edx
.text:00411E26		       test    esi, esi
.text:00411E28		       jnz     loc_411501
.text:00411E2E
.text:00411E2E loc_411E2E:			       ; CODE XREF: _memcmp+DE2j
.text:00411E2E		       movzx   esi, byte ptr [eax-15h]
.text:00411E32		       movzx   edx, byte ptr [ecx-15h]
.text:00411E36		       sub     esi, edx
.text:00411E38		       jz      short loc_411E4F
.text:00411E3A		       xor     edx, edx
.text:00411E3C		       test    esi, esi
.text:00411E3E		       setnle  dl
.text:00411E41		       lea     edx, [edx+edx-1]
.text:00411E45		       mov     esi, edx
.text:00411E47		       test    esi, esi
.text:00411E49		       jnz     loc_411501
.text:00411E4F
.text:00411E4F loc_411E4F:			       ; CODE XREF: _memcmp+E03j
.text:00411E4F		       movzx   esi, byte ptr [eax-14h]
.text:00411E53		       movzx   edx, byte ptr [ecx-14h]
.text:00411E57		       sub     esi, edx
.text:00411E59		       jz      short loc_411E70
.text:00411E5B		       xor     edx, edx
.text:00411E5D		       test    esi, esi
.text:00411E5F		       setnle  dl
.text:00411E62		       lea     edx, [edx+edx-1]
.text:00411E66		       mov     esi, edx
.text:00411E68		       test    esi, esi
.text:00411E6A		       jnz     loc_411501
.text:00411E70
.text:00411E70 loc_411E70:			       ; CODE XREF: _memcmp+E24j
.text:00411E70		       movzx   esi, byte ptr [eax-13h]
.text:00411E74		       movzx   edx, byte ptr [ecx-13h]
.text:00411E78		       sub     esi, edx
.text:00411E7A		       jz      short loc_411E8D
.text:00411E7C		       xor     edx, edx
.text:00411E7E		       test    esi, esi
.text:00411E80		       setnle  dl
.text:00411E83		       lea     edx, [edx+edx-1]
.text:00411E87		       mov     esi, edx
.text:00411E89		       jmp     short loc_411E8D
.text:00411E8B ; ---------------------------------------------------------------------------
.text:00411E8B
.text:00411E8B loc_411E8B:			       ; CODE XREF: _memcmp+DD7j
.text:00411E8B		       xor     esi, esi
.text:00411E8D
.text:00411E8D loc_411E8D:			       ; CODE XREF: _memcmp+E45j
.text:00411E8D					       ; _memcmp+E54j
.text:00411E8D		       test    esi, esi
.text:00411E8F		       jnz     loc_411501
.text:00411E95
.text:00411E95 $LN96_0:				       ; CODE XREF: _memcmp+4C5j
.text:00411E95					       ; DATA XREF: _memcmp:off_412635o
.text:00411E95		       mov     edx, [eax-12h]  ; jumptable 004114FA case 18
.text:00411E98		       cmp     edx, [ecx-12h]
.text:00411E9B		       jz      short loc_411F1A
.text:00411E9D		       movzx   esi, dl
.text:00411EA0		       movzx   edx, byte ptr [ecx-12h]
.text:00411EA4		       sub     esi, edx
.text:00411EA6		       jz      short loc_411EBD
.text:00411EA8		       xor     edx, edx
.text:00411EAA		       test    esi, esi
.text:00411EAC		       setnle  dl
.text:00411EAF		       lea     edx, [edx+edx-1]
.text:00411EB3		       mov     esi, edx
.text:00411EB5		       test    esi, esi
.text:00411EB7		       jnz     loc_411501
.text:00411EBD
.text:00411EBD loc_411EBD:			       ; CODE XREF: _memcmp+E71j
.text:00411EBD		       movzx   esi, byte ptr [eax-11h]
.text:00411EC1		       movzx   edx, byte ptr [ecx-11h]
.text:00411EC5		       sub     esi, edx
.text:00411EC7		       jz      short loc_411EDE
.text:00411EC9		       xor     edx, edx
.text:00411ECB		       test    esi, esi
.text:00411ECD		       setnle  dl
.text:00411ED0		       lea     edx, [edx+edx-1]
.text:00411ED4		       mov     esi, edx
.text:00411ED6		       test    esi, esi
.text:00411ED8		       jnz     loc_411501
.text:00411EDE
.text:00411EDE loc_411EDE:			       ; CODE XREF: _memcmp+E92j
.text:00411EDE		       movzx   esi, byte ptr [eax-10h]
.text:00411EE2		       movzx   edx, byte ptr [ecx-10h]
.text:00411EE6		       sub     esi, edx
.text:00411EE8		       jz      short loc_411EFF
.text:00411EEA		       xor     edx, edx
.text:00411EEC		       test    esi, esi
.text:00411EEE		       setnle  dl
.text:00411EF1		       lea     edx, [edx+edx-1]
.text:00411EF5		       mov     esi, edx
.text:00411EF7		       test    esi, esi
.text:00411EF9		       jnz     loc_411501
.text:00411EFF
.text:00411EFF loc_411EFF:			       ; CODE XREF: _memcmp+EB3j
.text:00411EFF		       movzx   esi, byte ptr [eax-0Fh]
.text:00411F03		       movzx   edx, byte ptr [ecx-0Fh]
.text:00411F07		       sub     esi, edx
.text:00411F09		       jz      short loc_411F1C
.text:00411F0B		       xor     edx, edx
.text:00411F0D		       test    esi, esi
.text:00411F0F		       setnle  dl
.text:00411F12		       lea     edx, [edx+edx-1]
.text:00411F16		       mov     esi, edx
.text:00411F18		       jmp     short loc_411F1C
.text:00411F1A ; ---------------------------------------------------------------------------
.text:00411F1A
.text:00411F1A loc_411F1A:			       ; CODE XREF: _memcmp+E66j
.text:00411F1A		       xor     esi, esi
.text:00411F1C
.text:00411F1C loc_411F1C:			       ; CODE XREF: _memcmp+ED4j
.text:00411F1C					       ; _memcmp+EE3j
.text:00411F1C		       test    esi, esi
.text:00411F1E		       jnz     loc_411501
.text:00411F24
.text:00411F24 $LN94:				       ; CODE XREF: _memcmp+4C5j
.text:00411F24					       ; DATA XREF: _memcmp:off_412635o
.text:00411F24		       mov     edx, [eax-0Eh]  ; jumptable 004114FA case 14
.text:00411F27		       cmp     edx, [ecx-0Eh]
.text:00411F2A		       jz      short loc_411FA9
.text:00411F2C		       movzx   esi, dl
.text:00411F2F		       movzx   edx, byte ptr [ecx-0Eh]
.text:00411F33		       sub     esi, edx
.text:00411F35		       jz      short loc_411F4C
.text:00411F37		       xor     edx, edx
.text:00411F39		       test    esi, esi
.text:00411F3B		       setnle  dl
.text:00411F3E		       lea     edx, [edx+edx-1]
.text:00411F42		       mov     esi, edx
.text:00411F44		       test    esi, esi
.text:00411F46		       jnz     loc_411501
.text:00411F4C
.text:00411F4C loc_411F4C:			       ; CODE XREF: _memcmp+F00j
.text:00411F4C		       movzx   esi, byte ptr [eax-0Dh]
.text:00411F50		       movzx   edx, byte ptr [ecx-0Dh]
.text:00411F54		       sub     esi, edx
.text:00411F56		       jz      short loc_411F6D
.text:00411F58		       xor     edx, edx
.text:00411F5A		       test    esi, esi
.text:00411F5C		       setnle  dl
.text:00411F5F		       lea     edx, [edx+edx-1]
.text:00411F63		       mov     esi, edx
.text:00411F65		       test    esi, esi
.text:00411F67		       jnz     loc_411501
.text:00411F6D
.text:00411F6D loc_411F6D:			       ; CODE XREF: _memcmp+F21j
.text:00411F6D		       movzx   esi, byte ptr [eax-0Ch]
.text:00411F71		       movzx   edx, byte ptr [ecx-0Ch]
.text:00411F75		       sub     esi, edx
.text:00411F77		       jz      short loc_411F8E
.text:00411F79		       xor     edx, edx
.text:00411F7B		       test    esi, esi
.text:00411F7D		       setnle  dl
.text:00411F80		       lea     edx, [edx+edx-1]
.text:00411F84		       mov     esi, edx
.text:00411F86		       test    esi, esi
.text:00411F88		       jnz     loc_411501
.text:00411F8E
.text:00411F8E loc_411F8E:			       ; CODE XREF: _memcmp+F42j
.text:00411F8E		       movzx   esi, byte ptr [eax-0Bh]
.text:00411F92		       movzx   edx, byte ptr [ecx-0Bh]
.text:00411F96		       sub     esi, edx
.text:00411F98		       jz      short loc_411FAB
.text:00411F9A		       xor     edx, edx
.text:00411F9C		       test    esi, esi
.text:00411F9E		       setnle  dl
.text:00411FA1		       lea     edx, [edx+edx-1]
.text:00411FA5		       mov     esi, edx
.text:00411FA7		       jmp     short loc_411FAB
.text:00411FA9 ; ---------------------------------------------------------------------------
.text:00411FA9
.text:00411FA9 loc_411FA9:			       ; CODE XREF: _memcmp+EF5j
.text:00411FA9		       xor     esi, esi
.text:00411FAB
.text:00411FAB loc_411FAB:			       ; CODE XREF: _memcmp+F63j
.text:00411FAB					       ; _memcmp+F72j
.text:00411FAB		       test    esi, esi
.text:00411FAD		       jnz     loc_411501
.text:00411FB3
.text:00411FB3 $LN92:				       ; CODE XREF: _memcmp+4C5j
.text:00411FB3					       ; DATA XREF: _memcmp:off_412635o
.text:00411FB3		       mov     edx, [eax-0Ah]  ; jumptable 004114FA case 10
.text:00411FB6		       cmp     edx, [ecx-0Ah]
.text:00411FB9		       jz      short loc_412039
.text:00411FBB		       movzx   edx, byte ptr [ecx-0Ah]
.text:00411FBF		       movzx   esi, byte ptr [eax-0Ah]
.text:00411FC3		       sub     esi, edx
.text:00411FC5		       jz      short loc_411FDC
.text:00411FC7		       xor     edx, edx
.text:00411FC9		       test    esi, esi
.text:00411FCB		       setnle  dl
.text:00411FCE		       lea     edx, [edx+edx-1]
.text:00411FD2		       mov     esi, edx
.text:00411FD4		       test    esi, esi
.text:00411FD6		       jnz     loc_411501
.text:00411FDC
.text:00411FDC loc_411FDC:			       ; CODE XREF: _memcmp+F90j
.text:00411FDC		       movzx   edx, byte ptr [ecx-9]
.text:00411FE0		       movzx   esi, byte ptr [eax-9]
.text:00411FE4		       sub     esi, edx
.text:00411FE6		       jz      short loc_411FFD
.text:00411FE8		       xor     edx, edx
.text:00411FEA		       test    esi, esi
.text:00411FEC		       setnle  dl
.text:00411FEF		       lea     edx, [edx+edx-1]
.text:00411FF3		       mov     esi, edx
.text:00411FF5		       test    esi, esi
.text:00411FF7		       jnz     loc_411501
.text:00411FFD
.text:00411FFD loc_411FFD:			       ; CODE XREF: _memcmp+FB1j
.text:00411FFD		       movzx   edx, byte ptr [ecx-8]
.text:00412001		       movzx   esi, byte ptr [eax-8]
.text:00412005		       sub     esi, edx
.text:00412007		       jz      short loc_41201E
.text:00412009		       xor     edx, edx
.text:0041200B		       test    esi, esi
.text:0041200D		       setnle  dl
.text:00412010		       lea     edx, [edx+edx-1]
.text:00412014		       mov     esi, edx
.text:00412016		       test    esi, esi
.text:00412018		       jnz     loc_411501
.text:0041201E
.text:0041201E loc_41201E:			       ; CODE XREF: _memcmp+FD2j
.text:0041201E		       movzx   edx, byte ptr [ecx-7]
.text:00412022		       movzx   esi, byte ptr [eax-7]
.text:00412026		       sub     esi, edx
.text:00412028		       jz      short loc_41203B
.text:0041202A		       xor     edx, edx
.text:0041202C		       test    esi, esi
.text:0041202E		       setnle  dl
.text:00412031		       lea     edx, [edx+edx-1]
.text:00412035		       mov     esi, edx
.text:00412037		       jmp     short loc_41203B
.text:00412039 ; ---------------------------------------------------------------------------
.text:00412039
.text:00412039 loc_412039:			       ; CODE XREF: _memcmp+F84j
.text:00412039		       xor     esi, esi
.text:0041203B
.text:0041203B loc_41203B:			       ; CODE XREF: _memcmp+FF3j
.text:0041203B					       ; _memcmp+1002j
.text:0041203B		       test    esi, esi
.text:0041203D		       jnz     loc_411501
.text:00412043
.text:00412043 $LN90:				       ; CODE XREF: _memcmp+4C5j
.text:00412043					       ; DATA XREF: _memcmp:off_412635o
.text:00412043		       mov     edx, [eax-6]    ; jumptable 004114FA case 6
.text:00412046		       cmp     edx, [ecx-6]
.text:00412049		       jz      short loc_4120C8
.text:0041204B		       movzx   esi, dl
.text:0041204E		       movzx   edx, byte ptr [ecx-6]
.text:00412052		       sub     esi, edx
.text:00412054		       jz      short loc_41206B
.text:00412056		       xor     edx, edx
.text:00412058		       test    esi, esi
.text:0041205A		       setnle  dl
.text:0041205D		       lea     edx, [edx+edx-1]
.text:00412061		       mov     esi, edx
.text:00412063		       test    esi, esi
.text:00412065		       jnz     loc_411501
.text:0041206B
.text:0041206B loc_41206B:			       ; CODE XREF: _memcmp+101Fj
.text:0041206B		       movzx   esi, byte ptr [eax-5]
.text:0041206F		       movzx   edx, byte ptr [ecx-5]
.text:00412073		       sub     esi, edx
.text:00412075		       jz      short loc_41208C
.text:00412077		       xor     edx, edx
.text:00412079		       test    esi, esi
.text:0041207B		       setnle  dl
.text:0041207E		       lea     edx, [edx+edx-1]
.text:00412082		       mov     esi, edx
.text:00412084		       test    esi, esi
.text:00412086		       jnz     loc_411501
.text:0041208C
.text:0041208C loc_41208C:			       ; CODE XREF: _memcmp+1040j
.text:0041208C		       movzx   esi, byte ptr [eax-4]
.text:00412090		       movzx   edx, byte ptr [ecx-4]
.text:00412094		       sub     esi, edx
.text:00412096		       jz      short loc_4120AD
.text:00412098		       xor     edx, edx
.text:0041209A		       test    esi, esi
.text:0041209C		       setnle  dl
.text:0041209F		       lea     edx, [edx+edx-1]
.text:004120A3		       mov     esi, edx
.text:004120A5		       test    esi, esi
.text:004120A7		       jnz     loc_411501
.text:004120AD
.text:004120AD loc_4120AD:			       ; CODE XREF: _memcmp+1061j
.text:004120AD		       movzx   esi, byte ptr [eax-3]
.text:004120B1		       movzx   edx, byte ptr [ecx-3]
.text:004120B5		       sub     esi, edx
.text:004120B7		       jz      short loc_4120CA
.text:004120B9		       xor     edx, edx
.text:004120BB		       test    esi, esi
.text:004120BD		       setnle  dl
.text:004120C0		       lea     edx, [edx+edx-1]
.text:004120C4		       mov     esi, edx
.text:004120C6		       jmp     short loc_4120CA
.text:004120C8 ; ---------------------------------------------------------------------------
.text:004120C8
.text:004120C8 loc_4120C8:			       ; CODE XREF: _memcmp+1014j
.text:004120C8		       xor     esi, esi
.text:004120CA
.text:004120CA loc_4120CA:			       ; CODE XREF: _memcmp+1082j
.text:004120CA					       ; _memcmp+1091j
.text:004120CA		       test    esi, esi
.text:004120CC		       jnz     loc_411501
.text:004120D2
.text:004120D2 $LN88:				       ; CODE XREF: _memcmp+4C5j
.text:004120D2					       ; DATA XREF: _memcmp:off_412635o
.text:004120D2		       mov     dx, [eax-2]     ; jumptable 004114FA case 2
.text:004120D6		       cmp     dx, [ecx-2]
.text:004120DA		       jz      $LN132	       ; default
.text:004120DA					       ; jumptable 004114FA case 0
.text:004120E0
.text:004120E0 loc_4120E0:			       ; CODE XREF: _memcmp+14C8j
.text:004120E0					       ; _memcmp+14DBj
.text:004120E0		       movzx   edx, byte ptr [ecx-2]
.text:004120E4		       movzx   esi, byte ptr [eax-2]
.text:004120E8		       sub     esi, edx
.text:004120EA		       jz      $LN103	       ; jumptable 004114FA case 1
.text:004120F0		       xor     edx, edx
.text:004120F2		       test    esi, esi
.text:004120F4		       setnle  dl
.text:004120F7		       lea     edx, [edx+edx-1]
.text:004120FB		       test    edx, edx
.text:004120FD		       jnz     loc_412516
.text:00412103		       jmp     $LN103	       ; jumptable 004114FA case 1
.text:00412108 ; ---------------------------------------------------------------------------
.text:00412108
.text:00412108 $LN86:				       ; CODE XREF: _memcmp+4C5j
.text:00412108					       ; DATA XREF: _memcmp:off_412635o
.text:00412108		       mov     edx, [eax-1Fh]  ; jumptable 004114FA case 31
.text:0041210B		       cmp     edx, [ecx-1Fh]
.text:0041210E		       jz      short loc_41218E
.text:00412110		       movzx   edx, byte ptr [ecx-1Fh]
.text:00412114		       movzx   esi, byte ptr [eax-1Fh]
.text:00412118		       sub     esi, edx
.text:0041211A		       jz      short loc_412131
.text:0041211C		       xor     edx, edx
.text:0041211E		       test    esi, esi
.text:00412120		       setnle  dl
.text:00412123		       lea     edx, [edx+edx-1]
.text:00412127		       mov     esi, edx
.text:00412129		       test    esi, esi
.text:0041212B		       jnz     loc_411501
.text:00412131
.text:00412131 loc_412131:			       ; CODE XREF: _memcmp+10E5j
.text:00412131		       movzx   esi, byte ptr [eax-1Eh]
.text:00412135		       movzx   edx, byte ptr [ecx-1Eh]
.text:00412139		       sub     esi, edx
.text:0041213B		       jz      short loc_412152
.text:0041213D		       xor     edx, edx
.text:0041213F		       test    esi, esi
.text:00412141		       setnle  dl
.text:00412144		       lea     edx, [edx+edx-1]
.text:00412148		       mov     esi, edx
.text:0041214A		       test    esi, esi
.text:0041214C		       jnz     loc_411501
.text:00412152
.text:00412152 loc_412152:			       ; CODE XREF: _memcmp+1106j
.text:00412152		       movzx   esi, byte ptr [eax-1Dh]
.text:00412156		       movzx   edx, byte ptr [ecx-1Dh]
.text:0041215A		       sub     esi, edx
.text:0041215C		       jz      short loc_412173
.text:0041215E		       xor     edx, edx
.text:00412160		       test    esi, esi
.text:00412162		       setnle  dl
.text:00412165		       lea     edx, [edx+edx-1]
.text:00412169		       mov     esi, edx
.text:0041216B		       test    esi, esi
.text:0041216D		       jnz     loc_411501
.text:00412173
.text:00412173 loc_412173:			       ; CODE XREF: _memcmp+1127j
.text:00412173		       movzx   esi, byte ptr [eax-1Ch]
.text:00412177		       movzx   edx, byte ptr [ecx-1Ch]
.text:0041217B		       sub     esi, edx
.text:0041217D		       jz      short loc_412190
.text:0041217F		       xor     edx, edx
.text:00412181		       test    esi, esi
.text:00412183		       setnle  dl
.text:00412186		       lea     edx, [edx+edx-1]
.text:0041218A		       mov     esi, edx
.text:0041218C		       jmp     short loc_412190
.text:0041218E ; ---------------------------------------------------------------------------
.text:0041218E
.text:0041218E loc_41218E:			       ; CODE XREF: _memcmp+10D9j
.text:0041218E		       xor     esi, esi
.text:00412190
.text:00412190 loc_412190:			       ; CODE XREF: _memcmp+1148j
.text:00412190					       ; _memcmp+1157j
.text:00412190		       test    esi, esi
.text:00412192		       jnz     loc_411501
.text:00412198
.text:00412198 $LN85:				       ; CODE XREF: _memcmp+4C5j
.text:00412198					       ; DATA XREF: _memcmp:off_412635o
.text:00412198		       mov     edx, [eax-1Bh]  ; jumptable 004114FA case 27
.text:0041219B		       cmp     edx, [ecx-1Bh]
.text:0041219E		       jz      short loc_41221D
.text:004121A0		       movzx   esi, dl
.text:004121A3		       movzx   edx, byte ptr [ecx-1Bh]
.text:004121A7		       sub     esi, edx
.text:004121A9		       jz      short loc_4121C0
.text:004121AB		       xor     edx, edx
.text:004121AD		       test    esi, esi
.text:004121AF		       setnle  dl
.text:004121B2		       lea     edx, [edx+edx-1]
.text:004121B6		       mov     esi, edx
.text:004121B8		       test    esi, esi
.text:004121BA		       jnz     loc_411501
.text:004121C0
.text:004121C0 loc_4121C0:			       ; CODE XREF: _memcmp+1174j
.text:004121C0		       movzx   esi, byte ptr [eax-1Ah]
.text:004121C4		       movzx   edx, byte ptr [ecx-1Ah]
.text:004121C8		       sub     esi, edx
.text:004121CA		       jz      short loc_4121E1
.text:004121CC		       xor     edx, edx
.text:004121CE		       test    esi, esi
.text:004121D0		       setnle  dl
.text:004121D3		       lea     edx, [edx+edx-1]
.text:004121D7		       mov     esi, edx
.text:004121D9		       test    esi, esi
.text:004121DB		       jnz     loc_411501
.text:004121E1
.text:004121E1 loc_4121E1:			       ; CODE XREF: _memcmp+1195j
.text:004121E1		       movzx   esi, byte ptr [eax-19h]
.text:004121E5		       movzx   edx, byte ptr [ecx-19h]
.text:004121E9		       sub     esi, edx
.text:004121EB		       jz      short loc_412202
.text:004121ED		       xor     edx, edx
.text:004121EF		       test    esi, esi
.text:004121F1		       setnle  dl
.text:004121F4		       lea     edx, [edx+edx-1]
.text:004121F8		       mov     esi, edx
.text:004121FA		       test    esi, esi
.text:004121FC		       jnz     loc_411501
.text:00412202
.text:00412202 loc_412202:			       ; CODE XREF: _memcmp+11B6j
.text:00412202		       movzx   esi, byte ptr [eax-18h]
.text:00412206		       movzx   edx, byte ptr [ecx-18h]
.text:0041220A		       sub     esi, edx
.text:0041220C		       jz      short loc_41221F
.text:0041220E		       xor     edx, edx
.text:00412210		       test    esi, esi
.text:00412212		       setnle  dl
.text:00412215		       lea     edx, [edx+edx-1]
.text:00412219		       mov     esi, edx
.text:0041221B		       jmp     short loc_41221F
.text:0041221D ; ---------------------------------------------------------------------------
.text:0041221D
.text:0041221D loc_41221D:			       ; CODE XREF: _memcmp+1169j
.text:0041221D		       xor     esi, esi
.text:0041221F
.text:0041221F loc_41221F:			       ; CODE XREF: _memcmp+11D7j
.text:0041221F					       ; _memcmp+11E6j
.text:0041221F		       test    esi, esi
.text:00412221		       jnz     loc_411501
.text:00412227
.text:00412227 $LN83:				       ; CODE XREF: _memcmp+4C5j
.text:00412227					       ; DATA XREF: _memcmp:off_412635o
.text:00412227		       mov     edx, [eax-17h]  ; jumptable 004114FA case 23
.text:0041222A		       cmp     edx, [ecx-17h]
.text:0041222D		       jz      short loc_4122AC
.text:0041222F		       movzx   esi, dl
.text:00412232		       movzx   edx, byte ptr [ecx-17h]
.text:00412236		       sub     esi, edx
.text:00412238		       jz      short loc_41224F
.text:0041223A		       xor     edx, edx
.text:0041223C		       test    esi, esi
.text:0041223E		       setnle  dl
.text:00412241		       lea     edx, [edx+edx-1]
.text:00412245		       mov     esi, edx
.text:00412247		       test    esi, esi
.text:00412249		       jnz     loc_411501
.text:0041224F
.text:0041224F loc_41224F:			       ; CODE XREF: _memcmp+1203j
.text:0041224F		       movzx   esi, byte ptr [eax-16h]
.text:00412253		       movzx   edx, byte ptr [ecx-16h]
.text:00412257		       sub     esi, edx
.text:00412259		       jz      short loc_412270
.text:0041225B		       xor     edx, edx
.text:0041225D		       test    esi, esi
.text:0041225F		       setnle  dl
.text:00412262		       lea     edx, [edx+edx-1]
.text:00412266		       mov     esi, edx
.text:00412268		       test    esi, esi
.text:0041226A		       jnz     loc_411501
.text:00412270
.text:00412270 loc_412270:			       ; CODE XREF: _memcmp+1224j
.text:00412270		       movzx   esi, byte ptr [eax-15h]
.text:00412274		       movzx   edx, byte ptr [ecx-15h]
.text:00412278		       sub     esi, edx
.text:0041227A		       jz      short loc_412291
.text:0041227C		       xor     edx, edx
.text:0041227E		       test    esi, esi
.text:00412280		       setnle  dl
.text:00412283		       lea     edx, [edx+edx-1]
.text:00412287		       mov     esi, edx
.text:00412289		       test    esi, esi
.text:0041228B		       jnz     loc_411501
.text:00412291
.text:00412291 loc_412291:			       ; CODE XREF: _memcmp+1245j
.text:00412291		       movzx   esi, byte ptr [eax-14h]
.text:00412295		       movzx   edx, byte ptr [ecx-14h]
.text:00412299		       sub     esi, edx
.text:0041229B		       jz      short loc_4122AE
.text:0041229D		       xor     edx, edx
.text:0041229F		       test    esi, esi
.text:004122A1		       setnle  dl
.text:004122A4		       lea     edx, [edx+edx-1]
.text:004122A8		       mov     esi, edx
.text:004122AA		       jmp     short loc_4122AE
.text:004122AC ; ---------------------------------------------------------------------------
.text:004122AC
.text:004122AC loc_4122AC:			       ; CODE XREF: _memcmp+11F8j
.text:004122AC		       xor     esi, esi
.text:004122AE
.text:004122AE loc_4122AE:			       ; CODE XREF: _memcmp+1266j
.text:004122AE					       ; _memcmp+1275j
.text:004122AE		       test    esi, esi
.text:004122B0		       jnz     loc_411501
.text:004122B6
.text:004122B6 $LN81:				       ; CODE XREF: _memcmp+4C5j
.text:004122B6					       ; DATA XREF: _memcmp:off_412635o
.text:004122B6		       mov     edx, [eax-13h]  ; jumptable 004114FA case 19
.text:004122B9		       cmp     edx, [ecx-13h]
.text:004122BC		       jz      short loc_41233B
.text:004122BE		       movzx   esi, dl
.text:004122C1		       movzx   edx, byte ptr [ecx-13h]
.text:004122C5		       sub     esi, edx
.text:004122C7		       jz      short loc_4122DE
.text:004122C9		       xor     edx, edx
.text:004122CB		       test    esi, esi
.text:004122CD		       setnle  dl
.text:004122D0		       lea     edx, [edx+edx-1]
.text:004122D4		       mov     esi, edx
.text:004122D6		       test    esi, esi
.text:004122D8		       jnz     loc_411501
.text:004122DE
.text:004122DE loc_4122DE:			       ; CODE XREF: _memcmp+1292j
.text:004122DE		       movzx   esi, byte ptr [eax-12h]
.text:004122E2		       movzx   edx, byte ptr [ecx-12h]
.text:004122E6		       sub     esi, edx
.text:004122E8		       jz      short loc_4122FF
.text:004122EA		       xor     edx, edx
.text:004122EC		       test    esi, esi
.text:004122EE		       setnle  dl
.text:004122F1		       lea     edx, [edx+edx-1]
.text:004122F5		       mov     esi, edx
.text:004122F7		       test    esi, esi
.text:004122F9		       jnz     loc_411501
.text:004122FF
.text:004122FF loc_4122FF:			       ; CODE XREF: _memcmp+12B3j
.text:004122FF		       movzx   esi, byte ptr [eax-11h]
.text:00412303		       movzx   edx, byte ptr [ecx-11h]
.text:00412307		       sub     esi, edx
.text:00412309		       jz      short loc_412320
.text:0041230B		       xor     edx, edx
.text:0041230D		       test    esi, esi
.text:0041230F		       setnle  dl
.text:00412312		       lea     edx, [edx+edx-1]
.text:00412316		       mov     esi, edx
.text:00412318		       test    esi, esi
.text:0041231A		       jnz     loc_411501
.text:00412320
.text:00412320 loc_412320:			       ; CODE XREF: _memcmp+12D4j
.text:00412320		       movzx   esi, byte ptr [eax-10h]
.text:00412324		       movzx   edx, byte ptr [ecx-10h]
.text:00412328		       sub     esi, edx
.text:0041232A		       jz      short loc_41233D
.text:0041232C		       xor     edx, edx
.text:0041232E		       test    esi, esi
.text:00412330		       setnle  dl
.text:00412333		       lea     edx, [edx+edx-1]
.text:00412337		       mov     esi, edx
.text:00412339		       jmp     short loc_41233D
.text:0041233B ; ---------------------------------------------------------------------------
.text:0041233B
.text:0041233B loc_41233B:			       ; CODE XREF: _memcmp+1287j
.text:0041233B		       xor     esi, esi
.text:0041233D
.text:0041233D loc_41233D:			       ; CODE XREF: _memcmp+12F5j
.text:0041233D					       ; _memcmp+1304j
.text:0041233D		       test    esi, esi
.text:0041233F		       jnz     loc_411501
.text:00412345
.text:00412345 $LN79:				       ; CODE XREF: _memcmp+4C5j
.text:00412345					       ; DATA XREF: _memcmp:off_412635o
.text:00412345		       mov     edx, [eax-0Fh]  ; jumptable 004114FA case 15
.text:00412348		       cmp     edx, [ecx-0Fh]
.text:0041234B		       jz      short loc_4123CB
.text:0041234D		       movzx   edx, byte ptr [ecx-0Fh]
.text:00412351		       movzx   esi, byte ptr [eax-0Fh]
.text:00412355		       sub     esi, edx
.text:00412357		       jz      short loc_41236E
.text:00412359		       xor     edx, edx
.text:0041235B		       test    esi, esi
.text:0041235D		       setnle  dl
.text:00412360		       lea     edx, [edx+edx-1]
.text:00412364		       mov     esi, edx
.text:00412366		       test    esi, esi
.text:00412368		       jnz     loc_411501
.text:0041236E
.text:0041236E loc_41236E:			       ; CODE XREF: _memcmp+1322j
.text:0041236E		       movzx   esi, byte ptr [eax-0Eh]
.text:00412372		       movzx   edx, byte ptr [ecx-0Eh]
.text:00412376		       sub     esi, edx
.text:00412378		       jz      short loc_41238F
.text:0041237A		       xor     edx, edx
.text:0041237C		       test    esi, esi
.text:0041237E		       setnle  dl
.text:00412381		       lea     edx, [edx+edx-1]
.text:00412385		       mov     esi, edx
.text:00412387		       test    esi, esi
.text:00412389		       jnz     loc_411501
.text:0041238F
.text:0041238F loc_41238F:			       ; CODE XREF: _memcmp+1343j
.text:0041238F		       movzx   esi, byte ptr [eax-0Dh]
.text:00412393		       movzx   edx, byte ptr [ecx-0Dh]
.text:00412397		       sub     esi, edx
.text:00412399		       jz      short loc_4123B0
.text:0041239B		       xor     edx, edx
.text:0041239D		       test    esi, esi
.text:0041239F		       setnle  dl
.text:004123A2		       lea     edx, [edx+edx-1]
.text:004123A6		       mov     esi, edx
.text:004123A8		       test    esi, esi
.text:004123AA		       jnz     loc_411501
.text:004123B0
.text:004123B0 loc_4123B0:			       ; CODE XREF: _memcmp+1364j
.text:004123B0		       movzx   esi, byte ptr [eax-0Ch]
.text:004123B4		       movzx   edx, byte ptr [ecx-0Ch]
.text:004123B8		       sub     esi, edx
.text:004123BA		       jz      short loc_4123CD
.text:004123BC		       xor     edx, edx
.text:004123BE		       test    esi, esi
.text:004123C0		       setnle  dl
.text:004123C3		       lea     edx, [edx+edx-1]
.text:004123C7		       mov     esi, edx
.text:004123C9		       jmp     short loc_4123CD
.text:004123CB ; ---------------------------------------------------------------------------
.text:004123CB
.text:004123CB loc_4123CB:			       ; CODE XREF: _memcmp+1316j
.text:004123CB		       xor     esi, esi
.text:004123CD
.text:004123CD loc_4123CD:			       ; CODE XREF: _memcmp+1385j
.text:004123CD					       ; _memcmp+1394j
.text:004123CD		       test    esi, esi
.text:004123CF		       jnz     loc_411501
.text:004123D5
.text:004123D5 $LN77:				       ; CODE XREF: _memcmp+4C5j
.text:004123D5					       ; DATA XREF: _memcmp:off_412635o
.text:004123D5		       mov     edx, [eax-0Bh]  ; jumptable 004114FA case 11
.text:004123D8		       cmp     edx, [ecx-0Bh]
.text:004123DB		       jz      short loc_41245A
.text:004123DD		       movzx   esi, dl
.text:004123E0		       movzx   edx, byte ptr [ecx-0Bh]
.text:004123E4		       sub     esi, edx
.text:004123E6		       jz      short loc_4123FD
.text:004123E8		       xor     edx, edx
.text:004123EA		       test    esi, esi
.text:004123EC		       setnle  dl
.text:004123EF		       lea     edx, [edx+edx-1]
.text:004123F3		       mov     esi, edx
.text:004123F5		       test    esi, esi
.text:004123F7		       jnz     loc_411501
.text:004123FD
.text:004123FD loc_4123FD:			       ; CODE XREF: _memcmp+13B1j
.text:004123FD		       movzx   esi, byte ptr [eax-0Ah]
.text:00412401		       movzx   edx, byte ptr [ecx-0Ah]
.text:00412405		       sub     esi, edx
.text:00412407		       jz      short loc_41241E
.text:00412409		       xor     edx, edx
.text:0041240B		       test    esi, esi
.text:0041240D		       setnle  dl
.text:00412410		       lea     edx, [edx+edx-1]
.text:00412414		       mov     esi, edx
.text:00412416		       test    esi, esi
.text:00412418		       jnz     loc_411501
.text:0041241E
.text:0041241E loc_41241E:			       ; CODE XREF: _memcmp+13D2j
.text:0041241E		       movzx   esi, byte ptr [eax-9]
.text:00412422		       movzx   edx, byte ptr [ecx-9]
.text:00412426		       sub     esi, edx
.text:00412428		       jz      short loc_41243F
.text:0041242A		       xor     edx, edx
.text:0041242C		       test    esi, esi
.text:0041242E		       setnle  dl
.text:00412431		       lea     edx, [edx+edx-1]
.text:00412435		       mov     esi, edx
.text:00412437		       test    esi, esi
.text:00412439		       jnz     loc_411501
.text:0041243F
.text:0041243F loc_41243F:			       ; CODE XREF: _memcmp+13F3j
.text:0041243F		       movzx   esi, byte ptr [eax-8]
.text:00412443		       movzx   edx, byte ptr [ecx-8]
.text:00412447		       sub     esi, edx
.text:00412449		       jz      short loc_41245C
.text:0041244B		       xor     edx, edx
.text:0041244D		       test    esi, esi
.text:0041244F		       setnle  dl
.text:00412452		       lea     edx, [edx+edx-1]
.text:00412456		       mov     esi, edx
.text:00412458		       jmp     short loc_41245C
.text:0041245A ; ---------------------------------------------------------------------------
.text:0041245A
.text:0041245A loc_41245A:			       ; CODE XREF: _memcmp+13A6j
.text:0041245A		       xor     esi, esi
.text:0041245C
.text:0041245C loc_41245C:			       ; CODE XREF: _memcmp+1414j
.text:0041245C					       ; _memcmp+1423j
.text:0041245C		       test    esi, esi
.text:0041245E		       jnz     loc_411501
.text:00412464
.text:00412464 $LN75:				       ; CODE XREF: _memcmp+4C5j
.text:00412464					       ; DATA XREF: _memcmp:off_412635o
.text:00412464		       mov     edx, [eax-7]    ; jumptable 004114FA case 7
.text:00412467		       cmp     edx, [ecx-7]
.text:0041246A		       jz      short loc_4124E9
.text:0041246C		       movzx   esi, dl
.text:0041246F		       movzx   edx, byte ptr [ecx-7]
.text:00412473		       sub     esi, edx
.text:00412475		       jz      short loc_41248C
.text:00412477		       xor     edx, edx
.text:00412479		       test    esi, esi
.text:0041247B		       setnle  dl
.text:0041247E		       lea     edx, [edx+edx-1]
.text:00412482		       mov     esi, edx
.text:00412484		       test    esi, esi
.text:00412486		       jnz     loc_411501
.text:0041248C
.text:0041248C loc_41248C:			       ; CODE XREF: _memcmp+1440j
.text:0041248C		       movzx   esi, byte ptr [eax-6]
.text:00412490		       movzx   edx, byte ptr [ecx-6]
.text:00412494		       sub     esi, edx
.text:00412496		       jz      short loc_4124AD
.text:00412498		       xor     edx, edx
.text:0041249A		       test    esi, esi
.text:0041249C		       setnle  dl
.text:0041249F		       lea     edx, [edx+edx-1]
.text:004124A3		       mov     esi, edx
.text:004124A5		       test    esi, esi
.text:004124A7		       jnz     loc_411501
.text:004124AD
.text:004124AD loc_4124AD:			       ; CODE XREF: _memcmp+1461j
.text:004124AD		       movzx   esi, byte ptr [eax-5]
.text:004124B1		       movzx   edx, byte ptr [ecx-5]
.text:004124B5		       sub     esi, edx
.text:004124B7		       jz      short loc_4124CE
.text:004124B9		       xor     edx, edx
.text:004124BB		       test    esi, esi
.text:004124BD		       setnle  dl
.text:004124C0		       lea     edx, [edx+edx-1]
.text:004124C4		       mov     esi, edx
.text:004124C6		       test    esi, esi
.text:004124C8		       jnz     loc_411501
.text:004124CE
.text:004124CE loc_4124CE:			       ; CODE XREF: _memcmp+1482j
.text:004124CE		       movzx   esi, byte ptr [eax-4]
.text:004124D2		       movzx   edx, byte ptr [ecx-4]
.text:004124D6		       sub     esi, edx
.text:004124D8		       jz      short loc_4124EB
.text:004124DA		       xor     edx, edx
.text:004124DC		       test    esi, esi
.text:004124DE		       setnle  dl
.text:004124E1		       lea     edx, [edx+edx-1]
.text:004124E5		       mov     esi, edx
.text:004124E7		       jmp     short loc_4124EB
.text:004124E9 ; ---------------------------------------------------------------------------
.text:004124E9
.text:004124E9 loc_4124E9:			       ; CODE XREF: _memcmp+1435j
.text:004124E9		       xor     esi, esi
.text:004124EB
.text:004124EB loc_4124EB:			       ; CODE XREF: _memcmp+14A3j
.text:004124EB					       ; _memcmp+14B2j
.text:004124EB		       test    esi, esi
.text:004124ED		       jnz     loc_411501
.text:004124F3
.text:004124F3 $LN73:				       ; CODE XREF: _memcmp+4C5j
.text:004124F3					       ; DATA XREF: _memcmp:off_412635o
.text:004124F3		       movzx   esi, byte ptr [eax-3] ; jumptable 004114FA case 3
.text:004124F7		       movzx   edx, byte ptr [ecx-3]
.text:004124FB		       sub     esi, edx
.text:004124FD		       jz      loc_4120E0
.text:00412503		       xor     edx, edx
.text:00412505		       test    esi, esi
.text:00412507		       setnle  dl
.text:0041250A		       lea     edx, [edx+edx-1]
.text:0041250E		       test    edx, edx
.text:00412510		       jz      loc_4120E0
.text:00412516
.text:00412516 loc_412516:			       ; CODE XREF: _memcmp+10C8j
.text:00412516		       mov     eax, edx
.text:00412518		       jmp     loc_4118D6
.text:0041251D ; ---------------------------------------------------------------------------
.text:0041251D
.text:0041251D loc_41251D:			       ; CODE XREF: _memcmp+29j
.text:0041251D		       mov     ecx, [ebp+lhs]
.text:00412520		       mov     esi, [ebp+rhs]
.text:00412523		       movzx   eax, byte ptr [ecx]
.text:00412526		       movzx   edx, byte ptr [esi]
.text:00412529		       sub     eax, edx
.text:0041252B		       jz      short loc_412542
.text:0041252D		       xor     edx, edx
.text:0041252F		       test    eax, eax
.text:00412531		       setnle  dl
.text:00412534		       lea     edx, [edx+edx-1]
.text:00412538		       mov     eax, edx
.text:0041253A		       test    eax, eax
.text:0041253C		       jnz     loc_41262F
.text:00412542
.text:00412542 loc_412542:			       ; CODE XREF: _memcmp+14F6j
.text:00412542		       movzx   eax, byte ptr [ecx+1]
.text:00412546		       movzx   edx, byte ptr [esi+1]
.text:0041254A		       sub     eax, edx
.text:0041254C		       jz      short loc_412563
.text:0041254E		       xor     edx, edx
.text:00412550		       test    eax, eax
.text:00412552		       setnle  dl
.text:00412555		       lea     edx, [edx+edx-1]
.text:00412559		       mov     eax, edx
.text:0041255B		       test    eax, eax
.text:0041255D		       jnz     loc_41262F
.text:00412563
.text:00412563 loc_412563:			       ; CODE XREF: _memcmp+1517j
.text:00412563		       movzx   eax, byte ptr [ecx+2]
.text:00412567		       movzx   edx, byte ptr [esi+2]
.text:0041256B		       sub     eax, edx
.text:0041256D		       jz      short loc_412584
.text:0041256F		       xor     edx, edx
.text:00412571		       test    eax, eax
.text:00412573		       setnle  dl
.text:00412576		       lea     edx, [edx+edx-1]
.text:0041257A		       mov     eax, edx
.text:0041257C		       test    eax, eax
.text:0041257E		       jnz     loc_41262F
.text:00412584
.text:00412584 loc_412584:			       ; CODE XREF: _memcmp+1538j
.text:00412584		       movzx   eax, byte ptr [ecx+3]
.text:00412588		       movzx   ecx, byte ptr [esi+3]
.text:0041258C
.text:0041258C loc_41258C:			       ; CODE XREF: _memcmp+15B7j
.text:0041258C					       ; _memcmp+15E2j	...
.text:0041258C		       sub     eax, ecx
.text:0041258E		       jz      loc_41262F
.text:00412594		       xor     ecx, ecx
.text:00412596		       test    eax, eax
.text:00412598		       setnle  cl
.text:0041259B		       lea     ecx, [ecx+ecx-1]
.text:0041259F		       mov     eax, ecx
.text:004125A1		       jmp     loc_41262F
.text:004125A6 ; ---------------------------------------------------------------------------
.text:004125A6
.text:004125A6 loc_4125A6:			       ; CODE XREF: _memcmp+22j
.text:004125A6		       mov     ecx, [ebp+lhs]
.text:004125A9		       mov     esi, [ebp+rhs]
.text:004125AC		       movzx   eax, byte ptr [ecx]
.text:004125AF		       movzx   edx, byte ptr [esi]
.text:004125B2		       sub     eax, edx
.text:004125B4		       jz      short loc_4125C7
.text:004125B6		       xor     edx, edx
.text:004125B8		       test    eax, eax
.text:004125BA		       setnle  dl
.text:004125BD		       lea     edx, [edx+edx-1]
.text:004125C1		       mov     eax, edx
.text:004125C3		       test    eax, eax
.text:004125C5		       jnz     short loc_41262F
.text:004125C7
.text:004125C7 loc_4125C7:			       ; CODE XREF: _memcmp+157Fj
.text:004125C7		       movzx   eax, byte ptr [ecx+1]
.text:004125CB		       movzx   edx, byte ptr [esi+1]
.text:004125CF		       sub     eax, edx
.text:004125D1		       jz      short loc_4125E4
.text:004125D3		       xor     edx, edx
.text:004125D5		       test    eax, eax
.text:004125D7		       setnle  dl
.text:004125DA		       lea     edx, [edx+edx-1]
.text:004125DE		       mov     eax, edx
.text:004125E0		       test    eax, eax
.text:004125E2		       jnz     short loc_41262F
.text:004125E4
.text:004125E4 loc_4125E4:			       ; CODE XREF: _memcmp+159Cj
.text:004125E4		       movzx   eax, byte ptr [ecx+2]
.text:004125E8		       movzx   ecx, byte ptr [esi+2]
.text:004125EC		       jmp     short loc_41258C
.text:004125EE ; ---------------------------------------------------------------------------
.text:004125EE
.text:004125EE loc_4125EE:			       ; CODE XREF: _memcmp+1Bj
.text:004125EE		       mov     ecx, [ebp+lhs]
.text:004125F1		       mov     esi, [ebp+rhs]
.text:004125F4		       movzx   eax, byte ptr [ecx]
.text:004125F7		       movzx   edx, byte ptr [esi]
.text:004125FA		       sub     eax, edx
.text:004125FC		       jz      short loc_41260F
.text:004125FE		       xor     edx, edx
.text:00412600		       test    eax, eax
.text:00412602		       setnle  dl
.text:00412605		       lea     edx, [edx+edx-1]
.text:00412609		       mov     eax, edx
.text:0041260B		       test    eax, eax
.text:0041260D		       jnz     short loc_41262F
.text:0041260F
.text:0041260F loc_41260F:			       ; CODE XREF: _memcmp+15C7j
.text:0041260F		       movzx   eax, byte ptr [ecx+1]
.text:00412613		       movzx   ecx, byte ptr [esi+1]
.text:00412617		       jmp     loc_41258C
.text:0041261C ; ---------------------------------------------------------------------------
.text:0041261C
.text:0041261C loc_41261C:			       ; CODE XREF: _memcmp+14j
.text:0041261C		       mov     eax, [ebp+lhs]
.text:0041261F		       mov     ecx, [ebp+rhs]
.text:00412622		       movzx   eax, byte ptr [eax]
.text:00412625		       movzx   ecx, byte ptr [ecx]
.text:00412628		       jmp     loc_41258C
.text:0041262D ; ---------------------------------------------------------------------------
.text:0041262D
.text:0041262D loc_41262D:			       ; CODE XREF: _memcmp+Dj
.text:0041262D		       xor     eax, eax
.text:0041262F
.text:0041262F loc_41262F:			       ; CODE XREF: _memcmp+8A2j
.text:0041262F					       ; _memcmp+1507j	...
.text:0041262F		       pop     edi
.text:00412630		       pop     esi
.text:00412631		       pop     ebp
.text:00412632		       retn
.text:00412632 ; ---------------------------------------------------------------------------
.text:00412633		       db 8Bh, 0FFh
.text:00412635 off_412635      dd offset $LN132	       ; DATA XREF: _memcmp+4C5r
.text:00412635		       dd offset $LN103	       ; jump table for	switch statement
.text:00412635		       dd offset $LN88
.text:00412635		       dd offset $LN73
.text:00412635		       dd offset $LN120
.text:00412635		       dd offset $LN105
.text:00412635		       dd offset $LN90
.text:00412635		       dd offset $LN75
.text:00412635		       dd offset $LN122_0
.text:00412635		       dd offset $LN107
.text:00412635		       dd offset $LN92
.text:00412635		       dd offset $LN77
.text:00412635		       dd offset $LN124
.text:00412635		       dd offset $LN109
.text:00412635		       dd offset $LN94
.text:00412635		       dd offset $LN79
.text:00412635		       dd offset $LN126
.text:00412635		       dd offset $LN111
.text:00412635		       dd offset $LN96_0
.text:00412635		       dd offset $LN81
.text:00412635		       dd offset $LN128
.text:00412635		       dd offset $LN113_0
.text:00412635		       dd offset $LN98
.text:00412635		       dd offset $LN83
.text:00412635		       dd offset $LN130_1
.text:00412635		       dd offset $LN115
.text:00412635		       dd offset $LN100
.text:00412635		       dd offset $LN85
.text:00412635		       dd offset $LN131_0
.text:00412635		       dd offset $LN116_0
.text:00412635		       dd offset $LN101
.text:00412635		       dd offset $LN86
.text:00412635 _memcmp	       endp
.text:00412635
.text:004126B5
.text:004126B5 ; =============== S U B R O U T I N E =======================================
.text:004126B5
.text:004126B5 ; Attributes: bp-based frame
.text:004126B5
.text:004126B5 ; int __cdecl strncmp(const char	*first,	const char *last, unsigned int count)
.text:004126B5 _strncmp	       proc near	       ; CODE XREF: _setlocale_nolock+B3p
.text:004126B5
.text:004126B5 n	       = dword ptr -4
.text:004126B5 first	       = dword ptr  8
.text:004126B5 last	       = dword ptr  0Ch
.text:004126B5 count	       = dword ptr  10h
.text:004126B5
.text:004126B5		       push    ebp
.text:004126B6		       mov     ebp, esp
.text:004126B8		       push    ecx
.text:004126B9		       and     [ebp+n],	0
.text:004126BD		       push    ebx
.text:004126BE		       mov     ebx, [ebp+count]
.text:004126C1		       test    ebx, ebx
.text:004126C3		       jnz     short loc_4126CC
.text:004126C5		       xor     eax, eax
.text:004126C7		       jmp     loc_412766
.text:004126CC ; ---------------------------------------------------------------------------
.text:004126CC
.text:004126CC loc_4126CC:			       ; CODE XREF: _strncmp+Ej
.text:004126CC		       cmp     ebx, 4
.text:004126CF		       push    edi
.text:004126D0		       jb      short loc_412747
.text:004126D2		       lea     edi, [ebx-4]
.text:004126D5		       test    edi, edi
.text:004126D7		       jbe     short loc_412747
.text:004126D9		       mov     ecx, [ebp+last]
.text:004126DC		       mov     eax, [ebp+first]
.text:004126DF
.text:004126DF loc_4126DF:			       ; CODE XREF: _strncmp+66j
.text:004126DF		       mov     dl, [eax]
.text:004126E1		       add     eax, 4
.text:004126E4		       add     ecx, 4
.text:004126E7		       test    dl, dl
.text:004126E9		       jz      short loc_41273D
.text:004126EB		       cmp     dl, [ecx-4]
.text:004126EE		       jnz     short loc_41273D
.text:004126F0		       mov     dl, [eax-3]
.text:004126F3		       test    dl, dl
.text:004126F5		       jz      short loc_412733
.text:004126F7		       cmp     dl, [ecx-3]
.text:004126FA		       jnz     short loc_412733
.text:004126FC		       mov     dl, [eax-2]
.text:004126FF		       test    dl, dl
.text:00412701		       jz      short loc_412729
.text:00412703		       cmp     dl, [ecx-2]
.text:00412706		       jnz     short loc_412729
.text:00412708		       mov     dl, [eax-1]
.text:0041270B		       test    dl, dl
.text:0041270D		       jz      short loc_41271F
.text:0041270F		       cmp     dl, [ecx-1]
.text:00412712		       jnz     short loc_41271F
.text:00412714		       add     [ebp+n],	4
.text:00412718		       cmp     [ebp+n],	edi
.text:0041271B		       jb      short loc_4126DF
.text:0041271D		       jmp     short loc_41275E
.text:0041271F ; ---------------------------------------------------------------------------
.text:0041271F
.text:0041271F loc_41271F:			       ; CODE XREF: _strncmp+58j
.text:0041271F					       ; _strncmp+5Dj
.text:0041271F		       movzx   eax, byte ptr [eax-1]
.text:00412723		       movzx   ecx, byte ptr [ecx-1]
.text:00412727		       jmp     short loc_41276F
.text:00412729 ; ---------------------------------------------------------------------------
.text:00412729
.text:00412729 loc_412729:			       ; CODE XREF: _strncmp+4Cj
.text:00412729					       ; _strncmp+51j
.text:00412729		       movzx   eax, byte ptr [eax-2]
.text:0041272D		       movzx   ecx, byte ptr [ecx-2]
.text:00412731		       jmp     short loc_41276F
.text:00412733 ; ---------------------------------------------------------------------------
.text:00412733
.text:00412733 loc_412733:			       ; CODE XREF: _strncmp+40j
.text:00412733					       ; _strncmp+45j
.text:00412733		       movzx   eax, byte ptr [eax-3]
.text:00412737		       movzx   ecx, byte ptr [ecx-3]
.text:0041273B		       jmp     short loc_41276F
.text:0041273D ; ---------------------------------------------------------------------------
.text:0041273D
.text:0041273D loc_41273D:			       ; CODE XREF: _strncmp+34j
.text:0041273D					       ; _strncmp+39j
.text:0041273D		       movzx   eax, byte ptr [eax-4]
.text:00412741		       movzx   ecx, byte ptr [ecx-4]
.text:00412745		       jmp     short loc_41276F
.text:00412747 ; ---------------------------------------------------------------------------
.text:00412747
.text:00412747 loc_412747:			       ; CODE XREF: _strncmp+1Bj
.text:00412747					       ; _strncmp+22j
.text:00412747		       mov     ecx, [ebp+last]
.text:0041274A		       mov     eax, [ebp+first]
.text:0041274D		       jmp     short loc_41275E
.text:0041274F ; ---------------------------------------------------------------------------
.text:0041274F
.text:0041274F loc_41274F:			       ; CODE XREF: _strncmp+ACj
.text:0041274F		       mov     dl, [eax]
.text:00412751		       test    dl, dl
.text:00412753		       jz      short loc_412769
.text:00412755		       cmp     dl, [ecx]
.text:00412757		       jnz     short loc_412769
.text:00412759		       inc     eax
.text:0041275A		       inc     ecx
.text:0041275B		       inc     [ebp+n]
.text:0041275E
.text:0041275E loc_41275E:			       ; CODE XREF: _strncmp+68j
.text:0041275E					       ; _strncmp+98j
.text:0041275E		       cmp     [ebp+n],	ebx
.text:00412761		       jb      short loc_41274F
.text:00412763		       xor     eax, eax
.text:00412765
.text:00412765 loc_412765:			       ; CODE XREF: _strncmp+BCj
.text:00412765		       pop     edi
.text:00412766
.text:00412766 loc_412766:			       ; CODE XREF: _strncmp+12j
.text:00412766		       pop     ebx
.text:00412767		       leave
.text:00412768		       retn
.text:00412769 ; ---------------------------------------------------------------------------
.text:00412769
.text:00412769 loc_412769:			       ; CODE XREF: _strncmp+9Ej
.text:00412769					       ; _strncmp+A2j
.text:00412769		       movzx   eax, byte ptr [eax]
.text:0041276C		       movzx   ecx, byte ptr [ecx]
.text:0041276F
.text:0041276F loc_41276F:			       ; CODE XREF: _strncmp+72j
.text:0041276F					       ; _strncmp+7Cj ...
.text:0041276F		       sub     eax, ecx
.text:00412771		       jmp     short loc_412765
.text:00412771 _strncmp	       endp
.text:00412771
.text:00412771 ; ---------------------------------------------------------------------------
.text:00412773		       align 10h
.text:00412780
.text:00412780 ; =============== S U B R O U T I N E =======================================
.text:00412780
.text:00412780 ; Attributes: bp-based frame
.text:00412780
.text:00412780 ; void __cdecl strpbrk(char *string, char *control)
.text:00412780 _strpbrk	       proc near	       ; CODE XREF: _setlocale_nolock+79p
.text:00412780
.text:00412780 var_24	       = dword ptr -24h
.text:00412780 string	       = dword ptr  8
.text:00412780 control	       = dword ptr  0Ch
.text:00412780
.text:00412780		       push    ebp
.text:00412781		       mov     ebp, esp
.text:00412783		       push    esi
.text:00412784		       xor     eax, eax
.text:00412786		       push    eax
.text:00412787		       push    eax
.text:00412788		       push    eax
.text:00412789		       push    eax
.text:0041278A		       push    eax
.text:0041278B		       push    eax
.text:0041278C		       push    eax
.text:0041278D		       push    eax
.text:0041278E		       mov     edx, [ebp+control]
.text:00412791		       lea     ecx, [ecx+0]
.text:00412794
.text:00412794 listnext_0:			       ; CODE XREF: _strpbrk+21j
.text:00412794		       mov     al, [edx]
.text:00412796		       or      al, al
.text:00412798		       jz      short listdone_0
.text:0041279A		       add     edx, 1
.text:0041279D		       bts     [esp+24h+var_24], eax
.text:004127A1		       jmp     short listnext_0
.text:004127A3 ; ---------------------------------------------------------------------------
.text:004127A3
.text:004127A3 listdone_0:			       ; CODE XREF: _strpbrk+18j
.text:004127A3		       mov     esi, [ebp+string]
.text:004127A6		       mov     edi, edi
.text:004127A8
.text:004127A8 dstnext_0:			       ; CODE XREF: _strpbrk+35j
.text:004127A8		       mov     al, [esi]
.text:004127AA		       or      al, al
.text:004127AC		       jz      short dstdone_0
.text:004127AE		       add     esi, 1
.text:004127B1		       bt      [esp+24h+var_24], eax
.text:004127B5		       jnb     short dstnext_0
.text:004127B7		       lea     eax, [esi-1]
.text:004127BA
.text:004127BA dstdone_0:			       ; CODE XREF: _strpbrk+2Cj
.text:004127BA		       add     esp, 20h
.text:004127BD		       pop     esi
.text:004127BE		       leave
.text:004127BF		       retn
.text:004127BF _strpbrk	       endp
.text:004127BF
.text:004127C0
.text:004127C0 ; =============== S U B R O U T I N E =======================================
.text:004127C0
.text:004127C0 ; Attributes: bp-based frame
.text:004127C0
.text:004127C0 ; __int64 __cdecl _lseeki64_nolock(int fh, __int64 pos, int mthd)
.text:004127C0 __lseeki64_nolock proc near	       ; CODE XREF: __write_nolock+E1p
.text:004127C0					       ; __lseeki64+CDp
.text:004127C0
.text:004127C0 newpos	       = doubleint ptr -8
.text:004127C0 fh	       = dword ptr  8
.text:004127C0 pos	       = qword ptr  0Ch
.text:004127C0 mthd	       = dword ptr  14h
.text:004127C0
.text:004127C0		       push    ebp
.text:004127C1		       mov     ebp, esp
.text:004127C3		       push    ecx
.text:004127C4		       push    ecx
.text:004127C5		       mov     eax, dword ptr [ebp+pos]
.text:004127C8		       push    esi
.text:004127C9		       mov     esi, [ebp+fh]
.text:004127CC		       mov     dword ptr [ebp+newpos], eax
.text:004127CF		       mov     eax, dword ptr [ebp+pos+4]
.text:004127D2		       push    edi
.text:004127D3		       push    esi	       ; fh
.text:004127D4		       mov     dword ptr [ebp+newpos+4], eax
.text:004127D7		       call    __get_osfhandle
.text:004127DC		       or      edi, 0FFFFFFFFh
.text:004127DF		       cmp     eax, edi
.text:004127E1		       pop     ecx
.text:004127E2		       jnz     short loc_4127F5
.text:004127E4		       call    __errno
.text:004127E9		       mov     dword ptr [eax],	9
.text:004127EF
.text:004127EF loc_4127EF:			       ; CODE XREF: __lseeki64_nolock+5Ej
.text:004127EF		       mov     eax, edi
.text:004127F1		       mov     edx, edi
.text:004127F3		       jmp     short loc_41283F
.text:004127F5 ; ---------------------------------------------------------------------------
.text:004127F5
.text:004127F5 loc_4127F5:			       ; CODE XREF: __lseeki64_nolock+22j
.text:004127F5		       push    [ebp+mthd]      ; dwMoveMethod
.text:004127F8		       lea     ecx, [ebp+newpos+4]
.text:004127FB		       push    ecx	       ; lpDistanceToMoveHigh
.text:004127FC		       push    dword ptr [ebp+newpos] ;	lDistanceToMove
.text:004127FF		       push    eax	       ; hFile
.text:00412800		       call    ds:__imp__SetFilePointer@16 ; SetFilePointer(x,x,x,x)
.text:00412806		       cmp     eax, edi
.text:00412808		       mov     dword ptr [ebp+newpos], eax
.text:0041280B		       jnz     short loc_412820
.text:0041280D		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00412813		       test    eax, eax
.text:00412815		       jz      short loc_412820
.text:00412817		       push    eax	       ; oserrno
.text:00412818		       call    __dosmaperr
.text:0041281D		       pop     ecx
.text:0041281E		       jmp     short loc_4127EF
.text:00412820 ; ---------------------------------------------------------------------------
.text:00412820
.text:00412820 loc_412820:			       ; CODE XREF: __lseeki64_nolock+4Bj
.text:00412820					       ; __lseeki64_nolock+55j
.text:00412820		       mov     eax, esi
.text:00412822		       sar     eax, 5
.text:00412825		       mov     eax, ___pioinfo[eax*4]
.text:0041282C		       and     esi, 1Fh
.text:0041282F		       shl     esi, 6
.text:00412832		       lea     eax, [eax+esi+4]
.text:00412836		       and     byte ptr	[eax], 0FDh
.text:00412839		       mov     eax, dword ptr [ebp+newpos]
.text:0041283C		       mov     edx, dword ptr [ebp+newpos+4]
.text:0041283F
.text:0041283F loc_41283F:			       ; CODE XREF: __lseeki64_nolock+33j
.text:0041283F		       pop     edi
.text:00412840		       pop     esi
.text:00412841		       leave
.text:00412842		       retn
.text:00412842 __lseeki64_nolock endp
.text:00412842
.text:00412843
.text:00412843 ; =============== S U B R O U T I N E =======================================
.text:00412843
.text:00412843 ; Attributes: bp-based frame
.text:00412843
.text:00412843 ; __int64 __cdecl _lseeki64(int fh, __int64 pos,	int mthd)
.text:00412843 __lseeki64      proc near	       ; CODE XREF: __flsbuf+116p
.text:00412843
.text:00412843 r	       = qword ptr -24h
.text:00412843 _Expr_val       = dword ptr -1Ch
.text:00412843 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00412843 fh	       = dword ptr  8
.text:00412843 pos	       = qword ptr  0Ch
.text:00412843 mthd	       = dword ptr  14h
.text:00412843
.text:00412843		       push    14h
.text:00412845		       push    offset dword_4208D8
.text:0041284A		       call    __SEH_prolog4
.text:0041284F		       or      esi, 0FFFFFFFFh
.text:00412852		       mov     dword ptr [ebp+r], esi
.text:00412855		       mov     dword ptr [ebp+r+4], esi
.text:00412858		       mov     eax, [ebp+fh]
.text:0041285B		       cmp     eax, 0FFFFFFFEh
.text:0041285E		       jnz     short loc_41287C
.text:00412860		       call    ___doserrno
.text:00412865		       and     dword ptr [eax],	0
.text:00412868		       call    __errno
.text:0041286D		       mov     dword ptr [eax],	9
.text:00412873
.text:00412873 loc_412873:			       ; CODE XREF: __lseeki64+66j
.text:00412873		       mov     eax, esi
.text:00412875		       mov     edx, esi
.text:00412877		       jmp     loc_41294C
.text:0041287C ; ---------------------------------------------------------------------------
.text:0041287C
.text:0041287C loc_41287C:			       ; CODE XREF: __lseeki64+1Bj
.text:0041287C		       xor     edi, edi
.text:0041287E		       cmp     eax, edi
.text:00412880		       jl      short loc_41288A
.text:00412882		       cmp     eax, __nhandle
.text:00412888		       jb      short loc_4128AB
.text:0041288A
.text:0041288A loc_41288A:			       ; CODE XREF: __lseeki64+3Dj
.text:0041288A		       call    ___doserrno
.text:0041288F		       mov     [eax], edi
.text:00412891		       call    __errno
.text:00412896		       mov     dword ptr [eax],	9
.text:0041289C		       push    edi	       ; pReserved
.text:0041289D		       push    edi	       ; nLine
.text:0041289E		       push    edi	       ; pszFile
.text:0041289F		       push    edi	       ; pszFunction
.text:004128A0		       push    edi	       ; pszExpression
.text:004128A1		       call    __invalid_parameter
.text:004128A6		       add     esp, 14h
.text:004128A9		       jmp     short loc_412873
.text:004128AB ; ---------------------------------------------------------------------------
.text:004128AB
.text:004128AB loc_4128AB:			       ; CODE XREF: __lseeki64+45j
.text:004128AB		       mov     ecx, eax
.text:004128AD		       sar     ecx, 5
.text:004128B0		       lea     ebx, ds:422F40h[ecx*4]
.text:004128B7		       mov     esi, eax
.text:004128B9		       and     esi, 1Fh
.text:004128BC		       shl     esi, 6
.text:004128BF		       mov     ecx, [ebx]
.text:004128C1		       movzx   ecx, byte ptr [ecx+esi+4]
.text:004128C6		       and     ecx, 1
.text:004128C9		       jnz     short loc_4128F1
.text:004128CB		       call    ___doserrno
.text:004128D0		       mov     [eax], edi
.text:004128D2		       call    __errno
.text:004128D7		       mov     dword ptr [eax],	9
.text:004128DD		       push    edi	       ; pReserved
.text:004128DE		       push    edi	       ; nLine
.text:004128DF		       push    edi	       ; pszFile
.text:004128E0		       push    edi	       ; pszFunction
.text:004128E1		       push    edi	       ; pszExpression
.text:004128E2		       call    __invalid_parameter
.text:004128E7		       add     esp, 14h
.text:004128EA		       or      edx, 0FFFFFFFFh
.text:004128ED		       mov     eax, edx
.text:004128EF		       jmp     short loc_41294C
.text:004128F1 ; ---------------------------------------------------------------------------
.text:004128F1
.text:004128F1 loc_4128F1:			       ; CODE XREF: __lseeki64+86j
.text:004128F1		       push    eax	       ; fh
.text:004128F2		       call    ___lock_fhandle
.text:004128F7		       pop     ecx
.text:004128F8		       mov     [ebp+ms_exc.disabled], edi
.text:004128FB		       mov     eax, [ebx]
.text:004128FD		       test    byte ptr	[eax+esi+4], 1
.text:00412902		       jz      short loc_412920
.text:00412904		       push    [ebp+mthd]      ; mthd
.text:00412907		       push    dword ptr [ebp+pos+4]
.text:0041290A		       push    dword ptr [ebp+pos] ; pos
.text:0041290D		       push    [ebp+fh]	       ; fh
.text:00412910		       call    __lseeki64_nolock
.text:00412915		       add     esp, 10h
.text:00412918		       mov     dword ptr [ebp+r], eax
.text:0041291B		       mov     dword ptr [ebp+r+4], edx
.text:0041291E		       jmp     short loc_41293A
.text:00412920 ; ---------------------------------------------------------------------------
.text:00412920
.text:00412920 loc_412920:			       ; CODE XREF: __lseeki64+BFj
.text:00412920		       call    __errno
.text:00412925		       mov     dword ptr [eax],	9
.text:0041292B		       call    ___doserrno
.text:00412930		       mov     [eax], edi
.text:00412932		       or      dword ptr [ebp+r], 0FFFFFFFFh
.text:00412936		       or      dword ptr [ebp+r+4], 0FFFFFFFFh
.text:0041293A
.text:0041293A loc_41293A:			       ; CODE XREF: __lseeki64+DBj
.text:0041293A		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00412941		       call    $LN12_9
.text:00412946
.text:00412946 $LN15_6:
.text:00412946		       mov     eax, dword ptr [ebp+r]
.text:00412949		       mov     edx, dword ptr [ebp+r+4]
.text:0041294C
.text:0041294C loc_41294C:			       ; CODE XREF: __lseeki64+34j
.text:0041294C					       ; __lseeki64+ACj
.text:0041294C		       call    __SEH_epilog4
.text:00412951		       retn
.text:00412952 ; ---------------------------------------------------------------------------
.text:00412952
.text:00412952 $LN12_9:				       ; CODE XREF: __lseeki64+FEp
.text:00412952					       ; DATA XREF: .rdata:004208F0o
.text:00412952		       push    [ebp+fh]	       ; fh
.text:00412955		       call    __unlock_fhandle
.text:0041295A		       pop     ecx
.text:0041295B
.text:0041295B $LN13_6:
.text:0041295B		       retn
.text:0041295B __lseeki64      endp
.text:0041295B
.text:0041295C
.text:0041295C ; =============== S U B R O U T I N E =======================================
.text:0041295C
.text:0041295C
.text:0041295C ; void __cdecl _getbuf(_iobuf *str)
.text:0041295C __getbuf	       proc near	       ; CODE XREF: __flsbuf+9Cp
.text:0041295C
.text:0041295C str	       = dword ptr  4
.text:0041295C
.text:0041295C		       inc     __cflush
.text:00412962		       push    1000h	       ; cb
.text:00412967		       call    __malloc_crt
.text:0041296C		       test    eax, eax
.text:0041296E		       pop     ecx
.text:0041296F		       mov     ecx, [esp+str]
.text:00412973		       mov     [ecx+8],	eax
.text:00412976		       jz      short loc_412985
.text:00412978		       or      dword ptr [ecx+0Ch], 8
.text:0041297C		       mov     dword ptr [ecx+18h], 1000h
.text:00412983		       jmp     short loc_412996
.text:00412985 ; ---------------------------------------------------------------------------
.text:00412985
.text:00412985 loc_412985:			       ; CODE XREF: __getbuf+1Aj
.text:00412985		       or      dword ptr [ecx+0Ch], 4
.text:00412989		       lea     eax, [ecx+14h]
.text:0041298C		       mov     [ecx+8],	eax
.text:0041298F		       mov     dword ptr [ecx+18h], 2
.text:00412996
.text:00412996 loc_412996:			       ; CODE XREF: __getbuf+27j
.text:00412996		       mov     eax, [ecx+8]
.text:00412999		       and     dword ptr [ecx+4], 0
.text:0041299D		       mov     [ecx], eax
.text:0041299F		       retn
.text:0041299F __getbuf	       endp
.text:0041299F
.text:004129A0
.text:004129A0 ; =============== S U B R O U T I N E =======================================
.text:004129A0
.text:004129A0 ; Attributes: bp-based frame
.text:004129A0
.text:004129A0 ; int __cdecl _iswctype_l(unsigned __int16 c, unsigned __int16 mask, localeinfo_struct *plocinfo)
.text:004129A0 __iswctype_l    proc near	       ; CODE XREF: __iswalpha_l+Dp
.text:004129A0					       ; __iswupper_l+Ap ...
.text:004129A0
.text:004129A0 _loc_update     = _LocaleUpdate ptr -14h
.text:004129A0 d	       = dword ptr -4
.text:004129A0 c	       = word ptr  8
.text:004129A0 mask	       = word ptr  0Ch
.text:004129A0 plocinfo	       = dword ptr  10h
.text:004129A0
.text:004129A0		       push    ebp
.text:004129A1		       mov     ebp, esp
.text:004129A3		       sub     esp, 14h
.text:004129A6		       cmp     [ebp+c],	0FFFFh
.text:004129AC		       jnz     short loc_4129B4
.text:004129AE		       and     [ebp+d],	0
.text:004129B2		       jmp     short loc_412A16
.text:004129B4 ; ---------------------------------------------------------------------------
.text:004129B4
.text:004129B4 loc_4129B4:			       ; CODE XREF: __iswctype_l+Cj
.text:004129B4		       cmp     [ebp+c],	100h
.text:004129BA		       jnb     short loc_4129D6
.text:004129BC		       movzx   eax, [ebp+c]
.text:004129C0		       mov     ecx, __pwctype
.text:004129C6		       mov     ax, [ecx+eax*2]
.text:004129CA		       and     ax, [ebp+mask]
.text:004129CE		       movzx   eax, ax
.text:004129D1		       mov     [ebp+d],	eax
.text:004129D4		       jmp     short loc_412A16
.text:004129D6 ; ---------------------------------------------------------------------------
.text:004129D6
.text:004129D6 loc_4129D6:			       ; CODE XREF: __iswctype_l+1Aj
.text:004129D6		       push    [ebp+plocinfo]  ; plocinfo
.text:004129D9		       lea     ecx, [ebp+_loc_update] ;	this
.text:004129DC		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004129E1		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004129E4		       push    dword ptr [eax+14h] ; lcid
.text:004129E7		       push    dword ptr [eax+4] ; code_page
.text:004129EA		       lea     eax, [ebp+d]
.text:004129ED		       push    eax	       ; lpCharType
.text:004129EE		       push    1	       ; cchSrc
.text:004129F0		       lea     eax, [ebp+c]
.text:004129F3		       push    eax	       ; lpSrcStr
.text:004129F4		       lea     eax, [ebp+_loc_update]
.text:004129F7		       push    1	       ; dwInfoType
.text:004129F9		       push    eax	       ; plocinfo
.text:004129FA		       call    ___crtGetStringTypeW
.text:004129FF		       add     esp, 1Ch
.text:00412A02		       test    eax, eax
.text:00412A04		       jnz     short loc_412A09
.text:00412A06		       and     [ebp+d],	eax
.text:00412A09
.text:00412A09 loc_412A09:			       ; CODE XREF: __iswctype_l+64j
.text:00412A09		       cmp     [ebp+_loc_update.updated], 0
.text:00412A0D		       jz      short loc_412A16
.text:00412A0F		       mov     eax, [ebp+_loc_update.ptd]
.text:00412A12		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00412A16
.text:00412A16 loc_412A16:			       ; CODE XREF: __iswctype_l+12j
.text:00412A16					       ; __iswctype_l+34j ...
.text:00412A16		       movzx   eax, word ptr [ebp+d]
.text:00412A1A		       movzx   ecx, [ebp+mask]
.text:00412A1E		       and     eax, ecx
.text:00412A20		       leave
.text:00412A21		       retn
.text:00412A21 __iswctype_l    endp
.text:00412A21
.text:00412A22
.text:00412A22 ; =============== S U B R O U T I N E =======================================
.text:00412A22
.text:00412A22 ; Attributes: bp-based frame
.text:00412A22
.text:00412A22 ; int __cdecl iswctype(unsigned __int16 c, unsigned __int16 mask)
.text:00412A22 _iswctype       proc near	       ; CODE XREF: _iswalpha+9p
.text:00412A22					       ; _iswupper+6p ...
.text:00412A22
.text:00412A22 d	       = word ptr -4
.text:00412A22 c	       = dword ptr  8
.text:00412A22 mask	       = dword ptr  0Ch
.text:00412A22
.text:00412A22		       push    ebp
.text:00412A23		       mov     ebp, esp
.text:00412A25		       push    ecx
.text:00412A26		       cmp     word ptr	[ebp+c], 0FFFFh
.text:00412A2C		       jnz     short loc_412A32
.text:00412A2E		       xor     eax, eax
.text:00412A30		       leave
.text:00412A31		       retn
.text:00412A32 ; ---------------------------------------------------------------------------
.text:00412A32
.text:00412A32 loc_412A32:			       ; CODE XREF: _iswctype+Aj
.text:00412A32		       cmp     word ptr	[ebp+c], 100h
.text:00412A38		       jnb     short loc_412A50
.text:00412A3A		       movzx   eax, word ptr [ebp+c]
.text:00412A3E		       mov     ecx, __pwctype
.text:00412A44		       movzx   eax, word ptr [ecx+eax*2]
.text:00412A48		       movzx   ecx, word ptr [ebp+mask]
.text:00412A4C		       and     eax, ecx
.text:00412A4E		       leave
.text:00412A4F		       retn
.text:00412A50 ; ---------------------------------------------------------------------------
.text:00412A50
.text:00412A50 loc_412A50:			       ; CODE XREF: _iswctype+16j
.text:00412A50		       cmp     ___locale_changed, 0
.text:00412A57		       jnz     short loc_412A7E
.text:00412A59		       push    ___initiallocinfo.lc_handle+8 ; lcid
.text:00412A5F		       lea     eax, [ebp+d]
.text:00412A62		       push    ___initiallocinfo.lc_codepage ; code_page
.text:00412A68		       push    eax	       ; lpCharType
.text:00412A69		       push    1	       ; cchSrc
.text:00412A6B		       lea     eax, [ebp+c]
.text:00412A6E		       push    eax	       ; lpSrcStr
.text:00412A6F		       push    1	       ; dwInfoType
.text:00412A71		       push    offset ___initiallocalestructinfo ; plocinfo
.text:00412A76		       call    ___crtGetStringTypeW
.text:00412A7B		       add     esp, 1Ch
.text:00412A7E
.text:00412A7E loc_412A7E:			       ; CODE XREF: _iswctype+35j
.text:00412A7E		       push    0	       ; plocinfo
.text:00412A80		       push    [ebp+mask]      ; mask
.text:00412A83		       push    [ebp+c]	       ; c
.text:00412A86		       call    __iswctype_l
.text:00412A8B		       add     esp, 0Ch
.text:00412A8E		       leave
.text:00412A8F		       retn
.text:00412A8F _iswctype       endp
.text:00412A8F
.text:00412A90 ; [00000005 BYTES: COLLAPSED FUNCTION _is_wctype. PRESS KEYPAD "+" TO EXPAND]
.text:00412A95
.text:00412A95 ; =============== S U B R O U T I N E =======================================
.text:00412A95
.text:00412A95 ; Attributes: bp-based frame
.text:00412A95
.text:00412A95 ___report_gsfailure proc	near	       ; CODE XREF: __security_check_cookie(x):failurej
.text:00412A95
.text:00412A95 cookie	       = dword ptr -328h
.text:00412A95 dw	       = dword ptr -320h
.text:00412A95 arg_0	       = byte ptr  8
.text:00412A95
.text:00412A95		       push    ebp
.text:00412A96		       mov     ebp, esp
.text:00412A98		       sub     esp, 328h
.text:00412A9E		       mov     GS_ContextRecord._Eax, eax
.text:00412AA3		       mov     GS_ContextRecord._Ecx, ecx
.text:00412AA9		       mov     GS_ContextRecord._Edx, edx
.text:00412AAF		       mov     GS_ContextRecord._Ebx, ebx
.text:00412AB5		       mov     GS_ContextRecord._Esi, esi
.text:00412ABB		       mov     GS_ContextRecord._Edi, edi
.text:00412AC1		       mov     word ptr	GS_ContextRecord.SegSs,	ss
.text:00412AC8		       mov     word ptr	GS_ContextRecord.SegCs,	cs
.text:00412ACF		       mov     word ptr	GS_ContextRecord.SegDs,	ds
.text:00412AD6		       mov     word ptr	GS_ContextRecord.SegEs,	es
.text:00412ADD		       mov     word ptr	GS_ContextRecord.SegFs,	fs
.text:00412AE4		       mov     word ptr	GS_ContextRecord.SegGs,	gs
.text:00412AEB		       pushf
.text:00412AEC		       pop     GS_ContextRecord.EFlags
.text:00412AF2		       mov     eax, [ebp+0]
.text:00412AF5		       mov     GS_ContextRecord._Ebp, eax
.text:00412AFA		       mov     eax, [ebp+4]
.text:00412AFD		       mov     GS_ContextRecord._Eip, eax
.text:00412B02		       lea     eax, [ebp+arg_0]
.text:00412B05		       mov     GS_ContextRecord._Esp, eax
.text:00412B0A		       mov     eax, [ebp+dw]
.text:00412B10		       mov     GS_ContextRecord.ContextFlags, 10001h
.text:00412B1A		       mov     eax, GS_ContextRecord._Eip
.text:00412B1F		       mov     GS_ExceptionRecord.ExceptionAddress, eax
.text:00412B24		       mov     GS_ExceptionRecord.ExceptionCode, 0C0000409h
.text:00412B2E		       mov     GS_ExceptionRecord.ExceptionFlags, 1
.text:00412B38		       mov     eax, ___security_cookie
.text:00412B3D		       mov     [ebp+cookie], eax
.text:00412B43		       mov     eax, ___security_cookie_complement
.text:00412B48		       mov     [ebp+cookie+4], eax
.text:00412B4E		       call    ds:__imp__IsDebuggerPresent@0 ; IsDebuggerPresent()
.text:00412B54		       mov     DebuggerWasPresent, eax
.text:00412B59		       push    1	       ; _Reserved
.text:00412B5B		       call    __crt_debugger_hook
.text:00412B60		       pop     ecx
.text:00412B61		       push    0	       ; lpTopLevelExceptionFilter
.text:00412B63		       call    ds:__imp__SetUnhandledExceptionFilter@4 ; SetUnhandledExceptionFilter(x)
.text:00412B69		       push    offset GS_ExceptionPointers ; ExceptionInfo
.text:00412B6E		       call    ds:__imp__UnhandledExceptionFilter@4 ; UnhandledExceptionFilter(x)
.text:00412B74		       cmp     DebuggerWasPresent, 0
.text:00412B7B		       jnz     short loc_412B85
.text:00412B7D		       push    1	       ; _Reserved
.text:00412B7F		       call    __crt_debugger_hook
.text:00412B84		       pop     ecx
.text:00412B85
.text:00412B85 loc_412B85:			       ; CODE XREF: ___report_gsfailure+E6j
.text:00412B85		       push    0C0000409h      ; uExitCode
.text:00412B8A		       call    ds:__imp__GetCurrentProcess@0 ; GetCurrentProcess()
.text:00412B90		       push    eax	       ; hProcess
.text:00412B91		       call    ds:__imp__TerminateProcess@8 ; TerminateProcess(x,x)
.text:00412B97		       leave
.text:00412B98		       retn
.text:00412B98 ___report_gsfailure endp
.text:00412B98
.text:00412B99
.text:00412B99 ; =============== S U B R O U T I N E =======================================
.text:00412B99
.text:00412B99 ; Attributes: bp-based frame
.text:00412B99
.text:00412B99 ; void __cdecl fastzero_I(void *dst, int	len)
.text:00412B99 fastzero_I      proc near	       ; CODE XREF: __VEC_memzero+31p
.text:00412B99
.text:00412B99 var_4	       = dword ptr -4
.text:00412B99 dst	       = dword ptr  8
.text:00412B99 len	       = dword ptr  0Ch
.text:00412B99
.text:00412B99		       push    ebp
.text:00412B9A		       mov     ebp, esp
.text:00412B9C		       sub     esp, 4
.text:00412B9F		       mov     [ebp+var_4], edi
.text:00412BA2		       mov     edi, [ebp+dst]
.text:00412BA5		       mov     ecx, [ebp+len]
.text:00412BA8		       shr     ecx, 7
.text:00412BAB		       pxor    xmm0, xmm0
.text:00412BAF		       jmp     short L_1
.text:00412BAF ; ---------------------------------------------------------------------------
.text:00412BB1		       db 8Dh, 0A4h, 24h, 4 dup(0)
.text:00412BB8		       db 90h
.text:00412BB9 ; ---------------------------------------------------------------------------
.text:00412BB9
.text:00412BB9 L_1:				       ; CODE XREF: fastzero_I+16j
.text:00412BB9					       ; fastzero_I+4Ej
.text:00412BB9		       movdqa  xmmword ptr [edi], xmm0
.text:00412BBD		       movdqa  xmmword ptr [edi+10h], xmm0
.text:00412BC2		       movdqa  xmmword ptr [edi+20h], xmm0
.text:00412BC7		       movdqa  xmmword ptr [edi+30h], xmm0
.text:00412BCC		       movdqa  xmmword ptr [edi+40h], xmm0
.text:00412BD1		       movdqa  xmmword ptr [edi+50h], xmm0
.text:00412BD6		       movdqa  xmmword ptr [edi+60h], xmm0
.text:00412BDB		       movdqa  xmmword ptr [edi+70h], xmm0
.text:00412BE0		       lea     edi, [edi+80h]
.text:00412BE6		       dec     ecx
.text:00412BE7		       jnz     short L_1
.text:00412BE9		       mov     edi, [ebp+var_4]
.text:00412BEC		       mov     esp, ebp
.text:00412BEE		       pop     ebp
.text:00412BEF		       retn
.text:00412BEF fastzero_I      endp
.text:00412BEF
.text:00412BF0
.text:00412BF0 ; =============== S U B R O U T I N E =======================================
.text:00412BF0
.text:00412BF0 ; Attributes: bp-based frame
.text:00412BF0
.text:00412BF0 ; void *__cdecl _VEC_memzero(void *dst, int val,	int len)
.text:00412BF0 __VEC_memzero   proc near	       ; CODE XREF: _memset+27j
.text:00412BF0					       ; __VEC_memzero+7Dp
.text:00412BF0
.text:00412BF0 var_10	       = dword ptr -10h
.text:00412BF0 var_C	       = dword ptr -0Ch
.text:00412BF0 var_8	       = dword ptr -8
.text:00412BF0 var_4	       = dword ptr -4
.text:00412BF0 dst	       = dword ptr  8
.text:00412BF0 val	       = dword ptr  0Ch
.text:00412BF0 len	       = dword ptr  10h
.text:00412BF0
.text:00412BF0		       push    ebp
.text:00412BF1		       mov     ebp, esp
.text:00412BF3		       sub     esp, 10h
.text:00412BF6		       mov     [ebp+var_4], edi
.text:00412BF9		       mov     eax, [ebp+dst]
.text:00412BFC		       cdq
.text:00412BFD		       mov     edi, eax
.text:00412BFF		       xor     edi, edx
.text:00412C01		       sub     edi, edx
.text:00412C03		       and     edi, 0Fh
.text:00412C06		       xor     edi, edx
.text:00412C08		       sub     edi, edx
.text:00412C0A		       test    edi, edi
.text:00412C0C		       jnz     short L_notaligned
.text:00412C0E		       mov     ecx, [ebp+len]
.text:00412C11		       mov     edx, ecx
.text:00412C13		       and     edx, 7Fh
.text:00412C16		       mov     [ebp+var_C], edx
.text:00412C19		       cmp     ecx, edx
.text:00412C1B		       jz      short L_trailing
.text:00412C1D		       sub     ecx, edx
.text:00412C1F		       push    ecx	       ; len
.text:00412C20		       push    eax	       ; dst
.text:00412C21		       call    fastzero_I
.text:00412C26		       add     esp, 8
.text:00412C29		       mov     eax, [ebp+dst]
.text:00412C2C		       mov     edx, [ebp+var_C]
.text:00412C2F
.text:00412C2F L_trailing:			       ; CODE XREF: __VEC_memzero+2Bj
.text:00412C2F		       test    edx, edx
.text:00412C31		       jz      short L_return
.text:00412C33		       add     eax, [ebp+len]
.text:00412C36		       sub     eax, edx
.text:00412C38		       mov     [ebp+var_8], eax
.text:00412C3B		       xor     eax, eax
.text:00412C3D		       mov     edi, [ebp+var_8]
.text:00412C40		       mov     ecx, [ebp+var_C]
.text:00412C43		       rep stosb
.text:00412C45		       mov     eax, [ebp+dst]
.text:00412C48		       jmp     short L_return
.text:00412C4A ; ---------------------------------------------------------------------------
.text:00412C4A
.text:00412C4A L_notaligned:			       ; CODE XREF: __VEC_memzero+1Cj
.text:00412C4A		       neg     edi
.text:00412C4C		       add     edi, 10h
.text:00412C4F		       mov     [ebp+var_10], edi
.text:00412C52		       xor     eax, eax
.text:00412C54		       mov     edi, [ebp+dst]
.text:00412C57		       mov     ecx, [ebp+var_10]
.text:00412C5A		       rep stosb
.text:00412C5C		       mov     eax, [ebp+var_10]
.text:00412C5F		       mov     ecx, [ebp+dst]
.text:00412C62		       mov     edx, [ebp+len]
.text:00412C65		       add     ecx, eax
.text:00412C67		       sub     edx, eax
.text:00412C69		       push    edx	       ; len
.text:00412C6A		       push    0	       ; val
.text:00412C6C		       push    ecx	       ; dst
.text:00412C6D		       call    __VEC_memzero
.text:00412C72		       add     esp, 0Ch
.text:00412C75		       mov     eax, [ebp+dst]
.text:00412C78
.text:00412C78 L_return:			       ; CODE XREF: __VEC_memzero+41j
.text:00412C78					       ; __VEC_memzero+58j
.text:00412C78		       mov     edi, [ebp+var_4]
.text:00412C7B		       mov     esp, ebp
.text:00412C7D		       pop     ebp
.text:00412C7E		       retn
.text:00412C7E __VEC_memzero   endp
.text:00412C7E
.text:00412C7F
.text:00412C7F ; =============== S U B R O U T I N E =======================================
.text:00412C7F
.text:00412C7F
.text:00412C7F ; int __cdecl _sse2_mathfcns_init()
.text:00412C7F __sse2_mathfcns_init proc near	       ; DATA XREF: .rdata:pinit_2o
.text:00412C7F		       and     ___use_sse2_mathfcns, 0
.text:00412C86		       call    __get_sse2_info
.text:00412C8B		       mov     ___use_sse2_mathfcns, eax
.text:00412C90		       xor     eax, eax
.text:00412C92		       retn
.text:00412C92 __sse2_mathfcns_init endp
.text:00412C92
.text:00412C93
.text:00412C93 ; =============== S U B R O U T I N E =======================================
.text:00412C93
.text:00412C93
.text:00412C93 ; int __cdecl _set_SSE2_enable(int flag)
.text:00412C93 __set_SSE2_enable proc near
.text:00412C93
.text:00412C93 flag	       = dword ptr  4
.text:00412C93
.text:00412C93		       mov     eax, [esp+flag]
.text:00412C97		       neg     eax
.text:00412C99		       sbb     eax, eax
.text:00412C9B		       and     eax, ___sse2_available
.text:00412CA1		       mov     ___use_sse2_mathfcns, eax
.text:00412CA6		       retn
.text:00412CA6 __set_SSE2_enable endp
.text:00412CA6
.text:00412CA6 ; ---------------------------------------------------------------------------
.text:00412CA7		       align 4
.text:00412CA8
.text:00412CA8 ; =============== S U B R O U T I N E =======================================
.text:00412CA8
.text:00412CA8 ; Attributes: bp-based frame
.text:00412CA8
.text:00412CA8 __global_unwind2	proc near
.text:00412CA8
.text:00412CA8 arg_0	       = dword ptr  8
.text:00412CA8
.text:00412CA8		       push    ebp
.text:00412CA9		       mov     ebp, esp
.text:00412CAB		       push    ebx
.text:00412CAC		       push    esi
.text:00412CAD		       push    edi
.text:00412CAE		       push    ebp
.text:00412CAF		       push    0
.text:00412CB1		       push    0
.text:00412CB3		       push    offset _gu_return
.text:00412CB8		       push    [ebp+arg_0]
.text:00412CBB		       call    _RtlUnwind@16   ; RtlUnwind(x,x,x,x)
.text:00412CC0
.text:00412CC0 _gu_return:			       ; DATA XREF: __global_unwind2+Bo
.text:00412CC0		       pop     ebp
.text:00412CC1		       pop     edi
.text:00412CC2		       pop     esi
.text:00412CC3		       pop     ebx
.text:00412CC4		       mov     esp, ebp
.text:00412CC6		       pop     ebp
.text:00412CC7		       retn
.text:00412CC7 __global_unwind2	endp
.text:00412CC7
.text:00412CC8
.text:00412CC8 ; =============== S U B R O U T I N E =======================================
.text:00412CC8
.text:00412CC8
.text:00412CC8 __unwind_handler	proc near	       ; DATA XREF: __local_unwind2+Bo
.text:00412CC8					       ; __abnormal_termination+9o
.text:00412CC8
.text:00412CC8 arg_0	       = dword ptr  4
.text:00412CC8 arg_4	       = dword ptr  8
.text:00412CC8 arg_C	       = dword ptr  10h
.text:00412CC8 arg_10	       = dword ptr  14h
.text:00412CC8
.text:00412CC8		       mov     ecx, [esp+arg_0]
.text:00412CCC		       test    dword ptr [ecx+4], 6
.text:00412CD3		       mov     eax, 1
.text:00412CD8		       jz      short _uh_return
.text:00412CDA		       mov     eax, [esp+arg_10]
.text:00412CDE		       mov     ecx, [eax-4]
.text:00412CE1		       xor     ecx, eax	       ; cookie
.text:00412CE3		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00412CE8		       push    ebp
.text:00412CE9		       mov     ebp, [eax+10h]
.text:00412CEC		       mov     edx, [eax+28h]
.text:00412CEF		       push    edx
.text:00412CF0		       mov     edx, [eax+24h]
.text:00412CF3		       push    edx
.text:00412CF4		       call    __local_unwind2
.text:00412CF9		       add     esp, 8
.text:00412CFC		       pop     ebp
.text:00412CFD		       mov     eax, [esp+arg_4]
.text:00412D01		       mov     edx, [esp+arg_C]
.text:00412D05		       mov     [edx], eax
.text:00412D07		       mov     eax, 3
.text:00412D0C
.text:00412D0C _uh_return:			       ; CODE XREF: __unwind_handler+10j
.text:00412D0C		       retn
.text:00412D0C __unwind_handler	endp
.text:00412D0C
.text:00412D0D
.text:00412D0D ; =============== S U B R O U T I N E =======================================
.text:00412D0D
.text:00412D0D
.text:00412D0D __local_unwind2 proc near	       ; CODE XREF: __unwind_handler+2Cp
.text:00412D0D
.text:00412D0D var_20	       = dword ptr -20h
.text:00412D0D var_18	       = dword ptr -18h
.text:00412D0D arg_0	       = dword ptr  4
.text:00412D0D arg_4	       = dword ptr  8
.text:00412D0D
.text:00412D0D		       push    ebx
.text:00412D0E		       push    esi
.text:00412D0F		       push    edi
.text:00412D10		       mov     eax, [esp+0Ch+arg_0]
.text:00412D14		       push    ebp
.text:00412D15		       push    eax
.text:00412D16		       push    0FFFFFFFEh
.text:00412D18		       push    offset __unwind_handler
.text:00412D1D		       push    large dword ptr fs:0
.text:00412D24		       mov     eax, ___security_cookie
.text:00412D29		       xor     eax, esp
.text:00412D2B		       push    eax
.text:00412D2C		       lea     eax, [esp+24h+var_20]
.text:00412D30		       mov     large fs:0, eax
.text:00412D36
.text:00412D36 _lu_top_0:			       ; CODE XREF: __local_unwind2:_lu_continuej
.text:00412D36		       mov     eax, [esp+24h+arg_0]
.text:00412D3A		       mov     ebx, [eax+8]
.text:00412D3D		       mov     esi, [eax+0Ch]
.text:00412D40		       cmp     esi, 0FFFFFFFFh
.text:00412D43		       jz      short _lu_done_0
.text:00412D45		       cmp     [esp+24h+arg_4],	0FFFFFFFFh
.text:00412D4A		       jz      short _continue_
.text:00412D4C		       cmp     esi, [esp+24h+arg_4]
.text:00412D50		       jbe     short _lu_done_0
.text:00412D52
.text:00412D52 _continue_:			       ; CODE XREF: __local_unwind2+3Dj
.text:00412D52		       lea     esi, [esi+esi*2]
.text:00412D55		       mov     ecx, [ebx+esi*4]
.text:00412D58		       mov     [esp+24h+var_18], ecx
.text:00412D5C		       mov     [eax+0Ch], ecx
.text:00412D5F		       cmp     dword ptr [ebx+esi*4+4],	0
.text:00412D64		       jnz     short _lu_continue
.text:00412D66		       push    101h
.text:00412D6B		       mov     eax, [ebx+esi*4+8]
.text:00412D6F		       call    __NLG_Notify
.text:00412D74		       mov     eax, [ebx+esi*4+8]
.text:00412D78		       call    __NLG_Call
.text:00412D7D
.text:00412D7D _lu_continue:			       ; CODE XREF: __local_unwind2+57j
.text:00412D7D		       jmp     short _lu_top_0
.text:00412D7F ; ---------------------------------------------------------------------------
.text:00412D7F
.text:00412D7F _lu_done_0:			       ; CODE XREF: __local_unwind2+36j
.text:00412D7F					       ; __local_unwind2+43j
.text:00412D7F		       mov     ecx, [esp+24h+var_20]
.text:00412D83		       mov     large fs:0, ecx
.text:00412D8A		       add     esp, 18h
.text:00412D8D		       pop     edi
.text:00412D8E		       pop     esi
.text:00412D8F		       pop     ebx
.text:00412D90		       retn
.text:00412D90 __local_unwind2 endp
.text:00412D90
.text:00412D91
.text:00412D91 ; =============== S U B R O U T I N E =======================================
.text:00412D91
.text:00412D91
.text:00412D91 ; int __cdecl _abnormal_termination()
.text:00412D91 __abnormal_termination proc near
.text:00412D91		       xor     eax, eax
.text:00412D93		       mov     ecx, large fs:0
.text:00412D9A		       cmp     dword ptr [ecx+4], offset __unwind_handler
.text:00412DA1		       jnz     short _at_done
.text:00412DA3		       mov     edx, [ecx+0Ch]
.text:00412DA6		       mov     edx, [edx+0Ch]
.text:00412DA9		       cmp     [ecx+8],	edx
.text:00412DAC		       jnz     short _at_done
.text:00412DAE		       mov     eax, 1
.text:00412DB3
.text:00412DB3 _at_done:			       ; CODE XREF: __abnormal_termination+10j
.text:00412DB3					       ; __abnormal_termination+1Bj
.text:00412DB3		       retn
.text:00412DB3 __abnormal_termination endp
.text:00412DB3
.text:00412DB4
.text:00412DB4 ; =============== S U B R O U T I N E =======================================
.text:00412DB4
.text:00412DB4
.text:00412DB4 __NLG_Notify1   proc near
.text:00412DB4		       push    ebx
.text:00412DB5		       push    ecx
.text:00412DB6		       mov     ebx, offset __NLG_Destination
.text:00412DBB		       jmp     short __NLG_Go
.text:00412DBB __NLG_Notify1   endp
.text:00412DBB
.text:00412DBD
.text:00412DBD ; =============== S U B R O U T I N E =======================================
.text:00412DBD
.text:00412DBD
.text:00412DBD __NLG_Notify    proc near	       ; CODE XREF: __local_unwind4+6Ep
.text:00412DBD					       ; _EH4_TransferToHandler(x,x)+8p ...
.text:00412DBD
.text:00412DBD arg_0	       = dword ptr  4
.text:00412DBD
.text:00412DBD		       push    ebx
.text:00412DBE		       push    ecx
.text:00412DBF		       mov     ebx, offset __NLG_Destination
.text:00412DC4		       mov     ecx, [esp+8+arg_0]
.text:00412DC8
.text:00412DC8 __NLG_Go:			       ; CODE XREF: __NLG_Notify1+7j
.text:00412DC8		       mov     [ebx+8],	ecx
.text:00412DCB		       mov     [ebx+4],	eax
.text:00412DCE		       mov     [ebx+0Ch], ebp
.text:00412DD1		       push    ebp
.text:00412DD2		       push    ecx
.text:00412DD3		       push    eax
.text:00412DD4
.text:00412DD4 __NLG_Dispatch2:
.text:00412DD4		       pop     eax
.text:00412DD5		       pop     ecx
.text:00412DD6		       pop     ebp
.text:00412DD7		       pop     ecx
.text:00412DD8		       pop     ebx
.text:00412DD9		       retn    4
.text:00412DD9 __NLG_Notify    endp
.text:00412DD9
.text:00412DDC
.text:00412DDC ; =============== S U B R O U T I N E =======================================
.text:00412DDC
.text:00412DDC
.text:00412DDC __NLG_Call      proc near	       ; CODE XREF: __local_unwind4+7Bp
.text:00412DDC					       ; __local_unwind2+6Bp
.text:00412DDC		       call    eax
.text:00412DDE
.text:00412DDE __NLG_Return2:
.text:00412DDE		       retn
.text:00412DDE __NLG_Call      endp
.text:00412DDE
.text:00412DDF
.text:00412DDF ; =============== S U B R O U T I N E =======================================
.text:00412DDF
.text:00412DDF ; Attributes: bp-based frame
.text:00412DDF
.text:00412DDF ; unsigned int __cdecl strtoxl(localeinfo_struct	*plocinfo, const char *nptr, const char	**endptr, int ibase, int flags)
.text:00412DDF strtoxl	       proc near	       ; CODE XREF: _strtol:loc_413029p
.text:00412DDF					       ; __strtol_l+12p ...
.text:00412DDF
.text:00412DDF _loc_update     = _LocaleUpdate ptr -14h
.text:00412DDF number	       = dword ptr -4
.text:00412DDF plocinfo	       = dword ptr  8
.text:00412DDF nptr	       = dword ptr  0Ch
.text:00412DDF endptr	       = dword ptr  10h
.text:00412DDF ibase	       = dword ptr  14h
.text:00412DDF flags	       = dword ptr  18h
.text:00412DDF
.text:00412DDF		       push    ebp
.text:00412DE0		       mov     ebp, esp
.text:00412DE2		       sub     esp, 14h
.text:00412DE5		       push    esi
.text:00412DE6		       push    edi
.text:00412DE7		       push    [ebp+plocinfo]  ; plocinfo
.text:00412DEA		       lea     ecx, [ebp+_loc_update] ;	this
.text:00412DED		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00412DF2		       mov     eax, [ebp+endptr]
.text:00412DF5		       mov     esi, [ebp+nptr]
.text:00412DF8		       xor     edi, edi
.text:00412DFA		       cmp     eax, edi
.text:00412DFC		       jz      short loc_412E00
.text:00412DFE		       mov     [eax], esi
.text:00412E00
.text:00412E00 loc_412E00:			       ; CODE XREF: strtoxl+1Dj
.text:00412E00		       cmp     esi, edi
.text:00412E02		       jnz     short loc_412E30
.text:00412E04
.text:00412E04 loc_412E04:			       ; CODE XREF: strtoxl+5Aj
.text:00412E04					       ; strtoxl+60j
.text:00412E04		       call    __errno
.text:00412E09		       push    edi	       ; pReserved
.text:00412E0A		       push    edi	       ; nLine
.text:00412E0B		       push    edi	       ; pszFile
.text:00412E0C		       push    edi	       ; pszFunction
.text:00412E0D		       push    edi	       ; pszExpression
.text:00412E0E		       mov     dword ptr [eax],	16h
.text:00412E14		       call    __invalid_parameter
.text:00412E19		       add     esp, 14h
.text:00412E1C		       cmp     [ebp+_loc_update.updated], 0
.text:00412E20		       jz      short loc_412E29
.text:00412E22		       mov     eax, [ebp+_loc_update.ptd]
.text:00412E25		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00412E29
.text:00412E29 loc_412E29:			       ; CODE XREF: strtoxl+41j
.text:00412E29		       xor     eax, eax
.text:00412E2B		       jmp     loc_413006
.text:00412E30 ; ---------------------------------------------------------------------------
.text:00412E30
.text:00412E30 loc_412E30:			       ; CODE XREF: strtoxl+23j
.text:00412E30		       cmp     [ebp+ibase], edi
.text:00412E33		       jz      short loc_412E41
.text:00412E35		       cmp     [ebp+ibase], 2
.text:00412E39		       jl      short loc_412E04
.text:00412E3B		       cmp     [ebp+ibase], 24h
.text:00412E3F		       jg      short loc_412E04
.text:00412E41
.text:00412E41 loc_412E41:			       ; CODE XREF: strtoxl+54j
.text:00412E41		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:00412E44		       push    ebx
.text:00412E45		       mov     bl, [esi]
.text:00412E47		       mov     [ebp+number], edi
.text:00412E4A		       lea     edi, [esi+1]
.text:00412E4D
.text:00412E4D loc_412E4D:			       ; CODE XREF: strtoxl+A5j
.text:00412E4D		       cmp     dword ptr [ecx+0ACh], 1
.text:00412E54		       jle     short loc_412E6D
.text:00412E56		       lea     eax, [ebp+_loc_update]
.text:00412E59		       push    eax	       ; plocinfo
.text:00412E5A		       movzx   eax, bl
.text:00412E5D		       push    8	       ; mask
.text:00412E5F		       push    eax	       ; c
.text:00412E60		       call    __isctype_l
.text:00412E65		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:00412E68		       add     esp, 0Ch
.text:00412E6B		       jmp     short loc_412E7D
.text:00412E6D ; ---------------------------------------------------------------------------
.text:00412E6D
.text:00412E6D loc_412E6D:			       ; CODE XREF: strtoxl+75j
.text:00412E6D		       mov     edx, [ecx+0C8h]
.text:00412E73		       movzx   eax, bl
.text:00412E76		       movzx   eax, byte ptr [edx+eax*2]
.text:00412E7A		       and     eax, 8
.text:00412E7D
.text:00412E7D loc_412E7D:			       ; CODE XREF: strtoxl+8Cj
.text:00412E7D		       test    eax, eax
.text:00412E7F		       jz      short loc_412E86
.text:00412E81		       mov     bl, [edi]
.text:00412E83		       inc     edi
.text:00412E84		       jmp     short loc_412E4D
.text:00412E86 ; ---------------------------------------------------------------------------
.text:00412E86
.text:00412E86 loc_412E86:			       ; CODE XREF: strtoxl+A0j
.text:00412E86		       cmp     bl, 2Dh
.text:00412E89		       jnz     short loc_412E91
.text:00412E8B		       or      [ebp+flags], 2
.text:00412E8F		       jmp     short loc_412E96
.text:00412E91 ; ---------------------------------------------------------------------------
.text:00412E91
.text:00412E91 loc_412E91:			       ; CODE XREF: strtoxl+AAj
.text:00412E91		       cmp     bl, 2Bh
.text:00412E94		       jnz     short loc_412E99
.text:00412E96
.text:00412E96 loc_412E96:			       ; CODE XREF: strtoxl+B0j
.text:00412E96		       mov     bl, [edi]
.text:00412E98		       inc     edi
.text:00412E99
.text:00412E99 loc_412E99:			       ; CODE XREF: strtoxl+B5j
.text:00412E99		       mov     eax, [ebp+ibase]
.text:00412E9C		       test    eax, eax
.text:00412E9E		       jl      loc_412FED
.text:00412EA4		       cmp     eax, 1
.text:00412EA7		       jz      loc_412FED
.text:00412EAD		       cmp     eax, 24h
.text:00412EB0		       jg      loc_412FED
.text:00412EB6		       test    eax, eax
.text:00412EB8		       jnz     short loc_412EE4
.text:00412EBA		       cmp     bl, 30h
.text:00412EBD		       jz      short loc_412EC8
.text:00412EBF		       mov     [ebp+ibase], 0Ah
.text:00412EC6		       jmp     short loc_412EFC
.text:00412EC8 ; ---------------------------------------------------------------------------
.text:00412EC8
.text:00412EC8 loc_412EC8:			       ; CODE XREF: strtoxl+DEj
.text:00412EC8		       mov     al, [edi]
.text:00412ECA		       cmp     al, 78h
.text:00412ECC		       jz      short loc_412EDB
.text:00412ECE		       cmp     al, 58h
.text:00412ED0		       jz      short loc_412EDB
.text:00412ED2		       mov     [ebp+ibase], 8
.text:00412ED9		       jmp     short loc_412EFC
.text:00412EDB ; ---------------------------------------------------------------------------
.text:00412EDB
.text:00412EDB loc_412EDB:			       ; CODE XREF: strtoxl+EDj
.text:00412EDB					       ; strtoxl+F1j
.text:00412EDB		       mov     [ebp+ibase], 10h
.text:00412EE2		       jmp     short loc_412EEE
.text:00412EE4 ; ---------------------------------------------------------------------------
.text:00412EE4
.text:00412EE4 loc_412EE4:			       ; CODE XREF: strtoxl+D9j
.text:00412EE4		       cmp     eax, 10h
.text:00412EE7		       jnz     short loc_412EFC
.text:00412EE9		       cmp     bl, 30h
.text:00412EEC		       jnz     short loc_412EFC
.text:00412EEE
.text:00412EEE loc_412EEE:			       ; CODE XREF: strtoxl+103j
.text:00412EEE		       mov     al, [edi]
.text:00412EF0		       cmp     al, 78h
.text:00412EF2		       jz      short loc_412EF8
.text:00412EF4		       cmp     al, 58h
.text:00412EF6		       jnz     short loc_412EFC
.text:00412EF8
.text:00412EF8 loc_412EF8:			       ; CODE XREF: strtoxl+113j
.text:00412EF8		       inc     edi
.text:00412EF9		       mov     bl, [edi]
.text:00412EFB		       inc     edi
.text:00412EFC
.text:00412EFC loc_412EFC:			       ; CODE XREF: strtoxl+E7j
.text:00412EFC					       ; strtoxl+FAj ...
.text:00412EFC		       mov     esi, [ecx+0C8h]
.text:00412F02		       or      eax, 0FFFFFFFFh
.text:00412F05		       xor     edx, edx
.text:00412F07		       div     [ebp+ibase]
.text:00412F0A
.text:00412F0A loc_412F0A:			       ; CODE XREF: strtoxl+19Dj
.text:00412F0A		       movzx   ecx, bl
.text:00412F0D		       movzx   ecx, word ptr [esi+ecx*2]
.text:00412F11		       test    cl, 4
.text:00412F14		       jz      short loc_412F1E
.text:00412F16		       movsx   ecx, bl
.text:00412F19		       sub     ecx, 30h
.text:00412F1C		       jmp     short loc_412F38
.text:00412F1E ; ---------------------------------------------------------------------------
.text:00412F1E
.text:00412F1E loc_412F1E:			       ; CODE XREF: strtoxl+135j
.text:00412F1E		       test    cx, 103h
.text:00412F23		       jz      short loc_412F56
.text:00412F25		       mov     cl, bl
.text:00412F27		       sub     cl, 61h
.text:00412F2A		       cmp     cl, 19h
.text:00412F2D		       movsx   ecx, bl
.text:00412F30		       ja      short loc_412F35
.text:00412F32		       sub     ecx, 20h
.text:00412F35
.text:00412F35 loc_412F35:			       ; CODE XREF: strtoxl+151j
.text:00412F35		       add     ecx, 0FFFFFFC9h
.text:00412F38
.text:00412F38 loc_412F38:			       ; CODE XREF: strtoxl+13Dj
.text:00412F38		       cmp     ecx, [ebp+ibase]
.text:00412F3B		       jnb     short loc_412F56
.text:00412F3D		       or      [ebp+flags], 8
.text:00412F41		       cmp     [ebp+number], eax
.text:00412F44		       jb      short loc_412F6D
.text:00412F46		       jnz     short loc_412F4C
.text:00412F48		       cmp     ecx, edx
.text:00412F4A		       jbe     short loc_412F6D
.text:00412F4C
.text:00412F4C loc_412F4C:			       ; CODE XREF: strtoxl+167j
.text:00412F4C		       or      [ebp+flags], 4
.text:00412F50		       cmp     [ebp+endptr], 0
.text:00412F54		       jnz     short loc_412F79
.text:00412F56
.text:00412F56 loc_412F56:			       ; CODE XREF: strtoxl+144j
.text:00412F56					       ; strtoxl+15Cj
.text:00412F56		       mov     eax, [ebp+flags]
.text:00412F59		       dec     edi
.text:00412F5A		       test    al, 8
.text:00412F5C		       jnz     short loc_412F7E
.text:00412F5E		       cmp     [ebp+endptr], 0
.text:00412F62		       jz      short loc_412F67
.text:00412F64		       mov     edi, [ebp+nptr]
.text:00412F67
.text:00412F67 loc_412F67:			       ; CODE XREF: strtoxl+183j
.text:00412F67		       and     [ebp+number], 0
.text:00412F6B		       jmp     short loc_412FC9
.text:00412F6D ; ---------------------------------------------------------------------------
.text:00412F6D
.text:00412F6D loc_412F6D:			       ; CODE XREF: strtoxl+165j
.text:00412F6D					       ; strtoxl+16Bj
.text:00412F6D		       mov     ebx, [ebp+number]
.text:00412F70		       imul    ebx, [ebp+ibase]
.text:00412F74		       add     ebx, ecx
.text:00412F76		       mov     [ebp+number], ebx
.text:00412F79
.text:00412F79 loc_412F79:			       ; CODE XREF: strtoxl+175j
.text:00412F79		       mov     bl, [edi]
.text:00412F7B		       inc     edi
.text:00412F7C		       jmp     short loc_412F0A
.text:00412F7E ; ---------------------------------------------------------------------------
.text:00412F7E
.text:00412F7E loc_412F7E:			       ; CODE XREF: strtoxl+17Dj
.text:00412F7E		       test    al, 4
.text:00412F80		       mov     esi, 7FFFFFFFh
.text:00412F85		       jnz     short loc_412FA2
.text:00412F87		       test    al, 1
.text:00412F89		       jnz     short loc_412FC9
.text:00412F8B		       and     eax, 2
.text:00412F8E		       jz      short loc_412F99
.text:00412F90		       cmp     [ebp+number], 80000000h
.text:00412F97		       ja      short loc_412FA2
.text:00412F99
.text:00412F99 loc_412F99:			       ; CODE XREF: strtoxl+1AFj
.text:00412F99		       test    eax, eax
.text:00412F9B		       jnz     short loc_412FC9
.text:00412F9D		       cmp     [ebp+number], esi
.text:00412FA0		       jbe     short loc_412FC9
.text:00412FA2
.text:00412FA2 loc_412FA2:			       ; CODE XREF: strtoxl+1A6j
.text:00412FA2					       ; strtoxl+1B8j
.text:00412FA2		       call    __errno
.text:00412FA7		       test    byte ptr	[ebp+flags], 1
.text:00412FAB		       mov     dword ptr [eax],	22h
.text:00412FB1		       jz      short loc_412FB9
.text:00412FB3		       or      [ebp+number], 0FFFFFFFFh
.text:00412FB7		       jmp     short loc_412FC9
.text:00412FB9 ; ---------------------------------------------------------------------------
.text:00412FB9
.text:00412FB9 loc_412FB9:			       ; CODE XREF: strtoxl+1D2j
.text:00412FB9		       mov     al, byte	ptr [ebp+flags]
.text:00412FBC		       and     al, 2
.text:00412FBE		       neg     al
.text:00412FC0		       sbb     eax, eax
.text:00412FC2		       neg     eax
.text:00412FC4		       add     eax, esi
.text:00412FC6		       mov     [ebp+number], eax
.text:00412FC9
.text:00412FC9 loc_412FC9:			       ; CODE XREF: strtoxl+18Cj
.text:00412FC9					       ; strtoxl+1AAj ...
.text:00412FC9		       mov     eax, [ebp+endptr]
.text:00412FCC		       test    eax, eax
.text:00412FCE		       jz      short loc_412FD2
.text:00412FD0		       mov     [eax], edi
.text:00412FD2
.text:00412FD2 loc_412FD2:			       ; CODE XREF: strtoxl+1EFj
.text:00412FD2		       test    byte ptr	[ebp+flags], 2
.text:00412FD6		       jz      short loc_412FDB
.text:00412FD8		       neg     [ebp+number]
.text:00412FDB
.text:00412FDB loc_412FDB:			       ; CODE XREF: strtoxl+1F7j
.text:00412FDB		       cmp     [ebp+_loc_update.updated], 0
.text:00412FDF		       jz      short loc_412FE8
.text:00412FE1		       mov     eax, [ebp+_loc_update.ptd]
.text:00412FE4		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00412FE8
.text:00412FE8 loc_412FE8:			       ; CODE XREF: strtoxl+200j
.text:00412FE8		       mov     eax, [ebp+number]
.text:00412FEB		       jmp     short loc_413005
.text:00412FED ; ---------------------------------------------------------------------------
.text:00412FED
.text:00412FED loc_412FED:			       ; CODE XREF: strtoxl+BFj
.text:00412FED					       ; strtoxl+C8j ...
.text:00412FED		       mov     eax, [ebp+endptr]
.text:00412FF0		       test    eax, eax
.text:00412FF2		       jz      short loc_412FF6
.text:00412FF4		       mov     [eax], esi
.text:00412FF6
.text:00412FF6 loc_412FF6:			       ; CODE XREF: strtoxl+213j
.text:00412FF6		       cmp     [ebp+_loc_update.updated], 0
.text:00412FFA		       jz      short loc_413003
.text:00412FFC		       mov     eax, [ebp+_loc_update.ptd]
.text:00412FFF		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00413003
.text:00413003 loc_413003:			       ; CODE XREF: strtoxl+21Bj
.text:00413003		       xor     eax, eax
.text:00413005
.text:00413005 loc_413005:			       ; CODE XREF: strtoxl+20Cj
.text:00413005		       pop     ebx
.text:00413006
.text:00413006 loc_413006:			       ; CODE XREF: strtoxl+4Cj
.text:00413006		       pop     edi
.text:00413007		       pop     esi
.text:00413008		       leave
.text:00413009		       retn
.text:00413009 strtoxl	       endp
.text:00413009
.text:0041300A
.text:0041300A ; =============== S U B R O U T I N E =======================================
.text:0041300A
.text:0041300A ; Attributes: bp-based frame
.text:0041300A
.text:0041300A ; int __cdecl strtol(const char *nptr, char **endptr, int ibase)
.text:0041300A _strtol	       proc near	       ; CODE XREF: __output_p_l+1E1p
.text:0041300A					       ; __output_p_l+226p ...
.text:0041300A
.text:0041300A nptr	       = dword ptr  8
.text:0041300A endptr	       = dword ptr  0Ch
.text:0041300A ibase	       = dword ptr  10h
.text:0041300A
.text:0041300A		       push    ebp
.text:0041300B		       mov     ebp, esp
.text:0041300D		       xor     eax, eax
.text:0041300F		       cmp     ___locale_changed, eax
.text:00413015		       push    eax	       ; flags
.text:00413016		       push    [ebp+ibase]     ; ibase
.text:00413019		       push    [ebp+endptr]    ; endptr
.text:0041301C		       push    [ebp+nptr]      ; nptr
.text:0041301F		       jnz     short loc_413028
.text:00413021		       push    offset ___initiallocalestructinfo
.text:00413026		       jmp     short loc_413029
.text:00413028 ; ---------------------------------------------------------------------------
.text:00413028
.text:00413028 loc_413028:			       ; CODE XREF: _strtol+15j
.text:00413028		       push    eax	       ; plocinfo
.text:00413029
.text:00413029 loc_413029:			       ; CODE XREF: _strtol+1Cj
.text:00413029		       call    strtoxl
.text:0041302E		       add     esp, 14h
.text:00413031		       pop     ebp
.text:00413032		       retn
.text:00413032 _strtol	       endp
.text:00413032
.text:00413033
.text:00413033 ; =============== S U B R O U T I N E =======================================
.text:00413033
.text:00413033
.text:00413033 ; int __cdecl _strtol_l(const char *nptr, char **endptr,	int ibase, localeinfo_struct *plocinfo)
.text:00413033 __strtol_l      proc near	       ; CODE XREF: __atol_l+Cp
.text:00413033
.text:00413033 nptr	       = dword ptr  4
.text:00413033 endptr	       = dword ptr  8
.text:00413033 ibase	       = dword ptr  0Ch
.text:00413033 plocinfo	       = dword ptr  10h
.text:00413033
.text:00413033		       push    0	       ; flags
.text:00413035		       push    [esp+4+ibase]   ; ibase
.text:00413039		       push    [esp+8+endptr]  ; endptr
.text:0041303D		       push    [esp+0Ch+nptr]  ; nptr
.text:00413041		       push    [esp+10h+plocinfo] ; plocinfo
.text:00413045		       call    strtoxl
.text:0041304A		       add     esp, 14h
.text:0041304D		       retn
.text:0041304D __strtol_l      endp
.text:0041304D
.text:0041304E
.text:0041304E ; =============== S U B R O U T I N E =======================================
.text:0041304E
.text:0041304E ; Attributes: bp-based frame
.text:0041304E
.text:0041304E ; unsigned int __cdecl strtoul(const char *nptr,	char **endptr, int ibase)
.text:0041304E _strtoul	       proc near
.text:0041304E
.text:0041304E nptr	       = dword ptr  8
.text:0041304E endptr	       = dword ptr  0Ch
.text:0041304E ibase	       = dword ptr  10h
.text:0041304E
.text:0041304E		       push    ebp
.text:0041304F		       mov     ebp, esp
.text:00413051		       cmp     ___locale_changed, 0
.text:00413058		       push    1	       ; flags
.text:0041305A		       push    [ebp+ibase]     ; ibase
.text:0041305D		       push    [ebp+endptr]    ; endptr
.text:00413060		       push    [ebp+nptr]      ; nptr
.text:00413063		       jnz     short loc_41306C
.text:00413065		       push    offset ___initiallocalestructinfo
.text:0041306A		       jmp     short loc_41306E
.text:0041306C ; ---------------------------------------------------------------------------
.text:0041306C
.text:0041306C loc_41306C:			       ; CODE XREF: _strtoul+15j
.text:0041306C		       push    0	       ; plocinfo
.text:0041306E
.text:0041306E loc_41306E:			       ; CODE XREF: _strtoul+1Cj
.text:0041306E		       call    strtoxl
.text:00413073		       add     esp, 14h
.text:00413076		       pop     ebp
.text:00413077		       retn
.text:00413077 _strtoul	       endp
.text:00413077
.text:00413078
.text:00413078 ; =============== S U B R O U T I N E =======================================
.text:00413078
.text:00413078
.text:00413078 ; unsigned int __cdecl _strtoul_l(const char *nptr, char	**endptr, int ibase, localeinfo_struct *plocinfo)
.text:00413078 __strtoul_l     proc near
.text:00413078
.text:00413078 nptr	       = dword ptr  4
.text:00413078 endptr	       = dword ptr  8
.text:00413078 ibase	       = dword ptr  0Ch
.text:00413078 plocinfo	       = dword ptr  10h
.text:00413078
.text:00413078		       push    1	       ; flags
.text:0041307A		       push    [esp+4+ibase]   ; ibase
.text:0041307E		       push    [esp+8+endptr]  ; endptr
.text:00413082		       push    [esp+0Ch+nptr]  ; nptr
.text:00413086		       push    [esp+10h+plocinfo] ; plocinfo
.text:0041308A		       call    strtoxl
.text:0041308F		       add     esp, 14h
.text:00413092		       retn
.text:00413092 __strtoul_l     endp
.text:00413092
.text:00413093
.text:00413093 ; =============== S U B R O U T I N E =======================================
.text:00413093
.text:00413093 ; Attributes: bp-based frame
.text:00413093
.text:00413093 ; void __cdecl fastcopy_I(void *dst, void *src, int len)
.text:00413093 fastcopy_I      proc near	       ; CODE XREF: __VEC_memcpy+4Dp
.text:00413093
.text:00413093 var_8	       = dword ptr -8
.text:00413093 var_4	       = dword ptr -4
.text:00413093 dst	       = dword ptr  8
.text:00413093 src	       = dword ptr  0Ch
.text:00413093 len	       = dword ptr  10h
.text:00413093
.text:00413093		       push    ebp
.text:00413094		       mov     ebp, esp
.text:00413096		       sub     esp, 8
.text:00413099		       mov     [ebp+var_4], edi
.text:0041309C		       mov     [ebp+var_8], esi
.text:0041309F		       mov     esi, [ebp+src]
.text:004130A2		       mov     edi, [ebp+dst]
.text:004130A5		       mov     ecx, [ebp+len]
.text:004130A8		       shr     ecx, 7
.text:004130AB		       jmp     short L_1_0
.text:004130AB ; ---------------------------------------------------------------------------
.text:004130AD		       db 8Dh, 9Bh, 4 dup(0)
.text:004130B3 ; ---------------------------------------------------------------------------
.text:004130B3
.text:004130B3 L_1_0:				       ; CODE XREF: fastcopy_I+18j
.text:004130B3					       ; fastcopy_I+7Bj
.text:004130B3		       movdqa  xmm0, xmmword ptr [esi]
.text:004130B7		       movdqa  xmm1, xmmword ptr [esi+10h]
.text:004130BC		       movdqa  xmm2, xmmword ptr [esi+20h]
.text:004130C1		       movdqa  xmm3, xmmword ptr [esi+30h]
.text:004130C6		       movdqa  xmmword ptr [edi], xmm0
.text:004130CA		       movdqa  xmmword ptr [edi+10h], xmm1
.text:004130CF		       movdqa  xmmword ptr [edi+20h], xmm2
.text:004130D4		       movdqa  xmmword ptr [edi+30h], xmm3
.text:004130D9		       movdqa  xmm4, xmmword ptr [esi+40h]
.text:004130DE		       movdqa  xmm5, xmmword ptr [esi+50h]
.text:004130E3		       movdqa  xmm6, xmmword ptr [esi+60h]
.text:004130E8		       movdqa  xmm7, xmmword ptr [esi+70h]
.text:004130ED		       movdqa  xmmword ptr [edi+40h], xmm4
.text:004130F2		       movdqa  xmmword ptr [edi+50h], xmm5
.text:004130F7		       movdqa  xmmword ptr [edi+60h], xmm6
.text:004130FC		       movdqa  xmmword ptr [edi+70h], xmm7
.text:00413101		       lea     esi, [esi+80h]
.text:00413107		       lea     edi, [edi+80h]
.text:0041310D		       dec     ecx
.text:0041310E		       jnz     short L_1_0
.text:00413110		       mov     esi, [ebp+var_8]
.text:00413113		       mov     edi, [ebp+var_4]
.text:00413116		       mov     esp, ebp
.text:00413118		       pop     ebp
.text:00413119		       retn
.text:00413119 fastcopy_I      endp
.text:00413119
.text:0041311A
.text:0041311A ; =============== S U B R O U T I N E =======================================
.text:0041311A
.text:0041311A ; Attributes: bp-based frame
.text:0041311A
.text:0041311A ; void *__cdecl _VEC_memcpy(void	*dst, void *src, int len)
.text:0041311A __VEC_memcpy    proc near	       ; CODE XREF: _memcpy+42j
.text:0041311A					       ; _memmove+42j ...
.text:0041311A
.text:0041311A var_1C	       = dword ptr -1Ch
.text:0041311A var_18	       = dword ptr -18h
.text:0041311A var_14	       = dword ptr -14h
.text:0041311A var_10	       = dword ptr -10h
.text:0041311A var_C	       = dword ptr -0Ch
.text:0041311A var_8	       = dword ptr -8
.text:0041311A var_4	       = dword ptr -4
.text:0041311A dst	       = dword ptr  8
.text:0041311A src	       = dword ptr  0Ch
.text:0041311A len	       = dword ptr  10h
.text:0041311A
.text:0041311A		       push    ebp
.text:0041311B		       mov     ebp, esp
.text:0041311D		       sub     esp, 1Ch
.text:00413120		       mov     [ebp+var_C], edi
.text:00413123		       mov     [ebp+var_8], esi
.text:00413126		       mov     [ebp+var_4], ebx
.text:00413129		       mov     ebx, [ebp+src]
.text:0041312C		       mov     eax, ebx
.text:0041312E		       cdq
.text:0041312F		       mov     ecx, eax
.text:00413131		       mov     eax, [ebp+dst]
.text:00413134		       xor     ecx, edx
.text:00413136		       sub     ecx, edx
.text:00413138		       and     ecx, 0Fh
.text:0041313B		       xor     ecx, edx
.text:0041313D		       sub     ecx, edx
.text:0041313F		       cdq
.text:00413140		       mov     edi, eax
.text:00413142		       xor     edi, edx
.text:00413144		       sub     edi, edx
.text:00413146		       and     edi, 0Fh
.text:00413149		       xor     edi, edx
.text:0041314B		       sub     edi, edx
.text:0041314D		       mov     edx, ecx
.text:0041314F		       or      edx, edi
.text:00413151		       jnz     short L_notaligned_0
.text:00413153		       mov     esi, [ebp+len]
.text:00413156		       mov     ecx, esi
.text:00413158		       and     ecx, 7Fh
.text:0041315B		       mov     [ebp+var_18], ecx
.text:0041315E		       cmp     esi, ecx
.text:00413160		       jz      short L_trailing_0
.text:00413162		       sub     esi, ecx
.text:00413164		       push    esi	       ; len
.text:00413165		       push    ebx	       ; src
.text:00413166		       push    eax	       ; dst
.text:00413167		       call    fastcopy_I
.text:0041316C		       add     esp, 0Ch
.text:0041316F		       mov     eax, [ebp+dst]
.text:00413172		       mov     ecx, [ebp+var_18]
.text:00413175
.text:00413175 L_trailing_0:			       ; CODE XREF: __VEC_memcpy+46j
.text:00413175		       test    ecx, ecx
.text:00413177		       jz      short L_return_0
.text:00413179		       mov     ebx, [ebp+len]
.text:0041317C		       mov     edx, [ebp+src]
.text:0041317F		       add     edx, ebx
.text:00413181		       sub     edx, ecx
.text:00413183		       mov     [ebp+var_14], edx
.text:00413186		       add     ebx, eax
.text:00413188		       sub     ebx, ecx
.text:0041318A		       mov     [ebp+var_10], ebx
.text:0041318D		       mov     esi, [ebp+var_14]
.text:00413190		       mov     edi, [ebp+var_10]
.text:00413193		       mov     ecx, [ebp+var_18]
.text:00413196		       rep movsb
.text:00413198		       mov     eax, [ebp+dst]
.text:0041319B		       jmp     short L_return_0
.text:0041319D ; ---------------------------------------------------------------------------
.text:0041319D
.text:0041319D L_notaligned_0:			       ; CODE XREF: __VEC_memcpy+37j
.text:0041319D		       cmp     ecx, edi
.text:0041319F		       jnz     short L_unequalalign
.text:004131A1		       neg     ecx
.text:004131A3		       add     ecx, 10h
.text:004131A6		       mov     [ebp+var_1C], ecx
.text:004131A9		       mov     esi, [ebp+src]
.text:004131AC		       mov     edi, [ebp+dst]
.text:004131AF		       mov     ecx, [ebp+var_1C]
.text:004131B2		       rep movsb
.text:004131B4		       mov     ecx, [ebp+dst]
.text:004131B7		       add     ecx, [ebp+var_1C]
.text:004131BA		       mov     edx, [ebp+src]
.text:004131BD		       add     edx, [ebp+var_1C]
.text:004131C0		       mov     eax, [ebp+len]
.text:004131C3		       sub     eax, [ebp+var_1C]
.text:004131C6		       push    eax	       ; len
.text:004131C7		       push    edx	       ; src
.text:004131C8		       push    ecx	       ; dst
.text:004131C9		       call    __VEC_memcpy
.text:004131CE		       add     esp, 0Ch
.text:004131D1		       mov     eax, [ebp+dst]
.text:004131D4		       jmp     short L_return_0
.text:004131D6 ; ---------------------------------------------------------------------------
.text:004131D6
.text:004131D6 L_unequalalign:			       ; CODE XREF: __VEC_memcpy+85j
.text:004131D6		       mov     esi, [ebp+src]
.text:004131D9		       mov     edi, [ebp+dst]
.text:004131DC		       mov     ecx, [ebp+len]
.text:004131DF		       mov     edx, ecx
.text:004131E1		       shr     ecx, 2
.text:004131E4		       rep movsd
.text:004131E6		       mov     ecx, edx
.text:004131E8		       and     ecx, 3
.text:004131EB		       rep movsb
.text:004131ED		       mov     eax, [ebp+dst]
.text:004131F0
.text:004131F0 L_return_0:			       ; CODE XREF: __VEC_memcpy+5Dj
.text:004131F0					       ; __VEC_memcpy+81j ...
.text:004131F0		       mov     ebx, [ebp+var_4]
.text:004131F3		       mov     esi, [ebp+var_8]
.text:004131F6		       mov     edi, [ebp+var_C]
.text:004131F9		       mov     esp, ebp
.text:004131FB		       pop     ebp
.text:004131FC		       retn
.text:004131FC __VEC_memcpy    endp
.text:004131FC
.text:004131FD
.text:004131FD ; =============== S U B R O U T I N E =======================================
.text:004131FD
.text:004131FD ; Attributes: bp-based frame
.text:004131FD
.text:004131FD ; int __cdecl _isctype_l(int c, int mask, localeinfo_struct *plocinfo)
.text:004131FD __isctype_l     proc near	       ; CODE XREF: __isalpha_l+29p
.text:004131FD					       ; __isupper_l+26p ...
.text:004131FD
.text:004131FD _loc_update     = _LocaleUpdate ptr -18h
.text:004131FD buffer	       = byte ptr -8
.text:004131FD chartype	       = word ptr -4
.text:004131FD c	       = dword ptr  8
.text:004131FD mask	       = dword ptr  0Ch
.text:004131FD plocinfo	       = dword ptr  10h
.text:004131FD
.text:004131FD		       push    ebp
.text:004131FE		       mov     ebp, esp
.text:00413200		       sub     esp, 18h
.text:00413203		       push    ebx
.text:00413204		       push    [ebp+plocinfo]  ; plocinfo
.text:00413207		       lea     ecx, [ebp+_loc_update] ;	this
.text:0041320A		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0041320F		       mov     ebx, [ebp+c]
.text:00413212		       lea     eax, [ebx+1]
.text:00413215		       cmp     eax, 100h
.text:0041321A		       ja      short loc_41322B
.text:0041321C		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0041321F		       mov     eax, [eax+0C8h]
.text:00413225		       movzx   eax, word ptr [eax+ebx*2]
.text:00413229		       jmp     short loc_4132A0
.text:0041322B ; ---------------------------------------------------------------------------
.text:0041322B
.text:0041322B loc_41322B:			       ; CODE XREF: __isctype_l+1Dj
.text:0041322B		       mov     [ebp+c],	ebx
.text:0041322E		       sar     [ebp+c],	8
.text:00413232		       lea     eax, [ebp+_loc_update]
.text:00413235		       push    eax	       ; plocinfo
.text:00413236		       mov     eax, [ebp+c]
.text:00413239		       and     eax, 0FFh
.text:0041323E		       push    eax	       ; c
.text:0041323F		       call    __isleadbyte_l
.text:00413244		       test    eax, eax
.text:00413246		       pop     ecx
.text:00413247		       pop     ecx
.text:00413248		       jz      short loc_41325C
.text:0041324A		       mov     al, byte	ptr [ebp+c]
.text:0041324D		       push    2
.text:0041324F		       mov     [ebp+buffer], al
.text:00413252		       mov     [ebp+buffer+1], bl
.text:00413255		       mov     [ebp+buffer+2], 0
.text:00413259		       pop     ecx
.text:0041325A		       jmp     short loc_413266
.text:0041325C ; ---------------------------------------------------------------------------
.text:0041325C
.text:0041325C loc_41325C:			       ; CODE XREF: __isctype_l+4Bj
.text:0041325C		       xor     ecx, ecx
.text:0041325E		       mov     [ebp+buffer], bl
.text:00413261		       mov     [ebp+buffer+1], 0
.text:00413265		       inc     ecx
.text:00413266
.text:00413266 loc_413266:			       ; CODE XREF: __isctype_l+5Dj
.text:00413266		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00413269		       push    1	       ; bError
.text:0041326B		       push    dword ptr [eax+14h] ; lcid
.text:0041326E		       push    dword ptr [eax+4] ; code_page
.text:00413271		       lea     eax, [ebp+chartype]
.text:00413274		       push    eax	       ; lpCharType
.text:00413275		       push    ecx	       ; cchSrc
.text:00413276		       lea     eax, [ebp+buffer]
.text:00413279		       push    eax	       ; lpSrcStr
.text:0041327A		       lea     eax, [ebp+_loc_update]
.text:0041327D		       push    1	       ; dwInfoType
.text:0041327F		       push    eax	       ; plocinfo
.text:00413280		       call    ___crtGetStringTypeA
.text:00413285		       add     esp, 20h
.text:00413288		       test    eax, eax
.text:0041328A		       jnz     short loc_41329C
.text:0041328C		       cmp     [ebp+_loc_update.updated], al
.text:0041328F		       jz      short loc_413298
.text:00413291		       mov     eax, [ebp+_loc_update.ptd]
.text:00413294		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00413298
.text:00413298 loc_413298:			       ; CODE XREF: __isctype_l+92j
.text:00413298		       xor     eax, eax
.text:0041329A		       jmp     short loc_4132B0
.text:0041329C ; ---------------------------------------------------------------------------
.text:0041329C
.text:0041329C loc_41329C:			       ; CODE XREF: __isctype_l+8Dj
.text:0041329C		       movzx   eax, [ebp+chartype]
.text:004132A0
.text:004132A0 loc_4132A0:			       ; CODE XREF: __isctype_l+2Cj
.text:004132A0		       and     eax, [ebp+mask]
.text:004132A3		       cmp     [ebp+_loc_update.updated], 0
.text:004132A7		       jz      short loc_4132B0
.text:004132A9		       mov     ecx, [ebp+_loc_update.ptd]
.text:004132AC		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:004132B0
.text:004132B0 loc_4132B0:			       ; CODE XREF: __isctype_l+9Dj
.text:004132B0					       ; __isctype_l+AAj
.text:004132B0		       pop     ebx
.text:004132B1		       leave
.text:004132B2		       retn
.text:004132B2 __isctype_l     endp
.text:004132B2
.text:004132B3
.text:004132B3 ; =============== S U B R O U T I N E =======================================
.text:004132B3
.text:004132B3
.text:004132B3 ; int __cdecl _isctype(int c, int mask)
.text:004132B3 __isctype       proc near
.text:004132B3
.text:004132B3 c	       = dword ptr  4
.text:004132B3 mask	       = dword ptr  8
.text:004132B3
.text:004132B3		       cmp     ___locale_changed, 0
.text:004132BA		       jnz     short loc_4132CF
.text:004132BC		       mov     eax, [esp+c]
.text:004132C0		       mov     ecx, ___initiallocinfo.pctype
.text:004132C6		       movzx   eax, word ptr [ecx+eax*2]
.text:004132CA		       and     eax, [esp+mask]
.text:004132CE		       retn
.text:004132CF ; ---------------------------------------------------------------------------
.text:004132CF
.text:004132CF loc_4132CF:			       ; CODE XREF: __isctype+7j
.text:004132CF		       push    0	       ; plocinfo
.text:004132D1		       push    [esp+4+mask]    ; mask
.text:004132D5		       push    [esp+8+c]       ; c
.text:004132D9		       call    __isctype_l
.text:004132DE		       add     esp, 0Ch
.text:004132E1		       retn
.text:004132E1 __isctype       endp
.text:004132E1
.text:004132E1 ; ---------------------------------------------------------------------------
.text:004132E2		       align 10h
.text:004132F0
.text:004132F0 ; =============== S U B R O U T I N E =======================================
.text:004132F0
.text:004132F0
.text:004132F0 __alloca_probe_16 proc near	       ; CODE XREF: __crtGetLocaleInfoW_stat+BBp
.text:004132F0					       ; __crtGetLocaleInfoA_stat+AAp ...
.text:004132F0
.text:004132F0 arg_0	       = byte ptr  4
.text:004132F0
.text:004132F0		       push    ecx
.text:004132F1		       lea     ecx, [esp+4+arg_0]
.text:004132F5		       sub     ecx, eax
.text:004132F7		       and     ecx, 0Fh
.text:004132FA		       add     eax, ecx
.text:004132FC		       sbb     ecx, ecx
.text:004132FE		       or      eax, ecx
.text:00413300		       pop     ecx
.text:00413301		       jmp     __chkstk
.text:00413306 ; ---------------------------------------------------------------------------
.text:00413306
.text:00413306 __alloca_probe_8:
.text:00413306		       push    ecx
.text:00413307		       lea     ecx, [esp+4+arg_0]
.text:0041330B		       sub     ecx, eax
.text:0041330D		       and     ecx, 7
.text:00413310		       add     eax, ecx
.text:00413312		       sbb     ecx, ecx
.text:00413314		       or      eax, ecx
.text:00413316		       pop     ecx
.text:00413317		       jmp     __chkstk
.text:00413317 __alloca_probe_16 endp
.text:00413317
.text:0041331C
.text:0041331C ; =============== S U B R O U T I N E =======================================
.text:0041331C
.text:0041331C
.text:0041331C ; int __cdecl _close_nolock(int fh)
.text:0041331C __close_nolock  proc near	       ; CODE XREF: __close+94p
.text:0041331C
.text:0041331C fh	       = dword ptr  4
.text:0041331C
.text:0041331C		       push    esi
.text:0041331D		       mov     esi, [esp+4+fh]
.text:00413321		       push    edi
.text:00413322		       push    esi	       ; fh
.text:00413323		       call    __get_osfhandle
.text:00413328		       cmp     eax, 0FFFFFFFFh
.text:0041332B		       pop     ecx
.text:0041332C		       jz      short loc_41337E
.text:0041332E		       cmp     esi, 1
.text:00413331		       mov     eax, ___pioinfo
.text:00413336		       jnz     short loc_413341
.text:00413338		       test    byte ptr	[eax+84h], 1
.text:0041333F		       jnz     short loc_41334C
.text:00413341
.text:00413341 loc_413341:			       ; CODE XREF: __close_nolock+1Aj
.text:00413341		       cmp     esi, 2
.text:00413344		       jnz     short loc_413362
.text:00413346		       test    byte ptr	[eax+44h], 1
.text:0041334A		       jz      short loc_413362
.text:0041334C
.text:0041334C loc_41334C:			       ; CODE XREF: __close_nolock+23j
.text:0041334C		       push    2	       ; fh
.text:0041334E		       call    __get_osfhandle
.text:00413353		       push    1	       ; fh
.text:00413355		       mov     edi, eax
.text:00413357		       call    __get_osfhandle
.text:0041335C		       cmp     eax, edi
.text:0041335E		       pop     ecx
.text:0041335F		       pop     ecx
.text:00413360		       jz      short loc_41337E
.text:00413362
.text:00413362 loc_413362:			       ; CODE XREF: __close_nolock+28j
.text:00413362					       ; __close_nolock+2Ej
.text:00413362		       push    esi	       ; fh
.text:00413363		       call    __get_osfhandle
.text:00413368		       pop     ecx
.text:00413369		       push    eax	       ; hObject
.text:0041336A		       call    ds:__imp__CloseHandle@4 ; CloseHandle(x)
.text:00413370		       test    eax, eax
.text:00413372		       jnz     short loc_41337E
.text:00413374		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0041337A		       mov     edi, eax
.text:0041337C		       jmp     short loc_413380
.text:0041337E ; ---------------------------------------------------------------------------
.text:0041337E
.text:0041337E loc_41337E:			       ; CODE XREF: __close_nolock+10j
.text:0041337E					       ; __close_nolock+44j ...
.text:0041337E		       xor     edi, edi
.text:00413380
.text:00413380 loc_413380:			       ; CODE XREF: __close_nolock+60j
.text:00413380		       push    esi	       ; fh
.text:00413381		       call    __free_osfhnd
.text:00413386		       mov     eax, esi
.text:00413388		       sar     eax, 5
.text:0041338B		       mov     eax, ___pioinfo[eax*4]
.text:00413392		       and     esi, 1Fh
.text:00413395		       shl     esi, 6
.text:00413398		       test    edi, edi
.text:0041339A		       pop     ecx
.text:0041339B		       mov     byte ptr	[eax+esi+4], 0
.text:004133A0		       jz      short loc_4133AE
.text:004133A2		       push    edi	       ; oserrno
.text:004133A3		       call    __dosmaperr
.text:004133A8		       pop     ecx
.text:004133A9		       or      eax, 0FFFFFFFFh
.text:004133AC		       jmp     short loc_4133B0
.text:004133AE ; ---------------------------------------------------------------------------
.text:004133AE
.text:004133AE loc_4133AE:			       ; CODE XREF: __close_nolock+84j
.text:004133AE		       xor     eax, eax
.text:004133B0
.text:004133B0 loc_4133B0:			       ; CODE XREF: __close_nolock+90j
.text:004133B0		       pop     edi
.text:004133B1		       pop     esi
.text:004133B2		       retn
.text:004133B2 __close_nolock  endp
.text:004133B2
.text:004133B3
.text:004133B3 ; =============== S U B R O U T I N E =======================================
.text:004133B3
.text:004133B3 ; Attributes: bp-based frame
.text:004133B3
.text:004133B3 ; int __cdecl _close(int	fh)
.text:004133B3 __close	       proc near	       ; CODE XREF: __fclose_nolock+47p
.text:004133B3
.text:004133B3 _Expr_val       = dword ptr -20h
.text:004133B3 r	       = dword ptr -1Ch
.text:004133B3 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004133B3 fh	       = dword ptr  8
.text:004133B3
.text:004133B3		       push    10h
.text:004133B5		       push    offset dword_4208F8
.text:004133BA		       call    __SEH_prolog4
.text:004133BF		       mov     eax, [ebp+fh]
.text:004133C2		       cmp     eax, 0FFFFFFFEh
.text:004133C5		       jnz     short loc_4133E2
.text:004133C7		       call    ___doserrno
.text:004133CC		       and     dword ptr [eax],	0
.text:004133CF		       call    __errno
.text:004133D4		       mov     dword ptr [eax],	9
.text:004133DA
.text:004133DA loc_4133DA:			       ; CODE XREF: __close+5Cj
.text:004133DA		       or      eax, 0FFFFFFFFh
.text:004133DD		       jmp     loc_413470
.text:004133E2 ; ---------------------------------------------------------------------------
.text:004133E2
.text:004133E2 loc_4133E2:			       ; CODE XREF: __close+12j
.text:004133E2		       xor     edi, edi
.text:004133E4		       cmp     eax, edi
.text:004133E6		       jl      short loc_4133F0
.text:004133E8		       cmp     eax, __nhandle
.text:004133EE		       jb      short loc_413411
.text:004133F0
.text:004133F0 loc_4133F0:			       ; CODE XREF: __close+33j
.text:004133F0					       ; __close+7Cj
.text:004133F0		       call    ___doserrno
.text:004133F5		       mov     [eax], edi
.text:004133F7		       call    __errno
.text:004133FC		       mov     dword ptr [eax],	9
.text:00413402		       push    edi	       ; pReserved
.text:00413403		       push    edi	       ; nLine
.text:00413404		       push    edi	       ; pszFile
.text:00413405		       push    edi	       ; pszFunction
.text:00413406		       push    edi	       ; pszExpression
.text:00413407		       call    __invalid_parameter
.text:0041340C		       add     esp, 14h
.text:0041340F		       jmp     short loc_4133DA
.text:00413411 ; ---------------------------------------------------------------------------
.text:00413411
.text:00413411 loc_413411:			       ; CODE XREF: __close+3Bj
.text:00413411		       mov     ecx, eax
.text:00413413		       sar     ecx, 5
.text:00413416		       lea     ebx, ds:422F40h[ecx*4]
.text:0041341D		       mov     esi, eax
.text:0041341F		       and     esi, 1Fh
.text:00413422		       shl     esi, 6
.text:00413425		       mov     ecx, [ebx]
.text:00413427		       movzx   ecx, byte ptr [ecx+esi+4]
.text:0041342C		       and     ecx, 1
.text:0041342F		       jz      short loc_4133F0
.text:00413431		       push    eax	       ; fh
.text:00413432		       call    ___lock_fhandle
.text:00413437		       pop     ecx
.text:00413438		       mov     [ebp+ms_exc.disabled], edi
.text:0041343B		       mov     eax, [ebx]
.text:0041343D		       test    byte ptr	[eax+esi+4], 1
.text:00413442		       jz      short loc_413452
.text:00413444		       push    [ebp+fh]	       ; fh
.text:00413447		       call    __close_nolock
.text:0041344C		       pop     ecx
.text:0041344D		       mov     [ebp+r],	eax
.text:00413450		       jmp     short loc_413461
.text:00413452 ; ---------------------------------------------------------------------------
.text:00413452
.text:00413452 loc_413452:			       ; CODE XREF: __close+8Fj
.text:00413452		       call    __errno
.text:00413457		       mov     dword ptr [eax],	9
.text:0041345D		       or      [ebp+r],	0FFFFFFFFh
.text:00413461
.text:00413461 loc_413461:			       ; CODE XREF: __close+9Dj
.text:00413461		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00413468		       call    $LN12_10
.text:0041346D
.text:0041346D $LN15_7:
.text:0041346D		       mov     eax, [ebp+r]
.text:00413470
.text:00413470 loc_413470:			       ; CODE XREF: __close+2Aj
.text:00413470		       call    __SEH_epilog4
.text:00413475		       retn
.text:00413476 ; ---------------------------------------------------------------------------
.text:00413476
.text:00413476 $LN12_10:			       ; CODE XREF: __close+B5p
.text:00413476					       ; DATA XREF: .rdata:00420910o
.text:00413476		       push    [ebp+fh]	       ; fh
.text:00413479		       call    __unlock_fhandle
.text:0041347E		       pop     ecx
.text:0041347F
.text:0041347F $LN13_7:
.text:0041347F		       retn
.text:0041347F __close	       endp
.text:0041347F
.text:00413480
.text:00413480 ; =============== S U B R O U T I N E =======================================
.text:00413480
.text:00413480
.text:00413480 ; void __cdecl _freebuf(_iobuf *stream)
.text:00413480 __freebuf       proc near	       ; CODE XREF: __fclose_nolock+3Bp
.text:00413480
.text:00413480 stream	       = dword ptr  4
.text:00413480
.text:00413480		       push    esi
.text:00413481		       mov     esi, [esp+4+stream]
.text:00413485		       mov     eax, [esi+0Ch]
.text:00413488		       test    al, 83h
.text:0041348A		       jz      short loc_4134AA
.text:0041348C		       test    al, 8
.text:0041348E		       jz      short loc_4134AA
.text:00413490		       push    dword ptr [esi+8] ; pBlock
.text:00413493		       call    _free
.text:00413498		       and     dword ptr [esi+0Ch], 0FFFFFBF7h
.text:0041349F		       xor     eax, eax
.text:004134A1		       pop     ecx
.text:004134A2		       mov     [esi], eax
.text:004134A4		       mov     [esi+8],	eax
.text:004134A7		       mov     [esi+4],	eax
.text:004134AA
.text:004134AA loc_4134AA:			       ; CODE XREF: __freebuf+Aj
.text:004134AA					       ; __freebuf+Ej
.text:004134AA		       pop     esi
.text:004134AB		       retn
.text:004134AB __freebuf       endp
.text:004134AB
.text:004134AC
.text:004134AC ; =============== S U B R O U T I N E =======================================
.text:004134AC
.text:004134AC ; Attributes: bp-based frame
.text:004134AC
.text:004134AC ; unsigned __int16 __cdecl _putwch_nolock(wchar_t ch)
.text:004134AC __putwch_nolock proc near	       ; CODE XREF: __write_nolock+2D6p
.text:004134AC					       ; __write_nolock+2F6p ...
.text:004134AC
.text:004134AC num_written     = dword ptr -10h
.text:004134AC mbc	       = byte ptr -0Ch
.text:004134AC var_4	       = dword ptr -4
.text:004134AC Buffer	       = word ptr  8
.text:004134AC
.text:004134AC		       push    ebp
.text:004134AD		       mov     ebp, esp
.text:004134AF		       sub     esp, 10h
.text:004134B2		       mov     eax, ___security_cookie
.text:004134B7		       xor     eax, ebp
.text:004134B9		       mov     [ebp+var_4], eax
.text:004134BC		       push    esi
.text:004134BD		       xor     esi, esi
.text:004134BF		       cmp     use_w, esi
.text:004134C5		       jz      short loc_413515
.text:004134C7		       cmp     __confh,	0FFFFFFFEh
.text:004134CE		       jnz     short loc_4134D5
.text:004134D0		       call    ___initconout
.text:004134D5
.text:004134D5 loc_4134D5:			       ; CODE XREF: __putwch_nolock+22j
.text:004134D5		       mov     eax, __confh
.text:004134DA		       cmp     eax, 0FFFFFFFFh
.text:004134DD		       jnz     short loc_4134E5
.text:004134DF
.text:004134DF loc_4134DF:			       ; CODE XREF: __putwch_nolock+56j
.text:004134DF					       ; __putwch_nolock+61j ...
.text:004134DF		       or      ax, 0FFFFh
.text:004134E3		       jmp     short loc_413555
.text:004134E5 ; ---------------------------------------------------------------------------
.text:004134E5
.text:004134E5 loc_4134E5:			       ; CODE XREF: __putwch_nolock+31j
.text:004134E5		       push    esi	       ; lpReserved
.text:004134E6		       lea     ecx, [ebp+num_written]
.text:004134E9		       push    ecx	       ; lpNumberOfCharsWritten
.text:004134EA		       push    1	       ; nNumberOfCharsToWrite
.text:004134EC		       lea     ecx, [ebp+Buffer]
.text:004134EF		       push    ecx	       ; lpBuffer
.text:004134F0		       push    eax	       ; hConsoleOutput
.text:004134F1		       call    ds:__imp__WriteConsoleW@20 ; WriteConsoleW(x,x,x,x,x)
.text:004134F7		       test    eax, eax
.text:004134F9		       jnz     short loc_413562
.text:004134FB		       cmp     use_w, 2
.text:00413502		       jnz     short loc_4134DF
.text:00413504		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0041350A		       cmp     eax, 78h
.text:0041350D		       jnz     short loc_4134DF
.text:0041350F		       mov     use_w, esi
.text:00413515
.text:00413515 loc_413515:			       ; CODE XREF: __putwch_nolock+19j
.text:00413515		       push    esi	       ; lpUsedDefaultChar
.text:00413516		       push    esi	       ; lpDefaultChar
.text:00413517		       push    5	       ; cbMultiByte
.text:00413519		       lea     eax, [ebp+mbc]
.text:0041351C		       push    eax	       ; lpMultiByteStr
.text:0041351D		       push    1	       ; cchWideChar
.text:0041351F		       lea     eax, [ebp+Buffer]
.text:00413522		       push    eax	       ; lpWideCharStr
.text:00413523		       push    esi	       ; dwFlags
.text:00413524		       call    ds:__imp__GetConsoleOutputCP@0 ;	GetConsoleOutputCP()
.text:0041352A		       push    eax	       ; CodePage
.text:0041352B		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00413531		       mov     ecx, __confh
.text:00413537		       cmp     ecx, 0FFFFFFFFh
.text:0041353A		       jz      short loc_4134DF
.text:0041353C		       push    esi	       ; lpReserved
.text:0041353D		       lea     edx, [ebp+num_written]
.text:00413540		       push    edx	       ; lpNumberOfCharsWritten
.text:00413541		       push    eax	       ; nNumberOfCharsToWrite
.text:00413542		       lea     eax, [ebp+mbc]
.text:00413545		       push    eax	       ; lpBuffer
.text:00413546		       push    ecx	       ; hConsoleOutput
.text:00413547		       call    ds:__imp__WriteConsoleA@20 ; WriteConsoleA(x,x,x,x,x)
.text:0041354D		       test    eax, eax
.text:0041354F		       jz      short loc_4134DF
.text:00413551
.text:00413551 loc_413551:			       ; CODE XREF: __putwch_nolock+C0j
.text:00413551		       mov     ax, [ebp+Buffer]
.text:00413555
.text:00413555 loc_413555:			       ; CODE XREF: __putwch_nolock+37j
.text:00413555		       mov     ecx, [ebp+var_4]
.text:00413558		       xor     ecx, ebp
.text:0041355A		       pop     esi
.text:0041355B		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00413560		       leave
.text:00413561		       retn
.text:00413562 ; ---------------------------------------------------------------------------
.text:00413562
.text:00413562 loc_413562:			       ; CODE XREF: __putwch_nolock+4Dj
.text:00413562		       mov     use_w, 1
.text:0041356C		       jmp     short loc_413551
.text:0041356C __putwch_nolock endp
.text:0041356C
.text:0041356E
.text:0041356E ; =============== S U B R O U T I N E =======================================
.text:0041356E
.text:0041356E ; Attributes: bp-based frame
.text:0041356E
.text:0041356E ; int __cdecl _cputws(const wchar_t *str)
.text:0041356E __cputws	       proc near
.text:0041356E
.text:0041356E retval	       = dword ptr -20h
.text:0041356E len	       = dword ptr -1Ch
.text:0041356E ms_exc	       = CPPEH_RECORD ptr -18h
.text:0041356E str	       = dword ptr  8
.text:0041356E
.text:0041356E		       push    10h
.text:00413570		       push    offset dword_420918
.text:00413575		       call    __SEH_prolog4
.text:0041357A		       xor     esi, esi
.text:0041357C		       mov     [ebp+retval], esi
.text:0041357F		       xor     eax, eax
.text:00413581		       cmp     [ebp+str], esi
.text:00413584		       setnz   al
.text:00413587		       cmp     eax, esi
.text:00413589		       jnz     short loc_4135AF
.text:0041358B		       call    ___doserrno
.text:00413590		       mov     [eax], esi
.text:00413592		       call    __errno
.text:00413597		       mov     dword ptr [eax],	16h
.text:0041359D		       push    esi	       ; pReserved
.text:0041359E		       push    esi	       ; nLine
.text:0041359F		       push    esi	       ; pszFile
.text:004135A0		       push    esi	       ; pszFunction
.text:004135A1		       push    esi	       ; pszExpression
.text:004135A2		       call    __invalid_parameter
.text:004135A7		       add     esp, 14h
.text:004135AA		       or      eax, 0FFFFFFFFh
.text:004135AD		       jmp     short loc_4135FA
.text:004135AF ; ---------------------------------------------------------------------------
.text:004135AF
.text:004135AF loc_4135AF:			       ; CODE XREF: __cputws+1Bj
.text:004135AF		       push    [ebp+str]       ; wcs
.text:004135B2		       call    _wcslen
.text:004135B7		       mov     [ebp+len], eax
.text:004135BA		       push    3	       ; locknum
.text:004135BC		       call    __lock
.text:004135C1		       pop     ecx
.text:004135C2		       pop     ecx
.text:004135C3		       mov     [ebp+ms_exc.disabled], esi
.text:004135C6
.text:004135C6 loc_4135C6:			       ; CODE XREF: __cputws+77j
.text:004135C6		       mov     eax, [ebp+len]
.text:004135C9		       dec     [ebp+len]
.text:004135CC		       test    eax, eax
.text:004135CE		       jz      short loc_4135EB
.text:004135D0		       mov     eax, [ebp+str]
.text:004135D3		       movzx   eax, word ptr [eax]
.text:004135D6		       push    eax	       ; ch
.text:004135D7		       call    __putwch_nolock
.text:004135DC		       pop     ecx
.text:004135DD		       add     [ebp+str], 2
.text:004135E1		       cmp     ax, 0FFFFh
.text:004135E5		       jnz     short loc_4135C6
.text:004135E7		       or      [ebp+retval], 0FFFFFFFFh
.text:004135EB
.text:004135EB loc_4135EB:			       ; CODE XREF: __cputws+60j
.text:004135EB		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004135F2		       call    $LN9_8
.text:004135F7
.text:004135F7 $LN12_11:
.text:004135F7		       mov     eax, [ebp+retval]
.text:004135FA
.text:004135FA loc_4135FA:			       ; CODE XREF: __cputws+3Fj
.text:004135FA		       call    __SEH_epilog4
.text:004135FF		       retn
.text:00413600 ; ---------------------------------------------------------------------------
.text:00413600
.text:00413600 $LN9_8:				       ; CODE XREF: __cputws+84p
.text:00413600					       ; DATA XREF: .rdata:00420930o
.text:00413600		       push    3	       ; locknum
.text:00413602		       call    __unlock
.text:00413607		       pop     ecx
.text:00413608
.text:00413608 $LN10_6:
.text:00413608		       retn
.text:00413608 __cputws	       endp
.text:00413608
.text:00413609
.text:00413609 ; =============== S U B R O U T I N E =======================================
.text:00413609
.text:00413609 ; Attributes: noreturn bp-based frame
.text:00413609
.text:00413609 ; unsigned __int16 __cdecl _putwch(wchar_t ch)
.text:00413609 __putwch	       proc near
.text:00413609
.text:00413609 retval	       = dword ptr -1Ch
.text:00413609 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00413609 arg_0	       = dword ptr  8
.text:00413609
.text:00413609		       push    0Ch
.text:0041360B		       push    offset dword_420938
.text:00413610		       call    __SEH_prolog4
.text:00413615		       push    3	       ; locknum
.text:00413617		       call    __lock
.text:0041361C		       pop     ecx
.text:0041361D		       and     [ebp+ms_exc.disabled], 0
.text:00413621		       push    [ebp+arg_0]     ; ch
.text:00413624		       call    __putwch_nolock
.text:00413629		       pop     ecx
.text:0041362A		       movzx   eax, ax
.text:0041362D		       mov     [ebp+retval], eax
.text:00413630		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00413637		       call    $LN5_0
.text:0041363C ; ---------------------------------------------------------------------------
.text:0041363C
.text:0041363C $LN8_5:
.text:0041363C		       mov     ax, word	ptr [ebp+retval]
.text:00413640		       call    __SEH_epilog4
.text:00413645		       retn
.text:00413646 ; ---------------------------------------------------------------------------
.text:00413646
.text:00413646 $LN5_0:				       ; CODE XREF: __putwch+2Ep
.text:00413646					       ; DATA XREF: .rdata:00420950o
.text:00413646		       push    3	       ; locknum
.text:00413648		       call    __unlock
.text:0041364D		       pop     ecx
.text:0041364E
.text:0041364E $LN6_8:
.text:0041364E		       retn
.text:0041364E __putwch	       endp
.text:0041364E
.text:0041364F
.text:0041364F ; =============== S U B R O U T I N E =======================================
.text:0041364F
.text:0041364F ; Attributes: bp-based frame
.text:0041364F
.text:0041364F ; int __cdecl _mbtowc_l(wchar_t *pwc, const char	*s, unsigned int n, localeinfo_struct *plocinfo)
.text:0041364F __mbtowc_l      proc near	       ; CODE XREF: _mbtowc+Ep
.text:0041364F
.text:0041364F _loc_update     = _LocaleUpdate ptr -10h
.text:0041364F pwc	       = dword ptr  8
.text:0041364F s	       = dword ptr  0Ch
.text:0041364F n	       = dword ptr  10h
.text:0041364F plocinfo	       = dword ptr  14h
.text:0041364F
.text:0041364F		       push    ebp
.text:00413650		       mov     ebp, esp
.text:00413652		       sub     esp, 10h
.text:00413655		       push    ebx
.text:00413656		       push    esi
.text:00413657		       mov     esi, [ebp+s]
.text:0041365A		       xor     ebx, ebx
.text:0041365C		       cmp     esi, ebx
.text:0041365E		       jz      short loc_413673
.text:00413660		       cmp     [ebp+n],	ebx
.text:00413663		       jz      short loc_413673
.text:00413665		       cmp     [esi], bl
.text:00413667		       jnz     short loc_413679
.text:00413669		       mov     eax, [ebp+pwc]
.text:0041366C		       cmp     eax, ebx
.text:0041366E		       jz      short loc_413673
.text:00413670		       mov     [eax], bx
.text:00413673
.text:00413673 loc_413673:			       ; CODE XREF: __mbtowc_l+Fj
.text:00413673					       ; __mbtowc_l+14j ...
.text:00413673		       xor     eax, eax
.text:00413675
.text:00413675 loc_413675:			       ; CODE XREF: __mbtowc_l+5Aj
.text:00413675					       ; __mbtowc_l+BBj ...
.text:00413675		       pop     esi
.text:00413676		       pop     ebx
.text:00413677		       leave
.text:00413678		       retn
.text:00413679 ; ---------------------------------------------------------------------------
.text:00413679
.text:00413679 loc_413679:			       ; CODE XREF: __mbtowc_l+18j
.text:00413679		       push    [ebp+plocinfo]  ; plocinfo
.text:0041367C		       lea     ecx, [ebp+_loc_update] ;	this
.text:0041367F		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00413684		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00413687		       cmp     [eax+14h], ebx
.text:0041368A		       jnz     short loc_4136AB
.text:0041368C		       mov     eax, [ebp+pwc]
.text:0041368F		       cmp     eax, ebx
.text:00413691		       jz      short loc_41369A
.text:00413693		       movzx   cx, byte	ptr [esi]
.text:00413697		       mov     [eax], cx
.text:0041369A
.text:0041369A loc_41369A:			       ; CODE XREF: __mbtowc_l+42j
.text:0041369A					       ; __mbtowc_l+10Bj
.text:0041369A		       cmp     [ebp+_loc_update.updated], bl
.text:0041369D		       jz      short loc_4136A6
.text:0041369F		       mov     eax, [ebp+_loc_update.ptd]
.text:004136A2		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004136A6
.text:004136A6 loc_4136A6:			       ; CODE XREF: __mbtowc_l+4Ej
.text:004136A6		       xor     eax, eax
.text:004136A8		       inc     eax
.text:004136A9		       jmp     short loc_413675
.text:004136AB ; ---------------------------------------------------------------------------
.text:004136AB
.text:004136AB loc_4136AB:			       ; CODE XREF: __mbtowc_l+3Bj
.text:004136AB		       lea     eax, [ebp+_loc_update]
.text:004136AE		       push    eax	       ; plocinfo
.text:004136AF		       movzx   eax, byte ptr [esi]
.text:004136B2		       push    eax	       ; c
.text:004136B3		       call    __isleadbyte_l
.text:004136B8		       test    eax, eax
.text:004136BA		       pop     ecx
.text:004136BB		       pop     ecx
.text:004136BC		       jz      short loc_41373B
.text:004136BE		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004136C1		       mov     ecx, [eax+0ACh]
.text:004136C7		       cmp     ecx, 1
.text:004136CA		       jle     short loc_4136F1
.text:004136CC		       cmp     [ebp+n],	ecx
.text:004136CF		       jl      short loc_4136F1
.text:004136D1		       xor     edx, edx
.text:004136D3		       cmp     [ebp+pwc], ebx
.text:004136D6		       setnz   dl
.text:004136D9		       push    edx	       ; cchWideChar
.text:004136DA		       push    [ebp+pwc]       ; lpWideCharStr
.text:004136DD		       push    ecx	       ; cbMultiByte
.text:004136DE		       push    esi	       ; lpMultiByteStr
.text:004136DF		       push    9	       ; dwFlags
.text:004136E1		       push    dword ptr [eax+4] ; CodePage
.text:004136E4		       call    ds:__imp__MultiByteToWideChar@24	; MultiByteToWideChar(x,x,x,x,x,x)
.text:004136EA		       test    eax, eax
.text:004136EC		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004136EF		       jnz     short loc_413701
.text:004136F1
.text:004136F1 loc_4136F1:			       ; CODE XREF: __mbtowc_l+7Bj
.text:004136F1					       ; __mbtowc_l+80j
.text:004136F1		       mov     ecx, [ebp+n]
.text:004136F4		       cmp     ecx, [eax+0ACh]
.text:004136FA		       jb      short loc_41371C
.text:004136FC		       cmp     [esi+1],	bl
.text:004136FF		       jz      short loc_41371C
.text:00413701
.text:00413701 loc_413701:			       ; CODE XREF: __mbtowc_l+A0j
.text:00413701		       cmp     [ebp+_loc_update.updated], bl
.text:00413704		       mov     eax, [eax+0ACh]
.text:0041370A		       jz      loc_413675
.text:00413710		       mov     ecx, [ebp+_loc_update.ptd]
.text:00413713		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00413717		       jmp     loc_413675
.text:0041371C ; ---------------------------------------------------------------------------
.text:0041371C
.text:0041371C loc_41371C:			       ; CODE XREF: __mbtowc_l+ABj
.text:0041371C					       ; __mbtowc_l+B0j ...
.text:0041371C		       call    __errno
.text:00413721		       mov     dword ptr [eax],	2Ah
.text:00413727		       cmp     [ebp+_loc_update.updated], bl
.text:0041372A		       jz      short loc_413733
.text:0041372C		       mov     eax, [ebp+_loc_update.ptd]
.text:0041372F		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00413733
.text:00413733 loc_413733:			       ; CODE XREF: __mbtowc_l+DBj
.text:00413733		       or      eax, 0FFFFFFFFh
.text:00413736		       jmp     loc_413675
.text:0041373B ; ---------------------------------------------------------------------------
.text:0041373B
.text:0041373B loc_41373B:			       ; CODE XREF: __mbtowc_l+6Dj
.text:0041373B		       xor     eax, eax
.text:0041373D		       cmp     [ebp+pwc], ebx
.text:00413740		       setnz   al
.text:00413743		       push    eax	       ; cchWideChar
.text:00413744		       push    [ebp+pwc]       ; lpWideCharStr
.text:00413747		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0041374A		       push    1	       ; cbMultiByte
.text:0041374C		       push    esi	       ; lpMultiByteStr
.text:0041374D		       push    9	       ; dwFlags
.text:0041374F		       push    dword ptr [eax+4] ; CodePage
.text:00413752		       call    ds:__imp__MultiByteToWideChar@24	; MultiByteToWideChar(x,x,x,x,x,x)
.text:00413758		       test    eax, eax
.text:0041375A		       jnz     loc_41369A
.text:00413760		       jmp     short loc_41371C
.text:00413760 __mbtowc_l      endp
.text:00413760
.text:00413762
.text:00413762 ; =============== S U B R O U T I N E =======================================
.text:00413762
.text:00413762
.text:00413762 ; int __cdecl mbtowc(wchar_t *pwc, const	char *s, unsigned int n)
.text:00413762 _mbtowc	       proc near	       ; CODE XREF: __write_nolock+1D1p
.text:00413762					       ; __write_nolock+1EFp
.text:00413762
.text:00413762 pwc	       = dword ptr  4
.text:00413762 s	       = dword ptr  8
.text:00413762 n	       = dword ptr  0Ch
.text:00413762
.text:00413762		       push    0	       ; plocinfo
.text:00413764		       push    [esp+4+n]       ; n
.text:00413768		       push    [esp+8+s]       ; s
.text:0041376C		       push    [esp+0Ch+pwc]   ; pwc
.text:00413770		       call    __mbtowc_l
.text:00413775		       add     esp, 10h
.text:00413778		       retn
.text:00413778 _mbtowc	       endp
.text:00413778
.text:00413779
.text:00413779 ; =============== S U B R O U T I N E =======================================
.text:00413779
.text:00413779
.text:00413779 ; int __cdecl _set_osfhnd(int fh, int value)
.text:00413779 __set_osfhnd    proc near	       ; CODE XREF: __open_osfhandle+8Fp
.text:00413779
.text:00413779 fh	       = dword ptr  4
.text:00413779 value	       = dword ptr  8
.text:00413779
.text:00413779		       mov     eax, [esp+fh]
.text:0041377D		       test    eax, eax
.text:0041377F		       push    esi
.text:00413780		       push    edi
.text:00413781		       jl      short loc_4137DD
.text:00413783		       cmp     eax, __nhandle
.text:00413789		       jnb     short loc_4137DD
.text:0041378B		       mov     ecx, eax
.text:0041378D		       sar     ecx, 5
.text:00413790		       mov     esi, eax
.text:00413792		       and     esi, 1Fh
.text:00413795		       lea     edi, ds:422F40h[ecx*4]
.text:0041379C		       mov     ecx, [edi]
.text:0041379E		       shl     esi, 6
.text:004137A1		       cmp     dword ptr [esi+ecx], 0FFFFFFFFh
.text:004137A5		       jnz     short loc_4137DD
.text:004137A7		       cmp     ___app_type, 1
.text:004137AE		       push    ebx
.text:004137AF		       mov     ebx, [esp+0Ch+value]
.text:004137B3		       jnz     short loc_4137D3
.text:004137B5		       sub     eax, 0
.text:004137B8		       jz      short loc_4137CA
.text:004137BA		       dec     eax
.text:004137BB		       jz      short loc_4137C5
.text:004137BD		       dec     eax
.text:004137BE		       jnz     short loc_4137D3
.text:004137C0		       push    ebx
.text:004137C1		       push    0FFFFFFF4h
.text:004137C3		       jmp     short loc_4137CD
.text:004137C5 ; ---------------------------------------------------------------------------
.text:004137C5
.text:004137C5 loc_4137C5:			       ; CODE XREF: __set_osfhnd+42j
.text:004137C5		       push    ebx
.text:004137C6		       push    0FFFFFFF5h
.text:004137C8		       jmp     short loc_4137CD
.text:004137CA ; ---------------------------------------------------------------------------
.text:004137CA
.text:004137CA loc_4137CA:			       ; CODE XREF: __set_osfhnd+3Fj
.text:004137CA		       push    ebx	       ; hHandle
.text:004137CB		       push    0FFFFFFF6h      ; nStdHandle
.text:004137CD
.text:004137CD loc_4137CD:			       ; CODE XREF: __set_osfhnd+4Aj
.text:004137CD					       ; __set_osfhnd+4Fj
.text:004137CD		       call    ds:__imp__SetStdHandle@8	; SetStdHandle(x,x)
.text:004137D3
.text:004137D3 loc_4137D3:			       ; CODE XREF: __set_osfhnd+3Aj
.text:004137D3					       ; __set_osfhnd+45j
.text:004137D3		       mov     eax, [edi]
.text:004137D5		       mov     [esi+eax], ebx
.text:004137D8		       xor     eax, eax
.text:004137DA		       pop     ebx
.text:004137DB		       jmp     short loc_4137F3
.text:004137DD ; ---------------------------------------------------------------------------
.text:004137DD
.text:004137DD loc_4137DD:			       ; CODE XREF: __set_osfhnd+8j
.text:004137DD					       ; __set_osfhnd+10j ...
.text:004137DD		       call    __errno
.text:004137E2		       mov     dword ptr [eax],	9
.text:004137E8		       call    ___doserrno
.text:004137ED		       and     dword ptr [eax],	0
.text:004137F0		       or      eax, 0FFFFFFFFh
.text:004137F3
.text:004137F3 loc_4137F3:			       ; CODE XREF: __set_osfhnd+62j
.text:004137F3		       pop     edi
.text:004137F4		       pop     esi
.text:004137F5		       retn
.text:004137F5 __set_osfhnd    endp
.text:004137F5
.text:004137F6
.text:004137F6 ; =============== S U B R O U T I N E =======================================
.text:004137F6
.text:004137F6
.text:004137F6 ; int __cdecl _free_osfhnd(int fh)
.text:004137F6 __free_osfhnd   proc near	       ; CODE XREF: __close_nolock+65p
.text:004137F6
.text:004137F6 fh	       = dword ptr  4
.text:004137F6
.text:004137F6		       mov     ecx, [esp+fh]
.text:004137FA		       push    ebx
.text:004137FB		       xor     ebx, ebx
.text:004137FD		       cmp     ecx, ebx
.text:004137FF		       push    esi
.text:00413800		       push    edi
.text:00413801		       jl      short loc_41385E
.text:00413803		       cmp     ecx, __nhandle
.text:00413809		       jnb     short loc_41385E
.text:0041380B		       mov     eax, ecx
.text:0041380D		       sar     eax, 5
.text:00413810		       mov     esi, ecx
.text:00413812		       lea     edi, ds:422F40h[eax*4]
.text:00413819		       mov     eax, [edi]
.text:0041381B		       and     esi, 1Fh
.text:0041381E		       shl     esi, 6
.text:00413821		       add     eax, esi
.text:00413823		       test    byte ptr	[eax+4], 1
.text:00413827		       jz      short loc_41385E
.text:00413829		       cmp     dword ptr [eax],	0FFFFFFFFh
.text:0041382C		       jz      short loc_41385E
.text:0041382E		       cmp     ___app_type, 1
.text:00413835		       jnz     short loc_413854
.text:00413837		       sub     ecx, ebx
.text:00413839		       jz      short loc_41384B
.text:0041383B		       dec     ecx
.text:0041383C		       jz      short loc_413846
.text:0041383E		       dec     ecx
.text:0041383F		       jnz     short loc_413854
.text:00413841		       push    ebx
.text:00413842		       push    0FFFFFFF4h
.text:00413844		       jmp     short loc_41384E
.text:00413846 ; ---------------------------------------------------------------------------
.text:00413846
.text:00413846 loc_413846:			       ; CODE XREF: __free_osfhnd+46j
.text:00413846		       push    ebx
.text:00413847		       push    0FFFFFFF5h
.text:00413849		       jmp     short loc_41384E
.text:0041384B ; ---------------------------------------------------------------------------
.text:0041384B
.text:0041384B loc_41384B:			       ; CODE XREF: __free_osfhnd+43j
.text:0041384B		       push    ebx	       ; hHandle
.text:0041384C		       push    0FFFFFFF6h      ; nStdHandle
.text:0041384E
.text:0041384E loc_41384E:			       ; CODE XREF: __free_osfhnd+4Ej
.text:0041384E					       ; __free_osfhnd+53j
.text:0041384E		       call    ds:__imp__SetStdHandle@8	; SetStdHandle(x,x)
.text:00413854
.text:00413854 loc_413854:			       ; CODE XREF: __free_osfhnd+3Fj
.text:00413854					       ; __free_osfhnd+49j
.text:00413854		       mov     eax, [edi]
.text:00413856		       or      dword ptr [esi+eax], 0FFFFFFFFh
.text:0041385A		       xor     eax, eax
.text:0041385C		       jmp     short loc_413873
.text:0041385E ; ---------------------------------------------------------------------------
.text:0041385E
.text:0041385E loc_41385E:			       ; CODE XREF: __free_osfhnd+Bj
.text:0041385E					       ; __free_osfhnd+13j ...
.text:0041385E		       call    __errno
.text:00413863		       mov     dword ptr [eax],	9
.text:00413869		       call    ___doserrno
.text:0041386E		       mov     [eax], ebx
.text:00413870		       or      eax, 0FFFFFFFFh
.text:00413873
.text:00413873 loc_413873:			       ; CODE XREF: __free_osfhnd+66j
.text:00413873		       pop     edi
.text:00413874		       pop     esi
.text:00413875		       pop     ebx
.text:00413876		       retn
.text:00413876 __free_osfhnd   endp
.text:00413876
.text:00413877
.text:00413877 ; =============== S U B R O U T I N E =======================================
.text:00413877
.text:00413877
.text:00413877 ; int __cdecl _get_osfhandle(int	fh)
.text:00413877 __get_osfhandle proc near	       ; CODE XREF: __commit+85p
.text:00413877					       ; __lseeki64_nolock+17p	...
.text:00413877
.text:00413877 fh	       = dword ptr  4
.text:00413877
.text:00413877		       mov     eax, [esp+fh]
.text:0041387B		       cmp     eax, 0FFFFFFFEh
.text:0041387E		       jnz     short loc_413897
.text:00413880		       call    ___doserrno
.text:00413885		       and     dword ptr [eax],	0
.text:00413888		       call    __errno
.text:0041388D		       mov     dword ptr [eax],	9
.text:00413893		       or      eax, 0FFFFFFFFh
.text:00413896		       retn
.text:00413897 ; ---------------------------------------------------------------------------
.text:00413897
.text:00413897 loc_413897:			       ; CODE XREF: __get_osfhandle+7j
.text:00413897		       push    esi
.text:00413898		       xor     esi, esi
.text:0041389A		       cmp     eax, esi
.text:0041389C		       jl      short loc_4138C0
.text:0041389E		       cmp     eax, __nhandle
.text:004138A4		       jnb     short loc_4138C0
.text:004138A6		       mov     ecx, eax
.text:004138A8		       and     eax, 1Fh
.text:004138AB		       sar     ecx, 5
.text:004138AE		       mov     ecx, ___pioinfo[ecx*4]
.text:004138B5		       shl     eax, 6
.text:004138B8		       add     eax, ecx
.text:004138BA		       test    byte ptr	[eax+4], 1
.text:004138BE		       jnz     short loc_4138E4
.text:004138C0
.text:004138C0 loc_4138C0:			       ; CODE XREF: __get_osfhandle+25j
.text:004138C0					       ; __get_osfhandle+2Dj
.text:004138C0		       call    ___doserrno
.text:004138C5		       mov     [eax], esi
.text:004138C7		       call    __errno
.text:004138CC		       push    esi	       ; pReserved
.text:004138CD		       push    esi	       ; nLine
.text:004138CE		       push    esi	       ; pszFile
.text:004138CF		       push    esi	       ; pszFunction
.text:004138D0		       push    esi	       ; pszExpression
.text:004138D1		       mov     dword ptr [eax],	9
.text:004138D7		       call    __invalid_parameter
.text:004138DC		       add     esp, 14h
.text:004138DF		       or      eax, 0FFFFFFFFh
.text:004138E2		       pop     esi
.text:004138E3		       retn
.text:004138E4 ; ---------------------------------------------------------------------------
.text:004138E4
.text:004138E4 loc_4138E4:			       ; CODE XREF: __get_osfhandle+47j
.text:004138E4		       mov     eax, [eax]
.text:004138E6		       pop     esi
.text:004138E7		       retn
.text:004138E7 __get_osfhandle endp
.text:004138E7
.text:004138E8
.text:004138E8 ; =============== S U B R O U T I N E =======================================
.text:004138E8
.text:004138E8 ; Attributes: bp-based frame
.text:004138E8
.text:004138E8 ; int __cdecl __lock_fhandle(int	fh)
.text:004138E8 ___lock_fhandle proc near	       ; CODE XREF: __write+7Fp
.text:004138E8					       ; __commit+70p ...
.text:004138E8
.text:004138E8 retval	       = dword ptr -1Ch
.text:004138E8 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004138E8 fh	       = dword ptr  8
.text:004138E8
.text:004138E8		       push    0Ch
.text:004138EA		       push    offset dword_420958
.text:004138EF		       call    __SEH_prolog4
.text:004138F4		       mov     edi, [ebp+fh]
.text:004138F7		       mov     eax, edi
.text:004138F9		       sar     eax, 5
.text:004138FC		       mov     esi, edi
.text:004138FE		       and     esi, 1Fh
.text:00413901		       shl     esi, 6
.text:00413904		       add     esi, ___pioinfo[eax*4]
.text:0041390B		       mov     [ebp+retval], 1
.text:00413912		       xor     ebx, ebx
.text:00413914		       cmp     [esi+8],	ebx
.text:00413917		       jnz     short $LN12_12
.text:00413919		       push    0Ah	       ; locknum
.text:0041391B		       call    __lock
.text:00413920		       pop     ecx
.text:00413921		       mov     [ebp+ms_exc.disabled], ebx
.text:00413924		       cmp     [esi+8],	ebx
.text:00413927		       jnz     short loc_413943
.text:00413929		       push    0FA0h	       ; dwSpinCount
.text:0041392E		       lea     eax, [esi+0Ch]
.text:00413931		       push    eax	       ; lpCriticalSection
.text:00413932		       call    ___crtInitCritSecAndSpinCount
.text:00413937		       pop     ecx
.text:00413938		       pop     ecx
.text:00413939		       test    eax, eax
.text:0041393B		       jnz     short loc_413940
.text:0041393D		       mov     [ebp+retval], ebx
.text:00413940
.text:00413940 loc_413940:			       ; CODE XREF: ___lock_fhandle+53j
.text:00413940		       inc     dword ptr [esi+8]
.text:00413943
.text:00413943 loc_413943:			       ; CODE XREF: ___lock_fhandle+3Fj
.text:00413943		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0041394A		       call    $LN11_7
.text:0041394F
.text:0041394F $LN12_12:			       ; CODE XREF: ___lock_fhandle+2Fj
.text:0041394F		       cmp     [ebp+retval], ebx
.text:00413952		       jz      short loc_413971
.text:00413954		       mov     eax, edi
.text:00413956		       sar     eax, 5
.text:00413959		       and     edi, 1Fh
.text:0041395C		       shl     edi, 6
.text:0041395F		       mov     eax, ___pioinfo[eax*4]
.text:00413966		       lea     eax, [eax+edi+0Ch]
.text:0041396A		       push    eax	       ; lpCriticalSection
.text:0041396B		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:00413971
.text:00413971 loc_413971:			       ; CODE XREF: ___lock_fhandle+6Aj
.text:00413971		       mov     eax, [ebp+retval]
.text:00413974		       call    __SEH_epilog4
.text:00413979		       retn
.text:0041397A ; ---------------------------------------------------------------------------
.text:0041397A
.text:0041397A $LN9_9:				       ; DATA XREF: .rdata:00420970o
.text:0041397A		       xor     ebx, ebx
.text:0041397C		       mov     edi, [ebp+fh]
.text:0041397F
.text:0041397F $LN11_7:				       ; CODE XREF: ___lock_fhandle+62p
.text:0041397F		       push    0Ah	       ; locknum
.text:00413981		       call    __unlock
.text:00413986		       pop     ecx
.text:00413987
.text:00413987 $LN10_7:
.text:00413987		       retn
.text:00413987 ___lock_fhandle endp ; sp-analysis failed
.text:00413987
.text:00413988
.text:00413988 ; =============== S U B R O U T I N E =======================================
.text:00413988
.text:00413988
.text:00413988 ; void __cdecl _unlock_fhandle(int fh)
.text:00413988 __unlock_fhandle	proc near	       ; CODE XREF: __write+D5p
.text:00413988					       ; __commit+DAp ...
.text:00413988
.text:00413988 fh	       = dword ptr  4
.text:00413988
.text:00413988		       mov     eax, [esp+fh]
.text:0041398C		       mov     ecx, eax
.text:0041398E		       and     eax, 1Fh
.text:00413991		       sar     ecx, 5
.text:00413994		       mov     ecx, ___pioinfo[ecx*4]
.text:0041399B		       shl     eax, 6
.text:0041399E		       lea     eax, [ecx+eax+0Ch]
.text:004139A2		       push    eax	       ; lpCriticalSection
.text:004139A3		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:004139A9		       retn
.text:004139A9 __unlock_fhandle	endp
.text:004139A9
.text:004139AA
.text:004139AA ; =============== S U B R O U T I N E =======================================
.text:004139AA
.text:004139AA ; Attributes: bp-based frame
.text:004139AA
.text:004139AA ; int __cdecl _alloc_osfhnd()
.text:004139AA __alloc_osfhnd  proc near	       ; CODE XREF: __open_osfhandle:loc_413BA9p
.text:004139AA
.text:004139AA i	       = dword ptr -28h
.text:004139AA failed	       = dword ptr -24h
.text:004139AA pio	       = dword ptr -20h
.text:004139AA fh	       = dword ptr -1Ch
.text:004139AA ms_exc	       = CPPEH_RECORD ptr -18h
.text:004139AA
.text:004139AA		       push    18h
.text:004139AC		       push    offset dword_420978
.text:004139B1		       call    __SEH_prolog4
.text:004139B6		       or      [ebp+fh], 0FFFFFFFFh
.text:004139BA		       xor     edi, edi
.text:004139BC		       mov     [ebp+failed], edi
.text:004139BF		       push    0Bh	       ; locknum
.text:004139C1		       call    __mtinitlocknum
.text:004139C6		       pop     ecx
.text:004139C7		       test    eax, eax
.text:004139C9		       jnz     short loc_4139D3
.text:004139CB		       or      eax, 0FFFFFFFFh
.text:004139CE		       jmp     loc_413B35
.text:004139D3 ; ---------------------------------------------------------------------------
.text:004139D3
.text:004139D3 loc_4139D3:			       ; CODE XREF: __alloc_osfhnd+1Fj
.text:004139D3		       push    0Bh	       ; locknum
.text:004139D5		       call    __lock
.text:004139DA		       pop     ecx
.text:004139DB		       mov     [ebp+ms_exc.disabled], edi
.text:004139DE
.text:004139DE loc_4139DE:			       ; CODE XREF: __alloc_osfhnd+104j
.text:004139DE		       mov     [ebp+i],	edi
.text:004139E1		       cmp     edi, 40h
.text:004139E4		       jge     loc_413B26
.text:004139EA		       mov     esi, ___pioinfo[edi*4]
.text:004139F1		       test    esi, esi
.text:004139F3		       jz      loc_413AB3
.text:004139F9
.text:004139F9 loc_4139F9:			       ; CODE XREF: __alloc_osfhnd+CBj
.text:004139F9		       mov     [ebp+pio], esi
.text:004139FC		       mov     eax, ___pioinfo[edi*4]
.text:00413A03		       add     eax, 800h
.text:00413A08		       cmp     esi, eax
.text:00413A0A		       jnb     loc_413AA7
.text:00413A10		       test    byte ptr	[esi+4], 1
.text:00413A14		       jnz     short loc_413A72
.text:00413A16		       cmp     dword ptr [esi+8], 0
.text:00413A1A		       jnz     short $LN36_1
.text:00413A1C		       push    0Ah	       ; locknum
.text:00413A1E		       call    __lock
.text:00413A23		       pop     ecx
.text:00413A24		       xor     ebx, ebx
.text:00413A26		       inc     ebx
.text:00413A27		       mov     [ebp+ms_exc.disabled], ebx
.text:00413A2A		       cmp     dword ptr [esi+8], 0
.text:00413A2E		       jnz     short loc_413A4C
.text:00413A30		       push    0FA0h	       ; dwSpinCount
.text:00413A35		       lea     eax, [esi+0Ch]
.text:00413A38		       push    eax	       ; lpCriticalSection
.text:00413A39		       call    ___crtInitCritSecAndSpinCount
.text:00413A3E		       pop     ecx
.text:00413A3F		       pop     ecx
.text:00413A40		       test    eax, eax
.text:00413A42		       jnz     short loc_413A49
.text:00413A44		       mov     [ebp+failed], ebx
.text:00413A47		       jmp     short loc_413A4C
.text:00413A49 ; ---------------------------------------------------------------------------
.text:00413A49
.text:00413A49 loc_413A49:			       ; CODE XREF: __alloc_osfhnd+98j
.text:00413A49		       inc     dword ptr [esi+8]
.text:00413A4C
.text:00413A4C loc_413A4C:			       ; CODE XREF: __alloc_osfhnd+84j
.text:00413A4C					       ; __alloc_osfhnd+9Dj
.text:00413A4C		       and     [ebp+ms_exc.disabled], 0
.text:00413A50		       call    $LN35_1
.text:00413A55
.text:00413A55 $LN36_1:				       ; CODE XREF: __alloc_osfhnd+70j
.text:00413A55		       cmp     [ebp+failed], 0
.text:00413A59		       jnz     short loc_413A72
.text:00413A5B		       lea     ebx, [esi+0Ch]
.text:00413A5E		       push    ebx	       ; lpCriticalSection
.text:00413A5F		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:00413A65		       test    byte ptr	[esi+4], 1
.text:00413A69		       jz      short loc_413A86
.text:00413A6B		       push    ebx	       ; lpCriticalSection
.text:00413A6C		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:00413A72
.text:00413A72 loc_413A72:			       ; CODE XREF: __alloc_osfhnd+6Aj
.text:00413A72					       ; __alloc_osfhnd+AFj ...
.text:00413A72		       add     esi, 40h
.text:00413A75		       jmp     short loc_4139F9
.text:00413A77 ; ---------------------------------------------------------------------------
.text:00413A77
.text:00413A77 $LN33:				       ; DATA XREF: .rdata:0042099Co
.text:00413A77		       mov     edi, [ebp+i]
.text:00413A7A		       mov     esi, [ebp+pio]
.text:00413A7D
.text:00413A7D $LN35_1:				       ; CODE XREF: __alloc_osfhnd+A6p
.text:00413A7D		       push    0Ah	       ; locknum
.text:00413A7F		       call    __unlock
.text:00413A84		       pop     ecx
.text:00413A85
.text:00413A85 $LN34:
.text:00413A85		       retn
.text:00413A86 ; ---------------------------------------------------------------------------
.text:00413A86
.text:00413A86 loc_413A86:			       ; CODE XREF: __alloc_osfhnd+BFj
.text:00413A86		       cmp     [ebp+failed], 0
.text:00413A8A		       jnz     short loc_413A72
.text:00413A8C		       mov     byte ptr	[esi+4], 1
.text:00413A90		       or      dword ptr [esi],	0FFFFFFFFh
.text:00413A93		       sub     esi, ___pioinfo[edi*4]
.text:00413A9A		       sar     esi, 6
.text:00413A9D		       mov     eax, edi
.text:00413A9F		       shl     eax, 5
.text:00413AA2		       add     esi, eax
.text:00413AA4		       mov     [ebp+fh], esi
.text:00413AA7
.text:00413AA7 loc_413AA7:			       ; CODE XREF: __alloc_osfhnd+60j
.text:00413AA7		       cmp     [ebp+fh], 0FFFFFFFFh
.text:00413AAB		       jnz     short loc_413B26
.text:00413AAD		       inc     edi
.text:00413AAE		       jmp     loc_4139DE
.text:00413AB3 ; ---------------------------------------------------------------------------
.text:00413AB3
.text:00413AB3 loc_413AB3:			       ; CODE XREF: __alloc_osfhnd+49j
.text:00413AB3		       push    40h	       ; size
.text:00413AB5		       push    20h	       ; count
.text:00413AB7		       call    __calloc_crt
.text:00413ABC		       pop     ecx
.text:00413ABD		       pop     ecx
.text:00413ABE		       mov     [ebp+pio], eax
.text:00413AC1		       test    eax, eax
.text:00413AC3		       jz      short loc_413B26
.text:00413AC5		       lea     ecx, ds:422F40h[edi*4]
.text:00413ACC		       mov     [ecx], eax
.text:00413ACE		       add     __nhandle, 20h
.text:00413AD5
.text:00413AD5 loc_413AD5:			       ; CODE XREF: __alloc_osfhnd+14Cj
.text:00413AD5		       mov     edx, [ecx]
.text:00413AD7		       add     edx, 800h
.text:00413ADD		       cmp     eax, edx
.text:00413ADF		       jnb     short loc_413AF8
.text:00413AE1		       mov     byte ptr	[eax+4], 0
.text:00413AE5		       or      dword ptr [eax],	0FFFFFFFFh
.text:00413AE8		       mov     byte ptr	[eax+5], 0Ah
.text:00413AEC		       and     dword ptr [eax+8], 0
.text:00413AF0		       add     eax, 40h
.text:00413AF3		       mov     [ebp+pio], eax
.text:00413AF6		       jmp     short loc_413AD5
.text:00413AF8 ; ---------------------------------------------------------------------------
.text:00413AF8
.text:00413AF8 loc_413AF8:			       ; CODE XREF: __alloc_osfhnd+135j
.text:00413AF8		       shl     edi, 5
.text:00413AFB		       mov     [ebp+fh], edi
.text:00413AFE		       mov     eax, edi
.text:00413B00		       sar     eax, 5
.text:00413B03		       mov     ecx, edi
.text:00413B05		       and     ecx, 1Fh
.text:00413B08		       shl     ecx, 6
.text:00413B0B		       mov     eax, ___pioinfo[eax*4]
.text:00413B12		       mov     byte ptr	[eax+ecx+4], 1
.text:00413B17		       push    edi	       ; fh
.text:00413B18		       call    ___lock_fhandle
.text:00413B1D		       pop     ecx
.text:00413B1E		       test    eax, eax
.text:00413B20		       jnz     short loc_413B26
.text:00413B22		       or      [ebp+fh], 0FFFFFFFFh
.text:00413B26
.text:00413B26 loc_413B26:			       ; CODE XREF: __alloc_osfhnd+3Aj
.text:00413B26					       ; __alloc_osfhnd+101j ...
.text:00413B26		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00413B2D		       call    $LN29_0
.text:00413B32
.text:00413B32 $LN32:
.text:00413B32		       mov     eax, [ebp+fh]
.text:00413B35
.text:00413B35 loc_413B35:			       ; CODE XREF: __alloc_osfhnd+24j
.text:00413B35		       call    __SEH_epilog4
.text:00413B3A		       retn
.text:00413B3B ; ---------------------------------------------------------------------------
.text:00413B3B
.text:00413B3B $LN29_0:				       ; CODE XREF: __alloc_osfhnd+183p
.text:00413B3B					       ; DATA XREF: .rdata:00420990o
.text:00413B3B		       push    0Bh	       ; locknum
.text:00413B3D		       call    __unlock
.text:00413B42		       pop     ecx
.text:00413B43
.text:00413B43 $LN30_1:
.text:00413B43		       retn
.text:00413B43 __alloc_osfhnd  endp ; sp-analysis failed
.text:00413B43
.text:00413B44
.text:00413B44 ; =============== S U B R O U T I N E =======================================
.text:00413B44
.text:00413B44 ; Attributes: bp-based frame
.text:00413B44
.text:00413B44 ; int __cdecl _open_osfhandle(int osfhandle, int	flags)
.text:00413B44 __open_osfhandle	proc near
.text:00413B44
.text:00413B44 success	       = dword ptr -1Ch
.text:00413B44 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00413B44 osfhandle       = dword ptr  8
.text:00413B44 fh	       = dword ptr  0Ch
.text:00413B44
.text:00413B44		       push    0Ch
.text:00413B46		       push    offset dword_4209A0
.text:00413B4B		       call    __SEH_prolog4
.text:00413B50		       xor     edi, edi
.text:00413B52		       mov     [ebp+success], edi
.text:00413B55		       xor     bl, bl
.text:00413B57		       test    byte ptr	[ebp+fh], 8
.text:00413B5B		       jz      short loc_413B60
.text:00413B5D		       add     bl, 20h
.text:00413B60
.text:00413B60 loc_413B60:			       ; CODE XREF: __open_osfhandle+17j
.text:00413B60		       test    word ptr	[ebp+fh], 4000h
.text:00413B66		       jz      short loc_413B6B
.text:00413B68		       or      bl, 80h
.text:00413B6B
.text:00413B6B loc_413B6B:			       ; CODE XREF: __open_osfhandle+22j
.text:00413B6B		       test    byte ptr	[ebp+fh], 80h
.text:00413B6F		       jz      short loc_413B74
.text:00413B71		       or      bl, 10h
.text:00413B74
.text:00413B74 loc_413B74:			       ; CODE XREF: __open_osfhandle+2Bj
.text:00413B74		       push    [ebp+osfhandle] ; hFile
.text:00413B77		       call    ds:__imp__GetFileType@4 ; GetFileType(x)
.text:00413B7D		       cmp     eax, edi
.text:00413B7F		       jnz     short loc_413B97
.text:00413B81		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00413B87		       push    eax	       ; oserrno
.text:00413B88		       call    __dosmaperr
.text:00413B8D		       pop     ecx
.text:00413B8E
.text:00413B8E loc_413B8E:			       ; CODE XREF: __open_osfhandle+86j
.text:00413B8E					       ; __open_osfhandle+DBj
.text:00413B8E		       or      eax, 0FFFFFFFFh
.text:00413B91
.text:00413B91 loc_413B91:			       ; CODE XREF: __open_osfhandle+E3j
.text:00413B91		       call    __SEH_epilog4
.text:00413B96		       retn
.text:00413B97 ; ---------------------------------------------------------------------------
.text:00413B97
.text:00413B97 loc_413B97:			       ; CODE XREF: __open_osfhandle+3Bj
.text:00413B97		       cmp     eax, 2
.text:00413B9A		       jnz     short loc_413BA1
.text:00413B9C		       or      bl, 40h
.text:00413B9F		       jmp     short loc_413BA9
.text:00413BA1 ; ---------------------------------------------------------------------------
.text:00413BA1
.text:00413BA1 loc_413BA1:			       ; CODE XREF: __open_osfhandle+56j
.text:00413BA1		       cmp     eax, 3
.text:00413BA4		       jnz     short loc_413BA9
.text:00413BA6		       or      bl, 8
.text:00413BA9
.text:00413BA9 loc_413BA9:			       ; CODE XREF: __open_osfhandle+5Bj
.text:00413BA9					       ; __open_osfhandle+60j
.text:00413BA9		       call    __alloc_osfhnd
.text:00413BAE		       mov     esi, eax
.text:00413BB0		       mov     [ebp+fh], esi
.text:00413BB3		       cmp     esi, 0FFFFFFFFh
.text:00413BB6		       jnz     short loc_413BCC
.text:00413BB8		       call    __errno
.text:00413BBD		       mov     dword ptr [eax],	18h
.text:00413BC3		       call    ___doserrno
.text:00413BC8		       mov     [eax], edi
.text:00413BCA		       jmp     short loc_413B8E
.text:00413BCC ; ---------------------------------------------------------------------------
.text:00413BCC
.text:00413BCC loc_413BCC:			       ; CODE XREF: __open_osfhandle+72j
.text:00413BCC		       mov     [ebp+ms_exc.disabled], edi
.text:00413BCF		       push    [ebp+osfhandle] ; value
.text:00413BD2		       push    esi	       ; fh
.text:00413BD3		       call    __set_osfhnd
.text:00413BD8		       pop     ecx
.text:00413BD9		       pop     ecx
.text:00413BDA		       or      bl, 1
.text:00413BDD		       mov     eax, esi
.text:00413BDF		       sar     eax, 5
.text:00413BE2		       lea     ecx, ds:422F40h[eax*4]
.text:00413BE9		       mov     eax, esi
.text:00413BEB		       and     eax, 1Fh
.text:00413BEE		       shl     eax, 6
.text:00413BF1		       mov     edx, [ecx]
.text:00413BF3		       mov     [edx+eax+4], bl
.text:00413BF7		       mov     edx, [ecx]
.text:00413BF9		       lea     edx, [edx+eax+24h]
.text:00413BFD		       and     byte ptr	[edx], 80h
.text:00413C00		       mov     ecx, [ecx]
.text:00413C02		       lea     eax, [ecx+eax+24h]
.text:00413C06		       and     byte ptr	[eax], 7Fh
.text:00413C09		       mov     [ebp+success], 1
.text:00413C10		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00413C17		       call    $LN18_2
.text:00413C1C
.text:00413C1C $LN19_5:
.text:00413C1C		       cmp     [ebp+success], edi
.text:00413C1F		       jz      loc_413B8E
.text:00413C25		       mov     eax, esi
.text:00413C27		       jmp     loc_413B91
.text:00413C2C ; ---------------------------------------------------------------------------
.text:00413C2C
.text:00413C2C $LN16_4:				       ; DATA XREF: .rdata:004209B8o
.text:00413C2C		       mov     esi, [ebp+fh]
.text:00413C2F		       xor     edi, edi
.text:00413C31
.text:00413C31 $LN18_2:				       ; CODE XREF: __open_osfhandle+D3p
.text:00413C31		       cmp     [ebp+success], edi
.text:00413C34		       jnz     short loc_413C51
.text:00413C36		       mov     eax, esi
.text:00413C38		       sar     eax, 5
.text:00413C3B		       mov     ecx, esi
.text:00413C3D		       and     ecx, 1Fh
.text:00413C40		       shl     ecx, 6
.text:00413C43		       mov     eax, ___pioinfo[eax*4]
.text:00413C4A		       lea     eax, [eax+ecx+4]
.text:00413C4E		       and     byte ptr	[eax], 0FEh
.text:00413C51
.text:00413C51 loc_413C51:			       ; CODE XREF: __open_osfhandle+F0j
.text:00413C51		       push    esi	       ; fh
.text:00413C52		       call    __unlock_fhandle
.text:00413C57		       pop     ecx
.text:00413C58
.text:00413C58 $LN17_5:
.text:00413C58		       retn
.text:00413C58 __open_osfhandle	endp ; sp-analysis failed
.text:00413C58
.text:00413C59
.text:00413C59 ; =============== S U B R O U T I N E =======================================
.text:00413C59
.text:00413C59 ; Attributes: bp-based frame
.text:00413C59
.text:00413C59 ; int __cdecl __ansicp(int lcid)
.text:00413C59 ___ansicp       proc near	       ; CODE XREF: __crtLCMapStringA_stat+25Ap
.text:00413C59					       ; __crtGetStringTypeA_stat+150p	...
.text:00413C59
.text:00413C59 nptr	       = byte ptr -0Ch
.text:00413C59 var_6	       = byte ptr -6
.text:00413C59 var_4	       = dword ptr -4
.text:00413C59 lcid	       = dword ptr  8
.text:00413C59
.text:00413C59		       push    ebp
.text:00413C5A		       mov     ebp, esp
.text:00413C5C		       sub     esp, 0Ch
.text:00413C5F		       mov     eax, ___security_cookie
.text:00413C64		       xor     eax, ebp
.text:00413C66		       mov     [ebp+var_4], eax
.text:00413C69		       push    6	       ; cchData
.text:00413C6B		       lea     eax, [ebp+nptr]
.text:00413C6E		       push    eax	       ; lpLCData
.text:00413C6F		       push    1004h	       ; LCType
.text:00413C74		       push    [ebp+lcid]      ; Locale
.text:00413C77		       mov     [ebp+var_6], 0
.text:00413C7B		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:00413C81		       test    eax, eax
.text:00413C83		       jnz     short loc_413C8A
.text:00413C85		       or      eax, 0FFFFFFFFh
.text:00413C88		       jmp     short loc_413C94
.text:00413C8A ; ---------------------------------------------------------------------------
.text:00413C8A
.text:00413C8A loc_413C8A:			       ; CODE XREF: ___ansicp+2Aj
.text:00413C8A		       lea     eax, [ebp+nptr]
.text:00413C8D		       push    eax	       ; nptr
.text:00413C8E		       call    _atol
.text:00413C93		       pop     ecx
.text:00413C94
.text:00413C94 loc_413C94:			       ; CODE XREF: ___ansicp+2Fj
.text:00413C94		       mov     ecx, [ebp+var_4]
.text:00413C97		       xor     ecx, ebp	       ; cookie
.text:00413C99		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00413C9E		       leave
.text:00413C9F		       retn
.text:00413C9F ___ansicp       endp
.text:00413C9F
.text:00413CA0
.text:00413CA0 ; =============== S U B R O U T I N E =======================================
.text:00413CA0
.text:00413CA0 ; Attributes: bp-based frame
.text:00413CA0
.text:00413CA0 ; char *__cdecl __convertcp(int fromCP, int toCP, const char *lpSrcStr, int *pcchSrc, char *lpDestStr, int cchDest)
.text:00413CA0 ___convertcp    proc near	       ; CODE XREF: __crtLCMapStringA_stat+285p
.text:00413CA0					       ; __crtLCMapStringA_stat+336p ...
.text:00413CA0
.text:00413CA0 var_34	       = dword ptr -34h
.text:00413CA0 var_30	       = dword ptr -30h
.text:00413CA0 sb	       = dword ptr -2Ch
.text:00413CA0 lpMultiByteStr  = dword ptr -28h
.text:00413CA0 cchSrc	       = dword ptr -24h
.text:00413CA0 cbuffer	       = dword ptr -20h
.text:00413CA0 wbuffer	       = dword ptr -1Ch
.text:00413CA0 cpi	       = _cpinfo ptr -18h
.text:00413CA0 var_4	       = dword ptr -4
.text:00413CA0 fromCP	       = dword ptr  8
.text:00413CA0 toCP	       = dword ptr  0Ch
.text:00413CA0 lpSrcStr	       = dword ptr  10h
.text:00413CA0 pcchSrc	       = dword ptr  14h
.text:00413CA0 lpDestStr       = dword ptr  18h
.text:00413CA0 cchDest	       = dword ptr  1Ch
.text:00413CA0
.text:00413CA0		       push    ebp
.text:00413CA1		       mov     ebp, esp
.text:00413CA3		       sub     esp, 34h
.text:00413CA6		       mov     eax, ___security_cookie
.text:00413CAB		       xor     eax, ebp
.text:00413CAD		       mov     [ebp+var_4], eax
.text:00413CB0		       mov     eax, [ebp+lpSrcStr]
.text:00413CB3		       mov     ecx, [ebp+lpDestStr]
.text:00413CB6		       mov     [ebp+lpMultiByteStr], eax
.text:00413CB9		       mov     eax, [ebp+pcchSrc]
.text:00413CBC		       push    ebx
.text:00413CBD		       mov     [ebp+var_30], eax
.text:00413CC0		       mov     eax, [eax]
.text:00413CC2		       push    esi
.text:00413CC3		       mov     [ebp+cchSrc], eax
.text:00413CC6		       mov     eax, [ebp+fromCP]
.text:00413CC9		       push    edi
.text:00413CCA		       xor     edi, edi
.text:00413CCC		       cmp     eax, [ebp+toCP]
.text:00413CCF		       mov     [ebp+var_34], ecx
.text:00413CD2		       mov     [ebp+cbuffer], edi
.text:00413CD5		       mov     [ebp+sb], edi
.text:00413CD8		       jz      loc_413E3D
.text:00413CDE		       mov     esi, ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:00413CE4		       lea     ecx, [ebp+cpi]
.text:00413CE7		       push    ecx	       ; lpCPInfo
.text:00413CE8		       push    eax	       ; CodePage
.text:00413CE9		       call    esi ; GetCPInfo(x,x) ; GetCPInfo(x,x)
.text:00413CEB		       test    eax, eax
.text:00413CED		       mov     ebx, ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
.text:00413CF3		       jz      short loc_413D53
.text:00413CF5		       cmp     [ebp+cpi.MaxCharSize], 1
.text:00413CF9		       jnz     short loc_413D53
.text:00413CFB		       lea     eax, [ebp+cpi]
.text:00413CFE		       push    eax	       ; lpCPInfo
.text:00413CFF		       push    [ebp+toCP]      ; CodePage
.text:00413D02		       call    esi ; GetCPInfo(x,x) ; GetCPInfo(x,x)
.text:00413D04		       test    eax, eax
.text:00413D06		       jz      short loc_413D53
.text:00413D08		       cmp     [ebp+cpi.MaxCharSize], 1
.text:00413D0C		       jnz     short loc_413D53
.text:00413D0E		       mov     esi, [ebp+cchSrc]
.text:00413D11		       cmp     esi, 0FFFFFFFFh
.text:00413D14		       mov     [ebp+sb], 1
.text:00413D1B		       jnz     short loc_413D29
.text:00413D1D		       push    [ebp+lpMultiByteStr] ; buf
.text:00413D20		       call    _strlen
.text:00413D25		       mov     esi, eax
.text:00413D27		       pop     ecx
.text:00413D28		       inc     esi
.text:00413D29
.text:00413D29 loc_413D29:			       ; CODE XREF: ___convertcp+7Bj
.text:00413D29		       cmp     esi, edi
.text:00413D2B
.text:00413D2B loc_413D2B:			       ; CODE XREF: ___convertcp+C6j
.text:00413D2B		       jle     short loc_413D88
.text:00413D2D		       cmp     esi, 7FFFFFF0h
.text:00413D33		       ja      short loc_413D88
.text:00413D35		       lea     eax, [esi+esi+8]
.text:00413D39		       cmp     eax, 400h
.text:00413D3E		       ja      short loc_413D6F
.text:00413D40		       call    __alloca_probe_16
.text:00413D45		       mov     eax, esp
.text:00413D47		       cmp     eax, edi
.text:00413D49		       jz      short loc_413D83
.text:00413D4B		       mov     dword ptr [eax],	0CCCCh
.text:00413D51		       jmp     short loc_413D80
.text:00413D53 ; ---------------------------------------------------------------------------
.text:00413D53
.text:00413D53 loc_413D53:			       ; CODE XREF: ___convertcp+53j
.text:00413D53					       ; ___convertcp+59j ...
.text:00413D53		       push    edi	       ; cchWideChar
.text:00413D54		       push    edi	       ; lpWideCharStr
.text:00413D55		       push    [ebp+cchSrc]    ; cbMultiByte
.text:00413D58		       push    [ebp+lpMultiByteStr] ; lpMultiByteStr
.text:00413D5B		       push    1	       ; dwFlags
.text:00413D5D		       push    [ebp+fromCP]    ; CodePage
.text:00413D60		       call    ebx ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00413D62		       mov     esi, eax
.text:00413D64		       cmp     esi, edi
.text:00413D66		       jnz     short loc_413D2B
.text:00413D68
.text:00413D68 loc_413D68:			       ; CODE XREF: ___convertcp+EEj
.text:00413D68		       xor     eax, eax
.text:00413D6A		       jmp     loc_413E40
.text:00413D6F ; ---------------------------------------------------------------------------
.text:00413D6F
.text:00413D6F loc_413D6F:			       ; CODE XREF: ___convertcp+9Ej
.text:00413D6F		       push    eax	       ; size
.text:00413D70		       call    _malloc
.text:00413D75		       cmp     eax, edi
.text:00413D77		       pop     ecx
.text:00413D78		       jz      short loc_413D83
.text:00413D7A		       mov     dword ptr [eax],	0DDDDh
.text:00413D80
.text:00413D80 loc_413D80:			       ; CODE XREF: ___convertcp+B1j
.text:00413D80		       add     eax, 8
.text:00413D83
.text:00413D83 loc_413D83:			       ; CODE XREF: ___convertcp+A9j
.text:00413D83					       ; ___convertcp+D8j
.text:00413D83		       mov     [ebp+wbuffer], eax
.text:00413D86		       jmp     short loc_413D8B
.text:00413D88 ; ---------------------------------------------------------------------------
.text:00413D88
.text:00413D88 loc_413D88:			       ; CODE XREF: ___convertcp:loc_413D2Bj
.text:00413D88					       ; ___convertcp+93j
.text:00413D88		       mov     [ebp+wbuffer], edi
.text:00413D8B
.text:00413D8B loc_413D8B:			       ; CODE XREF: ___convertcp+E6j
.text:00413D8B		       cmp     [ebp+wbuffer], edi
.text:00413D8E		       jz      short loc_413D68
.text:00413D90		       lea     eax, [esi+esi]
.text:00413D93		       push    eax	       ; count
.text:00413D94		       push    edi	       ; value
.text:00413D95		       push    [ebp+wbuffer]   ; dst
.text:00413D98		       call    _memset
.text:00413D9D		       add     esp, 0Ch
.text:00413DA0		       push    esi	       ; cchWideChar
.text:00413DA1		       push    [ebp+wbuffer]   ; lpWideCharStr
.text:00413DA4		       push    [ebp+cchSrc]    ; cbMultiByte
.text:00413DA7		       push    [ebp+lpMultiByteStr] ; lpMultiByteStr
.text:00413DAA		       push    1	       ; dwFlags
.text:00413DAC		       push    [ebp+fromCP]    ; CodePage
.text:00413DAF		       call    ebx ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00413DB1		       test    eax, eax
.text:00413DB3		       jz      short loc_413E34
.text:00413DB5		       mov     ebx, [ebp+var_34]
.text:00413DB8		       cmp     ebx, edi
.text:00413DBA		       jz      short loc_413DD9
.text:00413DBC		       push    edi	       ; lpUsedDefaultChar
.text:00413DBD		       push    edi	       ; lpDefaultChar
.text:00413DBE		       push    [ebp+cchDest]   ; cbMultiByte
.text:00413DC1		       push    ebx	       ; lpMultiByteStr
.text:00413DC2		       push    esi	       ; cchWideChar
.text:00413DC3		       push    [ebp+wbuffer]   ; lpWideCharStr
.text:00413DC6		       push    edi	       ; dwFlags
.text:00413DC7		       push    [ebp+toCP]      ; CodePage
.text:00413DCA		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00413DD0		       test    eax, eax
.text:00413DD2		       jz      short loc_413E34
.text:00413DD4		       mov     [ebp+cbuffer], ebx
.text:00413DD7		       jmp     short loc_413E34
.text:00413DD9 ; ---------------------------------------------------------------------------
.text:00413DD9
.text:00413DD9 loc_413DD9:			       ; CODE XREF: ___convertcp+11Aj
.text:00413DD9		       cmp     [ebp+sb], edi
.text:00413DDC		       mov     ebx, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00413DE2		       jnz     short loc_413DF8
.text:00413DE4		       push    edi	       ; lpUsedDefaultChar
.text:00413DE5		       push    edi	       ; lpDefaultChar
.text:00413DE6		       push    edi	       ; cbMultiByte
.text:00413DE7		       push    edi	       ; lpMultiByteStr
.text:00413DE8		       push    esi	       ; cchWideChar
.text:00413DE9		       push    [ebp+wbuffer]   ; lpWideCharStr
.text:00413DEC		       push    edi	       ; dwFlags
.text:00413DED		       push    [ebp+toCP]      ; CodePage
.text:00413DF0		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00413DF2		       mov     esi, eax
.text:00413DF4		       cmp     esi, edi
.text:00413DF6		       jz      short loc_413E34
.text:00413DF8
.text:00413DF8 loc_413DF8:			       ; CODE XREF: ___convertcp+142j
.text:00413DF8		       push    esi	       ; size
.text:00413DF9		       push    1	       ; count
.text:00413DFB		       call    __calloc_crt
.text:00413E00		       cmp     eax, edi
.text:00413E02		       pop     ecx
.text:00413E03		       pop     ecx
.text:00413E04		       mov     [ebp+cbuffer], eax
.text:00413E07		       jz      short loc_413E34
.text:00413E09		       push    edi	       ; lpUsedDefaultChar
.text:00413E0A		       push    edi	       ; lpDefaultChar
.text:00413E0B		       push    esi	       ; cbMultiByte
.text:00413E0C		       push    eax	       ; lpMultiByteStr
.text:00413E0D		       push    esi	       ; cchWideChar
.text:00413E0E		       push    [ebp+wbuffer]   ; lpWideCharStr
.text:00413E11		       push    edi	       ; dwFlags
.text:00413E12		       push    [ebp+toCP]      ; CodePage
.text:00413E15		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00413E17		       cmp     eax, edi
.text:00413E19		       jnz     short loc_413E29
.text:00413E1B		       push    [ebp+cbuffer]   ; pBlock
.text:00413E1E		       call    _free
.text:00413E23		       pop     ecx
.text:00413E24		       mov     [ebp+cbuffer], edi
.text:00413E27		       jmp     short loc_413E34
.text:00413E29 ; ---------------------------------------------------------------------------
.text:00413E29
.text:00413E29 loc_413E29:			       ; CODE XREF: ___convertcp+179j
.text:00413E29		       cmp     [ebp+cchSrc], 0FFFFFFFFh
.text:00413E2D		       jz      short loc_413E34
.text:00413E2F		       mov     ecx, [ebp+var_30]
.text:00413E32		       mov     [ecx], eax
.text:00413E34
.text:00413E34 loc_413E34:			       ; CODE XREF: ___convertcp+113j
.text:00413E34					       ; ___convertcp+132j ...
.text:00413E34		       push    [ebp+wbuffer]   ; _Memory
.text:00413E37		       call    __freea
.text:00413E3C		       pop     ecx
.text:00413E3D
.text:00413E3D loc_413E3D:			       ; CODE XREF: ___convertcp+38j
.text:00413E3D		       mov     eax, [ebp+cbuffer]
.text:00413E40
.text:00413E40 loc_413E40:			       ; CODE XREF: ___convertcp+CAj
.text:00413E40		       lea     esp, [ebp-40h]
.text:00413E43		       pop     edi
.text:00413E44		       pop     esi
.text:00413E45		       pop     ebx
.text:00413E46		       mov     ecx, [ebp+var_4]
.text:00413E49		       xor     ecx, ebp	       ; cookie
.text:00413E4B		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00413E50		       leave
.text:00413E51		       retn
.text:00413E51 ___convertcp    endp
.text:00413E51
.text:00413E52
.text:00413E52 ; =============== S U B R O U T I N E =======================================
.text:00413E52
.text:00413E52
.text:00413E52 ; int __cdecl _get_daylight(int *_Daylight)
.text:00413E52 __get_daylight  proc near	       ; CODE XREF: _tzset_nolock+52p
.text:00413E52					       ; _isindst_nolock+10p
.text:00413E52
.text:00413E52 _Daylight       = dword ptr  4
.text:00413E52
.text:00413E52		       mov     eax, [esp+_Daylight]
.text:00413E56		       push    esi
.text:00413E57		       xor     esi, esi
.text:00413E59		       cmp     eax, esi
.text:00413E5B		       jnz     short loc_413E7A
.text:00413E5D		       call    __errno
.text:00413E62		       push    esi	       ; pReserved
.text:00413E63		       push    esi	       ; nLine
.text:00413E64		       push    esi	       ; pszFile
.text:00413E65		       push    esi	       ; pszFunction
.text:00413E66		       push    esi	       ; pszExpression
.text:00413E67		       mov     dword ptr [eax],	16h
.text:00413E6D		       call    __invalid_parameter
.text:00413E72		       add     esp, 14h
.text:00413E75		       push    16h
.text:00413E77		       pop     eax
.text:00413E78		       pop     esi
.text:00413E79		       retn
.text:00413E7A ; ---------------------------------------------------------------------------
.text:00413E7A
.text:00413E7A loc_413E7A:			       ; CODE XREF: __get_daylight+9j
.text:00413E7A		       mov     ecx, __daylight
.text:00413E80		       mov     [eax], ecx
.text:00413E82		       xor     eax, eax
.text:00413E84		       pop     esi
.text:00413E85		       retn
.text:00413E85 __get_daylight  endp
.text:00413E85
.text:00413E86
.text:00413E86 ; =============== S U B R O U T I N E =======================================
.text:00413E86
.text:00413E86
.text:00413E86 ; int __cdecl _get_dstbias(int *_Daylight_savings_bias)
.text:00413E86 __get_dstbias   proc near	       ; CODE XREF: _tzset_nolock+6Dp
.text:00413E86					       ; cvtdate+195p
.text:00413E86
.text:00413E86 _Daylight_savings_bias= dword ptr  4
.text:00413E86
.text:00413E86		       mov     eax, [esp+_Daylight_savings_bias]
.text:00413E8A		       push    esi
.text:00413E8B		       xor     esi, esi
.text:00413E8D		       cmp     eax, esi
.text:00413E8F		       jnz     short loc_413EAE
.text:00413E91		       call    __errno
.text:00413E96		       push    esi	       ; pReserved
.text:00413E97		       push    esi	       ; nLine
.text:00413E98		       push    esi	       ; pszFile
.text:00413E99		       push    esi	       ; pszFunction
.text:00413E9A		       push    esi	       ; pszExpression
.text:00413E9B		       mov     dword ptr [eax],	16h
.text:00413EA1		       call    __invalid_parameter
.text:00413EA6		       add     esp, 14h
.text:00413EA9		       push    16h
.text:00413EAB		       pop     eax
.text:00413EAC		       pop     esi
.text:00413EAD		       retn
.text:00413EAE ; ---------------------------------------------------------------------------
.text:00413EAE
.text:00413EAE loc_413EAE:			       ; CODE XREF: __get_dstbias+9j
.text:00413EAE		       mov     ecx, __dstbias
.text:00413EB4		       mov     [eax], ecx
.text:00413EB6		       xor     eax, eax
.text:00413EB8		       pop     esi
.text:00413EB9		       retn
.text:00413EB9 __get_dstbias   endp
.text:00413EB9
.text:00413EBA
.text:00413EBA ; =============== S U B R O U T I N E =======================================
.text:00413EBA
.text:00413EBA
.text:00413EBA ; int __cdecl _get_timezone(int *_Timezone)
.text:00413EBA __get_timezone  proc near	       ; CODE XREF: _tzset_nolock+37p
.text:00413EBA
.text:00413EBA _Timezone       = dword ptr  4
.text:00413EBA
.text:00413EBA		       mov     eax, [esp+_Timezone]
.text:00413EBE		       push    esi
.text:00413EBF		       xor     esi, esi
.text:00413EC1		       cmp     eax, esi
.text:00413EC3		       jnz     short loc_413EE2
.text:00413EC5		       call    __errno
.text:00413ECA		       push    esi	       ; pReserved
.text:00413ECB		       push    esi	       ; nLine
.text:00413ECC		       push    esi	       ; pszFile
.text:00413ECD		       push    esi	       ; pszFunction
.text:00413ECE		       push    esi	       ; pszExpression
.text:00413ECF		       mov     dword ptr [eax],	16h
.text:00413ED5		       call    __invalid_parameter
.text:00413EDA		       add     esp, 14h
.text:00413EDD		       push    16h
.text:00413EDF		       pop     eax
.text:00413EE0		       pop     esi
.text:00413EE1		       retn
.text:00413EE2 ; ---------------------------------------------------------------------------
.text:00413EE2
.text:00413EE2 loc_413EE2:			       ; CODE XREF: __get_timezone+9j
.text:00413EE2		       mov     ecx, __timezone
.text:00413EE8		       mov     [eax], ecx
.text:00413EEA		       xor     eax, eax
.text:00413EEC		       pop     esi
.text:00413EED		       retn
.text:00413EED __get_timezone  endp
.text:00413EED
.text:00413EEE
.text:00413EEE ; =============== S U B R O U T I N E =======================================
.text:00413EEE
.text:00413EEE ; Attributes: bp-based frame
.text:00413EEE
.text:00413EEE ; int __cdecl _get_tzname(unsigned int *_ReturnValue, char *_Buffer, unsigned int _SizeInBytes, int _Index)
.text:00413EEE __get_tzname    proc near
.text:00413EEE
.text:00413EEE _ReturnValue    = dword ptr  8
.text:00413EEE _Buffer	       = dword ptr  0Ch
.text:00413EEE _SizeInBytes    = dword ptr  10h
.text:00413EEE _Index	       = dword ptr  14h
.text:00413EEE
.text:00413EEE		       push    ebp
.text:00413EEF		       mov     ebp, esp
.text:00413EF1		       mov     eax, [ebp+_Buffer]
.text:00413EF4		       push    ebx
.text:00413EF5		       xor     ebx, ebx
.text:00413EF7		       cmp     eax, ebx
.text:00413EF9		       push    esi
.text:00413EFA		       jz      short loc_413F36
.text:00413EFC		       cmp     [ebp+_SizeInBytes], ebx
.text:00413EFF		       jbe     short loc_413F3B
.text:00413F01
.text:00413F01 loc_413F01:			       ; CODE XREF: __get_tzname+4Bj
.text:00413F01		       cmp     eax, ebx
.text:00413F03		       jz      short loc_413F07
.text:00413F05		       mov     [eax], bl
.text:00413F07
.text:00413F07 loc_413F07:			       ; CODE XREF: __get_tzname+15j
.text:00413F07		       push    edi
.text:00413F08		       mov     edi, [ebp+_ReturnValue]
.text:00413F0B		       cmp     edi, ebx
.text:00413F0D		       jz      short loc_413F1B
.text:00413F0F		       mov     eax, [ebp+_Index]
.text:00413F12		       cmp     eax, ebx
.text:00413F14		       jz      short loc_413F56
.text:00413F16		       cmp     eax, 1
.text:00413F19		       jz      short loc_413F56
.text:00413F1B
.text:00413F1B loc_413F1B:			       ; CODE XREF: __get_tzname+1Fj
.text:00413F1B		       call    __errno
.text:00413F20		       push    16h
.text:00413F22		       pop     esi
.text:00413F23		       push    ebx	       ; pReserved
.text:00413F24		       push    ebx	       ; nLine
.text:00413F25		       push    ebx	       ; pszFile
.text:00413F26		       push    ebx	       ; pszFunction
.text:00413F27		       push    ebx	       ; pszExpression
.text:00413F28		       mov     [eax], esi
.text:00413F2A		       call    __invalid_parameter
.text:00413F2F		       add     esp, 14h
.text:00413F32		       mov     eax, esi
.text:00413F34		       jmp     short loc_413F8B
.text:00413F36 ; ---------------------------------------------------------------------------
.text:00413F36
.text:00413F36 loc_413F36:			       ; CODE XREF: __get_tzname+Cj
.text:00413F36		       cmp     [ebp+_SizeInBytes], ebx
.text:00413F39		       jz      short loc_413F01
.text:00413F3B
.text:00413F3B loc_413F3B:			       ; CODE XREF: __get_tzname+11j
.text:00413F3B		       call    __errno
.text:00413F40		       push    16h
.text:00413F42		       pop     esi
.text:00413F43		       push    ebx	       ; pReserved
.text:00413F44		       push    ebx	       ; nLine
.text:00413F45		       push    ebx	       ; pszFile
.text:00413F46		       push    ebx	       ; pszFunction
.text:00413F47		       push    ebx	       ; pszExpression
.text:00413F48		       mov     [eax], esi
.text:00413F4A		       call    __invalid_parameter
.text:00413F4F		       add     esp, 14h
.text:00413F52		       mov     eax, esi
.text:00413F54		       jmp     short loc_413F8C
.text:00413F56 ; ---------------------------------------------------------------------------
.text:00413F56
.text:00413F56 loc_413F56:			       ; CODE XREF: __get_tzname+26j
.text:00413F56					       ; __get_tzname+2Bj
.text:00413F56		       lea     esi, ds:421F48h[eax*4]
.text:00413F5D		       push    dword ptr [esi] ; buf
.text:00413F5F		       call    _strlen
.text:00413F64		       inc     eax
.text:00413F65		       cmp     [ebp+_Buffer], ebx
.text:00413F68		       pop     ecx
.text:00413F69		       mov     [edi], eax
.text:00413F6B		       jnz     short loc_413F71
.text:00413F6D		       xor     eax, eax
.text:00413F6F		       jmp     short loc_413F8B
.text:00413F71 ; ---------------------------------------------------------------------------
.text:00413F71
.text:00413F71 loc_413F71:			       ; CODE XREF: __get_tzname+7Dj
.text:00413F71		       cmp     eax, [ebp+_SizeInBytes]
.text:00413F74		       jbe     short loc_413F7B
.text:00413F76		       push    22h
.text:00413F78		       pop     eax
.text:00413F79		       jmp     short loc_413F8B
.text:00413F7B ; ---------------------------------------------------------------------------
.text:00413F7B
.text:00413F7B loc_413F7B:			       ; CODE XREF: __get_tzname+86j
.text:00413F7B		       push    dword ptr [esi] ; _Src
.text:00413F7D		       push    [ebp+_SizeInBytes] ; _SizeInBytes
.text:00413F80		       push    [ebp+_Buffer]   ; _Dst
.text:00413F83		       call    _strcpy_s
.text:00413F88		       add     esp, 0Ch
.text:00413F8B
.text:00413F8B loc_413F8B:			       ; CODE XREF: __get_tzname+46j
.text:00413F8B					       ; __get_tzname+81j ...
.text:00413F8B		       pop     edi
.text:00413F8C
.text:00413F8C loc_413F8C:			       ; CODE XREF: __get_tzname+66j
.text:00413F8C		       pop     esi
.text:00413F8D		       pop     ebx
.text:00413F8E		       pop     ebp
.text:00413F8F		       retn
.text:00413F8F __get_tzname    endp
.text:00413F8F
.text:00413F90
.text:00413F90 ; =============== S U B R O U T I N E =======================================
.text:00413F90
.text:00413F90
.text:00413F90 ; int *__cdecl __daylight()
.text:00413F90 ___daylight     proc near	       ; CODE XREF: __set_daylightp
.text:00413F90					       ; _tzset_nolock+230p ...
.text:00413F90		       mov     eax, offset __daylight
.text:00413F95		       retn
.text:00413F95 ___daylight     endp
.text:00413F95
.text:00413F96
.text:00413F96 ; =============== S U B R O U T I N E =======================================
.text:00413F96
.text:00413F96
.text:00413F96 ; int *__cdecl __dstbias()
.text:00413F96 ___dstbias      proc near	       ; CODE XREF: __set_dstbiasp
.text:00413F96					       ; _tzset_nolock+23Ap
.text:00413F96		       mov     eax, offset __dstbias
.text:00413F9B		       retn
.text:00413F9B ___dstbias      endp
.text:00413F9B
.text:00413F9C
.text:00413F9C ; =============== S U B R O U T I N E =======================================
.text:00413F9C
.text:00413F9C
.text:00413F9C ; int *__cdecl __timezone()
.text:00413F9C ___timezone     proc near	       ; CODE XREF: __set_timezonep
.text:00413F9C					       ; _tzset_nolock+226p ...
.text:00413F9C		       mov     eax, offset __timezone
.text:00413FA1		       retn
.text:00413FA1 ___timezone     endp
.text:00413FA1
.text:00413FA2
.text:00413FA2 ; =============== S U B R O U T I N E =======================================
.text:00413FA2
.text:00413FA2
.text:00413FA2 ; char **__cdecl	__tzname()
.text:00413FA2 ___tzname       proc near	       ; CODE XREF: _expandtime+332p
.text:00413FA2					       ; _tzset_nolock+2Bp
.text:00413FA2		       mov     eax, offset __tzname
.text:00413FA7		       retn
.text:00413FA7 ___tzname       endp
.text:00413FA7
.text:00413FA8
.text:00413FA8 ; =============== S U B R O U T I N E =======================================
.text:00413FA8
.text:00413FA8
.text:00413FA8 ; void __cdecl _set_daylight(int	_Value)
.text:00413FA8 __set_daylight  proc near
.text:00413FA8
.text:00413FA8 _Value	       = dword ptr  4
.text:00413FA8
.text:00413FA8		       call    ___daylight
.text:00413FAD		       mov     ecx, [esp+_Value]
.text:00413FB1		       mov     [eax], ecx
.text:00413FB3		       retn
.text:00413FB3 __set_daylight  endp
.text:00413FB3
.text:00413FB4
.text:00413FB4 ; =============== S U B R O U T I N E =======================================
.text:00413FB4
.text:00413FB4
.text:00413FB4 ; void __cdecl _set_dstbias(int _Value)
.text:00413FB4 __set_dstbias   proc near
.text:00413FB4
.text:00413FB4 _Value	       = dword ptr  4
.text:00413FB4
.text:00413FB4		       call    ___dstbias
.text:00413FB9		       mov     ecx, [esp+_Value]
.text:00413FBD		       mov     [eax], ecx
.text:00413FBF		       retn
.text:00413FBF __set_dstbias   endp
.text:00413FBF
.text:00413FC0
.text:00413FC0 ; =============== S U B R O U T I N E =======================================
.text:00413FC0
.text:00413FC0
.text:00413FC0 ; void __cdecl _set_timezone(int	_Value)
.text:00413FC0 __set_timezone  proc near
.text:00413FC0
.text:00413FC0 _Value	       = dword ptr  4
.text:00413FC0
.text:00413FC0		       call    ___timezone
.text:00413FC5		       mov     ecx, [esp+_Value]
.text:00413FC9		       mov     [eax], ecx
.text:00413FCB		       retn
.text:00413FCB __set_timezone  endp
.text:00413FCB
.text:00413FCC
.text:00413FCC ; =============== S U B R O U T I N E =======================================
.text:00413FCC
.text:00413FCC ; Attributes: noreturn bp-based frame
.text:00413FCC
.text:00413FCC _tzset_nolock   proc near	       ; CODE XREF: ___tzset+29p
.text:00413FCC					       ; __tzset+18p
.text:00413FCC
.text:00413FCC TZ	       = dword ptr -3Ch
.text:00413FCC negdiff	       = dword ptr -38h
.text:00413FCC lc_cp	       = dword ptr -34h
.text:00413FCC defused	       = dword ptr -30h
.text:00413FCC nochange	       = dword ptr -2Ch
.text:00413FCC dstbias	       = dword ptr -28h
.text:00413FCC daylight	       = dword ptr -24h
.text:00413FCC tzname	       = dword ptr -20h
.text:00413FCC timezone	       = dword ptr -1Ch
.text:00413FCC ms_exc	       = CPPEH_RECORD ptr -18h
.text:00413FCC
.text:00413FCC		       push    2Ch
.text:00413FCE		       push    offset dword_4209C0
.text:00413FD3		       call    __SEH_prolog4
.text:00413FD8		       xor     ebx, ebx
.text:00413FDA		       mov     [ebp+negdiff], ebx
.text:00413FDD		       mov     [ebp+nochange], ebx
.text:00413FE0		       mov     [ebp+timezone], ebx
.text:00413FE3		       mov     [ebp+daylight], ebx
.text:00413FE6		       mov     [ebp+dstbias], ebx
.text:00413FE9		       mov     [ebp+tzname], ebx
.text:00413FEC		       push    7	       ; locknum
.text:00413FEE		       call    __lock
.text:00413FF3		       pop     ecx
.text:00413FF4		       mov     [ebp+ms_exc.disabled], ebx
.text:00413FF7		       call    ___tzname
.text:00413FFC		       mov     [ebp+tzname], eax
.text:00413FFF		       lea     eax, [ebp+timezone]
.text:00414002		       push    eax	       ; _Timezone
.text:00414003		       call    __get_timezone
.text:00414008		       pop     ecx
.text:00414009		       cmp     eax, ebx
.text:0041400B		       jz      short loc_41401A
.text:0041400D		       push    ebx	       ; pReserved
.text:0041400E		       push    ebx	       ; nLine
.text:0041400F		       push    ebx	       ; pszFile
.text:00414010		       push    ebx	       ; pszFunction
.text:00414011		       push    ebx	       ; pszExpression
.text:00414012		       call    __invoke_watson
.text:00414017		       add     esp, 14h
.text:0041401A
.text:0041401A loc_41401A:			       ; CODE XREF: _tzset_nolock+3Fj
.text:0041401A		       lea     eax, [ebp+daylight]
.text:0041401D		       push    eax	       ; _Daylight
.text:0041401E		       call    __get_daylight
.text:00414023		       pop     ecx
.text:00414024		       cmp     eax, ebx
.text:00414026		       jz      short loc_414035
.text:00414028		       push    ebx	       ; pReserved
.text:00414029		       push    ebx	       ; nLine
.text:0041402A		       push    ebx	       ; pszFile
.text:0041402B		       push    ebx	       ; pszFunction
.text:0041402C		       push    ebx	       ; pszExpression
.text:0041402D		       call    __invoke_watson
.text:00414032		       add     esp, 14h
.text:00414035
.text:00414035 loc_414035:			       ; CODE XREF: _tzset_nolock+5Aj
.text:00414035		       lea     eax, [ebp+dstbias]
.text:00414038		       push    eax	       ; _Daylight_savings_bias
.text:00414039		       call    __get_dstbias
.text:0041403E		       pop     ecx
.text:0041403F		       cmp     eax, ebx
.text:00414041		       jz      short loc_414050
.text:00414043		       push    ebx	       ; pReserved
.text:00414044		       push    ebx	       ; nLine
.text:00414045		       push    ebx	       ; pszFile
.text:00414046		       push    ebx	       ; pszFunction
.text:00414047		       push    ebx	       ; pszExpression
.text:00414048		       call    __invoke_watson
.text:0041404D		       add     esp, 14h
.text:00414050
.text:00414050 loc_414050:			       ; CODE XREF: _tzset_nolock+75j
.text:00414050		       call    ____lc_codepage_func
.text:00414055		       mov     [ebp+lc_cp], eax
.text:00414058		       mov     tzapiused, ebx
.text:0041405E		       or      edi, 0FFFFFFFFh
.text:00414061		       mov     dstend.yr, edi
.text:00414067		       mov     dststart.yr, edi
.text:0041406D		       push    offset option   ; "TZ"
.text:00414072		       call    __getenv_helper_nolock
.text:00414077		       pop     ecx
.text:00414078		       mov     esi, eax
.text:0041407A		       mov     [ebp+TZ], esi
.text:0041407D		       cmp     esi, ebx
.text:0041407F		       jz      short loc_4140FD
.text:00414081		       cmp     [esi], bl
.text:00414083		       jz      short loc_4140FD
.text:00414085		       mov     eax, lastTZ
.text:0041408A		       cmp     eax, ebx
.text:0041408C		       jz      short loc_4140AF
.text:0041408E		       push    eax	       ; str2
.text:0041408F		       push    esi	       ; str1
.text:00414090		       call    _strcmp
.text:00414095		       pop     ecx
.text:00414096		       pop     ecx
.text:00414097		       test    eax, eax
.text:00414099		       jz      loc_4141E8
.text:0041409F		       mov     eax, lastTZ
.text:004140A4		       cmp     eax, ebx
.text:004140A6		       jz      short loc_4140AF
.text:004140A8		       push    eax	       ; pBlock
.text:004140A9		       call    _free
.text:004140AE		       pop     ecx
.text:004140AF
.text:004140AF loc_4140AF:			       ; CODE XREF: _tzset_nolock+C0j
.text:004140AF					       ; _tzset_nolock+DAj
.text:004140AF		       push    esi	       ; buf
.text:004140B0		       call    _strlen
.text:004140B5		       inc     eax
.text:004140B6		       push    eax	       ; cb
.text:004140B7		       call    __malloc_crt
.text:004140BC		       pop     ecx
.text:004140BD		       pop     ecx
.text:004140BE		       mov     lastTZ, eax
.text:004140C3		       cmp     eax, ebx
.text:004140C5		       jz      loc_4141E8
.text:004140CB		       push    esi	       ; _Src
.text:004140CC		       push    esi	       ; buf
.text:004140CD		       call    _strlen
.text:004140D2		       pop     ecx
.text:004140D3		       inc     eax
.text:004140D4		       push    eax	       ; _SizeInBytes
.text:004140D5		       push    lastTZ	       ; _Dst
.text:004140DB		       call    _strcpy_s
.text:004140E0		       add     esp, 0Ch
.text:004140E3		       cmp     eax, ebx
.text:004140E5		       jz      loc_4141EF
.text:004140EB		       push    ebx	       ; pReserved
.text:004140EC		       push    ebx	       ; nLine
.text:004140ED		       push    ebx	       ; pszFile
.text:004140EE		       push    ebx	       ; pszFunction
.text:004140EF		       push    ebx	       ; pszExpression
.text:004140F0		       call    __invoke_watson
.text:004140F5		       add     esp, 14h
.text:004140F8		       jmp     loc_4141EF
.text:004140FD ; ---------------------------------------------------------------------------
.text:004140FD
.text:004140FD loc_4140FD:			       ; CODE XREF: _tzset_nolock+B3j
.text:004140FD					       ; _tzset_nolock+B7j
.text:004140FD		       mov     eax, lastTZ
.text:00414102		       cmp     eax, ebx
.text:00414104		       jz      short loc_414113
.text:00414106		       push    eax	       ; pBlock
.text:00414107		       call    _free
.text:0041410C		       pop     ecx
.text:0041410D		       mov     lastTZ, ebx
.text:00414113
.text:00414113 loc_414113:			       ; CODE XREF: _tzset_nolock+138j
.text:00414113		       push    offset tzinfo   ; lpTimeZoneInformation
.text:00414118		       call    ds:__imp__GetTimeZoneInformation@4 ; GetTimeZoneInformation(x)
.text:0041411E		       cmp     eax, edi
.text:00414120		       jz      loc_4141E8
.text:00414126		       xor     ecx, ecx
.text:00414128		       inc     ecx
.text:00414129		       mov     tzapiused, ecx
.text:0041412F		       mov     eax, tzinfo.Bias
.text:00414134		       imul    eax, 3Ch
.text:00414137		       mov     [ebp+timezone], eax
.text:0041413A		       cmp     tzinfo.StandardDate.wMonth, bx
.text:00414141		       jz      short loc_414151
.text:00414143		       mov     edx, tzinfo.StandardBias
.text:00414149		       imul    edx, 3Ch
.text:0041414C		       add     eax, edx
.text:0041414E		       mov     [ebp+timezone], eax
.text:00414151
.text:00414151 loc_414151:			       ; CODE XREF: _tzset_nolock+175j
.text:00414151		       cmp     tzinfo.DaylightDate.wMonth, bx
.text:00414158		       jz      short loc_414174
.text:0041415A		       mov     eax, tzinfo.DaylightBias
.text:0041415F		       cmp     eax, ebx
.text:00414161		       jz      short loc_414174
.text:00414163		       mov     [ebp+daylight], ecx
.text:00414166		       sub     eax, tzinfo.StandardBias
.text:0041416C		       imul    eax, 3Ch
.text:0041416F		       mov     [ebp+dstbias], eax
.text:00414172		       jmp     short loc_41417A
.text:00414174 ; ---------------------------------------------------------------------------
.text:00414174
.text:00414174 loc_414174:			       ; CODE XREF: _tzset_nolock+18Cj
.text:00414174					       ; _tzset_nolock+195j
.text:00414174		       mov     [ebp+daylight], ebx
.text:00414177		       mov     [ebp+dstbias], ebx
.text:0041417A
.text:0041417A loc_41417A:			       ; CODE XREF: _tzset_nolock+1A6j
.text:0041417A		       lea     eax, [ebp+defused]
.text:0041417D		       push    eax	       ; lpUsedDefaultChar
.text:0041417E		       push    ebx	       ; lpDefaultChar
.text:0041417F		       push    3Fh	       ; cbMultiByte
.text:00414181		       mov     eax, [ebp+tzname]
.text:00414184		       push    dword ptr [eax] ; lpMultiByteStr
.text:00414186		       push    edi	       ; cchWideChar
.text:00414187		       push    offset tzinfo.StandardName ; lpWideCharStr
.text:0041418C		       push    ebx	       ; dwFlags
.text:0041418D		       push    [ebp+lc_cp]     ; CodePage
.text:00414190		       mov     edi, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414196		       call    edi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414198		       test    eax, eax
.text:0041419A		       jz      short loc_4141AB
.text:0041419C		       cmp     [ebp+defused], ebx
.text:0041419F		       jnz     short loc_4141AB
.text:004141A1		       mov     eax, [ebp+tzname]
.text:004141A4		       mov     eax, [eax]
.text:004141A6		       mov     [eax+3Fh], bl
.text:004141A9		       jmp     short loc_4141B2
.text:004141AB ; ---------------------------------------------------------------------------
.text:004141AB
.text:004141AB loc_4141AB:			       ; CODE XREF: _tzset_nolock+1CEj
.text:004141AB					       ; _tzset_nolock+1D3j
.text:004141AB		       mov     eax, [ebp+tzname]
.text:004141AE		       mov     eax, [eax]
.text:004141B0		       mov     [eax], bl
.text:004141B2
.text:004141B2 loc_4141B2:			       ; CODE XREF: _tzset_nolock+1DDj
.text:004141B2		       lea     eax, [ebp+defused]
.text:004141B5		       push    eax	       ; lpUsedDefaultChar
.text:004141B6		       push    ebx	       ; lpDefaultChar
.text:004141B7		       push    3Fh	       ; cbMultiByte
.text:004141B9		       mov     eax, [ebp+tzname]
.text:004141BC		       push    dword ptr [eax+4] ; lpMultiByteStr
.text:004141BF		       push    0FFFFFFFFh      ; cchWideChar
.text:004141C1		       push    offset tzinfo.DaylightName ; lpWideCharStr
.text:004141C6		       push    ebx	       ; dwFlags
.text:004141C7		       push    [ebp+lc_cp]     ; CodePage
.text:004141CA		       call    edi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:004141CC		       test    eax, eax
.text:004141CE		       jz      short loc_4141E0
.text:004141D0		       cmp     [ebp+defused], ebx
.text:004141D3		       jnz     short loc_4141E0
.text:004141D5		       mov     eax, [ebp+tzname]
.text:004141D8		       mov     eax, [eax+4]
.text:004141DB		       mov     [eax+3Fh], bl
.text:004141DE		       jmp     short loc_4141E8
.text:004141E0 ; ---------------------------------------------------------------------------
.text:004141E0
.text:004141E0 loc_4141E0:			       ; CODE XREF: _tzset_nolock+202j
.text:004141E0					       ; _tzset_nolock+207j
.text:004141E0		       mov     eax, [ebp+tzname]
.text:004141E3		       mov     eax, [eax+4]
.text:004141E6		       mov     [eax], bl
.text:004141E8
.text:004141E8 loc_4141E8:			       ; CODE XREF: _tzset_nolock+CDj
.text:004141E8					       ; _tzset_nolock+F9j ...
.text:004141E8		       mov     [ebp+nochange], 1
.text:004141EF
.text:004141EF loc_4141EF:			       ; CODE XREF: _tzset_nolock+119j
.text:004141EF					       ; _tzset_nolock+12Cj
.text:004141EF		       mov     edi, [ebp+timezone]
.text:004141F2		       call    ___timezone
.text:004141F7		       mov     [eax], edi
.text:004141F9		       mov     edi, [ebp+daylight]
.text:004141FC		       call    ___daylight
.text:00414201		       mov     [eax], edi
.text:00414203		       mov     edi, [ebp+dstbias]
.text:00414206		       call    ___dstbias
.text:0041420B		       mov     [eax], edi
.text:0041420D		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00414214		       call    $LN38_0
.text:00414219 ; ---------------------------------------------------------------------------
.text:00414219
.text:00414219 $LN39_0:
.text:00414219		       cmp     [ebp+nochange], ebx
.text:0041421C		       jnz     loc_41430F
.text:00414222		       push    3	       ; _Count
.text:00414224		       push    esi	       ; _Src
.text:00414225		       push    40h	       ; _SizeInBytes
.text:00414227		       mov     edi, [ebp+tzname]
.text:0041422A		       push    dword ptr [edi] ; _Dst
.text:0041422C		       call    _strncpy_s
.text:00414231		       add     esp, 10h
.text:00414234		       test    eax, eax
.text:00414236		       jz      short loc_414245
.text:00414238		       push    ebx	       ; pReserved
.text:00414239		       push    ebx	       ; nLine
.text:0041423A		       push    ebx	       ; pszFile
.text:0041423B		       push    ebx	       ; pszFunction
.text:0041423C		       push    ebx	       ; pszExpression
.text:0041423D		       call    __invoke_watson
.text:00414242		       add     esp, 14h
.text:00414245
.text:00414245 loc_414245:			       ; CODE XREF: _tzset_nolock+26Aj
.text:00414245		       add     esi, 3
.text:00414248		       cmp     byte ptr	[esi], 2Dh
.text:0041424B		       jnz     short loc_414255
.text:0041424D		       mov     [ebp+negdiff], 1
.text:00414254		       inc     esi
.text:00414255
.text:00414255 loc_414255:			       ; CODE XREF: _tzset_nolock+27Fj
.text:00414255		       push    esi	       ; nptr
.text:00414256		       call    _atol
.text:0041425B		       pop     ecx
.text:0041425C		       imul    eax, 0E10h
.text:00414262		       mov     [ebp+timezone], eax
.text:00414265
.text:00414265 loc_414265:			       ; CODE XREF: _tzset_nolock+2A8j
.text:00414265		       mov     al, [esi]
.text:00414267		       cmp     al, 2Bh
.text:00414269		       jz      short loc_414273
.text:0041426B		       cmp     al, 30h
.text:0041426D		       jl      short loc_414284
.text:0041426F		       cmp     al, 39h
.text:00414271		       jg      short loc_414284
.text:00414273
.text:00414273 loc_414273:			       ; CODE XREF: _tzset_nolock+29Dj
.text:00414273		       inc     esi
.text:00414274		       jmp     short loc_414265
.text:00414276 ; ---------------------------------------------------------------------------
.text:00414276
.text:00414276 $LN36_2:				       ; DATA XREF: .rdata:004209D8o
.text:00414276		       xor     ebx, ebx
.text:00414278		       mov     esi, [ebp+TZ]
.text:0041427B
.text:0041427B $LN38_0:				       ; CODE XREF: _tzset_nolock+248p
.text:0041427B		       push    7	       ; locknum
.text:0041427D		       call    __unlock
.text:00414282		       pop     ecx
.text:00414283
.text:00414283 $LN37_0:
.text:00414283		       retn
.text:00414284 ; ---------------------------------------------------------------------------
.text:00414284
.text:00414284 loc_414284:			       ; CODE XREF: _tzset_nolock+2A1j
.text:00414284					       ; _tzset_nolock+2A5j
.text:00414284		       cmp     byte ptr	[esi], 3Ah
.text:00414287		       jnz     short loc_4142C1
.text:00414289		       inc     esi
.text:0041428A		       push    esi	       ; nptr
.text:0041428B		       call    _atol
.text:00414290		       pop     ecx
.text:00414291		       imul    eax, 3Ch
.text:00414294		       add     [ebp+timezone], eax
.text:00414297		       jmp     short loc_41429E
.text:00414299 ; ---------------------------------------------------------------------------
.text:00414299
.text:00414299 loc_414299:			       ; CODE XREF: _tzset_nolock+2D6j
.text:00414299		       cmp     al, 39h
.text:0041429B		       jg      short loc_4142A4
.text:0041429D		       inc     esi
.text:0041429E
.text:0041429E loc_41429E:			       ; CODE XREF: _tzset_nolock+2CBj
.text:0041429E		       mov     al, [esi]
.text:004142A0		       cmp     al, 30h
.text:004142A2		       jge     short loc_414299
.text:004142A4
.text:004142A4 loc_4142A4:			       ; CODE XREF: _tzset_nolock+2CFj
.text:004142A4		       cmp     byte ptr	[esi], 3Ah
.text:004142A7		       jnz     short loc_4142C1
.text:004142A9		       inc     esi
.text:004142AA		       push    esi	       ; nptr
.text:004142AB		       call    _atol
.text:004142B0		       pop     ecx
.text:004142B1		       add     [ebp+timezone], eax
.text:004142B4		       jmp     short loc_4142BB
.text:004142B6 ; ---------------------------------------------------------------------------
.text:004142B6
.text:004142B6 loc_4142B6:			       ; CODE XREF: _tzset_nolock+2F3j
.text:004142B6		       cmp     al, 39h
.text:004142B8		       jg      short loc_4142C1
.text:004142BA		       inc     esi
.text:004142BB
.text:004142BB loc_4142BB:			       ; CODE XREF: _tzset_nolock+2E8j
.text:004142BB		       mov     al, [esi]
.text:004142BD		       cmp     al, 30h
.text:004142BF		       jge     short loc_4142B6
.text:004142C1
.text:004142C1 loc_4142C1:			       ; CODE XREF: _tzset_nolock+2BBj
.text:004142C1					       ; _tzset_nolock+2DBj ...
.text:004142C1		       cmp     [ebp+negdiff], ebx
.text:004142C4		       jz      short loc_4142C9
.text:004142C6		       neg     [ebp+timezone]
.text:004142C9
.text:004142C9 loc_4142C9:			       ; CODE XREF: _tzset_nolock+2F8j
.text:004142C9		       movsx   eax, byte ptr [esi]
.text:004142CC		       mov     [ebp+daylight], eax
.text:004142CF		       cmp     eax, ebx
.text:004142D1		       jz      short loc_4142F6
.text:004142D3		       push    3	       ; _Count
.text:004142D5		       push    esi	       ; _Src
.text:004142D6		       push    40h	       ; _SizeInBytes
.text:004142D8		       push    dword ptr [edi+4] ; _Dst
.text:004142DB		       call    _strncpy_s
.text:004142E0		       add     esp, 10h
.text:004142E3		       test    eax, eax
.text:004142E5		       jz      short loc_4142FB
.text:004142E7		       push    ebx	       ; pReserved
.text:004142E8		       push    ebx	       ; nLine
.text:004142E9		       push    ebx	       ; pszFile
.text:004142EA		       push    ebx	       ; pszFunction
.text:004142EB		       push    ebx	       ; pszExpression
.text:004142EC		       call    __invoke_watson
.text:004142F1		       add     esp, 14h
.text:004142F4		       jmp     short loc_4142FB
.text:004142F6 ; ---------------------------------------------------------------------------
.text:004142F6
.text:004142F6 loc_4142F6:			       ; CODE XREF: _tzset_nolock+305j
.text:004142F6		       mov     eax, [edi+4]
.text:004142F9		       mov     [eax], bl
.text:004142FB
.text:004142FB loc_4142FB:			       ; CODE XREF: _tzset_nolock+319j
.text:004142FB					       ; _tzset_nolock+328j
.text:004142FB		       mov     esi, [ebp+timezone]
.text:004142FE		       call    ___timezone
.text:00414303		       mov     [eax], esi
.text:00414305		       mov     esi, [ebp+daylight]
.text:00414308		       call    ___daylight
.text:0041430D		       mov     [eax], esi
.text:0041430F
.text:0041430F loc_41430F:			       ; CODE XREF: _tzset_nolock+250j
.text:0041430F		       call    __SEH_epilog4
.text:00414314		       retn
.text:00414314 _tzset_nolock   endp ; sp-analysis failed
.text:00414314
.text:00414315
.text:00414315 ; =============== S U B R O U T I N E =======================================
.text:00414315
.text:00414315 ; Attributes: bp-based frame
.text:00414315
.text:00414315 ; void __usercall cvtdate(int trantype, int datetype, int year, int month<eax>, int week, int dayofweek,	int date, int hour<ecx>, int min, int sec, int msec)
.text:00414315 cvtdate	       proc near	       ; CODE XREF: _isindst_nolock+ABp
.text:00414315					       ; _isindst_nolock+108p ...
.text:00414315
.text:00414315 var_C	       = dword ptr -0Ch
.text:00414315 var_8	       = dword ptr -8
.text:00414315 dstbias	       = dword ptr -4
.text:00414315 trantype	       = dword ptr  8
.text:00414315 datetype	       = dword ptr  0Ch
.text:00414315 year	       = dword ptr  10h
.text:00414315 week	       = dword ptr  14h
.text:00414315 dayofweek       = dword ptr  18h
.text:00414315 date	       = dword ptr  1Ch
.text:00414315 min	       = dword ptr  20h
.text:00414315 sec	       = dword ptr  24h
.text:00414315 msec	       = dword ptr  28h
.text:00414315
.text:00414315 month = eax
.text:00414315 hour = ecx
.text:00414315		       push    ebp
.text:00414316		       mov     ebp, esp
.text:00414318		       sub     esp, 0Ch
.text:0041431B		       and     [ebp+dstbias], 0
.text:0041431F		       cmp     [ebp+datetype], 1
.text:00414323		       push    ebx
.text:00414324		       push    esi
.text:00414325		       push    edi
.text:00414326		       mov     edi, [ebp+year]
.text:00414329		       mov     esi, month
.text:0041432B		       mov     month, edi
.text:0041432D		       jnz     loc_41442C
.text:00414333		       and     month, 80000003h
.text:00414338		       jns     short loc_41433F
.text:0041433A		       dec     month
.text:0041433B		       or      month, 0FFFFFFFCh
.text:0041433E		       inc     month
.text:0041433F
.text:0041433F loc_41433F:			       ; CODE XREF: cvtdate+23j
.text:0041433F		       mov     [ebp+var_C], month
.text:00414342		       jnz     short loc_414350
.text:00414344		       mov     month, edi
.text:00414346		       push    64h
.text:00414348		       cdq
.text:00414349		       pop     ebx
.text:0041434A		       idiv    ebx
.text:0041434C		       test    edx, edx
.text:0041434E		       jnz     short loc_41436F
.text:00414350
.text:00414350 loc_414350:			       ; CODE XREF: cvtdate+2Dj
.text:00414350		       lea     month, [edi+76Ch]
.text:00414356		       cdq
.text:00414357		       mov     ebx, 190h
.text:0041435C		       idiv    ebx
.text:0041435E		       test    edx, edx
.text:00414360		       jz      short loc_41436F
.text:00414362		       mov     month, esi
.text:00414364		       shl     month, 2
.text:00414367		       mov     esi, dword_421FA8[month]
.text:0041436D		       jmp     short loc_41437A
.text:0041436F ; ---------------------------------------------------------------------------
.text:0041436F
.text:0041436F loc_41436F:			       ; CODE XREF: cvtdate+39j
.text:0041436F					       ; cvtdate+4Bj
.text:0041436F		       mov     month, esi
.text:00414371		       shl     month, 2
.text:00414374		       mov     esi, __confh[month]
.text:0041437A
.text:0041437A loc_41437A:			       ; CODE XREF: cvtdate+58j
.text:0041437A		       mov     [ebp+datetype], month
.text:0041437D		       lea     month, [edi+12Bh]
.text:00414383		       cdq
.text:00414384		       lea     ebx, [edi-1]
.text:00414387		       mov     edi, 190h
.text:0041438C		       idiv    edi
.text:0041438E		       push    64h
.text:00414390		       pop     edi
.text:00414391		       inc     esi
.text:00414392		       push    7
.text:00414394		       mov     [ebp+var_8], month
.text:00414397		       mov     month, ebx
.text:00414399		       cdq
.text:0041439A		       idiv    edi
.text:0041439C		       mov     edx, [ebp+var_8]
.text:0041439F		       mov     edi, [ebp+year]
.text:004143A2		       sub     edx, month
.text:004143A4		       mov     ebx, edx
.text:004143A6		       lea     month, [edi-1]
.text:004143A9		       cdq
.text:004143AA		       and     edx, 3
.text:004143AD		       add     month, edx
.text:004143AF		       sar     month, 2
.text:004143B2		       mov     edx, edi
.text:004143B4		       imul    edx, 16Dh
.text:004143BA		       add     month, esi
.text:004143BC		       add     month, ebx
.text:004143BE		       lea     month, [edx+month-63DBh]
.text:004143C5		       cdq
.text:004143C6		       pop     ebx
.text:004143C7		       idiv    ebx
.text:004143C9		       mov     month, [ebp+week]
.text:004143CC		       imul    month, 7
.text:004143CF		       sub     month, edx
.text:004143D1		       add     month, [ebp+dayofweek]
.text:004143D4		       cmp     edx, [ebp+dayofweek]
.text:004143D7		       jg      short loc_4143DF
.text:004143D9		       lea     esi, [esi+month-7]
.text:004143DD		       jmp     short loc_4143E1
.text:004143DF ; ---------------------------------------------------------------------------
.text:004143DF
.text:004143DF loc_4143DF:			       ; CODE XREF: cvtdate+C2j
.text:004143DF		       add     esi, month
.text:004143E1
.text:004143E1 loc_4143E1:			       ; CODE XREF: cvtdate+C8j
.text:004143E1		       cmp     [ebp+week], 5
.text:004143E5		       jnz     loc_41446B
.text:004143EB		       cmp     [ebp+var_C], 0
.text:004143EF		       jnz     short loc_4143FD
.text:004143F1		       mov     month, edi
.text:004143F3		       push    64h
.text:004143F5		       cdq
.text:004143F6		       pop     ebx
.text:004143F7		       idiv    ebx
.text:004143F9		       test    edx, edx
.text:004143FB		       jnz     short loc_41441A
.text:004143FD
.text:004143FD loc_4143FD:			       ; CODE XREF: cvtdate+DAj
.text:004143FD		       lea     month, [edi+76Ch]
.text:00414403		       cdq
.text:00414404		       mov     ebx, 190h
.text:00414409		       idiv    ebx
.text:0041440B		       test    edx, edx
.text:0041440D		       jz      short loc_41441A
.text:0041440F		       mov     month, [ebp+datetype]
.text:00414412		       mov     month, __days[month]
.text:00414418		       jmp     short loc_414423
.text:0041441A ; ---------------------------------------------------------------------------
.text:0041441A
.text:0041441A loc_41441A:			       ; CODE XREF: cvtdate+E6j
.text:0041441A					       ; cvtdate+F8j
.text:0041441A		       mov     month, [ebp+datetype]
.text:0041441D		       mov     month, __lpdays[month]
.text:00414423
.text:00414423 loc_414423:			       ; CODE XREF: cvtdate+103j
.text:00414423		       cmp     esi, month
.text:00414425		       jle     short loc_41446B
.text:00414427		       sub     esi, 7
.text:0041442A		       jmp     short loc_41446B
.text:0041442C ; ---------------------------------------------------------------------------
.text:0041442C
.text:0041442C loc_41442C:			       ; CODE XREF: cvtdate+18j
.text:0041442C		       and     month, 80000003h
.text:00414431		       jns     short loc_414438
.text:00414433		       dec     month
.text:00414434		       or      month, 0FFFFFFFCh
.text:00414437		       inc     month
.text:00414438
.text:00414438 loc_414438:			       ; CODE XREF: cvtdate+11Cj
.text:00414438		       jnz     short loc_414446
.text:0041443A		       mov     month, edi
.text:0041443C		       push    64h
.text:0041443E		       cdq
.text:0041443F		       pop     ebx
.text:00414440		       idiv    ebx
.text:00414442		       test    edx, edx
.text:00414444		       jnz     short loc_414461
.text:00414446
.text:00414446 loc_414446:			       ; CODE XREF: cvtdate:loc_414438j
.text:00414446		       lea     month, [edi+76Ch]
.text:0041444C		       cdq
.text:0041444D		       mov     ebx, 190h
.text:00414452		       idiv    ebx
.text:00414454		       test    edx, edx
.text:00414456		       jz      short loc_414461
.text:00414458		       mov     esi, dword_421FA8[esi*4]
.text:0041445F		       jmp     short loc_414468
.text:00414461 ; ---------------------------------------------------------------------------
.text:00414461
.text:00414461 loc_414461:			       ; CODE XREF: cvtdate+12Fj
.text:00414461					       ; cvtdate+141j
.text:00414461		       mov     esi, __confh[esi*4]
.text:00414468
.text:00414468 loc_414468:			       ; CODE XREF: cvtdate+14Aj
.text:00414468		       add     esi, [ebp+date]
.text:0041446B
.text:0041446B loc_41446B:			       ; CODE XREF: cvtdate+D0j
.text:0041446B					       ; cvtdate+110j ...
.text:0041446B		       imul    hour, 3Ch
.text:0041446E		       add     hour, [ebp+min]
.text:00414471		       imul    hour, 3Ch
.text:00414474		       add     hour, [ebp+sec]
.text:00414477		       imul    hour, 3E8h
.text:0041447D		       add     hour, [ebp+msec]
.text:00414480		       cmp     [ebp+trantype], 1
.text:00414484		       jnz     short loc_41449A
.text:00414486		       mov     dststart.yd, esi
.text:0041448C		       mov     dststart.ms, hour
.text:00414492		       mov     dststart.yr, edi
.text:00414498		       jmp     short loc_414505
.text:0041449A ; ---------------------------------------------------------------------------
.text:0041449A
.text:0041449A loc_41449A:			       ; CODE XREF: cvtdate+16Fj
.text:0041449A		       lea     month, [ebp+dstbias]
.text:0041449D		       push    month	       ; _Daylight_savings_bias
.text:0041449E		       mov     dstend.yd, esi
.text:004144A4		       mov     dstend.ms, hour
.text:004144AA		       call    __get_dstbias
.text:004144AF		       test    month, month
.text:004144B1		       pop     hour
.text:004144B2		       jz      short loc_4144C3
.text:004144B4		       xor     month, month
.text:004144B6		       push    month	       ; pReserved
.text:004144B7		       push    month	       ; nLine
.text:004144B8		       push    month	       ; pszFile
.text:004144B9		       push    month	       ; pszFunction
.text:004144BA		       push    month	       ; pszExpression
.text:004144BB		       call    __invoke_watson
.text:004144C0		       add     esp, 14h
.text:004144C3
.text:004144C3 loc_4144C3:			       ; CODE XREF: cvtdate+19Dj
.text:004144C3		       mov     month, [ebp+dstbias]
.text:004144C6		       imul    month, 3E8h
.text:004144CC		       add     dstend.ms, month
.text:004144D2		       jns     short loc_4144E6
.text:004144D4		       add     dstend.ms, 5265C00h
.text:004144DE		       dec     dstend.yd
.text:004144E4		       jmp     short loc_4144FF
.text:004144E6 ; ---------------------------------------------------------------------------
.text:004144E6
.text:004144E6 loc_4144E6:			       ; CODE XREF: cvtdate+1BDj
.text:004144E6		       mov     month, 5265C00h
.text:004144EB		       cmp     dstend.ms, month
.text:004144F1		       jl      short loc_4144FF
.text:004144F3		       sub     dstend.ms, month
.text:004144F9		       inc     dstend.yd
.text:004144FF
.text:004144FF loc_4144FF:			       ; CODE XREF: cvtdate+1CFj
.text:004144FF					       ; cvtdate+1DCj
.text:004144FF		       mov     dstend.yr, edi
.text:00414505
.text:00414505 loc_414505:			       ; CODE XREF: cvtdate+183j
.text:00414505		       pop     edi
.text:00414506		       pop     esi
.text:00414507		       pop     ebx
.text:00414508		       leave
.text:00414509		       retn
.text:00414509 cvtdate	       endp
.text:00414509
.text:0041450A
.text:0041450A ; =============== S U B R O U T I N E =======================================
.text:0041450A
.text:0041450A ; Attributes: bp-based frame
.text:0041450A
.text:0041450A ; int __usercall	isindst_nolock<eax>(tm *tb<edi>)
.text:0041450A _isindst_nolock proc near	       ; CODE XREF: __isindst+1Bp
.text:0041450A
.text:0041450A endmonth	       = dword ptr -0Ch
.text:0041450A endweek	       = dword ptr -8
.text:0041450A daylight	       = dword ptr -4
.text:0041450A
.text:0041450A tb = edi
.text:0041450A		       push    ebp
.text:0041450B		       mov     ebp, esp
.text:0041450D		       sub     esp, 0Ch
.text:00414510		       push    esi
.text:00414511		       lea     eax, [ebp+daylight]
.text:00414514		       xor     esi, esi
.text:00414516		       push    eax	       ; _Daylight
.text:00414517		       mov     [ebp+daylight], esi
.text:0041451A		       call    __get_daylight
.text:0041451F		       test    eax, eax
.text:00414521		       pop     ecx
.text:00414522		       jz      short loc_414531
.text:00414524		       push    esi	       ; pReserved
.text:00414525		       push    esi	       ; nLine
.text:00414526		       push    esi	       ; pszFile
.text:00414527		       push    esi	       ; pszFunction
.text:00414528		       push    esi	       ; pszExpression
.text:00414529		       call    __invoke_watson
.text:0041452E		       add     esp, 14h
.text:00414531
.text:00414531 loc_414531:			       ; CODE XREF: _isindst_nolock+18j
.text:00414531		       cmp     [ebp+daylight], esi
.text:00414534		       jnz     short loc_41453D
.text:00414536		       xor     eax, eax
.text:00414538		       jmp     loc_414695
.text:0041453D ; ---------------------------------------------------------------------------
.text:0041453D
.text:0041453D loc_41453D:			       ; CODE XREF: _isindst_nolock+2Aj
.text:0041453D		       mov     edx, [tb+14h]
.text:00414540		       push    ebx
.text:00414541		       xor     ebx, ebx
.text:00414543		       inc     ebx
.text:00414544		       cmp     edx, dststart.yr
.text:0041454A		       jnz     short loc_414558
.text:0041454C		       cmp     edx, dstend.yr
.text:00414552		       jz      loc_414670
.text:00414558
.text:00414558 loc_414558:			       ; CODE XREF: _isindst_nolock+40j
.text:00414558		       cmp     tzapiused, esi
.text:0041455E		       jz      loc_41461C
.text:00414564		       cmp     tzinfo.DaylightDate.wYear, si
.text:0041456B		       movzx   eax, tzinfo.DaylightDate.wMilliseconds ;	month
.text:00414572		       movzx   ecx, tzinfo.DaylightDate.wHour ;	hour
.text:00414579		       push    eax	       ; msec
.text:0041457A		       movzx   eax, tzinfo.DaylightDate.wSecond
.text:00414581		       push    eax	       ; sec
.text:00414582		       movzx   eax, tzinfo.DaylightDate.wMinute
.text:00414589		       push    eax	       ; min
.text:0041458A		       jnz     short loc_4145A1
.text:0041458C		       movzx   eax, tzinfo.DaylightDate.wDayOfWeek
.text:00414593		       push    esi
.text:00414594		       push    eax
.text:00414595		       movzx   eax, tzinfo.DaylightDate.wDay
.text:0041459C		       push    eax
.text:0041459D		       push    edx
.text:0041459E		       push    ebx
.text:0041459F		       jmp     short loc_4145AD
.text:004145A1 ; ---------------------------------------------------------------------------
.text:004145A1
.text:004145A1 loc_4145A1:			       ; CODE XREF: _isindst_nolock+80j
.text:004145A1		       movzx   eax, tzinfo.DaylightDate.wDay
.text:004145A8		       push    eax	       ; date
.text:004145A9		       push    esi	       ; dayofweek
.text:004145AA		       push    esi	       ; week
.text:004145AB		       push    edx	       ; year
.text:004145AC		       push    esi	       ; datetype
.text:004145AD
.text:004145AD loc_4145AD:			       ; CODE XREF: _isindst_nolock+95j
.text:004145AD		       movzx   eax, tzinfo.DaylightDate.wMonth ; month
.text:004145B4		       push    ebx	       ; trantype
.text:004145B5		       call    cvtdate
.text:004145BA		       movzx   eax, tzinfo.StandardDate.wMilliseconds
.text:004145C1		       movzx   ecx, tzinfo.StandardDate.wHour
.text:004145C8		       add     esp, 24h
.text:004145CB		       cmp     tzinfo.StandardDate.wYear, si
.text:004145D2		       push    eax	       ; msec
.text:004145D3		       movzx   eax, tzinfo.StandardDate.wSecond
.text:004145DA		       push    eax	       ; sec
.text:004145DB		       movzx   eax, tzinfo.StandardDate.wMinute
.text:004145E2		       push    eax	       ; min
.text:004145E3		       jnz     short loc_4145FC
.text:004145E5		       movzx   eax, tzinfo.StandardDate.wDayOfWeek
.text:004145EC		       push    esi
.text:004145ED		       push    eax
.text:004145EE		       movzx   eax, tzinfo.StandardDate.wDay
.text:004145F5		       push    eax
.text:004145F6		       push    dword ptr [tb+14h]
.text:004145F9		       push    ebx
.text:004145FA		       jmp     short loc_41460A
.text:004145FC ; ---------------------------------------------------------------------------
.text:004145FC
.text:004145FC loc_4145FC:			       ; CODE XREF: _isindst_nolock+D9j
.text:004145FC		       movzx   eax, tzinfo.StandardDate.wDay
.text:00414603		       push    eax	       ; date
.text:00414604		       push    esi	       ; dayofweek
.text:00414605		       push    esi	       ; week
.text:00414606		       push    dword ptr [tb+14h] ; year
.text:00414609		       push    esi	       ; datetype
.text:0041460A
.text:0041460A loc_41460A:			       ; CODE XREF: _isindst_nolock+F0j
.text:0041460A		       movzx   eax, tzinfo.StandardDate.wMonth ; month
.text:00414611		       push    esi	       ; trantype
.text:00414612		       call    cvtdate
.text:00414617		       add     esp, 24h
.text:0041461A		       jmp     short loc_414670
.text:0041461C ; ---------------------------------------------------------------------------
.text:0041461C
.text:0041461C loc_41461C:			       ; CODE XREF: _isindst_nolock+54j
.text:0041461C		       cmp     edx, 6Bh
.text:0041461F		       push    3
.text:00414621		       pop     eax
.text:00414622		       push    2
.text:00414624		       pop     ecx
.text:00414625		       mov     [ebp+endmonth], 0Bh
.text:0041462C		       mov     [ebp+endweek], ebx
.text:0041462F		       jge     short loc_414644
.text:00414631		       push    4
.text:00414633		       pop     eax
.text:00414634		       mov     ecx, ebx	       ; hour
.text:00414636		       mov     [ebp+endmonth], 0Ah
.text:0041463D		       mov     [ebp+endweek], 5
.text:00414644
.text:00414644 loc_414644:			       ; CODE XREF: _isindst_nolock+125j
.text:00414644		       push    esi	       ; msec
.text:00414645		       push    esi	       ; sec
.text:00414646		       push    esi	       ; min
.text:00414647		       push    esi	       ; date
.text:00414648		       push    esi	       ; dayofweek
.text:00414649		       push    ecx	       ; week
.text:0041464A		       push    edx	       ; year
.text:0041464B		       push    ebx	       ; datetype
.text:0041464C		       push    ebx	       ; trantype
.text:0041464D		       push    2
.text:0041464F		       pop     ecx
.text:00414650		       call    cvtdate
.text:00414655		       mov     eax, [ebp+endmonth] ; month
.text:00414658		       push    esi	       ; msec
.text:00414659		       push    esi	       ; sec
.text:0041465A		       push    esi	       ; min
.text:0041465B		       push    esi	       ; date
.text:0041465C		       push    esi	       ; dayofweek
.text:0041465D		       push    [ebp+endweek]   ; week
.text:00414660		       push    dword ptr [tb+14h] ; year
.text:00414663		       push    ebx	       ; datetype
.text:00414664		       push    esi	       ; trantype
.text:00414665		       push    2
.text:00414667		       pop     ecx
.text:00414668		       call    cvtdate
.text:0041466D		       add     esp, 48h
.text:00414670
.text:00414670 loc_414670:			       ; CODE XREF: _isindst_nolock+48j
.text:00414670					       ; _isindst_nolock+110j
.text:00414670		       mov     ecx, dststart.yd
.text:00414676		       mov     eax, dstend.yd
.text:0041467B		       cmp     ecx, eax
.text:0041467D		       mov     edx, [tb+1Ch]
.text:00414680		       jge     short loc_414698
.text:00414682		       cmp     edx, ecx
.text:00414684		       jl      short loc_4146A8
.text:00414686		       cmp     edx, eax
.text:00414688		       jg      short loc_4146A8
.text:0041468A		       cmp     edx, ecx
.text:0041468C		       jle     short loc_4146AC
.text:0041468E		       cmp     edx, eax
.text:00414690		       jge     short loc_4146AC
.text:00414692
.text:00414692 loc_414692:			       ; CODE XREF: _isindst_nolock+190j
.text:00414692					       ; _isindst_nolock+194j
.text:00414692		       mov     eax, ebx
.text:00414694
.text:00414694 loc_414694:			       ; CODE XREF: _isindst_nolock+1A0j
.text:00414694					       ; _isindst_nolock+1D4j
.text:00414694		       pop     ebx
.text:00414695
.text:00414695 loc_414695:			       ; CODE XREF: _isindst_nolock+2Ej
.text:00414695		       pop     esi
.text:00414696		       leave
.text:00414697		       retn
.text:00414698 ; ---------------------------------------------------------------------------
.text:00414698
.text:00414698 loc_414698:			       ; CODE XREF: _isindst_nolock+176j
.text:00414698		       cmp     edx, eax
.text:0041469A		       jl      short loc_414692
.text:0041469C		       cmp     edx, ecx
.text:0041469E		       jg      short loc_414692
.text:004146A0		       cmp     edx, eax
.text:004146A2		       jle     short loc_4146AC
.text:004146A4		       cmp     edx, ecx
.text:004146A6		       jge     short loc_4146AC
.text:004146A8
.text:004146A8 loc_4146A8:			       ; CODE XREF: _isindst_nolock+17Aj
.text:004146A8					       ; _isindst_nolock+17Ej
.text:004146A8		       xor     eax, eax
.text:004146AA		       jmp     short loc_414694
.text:004146AC ; ---------------------------------------------------------------------------
.text:004146AC
.text:004146AC loc_4146AC:			       ; CODE XREF: _isindst_nolock+182j
.text:004146AC					       ; _isindst_nolock+186j ...
.text:004146AC		       mov     eax, [tb+8]
.text:004146AF		       imul    eax, 3Ch
.text:004146B2		       add     eax, [tb+4]
.text:004146B5		       imul    eax, 3Ch
.text:004146B8		       add     eax, [tb]
.text:004146BA		       imul    eax, 3E8h
.text:004146C0		       cmp     edx, ecx
.text:004146C2		       jnz     short loc_4146D1
.text:004146C4		       xor     ecx, ecx
.text:004146C6		       cmp     eax, dststart.ms
.text:004146CC		       setnl   cl
.text:004146CF		       jmp     short loc_4146DC
.text:004146D1 ; ---------------------------------------------------------------------------
.text:004146D1
.text:004146D1 loc_4146D1:			       ; CODE XREF: _isindst_nolock+1B8j
.text:004146D1		       xor     ecx, ecx
.text:004146D3		       cmp     eax, dstend.ms
.text:004146D9		       setl    cl
.text:004146DC
.text:004146DC loc_4146DC:			       ; CODE XREF: _isindst_nolock+1C5j
.text:004146DC		       mov     eax, ecx
.text:004146DE		       jmp     short loc_414694
.text:004146DE _isindst_nolock endp
.text:004146DE
.text:004146E0
.text:004146E0 ; =============== S U B R O U T I N E =======================================
.text:004146E0
.text:004146E0 ; Attributes: bp-based frame
.text:004146E0
.text:004146E0 ___tzset	       proc near	       ; CODE XREF: _expandtime:loc_40EB8Dp
.text:004146E0
.text:004146E0 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004146E0
.text:004146E0		       push    8
.text:004146E2		       push    offset dword_4209E0
.text:004146E7		       call    __SEH_prolog4
.text:004146EC		       xor     esi, esi
.text:004146EE		       cmp     first_time, esi
.text:004146F4		       jnz     short $LN10_8
.text:004146F6		       push    6	       ; locknum
.text:004146F8		       call    __lock
.text:004146FD		       pop     ecx
.text:004146FE		       mov     [ebp+ms_exc.disabled], esi
.text:00414701		       cmp     first_time, esi
.text:00414707		       jnz     short loc_414714
.text:00414709		       call    _tzset_nolock
.text:0041470E ; ---------------------------------------------------------------------------
.text:0041470E		       inc     first_time
.text:00414714
.text:00414714 loc_414714:			       ; CODE XREF: ___tzset+27j
.text:00414714		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0041471B		       call    $LN7_8
.text:00414720
.text:00414720 $LN10_8:				       ; CODE XREF: ___tzset+14j
.text:00414720		       call    __SEH_epilog4
.text:00414725		       retn
.text:00414726 ; ---------------------------------------------------------------------------
.text:00414726
.text:00414726 $LN7_8:				       ; CODE XREF: ___tzset+3Bp
.text:00414726					       ; DATA XREF: .rdata:004209F8o
.text:00414726		       push    6	       ; locknum
.text:00414728		       call    __unlock
.text:0041472D		       pop     ecx
.text:0041472E
.text:0041472E $LN8_6:
.text:0041472E		       retn
.text:0041472E ___tzset	       endp
.text:0041472E
.text:0041472F
.text:0041472F ; =============== S U B R O U T I N E =======================================
.text:0041472F
.text:0041472F ; Attributes: noreturn bp-based frame
.text:0041472F
.text:0041472F ; void __cdecl _tzset()
.text:0041472F __tzset	       proc near
.text:0041472F
.text:0041472F ms_exc	       = CPPEH_RECORD ptr -18h
.text:0041472F
.text:0041472F		       push    8
.text:00414731		       push    offset dword_420A00
.text:00414736		       call    __SEH_prolog4
.text:0041473B		       push    6	       ; locknum
.text:0041473D		       call    __lock
.text:00414742		       pop     ecx
.text:00414743		       and     [ebp+ms_exc.disabled], 0
.text:00414747		       call    _tzset_nolock
.text:0041474C ; ---------------------------------------------------------------------------
.text:0041474C		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00414753		       call    $LN5_1
.text:00414758 ; ---------------------------------------------------------------------------
.text:00414758
.text:00414758 $LN8_7:
.text:00414758		       call    __SEH_epilog4
.text:0041475D		       retn
.text:0041475E ; ---------------------------------------------------------------------------
.text:0041475E
.text:0041475E $LN5_1:				       ; CODE XREF: __tzset+24p
.text:0041475E					       ; DATA XREF: .rdata:00420A18o
.text:0041475E		       push    6	       ; locknum
.text:00414760		       call    __unlock
.text:00414765		       pop     ecx
.text:00414766
.text:00414766 $LN6_9:
.text:00414766		       retn
.text:00414766 __tzset	       endp
.text:00414766
.text:00414767
.text:00414767 ; =============== S U B R O U T I N E =======================================
.text:00414767
.text:00414767 ; Attributes: noreturn bp-based frame
.text:00414767
.text:00414767 ; int __cdecl _isindst(tm *tb)
.text:00414767 __isindst       proc near
.text:00414767
.text:00414767 retval	       = dword ptr -1Ch
.text:00414767 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00414767 tb	       = dword ptr  8
.text:00414767
.text:00414767		       push    0Ch
.text:00414769		       push    offset dword_420A20
.text:0041476E		       call    __SEH_prolog4
.text:00414773		       push    6	       ; locknum
.text:00414775		       call    __lock
.text:0041477A		       pop     ecx
.text:0041477B		       and     [ebp+ms_exc.disabled], 0
.text:0041477F		       mov     edi, [ebp+tb]   ; tb
.text:00414782		       call    _isindst_nolock
.text:00414787		       mov     [ebp+retval], eax
.text:0041478A		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00414791		       call    $LN5_2
.text:00414796 ; ---------------------------------------------------------------------------
.text:00414796
.text:00414796 $LN8_8:
.text:00414796		       mov     eax, [ebp+retval]
.text:00414799		       call    __SEH_epilog4
.text:0041479E		       retn
.text:0041479F ; ---------------------------------------------------------------------------
.text:0041479F
.text:0041479F $LN5_2:				       ; CODE XREF: __isindst+2Ap
.text:0041479F					       ; DATA XREF: .rdata:00420A38o
.text:0041479F		       push    6	       ; locknum
.text:004147A1		       call    __unlock
.text:004147A6		       pop     ecx
.text:004147A7
.text:004147A7 $LN6_10:
.text:004147A7		       retn
.text:004147A7 __isindst       endp
.text:004147A7
.text:004147A8
.text:004147A8 ; =============== S U B R O U T I N E =======================================
.text:004147A8
.text:004147A8
.text:004147A8 ; int __cdecl __ascii_stricmp(const char	*dst, const char *src)
.text:004147A8 ___ascii_stricmp	proc near	       ; CODE XREF: _store_winword+22Ap
.text:004147A8					       ; _store_winword+240p ...
.text:004147A8
.text:004147A8 dst	       = dword ptr  4
.text:004147A8 src	       = dword ptr  8
.text:004147A8
.text:004147A8		       mov     edx, [esp+src]
.text:004147AC		       push    esi
.text:004147AD		       mov     esi, [esp+4+dst]
.text:004147B1		       push    edi
.text:004147B2
.text:004147B2 loc_4147B2:			       ; CODE XREF: ___ascii_stricmp+2Ej
.text:004147B2		       movzx   eax, byte ptr [esi]
.text:004147B5		       lea     ecx, [eax-41h]
.text:004147B8		       inc     esi
.text:004147B9		       cmp     ecx, 19h
.text:004147BC		       ja      short loc_4147C1
.text:004147BE		       add     eax, 20h
.text:004147C1
.text:004147C1 loc_4147C1:			       ; CODE XREF: ___ascii_stricmp+14j
.text:004147C1		       movzx   ecx, byte ptr [edx]
.text:004147C4		       lea     edi, [ecx-41h]
.text:004147C7		       inc     edx
.text:004147C8		       cmp     edi, 19h
.text:004147CB		       ja      short loc_4147D0
.text:004147CD		       add     ecx, 20h
.text:004147D0
.text:004147D0 loc_4147D0:			       ; CODE XREF: ___ascii_stricmp+23j
.text:004147D0		       test    eax, eax
.text:004147D2		       jz      short loc_4147D8
.text:004147D4		       cmp     eax, ecx
.text:004147D6		       jz      short loc_4147B2
.text:004147D8
.text:004147D8 loc_4147D8:			       ; CODE XREF: ___ascii_stricmp+2Aj
.text:004147D8		       pop     edi
.text:004147D9		       sub     eax, ecx
.text:004147DB		       pop     esi
.text:004147DC		       retn
.text:004147DC ___ascii_stricmp	endp
.text:004147DC
.text:004147DD
.text:004147DD ; =============== S U B R O U T I N E =======================================
.text:004147DD
.text:004147DD ; Attributes: bp-based frame
.text:004147DD
.text:004147DD ; int __cdecl _stricmp_l(const char *dst, const char *src, localeinfo_struct *plocinfo)
.text:004147DD __stricmp_l     proc near	       ; CODE XREF: __stricmp+45p
.text:004147DD
.text:004147DD _loc_update     = _LocaleUpdate ptr -10h
.text:004147DD dst	       = dword ptr  8
.text:004147DD src	       = dword ptr  0Ch
.text:004147DD plocinfo	       = dword ptr  10h
.text:004147DD
.text:004147DD		       push    ebp
.text:004147DE		       mov     ebp, esp
.text:004147E0		       sub     esp, 10h
.text:004147E3		       push    ebx
.text:004147E4		       push    [ebp+plocinfo]  ; plocinfo
.text:004147E7		       lea     ecx, [ebp+_loc_update] ;	this
.text:004147EA		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004147EF		       xor     ebx, ebx
.text:004147F1		       cmp     [ebp+dst], ebx
.text:004147F4		       jnz     short loc_414824
.text:004147F6		       call    __errno
.text:004147FB		       push    ebx	       ; pReserved
.text:004147FC		       push    ebx	       ; nLine
.text:004147FD		       push    ebx	       ; pszFile
.text:004147FE		       push    ebx	       ; pszFunction
.text:004147FF		       push    ebx	       ; pszExpression
.text:00414800		       mov     dword ptr [eax],	16h
.text:00414806		       call    __invalid_parameter
.text:0041480B		       add     esp, 14h
.text:0041480E		       cmp     [ebp+_loc_update.updated], bl
.text:00414811		       jz      short loc_41481A
.text:00414813		       mov     eax, [ebp+_loc_update.ptd]
.text:00414816		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0041481A
.text:0041481A loc_41481A:			       ; CODE XREF: __stricmp_l+34j
.text:0041481A		       mov     eax, 7FFFFFFFh
.text:0041481F		       jmp     loc_4148AD
.text:00414824 ; ---------------------------------------------------------------------------
.text:00414824
.text:00414824 loc_414824:			       ; CODE XREF: __stricmp_l+17j
.text:00414824		       push    edi
.text:00414825		       mov     edi, [ebp+src]
.text:00414828		       cmp     edi, ebx
.text:0041482A		       jnz     short loc_414857
.text:0041482C		       call    __errno
.text:00414831		       push    ebx	       ; pReserved
.text:00414832		       push    ebx	       ; nLine
.text:00414833		       push    ebx	       ; pszFile
.text:00414834		       push    ebx	       ; pszFunction
.text:00414835		       push    ebx	       ; pszExpression
.text:00414836		       mov     dword ptr [eax],	16h
.text:0041483C		       call    __invalid_parameter
.text:00414841		       add     esp, 14h
.text:00414844		       cmp     [ebp+_loc_update.updated], bl
.text:00414847		       jz      short loc_414850
.text:00414849		       mov     eax, [ebp+_loc_update.ptd]
.text:0041484C		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00414850
.text:00414850 loc_414850:			       ; CODE XREF: __stricmp_l+6Aj
.text:00414850		       mov     eax, 7FFFFFFFh
.text:00414855		       jmp     short loc_4148AC
.text:00414857 ; ---------------------------------------------------------------------------
.text:00414857
.text:00414857 loc_414857:			       ; CODE XREF: __stricmp_l+4Dj
.text:00414857		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0041485A		       cmp     [eax+14h], ebx
.text:0041485D		       jnz     short loc_41486C
.text:0041485F		       push    edi	       ; src
.text:00414860		       push    [ebp+dst]       ; dst
.text:00414863		       call    ___ascii_stricmp
.text:00414868		       pop     ecx
.text:00414869		       pop     ecx
.text:0041486A		       jmp     short loc_4148A0
.text:0041486C ; ---------------------------------------------------------------------------
.text:0041486C
.text:0041486C loc_41486C:			       ; CODE XREF: __stricmp_l+80j
.text:0041486C		       push    esi
.text:0041486D
.text:0041486D loc_41486D:			       ; CODE XREF: __stricmp_l+BCj
.text:0041486D		       mov     eax, [ebp+dst]
.text:00414870		       movzx   eax, byte ptr [eax]
.text:00414873		       lea     ecx, [ebp+_loc_update]
.text:00414876		       push    ecx	       ; plocinfo
.text:00414877		       push    eax	       ; c
.text:00414878		       call    __tolower_l
.text:0041487D		       inc     [ebp+dst]
.text:00414880		       mov     esi, eax
.text:00414882		       movzx   eax, byte ptr [edi]
.text:00414885		       lea     ecx, [ebp+_loc_update]
.text:00414888		       push    ecx	       ; plocinfo
.text:00414889		       push    eax	       ; c
.text:0041488A		       call    __tolower_l
.text:0041488F		       add     esp, 10h
.text:00414892		       inc     edi
.text:00414893		       cmp     esi, ebx
.text:00414895		       jz      short loc_41489B
.text:00414897		       cmp     esi, eax
.text:00414899		       jz      short loc_41486D
.text:0041489B
.text:0041489B loc_41489B:			       ; CODE XREF: __stricmp_l+B8j
.text:0041489B		       sub     esi, eax
.text:0041489D		       mov     eax, esi
.text:0041489F		       pop     esi
.text:004148A0
.text:004148A0 loc_4148A0:			       ; CODE XREF: __stricmp_l+8Dj
.text:004148A0		       cmp     [ebp+_loc_update.updated], bl
.text:004148A3		       jz      short loc_4148AC
.text:004148A5		       mov     ecx, [ebp+_loc_update.ptd]
.text:004148A8		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:004148AC
.text:004148AC loc_4148AC:			       ; CODE XREF: __stricmp_l+78j
.text:004148AC					       ; __stricmp_l+C6j
.text:004148AC		       pop     edi
.text:004148AD
.text:004148AD loc_4148AD:			       ; CODE XREF: __stricmp_l+42j
.text:004148AD		       pop     ebx
.text:004148AE		       leave
.text:004148AF		       retn
.text:004148AF __stricmp_l     endp
.text:004148AF
.text:004148B0
.text:004148B0 ; =============== S U B R O U T I N E =======================================
.text:004148B0
.text:004148B0 ; Attributes: bp-based frame
.text:004148B0
.text:004148B0 ; int __cdecl _stricmp(const char *dst, const char *src)
.text:004148B0 __stricmp       proc near	       ; CODE XREF: TranslateName+2Dp
.text:004148B0					       ; CountryEnumProc+5Bp ...
.text:004148B0
.text:004148B0 dst	       = dword ptr  8
.text:004148B0 src	       = dword ptr  0Ch
.text:004148B0
.text:004148B0		       push    ebp
.text:004148B1		       mov     ebp, esp
.text:004148B3		       push    esi
.text:004148B4		       xor     esi, esi
.text:004148B6		       cmp     ___locale_changed, esi
.text:004148BC		       jnz     short loc_4148EE
.text:004148BE		       cmp     [ebp+dst], esi
.text:004148C1		       jnz     short loc_4148E2
.text:004148C3
.text:004148C3 loc_4148C3:			       ; CODE XREF: __stricmp+35j
.text:004148C3		       call    __errno
.text:004148C8		       push    esi	       ; pReserved
.text:004148C9		       push    esi	       ; nLine
.text:004148CA		       push    esi	       ; pszFile
.text:004148CB		       push    esi	       ; pszFunction
.text:004148CC		       push    esi	       ; pszExpression
.text:004148CD		       mov     dword ptr [eax],	16h
.text:004148D3		       call    __invalid_parameter
.text:004148D8		       add     esp, 14h
.text:004148DB		       mov     eax, 7FFFFFFFh
.text:004148E0		       jmp     short loc_4148FD
.text:004148E2 ; ---------------------------------------------------------------------------
.text:004148E2
.text:004148E2 loc_4148E2:			       ; CODE XREF: __stricmp+11j
.text:004148E2		       cmp     [ebp+src], esi
.text:004148E5		       jz      short loc_4148C3
.text:004148E7		       pop     esi
.text:004148E8		       pop     ebp
.text:004148E9		       jmp     ___ascii_stricmp
.text:004148EE ; ---------------------------------------------------------------------------
.text:004148EE
.text:004148EE loc_4148EE:			       ; CODE XREF: __stricmp+Cj
.text:004148EE		       push    esi	       ; plocinfo
.text:004148EF		       push    [ebp+src]       ; src
.text:004148F2		       push    [ebp+dst]       ; dst
.text:004148F5		       call    __stricmp_l
.text:004148FA		       add     esp, 0Ch
.text:004148FD
.text:004148FD loc_4148FD:			       ; CODE XREF: __stricmp+30j
.text:004148FD		       pop     esi
.text:004148FE		       pop     ebp
.text:004148FF		       retn
.text:004148FF __stricmp       endp
.text:004148FF
.text:00414900
.text:00414900 ; =============== S U B R O U T I N E =======================================
.text:00414900
.text:00414900
.text:00414900 ; int __cdecl atol(const	char *nptr)
.text:00414900 _atol	       proc near	       ; CODE XREF: ProcessCodePage+64p
.text:00414900					       ; ___ansicp+35p	...
.text:00414900
.text:00414900 nptr	       = dword ptr  4
.text:00414900
.text:00414900		       push    0Ah	       ; ibase
.text:00414902		       push    0	       ; endptr
.text:00414904		       push    [esp+8+nptr]    ; nptr
.text:00414908		       call    _strtol
.text:0041490D		       add     esp, 0Ch
.text:00414910		       retn
.text:00414910 _atol	       endp
.text:00414910
.text:00414911
.text:00414911 ; =============== S U B R O U T I N E =======================================
.text:00414911
.text:00414911
.text:00414911 ; int __cdecl _atol_l(const char	*nptr, localeinfo_struct *plocinfo)
.text:00414911 __atol_l	       proc near	       ; CODE XREF: __atoi_lj
.text:00414911
.text:00414911 nptr	       = dword ptr  4
.text:00414911 plocinfo	       = dword ptr  8
.text:00414911
.text:00414911		       push    [esp+plocinfo]  ; plocinfo
.text:00414915		       push    0Ah	       ; ibase
.text:00414917		       push    0	       ; endptr
.text:00414919		       push    [esp+0Ch+nptr]  ; nptr
.text:0041491D		       call    __strtol_l
.text:00414922		       add     esp, 10h
.text:00414925		       retn
.text:00414925 __atol_l	       endp
.text:00414925
.text:00414926 ; [00000005 BYTES: COLLAPSED FUNCTION _atoi. PRESS KEYPAD "+" TO	EXPAND]
.text:0041492B ; [00000005 BYTES: COLLAPSED FUNCTION __atoi_l. PRESS KEYPAD "+"	TO EXPAND]
.text:00414930
.text:00414930 ; =============== S U B R O U T I N E =======================================
.text:00414930
.text:00414930
.text:00414930 ; __int64 __cdecl _atoi64(const char *nptr)
.text:00414930 __atoi64	       proc near
.text:00414930
.text:00414930 nptr	       = dword ptr  4
.text:00414930
.text:00414930		       push    0Ah	       ; ibase
.text:00414932		       push    0	       ; endptr
.text:00414934		       push    [esp+8+nptr]    ; nptr
.text:00414938		       call    __strtoi64
.text:0041493D		       add     esp, 0Ch
.text:00414940		       retn
.text:00414940 __atoi64	       endp
.text:00414940
.text:00414941
.text:00414941 ; =============== S U B R O U T I N E =======================================
.text:00414941
.text:00414941
.text:00414941 ; __int64 __cdecl _atoi64_l(const char *nptr, localeinfo_struct *plocinfo)
.text:00414941 __atoi64_l      proc near
.text:00414941
.text:00414941 nptr	       = dword ptr  4
.text:00414941 plocinfo	       = dword ptr  8
.text:00414941
.text:00414941		       push    [esp+plocinfo]  ; plocinfo
.text:00414945		       push    0Ah	       ; ibase
.text:00414947		       push    0	       ; endptr
.text:00414949		       push    [esp+0Ch+nptr]  ; nptr
.text:0041494D		       call    __strtoi64_l
.text:00414952		       add     esp, 10h
.text:00414955		       retn
.text:00414955 __atoi64_l      endp
.text:00414955
.text:00414956
.text:00414956 ; =============== S U B R O U T I N E =======================================
.text:00414956
.text:00414956 ; Attributes: bp-based frame
.text:00414956
.text:00414956 ; int __cdecl _strnicmp_l(const char *dst, const	char *src, unsigned int	count, localeinfo_struct *plocinfo)
.text:00414956 __strnicmp_l    proc near	       ; CODE XREF: __strnicmp+51p
.text:00414956					       ; __strnicoll_l+9Fp
.text:00414956
.text:00414956 _loc_update     = _LocaleUpdate ptr -10h
.text:00414956 dst	       = dword ptr  8
.text:00414956 src	       = dword ptr  0Ch
.text:00414956 count	       = dword ptr  10h
.text:00414956 plocinfo	       = dword ptr  14h
.text:00414956
.text:00414956		       push    ebp
.text:00414957		       mov     ebp, esp
.text:00414959		       sub     esp, 10h
.text:0041495C		       push    ebx
.text:0041495D		       xor     ebx, ebx
.text:0041495F		       cmp     [ebp+count], ebx
.text:00414962		       push    esi
.text:00414963		       push    edi
.text:00414964		       jz      loc_414A3F
.text:0041496A		       push    [ebp+plocinfo]  ; plocinfo
.text:0041496D		       lea     ecx, [ebp+_loc_update] ;	this
.text:00414970		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00414975		       cmp     [ebp+dst], ebx
.text:00414978		       jnz     short loc_4149A8
.text:0041497A
.text:0041497A loc_41497A:			       ; CODE XREF: __strnicmp_l+57j
.text:0041497A		       call    __errno
.text:0041497F		       push    ebx	       ; pReserved
.text:00414980		       push    ebx	       ; nLine
.text:00414981		       push    ebx	       ; pszFile
.text:00414982		       push    ebx	       ; pszFunction
.text:00414983		       push    ebx	       ; pszExpression
.text:00414984		       mov     dword ptr [eax],	16h
.text:0041498A		       call    __invalid_parameter
.text:0041498F		       add     esp, 14h
.text:00414992		       cmp     [ebp+_loc_update.updated], bl
.text:00414995		       jz      short loc_41499E
.text:00414997		       mov     eax, [ebp+_loc_update.ptd]
.text:0041499A		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0041499E
.text:0041499E loc_41499E:			       ; CODE XREF: __strnicmp_l+3Fj
.text:0041499E		       mov     eax, 7FFFFFFFh
.text:004149A3		       jmp     loc_414A41
.text:004149A8 ; ---------------------------------------------------------------------------
.text:004149A8
.text:004149A8 loc_4149A8:			       ; CODE XREF: __strnicmp_l+22j
.text:004149A8		       mov     edi, [ebp+src]
.text:004149AB		       cmp     edi, ebx
.text:004149AD		       jz      short loc_41497A
.text:004149AF		       mov     esi, 7FFFFFFFh
.text:004149B4		       cmp     [ebp+count], esi
.text:004149B7		       jbe     short loc_4149E1
.text:004149B9		       call    __errno
.text:004149BE		       push    ebx	       ; pReserved
.text:004149BF		       push    ebx	       ; nLine
.text:004149C0		       push    ebx	       ; pszFile
.text:004149C1		       push    ebx	       ; pszFunction
.text:004149C2		       push    ebx	       ; pszExpression
.text:004149C3		       mov     dword ptr [eax],	16h
.text:004149C9		       call    __invalid_parameter
.text:004149CE		       add     esp, 14h
.text:004149D1		       cmp     [ebp+_loc_update.updated], bl
.text:004149D4		       jz      short loc_4149DD
.text:004149D6		       mov     eax, [ebp+_loc_update.ptd]
.text:004149D9		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004149DD
.text:004149DD loc_4149DD:			       ; CODE XREF: __strnicmp_l+7Ej
.text:004149DD		       mov     eax, esi
.text:004149DF		       jmp     short loc_414A41
.text:004149E1 ; ---------------------------------------------------------------------------
.text:004149E1
.text:004149E1 loc_4149E1:			       ; CODE XREF: __strnicmp_l+61j
.text:004149E1		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004149E4		       cmp     [eax+14h], ebx
.text:004149E7		       jnz     short loc_414A06
.text:004149E9		       push    [ebp+count]     ; count
.text:004149EC		       push    edi	       ; last
.text:004149ED		       push    [ebp+dst]       ; first
.text:004149F0		       call    ___ascii_strnicmp
.text:004149F5		       add     esp, 0Ch
.text:004149F8
.text:004149F8 loc_4149F8:			       ; CODE XREF: __strnicmp_l+E7j
.text:004149F8		       cmp     [ebp+_loc_update.updated], bl
.text:004149FB		       jz      short loc_414A41
.text:004149FD		       mov     ecx, [ebp+_loc_update.ptd]
.text:00414A00		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00414A04		       jmp     short loc_414A41
.text:00414A06 ; ---------------------------------------------------------------------------
.text:00414A06
.text:00414A06 loc_414A06:			       ; CODE XREF: __strnicmp_l+91j
.text:00414A06					       ; __strnicmp_l+E1j
.text:00414A06		       mov     eax, [ebp+dst]
.text:00414A09		       movzx   eax, byte ptr [eax]
.text:00414A0C		       lea     ecx, [ebp+_loc_update]
.text:00414A0F		       push    ecx	       ; plocinfo
.text:00414A10		       push    eax	       ; c
.text:00414A11		       call    __tolower_l
.text:00414A16		       inc     [ebp+dst]
.text:00414A19		       mov     esi, eax
.text:00414A1B		       movzx   eax, byte ptr [edi]
.text:00414A1E		       lea     ecx, [ebp+_loc_update]
.text:00414A21		       push    ecx	       ; plocinfo
.text:00414A22		       push    eax	       ; c
.text:00414A23		       call    __tolower_l
.text:00414A28		       add     esp, 10h
.text:00414A2B		       inc     edi
.text:00414A2C		       dec     [ebp+count]
.text:00414A2F		       jz      short loc_414A39
.text:00414A31		       cmp     esi, ebx
.text:00414A33		       jz      short loc_414A39
.text:00414A35		       cmp     esi, eax
.text:00414A37		       jz      short loc_414A06
.text:00414A39
.text:00414A39 loc_414A39:			       ; CODE XREF: __strnicmp_l+D9j
.text:00414A39					       ; __strnicmp_l+DDj
.text:00414A39		       sub     esi, eax
.text:00414A3B		       mov     eax, esi
.text:00414A3D		       jmp     short loc_4149F8
.text:00414A3F ; ---------------------------------------------------------------------------
.text:00414A3F
.text:00414A3F loc_414A3F:			       ; CODE XREF: __strnicmp_l+Ej
.text:00414A3F		       xor     eax, eax
.text:00414A41
.text:00414A41 loc_414A41:			       ; CODE XREF: __strnicmp_l+4Dj
.text:00414A41					       ; __strnicmp_l+89j ...
.text:00414A41		       pop     edi
.text:00414A42		       pop     esi
.text:00414A43		       pop     ebx
.text:00414A44		       leave
.text:00414A45		       retn
.text:00414A45 __strnicmp_l    endp
.text:00414A45
.text:00414A46
.text:00414A46 ; =============== S U B R O U T I N E =======================================
.text:00414A46
.text:00414A46 ; Attributes: bp-based frame
.text:00414A46
.text:00414A46 ; int __cdecl _strnicmp(const char *dst,	const char *src, unsigned int count)
.text:00414A46 __strnicmp      proc near	       ; CODE XREF: LangCountryEnumProc+C3p
.text:00414A46					       ; __strnicoll+Dj
.text:00414A46
.text:00414A46 dst	       = dword ptr  8
.text:00414A46 src	       = dword ptr  0Ch
.text:00414A46 count	       = dword ptr  10h
.text:00414A46
.text:00414A46		       push    ebp
.text:00414A47		       mov     ebp, esp
.text:00414A49		       push    esi
.text:00414A4A		       xor     esi, esi
.text:00414A4C		       cmp     ___locale_changed, esi
.text:00414A52		       jnz     short loc_414A8D
.text:00414A54		       cmp     [ebp+dst], esi
.text:00414A57		       jnz     short loc_414A78
.text:00414A59
.text:00414A59 loc_414A59:			       ; CODE XREF: __strnicmp+35j
.text:00414A59					       ; __strnicmp+3Ej
.text:00414A59		       call    __errno
.text:00414A5E		       push    esi	       ; pReserved
.text:00414A5F		       push    esi	       ; nLine
.text:00414A60		       push    esi	       ; pszFile
.text:00414A61		       push    esi	       ; pszFunction
.text:00414A62		       push    esi	       ; pszExpression
.text:00414A63		       mov     dword ptr [eax],	16h
.text:00414A69		       call    __invalid_parameter
.text:00414A6E		       add     esp, 14h
.text:00414A71		       mov     eax, 7FFFFFFFh
.text:00414A76		       jmp     short loc_414A9F
.text:00414A78 ; ---------------------------------------------------------------------------
.text:00414A78
.text:00414A78 loc_414A78:			       ; CODE XREF: __strnicmp+11j
.text:00414A78		       cmp     [ebp+src], esi
.text:00414A7B		       jz      short loc_414A59
.text:00414A7D		       cmp     [ebp+count], 7FFFFFFFh
.text:00414A84		       ja      short loc_414A59
.text:00414A86		       pop     esi
.text:00414A87		       pop     ebp
.text:00414A88		       jmp     ___ascii_strnicmp
.text:00414A8D ; ---------------------------------------------------------------------------
.text:00414A8D
.text:00414A8D loc_414A8D:			       ; CODE XREF: __strnicmp+Cj
.text:00414A8D		       push    esi	       ; plocinfo
.text:00414A8E		       push    [ebp+count]     ; count
.text:00414A91		       push    [ebp+src]       ; src
.text:00414A94		       push    [ebp+dst]       ; dst
.text:00414A97		       call    __strnicmp_l
.text:00414A9C		       add     esp, 10h
.text:00414A9F
.text:00414A9F loc_414A9F:			       ; CODE XREF: __strnicmp+30j
.text:00414A9F		       pop     esi
.text:00414AA0		       pop     ebp
.text:00414AA1		       retn
.text:00414AA1 __strnicmp      endp
.text:00414AA1
.text:00414AA2
.text:00414AA2 ; =============== S U B R O U T I N E =======================================
.text:00414AA2
.text:00414AA2 ; Attributes: bp-based frame
.text:00414AA2
.text:00414AA2 ; int __userpurge xtoa_s<eax>(unsigned int val<eax>, char *buf<ecx>, unsigned int sizeInTChars, unsigned	int radix, int is_neg)
.text:00414AA2 xtoa_s	       proc near	       ; CODE XREF: __itoa_s+21p
.text:00414AA2					       ; __ltoa_s+1Ep ...
.text:00414AA2
.text:00414AA2 length	       = dword ptr -4
.text:00414AA2 sizeInTChars    = dword ptr  8
.text:00414AA2 radix	       = dword ptr  0Ch
.text:00414AA2 is_neg	       = dword ptr  10h
.text:00414AA2
.text:00414AA2 val = eax
.text:00414AA2 buf = ecx
.text:00414AA2		       push    ebp
.text:00414AA3		       mov     ebp, esp
.text:00414AA5		       push    buf
.text:00414AA6		       push    ebx
.text:00414AA7		       push    esi
.text:00414AA8		       mov     esi, buf
.text:00414AAA		       xor     ebx, ebx
.text:00414AAC		       cmp     esi, ebx
.text:00414AAE		       jnz     short loc_414ACE
.text:00414AB0		       call    __errno
.text:00414AB5		       push    16h
.text:00414AB7		       pop     esi
.text:00414AB8		       push    ebx	       ; pReserved
.text:00414AB9		       push    ebx	       ; nLine
.text:00414ABA		       push    ebx	       ; pszFile
.text:00414ABB		       push    ebx	       ; pszFunction
.text:00414ABC		       push    ebx	       ; pszExpression
.text:00414ABD		       mov     [val], esi
.text:00414ABF		       call    __invalid_parameter
.text:00414AC4		       add     esp, 14h
.text:00414AC7		       mov     val, esi
.text:00414AC9		       jmp     loc_414B77
.text:00414ACE ; ---------------------------------------------------------------------------
.text:00414ACE
.text:00414ACE loc_414ACE:			       ; CODE XREF: xtoa_s+Cj
.text:00414ACE		       cmp     [ebp+sizeInTChars], ebx
.text:00414AD1		       push    edi
.text:00414AD2		       ja      short loc_414AF2
.text:00414AD4
.text:00414AD4 loc_414AD4:			       ; CODE XREF: xtoa_s+72j
.text:00414AD4		       call    __errno
.text:00414AD9		       push    16h
.text:00414ADB
.text:00414ADB loc_414ADB:			       ; CODE XREF: xtoa_s+67j
.text:00414ADB		       pop     esi
.text:00414ADC		       push    ebx	       ; pReserved
.text:00414ADD		       push    ebx	       ; nLine
.text:00414ADE		       push    ebx	       ; pszFile
.text:00414ADF		       push    ebx	       ; pszFunction
.text:00414AE0		       push    ebx	       ; pszExpression
.text:00414AE1		       mov     [val], esi
.text:00414AE3		       call    __invalid_parameter
.text:00414AE8		       add     esp, 14h
.text:00414AEB		       mov     val, esi
.text:00414AED		       jmp     loc_414B76
.text:00414AF2 ; ---------------------------------------------------------------------------
.text:00414AF2
.text:00414AF2 loc_414AF2:			       ; CODE XREF: xtoa_s+30j
.text:00414AF2		       xor     buf, buf
.text:00414AF4		       cmp     [ebp+is_neg], ebx
.text:00414AF7		       mov     [esi], bl
.text:00414AF9		       setnz   cl
.text:00414AFC		       inc     buf
.text:00414AFD		       cmp     [ebp+sizeInTChars], buf
.text:00414B00		       ja      short loc_414B0B
.text:00414B02
.text:00414B02 loc_414B02:			       ; CODE XREF: xtoa_s+BFj
.text:00414B02		       call    __errno
.text:00414B07		       push    22h
.text:00414B09		       jmp     short loc_414ADB
.text:00414B0B ; ---------------------------------------------------------------------------
.text:00414B0B
.text:00414B0B loc_414B0B:			       ; CODE XREF: xtoa_s+5Ej
.text:00414B0B		       mov     buf, [ebp+radix]
.text:00414B0E		       add     buf, 0FFFFFFFEh
.text:00414B11		       cmp     buf, 22h
.text:00414B14		       ja      short loc_414AD4
.text:00414B16		       cmp     [ebp+is_neg], ebx
.text:00414B19		       mov     [ebp+length], ebx
.text:00414B1C		       mov     buf, esi
.text:00414B1E		       jz      short loc_414B2F
.text:00414B20		       mov     byte ptr	[esi], 2Dh
.text:00414B23		       lea     buf, [esi+1]
.text:00414B26		       mov     [ebp+length], 1
.text:00414B2D		       neg     val
.text:00414B2F
.text:00414B2F loc_414B2F:			       ; CODE XREF: xtoa_s+7Cj
.text:00414B2F		       mov     edi, buf
.text:00414B31
.text:00414B31 loc_414B31:			       ; CODE XREF: xtoa_s+B3j
.text:00414B31		       xor     edx, edx
.text:00414B33		       div     [ebp+radix]
.text:00414B36		       cmp     edx, 9
.text:00414B39		       jbe     short loc_414B40
.text:00414B3B		       add     dl, 57h
.text:00414B3E		       jmp     short loc_414B43
.text:00414B40 ; ---------------------------------------------------------------------------
.text:00414B40
.text:00414B40 loc_414B40:			       ; CODE XREF: xtoa_s+97j
.text:00414B40		       add     dl, 30h
.text:00414B43
.text:00414B43 loc_414B43:			       ; CODE XREF: xtoa_s+9Cj
.text:00414B43		       mov     [buf], dl
.text:00414B45		       inc     buf
.text:00414B46		       inc     [ebp+length]
.text:00414B49		       xor     ebx, ebx
.text:00414B4B		       cmp     val, ebx
.text:00414B4D		       jbe     short loc_414B57
.text:00414B4F		       mov     edx, [ebp+sizeInTChars]
.text:00414B52		       cmp     [ebp+length], edx
.text:00414B55		       jb      short loc_414B31
.text:00414B57
.text:00414B57 loc_414B57:			       ; CODE XREF: xtoa_s+ABj
.text:00414B57		       mov     val, [ebp+length]
.text:00414B5A		       cmp     val, [ebp+sizeInTChars]
.text:00414B5D		       jb      short loc_414B63
.text:00414B5F		       mov     [esi], bl
.text:00414B61		       jmp     short loc_414B02
.text:00414B63 ; ---------------------------------------------------------------------------
.text:00414B63
.text:00414B63 loc_414B63:			       ; CODE XREF: xtoa_s+BBj
.text:00414B63		       mov     [buf], bl
.text:00414B65		       dec     buf
.text:00414B66
.text:00414B66 loc_414B66:			       ; CODE XREF: xtoa_s+D0j
.text:00414B66		       mov     dl, [edi]
.text:00414B68		       mov     al, [buf]
.text:00414B6A		       mov     [buf], dl
.text:00414B6C		       dec     buf
.text:00414B6D		       mov     [edi], al
.text:00414B6F		       inc     edi
.text:00414B70		       cmp     edi, buf
.text:00414B72		       jb      short loc_414B66
.text:00414B74		       xor     val, val
.text:00414B76
.text:00414B76 loc_414B76:			       ; CODE XREF: xtoa_s+4Bj
.text:00414B76		       pop     edi
.text:00414B77
.text:00414B77 loc_414B77:			       ; CODE XREF: xtoa_s+27j
.text:00414B77		       pop     esi
.text:00414B78		       pop     ebx
.text:00414B79		       leave
.text:00414B7A		       retn    0Ch
.text:00414B7A xtoa_s	       endp
.text:00414B7A
.text:00414B7D
.text:00414B7D ; =============== S U B R O U T I N E =======================================
.text:00414B7D
.text:00414B7D ; Attributes: bp-based frame
.text:00414B7D
.text:00414B7D ; int __cdecl _itoa_s(int val, char *buf, unsigned int sizeInTChars, int	radix)
.text:00414B7D __itoa_s	       proc near	       ; CODE XREF: ___get_qualified_locale+1CFp
.text:00414B7D
.text:00414B7D val	       = dword ptr  8
.text:00414B7D buf	       = dword ptr  0Ch
.text:00414B7D sizeInTChars    = dword ptr  10h
.text:00414B7D radix	       = dword ptr  14h
.text:00414B7D
.text:00414B7D		       push    ebp
.text:00414B7E		       mov     ebp, esp
.text:00414B80		       cmp     [ebp+radix], 0Ah
.text:00414B84		       mov     eax, [ebp+val]  ; val
.text:00414B87		       jnz     short loc_414B93
.text:00414B89		       test    eax, eax
.text:00414B8B		       jge     short loc_414B93
.text:00414B8D		       push    1
.text:00414B8F		       push    0Ah
.text:00414B91		       jmp     short loc_414B98
.text:00414B93 ; ---------------------------------------------------------------------------
.text:00414B93
.text:00414B93 loc_414B93:			       ; CODE XREF: __itoa_s+Aj
.text:00414B93					       ; __itoa_s+Ej
.text:00414B93		       push    0	       ; is_neg
.text:00414B95		       push    [ebp+radix]     ; radix
.text:00414B98
.text:00414B98 loc_414B98:			       ; CODE XREF: __itoa_s+14j
.text:00414B98		       push    [ebp+sizeInTChars] ; sizeInTChars
.text:00414B9B		       mov     ecx, [ebp+buf]  ; buf
.text:00414B9E		       call    xtoa_s
.text:00414BA3		       pop     ebp
.text:00414BA4		       retn
.text:00414BA4 __itoa_s	       endp
.text:00414BA4
.text:00414BA5
.text:00414BA5 ; =============== S U B R O U T I N E =======================================
.text:00414BA5
.text:00414BA5 ; Attributes: bp-based frame
.text:00414BA5
.text:00414BA5 ; int __cdecl _ltoa_s(int val, char *buf, unsigned int sizeInTChars, int	radix)
.text:00414BA5 __ltoa_s	       proc near
.text:00414BA5
.text:00414BA5 val	       = dword ptr  8
.text:00414BA5 buf	       = dword ptr  0Ch
.text:00414BA5 sizeInTChars    = dword ptr  10h
.text:00414BA5 radix	       = dword ptr  14h
.text:00414BA5
.text:00414BA5		       push    ebp
.text:00414BA6		       mov     ebp, esp
.text:00414BA8		       xor     eax, eax
.text:00414BAA		       cmp     [ebp+radix], 0Ah
.text:00414BAE		       jnz     short loc_414BB6
.text:00414BB0		       cmp     [ebp+val], eax
.text:00414BB3		       jge     short loc_414BB6
.text:00414BB5		       inc     eax
.text:00414BB6
.text:00414BB6 loc_414BB6:			       ; CODE XREF: __ltoa_s+9j
.text:00414BB6					       ; __ltoa_s+Ej
.text:00414BB6		       mov     ecx, [ebp+buf]  ; buf
.text:00414BB9		       push    eax	       ; is_neg
.text:00414BBA		       push    [ebp+radix]     ; radix
.text:00414BBD		       mov     eax, [ebp+val]  ; val
.text:00414BC0		       push    [ebp+sizeInTChars] ; sizeInTChars
.text:00414BC3		       call    xtoa_s
.text:00414BC8		       pop     ebp
.text:00414BC9		       retn
.text:00414BC9 __ltoa_s	       endp
.text:00414BC9
.text:00414BCA
.text:00414BCA ; =============== S U B R O U T I N E =======================================
.text:00414BCA
.text:00414BCA
.text:00414BCA ; int __cdecl _ultoa_s(unsigned int val,	char *buf, unsigned int	sizeInTChars, int radix)
.text:00414BCA __ultoa_s       proc near
.text:00414BCA
.text:00414BCA val	       = dword ptr  4
.text:00414BCA buf	       = dword ptr  8
.text:00414BCA sizeInTChars    = dword ptr  0Ch
.text:00414BCA radix	       = dword ptr  10h
.text:00414BCA
.text:00414BCA		       mov     ecx, [esp+buf]  ; buf
.text:00414BCE		       mov     eax, [esp+val]  ; val
.text:00414BD2		       push    0	       ; is_neg
.text:00414BD4		       push    [esp+4+radix]   ; radix
.text:00414BD8		       push    [esp+8+sizeInTChars] ; sizeInTChars
.text:00414BDC		       call    xtoa_s
.text:00414BE1		       retn
.text:00414BE1 __ultoa_s       endp
.text:00414BE1
.text:00414BE2
.text:00414BE2 ; =============== S U B R O U T I N E =======================================
.text:00414BE2
.text:00414BE2 ; Attributes: bp-based frame
.text:00414BE2
.text:00414BE2 ; int __userpurge x64toa_s<eax>(unsigned	__int64	val, char *buf<edi>, unsigned int sizeInTChars,	unsigned int radix, int	is_neg)
.text:00414BE2 x64toa_s	       proc near	       ; CODE XREF: __i64toa_s+2Bp
.text:00414BE2					       ; __ui64toa_s+15p
.text:00414BE2
.text:00414BE2 var_8	       = dword ptr -8
.text:00414BE2 length	       = dword ptr -4
.text:00414BE2 val	       = qword ptr  8
.text:00414BE2 sizeInTChars    = dword ptr  10h
.text:00414BE2 radix	       = dword ptr  14h
.text:00414BE2 firstdig	       = dword ptr  18h
.text:00414BE2
.text:00414BE2 buf = edi
.text:00414BE2		       push    ebp
.text:00414BE3		       mov     ebp, esp
.text:00414BE5		       sub     esp, 0Ch
.text:00414BE8		       push    ebx
.text:00414BE9		       xor     ebx, ebx
.text:00414BEB		       cmp     buf, ebx
.text:00414BED		       push    esi
.text:00414BEE		       jnz     short loc_414C0E
.text:00414BF0
.text:00414BF0 loc_414BF0:			       ; CODE XREF: x64toa_s+2Fj
.text:00414BF0					       ; x64toa_s+53j
.text:00414BF0		       call    __errno
.text:00414BF5		       push    16h
.text:00414BF7
.text:00414BF7 loc_414BF7:			       ; CODE XREF: x64toa_s+48j
.text:00414BF7		       pop     esi
.text:00414BF8		       mov     [eax], esi
.text:00414BFA
.text:00414BFA loc_414BFA:			       ; CODE XREF: x64toa_s+D1j
.text:00414BFA		       push    ebx	       ; pReserved
.text:00414BFB		       push    ebx	       ; nLine
.text:00414BFC		       push    ebx	       ; pszFile
.text:00414BFD		       push    ebx	       ; pszFunction
.text:00414BFE		       push    ebx	       ; pszExpression
.text:00414BFF		       call    __invalid_parameter
.text:00414C04		       add     esp, 14h
.text:00414C07		       mov     eax, esi
.text:00414C09		       jmp     loc_414CD2
.text:00414C0E ; ---------------------------------------------------------------------------
.text:00414C0E
.text:00414C0E loc_414C0E:			       ; CODE XREF: x64toa_s+Cj
.text:00414C0E		       cmp     [ebp+sizeInTChars], ebx
.text:00414C11		       jbe     short loc_414BF0
.text:00414C13		       xor     eax, eax
.text:00414C15		       cmp     [ebp+firstdig], ebx
.text:00414C18		       mov     [buf], bl
.text:00414C1A		       setnz   al
.text:00414C1D		       inc     eax
.text:00414C1E		       cmp     [ebp+sizeInTChars], eax
.text:00414C21		       ja      short loc_414C2C
.text:00414C23		       call    __errno
.text:00414C28		       push    22h
.text:00414C2A		       jmp     short loc_414BF7
.text:00414C2C ; ---------------------------------------------------------------------------
.text:00414C2C
.text:00414C2C loc_414C2C:			       ; CODE XREF: x64toa_s+3Fj
.text:00414C2C		       mov     eax, [ebp+radix]
.text:00414C2F		       add     eax, 0FFFFFFFEh
.text:00414C32		       cmp     eax, 22h
.text:00414C35		       ja      short loc_414BF0
.text:00414C37		       cmp     [ebp+firstdig], ebx
.text:00414C3A		       mov     edx, dword ptr [ebp+val]
.text:00414C3D		       mov     eax, dword ptr [ebp+val+4]
.text:00414C40		       mov     [ebp+length], ebx
.text:00414C43		       mov     esi, buf
.text:00414C45		       jz      short loc_414C5A
.text:00414C47		       neg     edx
.text:00414C49		       adc     eax, ebx
.text:00414C4B		       mov     byte ptr	[buf], 2Dh
.text:00414C4E		       lea     esi, [buf+1]
.text:00414C51		       mov     [ebp+length], 1
.text:00414C58		       neg     eax
.text:00414C5A
.text:00414C5A loc_414C5A:			       ; CODE XREF: x64toa_s+63j
.text:00414C5A		       mov     [ebp+firstdig], esi
.text:00414C5D		       mov     dword ptr [ebp+val+4], ebx
.text:00414C60
.text:00414C60 loc_414C60:			       ; CODE XREF: x64toa_s+B6j
.text:00414C60		       push    dword ptr [ebp+val+4]
.text:00414C63		       push    [ebp+radix]
.text:00414C66		       push    eax
.text:00414C67		       push    edx
.text:00414C68		       call    __aulldvrm
.text:00414C6D		       cmp     ecx, 9
.text:00414C70		       mov     [ebp+var_8], ebx
.text:00414C73		       mov     ebx, edx
.text:00414C75		       mov     edx, eax
.text:00414C77		       mov     eax, ebx
.text:00414C79		       jbe     short loc_414C80
.text:00414C7B		       add     cl, 57h
.text:00414C7E		       jmp     short loc_414C83
.text:00414C80 ; ---------------------------------------------------------------------------
.text:00414C80
.text:00414C80 loc_414C80:			       ; CODE XREF: x64toa_s+97j
.text:00414C80		       add     cl, 30h
.text:00414C83
.text:00414C83 loc_414C83:			       ; CODE XREF: x64toa_s+9Cj
.text:00414C83		       mov     [esi], cl
.text:00414C85		       mov     ecx, [ebp+length]
.text:00414C88		       inc     esi
.text:00414C89		       inc     ecx
.text:00414C8A		       test    eax, eax
.text:00414C8C		       mov     [ebp+length], ecx
.text:00414C8F		       ja      short loc_414C95
.text:00414C91		       test    edx, edx
.text:00414C93		       jbe     short loc_414C9D
.text:00414C95
.text:00414C95 loc_414C95:			       ; CODE XREF: x64toa_s+ADj
.text:00414C95		       cmp     ecx, [ebp+sizeInTChars]
.text:00414C98		       jb      short loc_414C60
.text:00414C9A		       mov     ecx, [ebp+length]
.text:00414C9D
.text:00414C9D loc_414C9D:			       ; CODE XREF: x64toa_s+B1j
.text:00414C9D		       cmp     ecx, [ebp+sizeInTChars]
.text:00414CA0		       jb      short loc_414CB8
.text:00414CA2		       mov     byte ptr	[buf], 0
.text:00414CA5		       call    __errno
.text:00414CAA		       push    22h
.text:00414CAC		       pop     ecx
.text:00414CAD		       mov     [eax], ecx
.text:00414CAF		       mov     esi, ecx
.text:00414CB1		       xor     ebx, ebx
.text:00414CB3		       jmp     loc_414BFA
.text:00414CB8 ; ---------------------------------------------------------------------------
.text:00414CB8
.text:00414CB8 loc_414CB8:			       ; CODE XREF: x64toa_s+BEj
.text:00414CB8		       mov     byte ptr	[esi], 0
.text:00414CBB		       dec     esi
.text:00414CBC
.text:00414CBC loc_414CBC:			       ; CODE XREF: x64toa_s+ECj
.text:00414CBC		       mov     eax, [ebp+firstdig]
.text:00414CBF		       mov     dl, [eax]
.text:00414CC1		       mov     cl, [esi]
.text:00414CC3		       mov     [esi], dl
.text:00414CC5		       dec     esi
.text:00414CC6		       mov     [eax], cl
.text:00414CC8		       inc     eax
.text:00414CC9		       cmp     eax, esi
.text:00414CCB		       mov     [ebp+firstdig], eax
.text:00414CCE		       jb      short loc_414CBC
.text:00414CD0		       xor     eax, eax
.text:00414CD2
.text:00414CD2 loc_414CD2:			       ; CODE XREF: x64toa_s+27j
.text:00414CD2		       pop     esi
.text:00414CD3		       pop     ebx
.text:00414CD4		       leave
.text:00414CD5		       retn    14h
.text:00414CD5 x64toa_s	       endp
.text:00414CD5
.text:00414CD8
.text:00414CD8 ; =============== S U B R O U T I N E =======================================
.text:00414CD8
.text:00414CD8 ; Attributes: bp-based frame
.text:00414CD8
.text:00414CD8 ; int __cdecl _i64toa_s(__int64 val, char *buf, unsigned	int sizeInTChars, int radix)
.text:00414CD8 __i64toa_s      proc near
.text:00414CD8
.text:00414CD8 val	       = qword ptr  8
.text:00414CD8 buf	       = dword ptr  10h
.text:00414CD8 sizeInTChars    = dword ptr  14h
.text:00414CD8 radix	       = dword ptr  18h
.text:00414CD8
.text:00414CD8		       push    ebp
.text:00414CD9		       mov     ebp, esp
.text:00414CDB		       xor     eax, eax
.text:00414CDD		       cmp     [ebp+radix], 0Ah
.text:00414CE1		       jnz     short loc_414CF2
.text:00414CE3		       cmp     dword ptr [ebp+val+4], eax
.text:00414CE6		       jg      short loc_414CF2
.text:00414CE8		       jl      short loc_414CEF
.text:00414CEA		       cmp     dword ptr [ebp+val], eax
.text:00414CED		       jnb     short loc_414CF2
.text:00414CEF
.text:00414CEF loc_414CEF:			       ; CODE XREF: __i64toa_s+10j
.text:00414CEF		       xor     eax, eax
.text:00414CF1		       inc     eax
.text:00414CF2
.text:00414CF2 loc_414CF2:			       ; CODE XREF: __i64toa_s+9j
.text:00414CF2					       ; __i64toa_s+Ej	...
.text:00414CF2		       push    edi
.text:00414CF3		       mov     edi, [ebp+buf]  ; buf
.text:00414CF6		       push    eax	       ; is_neg
.text:00414CF7		       push    [ebp+radix]     ; radix
.text:00414CFA		       push    [ebp+sizeInTChars] ; sizeInTChars
.text:00414CFD		       push    dword ptr [ebp+val+4]
.text:00414D00		       push    dword ptr [ebp+val] ; val
.text:00414D03		       call    x64toa_s
.text:00414D08		       pop     edi
.text:00414D09		       pop     ebp
.text:00414D0A		       retn
.text:00414D0A __i64toa_s      endp
.text:00414D0A
.text:00414D0B
.text:00414D0B ; =============== S U B R O U T I N E =======================================
.text:00414D0B
.text:00414D0B ; Attributes: bp-based frame
.text:00414D0B
.text:00414D0B ; int __cdecl _ui64toa_s(unsigned __int64 val, char *buf, unsigned int sizeInTChars, int	radix)
.text:00414D0B __ui64toa_s     proc near
.text:00414D0B
.text:00414D0B val	       = qword ptr  8
.text:00414D0B buf	       = dword ptr  10h
.text:00414D0B sizeInTChars    = dword ptr  14h
.text:00414D0B radix	       = dword ptr  18h
.text:00414D0B
.text:00414D0B		       push    ebp
.text:00414D0C		       mov     ebp, esp
.text:00414D0E		       push    edi
.text:00414D0F		       mov     edi, [ebp+buf]  ; buf
.text:00414D12		       push    0	       ; is_neg
.text:00414D14		       push    [ebp+radix]     ; radix
.text:00414D17		       push    [ebp+sizeInTChars] ; sizeInTChars
.text:00414D1A		       push    dword ptr [ebp+val+4]
.text:00414D1D		       push    dword ptr [ebp+val] ; val
.text:00414D20		       call    x64toa_s
.text:00414D25		       pop     edi
.text:00414D26		       pop     ebp
.text:00414D27		       retn
.text:00414D27 __ui64toa_s     endp
.text:00414D27
.text:00414D28
.text:00414D28 ; =============== S U B R O U T I N E =======================================
.text:00414D28
.text:00414D28 ; Attributes: bp-based frame
.text:00414D28
.text:00414D28 ; int __cdecl _crtGetStringTypeW_stat(localeinfo_struct *plocinfo, unsigned int dwInfoType, const wchar_t *lpSrcStr, int	cchSrc,	unsigned __int16 *lpCharType, int code_page, int lcid)
.text:00414D28 __crtGetStringTypeW_stat	proc near      ; CODE XREF: ___crtGetStringTypeW+27p
.text:00414D28
.text:00414D28 buff_size       = dword ptr -10h
.text:00414D28 retbool	       = dword ptr -0Ch
.text:00414D28 buffer	       = dword ptr -8
.text:00414D28 var_4	       = dword ptr -4
.text:00414D28 plocinfo	       = dword ptr  8
.text:00414D28 dwInfoType      = dword ptr  0Ch
.text:00414D28 lpSrcStr	       = dword ptr  10h
.text:00414D28 cchSrc	       = dword ptr  14h
.text:00414D28 lpCharType      = dword ptr  18h
.text:00414D28 code_page       = dword ptr  1Ch
.text:00414D28 lcid	       = dword ptr  20h
.text:00414D28
.text:00414D28		       push    ebp
.text:00414D29		       mov     ebp, esp
.text:00414D2B		       sub     esp, 10h
.text:00414D2E		       mov     eax, ___security_cookie
.text:00414D33		       xor     eax, ebp
.text:00414D35		       mov     [ebp+var_4], eax
.text:00414D38		       cmp     [ebp+cchSrc], 0FFFFFFFFh
.text:00414D3C		       push    ebx
.text:00414D3D		       push    esi
.text:00414D3E		       push    edi
.text:00414D3F		       jge     short loc_414D48
.text:00414D41
.text:00414D41 loc_414D41:			       ; CODE XREF: __crtGetStringTypeW_stat+85j
.text:00414D41					       ; __crtGetStringTypeW_stat+DDj ...
.text:00414D41		       xor     eax, eax
.text:00414D43		       jmp     loc_414F3A
.text:00414D48 ; ---------------------------------------------------------------------------
.text:00414D48
.text:00414D48 loc_414D48:			       ; CODE XREF: __crtGetStringTypeW_stat+17j
.text:00414D48		       mov     eax, f_use_4
.text:00414D4D		       mov     esi, ds:__imp__GetStringTypeW@16	; GetStringTypeW(x,x,x,x)
.text:00414D53		       xor     ebx, ebx
.text:00414D55		       xor     edi, edi
.text:00414D57		       inc     ebx
.text:00414D58		       cmp     eax, edi
.text:00414D5A		       jnz     short loc_414D8F
.text:00414D5C		       lea     eax, [ebp+buffer]
.text:00414D5F		       push    eax	       ; lpCharType
.text:00414D60		       push    ebx	       ; cchSrc
.text:00414D61		       push    offset SrcStr   ; lpSrcStr
.text:00414D66		       push    ebx	       ; dwInfoType
.text:00414D67		       call    esi ; GetStringTypeW(x,x,x,x) ; GetStringTypeW(x,x,x,x)
.text:00414D69		       test    eax, eax
.text:00414D6B		       jz      short loc_414D75
.text:00414D6D		       mov     f_use_4,	ebx
.text:00414D73		       jmp     short loc_414D93
.text:00414D75 ; ---------------------------------------------------------------------------
.text:00414D75
.text:00414D75 loc_414D75:			       ; CODE XREF: __crtGetStringTypeW_stat+43j
.text:00414D75		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00414D7B		       cmp     eax, 78h
.text:00414D7E		       jnz     short loc_414D8A
.text:00414D80		       push    2
.text:00414D82		       pop     eax
.text:00414D83		       mov     f_use_4,	eax
.text:00414D88		       jmp     short loc_414D8F
.text:00414D8A ; ---------------------------------------------------------------------------
.text:00414D8A
.text:00414D8A loc_414D8A:			       ; CODE XREF: __crtGetStringTypeW_stat+56j
.text:00414D8A		       mov     eax, f_use_4
.text:00414D8F
.text:00414D8F loc_414D8F:			       ; CODE XREF: __crtGetStringTypeW_stat+32j
.text:00414D8F					       ; __crtGetStringTypeW_stat+60j
.text:00414D8F		       cmp     eax, ebx
.text:00414D91		       jnz     short loc_414DA6
.text:00414D93
.text:00414D93 loc_414D93:			       ; CODE XREF: __crtGetStringTypeW_stat+4Bj
.text:00414D93		       push    [ebp+lpCharType]	; lpCharType
.text:00414D96		       push    [ebp+cchSrc]    ; cchSrc
.text:00414D99		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:00414D9C		       push    [ebp+dwInfoType]	; dwInfoType
.text:00414D9F		       call    esi ; GetStringTypeW(x,x,x,x) ; GetStringTypeW(x,x,x,x)
.text:00414DA1		       jmp     loc_414F3A
.text:00414DA6 ; ---------------------------------------------------------------------------
.text:00414DA6
.text:00414DA6 loc_414DA6:			       ; CODE XREF: __crtGetStringTypeW_stat+69j
.text:00414DA6		       cmp     eax, 2
.text:00414DA9		       jz      short loc_414DAF
.text:00414DAB		       cmp     eax, edi
.text:00414DAD		       jnz     short loc_414D41
.text:00414DAF
.text:00414DAF loc_414DAF:			       ; CODE XREF: __crtGetStringTypeW_stat+81j
.text:00414DAF		       cmp     [ebp+lcid], edi
.text:00414DB2		       mov     [ebp+retbool], edi
.text:00414DB5		       jnz     short loc_414DC2
.text:00414DB7		       mov     eax, [ebp+plocinfo]
.text:00414DBA		       mov     eax, [eax]
.text:00414DBC		       mov     eax, [eax+14h]
.text:00414DBF		       mov     [ebp+lcid], eax
.text:00414DC2
.text:00414DC2 loc_414DC2:			       ; CODE XREF: __crtGetStringTypeW_stat+8Dj
.text:00414DC2		       cmp     [ebp+code_page],	edi
.text:00414DC5		       jnz     short loc_414DD2
.text:00414DC7		       mov     eax, [ebp+plocinfo]
.text:00414DCA		       mov     eax, [eax]
.text:00414DCC		       mov     eax, [eax+4]
.text:00414DCF		       mov     [ebp+code_page],	eax
.text:00414DD2
.text:00414DD2 loc_414DD2:			       ; CODE XREF: __crtGetStringTypeW_stat+9Dj
.text:00414DD2		       push    [ebp+lcid]      ; lcid
.text:00414DD5		       call    ___ansicp
.text:00414DDA		       cmp     [ebp+code_page],	eax
.text:00414DDD		       pop     ecx
.text:00414DDE		       jz      short loc_414DE8
.text:00414DE0		       cmp     eax, 0FFFFFFFFh
.text:00414DE3		       jz      short loc_414DE8
.text:00414DE5		       mov     [ebp+code_page],	eax
.text:00414DE8
.text:00414DE8 loc_414DE8:			       ; CODE XREF: __crtGetStringTypeW_stat+B6j
.text:00414DE8					       ; __crtGetStringTypeW_stat+BBj
.text:00414DE8		       mov     ebx, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414DEE		       push    edi	       ; lpUsedDefaultChar
.text:00414DEF		       push    edi	       ; lpDefaultChar
.text:00414DF0		       push    edi	       ; cbMultiByte
.text:00414DF1		       push    edi	       ; lpMultiByteStr
.text:00414DF2		       push    [ebp+cchSrc]    ; cchWideChar
.text:00414DF5		       push    [ebp+lpSrcStr]  ; lpWideCharStr
.text:00414DF8		       push    edi	       ; dwFlags
.text:00414DF9		       push    [ebp+code_page] ; CodePage
.text:00414DFC		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414DFE		       mov     esi, eax
.text:00414E00		       cmp     esi, edi
.text:00414E02		       mov     [ebp+buff_size],	esi
.text:00414E05		       jz      loc_414D41
.text:00414E0B		       jle     short loc_414E48
.text:00414E0D		       cmp     esi, 0FFFFFFE0h
.text:00414E10		       ja      short loc_414E48
.text:00414E12		       lea     eax, [esi+8]
.text:00414E15		       cmp     eax, 400h
.text:00414E1A		       ja      short loc_414E2F
.text:00414E1C		       call    __alloca_probe_16
.text:00414E21		       mov     eax, esp
.text:00414E23		       cmp     eax, edi
.text:00414E25		       jz      short loc_414E43
.text:00414E27		       mov     dword ptr [eax],	0CCCCh
.text:00414E2D		       jmp     short loc_414E40
.text:00414E2F ; ---------------------------------------------------------------------------
.text:00414E2F
.text:00414E2F loc_414E2F:			       ; CODE XREF: __crtGetStringTypeW_stat+F2j
.text:00414E2F		       push    eax	       ; size
.text:00414E30		       call    _malloc
.text:00414E35		       cmp     eax, edi
.text:00414E37		       pop     ecx
.text:00414E38		       jz      short loc_414E43
.text:00414E3A		       mov     dword ptr [eax],	0DDDDh
.text:00414E40
.text:00414E40 loc_414E40:			       ; CODE XREF: __crtGetStringTypeW_stat+105j
.text:00414E40		       add     eax, 8
.text:00414E43
.text:00414E43 loc_414E43:			       ; CODE XREF: __crtGetStringTypeW_stat+FDj
.text:00414E43					       ; __crtGetStringTypeW_stat+110j
.text:00414E43		       mov     [ebp+buffer], eax
.text:00414E46		       jmp     short loc_414E4B
.text:00414E48 ; ---------------------------------------------------------------------------
.text:00414E48
.text:00414E48 loc_414E48:			       ; CODE XREF: __crtGetStringTypeW_stat+E3j
.text:00414E48					       ; __crtGetStringTypeW_stat+E8j
.text:00414E48		       mov     [ebp+buffer], edi
.text:00414E4B
.text:00414E4B loc_414E4B:			       ; CODE XREF: __crtGetStringTypeW_stat+11Ej
.text:00414E4B		       cmp     [ebp+buffer], edi
.text:00414E4E		       jz      loc_414D41
.text:00414E54		       push    esi	       ; count
.text:00414E55		       push    edi	       ; value
.text:00414E56		       push    [ebp+buffer]    ; dst
.text:00414E59		       call    _memset
.text:00414E5E		       add     esp, 0Ch
.text:00414E61		       push    edi	       ; lpUsedDefaultChar
.text:00414E62		       push    edi	       ; lpDefaultChar
.text:00414E63		       push    esi	       ; cbMultiByte
.text:00414E64		       push    [ebp+buffer]    ; lpMultiByteStr
.text:00414E67		       push    [ebp+cchSrc]    ; cchWideChar
.text:00414E6A		       push    [ebp+lpSrcStr]  ; lpWideCharStr
.text:00414E6D		       push    edi	       ; dwFlags
.text:00414E6E		       push    [ebp+code_page] ; CodePage
.text:00414E71		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414E73		       test    eax, eax
.text:00414E75		       jz      error_cleanup_3
.text:00414E7B		       lea     eax, [esi+1]
.text:00414E7E		       cmp     eax, edi
.text:00414E80		       jle     short loc_414EC6
.text:00414E82		       cmp     eax, 7FFFFFF0h
.text:00414E87		       ja      short loc_414EC6
.text:00414E89		       lea     eax, [esi+esi+0Ah]
.text:00414E8D		       cmp     eax, 400h
.text:00414E92		       ja      short loc_414EAE
.text:00414E94		       call    __alloca_probe_16
.text:00414E99		       mov     ebx, esp
.text:00414E9B		       cmp     ebx, edi
.text:00414E9D		       jz      error_cleanup_3
.text:00414EA3		       mov     dword ptr [ebx],	0CCCCh
.text:00414EA9		       add     ebx, 8
.text:00414EAC		       jmp     short loc_414EC8
.text:00414EAE ; ---------------------------------------------------------------------------
.text:00414EAE
.text:00414EAE loc_414EAE:			       ; CODE XREF: __crtGetStringTypeW_stat+16Aj
.text:00414EAE		       push    eax	       ; size
.text:00414EAF		       call    _malloc
.text:00414EB4		       cmp     eax, edi
.text:00414EB6		       pop     ecx
.text:00414EB7		       jz      short loc_414EC2
.text:00414EB9		       mov     dword ptr [eax],	0DDDDh
.text:00414EBF		       add     eax, 8
.text:00414EC2
.text:00414EC2 loc_414EC2:			       ; CODE XREF: __crtGetStringTypeW_stat+18Fj
.text:00414EC2		       mov     ebx, eax
.text:00414EC4		       jmp     short loc_414EC8
.text:00414EC6 ; ---------------------------------------------------------------------------
.text:00414EC6
.text:00414EC6 loc_414EC6:			       ; CODE XREF: __crtGetStringTypeW_stat+158j
.text:00414EC6					       ; __crtGetStringTypeW_stat+15Fj
.text:00414EC6		       xor     ebx, ebx
.text:00414EC8
.text:00414EC8 loc_414EC8:			       ; CODE XREF: __crtGetStringTypeW_stat+184j
.text:00414EC8					       ; __crtGetStringTypeW_stat+19Cj
.text:00414EC8		       cmp     ebx, edi
.text:00414ECA		       jz      short error_cleanup_3
.text:00414ECC		       cmp     [ebp+lcid], edi
.text:00414ECF		       jnz     short loc_414EDC
.text:00414ED1		       mov     eax, [ebp+plocinfo]
.text:00414ED4		       mov     eax, [eax]
.text:00414ED6		       mov     eax, [eax+14h]
.text:00414ED9		       mov     [ebp+lcid], eax
.text:00414EDC
.text:00414EDC loc_414EDC:			       ; CODE XREF: __crtGetStringTypeW_stat+1A7j
.text:00414EDC		       mov     edi, [ebp+cchSrc]
.text:00414EDF		       push    ebx	       ; lpCharType
.text:00414EE0		       push    [ebp+buff_size] ; cchSrc
.text:00414EE3		       add     edi, edi
.text:00414EE5		       push    [ebp+buffer]    ; lpSrcStr
.text:00414EE8		       lea     esi, [edi+ebx]
.text:00414EEB		       push    [ebp+dwInfoType]	; dwInfoType
.text:00414EEE		       or      word ptr	[esi], 0FFFFh
.text:00414EF3		       push    [ebp+lcid]      ; Locale
.text:00414EF6		       or      word ptr	[esi-2], 0FFFFh
.text:00414EFC		       call    ds:__imp__GetStringTypeA@20 ; GetStringTypeA(x,x,x,x,x)
.text:00414F02		       cmp     word ptr	[esi-2], 0FFFFh
.text:00414F08		       mov     [ebp+retbool], eax
.text:00414F0B		       jz      short loc_414F23
.text:00414F0D		       cmp     word ptr	[esi], 0FFFFh
.text:00414F12		       jnz     short loc_414F23
.text:00414F14		       push    edi	       ; count
.text:00414F15		       push    ebx	       ; src
.text:00414F16		       push    [ebp+lpCharType]	; dst
.text:00414F19		       call    _memmove
.text:00414F1E		       add     esp, 0Ch
.text:00414F21		       jmp     short loc_414F27
.text:00414F23 ; ---------------------------------------------------------------------------
.text:00414F23
.text:00414F23 loc_414F23:			       ; CODE XREF: __crtGetStringTypeW_stat+1E3j
.text:00414F23					       ; __crtGetStringTypeW_stat+1EAj
.text:00414F23		       and     [ebp+retbool], 0
.text:00414F27
.text:00414F27 loc_414F27:			       ; CODE XREF: __crtGetStringTypeW_stat+1F9j
.text:00414F27		       push    ebx	       ; _Memory
.text:00414F28		       call    __freea
.text:00414F2D		       pop     ecx
.text:00414F2E
.text:00414F2E error_cleanup_3:			       ; CODE XREF: __crtGetStringTypeW_stat+14Dj
.text:00414F2E					       ; __crtGetStringTypeW_stat+175j	...
.text:00414F2E		       push    [ebp+buffer]    ; _Memory
.text:00414F31		       call    __freea
.text:00414F36		       mov     eax, [ebp+retbool]
.text:00414F39		       pop     ecx
.text:00414F3A
.text:00414F3A loc_414F3A:			       ; CODE XREF: __crtGetStringTypeW_stat+1Bj
.text:00414F3A					       ; __crtGetStringTypeW_stat+79j
.text:00414F3A		       lea     esp, [ebp-1Ch]
.text:00414F3D		       pop     edi
.text:00414F3E		       pop     esi
.text:00414F3F		       pop     ebx
.text:00414F40		       mov     ecx, [ebp+var_4]
.text:00414F43		       xor     ecx, ebp	       ; cookie
.text:00414F45		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00414F4A		       leave
.text:00414F4B		       retn
.text:00414F4B __crtGetStringTypeW_stat	endp
.text:00414F4B
.text:00414F4C
.text:00414F4C ; =============== S U B R O U T I N E =======================================
.text:00414F4C
.text:00414F4C ; Attributes: bp-based frame
.text:00414F4C
.text:00414F4C ; int __cdecl __crtGetStringTypeW(localeinfo_struct *plocinfo, unsigned int dwInfoType, const wchar_t *lpSrcStr,	int cchSrc, unsigned __int16 *lpCharType, int code_page, int lcid)
.text:00414F4C ___crtGetStringTypeW proc near	       ; CODE XREF: __iswctype_l+5Ap
.text:00414F4C					       ; _iswctype+54p
.text:00414F4C
.text:00414F4C _loc_update     = _LocaleUpdate ptr -10h
.text:00414F4C plocinfo	       = dword ptr  8
.text:00414F4C dwInfoType      = dword ptr  0Ch
.text:00414F4C lpSrcStr	       = dword ptr  10h
.text:00414F4C cchSrc	       = dword ptr  14h
.text:00414F4C lpCharType      = dword ptr  18h
.text:00414F4C code_page       = dword ptr  1Ch
.text:00414F4C lcid	       = dword ptr  20h
.text:00414F4C
.text:00414F4C		       push    ebp
.text:00414F4D		       mov     ebp, esp
.text:00414F4F		       sub     esp, 10h
.text:00414F52		       push    [ebp+plocinfo]  ; plocinfo
.text:00414F55		       lea     ecx, [ebp+_loc_update] ;	this
.text:00414F58		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00414F5D		       push    [ebp+lcid]      ; lcid
.text:00414F60		       lea     eax, [ebp+_loc_update]
.text:00414F63		       push    [ebp+code_page] ; code_page
.text:00414F66		       push    [ebp+lpCharType]	; lpCharType
.text:00414F69		       push    [ebp+cchSrc]    ; cchSrc
.text:00414F6C		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:00414F6F		       push    [ebp+dwInfoType]	; dwInfoType
.text:00414F72		       push    eax	       ; plocinfo
.text:00414F73		       call    __crtGetStringTypeW_stat
.text:00414F78		       add     esp, 1Ch
.text:00414F7B		       cmp     [ebp+_loc_update.updated], 0
.text:00414F7F		       jz      short locret_414F88
.text:00414F81		       mov     ecx, [ebp+_loc_update.ptd]
.text:00414F84		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00414F88
.text:00414F88 locret_414F88:			       ; CODE XREF: ___crtGetStringTypeW+33j
.text:00414F88		       leave
.text:00414F89		       retn
.text:00414F89 ___crtGetStringTypeW endp
.text:00414F89
.text:00414F8A
.text:00414F8A ; =============== S U B R O U T I N E =======================================
.text:00414F8A
.text:00414F8A ; Attributes: bp-based frame
.text:00414F8A
.text:00414F8A ; int __cdecl has_osfxsr_set()
.text:00414F8A has_osfxsr_set  proc near	       ; CODE XREF: __get_sse2_info+4Dp
.text:00414F8A
.text:00414F8A ret	       = dword ptr -1Ch
.text:00414F8A ms_exc	       = CPPEH_RECORD ptr -18h
.text:00414F8A
.text:00414F8A		       push    0Ch
.text:00414F8C		       push    offset dword_420A40
.text:00414F91		       call    __SEH_prolog4
.text:00414F96		       and     [ebp+ms_exc.disabled], 0
.text:00414F9A		       movapd  xmm0, xmm1
.text:00414F9E		       mov     [ebp+ret], 1
.text:00414FA5		       jmp     short loc_414FCA
.text:00414FA7 ; ---------------------------------------------------------------------------
.text:00414FA7
.text:00414FA7 $LN7_9:
.text:00414FA7		       mov     eax, [ebp+ms_exc.exc_ptr]
.text:00414FAA		       mov     eax, [eax]
.text:00414FAC		       mov     eax, [eax]
.text:00414FAE		       cmp     eax, 0C0000005h
.text:00414FB3		       jz      short loc_414FBF
.text:00414FB5		       cmp     eax, 0C000001Dh
.text:00414FBA		       jz      short loc_414FBF
.text:00414FBC		       xor     eax, eax
.text:00414FBE		       retn
.text:00414FBF ; ---------------------------------------------------------------------------
.text:00414FBF
.text:00414FBF loc_414FBF:			       ; CODE XREF: has_osfxsr_set+29j
.text:00414FBF					       ; has_osfxsr_set+30j
.text:00414FBF		       xor     eax, eax
.text:00414FC1		       inc     eax
.text:00414FC2
.text:00414FC2 $LN11_8:
.text:00414FC2		       retn
.text:00414FC3 ; ---------------------------------------------------------------------------
.text:00414FC3
.text:00414FC3 $LN8_9:
.text:00414FC3		       mov     esp, [ebp+ms_exc.old_esp]
.text:00414FC6		       and     [ebp+ret], 0
.text:00414FCA
.text:00414FCA loc_414FCA:			       ; CODE XREF: has_osfxsr_set+1Bj
.text:00414FCA		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00414FD1		       mov     eax, [ebp+ret]
.text:00414FD4		       call    __SEH_epilog4
.text:00414FD9		       retn
.text:00414FD9 has_osfxsr_set  endp ; sp-analysis failed
.text:00414FD9
.text:00414FDA
.text:00414FDA ; =============== S U B R O U T I N E =======================================
.text:00414FDA
.text:00414FDA ; Attributes: bp-based frame
.text:00414FDA
.text:00414FDA ; int __cdecl _get_sse2_info()
.text:00414FDA __get_sse2_info proc near	       ; CODE XREF: __sse2_mathfcns_init+7p
.text:00414FDA					       ; ___sse2_available_initp
.text:00414FDA
.text:00414FDA Ident	       = $992A88C5856F6BE6869BBDDAC7BE31AD ptr -18h
.text:00414FDA dwMax	       = dword ptr -0Ch
.text:00414FDA Signature       = dword ptr -8
.text:00414FDA cpu_feature     = dword ptr -4
.text:00414FDA
.text:00414FDA		       push    ebp
.text:00414FDB		       mov     ebp, esp
.text:00414FDD		       sub     esp, 18h
.text:00414FE0		       xor     eax, eax
.text:00414FE2		       push    ebx
.text:00414FE3		       mov     [ebp+cpu_feature], eax
.text:00414FE6		       mov     [ebp+dwMax], eax
.text:00414FE9		       mov     [ebp+Signature],	eax
.text:00414FEC		       push    ebx
.text:00414FED		       pushf
.text:00414FEE		       pop     eax
.text:00414FEF		       mov     ecx, eax
.text:00414FF1		       xor     eax, 200000h
.text:00414FF6		       push    eax
.text:00414FF7		       popf
.text:00414FF8		       pushf
.text:00414FF9		       pop     edx
.text:00414FFA		       sub     edx, ecx
.text:00414FFC		       jz      short DONE
.text:00414FFE		       push    ecx
.text:00414FFF		       popf
.text:00415000		       xor     eax, eax
.text:00415002		       cpuid
.text:00415004		       mov     [ebp+dwMax], eax
.text:00415007		       mov     [ebp+Ident.dw0],	ebx
.text:0041500A		       mov     [ebp+Ident.dw1],	edx
.text:0041500D		       mov     [ebp+Ident.dw2],	ecx
.text:00415010		       mov     eax, 1
.text:00415015		       cpuid
.text:00415017		       mov     [ebp+cpu_feature], edx
.text:0041501A		       mov     [ebp+Signature],	eax
.text:0041501D
.text:0041501D DONE:				       ; CODE XREF: __get_sse2_info+22j
.text:0041501D		       pop     ebx
.text:0041501E		       test    [ebp+cpu_feature], 4000000h
.text:00415025		       jz      short loc_415035
.text:00415027		       call    has_osfxsr_set
.text:0041502C		       test    eax, eax
.text:0041502E		       jz      short loc_415035
.text:00415030		       xor     eax, eax
.text:00415032		       inc     eax
.text:00415033		       jmp     short loc_415037
.text:00415035 ; ---------------------------------------------------------------------------
.text:00415035
.text:00415035 loc_415035:			       ; CODE XREF: __get_sse2_info+4Bj
.text:00415035					       ; __get_sse2_info+54j
.text:00415035		       xor     eax, eax
.text:00415037
.text:00415037 loc_415037:			       ; CODE XREF: __get_sse2_info+59j
.text:00415037		       pop     ebx
.text:00415038		       leave
.text:00415039		       retn
.text:00415039 __get_sse2_info endp
.text:00415039
.text:0041503A
.text:0041503A ; =============== S U B R O U T I N E =======================================
.text:0041503A
.text:0041503A
.text:0041503A ; int __cdecl __sse2_available_init()
.text:0041503A ___sse2_available_init proc near	       ; DATA XREF: .rdata:pinit_3o
.text:0041503A		       call    __get_sse2_info
.text:0041503F		       mov     ___sse2_available, eax
.text:00415044		       xor     eax, eax
.text:00415046		       retn
.text:00415046 ___sse2_available_init endp
.text:00415046
.text:00415046 ; ---------------------------------------------------------------------------
.text:00415047		       align 10h
.text:00415050
.text:00415050 ; =============== S U B R O U T I N E =======================================
.text:00415050
.text:00415050
.text:00415050 __chkstk	       proc near	       ; CODE XREF: __alloca_probe_16+11j
.text:00415050					       ; __alloca_probe_16+27j
.text:00415050		       push    ecx
.text:00415051		       lea     ecx, [esp+4]
.text:00415055		       sub     ecx, eax
.text:00415057		       sbb     eax, eax
.text:00415059		       not     eax
.text:0041505B		       and     ecx, eax
.text:0041505D		       mov     eax, esp
.text:0041505F		       and     eax, 0FFFFF000h
.text:00415064
.text:00415064 cs10:				       ; CODE XREF: __chkstk+29j
.text:00415064		       cmp     ecx, eax
.text:00415066		       jb      short cs20
.text:00415068		       mov     eax, ecx
.text:0041506A		       pop     ecx
.text:0041506B		       xchg    eax, esp
.text:0041506C		       mov     eax, [eax]
.text:0041506E		       mov     [esp+0],	eax
.text:00415071		       retn
.text:00415072 ; ---------------------------------------------------------------------------
.text:00415072
.text:00415072 cs20:				       ; CODE XREF: __chkstk+16j
.text:00415072		       sub     eax, 1000h
.text:00415077		       test    [eax], eax
.text:00415079		       jmp     short cs10
.text:00415079 __chkstk	       endp
.text:00415079
.text:0041507B
.text:0041507B ; =============== S U B R O U T I N E =======================================
.text:0041507B
.text:0041507B
.text:0041507B ___initconin    proc near
.text:0041507B		       xor     eax, eax
.text:0041507D		       push    eax	       ; hTemplateFile
.text:0041507E		       push    eax	       ; dwFlagsAndAttributes
.text:0041507F		       push    3	       ; dwCreationDisposition
.text:00415081		       push    eax	       ; lpSecurityAttributes
.text:00415082		       push    3	       ; dwShareMode
.text:00415084		       push    0C0000000h      ; dwDesiredAccess
.text:00415089		       push    offset FileName ; "CONIN$"
.text:0041508E		       call    ds:__imp__CreateFileA@28	; CreateFileA(x,x,x,x,x,x,x)
.text:00415094		       mov     __coninpfh, eax
.text:00415099		       retn
.text:00415099 ___initconin    endp
.text:00415099
.text:0041509A
.text:0041509A ; =============== S U B R O U T I N E =======================================
.text:0041509A
.text:0041509A
.text:0041509A ___initconout   proc near	       ; CODE XREF: __putwch_nolock+24p
.text:0041509A		       xor     eax, eax
.text:0041509C		       push    eax	       ; hTemplateFile
.text:0041509D		       push    eax	       ; dwFlagsAndAttributes
.text:0041509E		       push    3	       ; dwCreationDisposition
.text:004150A0		       push    eax	       ; lpSecurityAttributes
.text:004150A1		       push    3	       ; dwShareMode
.text:004150A3		       push    40000000h       ; dwDesiredAccess
.text:004150A8		       push    offset aConout  ; "CONOUT$"
.text:004150AD		       call    ds:__imp__CreateFileA@28	; CreateFileA(x,x,x,x,x,x,x)
.text:004150B3		       mov     __confh,	eax
.text:004150B8		       retn
.text:004150B8 ___initconout   endp
.text:004150B8
.text:004150B9
.text:004150B9 ; =============== S U B R O U T I N E =======================================
.text:004150B9
.text:004150B9
.text:004150B9 ___termcon      proc near	       ; DATA XREF: .rdata:ptermo
.text:004150B9		       mov     eax, __confh
.text:004150BE		       cmp     eax, 0FFFFFFFFh
.text:004150C1		       push    esi
.text:004150C2		       mov     esi, ds:__imp__CloseHandle@4 ; CloseHandle(x)
.text:004150C8		       jz      short loc_4150D2
.text:004150CA		       cmp     eax, 0FFFFFFFEh
.text:004150CD		       jz      short loc_4150D2
.text:004150CF		       push    eax	       ; hObject
.text:004150D0		       call    esi ; CloseHandle(x) ; CloseHandle(x)
.text:004150D2
.text:004150D2 loc_4150D2:			       ; CODE XREF: ___termcon+Fj
.text:004150D2					       ; ___termcon+14j
.text:004150D2		       mov     eax, __coninpfh
.text:004150D7		       cmp     eax, 0FFFFFFFFh
.text:004150DA		       jz      short loc_4150E4
.text:004150DC		       cmp     eax, 0FFFFFFFEh
.text:004150DF		       jz      short loc_4150E4
.text:004150E1		       push    eax	       ; hObject
.text:004150E2		       call    esi ; CloseHandle(x) ; CloseHandle(x)
.text:004150E4
.text:004150E4 loc_4150E4:			       ; CODE XREF: ___termcon+21j
.text:004150E4					       ; ___termcon+26j
.text:004150E4		       pop     esi
.text:004150E5		       retn
.text:004150E5 ___termcon      endp
.text:004150E5
.text:004150E6
.text:004150E6 ; =============== S U B R O U T I N E =======================================
.text:004150E6
.text:004150E6
.text:004150E6 ; unsigned int __cdecl wcslen(const wchar_t *wcs)
.text:004150E6 _wcslen	       proc near	       ; CODE XREF: __cputws+44p
.text:004150E6
.text:004150E6 wcs	       = dword ptr  4
.text:004150E6
.text:004150E6		       mov     eax, [esp+wcs]
.text:004150EA
.text:004150EA loc_4150EA:			       ; CODE XREF: _wcslen+Cj
.text:004150EA		       mov     cx, [eax]
.text:004150ED		       inc     eax
.text:004150EE		       inc     eax
.text:004150EF		       test    cx, cx
.text:004150F2		       jnz     short loc_4150EA
.text:004150F4		       sub     eax, [esp+wcs]
.text:004150F8		       sar     eax, 1
.text:004150FA		       dec     eax
.text:004150FB		       retn
.text:004150FB _wcslen	       endp
.text:004150FB
.text:004150FC
.text:004150FC ; =============== S U B R O U T I N E =======================================
.text:004150FC
.text:004150FC
.text:004150FC ; const char *__cdecl _getenv_helper_nolock(const char *option)
.text:004150FC __getenv_helper_nolock proc near	       ; CODE XREF: _tzset_nolock+A6p
.text:004150FC					       ; _getenv_s_helper+47p ...
.text:004150FC
.text:004150FC option	       = dword ptr  4
.text:004150FC
.text:004150FC		       cmp     ___env_initialized, 0
.text:00415103		       push    esi
.text:00415104		       mov     esi, __environ
.text:0041510A		       jnz     short loc_415110
.text:0041510C		       xor     eax, eax
.text:0041510E		       pop     esi
.text:0041510F		       retn
.text:00415110 ; ---------------------------------------------------------------------------
.text:00415110
.text:00415110 loc_415110:			       ; CODE XREF: __getenv_helper_nolock+Ej
.text:00415110		       test    esi, esi
.text:00415112		       push    ebx
.text:00415113		       push    edi
.text:00415114		       jnz     short loc_415131
.text:00415116		       cmp     __wenviron, esi
.text:0041511C		       jz      short loc_41516F
.text:0041511E		       call    ___wtomb_environ
.text:00415123		       test    eax, eax
.text:00415125		       jnz     short loc_41516F
.text:00415127		       mov     esi, __environ
.text:0041512D		       test    esi, esi
.text:0041512F		       jz      short loc_41516F
.text:00415131
.text:00415131 loc_415131:			       ; CODE XREF: __getenv_helper_nolock+18j
.text:00415131		       mov     ebx, [esp+0Ch+option]
.text:00415135		       test    ebx, ebx
.text:00415137		       jz      short loc_41516F
.text:00415139		       push    ebx	       ; buf
.text:0041513A		       call    _strlen
.text:0041513F		       pop     ecx
.text:00415140		       mov     edi, eax
.text:00415142		       jmp     short loc_415169
.text:00415144 ; ---------------------------------------------------------------------------
.text:00415144
.text:00415144 loc_415144:			       ; CODE XREF: __getenv_helper_nolock+71j
.text:00415144		       push    eax	       ; buf
.text:00415145		       call    _strlen
.text:0041514A		       cmp     eax, edi
.text:0041514C		       pop     ecx
.text:0041514D		       jbe     short loc_415166
.text:0041514F		       mov     eax, [esi]
.text:00415151		       cmp     byte ptr	[eax+edi], 3Dh
.text:00415155		       jnz     short loc_415166
.text:00415157		       push    edi	       ; n
.text:00415158		       push    ebx	       ; s2
.text:00415159		       push    eax	       ; s1
.text:0041515A		       call    __mbsnbicoll
.text:0041515F		       add     esp, 0Ch
.text:00415162		       test    eax, eax
.text:00415164		       jz      short loc_415175
.text:00415166
.text:00415166 loc_415166:			       ; CODE XREF: __getenv_helper_nolock+51j
.text:00415166					       ; __getenv_helper_nolock+59j
.text:00415166		       add     esi, 4
.text:00415169
.text:00415169 loc_415169:			       ; CODE XREF: __getenv_helper_nolock+46j
.text:00415169		       mov     eax, [esi]
.text:0041516B		       test    eax, eax
.text:0041516D		       jnz     short loc_415144
.text:0041516F
.text:0041516F loc_41516F:			       ; CODE XREF: __getenv_helper_nolock+20j
.text:0041516F					       ; __getenv_helper_nolock+29j ...
.text:0041516F		       xor     eax, eax
.text:00415171
.text:00415171 loc_415171:			       ; CODE XREF: __getenv_helper_nolock+7Fj
.text:00415171		       pop     edi
.text:00415172		       pop     ebx
.text:00415173		       pop     esi
.text:00415174		       retn
.text:00415175 ; ---------------------------------------------------------------------------
.text:00415175
.text:00415175 loc_415175:			       ; CODE XREF: __getenv_helper_nolock+68j
.text:00415175		       mov     eax, [esi]
.text:00415177		       lea     eax, [eax+edi+1]
.text:0041517B		       jmp     short loc_415171
.text:0041517B __getenv_helper_nolock endp
.text:0041517B
.text:0041517D
.text:0041517D ; =============== S U B R O U T I N E =======================================
.text:0041517D
.text:0041517D ; Attributes: bp-based frame
.text:0041517D
.text:0041517D ; int __usercall	getenv_s_helper<eax>(unsigned int *pReturnValue<eax>, char *buffer, unsigned int sizeInTChars, const char *varname)
.text:0041517D _getenv_s_helper	proc near
.text:0041517D
.text:0041517D buffer	       = dword ptr  8
.text:0041517D sizeInTChars    = dword ptr  0Ch
.text:0041517D varname	       = dword ptr  10h
.text:0041517D
.text:0041517D pReturnValue = eax
.text:0041517D		       push    ebp
.text:0041517E		       mov     ebp, esp
.text:00415180		       push    ebx
.text:00415181		       push    esi
.text:00415182		       mov     esi, pReturnValue
.text:00415184		       xor     ebx, ebx
.text:00415186		       cmp     esi, ebx
.text:00415188		       jnz     short loc_4151A5
.text:0041518A
.text:0041518A loc_41518A:			       ; CODE XREF: _getenv_s_helper+36j
.text:0041518A					       ; _getenv_s_helper+3Bj
.text:0041518A		       call    __errno
.text:0041518F		       push    16h
.text:00415191		       pop     esi
.text:00415192		       push    ebx	       ; pReserved
.text:00415193		       push    ebx	       ; nLine
.text:00415194		       push    ebx	       ; pszFile
.text:00415195		       push    ebx	       ; pszFunction
.text:00415196		       push    ebx	       ; pszExpression
.text:00415197		       mov     [pReturnValue], esi
.text:00415199		       call    __invalid_parameter
.text:0041519E		       add     esp, 14h
.text:004151A1		       mov     pReturnValue, esi
.text:004151A3		       jmp     short loc_41520C
.text:004151A5 ; ---------------------------------------------------------------------------
.text:004151A5
.text:004151A5 loc_4151A5:			       ; CODE XREF: _getenv_s_helper+Bj
.text:004151A5		       mov     pReturnValue, [ebp+buffer]
.text:004151A8		       cmp     pReturnValue, ebx
.text:004151AA		       mov     [esi], ebx
.text:004151AC		       jz      short loc_4151B5
.text:004151AE		       cmp     [ebp+sizeInTChars], ebx
.text:004151B1		       ja      short loc_4151BA
.text:004151B3		       jmp     short loc_41518A
.text:004151B5 ; ---------------------------------------------------------------------------
.text:004151B5
.text:004151B5 loc_4151B5:			       ; CODE XREF: _getenv_s_helper+2Fj
.text:004151B5		       cmp     [ebp+sizeInTChars], ebx
.text:004151B8		       jnz     short loc_41518A
.text:004151BA
.text:004151BA loc_4151BA:			       ; CODE XREF: _getenv_s_helper+34j
.text:004151BA		       cmp     pReturnValue, ebx
.text:004151BC		       jz      short loc_4151C0
.text:004151BE		       mov     [pReturnValue], bl
.text:004151C0
.text:004151C0 loc_4151C0:			       ; CODE XREF: _getenv_s_helper+3Fj
.text:004151C0		       push    edi
.text:004151C1		       push    [ebp+varname]   ; option
.text:004151C4		       call    __getenv_helper_nolock
.text:004151C9		       mov     edi, pReturnValue
.text:004151CB		       cmp     edi, ebx
.text:004151CD		       pop     ecx
.text:004151CE		       jz      short loc_415209
.text:004151D0		       push    edi	       ; buf
.text:004151D1		       call    _strlen
.text:004151D6		       inc     pReturnValue
.text:004151D7		       cmp     [ebp+sizeInTChars], ebx
.text:004151DA		       pop     ecx
.text:004151DB		       mov     [esi], pReturnValue
.text:004151DD		       jz      short loc_415209
.text:004151DF		       cmp     pReturnValue, [ebp+sizeInTChars]
.text:004151E2		       jbe     short loc_4151E9
.text:004151E4		       push    22h
.text:004151E6		       pop     pReturnValue
.text:004151E7		       jmp     short loc_41520B
.text:004151E9 ; ---------------------------------------------------------------------------
.text:004151E9
.text:004151E9 loc_4151E9:			       ; CODE XREF: _getenv_s_helper+65j
.text:004151E9		       push    edi	       ; _Src
.text:004151EA		       push    [ebp+sizeInTChars] ; _SizeInBytes
.text:004151ED		       push    [ebp+buffer]    ; _Dst
.text:004151F0		       call    _strcpy_s
.text:004151F5		       add     esp, 0Ch
.text:004151F8		       test    pReturnValue, pReturnValue
.text:004151FA		       jz      short loc_415209
.text:004151FC		       push    ebx	       ; pReserved
.text:004151FD		       push    ebx	       ; nLine
.text:004151FE		       push    ebx	       ; pszFile
.text:004151FF		       push    ebx	       ; pszFunction
.text:00415200		       push    ebx	       ; pszExpression
.text:00415201		       call    __invoke_watson
.text:00415206		       add     esp, 14h
.text:00415209
.text:00415209 loc_415209:			       ; CODE XREF: _getenv_s_helper+51j
.text:00415209					       ; _getenv_s_helper+60j ...
.text:00415209		       xor     pReturnValue, pReturnValue
.text:0041520B
.text:0041520B loc_41520B:			       ; CODE XREF: _getenv_s_helper+6Aj
.text:0041520B		       pop     edi
.text:0041520C
.text:0041520C loc_41520C:			       ; CODE XREF: _getenv_s_helper+26j
.text:0041520C		       pop     esi
.text:0041520D		       pop     ebx
.text:0041520E		       pop     ebp
.text:0041520F		       retn
.text:0041520F _getenv_s_helper	endp
.text:0041520F
.text:00415210
.text:00415210 ; =============== S U B R O U T I N E =======================================
.text:00415210
.text:00415210 ; Attributes: bp-based frame
.text:00415210
.text:00415210 ; int __usercall	dupenv_s_helper<eax>(char **pBuffer<ebx>, unsigned int *pBufferSizeInTChars, const char	*varname)
.text:00415210 _dupenv_s_helper	proc near
.text:00415210
.text:00415210 str	       = dword ptr -4
.text:00415210 pBufferSizeInTChars= dword ptr  8
.text:00415210 varname	       = dword ptr  0Ch
.text:00415210
.text:00415210 pBuffer = ebx
.text:00415210		       push    ebp
.text:00415211		       mov     ebp, esp
.text:00415213		       push    ecx
.text:00415214		       push    esi
.text:00415215		       push    edi
.text:00415216		       xor     edi, edi
.text:00415218		       cmp     pBuffer,	edi
.text:0041521A		       jnz     short loc_415237
.text:0041521C
.text:0041521C loc_41521C:			       ; CODE XREF: _dupenv_s_helper+35j
.text:0041521C		       call    __errno
.text:00415221		       push    16h
.text:00415223		       pop     esi
.text:00415224		       push    edi	       ; pReserved
.text:00415225		       push    edi	       ; nLine
.text:00415226		       push    edi	       ; pszFile
.text:00415227		       push    edi	       ; pszFunction
.text:00415228		       push    edi	       ; pszExpression
.text:00415229		       mov     [eax], esi
.text:0041522B		       call    __invalid_parameter
.text:00415230		       add     esp, 14h
.text:00415233		       mov     eax, esi
.text:00415235		       jmp     short loc_4152AE
.text:00415237 ; ---------------------------------------------------------------------------
.text:00415237
.text:00415237 loc_415237:			       ; CODE XREF: _dupenv_s_helper+Aj
.text:00415237		       mov     eax, [ebp+pBufferSizeInTChars]
.text:0041523A		       cmp     eax, edi
.text:0041523C		       mov     [pBuffer], edi
.text:0041523E		       jz      short loc_415242
.text:00415240		       mov     [eax], edi
.text:00415242
.text:00415242 loc_415242:			       ; CODE XREF: _dupenv_s_helper+2Ej
.text:00415242		       cmp     [ebp+varname], edi
.text:00415245		       jz      short loc_41521C
.text:00415247		       push    [ebp+varname]   ; option
.text:0041524A		       call    __getenv_helper_nolock
.text:0041524F		       cmp     eax, edi
.text:00415251		       pop     ecx
.text:00415252		       mov     [ebp+str], eax
.text:00415255		       jz      short loc_4152AC
.text:00415257		       push    eax	       ; buf
.text:00415258		       call    _strlen
.text:0041525D		       mov     esi, eax
.text:0041525F		       inc     esi
.text:00415260		       push    1	       ; size
.text:00415262		       push    esi	       ; num
.text:00415263		       call    _calloc
.text:00415268		       add     esp, 0Ch
.text:0041526B		       cmp     eax, edi
.text:0041526D		       mov     [pBuffer], eax
.text:0041526F		       jnz     short loc_415285
.text:00415271		       call    __errno
.text:00415276		       mov     dword ptr [eax],	0Ch
.text:0041527C		       call    __errno
.text:00415281		       mov     eax, [eax]
.text:00415283		       jmp     short loc_4152AE
.text:00415285 ; ---------------------------------------------------------------------------
.text:00415285
.text:00415285 loc_415285:			       ; CODE XREF: _dupenv_s_helper+5Fj
.text:00415285		       push    [ebp+str]       ; _Src
.text:00415288		       push    esi	       ; _SizeInBytes
.text:00415289		       push    eax	       ; _Dst
.text:0041528A		       call    _strcpy_s
.text:0041528F		       add     esp, 0Ch
.text:00415292		       test    eax, eax
.text:00415294		       jz      short loc_4152A3
.text:00415296		       push    edi	       ; pReserved
.text:00415297		       push    edi	       ; nLine
.text:00415298		       push    edi	       ; pszFile
.text:00415299		       push    edi	       ; pszFunction
.text:0041529A		       push    edi	       ; pszExpression
.text:0041529B		       call    __invoke_watson
.text:004152A0		       add     esp, 14h
.text:004152A3
.text:004152A3 loc_4152A3:			       ; CODE XREF: _dupenv_s_helper+84j
.text:004152A3		       mov     eax, [ebp+pBufferSizeInTChars]
.text:004152A6		       cmp     eax, edi
.text:004152A8		       jz      short loc_4152AC
.text:004152AA		       mov     [eax], esi
.text:004152AC
.text:004152AC loc_4152AC:			       ; CODE XREF: _dupenv_s_helper+45j
.text:004152AC					       ; _dupenv_s_helper+98j
.text:004152AC		       xor     eax, eax
.text:004152AE
.text:004152AE loc_4152AE:			       ; CODE XREF: _dupenv_s_helper+25j
.text:004152AE					       ; _dupenv_s_helper+73j
.text:004152AE		       pop     edi
.text:004152AF		       pop     esi
.text:004152B0		       leave
.text:004152B1		       retn
.text:004152B1 _dupenv_s_helper	endp
.text:004152B1
.text:004152B2
.text:004152B2 ; =============== S U B R O U T I N E =======================================
.text:004152B2
.text:004152B2 ; Attributes: bp-based frame
.text:004152B2
.text:004152B2 ; char *__cdecl getenv(const char *option)
.text:004152B2 _getenv	       proc near
.text:004152B2
.text:004152B2 _Expr_val       = dword ptr -20h
.text:004152B2 retval	       = dword ptr -1Ch
.text:004152B2 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004152B2 option	       = dword ptr  8
.text:004152B2
.text:004152B2		       push    10h
.text:004152B4		       push    offset dword_420A60
.text:004152B9		       call    __SEH_prolog4
.text:004152BE		       xor     eax, eax
.text:004152C0		       xor     esi, esi
.text:004152C2		       cmp     [ebp+option], esi
.text:004152C5		       setnz   al
.text:004152C8		       cmp     eax, esi
.text:004152CA		       jnz     short loc_4152E8
.text:004152CC
.text:004152CC loc_4152CC:			       ; CODE XREF: _getenv+4Cj
.text:004152CC		       call    __errno
.text:004152D1		       mov     dword ptr [eax],	16h
.text:004152D7		       push    esi	       ; pReserved
.text:004152D8		       push    esi	       ; nLine
.text:004152D9		       push    esi	       ; pszFile
.text:004152DA		       push    esi	       ; pszFunction
.text:004152DB		       push    esi	       ; pszExpression
.text:004152DC		       call    __invalid_parameter
.text:004152E1		       add     esp, 14h
.text:004152E4		       xor     eax, eax
.text:004152E6		       jmp     short loc_415326
.text:004152E8 ; ---------------------------------------------------------------------------
.text:004152E8
.text:004152E8 loc_4152E8:			       ; CODE XREF: _getenv+18j
.text:004152E8		       mov     edi, 7FFFh
.text:004152ED		       push    edi	       ; maxsize
.text:004152EE		       push    [ebp+option]    ; str
.text:004152F1		       call    _strnlen
.text:004152F6		       pop     ecx
.text:004152F7		       pop     ecx
.text:004152F8		       cmp     eax, edi
.text:004152FA		       sbb     eax, eax
.text:004152FC		       neg     eax
.text:004152FE		       jz      short loc_4152CC
.text:00415300		       push    7	       ; locknum
.text:00415302		       call    __lock
.text:00415307		       pop     ecx
.text:00415308		       mov     [ebp+ms_exc.disabled], esi
.text:0041530B		       push    [ebp+option]    ; option
.text:0041530E		       call    __getenv_helper_nolock
.text:00415313		       pop     ecx
.text:00415314		       mov     [ebp+retval], eax
.text:00415317		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0041531E		       call    $LN7_10
.text:00415323
.text:00415323 $LN10_9:
.text:00415323		       mov     eax, [ebp+retval]
.text:00415326
.text:00415326 loc_415326:			       ; CODE XREF: _getenv+34j
.text:00415326		       call    __SEH_epilog4
.text:0041532B		       retn
.text:0041532C ; ---------------------------------------------------------------------------
.text:0041532C
.text:0041532C $LN7_10:				       ; CODE XREF: _getenv+6Cp
.text:0041532C					       ; DATA XREF: .rdata:00420A78o
.text:0041532C		       push    7	       ; locknum
.text:0041532E		       call    __unlock
.text:00415333		       pop     ecx
.text:00415334
.text:00415334 $LN8_10:
.text:00415334		       retn
.text:00415334 _getenv	       endp
.text:00415334
.text:00415335
.text:00415335 ; =============== S U B R O U T I N E =======================================
.text:00415335
.text:00415335 ; Attributes: noreturn bp-based frame
.text:00415335
.text:00415335 ; int __cdecl getenv_s(unsigned int *pReturnValue, char *buffer,	unsigned int sizeInTChars, const char *varname)
.text:00415335 _getenv_s       proc near
.text:00415335
.text:00415335 retval	       = dword ptr -1Ch
.text:00415335 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00415335 pReturnValue    = dword ptr  8
.text:00415335 buffer	       = dword ptr  0Ch
.text:00415335 sizeInTChars    = dword ptr  10h
.text:00415335 varname	       = dword ptr  14h
.text:00415335
.text:00415335		       push    0Ch
.text:00415337		       push    offset dword_420A80
.text:0041533C		       call    __SEH_prolog4
.text:00415341		       push    7	       ; locknum
.text:00415343		       call    __lock
.text:00415348		       pop     ecx
.text:00415349		       xor     ebx, ebx
.text:0041534B		       mov     [ebp+ms_exc.disabled], ebx
.text:0041534E		       xor     eax, eax
.text:00415350		       mov     edi, [ebp+pReturnValue]
.text:00415353		       cmp     edi, ebx
.text:00415355		       setnz   al
.text:00415358		       cmp     eax, ebx
.text:0041535A		       jnz     short loc_415378
.text:0041535C
.text:0041535C loc_41535C:			       ; CODE XREF: _getenv_s+63j
.text:0041535C		       call    __errno
.text:00415361		       push    16h
.text:00415363		       pop     esi
.text:00415364		       mov     [eax], esi
.text:00415366		       push    ebx	       ; pReserved
.text:00415367		       push    ebx	       ; nLine
.text:00415368		       push    ebx	       ; pszFile
.text:00415369		       push    ebx	       ; pszFunction
.text:0041536A		       push    ebx	       ; pszExpression
.text:0041536B		       call    __invalid_parameter
.text:00415370		       add     esp, 14h
.text:00415373		       mov     [ebp+retval], esi
.text:00415376		       jmp     short loc_4153EF
.text:00415378 ; ---------------------------------------------------------------------------
.text:00415378
.text:00415378 loc_415378:			       ; CODE XREF: _getenv_s+25j
.text:00415378		       mov     [edi], ebx
.text:0041537A		       mov     ecx, [ebp+buffer]
.text:0041537D		       cmp     ecx, ebx
.text:0041537F		       jz      short loc_41538A
.text:00415381		       cmp     [ebp+sizeInTChars], ebx
.text:00415384		       ja      short loc_41538F
.text:00415386		       cmp     ecx, ebx
.text:00415388		       jnz     short loc_415394
.text:0041538A
.text:0041538A loc_41538A:			       ; CODE XREF: _getenv_s+4Aj
.text:0041538A		       cmp     [ebp+sizeInTChars], ebx
.text:0041538D		       jnz     short loc_415394
.text:0041538F
.text:0041538F loc_41538F:			       ; CODE XREF: _getenv_s+4Fj
.text:0041538F		       xor     eax, eax
.text:00415391		       inc     eax
.text:00415392		       jmp     short loc_415396
.text:00415394 ; ---------------------------------------------------------------------------
.text:00415394
.text:00415394 loc_415394:			       ; CODE XREF: _getenv_s+53j
.text:00415394					       ; _getenv_s+58j
.text:00415394		       xor     eax, eax
.text:00415396
.text:00415396 loc_415396:			       ; CODE XREF: _getenv_s+5Dj
.text:00415396		       cmp     eax, ebx
.text:00415398		       jz      short loc_41535C
.text:0041539A		       cmp     ecx, ebx
.text:0041539C		       jz      short loc_4153A0
.text:0041539E		       mov     [ecx], bl
.text:004153A0
.text:004153A0 loc_4153A0:			       ; CODE XREF: _getenv_s+67j
.text:004153A0		       push    [ebp+varname]   ; option
.text:004153A3		       call    __getenv_helper_nolock
.text:004153A8		       pop     ecx
.text:004153A9		       mov     esi, eax
.text:004153AB		       cmp     esi, ebx
.text:004153AD		       jz      short loc_4153EC
.text:004153AF		       push    esi	       ; buf
.text:004153B0		       call    _strlen
.text:004153B5		       pop     ecx
.text:004153B6		       inc     eax
.text:004153B7		       mov     [edi], eax
.text:004153B9		       cmp     [ebp+sizeInTChars], ebx
.text:004153BC		       jz      short loc_4153EC
.text:004153BE		       cmp     eax, [ebp+sizeInTChars]
.text:004153C1		       jbe     short loc_4153CC
.text:004153C3		       mov     [ebp+retval], 22h
.text:004153CA		       jmp     short loc_4153EF
.text:004153CC ; ---------------------------------------------------------------------------
.text:004153CC
.text:004153CC loc_4153CC:			       ; CODE XREF: _getenv_s+8Cj
.text:004153CC		       push    esi	       ; _Src
.text:004153CD		       push    [ebp+sizeInTChars] ; _SizeInBytes
.text:004153D0		       push    [ebp+buffer]    ; _Dst
.text:004153D3		       call    _strcpy_s
.text:004153D8		       add     esp, 0Ch
.text:004153DB		       cmp     eax, ebx
.text:004153DD		       jz      short loc_4153EC
.text:004153DF		       push    ebx	       ; pReserved
.text:004153E0		       push    ebx	       ; nLine
.text:004153E1		       push    ebx	       ; pszFile
.text:004153E2		       push    ebx	       ; pszFunction
.text:004153E3		       push    ebx	       ; pszExpression
.text:004153E4		       call    __invoke_watson
.text:004153E9		       add     esp, 14h
.text:004153EC
.text:004153EC loc_4153EC:			       ; CODE XREF: _getenv_s+78j
.text:004153EC					       ; _getenv_s+87j	...
.text:004153EC		       mov     [ebp+retval], ebx
.text:004153EF
.text:004153EF loc_4153EF:			       ; CODE XREF: _getenv_s+41j
.text:004153EF					       ; _getenv_s+95j
.text:004153EF		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004153F6		       call    $LN5_3
.text:004153FB ; ---------------------------------------------------------------------------
.text:004153FB
.text:004153FB $LN8_11:
.text:004153FB		       mov     eax, [ebp+retval]
.text:004153FE		       call    __SEH_epilog4
.text:00415403		       retn
.text:00415404 ; ---------------------------------------------------------------------------
.text:00415404
.text:00415404 $LN5_3:				       ; CODE XREF: _getenv_s+C1p
.text:00415404					       ; DATA XREF: .rdata:00420A98o
.text:00415404		       push    7	       ; locknum
.text:00415406		       call    __unlock
.text:0041540B		       pop     ecx
.text:0041540C
.text:0041540C $LN6_11:
.text:0041540C		       retn
.text:0041540C _getenv_s       endp
.text:0041540C
.text:0041540D
.text:0041540D ; =============== S U B R O U T I N E =======================================
.text:0041540D
.text:0041540D ; Attributes: noreturn bp-based frame
.text:0041540D
.text:0041540D ; int __cdecl _dupenv_s(char **pBuffer, unsigned	int *pBufferSizeInTChars, const	char *varname)
.text:0041540D __dupenv_s      proc near
.text:0041540D
.text:0041540D _Src	       = dword ptr -20h
.text:0041540D retval	       = dword ptr -1Ch
.text:0041540D ms_exc	       = CPPEH_RECORD ptr -18h
.text:0041540D pBuffer	       = dword ptr  8
.text:0041540D pBufferSizeInTChars= dword ptr  0Ch
.text:0041540D varname	       = dword ptr  10h
.text:0041540D
.text:0041540D		       push    10h
.text:0041540F		       push    offset dword_420AA0
.text:00415414		       call    __SEH_prolog4
.text:00415419		       push    7	       ; locknum
.text:0041541B		       call    __lock
.text:00415420		       pop     ecx
.text:00415421		       xor     esi, esi
.text:00415423		       mov     [ebp+ms_exc.disabled], esi
.text:00415426		       xor     eax, eax
.text:00415428		       mov     ebx, [ebp+pBuffer]
.text:0041542B		       cmp     ebx, esi
.text:0041542D		       setnz   al
.text:00415430		       cmp     eax, esi
.text:00415432		       jnz     short loc_415453
.text:00415434
.text:00415434 loc_415434:			       ; CODE XREF: __dupenv_s+5Bj
.text:00415434		       call    __errno
.text:00415439		       push    16h
.text:0041543B		       pop     edi
.text:0041543C		       mov     [eax], edi
.text:0041543E		       push    esi	       ; pReserved
.text:0041543F		       push    esi	       ; nLine
.text:00415440		       push    esi	       ; pszFile
.text:00415441		       push    esi	       ; pszFunction
.text:00415442		       push    esi	       ; pszExpression
.text:00415443		       call    __invalid_parameter
.text:00415448		       add     esp, 14h
.text:0041544B		       mov     [ebp+retval], edi
.text:0041544E		       jmp     loc_4154D5
.text:00415453 ; ---------------------------------------------------------------------------
.text:00415453
.text:00415453 loc_415453:			       ; CODE XREF: __dupenv_s+25j
.text:00415453		       mov     [ebx], esi
.text:00415455		       mov     eax, [ebp+pBufferSizeInTChars]
.text:00415458		       cmp     eax, esi
.text:0041545A		       jz      short loc_41545E
.text:0041545C		       mov     [eax], esi
.text:0041545E
.text:0041545E loc_41545E:			       ; CODE XREF: __dupenv_s+4Dj
.text:0041545E		       xor     eax, eax
.text:00415460		       cmp     [ebp+varname], esi
.text:00415463		       setnz   al
.text:00415466		       cmp     eax, esi
.text:00415468		       jz      short loc_415434
.text:0041546A		       push    [ebp+varname]   ; option
.text:0041546D		       call    __getenv_helper_nolock
.text:00415472		       pop     ecx
.text:00415473		       mov     [ebp+_Src], eax
.text:00415476		       cmp     eax, esi
.text:00415478		       jz      short loc_4154D2
.text:0041547A		       push    eax	       ; buf
.text:0041547B		       call    _strlen
.text:00415480		       mov     edi, eax
.text:00415482		       inc     edi
.text:00415483		       push    1	       ; size
.text:00415485		       push    edi	       ; num
.text:00415486		       call    _calloc
.text:0041548B		       add     esp, 0Ch
.text:0041548E		       mov     [ebx], eax
.text:00415490		       cmp     eax, esi
.text:00415492		       jnz     short loc_4154AB
.text:00415494		       call    __errno
.text:00415499		       mov     dword ptr [eax],	0Ch
.text:0041549F		       call    __errno
.text:004154A4		       mov     eax, [eax]
.text:004154A6		       mov     [ebp+retval], eax
.text:004154A9		       jmp     short loc_4154D5
.text:004154AB ; ---------------------------------------------------------------------------
.text:004154AB
.text:004154AB loc_4154AB:			       ; CODE XREF: __dupenv_s+85j
.text:004154AB		       push    [ebp+_Src]      ; _Src
.text:004154AE		       push    edi	       ; _SizeInBytes
.text:004154AF		       push    eax	       ; _Dst
.text:004154B0		       call    _strcpy_s
.text:004154B5		       add     esp, 0Ch
.text:004154B8		       cmp     eax, esi
.text:004154BA		       jz      short loc_4154C9
.text:004154BC		       push    esi	       ; pReserved
.text:004154BD		       push    esi	       ; nLine
.text:004154BE		       push    esi	       ; pszFile
.text:004154BF		       push    esi	       ; pszFunction
.text:004154C0		       push    esi	       ; pszExpression
.text:004154C1		       call    __invoke_watson
.text:004154C6		       add     esp, 14h
.text:004154C9
.text:004154C9 loc_4154C9:			       ; CODE XREF: __dupenv_s+ADj
.text:004154C9		       mov     eax, [ebp+pBufferSizeInTChars]
.text:004154CC		       cmp     eax, esi
.text:004154CE		       jz      short loc_4154D2
.text:004154D0		       mov     [eax], edi
.text:004154D2
.text:004154D2 loc_4154D2:			       ; CODE XREF: __dupenv_s+6Bj
.text:004154D2					       ; __dupenv_s+C1j
.text:004154D2		       mov     [ebp+retval], esi
.text:004154D5
.text:004154D5 loc_4154D5:			       ; CODE XREF: __dupenv_s+41j
.text:004154D5					       ; __dupenv_s+9Cj
.text:004154D5		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004154DC		       call    $LN5_4
.text:004154E1 ; ---------------------------------------------------------------------------
.text:004154E1
.text:004154E1 $LN8_12:
.text:004154E1		       mov     eax, [ebp+retval]
.text:004154E4		       call    __SEH_epilog4
.text:004154E9		       retn
.text:004154EA ; ---------------------------------------------------------------------------
.text:004154EA
.text:004154EA $LN5_4:				       ; CODE XREF: __dupenv_s+CFp
.text:004154EA					       ; DATA XREF: .rdata:00420AB8o
.text:004154EA		       push    7	       ; locknum
.text:004154EC		       call    __unlock
.text:004154F1		       pop     ecx
.text:004154F2
.text:004154F2 $LN6_12:
.text:004154F2		       retn
.text:004154F2 __dupenv_s      endp
.text:004154F2
.text:004154F3
.text:004154F3 ; =============== S U B R O U T I N E =======================================
.text:004154F3
.text:004154F3
.text:004154F3 ; int __cdecl _tolower(int c)
.text:004154F3 __tolower       proc near
.text:004154F3
.text:004154F3 c	       = dword ptr  4
.text:004154F3
.text:004154F3		       mov     eax, [esp+c]
.text:004154F7		       add     eax, 20h
.text:004154FA		       retn
.text:004154FA __tolower       endp
.text:004154FA
.text:004154FB
.text:004154FB ; =============== S U B R O U T I N E =======================================
.text:004154FB
.text:004154FB ; Attributes: bp-based frame
.text:004154FB
.text:004154FB ; int __cdecl _tolower_l(int c, localeinfo_struct *plocinfo)
.text:004154FB __tolower_l     proc near	       ; CODE XREF: __stricmp_l+9Bp
.text:004154FB					       ; __stricmp_l+ADp ...
.text:004154FB
.text:004154FB _loc_update     = _LocaleUpdate ptr -18h
.text:004154FB outbuffer       = byte ptr -8
.text:004154FB inbuffer	       = byte ptr -4
.text:004154FB c	       = dword ptr  8
.text:004154FB plocinfo	       = dword ptr  0Ch
.text:004154FB
.text:004154FB		       push    ebp
.text:004154FC		       mov     ebp, esp
.text:004154FE		       sub     esp, 18h
.text:00415501		       push    ebx
.text:00415502		       push    esi
.text:00415503		       push    [ebp+plocinfo]  ; plocinfo
.text:00415506		       lea     ecx, [ebp+_loc_update] ;	this
.text:00415509		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0041550E		       mov     ebx, [ebp+c]
.text:00415511		       mov     esi, 100h
.text:00415516		       cmp     ebx, esi
.text:00415518		       jnb     short loc_41556E
.text:0041551A		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:0041551D		       cmp     dword ptr [ecx+0ACh], 1
.text:00415524		       jle     short loc_41553A
.text:00415526		       lea     eax, [ebp+_loc_update]
.text:00415529		       push    eax	       ; plocinfo
.text:0041552A		       push    1	       ; mask
.text:0041552C		       push    ebx	       ; c
.text:0041552D		       call    __isctype_l
.text:00415532		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:00415535		       add     esp, 0Ch
.text:00415538		       jmp     short loc_415547
.text:0041553A ; ---------------------------------------------------------------------------
.text:0041553A
.text:0041553A loc_41553A:			       ; CODE XREF: __tolower_l+29j
.text:0041553A		       mov     eax, [ecx+0C8h]
.text:00415540		       movzx   eax, byte ptr [eax+ebx*2]
.text:00415544		       and     eax, 1
.text:00415547
.text:00415547 loc_415547:			       ; CODE XREF: __tolower_l+3Dj
.text:00415547		       test    eax, eax
.text:00415549		       jz      short loc_41555A
.text:0041554B		       mov     eax, [ecx+0CCh]
.text:00415551		       movzx   eax, byte ptr [eax+ebx]
.text:00415555		       jmp     loc_415601
.text:0041555A ; ---------------------------------------------------------------------------
.text:0041555A
.text:0041555A loc_41555A:			       ; CODE XREF: __tolower_l+4Ej
.text:0041555A					       ; __tolower_l+EAj
.text:0041555A		       cmp     [ebp+_loc_update.updated], 0
.text:0041555E		       jz      short loc_415567
.text:00415560		       mov     eax, [ebp+_loc_update.ptd]
.text:00415563		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415567
.text:00415567 loc_415567:			       ; CODE XREF: __tolower_l+63j
.text:00415567		       mov     eax, ebx
.text:00415569		       jmp     loc_41560E
.text:0041556E ; ---------------------------------------------------------------------------
.text:0041556E
.text:0041556E loc_41556E:			       ; CODE XREF: __tolower_l+1Dj
.text:0041556E		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00415571		       cmp     dword ptr [eax+0ACh], 1
.text:00415578		       jle     short loc_4155AB
.text:0041557A		       mov     [ebp+c],	ebx
.text:0041557D		       sar     [ebp+c],	8
.text:00415581		       lea     eax, [ebp+_loc_update]
.text:00415584		       push    eax	       ; plocinfo
.text:00415585		       mov     eax, [ebp+c]
.text:00415588		       and     eax, 0FFh
.text:0041558D		       push    eax	       ; c
.text:0041558E		       call    __isleadbyte_l
.text:00415593		       test    eax, eax
.text:00415595		       pop     ecx
.text:00415596		       pop     ecx
.text:00415597		       jz      short loc_4155AB
.text:00415599		       mov     al, byte	ptr [ebp+c]
.text:0041559C		       push    2
.text:0041559E		       mov     [ebp+inbuffer], al
.text:004155A1		       mov     [ebp+inbuffer+1], bl
.text:004155A4		       mov     [ebp+inbuffer+2], 0
.text:004155A8		       pop     ecx
.text:004155A9		       jmp     short loc_4155C0
.text:004155AB ; ---------------------------------------------------------------------------
.text:004155AB
.text:004155AB loc_4155AB:			       ; CODE XREF: __tolower_l+7Dj
.text:004155AB					       ; __tolower_l+9Cj
.text:004155AB		       call    __errno
.text:004155B0		       mov     dword ptr [eax],	2Ah
.text:004155B6		       xor     ecx, ecx
.text:004155B8		       mov     [ebp+inbuffer], bl
.text:004155BB		       mov     [ebp+inbuffer+1], 0
.text:004155BF		       inc     ecx
.text:004155C0
.text:004155C0 loc_4155C0:			       ; CODE XREF: __tolower_l+AEj
.text:004155C0		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004155C3		       push    1	       ; bError
.text:004155C5		       push    dword ptr [eax+4] ; code_page
.text:004155C8		       lea     edx, [ebp+outbuffer]
.text:004155CB		       push    3	       ; cchDest
.text:004155CD		       push    edx	       ; lpDestStr
.text:004155CE		       push    ecx	       ; cchSrc
.text:004155CF		       lea     ecx, [ebp+inbuffer]
.text:004155D2		       push    ecx	       ; lpSrcStr
.text:004155D3		       push    esi	       ; dwMapFlags
.text:004155D4		       push    dword ptr [eax+14h] ; Locale
.text:004155D7		       lea     eax, [ebp+_loc_update]
.text:004155DA		       push    eax	       ; plocinfo
.text:004155DB		       call    ___crtLCMapStringA
.text:004155E0		       add     esp, 24h
.text:004155E3		       test    eax, eax
.text:004155E5		       jz      loc_41555A
.text:004155EB		       cmp     eax, 1
.text:004155EE		       jnz     short loc_4155F6
.text:004155F0		       movzx   eax, [ebp+outbuffer]
.text:004155F4		       jmp     short loc_415601
.text:004155F6 ; ---------------------------------------------------------------------------
.text:004155F6
.text:004155F6 loc_4155F6:			       ; CODE XREF: __tolower_l+F3j
.text:004155F6		       movzx   ecx, [ebp+outbuffer+1]
.text:004155FA		       xor     eax, eax
.text:004155FC		       mov     ah, [ebp+outbuffer]
.text:004155FF		       or      eax, ecx
.text:00415601
.text:00415601 loc_415601:			       ; CODE XREF: __tolower_l+5Aj
.text:00415601					       ; __tolower_l+F9j
.text:00415601		       cmp     [ebp+_loc_update.updated], 0
.text:00415605		       jz      short loc_41560E
.text:00415607		       mov     ecx, [ebp+_loc_update.ptd]
.text:0041560A		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0041560E
.text:0041560E loc_41560E:			       ; CODE XREF: __tolower_l+6Ej
.text:0041560E					       ; __tolower_l+10Aj
.text:0041560E		       pop     esi
.text:0041560F		       pop     ebx
.text:00415610		       leave
.text:00415611		       retn
.text:00415611 __tolower_l     endp
.text:00415611
.text:00415612
.text:00415612 ; =============== S U B R O U T I N E =======================================
.text:00415612
.text:00415612
.text:00415612 ; int __cdecl tolower(int c)
.text:00415612 _tolower	       proc near
.text:00415612
.text:00415612 c	       = dword ptr  4
.text:00415612
.text:00415612		       cmp     ___locale_changed, 0
.text:00415619		       jnz     short loc_41562B
.text:0041561B		       mov     eax, [esp+c]
.text:0041561F		       lea     ecx, [eax-41h]
.text:00415622		       cmp     ecx, 19h
.text:00415625		       ja      short locret_415638
.text:00415627		       add     eax, 20h
.text:0041562A		       retn
.text:0041562B ; ---------------------------------------------------------------------------
.text:0041562B
.text:0041562B loc_41562B:			       ; CODE XREF: _tolower+7j
.text:0041562B		       push    0	       ; plocinfo
.text:0041562D		       push    [esp+4+c]       ; c
.text:00415631		       call    __tolower_l
.text:00415636		       pop     ecx
.text:00415637		       pop     ecx
.text:00415638
.text:00415638 locret_415638:			       ; CODE XREF: _tolower+13j
.text:00415638		       retn
.text:00415638 _tolower	       endp
.text:00415638
.text:00415639
.text:00415639 ; =============== S U B R O U T I N E =======================================
.text:00415639
.text:00415639 ; Attributes: bp-based frame
.text:00415639
.text:00415639 ; unsigned __int64 __cdecl strtoxq(localeinfo_struct *plocinfo, const char *nptr, const char **endptr, int ibase, int flags)
.text:00415639 strtoxq	       proc near	       ; CODE XREF: __strtoi64:loc_4158ECp
.text:00415639					       ; __strtoi64_l+12p ...
.text:00415639
.text:00415639 _loc_update     = _LocaleUpdate ptr -38h
.text:00415639 var_24	       = dword ptr -24h
.text:00415639 var_20	       = dword ptr -20h
.text:00415639 var_1C	       = dword ptr -1Ch
.text:00415639 maxval	       = qword ptr -18h
.text:00415639 number	       = qword ptr -10h
.text:00415639 p	       = dword ptr -8
.text:00415639 c	       = byte ptr -1
.text:00415639 plocinfo	       = dword ptr  8
.text:00415639 nptr	       = dword ptr  0Ch
.text:00415639 endptr	       = dword ptr  10h
.text:00415639 ibase	       = dword ptr  14h
.text:00415639 flags	       = dword ptr  18h
.text:00415639
.text:00415639		       push    ebp
.text:0041563A		       mov     ebp, esp
.text:0041563C		       sub     esp, 38h
.text:0041563F		       push    ebx
.text:00415640		       push    edi
.text:00415641		       push    [ebp+plocinfo]  ; plocinfo
.text:00415644		       lea     ecx, [ebp+_loc_update] ;	this
.text:00415647		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0041564C		       mov     eax, [ebp+endptr]
.text:0041564F		       mov     edi, [ebp+nptr]
.text:00415652		       xor     ebx, ebx
.text:00415654		       cmp     eax, ebx
.text:00415656		       jz      short loc_41565A
.text:00415658		       mov     [eax], edi
.text:0041565A
.text:0041565A loc_41565A:			       ; CODE XREF: strtoxq+1Dj
.text:0041565A		       cmp     edi, ebx
.text:0041565C		       jnz     short loc_41568B
.text:0041565E
.text:0041565E loc_41565E:			       ; CODE XREF: strtoxq+5Bj
.text:0041565E					       ; strtoxq+61j
.text:0041565E		       call    __errno
.text:00415663		       push    ebx	       ; pReserved
.text:00415664		       push    ebx	       ; nLine
.text:00415665		       push    ebx	       ; pszFile
.text:00415666		       push    ebx	       ; pszFunction
.text:00415667		       push    ebx	       ; pszExpression
.text:00415668		       mov     dword ptr [eax],	16h
.text:0041566E		       call    __invalid_parameter
.text:00415673		       add     esp, 14h
.text:00415676		       cmp     [ebp+_loc_update.updated], bl
.text:00415679		       jz      short loc_415682
.text:0041567B		       mov     eax, [ebp+_loc_update.ptd]
.text:0041567E		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415682
.text:00415682 loc_415682:			       ; CODE XREF: strtoxq+40j
.text:00415682		       xor     eax, eax
.text:00415684		       xor     edx, edx
.text:00415686		       jmp     loc_4158C9
.text:0041568B ; ---------------------------------------------------------------------------
.text:0041568B
.text:0041568B loc_41568B:			       ; CODE XREF: strtoxq+23j
.text:0041568B		       cmp     [ebp+ibase], ebx
.text:0041568E		       jz      short loc_41569C
.text:00415690		       cmp     [ebp+ibase], 2
.text:00415694		       jl      short loc_41565E
.text:00415696		       cmp     [ebp+ibase], 24h
.text:0041569A		       jg      short loc_41565E
.text:0041569C
.text:0041569C loc_41569C:			       ; CODE XREF: strtoxq+55j
.text:0041569C		       push    esi
.text:0041569D		       mov     esi, [ebp+_loc_update.localeinfo.locinfo]
.text:004156A0		       mov     dword ptr [ebp+number], ebx
.text:004156A3		       mov     dword ptr [ebp+number+4], ebx
.text:004156A6
.text:004156A6 loc_4156A6:			       ; CODE XREF: strtoxq+A7j
.text:004156A6		       mov     al, [edi]
.text:004156A8		       inc     edi
.text:004156A9		       cmp     dword ptr [esi+0ACh], 1
.text:004156B0		       mov     [ebp+c],	al
.text:004156B3		       jle     short loc_4156CD
.text:004156B5		       lea     eax, [ebp+_loc_update]
.text:004156B8		       push    eax	       ; plocinfo
.text:004156B9		       movzx   eax, [ebp+c]
.text:004156BD		       push    8	       ; mask
.text:004156BF		       push    eax	       ; c
.text:004156C0		       call    __isctype_l
.text:004156C5		       mov     esi, [ebp+_loc_update.localeinfo.locinfo]
.text:004156C8		       add     esp, 0Ch
.text:004156CB		       jmp     short loc_4156DE
.text:004156CD ; ---------------------------------------------------------------------------
.text:004156CD
.text:004156CD loc_4156CD:			       ; CODE XREF: strtoxq+7Aj
.text:004156CD		       movzx   eax, [ebp+c]
.text:004156D1		       mov     ecx, [esi+0C8h]
.text:004156D7		       movzx   eax, byte ptr [ecx+eax*2]
.text:004156DB		       and     eax, 8
.text:004156DE
.text:004156DE loc_4156DE:			       ; CODE XREF: strtoxq+92j
.text:004156DE		       cmp     eax, ebx
.text:004156E0		       jnz     short loc_4156A6
.text:004156E2		       cmp     [ebp+c],	2Dh
.text:004156E6		       mov     [ebp+p],	edi
.text:004156E9		       jnz     short loc_4156F1
.text:004156EB		       or      [ebp+flags], 2
.text:004156EF		       jmp     short loc_4156F7
.text:004156F1 ; ---------------------------------------------------------------------------
.text:004156F1
.text:004156F1 loc_4156F1:			       ; CODE XREF: strtoxq+B0j
.text:004156F1		       cmp     [ebp+c],	2Bh
.text:004156F5		       jnz     short loc_415700
.text:004156F7
.text:004156F7 loc_4156F7:			       ; CODE XREF: strtoxq+B6j
.text:004156F7		       mov     al, [edi]
.text:004156F9		       inc     edi
.text:004156FA		       mov     [ebp+p],	edi
.text:004156FD		       mov     [ebp+c],	al
.text:00415700
.text:00415700 loc_415700:			       ; CODE XREF: strtoxq+BCj
.text:00415700		       cmp     [ebp+ibase], ebx
.text:00415703		       push    10h
.text:00415705		       pop     ecx
.text:00415706		       jnz     short loc_41572D
.text:00415708		       cmp     [ebp+c],	30h
.text:0041570C		       jz      short loc_415717
.text:0041570E		       mov     [ebp+ibase], 0Ah
.text:00415715		       jmp     short loc_41574C
.text:00415717 ; ---------------------------------------------------------------------------
.text:00415717
.text:00415717 loc_415717:			       ; CODE XREF: strtoxq+D3j
.text:00415717		       mov     al, [edi]
.text:00415719		       cmp     al, 78h
.text:0041571B		       jz      short loc_41572A
.text:0041571D		       cmp     al, 58h
.text:0041571F		       jz      short loc_41572A
.text:00415721		       mov     [ebp+ibase], 8
.text:00415728		       jmp     short loc_41574C
.text:0041572A ; ---------------------------------------------------------------------------
.text:0041572A
.text:0041572A loc_41572A:			       ; CODE XREF: strtoxq+E2j
.text:0041572A					       ; strtoxq+E6j
.text:0041572A		       mov     [ebp+ibase], ecx
.text:0041572D
.text:0041572D loc_41572D:			       ; CODE XREF: strtoxq+CDj
.text:0041572D		       cmp     [ebp+ibase], ecx
.text:00415730		       jnz     short loc_41574C
.text:00415732		       cmp     [ebp+c],	30h
.text:00415736		       jnz     short loc_41574C
.text:00415738		       mov     al, [edi]
.text:0041573A		       cmp     al, 78h
.text:0041573C		       jz      short loc_415742
.text:0041573E		       cmp     al, 58h
.text:00415740		       jnz     short loc_41574C
.text:00415742
.text:00415742 loc_415742:			       ; CODE XREF: strtoxq+103j
.text:00415742		       inc     edi
.text:00415743		       mov     al, [edi]
.text:00415745		       inc     edi
.text:00415746		       mov     [ebp+c],	al
.text:00415749		       mov     [ebp+p],	edi
.text:0041574C
.text:0041574C loc_41574C:			       ; CODE XREF: strtoxq+DCj
.text:0041574C					       ; strtoxq+EFj ...
.text:0041574C		       mov     eax, [ebp+ibase]
.text:0041574F		       cdq
.text:00415750		       push    edx
.text:00415751		       mov     edi, eax
.text:00415753		       push    edi
.text:00415754		       push    0FFFFFFFFh
.text:00415756		       push    0FFFFFFFFh
.text:00415758		       mov     [ebp+var_24], edx
.text:0041575B		       call    __aulldvrm
.text:00415760		       mov     [ebp+var_1C], ebx
.text:00415763		       mov     ebx, [esi+0C8h]
.text:00415769		       mov     [ebp+var_20], ecx
.text:0041576C		       mov     dword ptr [ebp+maxval], eax
.text:0041576F		       mov     dword ptr [ebp+maxval+4], edx
.text:00415772
.text:00415772 loc_415772:			       ; CODE XREF: strtoxq+1ECj
.text:00415772		       mov     cl, [ebp+c]
.text:00415775		       movzx   eax, cl
.text:00415778		       movzx   eax, word ptr [ebx+eax*2]
.text:0041577C		       test    al, 4
.text:0041577E		       jz      short loc_415788
.text:00415780		       movsx   esi, cl
.text:00415783		       sub     esi, 30h
.text:00415786		       jmp     short loc_41579F
.text:00415788 ; ---------------------------------------------------------------------------
.text:00415788
.text:00415788 loc_415788:			       ; CODE XREF: strtoxq+145j
.text:00415788		       test    ax, 103h
.text:0041578C		       jz      short loc_4157DF
.text:0041578E		       mov     al, cl
.text:00415790		       sub     al, 61h
.text:00415792		       cmp     al, 19h
.text:00415794		       movsx   eax, cl
.text:00415797		       ja      short loc_41579C
.text:00415799		       sub     eax, 20h
.text:0041579C
.text:0041579C loc_41579C:			       ; CODE XREF: strtoxq+15Ej
.text:0041579C		       lea     esi, [eax-37h]
.text:0041579F
.text:0041579F loc_41579F:			       ; CODE XREF: strtoxq+14Dj
.text:0041579F		       cmp     esi, [ebp+ibase]
.text:004157A2		       jnb     short loc_4157DF
.text:004157A4		       mov     ecx, dword ptr [ebp+number+4]
.text:004157A7		       or      [ebp+flags], 8
.text:004157AB		       cmp     ecx, dword ptr [ebp+maxval+4]
.text:004157AE		       jb      short loc_415801
.text:004157B0		       ja      short loc_4157BA
.text:004157B2		       mov     eax, dword ptr [ebp+number]
.text:004157B5		       cmp     eax, dword ptr [ebp+maxval]
.text:004157B8		       jb      short loc_415801
.text:004157BA
.text:004157BA loc_4157BA:			       ; CODE XREF: strtoxq+177j
.text:004157BA		       mov     eax, dword ptr [ebp+maxval]
.text:004157BD		       cmp     dword ptr [ebp+number], eax
.text:004157C0		       jnz     short loc_4157D5
.text:004157C2		       cmp     ecx, dword ptr [ebp+maxval+4]
.text:004157C5		       jnz     short loc_4157D5
.text:004157C7		       xor     eax, eax
.text:004157C9		       cmp     eax, [ebp+var_1C]
.text:004157CC		       jb      short loc_415801
.text:004157CE		       ja      short loc_4157D5
.text:004157D0		       cmp     esi, [ebp+var_20]
.text:004157D3		       jbe     short loc_415801
.text:004157D5
.text:004157D5 loc_4157D5:			       ; CODE XREF: strtoxq+187j
.text:004157D5					       ; strtoxq+18Cj ...
.text:004157D5		       or      [ebp+flags], 4
.text:004157D9		       cmp     [ebp+endptr], 0
.text:004157DD		       jnz     short loc_41581A
.text:004157DF
.text:004157DF loc_4157DF:			       ; CODE XREF: strtoxq+153j
.text:004157DF					       ; strtoxq+169j
.text:004157DF		       mov     eax, [ebp+flags]
.text:004157E2		       dec     [ebp+p]
.text:004157E5		       test    al, 8
.text:004157E7		       jnz     short loc_41582A
.text:004157E9		       xor     eax, eax
.text:004157EB		       cmp     [ebp+endptr], eax
.text:004157EE		       jz      short loc_4157F6
.text:004157F0		       mov     ecx, [ebp+nptr]
.text:004157F3		       mov     [ebp+p],	ecx
.text:004157F6
.text:004157F6 loc_4157F6:			       ; CODE XREF: strtoxq+1B5j
.text:004157F6		       mov     dword ptr [ebp+number], eax
.text:004157F9		       mov     dword ptr [ebp+number+4], eax
.text:004157FC		       jmp     loc_415890
.text:00415801 ; ---------------------------------------------------------------------------
.text:00415801
.text:00415801 loc_415801:			       ; CODE XREF: strtoxq+175j
.text:00415801					       ; strtoxq+17Fj ...
.text:00415801		       push    ecx
.text:00415802		       push    dword ptr [ebp+number]
.text:00415805		       push    [ebp+var_24]
.text:00415808		       push    edi
.text:00415809		       call    __allmul
.text:0041580E		       xor     ecx, ecx
.text:00415810		       add     eax, esi
.text:00415812		       adc     edx, ecx
.text:00415814		       mov     dword ptr [ebp+number], eax
.text:00415817		       mov     dword ptr [ebp+number+4], edx
.text:0041581A
.text:0041581A loc_41581A:			       ; CODE XREF: strtoxq+1A4j
.text:0041581A		       mov     eax, [ebp+p]
.text:0041581D		       mov     al, [eax]
.text:0041581F		       inc     [ebp+p]
.text:00415822		       mov     [ebp+c],	al
.text:00415825		       jmp     loc_415772
.text:0041582A ; ---------------------------------------------------------------------------
.text:0041582A
.text:0041582A loc_41582A:			       ; CODE XREF: strtoxq+1AEj
.text:0041582A		       test    al, 4
.text:0041582C		       mov     esi, 7FFFFFFFh
.text:00415831		       mov     ebx, 80000000h
.text:00415836		       jnz     short loc_41585F
.text:00415838		       test    al, 1
.text:0041583A		       jnz     short loc_415890
.text:0041583C		       and     eax, 2
.text:0041583F		       jz      short loc_41584E
.text:00415841		       cmp     dword ptr [ebp+number+4], ebx
.text:00415844		       ja      short loc_41585F
.text:00415846		       jb      short loc_41584E
.text:00415848		       cmp     dword ptr [ebp+number], 0
.text:0041584C		       ja      short loc_41585F
.text:0041584E
.text:0041584E loc_41584E:			       ; CODE XREF: strtoxq+206j
.text:0041584E					       ; strtoxq+20Dj
.text:0041584E		       test    eax, eax
.text:00415850		       jnz     short loc_415890
.text:00415852		       cmp     dword ptr [ebp+number+4], esi
.text:00415855		       jb      short loc_415890
.text:00415857		       ja      short loc_41585F
.text:00415859		       cmp     dword ptr [ebp+number], 0FFFFFFFFh
.text:0041585D		       jbe     short loc_415890
.text:0041585F
.text:0041585F loc_41585F:			       ; CODE XREF: strtoxq+1FDj
.text:0041585F					       ; strtoxq+20Bj ...
.text:0041585F		       call    __errno
.text:00415864		       test    byte ptr	[ebp+flags], 1
.text:00415868		       mov     dword ptr [eax],	22h
.text:0041586E		       jz      short loc_41587A
.text:00415870		       or      dword ptr [ebp+number], 0FFFFFFFFh
.text:00415874		       or      dword ptr [ebp+number+4], 0FFFFFFFFh
.text:00415878		       jmp     short loc_415890
.text:0041587A ; ---------------------------------------------------------------------------
.text:0041587A
.text:0041587A loc_41587A:			       ; CODE XREF: strtoxq+235j
.text:0041587A		       test    byte ptr	[ebp+flags], 2
.text:0041587E		       jz      short loc_415889
.text:00415880		       and     dword ptr [ebp+number], 0
.text:00415884		       mov     dword ptr [ebp+number+4], ebx
.text:00415887		       jmp     short loc_415890
.text:00415889 ; ---------------------------------------------------------------------------
.text:00415889
.text:00415889 loc_415889:			       ; CODE XREF: strtoxq+245j
.text:00415889		       or      dword ptr [ebp+number], 0FFFFFFFFh
.text:0041588D		       mov     dword ptr [ebp+number+4], esi
.text:00415890
.text:00415890 loc_415890:			       ; CODE XREF: strtoxq+1C3j
.text:00415890					       ; strtoxq+201j ...
.text:00415890		       mov     eax, [ebp+endptr]
.text:00415893		       test    eax, eax
.text:00415895		       pop     esi
.text:00415896		       jz      short loc_41589D
.text:00415898		       mov     ecx, [ebp+p]
.text:0041589B		       mov     [eax], ecx
.text:0041589D
.text:0041589D loc_41589D:			       ; CODE XREF: strtoxq+25Dj
.text:0041589D		       test    byte ptr	[ebp+flags], 2
.text:004158A1		       jz      short loc_4158B6
.text:004158A3		       mov     eax, dword ptr [ebp+number]
.text:004158A6		       mov     ecx, dword ptr [ebp+number+4]
.text:004158A9		       neg     eax
.text:004158AB		       adc     ecx, 0
.text:004158AE		       neg     ecx
.text:004158B0		       mov     dword ptr [ebp+number], eax
.text:004158B3		       mov     dword ptr [ebp+number+4], ecx
.text:004158B6
.text:004158B6 loc_4158B6:			       ; CODE XREF: strtoxq+268j
.text:004158B6		       cmp     [ebp+_loc_update.updated], 0
.text:004158BA		       jz      short loc_4158C3
.text:004158BC		       mov     eax, [ebp+_loc_update.ptd]
.text:004158BF		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004158C3
.text:004158C3 loc_4158C3:			       ; CODE XREF: strtoxq+281j
.text:004158C3		       mov     eax, dword ptr [ebp+number]
.text:004158C6		       mov     edx, dword ptr [ebp+number+4]
.text:004158C9
.text:004158C9 loc_4158C9:			       ; CODE XREF: strtoxq+4Dj
.text:004158C9		       pop     edi
.text:004158CA		       pop     ebx
.text:004158CB		       leave
.text:004158CC		       retn
.text:004158CC strtoxq	       endp
.text:004158CC
.text:004158CD
.text:004158CD ; =============== S U B R O U T I N E =======================================
.text:004158CD
.text:004158CD ; Attributes: bp-based frame
.text:004158CD
.text:004158CD ; __int64 __cdecl _strtoi64(const char *nptr, char **endptr, int	ibase)
.text:004158CD __strtoi64      proc near	       ; CODE XREF: __atoi64+8p
.text:004158CD
.text:004158CD nptr	       = dword ptr  8
.text:004158CD endptr	       = dword ptr  0Ch
.text:004158CD ibase	       = dword ptr  10h
.text:004158CD
.text:004158CD		       push    ebp
.text:004158CE		       mov     ebp, esp
.text:004158D0		       xor     eax, eax
.text:004158D2		       cmp     ___locale_changed, eax
.text:004158D8		       push    eax	       ; flags
.text:004158D9		       push    [ebp+ibase]     ; ibase
.text:004158DC		       push    [ebp+endptr]    ; endptr
.text:004158DF		       push    [ebp+nptr]      ; nptr
.text:004158E2		       jnz     short loc_4158EB
.text:004158E4		       push    offset ___initiallocalestructinfo
.text:004158E9		       jmp     short loc_4158EC
.text:004158EB ; ---------------------------------------------------------------------------
.text:004158EB
.text:004158EB loc_4158EB:			       ; CODE XREF: __strtoi64+15j
.text:004158EB		       push    eax	       ; plocinfo
.text:004158EC
.text:004158EC loc_4158EC:			       ; CODE XREF: __strtoi64+1Cj
.text:004158EC		       call    strtoxq
.text:004158F1		       add     esp, 14h
.text:004158F4		       pop     ebp
.text:004158F5		       retn
.text:004158F5 __strtoi64      endp
.text:004158F5
.text:004158F6
.text:004158F6 ; =============== S U B R O U T I N E =======================================
.text:004158F6
.text:004158F6
.text:004158F6 ; __int64 __cdecl _strtoi64_l(const char	*nptr, char **endptr, int ibase, localeinfo_struct *plocinfo)
.text:004158F6 __strtoi64_l    proc near	       ; CODE XREF: __atoi64_l+Cp
.text:004158F6
.text:004158F6 nptr	       = dword ptr  4
.text:004158F6 endptr	       = dword ptr  8
.text:004158F6 ibase	       = dword ptr  0Ch
.text:004158F6 plocinfo	       = dword ptr  10h
.text:004158F6
.text:004158F6		       push    0	       ; flags
.text:004158F8		       push    [esp+4+ibase]   ; ibase
.text:004158FC		       push    [esp+8+endptr]  ; endptr
.text:00415900		       push    [esp+0Ch+nptr]  ; nptr
.text:00415904		       push    [esp+10h+plocinfo] ; plocinfo
.text:00415908		       call    strtoxq
.text:0041590D		       add     esp, 14h
.text:00415910		       retn
.text:00415910 __strtoi64_l    endp
.text:00415910
.text:00415911
.text:00415911 ; =============== S U B R O U T I N E =======================================
.text:00415911
.text:00415911 ; Attributes: bp-based frame
.text:00415911
.text:00415911 ; unsigned __int64 __cdecl _strtoui64(const char	*nptr, char **endptr, int ibase)
.text:00415911 __strtoui64     proc near
.text:00415911
.text:00415911 nptr	       = dword ptr  8
.text:00415911 endptr	       = dword ptr  0Ch
.text:00415911 ibase	       = dword ptr  10h
.text:00415911
.text:00415911		       push    ebp
.text:00415912		       mov     ebp, esp
.text:00415914		       cmp     ___locale_changed, 0
.text:0041591B		       push    1	       ; flags
.text:0041591D		       push    [ebp+ibase]     ; ibase
.text:00415920		       push    [ebp+endptr]    ; endptr
.text:00415923		       push    [ebp+nptr]      ; nptr
.text:00415926		       jnz     short loc_41592F
.text:00415928		       push    offset ___initiallocalestructinfo
.text:0041592D		       jmp     short loc_415931
.text:0041592F ; ---------------------------------------------------------------------------
.text:0041592F
.text:0041592F loc_41592F:			       ; CODE XREF: __strtoui64+15j
.text:0041592F		       push    0	       ; plocinfo
.text:00415931
.text:00415931 loc_415931:			       ; CODE XREF: __strtoui64+1Cj
.text:00415931		       call    strtoxq
.text:00415936		       add     esp, 14h
.text:00415939		       pop     ebp
.text:0041593A		       retn
.text:0041593A __strtoui64     endp
.text:0041593A
.text:0041593B
.text:0041593B ; =============== S U B R O U T I N E =======================================
.text:0041593B
.text:0041593B
.text:0041593B ; unsigned __int64 __cdecl _strtoui64_l(const char *nptr, char **endptr,	int ibase, localeinfo_struct *plocinfo)
.text:0041593B __strtoui64_l   proc near
.text:0041593B
.text:0041593B nptr	       = dword ptr  4
.text:0041593B endptr	       = dword ptr  8
.text:0041593B ibase	       = dword ptr  0Ch
.text:0041593B plocinfo	       = dword ptr  10h
.text:0041593B
.text:0041593B		       push    1	       ; flags
.text:0041593D		       push    [esp+4+ibase]   ; ibase
.text:00415941		       push    [esp+8+endptr]  ; endptr
.text:00415945		       push    [esp+0Ch+nptr]  ; nptr
.text:00415949		       push    [esp+10h+plocinfo] ; plocinfo
.text:0041594D		       call    strtoxq
.text:00415952		       add     esp, 14h
.text:00415955		       retn
.text:00415955 __strtoui64_l   endp
.text:00415955
.text:00415955 ; ---------------------------------------------------------------------------
.text:00415956		       align 10h
.text:00415960
.text:00415960 ; =============== S U B R O U T I N E =======================================
.text:00415960
.text:00415960 ; Attributes: bp-based frame
.text:00415960
.text:00415960 ; void __cdecl __ascii_strnicmp(char *first, char *last,	unsigned int count)
.text:00415960 ___ascii_strnicmp proc near	       ; CODE XREF: __strnicmp_l+9Ap
.text:00415960					       ; __strnicmp+42j
.text:00415960
.text:00415960 first	       = dword ptr  8
.text:00415960 last	       = dword ptr  0Ch
.text:00415960 count	       = dword ptr  10h
.text:00415960
.text:00415960		       push    ebp
.text:00415961		       mov     ebp, esp
.text:00415963		       push    edi
.text:00415964		       push    esi
.text:00415965		       push    ebx
.text:00415966		       mov     ecx, [ebp+count]
.text:00415969		       or      ecx, ecx
.text:0041596B		       jz      short toend_0
.text:0041596D		       mov     esi, [ebp+first]
.text:00415970		       mov     edi, [ebp+last]
.text:00415973		       mov     bh, 41h
.text:00415975		       mov     bl, 5Ah
.text:00415977		       mov     dh, 20h
.text:00415979		       lea     ecx, [ecx+0]
.text:0041597C
.text:0041597C lupe:				       ; CODE XREF: ___ascii_strnicmp+49j
.text:0041597C		       mov     ah, [esi]
.text:0041597E		       or      ah, ah
.text:00415980		       mov     al, [edi]
.text:00415982		       jz      short eject
.text:00415984		       or      al, al
.text:00415986		       jz      short eject
.text:00415988		       add     esi, 1
.text:0041598B		       add     edi, 1
.text:0041598E		       cmp     ah, bh
.text:00415990		       jb      short skip1
.text:00415992		       cmp     ah, bl
.text:00415994		       ja      short skip1
.text:00415996		       add     ah, dh
.text:00415998
.text:00415998 skip1:				       ; CODE XREF: ___ascii_strnicmp+30j
.text:00415998					       ; ___ascii_strnicmp+34j
.text:00415998		       cmp     al, bh
.text:0041599A		       jb      short skip2
.text:0041599C		       cmp     al, bl
.text:0041599E		       ja      short skip2
.text:004159A0		       add     al, dh
.text:004159A2
.text:004159A2 skip2:				       ; CODE XREF: ___ascii_strnicmp+3Aj
.text:004159A2					       ; ___ascii_strnicmp+3Ej
.text:004159A2		       cmp     ah, al
.text:004159A4		       jnz     short differ
.text:004159A6		       sub     ecx, 1
.text:004159A9		       jnz     short lupe
.text:004159AB
.text:004159AB eject:				       ; CODE XREF: ___ascii_strnicmp+22j
.text:004159AB					       ; ___ascii_strnicmp+26j
.text:004159AB		       xor     ecx, ecx
.text:004159AD		       cmp     ah, al
.text:004159AF		       jz      short toend_0
.text:004159B1
.text:004159B1 differ:				       ; CODE XREF: ___ascii_strnicmp+44j
.text:004159B1		       mov     ecx, 0FFFFFFFFh
.text:004159B6		       jb      short toend_0
.text:004159B8		       neg     ecx
.text:004159BA
.text:004159BA toend_0:				       ; CODE XREF: ___ascii_strnicmp+Bj
.text:004159BA					       ; ___ascii_strnicmp+4Fj	...
.text:004159BA		       mov     eax, ecx
.text:004159BC		       pop     ebx
.text:004159BD		       pop     esi
.text:004159BE		       pop     edi
.text:004159BF		       leave
.text:004159C0		       retn
.text:004159C0 ___ascii_strnicmp endp
.text:004159C0
.text:004159C1
.text:004159C1 ; =============== S U B R O U T I N E =======================================
.text:004159C1
.text:004159C1 ; Attributes: bp-based frame
.text:004159C1
.text:004159C1 ; int __cdecl _mbsnbicoll_l(const char *s1, const char *s2, unsigned int	n, localeinfo_struct *plocinfo)
.text:004159C1 __mbsnbicoll_l  proc near	       ; CODE XREF: __mbsnbicoll+Ep
.text:004159C1
.text:004159C1 _loc_update     = _LocaleUpdate ptr -10h
.text:004159C1 s1	       = dword ptr  8
.text:004159C1 s2	       = dword ptr  0Ch
.text:004159C1 n	       = dword ptr  10h
.text:004159C1 plocinfo	       = dword ptr  14h
.text:004159C1
.text:004159C1		       push    ebp
.text:004159C2		       mov     ebp, esp
.text:004159C4		       sub     esp, 10h
.text:004159C7		       push    ebx
.text:004159C8		       push    [ebp+plocinfo]  ; plocinfo
.text:004159CB		       lea     ecx, [ebp+_loc_update] ;	this
.text:004159CE		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004159D3		       mov     ecx, [ebp+n]
.text:004159D6		       xor     ebx, ebx
.text:004159D8		       cmp     ecx, ebx
.text:004159DA		       jnz     short loc_4159EF
.text:004159DC		       cmp     [ebp+_loc_update.updated], bl
.text:004159DF		       jz      short loc_4159E8
.text:004159E1		       mov     eax, [ebp+_loc_update.ptd]
.text:004159E4		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004159E8
.text:004159E8 loc_4159E8:			       ; CODE XREF: __mbsnbicoll_l+1Ej
.text:004159E8		       xor     eax, eax
.text:004159EA		       jmp     loc_415AAA
.text:004159EF ; ---------------------------------------------------------------------------
.text:004159EF
.text:004159EF loc_4159EF:			       ; CODE XREF: __mbsnbicoll_l+19j
.text:004159EF		       cmp     [ebp+s1], ebx
.text:004159F2		       jnz     short loc_415A22
.text:004159F4
.text:004159F4 loc_4159F4:			       ; CODE XREF: __mbsnbicoll_l+64j
.text:004159F4		       call    __errno
.text:004159F9		       push    ebx	       ; pReserved
.text:004159FA		       push    ebx	       ; nLine
.text:004159FB		       push    ebx	       ; pszFile
.text:004159FC		       push    ebx	       ; pszFunction
.text:004159FD		       push    ebx	       ; pszExpression
.text:004159FE		       mov     dword ptr [eax],	16h
.text:00415A04		       call    __invalid_parameter
.text:00415A09		       add     esp, 14h
.text:00415A0C		       cmp     [ebp+_loc_update.updated], bl
.text:00415A0F		       jz      short loc_415A18
.text:00415A11		       mov     eax, [ebp+_loc_update.ptd]
.text:00415A14		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415A18
.text:00415A18 loc_415A18:			       ; CODE XREF: __mbsnbicoll_l+4Ej
.text:00415A18		       mov     eax, 7FFFFFFFh
.text:00415A1D		       jmp     loc_415AAA
.text:00415A22 ; ---------------------------------------------------------------------------
.text:00415A22
.text:00415A22 loc_415A22:			       ; CODE XREF: __mbsnbicoll_l+31j
.text:00415A22		       cmp     [ebp+s2], ebx
.text:00415A25		       jz      short loc_4159F4
.text:00415A27		       push    esi
.text:00415A28		       mov     esi, 7FFFFFFFh
.text:00415A2D		       cmp     ecx, esi
.text:00415A2F		       jbe     short loc_415A4B
.text:00415A31		       call    __errno
.text:00415A36		       push    ebx	       ; pReserved
.text:00415A37		       push    ebx	       ; nLine
.text:00415A38		       push    ebx	       ; pszFile
.text:00415A39		       push    ebx	       ; pszFunction
.text:00415A3A		       push    ebx	       ; pszExpression
.text:00415A3B		       mov     dword ptr [eax],	16h
.text:00415A41		       call    __invalid_parameter
.text:00415A46		       add     esp, 14h
.text:00415A49		       jmp     short loc_415A8A
.text:00415A4B ; ---------------------------------------------------------------------------
.text:00415A4B
.text:00415A4B loc_415A4B:			       ; CODE XREF: __mbsnbicoll_l+6Ej
.text:00415A4B		       mov     eax, [ebp+_loc_update.localeinfo.mbcinfo]
.text:00415A4E		       cmp     [eax+8],	ebx
.text:00415A51		       jnz     short loc_415A67
.text:00415A53		       push    [ebp+plocinfo]  ; plocinfo
.text:00415A56		       push    ecx	       ; count
.text:00415A57		       push    [ebp+s2]	       ; _string2
.text:00415A5A		       push    [ebp+s1]	       ; _string1
.text:00415A5D		       call    __strnicoll_l
.text:00415A62		       add     esp, 10h
.text:00415A65		       jmp     short loc_415A9D
.text:00415A67 ; ---------------------------------------------------------------------------
.text:00415A67
.text:00415A67 loc_415A67:			       ; CODE XREF: __mbsnbicoll_l+90j
.text:00415A67		       push    dword ptr [eax+4] ; code_page
.text:00415A6A		       push    ecx	       ; cchCount2
.text:00415A6B		       push    [ebp+s2]	       ; lpString2
.text:00415A6E		       push    ecx	       ; cchCount1
.text:00415A6F		       push    [ebp+s1]	       ; lpString1
.text:00415A72		       push    1001h	       ; dwCmpFlags
.text:00415A77		       push    dword ptr [eax+0Ch] ; Locale
.text:00415A7A		       lea     eax, [ebp+_loc_update]
.text:00415A7D		       push    eax	       ; plocinfo
.text:00415A7E		       call    ___crtCompareStringA
.text:00415A83		       add     esp, 20h
.text:00415A86		       cmp     eax, ebx
.text:00415A88		       jnz     short loc_415A9A
.text:00415A8A
.text:00415A8A loc_415A8A:			       ; CODE XREF: __mbsnbicoll_l+88j
.text:00415A8A		       cmp     [ebp+_loc_update.updated], bl
.text:00415A8D		       jz      short loc_415A96
.text:00415A8F		       mov     eax, [ebp+_loc_update.ptd]
.text:00415A92		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415A96
.text:00415A96 loc_415A96:			       ; CODE XREF: __mbsnbicoll_l+CCj
.text:00415A96		       mov     eax, esi
.text:00415A98		       jmp     short loc_415AA9
.text:00415A9A ; ---------------------------------------------------------------------------
.text:00415A9A
.text:00415A9A loc_415A9A:			       ; CODE XREF: __mbsnbicoll_l+C7j
.text:00415A9A		       add     eax, 0FFFFFFFEh
.text:00415A9D
.text:00415A9D loc_415A9D:			       ; CODE XREF: __mbsnbicoll_l+A4j
.text:00415A9D		       cmp     [ebp+_loc_update.updated], bl
.text:00415AA0		       jz      short loc_415AA9
.text:00415AA2		       mov     ecx, [ebp+_loc_update.ptd]
.text:00415AA5		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00415AA9
.text:00415AA9 loc_415AA9:			       ; CODE XREF: __mbsnbicoll_l+D7j
.text:00415AA9					       ; __mbsnbicoll_l+DFj
.text:00415AA9		       pop     esi
.text:00415AAA
.text:00415AAA loc_415AAA:			       ; CODE XREF: __mbsnbicoll_l+29j
.text:00415AAA					       ; __mbsnbicoll_l+5Cj
.text:00415AAA		       pop     ebx
.text:00415AAB		       leave
.text:00415AAC		       retn
.text:00415AAC __mbsnbicoll_l  endp
.text:00415AAC
.text:00415AAD
.text:00415AAD ; =============== S U B R O U T I N E =======================================
.text:00415AAD
.text:00415AAD
.text:00415AAD ; int __cdecl _mbsnbicoll(const char *s1, const char *s2, unsigned int n)
.text:00415AAD __mbsnbicoll    proc near	       ; CODE XREF: __getenv_helper_nolock+5Ep
.text:00415AAD					       ; findenv+Fp
.text:00415AAD
.text:00415AAD s1	       = dword ptr  4
.text:00415AAD s2	       = dword ptr  8
.text:00415AAD n	       = dword ptr  0Ch
.text:00415AAD
.text:00415AAD		       push    0	       ; plocinfo
.text:00415AAF		       push    [esp+4+n]       ; n
.text:00415AB3		       push    [esp+8+s2]      ; s2
.text:00415AB7		       push    [esp+0Ch+s1]    ; s1
.text:00415ABB		       call    __mbsnbicoll_l
.text:00415AC0		       add     esp, 10h
.text:00415AC3		       retn
.text:00415AC3 __mbsnbicoll    endp
.text:00415AC3
.text:00415AC4
.text:00415AC4 ; =============== S U B R O U T I N E =======================================
.text:00415AC4
.text:00415AC4 ; Attributes: bp-based frame
.text:00415AC4
.text:00415AC4 ; int __cdecl __wtomb_environ()
.text:00415AC4 ___wtomb_environ	proc near	       ; CODE XREF: __getenv_helper_nolock+22p
.text:00415AC4					       ; ___crtsetenv+85p
.text:00415AC4
.text:00415AC4 size	       = dword ptr -8
.text:00415AC4 envp	       = dword ptr -4
.text:00415AC4
.text:00415AC4		       push    ebp
.text:00415AC5		       mov     ebp, esp
.text:00415AC7		       push    ecx
.text:00415AC8		       push    ecx
.text:00415AC9		       push    ebx
.text:00415ACA		       push    esi
.text:00415ACB		       xor     esi, esi
.text:00415ACD		       push    edi
.text:00415ACE		       mov     edi, __wenviron
.text:00415AD4		       mov     [ebp+envp], esi
.text:00415AD7		       mov     eax, [edi]
.text:00415AD9		       cmp     eax, esi
.text:00415ADB		       jz      short loc_415B42
.text:00415ADD		       mov     ebx, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00415AE3
.text:00415AE3 loc_415AE3:			       ; CODE XREF: ___wtomb_environ+7Cj
.text:00415AE3		       push    esi	       ; lpUsedDefaultChar
.text:00415AE4		       push    esi	       ; lpDefaultChar
.text:00415AE5		       push    esi	       ; cbMultiByte
.text:00415AE6		       push    esi	       ; lpMultiByteStr
.text:00415AE7		       push    0FFFFFFFFh      ; cchWideChar
.text:00415AE9		       push    eax	       ; lpWideCharStr
.text:00415AEA		       push    esi	       ; dwFlags
.text:00415AEB		       push    esi	       ; CodePage
.text:00415AEC		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00415AEE		       cmp     eax, esi
.text:00415AF0		       mov     [ebp+size], eax
.text:00415AF3		       jz      short loc_415B49
.text:00415AF5		       push    1	       ; size
.text:00415AF7		       push    eax	       ; count
.text:00415AF8		       call    __calloc_crt
.text:00415AFD		       cmp     eax, esi
.text:00415AFF		       pop     ecx
.text:00415B00		       pop     ecx
.text:00415B01		       mov     [ebp+envp], eax
.text:00415B04		       jz      short loc_415B49
.text:00415B06		       push    esi	       ; lpUsedDefaultChar
.text:00415B07		       push    esi	       ; lpDefaultChar
.text:00415B08		       push    [ebp+size]      ; cbMultiByte
.text:00415B0B		       push    eax	       ; lpMultiByteStr
.text:00415B0C		       push    0FFFFFFFFh      ; cchWideChar
.text:00415B0E		       push    dword ptr [edi] ; lpWideCharStr
.text:00415B10		       push    esi	       ; dwFlags
.text:00415B11		       push    esi	       ; CodePage
.text:00415B12		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00415B14		       test    eax, eax
.text:00415B16		       jz      short loc_415B4E
.text:00415B18		       lea     eax, [ebp+envp]
.text:00415B1B		       push    esi	       ; primary
.text:00415B1C		       push    eax	       ; poption
.text:00415B1D		       call    ___crtsetenv
.text:00415B22		       test    eax, eax
.text:00415B24		       pop     ecx
.text:00415B25		       pop     ecx
.text:00415B26		       jge     short loc_415B39
.text:00415B28		       cmp     [ebp+envp], esi
.text:00415B2B		       jz      short loc_415B39
.text:00415B2D		       push    [ebp+envp]      ; pBlock
.text:00415B30		       call    _free
.text:00415B35		       pop     ecx
.text:00415B36		       mov     [ebp+envp], esi
.text:00415B39
.text:00415B39 loc_415B39:			       ; CODE XREF: ___wtomb_environ+62j
.text:00415B39					       ; ___wtomb_environ+67j
.text:00415B39		       add     edi, 4
.text:00415B3C		       mov     eax, [edi]
.text:00415B3E		       cmp     eax, esi
.text:00415B40		       jnz     short loc_415AE3
.text:00415B42
.text:00415B42 loc_415B42:			       ; CODE XREF: ___wtomb_environ+17j
.text:00415B42		       xor     eax, eax
.text:00415B44
.text:00415B44 loc_415B44:			       ; CODE XREF: ___wtomb_environ+88j
.text:00415B44		       pop     edi
.text:00415B45		       pop     esi
.text:00415B46		       pop     ebx
.text:00415B47		       leave
.text:00415B48		       retn
.text:00415B49 ; ---------------------------------------------------------------------------
.text:00415B49
.text:00415B49 loc_415B49:			       ; CODE XREF: ___wtomb_environ+2Fj
.text:00415B49					       ; ___wtomb_environ+40j ...
.text:00415B49		       or      eax, 0FFFFFFFFh
.text:00415B4C		       jmp     short loc_415B44
.text:00415B4E ; ---------------------------------------------------------------------------
.text:00415B4E
.text:00415B4E loc_415B4E:			       ; CODE XREF: ___wtomb_environ+52j
.text:00415B4E		       push    [ebp+envp]      ; pBlock
.text:00415B51		       call    _free
.text:00415B56		       pop     ecx
.text:00415B57		       jmp     short loc_415B49
.text:00415B57 ___wtomb_environ	endp
.text:00415B57
.text:00415B59
.text:00415B59 ; =============== S U B R O U T I N E =======================================
.text:00415B59
.text:00415B59
.text:00415B59 ; unsigned int __cdecl strnlen(const char *str, unsigned	int maxsize)
.text:00415B59 _strnlen	       proc near	       ; CODE XREF: _getenv+3Fp
.text:00415B59
.text:00415B59 str	       = dword ptr  4
.text:00415B59 maxsize	       = dword ptr  8
.text:00415B59
.text:00415B59		       xor     eax, eax
.text:00415B5B		       cmp     [esp+maxsize], eax
.text:00415B5F		       jbe     short locret_415B72
.text:00415B61		       mov     ecx, [esp+str]
.text:00415B65
.text:00415B65 loc_415B65:			       ; CODE XREF: _strnlen+17j
.text:00415B65		       cmp     byte ptr	[ecx], 0
.text:00415B68		       jz      short locret_415B72
.text:00415B6A		       inc     eax
.text:00415B6B		       inc     ecx
.text:00415B6C		       cmp     eax, [esp+maxsize]
.text:00415B70		       jb      short loc_415B65
.text:00415B72
.text:00415B72 locret_415B72:			       ; CODE XREF: _strnlen+6j
.text:00415B72					       ; _strnlen+Fj
.text:00415B72		       retn
.text:00415B72 _strnlen	       endp
.text:00415B72
.text:00415B72 ; ---------------------------------------------------------------------------
.text:00415B73		       align 10h
.text:00415B80
.text:00415B80 ; =============== S U B R O U T I N E =======================================
.text:00415B80
.text:00415B80
.text:00415B80 __allmul	       proc near	       ; CODE XREF: strtoxq+1D0p
.text:00415B80
.text:00415B80 arg_0	       = dword ptr  4
.text:00415B80 arg_4	       = dword ptr  8
.text:00415B80 arg_8	       = dword ptr  0Ch
.text:00415B80 arg_C	       = dword ptr  10h
.text:00415B80
.text:00415B80		       mov     eax, [esp+arg_4]
.text:00415B84		       mov     ecx, [esp+arg_C]
.text:00415B88		       or      ecx, eax
.text:00415B8A		       mov     ecx, [esp+arg_8]
.text:00415B8E		       jnz     short hard
.text:00415B90		       mov     eax, [esp+arg_0]
.text:00415B94		       mul     ecx
.text:00415B96		       retn    10h
.text:00415B99 ; ---------------------------------------------------------------------------
.text:00415B99
.text:00415B99 hard:				       ; CODE XREF: __allmul+Ej
.text:00415B99		       push    ebx
.text:00415B9A		       mul     ecx
.text:00415B9C		       mov     ebx, eax
.text:00415B9E		       mov     eax, [esp+4+arg_0]
.text:00415BA2		       mul     [esp+4+arg_C]
.text:00415BA6		       add     ebx, eax
.text:00415BA8		       mov     eax, [esp+4+arg_0]
.text:00415BAC		       mul     ecx
.text:00415BAE		       add     edx, ebx
.text:00415BB0		       pop     ebx
.text:00415BB1		       retn    10h
.text:00415BB1 __allmul	       endp
.text:00415BB1
.text:00415BB4
.text:00415BB4 ; =============== S U B R O U T I N E =======================================
.text:00415BB4
.text:00415BB4
.text:00415BB4 ; int __usercall	strncnt_0<eax>(const char *string<eax>,	int cnt)
.text:00415BB4 strncnt_0       proc near
.text:00415BB4
.text:00415BB4 cnt	       = dword ptr  4
.text:00415BB4
.text:00415BB4 string =	eax
.text:00415BB4		       mov     ecx, [esp+cnt]
.text:00415BB8		       jmp     short loc_415BC1
.text:00415BBA ; ---------------------------------------------------------------------------
.text:00415BBA
.text:00415BBA loc_415BBA:			       ; CODE XREF: strncnt_0+Fj
.text:00415BBA		       dec     ecx
.text:00415BBB		       cmp     byte ptr	[string], 0
.text:00415BBE		       jz      short loc_415BC6
.text:00415BC0		       inc     string
.text:00415BC1
.text:00415BC1 loc_415BC1:			       ; CODE XREF: strncnt_0+4j
.text:00415BC1		       test    ecx, ecx
.text:00415BC3		       jnz     short loc_415BBA
.text:00415BC5		       dec     ecx
.text:00415BC6
.text:00415BC6 loc_415BC6:			       ; CODE XREF: strncnt_0+Aj
.text:00415BC6		       mov     string, [esp+cnt]
.text:00415BCA		       sub     string, ecx
.text:00415BCC		       dec     string
.text:00415BCD		       retn
.text:00415BCD strncnt_0       endp
.text:00415BCD
.text:00415BCE
.text:00415BCE ; =============== S U B R O U T I N E =======================================
.text:00415BCE
.text:00415BCE ; Attributes: bp-based frame
.text:00415BCE
.text:00415BCE ; int __usercall	_crtCompareStringA_stat<eax>(localeinfo_struct *plocinfo<ecx>, unsigned	int Locale, unsigned int dwCmpFlags, const char	*lpString1<edx>, int cchCount1,	const char *lpString2, int cchCount2, int code_page)
.text:00415BCE __crtCompareStringA_stat	proc near      ; CODE XREF: ___crtCompareStringA+29p
.text:00415BCE
.text:00415BCE buff_size1      = dword ptr -2Ch
.text:00415BCE retcode	       = dword ptr -28h
.text:00415BCE lpSrcStr	       = dword ptr -24h
.text:00415BCE wbuffer1	       = dword ptr -20h
.text:00415BCE var_1C	       = dword ptr -1Ch
.text:00415BCE lpCPInfo	       = _cpinfo ptr -18h
.text:00415BCE var_4	       = dword ptr -4
.text:00415BCE Locale	       = dword ptr  8
.text:00415BCE dwCmpFlags      = dword ptr  0Ch
.text:00415BCE cchCount1       = dword ptr  10h
.text:00415BCE lpString2       = dword ptr  14h
.text:00415BCE cchCount2       = dword ptr  18h
.text:00415BCE code_page       = dword ptr  1Ch
.text:00415BCE
.text:00415BCE plocinfo	= ecx
.text:00415BCE lpString1 = edx
.text:00415BCE		       push    ebp
.text:00415BCF		       mov     ebp, esp
.text:00415BD1		       sub     esp, 2Ch
.text:00415BD4		       mov     eax, ___security_cookie
.text:00415BD9		       xor     eax, ebp
.text:00415BDB		       mov     [ebp+var_4], eax
.text:00415BDE		       mov     eax, [ebp+lpString2]
.text:00415BE1		       push    ebx
.text:00415BE2		       push    esi
.text:00415BE3		       push    edi
.text:00415BE4		       xor     edi, edi
.text:00415BE6		       cmp     f_use_5,	edi
.text:00415BEC		       mov     ebx, lpString1
.text:00415BEE		       mov     esi, plocinfo
.text:00415BF0		       mov     [ebp+lpSrcStr], ebx
.text:00415BF3		       mov     [ebp+var_1C], eax
.text:00415BF6		       jnz     short loc_415C30
.text:00415BF8		       push    1	       ; cchCount2
.text:00415BFA		       mov     eax, offset SrcStr
.text:00415BFF		       push    eax	       ; lpString2
.text:00415C00		       push    1	       ; cchCount1
.text:00415C02		       push    eax	       ; lpString1
.text:00415C03		       push    edi	       ; dwCmpFlags
.text:00415C04		       push    edi	       ; Locale
.text:00415C05		       call    ds:__imp__CompareStringW@24 ; CompareStringW(x,x,x,x,x,x)
.text:00415C0B		       test    eax, eax
.text:00415C0D		       jz      short loc_415C1B
.text:00415C0F		       mov     f_use_5,	1
.text:00415C19		       jmp     short loc_415C30
.text:00415C1B ; ---------------------------------------------------------------------------
.text:00415C1B
.text:00415C1B loc_415C1B:			       ; CODE XREF: __crtCompareStringA_stat+3Fj
.text:00415C1B		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00415C21		       cmp     eax, 78h
.text:00415C24		       jnz     short loc_415C30
.text:00415C26		       mov     f_use_5,	2
.text:00415C30
.text:00415C30 loc_415C30:			       ; CODE XREF: __crtCompareStringA_stat+28j
.text:00415C30					       ; __crtCompareStringA_stat+4Bj ...
.text:00415C30		       cmp     [ebp+cchCount1],	edi
.text:00415C33		       jle     short loc_415C76
.text:00415C35		       mov     plocinfo, [ebp+cchCount1]
.text:00415C38		       mov     eax, ebx
.text:00415C3A
.text:00415C3A loc_415C3A:			       ; CODE XREF: __crtCompareStringA_stat+75j
.text:00415C3A		       dec     plocinfo
.text:00415C3B		       cmp     byte ptr	[eax], 0
.text:00415C3E		       jz      short loc_415C48
.text:00415C40		       inc     eax
.text:00415C41		       cmp     plocinfo, edi
.text:00415C43		       jnz     short loc_415C3A
.text:00415C45		       or      plocinfo, 0FFFFFFFFh
.text:00415C48
.text:00415C48 loc_415C48:			       ; CODE XREF: __crtCompareStringA_stat+70j
.text:00415C48		       or      eax, 0FFFFFFFFh
.text:00415C4B		       sub     eax, plocinfo
.text:00415C4D		       add     [ebp+cchCount1],	eax
.text:00415C50
.text:00415C50 loc_415C50:			       ; CODE XREF: __crtCompareStringA_stat+ACj
.text:00415C50		       mov     lpString1, [ebp+cchCount2]
.text:00415C53		       cmp     lpString1, edi
.text:00415C55		       jle     short loc_415C83
.text:00415C57		       mov     eax, [ebp+var_1C]
.text:00415C5A		       mov     plocinfo, lpString1
.text:00415C5C
.text:00415C5C loc_415C5C:			       ; CODE XREF: __crtCompareStringA_stat+97j
.text:00415C5C		       dec     plocinfo
.text:00415C5D		       cmp     byte ptr	[eax], 0
.text:00415C60		       jz      short loc_415C6A
.text:00415C62		       inc     eax
.text:00415C63		       cmp     plocinfo, edi
.text:00415C65		       jnz     short loc_415C5C
.text:00415C67		       or      plocinfo, 0FFFFFFFFh
.text:00415C6A
.text:00415C6A loc_415C6A:			       ; CODE XREF: __crtCompareStringA_stat+92j
.text:00415C6A		       or      eax, 0FFFFFFFFh
.text:00415C6D		       sub     eax, plocinfo
.text:00415C6F		       add     lpString1, eax
.text:00415C71		       mov     [ebp+cchCount2],	lpString1
.text:00415C74		       jmp     short loc_415C88
.text:00415C76 ; ---------------------------------------------------------------------------
.text:00415C76
.text:00415C76 loc_415C76:			       ; CODE XREF: __crtCompareStringA_stat+65j
.text:00415C76		       cmp     [ebp+cchCount1],	0FFFFFFFFh
.text:00415C7A		       jge     short loc_415C50
.text:00415C7C
.text:00415C7C loc_415C7C:			       ; CODE XREF: __crtCompareStringA_stat+B8j
.text:00415C7C					       ; __crtCompareStringA_stat+D6j ...
.text:00415C7C		       xor     eax, eax
.text:00415C7E		       jmp     loc_415F45
.text:00415C83 ; ---------------------------------------------------------------------------
.text:00415C83
.text:00415C83 loc_415C83:			       ; CODE XREF: __crtCompareStringA_stat+87j
.text:00415C83		       cmp     lpString1, 0FFFFFFFFh
.text:00415C86		       jl      short loc_415C7C
.text:00415C88
.text:00415C88 loc_415C88:			       ; CODE XREF: __crtCompareStringA_stat+A6j
.text:00415C88		       mov     plocinfo, f_use_5
.text:00415C8E		       cmp     plocinfo, 2
.text:00415C91		       jz      loc_415E90
.text:00415C97		       cmp     plocinfo, edi
.text:00415C99		       jz      loc_415E90
.text:00415C9F		       xor     eax, eax
.text:00415CA1		       inc     eax
.text:00415CA2		       cmp     plocinfo, eax
.text:00415CA4		       jnz     short loc_415C7C
.text:00415CA6		       cmp     [ebp+code_page],	edi
.text:00415CA9		       mov     [ebp+retcode], edi
.text:00415CAC		       jnz     short loc_415CB6
.text:00415CAE		       mov     plocinfo, [esi]
.text:00415CB0		       mov     plocinfo, [plocinfo+4]
.text:00415CB3		       mov     [ebp+code_page],	plocinfo
.text:00415CB6
.text:00415CB6 loc_415CB6:			       ; CODE XREF: __crtCompareStringA_stat+DEj
.text:00415CB6		       cmp     [ebp+cchCount1],	edi
.text:00415CB9		       jz      short loc_415CC3
.text:00415CBB		       cmp     lpString1, edi
.text:00415CBD		       jnz     loc_415D5D
.text:00415CC3
.text:00415CC3 loc_415CC3:			       ; CODE XREF: __crtCompareStringA_stat+EBj
.text:00415CC3		       cmp     [ebp+cchCount1],	lpString1
.text:00415CC6		       jnz     short loc_415CD0
.text:00415CC8
.text:00415CC8 loc_415CC8:			       ; CODE XREF: __crtCompareStringA_stat+147j
.text:00415CC8					       ; __crtCompareStringA_stat+180j
.text:00415CC8		       push    2
.text:00415CCA
.text:00415CCA loc_415CCA:			       ; CODE XREF: __crtCompareStringA_stat+111j
.text:00415CCA		       pop     eax
.text:00415CCB		       jmp     loc_415F45
.text:00415CD0 ; ---------------------------------------------------------------------------
.text:00415CD0
.text:00415CD0 loc_415CD0:			       ; CODE XREF: __crtCompareStringA_stat+F8j
.text:00415CD0		       cmp     lpString1, eax
.text:00415CD2		       jg      loc_415F45
.text:00415CD8		       cmp     [ebp+cchCount1],	eax
.text:00415CDB		       jle     short loc_415CE1
.text:00415CDD
.text:00415CDD loc_415CDD:			       ; CODE XREF: __crtCompareStringA_stat+12Dj
.text:00415CDD					       ; __crtCompareStringA_stat+136j	...
.text:00415CDD		       push    3
.text:00415CDF		       jmp     short loc_415CCA
.text:00415CE1 ; ---------------------------------------------------------------------------
.text:00415CE1
.text:00415CE1 loc_415CE1:			       ; CODE XREF: __crtCompareStringA_stat+10Dj
.text:00415CE1		       lea     eax, [ebp+lpCPInfo]
.text:00415CE4		       push    eax	       ; lpCPInfo
.text:00415CE5		       push    [ebp+code_page] ; CodePage
.text:00415CE8		       call    ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:00415CEE		       test    eax, eax
.text:00415CF0		       jz      short loc_415C7C
.text:00415CF2		       cmp     [ebp+cchCount1],	edi
.text:00415CF5		       jle     short loc_415D20
.text:00415CF7		       cmp     [ebp+lpCPInfo.MaxCharSize], 2
.text:00415CFB		       jb      short loc_415CDD
.text:00415CFD		       cmp     [ebp+lpCPInfo.LeadByte],	0
.text:00415D01		       lea     eax, [ebp+lpCPInfo.LeadByte]
.text:00415D04		       jz      short loc_415CDD
.text:00415D06
.text:00415D06 loc_415D06:			       ; CODE XREF: __crtCompareStringA_stat+14Ej
.text:00415D06		       mov     dl, [eax+1]
.text:00415D09		       test    dl, dl
.text:00415D0B		       jz      short loc_415CDD
.text:00415D0D		       mov     cl, [ebx]
.text:00415D0F		       cmp     cl, [eax]
.text:00415D11		       jb      short loc_415D17
.text:00415D13		       cmp     cl, dl
.text:00415D15		       jbe     short loc_415CC8
.text:00415D17
.text:00415D17 loc_415D17:			       ; CODE XREF: __crtCompareStringA_stat+143j
.text:00415D17		       inc     eax
.text:00415D18		       inc     eax
.text:00415D19		       cmp     byte ptr	[eax], 0
.text:00415D1C		       jnz     short loc_415D06
.text:00415D1E		       jmp     short loc_415CDD
.text:00415D20 ; ---------------------------------------------------------------------------
.text:00415D20
.text:00415D20 loc_415D20:			       ; CODE XREF: __crtCompareStringA_stat+127j
.text:00415D20		       cmp     [ebp+cchCount2],	edi
.text:00415D23		       jle     short loc_415D5D
.text:00415D25		       cmp     [ebp+lpCPInfo.MaxCharSize], 2
.text:00415D29		       jnb     short loc_415D33
.text:00415D2B
.text:00415D2B loc_415D2B:			       ; CODE XREF: __crtCompareStringA_stat+16Cj
.text:00415D2B					       ; __crtCompareStringA_stat+173j	...
.text:00415D2B		       xor     eax, eax
.text:00415D2D		       inc     eax
.text:00415D2E		       jmp     loc_415F45
.text:00415D33 ; ---------------------------------------------------------------------------
.text:00415D33
.text:00415D33 loc_415D33:			       ; CODE XREF: __crtCompareStringA_stat+15Bj
.text:00415D33		       cmp     [ebp+lpCPInfo.LeadByte],	0
.text:00415D37		       lea     eax, [ebp+lpCPInfo.LeadByte]
.text:00415D3A		       jz      short loc_415D2B
.text:00415D3C
.text:00415D3C loc_415D3C:			       ; CODE XREF: __crtCompareStringA_stat+18Bj
.text:00415D3C		       mov     dl, [eax+1]
.text:00415D3F		       test    dl, dl
.text:00415D41		       jz      short loc_415D2B
.text:00415D43		       mov     plocinfo, [ebp+var_1C]
.text:00415D46		       mov     cl, [plocinfo]
.text:00415D48		       cmp     cl, [eax]
.text:00415D4A		       jb      short loc_415D54
.text:00415D4C		       cmp     cl, dl
.text:00415D4E		       jbe     loc_415CC8
.text:00415D54
.text:00415D54 loc_415D54:			       ; CODE XREF: __crtCompareStringA_stat+17Cj
.text:00415D54		       inc     eax
.text:00415D55		       inc     eax
.text:00415D56		       cmp     byte ptr	[eax], 0
.text:00415D59		       jnz     short loc_415D3C
.text:00415D5B		       jmp     short loc_415D2B
.text:00415D5D ; ---------------------------------------------------------------------------
.text:00415D5D
.text:00415D5D loc_415D5D:			       ; CODE XREF: __crtCompareStringA_stat+EFj
.text:00415D5D					       ; __crtCompareStringA_stat+155j
.text:00415D5D		       mov     esi, ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
.text:00415D63		       push    edi	       ; cchWideChar
.text:00415D64		       push    edi	       ; lpWideCharStr
.text:00415D65		       push    [ebp+cchCount1] ; cbMultiByte
.text:00415D68		       push    ebx	       ; lpMultiByteStr
.text:00415D69		       push    9	       ; dwFlags
.text:00415D6B		       push    [ebp+code_page] ; CodePage
.text:00415D6E		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00415D70		       mov     ebx, eax
.text:00415D72		       cmp     ebx, edi
.text:00415D74		       mov     [ebp+buff_size1], ebx
.text:00415D77		       jz      loc_415C7C
.text:00415D7D		       test    ebx, ebx
.text:00415D7F		       mov     edi, 400h
.text:00415D84		       jle     short loc_415DC6
.text:00415D86		       push    0FFFFFFE0h
.text:00415D88		       xor     lpString1, lpString1
.text:00415D8A		       pop     eax
.text:00415D8B		       div     ebx
.text:00415D8D		       cmp     eax, 2
.text:00415D90		       jb      short loc_415DC6
.text:00415D92		       lea     eax, [ebx+ebx+8]
.text:00415D96		       cmp     eax, edi
.text:00415D98		       ja      short loc_415DAD
.text:00415D9A		       call    __alloca_probe_16
.text:00415D9F		       mov     eax, esp
.text:00415DA1		       test    eax, eax
.text:00415DA3		       jz      short loc_415DC1
.text:00415DA5		       mov     dword ptr [eax],	0CCCCh
.text:00415DAB		       jmp     short loc_415DBE
.text:00415DAD ; ---------------------------------------------------------------------------
.text:00415DAD
.text:00415DAD loc_415DAD:			       ; CODE XREF: __crtCompareStringA_stat+1CAj
.text:00415DAD		       push    eax	       ; size
.text:00415DAE		       call    _malloc
.text:00415DB3		       test    eax, eax
.text:00415DB5		       pop     plocinfo
.text:00415DB6		       jz      short loc_415DC1
.text:00415DB8		       mov     dword ptr [eax],	0DDDDh
.text:00415DBE
.text:00415DBE loc_415DBE:			       ; CODE XREF: __crtCompareStringA_stat+1DDj
.text:00415DBE		       add     eax, 8
.text:00415DC1
.text:00415DC1 loc_415DC1:			       ; CODE XREF: __crtCompareStringA_stat+1D5j
.text:00415DC1					       ; __crtCompareStringA_stat+1E8j
.text:00415DC1		       mov     [ebp+wbuffer1], eax
.text:00415DC4		       jmp     short loc_415DCA
.text:00415DC6 ; ---------------------------------------------------------------------------
.text:00415DC6
.text:00415DC6 loc_415DC6:			       ; CODE XREF: __crtCompareStringA_stat+1B6j
.text:00415DC6					       ; __crtCompareStringA_stat+1C2j
.text:00415DC6		       and     [ebp+wbuffer1], 0
.text:00415DCA
.text:00415DCA loc_415DCA:			       ; CODE XREF: __crtCompareStringA_stat+1F6j
.text:00415DCA		       cmp     [ebp+wbuffer1], 0
.text:00415DCE		       jz      loc_415C7C
.text:00415DD4		       push    ebx	       ; cchWideChar
.text:00415DD5		       push    [ebp+wbuffer1]  ; lpWideCharStr
.text:00415DD8		       push    [ebp+cchCount1] ; cbMultiByte
.text:00415DDB		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:00415DDE		       push    1	       ; dwFlags
.text:00415DE0		       push    [ebp+code_page] ; CodePage
.text:00415DE3		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00415DE5		       test    eax, eax
.text:00415DE7		       jz      error_cleanup_4
.text:00415DED		       push    0	       ; cchWideChar
.text:00415DEF		       push    0	       ; lpWideCharStr
.text:00415DF1		       push    [ebp+cchCount2] ; cbMultiByte
.text:00415DF4		       push    [ebp+var_1C]    ; lpMultiByteStr
.text:00415DF7		       push    9	       ; dwFlags
.text:00415DF9		       push    [ebp+code_page] ; CodePage
.text:00415DFC		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00415DFE		       mov     ebx, eax
.text:00415E00		       test    ebx, ebx
.text:00415E02		       jz      short error_cleanup_4
.text:00415E04		       jle     short loc_415E48
.text:00415E06		       push    0FFFFFFE0h
.text:00415E08		       xor     lpString1, lpString1
.text:00415E0A		       pop     eax
.text:00415E0B		       div     ebx
.text:00415E0D		       cmp     eax, 2
.text:00415E10		       jb      short loc_415E48
.text:00415E12		       lea     eax, [ebx+ebx+8]
.text:00415E16		       cmp     eax, edi
.text:00415E18		       ja      short loc_415E30
.text:00415E1A		       call    __alloca_probe_16
.text:00415E1F		       mov     edi, esp
.text:00415E21		       test    edi, edi
.text:00415E23		       jz      short error_cleanup_4
.text:00415E25		       mov     dword ptr [edi],	0CCCCh
.text:00415E2B		       add     edi, 8
.text:00415E2E		       jmp     short loc_415E4A
.text:00415E30 ; ---------------------------------------------------------------------------
.text:00415E30
.text:00415E30 loc_415E30:			       ; CODE XREF: __crtCompareStringA_stat+24Aj
.text:00415E30		       push    eax	       ; size
.text:00415E31		       call    _malloc
.text:00415E36		       test    eax, eax
.text:00415E38		       pop     plocinfo
.text:00415E39		       jz      short loc_415E44
.text:00415E3B		       mov     dword ptr [eax],	0DDDDh
.text:00415E41		       add     eax, 8
.text:00415E44
.text:00415E44 loc_415E44:			       ; CODE XREF: __crtCompareStringA_stat+26Bj
.text:00415E44		       mov     edi, eax
.text:00415E46		       jmp     short loc_415E4A
.text:00415E48 ; ---------------------------------------------------------------------------
.text:00415E48
.text:00415E48 loc_415E48:			       ; CODE XREF: __crtCompareStringA_stat+236j
.text:00415E48					       ; __crtCompareStringA_stat+242j
.text:00415E48		       xor     edi, edi
.text:00415E4A
.text:00415E4A loc_415E4A:			       ; CODE XREF: __crtCompareStringA_stat+260j
.text:00415E4A					       ; __crtCompareStringA_stat+278j
.text:00415E4A		       test    edi, edi
.text:00415E4C		       jz      short error_cleanup_4
.text:00415E4E		       push    ebx	       ; cchWideChar
.text:00415E4F		       push    edi	       ; lpWideCharStr
.text:00415E50		       push    [ebp+cchCount2] ; cbMultiByte
.text:00415E53		       push    [ebp+var_1C]    ; lpMultiByteStr
.text:00415E56		       push    1	       ; dwFlags
.text:00415E58		       push    [ebp+code_page] ; CodePage
.text:00415E5B		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00415E5D		       test    eax, eax
.text:00415E5F		       jz      short loc_415E78
.text:00415E61		       push    ebx	       ; cchCount2
.text:00415E62		       push    edi	       ; lpString2
.text:00415E63		       push    [ebp+buff_size1]	; cchCount1
.text:00415E66		       push    [ebp+wbuffer1]  ; lpString1
.text:00415E69		       push    [ebp+dwCmpFlags]	; dwCmpFlags
.text:00415E6C		       push    [ebp+Locale]    ; Locale
.text:00415E6F		       call    ds:__imp__CompareStringW@24 ; CompareStringW(x,x,x,x,x,x)
.text:00415E75		       mov     [ebp+retcode], eax
.text:00415E78
.text:00415E78 loc_415E78:			       ; CODE XREF: __crtCompareStringA_stat+291j
.text:00415E78		       push    edi	       ; _Memory
.text:00415E79		       call    __freea
.text:00415E7E		       pop     plocinfo
.text:00415E7F
.text:00415E7F error_cleanup_4:			       ; CODE XREF: __crtCompareStringA_stat+219j
.text:00415E7F					       ; __crtCompareStringA_stat+234j	...
.text:00415E7F		       push    [ebp+wbuffer1]  ; _Memory
.text:00415E82		       call    __freea
.text:00415E87		       mov     eax, [ebp+retcode]
.text:00415E8A		       pop     plocinfo
.text:00415E8B		       jmp     loc_415F45
.text:00415E90 ; ---------------------------------------------------------------------------
.text:00415E90
.text:00415E90 loc_415E90:			       ; CODE XREF: __crtCompareStringA_stat+C3j
.text:00415E90					       ; __crtCompareStringA_stat+CBj
.text:00415E90		       xor     edi, edi
.text:00415E92		       xor     ebx, ebx
.text:00415E94		       cmp     [ebp+Locale], edi
.text:00415E97		       jnz     short loc_415EA1
.text:00415E99		       mov     eax, [esi]
.text:00415E9B		       mov     eax, [eax+14h]
.text:00415E9E		       mov     [ebp+Locale], eax
.text:00415EA1
.text:00415EA1 loc_415EA1:			       ; CODE XREF: __crtCompareStringA_stat+2C9j
.text:00415EA1		       cmp     [ebp+code_page],	edi
.text:00415EA4		       jnz     short loc_415EAE
.text:00415EA6		       mov     eax, [esi]
.text:00415EA8		       mov     eax, [eax+4]
.text:00415EAB		       mov     [ebp+code_page],	eax
.text:00415EAE
.text:00415EAE loc_415EAE:			       ; CODE XREF: __crtCompareStringA_stat+2D6j
.text:00415EAE		       push    [ebp+Locale]    ; lcid
.text:00415EB1		       call    ___ansicp
.text:00415EB6		       mov     esi, eax
.text:00415EB8		       cmp     esi, 0FFFFFFFFh
.text:00415EBB		       pop     plocinfo
.text:00415EBC		       jz      loc_415C7C
.text:00415EC2		       cmp     esi, [ebp+code_page]
.text:00415EC5		       jz      short loc_415F17
.text:00415EC7		       push    0	       ; cchDest
.text:00415EC9		       push    0	       ; lpDestStr
.text:00415ECB		       lea     eax, [ebp+cchCount1]
.text:00415ECE		       push    eax	       ; pcchSrc
.text:00415ECF		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:00415ED2		       push    esi	       ; toCP
.text:00415ED3		       push    [ebp+code_page] ; fromCP
.text:00415ED6		       call    ___convertcp
.text:00415EDB		       mov     ebx, eax
.text:00415EDD		       add     esp, 18h
.text:00415EE0		       test    ebx, ebx
.text:00415EE2		       jz      loc_415C7C
.text:00415EE8		       push    0	       ; cchDest
.text:00415EEA		       push    0	       ; lpDestStr
.text:00415EEC		       lea     eax, [ebp+cchCount2]
.text:00415EEF		       push    eax	       ; pcchSrc
.text:00415EF0		       push    [ebp+var_1C]    ; lpSrcStr
.text:00415EF3		       push    esi	       ; toCP
.text:00415EF4		       push    [ebp+code_page] ; fromCP
.text:00415EF7		       call    ___convertcp
.text:00415EFC		       mov     edi, eax
.text:00415EFE		       add     esp, 18h
.text:00415F01		       test    edi, edi
.text:00415F03		       jnz     short loc_415F11
.text:00415F05		       push    ebx	       ; pBlock
.text:00415F06		       call    _free
.text:00415F0B		       pop     plocinfo
.text:00415F0C		       jmp     loc_415C7C
.text:00415F11 ; ---------------------------------------------------------------------------
.text:00415F11
.text:00415F11 loc_415F11:			       ; CODE XREF: __crtCompareStringA_stat+335j
.text:00415F11		       mov     [ebp+lpSrcStr], ebx
.text:00415F14		       mov     [ebp+var_1C], edi
.text:00415F17
.text:00415F17 loc_415F17:			       ; CODE XREF: __crtCompareStringA_stat+2F7j
.text:00415F17		       push    [ebp+cchCount2] ; cchCount2
.text:00415F1A		       push    [ebp+var_1C]    ; lpString2
.text:00415F1D		       push    [ebp+cchCount1] ; cchCount1
.text:00415F20		       push    [ebp+lpSrcStr]  ; lpString1
.text:00415F23		       push    [ebp+dwCmpFlags]	; dwCmpFlags
.text:00415F26		       push    [ebp+Locale]    ; Locale
.text:00415F29		       call    ds:__imp__CompareStringA@24 ; CompareStringA(x,x,x,x,x,x)
.text:00415F2F		       test    ebx, ebx
.text:00415F31		       mov     esi, eax
.text:00415F33		       jz      short loc_415F43
.text:00415F35		       push    ebx	       ; pBlock
.text:00415F36		       call    _free
.text:00415F3B		       push    edi	       ; pBlock
.text:00415F3C		       call    _free
.text:00415F41		       pop     plocinfo
.text:00415F42		       pop     plocinfo
.text:00415F43
.text:00415F43 loc_415F43:			       ; CODE XREF: __crtCompareStringA_stat+365j
.text:00415F43		       mov     eax, esi
.text:00415F45
.text:00415F45 loc_415F45:			       ; CODE XREF: __crtCompareStringA_stat+B0j
.text:00415F45					       ; __crtCompareStringA_stat+FDj ...
.text:00415F45		       lea     esp, [ebp-38h]
.text:00415F48		       pop     edi
.text:00415F49		       pop     esi
.text:00415F4A		       pop     ebx
.text:00415F4B		       mov     plocinfo, [ebp+var_4]
.text:00415F4E		       xor     plocinfo, ebp   ; cookie
.text:00415F50		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00415F55		       leave
.text:00415F56		       retn
.text:00415F56 __crtCompareStringA_stat	endp
.text:00415F56
.text:00415F57
.text:00415F57 ; =============== S U B R O U T I N E =======================================
.text:00415F57
.text:00415F57 ; Attributes: bp-based frame
.text:00415F57
.text:00415F57 ; int __cdecl __crtCompareStringA(localeinfo_struct *plocinfo, unsigned int Locale, unsigned int	dwCmpFlags, const char *lpString1, int cchCount1, const	char *lpString2, int cchCount2,	int code_page)
.text:00415F57 ___crtCompareStringA proc near	       ; CODE XREF: __mbsnbicoll_l+BDp
.text:00415F57					       ; __strnicoll_l+BEp
.text:00415F57
.text:00415F57 _loc_update     = _LocaleUpdate ptr -10h
.text:00415F57 plocinfo	       = dword ptr  8
.text:00415F57 Locale	       = dword ptr  0Ch
.text:00415F57 dwCmpFlags      = dword ptr  10h
.text:00415F57 lpString1       = dword ptr  14h
.text:00415F57 cchCount1       = dword ptr  18h
.text:00415F57 lpString2       = dword ptr  1Ch
.text:00415F57 cchCount2       = dword ptr  20h
.text:00415F57 code_page       = dword ptr  24h
.text:00415F57
.text:00415F57		       push    ebp
.text:00415F58		       mov     ebp, esp
.text:00415F5A		       sub     esp, 10h
.text:00415F5D		       push    [ebp+plocinfo]  ; plocinfo
.text:00415F60		       lea     ecx, [ebp+_loc_update] ;	this
.text:00415F63		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00415F68		       push    [ebp+code_page] ; code_page
.text:00415F6B		       mov     edx, [ebp+lpString1] ; lpString1
.text:00415F6E		       push    [ebp+cchCount2] ; cchCount2
.text:00415F71		       lea     ecx, [ebp+_loc_update] ;	plocinfo
.text:00415F74		       push    [ebp+lpString2] ; lpString2
.text:00415F77		       push    [ebp+cchCount1] ; cchCount1
.text:00415F7A		       push    [ebp+dwCmpFlags]	; dwCmpFlags
.text:00415F7D		       push    [ebp+Locale]    ; Locale
.text:00415F80		       call    __crtCompareStringA_stat
.text:00415F85		       add     esp, 18h
.text:00415F88		       cmp     [ebp+_loc_update.updated], 0
.text:00415F8C		       jz      short locret_415F95
.text:00415F8E		       mov     ecx, [ebp+_loc_update.ptd]
.text:00415F91		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00415F95
.text:00415F95 locret_415F95:			       ; CODE XREF: ___crtCompareStringA+35j
.text:00415F95		       leave
.text:00415F96		       retn
.text:00415F96 ___crtCompareStringA endp
.text:00415F96
.text:00415F97
.text:00415F97 ; =============== S U B R O U T I N E =======================================
.text:00415F97
.text:00415F97 ; Attributes: bp-based frame
.text:00415F97
.text:00415F97 ; int __cdecl _strnicoll_l(const	char *_string1,	const char *_string2, unsigned int count, localeinfo_struct *plocinfo)
.text:00415F97 __strnicoll_l   proc near	       ; CODE XREF: __mbsnbicoll_l+9Cp
.text:00415F97					       ; __strnicoll+1Dp
.text:00415F97
.text:00415F97 _loc_update     = _LocaleUpdate ptr -10h
.text:00415F97 _string1	       = dword ptr  8
.text:00415F97 _string2	       = dword ptr  0Ch
.text:00415F97 count	       = dword ptr  10h
.text:00415F97 plocinfo	       = dword ptr  14h
.text:00415F97
.text:00415F97		       push    ebp
.text:00415F98		       mov     ebp, esp
.text:00415F9A		       sub     esp, 10h
.text:00415F9D		       push    ebx
.text:00415F9E		       push    [ebp+plocinfo]  ; plocinfo
.text:00415FA1		       lea     ecx, [ebp+_loc_update] ;	this
.text:00415FA4		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00415FA9		       mov     edx, [ebp+count]
.text:00415FAC		       xor     ebx, ebx
.text:00415FAE		       cmp     edx, ebx
.text:00415FB0		       jnz     short loc_415FC5
.text:00415FB2		       cmp     [ebp+_loc_update.updated], bl
.text:00415FB5		       jz      short loc_415FBE
.text:00415FB7		       mov     eax, [ebp+_loc_update.ptd]
.text:00415FBA		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415FBE
.text:00415FBE loc_415FBE:			       ; CODE XREF: __strnicoll_l+1Ej
.text:00415FBE		       xor     eax, eax
.text:00415FC0		       jmp     loc_41608C
.text:00415FC5 ; ---------------------------------------------------------------------------
.text:00415FC5
.text:00415FC5 loc_415FC5:			       ; CODE XREF: __strnicoll_l+19j
.text:00415FC5		       cmp     [ebp+_string1], ebx
.text:00415FC8		       jnz     short loc_415FF8
.text:00415FCA
.text:00415FCA loc_415FCA:			       ; CODE XREF: __strnicoll_l+64j
.text:00415FCA		       call    __errno
.text:00415FCF		       push    ebx	       ; pReserved
.text:00415FD0		       push    ebx	       ; nLine
.text:00415FD1		       push    ebx	       ; pszFile
.text:00415FD2		       push    ebx	       ; pszFunction
.text:00415FD3		       push    ebx	       ; pszExpression
.text:00415FD4		       mov     dword ptr [eax],	16h
.text:00415FDA		       call    __invalid_parameter
.text:00415FDF		       add     esp, 14h
.text:00415FE2		       cmp     [ebp+_loc_update.updated], bl
.text:00415FE5		       jz      short loc_415FEE
.text:00415FE7		       mov     eax, [ebp+_loc_update.ptd]
.text:00415FEA		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415FEE
.text:00415FEE loc_415FEE:			       ; CODE XREF: __strnicoll_l+4Ej
.text:00415FEE		       mov     eax, 7FFFFFFFh
.text:00415FF3		       jmp     loc_41608C
.text:00415FF8 ; ---------------------------------------------------------------------------
.text:00415FF8
.text:00415FF8 loc_415FF8:			       ; CODE XREF: __strnicoll_l+31j
.text:00415FF8		       cmp     [ebp+_string2], ebx
.text:00415FFB		       jz      short loc_415FCA
.text:00415FFD		       push    esi
.text:00415FFE		       mov     esi, 7FFFFFFFh
.text:00416003		       cmp     edx, esi
.text:00416005		       jbe     short loc_416021
.text:00416007		       call    __errno
.text:0041600C		       push    ebx	       ; pReserved
.text:0041600D		       push    ebx	       ; nLine
.text:0041600E		       push    ebx	       ; pszFile
.text:0041600F		       push    ebx	       ; pszFunction
.text:00416010		       push    ebx	       ; pszExpression
.text:00416011		       mov     dword ptr [eax],	16h
.text:00416017		       call    __invalid_parameter
.text:0041601C		       add     esp, 14h
.text:0041601F		       jmp     short loc_41606C
.text:00416021 ; ---------------------------------------------------------------------------
.text:00416021
.text:00416021 loc_416021:			       ; CODE XREF: __strnicoll_l+6Ej
.text:00416021		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00416024		       mov     ecx, [eax+10h]
.text:00416027		       cmp     ecx, ebx
.text:00416029		       jnz     short loc_416040
.text:0041602B		       lea     eax, [ebp+_loc_update]
.text:0041602E		       push    eax	       ; plocinfo
.text:0041602F		       push    edx	       ; count
.text:00416030		       push    [ebp+_string2]  ; src
.text:00416033		       push    [ebp+_string1]  ; dst
.text:00416036		       call    __strnicmp_l
.text:0041603B		       add     esp, 10h
.text:0041603E		       jmp     short loc_41607F
.text:00416040 ; ---------------------------------------------------------------------------
.text:00416040
.text:00416040 loc_416040:			       ; CODE XREF: __strnicoll_l+92j
.text:00416040		       push    dword ptr [eax+8] ; code_page
.text:00416043		       lea     eax, [ebp+_loc_update]
.text:00416046		       push    edx	       ; cchCount2
.text:00416047		       push    [ebp+_string2]  ; lpString2
.text:0041604A		       push    edx	       ; cchCount1
.text:0041604B		       push    [ebp+_string1]  ; lpString1
.text:0041604E		       push    1001h	       ; dwCmpFlags
.text:00416053		       push    ecx	       ; Locale
.text:00416054		       push    eax	       ; plocinfo
.text:00416055		       call    ___crtCompareStringA
.text:0041605A		       add     esp, 20h
.text:0041605D		       cmp     eax, ebx
.text:0041605F		       jnz     short loc_41607C
.text:00416061		       call    __errno
.text:00416066		       mov     dword ptr [eax],	16h
.text:0041606C
.text:0041606C loc_41606C:			       ; CODE XREF: __strnicoll_l+88j
.text:0041606C		       cmp     [ebp+_loc_update.updated], bl
.text:0041606F		       jz      short loc_416078
.text:00416071		       mov     eax, [ebp+_loc_update.ptd]
.text:00416074		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00416078
.text:00416078 loc_416078:			       ; CODE XREF: __strnicoll_l+D8j
.text:00416078		       mov     eax, esi
.text:0041607A		       jmp     short loc_41608B
.text:0041607C ; ---------------------------------------------------------------------------
.text:0041607C
.text:0041607C loc_41607C:			       ; CODE XREF: __strnicoll_l+C8j
.text:0041607C		       add     eax, 0FFFFFFFEh
.text:0041607F
.text:0041607F loc_41607F:			       ; CODE XREF: __strnicoll_l+A7j
.text:0041607F		       cmp     [ebp+_loc_update.updated], bl
.text:00416082		       jz      short loc_41608B
.text:00416084		       mov     ecx, [ebp+_loc_update.ptd]
.text:00416087		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0041608B
.text:0041608B loc_41608B:			       ; CODE XREF: __strnicoll_l+E3j
.text:0041608B					       ; __strnicoll_l+EBj
.text:0041608B		       pop     esi
.text:0041608C
.text:0041608C loc_41608C:			       ; CODE XREF: __strnicoll_l+29j
.text:0041608C					       ; __strnicoll_l+5Cj
.text:0041608C		       pop     ebx
.text:0041608D		       leave
.text:0041608E		       retn
.text:0041608E __strnicoll_l   endp
.text:0041608E
.text:0041608F
.text:0041608F ; =============== S U B R O U T I N E =======================================
.text:0041608F
.text:0041608F ; Attributes: bp-based frame
.text:0041608F
.text:0041608F ; int __cdecl _strnicoll(const char *_string1, const char *_string2, unsigned int count)
.text:0041608F __strnicoll     proc near
.text:0041608F
.text:0041608F _string1	       = dword ptr  8
.text:0041608F _string2	       = dword ptr  0Ch
.text:0041608F count	       = dword ptr  10h
.text:0041608F
.text:0041608F		       push    ebp
.text:00416090		       mov     ebp, esp
.text:00416092		       cmp     ___locale_changed, 0
.text:00416099		       jnz     short loc_4160A1
.text:0041609B		       pop     ebp
.text:0041609C		       jmp     __strnicmp
.text:004160A1 ; ---------------------------------------------------------------------------
.text:004160A1
.text:004160A1 loc_4160A1:			       ; CODE XREF: __strnicoll+Aj
.text:004160A1		       push    0	       ; plocinfo
.text:004160A3		       push    [ebp+count]     ; count
.text:004160A6		       push    [ebp+_string2]  ; _string2
.text:004160A9		       push    [ebp+_string1]  ; _string1
.text:004160AC		       call    __strnicoll_l
.text:004160B1		       add     esp, 10h
.text:004160B4		       pop     ebp
.text:004160B5		       retn
.text:004160B5 __strnicoll     endp
.text:004160B5
.text:004160B6
.text:004160B6 ; =============== S U B R O U T I N E =======================================
.text:004160B6
.text:004160B6
.text:004160B6 ; int __usercall	findenv<eax>(const char	*name, int len<edi>)
.text:004160B6 findenv	       proc near	       ; CODE XREF: ___crtsetenv+EEp
.text:004160B6
.text:004160B6 name	       = dword ptr  4
.text:004160B6
.text:004160B6 len = edi
.text:004160B6		       push    esi
.text:004160B7		       mov     esi, __environ
.text:004160BD		       jmp     short loc_4160E1
.text:004160BF ; ---------------------------------------------------------------------------
.text:004160BF
.text:004160BF loc_4160BF:			       ; CODE XREF: findenv+2Fj
.text:004160BF		       push    len	       ; n
.text:004160C0		       push    eax	       ; s2
.text:004160C1		       push    [esp+0Ch+name]  ; s1
.text:004160C5		       call    __mbsnbicoll
.text:004160CA		       add     esp, 0Ch
.text:004160CD		       test    eax, eax
.text:004160CF		       jnz     short loc_4160DE
.text:004160D1		       mov     eax, [esi]
.text:004160D3		       mov     al, [len+eax]
.text:004160D6		       cmp     al, 3Dh
.text:004160D8		       jz      short loc_4160F6
.text:004160DA		       test    al, al
.text:004160DC		       jz      short loc_4160F6
.text:004160DE
.text:004160DE loc_4160DE:			       ; CODE XREF: findenv+19j
.text:004160DE		       add     esi, 4
.text:004160E1
.text:004160E1 loc_4160E1:			       ; CODE XREF: findenv+7j
.text:004160E1		       mov     eax, [esi]
.text:004160E3		       test    eax, eax
.text:004160E5		       jnz     short loc_4160BF
.text:004160E7		       mov     eax, esi
.text:004160E9		       sub     eax, __environ
.text:004160EF		       pop     esi
.text:004160F0		       sar     eax, 2
.text:004160F3		       neg     eax
.text:004160F5		       retn
.text:004160F6 ; ---------------------------------------------------------------------------
.text:004160F6
.text:004160F6 loc_4160F6:			       ; CODE XREF: findenv+22j
.text:004160F6					       ; findenv+26j
.text:004160F6		       mov     eax, esi
.text:004160F8		       sub     eax, __environ
.text:004160FE		       pop     esi
.text:004160FF		       sar     eax, 2
.text:00416102		       retn
.text:00416102 findenv	       endp
.text:00416102
.text:00416103
.text:00416103 ; =============== S U B R O U T I N E =======================================
.text:00416103
.text:00416103 ; Attributes: bp-based frame
.text:00416103
.text:00416103 ; char **__usercall copy_environ<eax>(char **oldenviron<edi>)
.text:00416103 copy_environ    proc near	       ; CODE XREF: ___crtsetenv+6Ap
.text:00416103
.text:00416103 newenviron      = dword ptr -4
.text:00416103
.text:00416103 oldenviron = edi
.text:00416103		       push    ebp
.text:00416104		       mov     ebp, esp
.text:00416106		       push    ecx
.text:00416107		       xor     eax, eax
.text:00416109		       test    oldenviron, oldenviron
.text:0041610B		       mov     ecx, oldenviron
.text:0041610D		       jnz     short loc_416111
.text:0041610F		       leave
.text:00416110		       retn
.text:00416111 ; ---------------------------------------------------------------------------
.text:00416111
.text:00416111 loc_416111:			       ; CODE XREF: copy_environ+Aj
.text:00416111		       cmp     [oldenviron], eax
.text:00416113		       jz      short loc_41611E
.text:00416115
.text:00416115 loc_416115:			       ; CODE XREF: copy_environ+19j
.text:00416115		       add     ecx, 4
.text:00416118		       inc     eax
.text:00416119		       cmp     dword ptr [ecx],	0
.text:0041611C		       jnz     short loc_416115
.text:0041611E
.text:0041611E loc_41611E:			       ; CODE XREF: copy_environ+10j
.text:0041611E		       push    ebx
.text:0041611F		       push    esi
.text:00416120		       inc     eax
.text:00416121		       push    4	       ; size
.text:00416123		       push    eax	       ; count
.text:00416124		       call    __calloc_crt
.text:00416129		       mov     esi, eax
.text:0041612B		       test    esi, esi
.text:0041612D		       pop     ecx
.text:0041612E		       pop     ecx
.text:0041612F		       mov     [ebp+newenviron], esi
.text:00416132		       jnz     short loc_41613C
.text:00416134		       push    9	       ; rterrnum
.text:00416136		       call    __amsg_exit
.text:0041613B		       pop     ecx
.text:0041613C
.text:0041613C loc_41613C:			       ; CODE XREF: copy_environ+2Fj
.text:0041613C		       mov     eax, [oldenviron]
.text:0041613E		       mov     ebx, oldenviron
.text:00416140		       jmp     short loc_416153
.text:00416142 ; ---------------------------------------------------------------------------
.text:00416142
.text:00416142 loc_416142:			       ; CODE XREF: copy_environ+52j
.text:00416142		       push    eax	       ; string
.text:00416143		       call    __strdup
.text:00416148		       mov     [esi], eax
.text:0041614A		       add     esi, 4
.text:0041614D		       add     ebx, 4
.text:00416150		       mov     eax, [ebx]
.text:00416152		       pop     ecx
.text:00416153
.text:00416153 loc_416153:			       ; CODE XREF: copy_environ+3Dj
.text:00416153		       test    eax, eax
.text:00416155		       jnz     short loc_416142
.text:00416157		       and     [esi], eax
.text:00416159		       mov     eax, [ebp+newenviron]
.text:0041615C		       pop     esi
.text:0041615D		       pop     ebx
.text:0041615E		       leave
.text:0041615F		       retn
.text:0041615F copy_environ    endp
.text:0041615F
.text:00416160
.text:00416160 ; =============== S U B R O U T I N E =======================================
.text:00416160
.text:00416160 ; Attributes: bp-based frame
.text:00416160
.text:00416160 ; int __cdecl __crtsetenv(char **poption, const int primary)
.text:00416160 ___crtsetenv    proc near	       ; CODE XREF: ___wtomb_environ+59p
.text:00416160
.text:00416160 env	       = dword ptr -14h
.text:00416160 retval	       = dword ptr -10h
.text:00416160 equal	       = dword ptr -0Ch
.text:00416160 remove	       = dword ptr -8
.text:00416160 option	       = dword ptr -4
.text:00416160 poption	       = dword ptr  8
.text:00416160 primary	       = dword ptr  0Ch
.text:00416160
.text:00416160		       push    ebp
.text:00416161		       mov     ebp, esp
.text:00416163		       sub     esp, 14h
.text:00416166		       mov     eax, [ebp+poption]
.text:00416169		       push    ebx
.text:0041616A		       xor     ebx, ebx
.text:0041616C		       cmp     eax, ebx
.text:0041616E		       push    edi
.text:0041616F		       mov     [ebp+retval], ebx
.text:00416172		       jnz     short loc_416191
.text:00416174		       call    __errno
.text:00416179		       push    ebx	       ; pReserved
.text:0041617A		       push    ebx	       ; nLine
.text:0041617B		       push    ebx	       ; pszFile
.text:0041617C		       push    ebx	       ; pszFunction
.text:0041617D		       push    ebx	       ; pszExpression
.text:0041617E		       mov     dword ptr [eax],	16h
.text:00416184		       call    __invalid_parameter
.text:00416189		       add     esp, 14h
.text:0041618C		       or      eax, 0FFFFFFFFh
.text:0041618F		       jmp     short loc_4161FD
.text:00416191 ; ---------------------------------------------------------------------------
.text:00416191
.text:00416191 loc_416191:			       ; CODE XREF: ___crtsetenv+12j
.text:00416191		       push    esi
.text:00416192		       mov     esi, [eax]
.text:00416194		       cmp     esi, ebx
.text:00416196		       mov     [ebp+option], esi
.text:00416199		       jz      short loc_4161EE
.text:0041619B		       push    3Dh	       ; c
.text:0041619D		       push    esi	       ; string
.text:0041619E		       call    __mbschr
.text:004161A3		       cmp     eax, ebx
.text:004161A5		       pop     ecx
.text:004161A6		       pop     ecx
.text:004161A7		       mov     [ebp+equal], eax
.text:004161AA		       jz      short loc_4161EE
.text:004161AC		       cmp     esi, eax
.text:004161AE		       jz      short loc_4161EE
.text:004161B0		       xor     ecx, ecx
.text:004161B2		       cmp     [eax+1],	bl
.text:004161B5		       mov     eax, __environ
.text:004161BA		       setz    cl
.text:004161BD		       cmp     eax, ___initenv
.text:004161C3		       mov     [ebp+remove], ecx
.text:004161C6		       jnz     short loc_4161D4
.text:004161C8		       mov     edi, eax	       ; oldenviron
.text:004161CA		       call    copy_environ
.text:004161CF		       mov     __environ, eax
.text:004161D4
.text:004161D4 loc_4161D4:			       ; CODE XREF: ___crtsetenv+66j
.text:004161D4		       cmp     eax, ebx
.text:004161D6		       jnz     short loc_416238
.text:004161D8		       cmp     [ebp+primary], ebx
.text:004161DB		       jz      short loc_416201
.text:004161DD		       cmp     __wenviron, ebx
.text:004161E3		       jz      short loc_416201
.text:004161E5		       call    ___wtomb_environ
.text:004161EA		       test    eax, eax
.text:004161EC		       jz      short loc_416238
.text:004161EE
.text:004161EE loc_4161EE:			       ; CODE XREF: ___crtsetenv+39j
.text:004161EE					       ; ___crtsetenv+4Aj ...
.text:004161EE		       call    __errno
.text:004161F3		       mov     dword ptr [eax],	16h
.text:004161F9
.text:004161F9 loc_4161F9:			       ; CODE XREF: ___crtsetenv+B9j
.text:004161F9					       ; ___crtsetenv+D4j ...
.text:004161F9		       or      eax, 0FFFFFFFFh
.text:004161FC
.text:004161FC loc_4161FC:			       ; CODE XREF: ___crtsetenv+232j
.text:004161FC					       ; ___crtsetenv+247j
.text:004161FC		       pop     esi
.text:004161FD
.text:004161FD loc_4161FD:			       ; CODE XREF: ___crtsetenv+2Fj
.text:004161FD		       pop     edi
.text:004161FE		       pop     ebx
.text:004161FF		       leave
.text:00416200		       retn
.text:00416201 ; ---------------------------------------------------------------------------
.text:00416201
.text:00416201 loc_416201:			       ; CODE XREF: ___crtsetenv+7Bj
.text:00416201					       ; ___crtsetenv+83j
.text:00416201		       cmp     [ebp+remove], ebx
.text:00416204		       jnz     loc_4163A5
.text:0041620A		       push    4	       ; cb
.text:0041620C		       call    __malloc_crt
.text:00416211		       cmp     eax, ebx
.text:00416213		       pop     ecx
.text:00416214		       mov     __environ, eax
.text:00416219		       jz      short loc_4161F9
.text:0041621B		       mov     [eax], ebx
.text:0041621D		       cmp     __wenviron, ebx
.text:00416223		       jnz     short loc_416238
.text:00416225		       push    4	       ; cb
.text:00416227		       call    __malloc_crt
.text:0041622C		       cmp     eax, ebx
.text:0041622E		       pop     ecx
.text:0041622F		       mov     __wenviron, eax
.text:00416234		       jz      short loc_4161F9
.text:00416236		       mov     [eax], ebx
.text:00416238
.text:00416238 loc_416238:			       ; CODE XREF: ___crtsetenv+76j
.text:00416238					       ; ___crtsetenv+8Cj ...
.text:00416238		       mov     esi, __environ
.text:0041623E		       cmp     esi, ebx
.text:00416240		       mov     [ebp+env], esi
.text:00416243		       jz      short loc_4161F9
.text:00416245		       mov     edi, [ebp+equal]
.text:00416248		       sub     edi, [ebp+option] ; len
.text:0041624B		       push    [ebp+option]    ; name
.text:0041624E		       call    findenv
.text:00416253		       mov     edi, eax
.text:00416255		       cmp     edi, ebx
.text:00416257		       pop     ecx
.text:00416258		       jl      short loc_4162AC
.text:0041625A		       cmp     [esi], ebx
.text:0041625C		       jz      short loc_4162AC
.text:0041625E		       lea     esi, [esi+edi*4]
.text:00416261		       push    dword ptr [esi] ; pBlock
.text:00416263		       call    _free
.text:00416268		       cmp     [ebp+remove], ebx
.text:0041626B		       pop     ecx
.text:0041626C		       jnz     short loc_416289
.text:0041626E		       mov     eax, [ebp+option]
.text:00416271		       mov     [esi], eax
.text:00416273		       mov     eax, [ebp+poption]
.text:00416276		       mov     [eax], ebx
.text:00416278		       jmp     loc_4162FF
.text:0041627D ; ---------------------------------------------------------------------------
.text:0041627D
.text:0041627D loc_41627D:			       ; CODE XREF: ___crtsetenv+12Bj
.text:0041627D		       mov     eax, [esi+4]
.text:00416280		       mov     [esi], eax
.text:00416282		       mov     eax, [ebp+env]
.text:00416285		       inc     edi
.text:00416286		       lea     esi, [eax+edi*4]
.text:00416289
.text:00416289 loc_416289:			       ; CODE XREF: ___crtsetenv+10Cj
.text:00416289		       cmp     [esi], ebx
.text:0041628B		       jnz     short loc_41627D
.text:0041628D		       cmp     edi, 3FFFFFFFh
.text:00416293		       jnb     short loc_4162FF
.text:00416295		       push    4	       ; size
.text:00416297		       push    edi	       ; count
.text:00416298		       push    __environ       ; ptr
.text:0041629E		       call    __recalloc_crt
.text:004162A3		       add     esp, 0Ch
.text:004162A6		       cmp     eax, ebx
.text:004162A8		       jz      short loc_4162FF
.text:004162AA		       jmp     short loc_4162FA
.text:004162AC ; ---------------------------------------------------------------------------
.text:004162AC
.text:004162AC loc_4162AC:			       ; CODE XREF: ___crtsetenv+F8j
.text:004162AC					       ; ___crtsetenv+FCj
.text:004162AC		       cmp     [ebp+remove], ebx
.text:004162AF		       jnz     loc_416397
.text:004162B5		       cmp     edi, ebx
.text:004162B7		       jge     short loc_4162BB
.text:004162B9		       neg     edi
.text:004162BB
.text:004162BB loc_4162BB:			       ; CODE XREF: ___crtsetenv+157j
.text:004162BB		       lea     eax, [edi+2]
.text:004162BE		       cmp     eax, edi
.text:004162C0		       jl      loc_4161F9
.text:004162C6		       cmp     eax, 3FFFFFFFh
.text:004162CB		       jnb     loc_4161F9
.text:004162D1		       push    eax	       ; size
.text:004162D2		       push    4	       ; count
.text:004162D4		       push    __environ       ; ptr
.text:004162DA		       call    __recalloc_crt
.text:004162DF		       add     esp, 0Ch
.text:004162E2		       cmp     eax, ebx
.text:004162E4		       jz      loc_4161F9
.text:004162EA		       mov     edx, [ebp+option]
.text:004162ED		       lea     ecx, [eax+edi*4]
.text:004162F0		       mov     [ecx], edx
.text:004162F2		       mov     [ecx+4],	ebx
.text:004162F5		       mov     ecx, [ebp+poption]
.text:004162F8		       mov     [ecx], ebx
.text:004162FA
.text:004162FA loc_4162FA:			       ; CODE XREF: ___crtsetenv+14Aj
.text:004162FA		       mov     __environ, eax
.text:004162FF
.text:004162FF loc_4162FF:			       ; CODE XREF: ___crtsetenv+118j
.text:004162FF					       ; ___crtsetenv+133j ...
.text:004162FF		       cmp     [ebp+primary], ebx
.text:00416302		       jz      short loc_41637C
.text:00416304		       mov     esi, [ebp+option]
.text:00416307		       push    1	       ; size
.text:00416309		       push    esi	       ; buf
.text:0041630A		       call    _strlen
.text:0041630F		       inc     eax
.text:00416310		       pop     ecx
.text:00416311		       inc     eax
.text:00416312		       push    eax	       ; count
.text:00416313		       call    __calloc_crt
.text:00416318		       mov     edi, eax
.text:0041631A		       cmp     edi, ebx
.text:0041631C		       pop     ecx
.text:0041631D		       pop     ecx
.text:0041631E		       jz      short loc_41637C
.text:00416320		       push    esi	       ; _Src
.text:00416321		       push    esi	       ; buf
.text:00416322		       call    _strlen
.text:00416327		       inc     eax
.text:00416328		       pop     ecx
.text:00416329		       inc     eax
.text:0041632A		       push    eax	       ; _SizeInBytes
.text:0041632B		       push    edi	       ; _Dst
.text:0041632C		       call    _strcpy_s
.text:00416331		       add     esp, 0Ch
.text:00416334		       test    eax, eax
.text:00416336		       jz      short loc_416345
.text:00416338		       push    ebx	       ; pReserved
.text:00416339		       push    ebx	       ; nLine
.text:0041633A		       push    ebx	       ; pszFile
.text:0041633B		       push    ebx	       ; pszFunction
.text:0041633C		       push    ebx	       ; pszExpression
.text:0041633D		       call    __invoke_watson
.text:00416342		       add     esp, 14h
.text:00416345
.text:00416345 loc_416345:			       ; CODE XREF: ___crtsetenv+1D6j
.text:00416345		       mov     ecx, [ebp+remove]
.text:00416348		       mov     eax, edi
.text:0041634A		       sub     eax, esi
.text:0041634C		       add     eax, [ebp+equal]
.text:0041634F		       mov     [eax], bl
.text:00416351		       inc     eax
.text:00416352		       neg     ecx
.text:00416354		       sbb     ecx, ecx
.text:00416356		       not     ecx
.text:00416358		       and     ecx, eax
.text:0041635A		       push    ecx	       ; lpValue
.text:0041635B		       push    edi	       ; lpName
.text:0041635C		       call    ds:__imp__SetEnvironmentVariableA@8 ; SetEnvironmentVariableA(x,x)
.text:00416362		       test    eax, eax
.text:00416364		       jnz     short loc_416375
.text:00416366		       or      [ebp+retval], 0FFFFFFFFh
.text:0041636A		       call    __errno
.text:0041636F		       mov     dword ptr [eax],	2Ah
.text:00416375
.text:00416375 loc_416375:			       ; CODE XREF: ___crtsetenv+204j
.text:00416375		       push    edi	       ; pBlock
.text:00416376		       call    _free
.text:0041637B		       pop     ecx
.text:0041637C
.text:0041637C loc_41637C:			       ; CODE XREF: ___crtsetenv+1A2j
.text:0041637C					       ; ___crtsetenv+1BEj
.text:0041637C		       cmp     [ebp+remove], ebx
.text:0041637F		       jz      short loc_41638F
.text:00416381		       push    [ebp+option]    ; pBlock
.text:00416384		       call    _free
.text:00416389		       mov     eax, [ebp+poption]
.text:0041638C		       pop     ecx
.text:0041638D		       mov     [eax], ebx
.text:0041638F
.text:0041638F loc_41638F:			       ; CODE XREF: ___crtsetenv+21Fj
.text:0041638F		       mov     eax, [ebp+retval]
.text:00416392		       jmp     loc_4161FC
.text:00416397 ; ---------------------------------------------------------------------------
.text:00416397
.text:00416397 loc_416397:			       ; CODE XREF: ___crtsetenv+14Fj
.text:00416397		       push    [ebp+option]    ; pBlock
.text:0041639A		       call    _free
.text:0041639F		       mov     eax, [ebp+poption]
.text:004163A2		       pop     ecx
.text:004163A3		       mov     [eax], ebx
.text:004163A5
.text:004163A5 loc_4163A5:			       ; CODE XREF: ___crtsetenv+A4j
.text:004163A5		       xor     eax, eax
.text:004163A7		       jmp     loc_4161FC
.text:004163A7 ___crtsetenv    endp
.text:004163A7
.text:004163AC
.text:004163AC ; =============== S U B R O U T I N E =======================================
.text:004163AC
.text:004163AC
.text:004163AC ; char *__cdecl _strdup(const char *string)
.text:004163AC __strdup	       proc near	       ; CODE XREF: copy_environ+40p
.text:004163AC
.text:004163AC string	       = dword ptr  4
.text:004163AC
.text:004163AC		       push    ebx
.text:004163AD		       mov     ebx, [esp+4+string]
.text:004163B1		       push    ebp
.text:004163B2		       xor     ebp, ebp
.text:004163B4		       cmp     ebx, ebp
.text:004163B6		       jnz     short loc_4163BC
.text:004163B8		       xor     eax, eax
.text:004163BA		       jmp     short loc_4163F9
.text:004163BC ; ---------------------------------------------------------------------------
.text:004163BC
.text:004163BC loc_4163BC:			       ; CODE XREF: __strdup+Aj
.text:004163BC		       push    esi
.text:004163BD		       push    edi
.text:004163BE		       push    ebx	       ; buf
.text:004163BF		       call    _strlen
.text:004163C4		       mov     esi, eax
.text:004163C6		       inc     esi
.text:004163C7		       push    esi	       ; size
.text:004163C8		       call    _malloc
.text:004163CD		       mov     edi, eax
.text:004163CF		       cmp     edi, ebp
.text:004163D1		       pop     ecx
.text:004163D2		       pop     ecx
.text:004163D3		       jz      short loc_4163F5
.text:004163D5		       push    ebx	       ; _Src
.text:004163D6		       push    esi	       ; _SizeInBytes
.text:004163D7		       push    edi	       ; _Dst
.text:004163D8		       call    _strcpy_s
.text:004163DD		       add     esp, 0Ch
.text:004163E0		       test    eax, eax
.text:004163E2		       jz      short loc_4163F1
.text:004163E4		       push    ebp	       ; pReserved
.text:004163E5		       push    ebp	       ; nLine
.text:004163E6		       push    ebp	       ; pszFile
.text:004163E7		       push    ebp	       ; pszFunction
.text:004163E8		       push    ebp	       ; pszExpression
.text:004163E9		       call    __invoke_watson
.text:004163EE		       add     esp, 14h
.text:004163F1
.text:004163F1 loc_4163F1:			       ; CODE XREF: __strdup+36j
.text:004163F1		       mov     eax, edi
.text:004163F3		       jmp     short loc_4163F7
.text:004163F5 ; ---------------------------------------------------------------------------
.text:004163F5
.text:004163F5 loc_4163F5:			       ; CODE XREF: __strdup+27j
.text:004163F5		       xor     eax, eax
.text:004163F7
.text:004163F7 loc_4163F7:			       ; CODE XREF: __strdup+47j
.text:004163F7		       pop     edi
.text:004163F8		       pop     esi
.text:004163F9
.text:004163F9 loc_4163F9:			       ; CODE XREF: __strdup+Ej
.text:004163F9		       pop     ebp
.text:004163FA		       pop     ebx
.text:004163FB		       retn
.text:004163FB __strdup	       endp
.text:004163FB
.text:004163FC
.text:004163FC ; =============== S U B R O U T I N E =======================================
.text:004163FC
.text:004163FC ; Attributes: bp-based frame
.text:004163FC
.text:004163FC ; const char *__cdecl _mbschr_l(const char *string, unsigned int	c, localeinfo_struct *plocinfo)
.text:004163FC __mbschr_l      proc near	       ; CODE XREF: __mbschr+Ap
.text:004163FC
.text:004163FC _loc_update     = _LocaleUpdate ptr -10h
.text:004163FC string	       = dword ptr  8
.text:004163FC c	       = dword ptr  0Ch
.text:004163FC plocinfo	       = dword ptr  10h
.text:004163FC
.text:004163FC		       push    ebp
.text:004163FD		       mov     ebp, esp
.text:004163FF		       sub     esp, 10h
.text:00416402		       push    ebx
.text:00416403		       push    [ebp+plocinfo]  ; plocinfo
.text:00416406		       lea     ecx, [ebp+_loc_update] ;	this
.text:00416409		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0041640E		       mov     eax, [ebp+string]
.text:00416411		       xor     ebx, ebx
.text:00416413		       cmp     eax, ebx
.text:00416415		       jnz     short loc_41643F
.text:00416417		       call    __errno
.text:0041641C		       push    ebx	       ; pReserved
.text:0041641D		       push    ebx	       ; nLine
.text:0041641E		       push    ebx	       ; pszFile
.text:0041641F		       push    ebx	       ; pszFunction
.text:00416420		       push    ebx	       ; pszExpression
.text:00416421		       mov     dword ptr [eax],	16h
.text:00416427		       call    __invalid_parameter
.text:0041642C		       add     esp, 14h
.text:0041642F		       cmp     [ebp+_loc_update.updated], bl
.text:00416432		       jz      short loc_41643B
.text:00416434		       mov     eax, [ebp+_loc_update.ptd]
.text:00416437		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0041643B
.text:0041643B loc_41643B:			       ; CODE XREF: __mbschr_l+36j
.text:0041643B		       xor     eax, eax
.text:0041643D		       jmp     short loc_4164B3
.text:0041643F ; ---------------------------------------------------------------------------
.text:0041643F
.text:0041643F loc_41643F:			       ; CODE XREF: __mbschr_l+19j
.text:0041643F		       push    esi
.text:00416440		       mov     esi, [ebp+_loc_update.localeinfo.mbcinfo]
.text:00416443		       cmp     [esi+8],	ebx
.text:00416446		       jnz     short loc_416482
.text:00416448		       push    [ebp+c]	       ; chr
.text:0041644B		       push    eax	       ; string
.text:0041644C		       call    _strchr
.text:00416451		       pop     ecx
.text:00416452		       pop     ecx
.text:00416453		       jmp     short loc_416496
.text:00416455 ; ---------------------------------------------------------------------------
.text:00416455
.text:00416455 loc_416455:			       ; CODE XREF: __mbschr_l+90j
.text:00416455		       movzx   edx, cl
.text:00416458		       test    byte ptr	[edx+esi+1Dh], 4
.text:0041645D		       jz      short loc_416479
.text:0041645F		       inc     eax
.text:00416460		       mov     dl, [eax]
.text:00416462		       cmp     dl, bl
.text:00416464		       jz      short loc_4164A4
.text:00416466		       movzx   ecx, cx
.text:00416469		       movzx   edx, dl
.text:0041646C		       shl     ecx, 8
.text:0041646F		       or      ecx, edx
.text:00416471		       cmp     [ebp+c],	ecx
.text:00416474		       jnz     short loc_416481
.text:00416476		       dec     eax
.text:00416477		       jmp     short loc_416496
.text:00416479 ; ---------------------------------------------------------------------------
.text:00416479
.text:00416479 loc_416479:			       ; CODE XREF: __mbschr_l+61j
.text:00416479		       movzx   edx, cx
.text:0041647C		       cmp     [ebp+c],	edx
.text:0041647F		       jz      short loc_41648E
.text:00416481
.text:00416481 loc_416481:			       ; CODE XREF: __mbschr_l+78j
.text:00416481		       inc     eax
.text:00416482
.text:00416482 loc_416482:			       ; CODE XREF: __mbschr_l+4Aj
.text:00416482		       movzx   cx, byte	ptr [eax]
.text:00416486		       movzx   ecx, cx
.text:00416489		       cmp     cx, bx
.text:0041648C		       jnz     short loc_416455
.text:0041648E
.text:0041648E loc_41648E:			       ; CODE XREF: __mbschr_l+83j
.text:0041648E		       movzx   ecx, cx
.text:00416491		       cmp     [ebp+c],	ecx
.text:00416494		       jnz     short loc_4164A4
.text:00416496
.text:00416496 loc_416496:			       ; CODE XREF: __mbschr_l+57j
.text:00416496					       ; __mbschr_l+7Bj
.text:00416496		       cmp     [ebp+_loc_update.updated], bl
.text:00416499		       jz      short loc_4164B2
.text:0041649B		       mov     ecx, [ebp+_loc_update.ptd]
.text:0041649E		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:004164A2		       jmp     short loc_4164B2
.text:004164A4 ; ---------------------------------------------------------------------------
.text:004164A4
.text:004164A4 loc_4164A4:			       ; CODE XREF: __mbschr_l+68j
.text:004164A4					       ; __mbschr_l+98j
.text:004164A4		       cmp     [ebp+_loc_update.updated], bl
.text:004164A7		       jz      short loc_4164B0
.text:004164A9		       mov     eax, [ebp+_loc_update.ptd]
.text:004164AC		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004164B0
.text:004164B0 loc_4164B0:			       ; CODE XREF: __mbschr_l+ABj
.text:004164B0		       xor     eax, eax
.text:004164B2
.text:004164B2 loc_4164B2:			       ; CODE XREF: __mbschr_l+9Dj
.text:004164B2					       ; __mbschr_l+A6j
.text:004164B2		       pop     esi
.text:004164B3
.text:004164B3 loc_4164B3:			       ; CODE XREF: __mbschr_l+41j
.text:004164B3		       pop     ebx
.text:004164B4		       leave
.text:004164B5		       retn
.text:004164B5 __mbschr_l      endp
.text:004164B5
.text:004164B6
.text:004164B6 ; =============== S U B R O U T I N E =======================================
.text:004164B6
.text:004164B6
.text:004164B6 ; const char *__cdecl _mbschr(const char	*string, unsigned int c)
.text:004164B6 __mbschr	       proc near	       ; CODE XREF: ___crtsetenv+3Ep
.text:004164B6
.text:004164B6 string	       = dword ptr  4
.text:004164B6 c	       = dword ptr  8
.text:004164B6
.text:004164B6		       push    0	       ; plocinfo
.text:004164B8		       push    [esp+4+c]       ; c
.text:004164BC		       push    [esp+8+string]  ; string
.text:004164C0		       call    __mbschr_l
.text:004164C5		       add     esp, 0Ch
.text:004164C8		       retn
.text:004164C8 __mbschr	       endp
.text:004164C8
.text:004164C8 ; ---------------------------------------------------------------------------
.text:004164C9		       align 10h
.text:004164D0 ; START OF FUNCTION CHUNK FOR _strchr
.text:004164D0
.text:004164D0 found_bx:			       ; CODE XREF: _strchr+1Fj
.text:004164D0		       lea     eax, [edx-1]
.text:004164D3		       pop     ebx
.text:004164D4		       retn
.text:004164D4 ; END OF	FUNCTION CHUNK FOR _strchr
.text:004164D4 ; ---------------------------------------------------------------------------
.text:004164D5		       align 10h
.text:004164E0
.text:004164E0 ; =============== S U B R O U T I N E =======================================
.text:004164E0
.text:004164E0
.text:004164E0 ; void __cdecl strchr(char *string, char	chr)
.text:004164E0 _strchr	       proc near	       ; CODE XREF: __mbschr_l+50p
.text:004164E0
.text:004164E0 arg_0	       = dword ptr  4
.text:004164E0 string	       = dword ptr  8
.text:004164E0 chr	       = byte ptr  0Ch
.text:004164E0
.text:004164E0 ; FUNCTION CHUNK	AT .text:004164D0 SIZE 00000005	BYTES
.text:004164E0
.text:004164E0		       xor     eax, eax
.text:004164E2		       mov     al, byte	ptr [esp+string]
.text:004164E6
.text:004164E6 ___from_strstr_to_strchr:
.text:004164E6		       push    ebx
.text:004164E7		       mov     ebx, eax
.text:004164E9		       shl     eax, 8
.text:004164EC		       mov     edx, [esp+4+arg_0]
.text:004164F0		       test    edx, 3
.text:004164F6		       jz      short main_loop_start
.text:004164F8
.text:004164F8 str_misaligned_0:		       ; CODE XREF: _strchr+2Bj
.text:004164F8		       mov     cl, [edx]
.text:004164FA		       add     edx, 1
.text:004164FD		       cmp     cl, bl
.text:004164FF		       jz      short found_bx
.text:00416501		       test    cl, cl
.text:00416503		       jz      short retnull_bx
.text:00416505		       test    edx, 3
.text:0041650B		       jnz     short str_misaligned_0
.text:0041650D
.text:0041650D main_loop_start:			       ; CODE XREF: _strchr+16j
.text:0041650D		       or      ebx, eax
.text:0041650F		       push    edi
.text:00416510		       mov     eax, ebx
.text:00416512		       shl     ebx, 10h
.text:00416515		       push    esi
.text:00416516		       or      ebx, eax
.text:00416518
.text:00416518 main_loop_0:			       ; CODE XREF: _strchr+63j
.text:00416518					       ; _strchr+72j ...
.text:00416518		       mov     ecx, [edx]
.text:0041651A		       mov     edi, 7EFEFEFFh
.text:0041651F		       mov     eax, ecx
.text:00416521		       mov     esi, edi
.text:00416523		       xor     ecx, ebx
.text:00416525		       add     esi, eax
.text:00416527		       add     edi, ecx
.text:00416529		       xor     ecx, 0FFFFFFFFh
.text:0041652C		       xor     eax, 0FFFFFFFFh
.text:0041652F		       xor     ecx, edi
.text:00416531		       xor     eax, esi
.text:00416533		       add     edx, 4
.text:00416536		       and     ecx, 81010100h
.text:0041653C		       jnz     short chr_is_found
.text:0041653E		       and     eax, 81010100h
.text:00416543		       jz      short main_loop_0
.text:00416545		       and     eax, 1010100h
.text:0041654A		       jnz     short retnull
.text:0041654C		       and     esi, 80000000h
.text:00416552		       jnz     short main_loop_0
.text:00416554
.text:00416554 retnull:				       ; CODE XREF: _strchr+6Aj
.text:00416554					       ; _strchr+83j ...
.text:00416554		       pop     esi
.text:00416555		       pop     edi
.text:00416556
.text:00416556 retnull_bx:			       ; CODE XREF: _strchr+23j
.text:00416556		       pop     ebx
.text:00416557		       xor     eax, eax
.text:00416559		       retn
.text:0041655A ; ---------------------------------------------------------------------------
.text:0041655A
.text:0041655A chr_is_found:			       ; CODE XREF: _strchr+5Cj
.text:0041655A		       mov     eax, [edx-4]
.text:0041655D		       cmp     al, bl
.text:0041655F		       jz      short loc_416597
.text:00416561		       test    al, al
.text:00416563		       jz      short retnull
.text:00416565		       cmp     ah, bl
.text:00416567		       jz      short loc_416590
.text:00416569		       test    ah, ah
.text:0041656B		       jz      short retnull
.text:0041656D		       shr     eax, 10h
.text:00416570		       cmp     al, bl
.text:00416572		       jz      short loc_416589
.text:00416574		       test    al, al
.text:00416576		       jz      short retnull
.text:00416578		       cmp     ah, bl
.text:0041657A		       jz      short loc_416582
.text:0041657C		       test    ah, ah
.text:0041657E		       jz      short retnull
.text:00416580		       jmp     short main_loop_0
.text:00416582 ; ---------------------------------------------------------------------------
.text:00416582
.text:00416582 loc_416582:			       ; CODE XREF: _strchr+9Aj
.text:00416582		       pop     esi
.text:00416583		       pop     edi
.text:00416584		       lea     eax, [edx-1]
.text:00416587		       pop     ebx
.text:00416588		       retn
.text:00416589 ; ---------------------------------------------------------------------------
.text:00416589
.text:00416589 loc_416589:			       ; CODE XREF: _strchr+92j
.text:00416589		       lea     eax, [edx-2]
.text:0041658C		       pop     esi
.text:0041658D		       pop     edi
.text:0041658E		       pop     ebx
.text:0041658F		       retn
.text:00416590 ; ---------------------------------------------------------------------------
.text:00416590
.text:00416590 loc_416590:			       ; CODE XREF: _strchr+87j
.text:00416590		       lea     eax, [edx-3]
.text:00416593		       pop     esi
.text:00416594		       pop     edi
.text:00416595		       pop     ebx
.text:00416596		       retn
.text:00416597 ; ---------------------------------------------------------------------------
.text:00416597
.text:00416597 loc_416597:			       ; CODE XREF: _strchr+7Fj
.text:00416597		       lea     eax, [edx-4]
.text:0041659A		       pop     esi
.text:0041659B		       pop     edi
.text:0041659C		       pop     ebx
.text:0041659D		       retn
.text:0041659D _strchr	       endp
.text:0041659D
.text:0041659E ; [00000006 BYTES: COLLAPSED FUNCTION GetProcAddress(x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:004165A4 ; [00000006 BYTES: COLLAPSED FUNCTION GetModuleHandleA(x). PRESS	KEYPAD "+" TO EXPAND]
.text:004165AA ; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess(x). PRESS KEYPAD "+" TO EXPAND]
.text:004165B0 ; [00000006 BYTES: COLLAPSED FUNCTION EnterCriticalSection(x). PRESS KEYPAD "+" TO EXPAND]
.text:004165B6 ; [00000006 BYTES: COLLAPSED FUNCTION LeaveCriticalSection(x). PRESS KEYPAD "+" TO EXPAND]
.text:004165BC ; [00000006 BYTES: COLLAPSED FUNCTION HeapAlloc(x,x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:004165C2 ; [00000006 BYTES: COLLAPSED FUNCTION GetLastError(). PRESS KEYPAD "+" TO EXPAND]
.text:004165C8 ; [00000006 BYTES: COLLAPSED FUNCTION HeapFree(x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:004165CE ; [00000006 BYTES: COLLAPSED FUNCTION GetCommandLineA().	PRESS KEYPAD "+" TO EXPAND]
.text:004165D4 ; [00000006 BYTES: COLLAPSED FUNCTION GetVersionExA(x). PRESS KEYPAD "+"	TO EXPAND]
.text:004165DA ; [00000006 BYTES: COLLAPSED FUNCTION GetProcessHeap(). PRESS KEYPAD "+"	TO EXPAND]
.text:004165E0 ; [00000006 BYTES: COLLAPSED FUNCTION TerminateProcess(x,x). PRESS KEYPAD "+" TO	EXPAND]
.text:004165E6 ; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentProcess(). PRESS	KEYPAD "+" TO EXPAND]
.text:004165EC ; [00000006 BYTES: COLLAPSED FUNCTION UnhandledExceptionFilter(x). PRESS	KEYPAD "+" TO EXPAND]
.text:004165F2 ; [00000006 BYTES: COLLAPSED FUNCTION SetUnhandledExceptionFilter(x). PRESS KEYPAD "+" TO EXPAND]
.text:004165F8 ; [00000006 BYTES: COLLAPSED FUNCTION IsDebuggerPresent(). PRESS	KEYPAD "+" TO EXPAND]
.text:004165FE ; [00000006 BYTES: COLLAPSED FUNCTION TlsGetValue(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416604 ; [00000006 BYTES: COLLAPSED FUNCTION TlsAlloc(). PRESS KEYPAD "+" TO EXPAND]
.text:0041660A ; [00000006 BYTES: COLLAPSED FUNCTION TlsSetValue(x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416610 ; [00000006 BYTES: COLLAPSED FUNCTION TlsFree(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416616 ; [00000006 BYTES: COLLAPSED FUNCTION InterlockedIncrement(x). PRESS KEYPAD "+" TO EXPAND]
.text:0041661C ; [00000006 BYTES: COLLAPSED FUNCTION SetLastError(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416622 ; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentThreadId(). PRESS KEYPAD	"+" TO EXPAND]
.text:00416628 ; [00000006 BYTES: COLLAPSED FUNCTION InterlockedDecrement(x). PRESS KEYPAD "+" TO EXPAND]
.text:0041662E ; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentThread(). PRESS KEYPAD "+" TO EXPAND]
.text:00416634 ; [00000006 BYTES: COLLAPSED FUNCTION WriteFile(x,x,x,x,x). PRESS KEYPAD	"+" TO EXPAND]
.text:0041663A ; [00000006 BYTES: COLLAPSED FUNCTION GetStdHandle(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416640 ; [00000006 BYTES: COLLAPSED FUNCTION GetModuleFileNameA(x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416646 ; [00000006 BYTES: COLLAPSED FUNCTION DeleteCriticalSection(x). PRESS KEYPAD "+"	TO EXPAND]
.text:0041664C ; [00000006 BYTES: COLLAPSED FUNCTION FatalAppExitA(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416652 ; [00000006 BYTES: COLLAPSED FUNCTION SetConsoleCtrlHandler(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416658 ; [00000006 BYTES: COLLAPSED FUNCTION FreeLibrary(x). PRESS KEYPAD "+" TO EXPAND]
.text:0041665E ; [00000006 BYTES: COLLAPSED FUNCTION InterlockedExchange(x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416664 ; [00000006 BYTES: COLLAPSED FUNCTION LoadLibraryA(x). PRESS KEYPAD "+" TO EXPAND]
.text:0041666A ; [00000006 BYTES: COLLAPSED FUNCTION InitializeCriticalSection(x). PRESS KEYPAD	"+" TO EXPAND]
.text:00416670 ; [00000006 BYTES: COLLAPSED FUNCTION SetHandleCount(x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416676 ; [00000006 BYTES: COLLAPSED FUNCTION GetFileType(x). PRESS KEYPAD "+" TO EXPAND]
.text:0041667C ; [00000006 BYTES: COLLAPSED FUNCTION GetStartupInfoA(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416682 ; [00000006 BYTES: COLLAPSED FUNCTION Sleep(x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416688 ; [00000006 BYTES: COLLAPSED FUNCTION VirtualFree(x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:0041668E ; [00000006 BYTES: COLLAPSED FUNCTION VirtualAlloc(x,x,x,x). PRESS KEYPAD "+" TO	EXPAND]
.text:00416694 ; [00000006 BYTES: COLLAPSED FUNCTION HeapReAlloc(x,x,x,x). PRESS KEYPAD	"+" TO EXPAND]
.text:0041669A ; [00000006 BYTES: COLLAPSED FUNCTION HeapDestroy(x). PRESS KEYPAD "+" TO EXPAND]
.text:004166A0 ; [00000006 BYTES: COLLAPSED FUNCTION HeapCreate(x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:004166A6 ; [00000006 BYTES: COLLAPSED FUNCTION FreeEnvironmentStringsA(x). PRESS KEYPAD "+" TO EXPAND]
.text:004166AC ; [00000006 BYTES: COLLAPSED FUNCTION GetEnvironmentStrings(). PRESS KEYPAD "+" TO EXPAND]
.text:004166B2 ; [00000006 BYTES: COLLAPSED FUNCTION FreeEnvironmentStringsW(x). PRESS KEYPAD "+" TO EXPAND]
.text:004166B8 ; [00000006 BYTES: COLLAPSED FUNCTION WideCharToMultiByte(x,x,x,x,x,x,x,x). PRESS KEYPAD	"+" TO EXPAND]
.text:004166BE ; [00000006 BYTES: COLLAPSED FUNCTION GetEnvironmentStringsW(). PRESS KEYPAD "+"	TO EXPAND]
.text:004166C4 ; [00000006 BYTES: COLLAPSED FUNCTION QueryPerformanceCounter(x). PRESS KEYPAD "+" TO EXPAND]
.text:004166CA ; [00000006 BYTES: COLLAPSED FUNCTION GetTickCount(). PRESS KEYPAD "+" TO EXPAND]
.text:004166D0 ; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentProcessId(). PRESS KEYPAD "+" TO	EXPAND]
.text:004166D6 ; [00000006 BYTES: COLLAPSED FUNCTION GetSystemTimeAsFileTime(x). PRESS KEYPAD "+" TO EXPAND]
.text:004166DC ; [00000006 BYTES: COLLAPSED FUNCTION GetCPInfo(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:004166E2 ; [00000006 BYTES: COLLAPSED FUNCTION GetACP(). PRESS KEYPAD "+"	TO EXPAND]
.text:004166E8 ; [00000006 BYTES: COLLAPSED FUNCTION GetOEMCP(). PRESS KEYPAD "+" TO EXPAND]
.text:004166EE ; [00000006 BYTES: COLLAPSED FUNCTION IsValidCodePage(x). PRESS KEYPAD "+" TO EXPAND]
.text:004166F4 ; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:004166FA ; [00000006 BYTES: COLLAPSED FUNCTION HeapSize(x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416700 ; [00000006 BYTES: COLLAPSED FUNCTION MultiByteToWideChar(x,x,x,x,x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416706 ; [00000006 BYTES: COLLAPSED FUNCTION GetLocaleInfoA(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:0041670C ; [00000006 BYTES: COLLAPSED FUNCTION GetLocaleInfoW(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416712 ; [00000006 BYTES: COLLAPSED FUNCTION GetConsoleCP(). PRESS KEYPAD "+" TO EXPAND]
.text:00416718 ; [00000006 BYTES: COLLAPSED FUNCTION GetConsoleMode(x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:0041671E ; [00000006 BYTES: COLLAPSED FUNCTION FlushFileBuffers(x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416724 ; [00000006 BYTES: COLLAPSED FUNCTION LCMapStringA(x,x,x,x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:0041672A ; [00000006 BYTES: COLLAPSED FUNCTION LCMapStringW(x,x,x,x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416730 ; [00000006 BYTES: COLLAPSED FUNCTION GetStringTypeA(x,x,x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416736 ; [00000006 BYTES: COLLAPSED FUNCTION GetStringTypeW(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:0041673C ; [00000006 BYTES: COLLAPSED FUNCTION GetTimeFormatA(x,x,x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416742 ; [00000006 BYTES: COLLAPSED FUNCTION GetDateFormatA(x,x,x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416748 ; [00000006 BYTES: COLLAPSED FUNCTION GetUserDefaultLCID(). PRESS KEYPAD	"+" TO EXPAND]
.text:0041674E ; [00000006 BYTES: COLLAPSED FUNCTION EnumSystemLocalesA(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416754 ; [00000006 BYTES: COLLAPSED FUNCTION IsValidLocale(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:0041675A ; [00000006 BYTES: COLLAPSED FUNCTION SetFilePointer(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416760 ; [00000006 BYTES: COLLAPSED FUNCTION CloseHandle(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416766 ; [00000006 BYTES: COLLAPSED FUNCTION WriteConsoleA(x,x,x,x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:0041676C ; [00000006 BYTES: COLLAPSED FUNCTION GetConsoleOutputCP(). PRESS KEYPAD	"+" TO EXPAND]
.text:00416772 ; [00000006 BYTES: COLLAPSED FUNCTION WriteConsoleW(x,x,x,x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416778 ; [00000006 BYTES: COLLAPSED FUNCTION SetStdHandle(x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:0041677E ; [00000006 BYTES: COLLAPSED FUNCTION GetTimeZoneInformation(x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416784 ; [00000006 BYTES: COLLAPSED FUNCTION CreateFileA(x,x,x,x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:0041678A ; [00000006 BYTES: COLLAPSED FUNCTION CompareStringA(x,x,x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416790 ; [00000006 BYTES: COLLAPSED FUNCTION CompareStringW(x,x,x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416796 ; [00000006 BYTES: COLLAPSED FUNCTION SetEnvironmentVariableA(x,x). PRESS KEYPAD	"+" TO EXPAND]
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db ''
.text:0041679C		       db '',0
.text:0041CC8A		       align 400h
.text:0041CC8A _text	       ends
.text:0041CC8A
.rdata:0041D000	; Section 2. (virtual address 0001D000)
.rdata:0041D000	; Virtual size			: 00003D04 (  15620.)
.rdata:0041D000	; Section size in file		: 00004000 (  16384.)
.rdata:0041D000	; Offset to raw	data for section: 0001D000
.rdata:0041D000	; Flags	40000040: Data Readable
.rdata:0041D000	; Alignment	: default
.rdata:0041D000	; ===========================================================================
.rdata:0041D000
.rdata:0041D000	; Segment type:	Pure data
.rdata:0041D000	; Segment permissions: Read
.rdata:0041D000	_rdata		segment	para public 'DATA' use32
.rdata:0041D000			assume cs:_rdata
.rdata:0041D000			;org 41D000h
.rdata:0041D000	___xc_a		dd 41h dup(0)		; DATA XREF: __cinit+49o
.rdata:0041D104	___xc_z		dd 41h dup(0)		; DATA XREF: __cinit+50o
.rdata:0041D208	; int (__cdecl *__xi_a)()
.rdata:0041D208	___xi_a		dd 0			; DATA XREF: __cinit+2Do
.rdata:0041D20C			dd 40h dup(0)
.rdata:0041D30C	; int (__cdecl *pinit)()
.rdata:0041D30C	pinit		dd offset ___initstdio
.rdata:0041D310	; int (__cdecl *pinit_0)()
.rdata:0041D310	pinit_0		dd offset ___onexitinit
.rdata:0041D314	; int (__cdecl *pinit_1)()
.rdata:0041D314	pinit_1		dd offset ___initmbctable
.rdata:0041D318	; int (__cdecl *pinit_2)()
.rdata:0041D318	pinit_2		dd offset __sse2_mathfcns_init
.rdata:0041D31C	; int (__cdecl *pinit_3)()
.rdata:0041D31C	pinit_3		dd offset ___sse2_available_init
.rdata:0041D320			dd 41h dup(0)
.rdata:0041D424	; int (__cdecl *pinit_4)()
.rdata:0041D424	pinit_4		dd offset ___CxxSetUnhandledExceptionFilter
.rdata:0041D428			dd 40h dup(0)
.rdata:0041D528	; int (__cdecl *__xi_z)()
.rdata:0041D528	___xi_z		dd 0			; DATA XREF: __cinit+28o
.rdata:0041D52C			dd 40h dup(0)
.rdata:0041D62C	; void (__cdecl	*__xp_a)()
.rdata:0041D62C	___xp_a		dd 0			; DATA XREF: doexit+87o
.rdata:0041D630			dd 40h dup(0)
.rdata:0041D730	; void (__cdecl	*pterm)()
.rdata:0041D730	pterm		dd offset ___termcon
.rdata:0041D734			dd 40h dup(0)
.rdata:0041D834	; void (__cdecl	*pterm_0)()
.rdata:0041D834	pterm_0		dd offset ___endstdio
.rdata:0041D838			dd 40h dup(0)
.rdata:0041D938	; void (__cdecl	*__xp_z)()
.rdata:0041D938	___xp_z		dd 0			; DATA XREF: doexit:loc_401836o
.rdata:0041D93C			dd 40h dup(0)
.rdata:0041DA3C	; void (__cdecl	*__xt_a)()
.rdata:0041DA3C	___xt_a		dd 0			; DATA XREF: doexit+97o
.rdata:0041DA40			dd 40h dup(0)
.rdata:0041DB40	; void (__cdecl	*__xt_z)()
.rdata:0041DB40	___xt_z		dd 0			; DATA XREF: doexit:loc_401846o
.rdata:0041DB44			dd 44h dup(0)
.rdata:0041DC54	aM		db 'M',0
.rdata:0041DC59			align 4
.rdata:0041DC5C			dd 2, 40h, 2 dup(1FDDCh)
.rdata:0041DC6C	; char ProcName[]
.rdata:0041DC6C	ProcName	db 'CorExitProcess',0   ; DATA XREF: ___crtCorExitProcess+Fo
.rdata:0041DC7B			align 4
.rdata:0041DC7C	; char ModuleName[]
.rdata:0041DC7C	ModuleName	db 'mscoree.dll',0      ; DATA XREF: ___crtCorExitProcesso
.rdata:0041DC88	aNull:					; DATA XREF: .data:___wnullstringo
.rdata:0041DC88			unicode	0, <(null)>,0
.rdata:0041DC96			align 4
.rdata:0041DC98	aNull_0		db '(null)',0           ; DATA XREF: __output_l+177r
.rdata:0041DC98						; .data:___nullstringo
.rdata:0041DC9F			align 10h
.rdata:0041DCA0	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ProcessDetach
.rdata:0041DCA0	?ProcessDetach@NativeDll@_CrtImplementationDetails_@@0IB dd 0
.rdata:0041DCA4	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ProcessAttach
.rdata:0041DCA4	?ProcessAttach@NativeDll@_CrtImplementationDetails_@@0IB dd 1
.rdata:0041DCA8	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ThreadAttach
.rdata:0041DCA8	?ThreadAttach@NativeDll@_CrtImplementationDetails_@@0IB	dd 2
.rdata:0041DCAC	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ThreadDetach
.rdata:0041DCAC	?ThreadDetach@NativeDll@_CrtImplementationDetails_@@0IB	dd 3
.rdata:0041DCB0	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ProcessVerifier
.rdata:0041DCB0	?ProcessVerifier@NativeDll@_CrtImplementationDetails_@@0IB dd 4, 0
.rdata:0041DCB8	___lookuptable	db 6			; DATA XREF: __output_l:loc_4024A9r
.rdata:0041DCB9			db 2 dup(0), 6
.rdata:0041DCBC			dd 100h, 6030010h, 10020600h, 45454504h, 5050505h, 303505h
.rdata:0041DCBC			dd 50h,	38202800h, 8075850h, 30303700h,	75057h,	8202000h
.rdata:0041DCBC			dd 0
.rdata:0041DCF0			db 8,'`h````',0
.rdata:0041DCF8			dd 78707800h, 8787878h,	807h, 8080007h,	8000008h, 7000800h
.rdata:0041DCF8			dd 8
.rdata:0041DD14	; char str1[]
.rdata:0041DD14	str1		db '.mixcrt',0          ; DATA XREF: _use_encode_pointer+42o
.rdata:0041DD1C	; char aEncodepointer[]
.rdata:0041DD1C	aEncodepointer	db 'EncodePointer',0    ; DATA XREF: __encode_pointer+4Eo
.rdata:0041DD1C						; __initptd+37o
.rdata:0041DD2A			align 4
.rdata:0041DD2C	; char aKernel32_dll_0[]
.rdata:0041DD2C	aKernel32_dll_0	db 'KERNEL32.DLL',0     ; DATA XREF: __encode_pointer:loc_40332Co
.rdata:0041DD2C						; __decode_pointer:loc_4033A3o	...
.rdata:0041DD39			align 4
.rdata:0041DD3C	; char aDecodepointer[]
.rdata:0041DD3C	aDecodepointer	db 'DecodePointer',0    ; DATA XREF: __decode_pointer+4Eo
.rdata:0041DD3C						; __initptd+4Do
.rdata:0041DD4A			align 4
.rdata:0041DD4C	; char aFlsfree[]
.rdata:0041DD4C	aFlsfree	db 'FlsFree',0          ; DATA XREF: __mtinit+44o
.rdata:0041DD54	; char aFlssetvalue[]
.rdata:0041DD54	aFlssetvalue	db 'FlsSetValue',0      ; DATA XREF: __mtinit+37o
.rdata:0041DD60	; char aFlsgetvalue[]
.rdata:0041DD60	aFlsgetvalue	db 'FlsGetValue',0      ; DATA XREF: __mtinit+2Ao
.rdata:0041DD6C	; char aFlsalloc[]
.rdata:0041DD6C	aFlsalloc	db 'FlsAlloc',0         ; DATA XREF: __mtinit+22o
.rdata:0041DD75			align 4
.rdata:0041DD78	aRuntimeError	db 'runtime error ',0   ; DATA XREF: .data:rterrso
.rdata:0041DD87			align 4
.rdata:0041DD88	asc_41DD88	db 0Dh,0Ah,0		; DATA XREF: .data:rterrso
.rdata:0041DD8B			align 4
.rdata:0041DD8C	aTlossError	db 'TLOSS error',0Dh,0Ah,0 ; DATA XREF: .data:rterrso
.rdata:0041DD9A			align 4
.rdata:0041DD9C	aSingError	db 'SING error',0Dh,0Ah,0 ; DATA XREF: .data:rterrso
.rdata:0041DDA9			align 4
.rdata:0041DDAC	aDomainError	db 'DOMAIN error',0Dh,0Ah,0 ; DATA XREF: .data:rterrso
.rdata:0041DDBB			align 10h
.rdata:0041DDC0	aR6034AnApplica	db 'R6034',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041DDC0			db 'An application has made an attempt to load the C runtime library '
.rdata:0041DDC0			db 'incorrectly.',0Ah
.rdata:0041DDC0			db 'Please contact the application',27h,'s support team for more informa'
.rdata:0041DDC0			db 'tion.',0Dh,0Ah,0
.rdata:0041DE5B			align 10h
.rdata:0041DE60	aR6033AttemptTo	db 'R6033',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041DE60			db '- Attempt to use MSIL code from this assembly during native code '
.rdata:0041DE60			db 'initialization',0Ah
.rdata:0041DE60			db 'This indicates a bug in your application. It is most likely the r'
.rdata:0041DE60			db 'esult of calling an MSIL-compiled (/clr) function from a native c'
.rdata:0041DE60			db 'onstructor or from DllMain.',0Dh,0Ah,0
.rdata:0041DF57			align 4
.rdata:0041DF58	aR6032NotEnough	db 'R6032',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041DF58			db '- not enough space for locale information',0Dh,0Ah,0
.rdata:0041DF8B			align 10h
.rdata:0041DF90	aR6031AttemptTo	db 'R6031',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041DF90			db '- Attempt to initialize the CRT more than once.',0Ah
.rdata:0041DF90			db 'This indicates a bug in your application.',0Dh,0Ah,0
.rdata:0041DFF3			align 4
.rdata:0041DFF4	aR6030CrtNotIni	db 'R6030',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041DFF4			db '- CRT not initialized',0Dh,0Ah,0
.rdata:0041E013			align 4
.rdata:0041E014	aR6028UnableToI	db 'R6028',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E014			db '- unable to initialize heap',0Dh,0Ah,0
.rdata:0041E039			align 4
.rdata:0041E03C	aR6027NotEnough	db 'R6027',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E03C			db '- not enough space for lowio initialization',0Dh,0Ah,0
.rdata:0041E071			align 4
.rdata:0041E074	aR6026NotEnough	db 'R6026',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E074			db '- not enough space for stdio initialization',0Dh,0Ah,0
.rdata:0041E0A9			align 4
.rdata:0041E0AC	aR6025PureVirtu	db 'R6025',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E0AC			db '- pure virtual function call',0Dh,0Ah,0
.rdata:0041E0D2			align 4
.rdata:0041E0D4	aR6024NotEnough	db 'R6024',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E0D4			db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
.rdata:0041E109			align 4
.rdata:0041E10C	aR6019UnableToO	db 'R6019',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E10C			db '- unable to open console device',0Dh,0Ah,0
.rdata:0041E135			align 4
.rdata:0041E138	aR6018Unexpecte	db 'R6018',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E138			db '- unexpected heap error',0Dh,0Ah,0
.rdata:0041E159			align 4
.rdata:0041E15C	aR6017Unexpecte	db 'R6017',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E15C			db '- unexpected multithread lock error',0Dh,0Ah,0
.rdata:0041E189			align 4
.rdata:0041E18C	aR6016NotEnough	db 'R6016',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E18C			db '- not enough space for thread data',0Dh,0Ah,0
.rdata:0041E1B8	aThisApplicatio	db 0Dh,0Ah		; DATA XREF: .data:rterrso
.rdata:0041E1B8			db 'This application has requested the Runtime to terminate it in an '
.rdata:0041E1B8			db 'unusual way.',0Ah
.rdata:0041E1B8			db 'Please contact the application',27h,'s support team for more informa'
.rdata:0041E1B8			db 'tion.',0Dh,0Ah,0
.rdata:0041E24E			align 10h
.rdata:0041E250	aR6009NotEnough	db 'R6009',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E250			db '- not enough space for environment',0Dh,0Ah,0
.rdata:0041E27C	aR6008NotEnough	db 'R6008',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E27C			db '- not enough space for arguments',0Dh,0Ah,0
.rdata:0041E2A6			align 4
.rdata:0041E2A8	aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041E2A8			db '- floating point support not loaded',0Dh,0Ah,0
.rdata:0041E2D5			align 4
.rdata:0041E2D8	; char Caption[]
.rdata:0041E2D8	Caption		db 'Microsoft Visual C++ Runtime Library',0
.rdata:0041E2D8						; DATA XREF: __NMSG_WRITE+157o
.rdata:0041E2FD			align 10h
.rdata:0041E300	; char asc_41E300[]
.rdata:0041E300	asc_41E300	db 0Ah			; DATA XREF: __NMSG_WRITE:loc_403A23o
.rdata:0041E300			db 0Ah,0
.rdata:0041E303			align 4
.rdata:0041E304	; char a___[]
.rdata:0041E304	a___		db '...',0              ; DATA XREF: __NMSG_WRITE+E8o
.rdata:0041E308	; char aProgramNameUnk[]
.rdata:0041E308	aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+A3o
.rdata:0041E31F			align 10h
.rdata:0041E320	; char Src[]
.rdata:0041E320	_Src		db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+5Bo
.rdata:0041E320			db 0Ah
.rdata:0041E320			db 'Program: ',0
.rdata:0041E33A			align 4
.rdata:0041E33C	; char aSystemfunction[]
.rdata:0041E33C	aSystemfunction	db 'SystemFunction036',0 ; DATA XREF: _rand_s:loc_40475Do
.rdata:0041E34E			align 10h
.rdata:0041E350	; char LibFileName[]
.rdata:0041E350	LibFileName	db 'ADVAPI32.DLL',0     ; DATA XREF: _rand_s+45o
.rdata:0041E35D			align 10h
.rdata:0041E360	; char aInitializecrit[]
.rdata:0041E360	aInitializecrit	db 'InitializeCriticalSectionAndSpinCount',0
.rdata:0041E360						; DATA XREF: ___crtInitCritSecAndSpinCount+53o
.rdata:0041E386			align 4
.rdata:0041E388	; char aKernel32_dll[]
.rdata:0041E388	aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: ___crtInitCritSecAndSpinCount+44o
.rdata:0041E395			align 4
.rdata:0041E398	aLc_time	db 'LC_TIME',0          ; DATA XREF: .rdata:off_41E414o
.rdata:0041E3A0	aLc_numeric	db 'LC_NUMERIC',0       ; DATA XREF: .rdata:0041E408o
.rdata:0041E3AB			align 4
.rdata:0041E3AC	aLc_monetary	db 'LC_MONETARY',0      ; DATA XREF: .rdata:0041E3FCo
.rdata:0041E3B8	aLc_ctype	db 'LC_CTYPE',0         ; DATA XREF: .rdata:0041E3F0o
.rdata:0041E3C1			align 4
.rdata:0041E3C4	aLc_collate	db 'LC_COLLATE',0       ; DATA XREF: .rdata:off_41E3E4o
.rdata:0041E3CF			align 10h
.rdata:0041E3D0	aLc_all		db 'LC_ALL',0           ; DATA XREF: .rdata:___lc_categoryo
.rdata:0041E3D7			align 4
.rdata:0041E3D8	___lc_category	dd offset aLc_all	; "LC_ALL"
.rdata:0041E3DC			align 10h
.rdata:0041E3E0	off_41E3E0	dd offset ___init_dummy	; DATA XREF: _setlocale_set_cat+255r
.rdata:0041E3E4	off_41E3E4	dd offset aLc_collate	; DATA XREF: _setlocale_get_all+3Dr
.rdata:0041E3E4						; _setlocale_get_all+53o ...
.rdata:0041E3E4						; "LC_COLLATE"
.rdata:0041E3E8			dd offset ___clocalestr	; "C"
.rdata:0041E3EC			dd offset ___init_collate
.rdata:0041E3F0			dd offset aLc_ctype	; "LC_CTYPE"
.rdata:0041E3F4			dd offset ___clocalestr	; "C"
.rdata:0041E3F8			dd offset ___init_ctype
.rdata:0041E3FC			dd offset aLc_monetary	; "LC_MONETARY"
.rdata:0041E400			dd offset ___clocalestr	; "C"
.rdata:0041E404			dd offset ___init_monetary
.rdata:0041E408			dd offset aLc_numeric	; "LC_NUMERIC"
.rdata:0041E40C			dd offset ___clocalestr	; "C"
.rdata:0041E410			dd offset ___init_numeric
.rdata:0041E414	off_41E414	dd offset aLc_time	; DATA XREF: _setlocale_get_all+C9o
.rdata:0041E414						; _setlocale_nolock+D2o
.rdata:0041E414						; "LC_TIME"
.rdata:0041E418			dd offset ___clocalestr	; "C"
.rdata:0041E41C			dd offset ___init_time
.rdata:0041E420	; char first_127char[127]
.rdata:0041E420	_first_127char	db 1, 2, 3, 4, 5, 6, 7,	8, 9, 0Ah, 0Bh,	0Ch, 0Dh, 0Eh
.rdata:0041E420						; DATA XREF: _setlocale_set_cat+1E2o
.rdata:0041E420			db 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
.rdata:0041E420			db 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
.rdata:0041E420			db 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
.rdata:0041E420			db 30h,	31h, 32h, 33h, 34h, 35h, 36h, 37h, 38h,	39h, 3Ah
.rdata:0041E420			db 3Bh,	3Ch, 3Dh, 3Eh, 3Fh, 40h, 41h, 42h, 43h,	44h, 45h
.rdata:0041E420			db 46h,	47h, 48h, 49h, 4Ah, 4Bh, 4Ch, 4Dh, 4Eh,	4Fh, 50h
.rdata:0041E420			db 51h,	52h, 53h, 54h, 55h, 56h, 57h, 58h, 59h,	5Ah, 5Bh
.rdata:0041E420			db 5Ch,	5Dh, 5Eh, 5Fh, 60h, 61h, 62h, 63h, 64h,	65h, 66h
.rdata:0041E420			db 67h,	68h, 69h, 6Ah, 6Bh, 6Ch, 6Dh, 6Eh, 6Fh,	70h, 71h
.rdata:0041E420			db 72h,	73h, 74h, 75h, 76h, 77h, 78h, 79h, 7Ah,	7Bh, 7Ch
.rdata:0041E420			db 7Dh,	7Eh, 7Fh
.rdata:0041E49F			align 10h
.rdata:0041E4A0	; char control[]
.rdata:0041E4A0	control		db '_.,',0              ; DATA XREF: ___lc_strtolc:loc_4076D8o
.rdata:0041E4A0						; ___lc_strtolc+10Co ...
.rdata:0041E4A4	a__0		db '.',0                ; DATA XREF: ___lc_lctostr+54o
.rdata:0041E4A6			align 4
.rdata:0041E4A8	a_		db '_',0                ; DATA XREF: ___lc_lctostr+32o
.rdata:0041E4AA			align 4
.rdata:0041E4AC	; char asc_41E4AC[]
.rdata:0041E4AC	asc_41E4AC	db ';',0                ; DATA XREF: _setlocale_get_all:loc_407865o
.rdata:0041E4AC						; _setlocale_nolock+DBo
.rdata:0041E4AE			align 10h
.rdata:0041E4B0	asc_41E4B0	db '=',0                ; DATA XREF: _setlocale_get_all+38o
.rdata:0041E4B0						; _setlocale_get_all+B2o
.rdata:0041E4B2	word_41E4B2	dw 0			; DATA XREF: __expandlocale+146o
.rdata:0041E4B4	; char aC[]
.rdata:0041E4B4	aC		db 'C',0                ; DATA XREF: __expandlocale+75o
.rdata:0041E4B6			align 4
.rdata:0041E4B8	; char asc_41E4B8[]
.rdata:0041E4B8	asc_41E4B8	db '=;',0               ; DATA XREF: _setlocale_nolock:loc_407EB8o
.rdata:0041E4BB			align 10h
.rdata:0041E4C0	___lookuptable_s db 6			; DATA XREF: __output_s_l+18Br
.rdata:0041E4C0						; __output_p_l+1B2r
.rdata:0041E4C1	aAajaba		db '',0
.rdata:0041E4C8			dd 86031000h, 80828680h, 45050514h, 85854545h, 585h, 50803030h
.rdata:0041E4C8			dd 8008880h, 38272800h,	805750h, 30370007h, 88505030h
.rdata:0041E4C8			dd 20000000h, 80888028h, 80h
.rdata:0041E500	aHHhhXppwpp	db '`h`hhh',8,8,7,'xppwpp',8,8,0
.rdata:0041E512			dw 800h
.rdata:0041E514			dd 7000800h, 8
.rdata:0041E51C	; char aGetprocesswind[]
.rdata:0041E51C	aGetprocesswind	db 'GetProcessWindowStation',0
.rdata:0041E51C						; DATA XREF: ___crtMessageBoxA+C2o
.rdata:0041E534	; char aGetuserobjecti[]
.rdata:0041E534	aGetuserobjecti	db 'GetUserObjectInformationA',0
.rdata:0041E534						; DATA XREF: ___crtMessageBoxA+AAo
.rdata:0041E54E			align 10h
.rdata:0041E550	aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+6Eo
.rdata:0041E563			align 4
.rdata:0041E564	aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+59o
.rdata:0041E574	; char aMessageboxa[]
.rdata:0041E574	aMessageboxa	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+43o
.rdata:0041E580	; char aUser32_dll[]
.rdata:0041E580	aUser32_dll	db 'USER32.DLL',0       ; DATA XREF: ___crtMessageBoxA+28o
.rdata:0041E58B			align 4
.rdata:0041E58C	; const	wchar_t	SrcStr
.rdata:0041E58C	SrcStr		dw 0			; DATA XREF: __crtLCMapStringA_stat+25o
.rdata:0041E58C						; __crtGetStringTypeA_stat+27o	...
.rdata:0041E58E			align 10h
.rdata:0041E590	___newctype	dd 40h dup(0)
.rdata:0041E690	asc_41E690:				; DATA XREF: ___init_ctype+35Co
.rdata:0041E690						; .data:___initiallocinfoo ...
.rdata:0041E690			unicode	0, <	     (((((		    H>
.rdata:0041E6D2			dw 10h
.rdata:0041E6D4			dd 7 dup(100010h), 5 dup(840084h), 3 dup(100010h), 810010h
.rdata:0041E6D4			dd 2 dup(810081h), 10081h, 9 dup(10001h), 100001h, 2 dup(100010h)
.rdata:0041E6D4			dd 820010h, 2 dup(820082h), 20082h, 9 dup(20002h), 100002h
.rdata:0041E6D4			dd 100010h, 200010h, 40h dup(0)
.rdata:0041E890	; const	unsigned __int16 _wctype[]
.rdata:0041E890	__wctype	db 2 dup(0)
.rdata:0041E892	word_41E892	dw 20h			; DATA XREF: .data:__pwctypeo
.rdata:0041E894	aHH:					; DATA XREF: .data:_ctype_loc_styleo
.rdata:0041E894			unicode	0, <	    h((((		   H>
.rdata:0041E8D4			dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
.rdata:0041E8D4			dd 3 dup(1810181h), 0Ah	dup(1010101h), 3 dup(100010h)
.rdata:0041E8D4			dd 3 dup(1820182h), 0Ah	dup(1020102h), 2 dup(100010h)
.rdata:0041E8D4			dd 10h dup(200020h), 480020h, 8	dup(100010h), 140010h
.rdata:0041E8D4			dd 100014h, 2 dup(100010h), 100014h, 2 dup(100010h), 1010010h
.rdata:0041E8D4			dd 0Bh dup(1010101h), 1010010h,	3 dup(1010101h), 0Ch dup(1020102h)
.rdata:0041E8D4			dd 1020010h, 3 dup(1020102h), 1010102h,	0
.rdata:0041EA98	___newclmap	dd 83828180h, 87868584h, 8B8A8988h, 8F8E8D8Ch, 93929190h
.rdata:0041EA98			dd 97969594h, 9B9A9998h, 9F9E9D9Ch, 0A3A2A1A0h,	0A7A6A5A4h
.rdata:0041EA98			dd 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h, 0B7B6B5B4h, 0BBBAB9B8h
.rdata:0041EA98			dd 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h, 0CBCAC9C8h, 0CFCECDCCh
.rdata:0041EA98			dd 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h, 0DFDEDDDCh, 0E3E2E1E0h
.rdata:0041EA98			dd 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh, 0F3F2F1F0h, 0F7F6F5F4h
.rdata:0041EA98			dd 0FBFAF9F8h, 0FFFEFDFCh
.rdata:0041EB18	dword_41EB18	dd 3020100h, 7060504h, 0B0A0908h, 0F0E0D0Ch, 13121110h
.rdata:0041EB18						; DATA XREF: ___init_ctype+366o
.rdata:0041EB18						; .data:___initiallocinfoo
.rdata:0041EB18			dd 17161514h, 1B1A1918h, 1F1E1D1Ch, 23222120h, 27262524h
.rdata:0041EB18			dd 2B2A2928h, 2F2E2D2Ch, 33323130h, 37363534h, 3B3A3938h
.rdata:0041EB18			dd 3F3E3D3Ch, 63626140h, 67666564h, 6B6A6968h, 6F6E6D6Ch
.rdata:0041EB18			dd 73727170h, 77767574h, 5B7A7978h, 5F5E5D5Ch, 63626160h
.rdata:0041EB18			dd 67666564h, 6B6A6968h, 6F6E6D6Ch, 73727170h, 77767574h
.rdata:0041EB18			dd 7B7A7978h, 7F7E7D7Ch, 83828180h, 87868584h, 8B8A8988h
.rdata:0041EB18			dd 8F8E8D8Ch, 93929190h, 97969594h, 9B9A9998h, 9F9E9D9Ch
.rdata:0041EB18			dd 0A3A2A1A0h, 0A7A6A5A4h, 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h
.rdata:0041EB18			dd 0B7B6B5B4h, 0BBBAB9B8h, 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h
.rdata:0041EB18			dd 0CBCAC9C8h, 0CFCECDCCh, 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h
.rdata:0041EB18			dd 0DFDEDDDCh, 0E3E2E1E0h, 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh
.rdata:0041EB18			dd 0F3F2F1F0h, 0F7F6F5F4h, 0FBFAF9F8h, 0FFFEFDFCh
.rdata:0041EC18	___newcumap	dd 83828180h, 87868584h, 8B8A8988h, 8F8E8D8Ch, 93929190h
.rdata:0041EC18			dd 97969594h, 9B9A9998h, 9F9E9D9Ch, 0A3A2A1A0h,	0A7A6A5A4h
.rdata:0041EC18			dd 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h, 0B7B6B5B4h, 0BBBAB9B8h
.rdata:0041EC18			dd 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h, 0CBCAC9C8h, 0CFCECDCCh
.rdata:0041EC18			dd 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h, 0DFDEDDDCh, 0E3E2E1E0h
.rdata:0041EC18			dd 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh, 0F3F2F1F0h, 0F7F6F5F4h
.rdata:0041EC18			dd 0FBFAF9F8h, 0FFFEFDFCh
.rdata:0041EC98	dword_41EC98	dd 3020100h, 7060504h, 0B0A0908h, 0F0E0D0Ch, 13121110h
.rdata:0041EC98						; DATA XREF: ___init_ctype+370o
.rdata:0041EC98						; .data:___initiallocinfoo
.rdata:0041EC98			dd 17161514h, 1B1A1918h, 1F1E1D1Ch, 23222120h, 27262524h
.rdata:0041EC98			dd 2B2A2928h, 2F2E2D2Ch, 33323130h, 37363534h, 3B3A3938h
.rdata:0041EC98			dd 3F3E3D3Ch, 43424140h, 47464544h, 4B4A4948h, 4F4E4D4Ch
.rdata:0041EC98			dd 53525150h, 57565554h, 5B5A5958h, 5F5E5D5Ch, 43424160h
.rdata:0041EC98			dd 47464544h, 4B4A4948h, 4F4E4D4Ch, 53525150h, 57565554h
.rdata:0041EC98			dd 7B5A5958h, 7F7E7D7Ch, 83828180h, 87868584h, 8B8A8988h
.rdata:0041EC98			dd 8F8E8D8Ch, 93929190h, 97969594h, 9B9A9998h, 9F9E9D9Ch
.rdata:0041EC98			dd 0A3A2A1A0h, 0A7A6A5A4h, 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h
.rdata:0041EC98			dd 0B7B6B5B4h, 0BBBAB9B8h, 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h
.rdata:0041EC98			dd 0CBCAC9C8h, 0CFCECDCCh, 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h
.rdata:0041EC98			dd 0DFDEDDDCh, 0E3E2E1E0h, 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh
.rdata:0041EC98			dd 0F3F2F1F0h, 0F7F6F5F4h, 0FBFAF9F8h, 0FFFEFDFCh
.rdata:0041ED98	aHhMmSs		db 'HH:mm:ss',0         ; DATA XREF: .data:00421E40o
.rdata:0041EDA1			align 4
.rdata:0041EDA4	aDdddMmmmDdYyyy	db 'dddd, MMMM dd, yyyy',0 ; DATA XREF: .data:00421E3Co
.rdata:0041EDB8	aMmDdYy		db 'MM/dd/yy',0         ; DATA XREF: .data:00421E38o
.rdata:0041EDC1			align 4
.rdata:0041EDC4	aPm		db 'PM',0               ; DATA XREF: .data:00421E34o
.rdata:0041EDC7			align 4
.rdata:0041EDC8	aAm		db 'AM',0               ; DATA XREF: .data:00421E30o
.rdata:0041EDCB			align 4
.rdata:0041EDCC	aDecember	db 'December',0         ; DATA XREF: .data:00421E2Co
.rdata:0041EDD5			align 4
.rdata:0041EDD8	aNovember	db 'November',0         ; DATA XREF: .data:00421E28o
.rdata:0041EDE1			align 4
.rdata:0041EDE4	aOctober	db 'October',0          ; DATA XREF: .data:00421E24o
.rdata:0041EDEC	aSeptember	db 'September',0        ; DATA XREF: .data:00421E20o
.rdata:0041EDF6			align 4
.rdata:0041EDF8	aAugust		db 'August',0           ; DATA XREF: .data:00421E1Co
.rdata:0041EDFF			align 10h
.rdata:0041EE00	aJuly		db 'July',0             ; DATA XREF: .data:00421E18o
.rdata:0041EE05			align 4
.rdata:0041EE08	aJune		db 'June',0             ; DATA XREF: .data:00421E14o
.rdata:0041EE0D			align 10h
.rdata:0041EE10	aApril		db 'April',0            ; DATA XREF: .data:00421E0Co
.rdata:0041EE16			align 4
.rdata:0041EE18	aMarch		db 'March',0            ; DATA XREF: .data:00421E08o
.rdata:0041EE1E			align 10h
.rdata:0041EE20	aFebruary	db 'February',0         ; DATA XREF: .data:00421E04o
.rdata:0041EE29			align 4
.rdata:0041EE2C	aJanuary	db 'January',0          ; DATA XREF: .data:00421E00o
.rdata:0041EE34	aDec		db 'Dec',0              ; DATA XREF: .data:00421DFCo
.rdata:0041EE38	aNov		db 'Nov',0              ; DATA XREF: .data:00421DF8o
.rdata:0041EE3C	aOct		db 'Oct',0              ; DATA XREF: .data:00421DF4o
.rdata:0041EE40	aSep		db 'Sep',0              ; DATA XREF: .data:00421DF0o
.rdata:0041EE44	aAug		db 'Aug',0              ; DATA XREF: .data:00421DECo
.rdata:0041EE48	aJul		db 'Jul',0              ; DATA XREF: .data:00421DE8o
.rdata:0041EE4C	aJun		db 'Jun',0              ; DATA XREF: .data:00421DE4o
.rdata:0041EE50	aMay		db 'May',0              ; DATA XREF: .data:00421DE0o
.rdata:0041EE50						; .data:00421E10o
.rdata:0041EE54	aApr		db 'Apr',0              ; DATA XREF: .data:00421DDCo
.rdata:0041EE58	aMar		db 'Mar',0              ; DATA XREF: .data:00421DD8o
.rdata:0041EE5C	aFeb		db 'Feb',0              ; DATA XREF: .data:00421DD4o
.rdata:0041EE60	aJan		db 'Jan',0              ; DATA XREF: .data:00421DD0o
.rdata:0041EE64	aSaturday	db 'Saturday',0         ; DATA XREF: .data:00421DCCo
.rdata:0041EE6D			align 10h
.rdata:0041EE70	aFriday		db 'Friday',0           ; DATA XREF: .data:00421DC8o
.rdata:0041EE77			align 4
.rdata:0041EE78	aThursday	db 'Thursday',0         ; DATA XREF: .data:00421DC4o
.rdata:0041EE81			align 4
.rdata:0041EE84	aWednesday	db 'Wednesday',0        ; DATA XREF: .data:00421DC0o
.rdata:0041EE8E			align 10h
.rdata:0041EE90	aTuesday	db 'Tuesday',0          ; DATA XREF: .data:00421DBCo
.rdata:0041EE98	aMonday		db 'Monday',0           ; DATA XREF: .data:00421DB8o
.rdata:0041EE9F			align 10h
.rdata:0041EEA0	aSunday		db 'Sunday',0           ; DATA XREF: .data:00421DB4o
.rdata:0041EEA7			align 4
.rdata:0041EEA8	aSat		db 'Sat',0              ; DATA XREF: .data:00421DB0o
.rdata:0041EEAC	aFri		db 'Fri',0              ; DATA XREF: .data:00421DACo
.rdata:0041EEB0	aThu		db 'Thu',0              ; DATA XREF: .data:00421DA8o
.rdata:0041EEB4	aWed		db 'Wed',0              ; DATA XREF: .data:00421DA4o
.rdata:0041EEB8	aTue		db 'Tue',0              ; DATA XREF: .data:00421DA0o
.rdata:0041EEBC	aMon		db 'Mon',0              ; DATA XREF: .data:00421D9Co
.rdata:0041EEC0	aSun		db 'Sun',0              ; DATA XREF: .data:___lc_time_co
.rdata:0041EEC4	; char aAP[]
.rdata:0041EEC4	aAP		db 'a/p',0              ; DATA XREF: _store_winword:loc_40EE80o
.rdata:0041EEC8	; char src[]
.rdata:0041EEC8	src		db 'am/pm',0            ; DATA XREF: _store_winword:loc_40EE6Ao
.rdata:0041EECE			align 10h
.rdata:0041EED0	aUnitedStates	db 'united-states',0
.rdata:0041EEDE			align 10h
.rdata:0041EEE0	aUnitedKingdom	db 'united-kingdom',0
.rdata:0041EEEF			align 10h
.rdata:0041EEF0	aTrinidadTobago	db 'trinidad & tobago',0
.rdata:0041EF02			align 4
.rdata:0041EF04	aSouthKorea_0	db 'south-korea',0
.rdata:0041EF10	aSouthAfrica_0	db 'south-africa',0
.rdata:0041EF1D			align 10h
.rdata:0041EF20	aSouthKorea	db 'south korea',0
.rdata:0041EF2C	aSouthAfrica	db 'south africa',0
.rdata:0041EF39			align 4
.rdata:0041EF3C	aSlovak		db 'slovak',0
.rdata:0041EF43			align 4
.rdata:0041EF44	aPuertoRico	db 'puerto-rico',0
.rdata:0041EF50	aPrChina	db 'pr-china',0
.rdata:0041EF59			align 4
.rdata:0041EF5C	aPrChina_0	db 'pr china',0
.rdata:0041EF65			align 4
.rdata:0041EF68	aNz		db 'nz',0
.rdata:0041EF6B			align 4
.rdata:0041EF6C	aNewZealand	db 'new-zealand',0
.rdata:0041EF78	aHongKong	db 'hong-kong',0
.rdata:0041EF82			align 4
.rdata:0041EF84	aHolland	db 'holland',0
.rdata:0041EF8C	aGreatBritain	db 'great britain',0
.rdata:0041EF9A			align 4
.rdata:0041EF9C	aEngland	db 'england',0
.rdata:0041EFA4	aCzech		db 'czech',0
.rdata:0041EFAA			align 4
.rdata:0041EFAC	aChina		db 'china',0
.rdata:0041EFB2			align 4
.rdata:0041EFB4	aBritain	db 'britain',0          ; DATA XREF: .rdata:0041F5E8o
.rdata:0041EFBC	aAmerica	db 'america',0          ; DATA XREF: .rdata:___rg_countryo
.rdata:0041EFC4	aUsa		db 'usa',0
.rdata:0041EFC8	aUs		db 'us',0
.rdata:0041EFCB			align 4
.rdata:0041EFCC	aUk		db 'uk',0
.rdata:0041EFCF			align 10h
.rdata:0041EFD0	aSwiss		db 'swiss',0
.rdata:0041EFD6			align 4
.rdata:0041EFD8	aSwedishFinland	db 'swedish-finland',0
.rdata:0041EFE8	aSpanishVenezue	db 'spanish-venezuela',0
.rdata:0041EFFA			align 4
.rdata:0041EFFC	aSpanishUruguay	db 'spanish-uruguay',0
.rdata:0041F00C	aSpanishPuertoR	db 'spanish-puerto rico',0
.rdata:0041F020	aSpanishPeru	db 'spanish-peru',0
.rdata:0041F02D			align 10h
.rdata:0041F030	aSpanishParagua	db 'spanish-paraguay',0
.rdata:0041F041			align 4
.rdata:0041F044	aSpanishPanama	db 'spanish-panama',0
.rdata:0041F053			align 4
.rdata:0041F054	aSpanishNicarag	db 'spanish-nicaragua',0
.rdata:0041F066			align 4
.rdata:0041F068	aSpanishModern	db 'spanish-modern',0
.rdata:0041F077			align 4
.rdata:0041F078	aSpanishMexican	db 'spanish-mexican',0
.rdata:0041F088	aSpanishHondura	db 'spanish-honduras',0
.rdata:0041F099			align 4
.rdata:0041F09C	aSpanishGuatema	db 'spanish-guatemala',0
.rdata:0041F0AE			align 10h
.rdata:0041F0B0	aSpanishElSalva	db 'spanish-el salvador',0
.rdata:0041F0C4	aSpanishEcuador	db 'spanish-ecuador',0
.rdata:0041F0D4	aSpanishDominic	db 'spanish-dominican republic',0
.rdata:0041F0EF			align 10h
.rdata:0041F0F0	aSpanishCostaRi	db 'spanish-costa rica',0
.rdata:0041F103			align 4
.rdata:0041F104	aSpanishColombi	db 'spanish-colombia',0
.rdata:0041F115			align 4
.rdata:0041F118	aSpanishChile	db 'spanish-chile',0
.rdata:0041F126			align 4
.rdata:0041F128	aSpanishBolivia	db 'spanish-bolivia',0
.rdata:0041F138	aSpanishArgenti	db 'spanish-argentina',0
.rdata:0041F14A			align 4
.rdata:0041F14C	aPortugueseBraz	db 'portuguese-brazilian',0
.rdata:0041F161			align 4
.rdata:0041F164	aNorwegianNyn_0	db 'norwegian-nynorsk',0
.rdata:0041F176			align 4
.rdata:0041F178	aNorwegianBokma	db 'norwegian-bokmal',0
.rdata:0041F189			align 4
.rdata:0041F18C	aNorwegian	db 'norwegian',0
.rdata:0041F196			align 4
.rdata:0041F198	aItalianSwiss	db 'italian-swiss',0
.rdata:0041F1A6			align 4
.rdata:0041F1A8	aIrishEnglish	db 'irish-english',0
.rdata:0041F1B6			align 4
.rdata:0041F1B8	aGermanSwiss	db 'german-swiss',0
.rdata:0041F1C5			align 4
.rdata:0041F1C8	aGermanLuxembou	db 'german-luxembourg',0
.rdata:0041F1DA			align 4
.rdata:0041F1DC	aGermanLichtens	db 'german-lichtenstein',0
.rdata:0041F1F0	aGermanAustrian	db 'german-austrian',0
.rdata:0041F200	aFrenchSwiss	db 'french-swiss',0
.rdata:0041F20D			align 10h
.rdata:0041F210	aFrenchLuxembou	db 'french-luxembourg',0
.rdata:0041F222			align 4
.rdata:0041F224	aFrenchCanadian	db 'french-canadian',0
.rdata:0041F234	aFrenchBelgian	db 'french-belgian',0
.rdata:0041F243			align 4
.rdata:0041F244	aEnglishUsa	db 'english-usa',0
.rdata:0041F250	aEnglishUs	db 'english-us',0
.rdata:0041F25B			align 4
.rdata:0041F25C	aEnglishUk	db 'english-uk',0
.rdata:0041F267			align 4
.rdata:0041F268	aEnglishTrinida	db 'english-trinidad y tobago',0
.rdata:0041F282			align 4
.rdata:0041F284	aEnglishSouthAf	db 'english-south africa',0
.rdata:0041F299			align 4
.rdata:0041F29C	aEnglishNz	db 'english-nz',0
.rdata:0041F2A7			align 4
.rdata:0041F2A8	aEnglishJamaica	db 'english-jamaica',0
.rdata:0041F2B8	aEnglishIre	db 'english-ire',0
.rdata:0041F2C4	aEnglishCaribbe	db 'english-caribbean',0
.rdata:0041F2D6			align 4
.rdata:0041F2D8	aEnglishCan	db 'english-can',0
.rdata:0041F2E4	aEnglishBelize	db 'english-belize',0
.rdata:0041F2F3			align 4
.rdata:0041F2F4	aEnglishAus	db 'english-aus',0
.rdata:0041F300	aEnglishAmerica	db 'english-american',0
.rdata:0041F311			align 4
.rdata:0041F314	aDutchBelgian	db 'dutch-belgian',0
.rdata:0041F322			align 4
.rdata:0041F324	aChineseTraditi	db 'chinese-traditional',0
.rdata:0041F338	aChineseSingapo	db 'chinese-singapore',0
.rdata:0041F34A			align 4
.rdata:0041F34C	aChineseSimplif	db 'chinese-simplified',0
.rdata:0041F35F			align 10h
.rdata:0041F360	aChineseHongkon	db 'chinese-hongkong',0
.rdata:0041F371			align 4
.rdata:0041F374	aChinese	db 'chinese',0
.rdata:0041F37C	aChi		db 'chi',0
.rdata:0041F380	aChh		db 'chh',0
.rdata:0041F384	aCanadian	db 'canadian',0
.rdata:0041F38D			align 10h
.rdata:0041F390	aBelgian	db 'belgian',0
.rdata:0041F398	aAustralian	db 'australian',0
.rdata:0041F3A3			align 4
.rdata:0041F3A4	aAmericanEnglis	db 'american-english',0
.rdata:0041F3B5			align 4
.rdata:0041F3B8	aAmericanEngl_0	db 'american english',0 ; DATA XREF: .rdata:0041F3E0o
.rdata:0041F3C9			align 4
.rdata:0041F3CC	aAmerican	db 'american',0         ; DATA XREF: .rdata:___rg_languageo
.rdata:0041F3D5			align 4
.rdata:0041F3D8	; tagLOCALETAB __rg_language
.rdata:0041F3D8	___rg_language	dd offset aAmerican	; szName
.rdata:0041F3D8						; DATA XREF: ___get_qualified_locale+74o
.rdata:0041F3D8			db 45h,	4Eh, 55h, 0	; chAbbrev ; "american"
.rdata:0041F3E0			dd offset aAmericanEngl_0 ; "american english"
.rdata:0041F3E4			dd 554E45h, 41F3A4h, 554E45h, 41F398h, 414E45h,	41F390h
.rdata:0041F3E4			dd 424C4Eh, 41F384h, 434E45h, 41F380h, 48485Ah,	41F37Ch
.rdata:0041F3E4			dd 49485Ah, 41F374h, 534843h, 41F360h, 48485Ah,	41F34Ch
.rdata:0041F3E4			dd 534843h, 41F338h, 49485Ah, 41F324h, 544843h,	41F314h
.rdata:0041F3E4			dd 424C4Eh, 41F300h, 554E45h, 41F2F4h, 414E45h,	41F2E4h
.rdata:0041F3E4			dd 4C4E45h, 41F2D8h, 434E45h, 41F2C4h, 424E45h,	41F2B8h
.rdata:0041F3E4			dd 494E45h, 41F2A8h, 4A4E45h, 41F29Ch, 5A4E45h,	41F284h
.rdata:0041F3E4			dd 534E45h, 41F268h, 544E45h, 41F25Ch, 474E45h,	41F250h
.rdata:0041F3E4			dd 554E45h, 41F244h, 554E45h, 41F234h, 425246h,	41F224h
.rdata:0041F3E4			dd 435246h, 41F210h, 4C5246h, 41F200h, 535246h,	41F1F0h
.rdata:0041F3E4			dd 414544h, 41F1DCh, 434544h, 41F1C8h, 4C4544h,	41F1B8h
.rdata:0041F3E4			dd 534544h, 41F1A8h, 494E45h, 41F198h, 535449h,	41F18Ch
.rdata:0041F3E4			dd 524F4Eh, 41F178h, 524F4Eh, 41F164h, 4E4F4Eh,	41F14Ch
.rdata:0041F3E4			dd 425450h, 41F138h, 535345h, 41F128h, 425345h,	41F118h
.rdata:0041F3E4			dd 4C5345h, 41F104h, 4F5345h, 41F0F0h, 435345h,	41F0D4h
.rdata:0041F3E4			dd 445345h, 41F0C4h, 465345h, 41F0B0h, 455345h,	41F09Ch
.rdata:0041F3E4			dd 475345h, 41F088h, 485345h, 41F078h, 4D5345h,	41F068h
.rdata:0041F3E4			dd 4E5345h, 41F054h, 495345h, 41F044h, 415345h,	41F030h
.rdata:0041F3E4			dd 5A5345h, 41F020h, 525345h, 41F00Ch, 555345h,	41EFFCh
.rdata:0041F3E4			dd 595345h, 41EFE8h, 565345h, 41EFD8h, 465653h,	41EFD0h
.rdata:0041F3E4			dd 534544h, 41EFCCh, 474E45h, 41EFC8h, 554E45h,	41EFC4h
.rdata:0041F3E4			dd 554E45h
.rdata:0041F5E0	; tagLOCALETAB __rg_country
.rdata:0041F5E0	___rg_country	dd offset aAmerica	; szName
.rdata:0041F5E0						; DATA XREF: ___get_qualified_locale+3Co
.rdata:0041F5E0			db 55h,	53h, 41h, 0	; chAbbrev ; "america"
.rdata:0041F5E8			dd offset aBritain	; "britain"
.rdata:0041F5EC			dd 524247h, 41EFACh, 4E4843h, 41EFA4h, 455A43h,	41EF9Ch
.rdata:0041F5EC			dd 524247h, 41EF8Ch, 524247h, 41EF84h, 444C4Eh,	41EF78h
.rdata:0041F5EC			dd 474B48h, 41EF6Ch, 4C5A4Eh, 41EF68h, 4C5A4Eh,	41EF5Ch
.rdata:0041F5EC			dd 4E4843h, 41EF50h, 4E4843h, 41EF44h, 495250h,	41EF3Ch
.rdata:0041F5EC			dd 4B5653h, 41EF2Ch, 46415Ah, 41EF20h, 524F4Bh,	41EF10h
.rdata:0041F5EC			dd 46415Ah, 41EF04h, 524F4Bh, 41EEF0h, 4F5454h,	41EFCCh
.rdata:0041F5EC			dd 524247h, 41EEE0h, 524247h, 41EED0h, 415355h,	41EFC8h
.rdata:0041F5EC			dd 415355h
.rdata:0041F698	___rglangidNotDefault dw 0C0Ch		; DATA XREF: TestDefaultCountry+7r
.rdata:0041F69A			dw 0C1Ah
.rdata:0041F69C			dd 4361007h, 42D080Ch, 100C0403h, 81D0810h
.rdata:0041F6AC	; char aOcp[]
.rdata:0041F6AC	aOcp		db 'OCP',0              ; DATA XREF: ProcessCodePage+2Do
.rdata:0041F6B0	; char str2[]
.rdata:0041F6B0	str2		db 'ACP',0              ; DATA XREF: ProcessCodePage+1Co
.rdata:0041F6B4	; char aNorwegianNynor[]
.rdata:0041F6B4	aNorwegianNynor	db 'Norwegian-Nynorsk',0
.rdata:0041F6B4						; DATA XREF: ___get_qualified_locale+179o
.rdata:0041F6C6			align 4
.rdata:0041F6C8	; _EXCEPTION_POINTERS GS_ExceptionPointers
.rdata:0041F6C8	GS_ExceptionPointers _EXCEPTION_POINTERS <offset GS_ExceptionRecord, \
.rdata:0041F6C8						; DATA XREF: ___report_gsfailure+D4o
.rdata:0041F6C8					     offset GS_ContextRecord>
.rdata:0041F6D0	___dnames	db 'SunMonTueWedThuFriSat',0
.rdata:0041F6E6			align 4
.rdata:0041F6E8	___mnames	db 'JanFebMarAprMayJunJulAugSepOctNovDec',0
.rdata:0041F70D			align 10h
.rdata:0041F710	; char option[]
.rdata:0041F710	option		db 'TZ',0               ; DATA XREF: _tzset_nolock+A1o
.rdata:0041F713			align 4
.rdata:0041F714	; char FileName[]
.rdata:0041F714	FileName	db 'CONIN$',0           ; DATA XREF: ___initconin+Eo
.rdata:0041F71B			align 4
.rdata:0041F71C	; char aConout[]
.rdata:0041F71C	aConout		db 'CONOUT$',0          ; DATA XREF: ___initconout+Eo
.rdata:0041F724			align 8
.rdata:0041F728	__load_config_used:
.rdata:0041F728			unicode	0, <H>,0
.rdata:0041F72C			dd 0Eh dup(0)
.rdata:0041F764			dd offset ___security_cookie
.rdata:0041F768			dd offset ___safe_se_handler_table
.rdata:0041F76C			dd 3, 19Bh dup(0)
.rdata:0041FDDC			dd 53445352h, 0CA449B52h, 4673C44Ch, 0A4C9F69Ah, 78BEF4E4h
.rdata:0041FDDC			dd 1
.rdata:0041FDF4	aCAdityaWorkWal	db 'C:\aditya\work\waldo\tests\teststkl.pdb',0
.rdata:0041FE1C			dd 45h dup(0)
.rdata:0041FF30	___safe_se_handler_table dd 2FD0h, 8A8Ch, 12CC8h, 41h dup(0)
.rdata:0041FF30						; DATA XREF: .rdata:0041F768o
.rdata:00420040	___rtc_iaa	dd 0
.rdata:00420044	dword_420044	dd 40h dup(0)		; DATA XREF: __RTC_Initialize+2o
.rdata:00420144	___rtc_izz	dd 41h dup(0)		; DATA XREF: __RTC_Initialize+7o
.rdata:00420248	___rtc_taa	dd 0
.rdata:0042024C	dword_42024C	dd 40h dup(0)		; DATA XREF: __RTC_Terminate+2o
.rdata:0042034C	___rtc_tzz	dd 41h dup(0)		; DATA XREF: __RTC_Terminate+7o
.rdata:00420450	dword_420450	dd 0FFFFFFFEh, 0	; DATA XREF: _printf+2o
.rdata:00420458			dd 0FFFFFFD4h, 0
.rdata:00420460			dd 0FFFFFFFEh, 0
.rdata:00420468			dd offset $LN6
.rdata:0042046C			align 10h
.rdata:00420470	dword_420470	dd 0FFFFFFFEh, 0	; DATA XREF: doexit+2o
.rdata:00420478			dd 0FFFFFFD0h, 0
.rdata:00420480			dd 0FFFFFFFEh, 0
.rdata:00420488			dd offset $LN29
.rdata:0042048C			align 10h
.rdata:00420490	dword_420490	dd 0FFFFFFFEh, 0	; DATA XREF: _fprintf+2o
.rdata:00420498			dd 0FFFFFFD4h, 0
.rdata:004204A0			dd 0FFFFFFFEh, 0
.rdata:004204A8			dd offset $LN16_0
.rdata:004204AC			align 10h
.rdata:004204B0	dword_4204B0	dd 0FFFFFFFEh, 0	; DATA XREF: _V6_HeapAlloc+2o
.rdata:004204B8			dd 0FFFFFFD4h, 0
.rdata:004204C0			dd 0FFFFFFFEh, 0
.rdata:004204C8			dd offset $LN6_0
.rdata:004204CC			align 10h
.rdata:004204D0	dword_4204D0	dd 0FFFFFFFEh, 0	; DATA XREF: _free+2o
.rdata:004204D8			dd 0FFFFFFD4h, 0
.rdata:004204E0			dd 0FFFFFFFEh, 0
.rdata:004204E8			dd offset $LN12
.rdata:004204EC			align 10h
.rdata:004204F0	dword_4204F0	dd 0FFFFFFFEh, 0	; DATA XREF: __tmainCRTStartup+2o
.rdata:004204F8			dd 0FFFFFFC4h, 0
.rdata:00420500			dd 0FFFFFFFEh, 4020B4h,	4020C8h, 0
.rdata:00420510	dword_420510	dd 0FFFFFFFEh, 0	; DATA XREF: _vprintf_helper+2o
.rdata:00420518			dd 0FFFFFFD0h, 0
.rdata:00420520			dd 0FFFFFFFEh, 0
.rdata:00420528			dd offset $LN6_1
.rdata:0042052C			align 10h
.rdata:00420530	dword_420530	dd 0FFFFFFFEh, 0	; DATA XREF: __initptd+2o
.rdata:00420538			dd 0FFFFFFD4h, 0
.rdata:00420540			dd 0FFFFFFFEh, 0
.rdata:00420548			dd offset $LN8_0
.rdata:0042054C			align 10h
.rdata:00420550	dword_420550	dd 0FFFFFFFEh, 0	; DATA XREF: _freefls(x)+2o
.rdata:00420558			dd 0FFFFFFD8h, 0
.rdata:00420560			dd 0FFFFFFFEh, 0
.rdata:00420568			dd offset $LN17_1
.rdata:0042056C			dd 0FFFFFFFEh, 0
.rdata:00420574			dd offset $LN21
.rdata:00420578	dword_420578	dd 0FFFFFFFEh, 0	; DATA XREF: __mtinitlocknum+2o
.rdata:00420580			dd 0FFFFFFD4h, 0
.rdata:00420588			dd 0FFFFFFFEh, 0
.rdata:00420590			dd offset $LN12_0
.rdata:00420594			align 8
.rdata:00420598	dword_420598	dd 0FFFFFFFEh, 0	; DATA XREF: __onexit+2o
.rdata:004205A0			dd 0FFFFFFD4h, 0
.rdata:004205A8			dd 0FFFFFFFEh, 0
.rdata:004205B0			dd offset $LN5
.rdata:004205B4			align 8
.rdata:004205B8	dword_4205B8	dd 0FFFFFFFEh, 0	; DATA XREF: __IsNonwritableInCurrentImage+5o
.rdata:004205C0			dd 0FFFFFFD8h, 0
.rdata:004205C8			dd 0FFFFFFFEh, 403F79h,	403F8Dh, 0
.rdata:004205D8	dword_4205D8	dd 0FFFFFFFEh, 0	; DATA XREF: terminate(void)+2o
.rdata:004205E0			dd 0FFFFFFD8h, 0
.rdata:004205E8			dd 0FFFFFFFEh, 403FCBh,	403FCFh, 0
.rdata:004205F8	dword_4205F8	dd 0FFFFFFFEh, 0	; DATA XREF: _inconsistency(void)+2o
.rdata:00420600			dd 0FFFFFFD8h, 0
.rdata:00420608			dd 0FFFFFFFEh, 40401Bh,	40401Fh, 0
.rdata:00420618	dword_420618	dd 0FFFFFFFEh, 0	; DATA XREF: ctrlevent_capture+2o
.rdata:00420620			dd 0FFFFFFD0h, 0
.rdata:00420628			dd 0FFFFFFFEh, 0
.rdata:00420630			dd offset $LN10_1
.rdata:00420634			align 8
.rdata:00420638	dword_420638	dd 0FFFFFFFEh, 0	; DATA XREF: _signal+2o
.rdata:00420640			dd 0FFFFFFD0h, 0
.rdata:00420648			dd 0FFFFFFFEh, 0
.rdata:00420650			dd offset $LN41
.rdata:00420654			align 8
.rdata:00420658	dword_420658	dd 0FFFFFFFEh, 0	; DATA XREF: _raise+2o
.rdata:00420660			dd 0FFFFFFC0h, 0
.rdata:00420668			dd 0FFFFFFFEh, 0
.rdata:00420670			dd offset $LN35_0
.rdata:00420674			align 8
.rdata:00420678	dword_420678	dd 0FFFFFFFEh, 0	; DATA XREF: ___crtInitCritSecAndSpinCount+2o
.rdata:00420680			dd 0FFFFFFCCh, 0
.rdata:00420688			dd 0FFFFFFFEh, 4049F1h,	404A08h, 0
.rdata:00420698	dword_420698	dd 0FFFFFFFEh, 0	; DATA XREF: __ioinit+2o
.rdata:004206A0			dd 0FFFFFF8Ch, 0
.rdata:004206A8			dd 0FFFFFFFEh, 404CE0h,	404CE4h, 0
.rdata:004206B8	dword_4206B8	dd 0FFFFFFFEh, 0	; DATA XREF: _vfprintf_helper+2o
.rdata:004206C0			dd 0FFFFFFD4h, 0
.rdata:004206C8			dd 0FFFFFFFEh, 0
.rdata:004206D0			dd offset $LN16_2
.rdata:004206D4			align 8
.rdata:004206D8	dword_4206D8	dd 0FFFFFFFEh, 0	; DATA XREF: __fcloseall+2o
.rdata:004206E0			dd 0FFFFFFD0h, 0
.rdata:004206E8			dd 0FFFFFFFEh, 0
.rdata:004206F0			dd offset $LN11_2
.rdata:004206F4			align 8
.rdata:004206F8	dword_4206F8	dd 0FFFFFFFEh, 0	; DATA XREF: flsall+2o
.rdata:00420700			dd 0FFFFFFCCh, 0
.rdata:00420708			dd 0FFFFFFFEh, 0
.rdata:00420710			dd offset $LN18_0
.rdata:00420714			dd 2 dup(0)
.rdata:0042071C			dd offset $LN22_0
.rdata:00420720	dword_420720	dd 0FFFFFFFEh, 0	; DATA XREF: _fflush+2o
.rdata:00420728			dd 0FFFFFFD4h, 0
.rdata:00420730			dd 0FFFFFFFEh, 0
.rdata:00420738			dd offset $LN6_5
.rdata:0042073C			align 10h
.rdata:00420740	dword_420740	dd 0FFFFFFFEh, 0	; DATA XREF: ___updatetmbcinfo+2o
.rdata:00420748			dd 0FFFFFFD4h, 0
.rdata:00420750			dd 0FFFFFFFEh, 0
.rdata:00420758			dd offset $LN11_3
.rdata:0042075C			align 10h
.rdata:00420760	dword_420760	dd 0FFFFFFFEh, 0	; DATA XREF: __setmbcp+2o
.rdata:00420768			dd 0FFFFFFCCh, 0
.rdata:00420770			dd 0FFFFFFFEh, 0
.rdata:00420778			dd offset $LN25_0
.rdata:0042077C			align 10h
.rdata:00420780	dword_420780	dd 0FFFFFFFEh, 0	; DATA XREF: ___updatetlocinfo+2o
.rdata:00420788			dd 0FFFFFFD4h, 0
.rdata:00420790			dd 0FFFFFFFEh, 0
.rdata:00420798			dd offset $LN9_4
.rdata:0042079C			align 10h
.rdata:004207A0	dword_4207A0	dd 0FFFFFFFEh, 0	; DATA XREF: __free_locale+2o
.rdata:004207A8			dd 0FFFFFFD8h, 0
.rdata:004207B0			dd 0FFFFFFFEh, 0
.rdata:004207B8			dd offset $LN9_5
.rdata:004207BC			align 10h
.rdata:004207C0	dword_4207C0	dd 0FFFFFFFEh, 0	; DATA XREF: __get_current_locale+2o
.rdata:004207C8			dd 0FFFFFFD4h, 0
.rdata:004207D0			dd 0FFFFFFFEh, 0
.rdata:004207D8			dd offset $LN6_7
.rdata:004207DC			align 10h
.rdata:004207E0	dword_4207E0	dd 0FFFFFFFEh, 0	; DATA XREF: _setlocale+2o
.rdata:004207E8			dd 0FFFFFFCCh, 0
.rdata:004207F0			dd 0FFFFFFFEh, 0
.rdata:004207F8			dd offset $LN15_2
.rdata:004207FC			dd 2 dup(0)
.rdata:00420804			dd offset $LN19_4
.rdata:00420808			align 10h
.rdata:00420810			dd offset $LN23_1
.rdata:00420814			align 8
.rdata:00420818	dword_420818	dd 0FFFFFFFEh, 0	; DATA XREF: __msize+2o
.rdata:00420820			dd 0FFFFFFD0h, 0
.rdata:00420828			dd 0FFFFFFFEh, 0
.rdata:00420830			dd offset $LN10_4
.rdata:00420834			align 8
.rdata:00420838	dword_420838	dd 0FFFFFFFEh, 0	; DATA XREF: __calloc_impl+2o
.rdata:00420840			dd 0FFFFFFD4h, 0
.rdata:00420848			dd 0FFFFFFFEh, 0
.rdata:00420850			dd offset $LN22_2
.rdata:00420854			align 8
.rdata:00420858	dword_420858	dd 0FFFFFFFEh, 0	; DATA XREF: _realloc+2o
.rdata:00420860			dd 0FFFFFFD0h, 0
.rdata:00420868			dd 0FFFFFFFEh, 0
.rdata:00420870			dd offset $LN46
.rdata:00420874			align 8
.rdata:00420878	dword_420878	dd 0FFFFFFFEh, 0	; DATA XREF: _fclose+2o
.rdata:00420880			dd 0FFFFFFD4h, 0
.rdata:00420888			dd 0FFFFFFFEh, 0
.rdata:00420890			dd offset $LN8_4
.rdata:00420894			align 8
.rdata:00420898	dword_420898	dd 0FFFFFFFEh, 0	; DATA XREF: __write+2o
.rdata:004208A0			dd 0FFFFFFD0h, 0
.rdata:004208A8			dd 0FFFFFFFEh, 0
.rdata:004208B0			dd offset $LN12_8
.rdata:004208B4			align 8
.rdata:004208B8	dword_4208B8	dd 0FFFFFFFEh, 0	; DATA XREF: __commit+2o
.rdata:004208C0			dd 0FFFFFFD0h, 0
.rdata:004208C8			dd 0FFFFFFFEh, 0
.rdata:004208D0			dd offset $LN14_2
.rdata:004208D4			align 8
.rdata:004208D8	dword_4208D8	dd 0FFFFFFFEh, 0	; DATA XREF: __lseeki64+2o
.rdata:004208E0			dd 0FFFFFFCCh, 0
.rdata:004208E8			dd 0FFFFFFFEh, 0
.rdata:004208F0			dd offset $LN12_9
.rdata:004208F4			align 8
.rdata:004208F8	dword_4208F8	dd 0FFFFFFFEh, 0	; DATA XREF: __close+2o
.rdata:00420900			dd 0FFFFFFD0h, 0
.rdata:00420908			dd 0FFFFFFFEh, 0
.rdata:00420910			dd offset $LN12_10
.rdata:00420914			align 8
.rdata:00420918	dword_420918	dd 0FFFFFFFEh, 0	; DATA XREF: __cputws+2o
.rdata:00420920			dd 0FFFFFFD0h, 0
.rdata:00420928			dd 0FFFFFFFEh, 0
.rdata:00420930			dd offset $LN9_8
.rdata:00420934			align 8
.rdata:00420938	dword_420938	dd 0FFFFFFFEh, 0	; DATA XREF: __putwch+2o
.rdata:00420940			dd 0FFFFFFD4h, 0
.rdata:00420948			dd 0FFFFFFFEh, 0
.rdata:00420950			dd offset $LN5_0
.rdata:00420954			align 8
.rdata:00420958	dword_420958	dd 0FFFFFFFEh, 0	; DATA XREF: ___lock_fhandle+2o
.rdata:00420960			dd 0FFFFFFD4h, 0
.rdata:00420968			dd 0FFFFFFFEh, 0
.rdata:00420970			dd offset $LN9_9
.rdata:00420974			align 8
.rdata:00420978	dword_420978	dd 0FFFFFFFEh, 0	; DATA XREF: __alloc_osfhnd+2o
.rdata:00420980			dd 0FFFFFFC8h, 0
.rdata:00420988			dd 0FFFFFFFEh, 0
.rdata:00420990			dd offset $LN29_0
.rdata:00420994			dd 2 dup(0)
.rdata:0042099C			dd offset $LN33
.rdata:004209A0	dword_4209A0	dd 0FFFFFFFEh, 0	; DATA XREF: __open_osfhandle+2o
.rdata:004209A8			dd 0FFFFFFD4h, 0
.rdata:004209B0			dd 0FFFFFFFEh, 0
.rdata:004209B8			dd offset $LN16_4
.rdata:004209BC			align 10h
.rdata:004209C0	dword_4209C0	dd 0FFFFFFFEh, 0	; DATA XREF: _tzset_nolock+2o
.rdata:004209C8			dd 0FFFFFFB4h, 0
.rdata:004209D0			dd 0FFFFFFFEh, 0
.rdata:004209D8			dd offset $LN36_2
.rdata:004209DC			align 10h
.rdata:004209E0	dword_4209E0	dd 0FFFFFFFEh, 0	; DATA XREF: ___tzset+2o
.rdata:004209E8			dd 0FFFFFFD8h, 0
.rdata:004209F0			dd 0FFFFFFFEh, 0
.rdata:004209F8			dd offset $LN7_8
.rdata:004209FC			align 10h
.rdata:00420A00	dword_420A00	dd 0FFFFFFFEh, 0	; DATA XREF: __tzset+2o
.rdata:00420A08			dd 0FFFFFFD8h, 0
.rdata:00420A10			dd 0FFFFFFFEh, 0
.rdata:00420A18			dd offset $LN5_1
.rdata:00420A1C			align 10h
.rdata:00420A20	dword_420A20	dd 0FFFFFFFEh, 0	; DATA XREF: __isindst+2o
.rdata:00420A28			dd 0FFFFFFD4h, 0
.rdata:00420A30			dd 0FFFFFFFEh, 0
.rdata:00420A38			dd offset $LN5_2
.rdata:00420A3C			align 10h
.rdata:00420A40	dword_420A40	dd 0FFFFFFFEh, 0	; DATA XREF: has_osfxsr_set+2o
.rdata:00420A48			dd 0FFFFFFD4h, 0
.rdata:00420A50			dd 0FFFFFFFEh, 414FA7h,	414FC3h, 0
.rdata:00420A60	dword_420A60	dd 0FFFFFFFEh, 0	; DATA XREF: _getenv+2o
.rdata:00420A68			dd 0FFFFFFD0h, 0
.rdata:00420A70			dd 0FFFFFFFEh, 0
.rdata:00420A78			dd offset $LN7_10
.rdata:00420A7C			align 10h
.rdata:00420A80	dword_420A80	dd 0FFFFFFFEh, 0	; DATA XREF: _getenv_s+2o
.rdata:00420A88			dd 0FFFFFFD4h, 0
.rdata:00420A90			dd 0FFFFFFFEh, 0
.rdata:00420A98			dd offset $LN5_3
.rdata:00420A9C			align 10h
.rdata:00420AA0	dword_420AA0	dd 0FFFFFFFEh, 0	; DATA XREF: __dupenv_s+2o
.rdata:00420AA8			dd 0FFFFFFD0h, 0
.rdata:00420AB0			dd 0FFFFFFFEh, 0
.rdata:00420AB8			dd offset $LN5_4
.rdata:00420ABC			align 800h
.rdata:00420ABC	_rdata		ends
.rdata:00420ABC
.data:00421000 ; Section 3. (virtual address 00021000)
.data:00421000 ; Virtual size		       : 000033C8 (  13256.)
.data:00421000 ; Section size in file	       : 00002000 (   8192.)
.data:00421000 ; Offset	to raw data for	section: 00021000
.data:00421000 ; Flags C0000040: Data Readable Writable
.data:00421000 ; Alignment     : default
.data:00421000 ; ===========================================================================
.data:00421000
.data:00421000 ; Segment type: Pure data
.data:00421000 ; Segment permissions: Read/Write
.data:00421000 _data	       segment para public 'DATA' use32
.data:00421000		       assume cs:_data
.data:00421000		       ;org 421000h
.data:00421000 ; char format[4]
.data:00421000 format	       db '%d',0Ah,0           ; DATA XREF: _main+55o
.data:00421004 aOutOfSpace     db 'Out of space!!!',0  ; DATA XREF: _CreateStack+17o
.data:00421014 ; char aS[]
.data:00421014 aS	       db '%s',0Ah,0           ; DATA XREF: _CreateStack+1Co
.data:00421018 aMustUseCreates db 'Must use CreateStack first',0 ; DATA XREF: _MakeEmpty+9o
.data:00421033		       align 4
.data:00421034 ; char aS_0[]
.data:00421034 aS_0	       db '%s',0Ah,0           ; DATA XREF: _MakeEmpty+Eo
.data:00421038 aOutOfSpace_0   db 'Out of space!!!',0  ; DATA XREF: _Push+17o
.data:00421048 ; char aS_1[]
.data:00421048 aS_1	       db '%s',0Ah,0           ; DATA XREF: _Push+1Co
.data:0042104C aEmptyStack     db 'Empty stack',0      ; DATA XREF: _Top:loc_40127Do
.data:00421058 ; char aS_2[]
.data:00421058 aS_2	       db '%s',0Ah,0           ; DATA XREF: _Top+22o
.data:0042105C aEmptyStack_0   db 'Empty stack',0      ; DATA XREF: _Pop+14o
.data:00421068 ; char aS_3[]
.data:00421068 aS_3	       db '%s',0Ah,0           ; DATA XREF: _Pop+19o
.data:0042106C		       dd 5 dup(0)
.data:00421080 ; void *_aexit_rtn
.data:00421080 __aexit_rtn     dd offset __exit	       ; DATA XREF: __amsg_exit+Er
.data:00421080					       ; __init_pointers+45w
.data:00421084		       align 8
.data:00421088 ; FILE _iob[]
.data:00421088 __iob	       dd offset __bufin       ; DATA XREF: ___iob_funco
.data:00421088					       ; ___initstdio+52o ...
.data:0042108C		       align 10h
.data:00421090		       dd offset __bufin
.data:00421094		       dd 101h
.data:00421098 dword_421098    dd 2 dup(0)	       ; DATA XREF: ___initstdio+74o
.data:004210A0		       dd 1000h, 4 dup(0)
.data:004210B4		       dd 2, 1,	6 dup(0)
.data:004210D4		       dd 2 dup(2), 7 dup(0)
.data:004210F8 dword_4210F8    dd 7Ch dup(0)	       ; DATA XREF: ___initstdio+A4o
.data:004212E8 dword_4212E8    dd 8 dup(0)	       ; DATA XREF: __lock_file+Eo
.data:004212E8					       ; __unlock_file+Do
.data:00421308 ___app_type     dd 1		       ; DATA XREF: ___initstdio+67o
.data:00421308					       ; __NMSG_WRITE+42r ...
.data:0042130C ; char *__nullstring
.data:0042130C ___nullstring   dd offset aNull_0       ; DATA XREF: __output_l:loc_40280Er
.data:0042130C					       ; __output_l+7E6r ...
.data:0042130C					       ; "(null)"
.data:00421310 ___wnullstring  dd offset aNull	       ; DATA XREF: __output_l+433r
.data:00421310					       ; __output_s_l+444r ...
.data:00421310					       ; "(null)"
.data:00421314		       align 8
.data:00421318 ; errentry errtable[45]
.data:00421318 errtable	       errentry	<1, 16h>       ; DATA XREF: __get_errno_from_oserr:loc_402E35r
.data:00421318					       ; __get_errno_from_oserr:loc_402E50r
.data:00421318		       errentry	<2, 2>
.data:00421318		       errentry	<3, 2>
.data:00421318		       errentry	<4, 18h>
.data:00421318		       errentry	<5, 0Dh>
.data:00421318		       errentry	<6, 9>
.data:00421318		       errentry	<7, 0Ch>
.data:00421318		       errentry	<8, 0Ch>
.data:00421318		       errentry	<9, 0Ch>
.data:00421318		       errentry	<0Ah, 7>
.data:00421318		       errentry	<0Bh, 8>
.data:00421318		       errentry	<0Ch, 16h>
.data:00421318		       errentry	<0Dh, 16h>
.data:00421318		       errentry	<0Fh, 2>
.data:00421318		       errentry	<10h, 0Dh>
.data:00421318		       errentry	<11h, 12h>
.data:00421318		       errentry	<12h, 2>
.data:00421318		       errentry	<21h, 0Dh>
.data:00421318		       errentry	<35h, 2>
.data:00421318		       errentry	<41h, 0Dh>
.data:00421318		       errentry	<43h, 2>
.data:00421318		       errentry	<50h, 11h>
.data:00421318		       errentry	<52h, 0Dh>
.data:00421318		       errentry	<53h, 0Dh>
.data:00421318		       errentry	<57h, 16h>
.data:00421318		       errentry	<59h, 0Bh>
.data:00421318		       errentry	<6Ch, 0Dh>
.data:00421318		       errentry	<6Dh, 20h>
.data:00421318		       errentry	<70h, 1Ch>
.data:00421318		       errentry	<72h, 9>
.data:00421318		       errentry	<6, 16h>
.data:00421318		       errentry	<80h, 0Ah>
.data:00421318		       errentry	<81h, 0Ah>
.data:00421318		       errentry	<82h, 9>
.data:00421318		       errentry	<83h, 16h>
.data:00421318		       errentry	<84h, 0Dh>
.data:00421318		       errentry	<91h, 29h>
.data:00421318		       errentry	<9Eh, 0Dh>
.data:00421318		       errentry	<0A1h, 2>
.data:00421318		       errentry	<0A4h, 0Bh>
.data:00421318		       errentry	<0A7h, 0Dh>
.data:00421318		       errentry	<0B7h, 11h>
.data:00421318		       errentry	<0CEh, 2>
.data:00421318		       errentry	<0D7h, 0Bh>
.data:00421318		       errentry	<718h, 0Ch>
.data:00421480 ; int ErrnoNoMem
.data:00421480 ErrnoNoMem      dd 0Ch		       ; DATA XREF: __errno+9o
.data:00421484 ; unsigned int DoserrorNoMem
.data:00421484 DoserrorNoMem   dd 8		       ; DATA XREF: ___doserrno+9o
.data:00421488 ___security_cookie dd 0BB40E64Eh	       ; DATA XREF: __set_printf_count_outputr
.data:00421488					       ; __get_printf_count_outputr ...
.data:0042148C ___security_cookie_complement dd	44BF19B1h
.data:0042148C					       ; DATA XREF: ___security_init_cookie+29w
.data:0042148C					       ; ___security_init_cookie+89w ...
.data:00421490 ___flsindex     dd 0FFFFFFFFh	       ; DATA XREF: __encode_pointer+13r
.data:00421490					       ; __decode_pointer+13r ...
.data:00421494 ; DWORD __getvalueindex
.data:00421494 ___getvalueindex	dd 0FFFFFFFFh	       ; DATA XREF: __encode_pointer+1r
.data:00421494					       ; __encode_pointer+1Er ...
.data:00421498 ; rterrmsgs rterrs[23]
.data:00421498 rterrs	       rterrmsgs <2, offset aR6002FloatingP>
.data:00421498					       ; DATA XREF: __NMSG_WRITE:loc_40391Fr
.data:00421498					       ; __GET_RTERRMSG+6r ...
.data:00421498		       rterrmsgs <8, offset aR6008NotEnough> ; "runtime	error "
.data:00421498		       rterrmsgs <9, offset aR6009NotEnough>
.data:00421498		       rterrmsgs <0Ah, offset aThisApplicatio>
.data:00421498		       rterrmsgs <10h, offset aR6016NotEnough>
.data:00421498		       rterrmsgs <11h, offset aR6017Unexpecte>
.data:00421498		       rterrmsgs <12h, offset aR6018Unexpecte>
.data:00421498		       rterrmsgs <13h, offset aR6019UnableToO>
.data:00421498		       rterrmsgs <18h, offset aR6024NotEnough>
.data:00421498		       rterrmsgs <19h, offset aR6025PureVirtu>
.data:00421498		       rterrmsgs <1Ah, offset aR6026NotEnough>
.data:00421498		       rterrmsgs <1Bh, offset aR6027NotEnough>
.data:00421498		       rterrmsgs <1Ch, offset aR6028UnableToI>
.data:00421498		       rterrmsgs <1Eh, offset aR6030CrtNotIni>
.data:00421498		       rterrmsgs <1Fh, offset aR6031AttemptTo>
.data:00421498		       rterrmsgs <20h, offset aR6032NotEnough>
.data:00421498		       rterrmsgs <21h, offset aR6033AttemptTo>
.data:00421498		       rterrmsgs <22h, offset aR6034AnApplica>
.data:00421498		       rterrmsgs <78h, offset aDomainError>
.data:00421498		       rterrmsgs <79h, offset aSingError>
.data:00421498		       rterrmsgs <7Ah, offset aTlossError>
.data:00421498		       rterrmsgs <0FCh,	offset asc_41DD88>
.data:00421498		       rterrmsgs <0FFh,	offset aRuntimeError>
.data:00421550 ; LPCRITICAL_SECTION locktable
.data:00421550 _locktable      $A523CF47630928189F043837EB68A11F 2 dup(<0, lkPrealloc>)
.data:00421550					       ; DATA XREF: __mtinitlocks:loc_403B49w
.data:00421550					       ; __mtdeletelocks+8o ...
.data:00421550		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00421550		       $A523CF47630928189F043837EB68A11F 2 dup(<0, lkPrealloc>)
.data:00421550		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00421550		       $A523CF47630928189F043837EB68A11F 3 dup(<0, lkPrealloc>)
.data:00421550		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00421550		       $A523CF47630928189F043837EB68A11F <0, lkPrealloc>
.data:00421550		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00421550		       $A523CF47630928189F043837EB68A11F 3 dup(<0, lkPrealloc>)
.data:00421550		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00421550		       $A523CF47630928189F043837EB68A11F 3 dup(<0, lkPrealloc>)
.data:00421550		       $A523CF47630928189F043837EB68A11F  11h dup(<0>)
.data:00421670 __cfltcvt_tab   dd offset __fptrap      ; DATA XREF: __mtdeletelocks+2Ao
.data:00421670					       ; __mtdeletelocks+4Ao ...
.data:00421674		       dd offset __fptrap
.data:00421678		       dd offset __fptrap
.data:0042167C		       dd offset __fptrap
.data:00421680		       dd offset __fptrap
.data:00421684		       dd offset __fptrap
.data:00421688 ; void *codedptr
.data:00421688 codedptr	       dd offset __fptrap      ; DATA XREF: __output_l+61Ar
.data:00421688					       ; __output_s_l+629r ...
.data:0042168C		       dd offset __fptrap
.data:00421690 ; void *off_421690
.data:00421690 off_421690      dd offset __fptrap      ; DATA XREF: __output_l+65Fr
.data:00421690					       ; __output_s_l+66Fr ...
.data:00421694 ; void *off_421694
.data:00421694 off_421694      dd offset __fptrap      ; DATA XREF: __output_l+640r
.data:00421694					       ; __output_s_l+650r ...
.data:00421698 ; char _XcptActTab[3]
.data:00421698 __XcptActTab    db 5, 2 dup(0)	       ; DATA XREF: __initptd+1Do
.data:00421698					       ; _freefls(x)+6Eo ...
.data:0042169B		       db 0C0h
.data:0042169C		       dd 0Bh, 0
.data:004216A4		       dd 0C000001Dh, 4, 0
.data:004216B0		       dd 0C0000096h, 4, 0
.data:004216BC		       dd 0C000008Dh, 8, 0
.data:004216C8		       dd 0C000008Eh, 8, 0
.data:004216D4		       dd 0C000008Fh, 8, 0
.data:004216E0		       dd 0C0000090h, 8, 0
.data:004216EC		       dd 0C0000091h, 8, 0
.data:004216F8		       dd 0C0000092h, 8, 0
.data:00421704		       dd 0C0000093h, 8, 0
.data:00421710 __First_FPE_Indx	dd 3		       ; DATA XREF: __XcptFilter+90r
.data:00421710					       ; __XcptFilter+AFr ...
.data:00421714 __Num_FPE       dd 7		       ; DATA XREF: __XcptFilter+96r
.data:00421714					       ; __XcptFilter+B5r ...
.data:00421718 ; unsigned int _XcptActTabSize
.data:00421718 __XcptActTabSize	dd 78h		       ; DATA XREF: _signal+83r
.data:00421718					       ; _signal+9Ar
.data:0042171C __XcptActTabCount dd 0Ah		       ; DATA XREF: xcptlookup+4r
.data:0042171C					       ; __XcptFilter+18r ...
.data:00421720 ___badioinfo    dd 0FFFFFFFFh, 0A80h, 0Eh dup(0)
.data:00421720					       ; DATA XREF: _fprintf:loc_4019BEo
.data:00421720					       ; _fprintf:loc_401A03o ...
.data:00421760 ; unsigned int _amblksiz
.data:00421760 __amblksiz      dd 10h		       ; DATA XREF: __set_amblksiz:loc_4053B3w
.data:00421760					       ; __get_amblksiz+30r
.data:00421764		       align 8
.data:00421768 ; volatile LONG __initialmbcinfo
.data:00421768 ___initialmbcinfo dd 0		       ; DATA XREF: __initptd+6Eo
.data:00421768					       ; _freefls(x)+9Ao ...
.data:0042176C		       dd 16h dup(0)
.data:004217C4		       dd 10100000h, 6 dup(10101010h), 0
.data:004217E4		       dd 20200000h, 6 dup(20202020h), 31h dup(0)
.data:004218C4		       dd 62610000h, 66656463h,	6A696867h, 6E6D6C6Bh, 7271706Fh
.data:004218C4		       dd 76757473h, 7A797877h,	0
.data:004218E4		       db    0
.data:004218E5		       align 2
.data:004218E6 aAbcdefghijklmn db 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',0
.data:00421901		       align 4
.data:00421904		       dd 21h dup(0)
.data:00421988 ; unsigned __int8 _mbctype[]
.data:00421988 __mbctype       db 0		       ; DATA XREF: __setmbcp+102w
.data:00421989		       align 4
.data:0042198C		       dd 0Fh dup(0)
.data:004219C8		       dd 10100000h, 6 dup(10101010h), 0
.data:004219E8		       dd 20200000h, 6 dup(20202020h), 23h dup(0)
.data:00421A90 ; unsigned __int8 _mbcasemap[]
.data:00421A90 __mbcasemap     db 0		       ; DATA XREF: __setmbcp+11Ew
.data:00421A91		       align 4
.data:00421A94		       dd 0Fh dup(0)
.data:00421AD0		       dd 63626100h, 67666564h,	6B6A6968h, 6F6E6D6Ch, 73727170h
.data:00421AD0		       dd 77767574h, 7A7978h, 0
.data:00421AF0		       db    0
.data:00421AF1 aAbcdefghijkl_0 db 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',0
.data:00421B0C		       dd 21h dup(0)
.data:00421B90 ; volatile LONG *___ptmbcinfo
.data:00421B90 ___ptmbcinfo    dd offset ___initialmbcinfo
.data:00421B90					       ; DATA XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+41r
.data:00421B90					       ; ___updatetmbcinfo+4Cr	...
.data:00421B94 ; char _rgctypeflag[4]
.data:00421B94 __rgctypeflag   db 1, 2,	4, 8	       ; DATA XREF: __setmbcp_nolock+111r
.data:00421B98 ; code_page_info	_rgcode_page_info[5]
.data:00421B98 __rgcode_page_info dd 3A4h		  ; code_page
.data:00421B98					       ; DATA XREF: __setmbcp_nolock:loc_406D8Dr
.data:00421B98					       ; __setmbcp_nolock+159o
.data:00421B98		       dw 8260h, 8279h,	21h, 3 dup(0); mbulinfo
.data:00421B98		       db 0A6h,	0DFh, 6	dup(0),	0A1h, 0A5h, 6 dup(0), 81h, 9Fh;	rgrange
.data:00421B98		       db 0E0h,	0FCh, 4	dup(0),	40h, 7Eh, 80h, 0FCh, 4 dup(0); rgrange
.data:00421B98		       dd 3A8h		       ; code_page
.data:00421B98		       dw 0A3C1h, 0A3DAh, 20h, 3 dup(0); mbulinfo
.data:00421B98		       db 10h dup(0), 81h, 0FEh, 6 dup(0), 40h,	0FEh, 6	dup(0);	rgrange
.data:00421B98		       dd 3B5h		       ; code_page
.data:00421B98		       dw 0A3C1h, 0A3DAh, 20h, 3 dup(0); mbulinfo
.data:00421B98		       db 10h dup(0), 81h, 0FEh, 6 dup(0), 41h,	0FEh, 6	dup(0);	rgrange
.data:00421B98		       dd 3B6h		       ; code_page
.data:00421B98		       dw 0A2CFh, 0A2E4h, 1Ah, 0A2E5h, 0A2E8h, 5Bh; mbulinfo
.data:00421B98		       db 10h dup(0), 81h, 0FEh, 6 dup(0), 40h,	7Eh, 0A1h, 0FEh; rgrange
.data:00421B98		       db 4 dup(0)	       ; rgrange
.data:00421B98		       dd 551h		       ; code_page
.data:00421B98		       dw 0DA51h, 0DA5Eh, 20h, 0DA5Fh, 0DA6Ah, 32h; mbulinfo
.data:00421B98		       db 10h dup(0), 81h, 0D3h, 0D8h, 0DEh, 0E0h, 0F9h, 2 dup(0); rgrange
.data:00421B98		       db 31h, 7Eh, 81h, 0FEh, 4 dup(0); rgrange
.data:00421C88 ; const __int16 *ctype_loc_style
.data:00421C88 _ctype_loc_style	dd offset aHH	       ; DATA XREF: _setlocale_set_cat+20Er
.data:00421C88					       ; "	  h((((			 H"
.data:00421C8C ___globallocalestatus dd	0FFFFFFFEh     ; DATA XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+2Cr
.data:00421C8C					       ; _LocaleUpdate::_LocaleUpdate(localeinfo_struct	*)+4Cr	...
.data:00421C90 ; char __clocalestr[2]
.data:00421C90 ___clocalestr   db 'C',0                ; DATA XREF: ___freetlocinfo:loc_407227o
.data:00421C90					       ; ___addlocaleref:loc_4072B5o ...
.data:00421C92		       align 8
.data:00421C98 ; threadlocaleinfostruct	__initiallocinfo
.data:00421C98 ___initiallocinfo dd 1			 ; refcount
.data:00421C98					       ; DATA XREF: _freefls(x)+DAo
.data:00421C98					       ; _updatetlocinfoEx_nolock+28o ...
.data:00421C98		       dd 0		       ; lc_codepage ; "	 (((((			H"
.data:00421C98		       dd 0		       ; lc_collate_cp
.data:00421C98		       dd 6 dup(0)	       ; lc_handle
.data:00421C98		       dw 0		       ; lc_id.wLanguage
.data:00421C98		       dw 0		       ; lc_id.wCountry
.data:00421C98		       dw 0		       ; lc_id.wCodePage
.data:00421C98		       dw 0		       ; lc_id.wLanguage
.data:00421C98		       dw 0		       ; lc_id.wCountry
.data:00421C98		       dw 0		       ; lc_id.wCodePage
.data:00421C98		       dw 0		       ; lc_id.wLanguage
.data:00421C98		       dw 0		       ; lc_id.wCountry
.data:00421C98		       dw 0		       ; lc_id.wCodePage
.data:00421C98		       dw 0		       ; lc_id.wLanguage
.data:00421C98		       dw 0		       ; lc_id.wCountry
.data:00421C98		       dw 0		       ; lc_id.wCodePage
.data:00421C98		       dw 0		       ; lc_id.wLanguage
.data:00421C98		       dw 0		       ; lc_id.wCountry
.data:00421C98		       dw 0		       ; lc_id.wCodePage
.data:00421C98		       dw 0		       ; lc_id.wLanguage
.data:00421C98		       dw 0		       ; lc_id.wCountry
.data:00421C98		       dw 0		       ; lc_id.wCodePage
.data:00421C98		       dd 0		       ; lc_category.locale
.data:00421C98		       dd 0		       ; lc_category.wlocale
.data:00421C98		       dd 0		       ; lc_category.refcount
.data:00421C98		       dd 0		       ; lc_category.wrefcount
.data:00421C98		       dd offset ___clocalestr ; lc_category.locale
.data:00421C98		       dd 0		       ; lc_category.wlocale
.data:00421C98		       dd 0		       ; lc_category.refcount
.data:00421C98		       dd 0		       ; lc_category.wrefcount
.data:00421C98		       dd offset ___clocalestr ; lc_category.locale
.data:00421C98		       dd 0		       ; lc_category.wlocale
.data:00421C98		       dd 0		       ; lc_category.refcount
.data:00421C98		       dd 0		       ; lc_category.wrefcount
.data:00421C98		       dd offset ___clocalestr ; lc_category.locale
.data:00421C98		       dd 0		       ; lc_category.wlocale
.data:00421C98		       dd 0		       ; lc_category.refcount
.data:00421C98		       dd 0		       ; lc_category.wrefcount
.data:00421C98		       dd offset ___clocalestr ; lc_category.locale
.data:00421C98		       dd 0		       ; lc_category.wlocale
.data:00421C98		       dd 0		       ; lc_category.refcount
.data:00421C98		       dd 0		       ; lc_category.wrefcount
.data:00421C98		       dd offset ___clocalestr ; lc_category.locale
.data:00421C98		       dd 0		       ; lc_category.wlocale
.data:00421C98		       dd 0		       ; lc_category.refcount
.data:00421C98		       dd 0		       ; lc_category.wrefcount
.data:00421C98		       dd 1		       ; lc_clike
.data:00421C98		       dd 1		       ; mb_cur_max
.data:00421C98		       dd 0		       ; lconv_intl_refcount
.data:00421C98		       dd 0		       ; lconv_num_refcount
.data:00421C98		       dd 0		       ; lconv_mon_refcount
.data:00421C98		       dd offset ___lconv_c    ; lconv
.data:00421C98		       dd 0		       ; ctype1_refcount
.data:00421C98		       dd 0		       ; ctype1
.data:00421C98		       dd offset asc_41E690    ; pctype
.data:00421C98		       dd offset dword_41EB18  ; pclmap
.data:00421C98		       dd offset dword_41EC98  ; pcumap
.data:00421C98		       dd offset ___lc_time_c  ; lc_time_curr
.data:00421D70 ; threadlocaleinfostruct	*___ptlocinfo
.data:00421D70 ___ptlocinfo    dd offset ___initiallocinfo
.data:00421D70					       ; DATA XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+24r
.data:00421D70					       ; __initptd+93r	...
.data:00421D74 ___lc_clike     dd 1		       ; DATA XREF: sync_legacy_variables_lk+1Dw
.data:00421D78 ; localeinfo_struct __initiallocalestructinfo
.data:00421D78 ___initiallocalestructinfo localeinfo_struct <offset ___initiallocinfo, offset ___initialmbcinfo>
.data:00421D78					       ; DATA XREF: _iswctype+4Fo
.data:00421D78					       ; _strtol+17o ...
.data:00421D80 ___abort_behavior dd 3		       ; DATA XREF: _abort+1Br
.data:00421D80					       ; _abort:loc_40AC1Er ...
.data:00421D84		       align 10h
.data:00421D90 ; const unsigned	__int16	*_pctype
.data:00421D90 __pctype	       dd offset asc_41E690    ; DATA XREF: sync_legacy_variables_lk+41w
.data:00421D90					       ; "	   (((((		  H"
.data:00421D94 ; const wctype_t	*_pwctype
.data:00421D94 __pwctype       dd offset word_41E892   ; DATA XREF: ___pwctype_funcr
.data:00421D94					       ; __iswctype_l+20r ...
.data:00421D98 ___lc_time_c    dd offset aSun	       ; DATA XREF: ___freetlocinfo+D9o
.data:00421D98					       ; ___init_time+Co ...
.data:00421D98					       ; "Sun"
.data:00421D9C		       dd offset aMon	       ; "Mon"
.data:00421DA0		       dd offset aTue	       ; "Tue"
.data:00421DA4		       dd offset aWed	       ; "Wed"
.data:00421DA8		       dd offset aThu	       ; "Thu"
.data:00421DAC		       dd offset aFri	       ; "Fri"
.data:00421DB0		       dd offset aSat	       ; "Sat"
.data:00421DB4		       dd offset aSunday       ; "Sunday"
.data:00421DB8		       dd offset aMonday       ; "Monday"
.data:00421DBC		       dd offset aTuesday      ; "Tuesday"
.data:00421DC0		       dd offset aWednesday    ; "Wednesday"
.data:00421DC4		       dd offset aThursday     ; "Thursday"
.data:00421DC8		       dd offset aFriday       ; "Friday"
.data:00421DCC		       dd offset aSaturday     ; "Saturday"
.data:00421DD0		       dd offset aJan	       ; "Jan"
.data:00421DD4		       dd offset aFeb	       ; "Feb"
.data:00421DD8		       dd offset aMar	       ; "Mar"
.data:00421DDC		       dd offset aApr	       ; "Apr"
.data:00421DE0		       dd offset aMay	       ; "May"
.data:00421DE4		       dd offset aJun	       ; "Jun"
.data:00421DE8		       dd offset aJul	       ; "Jul"
.data:00421DEC		       dd offset aAug	       ; "Aug"
.data:00421DF0		       dd offset aSep	       ; "Sep"
.data:00421DF4		       dd offset aOct	       ; "Oct"
.data:00421DF8		       dd offset aNov	       ; "Nov"
.data:00421DFC		       dd offset aDec	       ; "Dec"
.data:00421E00		       dd offset aJanuary      ; "January"
.data:00421E04		       dd offset aFebruary     ; "February"
.data:00421E08		       dd offset aMarch	       ; "March"
.data:00421E0C		       dd offset aApril	       ; "April"
.data:00421E10		       dd offset aMay	       ; "May"
.data:00421E14		       dd offset aJune	       ; "June"
.data:00421E18		       dd offset aJuly	       ; "July"
.data:00421E1C		       dd offset aAugust       ; "August"
.data:00421E20		       dd offset aSeptember    ; "September"
.data:00421E24		       dd offset aOctober      ; "October"
.data:00421E28		       dd offset aNovember     ; "November"
.data:00421E2C		       dd offset aDecember     ; "December"
.data:00421E30		       dd offset aAm	       ; "AM"
.data:00421E34		       dd offset aPm	       ; "PM"
.data:00421E38		       dd offset aMmDdYy       ; "MM/dd/yy"
.data:00421E3C		       dd offset aDdddMmmmDdYyyy ; "dddd, MMMM dd, yyyy"
.data:00421E40		       dd offset aHhMmSs       ; "HH:mm:ss"
.data:00421E44		       dd 409h,	1, 0
.data:00421E50 ___lc_time_curr dd offset ___lc_time_c  ; DATA XREF: sync_legacy_variables_lk+29w
.data:00421E54 ___lconv_static_decimal dd 2Eh	       ; DATA XREF: .data:___lconv_co
.data:00421E58 ___lconv_c      dd offset ___lconv_static_decimal
.data:00421E58					       ; DATA XREF: ___freetlocinfo+14o
.data:00421E58					       ; ___free_lconv_num+Br ...
.data:00421E5C off_421E5C      dd offset ___lconv_static_null
.data:00421E5C					       ; DATA XREF: ___free_lconv_num+1Dr
.data:00421E5C					       ; ___init_numeric+144r
.data:00421E60 off_421E60      dd offset ___lconv_static_null
.data:00421E60					       ; DATA XREF: ___free_lconv_num+2Fr
.data:00421E60					       ; ___init_numeric+14Dr
.data:00421E64 off_421E64      dd offset ___lconv_static_null
.data:00421E64					       ; DATA XREF: ___free_lconv_mon+Cr
.data:00421E68 off_421E68      dd offset ___lconv_static_null
.data:00421E68					       ; DATA XREF: ___free_lconv_mon+1Er
.data:00421E6C off_421E6C      dd offset ___lconv_static_null
.data:00421E6C					       ; DATA XREF: ___free_lconv_mon+30r
.data:00421E70 off_421E70      dd offset ___lconv_static_null
.data:00421E70					       ; DATA XREF: ___free_lconv_mon+42r
.data:00421E74 off_421E74      dd offset ___lconv_static_null
.data:00421E74					       ; DATA XREF: ___free_lconv_mon+54r
.data:00421E78 off_421E78      dd offset ___lconv_static_null
.data:00421E78					       ; DATA XREF: ___free_lconv_mon+66r
.data:00421E7C off_421E7C      dd offset ___lconv_static_null
.data:00421E7C					       ; DATA XREF: ___free_lconv_mon+78r
.data:00421E80		       dd 2 dup(7F7F7F7Fh)
.data:00421E88 ___lconv	       dd offset ___lconv_c    ; DATA XREF: sync_legacy_variables_lk+35w
.data:00421E88					       ; _localeconv:loc_40F2CBr
.data:00421E8C ; int __mb_cur_max
.data:00421E8C ___mb_cur_max   dd 1		       ; DATA XREF: sync_legacy_variables_lk+4Dw
.data:00421E90 ___decimal_point	dd 2Eh
.data:00421E94 ___decimal_point_length dd 1, 2 dup(0)
.data:00421EA0 __NLG_Destination dd 19930520h, 3 dup(0)	; DATA XREF: __NLG_Notify1+2o
.data:00421EA0					       ; __NLG_Notify+2o
.data:00421EB0 ; int use_w
.data:00421EB0 use_w	       dd 2		       ; DATA XREF: __putwch_nolock+13r
.data:00421EB0					       ; __putwch_nolock+4Fr ...
.data:00421EB4		       align 8
.data:00421EB8 ; __int32 _timezone
.data:00421EB8 __timezone      dd 7080h		       ; DATA XREF: __get_timezone:loc_413EE2r
.data:00421EB8					       ; ___timezoneo
.data:00421EBC ; int _daylight
.data:00421EBC __daylight      dd 1		       ; DATA XREF: __get_daylight:loc_413E7Ar
.data:00421EBC					       ; ___daylighto
.data:00421EC0 ; __int32 _dstbias
.data:00421EC0 __dstbias       dd 0FFFFF1F0h	       ; DATA XREF: __get_dstbias:loc_413EAEr
.data:00421EC0					       ; ___dstbiaso
.data:00421EC4		       align 8
.data:00421EC8 ; char tzstd[64]
.data:00421EC8 tzstd	       db 50h, 53h, 54h, 3Dh dup(0) ; DATA XREF: .data:__tznameo
.data:00421F08 ; char tzdst[64]
.data:00421F08 tzdst	       db 50h, 44h, 54h, 3Dh dup(0) ; DATA XREF: .data:00421F4Co
.data:00421F48 ; char *_tzname[2]
.data:00421F48 __tzname	       dd offset tzstd	       ; DATA XREF: ___tznameo
.data:00421F4C		       dd offset tzdst
.data:00421F50 ; transitiondate	dststart
.data:00421F50 dststart	       transitiondate <0FFFFFFFFh, 0, 0>
.data:00421F50					       ; DATA XREF: _tzset_nolock+9Bw
.data:00421F50					       ; cvtdate+17Dw ...
.data:00421F5C ; transitiondate	dstend
.data:00421F5C dstend	       transitiondate <0FFFFFFFFh, 0, 0>
.data:00421F5C					       ; DATA XREF: _tzset_nolock+95w
.data:00421F5C					       ; cvtdate:loc_4144FFw ...
.data:00421F68		       align 10h
.data:00421F70 ; HANDLE	_coninpfh
.data:00421F70 __coninpfh      dd 0FFFFFFFEh	       ; DATA XREF: ___initconin+19w
.data:00421F70					       ; ___termcon:loc_4150D2r
.data:00421F74 ; HANDLE	_confh
.data:00421F74 __confh	       dd 0FFFFFFFEh	       ; DATA XREF: __putwch_nolock+1Br
.data:00421F74					       ; __putwch_nolock:loc_4134D5r ...
.data:00421F78 __lpdays	       dd 0FFFFFFFFh	       ; DATA XREF: cvtdate+108r
.data:00421F7C		       dd 1Eh, 3Bh, 5Ah, 78h, 97h, 0B5h, 0D4h, 0F3h, 111h, 130h
.data:00421F7C		       dd 14Eh
.data:00421FA8 dword_421FA8    dd 16Dh		       ; DATA XREF: cvtdate+52r
.data:00421FA8					       ; cvtdate+143r
.data:00421FAC __days	       dd 0FFFFFFFFh	       ; DATA XREF: cvtdate+FDr
.data:00421FB0		       dd 1Eh, 3Ah, 59h, 77h, 96h, 0B4h, 0D3h, 0F2h, 110h, 12Fh
.data:00421FB0		       dd 14Dh,	16Ch, 108h dup(0)
.data:00422400 ; unsigned int _enable_percent_n
.data:00422400 __enable_percent_n dd 0		       ; DATA XREF: __set_printf_count_output+Fr
.data:00422400					       ; __set_printf_count_output+1Ew	...
.data:00422404 __umaskval      dd 0
.data:00422408 __osplatform    dd 0		       ; DATA XREF: __get_osplatform:loc_4015B5r
.data:00422408					       ; __get_osver:loc_4015ECr ...
.data:0042240C ; unsigned int _osver
.data:0042240C __osver	       dd 0		       ; DATA XREF: __get_osver+30r
.data:0042240C					       ; __set_osver+4w ...
.data:00422410 ; unsigned int _winver
.data:00422410 __winver	       dd 0		       ; DATA XREF: __get_winver+30r
.data:00422410					       ; __set_winver+4w ...
.data:00422414 ; unsigned int _winmajor
.data:00422414 __winmajor      dd 0		       ; DATA XREF: __get_winmajor+30r
.data:00422414					       ; __set_winmajor+4w ...
.data:00422418 ; unsigned int _winminor
.data:00422418 __winminor      dd 0		       ; DATA XREF: __get_winminor+30r
.data:00422418					       ; __set_winminor+4w ...
.data:0042241C ; int __argc
.data:0042241C ___argc	       dd 0		       ; DATA XREF: __tmainCRTStartup+154r
.data:0042241C					       ; __setargv+A2w
.data:00422420 ; char **__argv
.data:00422420 ___argv	       dd 0		       ; DATA XREF: __tmainCRTStartup+14Er
.data:00422420					       ; __setargv+A7w
.data:00422424 ; wchar_t **__wargv
.data:00422424 ___wargv	       dd 0
.data:00422428 ; char **_environ
.data:00422428 __environ       dd 0		       ; DATA XREF: __tmainCRTStartup:loc_40207Fr
.data:00422428					       ; __setenvp+4Bw	...
.data:0042242C ___initenv      dd 0		       ; DATA XREF: __tmainCRTStartup+148w
.data:0042242C					       ; ___crtsetenv+5Dr
.data:00422430 ; wchar_t **_wenviron
.data:00422430 __wenviron      dd 0		       ; DATA XREF: __getenv_helper_nolock+1Ar
.data:00422430					       ; ___wtomb_environ+Ar ...
.data:00422434 ___winitenv     dd 0
.data:00422438 ; char *_pgmptr
.data:00422438 __pgmptr	       dd 0		       ; DATA XREF: __get_pgmptr:loc_401713r
.data:00422438					       ; __set_pgmptr+4w ...
.data:0042243C ; wchar_t *_wpgmptr
.data:0042243C __wpgmptr       dd 0		       ; DATA XREF: __get_wpgmptr:loc_4016DCr
.data:00422440 __exitflag      db 0		       ; DATA XREF: doexit+2Dw
.data:00422440					       ; ___endstdio+5r
.data:00422441		       align 4
.data:00422444 __C_Termination_Done dd 0	       ; DATA XREF: doexit+24w
.data:00422448 __C_Exit_Done   dd 0		       ; DATA XREF: doexit+1Cr
.data:00422448					       ; doexit+B4w
.data:0042244C __cflush	       dd 0		       ; DATA XREF: __stbuf:loc_402132w
.data:0042244C					       ; __getbufw
.data:00422450 ; char *_aenvptr
.data:00422450 __aenvptr       dd 0		       ; DATA XREF: __tmainCRTStartup+109w
.data:00422450					       ; __setenvp:loc_4064DAr	...
.data:00422454 __wenvptr       dd 0
.data:00422458 ___error_mode   dd 0		       ; DATA XREF: fast_error_exitr
.data:00422458					       ; __set_error_mode+15r ...
.data:0042245C __stdbuf	       dd 2 dup(0)
.data:00422464 ; void *__pInvalidArgHandler
.data:00422464 ___pInvalidArgHandler dd	0	       ; DATA XREF: __initp_misc_invarg+4w
.data:00422464					       ; __set_invalid_parameter_handler+1r ...
.data:00422468 ; void *gpFlsAlloc
.data:00422468 _gpFlsAlloc     dd 0		       ; DATA XREF: __mtinit+30w
.data:00422468					       ; __mtinit+51r ...
.data:0042246C ; LPVOID	gpFlsGetValue
.data:0042246C _gpFlsGetValue  dd 0		       ; DATA XREF: ___set_flsgetvalue+13r
.data:0042246C					       ; __mtinit+3Dw ...
.data:00422470 ; void *gpFlsSetValue
.data:00422470 _gpFlsSetValue  dd 0		       ; DATA XREF: __fls_setvalue(x,x)+8r
.data:00422470					       ; __getptd_noexit+38r ...
.data:00422474 ; void *gpFlsFree
.data:00422474 _gpFlsFree      dd 0		       ; DATA XREF: __mtterm+Br
.data:00422474					       ; __mtinit+5Ew ...
.data:00422478 ; char outmsg[788]
.data:00422478 outmsg	       db 314h dup(0)	       ; DATA XREF: __NMSG_WRITE+66o
.data:0042278C dword_42278C    dd 0		       ; DATA XREF: __NMSG_WRITE+E3o
.data:00422790 ; _RTL_CRITICAL_SECTION lclcritsects[14]
.data:00422790 lclcritsects    _RTL_CRITICAL_SECTION 0Eh dup(<0>)
.data:00422790					       ; DATA XREF: __mtinitlocks+4o
.data:004228E0 ; void *__pInconsistency
.data:004228E0 ?__pInconsistency@@3P6AXXZA dd 0	       ; DATA XREF: _inconsistency(void)+Cr
.data:004228E0					       ; __initp_eh_hooks+Bw
.data:004228E4 ; void (__cdecl *ctrlc_action)(int)
.data:004228E4 ctrlc_action    dd 0		       ; DATA XREF: __initp_misc_winsig+4w
.data:004228E4					       ; ctrlevent_capture+1Do	...
.data:004228E8 ; void (__cdecl *ctrlbreak_action)(int)
.data:004228E8 ctrlbreak_action	dd 0		       ; DATA XREF: __initp_misc_winsig+9w
.data:004228E8					       ; ctrlevent_capture:loc_40423Do	...
.data:004228EC ; void (__cdecl *abort_action)(int)
.data:004228EC abort_action    dd 0		       ; DATA XREF: __initp_misc_winsig+Ew
.data:004228EC					       ; ___get_sigabrtr ...
.data:004228F0 ; void (__cdecl *term_action)(int)
.data:004228F0 term_action     dd 0		       ; DATA XREF: __initp_misc_winsig+13w
.data:004228F0					       ; _signal:loc_40448Fr ...
.data:004228F4 ; int ConsoleCtrlHandler_Installed
.data:004228F4 ConsoleCtrlHandler_Installed dd 0       ; DATA XREF: _signal:loc_4043F9r
.data:004228F4					       ; _signal+124w
.data:004228F8 ; volatile LONG g_pfnRtlGenRandom
.data:004228F8 g_pfnRtlGenRandom dd 0		       ; DATA XREF: __initp_misc_rand_s+4w
.data:004228F8					       ; _rand_s+3r ...
.data:004228FC ; wchar_t wcbuffer
.data:004228FC wcbuffer	       dw 4 dup(0)	       ; DATA XREF: ___getlocaleinfo+117o
.data:00422904 ___pPurecall    dd 0		       ; DATA XREF: ___getlocaleinfo+14Eo
.data:00422904					       ; __initp_misc_purevirt+4w
.data:00422908 ; int (__stdcall	*_pfnInitCritSecAndSpinCount)(_RTL_CRITICAL_SECTION *, unsigned	int)
.data:00422908 __pfnInitCritSecAndSpinCount dd 0       ; DATA XREF: __initp_misc_initcrit+4w
.data:00422908					       ; ___crtInitCritSecAndSpinCount+11r ...
.data:0042290C ; void *_pnhHeap
.data:0042290C ?_pnhHeap@@3P6AHI@ZA dd 0	       ; DATA XREF: __initp_heap_handler+4w
.data:0042290C					       ; _set_new_handler(int (*)(uint))+8r ...
.data:00422910 __maxwait       dd 0		       ; DATA XREF: _wait_a_bit+12r
.data:00422910					       ; __set_malloc_crt_max_wait+4r ...
.data:00422914 ; char *__sbh_pHeaderDefer
.data:00422914 ___sbh_pHeaderDefer dd 0		       ; DATA XREF: ___sbh_heap_init+21w
.data:00422914					       ; ___sbh_free_block+21Cr ...
.data:00422918 ; HANDLE	_crtheap
.data:00422918 __crtheap       dd 0		       ; DATA XREF: __heap_allocr
.data:00422918					       ; __heap_alloc+37r ...
.data:0042291C __newmode       dd 0		       ; DATA XREF: _malloc+80r
.data:0042291C					       ; __calloc_impl+CAr ...
.data:00422920 ; char pgmname[261]
.data:00422920 _pgmname	       db 105h dup(0)	       ; DATA XREF: __setargv+1Do
.data:00422A25		       align 4
.data:00422A28 ; int f_use
.data:00422A28 f_use	       dd 0		       ; DATA XREF: ___crtGetEnvironmentStringsA+2r
.data:00422A28					       ; ___crtGetEnvironmentStringsA+24w ...
.data:00422A2C ; int fSystemSet
.data:00422A2C fSystemSet      dd 0		       ; DATA XREF: getSystemCP+15w
.data:00422A2C					       ; getSystemCP+1Dw ...
.data:00422A30 ___mbulinfo     dw 0		       ; DATA XREF: __setmbcp+E7w
.data:00422A32		       align 4
.data:00422A34		       dd 2 dup(0)
.data:00422A3C ___mbcodepage   dd 0		       ; DATA XREF: __setmbcp+C3w
.data:00422A40 ___ismbcodepage dd 0		       ; DATA XREF: __setmbcp+CBw
.data:00422A44 ___mblcid       dd 0		       ; DATA XREF: __setmbcp+D3w
.data:00422A48 ___locale_changed dd 0		       ; DATA XREF: _setlocale+B9w
.data:00422A48					       ; _isalphar ...
.data:00422A4C ; char __lc_handle[24]
.data:00422A4C ___lc_handle    db 18h dup(0)	       ; DATA XREF: _setlocale+109o
.data:00422A64 ___lc_codepage  dd 0		       ; DATA XREF: sync_legacy_variables_lk+8w
.data:00422A68 ___lc_collate_cp	dd 0		       ; DATA XREF: sync_legacy_variables_lk+11w
.data:00422A6C ; int (__stdcall	*pfnMessageBox)(HWND__ *, const	char *,	const char *, unsigned int)
.data:00422A6C pfnMessageBox   dd 0		       ; DATA XREF: ___crtMessageBoxA+10r
.data:00422A6C					       ; ___crtMessageBoxA+61w	...
.data:00422A70 ; HWND__	*(__stdcall *pfnGetActiveWindow)()
.data:00422A70 pfnGetActiveWindow dd 0		       ; DATA XREF: ___crtMessageBoxA+76w
.data:00422A70					       ; ___crtMessageBoxA:loc_40A8F3r
.data:00422A74 ; HWND__	*(__stdcall *pfnGetLastActivePopup)(HWND__ *)
.data:00422A74 pfnGetLastActivePopup dd	0	       ; DATA XREF: ___crtMessageBoxA+83w
.data:00422A74					       ; ___crtMessageBoxA+179r
.data:00422A78 ; HWINSTA__ *(__stdcall *pfnGetProcessWindowStation)()
.data:00422A78 pfnGetProcessWindowStation dd 0	       ; DATA XREF: ___crtMessageBoxA+D1w
.data:00422A78					       ; ___crtMessageBoxA:loc_40A86Er
.data:00422A7C ; int (__stdcall	*pfnGetUserObjectInformation)(void *, int, void	*, unsigned int, unsigned int *)
.data:00422A7C pfnGetUserObjectInformation dd 0	       ; DATA XREF: ___crtMessageBoxA+BBw
.data:00422A7C					       ; ___crtMessageBoxA+E2r	...
.data:00422A80 ; int f_use_0
.data:00422A80 f_use_0	       dd 0		       ; DATA XREF: __crtGetLocaleInfoW_stat+Fr
.data:00422A80					       ; __crtGetLocaleInfoW_stat+30w ...
.data:00422A84 ; int f_use_1
.data:00422A84 f_use_1	       dd 0		       ; DATA XREF: __crtGetLocaleInfoA_stat+Fr
.data:00422A84					       ; __crtGetLocaleInfoA_stat+30w ...
.data:00422A88 ; int f_use_2
.data:00422A88 f_use_2	       dd 0		       ; DATA XREF: __crtLCMapStringA_stat+14r
.data:00422A88					       ; __crtLCMapStringA_stat+3Aw ...
.data:00422A8C ; int f_use_3
.data:00422A8C f_use_3	       dd 0		       ; DATA XREF: __crtGetStringTypeA_stat+Fr
.data:00422A8C					       ; __crtGetStringTypeA_stat+37w ...
.data:00422A90 ___lconv_static_null dd 2 dup(0)	       ; DATA XREF: .data:off_421E5Co
.data:00422A90					       ; .data:off_421E60o ...
.data:00422A98 ; _EXCEPTION_RECORD GS_ExceptionRecord
.data:00422A98 GS_ExceptionRecord _EXCEPTION_RECORD <0>	; DATA XREF: ___report_gsfailure+8Fw
.data:00422A98					       ; .rdata:GS_ExceptionPointerso ...
.data:00422AE8 ; int DebuggerWasPresent
.data:00422AE8 DebuggerWasPresent dd 0		       ; DATA XREF: ___report_gsfailure+BFw
.data:00422AE8					       ; ___report_gsfailure+DFr
.data:00422AEC		       align 10h
.data:00422AF0 ; _CONTEXT GS_ContextRecord
.data:00422AF0 GS_ContextRecord	_CONTEXT <0>	       ; DATA XREF: ___report_gsfailure+7Bw
.data:00422AF0					       ; .rdata:GS_ExceptionPointerso
.data:00422DBC		       align 10h
.data:00422DC0 ; _TIME_ZONE_INFORMATION	tzinfo
.data:00422DC0 tzinfo	       _TIME_ZONE_INFORMATION <0>
.data:00422DC0					       ; DATA XREF: _tzset_nolock:loc_414113o
.data:00422DC0					       ; _tzset_nolock+163r ...
.data:00422E6C ; int tzapiused
.data:00422E6C tzapiused       dd 0		       ; DATA XREF: _tzset_nolock+8Cw
.data:00422E6C					       ; _tzset_nolock+15Dw ...
.data:00422E70 ; char *lastTZ
.data:00422E70 lastTZ	       dd 0		       ; DATA XREF: _tzset_nolock+B9r
.data:00422E70					       ; _tzset_nolock+D3r ...
.data:00422E74 ; int first_time
.data:00422E74 first_time      dd 0		       ; DATA XREF: ___tzset+Er
.data:00422E74					       ; ___tzset+21r ...
.data:00422E78 ; int f_use_4
.data:00422E78 f_use_4	       dd 0		       ; DATA XREF: __crtGetStringTypeW_stat:loc_414D48r
.data:00422E78					       ; __crtGetStringTypeW_stat+45w ...
.data:00422E7C ; int f_use_5
.data:00422E7C f_use_5	       dd 0		       ; DATA XREF: __crtCompareStringA_stat+18r
.data:00422E7C					       ; __crtCompareStringA_stat+41w ...
.data:00422E80 ___use_sse2_mathfcns dd 0	       ; DATA XREF: __sse2_mathfcns_initw
.data:00422E80					       ; __sse2_mathfcns_init+Cw ...
.data:00422E84		       align 10h
.data:00422E90 ___sse2_available dd 0		       ; DATA XREF: _memset+1Er
.data:00422E90					       ; _memcpy+28r ...
.data:00422E94 __debugger_hook_dummy dd	0	       ; DATA XREF: __crt_debugger_hookw
.data:00422E98		       align 10h
.data:00422EA0 ___setlc_active dd 0		       ; DATA XREF: ____setlc_active_funcr
.data:00422EA4		       align 10h
.data:00422EB0 ___unguarded_readlc_active dd 0	       ; DATA XREF: ____unguarded_readlc_active_add_funco
.data:00422EB4 ___active_heap  dd 0		       ; DATA XREF: __heap_alloc:loc_401D00r
.data:00422EB4					       ; _malloc:loc_401D8Fr ...
.data:00422EB8		       align 10h
.data:00422EC0 ___sbh_initialized dd 5 dup(0)
.data:00422ED4 ___sbh_cntHeaderList dd 0	       ; DATA XREF: ___sbh_heap_init+28w
.data:00422ED4					       ; ___sbh_find_blockr ...
.data:00422ED8 ; LPVOID	__sbh_pHeaderList
.data:00422ED8 ___sbh_pHeaderList dd 0		       ; DATA XREF: ___sbh_heap_init+15w
.data:00422ED8					       ; ___sbh_find_block+6r ...
.data:00422EDC ___sbh_threshold	dd 0		       ; DATA XREF: _V6_HeapAlloc+13r
.data:00422EDC					       ; __get_sbh_threshold+1Ar ...
.data:00422EE0 ___sbh_pHeaderScan dd 0		       ; DATA XREF: ___sbh_heap_init+2Fw
.data:00422EE0					       ; ___sbh_free_block+2FCw ...
.data:00422EE4 ___sbh_sizeHeaderList dd	0	       ; DATA XREF: ___sbh_heap_init+3Cw
.data:00422EE4					       ; ___sbh_alloc_new_regionr ...
.data:00422EE8 ___sbh_indGroupDefer dd 0	       ; DATA XREF: ___sbh_free_block+229r
.data:00422EE8					       ; ___sbh_free_block+249r ...
.data:00422EEC ; UINT _nhandle
.data:00422EEC __nhandle       dd 0		       ; DATA XREF: __ioinit+3Cw
.data:00422EEC					       ; __ioinit+CDw ...
.data:00422EF0		       dd 14h dup(0)
.data:00422F40 ___pioinfo      dd 0		       ; DATA XREF: ___initstdio+7Fr
.data:00422F40					       ; __ioinit+37w ...
.data:00422F44		       dd 2Fh dup(0)
.data:00423000		       dd 10h dup(?)
.data:00423040 ; char _pDestructExceptionObject[]
.data:00423040 __pDestructExceptionObject dd ?	       ; DATA XREF: __except_handler4+F1r
.data:00423040					       ; __except_handler4+FAo	...
.data:00423044		       dd 2 dup(?)
.data:0042304C __acmdln	       dd ?		       ; DATA XREF: __tmainCRTStartup+FFw
.data:0042304C					       ; __setargv+30r
.data:00423050		       dd 2 dup(?)
.data:00423058 ; void *__piob
.data:00423058 ___piob	       dd ?		       ; DATA XREF: ___initstdio+2Bw
.data:00423058					       ; ___initstdio+44w ...
.data:0042305C		       dd 0D1h dup(?)
.data:004233A0 __bufin	       dd 400h dup(?)	       ; DATA XREF: .data:__iobo
.data:004233A0					       ; .data:00421090o
.data:004243A0 ; unsigned int _nstream
.data:004243A0 __nstream       dd ?		       ; DATA XREF: ___initstdior
.data:004243A0					       ; ___initstdio:loc_401B0Fw ...
.data:004243A4 ___env_initialized dd ?		       ; DATA XREF: __setenvp+B3w
.data:004243A4					       ; __getenv_helper_nolockr
.data:004243A8		       dd 3 dup(?)
.data:004243B4 ; void *__onexitend
.data:004243B4 ___onexitend    dd ?		       ; DATA XREF: doexit+45r
.data:004243B4					       ; _onexit_nolock+10r ...
.data:004243B8 ; void *__onexitbegin
.data:004243B8 ___onexitbegin  dd ?		       ; DATA XREF: doexit+37r
.data:004243B8					       ; _onexit_nolock+5r ...
.data:004243BC ___mbctype_initialized dd ?	       ; DATA XREF: __setenvp+3r
.data:004243BC					       ; __setargv+9r ...
.data:004243C0 ; char _FPinit[]
.data:004243C0 __FPinit	       dd ?		       ; DATA XREF: __cinitr
.data:004243C0					       ; __cinit+9o ...
.data:004243C4 ; char __dyn_tls_init_callback[]
.data:004243C4 ___dyn_tls_init_callback	dd ?	       ; DATA XREF: __cinit:loc_40178Br
.data:004243C4					       ; __cinit+74o ...
.data:004243C8		       align 1000h
.data:004243C8 _data	       ends
.data:004243C8
.idata:004251EC	;
.idata:004251EC	; Imports from KERNEL32.dll
.idata:004251EC	;
.idata:004251EC	; Section 4. (virtual address 00025000)
.idata:004251EC	; Virtual size			: 00000B73 (   2931.)
.idata:004251EC	; Section size in file		: 00001000 (   4096.)
.idata:004251EC	; Offset to raw	data for section: 00023000
.idata:004251EC	; Flags	C0000040: Data Readable	Writable
.idata:004251EC	; Alignment	: default
.idata:004251EC	; ===========================================================================
.idata:004251EC
.idata:004251EC	; Segment type:	Externs
.idata:004251EC	; _idata
.idata:004251EC	; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
.idata:004251EC			extrn __imp__GetProcAddress@8:dword
.idata:004251EC						; CODE XREF: ___crtCorExitProcess+15p
.idata:004251EC						; __encode_pointer+54p	...
.idata:004251F0	; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
.idata:004251F0			extrn __imp__GetModuleHandleA@4:dword
.idata:004251F0						; CODE XREF: ___crtCorExitProcess+5p
.idata:004251F0						; _use_encode_pointer+28p ...
.idata:004251F4	; void __stdcall ExitProcess(UINT uExitCode)
.idata:004251F4			extrn __imp__ExitProcess@4:dword
.idata:004251F4						; CODE XREF: ___crtExitProcess+Ep
.idata:004251F4						; DATA XREF: ___crtExitProcess+Er ...
.idata:004251F8	; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:004251F8			extrn __imp__EnterCriticalSection@4:dword
.idata:004251F8						; CODE XREF: __lock_file+34p
.idata:004251F8						; __lock_file2+27p ...
.idata:004251FC	; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:004251FC			extrn __imp__LeaveCriticalSection@4:dword
.idata:004251FC						; CODE XREF: __unlock_file+2Fp
.idata:004251FC						; __unlock_file2+23p ...
.idata:00425200	; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
.idata:00425200			extrn __imp__HeapAlloc@12:dword
.idata:00425200						; CODE XREF: __heap_alloc+3Dp
.idata:00425200						; __heap_alloc+6Dp ...
.idata:00425204	; DWORD	__stdcall GetLastError()
.idata:00425204			extrn __imp__GetLastError@0:dword ; CODE XREF: _free+79p
.idata:00425204						; __getptd_noexit+2p ...
.idata:00425208	; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
.idata:00425208			extrn __imp__HeapFree@12:dword ; CODE XREF: _free+68p
.idata:00425208						; __tmainCRTStartup+4Ep ...
.idata:0042520C	; LPSTR	__stdcall GetCommandLineA()
.idata:0042520C			extrn __imp__GetCommandLineA@0:dword
.idata:0042520C						; CODE XREF: __tmainCRTStartup:loc_402035p
.idata:0042520C						; DATA XREF: __tmainCRTStartup:loc_402035r ...
.idata:00425210	; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
.idata:00425210			extrn __imp__GetVersionExA@4:dword
.idata:00425210						; CODE XREF: __tmainCRTStartup+3Ep
.idata:00425210						; DATA XREF: __tmainCRTStartup+3Er ...
.idata:00425214	; HANDLE __stdcall GetProcessHeap()
.idata:00425214			extrn __imp__GetProcessHeap@0:dword
.idata:00425214						; CODE XREF: __tmainCRTStartup+1Ap
.idata:00425214						; __tmainCRTStartup+4Bp ...
.idata:00425218	; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
.idata:00425218			extrn __imp__TerminateProcess@8:dword
.idata:00425218						; CODE XREF: __invoke_watson+E0p
.idata:00425218						; ___report_gsfailure+FCp
.idata:00425218						; DATA XREF: ...
.idata:0042521C	; HANDLE __stdcall GetCurrentProcess()
.idata:0042521C			extrn __imp__GetCurrentProcess@0:dword
.idata:0042521C						; CODE XREF: __invoke_watson+D9p
.idata:0042521C						; ___report_gsfailure+F5p
.idata:0042521C						; DATA XREF: ...
.idata:00425220	; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
.idata:00425220			extrn __imp__UnhandledExceptionFilter@4:dword
.idata:00425220						; CODE XREF: __invoke_watson+BEp
.idata:00425220						; _abort+E5p ...
.idata:00425224	; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
.idata:00425224			extrn __imp__SetUnhandledExceptionFilter@4:dword
.idata:00425224						; CODE XREF: __invoke_watson+B4p
.idata:00425224						; ___CxxSetUnhandledExceptionFilter+5p	...
.idata:00425228	; BOOL __stdcall IsDebuggerPresent()
.idata:00425228			extrn __imp__IsDebuggerPresent@0:dword
.idata:00425228						; CODE XREF: __invoke_watson+AAp
.idata:00425228						; ___report_gsfailure+B9p
.idata:00425228						; DATA XREF: ...
.idata:0042522C	; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
.idata:0042522C			extrn __imp__TlsGetValue@4:dword
.idata:0042522C						; CODE XREF: __encode_pointer+Dp
.idata:0042522C						; __encode_pointer+24p	...
.idata:00425230	; DWORD	__stdcall TlsAlloc()
.idata:00425230			extrn __imp__TlsAlloc@0:dword ;	CODE XREF: __crtTlsAlloc(x)p
.idata:00425230						; __mtinit:loc_40380Cp
.idata:00425230						; DATA XREF: ...
.idata:00425234	; BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue)
.idata:00425234			extrn __imp__TlsSetValue@8:dword
.idata:00425234						; CODE XREF: ___set_flsgetvalue+28p
.idata:00425234						; __freeptd+62p ...
.idata:00425238	; BOOL __stdcall TlsFree(DWORD dwTlsIndex)
.idata:00425238			extrn __imp__TlsFree@4:dword ; CODE XREF: __mtterm+2Bp
.idata:00425238						; DATA XREF: __mtterm+2Br ...
.idata:0042523C	; LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend)
.idata:0042523C			extrn __imp__InterlockedIncrement@4:dword
.idata:0042523C						; CODE XREF: __initptd+77p
.idata:0042523C						; ___updatetmbcinfo+84p ...
.idata:00425240	; void __stdcall SetLastError(DWORD dwErrCode)
.idata:00425240			extrn __imp__SetLastError@4:dword
.idata:00425240						; CODE XREF: __getptd_noexit+6Cp
.idata:00425240						; ___crtInitCritSecAndSpinCount+ABp
.idata:00425240						; DATA XREF: ...
.idata:00425244	; DWORD	__stdcall GetCurrentThreadId()
.idata:00425244			extrn __imp__GetCurrentThreadId@0:dword
.idata:00425244						; CODE XREF: __getptd_noexit+54p
.idata:00425244						; __mtinit+169p ...
.idata:00425248	; LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend)
.idata:00425248			extrn __imp__InterlockedDecrement@4:dword
.idata:00425248						; CODE XREF: _freefls(x)+90p
.idata:00425248						; ___updatetmbcinfo+59p ...
.idata:0042524C	; HANDLE __stdcall GetCurrentThread()
.idata:0042524C			extrn __imp__GetCurrentThread@0:dword
.idata:0042524C						; DATA XREF: ___threadhandler
.idata:0042524C						; GetCurrentThread()r
.idata:00425250	; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
.idata:00425250			extrn __imp__WriteFile@20:dword
.idata:00425250						; CODE XREF: __NMSG_WRITE+194p
.idata:00425250						; __write_nolock+241p ...
.idata:00425254	; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
.idata:00425254			extrn __imp__GetStdHandle@4:dword
.idata:00425254						; CODE XREF: __NMSG_WRITE+169p
.idata:00425254						; __ioinit+1C9p
.idata:00425254						; DATA XREF: ...
.idata:00425258	; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
.idata:00425258			extrn __imp__GetModuleFileNameA@12:dword
.idata:00425258						; CODE XREF: __NMSG_WRITE+99p
.idata:00425258						; __setargv+2Ap
.idata:00425258						; DATA XREF: ...
.idata:0042525C	; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:0042525C			extrn __imp__DeleteCriticalSection@4:dword
.idata:0042525C						; CODE XREF: __mtdeletelocks+1Bp
.idata:0042525C						; __mtdeletelocks+45p ...
.idata:00425260	; void __stdcall FatalAppExitA(UINT uAction, LPCSTR lpMessageText)
.idata:00425260			extrn __imp__FatalAppExitA@8:dword
.idata:00425260						; CODE XREF: __lockerr_exit+6p
.idata:00425260						; DATA XREF: __lockerr_exit+6r	...
.idata:00425264	; BOOL __stdcall SetConsoleCtrlHandler(PHANDLER_ROUTINE	HandlerRoutine,	BOOL Add)
.idata:00425264			extrn __imp__SetConsoleCtrlHandler@8:dword
.idata:00425264						; CODE XREF: _signal+117p
.idata:00425264						; DATA XREF: _signal+117r ...
.idata:00425268	; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
.idata:00425268			extrn __imp__FreeLibrary@4:dword ; CODE	XREF: _rand_s+DAp
.idata:00425268						; DATA XREF: _rand_s+DAr ...
.idata:0042526C	; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
.idata:0042526C			extrn __imp__InterlockedExchange@8:dword
.idata:0042526C						; CODE XREF: _rand_s+CDp
.idata:0042526C						; DATA XREF: _rand_s+CDr ...
.idata:00425270	; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
.idata:00425270			extrn __imp__LoadLibraryA@4:dword ; CODE XREF: _rand_s+4Ap
.idata:00425270						; ___crtMessageBoxA+2Dp
.idata:00425270						; DATA XREF: ...
.idata:00425274	; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:00425274			extrn __imp__InitializeCriticalSection@4:dword
.idata:00425274						; CODE XREF: __crtInitCritSecNoSpinCount+4p
.idata:00425274						; DATA XREF: __crtInitCritSecNoSpinCount+4r ...
.idata:00425278	; UINT __stdcall SetHandleCount(UINT uNumber)
.idata:00425278			extrn __imp__SetHandleCount@4:dword
.idata:00425278						; CODE XREF: __ioinit+233p
.idata:00425278						; DATA XREF: __ioinit+233r ...
.idata:0042527C	; DWORD	__stdcall GetFileType(HANDLE hFile)
.idata:0042527C			extrn __imp__GetFileType@4:dword ; CODE	XREF: __ioinit+13Fp
.idata:0042527C						; __ioinit+1DBp ...
.idata:00425280	; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
.idata:00425280			extrn __imp__GetStartupInfoA@4:dword
.idata:00425280						; CODE XREF: __ioinit+15p
.idata:00425280						; DATA XREF: __ioinit+15r ...
.idata:00425284	; void __stdcall Sleep(DWORD dwMilliseconds)
.idata:00425284			extrn __imp__Sleep@4:dword ; CODE XREF:	_wait_a_bit+6p
.idata:00425284						; __malloc_crt+1Dp ...
.idata:00425288	; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
.idata:00425288			extrn __imp__VirtualFree@12:dword
.idata:00425288						; CODE XREF: ___sbh_free_block+247p
.idata:00425288						; ___sbh_free_block+2A2p ...
.idata:0042528C	; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
.idata:0042528C			extrn __imp__VirtualAlloc@16:dword
.idata:0042528C						; CODE XREF: ___sbh_alloc_new_region+77p
.idata:0042528C						; ___sbh_alloc_new_group+52p
.idata:0042528C						; DATA XREF: ...
.idata:00425290	; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
.idata:00425290			extrn __imp__HeapReAlloc@16:dword
.idata:00425290						; CODE XREF: ___sbh_alloc_new_region+27p
.idata:00425290						; _realloc+134p ...
.idata:00425294	; BOOL __stdcall HeapDestroy(HANDLE hHeap)
.idata:00425294			extrn __imp__HeapDestroy@4:dword
.idata:00425294						; CODE XREF: __heap_init+47p
.idata:00425294						; __heap_term+66p
.idata:00425294						; DATA XREF: ...
.idata:00425298	; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
.idata:00425298			extrn __imp__HeapCreate@12:dword
.idata:00425298						; CODE XREF: __heap_init+11p
.idata:00425298						; DATA XREF: __heap_init+11r ...
.idata:0042529C	; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
.idata:0042529C			extrn __imp__FreeEnvironmentStringsA@4:dword
.idata:0042529C						; CODE XREF: ___crtGetEnvironmentStringsA+10Fp
.idata:0042529C						; ___crtGetEnvironmentStringsA+126p
.idata:0042529C						; DATA XREF: ...
.idata:004252A0	; LPCH __stdcall GetEnvironmentStrings()
.idata:004252A0			extrn __imp__GetEnvironmentStrings@0:dword
.idata:004252A0						; CODE XREF: ___crtGetEnvironmentStringsA:loc_4068DCp
.idata:004252A0						; DATA XREF: ___crtGetEnvironmentStringsA:loc_4068DCr ...
.idata:004252A4	; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
.idata:004252A4			extrn __imp__FreeEnvironmentStringsW@4:dword
.idata:004252A4						; CODE XREF: ___crtGetEnvironmentStringsA+CCp
.idata:004252A4						; DATA XREF: ___crtGetEnvironmentStringsA+CCr ...
.idata:004252A8	; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
.idata:004252A8			extrn __imp__WideCharToMultiByte@32:dword
.idata:004252A8						; CODE XREF: ___crtGetEnvironmentStringsA+91p
.idata:004252A8						; ___crtGetEnvironmentStringsA+B3p ...
.idata:004252AC	; LPWCH	__stdcall GetEnvironmentStringsW()
.idata:004252AC			extrn __imp__GetEnvironmentStringsW@0:dword
.idata:004252AC						; CODE XREF: ___crtGetEnvironmentStringsA+1Cp
.idata:004252AC						; ___crtGetEnvironmentStringsA+56p
.idata:004252AC						; DATA XREF: ...
.idata:004252B0	; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
.idata:004252B0			extrn __imp__QueryPerformanceCounter@4:dword
.idata:004252B0						; CODE XREF: ___security_init_cookie+5Dp
.idata:004252B0						; DATA XREF: ___security_init_cookie+5Dr ...
.idata:004252B4	; DWORD	__stdcall GetTickCount()
.idata:004252B4			extrn __imp__GetTickCount@0:dword
.idata:004252B4						; CODE XREF: ___security_init_cookie+51p
.idata:004252B4						; DATA XREF: ___security_init_cookie+51r ...
.idata:004252B8	; DWORD	__stdcall GetCurrentProcessId()
.idata:004252B8			extrn __imp__GetCurrentProcessId@0:dword
.idata:004252B8						; CODE XREF: ___security_init_cookie+41p
.idata:004252B8						; DATA XREF: ___security_init_cookie+41r ...
.idata:004252BC	; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
.idata:004252BC			extrn __imp__GetSystemTimeAsFileTime@4:dword
.idata:004252BC						; CODE XREF: ___security_init_cookie+35p
.idata:004252BC						; DATA XREF: ___security_init_cookie+35r ...
.idata:004252C0	; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
.idata:004252C0			extrn __imp__GetCPInfo@8:dword ; CODE XREF: setSBUpLow+24p
.idata:004252C0						; __setmbcp_nolock+84p	...
.idata:004252C4	; UINT __stdcall GetACP()
.idata:004252C4			extrn __imp__GetACP@0:dword ; CODE XREF: getSystemCP+4Ap
.idata:004252C4						; DATA XREF: getSystemCP+4Ar ...
.idata:004252C8	; UINT __stdcall GetOEMCP()
.idata:004252C8			extrn __imp__GetOEMCP@0:dword ;	CODE XREF: getSystemCP+27p
.idata:004252C8						; DATA XREF: getSystemCP+27r ...
.idata:004252CC	; BOOL __stdcall IsValidCodePage(UINT CodePage)
.idata:004252CC			extrn __imp__IsValidCodePage@4:dword
.idata:004252CC						; CODE XREF: __setmbcp_nolock+71p
.idata:004252CC						; ___get_qualified_locale+128p
.idata:004252CC						; DATA XREF: ...
.idata:004252D0	; __declspec(dllimport)	__stdcall RtlUnwind(x, x, x, x)
.idata:004252D0			extrn __imp__RtlUnwind@16:dword
.idata:004252D0						; DATA XREF: RtlUnwind(x,x,x,x)r
.idata:004252D4	; SIZE_T __stdcall HeapSize(HANDLE hHeap, DWORD	dwFlags, LPCVOID lpMem)
.idata:004252D4			extrn __imp__HeapSize@12:dword ; CODE XREF: __msize+82p
.idata:004252D4						; DATA XREF: __msize+82r ...
.idata:004252D8	; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
.idata:004252D8			extrn __imp__MultiByteToWideChar@24:dword
.idata:004252D8						; CODE XREF: __crtGetLocaleInfoW_stat+116p
.idata:004252D8						; __crtLCMapStringA_stat+CEp ...
.idata:004252DC	; int __stdcall	GetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData)
.idata:004252DC			extrn __imp__GetLocaleInfoA@16:dword
.idata:004252DC						; CODE XREF: __crtGetLocaleInfoW_stat+94p
.idata:004252DC						; __crtGetLocaleInfoW_stat+F7p	...
.idata:004252E0	; int __stdcall	GetLocaleInfoW(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int	cchData)
.idata:004252E0			extrn __imp__GetLocaleInfoW@16:dword
.idata:004252E0						; CODE XREF: __crtGetLocaleInfoW_stat+2Ap
.idata:004252E0						; __crtGetLocaleInfoW_stat+63p	...
.idata:004252E4	; UINT __stdcall GetConsoleCP()
.idata:004252E4			extrn __imp__GetConsoleCP@0:dword
.idata:004252E4						; CODE XREF: __write_nolock:loc_40BF76p
.idata:004252E4						; DATA XREF: __write_nolock:loc_40BF76r ...
.idata:004252E8	; BOOL __stdcall GetConsoleMode(HANDLE hConsoleHandle, LPDWORD lpMode)
.idata:004252E8			extrn __imp__GetConsoleMode@8:dword
.idata:004252E8						; CODE XREF: __write_nolock+126p
.idata:004252E8						; DATA XREF: __write_nolock+126r ...
.idata:004252EC	; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
.idata:004252EC			extrn __imp__FlushFileBuffers@4:dword
.idata:004252EC						; CODE XREF: __commit+8Cp
.idata:004252EC						; DATA XREF: __commit+8Cr ...
.idata:004252F0	; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
.idata:004252F0			extrn __imp__LCMapStringA@24:dword
.idata:004252F0						; CODE XREF: __crtLCMapStringA_stat+2A6p
.idata:004252F0						; __crtLCMapStringA_stat+318p ...
.idata:004252F4	; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
.idata:004252F4			extrn __imp__LCMapStringW@24:dword
.idata:004252F4						; CODE XREF: __crtLCMapStringA_stat+30p
.idata:004252F4						; __crtLCMapStringA_stat+156p ...
.idata:004252F8	; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
.idata:004252F8			extrn __imp__GetStringTypeA@20:dword
.idata:004252F8						; CODE XREF: __crtGetStringTypeA_stat+191p
.idata:004252F8						; __crtGetStringTypeW_stat+1D4p
.idata:004252F8						; DATA XREF: ...
.idata:004252FC	; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
.idata:004252FC			extrn __imp__GetStringTypeW@16:dword
.idata:004252FC						; CODE XREF: __crtGetStringTypeA_stat+2Dp
.idata:004252FC						; __crtGetStringTypeA_stat+11Cp ...
.idata:00425300	; int __stdcall	GetTimeFormatA(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpTime, LPCSTR lpFormat, LPSTR lpTimeStr, int cchTime)
.idata:00425300			extrn __imp__GetTimeFormatA@24:dword
.idata:00425300						; DATA XREF: _store_winword+54r
.idata:00425300						; GetTimeFormatA(x,x,x,x,x,x)r
.idata:00425304	; int __stdcall	GetDateFormatA(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpDate, LPCSTR lpFormat, LPSTR lpDateStr, int cchDate)
.idata:00425304			extrn __imp__GetDateFormatA@24:dword
.idata:00425304						; CODE XREF: _store_winword+A5p
.idata:00425304						; DATA XREF: _store_winword+4Cr ...
.idata:00425308	; LCID __stdcall GetUserDefaultLCID()
.idata:00425308			extrn __imp__GetUserDefaultLCID@0:dword
.idata:00425308						; CODE XREF: GetLcidFromDefault+7p
.idata:00425308						; ___get_qualified_locale:loc_40F9B8p
.idata:00425308						; DATA XREF: ...
.idata:0042530C	; BOOL __stdcall EnumSystemLocalesA(LOCALE_ENUMPROCA lpLocaleEnumProc, DWORD dwFlags)
.idata:0042530C			extrn __imp__EnumSystemLocalesA@8:dword
.idata:0042530C						; CODE XREF: GetLcidFromCountry+1Bp
.idata:0042530C						; GetLcidFromLangCountry+47p ...
.idata:00425310	; BOOL __stdcall IsValidLocale(LCID Locale, DWORD dwFlags)
.idata:00425310			extrn __imp__IsValidLocale@8:dword
.idata:00425310						; CODE XREF: ___get_qualified_locale+13Bp
.idata:00425310						; DATA XREF: ___get_qualified_locale+13Br ...
.idata:00425314	; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
.idata:00425314			extrn __imp__SetFilePointer@16:dword
.idata:00425314						; CODE XREF: __lseeki64_nolock+40p
.idata:00425314						; DATA XREF: __lseeki64_nolock+40r ...
.idata:00425318	; BOOL __stdcall CloseHandle(HANDLE hObject)
.idata:00425318			extrn __imp__CloseHandle@4:dword
.idata:00425318						; CODE XREF: __close_nolock+4Ep
.idata:00425318						; ___termcon+17p ...
.idata:0042531C	; BOOL __stdcall WriteConsoleA(HANDLE hConsoleOutput, const void *lpBuffer, DWORD nNumberOfCharsToWrite, LPDWORD lpNumberOfCharsWritten, LPVOID	lpReserved)
.idata:0042531C			extrn __imp__WriteConsoleA@20:dword
.idata:0042531C						; CODE XREF: __putwch_nolock+9Bp
.idata:0042531C						; DATA XREF: __putwch_nolock+9Br ...
.idata:00425320	; UINT __stdcall GetConsoleOutputCP()
.idata:00425320			extrn __imp__GetConsoleOutputCP@0:dword
.idata:00425320						; CODE XREF: __putwch_nolock+78p
.idata:00425320						; DATA XREF: __putwch_nolock+78r ...
.idata:00425324	; BOOL __stdcall WriteConsoleW(HANDLE hConsoleOutput, const void *lpBuffer, DWORD nNumberOfCharsToWrite, LPDWORD lpNumberOfCharsWritten, LPVOID	lpReserved)
.idata:00425324			extrn __imp__WriteConsoleW@20:dword
.idata:00425324						; CODE XREF: __putwch_nolock+45p
.idata:00425324						; DATA XREF: __putwch_nolock+45r ...
.idata:00425328	; BOOL __stdcall SetStdHandle(DWORD nStdHandle,	HANDLE hHandle)
.idata:00425328			extrn __imp__SetStdHandle@8:dword
.idata:00425328						; CODE XREF: __set_osfhnd:loc_4137CDp
.idata:00425328						; __free_osfhnd:loc_41384Ep
.idata:00425328						; DATA XREF: ...
.idata:0042532C	; DWORD	__stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)
.idata:0042532C			extrn __imp__GetTimeZoneInformation@4:dword
.idata:0042532C						; CODE XREF: _tzset_nolock+14Cp
.idata:0042532C						; DATA XREF: _tzset_nolock+14Cr ...
.idata:00425330	; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
.idata:00425330			extrn __imp__CreateFileA@28:dword
.idata:00425330						; CODE XREF: ___initconin+13p
.idata:00425330						; ___initconout+13p
.idata:00425330						; DATA XREF: ...
.idata:00425334	; int __stdcall	CompareStringA(LCID Locale, DWORD dwCmpFlags, LPCSTR lpString1,	int cchCount1, LPCSTR lpString2, int cchCount2)
.idata:00425334			extrn __imp__CompareStringA@24:dword
.idata:00425334						; CODE XREF: __crtCompareStringA_stat+35Bp
.idata:00425334						; DATA XREF: __crtCompareStringA_stat+35Br ...
.idata:00425338	; int __stdcall	CompareStringW(LCID Locale, DWORD dwCmpFlags, LPCWSTR lpString1, int cchCount1,	LPCWSTR	lpString2, int cchCount2)
.idata:00425338			extrn __imp__CompareStringW@24:dword
.idata:00425338						; CODE XREF: __crtCompareStringA_stat+37p
.idata:00425338						; __crtCompareStringA_stat+2A1p
.idata:00425338						; DATA XREF: ...
.idata:0042533C	; BOOL __stdcall SetEnvironmentVariableA(LPCSTR	lpName,	LPCSTR lpValue)
.idata:0042533C			extrn __imp__SetEnvironmentVariableA@8:dword
.idata:0042533C						; CODE XREF: ___crtsetenv+1FCp
.idata:0042533C						; DATA XREF: ___crtsetenv+1FCr	...
.idata:00425340			extrn _KERNEL32_NULL_THUNK_DATA:byte:70h
.idata:00425340
.idata:00425340
.idata:00425340			end _mainCRTStartup
