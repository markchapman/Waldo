;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2009 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-313D-7374-F1			    |
; |   Aditya Thakur, University	of Wisconsin/Computer Sciences Department   |
; +-------------------------------------------------------------------------+
;
.text:00401000 ;
.text:00401000 ; +-------------------------------------------------------------------------+
.text:00401000 ; |   This file has been	generated by The Interactive Disassembler (IDA)	   |
.text:00401000 ; |	  Copyright (c)	2009 by	Hex-Rays, <support@hex-rays.com>	   |
.text:00401000 ; |			License	info: 48-313D-7374-F1			   |
.text:00401000 ; |   Aditya Thakur, University of Wisconsin/Computer Sciences Department   |
.text:00401000 ; +-------------------------------------------------------------------------+
.text:00401000 ;
.text:00401000 ; Input MD5   : 81428CC6587FD5924062723CEE0DFB60
.text:00401000
.text:00401000 ; File Name   : C:\aditya\work\waldo\tests\large\testavl.exe
.text:00401000 ; Format	     : Portable	executable for 80386 (PE)
.text:00401000 ; Imagebase   : 400000
.text:00401000 ; Section 1. (virtual address 00001000)
.text:00401000 ; Virtual size		       : 0001C033 ( 114739.)
.text:00401000 ; Section size in file	       : 0001D000 ( 118784.)
.text:00401000 ; Offset	to raw data for	section: 00001000
.text:00401000 ; Flags 60000020: Text Executable Readable
.text:00401000 ; Alignment     : default
.text:00401000 ; OS type	 :  MS Windows
.text:00401000 ; Application type:  Executable 32bit
.text:00401000
.text:00401000		       include uni.inc ; see unicode subdir of ida for info on unicode
.text:00401000
.text:00401000		       .686p
.text:00401000		       .mmx
.text:00401000		       .model flat
.text:00401000
.text:00401000 ; ===========================================================================
.text:00401000
.text:00401000 ; Segment type: Pure code
.text:00401000 ; Segment permissions: Read/Execute
.text:00401000 _text	       segment para public 'CODE' use32
.text:00401000		       assume cs:_text
.text:00401000		       ;org 401000h
.text:00401000		       assume es:nothing, ss:nothing, ds:_data,	fs:nothing, gs:nothing
.text:00401000		       db 5 dup(0CCh)
.text:00401005 ; [00000005 BYTES: COLLAPSED FUNCTION j__MakeEmpty. PRESS KEYPAD	"+" TO EXPAND]
.text:0040100A ; [00000005 BYTES: COLLAPSED FUNCTION j__Retrieve. PRESS	KEYPAD "+" TO EXPAND]
.text:0040100F ; [00000005 BYTES: COLLAPSED FUNCTION j__Find. PRESS KEYPAD "+" TO EXPAND]
.text:00401014 ; [00000005 BYTES: COLLAPSED FUNCTION j__Delete.	PRESS KEYPAD "+" TO EXPAND]
.text:00401019
.text:00401019 ; =============== S U B R O U T I N E =======================================
.text:00401019
.text:00401019
.text:00401019 ; int __cdecl main_0()
.text:00401019 _main_0	       proc near	       ; CODE XREF: __tmainCRTStartup+15Ap
.text:00401019		       jmp     _main
.text:00401019 _main_0	       endp
.text:00401019
.text:0040101E ; [00000005 BYTES: COLLAPSED FUNCTION j__Insert.	PRESS KEYPAD "+" TO EXPAND]
.text:00401023 ; [00000005 BYTES: COLLAPSED FUNCTION j__FindMax. PRESS KEYPAD "+" TO EXPAND]
.text:00401028 ; [00000005 BYTES: COLLAPSED FUNCTION j__FindMin. PRESS KEYPAD "+" TO EXPAND]
.text:0040102D		       db 33h dup(0CCh)
.text:00401060
.text:00401060 ; =============== S U B R O U T I N E =======================================
.text:00401060
.text:00401060 ; Attributes: bp-based frame
.text:00401060
.text:00401060 ; int __cdecl main()
.text:00401060 _main	       proc near	       ; CODE XREF: _main_0j
.text:00401060
.text:00401060 j	       = dword ptr -10h
.text:00401060 P	       = dword ptr -0Ch
.text:00401060 i	       = dword ptr -8
.text:00401060 T	       = dword ptr -4
.text:00401060
.text:00401060		       push    ebp
.text:00401061		       mov     ebp, esp
.text:00401063		       sub     esp, 10h
.text:00401066		       mov     [ebp+j],	0
.text:0040106D		       push    0	       ; T
.text:0040106F		       call    j__MakeEmpty
.text:00401074		       add     esp, 4
.text:00401077		       mov     [ebp+T],	eax
.text:0040107A		       mov     [ebp+i],	0
.text:00401081		       jmp     short loc_40109D
.text:00401083 ; ---------------------------------------------------------------------------
.text:00401083
.text:00401083 loc_401083:			       ; CODE XREF: _main+56j
.text:00401083		       mov     eax, [ebp+i]
.text:00401086		       add     eax, 1
.text:00401089		       mov     [ebp+i],	eax
.text:0040108C		       mov     eax, [ebp+j]
.text:0040108F		       add     eax, 7
.text:00401092		       cdq
.text:00401093		       mov     ecx, 32h
.text:00401098		       idiv    ecx
.text:0040109A		       mov     [ebp+j],	edx
.text:0040109D
.text:0040109D loc_40109D:			       ; CODE XREF: _main+21j
.text:0040109D		       cmp     [ebp+i],	32h
.text:004010A1		       jge     short loc_4010B8
.text:004010A3		       mov     edx, [ebp+T]
.text:004010A6		       push    edx	       ; T
.text:004010A7		       mov     eax, [ebp+j]
.text:004010AA		       push    eax	       ; X
.text:004010AB		       call    j__Insert
.text:004010B0		       add     esp, 8
.text:004010B3		       mov     [ebp+T],	eax
.text:004010B6		       jmp     short loc_401083
.text:004010B8 ; ---------------------------------------------------------------------------
.text:004010B8
.text:004010B8 loc_4010B8:			       ; CODE XREF: _main+41j
.text:004010B8		       mov     [ebp+i],	0
.text:004010BF		       jmp     short loc_4010CA
.text:004010C1 ; ---------------------------------------------------------------------------
.text:004010C1
.text:004010C1 loc_4010C1:			       ; CODE XREF: _main:loc_40110Bj
.text:004010C1		       mov     ecx, [ebp+i]
.text:004010C4		       add     ecx, 1
.text:004010C7		       mov     [ebp+i],	ecx
.text:004010CA
.text:004010CA loc_4010CA:			       ; CODE XREF: _main+5Fj
.text:004010CA		       cmp     [ebp+i],	32h
.text:004010CE		       jge     short loc_40110D
.text:004010D0		       mov     edx, [ebp+T]
.text:004010D3		       push    edx	       ; T
.text:004010D4		       mov     eax, [ebp+i]
.text:004010D7		       push    eax	       ; X
.text:004010D8		       call    j__Find
.text:004010DD		       add     esp, 8
.text:004010E0		       mov     [ebp+P],	eax
.text:004010E3		       cmp     [ebp+P],	0
.text:004010E7		       jz      short loc_4010FA
.text:004010E9		       mov     ecx, [ebp+P]
.text:004010EC		       push    ecx	       ; P
.text:004010ED		       call    j__Retrieve
.text:004010F2		       add     esp, 4
.text:004010F5		       cmp     eax, [ebp+i]
.text:004010F8		       jz      short loc_40110B
.text:004010FA
.text:004010FA loc_4010FA:			       ; CODE XREF: _main+87j
.text:004010FA		       mov     edx, [ebp+i]
.text:004010FD		       push    edx
.text:004010FE		       push    offset format   ; "Error	at %d\n"
.text:00401103		       call    _printf
.text:00401108		       add     esp, 8
.text:0040110B
.text:0040110B loc_40110B:			       ; CODE XREF: _main+98j
.text:0040110B		       jmp     short loc_4010C1
.text:0040110D ; ---------------------------------------------------------------------------
.text:0040110D
.text:0040110D loc_40110D:			       ; CODE XREF: _main+6Ej
.text:0040110D		       mov     eax, [ebp+T]
.text:00401110		       push    eax	       ; T
.text:00401111		       call    j__FindMax
.text:00401116		       add     esp, 4
.text:00401119		       push    eax	       ; P
.text:0040111A		       call    j__Retrieve
.text:0040111F		       add     esp, 4
.text:00401122		       push    eax
.text:00401123		       mov     ecx, [ebp+T]
.text:00401126		       push    ecx	       ; T
.text:00401127		       call    j__FindMin
.text:0040112C		       add     esp, 4
.text:0040112F		       push    eax	       ; P
.text:00401130		       call    j__Retrieve
.text:00401135		       add     esp, 4
.text:00401138		       push    eax
.text:00401139		       push    offset aMinIsDMaxIsD ; "Min is %d, Max is %d\n"
.text:0040113E		       call    _printf
.text:00401143		       add     esp, 0Ch
.text:00401146		       xor     eax, eax
.text:00401148		       mov     esp, ebp
.text:0040114A		       pop     ebp
.text:0040114B		       retn
.text:0040114B _main	       endp
.text:0040114B
.text:0040114B ; ---------------------------------------------------------------------------
.text:0040114C		       db 44h dup(0CCh)
.text:00401190
.text:00401190 ; =============== S U B R O U T I N E =======================================
.text:00401190
.text:00401190 ; Attributes: bp-based frame
.text:00401190
.text:00401190 ; AvlNode *__cdecl MakeEmpty(AvlNode *T)
.text:00401190 _MakeEmpty      proc near	       ; CODE XREF: j__MakeEmptyj
.text:00401190
.text:00401190 T	       = dword ptr  8
.text:00401190
.text:00401190		       push    ebp
.text:00401191		       mov     ebp, esp
.text:00401193		       cmp     [ebp+T],	0
.text:00401197		       jz      short loc_4011C3
.text:00401199		       mov     eax, [ebp+T]
.text:0040119C		       mov     ecx, [eax+4]
.text:0040119F		       push    ecx	       ; T
.text:004011A0		       call    j__MakeEmpty
.text:004011A5		       add     esp, 4
.text:004011A8		       mov     edx, [ebp+T]
.text:004011AB		       mov     eax, [edx+8]
.text:004011AE		       push    eax	       ; T
.text:004011AF		       call    j__MakeEmpty
.text:004011B4		       add     esp, 4
.text:004011B7		       mov     ecx, [ebp+T]
.text:004011BA		       push    ecx	       ; pBlock
.text:004011BB		       call    _free
.text:004011C0		       add     esp, 4
.text:004011C3
.text:004011C3 loc_4011C3:			       ; CODE XREF: _MakeEmpty+7j
.text:004011C3		       xor     eax, eax
.text:004011C5		       pop     ebp
.text:004011C6		       retn
.text:004011C6 _MakeEmpty      endp
.text:004011C6
.text:004011C6 ; ---------------------------------------------------------------------------
.text:004011C7		       align 10h
.text:004011D0
.text:004011D0 ; =============== S U B R O U T I N E =======================================
.text:004011D0
.text:004011D0 ; Attributes: bp-based frame
.text:004011D0
.text:004011D0 ; AvlNode *__cdecl Find(int X, AvlNode *T)
.text:004011D0 _Find	       proc near	       ; CODE XREF: j__Findj
.text:004011D0
.text:004011D0 X	       = dword ptr  8
.text:004011D0 T	       = dword ptr  0Ch
.text:004011D0
.text:004011D0		       push    ebp
.text:004011D1		       mov     ebp, esp
.text:004011D3		       cmp     [ebp+T],	0
.text:004011D7		       jnz     short loc_4011DD
.text:004011D9		       xor     eax, eax
.text:004011DB		       jmp     short loc_401222
.text:004011DD ; ---------------------------------------------------------------------------
.text:004011DD
.text:004011DD loc_4011DD:			       ; CODE XREF: _Find+7j
.text:004011DD		       mov     eax, [ebp+T]
.text:004011E0		       mov     ecx, [ebp+X]
.text:004011E3		       cmp     ecx, [eax]
.text:004011E5		       jge     short loc_4011FE
.text:004011E7		       mov     edx, [ebp+T]
.text:004011EA		       mov     eax, [edx+4]
.text:004011ED		       push    eax	       ; T
.text:004011EE		       mov     ecx, [ebp+X]
.text:004011F1		       push    ecx	       ; X
.text:004011F2		       call    j__Find
.text:004011F7		       add     esp, 8
.text:004011FA		       jmp     short loc_401222
.text:004011FC ; ---------------------------------------------------------------------------
.text:004011FC		       jmp     short loc_401222
.text:004011FE ; ---------------------------------------------------------------------------
.text:004011FE
.text:004011FE loc_4011FE:			       ; CODE XREF: _Find+15j
.text:004011FE		       mov     edx, [ebp+T]
.text:00401201		       mov     eax, [ebp+X]
.text:00401204		       cmp     eax, [edx]
.text:00401206		       jle     short loc_40121F
.text:00401208		       mov     ecx, [ebp+T]
.text:0040120B		       mov     edx, [ecx+8]
.text:0040120E		       push    edx	       ; T
.text:0040120F		       mov     eax, [ebp+X]
.text:00401212		       push    eax	       ; X
.text:00401213		       call    j__Find
.text:00401218		       add     esp, 8
.text:0040121B		       jmp     short loc_401222
.text:0040121D ; ---------------------------------------------------------------------------
.text:0040121D		       jmp     short loc_401222
.text:0040121F ; ---------------------------------------------------------------------------
.text:0040121F
.text:0040121F loc_40121F:			       ; CODE XREF: _Find+36j
.text:0040121F		       mov     eax, [ebp+T]
.text:00401222
.text:00401222 loc_401222:			       ; CODE XREF: _Find+Bj
.text:00401222					       ; _Find+2Aj ...
.text:00401222		       pop     ebp
.text:00401223		       retn
.text:00401223 _Find	       endp
.text:00401223
.text:00401223 ; ---------------------------------------------------------------------------
.text:00401224		       align 10h
.text:00401230
.text:00401230 ; =============== S U B R O U T I N E =======================================
.text:00401230
.text:00401230 ; Attributes: bp-based frame
.text:00401230
.text:00401230 ; AvlNode *__cdecl FindMin(AvlNode *T)
.text:00401230 _FindMin	       proc near	       ; CODE XREF: j__FindMinj
.text:00401230
.text:00401230 T	       = dword ptr  8
.text:00401230
.text:00401230		       push    ebp
.text:00401231		       mov     ebp, esp
.text:00401233		       cmp     [ebp+T],	0
.text:00401237		       jnz     short loc_40123F
.text:00401239		       xor     eax, eax
.text:0040123B		       jmp     short loc_40125E
.text:0040123D ; ---------------------------------------------------------------------------
.text:0040123D		       jmp     short loc_40125E
.text:0040123F ; ---------------------------------------------------------------------------
.text:0040123F
.text:0040123F loc_40123F:			       ; CODE XREF: _FindMin+7j
.text:0040123F		       mov     eax, [ebp+T]
.text:00401242		       cmp     dword ptr [eax+4], 0
.text:00401246		       jnz     short loc_40124F
.text:00401248		       mov     eax, [ebp+T]
.text:0040124B		       jmp     short loc_40125E
.text:0040124D ; ---------------------------------------------------------------------------
.text:0040124D		       jmp     short loc_40125E
.text:0040124F ; ---------------------------------------------------------------------------
.text:0040124F
.text:0040124F loc_40124F:			       ; CODE XREF: _FindMin+16j
.text:0040124F		       mov     ecx, [ebp+T]
.text:00401252		       mov     edx, [ecx+4]
.text:00401255		       push    edx	       ; T
.text:00401256		       call    j__FindMin
.text:0040125B		       add     esp, 4
.text:0040125E
.text:0040125E loc_40125E:			       ; CODE XREF: _FindMin+Bj
.text:0040125E					       ; _FindMin+Dj ...
.text:0040125E		       pop     ebp
.text:0040125F		       retn
.text:0040125F _FindMin	       endp
.text:0040125F
.text:00401260
.text:00401260 ; =============== S U B R O U T I N E =======================================
.text:00401260
.text:00401260 ; Attributes: bp-based frame
.text:00401260
.text:00401260 ; AvlNode *__cdecl FindMax(AvlNode *T)
.text:00401260 _FindMax	       proc near	       ; CODE XREF: j__FindMaxj
.text:00401260
.text:00401260 T	       = dword ptr  8
.text:00401260
.text:00401260		       push    ebp
.text:00401261		       mov     ebp, esp
.text:00401263		       cmp     [ebp+T],	0
.text:00401267		       jz      short loc_40127D
.text:00401269
.text:00401269 loc_401269:			       ; CODE XREF: _FindMax+1Bj
.text:00401269		       mov     eax, [ebp+T]
.text:0040126C		       cmp     dword ptr [eax+8], 0
.text:00401270		       jz      short loc_40127D
.text:00401272		       mov     ecx, [ebp+T]
.text:00401275		       mov     edx, [ecx+8]
.text:00401278		       mov     [ebp+T],	edx
.text:0040127B		       jmp     short loc_401269
.text:0040127D ; ---------------------------------------------------------------------------
.text:0040127D
.text:0040127D loc_40127D:			       ; CODE XREF: _FindMax+7j
.text:0040127D					       ; _FindMax+10j
.text:0040127D		       mov     eax, [ebp+T]
.text:00401280		       pop     ebp
.text:00401281		       retn
.text:00401281 _FindMax	       endp
.text:00401281
.text:00401281 ; ---------------------------------------------------------------------------
.text:00401282		       align 10h
.text:00401290
.text:00401290 ; =============== S U B R O U T I N E =======================================
.text:00401290
.text:00401290 ; Attributes: bp-based frame
.text:00401290
.text:00401290 ; AvlNode *__cdecl Insert(int X,	AvlNode	*T)
.text:00401290 _Insert	       proc near	       ; CODE XREF: j__Insertj
.text:00401290
.text:00401290 X	       = dword ptr  8
.text:00401290 T	       = dword ptr  0Ch
.text:00401290
.text:00401290		       push    ebp
.text:00401291		       mov     ebp, esp
.text:00401293		       push    esi
.text:00401294		       cmp     [ebp+T],	0
.text:00401298		       jnz     short loc_4012FC
.text:0040129A		       push    10h	       ; size
.text:0040129C		       call    _malloc
.text:004012A1		       add     esp, 4
.text:004012A4		       mov     [ebp+T],	eax
.text:004012A7		       cmp     [ebp+T],	0
.text:004012AB		       jnz     short loc_4012D1
.text:004012AD		       push    offset aOutOfSpace ; "Out of space!!!"
.text:004012B2		       push    offset aS       ; "%s\n"
.text:004012B7		       call    ___iob_func
.text:004012BC		       add     eax, 40h
.text:004012BF		       push    eax	       ; str
.text:004012C0		       call    _fprintf
.text:004012C5		       add     esp, 0Ch
.text:004012C8		       push    1	       ; code
.text:004012CA		       call    _exit
.text:004012CF ; ---------------------------------------------------------------------------
.text:004012CF		       jmp     short loc_4012F7
.text:004012D1 ; ---------------------------------------------------------------------------
.text:004012D1
.text:004012D1 loc_4012D1:			       ; CODE XREF: _Insert+1Bj
.text:004012D1		       mov     eax, [ebp+T]
.text:004012D4		       mov     ecx, [ebp+X]
.text:004012D7		       mov     [eax], ecx
.text:004012D9		       mov     edx, [ebp+T]
.text:004012DC		       mov     dword ptr [edx+0Ch], 0
.text:004012E3		       mov     eax, [ebp+T]
.text:004012E6		       mov     dword ptr [eax+8], 0
.text:004012ED		       mov     ecx, [ebp+T]
.text:004012F0		       mov     dword ptr [ecx+4], 0
.text:004012F7
.text:004012F7 loc_4012F7:			       ; CODE XREF: _Insert+3Fj
.text:004012F7		       jmp     loc_4013EC
.text:004012FC ; ---------------------------------------------------------------------------
.text:004012FC
.text:004012FC loc_4012FC:			       ; CODE XREF: _Insert+8j
.text:004012FC		       mov     edx, [ebp+T]
.text:004012FF		       mov     eax, [ebp+X]
.text:00401302		       cmp     eax, [edx]
.text:00401304		       jge     short loc_401375
.text:00401306		       mov     ecx, [ebp+T]
.text:00401309		       mov     edx, [ecx+4]
.text:0040130C		       push    edx	       ; T
.text:0040130D		       mov     eax, [ebp+X]
.text:00401310		       push    eax	       ; X
.text:00401311		       call    j__Insert
.text:00401316		       add     esp, 8
.text:00401319		       mov     ecx, [ebp+T]
.text:0040131C		       mov     [ecx+4],	eax
.text:0040131F		       mov     edx, [ebp+T]
.text:00401322		       mov     eax, [edx+4]
.text:00401325		       push    eax	       ; P
.text:00401326		       call    Height
.text:0040132B		       add     esp, 4
.text:0040132E		       mov     esi, eax
.text:00401330		       mov     ecx, [ebp+T]
.text:00401333		       mov     edx, [ecx+8]
.text:00401336		       push    edx	       ; P
.text:00401337		       call    Height
.text:0040133C		       add     esp, 4
.text:0040133F		       sub     esi, eax
.text:00401341		       cmp     esi, 2
.text:00401344		       jnz     short loc_401373
.text:00401346		       mov     eax, [ebp+T]
.text:00401349		       mov     ecx, [eax+4]
.text:0040134C		       mov     edx, [ebp+X]
.text:0040134F		       cmp     edx, [ecx]
.text:00401351		       jge     short loc_401364
.text:00401353		       mov     eax, [ebp+T]
.text:00401356		       push    eax	       ; K2
.text:00401357		       call    SingleRotateWithLeft
.text:0040135C		       add     esp, 4
.text:0040135F		       mov     [ebp+T],	eax
.text:00401362		       jmp     short loc_401373
.text:00401364 ; ---------------------------------------------------------------------------
.text:00401364
.text:00401364 loc_401364:			       ; CODE XREF: _Insert+C1j
.text:00401364		       mov     ecx, [ebp+T]
.text:00401367		       push    ecx	       ; K3
.text:00401368		       call    DoubleRotateWithLeft
.text:0040136D		       add     esp, 4
.text:00401370		       mov     [ebp+T],	eax
.text:00401373
.text:00401373 loc_401373:			       ; CODE XREF: _Insert+B4j
.text:00401373					       ; _Insert+D2j
.text:00401373		       jmp     short loc_4013EC
.text:00401375 ; ---------------------------------------------------------------------------
.text:00401375
.text:00401375 loc_401375:			       ; CODE XREF: _Insert+74j
.text:00401375		       mov     edx, [ebp+T]
.text:00401378		       mov     eax, [ebp+X]
.text:0040137B		       cmp     eax, [edx]
.text:0040137D		       jle     short loc_4013EC
.text:0040137F		       mov     ecx, [ebp+T]
.text:00401382		       mov     edx, [ecx+8]
.text:00401385		       push    edx	       ; T
.text:00401386		       mov     eax, [ebp+X]
.text:00401389		       push    eax	       ; X
.text:0040138A		       call    j__Insert
.text:0040138F		       add     esp, 8
.text:00401392		       mov     ecx, [ebp+T]
.text:00401395		       mov     [ecx+8],	eax
.text:00401398		       mov     edx, [ebp+T]
.text:0040139B		       mov     eax, [edx+8]
.text:0040139E		       push    eax	       ; P
.text:0040139F		       call    Height
.text:004013A4		       add     esp, 4
.text:004013A7		       mov     esi, eax
.text:004013A9		       mov     ecx, [ebp+T]
.text:004013AC		       mov     edx, [ecx+4]
.text:004013AF		       push    edx	       ; P
.text:004013B0		       call    Height
.text:004013B5		       add     esp, 4
.text:004013B8		       sub     esi, eax
.text:004013BA		       cmp     esi, 2
.text:004013BD		       jnz     short loc_4013EC
.text:004013BF		       mov     eax, [ebp+T]
.text:004013C2		       mov     ecx, [eax+8]
.text:004013C5		       mov     edx, [ebp+X]
.text:004013C8		       cmp     edx, [ecx]
.text:004013CA		       jle     short loc_4013DD
.text:004013CC		       mov     eax, [ebp+T]
.text:004013CF		       push    eax	       ; K1
.text:004013D0		       call    SingleRotateWithRight
.text:004013D5		       add     esp, 4
.text:004013D8		       mov     [ebp+T],	eax
.text:004013DB		       jmp     short loc_4013EC
.text:004013DD ; ---------------------------------------------------------------------------
.text:004013DD
.text:004013DD loc_4013DD:			       ; CODE XREF: _Insert+13Aj
.text:004013DD		       mov     ecx, [ebp+T]
.text:004013E0		       push    ecx	       ; K1
.text:004013E1		       call    DoubleRotateWithRight
.text:004013E6		       add     esp, 4
.text:004013E9		       mov     [ebp+T],	eax
.text:004013EC
.text:004013EC loc_4013EC:			       ; CODE XREF: _Insert:loc_4012F7j
.text:004013EC					       ; _Insert:loc_401373j ...
.text:004013EC		       mov     edx, [ebp+T]
.text:004013EF		       mov     eax, [edx+8]
.text:004013F2		       push    eax	       ; P
.text:004013F3		       call    Height
.text:004013F8		       add     esp, 4
.text:004013FB		       push    eax	       ; Rhs
.text:004013FC		       mov     ecx, [ebp+T]
.text:004013FF		       mov     edx, [ecx+4]
.text:00401402		       push    edx	       ; P
.text:00401403		       call    Height
.text:00401408		       add     esp, 4
.text:0040140B		       push    eax	       ; Lhs
.text:0040140C		       call    Max
.text:00401411		       add     esp, 8
.text:00401414		       add     eax, 1
.text:00401417		       mov     ecx, [ebp+T]
.text:0040141A		       mov     [ecx+0Ch], eax
.text:0040141D		       mov     eax, [ebp+T]
.text:00401420		       pop     esi
.text:00401421		       pop     ebp
.text:00401422		       retn
.text:00401422 _Insert	       endp ; sp-analysis failed
.text:00401422
.text:00401422 ; ---------------------------------------------------------------------------
.text:00401423		       align 10h
.text:00401430
.text:00401430 ; =============== S U B R O U T I N E =======================================
.text:00401430
.text:00401430 ; Attributes: bp-based frame
.text:00401430
.text:00401430 ; int __cdecl Height(AvlNode *P)
.text:00401430 Height	       proc near	       ; CODE XREF: _Insert+96p
.text:00401430					       ; _Insert+A7p ...
.text:00401430
.text:00401430 P	       = dword ptr  8
.text:00401430
.text:00401430		       push    ebp
.text:00401431		       mov     ebp, esp
.text:00401433		       cmp     [ebp+P],	0
.text:00401437		       jnz     short loc_401440
.text:00401439		       or      eax, 0FFFFFFFFh
.text:0040143C		       jmp     short loc_401446
.text:0040143E ; ---------------------------------------------------------------------------
.text:0040143E		       jmp     short loc_401446
.text:00401440 ; ---------------------------------------------------------------------------
.text:00401440
.text:00401440 loc_401440:			       ; CODE XREF: Height+7j
.text:00401440		       mov     eax, [ebp+P]
.text:00401443		       mov     eax, [eax+0Ch]
.text:00401446
.text:00401446 loc_401446:			       ; CODE XREF: Height+Cj
.text:00401446					       ; Height+Ej
.text:00401446		       pop     ebp
.text:00401447		       retn
.text:00401447 Height	       endp
.text:00401447
.text:00401447 ; ---------------------------------------------------------------------------
.text:00401448		       align 10h
.text:00401450
.text:00401450 ; =============== S U B R O U T I N E =======================================
.text:00401450
.text:00401450 ; Attributes: bp-based frame
.text:00401450
.text:00401450 ; int __cdecl Max(int Lhs, int Rhs)
.text:00401450 Max	       proc near	       ; CODE XREF: _Insert+17Cp
.text:00401450					       ; SingleRotateWithLeft+42p ...
.text:00401450
.text:00401450 var_4	       = dword ptr -4
.text:00401450 Lhs	       = dword ptr  8
.text:00401450 Rhs	       = dword ptr  0Ch
.text:00401450
.text:00401450		       push    ebp
.text:00401451		       mov     ebp, esp
.text:00401453		       push    ecx
.text:00401454		       mov     eax, [ebp+Lhs]
.text:00401457		       cmp     eax, [ebp+Rhs]
.text:0040145A		       jle     short loc_401464
.text:0040145C		       mov     ecx, [ebp+Lhs]
.text:0040145F		       mov     [ebp+var_4], ecx
.text:00401462		       jmp     short loc_40146A
.text:00401464 ; ---------------------------------------------------------------------------
.text:00401464
.text:00401464 loc_401464:			       ; CODE XREF: Max+Aj
.text:00401464		       mov     edx, [ebp+Rhs]
.text:00401467		       mov     [ebp+var_4], edx
.text:0040146A
.text:0040146A loc_40146A:			       ; CODE XREF: Max+12j
.text:0040146A		       mov     eax, [ebp+var_4]
.text:0040146D		       mov     esp, ebp
.text:0040146F		       pop     ebp
.text:00401470		       retn
.text:00401470 Max	       endp
.text:00401470
.text:00401470 ; ---------------------------------------------------------------------------
.text:00401471		       align 10h
.text:00401480
.text:00401480 ; =============== S U B R O U T I N E =======================================
.text:00401480
.text:00401480 ; Attributes: bp-based frame
.text:00401480
.text:00401480 ; AvlNode *__cdecl SingleRotateWithLeft(AvlNode *K2)
.text:00401480 SingleRotateWithLeft proc near	       ; CODE XREF: _Insert+C7p
.text:00401480					       ; DoubleRotateWithLeft+1Cp ...
.text:00401480
.text:00401480 K1	       = dword ptr -4
.text:00401480 K2	       = dword ptr  8
.text:00401480
.text:00401480		       push    ebp
.text:00401481		       mov     ebp, esp
.text:00401483		       push    ecx
.text:00401484		       mov     eax, [ebp+K2]
.text:00401487		       mov     ecx, [eax+4]
.text:0040148A		       mov     [ebp+K1], ecx
.text:0040148D		       mov     edx, [ebp+K2]
.text:00401490		       mov     eax, [ebp+K1]
.text:00401493		       mov     ecx, [eax+8]
.text:00401496		       mov     [edx+4],	ecx
.text:00401499		       mov     edx, [ebp+K1]
.text:0040149C		       mov     eax, [ebp+K2]
.text:0040149F		       mov     [edx+8],	eax
.text:004014A2		       mov     ecx, [ebp+K2]
.text:004014A5		       mov     edx, [ecx+8]
.text:004014A8		       push    edx	       ; P
.text:004014A9		       call    Height
.text:004014AE		       add     esp, 4
.text:004014B1		       push    eax	       ; Rhs
.text:004014B2		       mov     eax, [ebp+K2]
.text:004014B5		       mov     ecx, [eax+4]
.text:004014B8		       push    ecx	       ; P
.text:004014B9		       call    Height
.text:004014BE		       add     esp, 4
.text:004014C1		       push    eax	       ; Lhs
.text:004014C2		       call    Max
.text:004014C7		       add     esp, 8
.text:004014CA		       add     eax, 1
.text:004014CD		       mov     edx, [ebp+K2]
.text:004014D0		       mov     [edx+0Ch], eax
.text:004014D3		       mov     eax, [ebp+K2]
.text:004014D6		       mov     ecx, [eax+0Ch]
.text:004014D9		       push    ecx	       ; Rhs
.text:004014DA		       mov     edx, [ebp+K1]
.text:004014DD		       mov     eax, [edx+4]
.text:004014E0		       push    eax	       ; P
.text:004014E1		       call    Height
.text:004014E6		       add     esp, 4
.text:004014E9		       push    eax	       ; Lhs
.text:004014EA		       call    Max
.text:004014EF		       add     esp, 8
.text:004014F2		       add     eax, 1
.text:004014F5		       mov     ecx, [ebp+K1]
.text:004014F8		       mov     [ecx+0Ch], eax
.text:004014FB		       mov     eax, [ebp+K1]
.text:004014FE		       mov     esp, ebp
.text:00401500		       pop     ebp
.text:00401501		       retn
.text:00401501 SingleRotateWithLeft endp
.text:00401501
.text:00401501 ; ---------------------------------------------------------------------------
.text:00401502		       align 10h
.text:00401510
.text:00401510 ; =============== S U B R O U T I N E =======================================
.text:00401510
.text:00401510 ; Attributes: bp-based frame
.text:00401510
.text:00401510 ; AvlNode *__cdecl SingleRotateWithRight(AvlNode	*K1)
.text:00401510 SingleRotateWithRight proc near	       ; CODE XREF: _Insert+140p
.text:00401510					       ; DoubleRotateWithLeft+Ap ...
.text:00401510
.text:00401510 K2	       = dword ptr -4
.text:00401510 K1	       = dword ptr  8
.text:00401510
.text:00401510		       push    ebp
.text:00401511		       mov     ebp, esp
.text:00401513		       push    ecx
.text:00401514		       mov     eax, [ebp+K1]
.text:00401517		       mov     ecx, [eax+8]
.text:0040151A		       mov     [ebp+K2], ecx
.text:0040151D		       mov     edx, [ebp+K1]
.text:00401520		       mov     eax, [ebp+K2]
.text:00401523		       mov     ecx, [eax+4]
.text:00401526		       mov     [edx+8],	ecx
.text:00401529		       mov     edx, [ebp+K2]
.text:0040152C		       mov     eax, [ebp+K1]
.text:0040152F		       mov     [edx+4],	eax
.text:00401532		       mov     ecx, [ebp+K1]
.text:00401535		       mov     edx, [ecx+8]
.text:00401538		       push    edx	       ; P
.text:00401539		       call    Height
.text:0040153E		       add     esp, 4
.text:00401541		       push    eax	       ; Rhs
.text:00401542		       mov     eax, [ebp+K1]
.text:00401545		       mov     ecx, [eax+4]
.text:00401548		       push    ecx	       ; P
.text:00401549		       call    Height
.text:0040154E		       add     esp, 4
.text:00401551		       push    eax	       ; Lhs
.text:00401552		       call    Max
.text:00401557		       add     esp, 8
.text:0040155A		       add     eax, 1
.text:0040155D		       mov     edx, [ebp+K1]
.text:00401560		       mov     [edx+0Ch], eax
.text:00401563		       mov     eax, [ebp+K1]
.text:00401566		       mov     ecx, [eax+0Ch]
.text:00401569		       push    ecx	       ; Rhs
.text:0040156A		       mov     edx, [ebp+K2]
.text:0040156D		       mov     eax, [edx+8]
.text:00401570		       push    eax	       ; P
.text:00401571		       call    Height
.text:00401576		       add     esp, 4
.text:00401579		       push    eax	       ; Lhs
.text:0040157A		       call    Max
.text:0040157F		       add     esp, 8
.text:00401582		       add     eax, 1
.text:00401585		       mov     ecx, [ebp+K2]
.text:00401588		       mov     [ecx+0Ch], eax
.text:0040158B		       mov     eax, [ebp+K2]
.text:0040158E		       mov     esp, ebp
.text:00401590		       pop     ebp
.text:00401591		       retn
.text:00401591 SingleRotateWithRight endp
.text:00401591
.text:00401591 ; ---------------------------------------------------------------------------
.text:00401592		       align 10h
.text:004015A0
.text:004015A0 ; =============== S U B R O U T I N E =======================================
.text:004015A0
.text:004015A0 ; Attributes: bp-based frame
.text:004015A0
.text:004015A0 ; AvlNode *__cdecl DoubleRotateWithLeft(AvlNode *K3)
.text:004015A0 DoubleRotateWithLeft proc near	       ; CODE XREF: _Insert+D8p
.text:004015A0
.text:004015A0 K3	       = dword ptr  8
.text:004015A0
.text:004015A0		       push    ebp
.text:004015A1		       mov     ebp, esp
.text:004015A3		       mov     eax, [ebp+K3]
.text:004015A6		       mov     ecx, [eax+4]
.text:004015A9		       push    ecx	       ; K1
.text:004015AA		       call    SingleRotateWithRight
.text:004015AF		       add     esp, 4
.text:004015B2		       mov     edx, [ebp+K3]
.text:004015B5		       mov     [edx+4],	eax
.text:004015B8		       mov     eax, [ebp+K3]
.text:004015BB		       push    eax	       ; K2
.text:004015BC		       call    SingleRotateWithLeft
.text:004015C1		       add     esp, 4
.text:004015C4		       pop     ebp
.text:004015C5		       retn
.text:004015C5 DoubleRotateWithLeft endp
.text:004015C5
.text:004015C5 ; ---------------------------------------------------------------------------
.text:004015C6		       align 10h
.text:004015D0
.text:004015D0 ; =============== S U B R O U T I N E =======================================
.text:004015D0
.text:004015D0 ; Attributes: bp-based frame
.text:004015D0
.text:004015D0 ; AvlNode *__cdecl DoubleRotateWithRight(AvlNode	*K1)
.text:004015D0 DoubleRotateWithRight proc near	       ; CODE XREF: _Insert+151p
.text:004015D0
.text:004015D0 K1	       = dword ptr  8
.text:004015D0
.text:004015D0		       push    ebp
.text:004015D1		       mov     ebp, esp
.text:004015D3		       mov     eax, [ebp+K1]
.text:004015D6		       mov     ecx, [eax+8]
.text:004015D9		       push    ecx	       ; K2
.text:004015DA		       call    SingleRotateWithLeft
.text:004015DF		       add     esp, 4
.text:004015E2		       mov     edx, [ebp+K1]
.text:004015E5		       mov     [edx+8],	eax
.text:004015E8		       mov     eax, [ebp+K1]
.text:004015EB		       push    eax	       ; K1
.text:004015EC		       call    SingleRotateWithRight
.text:004015F1		       add     esp, 4
.text:004015F4		       pop     ebp
.text:004015F5		       retn
.text:004015F5 DoubleRotateWithRight endp
.text:004015F5
.text:004015F5 ; ---------------------------------------------------------------------------
.text:004015F6		       align 10h
.text:00401600
.text:00401600 ; =============== S U B R O U T I N E =======================================
.text:00401600
.text:00401600 ; Attributes: bp-based frame
.text:00401600
.text:00401600 ; AvlNode *__cdecl Delete(int X,	AvlNode	*T)
.text:00401600 _Delete	       proc near	       ; CODE XREF: j__Deletej
.text:00401600
.text:00401600 X	       = dword ptr  8
.text:00401600 T	       = dword ptr  0Ch
.text:00401600
.text:00401600		       push    ebp
.text:00401601		       mov     ebp, esp
.text:00401603		       mov     eax, [ebp+X]
.text:00401606		       push    eax
.text:00401607		       push    offset aSorryDeleteIsU ;	"Sorry;	Delete is unimplemented; %d rema"...
.text:0040160C		       call    _printf
.text:00401611		       add     esp, 8
.text:00401614		       mov     eax, [ebp+T]
.text:00401617		       pop     ebp
.text:00401618		       retn
.text:00401618 _Delete	       endp
.text:00401618
.text:00401618 ; ---------------------------------------------------------------------------
.text:00401619		       align 10h
.text:00401620
.text:00401620 ; =============== S U B R O U T I N E =======================================
.text:00401620
.text:00401620 ; Attributes: bp-based frame
.text:00401620
.text:00401620 ; int __cdecl Retrieve(AvlNode *P)
.text:00401620 _Retrieve       proc near	       ; CODE XREF: j__Retrievej
.text:00401620
.text:00401620 P	       = dword ptr  8
.text:00401620
.text:00401620		       push    ebp
.text:00401621		       mov     ebp, esp
.text:00401623		       mov     eax, [ebp+P]
.text:00401626		       mov     eax, [eax]
.text:00401628		       pop     ebp
.text:00401629		       retn
.text:00401629 _Retrieve       endp
.text:00401629
.text:00401629 ; ---------------------------------------------------------------------------
.text:0040162A		       db 126h dup(0CCh)
.text:00401750
.text:00401750 ; =============== S U B R O U T I N E =======================================
.text:00401750
.text:00401750 ; Attributes: bp-based frame
.text:00401750
.text:00401750 ; int __cdecl printf(const char *format)
.text:00401750 _printf	       proc near	       ; CODE XREF: _main+A3p
.text:00401750					       ; _main+DEp ...
.text:00401750
.text:00401750 retval	       = dword ptr -1Ch
.text:00401750 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00401750 format	       = dword ptr  8
.text:00401750 argptr	       = byte ptr  0Ch
.text:00401750
.text:00401750		       push    0Ch
.text:00401752		       push    offset dword_421450
.text:00401757		       call    __SEH_prolog4
.text:0040175C		       xor     eax, eax
.text:0040175E		       xor     esi, esi
.text:00401760		       cmp     [ebp+format], esi
.text:00401763		       setnz   al
.text:00401766		       cmp     eax, esi
.text:00401768		       jnz     short loc_401787
.text:0040176A		       call    __errno
.text:0040176F		       mov     dword ptr [eax],	16h
.text:00401775		       push    esi	       ; pReserved
.text:00401776		       push    esi	       ; nLine
.text:00401777		       push    esi	       ; pszFile
.text:00401778		       push    esi	       ; pszFunction
.text:00401779		       push    esi	       ; pszExpression
.text:0040177A		       call    __invalid_parameter
.text:0040177F		       add     esp, 14h
.text:00401782		       or      eax, 0FFFFFFFFh
.text:00401785		       jmp     short loc_4017E6
.text:00401787 ; ---------------------------------------------------------------------------
.text:00401787
.text:00401787 loc_401787:			       ; CODE XREF: _printf+18j
.text:00401787		       call    ___iob_func
.text:0040178C		       push    20h
.text:0040178E		       pop     ebx
.text:0040178F		       add     eax, ebx
.text:00401791		       push    eax	       ; s
.text:00401792		       push    1	       ; i
.text:00401794		       call    __lock_file2
.text:00401799		       pop     ecx
.text:0040179A		       pop     ecx
.text:0040179B		       mov     [ebp+ms_exc.disabled], esi
.text:0040179E		       call    ___iob_func
.text:004017A3		       add     eax, ebx
.text:004017A5		       push    eax	       ; str
.text:004017A6		       call    __stbuf
.text:004017AB		       pop     ecx
.text:004017AC		       mov     edi, eax
.text:004017AE		       lea     eax, [ebp+argptr]
.text:004017B1		       push    eax	       ; argptr
.text:004017B2		       push    esi	       ; plocinfo
.text:004017B3		       push    [ebp+format]    ; format
.text:004017B6		       call    ___iob_func
.text:004017BB		       add     eax, ebx
.text:004017BD		       push    eax	       ; stream
.text:004017BE		       call    __output_l
.text:004017C3		       mov     [ebp+retval], eax
.text:004017C6		       call    ___iob_func
.text:004017CB		       add     eax, ebx
.text:004017CD		       push    eax	       ; str
.text:004017CE		       push    edi	       ; flag
.text:004017CF		       call    __ftbuf
.text:004017D4		       add     esp, 18h
.text:004017D7		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004017DE		       call    $LN6
.text:004017E3
.text:004017E3 $LN9:
.text:004017E3		       mov     eax, [ebp+retval]
.text:004017E6
.text:004017E6 loc_4017E6:			       ; CODE XREF: _printf+35j
.text:004017E6		       call    __SEH_epilog4
.text:004017EB		       retn
.text:004017EC ; ---------------------------------------------------------------------------
.text:004017EC
.text:004017EC $LN6:				       ; CODE XREF: _printf+8Ep
.text:004017EC					       ; DATA XREF: .rdata:00421468o
.text:004017EC		       call    ___iob_func
.text:004017F1		       add     eax, 20h
.text:004017F4		       push    eax	       ; s
.text:004017F5		       push    1	       ; i
.text:004017F7		       call    __unlock_file2
.text:004017FC		       pop     ecx
.text:004017FD		       pop     ecx
.text:004017FE
.text:004017FE $LN7:
.text:004017FE		       retn
.text:004017FE _printf	       endp
.text:004017FE
.text:004017FF
.text:004017FF ; =============== S U B R O U T I N E =======================================
.text:004017FF
.text:004017FF
.text:004017FF ; int __cdecl _printf_l(const char *format, localeinfo_struct *plocinfo)
.text:004017FF __printf_l      proc near
.text:004017FF
.text:004017FF format	       = dword ptr  4
.text:004017FF plocinfo	       = dword ptr  8
.text:004017FF ap	       = byte ptr  0Ch
.text:004017FF
.text:004017FF		       lea     eax, [esp+ap]
.text:00401803		       push    eax	       ; ap
.text:00401804		       push    [esp+4+plocinfo]	; plocinfo
.text:00401808		       push    [esp+8+format]  ; format
.text:0040180C		       call    __vprintf_l
.text:00401811		       add     esp, 0Ch
.text:00401814		       retn
.text:00401814 __printf_l      endp
.text:00401814
.text:00401815
.text:00401815 ; =============== S U B R O U T I N E =======================================
.text:00401815
.text:00401815
.text:00401815 ; int __cdecl _printf_s_l(const char *format, localeinfo_struct *plocinfo)
.text:00401815 __printf_s_l    proc near
.text:00401815
.text:00401815 format	       = dword ptr  4
.text:00401815 plocinfo	       = dword ptr  8
.text:00401815 ap	       = byte ptr  0Ch
.text:00401815
.text:00401815		       lea     eax, [esp+ap]
.text:00401819		       push    eax	       ; ap
.text:0040181A		       push    [esp+4+plocinfo]	; plocinfo
.text:0040181E		       push    [esp+8+format]  ; format
.text:00401822		       call    __vprintf_s_l
.text:00401827		       add     esp, 0Ch
.text:0040182A		       retn
.text:0040182A __printf_s_l    endp
.text:0040182A
.text:0040182B
.text:0040182B ; =============== S U B R O U T I N E =======================================
.text:0040182B
.text:0040182B
.text:0040182B ; int __cdecl printf_s(const char *format)
.text:0040182B _printf_s       proc near
.text:0040182B
.text:0040182B format	       = dword ptr  4
.text:0040182B ap	       = byte ptr  8
.text:0040182B
.text:0040182B		       lea     eax, [esp+ap]
.text:0040182F		       push    eax	       ; ap
.text:00401830		       push    0	       ; plocinfo
.text:00401832		       push    [esp+8+format]  ; format
.text:00401836		       call    __vprintf_s_l
.text:0040183B		       add     esp, 0Ch
.text:0040183E		       retn
.text:0040183E _printf_s       endp
.text:0040183E
.text:0040183F
.text:0040183F ; =============== S U B R O U T I N E =======================================
.text:0040183F
.text:0040183F
.text:0040183F ; int __cdecl _printf_p_l(const char *format, localeinfo_struct *plocinfo)
.text:0040183F __printf_p_l    proc near
.text:0040183F
.text:0040183F format	       = dword ptr  4
.text:0040183F plocinfo	       = dword ptr  8
.text:0040183F ap	       = byte ptr  0Ch
.text:0040183F
.text:0040183F		       lea     eax, [esp+ap]
.text:00401843		       push    eax	       ; ap
.text:00401844		       push    [esp+4+plocinfo]	; plocinfo
.text:00401848		       push    [esp+8+format]  ; format
.text:0040184C		       call    __vprintf_p_l
.text:00401851		       add     esp, 0Ch
.text:00401854		       retn
.text:00401854 __printf_p_l    endp
.text:00401854
.text:00401855
.text:00401855 ; =============== S U B R O U T I N E =======================================
.text:00401855
.text:00401855
.text:00401855 ; int __cdecl _printf_p(const char *format)
.text:00401855 __printf_p      proc near
.text:00401855
.text:00401855 format	       = dword ptr  4
.text:00401855 ap	       = byte ptr  8
.text:00401855
.text:00401855		       lea     eax, [esp+ap]
.text:00401859		       push    eax	       ; ap
.text:0040185A		       push    0	       ; plocinfo
.text:0040185C		       push    [esp+8+format]  ; format
.text:00401860		       call    __vprintf_p_l
.text:00401865		       add     esp, 0Ch
.text:00401868		       retn
.text:00401868 __printf_p      endp
.text:00401868
.text:00401869
.text:00401869 ; =============== S U B R O U T I N E =======================================
.text:00401869
.text:00401869
.text:00401869 ; int __cdecl _set_printf_count_output(int value)
.text:00401869 __set_printf_count_output proc near
.text:00401869
.text:00401869 value	       = dword ptr  4
.text:00401869
.text:00401869		       mov     ecx, ___security_cookie
.text:0040186F		       mov     edx, [esp+value]
.text:00401873		       or      ecx, 1
.text:00401876		       xor     eax, eax
.text:00401878		       cmp     __enable_percent_n, ecx
.text:0040187E		       setz    al
.text:00401881		       neg     edx
.text:00401883		       sbb     edx, edx
.text:00401885		       and     edx, ecx
.text:00401887		       mov     __enable_percent_n, edx
.text:0040188D		       retn
.text:0040188D __set_printf_count_output endp
.text:0040188D
.text:0040188E
.text:0040188E ; =============== S U B R O U T I N E =======================================
.text:0040188E
.text:0040188E
.text:0040188E ; int __cdecl _get_printf_count_output()
.text:0040188E __get_printf_count_output proc near     ; CODE XREF: __output_l+554p
.text:0040188E					       ; __output_s_l+562p ...
.text:0040188E		       mov     eax, ___security_cookie
.text:00401893		       or      eax, 1
.text:00401896		       xor     ecx, ecx
.text:00401898		       cmp     __enable_percent_n, eax
.text:0040189E		       setz    cl
.text:004018A1		       mov     eax, ecx
.text:004018A3		       retn
.text:004018A3 __get_printf_count_output endp
.text:004018A3
.text:004018A4
.text:004018A4 ; =============== S U B R O U T I N E =======================================
.text:004018A4
.text:004018A4 ; Attributes: bp-based frame
.text:004018A4
.text:004018A4 ; void __cdecl free(void	*pBlock)
.text:004018A4 _free	       proc near	       ; CODE XREF: _MakeEmpty+2Bp
.text:004018A4					       ; ___endstdio+19p ...
.text:004018A4
.text:004018A4 pHeader	       = dword ptr -1Ch
.text:004018A4 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004018A4 pBlock	       = dword ptr  8
.text:004018A4
.text:004018A4		       push    0Ch
.text:004018A6		       push    offset dword_421470
.text:004018AB		       call    __SEH_prolog4
.text:004018B0		       mov     esi, [ebp+pBlock]
.text:004018B3		       test    esi, esi
.text:004018B5		       jz      short loc_40192C
.text:004018B7		       cmp     ___active_heap, 3
.text:004018BE		       jnz     short loc_401903
.text:004018C0		       push    4	       ; locknum
.text:004018C2		       call    __lock
.text:004018C7		       pop     ecx
.text:004018C8		       and     [ebp+ms_exc.disabled], 0
.text:004018CC		       push    esi	       ; pvAlloc
.text:004018CD		       call    ___sbh_find_block
.text:004018D2		       pop     ecx
.text:004018D3		       mov     [ebp+pHeader], eax
.text:004018D6		       test    eax, eax
.text:004018D8		       jz      short loc_4018E3
.text:004018DA		       push    esi	       ; pvAlloc
.text:004018DB		       push    eax	       ; pHeader
.text:004018DC		       call    ___sbh_free_block
.text:004018E1		       pop     ecx
.text:004018E2		       pop     ecx
.text:004018E3
.text:004018E3 loc_4018E3:			       ; CODE XREF: _free+34j
.text:004018E3		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004018EA		       call    $LN12
.text:004018EF
.text:004018EF $LN15:
.text:004018EF		       cmp     [ebp+pHeader], 0
.text:004018F3		       jnz     short loc_40192C
.text:004018F5		       push    [ebp+pBlock]
.text:004018F8		       jmp     short loc_401904
.text:004018FA ; ---------------------------------------------------------------------------
.text:004018FA
.text:004018FA $LN12:				       ; CODE XREF: _free+46p
.text:004018FA					       ; DATA XREF: .rdata:00421488o
.text:004018FA		       push    4	       ; locknum
.text:004018FC		       call    __unlock
.text:00401901		       pop     ecx
.text:00401902
.text:00401902 $LN13:
.text:00401902		       retn
.text:00401903 ; ---------------------------------------------------------------------------
.text:00401903
.text:00401903 loc_401903:			       ; CODE XREF: _free+1Aj
.text:00401903		       push    esi	       ; lpMem
.text:00401904
.text:00401904 loc_401904:			       ; CODE XREF: _free+54j
.text:00401904		       push    0	       ; dwFlags
.text:00401906		       push    __crtheap       ; hHeap
.text:0040190C		       call    ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00401912		       test    eax, eax
.text:00401914		       jnz     short loc_40192C
.text:00401916		       call    __errno
.text:0040191B		       mov     esi, eax
.text:0040191D		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00401923		       push    eax	       ; oserrno
.text:00401924		       call    __get_errno_from_oserr
.text:00401929		       mov     [esi], eax
.text:0040192B		       pop     ecx
.text:0040192C
.text:0040192C loc_40192C:			       ; CODE XREF: _free+11j
.text:0040192C					       ; _free+4Fj ...
.text:0040192C		       call    __SEH_epilog4
.text:00401931		       retn
.text:00401931 _free	       endp
.text:00401931
.text:00401932
.text:00401932 ; =============== S U B R O U T I N E =======================================
.text:00401932
.text:00401932
.text:00401932 ; void __cdecl _amsg_exit(int rterrnum)
.text:00401932 __amsg_exit     proc near	       ; CODE XREF: __tmainCRTStartup+F3p
.text:00401932					       ; __tmainCRTStartup+119p ...
.text:00401932
.text:00401932 rterrnum	       = dword ptr  4
.text:00401932
.text:00401932		       call    __FF_MSGBANNER
.text:00401937		       push    [esp+rterrnum]  ; rterrnum
.text:0040193B		       call    __NMSG_WRITE
.text:00401940		       push    __aexit_rtn     ; codedptr
.text:00401946		       call    __decode_pointer
.text:0040194B		       push    0FFh
.text:00401950		       call    eax
.text:00401952		       add     esp, 0Ch
.text:00401955		       retn
.text:00401955 __amsg_exit     endp
.text:00401955
.text:00401956
.text:00401956 ; =============== S U B R O U T I N E =======================================
.text:00401956
.text:00401956
.text:00401956 ; void __cdecl __crtCorExitProcess(int status)
.text:00401956 ___crtCorExitProcess proc near	       ; CODE XREF: ___crtExitProcess+4p
.text:00401956
.text:00401956 status	       = dword ptr  4
.text:00401956
.text:00401956		       push    offset ModuleName ; "mscoree.dll"
.text:0040195B		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00401961		       test    eax, eax
.text:00401963		       jz      short locret_40197B
.text:00401965		       push    offset ProcName ; "CorExitProcess"
.text:0040196A		       push    eax	       ; hModule
.text:0040196B		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00401971		       test    eax, eax
.text:00401973		       jz      short locret_40197B
.text:00401975		       push    [esp+status]
.text:00401979		       call    eax
.text:0040197B
.text:0040197B locret_40197B:			       ; CODE XREF: ___crtCorExitProcess+Dj
.text:0040197B					       ; ___crtCorExitProcess+1Dj
.text:0040197B		       retn
.text:0040197B ___crtCorExitProcess endp
.text:0040197B
.text:0040197C
.text:0040197C ; =============== S U B R O U T I N E =======================================
.text:0040197C
.text:0040197C ; Attributes: noreturn
.text:0040197C
.text:0040197C ; void __cdecl __crtExitProcess(int status)
.text:0040197C ___crtExitProcess proc near	       ; CODE XREF: doexit+C5p
.text:0040197C					       ; __heap_alloc+1Ap ...
.text:0040197C
.text:0040197C status	       = dword ptr  4
.text:0040197C
.text:0040197C		       push    [esp+status]    ; status
.text:00401980		       call    ___crtCorExitProcess
.text:00401985		       pop     ecx
.text:00401986		       push    [esp+status]    ; uExitCode
.text:0040198A		       call    ds:__imp__ExitProcess@4 ; ExitProcess(x)
.text:0040198A ; ---------------------------------------------------------------------------
.text:00401990 $LN4	       db 0CCh
.text:00401990 ___crtExitProcess endp
.text:00401990
.text:00401991
.text:00401991 ; =============== S U B R O U T I N E =======================================
.text:00401991
.text:00401991
.text:00401991 __lockexit      proc near	       ; CODE XREF: __onexit+Cp
.text:00401991		       push    8	       ; locknum
.text:00401993		       call    __lock
.text:00401998		       pop     ecx
.text:00401999		       retn
.text:00401999 __lockexit      endp
.text:00401999
.text:0040199A
.text:0040199A ; =============== S U B R O U T I N E =======================================
.text:0040199A
.text:0040199A
.text:0040199A __unlockexit    proc near	       ; CODE XREF: __onexit:$LN5p
.text:0040199A		       push    8	       ; locknum
.text:0040199C		       call    __unlock
.text:004019A1		       pop     ecx
.text:004019A2		       retn
.text:004019A2 __unlockexit    endp
.text:004019A2
.text:004019A3
.text:004019A3 ; =============== S U B R O U T I N E =======================================
.text:004019A3
.text:004019A3
.text:004019A3 ; void __usercall initterm(void (__cdecl	**pfbegin)()<eax>, void	(__cdecl **pfend)())
.text:004019A3 _initterm       proc near	       ; CODE XREF: doexit+8Cp
.text:004019A3					       ; doexit+9Cp
.text:004019A3
.text:004019A3 pfend	       = dword ptr  4
.text:004019A3
.text:004019A3 pfbegin = eax
.text:004019A3		       push    esi
.text:004019A4		       mov     esi, pfbegin
.text:004019A6		       jmp     short loc_4019B3
.text:004019A8 ; ---------------------------------------------------------------------------
.text:004019A8
.text:004019A8 loc_4019A8:			       ; CODE XREF: _initterm+14j
.text:004019A8		       mov     pfbegin,	[esi]
.text:004019AA		       test    pfbegin,	pfbegin
.text:004019AC		       jz      short loc_4019B0
.text:004019AE		       call    pfbegin
.text:004019B0
.text:004019B0 loc_4019B0:			       ; CODE XREF: _initterm+9j
.text:004019B0		       add     esi, 4
.text:004019B3
.text:004019B3 loc_4019B3:			       ; CODE XREF: _initterm+3j
.text:004019B3		       cmp     esi, [esp+4+pfend]
.text:004019B7		       jb      short loc_4019A8
.text:004019B9		       pop     esi
.text:004019BA		       retn
.text:004019BA _initterm       endp
.text:004019BA
.text:004019BB
.text:004019BB ; =============== S U B R O U T I N E =======================================
.text:004019BB
.text:004019BB
.text:004019BB ; int __cdecl _initterm_e(int (__cdecl **pfbegin)(), int	(__cdecl **pfend)())
.text:004019BB __initterm_e    proc near	       ; CODE XREF: __cinit+32p
.text:004019BB
.text:004019BB pfbegin	       = dword ptr  4
.text:004019BB pfend	       = dword ptr  8
.text:004019BB
.text:004019BB		       push    esi
.text:004019BC		       mov     esi, [esp+4+pfbegin]
.text:004019C0		       xor     eax, eax
.text:004019C2		       jmp     short loc_4019D3
.text:004019C4 ; ---------------------------------------------------------------------------
.text:004019C4
.text:004019C4 loc_4019C4:			       ; CODE XREF: __initterm_e+1Cj
.text:004019C4		       test    eax, eax
.text:004019C6		       jnz     short loc_4019D9
.text:004019C8		       mov     ecx, [esi]
.text:004019CA		       test    ecx, ecx
.text:004019CC		       jz      short loc_4019D0
.text:004019CE		       call    ecx
.text:004019D0
.text:004019D0 loc_4019D0:			       ; CODE XREF: __initterm_e+11j
.text:004019D0		       add     esi, 4
.text:004019D3
.text:004019D3 loc_4019D3:			       ; CODE XREF: __initterm_e+7j
.text:004019D3		       cmp     esi, [esp+4+pfend]
.text:004019D7		       jb      short loc_4019C4
.text:004019D9
.text:004019D9 loc_4019D9:			       ; CODE XREF: __initterm_e+Bj
.text:004019D9		       pop     esi
.text:004019DA		       retn
.text:004019DA __initterm_e    endp
.text:004019DA
.text:004019DB
.text:004019DB ; =============== S U B R O U T I N E =======================================
.text:004019DB
.text:004019DB
.text:004019DB ; int __cdecl _get_osplatform(unsigned int *pValue)
.text:004019DB __get_osplatform	proc near	       ; CODE XREF: ___heap_select+12p
.text:004019DB					       ; ___crtInitCritSecAndSpinCount+27p ...
.text:004019DB
.text:004019DB pValue	       = dword ptr  4
.text:004019DB
.text:004019DB		       mov     ecx, [esp+pValue]
.text:004019DF		       push    esi
.text:004019E0		       xor     esi, esi
.text:004019E2		       cmp     ecx, esi
.text:004019E4		       jnz     short loc_401A03
.text:004019E6
.text:004019E6 loc_4019E6:			       ; CODE XREF: __get_osplatform+2Fj
.text:004019E6		       call    __errno
.text:004019EB		       push    esi	       ; pReserved
.text:004019EC		       push    esi	       ; nLine
.text:004019ED		       push    esi	       ; pszFile
.text:004019EE		       push    esi	       ; pszFunction
.text:004019EF		       push    esi	       ; pszExpression
.text:004019F0		       mov     dword ptr [eax],	16h
.text:004019F6		       call    __invalid_parameter
.text:004019FB		       add     esp, 14h
.text:004019FE		       push    16h
.text:00401A00		       pop     eax
.text:00401A01		       pop     esi
.text:00401A02		       retn
.text:00401A03 ; ---------------------------------------------------------------------------
.text:00401A03
.text:00401A03 loc_401A03:			       ; CODE XREF: __get_osplatform+9j
.text:00401A03		       mov     eax, __osplatform
.text:00401A08		       cmp     eax, esi
.text:00401A0A		       jz      short loc_4019E6
.text:00401A0C		       mov     [ecx], eax
.text:00401A0E		       xor     eax, eax
.text:00401A10		       pop     esi
.text:00401A11		       retn
.text:00401A11 __get_osplatform	endp
.text:00401A11
.text:00401A12
.text:00401A12 ; =============== S U B R O U T I N E =======================================
.text:00401A12
.text:00401A12
.text:00401A12 ; int __cdecl _get_osver(unsigned int *pValue)
.text:00401A12 __get_osver     proc near
.text:00401A12
.text:00401A12 pValue	       = dword ptr  4
.text:00401A12
.text:00401A12		       mov     eax, [esp+pValue]
.text:00401A16		       push    esi
.text:00401A17		       xor     esi, esi
.text:00401A19		       cmp     eax, esi
.text:00401A1B		       jnz     short loc_401A3A
.text:00401A1D
.text:00401A1D loc_401A1D:			       ; CODE XREF: __get_osver+2Ej
.text:00401A1D		       call    __errno
.text:00401A22		       push    esi	       ; pReserved
.text:00401A23		       push    esi	       ; nLine
.text:00401A24		       push    esi	       ; pszFile
.text:00401A25		       push    esi	       ; pszFunction
.text:00401A26		       push    esi	       ; pszExpression
.text:00401A27		       mov     dword ptr [eax],	16h
.text:00401A2D		       call    __invalid_parameter
.text:00401A32		       add     esp, 14h
.text:00401A35		       push    16h
.text:00401A37		       pop     eax
.text:00401A38		       pop     esi
.text:00401A39		       retn
.text:00401A3A ; ---------------------------------------------------------------------------
.text:00401A3A
.text:00401A3A loc_401A3A:			       ; CODE XREF: __get_osver+9j
.text:00401A3A		       cmp     __osplatform, esi
.text:00401A40		       jz      short loc_401A1D
.text:00401A42		       mov     ecx, __osver
.text:00401A48		       mov     [eax], ecx
.text:00401A4A		       xor     eax, eax
.text:00401A4C		       pop     esi
.text:00401A4D		       retn
.text:00401A4D __get_osver     endp
.text:00401A4D
.text:00401A4E
.text:00401A4E ; =============== S U B R O U T I N E =======================================
.text:00401A4E
.text:00401A4E
.text:00401A4E ; int __cdecl _get_winver(unsigned int *pValue)
.text:00401A4E __get_winver    proc near
.text:00401A4E
.text:00401A4E pValue	       = dword ptr  4
.text:00401A4E
.text:00401A4E		       mov     eax, [esp+pValue]
.text:00401A52		       push    esi
.text:00401A53		       xor     esi, esi
.text:00401A55		       cmp     eax, esi
.text:00401A57		       jnz     short loc_401A76
.text:00401A59
.text:00401A59 loc_401A59:			       ; CODE XREF: __get_winver+2Ej
.text:00401A59		       call    __errno
.text:00401A5E		       push    esi	       ; pReserved
.text:00401A5F		       push    esi	       ; nLine
.text:00401A60		       push    esi	       ; pszFile
.text:00401A61		       push    esi	       ; pszFunction
.text:00401A62		       push    esi	       ; pszExpression
.text:00401A63		       mov     dword ptr [eax],	16h
.text:00401A69		       call    __invalid_parameter
.text:00401A6E		       add     esp, 14h
.text:00401A71		       push    16h
.text:00401A73		       pop     eax
.text:00401A74		       pop     esi
.text:00401A75		       retn
.text:00401A76 ; ---------------------------------------------------------------------------
.text:00401A76
.text:00401A76 loc_401A76:			       ; CODE XREF: __get_winver+9j
.text:00401A76		       cmp     __osplatform, esi
.text:00401A7C		       jz      short loc_401A59
.text:00401A7E		       mov     ecx, __winver
.text:00401A84		       mov     [eax], ecx
.text:00401A86		       xor     eax, eax
.text:00401A88		       pop     esi
.text:00401A89		       retn
.text:00401A89 __get_winver    endp
.text:00401A89
.text:00401A8A
.text:00401A8A ; =============== S U B R O U T I N E =======================================
.text:00401A8A
.text:00401A8A
.text:00401A8A ; int __cdecl _get_winmajor(unsigned int	*pValue)
.text:00401A8A __get_winmajor  proc near	       ; CODE XREF: ___heap_select+2Dp
.text:00401A8A					       ; _use_encode_pointer+16p ...
.text:00401A8A
.text:00401A8A pValue	       = dword ptr  4
.text:00401A8A
.text:00401A8A		       mov     eax, [esp+pValue]
.text:00401A8E		       push    esi
.text:00401A8F		       xor     esi, esi
.text:00401A91		       cmp     eax, esi
.text:00401A93		       jnz     short loc_401AB2
.text:00401A95
.text:00401A95 loc_401A95:			       ; CODE XREF: __get_winmajor+2Ej
.text:00401A95		       call    __errno
.text:00401A9A		       push    esi	       ; pReserved
.text:00401A9B		       push    esi	       ; nLine
.text:00401A9C		       push    esi	       ; pszFile
.text:00401A9D		       push    esi	       ; pszFunction
.text:00401A9E		       push    esi	       ; pszExpression
.text:00401A9F		       mov     dword ptr [eax],	16h
.text:00401AA5		       call    __invalid_parameter
.text:00401AAA		       add     esp, 14h
.text:00401AAD		       push    16h
.text:00401AAF		       pop     eax
.text:00401AB0		       pop     esi
.text:00401AB1		       retn
.text:00401AB2 ; ---------------------------------------------------------------------------
.text:00401AB2
.text:00401AB2 loc_401AB2:			       ; CODE XREF: __get_winmajor+9j
.text:00401AB2		       cmp     __osplatform, esi
.text:00401AB8		       jz      short loc_401A95
.text:00401ABA		       mov     ecx, __winmajor
.text:00401AC0		       mov     [eax], ecx
.text:00401AC2		       xor     eax, eax
.text:00401AC4		       pop     esi
.text:00401AC5		       retn
.text:00401AC5 __get_winmajor  endp
.text:00401AC5
.text:00401AC6
.text:00401AC6 ; =============== S U B R O U T I N E =======================================
.text:00401AC6
.text:00401AC6
.text:00401AC6 ; int __cdecl _get_winminor(unsigned int	*pValue)
.text:00401AC6 __get_winminor  proc near
.text:00401AC6
.text:00401AC6 pValue	       = dword ptr  4
.text:00401AC6
.text:00401AC6		       mov     eax, [esp+pValue]
.text:00401ACA		       push    esi
.text:00401ACB		       xor     esi, esi
.text:00401ACD		       cmp     eax, esi
.text:00401ACF		       jnz     short loc_401AEE
.text:00401AD1
.text:00401AD1 loc_401AD1:			       ; CODE XREF: __get_winminor+2Ej
.text:00401AD1		       call    __errno
.text:00401AD6		       push    esi	       ; pReserved
.text:00401AD7		       push    esi	       ; nLine
.text:00401AD8		       push    esi	       ; pszFile
.text:00401AD9		       push    esi	       ; pszFunction
.text:00401ADA		       push    esi	       ; pszExpression
.text:00401ADB		       mov     dword ptr [eax],	16h
.text:00401AE1		       call    __invalid_parameter
.text:00401AE6		       add     esp, 14h
.text:00401AE9		       push    16h
.text:00401AEB		       pop     eax
.text:00401AEC		       pop     esi
.text:00401AED		       retn
.text:00401AEE ; ---------------------------------------------------------------------------
.text:00401AEE
.text:00401AEE loc_401AEE:			       ; CODE XREF: __get_winminor+9j
.text:00401AEE		       cmp     __osplatform, esi
.text:00401AF4		       jz      short loc_401AD1
.text:00401AF6		       mov     ecx, __winminor
.text:00401AFC		       mov     [eax], ecx
.text:00401AFE		       xor     eax, eax
.text:00401B00		       pop     esi
.text:00401B01		       retn
.text:00401B01 __get_winminor  endp
.text:00401B01
.text:00401B02
.text:00401B02 ; =============== S U B R O U T I N E =======================================
.text:00401B02
.text:00401B02
.text:00401B02 ; int __cdecl _get_wpgmptr(unsigned __int16 **pValue)
.text:00401B02 __get_wpgmptr   proc near
.text:00401B02
.text:00401B02 pValue	       = dword ptr  4
.text:00401B02
.text:00401B02		       mov     ecx, [esp+pValue]
.text:00401B06		       push    esi
.text:00401B07		       xor     esi, esi
.text:00401B09		       cmp     ecx, esi
.text:00401B0B		       jnz     short loc_401B2A
.text:00401B0D
.text:00401B0D loc_401B0D:			       ; CODE XREF: __get_wpgmptr+2Fj
.text:00401B0D		       call    __errno
.text:00401B12		       push    esi	       ; pReserved
.text:00401B13		       push    esi	       ; nLine
.text:00401B14		       push    esi	       ; pszFile
.text:00401B15		       push    esi	       ; pszFunction
.text:00401B16		       push    esi	       ; pszExpression
.text:00401B17		       mov     dword ptr [eax],	16h
.text:00401B1D		       call    __invalid_parameter
.text:00401B22		       add     esp, 14h
.text:00401B25		       push    16h
.text:00401B27		       pop     eax
.text:00401B28		       pop     esi
.text:00401B29		       retn
.text:00401B2A ; ---------------------------------------------------------------------------
.text:00401B2A
.text:00401B2A loc_401B2A:			       ; CODE XREF: __get_wpgmptr+9j
.text:00401B2A		       mov     eax, __wpgmptr
.text:00401B2F		       cmp     eax, esi
.text:00401B31		       jz      short loc_401B0D
.text:00401B33		       mov     [ecx], eax
.text:00401B35		       xor     eax, eax
.text:00401B37		       pop     esi
.text:00401B38		       retn
.text:00401B38 __get_wpgmptr   endp
.text:00401B38
.text:00401B39
.text:00401B39 ; =============== S U B R O U T I N E =======================================
.text:00401B39
.text:00401B39
.text:00401B39 ; int __cdecl _get_pgmptr(char **pValue)
.text:00401B39 __get_pgmptr    proc near
.text:00401B39
.text:00401B39 pValue	       = dword ptr  4
.text:00401B39
.text:00401B39		       mov     ecx, [esp+pValue]
.text:00401B3D		       push    esi
.text:00401B3E		       xor     esi, esi
.text:00401B40		       cmp     ecx, esi
.text:00401B42		       jnz     short loc_401B61
.text:00401B44
.text:00401B44 loc_401B44:			       ; CODE XREF: __get_pgmptr+2Fj
.text:00401B44		       call    __errno
.text:00401B49		       push    esi	       ; pReserved
.text:00401B4A		       push    esi	       ; nLine
.text:00401B4B		       push    esi	       ; pszFile
.text:00401B4C		       push    esi	       ; pszFunction
.text:00401B4D		       push    esi	       ; pszExpression
.text:00401B4E		       mov     dword ptr [eax],	16h
.text:00401B54		       call    __invalid_parameter
.text:00401B59		       add     esp, 14h
.text:00401B5C		       push    16h
.text:00401B5E		       pop     eax
.text:00401B5F		       pop     esi
.text:00401B60		       retn
.text:00401B61 ; ---------------------------------------------------------------------------
.text:00401B61
.text:00401B61 loc_401B61:			       ; CODE XREF: __get_pgmptr+9j
.text:00401B61		       mov     eax, __pgmptr
.text:00401B66		       cmp     eax, esi
.text:00401B68		       jz      short loc_401B44
.text:00401B6A		       mov     [ecx], eax
.text:00401B6C		       xor     eax, eax
.text:00401B6E		       pop     esi
.text:00401B6F		       retn
.text:00401B6F __get_pgmptr    endp
.text:00401B6F
.text:00401B70
.text:00401B70 ; =============== S U B R O U T I N E =======================================
.text:00401B70
.text:00401B70
.text:00401B70 ; int __cdecl _cinit(int	initFloatingPrecision)
.text:00401B70 __cinit	       proc near	       ; CODE XREF: __tmainCRTStartup+132p
.text:00401B70
.text:00401B70 initFloatingPrecision= dword ptr	 4
.text:00401B70
.text:00401B70		       cmp     __FPinit, 0
.text:00401B77		       jz      short loc_401B93
.text:00401B79		       push    offset __FPinit ; pTarget
.text:00401B7E		       call    __IsNonwritableInCurrentImage
.text:00401B83		       test    eax, eax
.text:00401B85		       pop     ecx
.text:00401B86		       jz      short loc_401B93
.text:00401B88		       push    [esp+initFloatingPrecision]
.text:00401B8C		       call    __FPinit
.text:00401B92		       pop     ecx
.text:00401B93
.text:00401B93 loc_401B93:			       ; CODE XREF: __cinit+7j
.text:00401B93					       ; __cinit+16j
.text:00401B93		       call    __initp_misc_cfltcvt_tab
.text:00401B98		       push    offset ___xi_z  ; pfend
.text:00401B9D		       push    offset ___xi_a  ; pfbegin
.text:00401BA2		       call    __initterm_e
.text:00401BA7		       test    eax, eax
.text:00401BA9		       pop     ecx
.text:00401BAA		       pop     ecx
.text:00401BAB		       jnz     short locret_401C01
.text:00401BAD		       push    esi
.text:00401BAE		       push    edi
.text:00401BAF		       push    offset __RTC_Terminate ;	func
.text:00401BB4		       call    _atexit
.text:00401BB9 ; ---------------------------------------------------------------------------
.text:00401BB9		       mov     esi, offset ___xc_a
.text:00401BBE		       mov     eax, esi
.text:00401BC0		       mov     edi, offset ___xc_z
.text:00401BC5		       cmp     eax, edi
.text:00401BC7		       pop     ecx
.text:00401BC8		       jnb     short loc_401BD9
.text:00401BCA
.text:00401BCA loc_401BCA:			       ; CODE XREF: __cinit+67j
.text:00401BCA		       mov     eax, [esi]
.text:00401BCC		       test    eax, eax
.text:00401BCE		       jz      short loc_401BD2
.text:00401BD0		       call    eax
.text:00401BD2
.text:00401BD2 loc_401BD2:			       ; CODE XREF: __cinit+5Ej
.text:00401BD2		       add     esi, 4
.text:00401BD5		       cmp     esi, edi
.text:00401BD7		       jb      short loc_401BCA
.text:00401BD9
.text:00401BD9 loc_401BD9:			       ; CODE XREF: __cinit+58j
.text:00401BD9		       cmp     ___dyn_tls_init_callback, 0
.text:00401BE0		       pop     edi
.text:00401BE1		       pop     esi
.text:00401BE2		       jz      short loc_401BFF
.text:00401BE4		       push    offset ___dyn_tls_init_callback ; pTarget
.text:00401BE9		       call    __IsNonwritableInCurrentImage
.text:00401BEE		       test    eax, eax
.text:00401BF0		       pop     ecx
.text:00401BF1		       jz      short loc_401BFF
.text:00401BF3		       push    0
.text:00401BF5		       push    2
.text:00401BF7		       push    0
.text:00401BF9		       call    ___dyn_tls_init_callback
.text:00401BFF
.text:00401BFF loc_401BFF:			       ; CODE XREF: __cinit+72j
.text:00401BFF					       ; __cinit+81j
.text:00401BFF		       xor     eax, eax
.text:00401C01
.text:00401C01 locret_401C01:			       ; CODE XREF: __cinit+3Bj
.text:00401C01		       retn
.text:00401C01 __cinit	       endp
.text:00401C01
.text:00401C02
.text:00401C02 ; =============== S U B R O U T I N E =======================================
.text:00401C02
.text:00401C02 ; Attributes: noreturn bp-based frame
.text:00401C02
.text:00401C02 ; void __cdecl doexit(int code, int quick, int retcaller)
.text:00401C02 doexit	       proc near	       ; CODE XREF: _exit+8p
.text:00401C02					       ; __exit+8p ...
.text:00401C02
.text:00401C02 onexitend       = dword ptr -20h
.text:00401C02 onexitbegin     = dword ptr -1Ch
.text:00401C02 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00401C02 code	       = dword ptr  8
.text:00401C02 quick	       = dword ptr  0Ch
.text:00401C02 retcaller       = dword ptr  10h
.text:00401C02
.text:00401C02		       push    10h
.text:00401C04		       push    offset dword_421490
.text:00401C09		       call    __SEH_prolog4
.text:00401C0E		       push    8	       ; locknum
.text:00401C10		       call    __lock
.text:00401C15		       pop     ecx
.text:00401C16		       xor     edi, edi
.text:00401C18		       mov     [ebp+ms_exc.disabled], edi
.text:00401C1B		       xor     ebx, ebx
.text:00401C1D		       inc     ebx
.text:00401C1E		       cmp     __C_Exit_Done, ebx
.text:00401C24		       jz      short loc_401CA4
.text:00401C26		       mov     __C_Termination_Done, ebx
.text:00401C2C		       mov     al, byte	ptr [ebp+retcaller]
.text:00401C2F		       mov     __exitflag, al
.text:00401C34		       cmp     [ebp+quick], edi
.text:00401C37		       jnz     short loc_401C94
.text:00401C39		       push    ___onexitbegin  ; codedptr
.text:00401C3F		       call    __decode_pointer
.text:00401C44		       mov     [ebp+onexitbegin], eax
.text:00401C47		       push    ___onexitend    ; codedptr
.text:00401C4D		       call    __decode_pointer
.text:00401C52		       pop     ecx
.text:00401C53		       pop     ecx
.text:00401C54		       mov     esi, eax
.text:00401C56		       mov     [ebp+onexitend],	esi
.text:00401C59		       cmp     [ebp+onexitbegin], edi
.text:00401C5C		       jz      short loc_401C84
.text:00401C5E
.text:00401C5E loc_401C5E:			       ; CODE XREF: doexit+6Aj
.text:00401C5E					       ; doexit+75j ...
.text:00401C5E		       sub     esi, 4
.text:00401C61		       mov     [ebp+onexitend],	esi
.text:00401C64		       cmp     esi, [ebp+onexitbegin]
.text:00401C67		       jb      short loc_401C84
.text:00401C69		       cmp     dword ptr [esi],	0
.text:00401C6C		       jz      short loc_401C5E
.text:00401C6E		       mov     edi, [esi]
.text:00401C70		       call    __encoded_null
.text:00401C75		       cmp     edi, eax
.text:00401C77		       jz      short loc_401C5E
.text:00401C79		       push    edi	       ; codedptr
.text:00401C7A		       call    __decode_pointer
.text:00401C7F		       pop     ecx
.text:00401C80		       call    eax
.text:00401C82		       jmp     short loc_401C5E
.text:00401C84 ; ---------------------------------------------------------------------------
.text:00401C84
.text:00401C84 loc_401C84:			       ; CODE XREF: doexit+5Aj
.text:00401C84					       ; doexit+65j
.text:00401C84		       push    offset ___xp_z  ; pfend
.text:00401C89		       mov     eax, offset ___xp_a ; pfbegin
.text:00401C8E		       call    _initterm
.text:00401C93		       pop     ecx
.text:00401C94
.text:00401C94 loc_401C94:			       ; CODE XREF: doexit+35j
.text:00401C94		       push    offset ___xt_z  ; pfend
.text:00401C99		       mov     eax, offset ___xt_a ; pfbegin
.text:00401C9E		       call    _initterm
.text:00401CA3		       pop     ecx
.text:00401CA4
.text:00401CA4 loc_401CA4:			       ; CODE XREF: doexit+22j
.text:00401CA4		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00401CAB		       call    $LN15_0
.text:00401CB0 ; ---------------------------------------------------------------------------
.text:00401CB0
.text:00401CB0 $LN16:
.text:00401CB0		       cmp     [ebp+retcaller],	0
.text:00401CB4		       jnz     short loc_401CDE
.text:00401CB6		       mov     __C_Exit_Done, ebx
.text:00401CBC		       push    8	       ; locknum
.text:00401CBE		       call    __unlock
.text:00401CC3		       pop     ecx
.text:00401CC4		       push    [ebp+code]      ; status
.text:00401CC7		       call    ___crtExitProcess
.text:00401CCC ; ---------------------------------------------------------------------------
.text:00401CCC
.text:00401CCC $LN29:				       ; DATA XREF: .rdata:004214A8o
.text:00401CCC		       xor     ebx, ebx
.text:00401CCE		       inc     ebx
.text:00401CCF
.text:00401CCF $LN15_0:				       ; CODE XREF: doexit+A9p
.text:00401CCF		       cmp     [ebp+retcaller],	0
.text:00401CD3		       jz      short $LN14
.text:00401CD5		       push    8	       ; locknum
.text:00401CD7		       call    __unlock
.text:00401CDC		       pop     ecx
.text:00401CDD
.text:00401CDD $LN14:				       ; CODE XREF: doexit+D1j
.text:00401CDD		       retn
.text:00401CDE ; ---------------------------------------------------------------------------
.text:00401CDE
.text:00401CDE loc_401CDE:			       ; CODE XREF: doexit+B2j
.text:00401CDE		       call    __SEH_epilog4
.text:00401CE3		       retn
.text:00401CE3 doexit	       endp ; sp-analysis failed
.text:00401CE3
.text:00401CE4
.text:00401CE4 ; =============== S U B R O U T I N E =======================================
.text:00401CE4
.text:00401CE4 ; Attributes: noreturn
.text:00401CE4
.text:00401CE4 ; void __cdecl exit(int code)
.text:00401CE4 _exit	       proc near	       ; CODE XREF: _Insert+3Ap
.text:00401CE4					       ; __tmainCRTStartup+16Cp
.text:00401CE4
.text:00401CE4 code	       = dword ptr  4
.text:00401CE4
.text:00401CE4		       push    0	       ; retcaller
.text:00401CE6		       push    0	       ; quick
.text:00401CE8		       push    [esp+8+code]    ; code
.text:00401CEC		       call    doexit
.text:00401CF1 ; ---------------------------------------------------------------------------
.text:00401CF1		       add     esp, 0Ch
.text:00401CF4		       retn
.text:00401CF4 _exit	       endp
.text:00401CF4
.text:00401CF5
.text:00401CF5 ; =============== S U B R O U T I N E =======================================
.text:00401CF5
.text:00401CF5 ; Attributes: noreturn
.text:00401CF5
.text:00401CF5 ; void __cdecl _exit(int	code)
.text:00401CF5 __exit	       proc near	       ; CODE XREF: __tmainCRTStartup+19Cp
.text:00401CF5					       ; _raise+D9p ...
.text:00401CF5
.text:00401CF5 code	       = dword ptr  4
.text:00401CF5
.text:00401CF5		       push    0	       ; retcaller
.text:00401CF7		       push    1	       ; quick
.text:00401CF9		       push    [esp+8+code]    ; code
.text:00401CFD		       call    doexit
.text:00401D02 ; ---------------------------------------------------------------------------
.text:00401D02		       add     esp, 0Ch
.text:00401D05		       retn
.text:00401D05 __exit	       endp
.text:00401D05
.text:00401D06
.text:00401D06 ; =============== S U B R O U T I N E =======================================
.text:00401D06
.text:00401D06 ; Attributes: noreturn
.text:00401D06
.text:00401D06 ; void __cdecl _cexit()
.text:00401D06 __cexit	       proc near	       ; CODE XREF: __tmainCRTStartup:$LN35p
.text:00401D06		       push    1	       ; retcaller
.text:00401D08		       push    0	       ; quick
.text:00401D0A		       push    0	       ; code
.text:00401D0C		       call    doexit
.text:00401D11 ; ---------------------------------------------------------------------------
.text:00401D11		       add     esp, 0Ch
.text:00401D14		       retn
.text:00401D14 __cexit	       endp
.text:00401D14
.text:00401D15
.text:00401D15 ; =============== S U B R O U T I N E =======================================
.text:00401D15
.text:00401D15 ; Attributes: noreturn
.text:00401D15
.text:00401D15 ; void __cdecl _c_exit()
.text:00401D15 __c_exit	       proc near	       ; CODE XREF: __tmainCRTStartup:$LN36p
.text:00401D15		       push    1	       ; retcaller
.text:00401D17		       push    1	       ; quick
.text:00401D19		       push    0	       ; code
.text:00401D1B		       call    doexit
.text:00401D20 ; ---------------------------------------------------------------------------
.text:00401D20		       add     esp, 0Ch
.text:00401D23		       retn
.text:00401D23 __c_exit	       endp
.text:00401D23
.text:00401D24
.text:00401D24 ; =============== S U B R O U T I N E =======================================
.text:00401D24
.text:00401D24
.text:00401D24 __init_pointers proc near	       ; CODE XREF: __mtinit+C4p
.text:00401D24		       push    esi
.text:00401D25		       call    __encoded_null
.text:00401D2A		       mov     esi, eax
.text:00401D2C		       push    esi	       ; enull
.text:00401D2D		       call    __initp_heap_handler
.text:00401D32		       push    esi	       ; enull
.text:00401D33		       call    __initp_misc_initcrit
.text:00401D38		       push    esi	       ; enull
.text:00401D39		       call    __initp_misc_invarg
.text:00401D3E		       push    esi	       ; enull
.text:00401D3F		       call    __initp_misc_purevirt
.text:00401D44		       push    esi	       ; enull
.text:00401D45		       call    __initp_misc_rand_s
.text:00401D4A		       push    esi	       ; enull
.text:00401D4B		       call    __initp_misc_winsig
.text:00401D50		       push    esi	       ; enull
.text:00401D51		       call    __initp_misc_winxfltr
.text:00401D56		       push    esi	       ; enull
.text:00401D57		       call    __initp_eh_hooks
.text:00401D5C		       push    offset __exit   ; ptr
.text:00401D61		       call    __encode_pointer
.text:00401D66		       add     esp, 24h
.text:00401D69		       mov     __aexit_rtn, eax
.text:00401D6E		       pop     esi
.text:00401D6F		       retn
.text:00401D6F __init_pointers endp
.text:00401D6F
.text:00401D70
.text:00401D70 ; =============== S U B R O U T I N E =======================================
.text:00401D70
.text:00401D70 ; Attributes: bp-based frame
.text:00401D70
.text:00401D70 ; int __cdecl fprintf(_iobuf *str, const	char *format)
.text:00401D70 _fprintf	       proc near	       ; CODE XREF: _Insert+30p
.text:00401D70
.text:00401D70 retval	       = dword ptr -1Ch
.text:00401D70 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00401D70 stream	       = dword ptr  8
.text:00401D70 format	       = dword ptr  0Ch
.text:00401D70 argptr	       = byte ptr  10h
.text:00401D70
.text:00401D70		       push    0Ch
.text:00401D72		       push    offset dword_4214B0
.text:00401D77		       call    __SEH_prolog4
.text:00401D7C		       xor     ebx, ebx
.text:00401D7E		       mov     [ebp+retval], ebx
.text:00401D81		       xor     eax, eax
.text:00401D83		       mov     esi, [ebp+stream]
.text:00401D86		       cmp     esi, ebx
.text:00401D88		       setnz   al
.text:00401D8B		       cmp     eax, ebx
.text:00401D8D		       jnz     short loc_401DAF
.text:00401D8F
.text:00401D8F loc_401D8F:			       ; CODE XREF: _fprintf+49j
.text:00401D8F		       call    __errno
.text:00401D94		       mov     dword ptr [eax],	16h
.text:00401D9A		       push    ebx	       ; pReserved
.text:00401D9B		       push    ebx	       ; nLine
.text:00401D9C		       push    ebx	       ; pszFile
.text:00401D9D		       push    ebx	       ; pszFunction
.text:00401D9E		       push    ebx	       ; pszExpression
.text:00401D9F		       call    __invalid_parameter
.text:00401DA4		       add     esp, 14h
.text:00401DA7		       or      eax, 0FFFFFFFFh
.text:00401DAA		       jmp     loc_401EAF
.text:00401DAF ; ---------------------------------------------------------------------------
.text:00401DAF
.text:00401DAF loc_401DAF:			       ; CODE XREF: _fprintf+1Dj
.text:00401DAF		       xor     eax, eax
.text:00401DB1		       cmp     [ebp+format], ebx
.text:00401DB4		       setnz   al
.text:00401DB7		       cmp     eax, ebx
.text:00401DB9		       jz      short loc_401D8F
.text:00401DBB		       mov     [ebp+stream], esi
.text:00401DBE		       push    esi	       ; pf
.text:00401DBF		       call    __lock_file
.text:00401DC4		       pop     ecx
.text:00401DC5		       mov     [ebp+ms_exc.disabled], ebx
.text:00401DC8		       test    byte ptr	[esi+0Ch], 40h
.text:00401DCC		       jnz     loc_401E78
.text:00401DD2		       push    esi	       ; stream
.text:00401DD3		       call    __fileno
.text:00401DD8		       pop     ecx
.text:00401DD9		       cmp     eax, 0FFFFFFFFh
.text:00401DDC		       jz      short loc_401E0C
.text:00401DDE		       push    esi	       ; stream
.text:00401DDF		       call    __fileno
.text:00401DE4		       pop     ecx
.text:00401DE5		       cmp     eax, 0FFFFFFFEh
.text:00401DE8		       jz      short loc_401E0C
.text:00401DEA		       push    esi	       ; stream
.text:00401DEB		       call    __fileno
.text:00401DF0		       sar     eax, 5
.text:00401DF3		       lea     edi, ds:423F00h[eax*4]
.text:00401DFA		       push    esi	       ; stream
.text:00401DFB		       call    __fileno
.text:00401E00		       pop     ecx
.text:00401E01		       pop     ecx
.text:00401E02		       and     eax, 1Fh
.text:00401E05		       shl     eax, 6
.text:00401E08		       add     eax, [edi]
.text:00401E0A		       jmp     short loc_401E11
.text:00401E0C ; ---------------------------------------------------------------------------
.text:00401E0C
.text:00401E0C loc_401E0C:			       ; CODE XREF: _fprintf+6Cj
.text:00401E0C					       ; _fprintf+78j
.text:00401E0C		       mov     eax, offset ___badioinfo
.text:00401E11
.text:00401E11 loc_401E11:			       ; CODE XREF: _fprintf+9Aj
.text:00401E11		       test    byte ptr	[eax+24h], 7Fh
.text:00401E15		       jnz     short loc_401E5C
.text:00401E17		       push    esi	       ; stream
.text:00401E18		       call    __fileno
.text:00401E1D		       pop     ecx
.text:00401E1E		       cmp     eax, 0FFFFFFFFh
.text:00401E21		       jz      short loc_401E51
.text:00401E23		       push    esi	       ; stream
.text:00401E24		       call    __fileno
.text:00401E29		       pop     ecx
.text:00401E2A		       cmp     eax, 0FFFFFFFEh
.text:00401E2D		       jz      short loc_401E51
.text:00401E2F		       push    esi	       ; stream
.text:00401E30		       call    __fileno
.text:00401E35		       sar     eax, 5
.text:00401E38		       lea     edi, ds:423F00h[eax*4]
.text:00401E3F		       push    esi	       ; stream
.text:00401E40		       call    __fileno
.text:00401E45		       pop     ecx
.text:00401E46		       pop     ecx
.text:00401E47		       and     eax, 1Fh
.text:00401E4A		       shl     eax, 6
.text:00401E4D		       add     eax, [edi]
.text:00401E4F		       jmp     short loc_401E56
.text:00401E51 ; ---------------------------------------------------------------------------
.text:00401E51
.text:00401E51 loc_401E51:			       ; CODE XREF: _fprintf+B1j
.text:00401E51					       ; _fprintf+BDj
.text:00401E51		       mov     eax, offset ___badioinfo
.text:00401E56
.text:00401E56 loc_401E56:			       ; CODE XREF: _fprintf+DFj
.text:00401E56		       test    byte ptr	[eax+24h], 80h
.text:00401E5A		       jz      short loc_401E78
.text:00401E5C
.text:00401E5C loc_401E5C:			       ; CODE XREF: _fprintf+A5j
.text:00401E5C		       call    __errno
.text:00401E61		       mov     dword ptr [eax],	16h
.text:00401E67		       push    ebx	       ; pReserved
.text:00401E68		       push    ebx	       ; nLine
.text:00401E69		       push    ebx	       ; pszFile
.text:00401E6A		       push    ebx	       ; pszFunction
.text:00401E6B		       push    ebx	       ; pszExpression
.text:00401E6C		       call    __invalid_parameter
.text:00401E71		       add     esp, 14h
.text:00401E74		       or      [ebp+retval], 0FFFFFFFFh
.text:00401E78
.text:00401E78 loc_401E78:			       ; CODE XREF: _fprintf+5Cj
.text:00401E78					       ; _fprintf+EAj
.text:00401E78		       cmp     [ebp+retval], ebx
.text:00401E7B		       jnz     short loc_401EA0
.text:00401E7D		       push    esi	       ; str
.text:00401E7E		       call    __stbuf
.text:00401E83		       mov     edi, eax
.text:00401E85		       lea     eax, [ebp+argptr]
.text:00401E88		       push    eax	       ; argptr
.text:00401E89		       push    ebx	       ; plocinfo
.text:00401E8A		       push    [ebp+format]    ; format
.text:00401E8D		       push    esi	       ; stream
.text:00401E8E		       call    __output_l
.text:00401E93		       mov     [ebp+retval], eax
.text:00401E96		       push    esi	       ; str
.text:00401E97		       push    edi	       ; flag
.text:00401E98		       call    __ftbuf
.text:00401E9D		       add     esp, 1Ch
.text:00401EA0
.text:00401EA0 loc_401EA0:			       ; CODE XREF: _fprintf+10Bj
.text:00401EA0		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00401EA7		       call    $LN16_0
.text:00401EAC
.text:00401EAC $LN19:
.text:00401EAC		       mov     eax, [ebp+retval]
.text:00401EAF
.text:00401EAF loc_401EAF:			       ; CODE XREF: _fprintf+3Aj
.text:00401EAF		       call    __SEH_epilog4
.text:00401EB4		       retn
.text:00401EB5 ; ---------------------------------------------------------------------------
.text:00401EB5
.text:00401EB5 $LN16_0:				       ; CODE XREF: _fprintf+137p
.text:00401EB5					       ; DATA XREF: .rdata:004214C8o
.text:00401EB5		       push    [ebp+stream]    ; pf
.text:00401EB8		       call    __unlock_file
.text:00401EBD		       pop     ecx
.text:00401EBE
.text:00401EBE $LN17:
.text:00401EBE		       retn
.text:00401EBE _fprintf	       endp
.text:00401EBE
.text:00401EBF
.text:00401EBF ; =============== S U B R O U T I N E =======================================
.text:00401EBF
.text:00401EBF
.text:00401EBF ; int __cdecl _fprintf_l(_iobuf *str, const char	*format, localeinfo_struct *plocinfo)
.text:00401EBF __fprintf_l     proc near
.text:00401EBF
.text:00401EBF str	       = dword ptr  4
.text:00401EBF format	       = dword ptr  8
.text:00401EBF plocinfo	       = dword ptr  0Ch
.text:00401EBF ap	       = byte ptr  10h
.text:00401EBF
.text:00401EBF		       lea     eax, [esp+ap]
.text:00401EC3		       push    eax	       ; ap
.text:00401EC4		       push    [esp+4+plocinfo]	; plocinfo
.text:00401EC8		       push    [esp+8+format]  ; format
.text:00401ECC		       push    [esp+0Ch+str]   ; str
.text:00401ED0		       call    __vfprintf_l
.text:00401ED5		       add     esp, 10h
.text:00401ED8		       retn
.text:00401ED8 __fprintf_l     endp
.text:00401ED8
.text:00401ED9
.text:00401ED9 ; =============== S U B R O U T I N E =======================================
.text:00401ED9
.text:00401ED9
.text:00401ED9 ; int __cdecl _fprintf_s_l(_iobuf *str, const char *format, localeinfo_struct *plocinfo)
.text:00401ED9 __fprintf_s_l   proc near
.text:00401ED9
.text:00401ED9 str	       = dword ptr  4
.text:00401ED9 format	       = dword ptr  8
.text:00401ED9 plocinfo	       = dword ptr  0Ch
.text:00401ED9 ap	       = byte ptr  10h
.text:00401ED9
.text:00401ED9		       lea     eax, [esp+ap]
.text:00401EDD		       push    eax	       ; ap
.text:00401EDE		       push    [esp+4+plocinfo]	; plocinfo
.text:00401EE2		       push    [esp+8+format]  ; format
.text:00401EE6		       push    [esp+0Ch+str]   ; str
.text:00401EEA		       call    __vfprintf_s_l
.text:00401EEF		       add     esp, 10h
.text:00401EF2		       retn
.text:00401EF2 __fprintf_s_l   endp
.text:00401EF2
.text:00401EF3
.text:00401EF3 ; =============== S U B R O U T I N E =======================================
.text:00401EF3
.text:00401EF3
.text:00401EF3 ; int __cdecl fprintf_s(_iobuf *str, const char *format)
.text:00401EF3 _fprintf_s      proc near
.text:00401EF3
.text:00401EF3 str	       = dword ptr  4
.text:00401EF3 format	       = dword ptr  8
.text:00401EF3 ap	       = byte ptr  0Ch
.text:00401EF3
.text:00401EF3		       lea     eax, [esp+ap]
.text:00401EF7		       push    eax	       ; ap
.text:00401EF8		       push    0	       ; plocinfo
.text:00401EFA		       push    [esp+8+format]  ; format
.text:00401EFE		       push    [esp+0Ch+str]   ; str
.text:00401F02		       call    __vfprintf_s_l
.text:00401F07		       add     esp, 10h
.text:00401F0A		       retn
.text:00401F0A _fprintf_s      endp
.text:00401F0A
.text:00401F0B
.text:00401F0B ; =============== S U B R O U T I N E =======================================
.text:00401F0B
.text:00401F0B
.text:00401F0B ; int __cdecl _fprintf_p_l(_iobuf *str, const char *format, localeinfo_struct *plocinfo)
.text:00401F0B __fprintf_p_l   proc near
.text:00401F0B
.text:00401F0B str	       = dword ptr  4
.text:00401F0B format	       = dword ptr  8
.text:00401F0B plocinfo	       = dword ptr  0Ch
.text:00401F0B ap	       = byte ptr  10h
.text:00401F0B
.text:00401F0B		       lea     eax, [esp+ap]
.text:00401F0F		       push    eax	       ; ap
.text:00401F10		       push    [esp+4+plocinfo]	; plocinfo
.text:00401F14		       push    [esp+8+format]  ; format
.text:00401F18		       push    [esp+0Ch+str]   ; str
.text:00401F1C		       call    __vfprintf_p_l
.text:00401F21		       add     esp, 10h
.text:00401F24		       retn
.text:00401F24 __fprintf_p_l   endp
.text:00401F24
.text:00401F25
.text:00401F25 ; =============== S U B R O U T I N E =======================================
.text:00401F25
.text:00401F25
.text:00401F25 ; int __cdecl _fprintf_p(_iobuf *str, const char	*format)
.text:00401F25 __fprintf_p     proc near
.text:00401F25
.text:00401F25 str	       = dword ptr  4
.text:00401F25 format	       = dword ptr  8
.text:00401F25 ap	       = byte ptr  0Ch
.text:00401F25
.text:00401F25		       lea     eax, [esp+ap]
.text:00401F29		       push    eax	       ; ap
.text:00401F2A		       push    0	       ; plocinfo
.text:00401F2C		       push    [esp+8+format]  ; format
.text:00401F30		       push    [esp+0Ch+str]   ; str
.text:00401F34		       call    __vfprintf_p_l
.text:00401F39		       add     esp, 10h
.text:00401F3C		       retn
.text:00401F3C __fprintf_p     endp
.text:00401F3C
.text:00401F3D
.text:00401F3D ; =============== S U B R O U T I N E =======================================
.text:00401F3D
.text:00401F3D
.text:00401F3D ; _iobuf	*__cdecl __iob_func()
.text:00401F3D ___iob_func     proc near	       ; CODE XREF: _Insert+27p
.text:00401F3D					       ; _printf:loc_401787p ...
.text:00401F3D		       mov     eax, offset __iob
.text:00401F42		       retn
.text:00401F42 ___iob_func     endp
.text:00401F42
.text:00401F43
.text:00401F43 ; =============== S U B R O U T I N E =======================================
.text:00401F43
.text:00401F43
.text:00401F43 ; int __cdecl __initstdio()
.text:00401F43 ___initstdio    proc near	       ; DATA XREF: .rdata:pinito
.text:00401F43		       mov     eax, __nstream
.text:00401F48		       test    eax, eax
.text:00401F4A		       push    esi
.text:00401F4B		       push    14h
.text:00401F4D		       pop     esi
.text:00401F4E		       jnz     short loc_401F57
.text:00401F50		       mov     eax, 200h
.text:00401F55		       jmp     short loc_401F5D
.text:00401F57 ; ---------------------------------------------------------------------------
.text:00401F57
.text:00401F57 loc_401F57:			       ; CODE XREF: ___initstdio+Bj
.text:00401F57		       cmp     eax, esi
.text:00401F59		       jge     short loc_401F62
.text:00401F5B		       mov     eax, esi
.text:00401F5D
.text:00401F5D loc_401F5D:			       ; CODE XREF: ___initstdio+12j
.text:00401F5D		       mov     __nstream, eax
.text:00401F62
.text:00401F62 loc_401F62:			       ; CODE XREF: ___initstdio+16j
.text:00401F62		       push    4	       ; size
.text:00401F64		       push    eax	       ; count
.text:00401F65		       call    __calloc_crt
.text:00401F6A		       test    eax, eax
.text:00401F6C		       pop     ecx
.text:00401F6D		       pop     ecx
.text:00401F6E		       mov     ___piob,	eax
.text:00401F73		       jnz     short loc_401F93
.text:00401F75		       push    4	       ; size
.text:00401F77		       push    esi	       ; count
.text:00401F78		       mov     __nstream, esi
.text:00401F7E		       call    __calloc_crt
.text:00401F83		       test    eax, eax
.text:00401F85		       pop     ecx
.text:00401F86		       pop     ecx
.text:00401F87		       mov     ___piob,	eax
.text:00401F8C		       jnz     short loc_401F93
.text:00401F8E		       push    1Ah
.text:00401F90		       pop     eax
.text:00401F91		       pop     esi
.text:00401F92		       retn
.text:00401F93 ; ---------------------------------------------------------------------------
.text:00401F93
.text:00401F93 loc_401F93:			       ; CODE XREF: ___initstdio+30j
.text:00401F93					       ; ___initstdio+49j
.text:00401F93		       xor     edx, edx
.text:00401F95		       mov     ecx, offset __iob
.text:00401F9A		       jmp     short loc_401FA1
.text:00401F9C ; ---------------------------------------------------------------------------
.text:00401F9C
.text:00401F9C loc_401F9C:			       ; CODE XREF: ___initstdio+6Dj
.text:00401F9C		       mov     eax, ___piob
.text:00401FA1
.text:00401FA1 loc_401FA1:			       ; CODE XREF: ___initstdio+57j
.text:00401FA1		       mov     [edx+eax], ecx
.text:00401FA4		       add     ecx, 20h
.text:00401FA7		       add     edx, 4
.text:00401FAA		       cmp     ecx, offset ___app_type
.text:00401FB0		       jl      short loc_401F9C
.text:00401FB2		       push    0FFFFFFFEh
.text:00401FB4		       pop     esi
.text:00401FB5		       xor     edx, edx
.text:00401FB7		       mov     ecx, offset dword_422090
.text:00401FBC		       push    edi
.text:00401FBD
.text:00401FBD loc_401FBD:			       ; CODE XREF: ___initstdio+AAj
.text:00401FBD		       mov     eax, edx
.text:00401FBF		       sar     eax, 5
.text:00401FC2		       mov     eax, ___pioinfo[eax*4]
.text:00401FC9		       mov     edi, edx
.text:00401FCB		       and     edi, 1Fh
.text:00401FCE		       shl     edi, 6
.text:00401FD1		       mov     eax, [edi+eax]
.text:00401FD4		       cmp     eax, 0FFFFFFFFh
.text:00401FD7		       jz      short loc_401FE1
.text:00401FD9		       cmp     eax, esi
.text:00401FDB		       jz      short loc_401FE1
.text:00401FDD		       test    eax, eax
.text:00401FDF		       jnz     short loc_401FE3
.text:00401FE1
.text:00401FE1 loc_401FE1:			       ; CODE XREF: ___initstdio+94j
.text:00401FE1					       ; ___initstdio+98j
.text:00401FE1		       mov     [ecx], esi
.text:00401FE3
.text:00401FE3 loc_401FE3:			       ; CODE XREF: ___initstdio+9Cj
.text:00401FE3		       add     ecx, 20h
.text:00401FE6		       inc     edx
.text:00401FE7		       cmp     ecx, offset dword_4220F0
.text:00401FED		       jl      short loc_401FBD
.text:00401FEF		       pop     edi
.text:00401FF0		       xor     eax, eax
.text:00401FF2		       pop     esi
.text:00401FF3		       retn
.text:00401FF3 ___initstdio    endp
.text:00401FF3
.text:00401FF4
.text:00401FF4 ; =============== S U B R O U T I N E =======================================
.text:00401FF4
.text:00401FF4
.text:00401FF4 ___endstdio     proc near	       ; DATA XREF: .rdata:pterm_0o
.text:00401FF4		       call    __flushall
.text:00401FF9		       cmp     __exitflag, 0
.text:00402000		       jz      short loc_402007
.text:00402002		       call    __fcloseall
.text:00402007
.text:00402007 loc_402007:			       ; CODE XREF: ___endstdio+Cj
.text:00402007		       push    ___piob	       ; pBlock
.text:0040200D		       call    _free
.text:00402012		       pop     ecx
.text:00402013		       retn
.text:00402013 ___endstdio     endp
.text:00402013
.text:00402014
.text:00402014 ; =============== S U B R O U T I N E =======================================
.text:00402014
.text:00402014
.text:00402014 ; void __cdecl _lock_file(_iobuf	*pf)
.text:00402014 __lock_file     proc near	       ; CODE XREF: _fprintf+4Fp
.text:00402014					       ; _vprintf_helper+45p ...
.text:00402014
.text:00402014 arg_0	       = dword ptr  4
.text:00402014
.text:00402014		       push    esi
.text:00402015		       mov     esi, [esp+4+arg_0]
.text:00402019		       mov     eax, offset __iob
.text:0040201E		       cmp     esi, eax
.text:00402020		       jb      short loc_402044
.text:00402022		       cmp     esi, offset dword_4222E0
.text:00402028		       ja      short loc_402044
.text:0040202A		       mov     ecx, esi
.text:0040202C		       sub     ecx, eax
.text:0040202E		       sar     ecx, 5
.text:00402031		       add     ecx, 10h
.text:00402034		       push    ecx	       ; locknum
.text:00402035		       call    __lock
.text:0040203A		       or      dword ptr [esi+0Ch], 8000h
.text:00402041		       pop     ecx
.text:00402042		       pop     esi
.text:00402043		       retn
.text:00402044 ; ---------------------------------------------------------------------------
.text:00402044
.text:00402044 loc_402044:			       ; CODE XREF: __lock_file+Cj
.text:00402044					       ; __lock_file+14j
.text:00402044		       add     esi, 20h
.text:00402047		       push    esi	       ; lpCriticalSection
.text:00402048		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:0040204E		       pop     esi
.text:0040204F		       retn
.text:0040204F __lock_file     endp
.text:0040204F
.text:00402050
.text:00402050 ; =============== S U B R O U T I N E =======================================
.text:00402050
.text:00402050
.text:00402050 ; void __cdecl _lock_file2(int i, void *s)
.text:00402050 __lock_file2    proc near	       ; CODE XREF: _printf+44p
.text:00402050					       ; flsall+46p
.text:00402050
.text:00402050 i	       = dword ptr  4
.text:00402050 s	       = dword ptr  8
.text:00402050
.text:00402050		       mov     eax, [esp+i]
.text:00402054		       cmp     eax, 14h
.text:00402057		       jge     short loc_40206F
.text:00402059		       add     eax, 10h
.text:0040205C		       push    eax	       ; locknum
.text:0040205D		       call    __lock
.text:00402062		       mov     eax, [esp+4+s]
.text:00402066		       or      dword ptr [eax+0Ch], 8000h
.text:0040206D		       pop     ecx
.text:0040206E		       retn
.text:0040206F ; ---------------------------------------------------------------------------
.text:0040206F
.text:0040206F loc_40206F:			       ; CODE XREF: __lock_file2+7j
.text:0040206F		       mov     eax, [esp+s]
.text:00402073		       add     eax, 20h
.text:00402076		       push    eax	       ; lpCriticalSection
.text:00402077		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:0040207D		       retn
.text:0040207D __lock_file2    endp
.text:0040207D
.text:0040207E
.text:0040207E ; =============== S U B R O U T I N E =======================================
.text:0040207E
.text:0040207E
.text:0040207E ; void __cdecl _unlock_file(_iobuf *pf)
.text:0040207E __unlock_file   proc near	       ; CODE XREF: _fprintf+148p
.text:0040207E					       ; _vprintf_helper+89p ...
.text:0040207E
.text:0040207E arg_0	       = dword ptr  4
.text:0040207E
.text:0040207E		       mov     eax, [esp+arg_0]
.text:00402082		       mov     ecx, offset __iob
.text:00402087		       cmp     eax, ecx
.text:00402089		       jb      short loc_4020A9
.text:0040208B		       cmp     eax, offset dword_4222E0
.text:00402090		       ja      short loc_4020A9
.text:00402092		       and     dword ptr [eax+0Ch], 0FFFF7FFFh
.text:00402099		       sub     eax, ecx
.text:0040209B		       sar     eax, 5
.text:0040209E		       add     eax, 10h
.text:004020A1		       push    eax	       ; locknum
.text:004020A2		       call    __unlock
.text:004020A7		       pop     ecx
.text:004020A8		       retn
.text:004020A9 ; ---------------------------------------------------------------------------
.text:004020A9
.text:004020A9 loc_4020A9:			       ; CODE XREF: __unlock_file+Bj
.text:004020A9					       ; __unlock_file+12j
.text:004020A9		       add     eax, 20h
.text:004020AC		       push    eax	       ; lpCriticalSection
.text:004020AD		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:004020B3		       retn
.text:004020B3 __unlock_file   endp
.text:004020B3
.text:004020B4
.text:004020B4 ; =============== S U B R O U T I N E =======================================
.text:004020B4
.text:004020B4
.text:004020B4 ; void __cdecl _unlock_file2(int	i, void	*s)
.text:004020B4 __unlock_file2  proc near	       ; CODE XREF: _printf+A7p
.text:004020B4					       ; flsall+ABp
.text:004020B4
.text:004020B4 i	       = dword ptr  4
.text:004020B4 s	       = dword ptr  8
.text:004020B4
.text:004020B4		       mov     ecx, [esp+i]
.text:004020B8		       cmp     ecx, 14h
.text:004020BB		       mov     eax, [esp+s]
.text:004020BF		       jge     short loc_4020D3
.text:004020C1		       and     dword ptr [eax+0Ch], 0FFFF7FFFh
.text:004020C8		       add     ecx, 10h
.text:004020CB		       push    ecx	       ; locknum
.text:004020CC		       call    __unlock
.text:004020D1		       pop     ecx
.text:004020D2		       retn
.text:004020D3 ; ---------------------------------------------------------------------------
.text:004020D3
.text:004020D3 loc_4020D3:			       ; CODE XREF: __unlock_file2+Bj
.text:004020D3		       add     eax, 20h
.text:004020D6		       push    eax	       ; lpCriticalSection
.text:004020D7		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:004020DD		       retn
.text:004020DD __unlock_file2  endp
.text:004020DD
.text:004020DE
.text:004020DE ; =============== S U B R O U T I N E =======================================
.text:004020DE
.text:004020DE ; Attributes: bp-based frame
.text:004020DE
.text:004020DE ; void *__cdecl V6_HeapAlloc(unsigned int size)
.text:004020DE _V6_HeapAlloc   proc near	       ; CODE XREF: __heap_alloc+4Fp
.text:004020DE					       ; _malloc+59p
.text:004020DE
.text:004020DE pvReturn	       = dword ptr -1Ch
.text:004020DE ms_exc	       = CPPEH_RECORD ptr -18h
.text:004020DE size	       = dword ptr  8
.text:004020DE
.text:004020DE		       push    0Ch
.text:004020E0		       push    offset dword_4214D0
.text:004020E5		       call    __SEH_prolog4
.text:004020EA		       and     [ebp+pvReturn], 0
.text:004020EE		       mov     esi, [ebp+size]
.text:004020F1		       cmp     esi, ___sbh_threshold
.text:004020F7		       ja      short $LN9_0
.text:004020F9		       push    4	       ; locknum
.text:004020FB		       call    __lock
.text:00402100		       pop     ecx
.text:00402101		       and     [ebp+ms_exc.disabled], 0
.text:00402105		       push    esi	       ; intSize
.text:00402106		       call    ___sbh_alloc_block
.text:0040210B		       pop     ecx
.text:0040210C		       mov     [ebp+pvReturn], eax
.text:0040210F		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00402116		       call    $LN6_0
.text:0040211B
.text:0040211B $LN9_0:				       ; CODE XREF: _V6_HeapAlloc+19j
.text:0040211B		       mov     eax, [ebp+pvReturn]
.text:0040211E		       call    __SEH_epilog4
.text:00402123		       retn
.text:00402124 ; ---------------------------------------------------------------------------
.text:00402124
.text:00402124 $LN6_0:				       ; CODE XREF: _V6_HeapAlloc+38p
.text:00402124					       ; DATA XREF: .rdata:004214E8o
.text:00402124		       push    4	       ; locknum
.text:00402126		       call    __unlock
.text:0040212B		       pop     ecx
.text:0040212C
.text:0040212C $LN7_0:
.text:0040212C		       retn
.text:0040212C _V6_HeapAlloc   endp
.text:0040212C
.text:0040212D
.text:0040212D ; =============== S U B R O U T I N E =======================================
.text:0040212D
.text:0040212D
.text:0040212D ; void *__cdecl _heap_alloc(unsigned int	size)
.text:0040212D __heap_alloc    proc near
.text:0040212D
.text:0040212D size	       = dword ptr  4
.text:0040212D
.text:0040212D		       cmp     __crtheap, 0
.text:00402134		       jnz     short loc_40214E
.text:00402136		       call    __FF_MSGBANNER
.text:0040213B		       push    1Eh	       ; rterrnum
.text:0040213D		       call    __NMSG_WRITE
.text:00402142		       push    0FFh	       ; status
.text:00402147		       call    ___crtExitProcess
.text:0040214C ; ---------------------------------------------------------------------------
.text:0040214C		       pop     ecx
.text:0040214D		       pop     ecx
.text:0040214E
.text:0040214E loc_40214E:			       ; CODE XREF: __heap_alloc+7j
.text:0040214E		       mov     eax, ___active_heap
.text:00402153		       cmp     eax, 1
.text:00402156		       jnz     short loc_402171
.text:00402158		       mov     eax, [esp+size]
.text:0040215C		       test    eax, eax
.text:0040215E		       jnz     short loc_402161
.text:00402160		       inc     eax
.text:00402161
.text:00402161 loc_402161:			       ; CODE XREF: __heap_alloc+31j
.text:00402161		       push    eax	       ; dwBytes
.text:00402162		       push    0	       ; dwFlags
.text:00402164		       push    __crtheap       ; hHeap
.text:0040216A		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:00402170		       retn
.text:00402171 ; ---------------------------------------------------------------------------
.text:00402171
.text:00402171 loc_402171:			       ; CODE XREF: __heap_alloc+29j
.text:00402171		       cmp     eax, 3
.text:00402174		       push    esi
.text:00402175		       mov     esi, [esp+4+size]
.text:00402179		       jnz     short loc_402186
.text:0040217B		       push    esi	       ; size
.text:0040217C		       call    _V6_HeapAlloc
.text:00402181		       test    eax, eax
.text:00402183		       pop     ecx
.text:00402184		       jnz     short loc_4021A0
.text:00402186
.text:00402186 loc_402186:			       ; CODE XREF: __heap_alloc+4Cj
.text:00402186		       test    esi, esi
.text:00402188		       jnz     short loc_40218B
.text:0040218A		       inc     esi
.text:0040218B
.text:0040218B loc_40218B:			       ; CODE XREF: __heap_alloc+5Bj
.text:0040218B		       add     esi, 0Fh
.text:0040218E		       and     esi, 0FFFFFFF0h
.text:00402191		       push    esi	       ; dwBytes
.text:00402192		       push    0	       ; dwFlags
.text:00402194		       push    __crtheap       ; hHeap
.text:0040219A		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:004021A0
.text:004021A0 loc_4021A0:			       ; CODE XREF: __heap_alloc+57j
.text:004021A0		       pop     esi
.text:004021A1		       retn
.text:004021A1 __heap_alloc    endp
.text:004021A1
.text:004021A2
.text:004021A2 ; =============== S U B R O U T I N E =======================================
.text:004021A2
.text:004021A2
.text:004021A2 ; void *__cdecl malloc(unsigned int size)
.text:004021A2 _malloc	       proc near	       ; CODE XREF: _Insert+Cp
.text:004021A2					       ; __malloc_crt+8p ...
.text:004021A2
.text:004021A2 size	       = dword ptr  4
.text:004021A2
.text:004021A2		       push    ebp
.text:004021A3		       mov     ebp, [esp+4+size]
.text:004021A7		       cmp     ebp, 0FFFFFFE0h
.text:004021AA		       ja      loc_40224F
.text:004021B0		       push    ebx
.text:004021B1		       mov     ebx, ds:__imp__HeapAlloc@12 ; HeapAlloc(x,x,x)
.text:004021B7		       push    esi
.text:004021B8		       push    edi
.text:004021B9
.text:004021B9 loc_4021B9:			       ; CODE XREF: _malloc+94j
.text:004021B9		       xor     esi, esi
.text:004021BB		       cmp     __crtheap, esi
.text:004021C1		       mov     edi, ebp
.text:004021C3		       jnz     short loc_4021DD
.text:004021C5		       call    __FF_MSGBANNER
.text:004021CA		       push    1Eh	       ; rterrnum
.text:004021CC		       call    __NMSG_WRITE
.text:004021D1		       push    0FFh	       ; status
.text:004021D6		       call    ___crtExitProcess
.text:004021DB ; ---------------------------------------------------------------------------
.text:004021DB		       pop     ecx
.text:004021DC		       pop     ecx
.text:004021DD
.text:004021DD loc_4021DD:			       ; CODE XREF: _malloc+21j
.text:004021DD		       mov     eax, ___active_heap
.text:004021E2		       cmp     eax, 1
.text:004021E5		       jnz     short loc_4021F5
.text:004021E7		       cmp     ebp, esi
.text:004021E9		       jz      short loc_4021EF
.text:004021EB		       mov     eax, ebp
.text:004021ED		       jmp     short loc_4021F2
.text:004021EF ; ---------------------------------------------------------------------------
.text:004021EF
.text:004021EF loc_4021EF:			       ; CODE XREF: _malloc+47j
.text:004021EF		       xor     eax, eax
.text:004021F1		       inc     eax
.text:004021F2
.text:004021F2 loc_4021F2:			       ; CODE XREF: _malloc+4Bj
.text:004021F2		       push    eax
.text:004021F3		       jmp     short loc_402213
.text:004021F5 ; ---------------------------------------------------------------------------
.text:004021F5
.text:004021F5 loc_4021F5:			       ; CODE XREF: _malloc+43j
.text:004021F5		       cmp     eax, 3
.text:004021F8		       jnz     short loc_402205
.text:004021FA		       push    ebp	       ; size
.text:004021FB		       call    _V6_HeapAlloc
.text:00402200		       cmp     eax, esi
.text:00402202		       pop     ecx
.text:00402203		       jnz     short loc_40221C
.text:00402205
.text:00402205 loc_402205:			       ; CODE XREF: _malloc+56j
.text:00402205		       cmp     ebp, esi
.text:00402207		       jnz     short loc_40220C
.text:00402209		       xor     edi, edi
.text:0040220B		       inc     edi
.text:0040220C
.text:0040220C loc_40220C:			       ; CODE XREF: _malloc+65j
.text:0040220C		       add     edi, 0Fh
.text:0040220F		       and     edi, 0FFFFFFF0h
.text:00402212		       push    edi	       ; dwBytes
.text:00402213
.text:00402213 loc_402213:			       ; CODE XREF: _malloc+51j
.text:00402213		       push    esi	       ; dwFlags
.text:00402214		       push    __crtheap       ; hHeap
.text:0040221A		       call    ebx ; HeapAlloc(x,x,x) ;	HeapAlloc(x,x,x)
.text:0040221C
.text:0040221C loc_40221C:			       ; CODE XREF: _malloc+61j
.text:0040221C		       mov     esi, eax
.text:0040221E		       test    esi, esi
.text:00402220		       jnz     short loc_402248
.text:00402222		       cmp     __newmode, eax
.text:00402228		       push    0Ch
.text:0040222A		       pop     edi
.text:0040222B		       jz      short loc_40223A
.text:0040222D		       push    ebp	       ; size
.text:0040222E		       call    __callnewh
.text:00402233		       test    eax, eax
.text:00402235		       pop     ecx
.text:00402236		       jnz     short loc_4021B9
.text:00402238		       jmp     short loc_402241
.text:0040223A ; ---------------------------------------------------------------------------
.text:0040223A
.text:0040223A loc_40223A:			       ; CODE XREF: _malloc+89j
.text:0040223A		       call    __errno
.text:0040223F		       mov     [eax], edi
.text:00402241
.text:00402241 loc_402241:			       ; CODE XREF: _malloc+96j
.text:00402241		       call    __errno
.text:00402246		       mov     [eax], edi
.text:00402248
.text:00402248 loc_402248:			       ; CODE XREF: _malloc+7Ej
.text:00402248		       pop     edi
.text:00402249		       mov     eax, esi
.text:0040224B		       pop     esi
.text:0040224C		       pop     ebx
.text:0040224D		       pop     ebp
.text:0040224E		       retn
.text:0040224F ; ---------------------------------------------------------------------------
.text:0040224F
.text:0040224F loc_40224F:			       ; CODE XREF: _malloc+8j
.text:0040224F		       push    ebp	       ; size
.text:00402250		       call    __callnewh
.text:00402255		       pop     ecx
.text:00402256		       call    __errno
.text:0040225B		       mov     dword ptr [eax],	0Ch
.text:00402261		       xor     eax, eax
.text:00402263		       pop     ebp
.text:00402264		       retn
.text:00402264 _malloc	       endp
.text:00402264
.text:00402265
.text:00402265 ; =============== S U B R O U T I N E =======================================
.text:00402265
.text:00402265
.text:00402265 ; void __cdecl _set_osplatform(unsigned int _Value)
.text:00402265 __set_osplatform	proc near
.text:00402265
.text:00402265 _Value	       = dword ptr  4
.text:00402265
.text:00402265		       mov     eax, [esp+_Value]
.text:00402269		       mov     __osplatform, eax
.text:0040226E		       retn
.text:0040226E __set_osplatform	endp
.text:0040226E
.text:0040226F
.text:0040226F ; =============== S U B R O U T I N E =======================================
.text:0040226F
.text:0040226F
.text:0040226F ; void __cdecl _set_osver(unsigned int _Value)
.text:0040226F __set_osver     proc near
.text:0040226F
.text:0040226F _Value	       = dword ptr  4
.text:0040226F
.text:0040226F		       mov     eax, [esp+_Value]
.text:00402273		       mov     __osver,	eax
.text:00402278		       retn
.text:00402278 __set_osver     endp
.text:00402278
.text:00402279
.text:00402279 ; =============== S U B R O U T I N E =======================================
.text:00402279
.text:00402279
.text:00402279 ; void __cdecl _set_winver(unsigned int _Value)
.text:00402279 __set_winver    proc near
.text:00402279
.text:00402279 _Value	       = dword ptr  4
.text:00402279
.text:00402279		       mov     eax, [esp+_Value]
.text:0040227D		       mov     __winver, eax
.text:00402282		       retn
.text:00402282 __set_winver    endp
.text:00402282
.text:00402283
.text:00402283 ; =============== S U B R O U T I N E =======================================
.text:00402283
.text:00402283
.text:00402283 ; void __cdecl _set_winmajor(unsigned int _Value)
.text:00402283 __set_winmajor  proc near
.text:00402283
.text:00402283 _Value	       = dword ptr  4
.text:00402283
.text:00402283		       mov     eax, [esp+_Value]
.text:00402287		       mov     __winmajor, eax
.text:0040228C		       retn
.text:0040228C __set_winmajor  endp
.text:0040228C
.text:0040228D
.text:0040228D ; =============== S U B R O U T I N E =======================================
.text:0040228D
.text:0040228D
.text:0040228D ; void __cdecl _set_winminor(unsigned int _Value)
.text:0040228D __set_winminor  proc near
.text:0040228D
.text:0040228D _Value	       = dword ptr  4
.text:0040228D
.text:0040228D		       mov     eax, [esp+_Value]
.text:00402291		       mov     __winminor, eax
.text:00402296		       retn
.text:00402296 __set_winminor  endp
.text:00402296
.text:00402297
.text:00402297 ; =============== S U B R O U T I N E =======================================
.text:00402297
.text:00402297 ; Attributes: noreturn
.text:00402297
.text:00402297 ; void __cdecl fast_error_exit(int rterrnum)
.text:00402297 fast_error_exit proc near	       ; CODE XREF: __tmainCRTStartup+2Bp
.text:00402297					       ; __tmainCRTStartup+C8p	...
.text:00402297
.text:00402297 rterrnum	       = dword ptr  4
.text:00402297
.text:00402297		       cmp     ___error_mode, 2
.text:0040229E		       jz      short loc_4022A5
.text:004022A0		       call    __FF_MSGBANNER
.text:004022A5
.text:004022A5 loc_4022A5:			       ; CODE XREF: fast_error_exit+7j
.text:004022A5		       push    [esp+rterrnum]  ; rterrnum
.text:004022A9		       call    __NMSG_WRITE
.text:004022AE		       push    0FFh	       ; status
.text:004022B3		       call    ___crtExitProcess
.text:004022B8 ; ---------------------------------------------------------------------------
.text:004022B8		       pop     ecx
.text:004022B9		       pop     ecx
.text:004022BA		       retn
.text:004022BA fast_error_exit endp
.text:004022BA
.text:004022BB
.text:004022BB ; =============== S U B R O U T I N E =======================================
.text:004022BB
.text:004022BB
.text:004022BB ; int __cdecl check_managed_app()
.text:004022BB check_managed_app proc near	       ; CODE XREF: __tmainCRTStartup+B2p
.text:004022BB		       cmp     word ptr	ds:400000h, 5A4Dh
.text:004022C4		       jnz     short loc_4022F9
.text:004022C6		       mov     eax, ds:40003Ch
.text:004022CB		       cmp     dword ptr [eax+400000h],	4550h
.text:004022D5		       jnz     short loc_4022F9
.text:004022D7		       cmp     word ptr	[eax+400018h], 10Bh
.text:004022E0		       jnz     short loc_4022F9
.text:004022E2		       cmp     dword ptr [eax+400074h],	0Eh
.text:004022E9		       jbe     short loc_4022F9
.text:004022EB		       xor     ecx, ecx
.text:004022ED		       cmp     [eax+4000E8h], ecx
.text:004022F3		       setnz   cl
.text:004022F6		       mov     eax, ecx
.text:004022F8		       retn
.text:004022F9 ; ---------------------------------------------------------------------------
.text:004022F9
.text:004022F9 loc_4022F9:			       ; CODE XREF: check_managed_app+9j
.text:004022F9					       ; check_managed_app+1Aj	...
.text:004022F9		       xor     eax, eax
.text:004022FB		       retn
.text:004022FB check_managed_app endp
.text:004022FB
.text:004022FC ; [000001B6 BYTES: COLLAPSED FUNCTION __tmainCRTStartup.	PRESS KEYPAD "+" TO EXPAND]
.text:004024B2 ; [0000000A BYTES: COLLAPSED FUNCTION _mainCRTStartup. PRESS KEYPAD "+" TO EXPAND]
.text:004024BC
.text:004024BC ; =============== S U B R O U T I N E =======================================
.text:004024BC
.text:004024BC
.text:004024BC ; int __cdecl _stbuf(_iobuf *str)
.text:004024BC __stbuf	       proc near	       ; CODE XREF: _printf+56p
.text:004024BC					       ; _fprintf+10Ep	...
.text:004024BC
.text:004024BC str	       = dword ptr  4
.text:004024BC
.text:004024BC		       push    esi
.text:004024BD		       mov     esi, [esp+4+str]
.text:004024C1		       push    esi	       ; stream
.text:004024C2		       call    __fileno
.text:004024C7		       push    eax	       ; fh
.text:004024C8		       call    __isatty
.text:004024CD		       test    eax, eax
.text:004024CF		       pop     ecx
.text:004024D0		       pop     ecx
.text:004024D1		       jz      short loc_40254E
.text:004024D3		       call    ___iob_func
.text:004024D8		       add     eax, 20h
.text:004024DB		       cmp     esi, eax
.text:004024DD		       jnz     short loc_4024E3
.text:004024DF		       xor     eax, eax
.text:004024E1		       jmp     short loc_4024F2
.text:004024E3 ; ---------------------------------------------------------------------------
.text:004024E3
.text:004024E3 loc_4024E3:			       ; CODE XREF: __stbuf+21j
.text:004024E3		       call    ___iob_func
.text:004024E8		       add     eax, 40h
.text:004024EB		       cmp     esi, eax
.text:004024ED		       jnz     short loc_40254E
.text:004024EF		       xor     eax, eax
.text:004024F1		       inc     eax
.text:004024F2
.text:004024F2 loc_4024F2:			       ; CODE XREF: __stbuf+25j
.text:004024F2		       inc     __cflush
.text:004024F8		       test    word ptr	[esi+0Ch], 10Ch
.text:004024FE		       jnz     short loc_40254E
.text:00402500		       push    ebx
.text:00402501		       push    edi
.text:00402502		       lea     edi, ds:42345Ch[eax*4]
.text:00402509		       cmp     dword ptr [edi],	0
.text:0040250C		       mov     ebx, 1000h
.text:00402511		       jnz     short loc_402533
.text:00402513		       push    ebx	       ; cb
.text:00402514		       call    __malloc_crt
.text:00402519		       test    eax, eax
.text:0040251B		       pop     ecx
.text:0040251C		       mov     [edi], eax
.text:0040251E		       jnz     short loc_402533
.text:00402520		       lea     eax, [esi+14h]
.text:00402523		       push    2
.text:00402525		       mov     [esi+8],	eax
.text:00402528		       mov     [esi], eax
.text:0040252A		       pop     eax
.text:0040252B		       mov     [esi+18h], eax
.text:0040252E		       mov     [esi+4],	eax
.text:00402531		       jmp     short loc_402540
.text:00402533 ; ---------------------------------------------------------------------------
.text:00402533
.text:00402533 loc_402533:			       ; CODE XREF: __stbuf+55j
.text:00402533					       ; __stbuf+62j
.text:00402533		       mov     edi, [edi]
.text:00402535		       mov     [esi+8],	edi
.text:00402538		       mov     [esi], edi
.text:0040253A		       mov     [esi+18h], ebx
.text:0040253D		       mov     [esi+4],	ebx
.text:00402540
.text:00402540 loc_402540:			       ; CODE XREF: __stbuf+75j
.text:00402540		       or      dword ptr [esi+0Ch], 1102h
.text:00402547		       pop     edi
.text:00402548		       xor     eax, eax
.text:0040254A		       pop     ebx
.text:0040254B		       inc     eax
.text:0040254C		       pop     esi
.text:0040254D		       retn
.text:0040254E ; ---------------------------------------------------------------------------
.text:0040254E
.text:0040254E loc_40254E:			       ; CODE XREF: __stbuf+15j
.text:0040254E					       ; __stbuf+31j ...
.text:0040254E		       xor     eax, eax
.text:00402550		       pop     esi
.text:00402551		       retn
.text:00402551 __stbuf	       endp
.text:00402551
.text:00402552
.text:00402552 ; =============== S U B R O U T I N E =======================================
.text:00402552
.text:00402552
.text:00402552 ; void __cdecl _ftbuf(int flag, _iobuf *str)
.text:00402552 __ftbuf	       proc near	       ; CODE XREF: _printf+7Fp
.text:00402552					       ; _fprintf+128p	...
.text:00402552
.text:00402552 flag	       = dword ptr  4
.text:00402552 str	       = dword ptr  8
.text:00402552
.text:00402552		       cmp     [esp+flag], 0
.text:00402557		       jz      short locret_402580
.text:00402559		       push    esi
.text:0040255A		       mov     esi, [esp+4+str]
.text:0040255E		       test    word ptr	[esi+0Ch], 1000h
.text:00402564		       jz      short loc_40257F
.text:00402566		       push    esi	       ; str
.text:00402567		       call    __flush
.text:0040256C		       and     dword ptr [esi+0Ch], 0FFFFEEFFh
.text:00402573		       and     dword ptr [esi+18h], 0
.text:00402577		       and     dword ptr [esi],	0
.text:0040257A		       and     dword ptr [esi+8], 0
.text:0040257E		       pop     ecx
.text:0040257F
.text:0040257F loc_40257F:			       ; CODE XREF: __ftbuf+12j
.text:0040257F		       pop     esi
.text:00402580
.text:00402580 locret_402580:			       ; CODE XREF: __ftbuf+5j
.text:00402580		       retn
.text:00402580 __ftbuf	       endp
.text:00402580
.text:00402581
.text:00402581 ; =============== S U B R O U T I N E =======================================
.text:00402581
.text:00402581
.text:00402581 ; void __thiscall _LocaleUpdate___LocaleUpdate(_LocaleUpdate *this, localeinfo_struct *plocinfo)
.text:00402581 ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z proc near
.text:00402581					       ; CODE XREF: __output_l+56p
.text:00402581					       ; getSystemCP+Dp ...
.text:00402581
.text:00402581 plocinfo	       = dword ptr  4
.text:00402581
.text:00402581 this = ecx
.text:00402581		       mov     eax, [esp+plocinfo]
.text:00402585		       test    eax, eax
.text:00402587		       push    esi
.text:00402588		       mov     esi, this
.text:0040258A		       mov     byte ptr	[esi+0Ch], 0
.text:0040258E		       jnz     short loc_4025F3
.text:00402590		       call    __getptd
.text:00402595		       mov     [esi+8],	eax
.text:00402598		       mov     this, [eax+6Ch]
.text:0040259B		       mov     [esi], this
.text:0040259D		       mov     this, [eax+68h]
.text:004025A0		       mov     [esi+4],	this
.text:004025A3		       mov     this, [esi]
.text:004025A5		       cmp     this, ___ptlocinfo ; ___ptlocinfo
.text:004025AB		       jz      short loc_4025BF
.text:004025AD		       mov     this, ___globallocalestatus
.text:004025B3		       test    [eax+70h], this
.text:004025B6		       jnz     short loc_4025BF
.text:004025B8		       call    ___updatetlocinfo
.text:004025BD		       mov     [esi], eax
.text:004025BF
.text:004025BF loc_4025BF:			       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+2Aj
.text:004025BF					       ; _LocaleUpdate::_LocaleUpdate(localeinfo_struct	*)+35j
.text:004025BF		       mov     eax, [esi+4]
.text:004025C2		       cmp     eax, ___ptmbcinfo ; ___ptmbcinfo
.text:004025C8		       jz      short loc_4025E0
.text:004025CA		       mov     eax, [esi+8]
.text:004025CD		       mov     this, ___globallocalestatus
.text:004025D3		       test    [eax+70h], this
.text:004025D6		       jnz     short loc_4025E0
.text:004025D8		       call    ___updatetmbcinfo
.text:004025DD		       mov     [esi+4],	eax
.text:004025E0
.text:004025E0 loc_4025E0:			       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+47j
.text:004025E0					       ; _LocaleUpdate::_LocaleUpdate(localeinfo_struct	*)+55j
.text:004025E0		       mov     eax, [esi+8]
.text:004025E3		       test    byte ptr	[eax+70h], 2
.text:004025E7		       jnz     short loc_4025FD
.text:004025E9		       or      dword ptr [eax+70h], 2
.text:004025ED		       mov     byte ptr	[esi+0Ch], 1
.text:004025F1		       jmp     short loc_4025FD
.text:004025F3 ; ---------------------------------------------------------------------------
.text:004025F3
.text:004025F3 loc_4025F3:			       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+Dj
.text:004025F3		       mov     this, [eax]
.text:004025F5		       mov     [esi], this
.text:004025F7		       mov     eax, [eax+4]
.text:004025FA		       mov     [esi+4],	eax
.text:004025FD
.text:004025FD loc_4025FD:			       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+66j
.text:004025FD					       ; _LocaleUpdate::_LocaleUpdate(localeinfo_struct	*)+70j
.text:004025FD		       mov     eax, esi
.text:004025FF		       pop     esi
.text:00402600		       retn    4
.text:00402600 ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z endp
.text:00402600
.text:00402603
.text:00402603 ; =============== S U B R O U T I N E =======================================
.text:00402603
.text:00402603
.text:00402603 ; void __thiscall _LocaleUpdate____LocaleUpdate(_LocaleUpdate *this)
.text:00402603 ??1_LocaleUpdate@@QAE@XZ	proc near
.text:00402603 this = ecx
.text:00402603		       cmp     byte ptr	[this+0Ch], 0
.text:00402607		       jz      short locret_402610
.text:00402609		       mov     eax, [this+8]
.text:0040260C		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00402610
.text:00402610 locret_402610:			       ; CODE XREF: _LocaleUpdate::~_LocaleUpdate(void)+4j
.text:00402610		       retn
.text:00402610 ??1_LocaleUpdate@@QAE@XZ	endp
.text:00402610
.text:00402611
.text:00402611 ; =============== S U B R O U T I N E =======================================
.text:00402611
.text:00402611
.text:00402611 ; localeinfo_struct *__thiscall _LocaleUpdate__GetLocaleT(_LocaleUpdate *this)
.text:00402611 ?GetLocaleT@_LocaleUpdate@@QAEPAUlocaleinfo_struct@@XZ proc near
.text:00402611 this = ecx
.text:00402611		       mov     eax, this
.text:00402613		       retn
.text:00402613 ?GetLocaleT@_LocaleUpdate@@QAEPAUlocaleinfo_struct@@XZ endp
.text:00402613
.text:00402614
.text:00402614 ; =============== S U B R O U T I N E =======================================
.text:00402614
.text:00402614
.text:00402614 ; void __usercall write_char(char ch<al>, _iobuf	*f<ecx>, int *pnumwritten<esi>)
.text:00402614 write_char      proc near	       ; CODE XREF: write_multi_char+11p
.text:00402614					       ; write_string+22p ...
.text:00402614 f = ecx
.text:00402614 pnumwritten = esi
.text:00402614		       test    byte ptr	[f+0Ch], 40h
.text:00402618		       jz      short loc_402620
.text:0040261A		       cmp     dword ptr [f+8],	0
.text:0040261E		       jz      short loc_402644
.text:00402620
.text:00402620 loc_402620:			       ; CODE XREF: write_char+4j
.text:00402620		       dec     dword ptr [f+4]
.text:00402623		       js      short loc_402630
.text:00402625		       mov     edx, [f]
.text:00402627		       mov     [edx], al
.text:00402629		       inc     dword ptr [f]
.text:0040262B		       movzx   eax, al
.text:0040262E		       jmp     short loc_40263C
.text:00402630 ; ---------------------------------------------------------------------------
.text:00402630
.text:00402630 loc_402630:			       ; CODE XREF: write_char+Fj
.text:00402630		       movsx   eax, al
.text:00402633		       push    f	       ; str
.text:00402634		       push    eax	       ; ch
.text:00402635		       call    __flsbuf
.text:0040263A		       pop     f
.text:0040263B		       pop     f
.text:0040263C
.text:0040263C loc_40263C:			       ; CODE XREF: write_char+1Aj
.text:0040263C		       cmp     eax, 0FFFFFFFFh
.text:0040263F		       jnz     short loc_402644
.text:00402641		       or      [pnumwritten], eax
.text:00402643		       retn
.text:00402644 ; ---------------------------------------------------------------------------
.text:00402644
.text:00402644 loc_402644:			       ; CODE XREF: write_char+Aj
.text:00402644					       ; write_char+2Bj
.text:00402644		       inc     dword ptr [pnumwritten]
.text:00402646		       retn
.text:00402646 write_char      endp
.text:00402646
.text:00402647
.text:00402647 ; =============== S U B R O U T I N E =======================================
.text:00402647
.text:00402647 ; Attributes: bp-based frame
.text:00402647
.text:00402647 ; void __usercall write_multi_char(char ch, int num, _iobuf *f, int *pnumwritten<eax>)
.text:00402647 write_multi_char	proc near	       ; CODE XREF: __output_l+852p
.text:00402647					       ; __output_l+87Fp ...
.text:00402647
.text:00402647 arg_0	       = byte ptr  8
.text:00402647 num	       = dword ptr  0Ch
.text:00402647 f	       = dword ptr  10h
.text:00402647
.text:00402647 pnumwritten = eax
.text:00402647		       push    ebp
.text:00402648		       mov     ebp, esp
.text:0040264A		       push    esi
.text:0040264B		       mov     esi, pnumwritten	; pnumwritten
.text:0040264D		       jmp     short loc_402662
.text:0040264F ; ---------------------------------------------------------------------------
.text:0040264F
.text:0040264F loc_40264F:			       ; CODE XREF: write_multi_char+1Fj
.text:0040264F		       mov     ecx, [ebp+f]    ; f
.text:00402652		       mov     al, [ebp+arg_0] ; ch
.text:00402655		       dec     [ebp+num]
.text:00402658		       call    write_char
.text:0040265D		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00402660		       jz      short loc_402668
.text:00402662
.text:00402662 loc_402662:			       ; CODE XREF: write_multi_char+6j
.text:00402662		       cmp     [ebp+num], 0
.text:00402666		       jg      short loc_40264F
.text:00402668
.text:00402668 loc_402668:			       ; CODE XREF: write_multi_char+19j
.text:00402668		       pop     esi
.text:00402669		       pop     ebp
.text:0040266A		       retn
.text:0040266A write_multi_char	endp
.text:0040266A
.text:0040266B
.text:0040266B ; =============== S U B R O U T I N E =======================================
.text:0040266B
.text:0040266B
.text:0040266B ; void __usercall write_string(char *string<ecx>, int len, _iobuf *f<edi>, int *pnumwritten<eax>)
.text:0040266B write_string    proc near	       ; CODE XREF: __output_l+866p
.text:0040266B					       ; __output_l+8CDp ...
.text:0040266B
.text:0040266B len	       = dword ptr  4
.text:0040266B
.text:0040266B string =	ecx
.text:0040266B f = edi
.text:0040266B pnumwritten = eax
.text:0040266B		       test    byte ptr	[f+0Ch], 40h
.text:0040266F		       push    ebx
.text:00402670		       push    esi
.text:00402671		       mov     esi, pnumwritten	; pnumwritten
.text:00402673		       mov     ebx, string
.text:00402675		       jz      short loc_4026AB
.text:00402677		       cmp     dword ptr [f+8],	0
.text:0040267B		       jnz     short loc_4026AB
.text:0040267D		       mov     pnumwritten, [esp+8+len]
.text:00402681		       add     [esi], pnumwritten
.text:00402683		       jmp     short loc_4026B2
.text:00402685 ; ---------------------------------------------------------------------------
.text:00402685
.text:00402685 loc_402685:			       ; CODE XREF: write_string+45j
.text:00402685		       mov     al, [ebx]       ; ch
.text:00402687		       dec     [esp+8+len]
.text:0040268B		       mov     string, f       ; f
.text:0040268D		       call    write_char
.text:00402692		       inc     ebx
.text:00402693		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00402696		       jnz     short loc_4026AB
.text:00402698		       call    __errno
.text:0040269D		       cmp     dword ptr [pnumwritten],	2Ah
.text:004026A0		       jnz     short loc_4026B2
.text:004026A2		       mov     string, f       ; f
.text:004026A4		       mov     al, 3Fh	       ; ch
.text:004026A6		       call    write_char
.text:004026AB
.text:004026AB loc_4026AB:			       ; CODE XREF: write_string+Aj
.text:004026AB					       ; write_string+10j ...
.text:004026AB		       cmp     [esp+8+len], 0
.text:004026B0		       jg      short loc_402685
.text:004026B2
.text:004026B2 loc_4026B2:			       ; CODE XREF: write_string+18j
.text:004026B2					       ; write_string+35j
.text:004026B2		       pop     esi
.text:004026B3		       pop     ebx
.text:004026B4		       retn
.text:004026B4 write_string    endp
.text:004026B4
.text:004026B5
.text:004026B5 ; =============== S U B R O U T I N E =======================================
.text:004026B5
.text:004026B5
.text:004026B5 ; int __cdecl get_int_arg(char **pargptr)
.text:004026B5 _get_int_arg    proc near
.text:004026B5
.text:004026B5 pargptr	       = dword ptr  4
.text:004026B5
.text:004026B5		       mov     eax, [esp+pargptr]
.text:004026B9		       add     dword ptr [eax],	4
.text:004026BC		       mov     eax, [eax]
.text:004026BE		       mov     eax, [eax-4]
.text:004026C1		       retn
.text:004026C1 _get_int_arg    endp
.text:004026C1
.text:004026C2
.text:004026C2 ; =============== S U B R O U T I N E =======================================
.text:004026C2
.text:004026C2
.text:004026C2 ; __int64 __cdecl get_int64_arg(char **pargptr)
.text:004026C2 _get_int64_arg  proc near
.text:004026C2
.text:004026C2 pargptr	       = dword ptr  4
.text:004026C2
.text:004026C2		       mov     eax, [esp+pargptr]
.text:004026C6		       add     dword ptr [eax],	8
.text:004026C9		       mov     ecx, [eax]
.text:004026CB		       mov     eax, [ecx-8]
.text:004026CE		       mov     edx, [ecx-4]
.text:004026D1		       retn
.text:004026D1 _get_int64_arg  endp
.text:004026D1
.text:004026D2
.text:004026D2 ; =============== S U B R O U T I N E =======================================
.text:004026D2
.text:004026D2
.text:004026D2 ; __int16 __cdecl get_short_arg(char **pargptr)
.text:004026D2 _get_short_arg  proc near
.text:004026D2
.text:004026D2 pargptr	       = dword ptr  4
.text:004026D2
.text:004026D2		       mov     eax, [esp+pargptr]
.text:004026D6		       add     dword ptr [eax],	4
.text:004026D9		       mov     eax, [eax]
.text:004026DB		       mov     ax, [eax-4]
.text:004026DF		       retn
.text:004026DF _get_short_arg  endp
.text:004026DF
.text:004026E0
.text:004026E0 ; =============== S U B R O U T I N E =======================================
.text:004026E0
.text:004026E0 ; Attributes: bp-based frame fpd=1F8h
.text:004026E0
.text:004026E0 ; int __cdecl _output_l(_iobuf *stream, const char *format, localeinfo_struct *plocinfo,	char *argptr)
.text:004026E0 __output_l      proc near	       ; CODE XREF: _printf+6Ep
.text:004026E0					       ; _fprintf+11Ep
.text:004026E0					       ; DATA XREF: ...
.text:004026E0
.text:004026E0 tmp	       = _CRT_DOUBLE ptr -278h
.text:004026E0 capexp	       = dword ptr -270h
.text:004026E0 state	       = dword ptr -26Ch
.text:004026E0 retval	       = dword ptr -268h
.text:004026E0 count	       = dword ptr -260h
.text:004026E0 _loc_update     = _LocaleUpdate ptr -25Ch
.text:004026E0 heapbuf	       = dword ptr -24Ch
.text:004026E0 no_output       = dword ptr -248h
.text:004026E0 hexadd	       = dword ptr -244h
.text:004026E0 var_240	       = dword ptr -240h
.text:004026E0 bufferiswide    = dword ptr -23Ch
.text:004026E0 fldwidth	       = dword ptr -238h
.text:004026E0 prefixlen       = dword ptr -234h
.text:004026E0 prefix	       = byte ptr -230h
.text:004026E0 charsout	       = dword ptr -22Ch
.text:004026E0 f	       = dword ptr -228h
.text:004026E0 var_224	       = dword ptr -224h
.text:004026E0 radix	       = dword ptr -220h
.text:004026E0 text	       = $12F061FBE778B92DEB8200A0ACF7A038 ptr -21Ch
.text:004026E0 precision       = dword ptr -218h
.text:004026E0 var_211	       = byte ptr -211h
.text:004026E0 flags	       = dword ptr -210h
.text:004026E0 buffer	       = $C8014B43F160BFD769FAE3F15553333C ptr -20Ch
.text:004026E0 L_buffer	       = byte ptr -0Ch
.text:004026E0 var_4	       = dword ptr -4
.text:004026E0 stream	       = dword ptr  8
.text:004026E0 format	       = dword ptr  0Ch
.text:004026E0 plocinfo	       = dword ptr  10h
.text:004026E0 argptr	       = dword ptr  14h
.text:004026E0
.text:004026E0		       push    ebp
.text:004026E1		       lea     ebp, [esp-1F8h]
.text:004026E8		       sub     esp, 278h
.text:004026EE		       mov     eax, ___security_cookie
.text:004026F3		       xor     eax, ebp
.text:004026F5		       mov     [ebp+1F8h+var_4], eax
.text:004026FB		       mov     eax, [ebp+1F8h+stream]
.text:00402701		       push    ebx
.text:00402702		       mov     ebx, [ebp+1F8h+format]
.text:00402708		       push    esi
.text:00402709		       xor     esi, esi
.text:0040270B		       push    edi
.text:0040270C		       mov     edi, [ebp+1F8h+argptr]
.text:00402712		       push    [ebp+1F8h+plocinfo] ; plocinfo
.text:00402718		       lea     ecx, [ebp+1F8h+_loc_update] ; this
.text:0040271B		       mov     [ebp+1F8h+f], eax
.text:0040271E		       mov     [ebp+1F8h+var_224], edi
.text:00402721		       mov     [ebp+1F8h+hexadd], esi
.text:00402724		       mov     [ebp+1F8h+flags], esi
.text:00402727		       mov     [ebp+1F8h+fldwidth], esi
.text:0040272A		       mov     [ebp+1F8h+precision], esi
.text:0040272D		       mov     [ebp+1F8h+prefixlen], esi
.text:00402730		       mov     [ebp+1F8h+no_output], esi
.text:00402733		       mov     [ebp+1F8h+bufferiswide],	esi
.text:00402736		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040273B		       cmp     [ebp+1F8h+f], esi
.text:0040273E		       jnz     short loc_40276D
.text:00402740
.text:00402740 loc_402740:			       ; CODE XREF: __output_l+E5j
.text:00402740					       ; __output_l+138j ...
.text:00402740		       call    __errno
.text:00402745		       push    esi	       ; pReserved
.text:00402746		       push    esi	       ; nLine
.text:00402747		       push    esi	       ; pszFile
.text:00402748		       push    esi	       ; pszFunction
.text:00402749		       mov     dword ptr [eax],	16h
.text:0040274F		       push    esi	       ; pszExpression
.text:00402750
.text:00402750 loc_402750:			       ; CODE XREF: __output_l+947j
.text:00402750		       call    __invalid_parameter
.text:00402755		       add     esp, 14h
.text:00402758		       cmp     [ebp+1F8h+_loc_update.updated], 0
.text:0040275C		       jz      short loc_402765
.text:0040275E		       mov     eax, [ebp+1F8h+_loc_update.ptd]
.text:00402761		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00402765
.text:00402765 loc_402765:			       ; CODE XREF: __output_l+7Cj
.text:00402765		       or      eax, 0FFFFFFFFh
.text:00402768		       jmp     loc_40303C
.text:0040276D ; ---------------------------------------------------------------------------
.text:0040276D
.text:0040276D loc_40276D:			       ; CODE XREF: __output_l+5Ej
.text:0040276D		       mov     eax, [ebp+1F8h+f]
.text:00402770		       test    byte ptr	[eax+0Ch], 40h
.text:00402774		       jnz     loc_40281E
.text:0040277A		       push    eax	       ; stream
.text:0040277B		       call    __fileno
.text:00402780		       cmp     eax, 0FFFFFFFFh
.text:00402783		       pop     ecx
.text:00402784		       jz      short loc_4027BC
.text:00402786		       push    [ebp+1F8h+f]    ; stream
.text:00402789		       call    __fileno
.text:0040278E		       cmp     eax, 0FFFFFFFEh
.text:00402791		       pop     ecx
.text:00402792		       jz      short loc_4027BC
.text:00402794		       push    [ebp+1F8h+f]    ; stream
.text:00402797		       call    __fileno
.text:0040279C		       push    [ebp+1F8h+f]    ; stream
.text:0040279F		       sar     eax, 5
.text:004027A2		       lea     esi, ds:423F00h[eax*4]
.text:004027A9		       call    __fileno
.text:004027AE		       and     eax, 1Fh
.text:004027B1		       shl     eax, 6
.text:004027B4		       add     eax, [esi]
.text:004027B6		       pop     ecx
.text:004027B7		       pop     ecx
.text:004027B8		       xor     esi, esi
.text:004027BA		       jmp     short loc_4027C1
.text:004027BC ; ---------------------------------------------------------------------------
.text:004027BC
.text:004027BC loc_4027BC:			       ; CODE XREF: __output_l+A4j
.text:004027BC					       ; __output_l+B2j
.text:004027BC		       mov     eax, offset ___badioinfo
.text:004027C1
.text:004027C1 loc_4027C1:			       ; CODE XREF: __output_l+DAj
.text:004027C1		       test    byte ptr	[eax+24h], 7Fh
.text:004027C5		       jnz     loc_402740
.text:004027CB		       push    [ebp+1F8h+f]    ; stream
.text:004027CE		       call    __fileno
.text:004027D3		       cmp     eax, 0FFFFFFFFh
.text:004027D6		       pop     ecx
.text:004027D7		       jz      short loc_40280F
.text:004027D9		       push    [ebp+1F8h+f]    ; stream
.text:004027DC		       call    __fileno
.text:004027E1		       cmp     eax, 0FFFFFFFEh
.text:004027E4		       pop     ecx
.text:004027E5		       jz      short loc_40280F
.text:004027E7		       push    [ebp+1F8h+f]    ; stream
.text:004027EA		       call    __fileno
.text:004027EF		       push    [ebp+1F8h+f]    ; stream
.text:004027F2		       sar     eax, 5
.text:004027F5		       lea     esi, ds:423F00h[eax*4]
.text:004027FC		       call    __fileno
.text:00402801		       and     eax, 1Fh
.text:00402804		       shl     eax, 6
.text:00402807		       add     eax, [esi]
.text:00402809		       pop     ecx
.text:0040280A		       pop     ecx
.text:0040280B		       xor     esi, esi
.text:0040280D		       jmp     short loc_402814
.text:0040280F ; ---------------------------------------------------------------------------
.text:0040280F
.text:0040280F loc_40280F:			       ; CODE XREF: __output_l+F7j
.text:0040280F					       ; __output_l+105j
.text:0040280F		       mov     eax, offset ___badioinfo
.text:00402814
.text:00402814 loc_402814:			       ; CODE XREF: __output_l+12Dj
.text:00402814		       test    byte ptr	[eax+24h], 80h
.text:00402818		       jnz     loc_402740
.text:0040281E
.text:0040281E loc_40281E:			       ; CODE XREF: __output_l+94j
.text:0040281E		       cmp     ebx, esi
.text:00402820		       jz      loc_402740
.text:00402826		       mov     dl, [ebx]
.text:00402828		       xor     ecx, ecx
.text:0040282A		       test    dl, dl
.text:0040282C		       mov     [ebp+1F8h+charsout], esi
.text:0040282F		       mov     [ebp+1F8h+radix], esi
.text:00402832		       mov     [ebp+1F8h+heapbuf], esi
.text:00402835		       mov     [ebp+1F8h+var_211], dl
.text:00402838		       jz      loc_40302C
.text:0040283E
.text:0040283E loc_40283E:			       ; CODE XREF: __output_l+930j
.text:0040283E		       inc     ebx
.text:0040283F		       cmp     [ebp+1F8h+charsout], 0
.text:00402843		       mov     [ebp+1F8h+var_240], ebx
.text:00402846		       jl      loc_40302C
.text:0040284C		       mov     al, dl
.text:0040284E		       sub     al, 20h
.text:00402850		       cmp     al, 58h
.text:00402852		       ja      short loc_402865
.text:00402854		       movsx   eax, dl
.text:00402857		       movzx   eax, byte ptr ds:aNull_0[eax] ; "(null)"
.text:0040285E		       and     eax, 0Fh
.text:00402861		       xor     esi, esi
.text:00402863		       jmp     short loc_402869
.text:00402865 ; ---------------------------------------------------------------------------
.text:00402865
.text:00402865 loc_402865:			       ; CODE XREF: __output_l+172j
.text:00402865		       xor     esi, esi
.text:00402867		       xor     eax, eax
.text:00402869
.text:00402869 loc_402869:			       ; CODE XREF: __output_l+183j
.text:00402869		       movsx   eax, ds:___lookuptable[ecx+eax*8]
.text:00402871		       push    7
.text:00402873		       sar     eax, 4
.text:00402876		       pop     ecx
.text:00402877		       cmp     eax, ecx	       ; switch	8 cases
.text:00402879		       mov     [ebp+1F8h+state], eax
.text:0040287C		       ja      loc_402FFC      ; default
.text:00402882		       jmp     ds:off_403054[eax*4] ; switch jump
.text:00402889
.text:00402889 $LN130:				       ; DATA XREF: __output_l:off_403054o
.text:00402889		       or      [ebp+1F8h+precision], 0FFFFFFFFh	; jumptable 00402882 case 1
.text:0040288D		       mov     [ebp+1F8h+capexp], esi
.text:00402890		       mov     [ebp+1F8h+no_output], esi
.text:00402893		       mov     [ebp+1F8h+fldwidth], esi
.text:00402896		       mov     [ebp+1F8h+prefixlen], esi
.text:00402899		       mov     [ebp+1F8h+flags], esi
.text:0040289C		       mov     [ebp+1F8h+bufferiswide],	esi
.text:0040289F		       jmp     loc_402FFC      ; default
.text:004028A4 ; ---------------------------------------------------------------------------
.text:004028A4
.text:004028A4 $LN129:				       ; CODE XREF: __output_l+1A2j
.text:004028A4					       ; DATA XREF: __output_l:off_403054o
.text:004028A4		       movsx   eax, dl	       ; jumptable 00402882 case 2
.text:004028A7		       sub     eax, 20h
.text:004028AA		       jz      short loc_4028EA
.text:004028AC		       sub     eax, 3
.text:004028AF		       jz      short loc_4028DE
.text:004028B1		       sub     eax, 8
.text:004028B4		       jz      short loc_4028D5
.text:004028B6		       dec     eax
.text:004028B7		       dec     eax
.text:004028B8		       jz      short loc_4028CC
.text:004028BA		       sub     eax, 3
.text:004028BD		       jnz     loc_402FFC      ; default
.text:004028C3		       or      [ebp+1F8h+flags], 8
.text:004028C7		       jmp     loc_402FFC      ; default
.text:004028CC ; ---------------------------------------------------------------------------
.text:004028CC
.text:004028CC loc_4028CC:			       ; CODE XREF: __output_l+1D8j
.text:004028CC		       or      [ebp+1F8h+flags], 4
.text:004028D0		       jmp     loc_402FFC      ; default
.text:004028D5 ; ---------------------------------------------------------------------------
.text:004028D5
.text:004028D5 loc_4028D5:			       ; CODE XREF: __output_l+1D4j
.text:004028D5		       or      [ebp+1F8h+flags], 1
.text:004028D9		       jmp     loc_402FFC      ; default
.text:004028DE ; ---------------------------------------------------------------------------
.text:004028DE
.text:004028DE loc_4028DE:			       ; CODE XREF: __output_l+1CFj
.text:004028DE		       or      [ebp+1F8h+flags], 80h
.text:004028E5		       jmp     loc_402FFC      ; default
.text:004028EA ; ---------------------------------------------------------------------------
.text:004028EA
.text:004028EA loc_4028EA:			       ; CODE XREF: __output_l+1CAj
.text:004028EA		       or      [ebp+1F8h+flags], 2
.text:004028EE		       jmp     loc_402FFC      ; default
.text:004028F3 ; ---------------------------------------------------------------------------
.text:004028F3
.text:004028F3 $LN121:				       ; CODE XREF: __output_l+1A2j
.text:004028F3					       ; DATA XREF: __output_l:off_403054o
.text:004028F3		       cmp     dl, 2Ah	       ; jumptable 00402882 case 3
.text:004028F6		       jnz     short loc_402918
.text:004028F8		       add     edi, 4
.text:004028FB		       mov     [ebp+1F8h+var_224], edi
.text:004028FE		       mov     edi, [edi-4]
.text:00402901		       cmp     edi, esi
.text:00402903		       mov     [ebp+1F8h+fldwidth], edi
.text:00402906		       jge     loc_402FFC      ; default
.text:0040290C		       or      [ebp+1F8h+flags], 4
.text:00402910		       neg     [ebp+1F8h+fldwidth]
.text:00402913		       jmp     loc_402FFC      ; default
.text:00402918 ; ---------------------------------------------------------------------------
.text:00402918
.text:00402918 loc_402918:			       ; CODE XREF: __output_l+216j
.text:00402918		       mov     eax, [ebp+1F8h+fldwidth]
.text:0040291B		       imul    eax, 0Ah
.text:0040291E		       movsx   ecx, dl
.text:00402921		       lea     eax, [eax+ecx-30h]
.text:00402925		       mov     [ebp+1F8h+fldwidth], eax
.text:00402928		       jmp     loc_402FFC      ; default
.text:0040292D ; ---------------------------------------------------------------------------
.text:0040292D
.text:0040292D $LN117:				       ; CODE XREF: __output_l+1A2j
.text:0040292D					       ; DATA XREF: __output_l:off_403054o
.text:0040292D		       mov     [ebp+1F8h+precision], esi ; jumptable 00402882 case 4
.text:00402930		       jmp     loc_402FFC      ; default
.text:00402935 ; ---------------------------------------------------------------------------
.text:00402935
.text:00402935 $LN116:				       ; CODE XREF: __output_l+1A2j
.text:00402935					       ; DATA XREF: __output_l:off_403054o
.text:00402935		       cmp     dl, 2Ah	       ; jumptable 00402882 case 5
.text:00402938		       jnz     short loc_402957
.text:0040293A		       add     edi, 4
.text:0040293D		       mov     [ebp+1F8h+var_224], edi
.text:00402940		       mov     edi, [edi-4]
.text:00402943		       cmp     edi, esi
.text:00402945		       mov     [ebp+1F8h+precision], edi
.text:00402948		       jge     loc_402FFC      ; default
.text:0040294E		       or      [ebp+1F8h+precision], 0FFFFFFFFh
.text:00402952		       jmp     loc_402FFC      ; default
.text:00402957 ; ---------------------------------------------------------------------------
.text:00402957
.text:00402957 loc_402957:			       ; CODE XREF: __output_l+258j
.text:00402957		       mov     eax, [ebp+1F8h+precision]
.text:0040295A		       imul    eax, 0Ah
.text:0040295D		       movsx   ecx, dl
.text:00402960		       lea     eax, [eax+ecx-30h]
.text:00402964		       mov     [ebp+1F8h+precision], eax
.text:00402967		       jmp     loc_402FFC      ; default
.text:0040296C ; ---------------------------------------------------------------------------
.text:0040296C
.text:0040296C $LN112:				       ; CODE XREF: __output_l+1A2j
.text:0040296C					       ; DATA XREF: __output_l:off_403054o
.text:0040296C		       cmp     dl, 49h	       ; jumptable 00402882 case 6
.text:0040296F		       jz      short loc_4029B7
.text:00402971		       cmp     dl, 68h
.text:00402974		       jz      short loc_4029AE
.text:00402976		       cmp     dl, 6Ch
.text:00402979		       jz      short loc_402990
.text:0040297B		       cmp     dl, 77h
.text:0040297E		       jnz     loc_402FFC      ; default
.text:00402984		       or      [ebp+1F8h+flags], 800h
.text:0040298B		       jmp     loc_402FFC      ; default
.text:00402990 ; ---------------------------------------------------------------------------
.text:00402990
.text:00402990 loc_402990:			       ; CODE XREF: __output_l+299j
.text:00402990		       cmp     byte ptr	[ebx], 6Ch
.text:00402993		       jnz     short loc_4029A5
.text:00402995		       inc     ebx
.text:00402996		       or      [ebp+1F8h+flags], 1000h
.text:0040299D		       mov     [ebp+1F8h+var_240], ebx
.text:004029A0		       jmp     loc_402FFC      ; default
.text:004029A5 ; ---------------------------------------------------------------------------
.text:004029A5
.text:004029A5 loc_4029A5:			       ; CODE XREF: __output_l+2B3j
.text:004029A5		       or      [ebp+1F8h+flags], 10h
.text:004029A9		       jmp     loc_402FFC      ; default
.text:004029AE ; ---------------------------------------------------------------------------
.text:004029AE
.text:004029AE loc_4029AE:			       ; CODE XREF: __output_l+294j
.text:004029AE		       or      [ebp+1F8h+flags], 20h
.text:004029B2		       jmp     loc_402FFC      ; default
.text:004029B7 ; ---------------------------------------------------------------------------
.text:004029B7
.text:004029B7 loc_4029B7:			       ; CODE XREF: __output_l+28Fj
.text:004029B7		       mov     al, [ebx]
.text:004029B9		       cmp     al, 36h
.text:004029BB		       jnz     short loc_4029D4
.text:004029BD		       cmp     byte ptr	[ebx+1], 34h
.text:004029C1		       jnz     short loc_4029D4
.text:004029C3		       inc     ebx
.text:004029C4		       inc     ebx
.text:004029C5		       or      [ebp+1F8h+flags], 8000h
.text:004029CC		       mov     [ebp+1F8h+var_240], ebx
.text:004029CF		       jmp     loc_402FFC      ; default
.text:004029D4 ; ---------------------------------------------------------------------------
.text:004029D4
.text:004029D4 loc_4029D4:			       ; CODE XREF: __output_l+2DBj
.text:004029D4					       ; __output_l+2E1j
.text:004029D4		       cmp     al, 33h
.text:004029D6		       jnz     short loc_4029EF
.text:004029D8		       cmp     byte ptr	[ebx+1], 32h
.text:004029DC		       jnz     short loc_4029EF
.text:004029DE		       inc     ebx
.text:004029DF		       inc     ebx
.text:004029E0		       and     [ebp+1F8h+flags], 0FFFF7FFFh
.text:004029E7		       mov     [ebp+1F8h+var_240], ebx
.text:004029EA		       jmp     loc_402FFC      ; default
.text:004029EF ; ---------------------------------------------------------------------------
.text:004029EF
.text:004029EF loc_4029EF:			       ; CODE XREF: __output_l+2F6j
.text:004029EF					       ; __output_l+2FCj
.text:004029EF		       cmp     al, 64h
.text:004029F1		       jz      loc_402FFC      ; default
.text:004029F7		       cmp     al, 69h
.text:004029F9		       jz      loc_402FFC      ; default
.text:004029FF		       cmp     al, 6Fh
.text:00402A01		       jz      loc_402FFC      ; default
.text:00402A07		       cmp     al, 75h
.text:00402A09		       jz      loc_402FFC      ; default
.text:00402A0F		       cmp     al, 78h
.text:00402A11		       jz      loc_402FFC      ; default
.text:00402A17		       cmp     al, 58h
.text:00402A19		       jz      loc_402FFC      ; default
.text:00402A1F		       mov     [ebp+1F8h+state], esi
.text:00402A22
.text:00402A22 NORMAL_STATE:			       ; CODE XREF: __output_l+1A2j
.text:00402A22					       ; DATA XREF: __output_l:off_403054o
.text:00402A22		       lea     eax, [ebp+1F8h+_loc_update] ; jumptable 00402882	case 0
.text:00402A25		       push    eax	       ; plocinfo
.text:00402A26		       movzx   eax, dl
.text:00402A29		       push    eax	       ; c
.text:00402A2A		       mov     [ebp+1F8h+bufferiswide],	esi
.text:00402A2D		       call    __isleadbyte_l
.text:00402A32		       pop     ecx
.text:00402A33		       test    eax, eax
.text:00402A35		       mov     al, [ebp+1F8h+var_211]
.text:00402A38		       pop     ecx
.text:00402A39		       jz      short loc_402A54
.text:00402A3B		       mov     ecx, [ebp+1F8h+f] ; f
.text:00402A3E		       lea     esi, [ebp+1F8h+charsout]	; pnumwritten
.text:00402A41		       call    write_char
.text:00402A46		       mov     al, [ebx]       ; ch
.text:00402A48		       inc     ebx
.text:00402A49		       test    al, al
.text:00402A4B		       mov     [ebp+1F8h+var_240], ebx
.text:00402A4E		       jz      loc_403015
.text:00402A54
.text:00402A54 loc_402A54:			       ; CODE XREF: __output_l+359j
.text:00402A54		       mov     ecx, [ebp+1F8h+f] ; f
.text:00402A57		       lea     esi, [ebp+1F8h+charsout]	; pnumwritten
.text:00402A5A		       call    write_char
.text:00402A5F		       jmp     loc_402FFC      ; default
.text:00402A64 ; ---------------------------------------------------------------------------
.text:00402A64
.text:00402A64 $LN96:				       ; CODE XREF: __output_l+1A2j
.text:00402A64					       ; DATA XREF: __output_l:off_403054o
.text:00402A64		       movsx   eax, dl	       ; jumptable 00402882 case 7
.text:00402A67		       cmp     eax, 64h
.text:00402A6A		       jg      loc_402BE2
.text:00402A70		       jz      loc_402C61
.text:00402A76		       cmp     eax, 53h
.text:00402A79		       jg      loc_402B2A
.text:00402A7F		       jz      short loc_402ADB
.text:00402A81		       sub     eax, 41h
.text:00402A84		       jz      short loc_402A96
.text:00402A86		       dec     eax
.text:00402A87		       dec     eax
.text:00402A88		       jz      short loc_402ACA
.text:00402A8A		       dec     eax
.text:00402A8B		       dec     eax
.text:00402A8C		       jz      short loc_402A96
.text:00402A8E		       dec     eax
.text:00402A8F		       dec     eax
.text:00402A90		       jnz     loc_402EE4
.text:00402A96
.text:00402A96 loc_402A96:			       ; CODE XREF: __output_l+3A4j
.text:00402A96					       ; __output_l+3ACj
.text:00402A96		       add     dl, 20h
.text:00402A99		       mov     [ebp+1F8h+capexp], 1
.text:00402AA0		       mov     [ebp+1F8h+var_211], dl
.text:00402AA3
.text:00402AA3 loc_402AA3:			       ; CODE XREF: __output_l+459j
.text:00402AA3					       ; __output_l+51Dj
.text:00402AA3		       or      [ebp+1F8h+flags], 40h
.text:00402AA7		       cmp     [ebp+1F8h+precision], esi
.text:00402AAA		       lea     ebx, [ebp+1F8h+buffer]
.text:00402AAD		       mov     eax, 200h
.text:00402AB2		       mov     dword ptr [ebp+1F8h+text], ebx
.text:00402AB5		       mov     [ebp+1F8h+count], eax
.text:00402AB8		       jge     loc_402C85
.text:00402ABE		       mov     [ebp+1F8h+precision], 6
.text:00402AC5		       jmp     loc_402CD3
.text:00402ACA ; ---------------------------------------------------------------------------
.text:00402ACA
.text:00402ACA loc_402ACA:			       ; CODE XREF: __output_l+3A8j
.text:00402ACA		       test    word ptr	[ebp+1F8h+flags], 830h
.text:00402AD0		       jnz     short loc_402B47
.text:00402AD2		       or      [ebp+1F8h+flags], 800h
.text:00402AD9		       jmp     short loc_402B47
.text:00402ADB ; ---------------------------------------------------------------------------
.text:00402ADB
.text:00402ADB loc_402ADB:			       ; CODE XREF: __output_l+39Fj
.text:00402ADB		       test    word ptr	[ebp+1F8h+flags], 830h
.text:00402AE1		       jnz     short loc_402AEA
.text:00402AE3		       or      [ebp+1F8h+flags], 800h
.text:00402AEA
.text:00402AEA loc_402AEA:			       ; CODE XREF: __output_l+401j
.text:00402AEA					       ; __output_l+694j
.text:00402AEA		       mov     ecx, [ebp+1F8h+precision]
.text:00402AED		       cmp     ecx, 0FFFFFFFFh
.text:00402AF0		       jnz     short loc_402AF7
.text:00402AF2		       mov     ecx, 7FFFFFFFh
.text:00402AF7
.text:00402AF7 loc_402AF7:			       ; CODE XREF: __output_l+410j
.text:00402AF7		       add     edi, 4
.text:00402AFA		       test    word ptr	[ebp+1F8h+flags], 810h
.text:00402B00		       mov     [ebp+1F8h+var_224], edi
.text:00402B03		       mov     edi, [edi-4]
.text:00402B06		       mov     dword ptr [ebp+1F8h+text], edi
.text:00402B09		       jz      loc_402EC2
.text:00402B0F		       cmp     edi, esi
.text:00402B11		       jnz     short loc_402B1B
.text:00402B13		       mov     eax, ___wnullstring
.text:00402B18		       mov     dword ptr [ebp+1F8h+text], eax
.text:00402B1B
.text:00402B1B loc_402B1B:			       ; CODE XREF: __output_l+431j
.text:00402B1B		       mov     eax, dword ptr [ebp+1F8h+text]
.text:00402B1E		       mov     [ebp+1F8h+bufferiswide],	1
.text:00402B25		       jmp     loc_402EB7
.text:00402B2A ; ---------------------------------------------------------------------------
.text:00402B2A
.text:00402B2A loc_402B2A:			       ; CODE XREF: __output_l+399j
.text:00402B2A		       sub     eax, 58h
.text:00402B2D		       jz      loc_402D6C
.text:00402B33		       dec     eax
.text:00402B34		       dec     eax
.text:00402B35		       jz      short loc_402B94
.text:00402B37		       sub     eax, ecx
.text:00402B39		       jz      loc_402AA3
.text:00402B3F		       dec     eax
.text:00402B40		       dec     eax
.text:00402B41		       jnz     loc_402EE4
.text:00402B47
.text:00402B47 loc_402B47:			       ; CODE XREF: __output_l+3F0j
.text:00402B47					       ; __output_l+3F9j
.text:00402B47		       add     edi, 4
.text:00402B4A		       test    word ptr	[ebp+1F8h+flags], 810h
.text:00402B50		       mov     [ebp+1F8h+var_224], edi
.text:00402B53		       jz      short loc_402B7C
.text:00402B55		       movzx   eax, word ptr [edi-4]
.text:00402B59		       push    eax	       ; wchar
.text:00402B5A		       push    200h	       ; sizeInBytes
.text:00402B5F		       lea     eax, [ebp+1F8h+buffer]
.text:00402B62		       push    eax	       ; dst
.text:00402B63		       lea     eax, [ebp+1F8h+radix]
.text:00402B66		       push    eax	       ; pRetValue
.text:00402B67		       call    _wctomb_s
.text:00402B6C		       add     esp, 10h
.text:00402B6F		       test    eax, eax
.text:00402B71		       jz      short loc_402B89
.text:00402B73		       mov     [ebp+1F8h+no_output], 1
.text:00402B7A		       jmp     short loc_402B89
.text:00402B7C ; ---------------------------------------------------------------------------
.text:00402B7C
.text:00402B7C loc_402B7C:			       ; CODE XREF: __output_l+473j
.text:00402B7C		       mov     al, [edi-4]
.text:00402B7F		       mov     byte ptr	[ebp+1F8h+buffer], al
.text:00402B82		       mov     [ebp+1F8h+radix], 1
.text:00402B89
.text:00402B89 loc_402B89:			       ; CODE XREF: __output_l+491j
.text:00402B89					       ; __output_l+49Aj
.text:00402B89		       lea     eax, [ebp+1F8h+buffer]
.text:00402B8C		       mov     dword ptr [ebp+1F8h+text], eax
.text:00402B8F		       jmp     loc_402EE4
.text:00402B94 ; ---------------------------------------------------------------------------
.text:00402B94
.text:00402B94 loc_402B94:			       ; CODE XREF: __output_l+455j
.text:00402B94		       mov     eax, [edi]
.text:00402B96		       add     edi, 4
.text:00402B99		       cmp     eax, esi
.text:00402B9B		       mov     [ebp+1F8h+var_224], edi
.text:00402B9E		       jz      short loc_402BCE
.text:00402BA0		       mov     ecx, [eax+4]
.text:00402BA3		       cmp     ecx, esi
.text:00402BA5		       jz      short loc_402BCE
.text:00402BA7		       test    word ptr	[ebp+1F8h+flags], 800h
.text:00402BAD		       movsx   eax, word ptr [eax]
.text:00402BB0		       mov     dword ptr [ebp+1F8h+text], ecx
.text:00402BB3		       jz      short loc_402BC6
.text:00402BB5		       cdq
.text:00402BB6		       sub     eax, edx
.text:00402BB8		       sar     eax, 1
.text:00402BBA		       mov     [ebp+1F8h+bufferiswide],	1
.text:00402BC1		       jmp     loc_402EE1
.text:00402BC6 ; ---------------------------------------------------------------------------
.text:00402BC6
.text:00402BC6 loc_402BC6:			       ; CODE XREF: __output_l+4D3j
.text:00402BC6		       mov     [ebp+1F8h+bufferiswide],	esi
.text:00402BC9		       jmp     loc_402EE1
.text:00402BCE ; ---------------------------------------------------------------------------
.text:00402BCE
.text:00402BCE loc_402BCE:			       ; CODE XREF: __output_l+4BEj
.text:00402BCE					       ; __output_l+4C5j
.text:00402BCE		       mov     eax, ___nullstring
.text:00402BD3		       mov     dword ptr [ebp+1F8h+text], eax
.text:00402BD6		       push    eax	       ; buf
.text:00402BD7
.text:00402BD7 loc_402BD7:			       ; CODE XREF: __output_l+680j
.text:00402BD7		       call    _strlen
.text:00402BDC		       pop     ecx
.text:00402BDD		       jmp     loc_402EE1
.text:00402BE2 ; ---------------------------------------------------------------------------
.text:00402BE2
.text:00402BE2 loc_402BE2:			       ; CODE XREF: __output_l+38Aj
.text:00402BE2		       cmp     eax, 70h
.text:00402BE5		       jg      loc_402D71
.text:00402BEB		       jz      loc_402D65
.text:00402BF1		       cmp     eax, 65h
.text:00402BF4		       jl      loc_402EE4
.text:00402BFA		       cmp     eax, 67h
.text:00402BFD		       jle     loc_402AA3
.text:00402C03		       cmp     eax, 69h
.text:00402C06		       jz      short loc_402C61
.text:00402C08		       cmp     eax, 6Eh
.text:00402C0B		       jz      short loc_402C2C
.text:00402C0D		       cmp     eax, 6Fh
.text:00402C10		       jnz     loc_402EE4
.text:00402C16		       test    byte ptr	[ebp+1F8h+flags], 80h
.text:00402C1A		       mov     [ebp+1F8h+radix], 8
.text:00402C21		       jz      short COMMON_INT
.text:00402C23		       or      [ebp+1F8h+flags], 200h
.text:00402C2A		       jmp     short COMMON_INT
.text:00402C2C ; ---------------------------------------------------------------------------
.text:00402C2C
.text:00402C2C loc_402C2C:			       ; CODE XREF: __output_l+52Bj
.text:00402C2C		       mov     esi, [edi]
.text:00402C2E		       add     edi, 4
.text:00402C31		       mov     [ebp+1F8h+var_224], edi
.text:00402C34		       call    __get_printf_count_output
.text:00402C39		       test    eax, eax
.text:00402C3B		       jz      loc_403015
.text:00402C41		       test    byte ptr	[ebp+1F8h+flags], 20h
.text:00402C45		       jz      short loc_402C50
.text:00402C47		       mov     ax, word	ptr [ebp+1F8h+charsout]
.text:00402C4B		       mov     [esi], ax
.text:00402C4E		       jmp     short loc_402C55
.text:00402C50 ; ---------------------------------------------------------------------------
.text:00402C50
.text:00402C50 loc_402C50:			       ; CODE XREF: __output_l+565j
.text:00402C50		       mov     eax, [ebp+1F8h+charsout]
.text:00402C53		       mov     [esi], eax
.text:00402C55
.text:00402C55 loc_402C55:			       ; CODE XREF: __output_l+56Ej
.text:00402C55		       mov     [ebp+1F8h+no_output], 1
.text:00402C5C		       jmp     loc_402FE9
.text:00402C61 ; ---------------------------------------------------------------------------
.text:00402C61
.text:00402C61 loc_402C61:			       ; CODE XREF: __output_l+390j
.text:00402C61					       ; __output_l+526j
.text:00402C61		       or      [ebp+1F8h+flags], 40h
.text:00402C65
.text:00402C65 loc_402C65:			       ; CODE XREF: __output_l+69Cj
.text:00402C65		       mov     [ebp+1F8h+radix], 0Ah
.text:00402C6C
.text:00402C6C COMMON_INT:			       ; CODE XREF: __output_l+541j
.text:00402C6C					       ; __output_l+54Aj ...
.text:00402C6C		       mov     ecx, [ebp+1F8h+flags]
.text:00402C6F		       test    cx, cx
.text:00402C72		       jns     loc_402DBB
.text:00402C78
.text:00402C78 loc_402C78:			       ; CODE XREF: __output_l+6E0j
.text:00402C78		       mov     eax, [edi]
.text:00402C7A		       mov     edx, [edi+4]
.text:00402C7D		       add     edi, 8
.text:00402C80		       jmp     loc_402DF0
.text:00402C85 ; ---------------------------------------------------------------------------
.text:00402C85
.text:00402C85 loc_402C85:			       ; CODE XREF: __output_l+3D8j
.text:00402C85		       jnz     short loc_402C95
.text:00402C87		       cmp     dl, 67h
.text:00402C8A		       jnz     short loc_402CD3
.text:00402C8C		       mov     [ebp+1F8h+precision], 1
.text:00402C93		       jmp     short loc_402CD3
.text:00402C95 ; ---------------------------------------------------------------------------
.text:00402C95
.text:00402C95 loc_402C95:			       ; CODE XREF: __output_l:loc_402C85j
.text:00402C95		       cmp     [ebp+1F8h+precision], eax
.text:00402C98		       jle     short loc_402C9D
.text:00402C9A		       mov     [ebp+1F8h+precision], eax
.text:00402C9D
.text:00402C9D loc_402C9D:			       ; CODE XREF: __output_l+5B8j
.text:00402C9D		       cmp     [ebp+1F8h+precision], 0A3h
.text:00402CA4		       jle     short loc_402CD3
.text:00402CA6		       mov     esi, [ebp+1F8h+precision]
.text:00402CA9		       add     esi, 15Dh
.text:00402CAF		       push    esi	       ; cb
.text:00402CB0		       call    __malloc_crt
.text:00402CB5		       test    eax, eax
.text:00402CB7		       mov     dl, [ebp+1F8h+var_211]
.text:00402CBA		       pop     ecx
.text:00402CBB		       mov     [ebp+1F8h+heapbuf], eax
.text:00402CBE		       jz      short loc_402CCA
.text:00402CC0		       mov     dword ptr [ebp+1F8h+text], eax
.text:00402CC3		       mov     [ebp+1F8h+count], esi
.text:00402CC6		       mov     ebx, eax
.text:00402CC8		       jmp     short loc_402CD1
.text:00402CCA ; ---------------------------------------------------------------------------
.text:00402CCA
.text:00402CCA loc_402CCA:			       ; CODE XREF: __output_l+5DEj
.text:00402CCA		       mov     [ebp+1F8h+precision], 0A3h
.text:00402CD1
.text:00402CD1 loc_402CD1:			       ; CODE XREF: __output_l+5E8j
.text:00402CD1		       xor     esi, esi
.text:00402CD3
.text:00402CD3 loc_402CD3:			       ; CODE XREF: __output_l+3E5j
.text:00402CD3					       ; __output_l+5AAj ...
.text:00402CD3		       mov     eax, [edi]
.text:00402CD5		       add     edi, 8
.text:00402CD8		       mov     dword ptr [ebp+1F8h+tmp.x], eax
.text:00402CDB		       mov     eax, [edi-4]
.text:00402CDE		       mov     dword ptr [ebp+1F8h+tmp.x+4], eax
.text:00402CE1		       lea     eax, [ebp+1F8h+_loc_update]
.text:00402CE4		       push    eax
.text:00402CE5		       push    [ebp+1F8h+capexp]
.text:00402CE8		       movsx   eax, dl
.text:00402CEB		       push    [ebp+1F8h+precision]
.text:00402CEE		       mov     [ebp+1F8h+var_224], edi
.text:00402CF1		       push    eax
.text:00402CF2		       push    [ebp+1F8h+count]
.text:00402CF5		       lea     eax, [ebp+1F8h+tmp]
.text:00402CF8		       push    ebx
.text:00402CF9		       push    eax
.text:00402CFA		       push    codedptr	       ; codedptr
.text:00402D00		       call    __decode_pointer
.text:00402D05		       pop     ecx
.text:00402D06		       call    eax
.text:00402D08		       mov     edi, [ebp+1F8h+flags]
.text:00402D0B		       add     esp, 1Ch
.text:00402D0E		       and     edi, 80h
.text:00402D14		       jz      short loc_402D30
.text:00402D16		       cmp     [ebp+1F8h+precision], esi
.text:00402D19		       jnz     short loc_402D30
.text:00402D1B		       lea     eax, [ebp+1F8h+_loc_update]
.text:00402D1E		       push    eax
.text:00402D1F		       push    ebx
.text:00402D20		       push    off_422694      ; codedptr
.text:00402D26		       call    __decode_pointer
.text:00402D2B		       pop     ecx
.text:00402D2C		       call    eax
.text:00402D2E		       pop     ecx
.text:00402D2F		       pop     ecx
.text:00402D30
.text:00402D30 loc_402D30:			       ; CODE XREF: __output_l+634j
.text:00402D30					       ; __output_l+639j
.text:00402D30		       cmp     [ebp+1F8h+var_211], 67h
.text:00402D34		       jnz     short loc_402D4F
.text:00402D36		       cmp     edi, esi
.text:00402D38		       jnz     short loc_402D4F
.text:00402D3A		       lea     eax, [ebp+1F8h+_loc_update]
.text:00402D3D		       push    eax
.text:00402D3E		       push    ebx
.text:00402D3F		       push    off_422690      ; codedptr
.text:00402D45		       call    __decode_pointer
.text:00402D4A		       pop     ecx
.text:00402D4B		       call    eax
.text:00402D4D		       pop     ecx
.text:00402D4E		       pop     ecx
.text:00402D4F
.text:00402D4F loc_402D4F:			       ; CODE XREF: __output_l+654j
.text:00402D4F					       ; __output_l+658j
.text:00402D4F		       cmp     byte ptr	[ebx], 2Dh
.text:00402D52		       jnz     short loc_402D5F
.text:00402D54		       or      [ebp+1F8h+flags], 100h
.text:00402D5B		       inc     ebx
.text:00402D5C		       mov     dword ptr [ebp+1F8h+text], ebx
.text:00402D5F
.text:00402D5F loc_402D5F:			       ; CODE XREF: __output_l+672j
.text:00402D5F		       push    ebx
.text:00402D60		       jmp     loc_402BD7
.text:00402D65 ; ---------------------------------------------------------------------------
.text:00402D65
.text:00402D65 loc_402D65:			       ; CODE XREF: __output_l+50Bj
.text:00402D65		       mov     [ebp+1F8h+precision], 8
.text:00402D6C
.text:00402D6C loc_402D6C:			       ; CODE XREF: __output_l+44Dj
.text:00402D6C		       mov     [ebp+1F8h+hexadd], ecx
.text:00402D6F		       jmp     short COMMON_HEX
.text:00402D71 ; ---------------------------------------------------------------------------
.text:00402D71
.text:00402D71 loc_402D71:			       ; CODE XREF: __output_l+505j
.text:00402D71		       sub     eax, 73h
.text:00402D74		       jz      loc_402AEA
.text:00402D7A		       dec     eax
.text:00402D7B		       dec     eax
.text:00402D7C		       jz      loc_402C65
.text:00402D82		       sub     eax, 3
.text:00402D85		       jnz     loc_402EE4
.text:00402D8B		       mov     [ebp+1F8h+hexadd], 27h
.text:00402D92
.text:00402D92 COMMON_HEX:			       ; CODE XREF: __output_l+68Fj
.text:00402D92		       test    byte ptr	[ebp+1F8h+flags], 80h
.text:00402D96		       mov     [ebp+1F8h+radix], 10h
.text:00402D9D		       jz      COMMON_INT
.text:00402DA3		       mov     al, byte	ptr [ebp+1F8h+hexadd]
.text:00402DA6		       add     al, 51h
.text:00402DA8		       mov     [ebp+1F8h+prefix], 30h
.text:00402DAC		       mov     [ebp+1F8h+prefix+1], al
.text:00402DAF		       mov     [ebp+1F8h+prefixlen], 2
.text:00402DB6		       jmp     COMMON_INT
.text:00402DBB ; ---------------------------------------------------------------------------
.text:00402DBB
.text:00402DBB loc_402DBB:			       ; CODE XREF: __output_l+592j
.text:00402DBB		       test    cx, 1000h
.text:00402DC0		       jnz     loc_402C78
.text:00402DC6		       add     edi, 4
.text:00402DC9		       test    cl, 20h
.text:00402DCC		       jz      short loc_402DE3
.text:00402DCE		       test    cl, 40h
.text:00402DD1		       mov     [ebp+1F8h+var_224], edi
.text:00402DD4		       jz      short loc_402DDC
.text:00402DD6		       movsx   eax, word ptr [edi-4]
.text:00402DDA		       jmp     short loc_402DE0
.text:00402DDC ; ---------------------------------------------------------------------------
.text:00402DDC
.text:00402DDC loc_402DDC:			       ; CODE XREF: __output_l+6F4j
.text:00402DDC		       movzx   eax, word ptr [edi-4]
.text:00402DE0
.text:00402DE0 loc_402DE0:			       ; CODE XREF: __output_l+6FAj
.text:00402DE0		       cdq
.text:00402DE1		       jmp     short loc_402DF3
.text:00402DE3 ; ---------------------------------------------------------------------------
.text:00402DE3
.text:00402DE3 loc_402DE3:			       ; CODE XREF: __output_l+6ECj
.text:00402DE3		       test    cl, 40h
.text:00402DE6		       mov     eax, [edi-4]
.text:00402DE9		       jz      short loc_402DEE
.text:00402DEB		       cdq
.text:00402DEC		       jmp     short loc_402DF0
.text:00402DEE ; ---------------------------------------------------------------------------
.text:00402DEE
.text:00402DEE loc_402DEE:			       ; CODE XREF: __output_l+709j
.text:00402DEE		       xor     edx, edx
.text:00402DF0
.text:00402DF0 loc_402DF0:			       ; CODE XREF: __output_l+5A0j
.text:00402DF0					       ; __output_l+70Cj
.text:00402DF0		       mov     [ebp+1F8h+var_224], edi
.text:00402DF3
.text:00402DF3 loc_402DF3:			       ; CODE XREF: __output_l+701j
.text:00402DF3		       test    cl, 40h
.text:00402DF6		       jz      short loc_402E10
.text:00402DF8		       cmp     edx, esi
.text:00402DFA		       jg      short loc_402E10
.text:00402DFC		       jl      short loc_402E02
.text:00402DFE		       cmp     eax, esi
.text:00402E00		       jnb     short loc_402E10
.text:00402E02
.text:00402E02 loc_402E02:			       ; CODE XREF: __output_l+71Cj
.text:00402E02		       neg     eax
.text:00402E04		       adc     edx, 0
.text:00402E07		       neg     edx
.text:00402E09		       or      [ebp+1F8h+flags], 100h
.text:00402E10
.text:00402E10 loc_402E10:			       ; CODE XREF: __output_l+716j
.text:00402E10					       ; __output_l+71Aj ...
.text:00402E10		       test    word ptr	[ebp+1F8h+flags], 9000h
.text:00402E16		       mov     ebx, edx
.text:00402E18		       mov     edi, eax
.text:00402E1A		       jnz     short loc_402E1E
.text:00402E1C		       xor     ebx, ebx
.text:00402E1E
.text:00402E1E loc_402E1E:			       ; CODE XREF: __output_l+73Aj
.text:00402E1E		       cmp     [ebp+1F8h+precision], 0
.text:00402E22		       jge     short loc_402E2D
.text:00402E24		       mov     [ebp+1F8h+precision], 1
.text:00402E2B		       jmp     short loc_402E3E
.text:00402E2D ; ---------------------------------------------------------------------------
.text:00402E2D
.text:00402E2D loc_402E2D:			       ; CODE XREF: __output_l+742j
.text:00402E2D		       and     [ebp+1F8h+flags], 0FFFFFFF7h
.text:00402E31		       mov     eax, 200h
.text:00402E36		       cmp     [ebp+1F8h+precision], eax
.text:00402E39		       jle     short loc_402E3E
.text:00402E3B		       mov     [ebp+1F8h+precision], eax
.text:00402E3E
.text:00402E3E loc_402E3E:			       ; CODE XREF: __output_l+74Bj
.text:00402E3E					       ; __output_l+759j
.text:00402E3E		       mov     eax, edi
.text:00402E40		       or      eax, ebx
.text:00402E42		       jnz     short loc_402E47
.text:00402E44		       and     [ebp+1F8h+prefixlen], eax
.text:00402E47
.text:00402E47 loc_402E47:			       ; CODE XREF: __output_l+762j
.text:00402E47		       lea     esi, [ebp+1F8h+buffer+1FFh]
.text:00402E4D
.text:00402E4D loc_402E4D:			       ; CODE XREF: __output_l+79Fj
.text:00402E4D		       mov     eax, [ebp+1F8h+precision]
.text:00402E50		       dec     [ebp+1F8h+precision]
.text:00402E53		       test    eax, eax
.text:00402E55		       jg      short loc_402E5D
.text:00402E57		       mov     eax, edi
.text:00402E59		       or      eax, ebx
.text:00402E5B		       jz      short loc_402E81
.text:00402E5D
.text:00402E5D loc_402E5D:			       ; CODE XREF: __output_l+775j
.text:00402E5D		       mov     eax, [ebp+1F8h+radix]
.text:00402E60		       cdq
.text:00402E61		       push    edx
.text:00402E62		       push    eax
.text:00402E63		       push    ebx
.text:00402E64		       push    edi
.text:00402E65		       call    __aulldvrm
.text:00402E6A		       add     ecx, 30h
.text:00402E6D		       cmp     ecx, 39h
.text:00402E70		       mov     [ebp+1F8h+count], ebx
.text:00402E73		       mov     edi, eax	       ; f
.text:00402E75		       mov     ebx, edx
.text:00402E77		       jle     short loc_402E7C
.text:00402E79		       add     ecx, [ebp+1F8h+hexadd]
.text:00402E7C
.text:00402E7C loc_402E7C:			       ; CODE XREF: __output_l+797j
.text:00402E7C		       mov     [esi], cl
.text:00402E7E		       dec     esi
.text:00402E7F		       jmp     short loc_402E4D
.text:00402E81 ; ---------------------------------------------------------------------------
.text:00402E81
.text:00402E81 loc_402E81:			       ; CODE XREF: __output_l+77Bj
.text:00402E81		       lea     eax, [ebp+1F8h+buffer+1FFh]
.text:00402E87		       sub     eax, esi
.text:00402E89		       inc     esi
.text:00402E8A		       test    word ptr	[ebp+1F8h+flags], 200h
.text:00402E90		       mov     [ebp+1F8h+radix], eax
.text:00402E93		       mov     dword ptr [ebp+1F8h+text], esi
.text:00402E96		       jz      short loc_402EE4
.text:00402E98		       test    eax, eax
.text:00402E9A		       jz      short loc_402EA3
.text:00402E9C		       mov     ecx, esi
.text:00402E9E		       cmp     byte ptr	[ecx], 30h
.text:00402EA1		       jz      short loc_402EE4
.text:00402EA3
.text:00402EA3 loc_402EA3:			       ; CODE XREF: __output_l+7BAj
.text:00402EA3		       dec     dword ptr [ebp+1F8h+text]
.text:00402EA6		       mov     ecx, dword ptr [ebp+1F8h+text]
.text:00402EA9		       mov     byte ptr	[ecx], 30h
.text:00402EAC		       inc     eax
.text:00402EAD		       jmp     short loc_402EE1
.text:00402EAF ; ---------------------------------------------------------------------------
.text:00402EAF
.text:00402EAF loc_402EAF:			       ; CODE XREF: __output_l+7D9j
.text:00402EAF		       dec     ecx
.text:00402EB0		       cmp     [eax], si
.text:00402EB3		       jz      short loc_402EBB
.text:00402EB5		       inc     eax
.text:00402EB6		       inc     eax
.text:00402EB7
.text:00402EB7 loc_402EB7:			       ; CODE XREF: __output_l+445j
.text:00402EB7		       cmp     ecx, esi
.text:00402EB9		       jnz     short loc_402EAF
.text:00402EBB
.text:00402EBB loc_402EBB:			       ; CODE XREF: __output_l+7D3j
.text:00402EBB		       sub     eax, dword ptr [ebp+1F8h+text]
.text:00402EBE		       sar     eax, 1
.text:00402EC0		       jmp     short loc_402EE1
.text:00402EC2 ; ---------------------------------------------------------------------------
.text:00402EC2
.text:00402EC2 loc_402EC2:			       ; CODE XREF: __output_l+429j
.text:00402EC2		       cmp     edi, esi
.text:00402EC4		       jnz     short loc_402ECE
.text:00402EC6		       mov     eax, ___nullstring
.text:00402ECB		       mov     dword ptr [ebp+1F8h+text], eax
.text:00402ECE
.text:00402ECE loc_402ECE:			       ; CODE XREF: __output_l+7E4j
.text:00402ECE		       mov     eax, dword ptr [ebp+1F8h+text]
.text:00402ED1		       jmp     short loc_402EDA
.text:00402ED3 ; ---------------------------------------------------------------------------
.text:00402ED3
.text:00402ED3 loc_402ED3:			       ; CODE XREF: __output_l+7FCj
.text:00402ED3		       dec     ecx
.text:00402ED4		       cmp     byte ptr	[eax], 0
.text:00402ED7		       jz      short loc_402EDE
.text:00402ED9		       inc     eax
.text:00402EDA
.text:00402EDA loc_402EDA:			       ; CODE XREF: __output_l+7F1j
.text:00402EDA		       cmp     ecx, esi
.text:00402EDC		       jnz     short loc_402ED3
.text:00402EDE
.text:00402EDE loc_402EDE:			       ; CODE XREF: __output_l+7F7j
.text:00402EDE		       sub     eax, dword ptr [ebp+1F8h+text]
.text:00402EE1
.text:00402EE1 loc_402EE1:			       ; CODE XREF: __output_l+4E1j
.text:00402EE1					       ; __output_l+4E9j ...
.text:00402EE1		       mov     [ebp+1F8h+radix], eax
.text:00402EE4
.text:00402EE4 loc_402EE4:			       ; CODE XREF: __output_l+3B0j
.text:00402EE4					       ; __output_l+461j ...
.text:00402EE4		       cmp     [ebp+1F8h+no_output], 0
.text:00402EE8		       jnz     loc_402FE9
.text:00402EEE		       mov     eax, [ebp+1F8h+flags]
.text:00402EF1		       test    al, 40h
.text:00402EF3		       jz      short loc_402F1A
.text:00402EF5		       test    ax, 100h
.text:00402EF9		       jz      short loc_402F01
.text:00402EFB		       mov     [ebp+1F8h+prefix], 2Dh
.text:00402EFF		       jmp     short loc_402F13
.text:00402F01 ; ---------------------------------------------------------------------------
.text:00402F01
.text:00402F01 loc_402F01:			       ; CODE XREF: __output_l+819j
.text:00402F01		       test    al, 1
.text:00402F03		       jz      short loc_402F0B
.text:00402F05		       mov     [ebp+1F8h+prefix], 2Bh
.text:00402F09		       jmp     short loc_402F13
.text:00402F0B ; ---------------------------------------------------------------------------
.text:00402F0B
.text:00402F0B loc_402F0B:			       ; CODE XREF: __output_l+823j
.text:00402F0B		       test    al, 2
.text:00402F0D		       jz      short loc_402F1A
.text:00402F0F		       mov     [ebp+1F8h+prefix], 20h
.text:00402F13
.text:00402F13 loc_402F13:			       ; CODE XREF: __output_l+81Fj
.text:00402F13					       ; __output_l+829j
.text:00402F13		       mov     [ebp+1F8h+prefixlen], 1
.text:00402F1A
.text:00402F1A loc_402F1A:			       ; CODE XREF: __output_l+813j
.text:00402F1A					       ; __output_l+82Dj
.text:00402F1A		       mov     ebx, [ebp+1F8h+fldwidth]
.text:00402F1D		       sub     ebx, [ebp+1F8h+radix]
.text:00402F20		       sub     ebx, [ebp+1F8h+prefixlen]
.text:00402F23		       test    byte ptr	[ebp+1F8h+flags], 0Ch
.text:00402F27		       jnz     short loc_402F3A
.text:00402F29		       push    [ebp+1F8h+f]    ; f
.text:00402F2C		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402F2F		       push    ebx	       ; num
.text:00402F30		       push    20h	       ; ch
.text:00402F32		       call    write_multi_char
.text:00402F37		       add     esp, 0Ch
.text:00402F3A
.text:00402F3A loc_402F3A:			       ; CODE XREF: __output_l+847j
.text:00402F3A		       push    [ebp+1F8h+prefixlen] ; len
.text:00402F3D		       mov     edi, [ebp+1F8h+f] ; f
.text:00402F40		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402F43		       lea     ecx, [ebp+1F8h+prefix] ;	string
.text:00402F46		       call    write_string
.text:00402F4B		       test    byte ptr	[ebp+1F8h+flags], 8
.text:00402F4F		       pop     ecx
.text:00402F50		       jz      short loc_402F67
.text:00402F52		       test    byte ptr	[ebp+1F8h+flags], 4
.text:00402F56		       jnz     short loc_402F67
.text:00402F58		       push    edi	       ; f
.text:00402F59		       push    ebx	       ; num
.text:00402F5A		       push    30h	       ; ch
.text:00402F5C		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402F5F		       call    write_multi_char
.text:00402F64		       add     esp, 0Ch
.text:00402F67
.text:00402F67 loc_402F67:			       ; CODE XREF: __output_l+870j
.text:00402F67					       ; __output_l+876j
.text:00402F67		       cmp     [ebp+1F8h+bufferiswide],	0
.text:00402F6B		       mov     eax, [ebp+1F8h+radix]
.text:00402F6E		       jz      short loc_402FC1
.text:00402F70		       test    eax, eax
.text:00402F72		       jle     short loc_402FC1
.text:00402F74		       mov     esi, dword ptr [ebp+1F8h+text]
.text:00402F77		       mov     [ebp+1F8h+count], eax
.text:00402F7A
.text:00402F7A loc_402F7A:			       ; CODE XREF: __output_l+8D7j
.text:00402F7A		       movzx   eax, word ptr [esi]
.text:00402F7D		       dec     [ebp+1F8h+count]
.text:00402F80		       push    eax	       ; wchar
.text:00402F81		       push    6	       ; sizeInBytes
.text:00402F83		       lea     eax, [ebp+1F8h+L_buffer]
.text:00402F89		       push    eax	       ; dst
.text:00402F8A		       lea     eax, [ebp+1F8h+retval]
.text:00402F8D		       inc     esi
.text:00402F8E		       push    eax	       ; pRetValue
.text:00402F8F		       inc     esi
.text:00402F90		       call    _wctomb_s
.text:00402F95		       add     esp, 10h
.text:00402F98		       test    eax, eax
.text:00402F9A		       jnz     short loc_402FBB
.text:00402F9C		       cmp     [ebp+1F8h+retval], eax
.text:00402F9F		       jz      short loc_402FBB
.text:00402FA1		       push    [ebp+1F8h+retval] ; len
.text:00402FA4		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402FA7		       lea     ecx, [ebp+1F8h+L_buffer]	; string
.text:00402FAD		       call    write_string
.text:00402FB2		       cmp     [ebp+1F8h+count], 0
.text:00402FB6		       pop     ecx
.text:00402FB7		       jnz     short loc_402F7A
.text:00402FB9		       jmp     short loc_402FCE
.text:00402FBB ; ---------------------------------------------------------------------------
.text:00402FBB
.text:00402FBB loc_402FBB:			       ; CODE XREF: __output_l+8BAj
.text:00402FBB					       ; __output_l+8BFj
.text:00402FBB		       or      [ebp+1F8h+charsout], 0FFFFFFFFh
.text:00402FBF		       jmp     short loc_402FCE
.text:00402FC1 ; ---------------------------------------------------------------------------
.text:00402FC1
.text:00402FC1 loc_402FC1:			       ; CODE XREF: __output_l+88Ej
.text:00402FC1					       ; __output_l+892j
.text:00402FC1		       mov     ecx, dword ptr [ebp+1F8h+text] ;	string
.text:00402FC4		       push    eax	       ; len
.text:00402FC5		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402FC8		       call    write_string
.text:00402FCD		       pop     ecx
.text:00402FCE
.text:00402FCE loc_402FCE:			       ; CODE XREF: __output_l+8D9j
.text:00402FCE					       ; __output_l+8DFj
.text:00402FCE		       cmp     [ebp+1F8h+charsout], 0
.text:00402FD2		       jl      short loc_402FE9
.text:00402FD4		       test    byte ptr	[ebp+1F8h+flags], 4
.text:00402FD8		       jz      short loc_402FE9
.text:00402FDA		       push    edi	       ; f
.text:00402FDB		       push    ebx	       ; num
.text:00402FDC		       push    20h	       ; ch
.text:00402FDE		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00402FE1		       call    write_multi_char
.text:00402FE6		       add     esp, 0Ch
.text:00402FE9
.text:00402FE9 loc_402FE9:			       ; CODE XREF: __output_l+57Cj
.text:00402FE9					       ; __output_l+808j ...
.text:00402FE9		       cmp     [ebp+1F8h+heapbuf], 0
.text:00402FED		       jz      short loc_402FFC	; default
.text:00402FEF		       push    [ebp+1F8h+heapbuf] ; pBlock
.text:00402FF2		       call    _free
.text:00402FF7		       and     [ebp+1F8h+heapbuf], 0
.text:00402FFB		       pop     ecx
.text:00402FFC
.text:00402FFC loc_402FFC:			       ; CODE XREF: __output_l+19Cj
.text:00402FFC					       ; __output_l+1BFj ...
.text:00402FFC		       mov     ebx, [ebp+1F8h+var_240] ; default
.text:00402FFF		       mov     al, [ebx]
.text:00403001		       test    al, al
.text:00403003		       mov     [ebp+1F8h+var_211], al
.text:00403006		       jz      short loc_40302C
.text:00403008		       mov     ecx, [ebp+1F8h+state]
.text:0040300B		       mov     edi, [ebp+1F8h+var_224]
.text:0040300E		       mov     dl, al
.text:00403010		       jmp     loc_40283E
.text:00403015 ; ---------------------------------------------------------------------------
.text:00403015
.text:00403015 loc_403015:			       ; CODE XREF: __output_l+36Ej
.text:00403015					       ; __output_l+55Bj
.text:00403015		       call    __errno
.text:0040301A		       mov     dword ptr [eax],	16h
.text:00403020		       xor     eax, eax
.text:00403022		       push    eax
.text:00403023		       push    eax
.text:00403024		       push    eax
.text:00403025		       push    eax
.text:00403026		       push    eax
.text:00403027		       jmp     loc_402750
.text:0040302C ; ---------------------------------------------------------------------------
.text:0040302C
.text:0040302C loc_40302C:			       ; CODE XREF: __output_l+158j
.text:0040302C					       ; __output_l+166j ...
.text:0040302C		       cmp     [ebp+1F8h+_loc_update.updated], 0
.text:00403030		       jz      short loc_403039
.text:00403032		       mov     eax, [ebp+1F8h+_loc_update.ptd]
.text:00403035		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00403039
.text:00403039 loc_403039:			       ; CODE XREF: __output_l+950j
.text:00403039		       mov     eax, [ebp+1F8h+charsout]
.text:0040303C
.text:0040303C loc_40303C:			       ; CODE XREF: __output_l+88j
.text:0040303C		       mov     ecx, [ebp+1F8h+var_4]
.text:00403042		       pop     edi
.text:00403043		       pop     esi
.text:00403044		       xor     ecx, ebp
.text:00403046		       pop     ebx
.text:00403047		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040304C		       add     ebp, 1F8h
.text:00403052		       leave
.text:00403053		       retn
.text:00403053 ; ---------------------------------------------------------------------------
.text:00403054 off_403054      dd offset NORMAL_STATE  ; DATA XREF: __output_l+1A2r
.text:00403054		       dd offset $LN130	       ; jump table for	switch statement
.text:00403054		       dd offset $LN129
.text:00403054		       dd offset $LN121
.text:00403054		       dd offset $LN117
.text:00403054		       dd offset $LN116
.text:00403054		       dd offset $LN112
.text:00403054		       dd offset $LN96
.text:00403054 __output_l      endp
.text:00403054
.text:00403074
.text:00403074 ; =============== S U B R O U T I N E =======================================
.text:00403074
.text:00403074
.text:00403074 ; void __cdecl _initp_misc_invarg(void *enull)
.text:00403074 __initp_misc_invarg proc	near	       ; CODE XREF: __init_pointers+15p
.text:00403074
.text:00403074 enull	       = dword ptr  4
.text:00403074
.text:00403074		       mov     eax, [esp+enull]
.text:00403078		       mov     ___pInvalidArgHandler, eax
.text:0040307D		       retn
.text:0040307D __initp_misc_invarg endp
.text:0040307D
.text:0040307E
.text:0040307E ; =============== S U B R O U T I N E =======================================
.text:0040307E
.text:0040307E ; Attributes: bp-based frame fpd=2A8h
.text:0040307E
.text:0040307E ; void __cdecl _invoke_watson(const wchar_t *pszExpression, const wchar_t *pszFunction, const wchar_t *pszFile, unsigned	int nLine, unsigned int	pReserved)
.text:0040307E __invoke_watson proc near	       ; CODE XREF: _invoke_watson(ushort const	*,ushort const *,ushort	const *,uint,uint)+4j
.text:0040307E					       ; __invalid_parameter+1Fj ...
.text:0040307E
.text:0040307E ExceptionRecord = _EXCEPTION_RECORD ptr -328h
.text:0040307E ExceptionPointers= _EXCEPTION_POINTERS ptr -2D8h
.text:0040307E ContextRecord   = _CONTEXT ptr -2D0h
.text:0040307E var_4	       = dword ptr -4
.text:0040307E pszExpression   = dword ptr  8
.text:0040307E pszFunction     = dword ptr  0Ch
.text:0040307E pszFile	       = dword ptr  10h
.text:0040307E nLine	       = dword ptr  14h
.text:0040307E pReserved       = dword ptr  18h
.text:0040307E
.text:0040307E		       push    ebp
.text:0040307F		       lea     ebp, [esp-2A8h]
.text:00403086		       sub     esp, 328h
.text:0040308C		       mov     eax, ___security_cookie
.text:00403091		       xor     eax, ebp
.text:00403093		       mov     [ebp+2A8h+var_4], eax
.text:00403099		       push    esi
.text:0040309A		       mov     [ebp+2A8h+ContextRecord._Eax], eax
.text:004030A0		       mov     [ebp+2A8h+ContextRecord._Ecx], ecx
.text:004030A6		       mov     [ebp+2A8h+ContextRecord._Edx], edx
.text:004030AC		       mov     [ebp+2A8h+ContextRecord._Ebx], ebx
.text:004030AF		       mov     [ebp+2A8h+ContextRecord._Esi], esi
.text:004030B2		       mov     [ebp+2A8h+ContextRecord._Edi], edi
.text:004030B5		       mov     word ptr	[ebp+2A8h+ContextRecord.SegSs],	ss
.text:004030BC		       mov     word ptr	[ebp+2A8h+ContextRecord.SegCs],	cs
.text:004030C3		       mov     word ptr	[ebp+2A8h+ContextRecord.SegDs],	ds
.text:004030C7		       mov     word ptr	[ebp+2A8h+ContextRecord.SegEs],	es
.text:004030CB		       mov     word ptr	[ebp+2A8h+ContextRecord.SegFs],	fs
.text:004030CF		       mov     word ptr	[ebp+2A8h+ContextRecord.SegGs],	gs
.text:004030D3		       pushf
.text:004030D4		       pop     [ebp+2A8h+ContextRecord.EFlags]
.text:004030DA		       mov     esi, [ebp+2ACh]
.text:004030E0		       lea     eax, [ebp+2ACh]
.text:004030E6		       mov     [ebp+2A8h+ContextRecord._Esp], eax
.text:004030EC		       mov     [ebp+2A8h+ContextRecord.ContextFlags], 10001h
.text:004030F3		       mov     [ebp+2A8h+ContextRecord._Eip], esi
.text:004030F9		       mov     eax, [eax-4]
.text:004030FC		       push    50h	       ; count
.text:004030FE		       mov     [ebp+2A8h+ContextRecord._Ebp], eax
.text:00403104		       lea     eax, [ebp+2A8h+ExceptionRecord]
.text:00403107		       push    0	       ; value
.text:00403109		       push    eax	       ; dst
.text:0040310A		       call    _memset
.text:0040310F		       lea     eax, [ebp+2A8h+ExceptionRecord]
.text:00403112		       mov     [ebp+2A8h+ExceptionPointers.ExceptionRecord], eax
.text:00403115		       lea     eax, [ebp+2A8h+ContextRecord]
.text:00403118		       add     esp, 0Ch
.text:0040311B		       mov     [ebp+2A8h+ExceptionRecord.ExceptionCode], 0C000000Dh
.text:00403122		       mov     [ebp+2A8h+ExceptionRecord.ExceptionAddress], esi
.text:00403125		       mov     [ebp+2A8h+ExceptionPointers.ContextRecord], eax
.text:00403128		       call    ds:__imp__IsDebuggerPresent@0 ; IsDebuggerPresent()
.text:0040312E		       push    0	       ; lpTopLevelExceptionFilter
.text:00403130		       mov     esi, eax
.text:00403132		       call    ds:__imp__SetUnhandledExceptionFilter@4 ; SetUnhandledExceptionFilter(x)
.text:00403138		       lea     eax, [ebp+2A8h+ExceptionPointers]
.text:0040313B		       push    eax	       ; ExceptionInfo
.text:0040313C		       call    ds:__imp__UnhandledExceptionFilter@4 ; UnhandledExceptionFilter(x)
.text:00403142		       test    eax, eax
.text:00403144		       jnz     short loc_403152
.text:00403146		       test    esi, esi
.text:00403148		       jnz     short loc_403152
.text:0040314A		       push    2	       ; _Reserved
.text:0040314C		       call    __crt_debugger_hook
.text:00403151		       pop     ecx
.text:00403152
.text:00403152 loc_403152:			       ; CODE XREF: __invoke_watson+C6j
.text:00403152					       ; __invoke_watson+CAj
.text:00403152		       push    0C000000Dh      ; uExitCode
.text:00403157		       call    ds:__imp__GetCurrentProcess@0 ; GetCurrentProcess()
.text:0040315D		       push    eax	       ; hProcess
.text:0040315E		       call    ds:__imp__TerminateProcess@8 ; TerminateProcess(x,x)
.text:00403164		       mov     ecx, [ebp+2A8h+var_4]
.text:0040316A		       xor     ecx, ebp
.text:0040316C		       pop     esi
.text:0040316D		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00403172		       add     ebp, 2A8h
.text:00403178		       leave
.text:00403179		       retn
.text:00403179 __invoke_watson endp
.text:00403179
.text:0040317A
.text:0040317A ; =============== S U B R O U T I N E =======================================
.text:0040317A
.text:0040317A
.text:0040317A ; void (__cdecl *__cdecl	_set_invalid_parameter_handler(void (__cdecl *pNew)(const wchar_t *, const wchar_t *, const wchar_t *, unsigned	int, unsigned int)))(const wchar_t *, const wchar_t *, const wchar_t *,	unsigned int, unsigned int)
.text:0040317A __set_invalid_parameter_handler proc near
.text:0040317A
.text:0040317A pNew	       = dword ptr  4
.text:0040317A
.text:0040317A		       push    esi
.text:0040317B		       push    ___pInvalidArgHandler ; codedptr
.text:00403181		       call    __decode_pointer
.text:00403186		       push    [esp+8+pNew]    ; ptr
.text:0040318A		       mov     esi, eax
.text:0040318C		       call    __encode_pointer
.text:00403191		       pop     ecx
.text:00403192		       pop     ecx
.text:00403193		       mov     ___pInvalidArgHandler, eax
.text:00403198		       mov     eax, esi
.text:0040319A		       pop     esi
.text:0040319B		       retn
.text:0040319B __set_invalid_parameter_handler endp
.text:0040319B
.text:0040319C
.text:0040319C ; =============== S U B R O U T I N E =======================================
.text:0040319C
.text:0040319C
.text:0040319C ; void (__cdecl *__cdecl	_get_invalid_parameter_handler())(const	wchar_t	*, const wchar_t *, const wchar_t *, unsigned int, unsigned int)
.text:0040319C __get_invalid_parameter_handler proc near
.text:0040319C		       push    ___pInvalidArgHandler ; codedptr
.text:004031A2		       call    __decode_pointer
.text:004031A7		       pop     ecx
.text:004031A8		       retn
.text:004031A8 __get_invalid_parameter_handler endp
.text:004031A8
.text:004031A9
.text:004031A9 ; =============== S U B R O U T I N E =======================================
.text:004031A9
.text:004031A9 ; Attributes: bp-based frame
.text:004031A9
.text:004031A9 ; void __cdecl _invoke_watson(const unsigned __int16 *pszExpression, const unsigned __int16 *pszFunction, const unsigned	__int16	*pszFile, unsigned int nLine, unsigned int pReserved)
.text:004031A9 ?_invoke_watson@@YAXPBG00II@Z proc near
.text:004031A9
.text:004031A9 pszExpression   = dword ptr  8
.text:004031A9 pszFunction     = dword ptr  0Ch
.text:004031A9 pszFile	       = dword ptr  10h
.text:004031A9 nLine	       = dword ptr  14h
.text:004031A9 pReserved       = dword ptr  18h
.text:004031A9
.text:004031A9		       push    ebp
.text:004031AA		       mov     ebp, esp
.text:004031AC		       pop     ebp
.text:004031AD		       jmp     __invoke_watson
.text:004031AD ?_invoke_watson@@YAXPBG00II@Z endp
.text:004031AD
.text:004031B2
.text:004031B2 ; =============== S U B R O U T I N E =======================================
.text:004031B2
.text:004031B2 ; Attributes: bp-based frame
.text:004031B2
.text:004031B2 ; void __cdecl _invalid_parameter(const wchar_t *pszExpression, const wchar_t *pszFunction, const wchar_t *pszFile, unsigned int	nLine, unsigned	int pReserved)
.text:004031B2 __invalid_parameter proc	near	       ; CODE XREF: _printf+2Ap
.text:004031B2					       ; __get_osplatform+1Bp ...
.text:004031B2
.text:004031B2 pszExpression   = dword ptr  8
.text:004031B2 pszFunction     = dword ptr  0Ch
.text:004031B2 pszFile	       = dword ptr  10h
.text:004031B2 nLine	       = dword ptr  14h
.text:004031B2 pReserved       = dword ptr  18h
.text:004031B2
.text:004031B2		       push    ebp
.text:004031B3		       mov     ebp, esp
.text:004031B5		       push    ___pInvalidArgHandler ; codedptr
.text:004031BB		       call    __decode_pointer
.text:004031C0		       test    eax, eax
.text:004031C2		       pop     ecx
.text:004031C3		       jz      short loc_4031C8
.text:004031C5		       pop     ebp
.text:004031C6		       jmp     eax
.text:004031C8 ; ---------------------------------------------------------------------------
.text:004031C8
.text:004031C8 loc_4031C8:			       ; CODE XREF: __invalid_parameter+11j
.text:004031C8		       push    2	       ; _Reserved
.text:004031CA		       call    __crt_debugger_hook
.text:004031CF		       pop     ecx
.text:004031D0		       pop     ebp
.text:004031D1		       jmp     __invoke_watson
.text:004031D1 __invalid_parameter endp
.text:004031D1
.text:004031D6
.text:004031D6 ; =============== S U B R O U T I N E =======================================
.text:004031D6
.text:004031D6
.text:004031D6 __invalid_parameter_noinfo proc near
.text:004031D6		       xor     eax, eax
.text:004031D8		       push    eax	       ; pReserved
.text:004031D9		       push    eax	       ; nLine
.text:004031DA		       push    eax	       ; pszFile
.text:004031DB		       push    eax	       ; pszFunction
.text:004031DC		       push    eax	       ; pszExpression
.text:004031DD		       call    __invalid_parameter
.text:004031E2		       add     esp, 14h
.text:004031E5		       retn
.text:004031E5 __invalid_parameter_noinfo endp
.text:004031E5
.text:004031E6
.text:004031E6 ; =============== S U B R O U T I N E =======================================
.text:004031E6
.text:004031E6 ; Attributes: bp-based frame
.text:004031E6
.text:004031E6 ; void __cdecl _invalid_parameter(const unsigned	__int16	*pszExpression,	const unsigned __int16 *pszFunction, const unsigned __int16 *pszFile, unsigned int nLine, unsigned int pReserved)
.text:004031E6 ?_invalid_parameter@@YAXPBG00II@Z proc near
.text:004031E6
.text:004031E6 pszExpression   = dword ptr  8
.text:004031E6 pszFunction     = dword ptr  0Ch
.text:004031E6 pszFile	       = dword ptr  10h
.text:004031E6 nLine	       = dword ptr  14h
.text:004031E6 pReserved       = dword ptr  18h
.text:004031E6
.text:004031E6		       push    ebp
.text:004031E7		       mov     ebp, esp
.text:004031E9		       pop     ebp
.text:004031EA		       jmp     __invalid_parameter
.text:004031EA ?_invalid_parameter@@YAXPBG00II@Z endp
.text:004031EA
.text:004031EF
.text:004031EF ; =============== S U B R O U T I N E =======================================
.text:004031EF
.text:004031EF
.text:004031EF ; int __cdecl _get_errno_from_oserr(unsigned int	oserrno)
.text:004031EF __get_errno_from_oserr proc near	       ; CODE XREF: _free+80p
.text:004031EF					       ; __dosmaperr+Dp ...
.text:004031EF
.text:004031EF oserrno	       = dword ptr  4
.text:004031EF
.text:004031EF		       mov     eax, [esp+oserrno]
.text:004031F3		       xor     ecx, ecx
.text:004031F5
.text:004031F5 loc_4031F5:			       ; CODE XREF: __get_errno_from_oserr+13j
.text:004031F5		       cmp     eax, errtable.oscode[ecx*8]
.text:004031FC		       jz      short loc_403210
.text:004031FE		       inc     ecx
.text:004031FF		       cmp     ecx, 2Dh
.text:00403202		       jb      short loc_4031F5
.text:00403204		       lea     ecx, [eax-13h]
.text:00403207		       cmp     ecx, 11h
.text:0040320A		       ja      short loc_403218
.text:0040320C		       push    0Dh
.text:0040320E		       pop     eax
.text:0040320F		       retn
.text:00403210 ; ---------------------------------------------------------------------------
.text:00403210
.text:00403210 loc_403210:			       ; CODE XREF: __get_errno_from_oserr+Dj
.text:00403210		       mov     eax, errtable.errnocode[ecx*8]
.text:00403217		       retn
.text:00403218 ; ---------------------------------------------------------------------------
.text:00403218
.text:00403218 loc_403218:			       ; CODE XREF: __get_errno_from_oserr+1Bj
.text:00403218		       add     eax, 0FFFFFF44h
.text:0040321D		       push    0Eh
.text:0040321F		       pop     ecx
.text:00403220		       cmp     ecx, eax
.text:00403222		       sbb     eax, eax
.text:00403224		       and     eax, ecx
.text:00403226		       add     eax, 8
.text:00403229		       retn
.text:00403229 __get_errno_from_oserr endp
.text:00403229
.text:0040322A
.text:0040322A ; =============== S U B R O U T I N E =======================================
.text:0040322A
.text:0040322A
.text:0040322A ; int *__cdecl _errno()
.text:0040322A __errno	       proc near	       ; CODE XREF: _printf+1Ap
.text:0040322A					       ; _free+72p ...
.text:0040322A		       call    __getptd_noexit
.text:0040322F		       test    eax, eax
.text:00403231		       jnz     short loc_403239
.text:00403233		       mov     eax, offset ErrnoNoMem
.text:00403238		       retn
.text:00403239 ; ---------------------------------------------------------------------------
.text:00403239
.text:00403239 loc_403239:			       ; CODE XREF: __errno+7j
.text:00403239		       add     eax, 8
.text:0040323C		       retn
.text:0040323C __errno	       endp
.text:0040323C
.text:0040323D
.text:0040323D ; =============== S U B R O U T I N E =======================================
.text:0040323D
.text:0040323D
.text:0040323D ; unsigned int *__cdecl __doserrno()
.text:0040323D ___doserrno     proc near	       ; CODE XREF: __dosmaperr+1p
.text:0040323D					       ; __set_doserrno:loc_4032C0p ...
.text:0040323D		       call    __getptd_noexit
.text:00403242		       test    eax, eax
.text:00403244		       jnz     short loc_40324C
.text:00403246		       mov     eax, offset DoserrorNoMem
.text:0040324B		       retn
.text:0040324C ; ---------------------------------------------------------------------------
.text:0040324C
.text:0040324C loc_40324C:			       ; CODE XREF: ___doserrno+7j
.text:0040324C		       add     eax, 0Ch
.text:0040324F		       retn
.text:0040324F ___doserrno     endp
.text:0040324F
.text:00403250
.text:00403250 ; =============== S U B R O U T I N E =======================================
.text:00403250
.text:00403250
.text:00403250 ; void __cdecl _dosmaperr(unsigned int oserrno)
.text:00403250 __dosmaperr     proc near	       ; CODE XREF: __write_nolock+5CCp
.text:00403250					       ; __lseeki64_nolock+58p	...
.text:00403250
.text:00403250 oserrno	       = dword ptr  4
.text:00403250
.text:00403250		       push    esi
.text:00403251		       call    ___doserrno
.text:00403256		       mov     ecx, [esp+4+oserrno]
.text:0040325A		       push    ecx	       ; oserrno
.text:0040325B		       mov     [eax], ecx
.text:0040325D		       call    __get_errno_from_oserr
.text:00403262		       pop     ecx
.text:00403263		       mov     esi, eax
.text:00403265		       call    __errno
.text:0040326A		       mov     [eax], esi
.text:0040326C		       pop     esi
.text:0040326D		       retn
.text:0040326D __dosmaperr     endp
.text:0040326D
.text:0040326E
.text:0040326E ; =============== S U B R O U T I N E =======================================
.text:0040326E
.text:0040326E
.text:0040326E ; int __cdecl _set_errno(int value)
.text:0040326E __set_errno     proc near
.text:0040326E
.text:0040326E value	       = dword ptr  4
.text:0040326E
.text:0040326E		       call    __getptd_noexit
.text:00403273		       test    eax, eax
.text:00403275		       jnz     short loc_40327B
.text:00403277		       push    0Ch
.text:00403279		       pop     eax
.text:0040327A		       retn
.text:0040327B ; ---------------------------------------------------------------------------
.text:0040327B
.text:0040327B loc_40327B:			       ; CODE XREF: __set_errno+7j
.text:0040327B		       call    __errno
.text:00403280		       mov     ecx, [esp+value]
.text:00403284		       mov     [eax], ecx
.text:00403286		       xor     eax, eax
.text:00403288		       retn
.text:00403288 __set_errno     endp
.text:00403288
.text:00403289
.text:00403289 ; =============== S U B R O U T I N E =======================================
.text:00403289
.text:00403289
.text:00403289 ; int __cdecl _get_errno(int *pValue)
.text:00403289 __get_errno     proc near
.text:00403289
.text:00403289 pValue	       = dword ptr  4
.text:00403289
.text:00403289		       push    esi
.text:0040328A		       mov     esi, [esp+4+pValue]
.text:0040328E		       xor     eax, eax
.text:00403290		       cmp     esi, eax
.text:00403292		       jnz     short loc_4032A6
.text:00403294		       push    eax	       ; pReserved
.text:00403295		       push    eax	       ; nLine
.text:00403296		       push    eax	       ; pszFile
.text:00403297		       push    eax	       ; pszFunction
.text:00403298		       push    eax	       ; pszExpression
.text:00403299		       call    __invalid_parameter
.text:0040329E		       add     esp, 14h
.text:004032A1		       push    16h
.text:004032A3		       pop     eax
.text:004032A4		       pop     esi
.text:004032A5		       retn
.text:004032A6 ; ---------------------------------------------------------------------------
.text:004032A6
.text:004032A6 loc_4032A6:			       ; CODE XREF: __get_errno+9j
.text:004032A6		       call    __errno
.text:004032AB		       mov     eax, [eax]
.text:004032AD		       mov     [esi], eax
.text:004032AF		       xor     eax, eax
.text:004032B1		       pop     esi
.text:004032B2		       retn
.text:004032B2 __get_errno     endp
.text:004032B2
.text:004032B3
.text:004032B3 ; =============== S U B R O U T I N E =======================================
.text:004032B3
.text:004032B3
.text:004032B3 ; int __cdecl _set_doserrno(unsigned int	value)
.text:004032B3 __set_doserrno  proc near
.text:004032B3
.text:004032B3 value	       = dword ptr  4
.text:004032B3
.text:004032B3		       call    __getptd_noexit
.text:004032B8		       test    eax, eax
.text:004032BA		       jnz     short loc_4032C0
.text:004032BC		       push    0Ch
.text:004032BE		       pop     eax
.text:004032BF		       retn
.text:004032C0 ; ---------------------------------------------------------------------------
.text:004032C0
.text:004032C0 loc_4032C0:			       ; CODE XREF: __set_doserrno+7j
.text:004032C0		       call    ___doserrno
.text:004032C5		       mov     ecx, [esp+value]
.text:004032C9		       mov     [eax], ecx
.text:004032CB		       xor     eax, eax
.text:004032CD		       retn
.text:004032CD __set_doserrno  endp
.text:004032CD
.text:004032CE
.text:004032CE ; =============== S U B R O U T I N E =======================================
.text:004032CE
.text:004032CE
.text:004032CE ; int __cdecl _get_doserrno(unsigned int	*pValue)
.text:004032CE __get_doserrno  proc near
.text:004032CE
.text:004032CE pValue	       = dword ptr  4
.text:004032CE
.text:004032CE		       push    esi
.text:004032CF		       mov     esi, [esp+4+pValue]
.text:004032D3		       xor     eax, eax
.text:004032D5		       cmp     esi, eax
.text:004032D7		       jnz     short loc_4032EB
.text:004032D9		       push    eax	       ; pReserved
.text:004032DA		       push    eax	       ; nLine
.text:004032DB		       push    eax	       ; pszFile
.text:004032DC		       push    eax	       ; pszFunction
.text:004032DD		       push    eax	       ; pszExpression
.text:004032DE		       call    __invalid_parameter
.text:004032E3		       add     esp, 14h
.text:004032E6		       push    16h
.text:004032E8		       pop     eax
.text:004032E9		       pop     esi
.text:004032EA		       retn
.text:004032EB ; ---------------------------------------------------------------------------
.text:004032EB
.text:004032EB loc_4032EB:			       ; CODE XREF: __get_doserrno+9j
.text:004032EB		       call    ___doserrno
.text:004032F0		       mov     eax, [eax]
.text:004032F2		       mov     [esi], eax
.text:004032F4		       xor     eax, eax
.text:004032F6		       pop     esi
.text:004032F7		       retn
.text:004032F7 __get_doserrno  endp
.text:004032F7
.text:004032F8 ; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4. PRESS KEYPAD "+" TO	EXPAND]
.text:0040333D ; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4. PRESS KEYPAD "+" TO	EXPAND]
.text:00403351		       align 10h
.text:00403360
.text:00403360 ; =============== S U B R O U T I N E =======================================
.text:00403360
.text:00403360
.text:00403360 ; void __usercall ValidateLocalCookies(_EH4_SCOPETABLE *ScopeTable<edi>,	char *FramePointer<esi>)
.text:00403360 ValidateLocalCookies proc near
.text:00403360 ScopeTable = edi
.text:00403360 FramePointer = esi
.text:00403360		       mov     eax, [ScopeTable]
.text:00403362		       cmp     eax, 0FFFFFFFEh
.text:00403365		       jz      short loc_403374
.text:00403367		       mov     ecx, [ScopeTable+4]
.text:0040336A		       add     ecx, FramePointer
.text:0040336C		       xor     ecx, [eax+FramePointer] ; cookie
.text:0040336F		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00403374
.text:00403374 loc_403374:			       ; CODE XREF: ValidateLocalCookies+5j
.text:00403374		       mov     ecx, [ScopeTable+0Ch]
.text:00403377		       mov     eax, [ScopeTable+8]
.text:0040337A		       add     ecx, FramePointer
.text:0040337C		       xor     ecx, [eax+FramePointer]
.text:0040337F		       jmp     @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040337F ValidateLocalCookies endp
.text:0040337F
.text:0040337F ; ---------------------------------------------------------------------------
.text:00403384		       align 10h
.text:00403390
.text:00403390 ; =============== S U B R O U T I N E =======================================
.text:00403390
.text:00403390
.text:00403390 ; _EXCEPTION_DISPOSITION	__cdecl	_except_handler4(_EXCEPTION_RECORD *ExceptionRecord, _EXCEPTION_REGISTRATION_RECORD *EstablisherFrame, _CONTEXT	*ContextRecord,	void *DispatcherContext)
.text:00403390 __except_handler4 proc near	       ; DATA XREF: __SEH_prolog4o
.text:00403390					       ; __IsNonwritableInCurrentImage+Ao
.text:00403390
.text:00403390 Revalidate      = byte ptr -15h
.text:00403390 EnclosingLevel  = dword ptr -14h
.text:00403390 Disposition     = dword ptr -10h
.text:00403390 ExceptionPointers= _EXCEPTION_POINTERS ptr -0Ch
.text:00403390 var_4	       = dword ptr -4
.text:00403390 ExceptionRecord = dword ptr  4
.text:00403390 EstablisherFrame= dword ptr  8
.text:00403390 ContextRecord   = dword ptr  0Ch
.text:00403390 DispatcherContext= dword	ptr  10h
.text:00403390
.text:00403390		       sub     esp, 14h
.text:00403393		       push    ebx
.text:00403394		       mov     ebx, [esp+18h+EstablisherFrame]
.text:00403398		       push    ebp
.text:00403399		       push    esi
.text:0040339A		       mov     esi, [ebx+8]
.text:0040339D		       xor     esi, ___security_cookie
.text:004033A3		       push    edi
.text:004033A4		       mov     eax, [esi]
.text:004033A6		       cmp     eax, 0FFFFFFFEh
.text:004033A9		       mov     byte ptr	[esp+24h+EnclosingLevel+3], 0
.text:004033AE		       mov     [esp+24h+ExceptionPointers.ExceptionRecord], 1
.text:004033B6		       lea     edi, [ebx+10h]
.text:004033B9		       jz      short loc_4033C8
.text:004033BB		       mov     ecx, [esi+4]
.text:004033BE		       add     ecx, edi
.text:004033C0		       xor     ecx, [eax+edi]  ; cookie
.text:004033C3		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004033C8
.text:004033C8 loc_4033C8:			       ; CODE XREF: __except_handler4+29j
.text:004033C8		       mov     ecx, [esi+0Ch]
.text:004033CB		       mov     eax, [esi+8]
.text:004033CE		       add     ecx, edi
.text:004033D0		       xor     ecx, [eax+edi]  ; cookie
.text:004033D3		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004033D8		       mov     eax, [esp+24h+ExceptionRecord]
.text:004033DC		       test    byte ptr	[eax+4], 66h
.text:004033E0		       jnz     loc_403505
.text:004033E6		       mov     ebp, [ebx+0Ch]
.text:004033E9		       cmp     ebp, 0FFFFFFFEh
.text:004033EC		       mov     ecx, [esp+24h+ContextRecord]
.text:004033F0		       lea     edx, [esp+24h+ExceptionPointers.ContextRecord]
.text:004033F4		       mov     [esp+24h+ExceptionPointers.ContextRecord], eax
.text:004033F8		       mov     [esp+24h+var_4],	ecx
.text:004033FC		       mov     [ebx-4],	edx
.text:004033FF		       jz      short loc_40345F
.text:00403401
.text:00403401 loc_403401:			       ; CODE XREF: __except_handler4+A2j
.text:00403401		       lea     eax, [ebp+ebp*2+0]
.text:00403405		       mov     ecx, [esi+eax*4+14h]
.text:00403409		       test    ecx, ecx
.text:0040340B		       lea     ebx, [esi+eax*4+10h]
.text:0040340F		       mov     eax, [ebx]
.text:00403411		       mov     [esp+24h+Disposition], eax
.text:00403415		       jz      short loc_40342D
.text:00403417		       mov     edx, edi
.text:00403419		       call    @_EH4_CallFilterFunc@8 ;	_EH4_CallFilterFunc(x,x)
.text:0040341E		       test    eax, eax
.text:00403420		       mov     byte ptr	[esp+24h+EnclosingLevel+3], 1
.text:00403425		       jl      short loc_40346B
.text:00403427		       jg      short loc_403475
.text:00403429		       mov     eax, [esp+24h+Disposition]
.text:0040342D
.text:0040342D loc_40342D:			       ; CODE XREF: __except_handler4+85j
.text:0040342D		       cmp     eax, 0FFFFFFFEh
.text:00403430		       mov     ebp, eax
.text:00403432		       jnz     short loc_403401
.text:00403434		       cmp     byte ptr	[esp+24h+EnclosingLevel+3], 0
.text:00403439		       jz      short loc_40345F
.text:0040343B
.text:0040343B loc_40343B:			       ; CODE XREF: __except_handler4+E3j
.text:0040343B					       ; __except_handler4+191j
.text:0040343B		       mov     eax, [esi]
.text:0040343D		       cmp     eax, 0FFFFFFFEh
.text:00403440		       jz      short loc_40344F
.text:00403442		       mov     ecx, [esi+4]
.text:00403445		       add     ecx, edi
.text:00403447		       xor     ecx, [eax+edi]  ; cookie
.text:0040344A		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040344F
.text:0040344F loc_40344F:			       ; CODE XREF: __except_handler4+B0j
.text:0040344F		       mov     ecx, [esi+0Ch]
.text:00403452		       mov     eax, [esi+8]
.text:00403455		       add     ecx, edi
.text:00403457		       xor     ecx, [eax+edi]  ; cookie
.text:0040345A		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040345F
.text:0040345F loc_40345F:			       ; CODE XREF: __except_handler4+6Fj
.text:0040345F					       ; __except_handler4+A9j	...
.text:0040345F		       mov     eax, [esp+24h+ExceptionPointers.ExceptionRecord]
.text:00403463		       pop     edi
.text:00403464		       pop     esi
.text:00403465		       pop     ebp
.text:00403466		       pop     ebx
.text:00403467		       add     esp, 14h
.text:0040346A		       retn
.text:0040346B ; ---------------------------------------------------------------------------
.text:0040346B
.text:0040346B loc_40346B:			       ; CODE XREF: __except_handler4+95j
.text:0040346B		       mov     [esp+24h+ExceptionPointers.ExceptionRecord], 0
.text:00403473		       jmp     short loc_40343B
.text:00403475 ; ---------------------------------------------------------------------------
.text:00403475
.text:00403475 loc_403475:			       ; CODE XREF: __except_handler4+97j
.text:00403475		       mov     ecx, [esp+24h+ExceptionRecord]
.text:00403479		       cmp     dword ptr [ecx],	0E06D7363h
.text:0040347F		       jnz     short loc_4034AB
.text:00403481		       cmp     __pDestructExceptionObject, 0
.text:00403488		       jz      short loc_4034AB
.text:0040348A		       push    offset __pDestructExceptionObject ; pTarget
.text:0040348F		       call    __IsNonwritableInCurrentImage
.text:00403494		       add     esp, 4
.text:00403497		       test    eax, eax
.text:00403499		       jz      short loc_4034AB
.text:0040349B		       mov     edx, [esp+24h+ExceptionRecord]
.text:0040349F		       push    1
.text:004034A1		       push    edx
.text:004034A2		       call    __pDestructExceptionObject
.text:004034A8		       add     esp, 8
.text:004034AB
.text:004034AB loc_4034AB:			       ; CODE XREF: __except_handler4+EFj
.text:004034AB					       ; __except_handler4+F8j	...
.text:004034AB		       mov     ecx, [esp+24h+EstablisherFrame]
.text:004034AF		       call    @_EH4_GlobalUnwind@4 ; _EH4_GlobalUnwind(x)
.text:004034B4		       mov     eax, [esp+24h+EstablisherFrame]
.text:004034B8		       cmp     [eax+0Ch], ebp
.text:004034BB		       jz      short loc_4034D0
.text:004034BD		       push    offset ___security_cookie
.text:004034C2		       push    edi
.text:004034C3		       mov     edx, ebp
.text:004034C5		       mov     ecx, eax
.text:004034C7		       call    @_EH4_LocalUnwind@16 ; _EH4_LocalUnwind(x,x,x,x)
.text:004034CC		       mov     eax, [esp+1Ch+DispatcherContext]
.text:004034D0
.text:004034D0 loc_4034D0:			       ; CODE XREF: __except_handler4+12Bj
.text:004034D0		       mov     ecx, [esp+1Ch+ExceptionPointers.ContextRecord]
.text:004034D4		       mov     [eax+0Ch], ecx
.text:004034D7		       mov     eax, [esi]
.text:004034D9		       cmp     eax, 0FFFFFFFEh
.text:004034DC		       jz      short loc_4034EB
.text:004034DE		       mov     ecx, [esi+4]
.text:004034E1		       add     ecx, edi
.text:004034E3		       xor     ecx, [eax+edi]  ; cookie
.text:004034E6		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004034EB
.text:004034EB loc_4034EB:			       ; CODE XREF: __except_handler4+14Cj
.text:004034EB		       mov     ecx, [esi+0Ch]
.text:004034EE		       mov     edx, [esi+8]
.text:004034F1		       add     ecx, edi
.text:004034F3		       xor     ecx, [edx+edi]  ; cookie
.text:004034F6		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004034FB		       mov     ecx, [ebx+8]
.text:004034FE		       mov     edx, edi
.text:00403500		       jmp     @_EH4_TransferToHandler@8 ; _EH4_TransferToHandler(x,x)
.text:00403505 ; ---------------------------------------------------------------------------
.text:00403505
.text:00403505 loc_403505:			       ; CODE XREF: __except_handler4+50j
.text:00403505		       cmp     dword ptr [ebx+0Ch], 0FFFFFFFEh
.text:00403509		       jz      loc_40345F
.text:0040350F		       push    offset ___security_cookie
.text:00403514		       push    edi
.text:00403515		       mov     ecx, ebx
.text:00403517		       mov     edx, 0FFFFFFFEh
.text:0040351C		       call    @_EH4_LocalUnwind@16 ; _EH4_LocalUnwind(x,x,x,x)
.text:00403521		       jmp     loc_40343B
.text:00403521 __except_handler4 endp ;	sp-analysis failed
.text:00403521
.text:00403526
.text:00403526 ; =============== S U B R O U T I N E =======================================
.text:00403526
.text:00403526 ; Attributes: bp-based frame
.text:00403526
.text:00403526 ; int __cdecl vprintf_helper(int	(__cdecl *outfn)(_iobuf	*, const char *, localeinfo_struct *, char *), const char *format, localeinfo_struct *plocinfo,	char *ap)
.text:00403526 _vprintf_helper proc near	       ; CODE XREF: __vprintf_l+11p
.text:00403526					       ; __vprintf_s_l+11p ...
.text:00403526
.text:00403526 retval	       = dword ptr -20h
.text:00403526 stream	       = dword ptr -1Ch
.text:00403526 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00403526 outfn	       = dword ptr  8
.text:00403526 format	       = dword ptr  0Ch
.text:00403526 plocinfo	       = dword ptr  10h
.text:00403526 ap	       = dword ptr  14h
.text:00403526
.text:00403526		       push    10h
.text:00403528		       push    offset dword_421510
.text:0040352D		       call    __SEH_prolog4
.text:00403532		       call    ___iob_func
.text:00403537		       mov     esi, eax
.text:00403539		       add     esi, 20h
.text:0040353C		       mov     [ebp+stream], esi
.text:0040353F		       xor     eax, eax
.text:00403541		       xor     edi, edi
.text:00403543		       cmp     [ebp+format], edi
.text:00403546		       setnz   al
.text:00403549		       cmp     eax, edi
.text:0040354B		       jnz     short loc_40356A
.text:0040354D		       call    __errno
.text:00403552		       mov     dword ptr [eax],	16h
.text:00403558		       push    edi	       ; pReserved
.text:00403559		       push    edi	       ; nLine
.text:0040355A		       push    edi	       ; pszFile
.text:0040355B		       push    edi	       ; pszFunction
.text:0040355C		       push    edi	       ; pszExpression
.text:0040355D		       call    __invalid_parameter
.text:00403562		       add     esp, 14h
.text:00403565		       or      eax, 0FFFFFFFFh
.text:00403568		       jmp     short loc_4035A5
.text:0040356A ; ---------------------------------------------------------------------------
.text:0040356A
.text:0040356A loc_40356A:			       ; CODE XREF: _vprintf_helper+25j
.text:0040356A		       push    esi	       ; pf
.text:0040356B		       call    __lock_file
.text:00403570		       pop     ecx
.text:00403571		       mov     [ebp+ms_exc.disabled], edi
.text:00403574		       push    esi	       ; str
.text:00403575		       call    __stbuf
.text:0040357A		       mov     edi, eax
.text:0040357C		       push    [ebp+ap]
.text:0040357F		       push    [ebp+plocinfo]
.text:00403582		       push    [ebp+format]
.text:00403585		       push    esi
.text:00403586		       call    [ebp+outfn]
.text:00403589		       mov     [ebp+retval], eax
.text:0040358C		       push    esi	       ; str
.text:0040358D		       push    edi	       ; flag
.text:0040358E		       call    __ftbuf
.text:00403593		       add     esp, 1Ch
.text:00403596		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040359D		       call    $LN8
.text:004035A2
.text:004035A2 $LN9_1:
.text:004035A2		       mov     eax, [ebp+retval]
.text:004035A5
.text:004035A5 loc_4035A5:			       ; CODE XREF: _vprintf_helper+42j
.text:004035A5		       call    __SEH_epilog4
.text:004035AA		       retn
.text:004035AB ; ---------------------------------------------------------------------------
.text:004035AB
.text:004035AB $LN6_1:				       ; DATA XREF: .rdata:00421528o
.text:004035AB		       mov     esi, [ebp+stream]
.text:004035AE
.text:004035AE $LN8:				       ; CODE XREF: _vprintf_helper+77p
.text:004035AE		       push    esi	       ; pf
.text:004035AF		       call    __unlock_file
.text:004035B4		       pop     ecx
.text:004035B5
.text:004035B5 $LN7_1:
.text:004035B5		       retn
.text:004035B5 _vprintf_helper endp ; sp-analysis failed
.text:004035B5
.text:004035B6
.text:004035B6 ; =============== S U B R O U T I N E =======================================
.text:004035B6
.text:004035B6
.text:004035B6 ; int __cdecl _vprintf_l(const char *format, localeinfo_struct *plocinfo, char *ap)
.text:004035B6 __vprintf_l     proc near	       ; CODE XREF: __printf_l+Dp
.text:004035B6
.text:004035B6 format	       = dword ptr  4
.text:004035B6 plocinfo	       = dword ptr  8
.text:004035B6 ap	       = dword ptr  0Ch
.text:004035B6
.text:004035B6		       push    [esp+ap]	       ; ap
.text:004035BA		       push    [esp+4+plocinfo]	; plocinfo
.text:004035BE		       push    [esp+8+format]  ; format
.text:004035C2		       push    offset __output_l ; outfn
.text:004035C7		       call    _vprintf_helper
.text:004035CC		       add     esp, 10h
.text:004035CF		       retn
.text:004035CF __vprintf_l     endp
.text:004035CF
.text:004035D0
.text:004035D0 ; =============== S U B R O U T I N E =======================================
.text:004035D0
.text:004035D0
.text:004035D0 ; int __cdecl _vprintf_s_l(const	char *format, localeinfo_struct	*plocinfo, char	*ap)
.text:004035D0 __vprintf_s_l   proc near	       ; CODE XREF: __printf_s_l+Dp
.text:004035D0					       ; _printf_s+Bp
.text:004035D0
.text:004035D0 format	       = dword ptr  4
.text:004035D0 plocinfo	       = dword ptr  8
.text:004035D0 ap	       = dword ptr  0Ch
.text:004035D0
.text:004035D0		       push    [esp+ap]	       ; ap
.text:004035D4		       push    [esp+4+plocinfo]	; plocinfo
.text:004035D8		       push    [esp+8+format]  ; format
.text:004035DC		       push    offset __output_s_l ; outfn
.text:004035E1		       call    _vprintf_helper
.text:004035E6		       add     esp, 10h
.text:004035E9		       retn
.text:004035E9 __vprintf_s_l   endp
.text:004035E9
.text:004035EA
.text:004035EA ; =============== S U B R O U T I N E =======================================
.text:004035EA
.text:004035EA
.text:004035EA ; int __cdecl _vprintf_p_l(const	char *format, localeinfo_struct	*plocinfo, char	*ap)
.text:004035EA __vprintf_p_l   proc near	       ; CODE XREF: __printf_p_l+Dp
.text:004035EA					       ; __printf_p+Bp
.text:004035EA
.text:004035EA format	       = dword ptr  4
.text:004035EA plocinfo	       = dword ptr  8
.text:004035EA ap	       = dword ptr  0Ch
.text:004035EA
.text:004035EA		       push    [esp+ap]	       ; ap
.text:004035EE		       push    [esp+4+plocinfo]	; plocinfo
.text:004035F2		       push    [esp+8+format]  ; format
.text:004035F6		       push    offset __output_p_l ; outfn
.text:004035FB		       call    _vprintf_helper
.text:00403600		       add     esp, 10h
.text:00403603		       retn
.text:00403603 __vprintf_p_l   endp
.text:00403603
.text:00403604
.text:00403604 ; =============== S U B R O U T I N E =======================================
.text:00403604
.text:00403604
.text:00403604 ; int __cdecl vprintf(const char	*format, char *ap)
.text:00403604 _vprintf	       proc near
.text:00403604
.text:00403604 format	       = dword ptr  4
.text:00403604 ap	       = dword ptr  8
.text:00403604
.text:00403604		       push    [esp+ap]	       ; ap
.text:00403608		       push    0	       ; plocinfo
.text:0040360A		       push    [esp+8+format]  ; format
.text:0040360E		       push    offset __output_l ; outfn
.text:00403613		       call    _vprintf_helper
.text:00403618		       add     esp, 10h
.text:0040361B		       retn
.text:0040361B _vprintf	       endp
.text:0040361B
.text:0040361C
.text:0040361C ; =============== S U B R O U T I N E =======================================
.text:0040361C
.text:0040361C
.text:0040361C ; int __cdecl vprintf_s(const char *format, char	*ap)
.text:0040361C _vprintf_s      proc near
.text:0040361C
.text:0040361C format	       = dword ptr  4
.text:0040361C ap	       = dword ptr  8
.text:0040361C
.text:0040361C		       push    [esp+ap]	       ; ap
.text:00403620		       push    0	       ; plocinfo
.text:00403622		       push    [esp+8+format]  ; format
.text:00403626		       push    offset __output_s_l ; outfn
.text:0040362B		       call    _vprintf_helper
.text:00403630		       add     esp, 10h
.text:00403633		       retn
.text:00403633 _vprintf_s      endp
.text:00403633
.text:00403634
.text:00403634 ; =============== S U B R O U T I N E =======================================
.text:00403634
.text:00403634
.text:00403634 ; int __cdecl _vprintf_p(const char *format, char *ap)
.text:00403634 __vprintf_p     proc near
.text:00403634
.text:00403634 format	       = dword ptr  4
.text:00403634 ap	       = dword ptr  8
.text:00403634
.text:00403634		       push    [esp+ap]	       ; ap
.text:00403638		       push    0	       ; plocinfo
.text:0040363A		       push    [esp+8+format]  ; format
.text:0040363E		       push    offset __output_p_l ; outfn
.text:00403643		       call    _vprintf_helper
.text:00403648		       add     esp, 10h
.text:0040364B		       retn
.text:0040364B __vprintf_p     endp
.text:0040364B
.text:0040364C
.text:0040364C ; =============== S U B R O U T I N E =======================================
.text:0040364C
.text:0040364C ; Attributes: bp-based frame
.text:0040364C
.text:0040364C ; void __cdecl _invoke_watson_if_error(int _ExpressionError, const wchar_t *_Expression,	const wchar_t *_Function, const	wchar_t	*_File,	unsigned int _Line, unsigned int _Reserved)
.text:0040364C __invoke_watson_if_error	proc near
.text:0040364C
.text:0040364C _ExpressionError= dword ptr  8
.text:0040364C _Expression     = dword ptr  0Ch
.text:0040364C _Function       = dword ptr  10h
.text:0040364C _File	       = dword ptr  14h
.text:0040364C _Line	       = dword ptr  18h
.text:0040364C _Reserved       = dword ptr  1Ch
.text:0040364C
.text:0040364C		       push    ebp
.text:0040364D		       mov     ebp, esp
.text:0040364F		       cmp     [ebp+_ExpressionError], 0
.text:00403653		       jz      short loc_40366C
.text:00403655		       push    [ebp+_Reserved] ; pReserved
.text:00403658		       push    [ebp+_Line]     ; nLine
.text:0040365B		       push    [ebp+_File]     ; pszFile
.text:0040365E		       push    [ebp+_Function] ; pszFunction
.text:00403661		       push    [ebp+_Expression] ; pszExpression
.text:00403664		       call    __invoke_watson
.text:00403669		       add     esp, 14h
.text:0040366C
.text:0040366C loc_40366C:			       ; CODE XREF: __invoke_watson_if_error+7j
.text:0040366C		       pop     ebp
.text:0040366D		       retn
.text:0040366D __invoke_watson_if_error	endp
.text:0040366D
.text:0040366E
.text:0040366E ; =============== S U B R O U T I N E =======================================
.text:0040366E
.text:0040366E ; Attributes: bp-based frame
.text:0040366E
.text:0040366E ; int __cdecl __heap_select()
.text:0040366E ___heap_select  proc near	       ; CODE XREF: __heap_init:loc_4036ECp
.text:0040366E
.text:0040366E winmajor	       = dword ptr -8
.text:0040366E osplatform      = dword ptr -4
.text:0040366E
.text:0040366E		       push    ebp
.text:0040366F		       mov     ebp, esp
.text:00403671		       push    ecx
.text:00403672		       push    ecx
.text:00403673		       push    esi
.text:00403674		       lea     eax, [ebp+osplatform]
.text:00403677		       xor     esi, esi
.text:00403679		       push    eax	       ; pValue
.text:0040367A		       mov     [ebp+osplatform], esi
.text:0040367D		       mov     [ebp+winmajor], esi
.text:00403680		       call    __get_osplatform
.text:00403685		       test    eax, eax
.text:00403687		       pop     ecx
.text:00403688		       jz      short loc_403697
.text:0040368A		       push    esi	       ; pReserved
.text:0040368B		       push    esi	       ; nLine
.text:0040368C		       push    esi	       ; pszFile
.text:0040368D		       push    esi	       ; pszFunction
.text:0040368E		       push    esi	       ; pszExpression
.text:0040368F		       call    __invoke_watson
.text:00403694		       add     esp, 14h
.text:00403697
.text:00403697 loc_403697:			       ; CODE XREF: ___heap_select+1Aj
.text:00403697		       lea     eax, [ebp+winmajor]
.text:0040369A		       push    eax	       ; pValue
.text:0040369B		       call    __get_winmajor
.text:004036A0		       test    eax, eax
.text:004036A2		       pop     ecx
.text:004036A3		       jz      short loc_4036B2
.text:004036A5		       push    esi	       ; pReserved
.text:004036A6		       push    esi	       ; nLine
.text:004036A7		       push    esi	       ; pszFile
.text:004036A8		       push    esi	       ; pszFunction
.text:004036A9		       push    esi	       ; pszExpression
.text:004036AA		       call    __invoke_watson
.text:004036AF		       add     esp, 14h
.text:004036B2
.text:004036B2 loc_4036B2:			       ; CODE XREF: ___heap_select+35j
.text:004036B2		       cmp     [ebp+osplatform], 2
.text:004036B6		       pop     esi
.text:004036B7		       jnz     short loc_4036C4
.text:004036B9		       cmp     [ebp+winmajor], 5
.text:004036BD		       jb      short loc_4036C4
.text:004036BF		       xor     eax, eax
.text:004036C1		       inc     eax
.text:004036C2		       leave
.text:004036C3		       retn
.text:004036C4 ; ---------------------------------------------------------------------------
.text:004036C4
.text:004036C4 loc_4036C4:			       ; CODE XREF: ___heap_select+49j
.text:004036C4					       ; ___heap_select+4Fj
.text:004036C4		       push    3
.text:004036C6		       pop     eax
.text:004036C7		       leave
.text:004036C8		       retn
.text:004036C8 ___heap_select  endp
.text:004036C8
.text:004036C9
.text:004036C9 ; =============== S U B R O U T I N E =======================================
.text:004036C9
.text:004036C9
.text:004036C9 ; int __cdecl _heap_init(int mtflag)
.text:004036C9 __heap_init     proc near	       ; CODE XREF: __tmainCRTStartup+BCp
.text:004036C9
.text:004036C9 mtflag	       = dword ptr  4
.text:004036C9
.text:004036C9		       xor     eax, eax
.text:004036CB		       cmp     [esp+mtflag], eax
.text:004036CF		       push    0	       ; dwMaximumSize
.text:004036D1		       setz    al
.text:004036D4		       push    1000h	       ; dwInitialSize
.text:004036D9		       push    eax	       ; flOptions
.text:004036DA		       call    ds:__imp__HeapCreate@12 ; HeapCreate(x,x,x)
.text:004036E0		       test    eax, eax
.text:004036E2		       mov     __crtheap, eax
.text:004036E7		       jnz     short loc_4036EC
.text:004036E9
.text:004036E9 loc_4036E9:			       ; CODE XREF: __heap_init+54j
.text:004036E9		       xor     eax, eax
.text:004036EB		       retn
.text:004036EC ; ---------------------------------------------------------------------------
.text:004036EC
.text:004036EC loc_4036EC:			       ; CODE XREF: __heap_init+1Ej
.text:004036EC		       call    ___heap_select
.text:004036F1		       cmp     eax, 3
.text:004036F4		       mov     ___active_heap, eax
.text:004036F9		       jnz     short loc_40371F
.text:004036FB		       push    3F8h	       ; threshold
.text:00403700		       call    ___sbh_heap_init
.text:00403705		       test    eax, eax
.text:00403707		       pop     ecx
.text:00403708		       jnz     short loc_40371F
.text:0040370A		       push    __crtheap       ; hHeap
.text:00403710		       call    ds:__imp__HeapDestroy@4 ; HeapDestroy(x)
.text:00403716		       and     __crtheap, 0
.text:0040371D		       jmp     short loc_4036E9
.text:0040371F ; ---------------------------------------------------------------------------
.text:0040371F
.text:0040371F loc_40371F:			       ; CODE XREF: __heap_init+30j
.text:0040371F					       ; __heap_init+3Fj
.text:0040371F		       xor     eax, eax
.text:00403721		       inc     eax
.text:00403722		       retn
.text:00403722 __heap_init     endp
.text:00403722
.text:00403723
.text:00403723 ; =============== S U B R O U T I N E =======================================
.text:00403723
.text:00403723
.text:00403723 __heap_term     proc near
.text:00403723		       push    ebp
.text:00403724		       xor     ebp, ebp
.text:00403726		       cmp     ___active_heap, 3
.text:0040372D		       jnz     short loc_403783
.text:0040372F		       push    ebx
.text:00403730		       mov     ebx, ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00403736		       push    edi
.text:00403737		       xor     edi, edi
.text:00403739		       cmp     ___sbh_cntHeaderList, ebp
.text:0040373F		       jle     short loc_403772
.text:00403741		       push    esi
.text:00403742		       mov     esi, ___sbh_pHeaderList
.text:00403748		       add     esi, 10h
.text:0040374B
.text:0040374B loc_40374B:			       ; CODE XREF: __heap_term+4Cj
.text:0040374B		       push    8000h	       ; dwFreeType
.text:00403750		       push    ebp	       ; dwSize
.text:00403751		       push    dword ptr [esi-4] ; lpAddress
.text:00403754		       call    ds:__imp__VirtualFree@12	; VirtualFree(x,x,x)
.text:0040375A		       push    dword ptr [esi] ; lpMem
.text:0040375C		       push    ebp	       ; dwFlags
.text:0040375D		       push    __crtheap       ; hHeap
.text:00403763		       call    ebx ; HeapFree(x,x,x) ; HeapFree(x,x,x)
.text:00403765		       add     esi, 14h
.text:00403768		       inc     edi
.text:00403769		       cmp     edi, ___sbh_cntHeaderList
.text:0040376F		       jl      short loc_40374B
.text:00403771		       pop     esi
.text:00403772
.text:00403772 loc_403772:			       ; CODE XREF: __heap_term+1Cj
.text:00403772		       push    ___sbh_pHeaderList ; lpMem
.text:00403778		       push    ebp	       ; dwFlags
.text:00403779		       push    __crtheap       ; hHeap
.text:0040377F		       call    ebx ; HeapFree(x,x,x) ; HeapFree(x,x,x)
.text:00403781		       pop     edi
.text:00403782		       pop     ebx
.text:00403783
.text:00403783 loc_403783:			       ; CODE XREF: __heap_term+Aj
.text:00403783		       push    __crtheap       ; hHeap
.text:00403789		       call    ds:__imp__HeapDestroy@4 ; HeapDestroy(x)
.text:0040378F		       mov     __crtheap, ebp
.text:00403795		       pop     ebp
.text:00403796		       retn
.text:00403796 __heap_term     endp
.text:00403796
.text:00403797
.text:00403797 ; =============== S U B R O U T I N E =======================================
.text:00403797
.text:00403797
.text:00403797 ; int __cdecl _get_heap_handle()
.text:00403797 __get_heap_handle proc near
.text:00403797		       mov     eax, __crtheap
.text:0040379C		       retn
.text:0040379C __get_heap_handle endp
.text:0040379C
.text:0040379D
.text:0040379D ; =============== S U B R O U T I N E =======================================
.text:0040379D
.text:0040379D
.text:0040379D ; int __cdecl _mtinitlocks()
.text:0040379D __mtinitlocks   proc near	       ; CODE XREF: __mtinit+10Cp
.text:0040379D		       push    esi
.text:0040379E		       push    edi
.text:0040379F		       xor     esi, esi
.text:004037A1		       mov     edi, offset lclcritsects
.text:004037A6
.text:004037A6 loc_4037A6:			       ; CODE XREF: __mtinitlocks+35j
.text:004037A6		       cmp     _locktable.kind[esi*8], 1
.text:004037AE		       jnz     short loc_4037CE
.text:004037B0		       lea     eax, ds:422490h[esi*8]
.text:004037B7		       mov     [eax], edi
.text:004037B9		       push    0FA0h	       ; dwSpinCount
.text:004037BE		       push    dword ptr [eax] ; lpCriticalSection
.text:004037C0		       add     edi, 18h
.text:004037C3		       call    ___crtInitCritSecAndSpinCount
.text:004037C8		       test    eax, eax
.text:004037CA		       pop     ecx
.text:004037CB		       pop     ecx
.text:004037CC		       jz      short loc_4037DA
.text:004037CE
.text:004037CE loc_4037CE:			       ; CODE XREF: __mtinitlocks+11j
.text:004037CE		       inc     esi
.text:004037CF		       cmp     esi, 24h
.text:004037D2		       jl      short loc_4037A6
.text:004037D4		       xor     eax, eax
.text:004037D6		       inc     eax
.text:004037D7
.text:004037D7 loc_4037D7:			       ; CODE XREF: __mtinitlocks+47j
.text:004037D7		       pop     edi
.text:004037D8		       pop     esi
.text:004037D9		       retn
.text:004037DA ; ---------------------------------------------------------------------------
.text:004037DA
.text:004037DA loc_4037DA:			       ; CODE XREF: __mtinitlocks+2Fj
.text:004037DA		       and     _locktable.lock[esi*8], 0
.text:004037E2		       xor     eax, eax
.text:004037E4		       jmp     short loc_4037D7
.text:004037E4 __mtinitlocks   endp
.text:004037E4
.text:004037E6
.text:004037E6 ; =============== S U B R O U T I N E =======================================
.text:004037E6
.text:004037E6
.text:004037E6 __mtdeletelocks proc near	       ; CODE XREF: __mtterm:loc_404B4Dj
.text:004037E6		       push    ebx
.text:004037E7		       mov     ebx, ds:__imp__DeleteCriticalSection@4 ;	DeleteCriticalSection(x)
.text:004037ED		       push    esi
.text:004037EE		       mov     esi, offset _locktable
.text:004037F3		       push    edi
.text:004037F4
.text:004037F4 loc_4037F4:			       ; CODE XREF: __mtdeletelocks+30j
.text:004037F4		       mov     edi, [esi]
.text:004037F6		       test    edi, edi
.text:004037F8		       jz      short loc_40380D
.text:004037FA		       cmp     dword ptr [esi+4], 1
.text:004037FE		       jz      short loc_40380D
.text:00403800		       push    edi	       ; lpCriticalSection
.text:00403801		       call    ebx ; DeleteCriticalSection(x) ;	DeleteCriticalSection(x)
.text:00403803		       push    edi	       ; pBlock
.text:00403804		       call    _free
.text:00403809		       and     dword ptr [esi],	0
.text:0040380C		       pop     ecx
.text:0040380D
.text:0040380D loc_40380D:			       ; CODE XREF: __mtdeletelocks+12j
.text:0040380D					       ; __mtdeletelocks+18j
.text:0040380D		       add     esi, 8
.text:00403810		       cmp     esi, offset ___flsindex
.text:00403816		       jl      short loc_4037F4
.text:00403818		       mov     esi, offset _locktable
.text:0040381D		       pop     edi
.text:0040381E
.text:0040381E loc_40381E:			       ; CODE XREF: __mtdeletelocks+50j
.text:0040381E		       mov     eax, [esi]
.text:00403820		       test    eax, eax
.text:00403822		       jz      short loc_40382D
.text:00403824		       cmp     dword ptr [esi+4], 1
.text:00403828		       jnz     short loc_40382D
.text:0040382A		       push    eax	       ; lpCriticalSection
.text:0040382B		       call    ebx ; DeleteCriticalSection(x) ;	DeleteCriticalSection(x)
.text:0040382D
.text:0040382D loc_40382D:			       ; CODE XREF: __mtdeletelocks+3Cj
.text:0040382D					       ; __mtdeletelocks+42j
.text:0040382D		       add     esi, 8
.text:00403830		       cmp     esi, offset ___flsindex
.text:00403836		       jl      short loc_40381E
.text:00403838		       pop     esi
.text:00403839		       pop     ebx
.text:0040383A		       retn
.text:0040383A __mtdeletelocks endp
.text:0040383A
.text:0040383B
.text:0040383B ; =============== S U B R O U T I N E =======================================
.text:0040383B
.text:0040383B ; Attributes: bp-based frame
.text:0040383B
.text:0040383B ; void __cdecl _unlock(int locknum)
.text:0040383B __unlock	       proc near	       ; CODE XREF: _free+58p
.text:0040383B					       ; __unlockexit+2p ...
.text:0040383B
.text:0040383B locknum	       = dword ptr  8
.text:0040383B
.text:0040383B		       push    ebp
.text:0040383C		       mov     ebp, esp
.text:0040383E		       mov     eax, [ebp+locknum]
.text:00403841		       push    _locktable.lock[eax*8] ;	lpCriticalSection
.text:00403848		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:0040384E		       pop     ebp
.text:0040384F		       retn
.text:0040384F __unlock	       endp
.text:0040384F
.text:00403850
.text:00403850 ; =============== S U B R O U T I N E =======================================
.text:00403850
.text:00403850 ; Attributes: noreturn
.text:00403850
.text:00403850 ; void __cdecl _lockerr_exit(char *msg)
.text:00403850 __lockerr_exit  proc near
.text:00403850
.text:00403850 msg	       = dword ptr  4
.text:00403850
.text:00403850		       push    [esp+msg]       ; lpMessageText
.text:00403854		       push    0	       ; uAction
.text:00403856		       call    ds:__imp__FatalAppExitA@8 ; FatalAppExitA(x,x)
.text:0040385C ; ---------------------------------------------------------------------------
.text:0040385C		       push    0FFh	       ; status
.text:00403861		       call    ___crtExitProcess
.text:00403866 ; ---------------------------------------------------------------------------
.text:00403866		       pop     ecx
.text:00403867		       retn
.text:00403867 __lockerr_exit  endp
.text:00403867
.text:00403868
.text:00403868 ; =============== S U B R O U T I N E =======================================
.text:00403868
.text:00403868 ; Attributes: bp-based frame
.text:00403868
.text:00403868 ; int __cdecl _mtinitlocknum(int	locknum)
.text:00403868 __mtinitlocknum proc near	       ; CODE XREF: __lock+14p
.text:00403868					       ; __alloc_osfhnd+17p
.text:00403868
.text:00403868 retval	       = dword ptr -1Ch
.text:00403868 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00403868 locknum	       = dword ptr  8
.text:00403868
.text:00403868		       push    0Ch
.text:0040386A		       push    offset dword_421530
.text:0040386F		       call    __SEH_prolog4
.text:00403874		       xor     edi, edi
.text:00403876		       inc     edi
.text:00403877		       mov     [ebp+retval], edi
.text:0040387A		       xor     ebx, ebx
.text:0040387C		       cmp     __crtheap, ebx
.text:00403882		       jnz     short loc_40389C
.text:00403884		       call    __FF_MSGBANNER
.text:00403889		       push    1Eh	       ; rterrnum
.text:0040388B		       call    __NMSG_WRITE
.text:00403890		       push    0FFh	       ; status
.text:00403895		       call    ___crtExitProcess
.text:0040389A ; ---------------------------------------------------------------------------
.text:0040389A		       pop     ecx
.text:0040389B		       pop     ecx
.text:0040389C
.text:0040389C loc_40389C:			       ; CODE XREF: __mtinitlocknum+1Aj
.text:0040389C		       mov     esi, [ebp+locknum]
.text:0040389F		       lea     esi, ds:422490h[esi*8]
.text:004038A6		       cmp     [esi], ebx
.text:004038A8		       jz      short loc_4038AE
.text:004038AA		       mov     eax, edi
.text:004038AC		       jmp     short loc_40391C
.text:004038AE ; ---------------------------------------------------------------------------
.text:004038AE
.text:004038AE loc_4038AE:			       ; CODE XREF: __mtinitlocknum+40j
.text:004038AE		       push    18h	       ; cb
.text:004038B0		       call    __malloc_crt
.text:004038B5		       pop     ecx
.text:004038B6		       mov     edi, eax
.text:004038B8		       cmp     edi, ebx
.text:004038BA		       jnz     short loc_4038CB
.text:004038BC		       call    __errno
.text:004038C1		       mov     dword ptr [eax],	0Ch
.text:004038C7		       xor     eax, eax
.text:004038C9		       jmp     short loc_40391C
.text:004038CB ; ---------------------------------------------------------------------------
.text:004038CB
.text:004038CB loc_4038CB:			       ; CODE XREF: __mtinitlocknum+52j
.text:004038CB		       push    0Ah	       ; locknum
.text:004038CD		       call    __lock
.text:004038D2		       pop     ecx
.text:004038D3		       mov     [ebp+ms_exc.disabled], ebx
.text:004038D6		       cmp     [esi], ebx
.text:004038D8		       jnz     short loc_403906
.text:004038DA		       push    0FA0h	       ; dwSpinCount
.text:004038DF		       push    edi	       ; lpCriticalSection
.text:004038E0		       call    ___crtInitCritSecAndSpinCount
.text:004038E5		       pop     ecx
.text:004038E6		       pop     ecx
.text:004038E7		       test    eax, eax
.text:004038E9		       jnz     short loc_403902
.text:004038EB		       push    edi	       ; pBlock
.text:004038EC		       call    _free
.text:004038F1		       pop     ecx
.text:004038F2		       call    __errno
.text:004038F7		       mov     dword ptr [eax],	0Ch
.text:004038FD		       mov     [ebp+retval], ebx
.text:00403900		       jmp     short loc_40390D
.text:00403902 ; ---------------------------------------------------------------------------
.text:00403902
.text:00403902 loc_403902:			       ; CODE XREF: __mtinitlocknum+81j
.text:00403902		       mov     [esi], edi
.text:00403904		       jmp     short loc_40390D
.text:00403906 ; ---------------------------------------------------------------------------
.text:00403906
.text:00403906 loc_403906:			       ; CODE XREF: __mtinitlocknum+70j
.text:00403906		       push    edi	       ; pBlock
.text:00403907		       call    _free
.text:0040390C		       pop     ecx
.text:0040390D
.text:0040390D loc_40390D:			       ; CODE XREF: __mtinitlocknum+98j
.text:0040390D					       ; __mtinitlocknum+9Cj
.text:0040390D		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00403914		       call    $LN12_0
.text:00403919
.text:00403919 $LN15_1:
.text:00403919		       mov     eax, [ebp+retval]
.text:0040391C
.text:0040391C loc_40391C:			       ; CODE XREF: __mtinitlocknum+44j
.text:0040391C					       ; __mtinitlocknum+61j
.text:0040391C		       call    __SEH_epilog4
.text:00403921		       retn
.text:00403922 ; ---------------------------------------------------------------------------
.text:00403922
.text:00403922 $LN12_0:				       ; CODE XREF: __mtinitlocknum+ACp
.text:00403922					       ; DATA XREF: .rdata:00421548o
.text:00403922		       push    0Ah	       ; locknum
.text:00403924		       call    __unlock
.text:00403929		       pop     ecx
.text:0040392A
.text:0040392A $LN13_0:
.text:0040392A		       retn
.text:0040392A __mtinitlocknum endp
.text:0040392A
.text:0040392B
.text:0040392B ; =============== S U B R O U T I N E =======================================
.text:0040392B
.text:0040392B ; Attributes: bp-based frame
.text:0040392B
.text:0040392B ; void __cdecl _lock(int	locknum)
.text:0040392B __lock	       proc near	       ; CODE XREF: _free+1Ep
.text:0040392B					       ; __lockexit+2p	...
.text:0040392B
.text:0040392B locknum	       = dword ptr  8
.text:0040392B
.text:0040392B		       push    ebp
.text:0040392C		       mov     ebp, esp
.text:0040392E		       mov     eax, [ebp+locknum]
.text:00403931		       push    esi
.text:00403932		       lea     esi, ds:422490h[eax*8]
.text:00403939		       cmp     dword ptr [esi],	0
.text:0040393C		       jnz     short loc_403951
.text:0040393E		       push    eax	       ; locknum
.text:0040393F		       call    __mtinitlocknum
.text:00403944		       test    eax, eax
.text:00403946		       pop     ecx
.text:00403947		       jnz     short loc_403951
.text:00403949		       push    11h	       ; rterrnum
.text:0040394B		       call    __amsg_exit
.text:00403950		       pop     ecx
.text:00403951
.text:00403951 loc_403951:			       ; CODE XREF: __lock+11j
.text:00403951					       ; __lock+1Cj
.text:00403951		       push    dword ptr [esi] ; lpCriticalSection
.text:00403953		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:00403959		       pop     esi
.text:0040395A		       pop     ebp
.text:0040395B		       retn
.text:0040395B __lock	       endp
.text:0040395B
.text:0040395C
.text:0040395C ; =============== S U B R O U T I N E =======================================
.text:0040395C
.text:0040395C
.text:0040395C ; unsigned int __cdecl _get_sbh_threshold()
.text:0040395C __get_sbh_threshold proc	near
.text:0040395C		       cmp     __crtheap, 0
.text:00403963		       jnz     short loc_403968
.text:00403965		       xor     eax, eax
.text:00403967		       retn
.text:00403968 ; ---------------------------------------------------------------------------
.text:00403968
.text:00403968 loc_403968:			       ; CODE XREF: __get_sbh_threshold+7j
.text:00403968		       mov     eax, ___active_heap
.text:0040396D		       sub     eax, 3
.text:00403970		       neg     eax
.text:00403972		       sbb     eax, eax
.text:00403974		       not     eax
.text:00403976		       and     eax, ___sbh_threshold
.text:0040397C		       retn
.text:0040397C __get_sbh_threshold endp
.text:0040397C
.text:0040397D
.text:0040397D ; =============== S U B R O U T I N E =======================================
.text:0040397D
.text:0040397D
.text:0040397D ; int __cdecl _set_amblksiz(unsigned int	size)
.text:0040397D __set_amblksiz  proc near
.text:0040397D
.text:0040397D size	       = dword ptr  4
.text:0040397D
.text:0040397D		       mov     eax, [esp+size]
.text:00403981		       lea     ecx, [eax-1]
.text:00403984		       cmp     ecx, 0FFFFFFFEh
.text:00403987		       push    esi
.text:00403988		       jbe     short loc_4039A9
.text:0040398A		       call    __errno
.text:0040398F		       xor     esi, esi
.text:00403991
.text:00403991 loc_403991:			       ; CODE XREF: __set_amblksiz+3Bj
.text:00403991		       push    esi	       ; pReserved
.text:00403992		       push    esi	       ; nLine
.text:00403993		       push    esi	       ; pszFile
.text:00403994		       push    esi	       ; pszFunction
.text:00403995		       push    esi	       ; pszExpression
.text:00403996		       mov     dword ptr [eax],	16h
.text:0040399C		       call    __invalid_parameter
.text:004039A1		       add     esp, 14h
.text:004039A4		       push    16h
.text:004039A6		       pop     eax
.text:004039A7		       pop     esi
.text:004039A8		       retn
.text:004039A9 ; ---------------------------------------------------------------------------
.text:004039A9
.text:004039A9 loc_4039A9:			       ; CODE XREF: __set_amblksiz+Bj
.text:004039A9		       xor     esi, esi
.text:004039AB		       cmp     __crtheap, esi
.text:004039B1		       jnz     short loc_4039BA
.text:004039B3		       call    __errno
.text:004039B8		       jmp     short loc_403991
.text:004039BA ; ---------------------------------------------------------------------------
.text:004039BA
.text:004039BA loc_4039BA:			       ; CODE XREF: __set_amblksiz+34j
.text:004039BA		       mov     __amblksiz, eax
.text:004039BF		       xor     eax, eax
.text:004039C1		       pop     esi
.text:004039C2		       retn
.text:004039C2 __set_amblksiz  endp
.text:004039C2
.text:004039C3
.text:004039C3 ; =============== S U B R O U T I N E =======================================
.text:004039C3
.text:004039C3
.text:004039C3 ; int __cdecl _get_amblksiz(unsigned int	*pSize)
.text:004039C3 __get_amblksiz  proc near
.text:004039C3
.text:004039C3 pSize	       = dword ptr  4
.text:004039C3
.text:004039C3		       mov     eax, [esp+pSize]
.text:004039C7		       push    esi
.text:004039C8		       xor     esi, esi
.text:004039CA		       cmp     eax, esi
.text:004039CC		       jnz     short loc_4039EB
.text:004039CE
.text:004039CE loc_4039CE:			       ; CODE XREF: __get_amblksiz+2Ej
.text:004039CE		       call    __errno
.text:004039D3		       push    esi	       ; pReserved
.text:004039D4		       push    esi	       ; nLine
.text:004039D5		       push    esi	       ; pszFile
.text:004039D6		       push    esi	       ; pszFunction
.text:004039D7		       push    esi	       ; pszExpression
.text:004039D8		       mov     dword ptr [eax],	16h
.text:004039DE		       call    __invalid_parameter
.text:004039E3		       add     esp, 14h
.text:004039E6		       push    16h
.text:004039E8		       pop     eax
.text:004039E9		       pop     esi
.text:004039EA		       retn
.text:004039EB ; ---------------------------------------------------------------------------
.text:004039EB
.text:004039EB loc_4039EB:			       ; CODE XREF: __get_amblksiz+9j
.text:004039EB		       cmp     __crtheap, esi
.text:004039F1		       jz      short loc_4039CE
.text:004039F3		       mov     ecx, __amblksiz
.text:004039F9		       mov     [eax], ecx
.text:004039FB		       xor     eax, eax
.text:004039FD		       pop     esi
.text:004039FE		       retn
.text:004039FE __get_amblksiz  endp
.text:004039FE
.text:004039FF
.text:004039FF ; =============== S U B R O U T I N E =======================================
.text:004039FF
.text:004039FF
.text:004039FF ; int __cdecl __sbh_heap_init(unsigned int threshold)
.text:004039FF ___sbh_heap_init	proc near	       ; CODE XREF: __heap_init+37p
.text:004039FF					       ; __set_sbh_threshold+5Fp
.text:004039FF
.text:004039FF threshold       = dword ptr  4
.text:004039FF
.text:004039FF		       push    140h	       ; dwBytes
.text:00403A04		       push    0	       ; dwFlags
.text:00403A06		       push    __crtheap       ; hHeap
.text:00403A0C		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:00403A12		       test    eax, eax
.text:00403A14		       mov     ___sbh_pHeaderList, eax
.text:00403A19		       jnz     short loc_403A1C
.text:00403A1B		       retn
.text:00403A1C ; ---------------------------------------------------------------------------
.text:00403A1C
.text:00403A1C loc_403A1C:			       ; CODE XREF: ___sbh_heap_init+1Aj
.text:00403A1C		       mov     ecx, [esp+threshold]
.text:00403A20		       and     ___sbh_pHeaderDefer, 0
.text:00403A27		       and     ___sbh_cntHeaderList, 0
.text:00403A2E		       mov     ___sbh_pHeaderScan, eax
.text:00403A33		       xor     eax, eax
.text:00403A35		       mov     ___sbh_threshold, ecx
.text:00403A3B		       mov     ___sbh_sizeHeaderList, 10h
.text:00403A45		       inc     eax
.text:00403A46		       retn
.text:00403A46 ___sbh_heap_init	endp
.text:00403A46
.text:00403A47
.text:00403A47 ; =============== S U B R O U T I N E =======================================
.text:00403A47
.text:00403A47
.text:00403A47 ; tagHeader *__cdecl __sbh_find_block(void *pvAlloc)
.text:00403A47 ___sbh_find_block proc near	       ; CODE XREF: _free+29p
.text:00403A47					       ; __msize+4Ep ...
.text:00403A47
.text:00403A47 pvAlloc	       = dword ptr  4
.text:00403A47
.text:00403A47		       mov     ecx, ___sbh_cntHeaderList
.text:00403A4D		       mov     eax, ___sbh_pHeaderList
.text:00403A52		       imul    ecx, 14h
.text:00403A55		       add     ecx, eax
.text:00403A57		       jmp     short loc_403A6B
.text:00403A59 ; ---------------------------------------------------------------------------
.text:00403A59
.text:00403A59 loc_403A59:			       ; CODE XREF: ___sbh_find_block+26j
.text:00403A59		       mov     edx, [esp+pvAlloc]
.text:00403A5D		       sub     edx, [eax+0Ch]
.text:00403A60		       cmp     edx, 100000h
.text:00403A66		       jb      short locret_403A71
.text:00403A68		       add     eax, 14h
.text:00403A6B
.text:00403A6B loc_403A6B:			       ; CODE XREF: ___sbh_find_block+10j
.text:00403A6B		       cmp     eax, ecx
.text:00403A6D		       jb      short loc_403A59
.text:00403A6F		       xor     eax, eax
.text:00403A71
.text:00403A71 locret_403A71:			       ; CODE XREF: ___sbh_find_block+1Fj
.text:00403A71		       retn
.text:00403A71 ___sbh_find_block endp
.text:00403A71
.text:00403A72
.text:00403A72 ; =============== S U B R O U T I N E =======================================
.text:00403A72
.text:00403A72 ; Attributes: bp-based frame
.text:00403A72
.text:00403A72 ; void __cdecl __sbh_free_block(tagHeader *pHeader, void	*pvAlloc)
.text:00403A72 ___sbh_free_block proc near	       ; CODE XREF: _free+38p
.text:00403A72					       ; _realloc+B5p ...
.text:00403A72
.text:00403A72 pGroup	       = dword ptr -10h
.text:00403A72 sizeNext	       = dword ptr -0Ch
.text:00403A72 sizePrev	       = dword ptr -8
.text:00403A72 sizeEntry       = dword ptr -4
.text:00403A72 indPrev	       = dword ptr  8
.text:00403A72 pNext	       = dword ptr  0Ch
.text:00403A72
.text:00403A72		       push    ebp
.text:00403A73		       mov     ebp, esp
.text:00403A75		       sub     esp, 10h
.text:00403A78		       mov     ecx, [ebp+indPrev]
.text:00403A7B		       mov     eax, [ecx+10h]
.text:00403A7E		       push    esi
.text:00403A7F		       mov     esi, [ebp+pNext]
.text:00403A82		       push    edi
.text:00403A83		       mov     edi, esi
.text:00403A85		       sub     edi, [ecx+0Ch]
.text:00403A88		       add     esi, 0FFFFFFFCh
.text:00403A8B		       shr     edi, 0Fh
.text:00403A8E		       mov     ecx, edi
.text:00403A90		       imul    ecx, 204h
.text:00403A96		       lea     ecx, [ecx+eax+144h]
.text:00403A9D		       mov     [ebp+pGroup], ecx
.text:00403AA0		       mov     ecx, [esi]
.text:00403AA2		       dec     ecx
.text:00403AA3		       test    cl, 1
.text:00403AA6		       mov     [ebp+sizeEntry],	ecx
.text:00403AA9		       jnz     loc_403D82
.text:00403AAF		       push    ebx
.text:00403AB0		       lea     ebx, [ecx+esi]
.text:00403AB3		       mov     edx, [ebx]
.text:00403AB5		       mov     [ebp+sizeNext], edx
.text:00403AB8		       mov     edx, [esi-4]
.text:00403ABB		       mov     [ebp+sizePrev], edx
.text:00403ABE		       mov     edx, [ebp+sizeNext]
.text:00403AC1		       test    dl, 1
.text:00403AC4		       mov     [ebp+pNext], ebx
.text:00403AC7		       jnz     short loc_403B3D
.text:00403AC9		       sar     edx, 4
.text:00403ACC		       dec     edx
.text:00403ACD		       cmp     edx, 3Fh
.text:00403AD0		       jbe     short loc_403AD5
.text:00403AD2		       push    3Fh
.text:00403AD4		       pop     edx
.text:00403AD5
.text:00403AD5 loc_403AD5:			       ; CODE XREF: ___sbh_free_block+5Ej
.text:00403AD5		       mov     ecx, [ebx+4]
.text:00403AD8		       cmp     ecx, [ebx+8]
.text:00403ADB		       jnz     short loc_403B1F
.text:00403ADD		       cmp     edx, 20h
.text:00403AE0		       mov     ebx, 80000000h
.text:00403AE5		       jnb     short loc_403B00
.text:00403AE7		       mov     ecx, edx
.text:00403AE9		       shr     ebx, cl
.text:00403AEB		       lea     ecx, [edx+eax+4]
.text:00403AEF		       not     ebx
.text:00403AF1		       and     [eax+edi*4+44h],	ebx
.text:00403AF5		       dec     byte ptr	[ecx]
.text:00403AF7		       jnz     short loc_403B1C
.text:00403AF9		       mov     ecx, [ebp+indPrev]
.text:00403AFC		       and     [ecx], ebx
.text:00403AFE		       jmp     short loc_403B1C
.text:00403B00 ; ---------------------------------------------------------------------------
.text:00403B00
.text:00403B00 loc_403B00:			       ; CODE XREF: ___sbh_free_block+73j
.text:00403B00		       lea     ecx, [edx-20h]
.text:00403B03		       shr     ebx, cl
.text:00403B05		       lea     ecx, [edx+eax+4]
.text:00403B09		       not     ebx
.text:00403B0B		       and     [eax+edi*4+0C4h], ebx
.text:00403B12		       dec     byte ptr	[ecx]
.text:00403B14		       jnz     short loc_403B1C
.text:00403B16		       mov     ecx, [ebp+indPrev]
.text:00403B19		       and     [ecx+4],	ebx
.text:00403B1C
.text:00403B1C loc_403B1C:			       ; CODE XREF: ___sbh_free_block+85j
.text:00403B1C					       ; ___sbh_free_block+8Cj	...
.text:00403B1C		       mov     ebx, [ebp+pNext]
.text:00403B1F
.text:00403B1F loc_403B1F:			       ; CODE XREF: ___sbh_free_block+69j
.text:00403B1F		       mov     edx, [ebx+8]
.text:00403B22		       mov     ebx, [ebx+4]
.text:00403B25		       mov     ecx, [ebp+sizeEntry]
.text:00403B28		       add     ecx, [ebp+sizeNext]
.text:00403B2B		       mov     [edx+4],	ebx
.text:00403B2E		       mov     edx, [ebp+pNext]
.text:00403B31		       mov     ebx, [edx+4]
.text:00403B34		       mov     edx, [edx+8]
.text:00403B37		       mov     [ebx+8],	edx
.text:00403B3A		       mov     [ebp+sizeEntry],	ecx
.text:00403B3D
.text:00403B3D loc_403B3D:			       ; CODE XREF: ___sbh_free_block+55j
.text:00403B3D		       mov     edx, ecx
.text:00403B3F		       sar     edx, 4
.text:00403B42		       dec     edx
.text:00403B43		       cmp     edx, 3Fh
.text:00403B46		       jbe     short loc_403B4B
.text:00403B48		       push    3Fh
.text:00403B4A		       pop     edx
.text:00403B4B
.text:00403B4B loc_403B4B:			       ; CODE XREF: ___sbh_free_block+D4j
.text:00403B4B		       mov     ebx, [ebp+sizePrev]
.text:00403B4E		       and     ebx, 1
.text:00403B51		       mov     [ebp+sizeNext], ebx
.text:00403B54		       jnz     loc_403BE9
.text:00403B5A		       sub     esi, [ebp+sizePrev]
.text:00403B5D		       mov     ebx, [ebp+sizePrev]
.text:00403B60		       sar     ebx, 4
.text:00403B63		       push    3Fh
.text:00403B65		       mov     [ebp+pNext], esi
.text:00403B68		       dec     ebx
.text:00403B69		       pop     esi
.text:00403B6A		       cmp     ebx, esi
.text:00403B6C		       jbe     short loc_403B70
.text:00403B6E		       mov     ebx, esi
.text:00403B70
.text:00403B70 loc_403B70:			       ; CODE XREF: ___sbh_free_block+FAj
.text:00403B70		       add     ecx, [ebp+sizePrev]
.text:00403B73		       mov     edx, ecx
.text:00403B75		       sar     edx, 4
.text:00403B78		       dec     edx
.text:00403B79		       cmp     edx, esi
.text:00403B7B		       mov     [ebp+sizeEntry],	ecx
.text:00403B7E		       jbe     short loc_403B82
.text:00403B80		       mov     edx, esi
.text:00403B82
.text:00403B82 loc_403B82:			       ; CODE XREF: ___sbh_free_block+10Cj
.text:00403B82		       cmp     ebx, edx
.text:00403B84		       jz      short loc_403BE4
.text:00403B86		       mov     ecx, [ebp+pNext]
.text:00403B89		       mov     esi, [ecx+4]
.text:00403B8C		       cmp     esi, [ecx+8]
.text:00403B8F		       jnz     short loc_403BCC
.text:00403B91		       cmp     ebx, 20h
.text:00403B94		       mov     esi, 80000000h
.text:00403B99		       jnb     short loc_403BB2
.text:00403B9B		       mov     ecx, ebx
.text:00403B9D		       shr     esi, cl
.text:00403B9F		       not     esi
.text:00403BA1		       and     [eax+edi*4+44h],	esi
.text:00403BA5		       dec     byte ptr	[ebx+eax+4]
.text:00403BA9		       jnz     short loc_403BCC
.text:00403BAB		       mov     ecx, [ebp+indPrev]
.text:00403BAE		       and     [ecx], esi
.text:00403BB0		       jmp     short loc_403BCC
.text:00403BB2 ; ---------------------------------------------------------------------------
.text:00403BB2
.text:00403BB2 loc_403BB2:			       ; CODE XREF: ___sbh_free_block+127j
.text:00403BB2		       lea     ecx, [ebx-20h]
.text:00403BB5		       shr     esi, cl
.text:00403BB7		       not     esi
.text:00403BB9		       and     [eax+edi*4+0C4h], esi
.text:00403BC0		       dec     byte ptr	[ebx+eax+4]
.text:00403BC4		       jnz     short loc_403BCC
.text:00403BC6		       mov     ecx, [ebp+indPrev]
.text:00403BC9		       and     [ecx+4],	esi
.text:00403BCC
.text:00403BCC loc_403BCC:			       ; CODE XREF: ___sbh_free_block+11Dj
.text:00403BCC					       ; ___sbh_free_block+137j ...
.text:00403BCC		       mov     ecx, [ebp+pNext]
.text:00403BCF		       mov     esi, [ecx+8]
.text:00403BD2		       mov     ecx, [ecx+4]
.text:00403BD5		       mov     [esi+4],	ecx
.text:00403BD8		       mov     ecx, [ebp+pNext]
.text:00403BDB		       mov     esi, [ecx+4]
.text:00403BDE		       mov     ecx, [ecx+8]
.text:00403BE1		       mov     [esi+8],	ecx
.text:00403BE4
.text:00403BE4 loc_403BE4:			       ; CODE XREF: ___sbh_free_block+112j
.text:00403BE4		       mov     esi, [ebp+pNext]
.text:00403BE7		       jmp     short loc_403BEC
.text:00403BE9 ; ---------------------------------------------------------------------------
.text:00403BE9
.text:00403BE9 loc_403BE9:			       ; CODE XREF: ___sbh_free_block+E2j
.text:00403BE9		       mov     ebx, [ebp+indPrev]
.text:00403BEC
.text:00403BEC loc_403BEC:			       ; CODE XREF: ___sbh_free_block+175j
.text:00403BEC		       cmp     [ebp+sizeNext], 0
.text:00403BF0		       jnz     short loc_403BFA
.text:00403BF2		       cmp     ebx, edx
.text:00403BF4		       jz      loc_403C7A
.text:00403BFA
.text:00403BFA loc_403BFA:			       ; CODE XREF: ___sbh_free_block+17Ej
.text:00403BFA		       mov     ecx, [ebp+pGroup]
.text:00403BFD		       lea     ecx, [ecx+edx*8]
.text:00403C00		       mov     ebx, [ecx+4]
.text:00403C03		       mov     [esi+8],	ecx
.text:00403C06		       mov     [esi+4],	ebx
.text:00403C09		       mov     [ecx+4],	esi
.text:00403C0C		       mov     ecx, [esi+4]
.text:00403C0F		       mov     [ecx+8],	esi
.text:00403C12		       mov     ecx, [esi+4]
.text:00403C15		       cmp     ecx, [esi+8]
.text:00403C18		       jnz     short loc_403C7A
.text:00403C1A		       mov     cl, [edx+eax+4]
.text:00403C1E		       mov     byte ptr	[ebp+pNext+3], cl
.text:00403C21		       inc     cl
.text:00403C23		       cmp     edx, 20h
.text:00403C26		       mov     [edx+eax+4], cl
.text:00403C2A		       jnb     short loc_403C51
.text:00403C2C		       cmp     byte ptr	[ebp+pNext+3], 0
.text:00403C30		       jnz     short loc_403C40
.text:00403C32		       mov     ecx, edx
.text:00403C34		       mov     ebx, 80000000h
.text:00403C39		       shr     ebx, cl
.text:00403C3B		       mov     ecx, [ebp+indPrev]
.text:00403C3E		       or      [ecx], ebx
.text:00403C40
.text:00403C40 loc_403C40:			       ; CODE XREF: ___sbh_free_block+1BEj
.text:00403C40		       mov     ebx, 80000000h
.text:00403C45		       mov     ecx, edx
.text:00403C47		       shr     ebx, cl
.text:00403C49		       lea     eax, [eax+edi*4+44h]
.text:00403C4D		       or      [eax], ebx
.text:00403C4F		       jmp     short loc_403C7A
.text:00403C51 ; ---------------------------------------------------------------------------
.text:00403C51
.text:00403C51 loc_403C51:			       ; CODE XREF: ___sbh_free_block+1B8j
.text:00403C51		       cmp     byte ptr	[ebp+pNext+3], 0
.text:00403C55		       jnz     short loc_403C67
.text:00403C57		       lea     ecx, [edx-20h]
.text:00403C5A		       mov     ebx, 80000000h
.text:00403C5F		       shr     ebx, cl
.text:00403C61		       mov     ecx, [ebp+indPrev]
.text:00403C64		       or      [ecx+4],	ebx
.text:00403C67
.text:00403C67 loc_403C67:			       ; CODE XREF: ___sbh_free_block+1E3j
.text:00403C67		       lea     ecx, [edx-20h]
.text:00403C6A		       mov     edx, 80000000h
.text:00403C6F		       shr     edx, cl
.text:00403C71		       lea     eax, [eax+edi*4+0C4h]
.text:00403C78		       or      [eax], edx
.text:00403C7A
.text:00403C7A loc_403C7A:			       ; CODE XREF: ___sbh_free_block+182j
.text:00403C7A					       ; ___sbh_free_block+1A6j ...
.text:00403C7A		       mov     eax, [ebp+sizeEntry]
.text:00403C7D		       mov     [esi], eax
.text:00403C7F		       mov     [eax+esi-4], eax
.text:00403C83		       mov     eax, [ebp+pGroup]
.text:00403C86		       dec     dword ptr [eax]
.text:00403C88		       jnz     loc_403D81
.text:00403C8E		       mov     eax, ___sbh_pHeaderDefer
.text:00403C93		       test    eax, eax
.text:00403C95		       jz      loc_403D73
.text:00403C9B		       mov     ecx, ___sbh_indGroupDefer
.text:00403CA1		       mov     esi, ds:__imp__VirtualFree@12 ; VirtualFree(x,x,x)
.text:00403CA7		       push    4000h	       ; dwFreeType
.text:00403CAC		       shl     ecx, 0Fh
.text:00403CAF		       add     ecx, [eax+0Ch]
.text:00403CB2		       mov     ebx, 8000h
.text:00403CB7		       push    ebx	       ; dwSize
.text:00403CB8		       push    ecx	       ; lpAddress
.text:00403CB9		       call    esi ; VirtualFree(x,x,x)	; VirtualFree(x,x,x)
.text:00403CBB		       mov     ecx, ___sbh_indGroupDefer
.text:00403CC1		       mov     eax, ___sbh_pHeaderDefer
.text:00403CC6		       mov     edx, 80000000h
.text:00403CCB		       shr     edx, cl
.text:00403CCD		       or      [eax+8],	edx
.text:00403CD0		       mov     eax, ___sbh_pHeaderDefer
.text:00403CD5		       mov     eax, [eax+10h]
.text:00403CD8		       mov     ecx, ___sbh_indGroupDefer
.text:00403CDE		       and     dword ptr [eax+ecx*4+0C4h], 0
.text:00403CE6		       mov     eax, ___sbh_pHeaderDefer
.text:00403CEB		       mov     eax, [eax+10h]
.text:00403CEE		       dec     byte ptr	[eax+43h]
.text:00403CF1		       mov     eax, ___sbh_pHeaderDefer
.text:00403CF6		       mov     ecx, [eax+10h]
.text:00403CF9		       cmp     byte ptr	[ecx+43h], 0
.text:00403CFD		       jnz     short loc_403D08
.text:00403CFF		       and     dword ptr [eax+4], 0FFFFFFFEh
.text:00403D03		       mov     eax, ___sbh_pHeaderDefer
.text:00403D08
.text:00403D08 loc_403D08:			       ; CODE XREF: ___sbh_free_block+28Bj
.text:00403D08		       cmp     dword ptr [eax+8], 0FFFFFFFFh
.text:00403D0C		       jnz     short loc_403D73
.text:00403D0E		       push    ebx	       ; dwFreeType
.text:00403D0F		       push    0	       ; dwSize
.text:00403D11		       push    dword ptr [eax+0Ch] ; lpAddress
.text:00403D14		       call    esi ; VirtualFree(x,x,x)	; VirtualFree(x,x,x)
.text:00403D16		       mov     eax, ___sbh_pHeaderDefer
.text:00403D1B		       push    dword ptr [eax+10h] ; lpMem
.text:00403D1E		       push    0	       ; dwFlags
.text:00403D20		       push    __crtheap       ; hHeap
.text:00403D26		       call    ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00403D2C		       mov     ecx, ___sbh_cntHeaderList
.text:00403D32		       mov     eax, ___sbh_pHeaderDefer
.text:00403D37		       imul    ecx, 14h
.text:00403D3A		       mov     edx, ___sbh_pHeaderList
.text:00403D40		       sub     ecx, eax
.text:00403D42		       lea     ecx, [ecx+edx-14h]
.text:00403D46		       push    ecx	       ; count
.text:00403D47		       lea     ecx, [eax+14h]
.text:00403D4A		       push    ecx	       ; src
.text:00403D4B		       push    eax	       ; dst
.text:00403D4C		       call    _memmove
.text:00403D51		       mov     eax, [ebp+indPrev]
.text:00403D54		       add     esp, 0Ch
.text:00403D57		       dec     ___sbh_cntHeaderList
.text:00403D5D		       cmp     eax, ___sbh_pHeaderDefer
.text:00403D63		       jbe     short loc_403D69
.text:00403D65		       sub     [ebp+indPrev], 14h
.text:00403D69
.text:00403D69 loc_403D69:			       ; CODE XREF: ___sbh_free_block+2F1j
.text:00403D69		       mov     eax, ___sbh_pHeaderList
.text:00403D6E		       mov     ___sbh_pHeaderScan, eax
.text:00403D73
.text:00403D73 loc_403D73:			       ; CODE XREF: ___sbh_free_block+223j
.text:00403D73					       ; ___sbh_free_block+29Aj
.text:00403D73		       mov     eax, [ebp+indPrev]
.text:00403D76		       mov     ___sbh_pHeaderDefer, eax
.text:00403D7B		       mov     ___sbh_indGroupDefer, edi
.text:00403D81
.text:00403D81 loc_403D81:			       ; CODE XREF: ___sbh_free_block+216j
.text:00403D81		       pop     ebx
.text:00403D82
.text:00403D82 loc_403D82:			       ; CODE XREF: ___sbh_free_block+37j
.text:00403D82		       pop     edi
.text:00403D83		       pop     esi
.text:00403D84		       leave
.text:00403D85		       retn
.text:00403D85 ___sbh_free_block endp
.text:00403D85
.text:00403D86
.text:00403D86 ; =============== S U B R O U T I N E =======================================
.text:00403D86
.text:00403D86
.text:00403D86 ; tagHeader *__cdecl __sbh_alloc_new_region()
.text:00403D86 ___sbh_alloc_new_region proc near       ; CODE XREF: ___sbh_alloc_block+C0p
.text:00403D86		       mov     eax, ___sbh_sizeHeaderList
.text:00403D8B		       push    esi
.text:00403D8C		       mov     esi, ___sbh_cntHeaderList
.text:00403D92		       push    edi
.text:00403D93		       xor     edi, edi
.text:00403D95		       cmp     esi, eax
.text:00403D97		       jnz     short loc_403DCD
.text:00403D99		       add     eax, 10h
.text:00403D9C		       imul    eax, 14h
.text:00403D9F		       push    eax	       ; dwBytes
.text:00403DA0		       push    ___sbh_pHeaderList ; lpMem
.text:00403DA6		       push    edi	       ; dwFlags
.text:00403DA7		       push    __crtheap       ; hHeap
.text:00403DAD		       call    ds:__imp__HeapReAlloc@16	; HeapReAlloc(x,x,x,x)
.text:00403DB3		       cmp     eax, edi
.text:00403DB5		       jnz     short loc_403DBB
.text:00403DB7
.text:00403DB7 loc_403DB7:			       ; CODE XREF: ___sbh_alloc_new_region+68j
.text:00403DB7					       ; ___sbh_alloc_new_region+94j
.text:00403DB7		       xor     eax, eax
.text:00403DB9		       jmp     short loc_403E33
.text:00403DBB ; ---------------------------------------------------------------------------
.text:00403DBB
.text:00403DBB loc_403DBB:			       ; CODE XREF: ___sbh_alloc_new_region+2Fj
.text:00403DBB		       add     ___sbh_sizeHeaderList, 10h
.text:00403DC2		       mov     esi, ___sbh_cntHeaderList
.text:00403DC8		       mov     ___sbh_pHeaderList, eax
.text:00403DCD
.text:00403DCD loc_403DCD:			       ; CODE XREF: ___sbh_alloc_new_region+11j
.text:00403DCD		       imul    esi, 14h
.text:00403DD0		       add     esi, ___sbh_pHeaderList
.text:00403DD6		       push    41C4h	       ; dwBytes
.text:00403DDB		       push    8	       ; dwFlags
.text:00403DDD		       push    __crtheap       ; hHeap
.text:00403DE3		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:00403DE9		       cmp     eax, edi
.text:00403DEB		       mov     [esi+10h], eax
.text:00403DEE		       jz      short loc_403DB7
.text:00403DF0		       push    4	       ; flProtect
.text:00403DF2		       push    2000h	       ; flAllocationType
.text:00403DF7		       push    100000h	       ; dwSize
.text:00403DFC		       push    edi	       ; lpAddress
.text:00403DFD		       call    ds:__imp__VirtualAlloc@16 ; VirtualAlloc(x,x,x,x)
.text:00403E03		       cmp     eax, edi
.text:00403E05		       mov     [esi+0Ch], eax
.text:00403E08		       jnz     short loc_403E1C
.text:00403E0A		       push    dword ptr [esi+10h] ; lpMem
.text:00403E0D		       push    edi	       ; dwFlags
.text:00403E0E		       push    __crtheap       ; hHeap
.text:00403E14		       call    ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:00403E1A		       jmp     short loc_403DB7
.text:00403E1C ; ---------------------------------------------------------------------------
.text:00403E1C
.text:00403E1C loc_403E1C:			       ; CODE XREF: ___sbh_alloc_new_region+82j
.text:00403E1C		       or      dword ptr [esi+8], 0FFFFFFFFh
.text:00403E20		       mov     [esi], edi
.text:00403E22		       mov     [esi+4],	edi
.text:00403E25		       inc     ___sbh_cntHeaderList
.text:00403E2B		       mov     eax, [esi+10h]
.text:00403E2E		       or      dword ptr [eax],	0FFFFFFFFh
.text:00403E31		       mov     eax, esi
.text:00403E33
.text:00403E33 loc_403E33:			       ; CODE XREF: ___sbh_alloc_new_region+33j
.text:00403E33		       pop     edi
.text:00403E34		       pop     esi
.text:00403E35		       retn
.text:00403E35 ___sbh_alloc_new_region endp
.text:00403E35
.text:00403E36
.text:00403E36 ; =============== S U B R O U T I N E =======================================
.text:00403E36
.text:00403E36 ; Attributes: bp-based frame
.text:00403E36
.text:00403E36 ; int __cdecl __sbh_alloc_new_group(tagHeader *pHeader)
.text:00403E36 ___sbh_alloc_new_group proc near	       ; CODE XREF: ___sbh_alloc_block+D6p
.text:00403E36
.text:00403E36 pGroup	       = dword ptr -8
.text:00403E36 pHeapEndPage    = dword ptr -4
.text:00403E36 pHeader	       = dword ptr  8
.text:00403E36
.text:00403E36		       push    ebp
.text:00403E37		       mov     ebp, esp
.text:00403E39		       push    ecx
.text:00403E3A		       push    ecx
.text:00403E3B		       mov     ecx, [ebp+pHeader]
.text:00403E3E		       mov     eax, [ecx+8]
.text:00403E41		       push    ebx
.text:00403E42		       push    esi
.text:00403E43		       mov     esi, [ecx+10h]
.text:00403E46		       push    edi
.text:00403E47		       xor     ebx, ebx
.text:00403E49		       jmp     short loc_403E4E
.text:00403E4B ; ---------------------------------------------------------------------------
.text:00403E4B
.text:00403E4B loc_403E4B:			       ; CODE XREF: ___sbh_alloc_new_group+1Aj
.text:00403E4B		       add     eax, eax
.text:00403E4D		       inc     ebx
.text:00403E4E
.text:00403E4E loc_403E4E:			       ; CODE XREF: ___sbh_alloc_new_group+13j
.text:00403E4E		       test    eax, eax
.text:00403E50		       jge     short loc_403E4B
.text:00403E52		       mov     eax, ebx
.text:00403E54		       imul    eax, 204h
.text:00403E5A		       lea     eax, [eax+esi+144h]
.text:00403E61		       push    3Fh
.text:00403E63		       mov     [ebp+pGroup], eax
.text:00403E66		       pop     edx
.text:00403E67
.text:00403E67 loc_403E67:			       ; CODE XREF: ___sbh_alloc_new_group+3Bj
.text:00403E67		       mov     [eax+8],	eax
.text:00403E6A		       mov     [eax+4],	eax
.text:00403E6D		       add     eax, 8
.text:00403E70		       dec     edx
.text:00403E71		       jnz     short loc_403E67
.text:00403E73		       push    4	       ; flProtect
.text:00403E75		       mov     edi, ebx
.text:00403E77		       push    1000h	       ; flAllocationType
.text:00403E7C		       shl     edi, 0Fh
.text:00403E7F		       add     edi, [ecx+0Ch]
.text:00403E82		       push    8000h	       ; dwSize
.text:00403E87		       push    edi	       ; lpAddress
.text:00403E88		       call    ds:__imp__VirtualAlloc@16 ; VirtualAlloc(x,x,x,x)
.text:00403E8E		       test    eax, eax
.text:00403E90		       jnz     short loc_403E9A
.text:00403E92		       or      eax, 0FFFFFFFFh
.text:00403E95		       jmp     loc_403F37
.text:00403E9A ; ---------------------------------------------------------------------------
.text:00403E9A
.text:00403E9A loc_403E9A:			       ; CODE XREF: ___sbh_alloc_new_group+5Aj
.text:00403E9A		       lea     edx, [edi+7000h]
.text:00403EA0		       cmp     edi, edx
.text:00403EA2		       mov     [ebp+pHeapEndPage], edx
.text:00403EA5		       ja      short loc_403EEA
.text:00403EA7		       mov     ecx, edx
.text:00403EA9		       sub     ecx, edi
.text:00403EAB		       shr     ecx, 0Ch
.text:00403EAE		       lea     eax, [edi+10h]
.text:00403EB1		       inc     ecx
.text:00403EB2
.text:00403EB2 loc_403EB2:			       ; CODE XREF: ___sbh_alloc_new_group+AFj
.text:00403EB2		       or      dword ptr [eax-8], 0FFFFFFFFh
.text:00403EB6		       or      dword ptr [eax+0FECh], 0FFFFFFFFh
.text:00403EBD		       lea     edx, [eax+0FFCh]
.text:00403EC3		       mov     [eax], edx
.text:00403EC5		       lea     edx, [eax-1004h]
.text:00403ECB		       mov     dword ptr [eax-4], 0FF0h
.text:00403ED2		       mov     [eax+4],	edx
.text:00403ED5		       mov     dword ptr [eax+0FE8h], 0FF0h
.text:00403EDF		       add     eax, 1000h
.text:00403EE4		       dec     ecx
.text:00403EE5		       jnz     short loc_403EB2
.text:00403EE7		       mov     edx, [ebp+pHeapEndPage]
.text:00403EEA
.text:00403EEA loc_403EEA:			       ; CODE XREF: ___sbh_alloc_new_group+6Fj
.text:00403EEA		       mov     eax, [ebp+pGroup]
.text:00403EED		       add     eax, 1F8h
.text:00403EF2		       lea     ecx, [edi+0Ch]
.text:00403EF5		       mov     [eax+4],	ecx
.text:00403EF8		       mov     [ecx+8],	eax
.text:00403EFB		       lea     ecx, [edx+0Ch]
.text:00403EFE		       mov     [eax+8],	ecx
.text:00403F01		       mov     [ecx+4],	eax
.text:00403F04		       and     dword ptr [esi+ebx*4+44h], 0
.text:00403F09		       xor     edi, edi
.text:00403F0B		       inc     edi
.text:00403F0C		       mov     [esi+ebx*4+0C4h], edi
.text:00403F13		       mov     al, [esi+43h]
.text:00403F16		       mov     cl, al
.text:00403F18		       inc     cl
.text:00403F1A		       test    al, al
.text:00403F1C		       mov     eax, [ebp+pHeader]
.text:00403F1F		       mov     [esi+43h], cl
.text:00403F22		       jnz     short loc_403F27
.text:00403F24		       or      [eax+4],	edi
.text:00403F27
.text:00403F27 loc_403F27:			       ; CODE XREF: ___sbh_alloc_new_group+ECj
.text:00403F27		       mov     edx, 80000000h
.text:00403F2C		       mov     ecx, ebx
.text:00403F2E		       shr     edx, cl
.text:00403F30		       not     edx
.text:00403F32		       and     [eax+8],	edx
.text:00403F35		       mov     eax, ebx
.text:00403F37
.text:00403F37 loc_403F37:			       ; CODE XREF: ___sbh_alloc_new_group+5Fj
.text:00403F37		       pop     edi
.text:00403F38		       pop     esi
.text:00403F39		       pop     ebx
.text:00403F3A		       leave
.text:00403F3B		       retn
.text:00403F3B ___sbh_alloc_new_group endp
.text:00403F3B
.text:00403F3C
.text:00403F3C ; =============== S U B R O U T I N E =======================================
.text:00403F3C
.text:00403F3C ; Attributes: bp-based frame
.text:00403F3C
.text:00403F3C ; int __cdecl __sbh_resize_block(tagHeader *pHeader, void *pvAlloc, int intNew)
.text:00403F3C ___sbh_resize_block proc	near	       ; CODE XREF: _realloc+77p
.text:00403F3C
.text:00403F3C pGroup	       = dword ptr -0Ch
.text:00403F3C indNext	       = dword ptr -8
.text:00403F3C sizeNext	       = dword ptr -4
.text:00403F3C pHeader	       = dword ptr  8
.text:00403F3C pvAlloc	       = dword ptr  0Ch
.text:00403F3C pHead	       = dword ptr  10h
.text:00403F3C
.text:00403F3C		       push    ebp
.text:00403F3D		       mov     ebp, esp
.text:00403F3F		       sub     esp, 0Ch
.text:00403F42		       mov     ecx, [ebp+pHeader]
.text:00403F45		       mov     eax, [ecx+10h]
.text:00403F48		       push    ebx
.text:00403F49		       push    esi
.text:00403F4A		       mov     esi, [ebp+pHead]
.text:00403F4D		       push    edi
.text:00403F4E		       mov     edi, [ebp+pvAlloc]
.text:00403F51		       mov     edx, edi
.text:00403F53		       sub     edx, [ecx+0Ch]
.text:00403F56		       add     esi, 17h
.text:00403F59		       shr     edx, 0Fh
.text:00403F5C		       mov     ecx, edx
.text:00403F5E		       imul    ecx, 204h
.text:00403F64		       lea     ecx, [ecx+eax+144h]
.text:00403F6B		       mov     [ebp+pGroup], ecx
.text:00403F6E		       mov     ecx, [edi-4]
.text:00403F71		       and     esi, 0FFFFFFF0h
.text:00403F74		       dec     ecx
.text:00403F75		       cmp     esi, ecx
.text:00403F77		       lea     edi, [ecx+edi-4]
.text:00403F7B		       mov     ebx, [edi]
.text:00403F7D		       mov     [ebp+pHead], ecx
.text:00403F80		       mov     [ebp+sizeNext], ebx
.text:00403F83		       jle     loc_4040DE
.text:00403F89		       test    bl, 1
.text:00403F8C		       jnz     loc_4040D7
.text:00403F92		       add     ebx, ecx
.text:00403F94		       cmp     esi, ebx
.text:00403F96		       jg      loc_4040D7
.text:00403F9C		       mov     ecx, [ebp+sizeNext]
.text:00403F9F		       sar     ecx, 4
.text:00403FA2		       dec     ecx
.text:00403FA3		       cmp     ecx, 3Fh
.text:00403FA6		       mov     [ebp+indNext], ecx
.text:00403FA9		       jbe     short loc_403FB1
.text:00403FAB		       push    3Fh
.text:00403FAD		       pop     ecx
.text:00403FAE		       mov     [ebp+indNext], ecx
.text:00403FB1
.text:00403FB1 loc_403FB1:			       ; CODE XREF: ___sbh_resize_block+6Dj
.text:00403FB1		       mov     ebx, [edi+4]
.text:00403FB4		       cmp     ebx, [edi+8]
.text:00403FB7		       jnz     short loc_403FFC
.text:00403FB9		       cmp     ecx, 20h
.text:00403FBC		       mov     ebx, 80000000h
.text:00403FC1		       jnb     short loc_403FDD
.text:00403FC3		       shr     ebx, cl
.text:00403FC5		       mov     ecx, [ebp+indNext]
.text:00403FC8		       lea     ecx, [ecx+eax+4]
.text:00403FCC		       not     ebx
.text:00403FCE		       and     [eax+edx*4+44h],	ebx
.text:00403FD2		       dec     byte ptr	[ecx]
.text:00403FD4		       jnz     short loc_403FFC
.text:00403FD6		       mov     ecx, [ebp+pHeader]
.text:00403FD9		       and     [ecx], ebx
.text:00403FDB		       jmp     short loc_403FFC
.text:00403FDD ; ---------------------------------------------------------------------------
.text:00403FDD
.text:00403FDD loc_403FDD:			       ; CODE XREF: ___sbh_resize_block+85j
.text:00403FDD		       add     ecx, 0FFFFFFE0h
.text:00403FE0		       shr     ebx, cl
.text:00403FE2		       mov     ecx, [ebp+indNext]
.text:00403FE5		       lea     ecx, [ecx+eax+4]
.text:00403FE9		       not     ebx
.text:00403FEB		       and     [eax+edx*4+0C4h], ebx
.text:00403FF2		       dec     byte ptr	[ecx]
.text:00403FF4		       jnz     short loc_403FFC
.text:00403FF6		       mov     ecx, [ebp+pHeader]
.text:00403FF9		       and     [ecx+4],	ebx
.text:00403FFC
.text:00403FFC loc_403FFC:			       ; CODE XREF: ___sbh_resize_block+7Bj
.text:00403FFC					       ; ___sbh_resize_block+98j ...
.text:00403FFC		       mov     ecx, [edi+8]
.text:00403FFF		       mov     ebx, [edi+4]
.text:00404002		       mov     [ecx+4],	ebx
.text:00404005		       mov     ecx, [edi+4]
.text:00404008		       mov     edi, [edi+8]
.text:0040400B		       mov     [ecx+8],	edi
.text:0040400E		       mov     ecx, [ebp+pHead]
.text:00404011		       sub     ecx, esi
.text:00404013		       add     [ebp+sizeNext], ecx
.text:00404016		       cmp     [ebp+sizeNext], 0
.text:0040401A		       jle     loc_4040C5
.text:00404020		       mov     edi, [ebp+sizeNext]
.text:00404023		       mov     ecx, [ebp+pvAlloc]
.text:00404026		       sar     edi, 4
.text:00404029		       dec     edi
.text:0040402A		       cmp     edi, 3Fh
.text:0040402D		       lea     ecx, [ecx+esi-4]
.text:00404031		       jbe     short loc_404036
.text:00404033		       push    3Fh
.text:00404035		       pop     edi
.text:00404036
.text:00404036 loc_404036:			       ; CODE XREF: ___sbh_resize_block+F5j
.text:00404036		       mov     ebx, [ebp+pGroup]
.text:00404039		       lea     ebx, [ebx+edi*8]
.text:0040403C		       mov     [ebp+pHead], ebx
.text:0040403F		       mov     ebx, [ebx+4]
.text:00404042		       mov     [ecx+4],	ebx
.text:00404045		       mov     ebx, [ebp+pHead]
.text:00404048		       mov     [ecx+8],	ebx
.text:0040404B		       mov     [ebx+4],	ecx
.text:0040404E		       mov     ebx, [ecx+4]
.text:00404051		       mov     [ebx+8],	ecx
.text:00404054		       mov     ebx, [ecx+4]
.text:00404057		       cmp     ebx, [ecx+8]
.text:0040405A		       jnz     short loc_4040B3
.text:0040405C		       mov     cl, [edi+eax+4]
.text:00404060		       mov     byte ptr	[ebp+pHead+3], cl
.text:00404063		       inc     cl
.text:00404065		       cmp     edi, 20h
.text:00404068		       mov     [edi+eax+4], cl
.text:0040406C		       jnb     short loc_40408A
.text:0040406E		       cmp     byte ptr	[ebp+pHead+3], 0
.text:00404072		       jnz     short loc_404082
.text:00404074		       mov     ecx, edi
.text:00404076		       mov     ebx, 80000000h
.text:0040407B		       shr     ebx, cl
.text:0040407D		       mov     ecx, [ebp+pHeader]
.text:00404080		       or      [ecx], ebx
.text:00404082
.text:00404082 loc_404082:			       ; CODE XREF: ___sbh_resize_block+136j
.text:00404082		       lea     eax, [eax+edx*4+44h]
.text:00404086		       mov     ecx, edi
.text:00404088		       jmp     short loc_4040AA
.text:0040408A ; ---------------------------------------------------------------------------
.text:0040408A
.text:0040408A loc_40408A:			       ; CODE XREF: ___sbh_resize_block+130j
.text:0040408A		       cmp     byte ptr	[ebp+pHead+3], 0
.text:0040408E		       jnz     short loc_4040A0
.text:00404090		       lea     ecx, [edi-20h]
.text:00404093		       mov     ebx, 80000000h
.text:00404098		       shr     ebx, cl
.text:0040409A		       mov     ecx, [ebp+pHeader]
.text:0040409D		       or      [ecx+4],	ebx
.text:004040A0
.text:004040A0 loc_4040A0:			       ; CODE XREF: ___sbh_resize_block+152j
.text:004040A0		       lea     eax, [eax+edx*4+0C4h]
.text:004040A7		       lea     ecx, [edi-20h]
.text:004040AA
.text:004040AA loc_4040AA:			       ; CODE XREF: ___sbh_resize_block+14Cj
.text:004040AA		       mov     edx, 80000000h
.text:004040AF		       shr     edx, cl
.text:004040B1		       or      [eax], edx
.text:004040B3
.text:004040B3 loc_4040B3:			       ; CODE XREF: ___sbh_resize_block+11Ej
.text:004040B3		       mov     edx, [ebp+pvAlloc]
.text:004040B6		       mov     ecx, [ebp+sizeNext]
.text:004040B9		       lea     eax, [edx+esi-4]
.text:004040BD		       mov     [eax], ecx
.text:004040BF		       mov     [ecx+eax-4], ecx
.text:004040C3		       jmp     short loc_4040C8
.text:004040C5 ; ---------------------------------------------------------------------------
.text:004040C5
.text:004040C5 loc_4040C5:			       ; CODE XREF: ___sbh_resize_block+DEj
.text:004040C5		       mov     edx, [ebp+pvAlloc]
.text:004040C8
.text:004040C8 loc_4040C8:			       ; CODE XREF: ___sbh_resize_block+187j
.text:004040C8		       lea     eax, [esi+1]
.text:004040CB		       mov     [edx-4],	eax
.text:004040CE		       mov     [edx+esi-8], eax
.text:004040D2		       jmp     loc_404213
.text:004040D7 ; ---------------------------------------------------------------------------
.text:004040D7
.text:004040D7 loc_4040D7:			       ; CODE XREF: ___sbh_resize_block+50j
.text:004040D7					       ; ___sbh_resize_block+5Aj
.text:004040D7		       xor     eax, eax
.text:004040D9		       jmp     loc_404216
.text:004040DE ; ---------------------------------------------------------------------------
.text:004040DE
.text:004040DE loc_4040DE:			       ; CODE XREF: ___sbh_resize_block+47j
.text:004040DE		       jge     loc_404213
.text:004040E4		       mov     ebx, [ebp+pvAlloc]
.text:004040E7		       sub     [ebp+pHead], esi
.text:004040EA		       lea     ecx, [esi+1]
.text:004040ED		       mov     [ebx-4],	ecx
.text:004040F0		       lea     ebx, [ebx+esi-4]
.text:004040F4		       mov     esi, [ebp+pHead]
.text:004040F7		       sar     esi, 4
.text:004040FA		       dec     esi
.text:004040FB		       cmp     esi, 3Fh
.text:004040FE		       mov     [ebp+pvAlloc], ebx
.text:00404101		       mov     [ebx-4],	ecx
.text:00404104		       jbe     short loc_404109
.text:00404106		       push    3Fh
.text:00404108		       pop     esi
.text:00404109
.text:00404109 loc_404109:			       ; CODE XREF: ___sbh_resize_block+1C8j
.text:00404109		       test    byte ptr	[ebp+sizeNext],	1
.text:0040410D		       jnz     loc_404193
.text:00404113		       mov     esi, [ebp+sizeNext]
.text:00404116		       sar     esi, 4
.text:00404119		       dec     esi
.text:0040411A		       cmp     esi, 3Fh
.text:0040411D		       jbe     short loc_404122
.text:0040411F		       push    3Fh
.text:00404121		       pop     esi
.text:00404122
.text:00404122 loc_404122:			       ; CODE XREF: ___sbh_resize_block+1E1j
.text:00404122		       mov     ecx, [edi+4]
.text:00404125		       cmp     ecx, [edi+8]
.text:00404128		       jnz     short loc_40416C
.text:0040412A		       cmp     esi, 20h
.text:0040412D		       mov     ebx, 80000000h
.text:00404132		       jnb     short loc_40414D
.text:00404134		       mov     ecx, esi
.text:00404136		       shr     ebx, cl
.text:00404138		       lea     esi, [esi+eax+4]
.text:0040413C		       not     ebx
.text:0040413E		       and     [eax+edx*4+44h],	ebx
.text:00404142		       dec     byte ptr	[esi]
.text:00404144		       jnz     short loc_404169
.text:00404146		       mov     ecx, [ebp+pHeader]
.text:00404149		       and     [ecx], ebx
.text:0040414B		       jmp     short loc_404169
.text:0040414D ; ---------------------------------------------------------------------------
.text:0040414D
.text:0040414D loc_40414D:			       ; CODE XREF: ___sbh_resize_block+1F6j
.text:0040414D		       lea     ecx, [esi-20h]
.text:00404150		       shr     ebx, cl
.text:00404152		       lea     ecx, [esi+eax+4]
.text:00404156		       not     ebx
.text:00404158		       and     [eax+edx*4+0C4h], ebx
.text:0040415F		       dec     byte ptr	[ecx]
.text:00404161		       jnz     short loc_404169
.text:00404163		       mov     ecx, [ebp+pHeader]
.text:00404166		       and     [ecx+4],	ebx
.text:00404169
.text:00404169 loc_404169:			       ; CODE XREF: ___sbh_resize_block+208j
.text:00404169					       ; ___sbh_resize_block+20Fj ...
.text:00404169		       mov     ebx, [ebp+pvAlloc]
.text:0040416C
.text:0040416C loc_40416C:			       ; CODE XREF: ___sbh_resize_block+1ECj
.text:0040416C		       mov     ecx, [edi+8]
.text:0040416F		       mov     esi, [edi+4]
.text:00404172		       mov     [ecx+4],	esi
.text:00404175		       mov     esi, [edi+8]
.text:00404178		       mov     ecx, [edi+4]
.text:0040417B		       mov     [ecx+8],	esi
.text:0040417E		       mov     esi, [ebp+pHead]
.text:00404181		       add     esi, [ebp+sizeNext]
.text:00404184		       mov     [ebp+pHead], esi
.text:00404187		       sar     esi, 4
.text:0040418A		       dec     esi
.text:0040418B		       cmp     esi, 3Fh
.text:0040418E		       jbe     short loc_404193
.text:00404190		       push    3Fh
.text:00404192		       pop     esi
.text:00404193
.text:00404193 loc_404193:			       ; CODE XREF: ___sbh_resize_block+1D1j
.text:00404193					       ; ___sbh_resize_block+252j
.text:00404193		       mov     ecx, [ebp+pGroup]
.text:00404196		       lea     ecx, [ecx+esi*8]
.text:00404199		       mov     edi, [ecx+4]
.text:0040419C		       mov     [ebx+8],	ecx
.text:0040419F		       mov     [ebx+4],	edi
.text:004041A2		       mov     [ecx+4],	ebx
.text:004041A5		       mov     ecx, [ebx+4]
.text:004041A8		       mov     [ecx+8],	ebx
.text:004041AB		       mov     ecx, [ebx+4]
.text:004041AE		       cmp     ecx, [ebx+8]
.text:004041B1		       jnz     short loc_40420A
.text:004041B3		       mov     cl, [esi+eax+4]
.text:004041B7		       mov     byte ptr	[ebp+pvAlloc+3], cl
.text:004041BA		       inc     cl
.text:004041BC		       cmp     esi, 20h
.text:004041BF		       mov     [esi+eax+4], cl
.text:004041C3		       jnb     short loc_4041E1
.text:004041C5		       cmp     byte ptr	[ebp+pvAlloc+3], 0
.text:004041C9		       jnz     short loc_4041D9
.text:004041CB		       mov     ecx, esi
.text:004041CD		       mov     edi, 80000000h
.text:004041D2		       shr     edi, cl
.text:004041D4		       mov     ecx, [ebp+pHeader]
.text:004041D7		       or      [ecx], edi
.text:004041D9
.text:004041D9 loc_4041D9:			       ; CODE XREF: ___sbh_resize_block+28Dj
.text:004041D9		       lea     eax, [eax+edx*4+44h]
.text:004041DD		       mov     ecx, esi
.text:004041DF		       jmp     short loc_404201
.text:004041E1 ; ---------------------------------------------------------------------------
.text:004041E1
.text:004041E1 loc_4041E1:			       ; CODE XREF: ___sbh_resize_block+287j
.text:004041E1		       cmp     byte ptr	[ebp+pvAlloc+3], 0
.text:004041E5		       jnz     short loc_4041F7
.text:004041E7		       lea     ecx, [esi-20h]
.text:004041EA		       mov     edi, 80000000h
.text:004041EF		       shr     edi, cl
.text:004041F1		       mov     ecx, [ebp+pHeader]
.text:004041F4		       or      [ecx+4],	edi
.text:004041F7
.text:004041F7 loc_4041F7:			       ; CODE XREF: ___sbh_resize_block+2A9j
.text:004041F7		       lea     eax, [eax+edx*4+0C4h]
.text:004041FE		       lea     ecx, [esi-20h]
.text:00404201
.text:00404201 loc_404201:			       ; CODE XREF: ___sbh_resize_block+2A3j
.text:00404201		       mov     edx, 80000000h
.text:00404206		       shr     edx, cl
.text:00404208		       or      [eax], edx
.text:0040420A
.text:0040420A loc_40420A:			       ; CODE XREF: ___sbh_resize_block+275j
.text:0040420A		       mov     eax, [ebp+pHead]
.text:0040420D		       mov     [ebx], eax
.text:0040420F		       mov     [eax+ebx-4], eax
.text:00404213
.text:00404213 loc_404213:			       ; CODE XREF: ___sbh_resize_block+196j
.text:00404213					       ; ___sbh_resize_block:loc_4040DEj
.text:00404213		       xor     eax, eax
.text:00404215		       inc     eax
.text:00404216
.text:00404216 loc_404216:			       ; CODE XREF: ___sbh_resize_block+19Dj
.text:00404216		       pop     edi
.text:00404217		       pop     esi
.text:00404218		       pop     ebx
.text:00404219		       leave
.text:0040421A		       retn
.text:0040421A ___sbh_resize_block endp
.text:0040421A
.text:0040421B
.text:0040421B ; =============== S U B R O U T I N E =======================================
.text:0040421B
.text:0040421B
.text:0040421B ___sbh_heapmin  proc near
.text:0040421B		       mov     eax, ___sbh_pHeaderDefer
.text:00404220		       test    eax, eax
.text:00404222		       jz      locret_4042E7
.text:00404228		       mov     ecx, ___sbh_indGroupDefer
.text:0040422E		       push    4000h	       ; dwFreeType
.text:00404233		       shl     ecx, 0Fh
.text:00404236		       add     ecx, [eax+0Ch]
.text:00404239		       push    8000h	       ; dwSize
.text:0040423E		       push    ecx	       ; lpAddress
.text:0040423F		       call    ds:__imp__VirtualFree@12	; VirtualFree(x,x,x)
.text:00404245		       mov     ecx, ___sbh_indGroupDefer
.text:0040424B		       mov     eax, ___sbh_pHeaderDefer
.text:00404250		       mov     edx, 80000000h
.text:00404255		       shr     edx, cl
.text:00404257		       or      [eax+8],	edx
.text:0040425A		       mov     eax, ___sbh_pHeaderDefer
.text:0040425F		       mov     eax, [eax+10h]
.text:00404262		       mov     ecx, ___sbh_indGroupDefer
.text:00404268		       and     dword ptr [eax+ecx*4+0C4h], 0
.text:00404270		       mov     eax, ___sbh_pHeaderDefer
.text:00404275		       mov     eax, [eax+10h]
.text:00404278		       dec     byte ptr	[eax+43h]
.text:0040427B		       mov     eax, ___sbh_pHeaderDefer
.text:00404280		       mov     ecx, [eax+10h]
.text:00404283		       cmp     byte ptr	[ecx+43h], 0
.text:00404287		       jnz     short loc_404292
.text:00404289		       and     dword ptr [eax+4], 0FFFFFFFEh
.text:0040428D		       mov     eax, ___sbh_pHeaderDefer
.text:00404292
.text:00404292 loc_404292:			       ; CODE XREF: ___sbh_heapmin+6Cj
.text:00404292		       cmp     dword ptr [eax+8], 0FFFFFFFFh
.text:00404296		       jnz     short loc_4042E0
.text:00404298		       cmp     ___sbh_cntHeaderList, 1
.text:0040429F		       jle     short loc_4042E0
.text:004042A1		       push    dword ptr [eax+10h] ; lpMem
.text:004042A4		       push    0	       ; dwFlags
.text:004042A6		       push    __crtheap       ; hHeap
.text:004042AC		       call    ds:__imp__HeapFree@12 ; HeapFree(x,x,x)
.text:004042B2		       mov     ecx, ___sbh_cntHeaderList
.text:004042B8		       mov     eax, ___sbh_pHeaderDefer
.text:004042BD		       imul    ecx, 14h
.text:004042C0		       mov     edx, ___sbh_pHeaderList
.text:004042C6		       sub     ecx, eax
.text:004042C8		       lea     ecx, [ecx+edx-14h]
.text:004042CC		       push    ecx	       ; count
.text:004042CD		       lea     ecx, [eax+14h]
.text:004042D0		       push    ecx	       ; src
.text:004042D1		       push    eax	       ; dst
.text:004042D2		       call    _memmove
.text:004042D7		       add     esp, 0Ch
.text:004042DA		       dec     ___sbh_cntHeaderList
.text:004042E0
.text:004042E0 loc_4042E0:			       ; CODE XREF: ___sbh_heapmin+7Bj
.text:004042E0					       ; ___sbh_heapmin+84j
.text:004042E0		       and     ___sbh_pHeaderDefer, 0
.text:004042E7
.text:004042E7 locret_4042E7:			       ; CODE XREF: ___sbh_heapmin+7j
.text:004042E7		       retn
.text:004042E7 ___sbh_heapmin  endp
.text:004042E7
.text:004042E8
.text:004042E8 ; =============== S U B R O U T I N E =======================================
.text:004042E8
.text:004042E8 ; Attributes: bp-based frame
.text:004042E8
.text:004042E8 ; int __cdecl __sbh_heap_check()
.text:004042E8 ___sbh_heap_check proc near
.text:004042E8
.text:004042E8 cntFree	       = dword ptr -138h
.text:004042E8 var_38	       = dword ptr -38h
.text:004042E8 pHeader	       = dword ptr -34h
.text:004042E8 var_30	       = dword ptr -30h
.text:004042E8 pEntry	       = dword ptr -2Ch
.text:004042E8 bitvGroupHi     = dword ptr -28h
.text:004042E8 pGroup	       = dword ptr -24h
.text:004042E8 bitvCommit      = dword ptr -20h
.text:004042E8 indHeader       = dword ptr -1Ch
.text:004042E8 bitvGroupLo     = dword ptr -18h
.text:004042E8 bitvEntryLo     = dword ptr -14h
.text:004042E8 bitvEntryHi     = dword ptr -10h
.text:004042E8 indGroup	       = dword ptr -0Ch
.text:004042E8 pHeapGroup      = dword ptr -8
.text:004042E8 cntAllocated    = dword ptr -4
.text:004042E8
.text:004042E8		       push    ebp
.text:004042E9		       mov     ebp, esp
.text:004042EB		       mov     eax, ___sbh_pHeaderList
.text:004042F0		       sub     esp, 138h
.text:004042F6		       push    ebx
.text:004042F7		       xor     ebx, ebx
.text:004042F9		       cmp     eax, ebx
.text:004042FB		       jnz     short loc_404305
.text:004042FD		       or      eax, 0FFFFFFFFh
.text:00404300		       jmp     loc_40458A
.text:00404305 ; ---------------------------------------------------------------------------
.text:00404305
.text:00404305 loc_404305:			       ; CODE XREF: ___sbh_heap_check+13j
.text:00404305		       cmp     ___sbh_cntHeaderList, ebx
.text:0040430B		       push    esi
.text:0040430C		       mov     edx, eax
.text:0040430E		       push    edi
.text:0040430F		       mov     [ebp+pHeader], edx
.text:00404312		       mov     [ebp+indHeader],	ebx
.text:00404315		       jle     loc_404586
.text:0040431B
.text:0040431B loc_40431B:			       ; CODE XREF: ___sbh_heap_check+298j
.text:0040431B		       mov     eax, [edx+10h]
.text:0040431E		       cmp     eax, ebx
.text:00404320		       jz      loc_40458D
.text:00404326		       mov     ecx, [edx+0Ch]
.text:00404329		       mov     [ebp+pHeapGroup], ecx
.text:0040432C		       lea     ecx, [eax+144h]
.text:00404332		       mov     [ebp+pGroup], ecx
.text:00404335		       mov     ecx, [edx+8]
.text:00404338		       lea     esi, [eax+0C4h]
.text:0040433E		       mov     [ebp+bitvCommit], ecx
.text:00404341		       mov     [ebp+bitvEntryHi], ebx
.text:00404344		       mov     [ebp+bitvEntryLo], ebx
.text:00404347		       mov     [ebp+indGroup], ebx
.text:0040434A		       mov     [ebp+var_38], esi
.text:0040434D
.text:0040434D loc_40434D:			       ; CODE XREF: ___sbh_heap_check+271j
.text:0040434D		       push    40h
.text:0040434F		       xor     eax, eax
.text:00404351		       cmp     [ebp+bitvCommit], ebx
.text:00404354		       pop     ecx
.text:00404355		       lea     edi, [ebp+cntFree]
.text:0040435B		       mov     [ebp+bitvGroupHi], ebx
.text:0040435E		       mov     [ebp+bitvGroupLo], ebx
.text:00404361		       mov     [ebp+cntAllocated], ebx
.text:00404364		       rep stosd
.text:00404366		       jl      loc_404524
.text:0040436C		       cmp     [ebp+pHeapGroup], ebx
.text:0040436F		       jz      loc_404591
.text:00404375		       mov     edx, [ebp+pHeapGroup]
.text:00404378		       add     edx, 0FFCh
.text:0040437E
.text:0040437E loc_40437E:			       ; CODE XREF: ___sbh_heap_check+124j
.text:0040437E		       cmp     dword ptr [edx-0FF4h], 0FFFFFFFFh
.text:00404385		       lea     esi, [edx-0FF0h]
.text:0040438B		       jnz     loc_4045A1
.text:00404391		       cmp     dword ptr [edx],	0FFFFFFFFh
.text:00404394		       jnz     loc_4045A1
.text:0040439A
.text:0040439A loc_40439A:			       ; CODE XREF: ___sbh_heap_check+112j
.text:0040439A		       mov     ecx, [esi]
.text:0040439C		       test    cl, 1
.text:0040439F		       mov     edi, ecx
.text:004043A1		       jz      short loc_4043B5
.text:004043A3		       dec     ecx
.text:004043A4		       cmp     ecx, 400h
.text:004043AA		       jg      loc_404595
.text:004043B0		       inc     [ebp+cntAllocated]
.text:004043B3		       jmp     short loc_4043CC
.text:004043B5 ; ---------------------------------------------------------------------------
.text:004043B5
.text:004043B5 loc_4043B5:			       ; CODE XREF: ___sbh_heap_check+B9j
.text:004043B5		       mov     eax, ecx
.text:004043B7		       sar     eax, 4
.text:004043BA		       dec     eax
.text:004043BB		       cmp     eax, 3Fh
.text:004043BE		       jle     short loc_4043C3
.text:004043C0		       push    3Fh
.text:004043C2		       pop     eax
.text:004043C3
.text:004043C3 loc_4043C3:			       ; CODE XREF: ___sbh_heap_check+D6j
.text:004043C3		       lea     eax, [ebp+eax*4+cntFree]
.text:004043CA		       inc     dword ptr [eax]
.text:004043CC
.text:004043CC loc_4043CC:			       ; CODE XREF: ___sbh_heap_check+CBj
.text:004043CC		       cmp     ecx, 10h
.text:004043CF		       jl      loc_40459D
.text:004043D5		       test    cl, 0Fh
.text:004043D8		       jnz     loc_40459D
.text:004043DE		       cmp     ecx, 0FF0h
.text:004043E4		       jg      loc_40459D
.text:004043EA		       lea     eax, [ecx+esi]
.text:004043ED		       cmp     [eax-4],	edi
.text:004043F0		       jnz     loc_404599
.text:004043F6		       mov     esi, eax
.text:004043F8		       cmp     esi, edx
.text:004043FA		       jb      short loc_40439A
.text:004043FC		       jnz     loc_404599
.text:00404402		       add     edx, 1000h
.text:00404408		       inc     ebx
.text:00404409		       cmp     ebx, 8
.text:0040440C		       jl      loc_40437E
.text:00404412		       mov     eax, [ebp+cntAllocated]
.text:00404415		       mov     edi, [ebp+pGroup]
.text:00404418		       cmp     [edi], eax
.text:0040441A		       jnz     loc_4045A5
.text:00404420		       xor     esi, esi
.text:00404422
.text:00404422 loc_404422:			       ; CODE XREF: ___sbh_heap_check+22Ej
.text:00404422		       and     [ebp+cntAllocated], 0
.text:00404426		       lea     ebx, [edi+8]
.text:00404429		       mov     eax, [ebx-4]
.text:0040442C		       cmp     eax, edi
.text:0040442E		       mov     [ebp+pEntry], edi
.text:00404431		       mov     [ebp+var_30], ebx
.text:00404434		       jz      loc_4044EC
.text:0040443A
.text:0040443A loc_40443A:			       ; CODE XREF: ___sbh_heap_check+1D7j
.text:0040443A		       mov     ecx, [ebp+cntAllocated]
.text:0040443D		       cmp     ecx, [ebp+esi*4+cntFree]
.text:00404444		       jz      short loc_4044C5
.text:00404446		       mov     ecx, [ebp+pHeapGroup]
.text:00404449		       cmp     eax, ecx
.text:0040444B		       jb      loc_4045B5
.text:00404451		       add     ecx, 8000h
.text:00404457		       cmp     eax, ecx
.text:00404459		       jnb     loc_4045B5
.text:0040445F		       mov     ecx, eax
.text:00404461		       and     ecx, 0FFFFF000h
.text:00404467		       add     ecx, 0Ch
.text:0040446A		       lea     edx, [ecx+0FF0h]
.text:00404470		       cmp     ecx, edx
.text:00404472		       jz      loc_4045A9
.text:00404478
.text:00404478 loc_404478:			       ; CODE XREF: ___sbh_heap_check+1A0j
.text:00404478		       cmp     ecx, eax
.text:0040447A		       jz      short loc_40448A
.text:0040447C		       mov     ebx, [ecx]
.text:0040447E		       and     ebx, 0FFFFFFFEh
.text:00404481		       add     ecx, ebx
.text:00404483		       cmp     ecx, edx
.text:00404485		       mov     ebx, [ebp+var_30]
.text:00404488		       jnz     short loc_404478
.text:0040448A
.text:0040448A loc_40448A:			       ; CODE XREF: ___sbh_heap_check+192j
.text:0040448A		       cmp     ecx, edx
.text:0040448C		       jz      loc_4045A9
.text:00404492		       mov     ecx, [eax]
.text:00404494		       sar     ecx, 4
.text:00404497		       dec     ecx
.text:00404498		       cmp     ecx, 3Fh
.text:0040449B		       jle     short loc_4044A0
.text:0040449D		       push    3Fh
.text:0040449F		       pop     ecx
.text:004044A0
.text:004044A0 loc_4044A0:			       ; CODE XREF: ___sbh_heap_check+1B3j
.text:004044A0		       cmp     ecx, esi
.text:004044A2		       jnz     loc_4045AD
.text:004044A8		       mov     ecx, [ebp+pEntry]
.text:004044AB		       cmp     [eax+8],	ecx
.text:004044AE		       jnz     loc_4045B1
.text:004044B4		       inc     [ebp+cntAllocated]
.text:004044B7		       mov     [ebp+pEntry], eax
.text:004044BA		       mov     eax, [eax+4]
.text:004044BD		       cmp     eax, edi
.text:004044BF		       jnz     loc_40443A
.text:004044C5
.text:004044C5 loc_4044C5:			       ; CODE XREF: ___sbh_heap_check+15Cj
.text:004044C5		       cmp     [ebp+cntAllocated], 0
.text:004044C9		       jz      short loc_4044EC
.text:004044CB		       cmp     esi, 20h
.text:004044CE		       mov     eax, 80000000h
.text:004044D3		       jge     short loc_4044E1
.text:004044D5		       mov     ecx, esi
.text:004044D7		       shr     eax, cl
.text:004044D9		       or      [ebp+bitvGroupHi], eax
.text:004044DC		       or      [ebp+bitvEntryHi], eax
.text:004044DF		       jmp     short loc_4044EC
.text:004044E1 ; ---------------------------------------------------------------------------
.text:004044E1
.text:004044E1 loc_4044E1:			       ; CODE XREF: ___sbh_heap_check+1EBj
.text:004044E1		       lea     ecx, [esi-20h]
.text:004044E4		       shr     eax, cl
.text:004044E6		       or      [ebp+bitvGroupLo], eax
.text:004044E9		       or      [ebp+bitvEntryLo], eax
.text:004044EC
.text:004044EC loc_4044EC:			       ; CODE XREF: ___sbh_heap_check+14Cj
.text:004044EC					       ; ___sbh_heap_check+1E1j ...
.text:004044EC		       mov     eax, [ebp+pEntry]
.text:004044EF		       cmp     [eax+4],	edi
.text:004044F2		       jnz     loc_4045BD
.text:004044F8		       mov     ecx, [ebp+cntAllocated]
.text:004044FB		       cmp     ecx, [ebp+esi*4+cntFree]
.text:00404502		       jnz     loc_4045BD
.text:00404508		       cmp     [ebx], eax
.text:0040450A		       jnz     loc_4045B9
.text:00404510		       inc     esi
.text:00404511		       cmp     esi, 40h
.text:00404514		       mov     edi, ebx
.text:00404516		       jl      loc_404422
.text:0040451C		       mov     esi, [ebp+var_38]
.text:0040451F		       mov     edx, [ebp+pHeader]
.text:00404522		       xor     ebx, ebx
.text:00404524
.text:00404524 loc_404524:			       ; CODE XREF: ___sbh_heap_check+7Ej
.text:00404524		       mov     eax, [ebp+bitvGroupHi]
.text:00404527		       cmp     eax, [esi-80h]
.text:0040452A		       jnz     loc_4045C1
.text:00404530		       mov     eax, [ebp+bitvGroupLo]
.text:00404533		       cmp     eax, [esi]
.text:00404535		       jnz     loc_4045C1
.text:0040453B		       add     [ebp+pHeapGroup], 8000h
.text:00404542		       add     [ebp+pGroup], 204h
.text:00404549		       shl     [ebp+bitvCommit], 1
.text:0040454C		       inc     [ebp+indGroup]
.text:0040454F		       add     esi, 4
.text:00404552		       cmp     [ebp+indGroup], 20h
.text:00404556		       mov     [ebp+var_38], esi
.text:00404559		       jl      loc_40434D
.text:0040455F		       mov     eax, [ebp+bitvEntryHi]
.text:00404562		       cmp     eax, [edx]
.text:00404564		       jnz     short loc_4045C5
.text:00404566		       mov     eax, [ebp+bitvEntryLo]
.text:00404569		       cmp     eax, [edx+4]
.text:0040456C		       jnz     short loc_4045C5
.text:0040456E		       add     edx, 14h
.text:00404571		       inc     [ebp+indHeader]
.text:00404574		       mov     eax, [ebp+indHeader]
.text:00404577		       cmp     eax, ___sbh_cntHeaderList
.text:0040457D		       mov     [ebp+pHeader], edx
.text:00404580		       jl      loc_40431B
.text:00404586
.text:00404586 loc_404586:			       ; CODE XREF: ___sbh_heap_check+2Dj
.text:00404586		       xor     eax, eax
.text:00404588
.text:00404588 loc_404588:			       ; CODE XREF: ___sbh_heap_check+2E0j
.text:00404588		       pop     edi
.text:00404589		       pop     esi
.text:0040458A
.text:0040458A loc_40458A:			       ; CODE XREF: ___sbh_heap_check+18j
.text:0040458A		       pop     ebx
.text:0040458B		       leave
.text:0040458C		       retn
.text:0040458D ; ---------------------------------------------------------------------------
.text:0040458D
.text:0040458D loc_40458D:			       ; CODE XREF: ___sbh_heap_check+38j
.text:0040458D		       push    0FFFFFFFEh
.text:0040458F		       jmp     short loc_4045C7
.text:00404591 ; ---------------------------------------------------------------------------
.text:00404591
.text:00404591 loc_404591:			       ; CODE XREF: ___sbh_heap_check+87j
.text:00404591		       push    0FFFFFFFCh
.text:00404593		       jmp     short loc_4045C7
.text:00404595 ; ---------------------------------------------------------------------------
.text:00404595
.text:00404595 loc_404595:			       ; CODE XREF: ___sbh_heap_check+C2j
.text:00404595		       push    0FFFFFFFAh
.text:00404597		       jmp     short loc_4045C7
.text:00404599 ; ---------------------------------------------------------------------------
.text:00404599
.text:00404599 loc_404599:			       ; CODE XREF: ___sbh_heap_check+108j
.text:00404599					       ; ___sbh_heap_check+114j
.text:00404599		       push    0FFFFFFF8h
.text:0040459B		       jmp     short loc_4045C7
.text:0040459D ; ---------------------------------------------------------------------------
.text:0040459D
.text:0040459D loc_40459D:			       ; CODE XREF: ___sbh_heap_check+E7j
.text:0040459D					       ; ___sbh_heap_check+F0j	...
.text:0040459D		       push    0FFFFFFF9h
.text:0040459F		       jmp     short loc_4045C7
.text:004045A1 ; ---------------------------------------------------------------------------
.text:004045A1
.text:004045A1 loc_4045A1:			       ; CODE XREF: ___sbh_heap_check+A3j
.text:004045A1					       ; ___sbh_heap_check+ACj
.text:004045A1		       push    0FFFFFFFBh
.text:004045A3		       jmp     short loc_4045C7
.text:004045A5 ; ---------------------------------------------------------------------------
.text:004045A5
.text:004045A5 loc_4045A5:			       ; CODE XREF: ___sbh_heap_check+132j
.text:004045A5		       push    0FFFFFFF7h
.text:004045A7		       jmp     short loc_4045C7
.text:004045A9 ; ---------------------------------------------------------------------------
.text:004045A9
.text:004045A9 loc_4045A9:			       ; CODE XREF: ___sbh_heap_check+18Aj
.text:004045A9					       ; ___sbh_heap_check+1A4j
.text:004045A9		       push    0FFFFFFF5h
.text:004045AB		       jmp     short loc_4045C7
.text:004045AD ; ---------------------------------------------------------------------------
.text:004045AD
.text:004045AD loc_4045AD:			       ; CODE XREF: ___sbh_heap_check+1BAj
.text:004045AD		       push    0FFFFFFF4h
.text:004045AF		       jmp     short loc_4045C7
.text:004045B1 ; ---------------------------------------------------------------------------
.text:004045B1
.text:004045B1 loc_4045B1:			       ; CODE XREF: ___sbh_heap_check+1C6j
.text:004045B1		       push    0FFFFFFF3h
.text:004045B3		       jmp     short loc_4045C7
.text:004045B5 ; ---------------------------------------------------------------------------
.text:004045B5
.text:004045B5 loc_4045B5:			       ; CODE XREF: ___sbh_heap_check+163j
.text:004045B5					       ; ___sbh_heap_check+171j
.text:004045B5		       push    0FFFFFFF6h
.text:004045B7		       jmp     short loc_4045C7
.text:004045B9 ; ---------------------------------------------------------------------------
.text:004045B9
.text:004045B9 loc_4045B9:			       ; CODE XREF: ___sbh_heap_check+222j
.text:004045B9		       push    0FFFFFFF1h
.text:004045BB		       jmp     short loc_4045C7
.text:004045BD ; ---------------------------------------------------------------------------
.text:004045BD
.text:004045BD loc_4045BD:			       ; CODE XREF: ___sbh_heap_check+20Aj
.text:004045BD					       ; ___sbh_heap_check+21Aj
.text:004045BD		       push    0FFFFFFF2h
.text:004045BF		       jmp     short loc_4045C7
.text:004045C1 ; ---------------------------------------------------------------------------
.text:004045C1
.text:004045C1 loc_4045C1:			       ; CODE XREF: ___sbh_heap_check+242j
.text:004045C1					       ; ___sbh_heap_check+24Dj
.text:004045C1		       push    0FFFFFFF0h
.text:004045C3		       jmp     short loc_4045C7
.text:004045C5 ; ---------------------------------------------------------------------------
.text:004045C5
.text:004045C5 loc_4045C5:			       ; CODE XREF: ___sbh_heap_check+27Cj
.text:004045C5					       ; ___sbh_heap_check+284j
.text:004045C5		       push    0FFFFFFEFh
.text:004045C7
.text:004045C7 loc_4045C7:			       ; CODE XREF: ___sbh_heap_check+2A7j
.text:004045C7					       ; ___sbh_heap_check+2ABj ...
.text:004045C7		       pop     eax
.text:004045C8		       jmp     short loc_404588
.text:004045C8 ___sbh_heap_check endp
.text:004045C8
.text:004045CA
.text:004045CA ; =============== S U B R O U T I N E =======================================
.text:004045CA
.text:004045CA
.text:004045CA ; int __cdecl _set_sbh_threshold(unsigned int threshold)
.text:004045CA __set_sbh_threshold proc	near
.text:004045CA
.text:004045CA threshold       = dword ptr  4
.text:004045CA
.text:004045CA		       push    esi
.text:004045CB		       xor     esi, esi
.text:004045CD		       cmp     __crtheap, esi
.text:004045D3		       jnz     short loc_4045D9
.text:004045D5
.text:004045D5 loc_4045D5:			       ; CODE XREF: __set_sbh_threshold+3Cj
.text:004045D5		       xor     eax, eax
.text:004045D7		       pop     esi
.text:004045D8		       retn
.text:004045D9 ; ---------------------------------------------------------------------------
.text:004045D9
.text:004045D9 loc_4045D9:			       ; CODE XREF: __set_sbh_threshold+9j
.text:004045D9		       mov     eax, ___active_heap
.text:004045DE		       cmp     eax, 3
.text:004045E1		       jnz     short loc_404612
.text:004045E3		       mov     eax, [esp+4+threshold]
.text:004045E7		       cmp     eax, 3F8h
.text:004045EC		       jbe     short loc_404608
.text:004045EE		       call    __errno
.text:004045F3		       push    esi	       ; pReserved
.text:004045F4		       push    esi	       ; nLine
.text:004045F5		       push    esi	       ; pszFile
.text:004045F6		       push    esi	       ; pszFunction
.text:004045F7		       push    esi	       ; pszExpression
.text:004045F8		       mov     dword ptr [eax],	16h
.text:004045FE		       call    __invalid_parameter
.text:00404603		       add     esp, 14h
.text:00404606		       jmp     short loc_4045D5
.text:00404608 ; ---------------------------------------------------------------------------
.text:00404608
.text:00404608 loc_404608:			       ; CODE XREF: __set_sbh_threshold+22j
.text:00404608		       mov     ___sbh_threshold, eax
.text:0040460D		       xor     eax, eax
.text:0040460F		       inc     eax
.text:00404610		       pop     esi
.text:00404611		       retn
.text:00404612 ; ---------------------------------------------------------------------------
.text:00404612
.text:00404612 loc_404612:			       ; CODE XREF: __set_sbh_threshold+17j
.text:00404612		       push    edi
.text:00404613		       mov     edi, [esp+8+threshold]
.text:00404617		       cmp     edi, esi
.text:00404619		       jz      short loc_40465D
.text:0040461B		       cmp     eax, 1
.text:0040461E		       jnz     short loc_404662
.text:00404620		       cmp     edi, 3F8h
.text:00404626		       ja      short loc_404633
.text:00404628		       push    edi	       ; threshold
.text:00404629		       call    ___sbh_heap_init
.text:0040462E		       test    eax, eax
.text:00404630		       pop     ecx
.text:00404631		       jnz     short loc_40464D
.text:00404633
.text:00404633 loc_404633:			       ; CODE XREF: __set_sbh_threshold+5Cj
.text:00404633		       call    __errno
.text:00404638		       push    esi	       ; pReserved
.text:00404639		       push    esi	       ; nLine
.text:0040463A		       push    esi	       ; pszFile
.text:0040463B		       push    esi	       ; pszFunction
.text:0040463C		       push    esi	       ; pszExpression
.text:0040463D		       mov     dword ptr [eax],	16h
.text:00404643		       call    __invalid_parameter
.text:00404648		       add     esp, 14h
.text:0040464B		       jmp     short loc_40466D
.text:0040464D ; ---------------------------------------------------------------------------
.text:0040464D
.text:0040464D loc_40464D:			       ; CODE XREF: __set_sbh_threshold+67j
.text:0040464D		       mov     ___sbh_threshold, edi
.text:00404653		       mov     ___active_heap, 3
.text:0040465D
.text:0040465D loc_40465D:			       ; CODE XREF: __set_sbh_threshold+4Fj
.text:0040465D		       xor     eax, eax
.text:0040465F		       inc     eax
.text:00404660		       jmp     short loc_40466F
.text:00404662 ; ---------------------------------------------------------------------------
.text:00404662
.text:00404662 loc_404662:			       ; CODE XREF: __set_sbh_threshold+54j
.text:00404662		       call    __errno
.text:00404667		       mov     dword ptr [eax],	16h
.text:0040466D
.text:0040466D loc_40466D:			       ; CODE XREF: __set_sbh_threshold+81j
.text:0040466D		       xor     eax, eax
.text:0040466F
.text:0040466F loc_40466F:			       ; CODE XREF: __set_sbh_threshold+96j
.text:0040466F		       pop     edi
.text:00404670		       pop     esi
.text:00404671		       retn
.text:00404671 __set_sbh_threshold endp
.text:00404671
.text:00404672
.text:00404672 ; =============== S U B R O U T I N E =======================================
.text:00404672
.text:00404672 ; Attributes: bp-based frame
.text:00404672
.text:00404672 ; void *__cdecl __sbh_alloc_block(int intSize)
.text:00404672 ___sbh_alloc_block proc near	       ; CODE XREF: _V6_HeapAlloc+28p
.text:00404672					       ; __calloc_impl+88p ...
.text:00404672
.text:00404672 var_14	       = dword ptr -14h
.text:00404672 sizeEntry       = dword ptr -10h
.text:00404672 pGroup	       = dword ptr -0Ch
.text:00404672 sizeNewFree     = dword ptr -8
.text:00404672 indGroupUse     = dword ptr -4
.text:00404672 pHeader	       = dword ptr  8
.text:00404672
.text:00404672		       push    ebp
.text:00404673		       mov     ebp, esp
.text:00404675		       sub     esp, 14h
.text:00404678		       mov     eax, ___sbh_cntHeaderList
.text:0040467D		       mov     ecx, [ebp+pHeader]
.text:00404680		       imul    eax, 14h
.text:00404683		       add     eax, ___sbh_pHeaderList
.text:00404689		       add     ecx, 17h
.text:0040468C		       and     ecx, 0FFFFFFF0h
.text:0040468F		       mov     [ebp+sizeEntry],	ecx
.text:00404692		       sar     ecx, 4
.text:00404695		       push    ebx
.text:00404696		       dec     ecx
.text:00404697		       cmp     ecx, 20h
.text:0040469A		       push    esi
.text:0040469B		       push    edi
.text:0040469C		       jge     short loc_4046A9
.text:0040469E		       or      esi, 0FFFFFFFFh
.text:004046A1		       shr     esi, cl
.text:004046A3		       or      [ebp+sizeNewFree], 0FFFFFFFFh
.text:004046A7		       jmp     short loc_4046B6
.text:004046A9 ; ---------------------------------------------------------------------------
.text:004046A9
.text:004046A9 loc_4046A9:			       ; CODE XREF: ___sbh_alloc_block+2Aj
.text:004046A9		       add     ecx, 0FFFFFFE0h
.text:004046AC		       or      edx, 0FFFFFFFFh
.text:004046AF		       xor     esi, esi
.text:004046B1		       shr     edx, cl
.text:004046B3		       mov     [ebp+sizeNewFree], edx
.text:004046B6
.text:004046B6 loc_4046B6:			       ; CODE XREF: ___sbh_alloc_block+35j
.text:004046B6		       mov     ecx, ___sbh_pHeaderScan
.text:004046BC		       mov     ebx, ecx
.text:004046BE		       jmp     short loc_4046D1
.text:004046C0 ; ---------------------------------------------------------------------------
.text:004046C0
.text:004046C0 loc_4046C0:			       ; CODE XREF: ___sbh_alloc_block+64j
.text:004046C0		       mov     edx, [ebx+4]
.text:004046C3		       mov     edi, [ebx]
.text:004046C5		       and     edx, [ebp+sizeNewFree]
.text:004046C8		       and     edi, esi
.text:004046CA		       or      edx, edi
.text:004046CC		       jnz     short loc_4046D8
.text:004046CE		       add     ebx, 14h
.text:004046D1
.text:004046D1 loc_4046D1:			       ; CODE XREF: ___sbh_alloc_block+4Cj
.text:004046D1		       cmp     ebx, eax
.text:004046D3		       mov     [ebp+pHeader], ebx
.text:004046D6		       jb      short loc_4046C0
.text:004046D8
.text:004046D8 loc_4046D8:			       ; CODE XREF: ___sbh_alloc_block+5Aj
.text:004046D8		       cmp     ebx, eax
.text:004046DA		       jnz     short loc_40475B
.text:004046DC		       mov     ebx, ___sbh_pHeaderList
.text:004046E2		       jmp     short loc_4046F5
.text:004046E4 ; ---------------------------------------------------------------------------
.text:004046E4
.text:004046E4 loc_4046E4:			       ; CODE XREF: ___sbh_alloc_block+88j
.text:004046E4		       mov     edx, [ebx+4]
.text:004046E7		       mov     edi, [ebx]
.text:004046E9		       and     edx, [ebp+sizeNewFree]
.text:004046EC		       and     edi, esi
.text:004046EE		       or      edx, edi
.text:004046F0		       jnz     short loc_4046FC
.text:004046F2		       add     ebx, 14h
.text:004046F5
.text:004046F5 loc_4046F5:			       ; CODE XREF: ___sbh_alloc_block+70j
.text:004046F5		       cmp     ebx, ecx
.text:004046F7		       mov     [ebp+pHeader], ebx
.text:004046FA		       jb      short loc_4046E4
.text:004046FC
.text:004046FC loc_4046FC:			       ; CODE XREF: ___sbh_alloc_block+7Ej
.text:004046FC		       cmp     ebx, ecx
.text:004046FE		       jnz     short loc_40475B
.text:00404700		       jmp     short loc_40470E
.text:00404702 ; ---------------------------------------------------------------------------
.text:00404702
.text:00404702 loc_404702:			       ; CODE XREF: ___sbh_alloc_block+9Ej
.text:00404702		       cmp     dword ptr [ebx+8], 0
.text:00404706		       jnz     short loc_404712
.text:00404708		       add     ebx, 14h
.text:0040470B		       mov     [ebp+pHeader], ebx
.text:0040470E
.text:0040470E loc_40470E:			       ; CODE XREF: ___sbh_alloc_block+8Ej
.text:0040470E		       cmp     ebx, eax
.text:00404710		       jb      short loc_404702
.text:00404712
.text:00404712 loc_404712:			       ; CODE XREF: ___sbh_alloc_block+94j
.text:00404712		       cmp     ebx, eax
.text:00404714		       jnz     short loc_404747
.text:00404716		       mov     ebx, ___sbh_pHeaderList
.text:0040471C		       jmp     short loc_404727
.text:0040471E ; ---------------------------------------------------------------------------
.text:0040471E
.text:0040471E loc_40471E:			       ; CODE XREF: ___sbh_alloc_block+BAj
.text:0040471E		       cmp     dword ptr [ebx+8], 0
.text:00404722		       jnz     short loc_40472E
.text:00404724		       add     ebx, 14h
.text:00404727
.text:00404727 loc_404727:			       ; CODE XREF: ___sbh_alloc_block+AAj
.text:00404727		       cmp     ebx, ecx
.text:00404729		       mov     [ebp+pHeader], ebx
.text:0040472C		       jb      short loc_40471E
.text:0040472E
.text:0040472E loc_40472E:			       ; CODE XREF: ___sbh_alloc_block+B0j
.text:0040472E		       cmp     ebx, ecx
.text:00404730		       jnz     short loc_404747
.text:00404732		       call    ___sbh_alloc_new_region
.text:00404737		       mov     ebx, eax
.text:00404739		       test    ebx, ebx
.text:0040473B		       mov     [ebp+pHeader], ebx
.text:0040473E		       jnz     short loc_404747
.text:00404740
.text:00404740 loc_404740:			       ; CODE XREF: ___sbh_alloc_block+E7j
.text:00404740		       xor     eax, eax
.text:00404742		       jmp     loc_404950
.text:00404747 ; ---------------------------------------------------------------------------
.text:00404747
.text:00404747 loc_404747:			       ; CODE XREF: ___sbh_alloc_block+A2j
.text:00404747					       ; ___sbh_alloc_block+BEj ...
.text:00404747		       push    ebx	       ; pHeader
.text:00404748		       call    ___sbh_alloc_new_group
.text:0040474D		       pop     ecx
.text:0040474E		       mov     ecx, [ebx+10h]
.text:00404751		       mov     [ecx], eax
.text:00404753		       mov     eax, [ebx+10h]
.text:00404756		       cmp     dword ptr [eax],	0FFFFFFFFh
.text:00404759		       jz      short loc_404740
.text:0040475B
.text:0040475B loc_40475B:			       ; CODE XREF: ___sbh_alloc_block+68j
.text:0040475B					       ; ___sbh_alloc_block+8Cj
.text:0040475B		       mov     ___sbh_pHeaderScan, ebx
.text:00404761		       mov     eax, [ebx+10h]
.text:00404764		       mov     edx, [eax]
.text:00404766		       cmp     edx, 0FFFFFFFFh
.text:00404769		       mov     [ebp+indGroupUse], edx
.text:0040476C		       jz      short loc_404782
.text:0040476E		       mov     ecx, [eax+edx*4+0C4h]
.text:00404775		       mov     edi, [eax+edx*4+44h]
.text:00404779		       and     ecx, [ebp+sizeNewFree]
.text:0040477C		       and     edi, esi
.text:0040477E		       or      ecx, edi
.text:00404780		       jnz     short loc_4047AB
.text:00404782
.text:00404782 loc_404782:			       ; CODE XREF: ___sbh_alloc_block+FAj
.text:00404782		       and     [ebp+indGroupUse], 0
.text:00404786		       mov     edx, [eax+0C4h]
.text:0040478C		       lea     ecx, [eax+44h]
.text:0040478F
.text:0040478F loc_40478F:			       ; CODE XREF: ___sbh_alloc_block+134j
.text:0040478F		       mov     edi, [ecx]
.text:00404791		       and     edx, [ebp+sizeNewFree]
.text:00404794		       and     edi, esi
.text:00404796		       or      edx, edi
.text:00404798		       jnz     short loc_4047A8
.text:0040479A		       inc     [ebp+indGroupUse]
.text:0040479D		       mov     edx, [ecx+84h]
.text:004047A3		       add     ecx, 4
.text:004047A6		       jmp     short loc_40478F
.text:004047A8 ; ---------------------------------------------------------------------------
.text:004047A8
.text:004047A8 loc_4047A8:			       ; CODE XREF: ___sbh_alloc_block+126j
.text:004047A8		       mov     edx, [ebp+indGroupUse]
.text:004047AB
.text:004047AB loc_4047AB:			       ; CODE XREF: ___sbh_alloc_block+10Ej
.text:004047AB		       mov     ecx, edx
.text:004047AD		       imul    ecx, 204h
.text:004047B3		       lea     ecx, [ecx+eax+144h]
.text:004047BA		       mov     [ebp+pGroup], ecx
.text:004047BD		       mov     ecx, [eax+edx*4+44h]
.text:004047C1		       xor     edi, edi
.text:004047C3		       and     ecx, esi
.text:004047C5		       jnz     short loc_4047D9
.text:004047C7		       mov     ecx, [eax+edx*4+0C4h]
.text:004047CE		       and     ecx, [ebp+sizeNewFree]
.text:004047D1		       push    20h
.text:004047D3		       pop     edi
.text:004047D4		       jmp     short loc_4047D9
.text:004047D6 ; ---------------------------------------------------------------------------
.text:004047D6
.text:004047D6 loc_4047D6:			       ; CODE XREF: ___sbh_alloc_block+169j
.text:004047D6		       add     ecx, ecx
.text:004047D8		       inc     edi
.text:004047D9
.text:004047D9 loc_4047D9:			       ; CODE XREF: ___sbh_alloc_block+153j
.text:004047D9					       ; ___sbh_alloc_block+162j
.text:004047D9		       test    ecx, ecx
.text:004047DB		       jge     short loc_4047D6
.text:004047DD		       mov     ecx, [ebp+pGroup]
.text:004047E0		       mov     edx, [ecx+edi*8+4]
.text:004047E4		       mov     ecx, [edx]
.text:004047E6		       sub     ecx, [ebp+sizeEntry]
.text:004047E9		       mov     esi, ecx
.text:004047EB		       sar     esi, 4
.text:004047EE		       dec     esi
.text:004047EF		       cmp     esi, 3Fh
.text:004047F2		       mov     [ebp+sizeNewFree], ecx
.text:004047F5		       jle     short loc_4047FA
.text:004047F7		       push    3Fh
.text:004047F9		       pop     esi
.text:004047FA
.text:004047FA loc_4047FA:			       ; CODE XREF: ___sbh_alloc_block+183j
.text:004047FA		       cmp     esi, edi
.text:004047FC		       jz      loc_404903
.text:00404802		       mov     ecx, [edx+4]
.text:00404805		       cmp     ecx, [edx+8]
.text:00404808		       jnz     short loc_404866
.text:0040480A		       cmp     edi, 20h
.text:0040480D		       mov     ebx, 80000000h
.text:00404812		       jge     short loc_40483A
.text:00404814		       mov     ecx, edi
.text:00404816		       shr     ebx, cl
.text:00404818		       mov     ecx, [ebp+indGroupUse]
.text:0040481B		       lea     edi, [eax+edi+4]
.text:0040481F		       not     ebx
.text:00404821		       mov     [ebp+var_14], ebx
.text:00404824		       and     ebx, [eax+ecx*4+44h]
.text:00404828		       mov     [eax+ecx*4+44h],	ebx
.text:0040482C		       dec     byte ptr	[edi]
.text:0040482E		       jnz     short loc_404863
.text:00404830		       mov     ecx, [ebp+var_14]
.text:00404833		       mov     ebx, [ebp+pHeader]
.text:00404836		       and     [ebx], ecx
.text:00404838		       jmp     short loc_404866
.text:0040483A ; ---------------------------------------------------------------------------
.text:0040483A
.text:0040483A loc_40483A:			       ; CODE XREF: ___sbh_alloc_block+1A0j
.text:0040483A		       lea     ecx, [edi-20h]
.text:0040483D		       shr     ebx, cl
.text:0040483F		       mov     ecx, [ebp+indGroupUse]
.text:00404842		       lea     ecx, [eax+ecx*4+0C4h]
.text:00404849		       lea     edi, [eax+edi+4]
.text:0040484D		       not     ebx
.text:0040484F		       and     [ecx], ebx
.text:00404851		       dec     byte ptr	[edi]
.text:00404853		       mov     [ebp+var_14], ebx
.text:00404856		       jnz     short loc_404863
.text:00404858		       mov     ebx, [ebp+pHeader]
.text:0040485B		       mov     ecx, [ebp+var_14]
.text:0040485E		       and     [ebx+4],	ecx
.text:00404861		       jmp     short loc_404866
.text:00404863 ; ---------------------------------------------------------------------------
.text:00404863
.text:00404863 loc_404863:			       ; CODE XREF: ___sbh_alloc_block+1BCj
.text:00404863					       ; ___sbh_alloc_block+1E4j
.text:00404863		       mov     ebx, [ebp+pHeader]
.text:00404866
.text:00404866 loc_404866:			       ; CODE XREF: ___sbh_alloc_block+196j
.text:00404866					       ; ___sbh_alloc_block+1C6j ...
.text:00404866		       cmp     [ebp+sizeNewFree], 0
.text:0040486A		       mov     ecx, [edx+8]
.text:0040486D		       mov     edi, [edx+4]
.text:00404870		       mov     [ecx+4],	edi
.text:00404873		       mov     ecx, [edx+4]
.text:00404876		       mov     edi, [edx+8]
.text:00404879		       mov     [ecx+8],	edi
.text:0040487C		       jz      loc_40490F
.text:00404882		       mov     ecx, [ebp+pGroup]
.text:00404885		       lea     ecx, [ecx+esi*8]
.text:00404888		       mov     edi, [ecx+4]
.text:0040488B		       mov     [edx+8],	ecx
.text:0040488E		       mov     [edx+4],	edi
.text:00404891		       mov     [ecx+4],	edx
.text:00404894		       mov     ecx, [edx+4]
.text:00404897		       mov     [ecx+8],	edx
.text:0040489A		       mov     ecx, [edx+4]
.text:0040489D		       cmp     ecx, [edx+8]
.text:004048A0		       jnz     short loc_404900
.text:004048A2		       mov     cl, [esi+eax+4]
.text:004048A6		       mov     byte ptr	[ebp+pHeader+3], cl
.text:004048A9		       inc     cl
.text:004048AB		       cmp     esi, 20h
.text:004048AE		       mov     [esi+eax+4], cl
.text:004048B2		       jge     short loc_4048D7
.text:004048B4		       cmp     byte ptr	[ebp+pHeader+3], 0
.text:004048B8		       jnz     short loc_4048C5
.text:004048BA		       mov     edi, 80000000h
.text:004048BF		       mov     ecx, esi
.text:004048C1		       shr     edi, cl
.text:004048C3		       or      [ebx], edi
.text:004048C5
.text:004048C5 loc_4048C5:			       ; CODE XREF: ___sbh_alloc_block+246j
.text:004048C5		       mov     ecx, esi
.text:004048C7		       mov     edi, 80000000h
.text:004048CC		       shr     edi, cl
.text:004048CE		       mov     ecx, [ebp+indGroupUse]
.text:004048D1		       or      [eax+ecx*4+44h],	edi
.text:004048D5		       jmp     short loc_404900
.text:004048D7 ; ---------------------------------------------------------------------------
.text:004048D7
.text:004048D7 loc_4048D7:			       ; CODE XREF: ___sbh_alloc_block+240j
.text:004048D7		       cmp     byte ptr	[ebp+pHeader+3], 0
.text:004048DB		       jnz     short loc_4048EA
.text:004048DD		       lea     ecx, [esi-20h]
.text:004048E0		       mov     edi, 80000000h
.text:004048E5		       shr     edi, cl
.text:004048E7		       or      [ebx+4],	edi
.text:004048EA
.text:004048EA loc_4048EA:			       ; CODE XREF: ___sbh_alloc_block+269j
.text:004048EA		       mov     ecx, [ebp+indGroupUse]
.text:004048ED		       lea     edi, [eax+ecx*4+0C4h]
.text:004048F4		       lea     ecx, [esi-20h]
.text:004048F7		       mov     esi, 80000000h
.text:004048FC		       shr     esi, cl
.text:004048FE		       or      [edi], esi
.text:00404900
.text:00404900 loc_404900:			       ; CODE XREF: ___sbh_alloc_block+22Ej
.text:00404900					       ; ___sbh_alloc_block+263j
.text:00404900		       mov     ecx, [ebp+sizeNewFree]
.text:00404903
.text:00404903 loc_404903:			       ; CODE XREF: ___sbh_alloc_block+18Aj
.text:00404903		       test    ecx, ecx
.text:00404905		       jz      short loc_404912
.text:00404907		       mov     [edx], ecx
.text:00404909		       mov     [ecx+edx-4], ecx
.text:0040490D		       jmp     short loc_404912
.text:0040490F ; ---------------------------------------------------------------------------
.text:0040490F
.text:0040490F loc_40490F:			       ; CODE XREF: ___sbh_alloc_block+20Aj
.text:0040490F		       mov     ecx, [ebp+sizeNewFree]
.text:00404912
.text:00404912 loc_404912:			       ; CODE XREF: ___sbh_alloc_block+293j
.text:00404912					       ; ___sbh_alloc_block+29Bj
.text:00404912		       mov     esi, [ebp+sizeEntry]
.text:00404915		       add     edx, ecx
.text:00404917		       lea     ecx, [esi+1]
.text:0040491A		       mov     [edx], ecx
.text:0040491C		       mov     [edx+esi-4], ecx
.text:00404920		       mov     esi, [ebp+pGroup]
.text:00404923		       mov     ecx, [esi]
.text:00404925		       test    ecx, ecx
.text:00404927		       lea     edi, [ecx+1]
.text:0040492A		       mov     [esi], edi
.text:0040492C		       jnz     short loc_404948
.text:0040492E		       cmp     ebx, ___sbh_pHeaderDefer
.text:00404934		       jnz     short loc_404948
.text:00404936		       mov     ecx, [ebp+indGroupUse]
.text:00404939		       cmp     ecx, ___sbh_indGroupDefer
.text:0040493F		       jnz     short loc_404948
.text:00404941		       and     ___sbh_pHeaderDefer, 0
.text:00404948
.text:00404948 loc_404948:			       ; CODE XREF: ___sbh_alloc_block+2BAj
.text:00404948					       ; ___sbh_alloc_block+2C2j ...
.text:00404948		       mov     ecx, [ebp+indGroupUse]
.text:0040494B		       mov     [eax], ecx
.text:0040494D		       lea     eax, [edx+4]
.text:00404950
.text:00404950 loc_404950:			       ; CODE XREF: ___sbh_alloc_block+D0j
.text:00404950		       pop     edi
.text:00404951		       pop     esi
.text:00404952		       pop     ebx
.text:00404953		       leave
.text:00404954		       retn
.text:00404954 ___sbh_alloc_block endp
.text:00404954
.text:00404955
.text:00404955 ; =============== S U B R O U T I N E =======================================
.text:00404955
.text:00404955 ; Attributes: bp-based frame
.text:00404955
.text:00404955 ; int __cdecl use_encode_pointer()
.text:00404955 _use_encode_pointer proc	near	       ; CODE XREF: __encode_pointer+45p
.text:00404955					       ; __decode_pointer+45p ...
.text:00404955
.text:00404955 bEncode	       = dword ptr -8
.text:00404955 winmajor	       = dword ptr -4
.text:00404955
.text:00404955		       push    ebp
.text:00404956		       mov     ebp, esp
.text:00404958		       push    ecx
.text:00404959		       push    ecx
.text:0040495A		       push    ebx
.text:0040495B		       push    esi
.text:0040495C		       xor     esi, esi
.text:0040495E		       lea     eax, [ebp+winmajor]
.text:00404961		       inc     esi
.text:00404962		       xor     ebx, ebx
.text:00404964		       push    eax	       ; pValue
.text:00404965		       mov     [ebp+bEncode], esi
.text:00404968		       mov     [ebp+winmajor], ebx
.text:0040496B		       call    __get_winmajor
.text:00404970		       cmp     [ebp+winmajor], 5
.text:00404974		       pop     ecx
.text:00404975		       jle     short loc_40497B
.text:00404977		       mov     eax, esi
.text:00404979		       jmp     short loc_4049BD
.text:0040497B ; ---------------------------------------------------------------------------
.text:0040497B
.text:0040497B loc_40497B:			       ; CODE XREF: _use_encode_pointer+20j
.text:0040497B		       push    edi
.text:0040497C		       push    ebx	       ; lpModuleName
.text:0040497D		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00404983		       mov     esi, [eax+3Ch]
.text:00404986		       add     esi, eax
.text:00404988		       cmp     [esi+6],	bx
.text:0040498C		       movzx   eax, word ptr [esi+14h]
.text:00404990		       lea     edi, [eax+esi+18h]
.text:00404994		       jbe     short loc_4049B9
.text:00404996
.text:00404996 loc_404996:			       ; CODE XREF: _use_encode_pointer+5Cj
.text:00404996		       push    edi	       ; str2
.text:00404997		       push    offset str1     ; ".mixcrt"
.text:0040499C		       call    _strcmp
.text:004049A1		       test    eax, eax
.text:004049A3		       pop     ecx
.text:004049A4		       pop     ecx
.text:004049A5		       jz      short loc_4049B5
.text:004049A7		       movzx   eax, word ptr [esi+6]
.text:004049AB		       inc     ebx
.text:004049AC		       add     edi, 28h
.text:004049AF		       cmp     ebx, eax
.text:004049B1		       jb      short loc_404996
.text:004049B3		       jmp     short loc_4049B9
.text:004049B5 ; ---------------------------------------------------------------------------
.text:004049B5
.text:004049B5 loc_4049B5:			       ; CODE XREF: _use_encode_pointer+50j
.text:004049B5		       and     [ebp+bEncode], 0
.text:004049B9
.text:004049B9 loc_4049B9:			       ; CODE XREF: _use_encode_pointer+3Fj
.text:004049B9					       ; _use_encode_pointer+5Ej
.text:004049B9		       mov     eax, [ebp+bEncode]
.text:004049BC		       pop     edi
.text:004049BD
.text:004049BD loc_4049BD:			       ; CODE XREF: _use_encode_pointer+24j
.text:004049BD		       pop     esi
.text:004049BE		       pop     ebx
.text:004049BF		       leave
.text:004049C0		       retn
.text:004049C0 _use_encode_pointer endp
.text:004049C0
.text:004049C1
.text:004049C1 ; =============== S U B R O U T I N E =======================================
.text:004049C1
.text:004049C1
.text:004049C1 ; void *__cdecl _encode_pointer(void *ptr)
.text:004049C1 __encode_pointer	proc near	       ; CODE XREF: __init_pointers+3Dp
.text:004049C1					       ; __set_invalid_parameter_handler+12p ...
.text:004049C1
.text:004049C1 ptr	       = dword ptr  4
.text:004049C1
.text:004049C1		       push    esi
.text:004049C2		       push    ___getvalueindex	; dwTlsIndex
.text:004049C8		       mov     esi, ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:004049CE		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:004049D0		       test    eax, eax
.text:004049D2		       jz      short loc_4049F5
.text:004049D4		       mov     eax, ___flsindex
.text:004049D9		       cmp     eax, 0FFFFFFFFh
.text:004049DC		       jz      short loc_4049F5
.text:004049DE		       push    eax
.text:004049DF		       push    ___getvalueindex	; dwTlsIndex
.text:004049E5		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:004049E7		       call    eax
.text:004049E9		       test    eax, eax
.text:004049EB		       jz      short loc_4049F5
.text:004049ED		       mov     eax, [eax+1F8h]
.text:004049F3		       jmp     short loc_404A1B
.text:004049F5 ; ---------------------------------------------------------------------------
.text:004049F5
.text:004049F5 loc_4049F5:			       ; CODE XREF: __encode_pointer+11j
.text:004049F5					       ; __encode_pointer+1Bj ...
.text:004049F5		       push    offset aKernel32_dll_0 ;	"KERNEL32.DLL"
.text:004049FA		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00404A00		       mov     esi, eax
.text:00404A02		       test    esi, esi
.text:00404A04		       jz      short loc_404A29
.text:00404A06		       call    _use_encode_pointer
.text:00404A0B		       test    eax, eax
.text:00404A0D		       jz      short loc_404A29
.text:00404A0F		       push    offset aEncodepointer ; "EncodePointer"
.text:00404A14		       push    esi	       ; hModule
.text:00404A15		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00404A1B
.text:00404A1B loc_404A1B:			       ; CODE XREF: __encode_pointer+32j
.text:00404A1B		       test    eax, eax
.text:00404A1D		       jz      short loc_404A29
.text:00404A1F		       push    [esp+4+ptr]
.text:00404A23		       call    eax
.text:00404A25		       mov     [esp+4+ptr], eax
.text:00404A29
.text:00404A29 loc_404A29:			       ; CODE XREF: __encode_pointer+43j
.text:00404A29					       ; __encode_pointer+4Cj ...
.text:00404A29		       mov     eax, [esp+4+ptr]
.text:00404A2D		       pop     esi
.text:00404A2E		       retn
.text:00404A2E __encode_pointer	endp
.text:00404A2E
.text:00404A2F
.text:00404A2F ; =============== S U B R O U T I N E =======================================
.text:00404A2F
.text:00404A2F
.text:00404A2F ; void *__cdecl _encoded_null()
.text:00404A2F __encoded_null  proc near	       ; CODE XREF: doexit+6Ep
.text:00404A2F					       ; __init_pointers+1p ...
.text:00404A2F		       push    0	       ; ptr
.text:00404A31		       call    __encode_pointer
.text:00404A36		       pop     ecx
.text:00404A37		       retn
.text:00404A37 __encoded_null  endp
.text:00404A37
.text:00404A38
.text:00404A38 ; =============== S U B R O U T I N E =======================================
.text:00404A38
.text:00404A38
.text:00404A38 ; void *__cdecl _decode_pointer(void *codedptr)
.text:00404A38 __decode_pointer	proc near	       ; CODE XREF: __amsg_exit+14p
.text:00404A38					       ; doexit+3Dp ...
.text:00404A38
.text:00404A38 codedptr	       = dword ptr  4
.text:00404A38
.text:00404A38		       push    esi
.text:00404A39		       push    ___getvalueindex	; dwTlsIndex
.text:00404A3F		       mov     esi, ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:00404A45		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:00404A47		       test    eax, eax
.text:00404A49		       jz      short loc_404A6C
.text:00404A4B		       mov     eax, ___flsindex
.text:00404A50		       cmp     eax, 0FFFFFFFFh
.text:00404A53		       jz      short loc_404A6C
.text:00404A55		       push    eax
.text:00404A56		       push    ___getvalueindex	; dwTlsIndex
.text:00404A5C		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:00404A5E		       call    eax
.text:00404A60		       test    eax, eax
.text:00404A62		       jz      short loc_404A6C
.text:00404A64		       mov     eax, [eax+1FCh]
.text:00404A6A		       jmp     short loc_404A92
.text:00404A6C ; ---------------------------------------------------------------------------
.text:00404A6C
.text:00404A6C loc_404A6C:			       ; CODE XREF: __decode_pointer+11j
.text:00404A6C					       ; __decode_pointer+1Bj ...
.text:00404A6C		       push    offset aKernel32_dll_0 ;	"KERNEL32.DLL"
.text:00404A71		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00404A77		       mov     esi, eax
.text:00404A79		       test    esi, esi
.text:00404A7B		       jz      short loc_404AA0
.text:00404A7D		       call    _use_encode_pointer
.text:00404A82		       test    eax, eax
.text:00404A84		       jz      short loc_404AA0
.text:00404A86		       push    offset aDecodepointer ; "DecodePointer"
.text:00404A8B		       push    esi	       ; hModule
.text:00404A8C		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00404A92
.text:00404A92 loc_404A92:			       ; CODE XREF: __decode_pointer+32j
.text:00404A92		       test    eax, eax
.text:00404A94		       jz      short loc_404AA0
.text:00404A96		       push    [esp+4+codedptr]
.text:00404A9A		       call    eax
.text:00404A9C		       mov     [esp+4+codedptr], eax
.text:00404AA0
.text:00404AA0 loc_404AA0:			       ; CODE XREF: __decode_pointer+43j
.text:00404AA0					       ; __decode_pointer+4Cj ...
.text:00404AA0		       mov     eax, [esp+4+codedptr]
.text:00404AA4		       pop     esi
.text:00404AA5		       retn
.text:00404AA5 __decode_pointer	endp
.text:00404AA5
.text:00404AA6
.text:00404AA6 ; =============== S U B R O U T I N E =======================================
.text:00404AA6
.text:00404AA6
.text:00404AA6 ; unsigned int __stdcall	__crtTlsAlloc(void (__stdcall *lpCallBack)(void	*))
.text:00404AA6 ___crtTlsAlloc@4	proc near	       ; DATA XREF: __mtinit+8Ao
.text:00404AA6
.text:00404AA6 lpCallBack      = dword ptr  4
.text:00404AA6
.text:00404AA6		       call    ds:__imp__TlsAlloc@0 ; TlsAlloc()
.text:00404AAC		       retn    4
.text:00404AAC ___crtTlsAlloc@4	endp
.text:00404AAC
.text:00404AAF
.text:00404AAF ; =============== S U B R O U T I N E =======================================
.text:00404AAF
.text:00404AAF
.text:00404AAF ; void *__stdcall __fls_getvalue(unsigned int dwFlsIndex)
.text:00404AAF ___fls_getvalue@4 proc near
.text:00404AAF
.text:00404AAF dwFlsIndex      = dword ptr  4
.text:00404AAF
.text:00404AAF		       push    [esp+dwFlsIndex]
.text:00404AB3		       push    ___getvalueindex	; dwTlsIndex
.text:00404AB9		       call    ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:00404ABF		       call    eax
.text:00404AC1		       retn    4
.text:00404AC1 ___fls_getvalue@4 endp
.text:00404AC1
.text:00404AC4
.text:00404AC4 ; =============== S U B R O U T I N E =======================================
.text:00404AC4
.text:00404AC4
.text:00404AC4 ; unsigned int __cdecl __get_flsindex()
.text:00404AC4 ___get_flsindex proc near
.text:00404AC4		       mov     eax, ___flsindex
.text:00404AC9		       retn
.text:00404AC9 ___get_flsindex endp
.text:00404AC9
.text:00404ACA
.text:00404ACA ; =============== S U B R O U T I N E =======================================
.text:00404ACA
.text:00404ACA
.text:00404ACA ; void *(__stdcall *__cdecl __set_flsgetvalue())(unsigned int)
.text:00404ACA ___set_flsgetvalue proc near	       ; CODE XREF: __getptd_noexit+10p
.text:00404ACA		       push    esi
.text:00404ACB		       push    ___getvalueindex	; dwTlsIndex
.text:00404AD1		       call    ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:00404AD7		       mov     esi, eax
.text:00404AD9		       test    esi, esi
.text:00404ADB		       jnz     short loc_404AF8
.text:00404ADD		       push    _gpFlsGetValue  ; codedptr
.text:00404AE3		       call    __decode_pointer
.text:00404AE8		       pop     ecx
.text:00404AE9		       mov     esi, eax
.text:00404AEB		       push    esi	       ; lpTlsValue
.text:00404AEC		       push    ___getvalueindex	; dwTlsIndex
.text:00404AF2		       call    ds:__imp__TlsSetValue@8 ; TlsSetValue(x,x)
.text:00404AF8
.text:00404AF8 loc_404AF8:			       ; CODE XREF: ___set_flsgetvalue+11j
.text:00404AF8		       mov     eax, esi
.text:00404AFA		       pop     esi
.text:00404AFB		       retn
.text:00404AFB ___set_flsgetvalue endp
.text:00404AFB
.text:00404AFC
.text:00404AFC ; =============== S U B R O U T I N E =======================================
.text:00404AFC
.text:00404AFC
.text:00404AFC ; int __stdcall __fls_setvalue(unsigned int dwFlsIndex, void *lpFlsData)
.text:00404AFC ___fls_setvalue@8 proc near
.text:00404AFC
.text:00404AFC dwFlsIndex      = dword ptr  4
.text:00404AFC lpFlsData       = dword ptr  8
.text:00404AFC
.text:00404AFC		       push    [esp+lpFlsData]
.text:00404B00		       push    [esp+4+dwFlsIndex]
.text:00404B04		       push    _gpFlsSetValue  ; codedptr
.text:00404B0A		       call    __decode_pointer
.text:00404B0F		       pop     ecx
.text:00404B10		       call    eax
.text:00404B12		       retn    8
.text:00404B12 ___fls_setvalue@8 endp
.text:00404B12
.text:00404B15
.text:00404B15 ; =============== S U B R O U T I N E =======================================
.text:00404B15
.text:00404B15
.text:00404B15 __mtterm	       proc near	       ; CODE XREF: __mtinit+12p
.text:00404B15					       ; __mtinit:loc_404FB0p
.text:00404B15		       mov     eax, ___flsindex
.text:00404B1A		       cmp     eax, 0FFFFFFFFh
.text:00404B1D		       jz      short loc_404B35
.text:00404B1F		       push    eax
.text:00404B20		       push    _gpFlsFree      ; codedptr
.text:00404B26		       call    __decode_pointer
.text:00404B2B		       pop     ecx
.text:00404B2C		       call    eax
.text:00404B2E		       or      ___flsindex, 0FFFFFFFFh
.text:00404B35
.text:00404B35 loc_404B35:			       ; CODE XREF: __mtterm+8j
.text:00404B35		       mov     eax, ___getvalueindex
.text:00404B3A		       cmp     eax, 0FFFFFFFFh
.text:00404B3D		       jz      short loc_404B4D
.text:00404B3F		       push    eax	       ; dwTlsIndex
.text:00404B40		       call    ds:__imp__TlsFree@4 ; TlsFree(x)
.text:00404B46		       or      ___getvalueindex, 0FFFFFFFFh
.text:00404B4D
.text:00404B4D loc_404B4D:			       ; CODE XREF: __mtterm+28j
.text:00404B4D		       jmp     __mtdeletelocks
.text:00404B4D __mtterm	       endp
.text:00404B4D
.text:00404B52
.text:00404B52 ; =============== S U B R O U T I N E =======================================
.text:00404B52
.text:00404B52 ; Attributes: noreturn bp-based frame
.text:00404B52
.text:00404B52 ; void __cdecl _initptd(_tiddata	*ptd, threadlocaleinfostruct *ptloci)
.text:00404B52 __initptd       proc near	       ; CODE XREF: __getptd_noexit+4Dp
.text:00404B52					       ; __mtinit+162p
.text:00404B52
.text:00404B52 hKernel32       = dword ptr -1Ch
.text:00404B52 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00404B52 ptd	       = dword ptr  8
.text:00404B52 ptloci	       = dword ptr  0Ch
.text:00404B52
.text:00404B52		       push    0Ch
.text:00404B54		       push    offset dword_421550
.text:00404B59		       call    __SEH_prolog4
.text:00404B5E		       push    offset aKernel32_dll_0 ;	"KERNEL32.DLL"
.text:00404B63		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00404B69		       mov     [ebp+hKernel32],	eax
.text:00404B6C		       mov     esi, [ebp+ptd]
.text:00404B6F		       mov     dword ptr [esi+5Ch], offset __XcptActTab
.text:00404B76		       xor     edi, edi
.text:00404B78		       inc     edi
.text:00404B79		       mov     [esi+14h], edi
.text:00404B7C		       test    eax, eax
.text:00404B7E		       jz      short loc_404BAF
.text:00404B80		       call    _use_encode_pointer
.text:00404B85		       test    eax, eax
.text:00404B87		       jz      short loc_404BAF
.text:00404B89		       push    offset aEncodepointer ; "EncodePointer"
.text:00404B8E		       push    [ebp+hKernel32] ; hModule
.text:00404B91		       mov     ebx, ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00404B97		       call    ebx ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:00404B99		       mov     [esi+1F8h], eax
.text:00404B9F		       push    offset aDecodepointer ; "DecodePointer"
.text:00404BA4		       push    [ebp+hKernel32] ; hModule
.text:00404BA7		       call    ebx ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:00404BA9		       mov     [esi+1FCh], eax
.text:00404BAF
.text:00404BAF loc_404BAF:			       ; CODE XREF: __initptd+2Cj
.text:00404BAF					       ; __initptd+35j
.text:00404BAF		       mov     [esi+70h], edi
.text:00404BB2		       mov     byte ptr	[esi+0C8h], 43h
.text:00404BB9		       mov     byte ptr	[esi+14Bh], 43h
.text:00404BC0		       mov     eax, offset ___initialmbcinfo
.text:00404BC5		       mov     [esi+68h], eax
.text:00404BC8		       push    eax	       ; lpAddend
.text:00404BC9		       call    ds:__imp__InterlockedIncrement@4	; InterlockedIncrement(x)
.text:00404BCF		       push    0Ch	       ; locknum
.text:00404BD1		       call    __lock
.text:00404BD6		       pop     ecx
.text:00404BD7		       and     [ebp+ms_exc.disabled], 0
.text:00404BDB		       mov     eax, [ebp+ptloci]
.text:00404BDE		       mov     [esi+6Ch], eax
.text:00404BE1		       test    eax, eax
.text:00404BE3		       jnz     short loc_404BED
.text:00404BE5		       mov     eax, ___ptlocinfo ; ___ptlocinfo
.text:00404BEA		       mov     [esi+6Ch], eax
.text:00404BED
.text:00404BED loc_404BED:			       ; CODE XREF: __initptd+91j
.text:00404BED		       push    dword ptr [esi+6Ch] ; ptloci
.text:00404BF0		       call    ___addlocaleref
.text:00404BF5		       pop     ecx
.text:00404BF6		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404BFD		       call    $LN8_0
.text:00404C02 ; ---------------------------------------------------------------------------
.text:00404C02
.text:00404C02 $LN11:
.text:00404C02		       call    __SEH_epilog4
.text:00404C07		       retn
.text:00404C08 ; ---------------------------------------------------------------------------
.text:00404C08
.text:00404C08 $LN8_0:				       ; CODE XREF: __initptd+ABp
.text:00404C08					       ; DATA XREF: .rdata:00421568o
.text:00404C08		       push    0Ch	       ; locknum
.text:00404C0A		       call    __unlock
.text:00404C0F		       pop     ecx
.text:00404C10
.text:00404C10 $LN9_2:
.text:00404C10		       retn
.text:00404C10 __initptd       endp
.text:00404C10
.text:00404C11
.text:00404C11 ; =============== S U B R O U T I N E =======================================
.text:00404C11
.text:00404C11
.text:00404C11 ; _tiddata *__cdecl _getptd_noexit()
.text:00404C11 __getptd_noexit proc near	       ; CODE XREF: __errnop
.text:00404C11					       ; ___doserrnop ...
.text:00404C11		       push    esi
.text:00404C12		       push    edi
.text:00404C13		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00404C19		       push    ___flsindex
.text:00404C1F		       mov     edi, eax
.text:00404C21		       call    ___set_flsgetvalue
.text:00404C26		       call    eax
.text:00404C28		       mov     esi, eax
.text:00404C2A		       test    esi, esi
.text:00404C2C		       jnz     short loc_404C7C
.text:00404C2E		       push    214h	       ; size
.text:00404C33		       push    1	       ; count
.text:00404C35		       call    __calloc_crt
.text:00404C3A		       mov     esi, eax
.text:00404C3C		       test    esi, esi
.text:00404C3E		       pop     ecx
.text:00404C3F		       pop     ecx
.text:00404C40		       jz      short loc_404C7C
.text:00404C42		       push    esi
.text:00404C43		       push    ___flsindex
.text:00404C49		       push    _gpFlsSetValue  ; codedptr
.text:00404C4F		       call    __decode_pointer
.text:00404C54		       pop     ecx
.text:00404C55		       call    eax
.text:00404C57		       test    eax, eax
.text:00404C59		       jz      short loc_404C73
.text:00404C5B		       push    0	       ; ptloci
.text:00404C5D		       push    esi	       ; ptd
.text:00404C5E		       call    __initptd
.text:00404C63 ; ---------------------------------------------------------------------------
.text:00404C63		       pop     ecx
.text:00404C64		       pop     ecx
.text:00404C65		       call    ds:__imp__GetCurrentThreadId@0 ;	GetCurrentThreadId()
.text:00404C6B		       or      dword ptr [esi+4], 0FFFFFFFFh
.text:00404C6F		       mov     [esi], eax
.text:00404C71		       jmp     short loc_404C7C
.text:00404C73 ; ---------------------------------------------------------------------------
.text:00404C73
.text:00404C73 loc_404C73:			       ; CODE XREF: __getptd_noexit+48j
.text:00404C73		       push    esi	       ; pBlock
.text:00404C74		       call    _free
.text:00404C79		       pop     ecx
.text:00404C7A		       xor     esi, esi
.text:00404C7C
.text:00404C7C loc_404C7C:			       ; CODE XREF: __getptd_noexit+1Bj
.text:00404C7C					       ; __getptd_noexit+2Fj ...
.text:00404C7C		       push    edi	       ; dwErrCode
.text:00404C7D		       call    ds:__imp__SetLastError@4	; SetLastError(x)
.text:00404C83		       pop     edi
.text:00404C84		       mov     eax, esi
.text:00404C86		       pop     esi
.text:00404C87		       retn
.text:00404C87 __getptd_noexit endp
.text:00404C87
.text:00404C88
.text:00404C88 ; =============== S U B R O U T I N E =======================================
.text:00404C88
.text:00404C88
.text:00404C88 ; _tiddata *__cdecl _getptd()
.text:00404C88 __getptd	       proc near	       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+Fp
.text:00404C88					       ; terminate(void)+Cp ...
.text:00404C88		       push    esi
.text:00404C89		       call    __getptd_noexit
.text:00404C8E		       mov     esi, eax
.text:00404C90		       test    esi, esi
.text:00404C92		       jnz     short loc_404C9C
.text:00404C94		       push    10h	       ; rterrnum
.text:00404C96		       call    __amsg_exit
.text:00404C9B		       pop     ecx
.text:00404C9C
.text:00404C9C loc_404C9C:			       ; CODE XREF: __getptd+Aj
.text:00404C9C		       mov     eax, esi
.text:00404C9E		       pop     esi
.text:00404C9F		       retn
.text:00404C9F __getptd	       endp
.text:00404C9F
.text:00404CA0
.text:00404CA0 ; =============== S U B R O U T I N E =======================================
.text:00404CA0
.text:00404CA0 ; Attributes: bp-based frame
.text:00404CA0
.text:00404CA0 ; void __stdcall	_freefls(void *data)
.text:00404CA0 __freefls@4     proc near	       ; CODE XREF: __freeptd+4Fp
.text:00404CA0					       ; DATA XREF: __mtinit+115o
.text:00404CA0
.text:00404CA0 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00404CA0 data	       = dword ptr  8
.text:00404CA0
.text:00404CA0		       push    8
.text:00404CA2		       push    offset dword_421570
.text:00404CA7		       call    __SEH_prolog4
.text:00404CAC		       mov     esi, [ebp+data]
.text:00404CAF		       test    esi, esi
.text:00404CB1		       jz      loc_404DA1
.text:00404CB7		       mov     eax, [esi+24h]
.text:00404CBA		       test    eax, eax
.text:00404CBC		       jz      short loc_404CC5
.text:00404CBE		       push    eax	       ; pBlock
.text:00404CBF		       call    _free
.text:00404CC4		       pop     ecx
.text:00404CC5
.text:00404CC5 loc_404CC5:			       ; CODE XREF: _freefls(x)+1Cj
.text:00404CC5		       mov     eax, [esi+2Ch]
.text:00404CC8		       test    eax, eax
.text:00404CCA		       jz      short loc_404CD3
.text:00404CCC		       push    eax	       ; pBlock
.text:00404CCD		       call    _free
.text:00404CD2		       pop     ecx
.text:00404CD3
.text:00404CD3 loc_404CD3:			       ; CODE XREF: _freefls(x)+2Aj
.text:00404CD3		       mov     eax, [esi+34h]
.text:00404CD6		       test    eax, eax
.text:00404CD8		       jz      short loc_404CE1
.text:00404CDA		       push    eax	       ; pBlock
.text:00404CDB		       call    _free
.text:00404CE0		       pop     ecx
.text:00404CE1
.text:00404CE1 loc_404CE1:			       ; CODE XREF: _freefls(x)+38j
.text:00404CE1		       mov     eax, [esi+3Ch]
.text:00404CE4		       test    eax, eax
.text:00404CE6		       jz      short loc_404CEF
.text:00404CE8		       push    eax	       ; pBlock
.text:00404CE9		       call    _free
.text:00404CEE		       pop     ecx
.text:00404CEF
.text:00404CEF loc_404CEF:			       ; CODE XREF: _freefls(x)+46j
.text:00404CEF		       mov     eax, [esi+44h]
.text:00404CF2		       test    eax, eax
.text:00404CF4		       jz      short loc_404CFD
.text:00404CF6		       push    eax	       ; pBlock
.text:00404CF7		       call    _free
.text:00404CFC		       pop     ecx
.text:00404CFD
.text:00404CFD loc_404CFD:			       ; CODE XREF: _freefls(x)+54j
.text:00404CFD		       mov     eax, [esi+48h]
.text:00404D00		       test    eax, eax
.text:00404D02		       jz      short loc_404D0B
.text:00404D04		       push    eax	       ; pBlock
.text:00404D05		       call    _free
.text:00404D0A		       pop     ecx
.text:00404D0B
.text:00404D0B loc_404D0B:			       ; CODE XREF: _freefls(x)+62j
.text:00404D0B		       mov     eax, [esi+5Ch]
.text:00404D0E		       cmp     eax, offset __XcptActTab
.text:00404D13		       jz      short loc_404D1C
.text:00404D15		       push    eax	       ; pBlock
.text:00404D16		       call    _free
.text:00404D1B		       pop     ecx
.text:00404D1C
.text:00404D1C loc_404D1C:			       ; CODE XREF: _freefls(x)+73j
.text:00404D1C		       push    0Dh	       ; locknum
.text:00404D1E		       call    __lock
.text:00404D23		       pop     ecx
.text:00404D24		       and     [ebp+ms_exc.disabled], 0
.text:00404D28		       mov     edi, [esi+68h]
.text:00404D2B		       test    edi, edi
.text:00404D2D		       jz      short loc_404D49
.text:00404D2F		       push    edi	       ; lpAddend
.text:00404D30		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:00404D36		       test    eax, eax
.text:00404D38		       jnz     short loc_404D49
.text:00404D3A		       cmp     edi, offset ___initialmbcinfo
.text:00404D40		       jz      short loc_404D49
.text:00404D42		       push    edi	       ; pBlock
.text:00404D43		       call    _free
.text:00404D48		       pop     ecx
.text:00404D49
.text:00404D49 loc_404D49:			       ; CODE XREF: _freefls(x)+8Dj
.text:00404D49					       ; _freefls(x)+98j ...
.text:00404D49		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404D50		       call    $LN19_0
.text:00404D55
.text:00404D55 $LN20:				       ; locknum
.text:00404D55		       push    0Ch
.text:00404D57		       call    __lock
.text:00404D5C		       pop     ecx
.text:00404D5D		       mov     [ebp+ms_exc.disabled], 1
.text:00404D64		       mov     edi, [esi+6Ch]
.text:00404D67		       test    edi, edi
.text:00404D69		       jz      short loc_404D8E
.text:00404D6B		       push    edi	       ; ptloci
.text:00404D6C		       call    ___removelocaleref
.text:00404D71		       pop     ecx
.text:00404D72		       cmp     edi, ___ptlocinfo ; ___ptlocinfo
.text:00404D78		       jz      short loc_404D8E
.text:00404D7A		       cmp     edi, offset ___initiallocinfo
.text:00404D80		       jz      short loc_404D8E
.text:00404D82		       cmp     dword ptr [edi],	0
.text:00404D85		       jnz     short loc_404D8E
.text:00404D87		       push    edi	       ; ptloci
.text:00404D88		       call    ___freetlocinfo
.text:00404D8D		       pop     ecx
.text:00404D8E
.text:00404D8E loc_404D8E:			       ; CODE XREF: _freefls(x)+C9j
.text:00404D8E					       ; _freefls(x)+D8j ...
.text:00404D8E		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00404D95		       call    $LN23
.text:00404D9A
.text:00404D9A $LN24:				       ; pBlock
.text:00404D9A		       push    esi
.text:00404D9B		       call    _free
.text:00404DA0		       pop     ecx
.text:00404DA1
.text:00404DA1 loc_404DA1:			       ; CODE XREF: _freefls(x)+11j
.text:00404DA1		       call    __SEH_epilog4
.text:00404DA6		       retn    4
.text:00404DA9 ; ---------------------------------------------------------------------------
.text:00404DA9
.text:00404DA9 $LN17_1:				       ; DATA XREF: .rdata:00421588o
.text:00404DA9		       mov     esi, [ebp+data]
.text:00404DAC
.text:00404DAC $LN19_0:				       ; CODE XREF: _freefls(x)+B0p
.text:00404DAC		       push    0Dh	       ; locknum
.text:00404DAE		       call    __unlock
.text:00404DB3		       pop     ecx
.text:00404DB4
.text:00404DB4 $LN18:
.text:00404DB4		       retn
.text:00404DB5 ; ---------------------------------------------------------------------------
.text:00404DB5
.text:00404DB5 $LN21:				       ; DATA XREF: .rdata:00421594o
.text:00404DB5		       mov     esi, [ebp+data]
.text:00404DB8
.text:00404DB8 $LN23:				       ; CODE XREF: _freefls(x)+F5p
.text:00404DB8		       push    0Ch	       ; locknum
.text:00404DBA		       call    __unlock
.text:00404DBF		       pop     ecx
.text:00404DC0
.text:00404DC0 $LN22:
.text:00404DC0		       retn
.text:00404DC0 __freefls@4     endp ; sp-analysis failed
.text:00404DC0
.text:00404DC1
.text:00404DC1 ; =============== S U B R O U T I N E =======================================
.text:00404DC1
.text:00404DC1
.text:00404DC1 ; void __cdecl _freeptd(_tiddata	*ptd)
.text:00404DC1 __freeptd       proc near
.text:00404DC1
.text:00404DC1 ptd	       = dword ptr  4
.text:00404DC1
.text:00404DC1		       cmp     ___flsindex, 0FFFFFFFFh
.text:00404DC8		       jz      short loc_404E16
.text:00404DCA		       push    edi
.text:00404DCB		       mov     edi, [esp+4+ptd]
.text:00404DCF		       test    edi, edi
.text:00404DD1		       jnz     short loc_404DF9
.text:00404DD3		       push    esi
.text:00404DD4		       push    ___getvalueindex	; dwTlsIndex
.text:00404DDA		       mov     esi, ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:00404DE0		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:00404DE2		       test    eax, eax
.text:00404DE4		       jz      short loc_404DF8
.text:00404DE6		       push    ___flsindex
.text:00404DEC		       push    ___getvalueindex	; dwTlsIndex
.text:00404DF2		       call    esi ; TlsGetValue(x) ; TlsGetValue(x)
.text:00404DF4		       call    eax
.text:00404DF6		       mov     edi, eax
.text:00404DF8
.text:00404DF8 loc_404DF8:			       ; CODE XREF: __freeptd+23j
.text:00404DF8		       pop     esi
.text:00404DF9
.text:00404DF9 loc_404DF9:			       ; CODE XREF: __freeptd+10j
.text:00404DF9		       push    0
.text:00404DFB		       push    ___flsindex
.text:00404E01		       push    _gpFlsSetValue  ; codedptr
.text:00404E07		       call    __decode_pointer
.text:00404E0C		       pop     ecx
.text:00404E0D		       call    eax
.text:00404E0F		       push    edi	       ; data
.text:00404E10		       call    __freefls@4     ; _freefls(x)
.text:00404E15		       pop     edi
.text:00404E16
.text:00404E16 loc_404E16:			       ; CODE XREF: __freeptd+7j
.text:00404E16		       mov     eax, ___getvalueindex
.text:00404E1B		       cmp     eax, 0FFFFFFFFh
.text:00404E1E		       jz      short locret_404E29
.text:00404E20		       push    0	       ; lpTlsValue
.text:00404E22		       push    eax	       ; dwTlsIndex
.text:00404E23		       call    ds:__imp__TlsSetValue@8 ; TlsSetValue(x,x)
.text:00404E29
.text:00404E29 locret_404E29:			       ; CODE XREF: __freeptd+5Dj
.text:00404E29		       retn
.text:00404E29 __freeptd       endp
.text:00404E29
.text:00404E2A ; [00000006 BYTES: COLLAPSED FUNCTION ___threadid. PRESS	KEYPAD "+" TO EXPAND]
.text:00404E30 ; [00000006 BYTES: COLLAPSED FUNCTION ___threadhandle. PRESS KEYPAD "+" TO EXPAND]
.text:00404E36
.text:00404E36 ; =============== S U B R O U T I N E =======================================
.text:00404E36
.text:00404E36
.text:00404E36 ; int __cdecl _mtinit()
.text:00404E36 __mtinit	       proc near	       ; CODE XREF: __tmainCRTStartup:loc_4023CAp
.text:00404E36		       push    edi
.text:00404E37		       push    offset aKernel32_dll_0 ;	"KERNEL32.DLL"
.text:00404E3C		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00404E42		       mov     edi, eax
.text:00404E44		       test    edi, edi
.text:00404E46		       jnz     short loc_404E51
.text:00404E48		       call    __mtterm
.text:00404E4D		       xor     eax, eax
.text:00404E4F		       pop     edi
.text:00404E50		       retn
.text:00404E51 ; ---------------------------------------------------------------------------
.text:00404E51
.text:00404E51 loc_404E51:			       ; CODE XREF: __mtinit+10j
.text:00404E51		       push    esi
.text:00404E52		       mov     esi, ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00404E58		       push    offset aFlsalloc	; "FlsAlloc"
.text:00404E5D		       push    edi	       ; hModule
.text:00404E5E		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:00404E60		       push    offset aFlsgetvalue ; "FlsGetValue"
.text:00404E65		       push    edi	       ; hModule
.text:00404E66		       mov     _gpFlsAlloc, eax
.text:00404E6B		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:00404E6D		       push    offset aFlssetvalue ; "FlsSetValue"
.text:00404E72		       push    edi	       ; hModule
.text:00404E73		       mov     _gpFlsGetValue, eax
.text:00404E78		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:00404E7A		       push    offset aFlsfree ; "FlsFree"
.text:00404E7F		       push    edi	       ; hModule
.text:00404E80		       mov     _gpFlsSetValue, eax
.text:00404E85		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:00404E87		       cmp     _gpFlsAlloc, 0
.text:00404E8E		       mov     esi, ds:__imp__TlsSetValue@8 ; TlsSetValue(x,x)
.text:00404E94		       mov     _gpFlsFree, eax
.text:00404E99		       jz      short loc_404EB1
.text:00404E9B		       cmp     _gpFlsGetValue, 0
.text:00404EA2		       jz      short loc_404EB1
.text:00404EA4		       cmp     _gpFlsSetValue, 0
.text:00404EAB		       jz      short loc_404EB1
.text:00404EAD		       test    eax, eax
.text:00404EAF		       jnz     short loc_404ED5
.text:00404EB1
.text:00404EB1 loc_404EB1:			       ; CODE XREF: __mtinit+63j
.text:00404EB1					       ; __mtinit+6Cj ...
.text:00404EB1		       mov     eax, ds:__imp__TlsGetValue@4 ; TlsGetValue(x)
.text:00404EB6		       mov     _gpFlsGetValue, eax
.text:00404EBB		       mov     eax, ds:__imp__TlsFree@4	; TlsFree(x)
.text:00404EC0		       mov     _gpFlsAlloc, offset ___crtTlsAlloc@4 ; __crtTlsAlloc(x)
.text:00404ECA		       mov     _gpFlsSetValue, esi
.text:00404ED0		       mov     _gpFlsFree, eax
.text:00404ED5
.text:00404ED5 loc_404ED5:			       ; CODE XREF: __mtinit+79j
.text:00404ED5		       call    ds:__imp__TlsAlloc@0 ; TlsAlloc()
.text:00404EDB		       cmp     eax, 0FFFFFFFFh
.text:00404EDE		       mov     ___getvalueindex, eax
.text:00404EE3		       jz      loc_404FB5
.text:00404EE9		       push    _gpFlsGetValue  ; lpTlsValue
.text:00404EEF		       push    eax	       ; dwTlsIndex
.text:00404EF0		       call    esi ; TlsSetValue(x,x) ;	TlsSetValue(x,x)
.text:00404EF2		       test    eax, eax
.text:00404EF4		       jz      loc_404FB5
.text:00404EFA		       call    __init_pointers
.text:00404EFF		       push    _gpFlsAlloc     ; ptr
.text:00404F05		       call    __encode_pointer
.text:00404F0A		       push    _gpFlsGetValue  ; ptr
.text:00404F10		       mov     _gpFlsAlloc, eax
.text:00404F15		       call    __encode_pointer
.text:00404F1A		       push    _gpFlsSetValue  ; ptr
.text:00404F20		       mov     _gpFlsGetValue, eax
.text:00404F25		       call    __encode_pointer
.text:00404F2A		       push    _gpFlsFree      ; ptr
.text:00404F30		       mov     _gpFlsSetValue, eax
.text:00404F35		       call    __encode_pointer
.text:00404F3A		       add     esp, 10h
.text:00404F3D		       mov     _gpFlsFree, eax
.text:00404F42		       call    __mtinitlocks
.text:00404F47		       test    eax, eax
.text:00404F49		       jz      short loc_404FB0
.text:00404F4B		       push    offset __freefls@4 ; _freefls(x)
.text:00404F50		       push    _gpFlsAlloc     ; codedptr
.text:00404F56		       call    __decode_pointer
.text:00404F5B		       pop     ecx
.text:00404F5C		       call    eax
.text:00404F5E		       cmp     eax, 0FFFFFFFFh
.text:00404F61		       mov     ___flsindex, eax
.text:00404F66		       jz      short loc_404FB0
.text:00404F68		       push    214h	       ; size
.text:00404F6D		       push    1	       ; count
.text:00404F6F		       call    __calloc_crt
.text:00404F74		       mov     esi, eax
.text:00404F76		       test    esi, esi
.text:00404F78		       pop     ecx
.text:00404F79		       pop     ecx
.text:00404F7A		       jz      short loc_404FB0
.text:00404F7C		       push    esi
.text:00404F7D		       push    ___flsindex
.text:00404F83		       push    _gpFlsSetValue  ; codedptr
.text:00404F89		       call    __decode_pointer
.text:00404F8E		       pop     ecx
.text:00404F8F		       call    eax
.text:00404F91		       test    eax, eax
.text:00404F93		       jz      short loc_404FB0
.text:00404F95		       push    0	       ; ptloci
.text:00404F97		       push    esi	       ; ptd
.text:00404F98		       call    __initptd
.text:00404F9D ; ---------------------------------------------------------------------------
.text:00404F9D		       pop     ecx
.text:00404F9E		       pop     ecx
.text:00404F9F		       call    ds:__imp__GetCurrentThreadId@0 ;	GetCurrentThreadId()
.text:00404FA5		       or      dword ptr [esi+4], 0FFFFFFFFh
.text:00404FA9		       mov     [esi], eax
.text:00404FAB		       xor     eax, eax
.text:00404FAD		       inc     eax
.text:00404FAE		       jmp     short loc_404FB7
.text:00404FB0 ; ---------------------------------------------------------------------------
.text:00404FB0
.text:00404FB0 loc_404FB0:			       ; CODE XREF: __mtinit+113j
.text:00404FB0					       ; __mtinit+130j	...
.text:00404FB0		       call    __mtterm
.text:00404FB5
.text:00404FB5 loc_404FB5:			       ; CODE XREF: __mtinit+ADj
.text:00404FB5					       ; __mtinit+BEj
.text:00404FB5		       xor     eax, eax
.text:00404FB7
.text:00404FB7 loc_404FB7:			       ; CODE XREF: __mtinit+178j
.text:00404FB7		       pop     esi
.text:00404FB8		       pop     edi
.text:00404FB9		       retn
.text:00404FB9 __mtinit	       endp
.text:00404FB9
.text:00404FBA
.text:00404FBA ; =============== S U B R O U T I N E =======================================
.text:00404FBA
.text:00404FBA
.text:00404FBA ; void __cdecl _NMSG_WRITE(int rterrnum)
.text:00404FBA __NMSG_WRITE    proc near	       ; CODE XREF: __amsg_exit+9p
.text:00404FBA					       ; __heap_alloc+10p ...
.text:00404FBA
.text:00404FBA bytes_written   = dword ptr -8
.text:00404FBA NumberOfBytesWritten= dword ptr -4
.text:00404FBA rterrnum	       = dword ptr  4
.text:00404FBA
.text:00404FBA		       push    ecx
.text:00404FBB		       push    ebx
.text:00404FBC		       mov     ebx, [esp+8+rterrnum]
.text:00404FC0		       push    esi
.text:00404FC1		       push    edi
.text:00404FC2		       xor     esi, esi
.text:00404FC4		       xor     edi, edi
.text:00404FC6
.text:00404FC6 loc_404FC6:			       ; CODE XREF: __NMSG_WRITE+19j
.text:00404FC6		       cmp     ebx, rterrs.rterrno[edi*8]
.text:00404FCD		       jz      short loc_404FD5
.text:00404FCF		       inc     edi
.text:00404FD0		       cmp     edi, 17h
.text:00404FD3		       jb      short loc_404FC6
.text:00404FD5
.text:00404FD5 loc_404FD5:			       ; CODE XREF: __NMSG_WRITE+13j
.text:00404FD5		       cmp     edi, 17h
.text:00404FD8		       jnb     loc_405155
.text:00404FDE		       push    ebp
.text:00404FDF		       push    3	       ; em
.text:00404FE1		       call    __set_error_mode
.text:00404FE6		       cmp     eax, 1
.text:00404FE9		       pop     ecx
.text:00404FEA		       jz      loc_405121
.text:00404FF0		       push    3	       ; em
.text:00404FF2		       call    __set_error_mode
.text:00404FF7		       test    eax, eax
.text:00404FF9		       pop     ecx
.text:00404FFA		       jnz     short loc_405009
.text:00404FFC		       cmp     ___app_type, 1
.text:00405003		       jz      loc_405121
.text:00405009
.text:00405009 loc_405009:			       ; CODE XREF: __NMSG_WRITE+40j
.text:00405009		       cmp     ebx, 0FCh
.text:0040500F		       jz      loc_405154
.text:00405015		       push    offset _Src     ; "Runtime Error!\n\nProgram: "
.text:0040501A		       mov     ebx, 314h
.text:0040501F		       push    ebx	       ; _SizeInBytes
.text:00405020		       mov     ebp, offset outmsg
.text:00405025		       push    ebp	       ; _Dst
.text:00405026		       call    _strcpy_s
.text:0040502B		       add     esp, 0Ch
.text:0040502E		       test    eax, eax
.text:00405030		       jz      short loc_40503F
.text:00405032		       push    esi	       ; pReserved
.text:00405033		       push    esi	       ; nLine
.text:00405034		       push    esi	       ; pszFile
.text:00405035		       push    esi	       ; pszFunction
.text:00405036		       push    esi	       ; pszExpression
.text:00405037		       call    __invoke_watson
.text:0040503C		       add     esp, 14h
.text:0040503F
.text:0040503F loc_40503F:			       ; CODE XREF: __NMSG_WRITE+76j
.text:0040503F		       push    104h	       ; nSize
.text:00405044		       mov     esi, (offset outmsg+19h)
.text:00405049		       push    esi	       ; lpFilename
.text:0040504A		       push    0	       ; hModule
.text:0040504C		       mov     outmsg+11Dh, 0
.text:00405053		       call    ds:__imp__GetModuleFileNameA@12 ; GetModuleFileNameA(x,x,x)
.text:00405059		       test    eax, eax
.text:0040505B		       jnz     short loc_405083
.text:0040505D		       push    offset aProgramNameUnk ;	"<program name unknown>"
.text:00405062		       push    2FBh	       ; _SizeInBytes
.text:00405067		       push    esi	       ; _Dst
.text:00405068		       call    _strcpy_s
.text:0040506D		       add     esp, 0Ch
.text:00405070		       test    eax, eax
.text:00405072		       jz      short loc_405083
.text:00405074		       xor     eax, eax
.text:00405076		       push    eax	       ; pReserved
.text:00405077		       push    eax	       ; nLine
.text:00405078		       push    eax	       ; pszFile
.text:00405079		       push    eax	       ; pszFunction
.text:0040507A		       push    eax	       ; pszExpression
.text:0040507B		       call    __invoke_watson
.text:00405080		       add     esp, 14h
.text:00405083
.text:00405083 loc_405083:			       ; CODE XREF: __NMSG_WRITE+A1j
.text:00405083					       ; __NMSG_WRITE+B8j
.text:00405083		       push    esi	       ; buf
.text:00405084		       call    _strlen
.text:00405089		       inc     eax
.text:0040508A		       cmp     eax, 3Ch
.text:0040508D		       pop     ecx
.text:0040508E		       jbe     short loc_4050C8
.text:00405090		       push    esi	       ; buf
.text:00405091		       call    _strlen
.text:00405096		       sub     esi, 3Bh
.text:00405099		       add     eax, esi
.text:0040509B		       push    3	       ; _Count
.text:0040509D		       mov     ecx, offset ?__pInconsistency@@3P6AXXZA ; void (*__pInconsistency)(void)
.text:004050A2		       push    offset a___     ; "..."
.text:004050A7		       sub     ecx, eax
.text:004050A9		       push    ecx	       ; _SizeInBytes
.text:004050AA		       push    eax	       ; _Dst
.text:004050AB		       call    _strncpy_s
.text:004050B0		       add     esp, 14h
.text:004050B3		       test    eax, eax
.text:004050B5		       jz      short loc_4050C8
.text:004050B7		       xor     esi, esi
.text:004050B9		       push    esi	       ; pReserved
.text:004050BA		       push    esi	       ; nLine
.text:004050BB		       push    esi	       ; pszFile
.text:004050BC		       push    esi	       ; pszFunction
.text:004050BD		       push    esi	       ; pszExpression
.text:004050BE		       call    __invoke_watson
.text:004050C3		       add     esp, 14h
.text:004050C6		       jmp     short loc_4050CA
.text:004050C8 ; ---------------------------------------------------------------------------
.text:004050C8
.text:004050C8 loc_4050C8:			       ; CODE XREF: __NMSG_WRITE+D4j
.text:004050C8					       ; __NMSG_WRITE+FBj
.text:004050C8		       xor     esi, esi
.text:004050CA
.text:004050CA loc_4050CA:			       ; CODE XREF: __NMSG_WRITE+10Cj
.text:004050CA		       push    offset asc_41F300 ; "\n\n"
.text:004050CF		       push    ebx	       ; _SizeInBytes
.text:004050D0		       push    ebp	       ; _Dst
.text:004050D1		       call    _strcat_s
.text:004050D6		       add     esp, 0Ch
.text:004050D9		       test    eax, eax
.text:004050DB		       jz      short loc_4050EA
.text:004050DD		       push    esi	       ; pReserved
.text:004050DE		       push    esi	       ; nLine
.text:004050DF		       push    esi	       ; pszFile
.text:004050E0		       push    esi	       ; pszFunction
.text:004050E1		       push    esi	       ; pszExpression
.text:004050E2		       call    __invoke_watson
.text:004050E7		       add     esp, 14h
.text:004050EA
.text:004050EA loc_4050EA:			       ; CODE XREF: __NMSG_WRITE+121j
.text:004050EA		       push    rterrs.rterrtxt[edi*8] ;	_Src
.text:004050F1		       push    ebx	       ; _SizeInBytes
.text:004050F2		       push    ebp	       ; _Dst
.text:004050F3		       call    _strcat_s
.text:004050F8		       add     esp, 0Ch
.text:004050FB		       test    eax, eax
.text:004050FD		       jz      short loc_40510C
.text:004050FF		       push    esi	       ; pReserved
.text:00405100		       push    esi	       ; nLine
.text:00405101		       push    esi	       ; pszFile
.text:00405102		       push    esi	       ; pszFunction
.text:00405103		       push    esi	       ; pszExpression
.text:00405104		       call    __invoke_watson
.text:00405109		       add     esp, 14h
.text:0040510C
.text:0040510C loc_40510C:			       ; CODE XREF: __NMSG_WRITE+143j
.text:0040510C		       push    12010h	       ; uType
.text:00405111		       push    offset Caption  ; "Microsoft Visual C++ Runtime Library"
.text:00405116		       push    ebp	       ; lpText
.text:00405117		       call    ___crtMessageBoxA
.text:0040511C		       add     esp, 0Ch
.text:0040511F		       jmp     short loc_405154
.text:00405121 ; ---------------------------------------------------------------------------
.text:00405121
.text:00405121 loc_405121:			       ; CODE XREF: __NMSG_WRITE+30j
.text:00405121					       ; __NMSG_WRITE+49j
.text:00405121		       push    0FFFFFFF4h      ; nStdHandle
.text:00405123		       call    ds:__imp__GetStdHandle@4	; GetStdHandle(x)
.text:00405129		       mov     ebp, eax
.text:0040512B		       cmp     ebp, esi
.text:0040512D		       jz      short loc_405154
.text:0040512F		       cmp     ebp, 0FFFFFFFFh
.text:00405132		       jz      short loc_405154
.text:00405134		       push    0	       ; lpOverlapped
.text:00405136		       lea     eax, [esp+18h+NumberOfBytesWritten]
.text:0040513A		       push    eax	       ; lpNumberOfBytesWritten
.text:0040513B		       lea     esi, ds:4225BCh[edi*8]
.text:00405142		       push    dword ptr [esi] ; buf
.text:00405144		       call    _strlen
.text:00405149		       pop     ecx
.text:0040514A		       push    eax	       ; nNumberOfBytesToWrite
.text:0040514B		       push    dword ptr [esi] ; lpBuffer
.text:0040514D		       push    ebp	       ; hFile
.text:0040514E		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:00405154
.text:00405154 loc_405154:			       ; CODE XREF: __NMSG_WRITE+55j
.text:00405154					       ; __NMSG_WRITE+165j ...
.text:00405154		       pop     ebp
.text:00405155
.text:00405155 loc_405155:			       ; CODE XREF: __NMSG_WRITE+1Ej
.text:00405155		       pop     edi
.text:00405156		       pop     esi
.text:00405157		       pop     ebx
.text:00405158		       pop     ecx
.text:00405159		       retn
.text:00405159 __NMSG_WRITE    endp
.text:00405159
.text:0040515A
.text:0040515A ; =============== S U B R O U T I N E =======================================
.text:0040515A
.text:0040515A
.text:0040515A ; char *__cdecl _GET_RTERRMSG(int rterrnum)
.text:0040515A __GET_RTERRMSG  proc near
.text:0040515A
.text:0040515A rterrnum	       = dword ptr  4
.text:0040515A
.text:0040515A		       xor     eax, eax
.text:0040515C
.text:0040515C loc_40515C:			       ; CODE XREF: __GET_RTERRMSG+13j
.text:0040515C		       mov     ecx, [esp+rterrnum]
.text:00405160		       cmp     ecx, rterrs.rterrno[eax*8]
.text:00405167		       jz      short loc_405172
.text:00405169		       inc     eax
.text:0040516A		       cmp     eax, 17h
.text:0040516D		       jb      short loc_40515C
.text:0040516F		       xor     eax, eax
.text:00405171		       retn
.text:00405172 ; ---------------------------------------------------------------------------
.text:00405172
.text:00405172 loc_405172:			       ; CODE XREF: __GET_RTERRMSG+Dj
.text:00405172		       mov     eax, rterrs.rterrtxt[eax*8]
.text:00405179		       retn
.text:00405179 __GET_RTERRMSG  endp
.text:00405179
.text:0040517A
.text:0040517A ; =============== S U B R O U T I N E =======================================
.text:0040517A
.text:0040517A
.text:0040517A __FF_MSGBANNER  proc near	       ; CODE XREF: __amsg_exitp
.text:0040517A					       ; __heap_alloc+9p ...
.text:0040517A		       push    3	       ; em
.text:0040517C		       call    __set_error_mode
.text:00405181		       cmp     eax, 1
.text:00405184		       pop     ecx
.text:00405185		       jz      short loc_40519C
.text:00405187		       push    3	       ; em
.text:00405189		       call    __set_error_mode
.text:0040518E		       test    eax, eax
.text:00405190		       pop     ecx
.text:00405191		       jnz     short locret_4051B2
.text:00405193		       cmp     ___app_type, 1
.text:0040519A		       jnz     short locret_4051B2
.text:0040519C
.text:0040519C loc_40519C:			       ; CODE XREF: __FF_MSGBANNER+Bj
.text:0040519C		       push    0FCh	       ; rterrnum
.text:004051A1		       call    __NMSG_WRITE
.text:004051A6		       push    0FFh	       ; rterrnum
.text:004051AB		       call    __NMSG_WRITE
.text:004051B0		       pop     ecx
.text:004051B1		       pop     ecx
.text:004051B2
.text:004051B2 locret_4051B2:			       ; CODE XREF: __FF_MSGBANNER+17j
.text:004051B2					       ; __FF_MSGBANNER+20j
.text:004051B2		       retn
.text:004051B2 __FF_MSGBANNER  endp
.text:004051B2
.text:004051B3
.text:004051B3 ; =============== S U B R O U T I N E =======================================
.text:004051B3
.text:004051B3
.text:004051B3 ; int (__cdecl *__cdecl onexit_nolock(int (__cdecl *func)()))()
.text:004051B3 _onexit_nolock  proc near	       ; CODE XREF: __onexit+18p
.text:004051B3
.text:004051B3 onexitbegin     = dword ptr -8
.text:004051B3 ptr	       = dword ptr -4
.text:004051B3 func	       = dword ptr  4
.text:004051B3
.text:004051B3		       push    ecx
.text:004051B4		       push    ebx
.text:004051B5		       push    ebp
.text:004051B6		       push    esi
.text:004051B7		       push    edi
.text:004051B8		       push    ___onexitbegin  ; codedptr
.text:004051BE		       call    __decode_pointer
.text:004051C3		       push    ___onexitend    ; codedptr
.text:004051C9		       mov     esi, eax
.text:004051CB		       mov     [esp+1Ch+ptr], esi
.text:004051CF		       call    __decode_pointer
.text:004051D4		       mov     edi, eax
.text:004051D6		       cmp     edi, esi
.text:004051D8		       pop     ecx
.text:004051D9		       pop     ecx
.text:004051DA		       jb      loc_405264
.text:004051E0		       mov     ebx, edi
.text:004051E2		       sub     ebx, esi
.text:004051E4		       lea     ebp, [ebx+4]
.text:004051E7		       cmp     ebp, 4
.text:004051EA		       jb      short loc_405264
.text:004051EC		       push    esi	       ; pblock
.text:004051ED		       call    __msize
.text:004051F2		       mov     esi, eax
.text:004051F4		       cmp     esi, ebp
.text:004051F6		       pop     ecx
.text:004051F7		       jnb     short loc_405243
.text:004051F9		       mov     eax, 800h
.text:004051FE		       cmp     esi, eax
.text:00405200		       jnb     short loc_405204
.text:00405202		       mov     eax, esi
.text:00405204
.text:00405204 loc_405204:			       ; CODE XREF: _onexit_nolock+4Dj
.text:00405204		       add     eax, esi
.text:00405206		       cmp     eax, esi
.text:00405208		       jb      short loc_40521A
.text:0040520A		       push    eax	       ; size
.text:0040520B		       push    [esp+18h+ptr]   ; ptr
.text:0040520F		       call    __realloc_crt
.text:00405214		       test    eax, eax
.text:00405216		       pop     ecx
.text:00405217		       pop     ecx
.text:00405218		       jnz     short loc_405231
.text:0040521A
.text:0040521A loc_40521A:			       ; CODE XREF: _onexit_nolock+55j
.text:0040521A		       lea     eax, [esi+10h]
.text:0040521D		       cmp     eax, esi
.text:0040521F		       jb      short loc_405264
.text:00405221		       push    eax	       ; size
.text:00405222		       push    [esp+18h+ptr]   ; ptr
.text:00405226		       call    __realloc_crt
.text:0040522B		       test    eax, eax
.text:0040522D		       pop     ecx
.text:0040522E		       pop     ecx
.text:0040522F		       jz      short loc_405264
.text:00405231
.text:00405231 loc_405231:			       ; CODE XREF: _onexit_nolock+65j
.text:00405231		       sar     ebx, 2
.text:00405234		       push    eax	       ; ptr
.text:00405235		       lea     edi, [eax+ebx*4]
.text:00405238		       call    __encode_pointer
.text:0040523D		       pop     ecx
.text:0040523E		       mov     ___onexitbegin, eax
.text:00405243
.text:00405243 loc_405243:			       ; CODE XREF: _onexit_nolock+44j
.text:00405243		       push    [esp+14h+func]  ; ptr
.text:00405247		       call    __encode_pointer
.text:0040524C		       mov     [edi], eax
.text:0040524E		       add     edi, 4
.text:00405251		       push    edi	       ; ptr
.text:00405252		       call    __encode_pointer
.text:00405257		       pop     ecx
.text:00405258		       mov     ___onexitend, eax
.text:0040525D		       mov     eax, [esp+18h+func]
.text:00405261		       pop     ecx
.text:00405262		       jmp     short loc_405266
.text:00405264 ; ---------------------------------------------------------------------------
.text:00405264
.text:00405264 loc_405264:			       ; CODE XREF: _onexit_nolock+27j
.text:00405264					       ; _onexit_nolock+37j ...
.text:00405264		       xor     eax, eax
.text:00405266
.text:00405266 loc_405266:			       ; CODE XREF: _onexit_nolock+AFj
.text:00405266		       pop     edi
.text:00405267		       pop     esi
.text:00405268		       pop     ebp
.text:00405269		       pop     ebx
.text:0040526A		       pop     ecx
.text:0040526B		       retn
.text:0040526B _onexit_nolock  endp
.text:0040526B
.text:0040526C
.text:0040526C ; =============== S U B R O U T I N E =======================================
.text:0040526C
.text:0040526C
.text:0040526C ; int __cdecl __onexitinit()
.text:0040526C ___onexitinit   proc near	       ; DATA XREF: .rdata:pinit_0o
.text:0040526C		       push    esi
.text:0040526D		       push    4	       ; size
.text:0040526F		       push    20h	       ; count
.text:00405271		       call    __calloc_crt
.text:00405276		       mov     esi, eax
.text:00405278		       push    esi	       ; ptr
.text:00405279		       call    __encode_pointer
.text:0040527E		       add     esp, 0Ch
.text:00405281		       test    esi, esi
.text:00405283		       mov     ___onexitbegin, eax
.text:00405288		       mov     ___onexitend, eax
.text:0040528D		       jnz     short loc_405294
.text:0040528F		       push    18h
.text:00405291		       pop     eax
.text:00405292		       pop     esi
.text:00405293		       retn
.text:00405294 ; ---------------------------------------------------------------------------
.text:00405294
.text:00405294 loc_405294:			       ; CODE XREF: ___onexitinit+21j
.text:00405294		       and     dword ptr [esi],	0
.text:00405297		       xor     eax, eax
.text:00405299		       pop     esi
.text:0040529A		       retn
.text:0040529A ___onexitinit   endp
.text:0040529A
.text:0040529B
.text:0040529B ; =============== S U B R O U T I N E =======================================
.text:0040529B
.text:0040529B ; Attributes: noreturn bp-based frame
.text:0040529B
.text:0040529B ; int (__cdecl *__cdecl _onexit(int (__cdecl *func)()))()
.text:0040529B __onexit	       proc near	       ; CODE XREF: _atexit+4p
.text:0040529B
.text:0040529B retval	       = dword ptr -1Ch
.text:0040529B ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040529B func	       = dword ptr  8
.text:0040529B
.text:0040529B		       push    0Ch
.text:0040529D		       push    offset dword_421598
.text:004052A2		       call    __SEH_prolog4
.text:004052A7		       call    __lockexit
.text:004052AC		       and     [ebp+ms_exc.disabled], 0
.text:004052B0		       push    [ebp+func]      ; func
.text:004052B3		       call    _onexit_nolock
.text:004052B8		       pop     ecx
.text:004052B9		       mov     [ebp+retval], eax
.text:004052BC		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004052C3		       call    $LN5
.text:004052C8 ; ---------------------------------------------------------------------------
.text:004052C8
.text:004052C8 $LN8_1:
.text:004052C8		       mov     eax, [ebp+retval]
.text:004052CB		       call    __SEH_epilog4
.text:004052D0		       retn
.text:004052D1 ; ---------------------------------------------------------------------------
.text:004052D1
.text:004052D1 $LN5:				       ; CODE XREF: __onexit+28p
.text:004052D1					       ; DATA XREF: .rdata:004215B0o
.text:004052D1		       call    __unlockexit
.text:004052D6
.text:004052D6 $LN6_2:
.text:004052D6		       retn
.text:004052D6 __onexit	       endp
.text:004052D6
.text:004052D7
.text:004052D7 ; =============== S U B R O U T I N E =======================================
.text:004052D7
.text:004052D7 ; Attributes: noreturn
.text:004052D7
.text:004052D7 ; int __cdecl atexit(void (__cdecl *func)())
.text:004052D7 _atexit	       proc near	       ; CODE XREF: __cinit+44p
.text:004052D7
.text:004052D7 func	       = dword ptr  4
.text:004052D7
.text:004052D7		       push    [esp+func]      ; func
.text:004052DB		       call    __onexit
.text:004052E0 ; ---------------------------------------------------------------------------
.text:004052E0		       neg     eax
.text:004052E2		       sbb     eax, eax
.text:004052E4		       neg     eax
.text:004052E6		       pop     ecx
.text:004052E7		       dec     eax
.text:004052E8		       retn
.text:004052E8 _atexit	       endp
.text:004052E8
.text:004052E9
.text:004052E9 ; =============== S U B R O U T I N E =======================================
.text:004052E9
.text:004052E9
.text:004052E9 __RTC_Initialize	proc near	       ; CODE XREF: __tmainCRTStartup:loc_4023DBp
.text:004052E9		       push    esi
.text:004052EA		       push    edi
.text:004052EB		       mov     eax, offset dword_421044
.text:004052F0		       mov     edi, offset ___rtc_izz
.text:004052F5		       cmp     eax, edi
.text:004052F7		       mov     esi, eax
.text:004052F9		       jnb     short loc_40530A
.text:004052FB
.text:004052FB loc_4052FB:			       ; CODE XREF: __RTC_Initialize+1Fj
.text:004052FB		       mov     eax, [esi]
.text:004052FD		       test    eax, eax
.text:004052FF		       jz      short loc_405303
.text:00405301		       call    eax
.text:00405303
.text:00405303 loc_405303:			       ; CODE XREF: __RTC_Initialize+16j
.text:00405303		       add     esi, 4
.text:00405306		       cmp     esi, edi
.text:00405308		       jb      short loc_4052FB
.text:0040530A
.text:0040530A loc_40530A:			       ; CODE XREF: __RTC_Initialize+10j
.text:0040530A		       pop     edi
.text:0040530B		       pop     esi
.text:0040530C		       retn
.text:0040530C __RTC_Initialize	endp
.text:0040530C
.text:0040530D
.text:0040530D ; =============== S U B R O U T I N E =======================================
.text:0040530D
.text:0040530D
.text:0040530D ; void __cdecl _RTC_Terminate()
.text:0040530D __RTC_Terminate proc near	       ; DATA XREF: __cinit+3Fo
.text:0040530D		       push    esi
.text:0040530E		       push    edi
.text:0040530F		       mov     eax, offset dword_42124C
.text:00405314		       mov     edi, offset ___rtc_tzz
.text:00405319		       cmp     eax, edi
.text:0040531B		       mov     esi, eax
.text:0040531D		       jnb     short loc_40532E
.text:0040531F
.text:0040531F loc_40531F:			       ; CODE XREF: __RTC_Terminate+1Fj
.text:0040531F		       mov     eax, [esi]
.text:00405321		       test    eax, eax
.text:00405323		       jz      short loc_405327
.text:00405325		       call    eax
.text:00405327
.text:00405327 loc_405327:			       ; CODE XREF: __RTC_Terminate+16j
.text:00405327		       add     esi, 4
.text:0040532A		       cmp     esi, edi
.text:0040532C		       jb      short loc_40531F
.text:0040532E
.text:0040532E loc_40532E:			       ; CODE XREF: __RTC_Terminate+10j
.text:0040532E		       pop     edi
.text:0040532F		       pop     esi
.text:00405330		       retn
.text:00405330 __RTC_Terminate endp
.text:00405330
.text:00405331
.text:00405331 ; =============== S U B R O U T I N E =======================================
.text:00405331
.text:00405331
.text:00405331 __initp_misc_cfltcvt_tab	proc near      ; CODE XREF: __cinit:loc_401B93p
.text:00405331		       push    esi
.text:00405332		       push    edi
.text:00405333		       xor     edi, edi
.text:00405335
.text:00405335 loc_405335:			       ; CODE XREF: __initp_misc_cfltcvt_tab+1Aj
.text:00405335		       lea     esi, __cfltcvt_tab[edi]
.text:0040533B		       push    dword ptr [esi] ; ptr
.text:0040533D		       call    __encode_pointer
.text:00405342		       add     edi, 4
.text:00405345		       cmp     edi, 28h
.text:00405348		       pop     ecx
.text:00405349		       mov     [esi], eax
.text:0040534B		       jb      short loc_405335
.text:0040534D		       pop     edi
.text:0040534E		       pop     esi
.text:0040534F		       retn
.text:0040534F __initp_misc_cfltcvt_tab	endp
.text:0040534F
.text:00405350
.text:00405350 ; =============== S U B R O U T I N E =======================================
.text:00405350
.text:00405350
.text:00405350 ; int __cdecl _ValidateImageBase(char *pImageBase)
.text:00405350 __ValidateImageBase proc	near	       ; CODE XREF: __IsNonwritableInCurrentImage+3Fp
.text:00405350
.text:00405350 pImageBase      = dword ptr  4
.text:00405350
.text:00405350		       mov     ecx, [esp+pImageBase]
.text:00405354		       cmp     word ptr	[ecx], 5A4Dh
.text:00405359		       jz      short loc_40535E
.text:0040535B
.text:0040535B loc_40535B:			       ; CODE XREF: __ValidateImageBase+19j
.text:0040535B		       xor     eax, eax
.text:0040535D		       retn
.text:0040535E ; ---------------------------------------------------------------------------
.text:0040535E
.text:0040535E loc_40535E:			       ; CODE XREF: __ValidateImageBase+9j
.text:0040535E		       mov     eax, [ecx+3Ch]
.text:00405361		       add     eax, ecx
.text:00405363		       cmp     dword ptr [eax],	4550h
.text:00405369		       jnz     short loc_40535B
.text:0040536B		       xor     ecx, ecx
.text:0040536D		       cmp     word ptr	[eax+18h], 10Bh
.text:00405373		       setz    cl
.text:00405376		       mov     eax, ecx
.text:00405378		       retn
.text:00405378 __ValidateImageBase endp
.text:00405378
.text:00405378 ; ---------------------------------------------------------------------------
.text:00405379		       align 10h
.text:00405380
.text:00405380 ; =============== S U B R O U T I N E =======================================
.text:00405380
.text:00405380
.text:00405380 ; _IMAGE_SECTION_HEADER *__cdecl	_FindPESection(char *pImageBase, unsigned int rva)
.text:00405380 __FindPESection proc near	       ; CODE XREF: __IsNonwritableInCurrentImage+59p
.text:00405380
.text:00405380 pImageBase      = dword ptr  4
.text:00405380 rva	       = dword ptr  8
.text:00405380
.text:00405380		       mov     eax, [esp+pImageBase]
.text:00405384		       mov     ecx, [eax+3Ch]
.text:00405387		       add     ecx, eax
.text:00405389		       movzx   eax, word ptr [ecx+14h]
.text:0040538D		       push    ebx
.text:0040538E		       push    esi
.text:0040538F		       movzx   esi, word ptr [ecx+6]
.text:00405393		       xor     edx, edx
.text:00405395		       test    esi, esi
.text:00405397		       push    edi
.text:00405398		       lea     eax, [eax+ecx+18h]
.text:0040539C		       jbe     short loc_4053BC
.text:0040539E		       mov     edi, [esp+0Ch+rva]
.text:004053A2
.text:004053A2 loc_4053A2:			       ; CODE XREF: __FindPESection+3Aj
.text:004053A2		       mov     ecx, [eax+0Ch]
.text:004053A5		       cmp     edi, ecx
.text:004053A7		       jb      short loc_4053B2
.text:004053A9		       mov     ebx, [eax+8]
.text:004053AC		       add     ebx, ecx
.text:004053AE		       cmp     edi, ebx
.text:004053B0		       jb      short loc_4053BE
.text:004053B2
.text:004053B2 loc_4053B2:			       ; CODE XREF: __FindPESection+27j
.text:004053B2		       add     edx, 1
.text:004053B5		       add     eax, 28h
.text:004053B8		       cmp     edx, esi
.text:004053BA		       jb      short loc_4053A2
.text:004053BC
.text:004053BC loc_4053BC:			       ; CODE XREF: __FindPESection+1Cj
.text:004053BC		       xor     eax, eax
.text:004053BE
.text:004053BE loc_4053BE:			       ; CODE XREF: __FindPESection+30j
.text:004053BE		       pop     edi
.text:004053BF		       pop     esi
.text:004053C0		       pop     ebx
.text:004053C1		       retn
.text:004053C1 __FindPESection endp
.text:004053C1
.text:004053C1 ; ---------------------------------------------------------------------------
.text:004053C2		       align 10h
.text:004053D0
.text:004053D0 ; =============== S U B R O U T I N E =======================================
.text:004053D0
.text:004053D0 ; Attributes: bp-based frame
.text:004053D0
.text:004053D0 ; int __cdecl _IsNonwritableInCurrentImage(char *pTarget)
.text:004053D0 __IsNonwritableInCurrentImage proc near ; CODE XREF: __cinit+Ep
.text:004053D0					       ; __cinit+79p ...
.text:004053D0
.text:004053D0 var_18	       = dword ptr -18h
.text:004053D0 var_14	       = dword ptr -14h
.text:004053D0 var_10	       = dword ptr -10h
.text:004053D0 var_8	       = dword ptr -8
.text:004053D0 var_4	       = dword ptr -4
.text:004053D0 pTarget	       = dword ptr  8
.text:004053D0
.text:004053D0		       push    ebp
.text:004053D1		       mov     ebp, esp
.text:004053D3		       push    0FFFFFFFEh
.text:004053D5		       push    offset dword_4215B8
.text:004053DA		       push    offset __except_handler4
.text:004053DF		       mov     eax, large fs:0
.text:004053E5		       push    eax
.text:004053E6		       sub     esp, 8
.text:004053E9		       push    ebx
.text:004053EA		       push    esi
.text:004053EB		       push    edi
.text:004053EC		       mov     eax, ___security_cookie
.text:004053F1		       xor     [ebp+var_8], eax
.text:004053F4		       xor     eax, ebp
.text:004053F6		       push    eax
.text:004053F7		       lea     eax, [ebp+var_10]
.text:004053FA		       mov     large fs:0, eax
.text:00405400		       mov     [ebp+var_18], esp
.text:00405403		       mov     [ebp+var_4], 0
.text:0040540A		       push    400000h	       ; pImageBase
.text:0040540F		       call    __ValidateImageBase
.text:00405414		       add     esp, 4
.text:00405417		       test    eax, eax
.text:00405419		       jz      short loc_405470
.text:0040541B		       mov     eax, [ebp+pTarget]
.text:0040541E		       sub     eax, 400000h
.text:00405423		       push    eax	       ; rva
.text:00405424		       push    400000h	       ; pImageBase
.text:00405429		       call    __FindPESection
.text:0040542E		       add     esp, 8
.text:00405431		       test    eax, eax
.text:00405433		       jz      short loc_405470
.text:00405435		       mov     eax, [eax+24h]
.text:00405438		       shr     eax, 1Fh
.text:0040543B		       not     eax
.text:0040543D		       and     eax, 1
.text:00405440		       mov     [ebp+var_4], 0FFFFFFFEh
.text:00405447		       mov     ecx, [ebp+var_10]
.text:0040544A		       mov     large fs:0, ecx
.text:00405451		       pop     ecx
.text:00405452		       pop     edi
.text:00405453		       pop     esi
.text:00405454		       pop     ebx
.text:00405455		       mov     esp, ebp
.text:00405457		       pop     ebp
.text:00405458		       retn
.text:00405459 ; ---------------------------------------------------------------------------
.text:00405459
.text:00405459 $LN7_2:
.text:00405459		       mov     eax, [ebp+var_14]
.text:0040545C		       mov     ecx, [eax]
.text:0040545E		       mov     eax, [ecx]
.text:00405460		       xor     edx, edx
.text:00405462		       cmp     eax, 0C0000005h
.text:00405467		       setz    dl
.text:0040546A		       mov     eax, edx
.text:0040546C
.text:0040546C $LN11_0:
.text:0040546C		       retn
.text:0040546D ; ---------------------------------------------------------------------------
.text:0040546D
.text:0040546D $LN8_2:
.text:0040546D		       mov     esp, [ebp+var_18]
.text:00405470
.text:00405470 loc_405470:			       ; CODE XREF: __IsNonwritableInCurrentImage+49j
.text:00405470					       ; __IsNonwritableInCurrentImage+63j
.text:00405470		       mov     [ebp+var_4], 0FFFFFFFEh
.text:00405477		       xor     eax, eax
.text:00405479		       mov     ecx, [ebp+var_10]
.text:0040547C		       mov     large fs:0, ecx
.text:00405483		       pop     ecx
.text:00405484		       pop     edi
.text:00405485		       pop     esi
.text:00405486		       pop     ebx
.text:00405487		       mov     esp, ebp
.text:00405489		       pop     ebp
.text:0040548A		       retn
.text:0040548A __IsNonwritableInCurrentImage endp
.text:0040548A
.text:0040548B
.text:0040548B ; =============== S U B R O U T I N E =======================================
.text:0040548B
.text:0040548B ; Attributes: noreturn bp-based frame
.text:0040548B
.text:0040548B ; void __cdecl terminate()
.text:0040548B ?terminate@@YAXXZ proc near	       ; CODE XREF: unexpected(void):loc_4054D2j
.text:0040548B					       ; _inconsistency(void):loc_405509j ...
.text:0040548B
.text:0040548B ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040548B
.text:0040548B		       push    8
.text:0040548D		       push    offset dword_4215D8
.text:00405492		       call    __SEH_prolog4
.text:00405497		       call    __getptd
.text:0040549C		       mov     eax, [eax+78h]
.text:0040549F		       test    eax, eax
.text:004054A1		       jz      short loc_4054B9
.text:004054A3		       and     [ebp+ms_exc.disabled], 0
.text:004054A7		       call    eax
.text:004054A9		       jmp     short loc_4054B2
.text:004054AB ; ---------------------------------------------------------------------------
.text:004054AB
.text:004054AB $LN6_3:
.text:004054AB		       xor     eax, eax
.text:004054AD		       inc     eax
.text:004054AE
.text:004054AE $LN10:
.text:004054AE		       retn
.text:004054AF ; ---------------------------------------------------------------------------
.text:004054AF
.text:004054AF $LN7_3:
.text:004054AF		       mov     esp, [ebp+ms_exc.old_esp]
.text:004054B2
.text:004054B2 loc_4054B2:			       ; CODE XREF: terminate(void)+1Ej
.text:004054B2		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004054B9
.text:004054B9 loc_4054B9:			       ; CODE XREF: terminate(void)+16j
.text:004054B9		       call    _abort
.text:004054BE ; ---------------------------------------------------------------------------
.text:004054BE		       call    __SEH_epilog4
.text:004054C3		       retn
.text:004054C3 ?terminate@@YAXXZ endp
.text:004054C3
.text:004054C4
.text:004054C4 ; =============== S U B R O U T I N E =======================================
.text:004054C4
.text:004054C4 ; Attributes: noreturn
.text:004054C4
.text:004054C4 ; void __cdecl unexpected()
.text:004054C4 ?unexpected@@YAXXZ proc near
.text:004054C4		       call    __getptd
.text:004054C9		       mov     eax, [eax+7Ch]
.text:004054CC		       test    eax, eax
.text:004054CE		       jz      short loc_4054D2
.text:004054D0		       call    eax
.text:004054D2
.text:004054D2 loc_4054D2:			       ; CODE XREF: unexpected(void)+Aj
.text:004054D2		       jmp     ?terminate@@YAXXZ ; terminate(void)
.text:004054D2 ?unexpected@@YAXXZ endp
.text:004054D2
.text:004054D7
.text:004054D7 ; =============== S U B R O U T I N E =======================================
.text:004054D7
.text:004054D7 ; Attributes: noreturn bp-based frame
.text:004054D7
.text:004054D7 ; void __cdecl _inconsistency()
.text:004054D7 ?_inconsistency@@YAXXZ proc near
.text:004054D7
.text:004054D7 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004054D7
.text:004054D7		       push    8
.text:004054D9		       push    offset dword_4215F8
.text:004054DE		       call    __SEH_prolog4
.text:004054E3		       push    ?__pInconsistency@@3P6AXXZA ; codedptr
.text:004054E9		       call    __decode_pointer
.text:004054EE		       pop     ecx
.text:004054EF		       test    eax, eax
.text:004054F1		       jz      short loc_405509
.text:004054F3		       and     [ebp+ms_exc.disabled], 0
.text:004054F7		       call    eax
.text:004054F9		       jmp     short loc_405502
.text:004054FB ; ---------------------------------------------------------------------------
.text:004054FB
.text:004054FB $LN6_4:
.text:004054FB		       xor     eax, eax
.text:004054FD		       inc     eax
.text:004054FE
.text:004054FE $LN10_0:
.text:004054FE		       retn
.text:004054FF ; ---------------------------------------------------------------------------
.text:004054FF
.text:004054FF $LN7_4:
.text:004054FF		       mov     esp, [ebp+ms_exc.old_esp]
.text:00405502
.text:00405502 loc_405502:			       ; CODE XREF: _inconsistency(void)+22j
.text:00405502		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00405509
.text:00405509 loc_405509:			       ; CODE XREF: _inconsistency(void)+1Aj
.text:00405509		       jmp     ?terminate@@YAXXZ ; terminate(void)
.text:00405509 ?_inconsistency@@YAXXZ endp
.text:00405509
.text:0040550E
.text:0040550E ; =============== S U B R O U T I N E =======================================
.text:0040550E
.text:0040550E
.text:0040550E ; void __cdecl _initp_eh_hooks(void *enull)
.text:0040550E __initp_eh_hooks	proc near	       ; CODE XREF: __init_pointers+33p
.text:0040550E
.text:0040550E enull	       = dword ptr  4
.text:0040550E
.text:0040550E		       push    offset ?terminate@@YAXXZ	; ptr
.text:00405513		       call    __encode_pointer
.text:00405518		       pop     ecx
.text:00405519		       mov     ?__pInconsistency@@3P6AXXZA, eax	; void (*__pInconsistency)(void)
.text:0040551E		       retn
.text:0040551E __initp_eh_hooks	endp
.text:0040551E
.text:0040551F ; [00000001 BYTES: COLLAPSED FUNCTION __initp_misc_winxfltr. PRESS KEYPAD "+" TO	EXPAND]
.text:00405520
.text:00405520 ; =============== S U B R O U T I N E =======================================
.text:00405520
.text:00405520
.text:00405520 ; _XCPT_ACTION *__usercall xcptlookup<eax>(unsigned int xcptnum<edx>, _XCPT_ACTION *pxcptacttab)
.text:00405520 xcptlookup      proc near
.text:00405520
.text:00405520 pxcptacttab     = dword ptr  4
.text:00405520
.text:00405520 xcptnum = edx
.text:00405520		       mov     eax, [esp+pxcptacttab]
.text:00405524		       mov     ecx, __XcptActTabCount
.text:0040552A		       push    esi
.text:0040552B
.text:0040552B loc_40552B:			       ; CODE XREF: xcptlookup+1Dj
.text:0040552B		       cmp     [eax], xcptnum
.text:0040552D		       jz      short loc_40553F
.text:0040552F		       mov     esi, ecx
.text:00405531		       imul    esi, 0Ch
.text:00405534		       add     esi, [esp+4+pxcptacttab]
.text:00405538		       add     eax, 0Ch
.text:0040553B		       cmp     eax, esi
.text:0040553D		       jb      short loc_40552B
.text:0040553F
.text:0040553F loc_40553F:			       ; CODE XREF: xcptlookup+Dj
.text:0040553F		       imul    ecx, 0Ch
.text:00405542		       add     ecx, [esp+4+pxcptacttab]
.text:00405546		       pop     esi
.text:00405547		       cmp     eax, ecx
.text:00405549		       jnb     short loc_40554F
.text:0040554B		       cmp     [eax], xcptnum
.text:0040554D		       jz      short locret_405551
.text:0040554F
.text:0040554F loc_40554F:			       ; CODE XREF: xcptlookup+29j
.text:0040554F		       xor     eax, eax
.text:00405551
.text:00405551 locret_405551:			       ; CODE XREF: xcptlookup+2Dj
.text:00405551		       retn
.text:00405551 xcptlookup      endp
.text:00405551
.text:00405552
.text:00405552 ; =============== S U B R O U T I N E =======================================
.text:00405552
.text:00405552 ; Attributes: bp-based frame
.text:00405552
.text:00405552 ; int __cdecl _XcptFilter(unsigned int xcptnum, _EXCEPTION_POINTERS *pxcptinfoptrs)
.text:00405552 __XcptFilter    proc near	       ; CODE XREF: __tmainCRTStartup+184p
.text:00405552					       ; ___CppXcptFilter+10p
.text:00405552
.text:00405552 oldpxcptinfoptrs= dword ptr -8
.text:00405552 phandler	       = dword ptr -4
.text:00405552 xcptnum	       = dword ptr  8
.text:00405552 pxcptinfoptrs   = dword ptr  0Ch
.text:00405552
.text:00405552		       push    ebp
.text:00405553		       mov     ebp, esp
.text:00405555		       push    ecx
.text:00405556		       push    ecx
.text:00405557		       push    esi
.text:00405558		       call    __getptd_noexit
.text:0040555D		       mov     esi, eax
.text:0040555F		       test    esi, esi
.text:00405561		       jz      loc_4056AD
.text:00405567		       mov     edx, [esi+5Ch]
.text:0040556A		       mov     eax, __XcptActTabCount
.text:0040556F		       push    edi
.text:00405570		       mov     edi, [ebp+xcptnum]
.text:00405573		       mov     ecx, edx
.text:00405575		       push    ebx
.text:00405576
.text:00405576 loc_405576:			       ; CODE XREF: __XcptFilter+34j
.text:00405576		       cmp     [ecx], edi
.text:00405578		       jz      short loc_405588
.text:0040557A		       mov     ebx, eax
.text:0040557C		       imul    ebx, 0Ch
.text:0040557F		       add     ecx, 0Ch
.text:00405582		       add     ebx, edx
.text:00405584		       cmp     ecx, ebx
.text:00405586		       jb      short loc_405576
.text:00405588
.text:00405588 loc_405588:			       ; CODE XREF: __XcptFilter+26j
.text:00405588		       imul    eax, 0Ch
.text:0040558B		       add     eax, edx
.text:0040558D		       cmp     ecx, eax
.text:0040558F		       jnb     short loc_405599
.text:00405591		       cmp     [ecx], edi
.text:00405593		       jnz     short loc_405599
.text:00405595		       mov     eax, ecx
.text:00405597		       jmp     short loc_40559B
.text:00405599 ; ---------------------------------------------------------------------------
.text:00405599
.text:00405599 loc_405599:			       ; CODE XREF: __XcptFilter+3Dj
.text:00405599					       ; __XcptFilter+41j
.text:00405599		       xor     eax, eax
.text:0040559B
.text:0040559B loc_40559B:			       ; CODE XREF: __XcptFilter+45j
.text:0040559B		       test    eax, eax
.text:0040559D		       jz      short loc_4055A9
.text:0040559F		       mov     ebx, [eax+8]
.text:004055A2		       test    ebx, ebx
.text:004055A4		       mov     [ebp+phandler], ebx
.text:004055A7		       jnz     short loc_4055B0
.text:004055A9
.text:004055A9 loc_4055A9:			       ; CODE XREF: __XcptFilter+4Bj
.text:004055A9		       xor     eax, eax
.text:004055AB		       jmp     loc_4056AB
.text:004055B0 ; ---------------------------------------------------------------------------
.text:004055B0
.text:004055B0 loc_4055B0:			       ; CODE XREF: __XcptFilter+55j
.text:004055B0		       cmp     ebx, 5
.text:004055B3		       jnz     short loc_4055C1
.text:004055B5		       and     dword ptr [eax+8], 0
.text:004055B9		       xor     eax, eax
.text:004055BB		       inc     eax
.text:004055BC		       jmp     loc_4056AB
.text:004055C1 ; ---------------------------------------------------------------------------
.text:004055C1
.text:004055C1 loc_4055C1:			       ; CODE XREF: __XcptFilter+61j
.text:004055C1		       cmp     ebx, 1
.text:004055C4		       jz      loc_4056A8
.text:004055CA		       mov     ecx, [esi+60h]
.text:004055CD		       mov     [ebp+oldpxcptinfoptrs], ecx
.text:004055D0		       mov     ecx, [ebp+pxcptinfoptrs]
.text:004055D3		       mov     [esi+60h], ecx
.text:004055D6		       mov     ecx, [eax+4]
.text:004055D9		       cmp     ecx, 8
.text:004055DC		       jnz     loc_40569A
.text:004055E2		       mov     ecx, __First_FPE_Indx
.text:004055E8		       mov     edi, __Num_FPE
.text:004055EE		       mov     edx, ecx
.text:004055F0		       add     edi, ecx
.text:004055F2		       cmp     edx, edi
.text:004055F4		       jge     short loc_40561A
.text:004055F6		       imul    ecx, 0Ch
.text:004055F9
.text:004055F9 loc_4055F9:			       ; CODE XREF: __XcptFilter+C3j
.text:004055F9		       mov     edi, [esi+5Ch]
.text:004055FC		       and     dword ptr [ecx+edi+8], 0
.text:00405601		       mov     edi, __First_FPE_Indx
.text:00405607		       mov     ebx, __Num_FPE
.text:0040560D		       inc     edx
.text:0040560E		       add     ebx, edi
.text:00405610		       add     ecx, 0Ch
.text:00405613		       cmp     edx, ebx
.text:00405615		       jl      short loc_4055F9
.text:00405617		       mov     ebx, [ebp+phandler]
.text:0040561A
.text:0040561A loc_40561A:			       ; CODE XREF: __XcptFilter+A2j
.text:0040561A		       mov     eax, [eax]
.text:0040561C		       cmp     eax, 0C000008Eh
.text:00405621		       mov     edi, [esi+64h]
.text:00405624		       jnz     short loc_40562F
.text:00405626		       mov     dword ptr [esi+64h], 83h
.text:0040562D		       jmp     short loc_40568D
.text:0040562F ; ---------------------------------------------------------------------------
.text:0040562F
.text:0040562F loc_40562F:			       ; CODE XREF: __XcptFilter+D2j
.text:0040562F		       cmp     eax, 0C0000090h
.text:00405634		       jnz     short loc_40563F
.text:00405636		       mov     dword ptr [esi+64h], 81h
.text:0040563D		       jmp     short loc_40568D
.text:0040563F ; ---------------------------------------------------------------------------
.text:0040563F
.text:0040563F loc_40563F:			       ; CODE XREF: __XcptFilter+E2j
.text:0040563F		       cmp     eax, 0C0000091h
.text:00405644		       jnz     short loc_40564F
.text:00405646		       mov     dword ptr [esi+64h], 84h
.text:0040564D		       jmp     short loc_40568D
.text:0040564F ; ---------------------------------------------------------------------------
.text:0040564F
.text:0040564F loc_40564F:			       ; CODE XREF: __XcptFilter+F2j
.text:0040564F		       cmp     eax, 0C0000093h
.text:00405654		       jnz     short loc_40565F
.text:00405656		       mov     dword ptr [esi+64h], 85h
.text:0040565D		       jmp     short loc_40568D
.text:0040565F ; ---------------------------------------------------------------------------
.text:0040565F
.text:0040565F loc_40565F:			       ; CODE XREF: __XcptFilter+102j
.text:0040565F		       cmp     eax, 0C000008Dh
.text:00405664		       jnz     short loc_40566F
.text:00405666		       mov     dword ptr [esi+64h], 82h
.text:0040566D		       jmp     short loc_40568D
.text:0040566F ; ---------------------------------------------------------------------------
.text:0040566F
.text:0040566F loc_40566F:			       ; CODE XREF: __XcptFilter+112j
.text:0040566F		       cmp     eax, 0C000008Fh
.text:00405674		       jnz     short loc_40567F
.text:00405676		       mov     dword ptr [esi+64h], 86h
.text:0040567D		       jmp     short loc_40568D
.text:0040567F ; ---------------------------------------------------------------------------
.text:0040567F
.text:0040567F loc_40567F:			       ; CODE XREF: __XcptFilter+122j
.text:0040567F		       cmp     eax, 0C0000092h
.text:00405684		       jnz     short loc_40568D
.text:00405686		       mov     dword ptr [esi+64h], 8Ah
.text:0040568D
.text:0040568D loc_40568D:			       ; CODE XREF: __XcptFilter+DBj
.text:0040568D					       ; __XcptFilter+EBj ...
.text:0040568D		       push    dword ptr [esi+64h]
.text:00405690		       push    8
.text:00405692		       call    ebx
.text:00405694		       pop     ecx
.text:00405695		       mov     [esi+64h], edi
.text:00405698		       jmp     short loc_4056A1
.text:0040569A ; ---------------------------------------------------------------------------
.text:0040569A
.text:0040569A loc_40569A:			       ; CODE XREF: __XcptFilter+8Aj
.text:0040569A		       and     dword ptr [eax+8], 0
.text:0040569E		       push    ecx
.text:0040569F		       call    ebx
.text:004056A1
.text:004056A1 loc_4056A1:			       ; CODE XREF: __XcptFilter+146j
.text:004056A1		       mov     eax, [ebp+oldpxcptinfoptrs]
.text:004056A4		       pop     ecx
.text:004056A5		       mov     [esi+60h], eax
.text:004056A8
.text:004056A8 loc_4056A8:			       ; CODE XREF: __XcptFilter+72j
.text:004056A8		       or      eax, 0FFFFFFFFh
.text:004056AB
.text:004056AB loc_4056AB:			       ; CODE XREF: __XcptFilter+59j
.text:004056AB					       ; __XcptFilter+6Aj
.text:004056AB		       pop     ebx
.text:004056AC		       pop     edi
.text:004056AD
.text:004056AD loc_4056AD:			       ; CODE XREF: __XcptFilter+Fj
.text:004056AD		       pop     esi
.text:004056AE		       leave
.text:004056AF		       retn
.text:004056AF __XcptFilter    endp
.text:004056AF
.text:004056B0
.text:004056B0 ; =============== S U B R O U T I N E =======================================
.text:004056B0
.text:004056B0
.text:004056B0 ; int __cdecl __CppXcptFilter(unsigned int xcptnum, _EXCEPTION_POINTERS *pxcptinfoptrs)
.text:004056B0 ___CppXcptFilter	proc near
.text:004056B0
.text:004056B0 xcptnum	       = dword ptr  4
.text:004056B0 pxcptinfoptrs   = dword ptr  8
.text:004056B0
.text:004056B0		       mov     eax, 0E06D7363h
.text:004056B5		       cmp     [esp+xcptnum], eax
.text:004056B9		       jnz     short loc_4056C8
.text:004056BB		       push    [esp+pxcptinfoptrs] ; pxcptinfoptrs
.text:004056BF		       push    eax	       ; xcptnum
.text:004056C0		       call    __XcptFilter
.text:004056C5		       pop     ecx
.text:004056C6		       pop     ecx
.text:004056C7		       retn
.text:004056C8 ; ---------------------------------------------------------------------------
.text:004056C8
.text:004056C8 loc_4056C8:			       ; CODE XREF: ___CppXcptFilter+9j
.text:004056C8		       xor     eax, eax
.text:004056CA		       retn
.text:004056CA ___CppXcptFilter	endp
.text:004056CA
.text:004056CB
.text:004056CB ; =============== S U B R O U T I N E =======================================
.text:004056CB
.text:004056CB
.text:004056CB ; void __cdecl _initp_misc_winsig(void *enull)
.text:004056CB __initp_misc_winsig proc	near	       ; CODE XREF: __init_pointers+27p
.text:004056CB
.text:004056CB enull	       = dword ptr  4
.text:004056CB
.text:004056CB		       mov     eax, [esp+enull]
.text:004056CF		       mov     ctrlc_action, eax
.text:004056D4		       mov     ctrlbreak_action, eax
.text:004056D9		       mov     abort_action, eax
.text:004056DE		       mov     term_action, eax
.text:004056E3		       retn
.text:004056E3 __initp_misc_winsig endp
.text:004056E3
.text:004056E4
.text:004056E4 ; =============== S U B R O U T I N E =======================================
.text:004056E4
.text:004056E4 ; Attributes: noreturn bp-based frame
.text:004056E4
.text:004056E4 ; int __stdcall ctrlevent_capture(unsigned int CtrlType)
.text:004056E4 ctrlevent_capture proc near	       ; DATA XREF: _signal+112o
.text:004056E4
.text:004056E4 sigcode	       = dword ptr -20h
.text:004056E4 ctrl_action     = dword ptr -1Ch
.text:004056E4 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004056E4 CtrlType	       = dword ptr  8
.text:004056E4
.text:004056E4		       push    10h
.text:004056E6		       push    offset dword_421618
.text:004056EB		       call    __SEH_prolog4
.text:004056F0		       xor     edi, edi
.text:004056F2		       push    edi	       ; locknum
.text:004056F3		       call    __lock
.text:004056F8		       pop     ecx
.text:004056F9		       mov     [ebp+ms_exc.disabled], edi
.text:004056FC		       cmp     [ebp+CtrlType], edi
.text:004056FF		       jnz     short loc_40571D
.text:00405701		       mov     esi, offset ctrlc_action
.text:00405706		       push    ctrlc_action    ; codedptr
.text:0040570C		       call    __decode_pointer
.text:00405711		       mov     [ebp+ctrl_action], eax
.text:00405714		       mov     [ebp+sigcode], 2
.text:0040571B		       jmp     short loc_405737
.text:0040571D ; ---------------------------------------------------------------------------
.text:0040571D
.text:0040571D loc_40571D:			       ; CODE XREF: ctrlevent_capture+1Bj
.text:0040571D		       mov     esi, offset ctrlbreak_action
.text:00405722		       push    ctrlbreak_action	; codedptr
.text:00405728		       call    __decode_pointer
.text:0040572D		       mov     [ebp+ctrl_action], eax
.text:00405730		       mov     [ebp+sigcode], 15h
.text:00405737
.text:00405737 loc_405737:			       ; CODE XREF: ctrlevent_capture+37j
.text:00405737		       pop     ecx
.text:00405738		       cmp     eax, edi
.text:0040573A		       jz      short loc_405748
.text:0040573C		       cmp     eax, 1
.text:0040573F		       jz      short loc_405748
.text:00405741		       call    __encoded_null
.text:00405746		       mov     [esi], eax
.text:00405748
.text:00405748 loc_405748:			       ; CODE XREF: ctrlevent_capture+56j
.text:00405748					       ; ctrlevent_capture+5Bj
.text:00405748		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040574F		       call    $LN12_1
.text:00405754 ; ---------------------------------------------------------------------------
.text:00405754
.text:00405754 $LN13_1:
.text:00405754		       cmp     [ebp+ctrl_action], edi
.text:00405757		       jnz     short loc_405767
.text:00405759		       xor     eax, eax
.text:0040575B		       jmp     short loc_405777
.text:0040575D ; ---------------------------------------------------------------------------
.text:0040575D
.text:0040575D $LN10_1:				       ; DATA XREF: .rdata:00421630o
.text:0040575D		       xor     edi, edi
.text:0040575F
.text:0040575F $LN12_1:				       ; CODE XREF: ctrlevent_capture+6Bp
.text:0040575F		       push    edi	       ; locknum
.text:00405760		       call    __unlock
.text:00405765		       pop     ecx
.text:00405766
.text:00405766 $LN11_1:
.text:00405766		       retn
.text:00405767 ; ---------------------------------------------------------------------------
.text:00405767
.text:00405767 loc_405767:			       ; CODE XREF: ctrlevent_capture+73j
.text:00405767		       cmp     [ebp+ctrl_action], 1
.text:0040576B		       jz      short loc_405774
.text:0040576D		       push    [ebp+sigcode]
.text:00405770		       call    [ebp+ctrl_action]
.text:00405773		       pop     ecx
.text:00405774
.text:00405774 loc_405774:			       ; CODE XREF: ctrlevent_capture+87j
.text:00405774		       xor     eax, eax
.text:00405776		       inc     eax
.text:00405777
.text:00405777 loc_405777:			       ; CODE XREF: ctrlevent_capture+77j
.text:00405777		       call    __SEH_epilog4
.text:0040577C		       retn    4
.text:0040577C ctrlevent_capture endp ;	sp-analysis failed
.text:0040577C
.text:0040577F
.text:0040577F ; =============== S U B R O U T I N E =======================================
.text:0040577F
.text:0040577F
.text:0040577F ; _XCPT_ACTION *__usercall siglookup<eax>(int signum<edx>, _XCPT_ACTION *pxcptacttab)
.text:0040577F siglookup       proc near	       ; CODE XREF: _signal+AFp
.text:0040577F					       ; _raise+5Ap
.text:0040577F
.text:0040577F pxcptacttab     = dword ptr  4
.text:0040577F
.text:0040577F signum =	edx
.text:0040577F		       mov     eax, [esp+pxcptacttab]
.text:00405783		       mov     ecx, __XcptActTabCount
.text:00405789		       push    esi
.text:0040578A
.text:0040578A loc_40578A:			       ; CODE XREF: siglookup+1Ej
.text:0040578A		       cmp     [eax+4],	signum
.text:0040578D		       jz      short loc_40579F
.text:0040578F		       mov     esi, ecx
.text:00405791		       imul    esi, 0Ch
.text:00405794		       add     esi, [esp+4+pxcptacttab]
.text:00405798		       add     eax, 0Ch
.text:0040579B		       cmp     eax, esi
.text:0040579D		       jb      short loc_40578A
.text:0040579F
.text:0040579F loc_40579F:			       ; CODE XREF: siglookup+Ej
.text:0040579F		       imul    ecx, 0Ch
.text:004057A2		       add     ecx, [esp+4+pxcptacttab]
.text:004057A6		       pop     esi
.text:004057A7		       cmp     eax, ecx
.text:004057A9		       jnb     short loc_4057B0
.text:004057AB		       cmp     [eax+4],	signum
.text:004057AE		       jz      short locret_4057B2
.text:004057B0
.text:004057B0 loc_4057B0:			       ; CODE XREF: siglookup+2Aj
.text:004057B0		       xor     eax, eax
.text:004057B2
.text:004057B2 locret_4057B2:			       ; CODE XREF: siglookup+2Fj
.text:004057B2		       retn
.text:004057B2 siglookup       endp
.text:004057B2
.text:004057B3
.text:004057B3 ; =============== S U B R O U T I N E =======================================
.text:004057B3
.text:004057B3
.text:004057B3 ; void (__cdecl *__cdecl	__get_sigabrt())(int)
.text:004057B3 ___get_sigabrt  proc near	       ; CODE XREF: _abort:loc_40B33Dp
.text:004057B3		       push    abort_action    ; codedptr
.text:004057B9		       call    __decode_pointer
.text:004057BE		       pop     ecx
.text:004057BF		       retn
.text:004057BF ___get_sigabrt  endp
.text:004057BF
.text:004057C0
.text:004057C0 ; =============== S U B R O U T I N E =======================================
.text:004057C0
.text:004057C0
.text:004057C0 ; int *__cdecl __fpecode()
.text:004057C0 ___fpecode      proc near
.text:004057C0		       call    __getptd
.text:004057C5		       add     eax, 64h
.text:004057C8		       retn
.text:004057C8 ___fpecode      endp
.text:004057C8
.text:004057C9
.text:004057C9 ; =============== S U B R O U T I N E =======================================
.text:004057C9
.text:004057C9
.text:004057C9 ; void **__cdecl	__pxcptinfoptrs()
.text:004057C9 ___pxcptinfoptrs	proc near
.text:004057C9		       call    __getptd
.text:004057CE		       add     eax, 60h
.text:004057D1		       retn
.text:004057D1 ___pxcptinfoptrs	endp
.text:004057D1
.text:004057D2
.text:004057D2 ; =============== S U B R O U T I N E =======================================
.text:004057D2
.text:004057D2 ; Attributes: bp-based frame
.text:004057D2
.text:004057D2 ; void (__cdecl *__cdecl	signal(int signum, void	(__cdecl *sigact)(int)))(int)
.text:004057D2 _signal	       proc near
.text:004057D2
.text:004057D2 SetConsoleCtrlError= dword ptr -20h
.text:004057D2 oldsigact       = dword ptr -1Ch
.text:004057D2 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004057D2 signum	       = dword ptr  8
.text:004057D2 sigact	       = dword ptr  0Ch
.text:004057D2
.text:004057D2		       push    10h
.text:004057D4		       push    offset dword_421638
.text:004057D9		       call    __SEH_prolog4
.text:004057DE		       and     [ebp+SetConsoleCtrlError], 0
.text:004057E2		       mov     esi, [ebp+sigact]
.text:004057E5		       mov     ebx, [ebp+signum]
.text:004057E8		       cmp     esi, 4
.text:004057EB		       jz      sigreterror
.text:004057F1		       cmp     esi, 3
.text:004057F4		       jz      sigreterror
.text:004057FA		       push    2
.text:004057FC		       pop     edi
.text:004057FD		       cmp     ebx, edi
.text:004057FF		       jz      loc_4058C4
.text:00405805		       cmp     ebx, 15h
.text:00405808		       jz      loc_4058C4
.text:0040580E		       cmp     ebx, 16h
.text:00405811		       jz      loc_4058C4
.text:00405817		       cmp     ebx, 6
.text:0040581A		       jz      loc_4058C4
.text:00405820		       cmp     ebx, 0Fh
.text:00405823		       jz      loc_4058C4
.text:00405829		       cmp     ebx, 8
.text:0040582C		       jz      short loc_40583C
.text:0040582E		       cmp     ebx, 4
.text:00405831		       jz      short loc_40583C
.text:00405833		       cmp     ebx, 0Bh
.text:00405836		       jnz     sigreterror
.text:0040583C
.text:0040583C loc_40583C:			       ; CODE XREF: _signal+5Aj
.text:0040583C					       ; _signal+5Fj
.text:0040583C		       call    __getptd_noexit
.text:00405841		       mov     esi, eax
.text:00405843		       test    esi, esi
.text:00405845		       jz      sigreterror
.text:0040584B		       mov     edi, offset __XcptActTab
.text:00405850		       cmp     [esi+5Ch], edi
.text:00405853		       jnz     short loc_40587C
.text:00405855		       push    __XcptActTabSize	; cb
.text:0040585B		       call    __malloc_crt
.text:00405860		       pop     ecx
.text:00405861		       mov     [esi+5Ch], eax
.text:00405864		       test    eax, eax
.text:00405866		       jz      sigreterror
.text:0040586C		       push    __XcptActTabSize	; count
.text:00405872		       push    edi	       ; src
.text:00405873		       push    eax	       ; dst
.text:00405874		       call    _memcpy
.text:00405879		       add     esp, 0Ch
.text:0040587C
.text:0040587C loc_40587C:			       ; CODE XREF: _signal+81j
.text:0040587C		       push    dword ptr [esi+5Ch] ; pxcptacttab
.text:0040587F		       mov     edx, ebx	       ; signum
.text:00405881		       call    siglookup
.text:00405886		       pop     ecx
.text:00405887		       test    eax, eax
.text:00405889		       jz      sigreterror
.text:0040588F		       mov     edx, [eax+8]
.text:00405892		       mov     ecx, [ebp+sigact]
.text:00405895		       cmp     ecx, 2
.text:00405898		       jz      sigretok
.text:0040589E		       jmp     short loc_4058BA
.text:004058A0 ; ---------------------------------------------------------------------------
.text:004058A0
.text:004058A0 loc_4058A0:			       ; CODE XREF: _signal+EBj
.text:004058A0		       mov     [eax+8],	ecx
.text:004058A3		       add     eax, 0Ch
.text:004058A6		       mov     edi, __XcptActTabCount
.text:004058AC		       imul    edi, 0Ch
.text:004058AF		       add     edi, [esi+5Ch]
.text:004058B2		       cmp     eax, edi
.text:004058B4		       jnb     sigretok
.text:004058BA
.text:004058BA loc_4058BA:			       ; CODE XREF: _signal+CCj
.text:004058BA		       cmp     [eax+4],	ebx
.text:004058BD		       jz      short loc_4058A0
.text:004058BF		       jmp     sigretok
.text:004058C4 ; ---------------------------------------------------------------------------
.text:004058C4
.text:004058C4 loc_4058C4:			       ; CODE XREF: _signal+2Dj
.text:004058C4					       ; _signal+36j ...
.text:004058C4		       push    0	       ; locknum
.text:004058C6		       call    __lock
.text:004058CB		       pop     ecx
.text:004058CC		       and     [ebp+ms_exc.disabled], 0
.text:004058D0		       cmp     ebx, edi
.text:004058D2		       jz      short loc_4058D9
.text:004058D4		       cmp     ebx, 15h
.text:004058D7		       jnz     short loc_405917
.text:004058D9
.text:004058D9 loc_4058D9:			       ; CODE XREF: _signal+100j
.text:004058D9		       cmp     ConsoleCtrlHandler_Installed, 0
.text:004058E0		       jnz     short loc_405917
.text:004058E2		       push    1	       ; Add
.text:004058E4		       push    offset ctrlevent_capture	; HandlerRoutine
.text:004058E9		       call    ds:__imp__SetConsoleCtrlHandler@8 ; SetConsoleCtrlHandler(x,x)
.text:004058EF		       xor     ecx, ecx
.text:004058F1		       inc     ecx
.text:004058F2		       cmp     eax, ecx
.text:004058F4		       jnz     short loc_4058FE
.text:004058F6		       mov     ConsoleCtrlHandler_Installed, ecx
.text:004058FC		       jmp     short loc_405917
.text:004058FE ; ---------------------------------------------------------------------------
.text:004058FE
.text:004058FE loc_4058FE:			       ; CODE XREF: _signal+122j
.text:004058FE		       call    ___doserrno
.text:00405903		       mov     esi, eax
.text:00405905		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040590B		       mov     [esi], eax
.text:0040590D		       mov     [ebp+SetConsoleCtrlError], 1
.text:00405914		       mov     esi, [ebp+sigact]
.text:00405917
.text:00405917 loc_405917:			       ; CODE XREF: _signal+105j
.text:00405917					       ; _signal+10Ej ...
.text:00405917		       mov     eax, ebx
.text:00405919		       sub     eax, edi
.text:0040591B		       jz      short loc_40598F
.text:0040591D		       sub     eax, 4
.text:00405920		       jz      short loc_40592F
.text:00405922		       sub     eax, 9
.text:00405925		       jz      short loc_40596F
.text:00405927		       sub     eax, 6
.text:0040592A		       jz      short loc_40594F
.text:0040592C		       dec     eax
.text:0040592D		       jnz     short loc_4059AE
.text:0040592F
.text:0040592F loc_40592F:			       ; CODE XREF: _signal+14Ej
.text:0040592F		       push    abort_action    ; codedptr
.text:00405935		       call    __decode_pointer
.text:0040593A		       pop     ecx
.text:0040593B		       mov     [ebp+oldsigact],	eax
.text:0040593E		       cmp     esi, edi
.text:00405940		       jz      short loc_4059AE
.text:00405942		       push    esi	       ; ptr
.text:00405943		       call    __encode_pointer
.text:00405948		       mov     abort_action, eax
.text:0040594D		       jmp     short loc_4059AD
.text:0040594F ; ---------------------------------------------------------------------------
.text:0040594F
.text:0040594F loc_40594F:			       ; CODE XREF: _signal+158j
.text:0040594F		       push    ctrlbreak_action	; codedptr
.text:00405955		       call    __decode_pointer
.text:0040595A		       pop     ecx
.text:0040595B		       mov     [ebp+oldsigact],	eax
.text:0040595E		       cmp     esi, edi
.text:00405960		       jz      short loc_4059AE
.text:00405962		       push    esi	       ; ptr
.text:00405963		       call    __encode_pointer
.text:00405968		       mov     ctrlbreak_action, eax
.text:0040596D		       jmp     short loc_4059AD
.text:0040596F ; ---------------------------------------------------------------------------
.text:0040596F
.text:0040596F loc_40596F:			       ; CODE XREF: _signal+153j
.text:0040596F		       push    term_action     ; codedptr
.text:00405975		       call    __decode_pointer
.text:0040597A		       pop     ecx
.text:0040597B		       mov     [ebp+oldsigact],	eax
.text:0040597E		       cmp     esi, edi
.text:00405980		       jz      short loc_4059AE
.text:00405982		       push    esi	       ; ptr
.text:00405983		       call    __encode_pointer
.text:00405988		       mov     term_action, eax
.text:0040598D		       jmp     short loc_4059AD
.text:0040598F ; ---------------------------------------------------------------------------
.text:0040598F
.text:0040598F loc_40598F:			       ; CODE XREF: _signal+149j
.text:0040598F		       push    ctrlc_action    ; codedptr
.text:00405995		       call    __decode_pointer
.text:0040599A		       pop     ecx
.text:0040599B		       mov     [ebp+oldsigact],	eax
.text:0040599E		       cmp     esi, edi
.text:004059A0		       jz      short loc_4059AE
.text:004059A2		       push    esi	       ; ptr
.text:004059A3		       call    __encode_pointer
.text:004059A8		       mov     ctrlc_action, eax
.text:004059AD
.text:004059AD loc_4059AD:			       ; CODE XREF: _signal+17Bj
.text:004059AD					       ; _signal+19Bj ...
.text:004059AD		       pop     ecx
.text:004059AE
.text:004059AE loc_4059AE:			       ; CODE XREF: _signal+15Bj
.text:004059AE					       ; _signal+16Ej ...
.text:004059AE		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004059B5		       call    $LN43
.text:004059BA
.text:004059BA $LN44:
.text:004059BA		       cmp     [ebp+SetConsoleCtrlError], 0
.text:004059BE		       jnz     short sigreterror
.text:004059C0		       mov     edx, [ebp+oldsigact]
.text:004059C3
.text:004059C3 sigretok:			       ; CODE XREF: _signal+C6j
.text:004059C3					       ; _signal+E2j ...
.text:004059C3		       mov     eax, edx
.text:004059C5		       jmp     short loc_405A09
.text:004059C7 ; ---------------------------------------------------------------------------
.text:004059C7
.text:004059C7 $LN41:				       ; DATA XREF: .rdata:00421650o
.text:004059C7		       mov     ebx, [ebp+signum]
.text:004059CA
.text:004059CA $LN43:				       ; CODE XREF: _signal+1E3p
.text:004059CA		       push    0	       ; locknum
.text:004059CC		       call    __unlock
.text:004059D1		       pop     ecx
.text:004059D2
.text:004059D2 $LN42:
.text:004059D2		       retn
.text:004059D3 ; ---------------------------------------------------------------------------
.text:004059D3
.text:004059D3 sigreterror:			       ; CODE XREF: _signal+19j
.text:004059D3					       ; _signal+22j ...
.text:004059D3		       cmp     ebx, 1
.text:004059D6		       jz      short loc_405A06
.text:004059D8		       cmp     ebx, 3
.text:004059DB		       jz      short loc_405A06
.text:004059DD		       cmp     ebx, 0Dh
.text:004059E0		       jz      short loc_405A06
.text:004059E2		       cmp     ebx, 0Fh
.text:004059E5		       jle     short loc_4059EC
.text:004059E7		       cmp     ebx, 11h
.text:004059EA		       jle     short loc_405A06
.text:004059EC
.text:004059EC loc_4059EC:			       ; CODE XREF: _signal+213j
.text:004059EC		       call    __errno
.text:004059F1		       mov     dword ptr [eax],	16h
.text:004059F7		       xor     eax, eax
.text:004059F9		       push    eax	       ; pReserved
.text:004059FA		       push    eax	       ; nLine
.text:004059FB		       push    eax	       ; pszFile
.text:004059FC		       push    eax	       ; pszFunction
.text:004059FD		       push    eax	       ; pszExpression
.text:004059FE		       call    __invalid_parameter
.text:00405A03		       add     esp, 14h
.text:00405A06
.text:00405A06 loc_405A06:			       ; CODE XREF: _signal+204j
.text:00405A06					       ; _signal+209j ...
.text:00405A06		       or      eax, 0FFFFFFFFh
.text:00405A09
.text:00405A09 loc_405A09:			       ; CODE XREF: _signal+1F3j
.text:00405A09		       call    __SEH_epilog4
.text:00405A0E		       retn
.text:00405A0E _signal	       endp ; sp-analysis failed
.text:00405A0E
.text:00405A0F
.text:00405A0F ; =============== S U B R O U T I N E =======================================
.text:00405A0F
.text:00405A0F ; Attributes: bp-based frame
.text:00405A0F
.text:00405A0F ; int __cdecl raise(int signum)
.text:00405A0F _raise	       proc near	       ; CODE XREF: _abort+38p
.text:00405A0F
.text:00405A0F oldfpecode      = dword ptr -30h
.text:00405A0F oldpxcptinfoptrs= dword ptr -2Ch
.text:00405A0F ptd	       = dword ptr -28h
.text:00405A0F indx	       = dword ptr -24h
.text:00405A0F sigact	       = dword ptr -20h
.text:00405A0F siglock	       = dword ptr -1Ch
.text:00405A0F ms_exc	       = CPPEH_RECORD ptr -18h
.text:00405A0F signum	       = dword ptr  8
.text:00405A0F
.text:00405A0F		       push    20h
.text:00405A11		       push    offset dword_421658
.text:00405A16		       call    __SEH_prolog4
.text:00405A1B		       xor     edi, edi
.text:00405A1D		       mov     [ebp+siglock], edi
.text:00405A20		       mov     [ebp+ptd], edi
.text:00405A23		       mov     ebx, [ebp+signum]
.text:00405A26		       cmp     ebx, 0Bh
.text:00405A29		       jg      short loc_405A77
.text:00405A2B		       jz      short loc_405A42
.text:00405A2D		       mov     eax, ebx
.text:00405A2F		       push    2
.text:00405A31		       pop     ecx
.text:00405A32		       sub     eax, ecx
.text:00405A34		       jz      short loc_405A58
.text:00405A36		       sub     eax, ecx
.text:00405A38		       jz      short loc_405A42
.text:00405A3A		       sub     eax, ecx
.text:00405A3C		       jz      short loc_405AA2
.text:00405A3E		       sub     eax, ecx
.text:00405A40		       jnz     short loc_405A86
.text:00405A42
.text:00405A42 loc_405A42:			       ; CODE XREF: _raise+1Cj
.text:00405A42					       ; _raise+29j
.text:00405A42		       call    __getptd_noexit
.text:00405A47		       mov     edi, eax
.text:00405A49		       mov     [ebp+ptd], edi
.text:00405A4C		       test    edi, edi
.text:00405A4E		       jnz     short loc_405A64
.text:00405A50
.text:00405A50 loc_405A50:			       ; CODE XREF: _raise+91j
.text:00405A50		       or      eax, 0FFFFFFFFh
.text:00405A53		       jmp     loc_405BB9
.text:00405A58 ; ---------------------------------------------------------------------------
.text:00405A58
.text:00405A58 loc_405A58:			       ; CODE XREF: _raise+25j
.text:00405A58		       mov     esi, offset ctrlc_action
.text:00405A5D		       mov     eax, ctrlc_action
.text:00405A62		       jmp     short loc_405AC4
.text:00405A64 ; ---------------------------------------------------------------------------
.text:00405A64
.text:00405A64 loc_405A64:			       ; CODE XREF: _raise+3Fj
.text:00405A64		       push    dword ptr [edi+5Ch] ; pxcptacttab
.text:00405A67		       mov     edx, ebx	       ; signum
.text:00405A69		       call    siglookup
.text:00405A6E		       mov     esi, eax
.text:00405A70		       add     esi, 8
.text:00405A73		       mov     eax, [esi]
.text:00405A75		       jmp     short loc_405AD1
.text:00405A77 ; ---------------------------------------------------------------------------
.text:00405A77
.text:00405A77 loc_405A77:			       ; CODE XREF: _raise+1Aj
.text:00405A77		       mov     eax, ebx
.text:00405A79		       sub     eax, 0Fh
.text:00405A7C		       jz      short loc_405ABA
.text:00405A7E		       sub     eax, 6
.text:00405A81		       jz      short loc_405AAE
.text:00405A83		       dec     eax
.text:00405A84		       jz      short loc_405AA2
.text:00405A86
.text:00405A86 loc_405A86:			       ; CODE XREF: _raise+31j
.text:00405A86		       call    __errno
.text:00405A8B		       mov     dword ptr [eax],	16h
.text:00405A91		       xor     eax, eax
.text:00405A93		       push    eax	       ; pReserved
.text:00405A94		       push    eax	       ; nLine
.text:00405A95		       push    eax	       ; pszFile
.text:00405A96		       push    eax	       ; pszFunction
.text:00405A97		       push    eax	       ; pszExpression
.text:00405A98		       call    __invalid_parameter
.text:00405A9D		       add     esp, 14h
.text:00405AA0		       jmp     short loc_405A50
.text:00405AA2 ; ---------------------------------------------------------------------------
.text:00405AA2
.text:00405AA2 loc_405AA2:			       ; CODE XREF: _raise+2Dj
.text:00405AA2					       ; _raise+75j
.text:00405AA2		       mov     esi, offset abort_action
.text:00405AA7		       mov     eax, abort_action
.text:00405AAC		       jmp     short loc_405AC4
.text:00405AAE ; ---------------------------------------------------------------------------
.text:00405AAE
.text:00405AAE loc_405AAE:			       ; CODE XREF: _raise+72j
.text:00405AAE		       mov     esi, offset ctrlbreak_action
.text:00405AB3		       mov     eax, ctrlbreak_action
.text:00405AB8		       jmp     short loc_405AC4
.text:00405ABA ; ---------------------------------------------------------------------------
.text:00405ABA
.text:00405ABA loc_405ABA:			       ; CODE XREF: _raise+6Dj
.text:00405ABA		       mov     esi, offset term_action
.text:00405ABF		       mov     eax, term_action
.text:00405AC4
.text:00405AC4 loc_405AC4:			       ; CODE XREF: _raise+53j
.text:00405AC4					       ; _raise+9Dj ...
.text:00405AC4		       mov     [ebp+siglock], 1
.text:00405ACB		       push    eax	       ; codedptr
.text:00405ACC		       call    __decode_pointer
.text:00405AD1
.text:00405AD1 loc_405AD1:			       ; CODE XREF: _raise+66j
.text:00405AD1		       mov     [ebp+sigact], eax
.text:00405AD4		       pop     ecx
.text:00405AD5
.text:00405AD5 decode_done:
.text:00405AD5		       xor     eax, eax
.text:00405AD7		       cmp     [ebp+sigact], 1
.text:00405ADB		       jz      loc_405BB9
.text:00405AE1		       cmp     [ebp+sigact], eax
.text:00405AE4		       jnz     short $LN51
.text:00405AE6		       push    3	       ; code
.text:00405AE8		       call    __exit
.text:00405AED ; ---------------------------------------------------------------------------
.text:00405AED
.text:00405AED $LN51:				       ; CODE XREF: _raise+D5j
.text:00405AED		       cmp     [ebp+siglock], eax
.text:00405AF0		       jz      short loc_405AF9
.text:00405AF2		       push    eax	       ; locknum
.text:00405AF3		       call    __lock
.text:00405AF8		       pop     ecx
.text:00405AF9
.text:00405AF9 loc_405AF9:			       ; CODE XREF: _raise+E1j
.text:00405AF9		       xor     eax, eax
.text:00405AFB		       mov     [ebp+ms_exc.disabled], eax
.text:00405AFE		       cmp     ebx, 8
.text:00405B01		       jz      short loc_405B0D
.text:00405B03		       cmp     ebx, 0Bh
.text:00405B06		       jz      short loc_405B0D
.text:00405B08		       cmp     ebx, 4
.text:00405B0B		       jnz     short loc_405B28
.text:00405B0D
.text:00405B0D loc_405B0D:			       ; CODE XREF: _raise+F2j
.text:00405B0D					       ; _raise+F7j
.text:00405B0D		       mov     ecx, [edi+60h]
.text:00405B10		       mov     [ebp+oldpxcptinfoptrs], ecx
.text:00405B13		       mov     [edi+60h], eax
.text:00405B16		       cmp     ebx, 8
.text:00405B19		       jnz     short loc_405B5B
.text:00405B1B		       mov     ecx, [edi+64h]
.text:00405B1E		       mov     [ebp+oldfpecode], ecx
.text:00405B21		       mov     dword ptr [edi+64h], 8Ch
.text:00405B28
.text:00405B28 loc_405B28:			       ; CODE XREF: _raise+FCj
.text:00405B28		       cmp     ebx, 8
.text:00405B2B		       jnz     short loc_405B5B
.text:00405B2D		       mov     ecx, __First_FPE_Indx
.text:00405B33		       mov     [ebp+indx], ecx
.text:00405B36
.text:00405B36 loc_405B36:			       ; CODE XREF: _raise+14Aj
.text:00405B36		       mov     ecx, __Num_FPE
.text:00405B3C		       mov     edx, __First_FPE_Indx
.text:00405B42		       add     ecx, edx
.text:00405B44		       cmp     [ebp+indx], ecx
.text:00405B47		       jge     short loc_405B62
.text:00405B49		       mov     ecx, [ebp+indx]
.text:00405B4C		       imul    ecx, 0Ch
.text:00405B4F		       mov     edx, [edi+5Ch]
.text:00405B52		       mov     [ecx+edx+8], eax
.text:00405B56		       inc     [ebp+indx]
.text:00405B59		       jmp     short loc_405B36
.text:00405B5B ; ---------------------------------------------------------------------------
.text:00405B5B
.text:00405B5B loc_405B5B:			       ; CODE XREF: _raise+10Aj
.text:00405B5B					       ; _raise+11Cj
.text:00405B5B		       call    __encoded_null
.text:00405B60		       mov     [esi], eax
.text:00405B62
.text:00405B62 loc_405B62:			       ; CODE XREF: _raise+138j
.text:00405B62		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00405B69		       call    $LN37
.text:00405B6E
.text:00405B6E $LN38:
.text:00405B6E		       cmp     ebx, 8
.text:00405B71		       jnz     short loc_405B92
.text:00405B73		       push    dword ptr [edi+64h]
.text:00405B76		       push    ebx
.text:00405B77		       call    [ebp+sigact]
.text:00405B7A		       pop     ecx
.text:00405B7B		       jmp     short loc_405B96
.text:00405B7D ; ---------------------------------------------------------------------------
.text:00405B7D
.text:00405B7D $LN35_0:				       ; DATA XREF: .rdata:00421670o
.text:00405B7D		       mov     ebx, [ebp+signum]
.text:00405B80		       mov     edi, [ebp+ptd]
.text:00405B83
.text:00405B83 $LN37:				       ; CODE XREF: _raise+15Ap
.text:00405B83		       cmp     [ebp+siglock], 0
.text:00405B87		       jz      short $LN36_0
.text:00405B89		       push    0	       ; locknum
.text:00405B8B		       call    __unlock
.text:00405B90		       pop     ecx
.text:00405B91
.text:00405B91 $LN36_0:				       ; CODE XREF: _raise+178j
.text:00405B91		       retn
.text:00405B92 ; ---------------------------------------------------------------------------
.text:00405B92
.text:00405B92 loc_405B92:			       ; CODE XREF: _raise+162j
.text:00405B92		       push    ebx
.text:00405B93		       call    [ebp+sigact]
.text:00405B96
.text:00405B96 loc_405B96:			       ; CODE XREF: _raise+16Cj
.text:00405B96		       pop     ecx
.text:00405B97		       cmp     ebx, 8
.text:00405B9A		       jz      short loc_405BA6
.text:00405B9C		       cmp     ebx, 0Bh
.text:00405B9F		       jz      short loc_405BA6
.text:00405BA1		       cmp     ebx, 4
.text:00405BA4		       jnz     short loc_405BB7
.text:00405BA6
.text:00405BA6 loc_405BA6:			       ; CODE XREF: _raise+18Bj
.text:00405BA6					       ; _raise+190j
.text:00405BA6		       mov     eax, [ebp+oldpxcptinfoptrs]
.text:00405BA9		       mov     [edi+60h], eax
.text:00405BAC		       cmp     ebx, 8
.text:00405BAF		       jnz     short loc_405BB7
.text:00405BB1		       mov     eax, [ebp+oldfpecode]
.text:00405BB4		       mov     [edi+64h], eax
.text:00405BB7
.text:00405BB7 loc_405BB7:			       ; CODE XREF: _raise+195j
.text:00405BB7					       ; _raise+1A0j
.text:00405BB7		       xor     eax, eax
.text:00405BB9
.text:00405BB9 loc_405BB9:			       ; CODE XREF: _raise+44j
.text:00405BB9					       ; _raise+CCj
.text:00405BB9		       call    __SEH_epilog4
.text:00405BBE		       retn
.text:00405BBE _raise	       endp ; sp-analysis failed
.text:00405BBE
.text:00405BBF
.text:00405BBF ; =============== S U B R O U T I N E =======================================
.text:00405BBF
.text:00405BBF
.text:00405BBF ; void __cdecl _initp_misc_rand_s(void *enull)
.text:00405BBF __initp_misc_rand_s proc	near	       ; CODE XREF: __init_pointers+21p
.text:00405BBF
.text:00405BBF enull	       = dword ptr  4
.text:00405BBF
.text:00405BBF		       mov     eax, [esp+enull]
.text:00405BC3		       mov     g_pfnRtlGenRandom, eax
.text:00405BC8		       retn
.text:00405BC8 __initp_misc_rand_s endp
.text:00405BC8
.text:00405BC9
.text:00405BC9 ; =============== S U B R O U T I N E =======================================
.text:00405BC9
.text:00405BC9
.text:00405BC9 ; int __cdecl rand_s(unsigned int *_RandomValue)
.text:00405BC9 _rand_s	       proc near
.text:00405BC9
.text:00405BC9 enull	       = dword ptr  4
.text:00405BC9
.text:00405BC9		       push    ebp
.text:00405BCA		       push    esi
.text:00405BCB		       push    edi
.text:00405BCC		       push    g_pfnRtlGenRandom ; codedptr
.text:00405BD2		       call    __decode_pointer
.text:00405BD7		       mov     ebp, [esp+10h+enull]
.text:00405BDB		       xor     esi, esi
.text:00405BDD		       cmp     ebp, esi
.text:00405BDF		       pop     ecx
.text:00405BE0		       mov     edi, eax
.text:00405BE2		       jnz     short loc_405C02
.text:00405BE4		       call    __errno
.text:00405BE9		       push    16h
.text:00405BEB		       pop     edi
.text:00405BEC		       push    esi	       ; pReserved
.text:00405BED		       push    esi	       ; nLine
.text:00405BEE		       push    esi	       ; pszFile
.text:00405BEF		       push    esi	       ; pszFunction
.text:00405BF0		       push    esi	       ; pszExpression
.text:00405BF1		       mov     [eax], edi
.text:00405BF3		       call    __invalid_parameter
.text:00405BF8		       add     esp, 14h
.text:00405BFB		       mov     eax, edi
.text:00405BFD		       jmp     loc_405CC9
.text:00405C02 ; ---------------------------------------------------------------------------
.text:00405C02
.text:00405C02 loc_405C02:			       ; CODE XREF: _rand_s+19j
.text:00405C02		       cmp     edi, esi
.text:00405C04		       push    ebx
.text:00405C05		       mov     [ebp+0],	esi
.text:00405C08		       jnz     loc_405CA9
.text:00405C0E		       push    offset LibFileName ; "ADVAPI32.DLL"
.text:00405C13		       call    ds:__imp__LoadLibraryA@4	; LoadLibraryA(x)
.text:00405C19		       mov     ebx, eax
.text:00405C1B		       cmp     ebx, esi
.text:00405C1D		       jnz     short loc_405C3D
.text:00405C1F		       call    __errno
.text:00405C24		       push    16h
.text:00405C26		       pop     edi
.text:00405C27		       push    esi	       ; pReserved
.text:00405C28		       push    esi	       ; nLine
.text:00405C29		       push    esi	       ; pszFile
.text:00405C2A		       push    esi	       ; pszFunction
.text:00405C2B		       push    esi	       ; pszExpression
.text:00405C2C		       mov     [eax], edi
.text:00405C2E		       call    __invalid_parameter
.text:00405C33		       add     esp, 14h
.text:00405C36		       mov     eax, edi
.text:00405C38		       jmp     loc_405CC8
.text:00405C3D ; ---------------------------------------------------------------------------
.text:00405C3D
.text:00405C3D loc_405C3D:			       ; CODE XREF: _rand_s+54j
.text:00405C3D		       push    offset aSystemfunction ;	"SystemFunction036"
.text:00405C42		       push    ebx	       ; hModule
.text:00405C43		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00405C49		       mov     edi, eax
.text:00405C4B		       cmp     edi, esi
.text:00405C4D		       jnz     short loc_405C7E
.text:00405C4F		       call    __errno
.text:00405C54		       mov     edi, ds:__imp__GetLastError@0 ; GetLastError()
.text:00405C5A		       mov     ebx, eax
.text:00405C5C		       call    edi ; GetLastError() ; GetLastError()
.text:00405C5E		       push    eax	       ; oserrno
.text:00405C5F		       call    __get_errno_from_oserr
.text:00405C64		       push    esi	       ; pReserved
.text:00405C65		       push    esi	       ; nLine
.text:00405C66		       push    esi	       ; pszFile
.text:00405C67		       push    esi	       ; pszFunction
.text:00405C68		       push    esi	       ; pszExpression
.text:00405C69		       mov     [ebx], eax
.text:00405C6B		       call    __invalid_parameter
.text:00405C70		       add     esp, 18h
.text:00405C73		       call    edi ; GetLastError() ; GetLastError()
.text:00405C75		       push    eax	       ; oserrno
.text:00405C76		       call    __get_errno_from_oserr
.text:00405C7B		       pop     ecx
.text:00405C7C		       jmp     short loc_405CC8
.text:00405C7E ; ---------------------------------------------------------------------------
.text:00405C7E
.text:00405C7E loc_405C7E:			       ; CODE XREF: _rand_s+84j
.text:00405C7E		       push    edi	       ; ptr
.text:00405C7F		       call    __encode_pointer
.text:00405C84		       pop     ecx
.text:00405C85		       mov     esi, eax
.text:00405C87		       call    __encoded_null
.text:00405C8C		       push    esi	       ; Value
.text:00405C8D		       push    offset g_pfnRtlGenRandom	; Target
.text:00405C92		       mov     [esp+18h+enull],	eax
.text:00405C96		       call    ds:__imp__InterlockedExchange@8 ; InterlockedExchange(x,x)
.text:00405C9C		       cmp     eax, [esp+10h+enull]
.text:00405CA0		       jz      short loc_405CA9
.text:00405CA2		       push    ebx	       ; hLibModule
.text:00405CA3		       call    ds:__imp__FreeLibrary@4 ; FreeLibrary(x)
.text:00405CA9
.text:00405CA9 loc_405CA9:			       ; CODE XREF: _rand_s+3Fj
.text:00405CA9					       ; _rand_s+D7j
.text:00405CA9		       push    4
.text:00405CAB		       push    ebp
.text:00405CAC		       call    edi
.text:00405CAE		       test    eax, eax
.text:00405CB0		       jnz     short loc_405CC6
.text:00405CB2		       call    __errno
.text:00405CB7		       mov     dword ptr [eax],	0Ch
.text:00405CBD		       call    __errno
.text:00405CC2		       mov     eax, [eax]
.text:00405CC4		       jmp     short loc_405CC8
.text:00405CC6 ; ---------------------------------------------------------------------------
.text:00405CC6
.text:00405CC6 loc_405CC6:			       ; CODE XREF: _rand_s+E7j
.text:00405CC6		       xor     eax, eax
.text:00405CC8
.text:00405CC8 loc_405CC8:			       ; CODE XREF: _rand_s+6Fj
.text:00405CC8					       ; _rand_s+B3j ...
.text:00405CC8		       pop     ebx
.text:00405CC9
.text:00405CC9 loc_405CC9:			       ; CODE XREF: _rand_s+34j
.text:00405CC9		       pop     edi
.text:00405CCA		       pop     esi
.text:00405CCB		       pop     ebp
.text:00405CCC		       retn
.text:00405CCC _rand_s	       endp
.text:00405CCC
.text:00405CCD
.text:00405CCD ; =============== S U B R O U T I N E =======================================
.text:00405CCD
.text:00405CCD ; Attributes: bp-based frame fpd=64h
.text:00405CCD
.text:00405CCD ; int __cdecl __getlocaleinfo(localeinfo_struct *plocinfo, int lc_type, unsigned	int localehandle, unsigned int fieldtype, void *address)
.text:00405CCD ___getlocaleinfo	proc near	       ; CODE XREF: _get_lc_time+35p
.text:00405CCD					       ; _get_lc_time+4Ap ...
.text:00405CCD
.text:00405CCD var_94	       = dword ptr -94h
.text:00405CCD buffersize      = dword ptr -90h
.text:00405CCD var_8C	       = dword ptr -8Ch
.text:00405CCD bufferused      = dword ptr -88h
.text:00405CCD cbuffer	       = byte ptr -84h
.text:00405CCD var_4	       = dword ptr -4
.text:00405CCD plocinfo	       = dword ptr  8
.text:00405CCD lc_type	       = dword ptr  0Ch
.text:00405CCD localehandle    = dword ptr  10h
.text:00405CCD fieldtype       = dword ptr  14h
.text:00405CCD address	       = dword ptr  18h
.text:00405CCD
.text:00405CCD		       push    ebp
.text:00405CCE		       lea     ebp, [esp-64h]
.text:00405CD2		       sub     esp, 94h
.text:00405CD8		       mov     eax, ___security_cookie
.text:00405CDD		       xor     eax, ebp
.text:00405CDF		       mov     [ebp+64h+var_4],	eax
.text:00405CE2		       mov     eax, [ebp+64h+plocinfo]
.text:00405CE5		       push    ebx
.text:00405CE6		       push    esi
.text:00405CE7		       mov     esi, [ebp+64h+address]
.text:00405CEA		       xor     ebx, ebx
.text:00405CEC		       cmp     [ebp+64h+lc_type], 1
.text:00405CF0		       push    edi
.text:00405CF1		       mov     [ebp+64h+var_8C], eax
.text:00405CF4		       mov     [ebp+64h+var_94], esi
.text:00405CF7		       jnz     loc_405DDC
.text:00405CFD		       push    ebx	       ; code_page
.text:00405CFE		       push    80h	       ; cchData
.text:00405D03		       lea     edi, [ebp+64h+cbuffer]
.text:00405D06		       mov     ecx, edi
.text:00405D08		       push    ecx	       ; lpLCData
.text:00405D09		       push    [ebp+64h+fieldtype] ; LCType
.text:00405D0C		       mov     [ebp+64h+bufferused], ebx
.text:00405D0F		       push    [ebp+64h+localehandle] ;	Locale
.text:00405D12		       push    eax	       ; plocinfo
.text:00405D13		       call    ___crtGetLocaleInfoA
.text:00405D18		       mov     esi, eax
.text:00405D1A		       add     esp, 18h
.text:00405D1D		       cmp     esi, ebx
.text:00405D1F		       jnz     short loc_405D78
.text:00405D21		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00405D27		       cmp     eax, 7Ah
.text:00405D2A		       jnz     short loc_405D97
.text:00405D2C		       push    ebx	       ; code_page
.text:00405D2D		       push    ebx	       ; cchData
.text:00405D2E		       push    ebx	       ; lpLCData
.text:00405D2F		       push    [ebp+64h+fieldtype] ; LCType
.text:00405D32		       push    [ebp+64h+localehandle] ;	Locale
.text:00405D35		       push    [ebp+64h+var_8C]	; plocinfo
.text:00405D38		       call    ___crtGetLocaleInfoA
.text:00405D3D		       add     esp, 18h
.text:00405D40		       cmp     eax, ebx
.text:00405D42		       mov     [ebp+64h+buffersize], eax
.text:00405D45		       jz      short loc_405D97
.text:00405D47		       xor     esi, esi
.text:00405D49		       inc     esi
.text:00405D4A		       push    esi	       ; size
.text:00405D4B		       push    eax	       ; count
.text:00405D4C		       call    __calloc_crt
.text:00405D51		       mov     edi, eax
.text:00405D53		       cmp     edi, ebx
.text:00405D55		       pop     ecx
.text:00405D56		       pop     ecx
.text:00405D57		       jz      short loc_405D97
.text:00405D59		       push    ebx	       ; code_page
.text:00405D5A		       push    [ebp+64h+buffersize] ; cchData
.text:00405D5D		       mov     [ebp+64h+bufferused], esi
.text:00405D60		       push    edi	       ; lpLCData
.text:00405D61		       push    [ebp+64h+fieldtype] ; LCType
.text:00405D64		       push    [ebp+64h+localehandle] ;	Locale
.text:00405D67		       push    [ebp+64h+var_8C]	; plocinfo
.text:00405D6A		       call    ___crtGetLocaleInfoA
.text:00405D6F		       mov     esi, eax
.text:00405D71		       add     esp, 18h
.text:00405D74		       cmp     esi, ebx
.text:00405D76		       jz      short loc_405D90
.text:00405D78
.text:00405D78 loc_405D78:			       ; CODE XREF: ___getlocaleinfo+52j
.text:00405D78		       push    1	       ; size
.text:00405D7A		       push    esi	       ; count
.text:00405D7B		       call    __calloc_crt
.text:00405D80		       cmp     eax, ebx
.text:00405D82		       pop     ecx
.text:00405D83		       pop     ecx
.text:00405D84		       mov     ecx, [ebp+64h+var_94]
.text:00405D87		       mov     [ecx], eax
.text:00405D89		       jnz     short loc_405DAC
.text:00405D8B
.text:00405D8B error:
.text:00405D8B		       cmp     [ebp+64h+bufferused], ebx
.text:00405D8E		       jz      short loc_405D97
.text:00405D90
.text:00405D90 loc_405D90:			       ; CODE XREF: ___getlocaleinfo+A9j
.text:00405D90		       push    edi	       ; pBlock
.text:00405D91		       call    _free
.text:00405D96		       pop     ecx
.text:00405D97
.text:00405D97 loc_405D97:			       ; CODE XREF: ___getlocaleinfo+5Dj
.text:00405D97					       ; ___getlocaleinfo+78j ...
.text:00405D97		       or      eax, 0FFFFFFFFh
.text:00405D9A
.text:00405D9A loc_405D9A:			       ; CODE XREF: ___getlocaleinfo+10Dj
.text:00405D9A		       mov     ecx, [ebp+64h+var_4]
.text:00405D9D		       pop     edi
.text:00405D9E		       pop     esi
.text:00405D9F		       xor     ecx, ebp
.text:00405DA1		       pop     ebx
.text:00405DA2		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00405DA7		       add     ebp, 64h
.text:00405DAA		       leave
.text:00405DAB		       retn
.text:00405DAC ; ---------------------------------------------------------------------------
.text:00405DAC
.text:00405DAC loc_405DAC:			       ; CODE XREF: ___getlocaleinfo+BCj
.text:00405DAC		       lea     ecx, [esi-1]
.text:00405DAF		       push    ecx	       ; _Count
.text:00405DB0		       push    edi	       ; _Src
.text:00405DB1		       push    esi	       ; _SizeInBytes
.text:00405DB2		       push    eax	       ; _Dst
.text:00405DB3		       call    _strncpy_s
.text:00405DB8		       add     esp, 10h
.text:00405DBB		       test    eax, eax
.text:00405DBD		       jz      short loc_405DCC
.text:00405DBF		       push    ebx	       ; pReserved
.text:00405DC0		       push    ebx	       ; nLine
.text:00405DC1		       push    ebx	       ; pszFile
.text:00405DC2		       push    ebx	       ; pszFunction
.text:00405DC3		       push    ebx	       ; pszExpression
.text:00405DC4		       call    __invoke_watson
.text:00405DC9		       add     esp, 14h
.text:00405DCC
.text:00405DCC loc_405DCC:			       ; CODE XREF: ___getlocaleinfo+F0j
.text:00405DCC		       cmp     [ebp+64h+bufferused], ebx
.text:00405DCF		       jz      short loc_405DD8
.text:00405DD1		       push    edi	       ; pBlock
.text:00405DD2		       call    _free
.text:00405DD7		       pop     ecx
.text:00405DD8
.text:00405DD8 loc_405DD8:			       ; CODE XREF: ___getlocaleinfo+102j
.text:00405DD8					       ; ___getlocaleinfo+140j	...
.text:00405DD8		       xor     eax, eax
.text:00405DDA		       jmp     short loc_405D9A
.text:00405DDC ; ---------------------------------------------------------------------------
.text:00405DDC
.text:00405DDC loc_405DDC:			       ; CODE XREF: ___getlocaleinfo+2Aj
.text:00405DDC		       cmp     [ebp+64h+lc_type], ebx
.text:00405DDF		       jnz     short loc_405D97
.text:00405DE1		       push    ebx	       ; code_page
.text:00405DE2		       push    4	       ; cchData
.text:00405DE4		       mov     edi, offset wcbuffer
.text:00405DE9		       push    edi	       ; lpLCData
.text:00405DEA		       push    [ebp+64h+fieldtype] ; LCType
.text:00405DED		       push    [ebp+64h+localehandle] ;	Locale
.text:00405DF0		       push    eax	       ; plocinfo
.text:00405DF1		       call    ___crtGetLocaleInfoW
.text:00405DF6		       add     esp, 18h
.text:00405DF9		       test    eax, eax
.text:00405DFB		       jz      short loc_405D97
.text:00405DFD		       mov     [esi], bl
.text:00405DFF
.text:00405DFF loc_405DFF:			       ; CODE XREF: ___getlocaleinfo+156j
.text:00405DFF		       mov     bl, [edi]
.text:00405E01		       movzx   eax, bl
.text:00405E04		       push    eax	       ; c
.text:00405E05		       call    _isdigit
.text:00405E0A		       test    eax, eax
.text:00405E0C		       pop     ecx
.text:00405E0D		       jz      short loc_405DD8
.text:00405E0F		       mov     al, [esi]
.text:00405E11		       mov     cl, 0Ah
.text:00405E13		       imul    cl
.text:00405E15		       add     al, bl
.text:00405E17		       sub     al, 30h
.text:00405E19		       inc     edi
.text:00405E1A		       inc     edi
.text:00405E1B		       cmp     edi, offset ___pPurecall
.text:00405E21		       mov     [esi], al
.text:00405E23		       jl      short loc_405DFF
.text:00405E25		       jmp     short loc_405DD8
.text:00405E25 ___getlocaleinfo	endp
.text:00405E25
.text:00405E27
.text:00405E27 ; =============== S U B R O U T I N E =======================================
.text:00405E27
.text:00405E27
.text:00405E27 ; void __cdecl _initp_misc_purevirt(void	*enull)
.text:00405E27 __initp_misc_purevirt proc near	       ; CODE XREF: __init_pointers+1Bp
.text:00405E27
.text:00405E27 enull	       = dword ptr  4
.text:00405E27
.text:00405E27		       mov     eax, [esp+enull]
.text:00405E2B		       mov     ___pPurecall, eax
.text:00405E30		       retn
.text:00405E30 __initp_misc_purevirt endp
.text:00405E30
.text:00405E31
.text:00405E31 ; =============== S U B R O U T I N E =======================================
.text:00405E31
.text:00405E31
.text:00405E31 ; void __cdecl _initp_misc_initcrit(void	*enull)
.text:00405E31 __initp_misc_initcrit proc near	       ; CODE XREF: __init_pointers+Fp
.text:00405E31
.text:00405E31 enull	       = dword ptr  4
.text:00405E31
.text:00405E31		       mov     eax, [esp+enull]
.text:00405E35		       mov     __pfnInitCritSecAndSpinCount, eax
.text:00405E3A		       retn
.text:00405E3A __initp_misc_initcrit endp
.text:00405E3A
.text:00405E3B
.text:00405E3B ; =============== S U B R O U T I N E =======================================
.text:00405E3B
.text:00405E3B
.text:00405E3B ; int __stdcall _crtInitCritSecNoSpinCount(_RTL_CRITICAL_SECTION	*lpCriticalSection, unsigned int dwSpinCount)
.text:00405E3B __crtInitCritSecNoSpinCount proc	near   ; DATA XREF: ___crtInitCritSecAndSpinCount:loc_405EB0o
.text:00405E3B
.text:00405E3B lpCriticalSection= dword	ptr  4
.text:00405E3B dwSpinCount     = dword ptr  8
.text:00405E3B
.text:00405E3B		       push    [esp+lpCriticalSection] ; lpCriticalSection
.text:00405E3F		       call    ds:__imp__InitializeCriticalSection@4 ; InitializeCriticalSection(x)
.text:00405E45		       xor     eax, eax
.text:00405E47		       inc     eax
.text:00405E48		       retn    8
.text:00405E48 __crtInitCritSecNoSpinCount endp
.text:00405E48
.text:00405E4B
.text:00405E4B ; =============== S U B R O U T I N E =======================================
.text:00405E4B
.text:00405E4B ; Attributes: bp-based frame
.text:00405E4B
.text:00405E4B ; int __cdecl __crtInitCritSecAndSpinCount(_RTL_CRITICAL_SECTION	*lpCriticalSection, unsigned int dwSpinCount)
.text:00405E4B ___crtInitCritSecAndSpinCount proc near ; CODE XREF: __mtinitlocks+26p
.text:00405E4B					       ; __mtinitlocknum+78p ...
.text:00405E4B
.text:00405E4B var_24	       = dword ptr -24h
.text:00405E4B ret	       = dword ptr -20h
.text:00405E4B osplatform      = dword ptr -1Ch
.text:00405E4B ms_exc	       = CPPEH_RECORD ptr -18h
.text:00405E4B lpCriticalSection= dword	ptr  8
.text:00405E4B dwSpinCount     = dword ptr  0Ch
.text:00405E4B
.text:00405E4B		       push    14h
.text:00405E4D		       push    offset dword_421678
.text:00405E52		       call    __SEH_prolog4
.text:00405E57		       xor     edi, edi
.text:00405E59		       mov     [ebp+osplatform], edi
.text:00405E5C		       push    __pfnInitCritSecAndSpinCount ; codedptr
.text:00405E62		       call    __decode_pointer
.text:00405E67		       pop     ecx
.text:00405E68		       mov     esi, eax
.text:00405E6A		       cmp     esi, edi
.text:00405E6C		       jnz     short loc_405EC1
.text:00405E6E		       lea     eax, [ebp+osplatform]
.text:00405E71		       push    eax	       ; pValue
.text:00405E72		       call    __get_osplatform
.text:00405E77		       pop     ecx
.text:00405E78		       cmp     eax, edi
.text:00405E7A		       jz      short loc_405E89
.text:00405E7C		       push    edi	       ; pReserved
.text:00405E7D		       push    edi	       ; nLine
.text:00405E7E		       push    edi	       ; pszFile
.text:00405E7F		       push    edi	       ; pszFunction
.text:00405E80		       push    edi	       ; pszExpression
.text:00405E81		       call    __invoke_watson
.text:00405E86		       add     esp, 14h
.text:00405E89
.text:00405E89 loc_405E89:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+2Fj
.text:00405E89		       cmp     [ebp+osplatform], 1
.text:00405E8D		       jz      short loc_405EB0
.text:00405E8F		       push    offset aKernel32_dll ; "kernel32.dll"
.text:00405E94		       call    ds:__imp__GetModuleHandleA@4 ; GetModuleHandleA(x)
.text:00405E9A		       cmp     eax, edi
.text:00405E9C		       jz      short loc_405EB0
.text:00405E9E		       push    offset aInitializecrit ;	"InitializeCriticalSectionAndSpinCount"
.text:00405EA3		       push    eax	       ; hModule
.text:00405EA4		       call    ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:00405EAA		       mov     esi, eax
.text:00405EAC		       cmp     esi, edi
.text:00405EAE		       jnz     short loc_405EB5
.text:00405EB0
.text:00405EB0 loc_405EB0:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+42j
.text:00405EB0					       ; ___crtInitCritSecAndSpinCount+51j
.text:00405EB0		       mov     esi, offset __crtInitCritSecNoSpinCount
.text:00405EB5
.text:00405EB5 loc_405EB5:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+63j
.text:00405EB5		       push    esi	       ; ptr
.text:00405EB6		       call    __encode_pointer
.text:00405EBB		       pop     ecx
.text:00405EBC		       mov     __pfnInitCritSecAndSpinCount, eax
.text:00405EC1
.text:00405EC1 loc_405EC1:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+21j
.text:00405EC1		       mov     [ebp+ms_exc.disabled], edi
.text:00405EC4		       push    [ebp+dwSpinCount]
.text:00405EC7		       push    [ebp+lpCriticalSection]
.text:00405ECA		       call    esi
.text:00405ECC		       mov     [ebp+ret], eax
.text:00405ECF		       jmp     short loc_405F00
.text:00405ED1 ; ---------------------------------------------------------------------------
.text:00405ED1
.text:00405ED1 $LN12_2:
.text:00405ED1		       mov     eax, [ebp+ms_exc.exc_ptr]
.text:00405ED4		       mov     eax, [eax]
.text:00405ED6		       mov     eax, [eax]
.text:00405ED8		       mov     [ebp+var_24], eax
.text:00405EDB		       xor     ecx, ecx
.text:00405EDD		       cmp     eax, 0C0000017h
.text:00405EE2		       setz    cl
.text:00405EE5		       mov     eax, ecx
.text:00405EE7
.text:00405EE7 $LN19_1:
.text:00405EE7		       retn
.text:00405EE8 ; ---------------------------------------------------------------------------
.text:00405EE8
.text:00405EE8 $LN13_2:
.text:00405EE8		       mov     esp, [ebp+ms_exc.old_esp]
.text:00405EEB		       cmp     [ebp+var_24], 0C0000017h
.text:00405EF2		       jnz     short loc_405EFC
.text:00405EF4		       push    8	       ; dwErrCode
.text:00405EF6		       call    ds:__imp__SetLastError@4	; SetLastError(x)
.text:00405EFC
.text:00405EFC loc_405EFC:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+A7j
.text:00405EFC		       and     [ebp+ret], 0
.text:00405F00
.text:00405F00 loc_405F00:			       ; CODE XREF: ___crtInitCritSecAndSpinCount+84j
.text:00405F00		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00405F07		       mov     eax, [ebp+ret]
.text:00405F0A		       call    __SEH_epilog4
.text:00405F0F		       retn
.text:00405F0F ___crtInitCritSecAndSpinCount endp
.text:00405F0F
.text:00405F10
.text:00405F10 ; =============== S U B R O U T I N E =======================================
.text:00405F10
.text:00405F10
.text:00405F10 ; void __cdecl _initp_heap_handler(void *enull)
.text:00405F10 __initp_heap_handler proc near	       ; CODE XREF: __init_pointers+9p
.text:00405F10
.text:00405F10 enull	       = dword ptr  4
.text:00405F10
.text:00405F10		       mov     eax, [esp+enull]
.text:00405F14		       mov     ?_pnhHeap@@3P6AHI@ZA, eax ; int (*_pnhHeap)(uint)
.text:00405F19		       retn
.text:00405F19 __initp_heap_handler endp
.text:00405F19
.text:00405F1A
.text:00405F1A ; =============== S U B R O U T I N E =======================================
.text:00405F1A
.text:00405F1A
.text:00405F1A ; int (__cdecl *__cdecl _set_new_handler(int (__cdecl *pnh)(unsigned int)))(unsigned int)
.text:00405F1A ?_set_new_handler@@YAP6AHI@ZP6AHI@Z@Z proc near
.text:00405F1A					       ; CODE XREF: _set_new_handler(int)+2p
.text:00405F1A
.text:00405F1A pnh	       = dword ptr  4
.text:00405F1A
.text:00405F1A		       push    esi
.text:00405F1B		       push    4	       ; locknum
.text:00405F1D		       call    __lock
.text:00405F22		       push    ?_pnhHeap@@3P6AHI@ZA ; codedptr
.text:00405F28		       call    __decode_pointer
.text:00405F2D		       push    [esp+0Ch+pnh]   ; ptr
.text:00405F31		       mov     esi, eax
.text:00405F33		       call    __encode_pointer
.text:00405F38		       push    4	       ; locknum
.text:00405F3A		       mov     ?_pnhHeap@@3P6AHI@ZA, eax ; int (*_pnhHeap)(uint)
.text:00405F3F		       call    __unlock
.text:00405F44		       add     esp, 10h
.text:00405F47		       mov     eax, esi
.text:00405F49		       pop     esi
.text:00405F4A		       retn
.text:00405F4A ?_set_new_handler@@YAP6AHI@ZP6AHI@Z@Z endp
.text:00405F4A
.text:00405F4B
.text:00405F4B ; =============== S U B R O U T I N E =======================================
.text:00405F4B
.text:00405F4B
.text:00405F4B ; int (__cdecl *__cdecl _set_new_handler(int pnh))(unsigned int)
.text:00405F4B ?_set_new_handler@@YAP6AHI@ZH@Z proc near
.text:00405F4B
.text:00405F4B pnh	       = dword ptr  4
.text:00405F4B
.text:00405F4B		       push    0	       ; pnh
.text:00405F4D		       call    ?_set_new_handler@@YAP6AHI@ZP6AHI@Z@Z ; _set_new_handler(int (*)(uint))
.text:00405F52		       pop     ecx
.text:00405F53		       retn
.text:00405F53 ?_set_new_handler@@YAP6AHI@ZH@Z endp
.text:00405F53
.text:00405F54
.text:00405F54 ; =============== S U B R O U T I N E =======================================
.text:00405F54
.text:00405F54
.text:00405F54 ; int (__cdecl *__cdecl _query_new_handler())(unsigned int)
.text:00405F54 ?_query_new_handler@@YAP6AHI@ZXZ	proc near
.text:00405F54		       push    ?_pnhHeap@@3P6AHI@ZA ; codedptr
.text:00405F5A		       call    __decode_pointer
.text:00405F5F		       pop     ecx
.text:00405F60		       retn
.text:00405F60 ?_query_new_handler@@YAP6AHI@ZXZ	endp
.text:00405F60
.text:00405F61
.text:00405F61 ; =============== S U B R O U T I N E =======================================
.text:00405F61
.text:00405F61
.text:00405F61 ; int __cdecl _callnewh(unsigned	int size)
.text:00405F61 __callnewh      proc near	       ; CODE XREF: _malloc+8Cp
.text:00405F61					       ; _malloc+AEp ...
.text:00405F61
.text:00405F61 size	       = dword ptr  4
.text:00405F61
.text:00405F61		       push    ?_pnhHeap@@3P6AHI@ZA ; codedptr
.text:00405F67		       call    __decode_pointer
.text:00405F6C		       test    eax, eax
.text:00405F6E		       pop     ecx
.text:00405F6F		       jz      short loc_405F80
.text:00405F71		       push    [esp+size]
.text:00405F75		       call    eax
.text:00405F77		       test    eax, eax
.text:00405F79		       pop     ecx
.text:00405F7A		       jz      short loc_405F80
.text:00405F7C		       xor     eax, eax
.text:00405F7E		       inc     eax
.text:00405F7F		       retn
.text:00405F80 ; ---------------------------------------------------------------------------
.text:00405F80
.text:00405F80 loc_405F80:			       ; CODE XREF: __callnewh+Ej
.text:00405F80					       ; __callnewh+19j
.text:00405F80		       xor     eax, eax
.text:00405F82		       retn
.text:00405F82 __callnewh      endp
.text:00405F82
.text:00405F83
.text:00405F83 ; =============== S U B R O U T I N E =======================================
.text:00405F83
.text:00405F83 ; Attributes: bp-based frame
.text:00405F83
.text:00405F83 ; int __cdecl _ioinit()
.text:00405F83 __ioinit	       proc near	       ; CODE XREF: __tmainCRTStartup+E8p
.text:00405F83
.text:00405F83 StartupInfo     = _STARTUPINFOA ptr -64h
.text:00405F83 i	       = dword ptr -20h
.text:00405F83 posfhnd	       = dword ptr -1Ch
.text:00405F83 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00405F83
.text:00405F83		       push    54h
.text:00405F85		       push    offset dword_421698
.text:00405F8A		       call    __SEH_prolog4
.text:00405F8F		       xor     edi, edi
.text:00405F91		       mov     [ebp+ms_exc.disabled], edi
.text:00405F94		       lea     eax, [ebp+StartupInfo]
.text:00405F97		       push    eax	       ; lpStartupInfo
.text:00405F98		       call    ds:__imp__GetStartupInfoA@4 ; GetStartupInfoA(x)
.text:00405F9E		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00405FA5		       push    40h	       ; size
.text:00405FA7		       push    20h
.text:00405FA9		       pop     esi
.text:00405FAA		       push    esi	       ; count
.text:00405FAB		       call    __calloc_crt
.text:00405FB0		       pop     ecx
.text:00405FB1		       pop     ecx
.text:00405FB2		       cmp     eax, edi
.text:00405FB4		       jz      loc_4061CE
.text:00405FBA		       mov     ___pioinfo, eax
.text:00405FBF		       mov     __nhandle, esi
.text:00405FC5		       lea     ecx, [eax+800h]
.text:00405FCB		       jmp     short loc_405FFD
.text:00405FCD ; ---------------------------------------------------------------------------
.text:00405FCD
.text:00405FCD loc_405FCD:			       ; CODE XREF: __ioinit+7Cj
.text:00405FCD		       mov     byte ptr	[eax+4], 0
.text:00405FD1		       or      dword ptr [eax],	0FFFFFFFFh
.text:00405FD4		       mov     byte ptr	[eax+5], 0Ah
.text:00405FD8		       mov     [eax+8],	edi
.text:00405FDB		       mov     byte ptr	[eax+24h], 0
.text:00405FDF		       mov     byte ptr	[eax+25h], 0Ah
.text:00405FE3		       mov     byte ptr	[eax+26h], 0Ah
.text:00405FE7		       mov     [eax+38h], edi
.text:00405FEA		       mov     byte ptr	[eax+34h], 0
.text:00405FEE		       add     eax, 40h
.text:00405FF1		       mov     ecx, ___pioinfo
.text:00405FF7		       add     ecx, 800h
.text:00405FFD
.text:00405FFD loc_405FFD:			       ; CODE XREF: __ioinit+48j
.text:00405FFD		       cmp     eax, ecx
.text:00405FFF		       jb      short loc_405FCD
.text:00406001		       cmp     [ebp+StartupInfo.cbReserved2], di
.text:00406005		       jz      loc_406115
.text:0040600B		       mov     eax, [ebp+StartupInfo.lpReserved2]
.text:0040600E		       cmp     eax, edi
.text:00406010		       jz      loc_406115
.text:00406016		       mov     edi, [eax]
.text:00406018		       lea     ebx, [eax+4]
.text:0040601B		       lea     eax, [ebx+edi]
.text:0040601E		       mov     [ebp+posfhnd], eax
.text:00406021		       mov     esi, 800h
.text:00406026		       cmp     edi, esi
.text:00406028		       jl      short loc_40602C
.text:0040602A		       mov     edi, esi
.text:0040602C
.text:0040602C loc_40602C:			       ; CODE XREF: __ioinit+A5j
.text:0040602C		       mov     [ebp+i],	1
.text:00406033		       jmp     short loc_406090
.text:00406035 ; ---------------------------------------------------------------------------
.text:00406035
.text:00406035 loc_406035:			       ; CODE XREF: __ioinit+113j
.text:00406035		       push    40h	       ; size
.text:00406037		       push    20h	       ; count
.text:00406039		       call    __calloc_crt
.text:0040603E		       pop     ecx
.text:0040603F		       pop     ecx
.text:00406040		       test    eax, eax
.text:00406042		       jz      short loc_40609A
.text:00406044		       mov     ecx, [ebp+i]
.text:00406047		       lea     ecx, ds:423F00h[ecx*4]
.text:0040604E		       mov     [ecx], eax
.text:00406050		       add     __nhandle, 20h
.text:00406057		       lea     edx, [eax+800h]
.text:0040605D		       jmp     short loc_406089
.text:0040605F ; ---------------------------------------------------------------------------
.text:0040605F
.text:0040605F loc_40605F:			       ; CODE XREF: __ioinit+108j
.text:0040605F		       mov     byte ptr	[eax+4], 0
.text:00406063		       or      dword ptr [eax],	0FFFFFFFFh
.text:00406066		       mov     byte ptr	[eax+5], 0Ah
.text:0040606A		       and     dword ptr [eax+8], 0
.text:0040606E		       and     byte ptr	[eax+24h], 80h
.text:00406072		       mov     byte ptr	[eax+25h], 0Ah
.text:00406076		       mov     byte ptr	[eax+26h], 0Ah
.text:0040607A		       and     dword ptr [eax+38h], 0
.text:0040607E		       mov     byte ptr	[eax+34h], 0
.text:00406082		       add     eax, 40h
.text:00406085		       mov     edx, [ecx]
.text:00406087		       add     edx, esi
.text:00406089
.text:00406089 loc_406089:			       ; CODE XREF: __ioinit+DAj
.text:00406089		       cmp     eax, edx
.text:0040608B		       jb      short loc_40605F
.text:0040608D		       inc     [ebp+i]
.text:00406090
.text:00406090 loc_406090:			       ; CODE XREF: __ioinit+B0j
.text:00406090		       cmp     __nhandle, edi
.text:00406096		       jl      short loc_406035
.text:00406098		       jmp     short loc_4060A0
.text:0040609A ; ---------------------------------------------------------------------------
.text:0040609A
.text:0040609A loc_40609A:			       ; CODE XREF: __ioinit+BFj
.text:0040609A		       mov     edi, __nhandle
.text:004060A0
.text:004060A0 loc_4060A0:			       ; CODE XREF: __ioinit+115j
.text:004060A0		       and     [ebp+i],	0
.text:004060A4		       test    edi, edi
.text:004060A6		       jle     short loc_406115
.text:004060A8
.text:004060A8 loc_4060A8:			       ; CODE XREF: __ioinit+190j
.text:004060A8		       mov     eax, [ebp+posfhnd]
.text:004060AB		       mov     ecx, [eax]
.text:004060AD		       cmp     ecx, 0FFFFFFFFh
.text:004060B0		       jz      short loc_406108
.text:004060B2		       cmp     ecx, 0FFFFFFFEh
.text:004060B5		       jz      short loc_406108
.text:004060B7		       mov     al, [ebx]
.text:004060B9		       test    al, 1
.text:004060BB		       jz      short loc_406108
.text:004060BD		       test    al, 8
.text:004060BF		       jnz     short loc_4060CC
.text:004060C1		       push    ecx	       ; hFile
.text:004060C2		       call    ds:__imp__GetFileType@4 ; GetFileType(x)
.text:004060C8		       test    eax, eax
.text:004060CA		       jz      short loc_406108
.text:004060CC
.text:004060CC loc_4060CC:			       ; CODE XREF: __ioinit+13Cj
.text:004060CC		       mov     esi, [ebp+i]
.text:004060CF		       mov     eax, esi
.text:004060D1		       sar     eax, 5
.text:004060D4		       and     esi, 1Fh
.text:004060D7		       shl     esi, 6
.text:004060DA		       add     esi, ___pioinfo[eax*4]
.text:004060E1		       mov     eax, [ebp+posfhnd]
.text:004060E4		       mov     eax, [eax]
.text:004060E6		       mov     [esi], eax
.text:004060E8		       mov     al, [ebx]
.text:004060EA		       mov     [esi+4],	al
.text:004060ED		       push    0FA0h	       ; dwSpinCount
.text:004060F2		       lea     eax, [esi+0Ch]
.text:004060F5		       push    eax	       ; lpCriticalSection
.text:004060F6		       call    ___crtInitCritSecAndSpinCount
.text:004060FB		       pop     ecx
.text:004060FC		       pop     ecx
.text:004060FD		       test    eax, eax
.text:004060FF		       jz      loc_4061CE
.text:00406105		       inc     dword ptr [esi+8]
.text:00406108
.text:00406108 loc_406108:			       ; CODE XREF: __ioinit+12Dj
.text:00406108					       ; __ioinit+132j	...
.text:00406108		       inc     [ebp+i]
.text:0040610B		       inc     ebx
.text:0040610C		       add     [ebp+posfhnd], 4
.text:00406110		       cmp     [ebp+i],	edi
.text:00406113		       jl      short loc_4060A8
.text:00406115
.text:00406115 loc_406115:			       ; CODE XREF: __ioinit+82j
.text:00406115					       ; __ioinit+8Dj ...
.text:00406115		       xor     ebx, ebx
.text:00406117
.text:00406117 loc_406117:			       ; CODE XREF: __ioinit+227j
.text:00406117		       mov     esi, ebx
.text:00406119		       shl     esi, 6
.text:0040611C		       add     esi, ___pioinfo
.text:00406122		       mov     eax, [esi]
.text:00406124		       cmp     eax, 0FFFFFFFFh
.text:00406127		       jz      short loc_406134
.text:00406129		       cmp     eax, 0FFFFFFFEh
.text:0040612C		       jz      short loc_406134
.text:0040612E		       or      byte ptr	[esi+4], 80h
.text:00406132		       jmp     short loc_4061A6
.text:00406134 ; ---------------------------------------------------------------------------
.text:00406134
.text:00406134 loc_406134:			       ; CODE XREF: __ioinit+1A4j
.text:00406134					       ; __ioinit+1A9j
.text:00406134		       mov     byte ptr	[esi+4], 81h
.text:00406138		       test    ebx, ebx
.text:0040613A		       jnz     short loc_406141
.text:0040613C		       push    0FFFFFFF6h
.text:0040613E		       pop     eax
.text:0040613F		       jmp     short loc_40614B
.text:00406141 ; ---------------------------------------------------------------------------
.text:00406141
.text:00406141 loc_406141:			       ; CODE XREF: __ioinit+1B7j
.text:00406141		       mov     eax, ebx
.text:00406143		       dec     eax
.text:00406144		       neg     eax
.text:00406146		       sbb     eax, eax
.text:00406148		       add     eax, 0FFFFFFF5h
.text:0040614B
.text:0040614B loc_40614B:			       ; CODE XREF: __ioinit+1BCj
.text:0040614B		       push    eax	       ; nStdHandle
.text:0040614C		       call    ds:__imp__GetStdHandle@4	; GetStdHandle(x)
.text:00406152		       mov     edi, eax
.text:00406154		       cmp     edi, 0FFFFFFFFh
.text:00406157		       jz      short loc_40619C
.text:00406159		       test    edi, edi
.text:0040615B		       jz      short loc_40619C
.text:0040615D		       push    edi	       ; hFile
.text:0040615E		       call    ds:__imp__GetFileType@4 ; GetFileType(x)
.text:00406164		       test    eax, eax
.text:00406166		       jz      short loc_40619C
.text:00406168		       mov     [esi], edi
.text:0040616A		       and     eax, 0FFh
.text:0040616F		       cmp     eax, 2
.text:00406172		       jnz     short loc_40617A
.text:00406174		       or      byte ptr	[esi+4], 40h
.text:00406178		       jmp     short loc_406183
.text:0040617A ; ---------------------------------------------------------------------------
.text:0040617A
.text:0040617A loc_40617A:			       ; CODE XREF: __ioinit+1EFj
.text:0040617A		       cmp     eax, 3
.text:0040617D		       jnz     short loc_406183
.text:0040617F		       or      byte ptr	[esi+4], 8
.text:00406183
.text:00406183 loc_406183:			       ; CODE XREF: __ioinit+1F5j
.text:00406183					       ; __ioinit+1FAj
.text:00406183		       push    0FA0h	       ; dwSpinCount
.text:00406188		       lea     eax, [esi+0Ch]
.text:0040618B		       push    eax	       ; lpCriticalSection
.text:0040618C		       call    ___crtInitCritSecAndSpinCount
.text:00406191		       pop     ecx
.text:00406192		       pop     ecx
.text:00406193		       test    eax, eax
.text:00406195		       jz      short loc_4061CE
.text:00406197		       inc     dword ptr [esi+8]
.text:0040619A		       jmp     short loc_4061A6
.text:0040619C ; ---------------------------------------------------------------------------
.text:0040619C
.text:0040619C loc_40619C:			       ; CODE XREF: __ioinit+1D4j
.text:0040619C					       ; __ioinit+1D8j	...
.text:0040619C		       or      byte ptr	[esi+4], 40h
.text:004061A0		       mov     dword ptr [esi],	0FFFFFFFEh
.text:004061A6
.text:004061A6 loc_4061A6:			       ; CODE XREF: __ioinit+1AFj
.text:004061A6					       ; __ioinit+217j
.text:004061A6		       inc     ebx
.text:004061A7		       cmp     ebx, 3
.text:004061AA		       jl      loc_406117
.text:004061B0		       push    __nhandle       ; uNumber
.text:004061B6		       call    ds:__imp__SetHandleCount@4 ; SetHandleCount(x)
.text:004061BC		       xor     eax, eax
.text:004061BE		       jmp     short loc_4061D1
.text:004061C0 ; ---------------------------------------------------------------------------
.text:004061C0
.text:004061C0 $LN39:
.text:004061C0		       xor     eax, eax
.text:004061C2		       inc     eax
.text:004061C3
.text:004061C3 $LN64:
.text:004061C3		       retn
.text:004061C4 ; ---------------------------------------------------------------------------
.text:004061C4
.text:004061C4 $LN40:
.text:004061C4		       mov     esp, [ebp+ms_exc.old_esp]
.text:004061C7		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004061CE
.text:004061CE loc_4061CE:			       ; CODE XREF: __ioinit+31j
.text:004061CE					       ; __ioinit+17Cj	...
.text:004061CE		       or      eax, 0FFFFFFFFh
.text:004061D1
.text:004061D1 loc_4061D1:			       ; CODE XREF: __ioinit+23Bj
.text:004061D1		       call    __SEH_epilog4
.text:004061D6		       retn
.text:004061D6 __ioinit	       endp
.text:004061D6
.text:004061D7
.text:004061D7 ; =============== S U B R O U T I N E =======================================
.text:004061D7
.text:004061D7
.text:004061D7 __ioterm	       proc near
.text:004061D7		       push    esi
.text:004061D8		       push    edi
.text:004061D9		       mov     esi, offset ___pioinfo
.text:004061DE
.text:004061DE loc_4061DE:			       ; CODE XREF: __ioterm+47j
.text:004061DE		       mov     edi, [esi]
.text:004061E0		       test    edi, edi
.text:004061E2		       jz      short loc_406215
.text:004061E4		       lea     eax, [edi+800h]
.text:004061EA		       jmp     short loc_406206
.text:004061EC ; ---------------------------------------------------------------------------
.text:004061EC
.text:004061EC loc_4061EC:			       ; CODE XREF: __ioterm+31j
.text:004061EC		       cmp     dword ptr [edi+8], 0
.text:004061F0		       jz      short loc_4061FC
.text:004061F2		       lea     eax, [edi+0Ch]
.text:004061F5		       push    eax	       ; lpCriticalSection
.text:004061F6		       call    ds:__imp__DeleteCriticalSection@4 ; DeleteCriticalSection(x)
.text:004061FC
.text:004061FC loc_4061FC:			       ; CODE XREF: __ioterm+19j
.text:004061FC		       mov     eax, [esi]
.text:004061FE		       add     edi, 40h
.text:00406201		       add     eax, 800h
.text:00406206
.text:00406206 loc_406206:			       ; CODE XREF: __ioterm+13j
.text:00406206		       cmp     edi, eax
.text:00406208		       jb      short loc_4061EC
.text:0040620A		       push    dword ptr [esi] ; pBlock
.text:0040620C		       call    _free
.text:00406211		       and     dword ptr [esi],	0
.text:00406214		       pop     ecx
.text:00406215
.text:00406215 loc_406215:			       ; CODE XREF: __ioterm+Bj
.text:00406215		       add     esi, 4
.text:00406218		       cmp     esi, offset ___sbh_initialized
.text:0040621E		       jl      short loc_4061DE
.text:00406220		       pop     edi
.text:00406221		       pop     esi
.text:00406222		       retn
.text:00406222 __ioterm	       endp
.text:00406222
.text:00406223
.text:00406223 ; =============== S U B R O U T I N E =======================================
.text:00406223
.text:00406223
.text:00406223 ; int __cdecl _fileno(_iobuf *stream)
.text:00406223 __fileno	       proc near	       ; CODE XREF: _fprintf+63p
.text:00406223					       ; _fprintf+6Fp ...
.text:00406223
.text:00406223 stream	       = dword ptr  4
.text:00406223
.text:00406223		       mov     eax, [esp+stream]
.text:00406227		       push    esi
.text:00406228		       xor     esi, esi
.text:0040622A		       cmp     eax, esi
.text:0040622C		       jnz     short loc_40624B
.text:0040622E		       call    __errno
.text:00406233		       push    esi	       ; pReserved
.text:00406234		       push    esi	       ; nLine
.text:00406235		       push    esi	       ; pszFile
.text:00406236		       push    esi	       ; pszFunction
.text:00406237		       push    esi	       ; pszExpression
.text:00406238		       mov     dword ptr [eax],	16h
.text:0040623E		       call    __invalid_parameter
.text:00406243		       add     esp, 14h
.text:00406246		       or      eax, 0FFFFFFFFh
.text:00406249		       pop     esi
.text:0040624A		       retn
.text:0040624B ; ---------------------------------------------------------------------------
.text:0040624B
.text:0040624B loc_40624B:			       ; CODE XREF: __fileno+9j
.text:0040624B		       mov     eax, [eax+10h]
.text:0040624E		       pop     esi
.text:0040624F		       retn
.text:0040624F __fileno	       endp
.text:0040624F
.text:00406250
.text:00406250 ; =============== S U B R O U T I N E =======================================
.text:00406250
.text:00406250 ; Attributes: bp-based frame
.text:00406250
.text:00406250 ; int __cdecl vfprintf_helper(int (__cdecl *outfn)(_iobuf *, const char *, localeinfo_struct *, char *),	_iobuf *str, const char	*format, localeinfo_struct *plocinfo, char *ap)
.text:00406250 _vfprintf_helper	proc near	       ; CODE XREF: __vfprintf_l+15p
.text:00406250					       ; __vfprintf_s_l+15p ...
.text:00406250
.text:00406250 retval	       = dword ptr -1Ch
.text:00406250 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00406250 outfn	       = dword ptr  8
.text:00406250 stream	       = dword ptr  0Ch
.text:00406250 format	       = dword ptr  10h
.text:00406250 plocinfo	       = dword ptr  14h
.text:00406250 ap	       = dword ptr  18h
.text:00406250
.text:00406250		       push    0Ch
.text:00406252		       push    offset dword_4216B8
.text:00406257		       call    __SEH_prolog4
.text:0040625C		       xor     ebx, ebx
.text:0040625E		       mov     [ebp+retval], ebx
.text:00406261		       xor     eax, eax
.text:00406263		       mov     esi, [ebp+stream]
.text:00406266		       cmp     esi, ebx
.text:00406268		       setnz   al
.text:0040626B		       cmp     eax, ebx
.text:0040626D		       jnz     short loc_40628F
.text:0040626F
.text:0040626F loc_40626F:			       ; CODE XREF: _vfprintf_helper+49j
.text:0040626F		       call    __errno
.text:00406274		       mov     dword ptr [eax],	16h
.text:0040627A		       push    ebx	       ; pReserved
.text:0040627B		       push    ebx	       ; nLine
.text:0040627C		       push    ebx	       ; pszFile
.text:0040627D		       push    ebx	       ; pszFunction
.text:0040627E		       push    ebx	       ; pszExpression
.text:0040627F		       call    __invalid_parameter
.text:00406284		       add     esp, 14h
.text:00406287		       or      eax, 0FFFFFFFFh
.text:0040628A		       jmp     loc_40638E
.text:0040628F ; ---------------------------------------------------------------------------
.text:0040628F
.text:0040628F loc_40628F:			       ; CODE XREF: _vfprintf_helper+1Dj
.text:0040628F		       xor     eax, eax
.text:00406291		       cmp     [ebp+format], ebx
.text:00406294		       setnz   al
.text:00406297		       cmp     eax, ebx
.text:00406299		       jz      short loc_40626F
.text:0040629B		       mov     [ebp+stream], esi
.text:0040629E		       push    esi	       ; pf
.text:0040629F		       call    __lock_file
.text:004062A4		       pop     ecx
.text:004062A5		       mov     [ebp+ms_exc.disabled], ebx
.text:004062A8		       test    byte ptr	[esi+0Ch], 40h
.text:004062AC		       jnz     loc_406358
.text:004062B2		       push    esi	       ; stream
.text:004062B3		       call    __fileno
.text:004062B8		       pop     ecx
.text:004062B9		       cmp     eax, 0FFFFFFFFh
.text:004062BC		       jz      short loc_4062EC
.text:004062BE		       push    esi	       ; stream
.text:004062BF		       call    __fileno
.text:004062C4		       pop     ecx
.text:004062C5		       cmp     eax, 0FFFFFFFEh
.text:004062C8		       jz      short loc_4062EC
.text:004062CA		       push    esi	       ; stream
.text:004062CB		       call    __fileno
.text:004062D0		       sar     eax, 5
.text:004062D3		       lea     edi, ds:423F00h[eax*4]
.text:004062DA		       push    esi	       ; stream
.text:004062DB		       call    __fileno
.text:004062E0		       pop     ecx
.text:004062E1		       pop     ecx
.text:004062E2		       and     eax, 1Fh
.text:004062E5		       shl     eax, 6
.text:004062E8		       add     eax, [edi]
.text:004062EA		       jmp     short loc_4062F1
.text:004062EC ; ---------------------------------------------------------------------------
.text:004062EC
.text:004062EC loc_4062EC:			       ; CODE XREF: _vfprintf_helper+6Cj
.text:004062EC					       ; _vfprintf_helper+78j
.text:004062EC		       mov     eax, offset ___badioinfo
.text:004062F1
.text:004062F1 loc_4062F1:			       ; CODE XREF: _vfprintf_helper+9Aj
.text:004062F1		       test    byte ptr	[eax+24h], 7Fh
.text:004062F5		       jnz     short loc_40633C
.text:004062F7		       push    esi	       ; stream
.text:004062F8		       call    __fileno
.text:004062FD		       pop     ecx
.text:004062FE		       cmp     eax, 0FFFFFFFFh
.text:00406301		       jz      short loc_406331
.text:00406303		       push    esi	       ; stream
.text:00406304		       call    __fileno
.text:00406309		       pop     ecx
.text:0040630A		       cmp     eax, 0FFFFFFFEh
.text:0040630D		       jz      short loc_406331
.text:0040630F		       push    esi	       ; stream
.text:00406310		       call    __fileno
.text:00406315		       sar     eax, 5
.text:00406318		       lea     edi, ds:423F00h[eax*4]
.text:0040631F		       push    esi	       ; stream
.text:00406320		       call    __fileno
.text:00406325		       pop     ecx
.text:00406326		       pop     ecx
.text:00406327		       and     eax, 1Fh
.text:0040632A		       shl     eax, 6
.text:0040632D		       add     eax, [edi]
.text:0040632F		       jmp     short loc_406336
.text:00406331 ; ---------------------------------------------------------------------------
.text:00406331
.text:00406331 loc_406331:			       ; CODE XREF: _vfprintf_helper+B1j
.text:00406331					       ; _vfprintf_helper+BDj
.text:00406331		       mov     eax, offset ___badioinfo
.text:00406336
.text:00406336 loc_406336:			       ; CODE XREF: _vfprintf_helper+DFj
.text:00406336		       test    byte ptr	[eax+24h], 80h
.text:0040633A		       jz      short loc_406358
.text:0040633C
.text:0040633C loc_40633C:			       ; CODE XREF: _vfprintf_helper+A5j
.text:0040633C		       call    __errno
.text:00406341		       mov     dword ptr [eax],	16h
.text:00406347		       push    ebx	       ; pReserved
.text:00406348		       push    ebx	       ; nLine
.text:00406349		       push    ebx	       ; pszFile
.text:0040634A		       push    ebx	       ; pszFunction
.text:0040634B		       push    ebx	       ; pszExpression
.text:0040634C		       call    __invalid_parameter
.text:00406351		       add     esp, 14h
.text:00406354		       or      [ebp+retval], 0FFFFFFFFh
.text:00406358
.text:00406358 loc_406358:			       ; CODE XREF: _vfprintf_helper+5Cj
.text:00406358					       ; _vfprintf_helper+EAj
.text:00406358		       cmp     [ebp+retval], ebx
.text:0040635B		       jnz     short loc_40637F
.text:0040635D		       push    esi	       ; str
.text:0040635E		       call    __stbuf
.text:00406363		       mov     edi, eax
.text:00406365		       push    [ebp+ap]
.text:00406368		       push    [ebp+plocinfo]
.text:0040636B		       push    [ebp+format]
.text:0040636E		       push    esi
.text:0040636F		       call    [ebp+outfn]
.text:00406372		       mov     [ebp+retval], eax
.text:00406375		       push    esi	       ; str
.text:00406376		       push    edi	       ; flag
.text:00406377		       call    __ftbuf
.text:0040637C		       add     esp, 1Ch
.text:0040637F
.text:0040637F loc_40637F:			       ; CODE XREF: _vfprintf_helper+10Bj
.text:0040637F		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00406386		       call    $LN16_2
.text:0040638B
.text:0040638B $LN19_2:
.text:0040638B		       mov     eax, [ebp+retval]
.text:0040638E
.text:0040638E loc_40638E:			       ; CODE XREF: _vfprintf_helper+3Aj
.text:0040638E		       call    __SEH_epilog4
.text:00406393		       retn
.text:00406394 ; ---------------------------------------------------------------------------
.text:00406394
.text:00406394 $LN16_2:				       ; CODE XREF: _vfprintf_helper+136p
.text:00406394					       ; DATA XREF: .rdata:004216D0o
.text:00406394		       push    [ebp+stream]    ; pf
.text:00406397		       call    __unlock_file
.text:0040639C		       pop     ecx
.text:0040639D
.text:0040639D $LN17_2:
.text:0040639D		       retn
.text:0040639D _vfprintf_helper	endp
.text:0040639D
.text:0040639E
.text:0040639E ; =============== S U B R O U T I N E =======================================
.text:0040639E
.text:0040639E
.text:0040639E ; int __cdecl _vfprintf_l(_iobuf	*str, const char *format, localeinfo_struct *plocinfo, char *ap)
.text:0040639E __vfprintf_l    proc near	       ; CODE XREF: __fprintf_l+11p
.text:0040639E
.text:0040639E str	       = dword ptr  4
.text:0040639E format	       = dword ptr  8
.text:0040639E plocinfo	       = dword ptr  0Ch
.text:0040639E ap	       = dword ptr  10h
.text:0040639E
.text:0040639E		       push    [esp+ap]	       ; ap
.text:004063A2		       push    [esp+4+plocinfo]	; plocinfo
.text:004063A6		       push    [esp+8+format]  ; format
.text:004063AA		       push    [esp+0Ch+str]   ; str
.text:004063AE		       push    offset __output_l ; outfn
.text:004063B3		       call    _vfprintf_helper
.text:004063B8		       add     esp, 14h
.text:004063BB		       retn
.text:004063BB __vfprintf_l    endp
.text:004063BB
.text:004063BC
.text:004063BC ; =============== S U B R O U T I N E =======================================
.text:004063BC
.text:004063BC
.text:004063BC ; int __cdecl _vfprintf_s_l(_iobuf *str,	const char *format, localeinfo_struct *plocinfo, char *ap)
.text:004063BC __vfprintf_s_l  proc near	       ; CODE XREF: __fprintf_s_l+11p
.text:004063BC					       ; _fprintf_s+Fp
.text:004063BC
.text:004063BC str	       = dword ptr  4
.text:004063BC format	       = dword ptr  8
.text:004063BC plocinfo	       = dword ptr  0Ch
.text:004063BC ap	       = dword ptr  10h
.text:004063BC
.text:004063BC		       push    [esp+ap]	       ; ap
.text:004063C0		       push    [esp+4+plocinfo]	; plocinfo
.text:004063C4		       push    [esp+8+format]  ; format
.text:004063C8		       push    [esp+0Ch+str]   ; str
.text:004063CC		       push    offset __output_s_l ; outfn
.text:004063D1		       call    _vfprintf_helper
.text:004063D6		       add     esp, 14h
.text:004063D9		       retn
.text:004063D9 __vfprintf_s_l  endp
.text:004063D9
.text:004063DA
.text:004063DA ; =============== S U B R O U T I N E =======================================
.text:004063DA
.text:004063DA
.text:004063DA ; int __cdecl _vfprintf_p_l(_iobuf *str,	const char *format, localeinfo_struct *plocinfo, char *ap)
.text:004063DA __vfprintf_p_l  proc near	       ; CODE XREF: __fprintf_p_l+11p
.text:004063DA					       ; __fprintf_p+Fp
.text:004063DA
.text:004063DA str	       = dword ptr  4
.text:004063DA format	       = dword ptr  8
.text:004063DA plocinfo	       = dword ptr  0Ch
.text:004063DA ap	       = dword ptr  10h
.text:004063DA
.text:004063DA		       push    [esp+ap]	       ; ap
.text:004063DE		       push    [esp+4+plocinfo]	; plocinfo
.text:004063E2		       push    [esp+8+format]  ; format
.text:004063E6		       push    [esp+0Ch+str]   ; str
.text:004063EA		       push    offset __output_p_l ; outfn
.text:004063EF		       call    _vfprintf_helper
.text:004063F4		       add     esp, 14h
.text:004063F7		       retn
.text:004063F7 __vfprintf_p_l  endp
.text:004063F7
.text:004063F8
.text:004063F8 ; =============== S U B R O U T I N E =======================================
.text:004063F8
.text:004063F8
.text:004063F8 ; int __cdecl vfprintf(_iobuf *str, const char *format, char *ap)
.text:004063F8 _vfprintf       proc near
.text:004063F8
.text:004063F8 str	       = dword ptr  4
.text:004063F8 format	       = dword ptr  8
.text:004063F8 ap	       = dword ptr  0Ch
.text:004063F8
.text:004063F8		       push    [esp+ap]	       ; ap
.text:004063FC		       push    0	       ; plocinfo
.text:004063FE		       push    [esp+8+format]  ; format
.text:00406402		       push    [esp+0Ch+str]   ; str
.text:00406406		       push    offset __output_l ; outfn
.text:0040640B		       call    _vfprintf_helper
.text:00406410		       add     esp, 14h
.text:00406413		       retn
.text:00406413 _vfprintf       endp
.text:00406413
.text:00406414
.text:00406414 ; =============== S U B R O U T I N E =======================================
.text:00406414
.text:00406414
.text:00406414 ; int __cdecl vfprintf_s(_iobuf *str, const char	*format, char *ap)
.text:00406414 _vfprintf_s     proc near
.text:00406414
.text:00406414 str	       = dword ptr  4
.text:00406414 format	       = dword ptr  8
.text:00406414 ap	       = dword ptr  0Ch
.text:00406414
.text:00406414		       push    [esp+ap]	       ; ap
.text:00406418		       push    0	       ; plocinfo
.text:0040641A		       push    [esp+8+format]  ; format
.text:0040641E		       push    [esp+0Ch+str]   ; str
.text:00406422		       push    offset __output_s_l ; outfn
.text:00406427		       call    _vfprintf_helper
.text:0040642C		       add     esp, 14h
.text:0040642F		       retn
.text:0040642F _vfprintf_s     endp
.text:0040642F
.text:00406430
.text:00406430 ; =============== S U B R O U T I N E =======================================
.text:00406430
.text:00406430
.text:00406430 ; int __cdecl _vfprintf_p(_iobuf	*str, const char *format, char *ap)
.text:00406430 __vfprintf_p    proc near
.text:00406430
.text:00406430 str	       = dword ptr  4
.text:00406430 format	       = dword ptr  8
.text:00406430 ap	       = dword ptr  0Ch
.text:00406430
.text:00406430		       push    [esp+ap]	       ; ap
.text:00406434		       push    0	       ; plocinfo
.text:00406436		       push    [esp+8+format]  ; format
.text:0040643A		       push    [esp+0Ch+str]   ; str
.text:0040643E		       push    offset __output_p_l ; outfn
.text:00406443		       call    _vfprintf_helper
.text:00406448		       add     esp, 14h
.text:0040644B		       retn
.text:0040644B __vfprintf_p    endp
.text:0040644B
.text:0040644C
.text:0040644C ; =============== S U B R O U T I N E =======================================
.text:0040644C
.text:0040644C
.text:0040644C ; unsigned int __cdecl wait_a_bit(unsigned int WaitTime)
.text:0040644C _wait_a_bit     proc near
.text:0040644C
.text:0040644C WaitTime	       = dword ptr  4
.text:0040644C
.text:0040644C		       push    esi
.text:0040644D		       mov     esi, [esp+4+WaitTime]
.text:00406451		       push    esi	       ; dwMilliseconds
.text:00406452		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:00406458		       add     esi, 3E8h
.text:0040645E		       cmp     esi, __maxwait
.text:00406464		       jbe     short loc_406469
.text:00406466		       or      esi, 0FFFFFFFFh
.text:00406469
.text:00406469 loc_406469:			       ; CODE XREF: _wait_a_bit+18j
.text:00406469		       mov     eax, esi
.text:0040646B		       pop     esi
.text:0040646C		       retn
.text:0040646C _wait_a_bit     endp
.text:0040646C
.text:0040646D
.text:0040646D ; =============== S U B R O U T I N E =======================================
.text:0040646D
.text:0040646D
.text:0040646D ; unsigned int __cdecl _set_malloc_crt_max_wait(unsigned	int newvalue)
.text:0040646D __set_malloc_crt_max_wait proc near
.text:0040646D
.text:0040646D newvalue	       = dword ptr  4
.text:0040646D
.text:0040646D		       mov     ecx, [esp+newvalue]
.text:00406471		       mov     eax, __maxwait
.text:00406476		       mov     __maxwait, ecx
.text:0040647C		       retn
.text:0040647C __set_malloc_crt_max_wait endp
.text:0040647C
.text:0040647D
.text:0040647D ; =============== S U B R O U T I N E =======================================
.text:0040647D
.text:0040647D
.text:0040647D ; void *__cdecl _malloc_crt(unsigned int	cb)
.text:0040647D __malloc_crt    proc near	       ; CODE XREF: __stbuf+58p
.text:0040647D					       ; __output_l+5D0p ...
.text:0040647D
.text:0040647D cb	       = dword ptr  4
.text:0040647D
.text:0040647D		       push    esi
.text:0040647E		       push    edi
.text:0040647F		       xor     esi, esi
.text:00406481
.text:00406481 Retry:				       ; CODE XREF: __malloc_crt+39j
.text:00406481		       push    [esp+8+cb]      ; size
.text:00406485		       call    _malloc
.text:0040648A		       mov     edi, eax
.text:0040648C		       test    edi, edi
.text:0040648E		       pop     ecx
.text:0040648F		       jnz     short loc_4064B8
.text:00406491		       cmp     __maxwait, eax
.text:00406497		       jbe     short loc_4064B8
.text:00406499		       push    esi	       ; dwMilliseconds
.text:0040649A		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:004064A0		       lea     eax, [esi+3E8h]
.text:004064A6		       cmp     eax, __maxwait
.text:004064AC		       jbe     short loc_4064B1
.text:004064AE		       or      eax, 0FFFFFFFFh
.text:004064B1
.text:004064B1 loc_4064B1:			       ; CODE XREF: __malloc_crt+2Fj
.text:004064B1		       cmp     eax, 0FFFFFFFFh
.text:004064B4		       mov     esi, eax
.text:004064B6		       jnz     short Retry
.text:004064B8
.text:004064B8 loc_4064B8:			       ; CODE XREF: __malloc_crt+12j
.text:004064B8					       ; __malloc_crt+1Aj
.text:004064B8		       mov     eax, edi
.text:004064BA		       pop     edi
.text:004064BB		       pop     esi
.text:004064BC		       retn
.text:004064BC __malloc_crt    endp
.text:004064BC
.text:004064BD
.text:004064BD ; =============== S U B R O U T I N E =======================================
.text:004064BD
.text:004064BD
.text:004064BD ; void *__cdecl _calloc_crt(unsigned int	count, unsigned	int size)
.text:004064BD __calloc_crt    proc near	       ; CODE XREF: ___initstdio+22p
.text:004064BD					       ; ___initstdio+3Bp ...
.text:004064BD
.text:004064BD count	       = dword ptr  4
.text:004064BD size	       = dword ptr  8
.text:004064BD
.text:004064BD		       push    esi
.text:004064BE		       push    edi
.text:004064BF		       xor     esi, esi
.text:004064C1
.text:004064C1 Retry_0:				       ; CODE XREF: __calloc_crt+41j
.text:004064C1		       push    0	       ; errno_tmp
.text:004064C3		       push    [esp+0Ch+size]  ; size
.text:004064C7		       push    [esp+10h+count] ; num
.text:004064CB		       call    __calloc_impl
.text:004064D0		       mov     edi, eax
.text:004064D2		       add     esp, 0Ch
.text:004064D5		       test    edi, edi
.text:004064D7		       jnz     short loc_406500
.text:004064D9		       cmp     __maxwait, eax
.text:004064DF		       jbe     short loc_406500
.text:004064E1		       push    esi	       ; dwMilliseconds
.text:004064E2		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:004064E8		       lea     eax, [esi+3E8h]
.text:004064EE		       cmp     eax, __maxwait
.text:004064F4		       jbe     short loc_4064F9
.text:004064F6		       or      eax, 0FFFFFFFFh
.text:004064F9
.text:004064F9 loc_4064F9:			       ; CODE XREF: __calloc_crt+37j
.text:004064F9		       cmp     eax, 0FFFFFFFFh
.text:004064FC		       mov     esi, eax
.text:004064FE		       jnz     short Retry_0
.text:00406500
.text:00406500 loc_406500:			       ; CODE XREF: __calloc_crt+1Aj
.text:00406500					       ; __calloc_crt+22j
.text:00406500		       mov     eax, edi
.text:00406502		       pop     edi
.text:00406503		       pop     esi
.text:00406504		       retn
.text:00406504 __calloc_crt    endp
.text:00406504
.text:00406505
.text:00406505 ; =============== S U B R O U T I N E =======================================
.text:00406505
.text:00406505
.text:00406505 ; void *__cdecl _realloc_crt(void *ptr, unsigned	int size)
.text:00406505 __realloc_crt   proc near	       ; CODE XREF: _onexit_nolock+5Cp
.text:00406505					       ; _onexit_nolock+73p ...
.text:00406505
.text:00406505 ptr	       = dword ptr  4
.text:00406505 size	       = dword ptr  8
.text:00406505
.text:00406505		       push    esi
.text:00406506		       push    edi
.text:00406507		       xor     esi, esi
.text:00406509
.text:00406509 Retry_1:				       ; CODE XREF: __realloc_crt+44j
.text:00406509		       push    [esp+8+size]    ; newsize
.text:0040650D		       push    [esp+0Ch+ptr]   ; pBlock
.text:00406511		       call    _realloc
.text:00406516		       mov     edi, eax
.text:00406518		       test    edi, edi
.text:0040651A		       pop     ecx
.text:0040651B		       pop     ecx
.text:0040651C		       jnz     short loc_40654B
.text:0040651E		       cmp     [esp+8+size], eax
.text:00406522		       jz      short loc_40654B
.text:00406524		       cmp     __maxwait, eax
.text:0040652A		       jbe     short loc_40654B
.text:0040652C		       push    esi	       ; dwMilliseconds
.text:0040652D		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:00406533		       lea     eax, [esi+3E8h]
.text:00406539		       cmp     eax, __maxwait
.text:0040653F		       jbe     short loc_406544
.text:00406541		       or      eax, 0FFFFFFFFh
.text:00406544
.text:00406544 loc_406544:			       ; CODE XREF: __realloc_crt+3Aj
.text:00406544		       cmp     eax, 0FFFFFFFFh
.text:00406547		       mov     esi, eax
.text:00406549		       jnz     short Retry_1
.text:0040654B
.text:0040654B loc_40654B:			       ; CODE XREF: __realloc_crt+17j
.text:0040654B					       ; __realloc_crt+1Dj ...
.text:0040654B		       mov     eax, edi
.text:0040654D		       pop     edi
.text:0040654E		       pop     esi
.text:0040654F		       retn
.text:0040654F __realloc_crt   endp
.text:0040654F
.text:00406550
.text:00406550 ; =============== S U B R O U T I N E =======================================
.text:00406550
.text:00406550
.text:00406550 ; void *__cdecl _recalloc_crt(void *ptr,	unsigned int count, unsigned int size)
.text:00406550 __recalloc_crt  proc near	       ; CODE XREF: ___crtsetenv+13Ep
.text:00406550					       ; ___crtsetenv+17Ap
.text:00406550
.text:00406550 ptr	       = dword ptr  4
.text:00406550 count	       = dword ptr  8
.text:00406550 size	       = dword ptr  0Ch
.text:00406550
.text:00406550		       push    esi
.text:00406551		       push    edi
.text:00406552		       xor     esi, esi
.text:00406554
.text:00406554 Retry_2:				       ; CODE XREF: __recalloc_crt+49j
.text:00406554		       push    [esp+8+size]    ; size
.text:00406558		       push    [esp+0Ch+count] ; count
.text:0040655C		       push    [esp+10h+ptr]   ; memblock
.text:00406560		       call    __recalloc
.text:00406565		       mov     edi, eax
.text:00406567		       add     esp, 0Ch
.text:0040656A		       test    edi, edi
.text:0040656C		       jnz     short loc_40659B
.text:0040656E		       cmp     [esp+8+size], eax
.text:00406572		       jz      short loc_40659B
.text:00406574		       cmp     __maxwait, eax
.text:0040657A		       jbe     short loc_40659B
.text:0040657C		       push    esi	       ; dwMilliseconds
.text:0040657D		       call    ds:__imp__Sleep@4 ; Sleep(x)
.text:00406583		       lea     eax, [esi+3E8h]
.text:00406589		       cmp     eax, __maxwait
.text:0040658F		       jbe     short loc_406594
.text:00406591		       or      eax, 0FFFFFFFFh
.text:00406594
.text:00406594 loc_406594:			       ; CODE XREF: __recalloc_crt+3Fj
.text:00406594		       cmp     eax, 0FFFFFFFFh
.text:00406597		       mov     esi, eax
.text:00406599		       jnz     short Retry_2
.text:0040659B
.text:0040659B loc_40659B:			       ; CODE XREF: __recalloc_crt+1Cj
.text:0040659B					       ; __recalloc_crt+22j ...
.text:0040659B		       mov     eax, edi
.text:0040659D		       pop     edi
.text:0040659E		       pop     esi
.text:0040659F		       retn
.text:0040659F __recalloc_crt  endp
.text:0040659F
.text:004065A0
.text:004065A0 ; =============== S U B R O U T I N E =======================================
.text:004065A0
.text:004065A0
.text:004065A0 ; void *__fastcall _malloc_crt_fastcall(unsigned	int cb)
.text:004065A0 @_malloc_crt_fastcall@4 proc near
.text:004065A0 cb = ecx
.text:004065A0		       push    cb	       ; cb
.text:004065A1		       call    __malloc_crt
.text:004065A6		       pop     cb
.text:004065A7		       retn
.text:004065A7 @_malloc_crt_fastcall@4 endp
.text:004065A7
.text:004065A8
.text:004065A8 ; =============== S U B R O U T I N E =======================================
.text:004065A8
.text:004065A8
.text:004065A8 ; void *__fastcall _calloc_crt_fastcall(unsigned	int count, unsigned int	size)
.text:004065A8 @_calloc_crt_fastcall@8 proc near
.text:004065A8 count = ecx
.text:004065A8 size = edx
.text:004065A8		       push    size	       ; size
.text:004065A9		       push    count	       ; count
.text:004065AA		       call    __calloc_crt
.text:004065AF		       pop     count
.text:004065B0		       pop     count
.text:004065B1		       retn
.text:004065B1 @_calloc_crt_fastcall@8 endp
.text:004065B1
.text:004065B2
.text:004065B2 ; =============== S U B R O U T I N E =======================================
.text:004065B2
.text:004065B2
.text:004065B2 ; void *__fastcall _realloc_crt_fastcall(void *ptr, unsigned int	size)
.text:004065B2 @_realloc_crt_fastcall@8	proc near
.text:004065B2 ptr = ecx
.text:004065B2 size = edx
.text:004065B2		       push    size	       ; size
.text:004065B3		       push    ptr	       ; ptr
.text:004065B4		       call    __realloc_crt
.text:004065B9		       pop     ptr
.text:004065BA		       pop     ptr
.text:004065BB		       retn
.text:004065BB @_realloc_crt_fastcall@8	endp
.text:004065BB
.text:004065BC
.text:004065BC ; =============== S U B R O U T I N E =======================================
.text:004065BC
.text:004065BC ; Attributes: bp-based frame
.text:004065BC
.text:004065BC ; int __cdecl _fcloseall()
.text:004065BC __fcloseall     proc near	       ; CODE XREF: ___endstdio+Ep
.text:004065BC
.text:004065BC i	       = dword ptr -20h
.text:004065BC count	       = dword ptr -1Ch
.text:004065BC ms_exc	       = CPPEH_RECORD ptr -18h
.text:004065BC
.text:004065BC		       push    10h
.text:004065BE		       push    offset dword_4216D8
.text:004065C3		       call    __SEH_prolog4
.text:004065C8		       xor     ebx, ebx
.text:004065CA		       mov     [ebp+count], ebx
.text:004065CD		       push    1	       ; locknum
.text:004065CF		       call    __lock
.text:004065D4		       pop     ecx
.text:004065D5		       mov     [ebp+ms_exc.disabled], ebx
.text:004065D8		       push    3
.text:004065DA		       pop     edi
.text:004065DB
.text:004065DB loc_4065DB:			       ; CODE XREF: __fcloseall+7Fj
.text:004065DB		       mov     [ebp+i],	edi
.text:004065DE		       cmp     edi, __nstream
.text:004065E4		       jge     short loc_40663D
.text:004065E6		       mov     esi, edi
.text:004065E8		       shl     esi, 2
.text:004065EB		       mov     eax, ___piob
.text:004065F0		       add     eax, esi
.text:004065F2		       cmp     [eax], ebx
.text:004065F4		       jz      short loc_40663A
.text:004065F6		       mov     eax, [eax]
.text:004065F8		       test    byte ptr	[eax+0Ch], 83h
.text:004065FC		       jz      short loc_40660D
.text:004065FE		       push    eax	       ; stream
.text:004065FF		       call    _fclose
.text:00406604		       pop     ecx
.text:00406605		       cmp     eax, 0FFFFFFFFh
.text:00406608		       jz      short loc_40660D
.text:0040660A		       inc     [ebp+count]
.text:0040660D
.text:0040660D loc_40660D:			       ; CODE XREF: __fcloseall+40j
.text:0040660D					       ; __fcloseall+4Cj
.text:0040660D		       cmp     edi, 14h
.text:00406610		       jl      short loc_40663A
.text:00406612		       mov     eax, ___piob
.text:00406617		       mov     eax, [esi+eax]
.text:0040661A		       add     eax, 20h
.text:0040661D		       push    eax	       ; lpCriticalSection
.text:0040661E		       call    ds:__imp__DeleteCriticalSection@4 ; DeleteCriticalSection(x)
.text:00406624		       mov     eax, ___piob
.text:00406629		       push    dword ptr [esi+eax] ; pBlock
.text:0040662C		       call    _free
.text:00406631		       pop     ecx
.text:00406632		       mov     eax, ___piob
.text:00406637		       mov     [esi+eax], ebx
.text:0040663A
.text:0040663A loc_40663A:			       ; CODE XREF: __fcloseall+38j
.text:0040663A					       ; __fcloseall+54j
.text:0040663A		       inc     edi
.text:0040663B		       jmp     short loc_4065DB
.text:0040663D ; ---------------------------------------------------------------------------
.text:0040663D
.text:0040663D loc_40663D:			       ; CODE XREF: __fcloseall+28j
.text:0040663D		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00406644		       call    $LN11_2
.text:00406649
.text:00406649 $LN14_0:
.text:00406649		       mov     eax, [ebp+count]
.text:0040664C		       call    __SEH_epilog4
.text:00406651		       retn
.text:00406652 ; ---------------------------------------------------------------------------
.text:00406652
.text:00406652 $LN11_2:				       ; CODE XREF: __fcloseall+88p
.text:00406652					       ; DATA XREF: .rdata:004216F0o
.text:00406652		       push    1	       ; locknum
.text:00406654		       call    __unlock
.text:00406659		       pop     ecx
.text:0040665A
.text:0040665A $LN12_3:
.text:0040665A		       retn
.text:0040665A __fcloseall     endp
.text:0040665A
.text:0040665B
.text:0040665B ; =============== S U B R O U T I N E =======================================
.text:0040665B
.text:0040665B
.text:0040665B ; int __cdecl _flush(_iobuf *str)
.text:0040665B __flush	       proc near	       ; CODE XREF: __ftbuf+15p
.text:0040665B					       ; __fflush_nolock+13p ...
.text:0040665B
.text:0040665B str	       = dword ptr  4
.text:0040665B
.text:0040665B		       push    ebx
.text:0040665C		       push    esi
.text:0040665D		       mov     esi, [esp+8+str]
.text:00406661		       mov     eax, [esi+0Ch]
.text:00406664		       mov     ecx, eax
.text:00406666		       and     cl, 3
.text:00406669		       xor     ebx, ebx
.text:0040666B		       cmp     cl, 2
.text:0040666E		       jnz     short loc_4066AF
.text:00406670		       test    ax, 108h
.text:00406674		       jz      short loc_4066AF
.text:00406676		       mov     eax, [esi+8]
.text:00406679		       push    edi
.text:0040667A		       mov     edi, [esi]
.text:0040667C		       sub     edi, eax
.text:0040667E		       test    edi, edi
.text:00406680		       jle     short loc_4066AE
.text:00406682		       push    edi	       ; cnt
.text:00406683		       push    eax	       ; buf
.text:00406684		       push    esi	       ; stream
.text:00406685		       call    __fileno
.text:0040668A		       pop     ecx
.text:0040668B		       push    eax	       ; fh
.text:0040668C		       call    __write
.text:00406691		       add     esp, 0Ch
.text:00406694		       cmp     eax, edi
.text:00406696		       jnz     short loc_4066A7
.text:00406698		       mov     eax, [esi+0Ch]
.text:0040669B		       test    al, al
.text:0040669D		       jns     short loc_4066AE
.text:0040669F		       and     eax, 0FFFFFFFDh
.text:004066A2		       mov     [esi+0Ch], eax
.text:004066A5		       jmp     short loc_4066AE
.text:004066A7 ; ---------------------------------------------------------------------------
.text:004066A7
.text:004066A7 loc_4066A7:			       ; CODE XREF: __flush+3Bj
.text:004066A7		       or      dword ptr [esi+0Ch], 20h
.text:004066AB		       or      ebx, 0FFFFFFFFh
.text:004066AE
.text:004066AE loc_4066AE:			       ; CODE XREF: __flush+25j
.text:004066AE					       ; __flush+42j ...
.text:004066AE		       pop     edi
.text:004066AF
.text:004066AF loc_4066AF:			       ; CODE XREF: __flush+13j
.text:004066AF					       ; __flush+19j
.text:004066AF		       mov     eax, [esi+8]
.text:004066B2		       and     dword ptr [esi+4], 0
.text:004066B6		       mov     [esi], eax
.text:004066B8		       pop     esi
.text:004066B9		       mov     eax, ebx
.text:004066BB		       pop     ebx
.text:004066BC		       retn
.text:004066BC __flush	       endp
.text:004066BC
.text:004066BD
.text:004066BD ; =============== S U B R O U T I N E =======================================
.text:004066BD
.text:004066BD
.text:004066BD ; int __cdecl _fflush_nolock(_iobuf *str)
.text:004066BD __fflush_nolock proc near	       ; CODE XREF: flsall+69p
.text:004066BD					       ; flsall+84p ...
.text:004066BD
.text:004066BD str	       = dword ptr  4
.text:004066BD
.text:004066BD		       push    esi
.text:004066BE		       mov     esi, [esp+4+str]
.text:004066C2		       test    esi, esi
.text:004066C4		       jnz     short loc_4066CF
.text:004066C6		       push    esi	       ; flushflag
.text:004066C7		       call    flsall
.text:004066CC		       pop     ecx
.text:004066CD		       pop     esi
.text:004066CE		       retn
.text:004066CF ; ---------------------------------------------------------------------------
.text:004066CF
.text:004066CF loc_4066CF:			       ; CODE XREF: __fflush_nolock+7j
.text:004066CF		       push    esi	       ; str
.text:004066D0		       call    __flush
.text:004066D5		       test    eax, eax
.text:004066D7		       pop     ecx
.text:004066D8		       jz      short loc_4066DF
.text:004066DA		       or      eax, 0FFFFFFFFh
.text:004066DD		       pop     esi
.text:004066DE		       retn
.text:004066DF ; ---------------------------------------------------------------------------
.text:004066DF
.text:004066DF loc_4066DF:			       ; CODE XREF: __fflush_nolock+1Bj
.text:004066DF		       test    word ptr	[esi+0Ch], 4000h
.text:004066E5		       jz      short loc_4066FB
.text:004066E7		       push    esi	       ; stream
.text:004066E8		       call    __fileno
.text:004066ED		       push    eax	       ; filedes
.text:004066EE		       call    __commit
.text:004066F3		       pop     ecx
.text:004066F4		       pop     ecx
.text:004066F5		       neg     eax
.text:004066F7		       sbb     eax, eax
.text:004066F9		       pop     esi
.text:004066FA		       retn
.text:004066FB ; ---------------------------------------------------------------------------
.text:004066FB
.text:004066FB loc_4066FB:			       ; CODE XREF: __fflush_nolock+28j
.text:004066FB		       xor     eax, eax
.text:004066FD		       pop     esi
.text:004066FE		       retn
.text:004066FE __fflush_nolock endp
.text:004066FE
.text:004066FF
.text:004066FF ; =============== S U B R O U T I N E =======================================
.text:004066FF
.text:004066FF ; Attributes: bp-based frame
.text:004066FF
.text:004066FF ; int __cdecl flsall(int	flushflag)
.text:004066FF flsall	       proc near	       ; CODE XREF: __fflush_nolock+Ap
.text:004066FF					       ; _fflush+14p ...
.text:004066FF
.text:004066FF err	       = dword ptr -24h
.text:004066FF i	       = dword ptr -20h
.text:004066FF count	       = dword ptr -1Ch
.text:004066FF ms_exc	       = CPPEH_RECORD ptr -18h
.text:004066FF flushflag       = dword ptr  8
.text:004066FF
.text:004066FF		       push    14h
.text:00406701		       push    offset dword_4216F8
.text:00406706		       call    __SEH_prolog4
.text:0040670B		       xor     edi, edi
.text:0040670D		       mov     [ebp+count], edi
.text:00406710		       mov     [ebp+err], edi
.text:00406713		       push    1	       ; locknum
.text:00406715		       call    __lock
.text:0040671A		       pop     ecx
.text:0040671B		       mov     [ebp+ms_exc.disabled], edi
.text:0040671E		       xor     esi, esi
.text:00406720
.text:00406720 loc_406720:			       ; CODE XREF: flsall+9Bj
.text:00406720		       mov     [ebp+i],	esi
.text:00406723		       cmp     esi, __nstream
.text:00406729		       jge     loc_4067B2
.text:0040672F		       mov     eax, ___piob
.text:00406734		       lea     eax, [eax+esi*4]
.text:00406737		       cmp     [eax], edi
.text:00406739		       jz      short $LN25
.text:0040673B		       mov     eax, [eax]
.text:0040673D		       test    byte ptr	[eax+0Ch], 83h
.text:00406741		       jz      short $LN25
.text:00406743		       push    eax	       ; s
.text:00406744		       push    esi	       ; i
.text:00406745		       call    __lock_file2
.text:0040674A		       pop     ecx
.text:0040674B		       pop     ecx
.text:0040674C		       xor     edx, edx
.text:0040674E		       inc     edx
.text:0040674F		       mov     [ebp+ms_exc.disabled], edx
.text:00406752		       mov     eax, ___piob
.text:00406757		       mov     eax, [eax+esi*4]
.text:0040675A		       mov     ecx, [eax+0Ch]
.text:0040675D		       test    cl, 83h
.text:00406760		       jz      short loc_406791
.text:00406762		       cmp     [ebp+flushflag],	edx
.text:00406765		       jnz     short loc_406778
.text:00406767		       push    eax	       ; str
.text:00406768		       call    __fflush_nolock
.text:0040676D		       pop     ecx
.text:0040676E		       cmp     eax, 0FFFFFFFFh
.text:00406771		       jz      short loc_406791
.text:00406773		       inc     [ebp+count]
.text:00406776		       jmp     short loc_406791
.text:00406778 ; ---------------------------------------------------------------------------
.text:00406778
.text:00406778 loc_406778:			       ; CODE XREF: flsall+66j
.text:00406778		       cmp     [ebp+flushflag],	edi
.text:0040677B		       jnz     short loc_406791
.text:0040677D		       test    cl, 2
.text:00406780		       jz      short loc_406791
.text:00406782		       push    eax	       ; str
.text:00406783		       call    __fflush_nolock
.text:00406788		       pop     ecx
.text:00406789		       cmp     eax, 0FFFFFFFFh
.text:0040678C		       jnz     short loc_406791
.text:0040678E		       or      [ebp+err], eax
.text:00406791
.text:00406791 loc_406791:			       ; CODE XREF: flsall+61j
.text:00406791					       ; flsall+72j ...
.text:00406791		       mov     [ebp+ms_exc.disabled], edi
.text:00406794		       call    $LN24_0
.text:00406799
.text:00406799 $LN25:				       ; CODE XREF: flsall+3Aj
.text:00406799					       ; flsall+42j
.text:00406799		       inc     esi
.text:0040679A		       jmp     short loc_406720
.text:0040679C ; ---------------------------------------------------------------------------
.text:0040679C
.text:0040679C $LN22_0:				       ; DATA XREF: .rdata:0042171Co
.text:0040679C		       xor     edi, edi
.text:0040679E		       mov     esi, [ebp+i]
.text:004067A1
.text:004067A1 $LN24_0:				       ; CODE XREF: flsall+95p
.text:004067A1		       mov     eax, ___piob
.text:004067A6		       push    dword ptr [eax+esi*4] ; s
.text:004067A9		       push    esi	       ; i
.text:004067AA		       call    __unlock_file2
.text:004067AF		       pop     ecx
.text:004067B0		       pop     ecx
.text:004067B1
.text:004067B1 $LN23_0:
.text:004067B1		       retn
.text:004067B2 ; ---------------------------------------------------------------------------
.text:004067B2
.text:004067B2 loc_4067B2:			       ; CODE XREF: flsall+2Aj
.text:004067B2		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004067B9		       call    $LN18_0
.text:004067BE
.text:004067BE $LN21_0:
.text:004067BE		       cmp     [ebp+flushflag],	1
.text:004067C2		       mov     eax, [ebp+count]
.text:004067C5		       jz      short loc_4067CA
.text:004067C7		       mov     eax, [ebp+err]
.text:004067CA
.text:004067CA loc_4067CA:			       ; CODE XREF: flsall+C6j
.text:004067CA		       call    __SEH_epilog4
.text:004067CF		       retn
.text:004067D0 ; ---------------------------------------------------------------------------
.text:004067D0
.text:004067D0 $LN18_0:				       ; CODE XREF: flsall+BAp
.text:004067D0					       ; DATA XREF: .rdata:00421710o
.text:004067D0		       push    1	       ; locknum
.text:004067D2		       call    __unlock
.text:004067D7		       pop     ecx
.text:004067D8
.text:004067D8 $LN19_3:
.text:004067D8		       retn
.text:004067D8 flsall	       endp ; sp-analysis failed
.text:004067D8
.text:004067D9
.text:004067D9 ; =============== S U B R O U T I N E =======================================
.text:004067D9
.text:004067D9 ; Attributes: bp-based frame
.text:004067D9
.text:004067D9 ; int __cdecl fflush(_iobuf *stream)
.text:004067D9 _fflush	       proc near
.text:004067D9
.text:004067D9 rc	       = dword ptr -1Ch
.text:004067D9 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004067D9 stream	       = dword ptr  8
.text:004067D9
.text:004067D9		       push    0Ch
.text:004067DB		       push    offset dword_421720
.text:004067E0		       call    __SEH_prolog4
.text:004067E5		       xor     esi, esi
.text:004067E7		       cmp     [ebp+stream], esi
.text:004067EA		       jnz     short loc_4067F5
.text:004067EC		       push    esi	       ; flushflag
.text:004067ED		       call    flsall
.text:004067F2		       pop     ecx
.text:004067F3		       jmp     short loc_40681C
.text:004067F5 ; ---------------------------------------------------------------------------
.text:004067F5
.text:004067F5 loc_4067F5:			       ; CODE XREF: _fflush+11j
.text:004067F5		       push    [ebp+stream]    ; pf
.text:004067F8		       call    __lock_file
.text:004067FD		       pop     ecx
.text:004067FE		       mov     [ebp+ms_exc.disabled], esi
.text:00406801		       push    [ebp+stream]    ; str
.text:00406804		       call    __fflush_nolock
.text:00406809		       pop     ecx
.text:0040680A		       mov     [ebp+rc], eax
.text:0040680D		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00406814		       call    $LN6_5
.text:00406819
.text:00406819 $LN9_3:
.text:00406819		       mov     eax, [ebp+rc]
.text:0040681C
.text:0040681C loc_40681C:			       ; CODE XREF: _fflush+1Aj
.text:0040681C		       call    __SEH_epilog4
.text:00406821		       retn
.text:00406822 ; ---------------------------------------------------------------------------
.text:00406822
.text:00406822 $LN6_5:				       ; CODE XREF: _fflush+3Bp
.text:00406822					       ; DATA XREF: .rdata:00421738o
.text:00406822		       push    [ebp+stream]    ; pf
.text:00406825		       call    __unlock_file
.text:0040682A		       pop     ecx
.text:0040682B
.text:0040682B $LN7_5:
.text:0040682B		       retn
.text:0040682B _fflush	       endp
.text:0040682B
.text:0040682C
.text:0040682C ; =============== S U B R O U T I N E =======================================
.text:0040682C
.text:0040682C
.text:0040682C ; int __cdecl _flushall()
.text:0040682C __flushall      proc near	       ; CODE XREF: ___endstdiop
.text:0040682C		       push    1	       ; flushflag
.text:0040682E		       call    flsall
.text:00406833		       pop     ecx
.text:00406834		       retn
.text:00406834 __flushall      endp
.text:00406834
.text:00406835
.text:00406835 ; =============== S U B R O U T I N E =======================================
.text:00406835
.text:00406835
.text:00406835 ; int __stdcall __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *pPtrs)
.text:00406835 ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z proc near
.text:00406835					       ; DATA XREF: ___CxxSetUnhandledExceptionFiltero
.text:00406835
.text:00406835 pPtrs	       = dword ptr  4
.text:00406835
.text:00406835		       mov     eax, [esp+pPtrs]
.text:00406839		       mov     eax, [eax]
.text:0040683B		       cmp     dword ptr [eax],	0E06D7363h
.text:00406841		       jnz     short $LN6_6
.text:00406843		       cmp     dword ptr [eax+10h], 3
.text:00406847		       jnz     short $LN6_6
.text:00406849		       mov     eax, [eax+14h]
.text:0040684C		       cmp     eax, 19930520h
.text:00406851		       jz      short loc_406868
.text:00406853		       cmp     eax, 19930521h
.text:00406858		       jz      short loc_406868
.text:0040685A		       cmp     eax, 19930522h
.text:0040685F		       jz      short loc_406868
.text:00406861		       cmp     eax, 1994000h
.text:00406866		       jnz     short $LN6_6
.text:00406868
.text:00406868 loc_406868:			       ; CODE XREF: __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+1Cj
.text:00406868					       ; __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+23j ...
.text:00406868		       call    ?terminate@@YAXXZ ; terminate(void)
.text:0040686D ; ---------------------------------------------------------------------------
.text:0040686D
.text:0040686D $LN6_6:				       ; CODE XREF: __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+Cj
.text:0040686D					       ; __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+12j ...
.text:0040686D		       xor     eax, eax
.text:0040686F		       retn    4
.text:0040686F ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z endp
.text:0040686F
.text:00406872
.text:00406872 ; =============== S U B R O U T I N E =======================================
.text:00406872
.text:00406872
.text:00406872 ; int __cdecl __CxxSetUnhandledExceptionFilter()
.text:00406872 ___CxxSetUnhandledExceptionFilter proc near ; DATA XREF:	.rdata:pinit_4o
.text:00406872		       push    offset ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z ; lpTopLevelExceptionFilter
.text:00406877		       call    ds:__imp__SetUnhandledExceptionFilter@4 ; SetUnhandledExceptionFilter(x)
.text:0040687D		       xor     eax, eax
.text:0040687F		       retn
.text:0040687F ___CxxSetUnhandledExceptionFilter endp
.text:0040687F
.text:00406880
.text:00406880 ; =============== S U B R O U T I N E =======================================
.text:00406880
.text:00406880
.text:00406880 ; int __cdecl _setenvp()
.text:00406880 __setenvp       proc near	       ; CODE XREF: __tmainCRTStartup:loc_40241Bp
.text:00406880		       push    ebx
.text:00406881		       xor     ebx, ebx
.text:00406883		       cmp     ___mbctype_initialized, ebx
.text:00406889		       push    esi
.text:0040688A		       push    edi
.text:0040688B		       jnz     short loc_406892
.text:0040688D		       call    ___initmbctable
.text:00406892
.text:00406892 loc_406892:			       ; CODE XREF: __setenvp+Bj
.text:00406892		       mov     esi, __aenvptr
.text:00406898		       xor     edi, edi
.text:0040689A		       cmp     esi, ebx
.text:0040689C		       jnz     short loc_4068B6
.text:0040689E
.text:0040689E loc_40689E:			       ; CODE XREF: __setenvp+51j
.text:0040689E		       or      eax, 0FFFFFFFFh
.text:004068A1		       jmp     loc_406941
.text:004068A6 ; ---------------------------------------------------------------------------
.text:004068A6
.text:004068A6 loc_4068A6:			       ; CODE XREF: __setenvp+3Aj
.text:004068A6		       cmp     al, 3Dh
.text:004068A8		       jz      short loc_4068AB
.text:004068AA		       inc     edi
.text:004068AB
.text:004068AB loc_4068AB:			       ; CODE XREF: __setenvp+28j
.text:004068AB		       push    esi	       ; buf
.text:004068AC		       call    _strlen
.text:004068B1		       pop     ecx
.text:004068B2		       lea     esi, [esi+eax+1]
.text:004068B6
.text:004068B6 loc_4068B6:			       ; CODE XREF: __setenvp+1Cj
.text:004068B6		       mov     al, [esi]
.text:004068B8		       cmp     al, bl
.text:004068BA		       jnz     short loc_4068A6
.text:004068BC		       push    4	       ; size
.text:004068BE		       inc     edi
.text:004068BF		       push    edi	       ; count
.text:004068C0		       call    __calloc_crt
.text:004068C5		       mov     edi, eax
.text:004068C7		       cmp     edi, ebx
.text:004068C9		       pop     ecx
.text:004068CA		       pop     ecx
.text:004068CB		       mov     __environ, edi
.text:004068D1		       jz      short loc_40689E
.text:004068D3		       mov     esi, __aenvptr
.text:004068D9		       push    ebp
.text:004068DA		       jmp     short loc_40691C
.text:004068DC ; ---------------------------------------------------------------------------
.text:004068DC
.text:004068DC loc_4068DC:			       ; CODE XREF: __setenvp+9Ej
.text:004068DC		       push    esi	       ; buf
.text:004068DD		       call    _strlen
.text:004068E2		       mov     ebp, eax
.text:004068E4		       inc     ebp
.text:004068E5		       cmp     byte ptr	[esi], 3Dh
.text:004068E8		       pop     ecx
.text:004068E9		       jz      short loc_40691A
.text:004068EB		       push    1	       ; size
.text:004068ED		       push    ebp	       ; count
.text:004068EE		       call    __calloc_crt
.text:004068F3		       cmp     eax, ebx
.text:004068F5		       pop     ecx
.text:004068F6		       pop     ecx
.text:004068F7		       mov     [edi], eax
.text:004068F9		       jz      short loc_406945
.text:004068FB		       push    esi	       ; _Src
.text:004068FC		       push    ebp	       ; _SizeInBytes
.text:004068FD		       push    eax	       ; _Dst
.text:004068FE		       call    _strcpy_s
.text:00406903		       add     esp, 0Ch
.text:00406906		       test    eax, eax
.text:00406908		       jz      short loc_406917
.text:0040690A		       push    ebx	       ; pReserved
.text:0040690B		       push    ebx	       ; nLine
.text:0040690C		       push    ebx	       ; pszFile
.text:0040690D		       push    ebx	       ; pszFunction
.text:0040690E		       push    ebx	       ; pszExpression
.text:0040690F		       call    __invoke_watson
.text:00406914		       add     esp, 14h
.text:00406917
.text:00406917 loc_406917:			       ; CODE XREF: __setenvp+88j
.text:00406917		       add     edi, 4
.text:0040691A
.text:0040691A loc_40691A:			       ; CODE XREF: __setenvp+69j
.text:0040691A		       add     esi, ebp
.text:0040691C
.text:0040691C loc_40691C:			       ; CODE XREF: __setenvp+5Aj
.text:0040691C		       cmp     [esi], bl
.text:0040691E		       jnz     short loc_4068DC
.text:00406920		       push    __aenvptr       ; pBlock
.text:00406926		       call    _free
.text:0040692B		       mov     __aenvptr, ebx
.text:00406931		       mov     [edi], ebx
.text:00406933		       mov     ___env_initialized, 1
.text:0040693D		       xor     eax, eax
.text:0040693F
.text:0040693F loc_40693F:			       ; CODE XREF: __setenvp+D9j
.text:0040693F		       pop     ecx
.text:00406940		       pop     ebp
.text:00406941
.text:00406941 loc_406941:			       ; CODE XREF: __setenvp+21j
.text:00406941		       pop     edi
.text:00406942		       pop     esi
.text:00406943		       pop     ebx
.text:00406944		       retn
.text:00406945 ; ---------------------------------------------------------------------------
.text:00406945
.text:00406945 loc_406945:			       ; CODE XREF: __setenvp+79j
.text:00406945		       push    __environ       ; pBlock
.text:0040694B		       call    _free
.text:00406950		       mov     __environ, ebx
.text:00406956		       or      eax, 0FFFFFFFFh
.text:00406959		       jmp     short loc_40693F
.text:00406959 __setenvp       endp
.text:00406959
.text:0040695B
.text:0040695B ; =============== S U B R O U T I N E =======================================
.text:0040695B
.text:0040695B
.text:0040695B ; void __cdecl _set_pgmptr(char *_Value)
.text:0040695B __set_pgmptr    proc near
.text:0040695B
.text:0040695B _Value	       = dword ptr  4
.text:0040695B
.text:0040695B		       mov     eax, [esp+_Value]
.text:0040695F		       mov     __pgmptr, eax
.text:00406964		       retn
.text:00406964 __set_pgmptr    endp
.text:00406964
.text:00406965
.text:00406965 ; =============== S U B R O U T I N E =======================================
.text:00406965
.text:00406965 ; Attributes: bp-based frame
.text:00406965
.text:00406965 ; void __usercall parse_cmdline(char *cmdstart<edx>, char **argv, char *args, int *numargs, int *numchars<edi>)
.text:00406965 parse_cmdline   proc near	       ; CODE XREF: __setargv+55p
.text:00406965					       ; __setargv+96p
.text:00406965
.text:00406965 inquote	       = dword ptr -4
.text:00406965 argv	       = dword ptr  8
.text:00406965 args	       = dword ptr  0Ch
.text:00406965 numargs	       = dword ptr  10h
.text:00406965
.text:00406965 cmdstart	= edx
.text:00406965 numchars	= edi
.text:00406965		       push    ebp
.text:00406966		       mov     ebp, esp
.text:00406968		       push    ecx
.text:00406969		       mov     ecx, [ebp+numargs]
.text:0040696C		       push    ebx
.text:0040696D		       xor     eax, eax
.text:0040696F		       cmp     [ebp+argv], eax
.text:00406972		       push    esi
.text:00406973		       mov     [numchars], eax
.text:00406975		       mov     esi, cmdstart
.text:00406977		       mov     cmdstart, [ebp+args]
.text:0040697A		       mov     dword ptr [ecx],	1
.text:00406980		       jz      short loc_40698B
.text:00406982		       mov     ebx, [ebp+argv]
.text:00406985		       add     [ebp+argv], 4
.text:00406989		       mov     [ebx], cmdstart
.text:0040698B
.text:0040698B loc_40698B:			       ; CODE XREF: parse_cmdline+1Bj
.text:0040698B		       mov     [ebp+inquote], eax
.text:0040698E
.text:0040698E loc_40698E:			       ; CODE XREF: parse_cmdline+7Ej
.text:0040698E					       ; parse_cmdline+88j
.text:0040698E		       cmp     byte ptr	[esi], 22h
.text:00406991		       jnz     short loc_4069A3
.text:00406993		       xor     eax, eax
.text:00406995		       cmp     [ebp+inquote], eax
.text:00406998		       mov     bl, 22h
.text:0040699A		       setz    al
.text:0040699D		       inc     esi
.text:0040699E		       mov     [ebp+inquote], eax
.text:004069A1		       jmp     short loc_4069DF
.text:004069A3 ; ---------------------------------------------------------------------------
.text:004069A3
.text:004069A3 loc_4069A3:			       ; CODE XREF: parse_cmdline+2Cj
.text:004069A3		       inc     dword ptr [numchars]
.text:004069A5		       test    cmdstart, cmdstart
.text:004069A7		       jz      short loc_4069B1
.text:004069A9		       mov     al, [esi]
.text:004069AB		       mov     [cmdstart], al
.text:004069AD		       inc     cmdstart
.text:004069AE		       mov     [ebp+args], cmdstart
.text:004069B1
.text:004069B1 loc_4069B1:			       ; CODE XREF: parse_cmdline+42j
.text:004069B1		       mov     bl, [esi]
.text:004069B3		       movzx   eax, bl
.text:004069B6		       push    eax	       ; tst
.text:004069B7		       inc     esi
.text:004069B8		       call    __ismbblead
.text:004069BD		       test    eax, eax
.text:004069BF		       pop     ecx
.text:004069C0		       jz      short loc_4069D5
.text:004069C2		       inc     dword ptr [numchars]
.text:004069C4		       cmp     [ebp+args], 0
.text:004069C8		       jz      short loc_4069D4
.text:004069CA		       mov     ecx, [ebp+args]
.text:004069CD		       mov     al, [esi]
.text:004069CF		       inc     [ebp+args]
.text:004069D2		       mov     [ecx], al
.text:004069D4
.text:004069D4 loc_4069D4:			       ; CODE XREF: parse_cmdline+63j
.text:004069D4		       inc     esi
.text:004069D5
.text:004069D5 loc_4069D5:			       ; CODE XREF: parse_cmdline+5Bj
.text:004069D5		       test    bl, bl
.text:004069D7		       mov     cmdstart, [ebp+args]
.text:004069DA		       mov     ecx, [ebp+numargs]
.text:004069DD		       jz      short loc_406A11
.text:004069DF
.text:004069DF loc_4069DF:			       ; CODE XREF: parse_cmdline+3Cj
.text:004069DF		       cmp     [ebp+inquote], 0
.text:004069E3		       jnz     short loc_40698E
.text:004069E5		       cmp     bl, 20h
.text:004069E8		       jz      short loc_4069EF
.text:004069EA		       cmp     bl, 9
.text:004069ED		       jnz     short loc_40698E
.text:004069EF
.text:004069EF loc_4069EF:			       ; CODE XREF: parse_cmdline+83j
.text:004069EF		       test    cmdstart, cmdstart
.text:004069F1		       jz      short loc_4069F7
.text:004069F3		       mov     byte ptr	[cmdstart-1], 0
.text:004069F7
.text:004069F7 loc_4069F7:			       ; CODE XREF: parse_cmdline+8Cj
.text:004069F7					       ; parse_cmdline+ADj
.text:004069F7		       and     [ebp+inquote], 0
.text:004069FB
.text:004069FB loc_4069FB:			       ; CODE XREF: parse_cmdline+183j
.text:004069FB		       cmp     byte ptr	[esi], 0
.text:004069FE		       jz      loc_406AED
.text:00406A04
.text:00406A04 loc_406A04:			       ; CODE XREF: parse_cmdline+AAj
.text:00406A04		       mov     al, [esi]
.text:00406A06		       cmp     al, 20h
.text:00406A08		       jz      short loc_406A0E
.text:00406A0A		       cmp     al, 9
.text:00406A0C		       jnz     short loc_406A14
.text:00406A0E
.text:00406A0E loc_406A0E:			       ; CODE XREF: parse_cmdline+A3j
.text:00406A0E		       inc     esi
.text:00406A0F		       jmp     short loc_406A04
.text:00406A11 ; ---------------------------------------------------------------------------
.text:00406A11
.text:00406A11 loc_406A11:			       ; CODE XREF: parse_cmdline+78j
.text:00406A11		       dec     esi
.text:00406A12		       jmp     short loc_4069F7
.text:00406A14 ; ---------------------------------------------------------------------------
.text:00406A14
.text:00406A14 loc_406A14:			       ; CODE XREF: parse_cmdline+A7j
.text:00406A14		       cmp     byte ptr	[esi], 0
.text:00406A17		       jz      loc_406AED
.text:00406A1D		       cmp     [ebp+argv], 0
.text:00406A21		       jz      short loc_406A2C
.text:00406A23		       mov     eax, [ebp+argv]
.text:00406A26		       add     [ebp+argv], 4
.text:00406A2A		       mov     [eax], cmdstart
.text:00406A2C
.text:00406A2C loc_406A2C:			       ; CODE XREF: parse_cmdline+BCj
.text:00406A2C		       inc     dword ptr [ecx]
.text:00406A2E
.text:00406A2E loc_406A2E:			       ; CODE XREF: parse_cmdline+16Ej
.text:00406A2E		       xor     ebx, ebx
.text:00406A30		       inc     ebx
.text:00406A31		       xor     ecx, ecx
.text:00406A33		       jmp     short loc_406A37
.text:00406A35 ; ---------------------------------------------------------------------------
.text:00406A35
.text:00406A35 loc_406A35:			       ; CODE XREF: parse_cmdline+D5j
.text:00406A35		       inc     esi
.text:00406A36		       inc     ecx
.text:00406A37
.text:00406A37 loc_406A37:			       ; CODE XREF: parse_cmdline+CEj
.text:00406A37		       cmp     byte ptr	[esi], 5Ch
.text:00406A3A		       jz      short loc_406A35
.text:00406A3C		       cmp     byte ptr	[esi], 22h
.text:00406A3F		       jnz     short loc_406A67
.text:00406A41		       test    cl, 1
.text:00406A44		       jnz     short loc_406A65
.text:00406A46		       cmp     [ebp+inquote], 0
.text:00406A4A		       jz      short loc_406A58
.text:00406A4C		       lea     eax, [esi+1]
.text:00406A4F		       cmp     byte ptr	[eax], 22h
.text:00406A52		       jnz     short loc_406A58
.text:00406A54		       mov     esi, eax
.text:00406A56		       jmp     short loc_406A65
.text:00406A58 ; ---------------------------------------------------------------------------
.text:00406A58
.text:00406A58 loc_406A58:			       ; CODE XREF: parse_cmdline+E5j
.text:00406A58					       ; parse_cmdline+EDj
.text:00406A58		       xor     eax, eax
.text:00406A5A		       xor     ebx, ebx
.text:00406A5C		       cmp     [ebp+inquote], eax
.text:00406A5F		       setz    al
.text:00406A62		       mov     [ebp+inquote], eax
.text:00406A65
.text:00406A65 loc_406A65:			       ; CODE XREF: parse_cmdline+DFj
.text:00406A65					       ; parse_cmdline+F1j
.text:00406A65		       shr     ecx, 1
.text:00406A67
.text:00406A67 loc_406A67:			       ; CODE XREF: parse_cmdline+DAj
.text:00406A67		       test    ecx, ecx
.text:00406A69		       jz      short loc_406A7D
.text:00406A6B
.text:00406A6B loc_406A6B:			       ; CODE XREF: parse_cmdline+113j
.text:00406A6B		       dec     ecx
.text:00406A6C		       test    cmdstart, cmdstart
.text:00406A6E		       jz      short loc_406A74
.text:00406A70		       mov     byte ptr	[cmdstart], 5Ch
.text:00406A73		       inc     cmdstart
.text:00406A74
.text:00406A74 loc_406A74:			       ; CODE XREF: parse_cmdline+109j
.text:00406A74		       inc     dword ptr [numchars]
.text:00406A76		       test    ecx, ecx
.text:00406A78		       jnz     short loc_406A6B
.text:00406A7A		       mov     [ebp+args], cmdstart
.text:00406A7D
.text:00406A7D loc_406A7D:			       ; CODE XREF: parse_cmdline+104j
.text:00406A7D		       mov     al, [esi]
.text:00406A7F		       test    al, al
.text:00406A81		       jz      short loc_406AD8
.text:00406A83		       cmp     [ebp+inquote], 0
.text:00406A87		       jnz     short loc_406A91
.text:00406A89		       cmp     al, 20h
.text:00406A8B		       jz      short loc_406AD8
.text:00406A8D		       cmp     al, 9
.text:00406A8F		       jz      short loc_406AD8
.text:00406A91
.text:00406A91 loc_406A91:			       ; CODE XREF: parse_cmdline+122j
.text:00406A91		       test    ebx, ebx
.text:00406A93		       jz      short loc_406AD2
.text:00406A95		       test    cmdstart, cmdstart
.text:00406A97		       movsx   eax, al
.text:00406A9A		       push    eax	       ; tst
.text:00406A9B		       jz      short loc_406AC0
.text:00406A9D		       call    __ismbblead
.text:00406AA2		       test    eax, eax
.text:00406AA4		       pop     ecx
.text:00406AA5		       jz      short loc_406AB4
.text:00406AA7		       mov     al, [esi]
.text:00406AA9		       mov     ecx, [ebp+args]
.text:00406AAC		       inc     [ebp+args]
.text:00406AAF		       mov     [ecx], al
.text:00406AB1		       inc     esi
.text:00406AB2		       inc     dword ptr [numchars]
.text:00406AB4
.text:00406AB4 loc_406AB4:			       ; CODE XREF: parse_cmdline+140j
.text:00406AB4		       mov     ecx, [ebp+args]
.text:00406AB7		       mov     al, [esi]
.text:00406AB9		       inc     [ebp+args]
.text:00406ABC		       mov     [ecx], al
.text:00406ABE		       jmp     short loc_406ACD
.text:00406AC0 ; ---------------------------------------------------------------------------
.text:00406AC0
.text:00406AC0 loc_406AC0:			       ; CODE XREF: parse_cmdline+136j
.text:00406AC0		       call    __ismbblead
.text:00406AC5		       test    eax, eax
.text:00406AC7		       pop     ecx
.text:00406AC8		       jz      short loc_406ACD
.text:00406ACA		       inc     esi
.text:00406ACB		       inc     dword ptr [numchars]
.text:00406ACD
.text:00406ACD loc_406ACD:			       ; CODE XREF: parse_cmdline+159j
.text:00406ACD					       ; parse_cmdline+163j
.text:00406ACD		       inc     dword ptr [numchars]
.text:00406ACF		       mov     cmdstart, [ebp+args]
.text:00406AD2
.text:00406AD2 loc_406AD2:			       ; CODE XREF: parse_cmdline+12Ej
.text:00406AD2		       inc     esi
.text:00406AD3		       jmp     loc_406A2E
.text:00406AD8 ; ---------------------------------------------------------------------------
.text:00406AD8
.text:00406AD8 loc_406AD8:			       ; CODE XREF: parse_cmdline+11Cj
.text:00406AD8					       ; parse_cmdline+126j ...
.text:00406AD8		       test    cmdstart, cmdstart
.text:00406ADA		       jz      short loc_406AE3
.text:00406ADC		       mov     byte ptr	[cmdstart], 0
.text:00406ADF		       inc     cmdstart
.text:00406AE0		       mov     [ebp+args], cmdstart
.text:00406AE3
.text:00406AE3 loc_406AE3:			       ; CODE XREF: parse_cmdline+175j
.text:00406AE3		       inc     dword ptr [numchars]
.text:00406AE5		       mov     ecx, [ebp+numargs]
.text:00406AE8		       jmp     loc_4069FB
.text:00406AED ; ---------------------------------------------------------------------------
.text:00406AED
.text:00406AED loc_406AED:			       ; CODE XREF: parse_cmdline+99j
.text:00406AED					       ; parse_cmdline+B2j
.text:00406AED		       mov     eax, [ebp+argv]
.text:00406AF0		       test    eax, eax
.text:00406AF2		       pop     esi
.text:00406AF3		       pop     ebx
.text:00406AF4		       jz      short loc_406AF9
.text:00406AF6		       and     dword ptr [eax],	0
.text:00406AF9
.text:00406AF9 loc_406AF9:			       ; CODE XREF: parse_cmdline+18Fj
.text:00406AF9		       inc     dword ptr [ecx]
.text:00406AFB		       leave
.text:00406AFC		       retn
.text:00406AFC parse_cmdline   endp
.text:00406AFC
.text:00406AFD
.text:00406AFD ; =============== S U B R O U T I N E =======================================
.text:00406AFD
.text:00406AFD ; Attributes: bp-based frame
.text:00406AFD
.text:00406AFD ; int __cdecl _setargv()
.text:00406AFD __setargv       proc near	       ; CODE XREF: __tmainCRTStartup+10Ep
.text:00406AFD
.text:00406AFD numchars	       = dword ptr -0Ch
.text:00406AFD numargs	       = dword ptr -8
.text:00406AFD cmdstart	       = dword ptr -4
.text:00406AFD
.text:00406AFD		       push    ebp
.text:00406AFE		       mov     ebp, esp
.text:00406B00		       sub     esp, 0Ch
.text:00406B03		       push    ebx
.text:00406B04		       xor     ebx, ebx
.text:00406B06		       cmp     ___mbctype_initialized, ebx
.text:00406B0C		       push    esi
.text:00406B0D		       push    edi
.text:00406B0E		       jnz     short loc_406B15
.text:00406B10		       call    ___initmbctable
.text:00406B15
.text:00406B15 loc_406B15:			       ; CODE XREF: __setargv+11j
.text:00406B15		       push    104h	       ; nSize
.text:00406B1A		       mov     esi, offset _pgmname
.text:00406B1F		       push    esi	       ; lpFilename
.text:00406B20		       push    ebx	       ; hModule
.text:00406B21		       mov     _pgmname+104h, bl
.text:00406B27		       call    ds:__imp__GetModuleFileNameA@12 ; GetModuleFileNameA(x,x,x)
.text:00406B2D		       mov     eax, __acmdln
.text:00406B32		       cmp     eax, ebx
.text:00406B34		       mov     __pgmptr, esi
.text:00406B3A		       jz      short loc_406B43
.text:00406B3C		       cmp     [eax], bl
.text:00406B3E		       mov     [ebp+cmdstart], eax
.text:00406B41		       jnz     short loc_406B46
.text:00406B43
.text:00406B43 loc_406B43:			       ; CODE XREF: __setargv+3Dj
.text:00406B43		       mov     [ebp+cmdstart], esi
.text:00406B46
.text:00406B46 loc_406B46:			       ; CODE XREF: __setargv+44j
.text:00406B46		       mov     edx, [ebp+cmdstart] ; cmdstart
.text:00406B49		       lea     eax, [ebp+numargs]
.text:00406B4C		       push    eax	       ; numargs
.text:00406B4D		       push    ebx	       ; args
.text:00406B4E		       push    ebx	       ; argv
.text:00406B4F		       lea     edi, [ebp+numchars] ; numchars
.text:00406B52		       call    parse_cmdline
.text:00406B57		       mov     eax, [ebp+numargs]
.text:00406B5A		       add     esp, 0Ch
.text:00406B5D		       cmp     eax, 3FFFFFFFh
.text:00406B62		       jnb     short loc_406BAE
.text:00406B64		       mov     ecx, [ebp+numchars]
.text:00406B67		       cmp     ecx, 0FFFFFFFFh
.text:00406B6A		       jnb     short loc_406BAE
.text:00406B6C		       mov     edi, eax
.text:00406B6E		       shl     edi, 2
.text:00406B71		       lea     eax, [edi+ecx]
.text:00406B74		       cmp     eax, ecx
.text:00406B76		       jb      short loc_406BAE
.text:00406B78		       push    eax	       ; cb
.text:00406B79		       call    __malloc_crt
.text:00406B7E		       mov     esi, eax
.text:00406B80		       cmp     esi, ebx
.text:00406B82		       pop     ecx
.text:00406B83		       jz      short loc_406BAE
.text:00406B85		       mov     edx, [ebp+cmdstart] ; cmdstart
.text:00406B88		       lea     eax, [ebp+numargs]
.text:00406B8B		       push    eax	       ; numargs
.text:00406B8C		       add     edi, esi
.text:00406B8E		       push    edi	       ; args
.text:00406B8F		       push    esi	       ; argv
.text:00406B90		       lea     edi, [ebp+numchars] ; numchars
.text:00406B93		       call    parse_cmdline
.text:00406B98		       mov     eax, [ebp+numargs]
.text:00406B9B		       add     esp, 0Ch
.text:00406B9E		       dec     eax
.text:00406B9F		       mov     ___argc,	eax
.text:00406BA4		       mov     ___argv,	esi
.text:00406BAA		       xor     eax, eax
.text:00406BAC		       jmp     short loc_406BB1
.text:00406BAE ; ---------------------------------------------------------------------------
.text:00406BAE
.text:00406BAE loc_406BAE:			       ; CODE XREF: __setargv+65j
.text:00406BAE					       ; __setargv+6Dj	...
.text:00406BAE		       or      eax, 0FFFFFFFFh
.text:00406BB1
.text:00406BB1 loc_406BB1:			       ; CODE XREF: __setargv+AFj
.text:00406BB1		       pop     edi
.text:00406BB2		       pop     esi
.text:00406BB3		       pop     ebx
.text:00406BB4		       leave
.text:00406BB5		       retn
.text:00406BB5 __setargv       endp
.text:00406BB5
.text:00406BB6
.text:00406BB6 ; =============== S U B R O U T I N E =======================================
.text:00406BB6
.text:00406BB6
.text:00406BB6 ; void *__cdecl __crtGetEnvironmentStringsA()
.text:00406BB6 ___crtGetEnvironmentStringsA proc near  ; CODE XREF: __tmainCRTStartup+104p
.text:00406BB6
.text:00406BB6 aEnv	       = dword ptr -0Ch
.text:00406BB6 nSizeW	       = dword ptr -8
.text:00406BB6 cchWideChar     = dword ptr -4
.text:00406BB6
.text:00406BB6		       push    ecx
.text:00406BB7		       push    ecx
.text:00406BB8		       mov     eax, f_use
.text:00406BBD		       push    ebx
.text:00406BBE		       push    ebp
.text:00406BBF		       push    esi
.text:00406BC0		       push    edi
.text:00406BC1		       mov     edi, ds:__imp__GetEnvironmentStringsW@0 ; GetEnvironmentStringsW()
.text:00406BC7		       xor     ebx, ebx
.text:00406BC9		       xor     esi, esi
.text:00406BCB		       cmp     eax, ebx
.text:00406BCD		       push    2
.text:00406BCF		       pop     ebp
.text:00406BD0		       jnz     short loc_406BFF
.text:00406BD2		       call    edi ; GetEnvironmentStringsW() ;	GetEnvironmentStringsW()
.text:00406BD4		       mov     esi, eax
.text:00406BD6		       cmp     esi, ebx
.text:00406BD8		       jz      short loc_406BE6
.text:00406BDA		       mov     f_use, 1
.text:00406BE4		       jmp     short loc_406C08
.text:00406BE6 ; ---------------------------------------------------------------------------
.text:00406BE6
.text:00406BE6 loc_406BE6:			       ; CODE XREF: ___crtGetEnvironmentStringsA+22j
.text:00406BE6		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00406BEC		       cmp     eax, 78h
.text:00406BEF		       jnz     short loc_406BFA
.text:00406BF1		       mov     eax, ebp
.text:00406BF3		       mov     f_use, eax
.text:00406BF8		       jmp     short loc_406BFF
.text:00406BFA ; ---------------------------------------------------------------------------
.text:00406BFA
.text:00406BFA loc_406BFA:			       ; CODE XREF: ___crtGetEnvironmentStringsA+39j
.text:00406BFA		       mov     eax, f_use
.text:00406BFF
.text:00406BFF loc_406BFF:			       ; CODE XREF: ___crtGetEnvironmentStringsA+1Aj
.text:00406BFF					       ; ___crtGetEnvironmentStringsA+42j
.text:00406BFF		       cmp     eax, 1
.text:00406C02		       jnz     loc_406C8C
.text:00406C08
.text:00406C08 loc_406C08:			       ; CODE XREF: ___crtGetEnvironmentStringsA+2Ej
.text:00406C08		       cmp     esi, ebx
.text:00406C0A		       jnz     short loc_406C1B
.text:00406C0C		       call    edi ; GetEnvironmentStringsW() ;	GetEnvironmentStringsW()
.text:00406C0E		       mov     esi, eax
.text:00406C10		       cmp     esi, ebx
.text:00406C12		       jnz     short loc_406C1B
.text:00406C14
.text:00406C14 loc_406C14:			       ; CODE XREF: ___crtGetEnvironmentStringsA+DCj
.text:00406C14					       ; ___crtGetEnvironmentStringsA+E8j ...
.text:00406C14		       xor     eax, eax
.text:00406C16		       jmp     loc_406CE4
.text:00406C1B ; ---------------------------------------------------------------------------
.text:00406C1B
.text:00406C1B loc_406C1B:			       ; CODE XREF: ___crtGetEnvironmentStringsA+54j
.text:00406C1B					       ; ___crtGetEnvironmentStringsA+5Cj
.text:00406C1B		       cmp     [esi], bx
.text:00406C1E		       mov     eax, esi
.text:00406C20		       jz      short loc_406C30
.text:00406C22
.text:00406C22 loc_406C22:			       ; CODE XREF: ___crtGetEnvironmentStringsA+71j
.text:00406C22					       ; ___crtGetEnvironmentStringsA+78j
.text:00406C22		       add     eax, ebp
.text:00406C24		       cmp     [eax], bx
.text:00406C27		       jnz     short loc_406C22
.text:00406C29		       add     eax, ebp
.text:00406C2B		       cmp     [eax], bx
.text:00406C2E		       jnz     short loc_406C22
.text:00406C30
.text:00406C30 loc_406C30:			       ; CODE XREF: ___crtGetEnvironmentStringsA+6Aj
.text:00406C30		       mov     edi, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00406C36		       push    ebx	       ; lpUsedDefaultChar
.text:00406C37		       push    ebx	       ; lpDefaultChar
.text:00406C38		       push    ebx	       ; cbMultiByte
.text:00406C39		       sub     eax, esi
.text:00406C3B		       push    ebx	       ; lpMultiByteStr
.text:00406C3C		       sar     eax, 1
.text:00406C3E		       inc     eax
.text:00406C3F		       push    eax	       ; cchWideChar
.text:00406C40		       push    esi	       ; lpWideCharStr
.text:00406C41		       push    ebx	       ; dwFlags
.text:00406C42		       push    ebx	       ; CodePage
.text:00406C43		       mov     [esp+38h+cchWideChar], eax
.text:00406C47		       call    edi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00406C49		       mov     ebp, eax
.text:00406C4B		       cmp     ebp, ebx
.text:00406C4D		       jz      short loc_406C81
.text:00406C4F		       push    ebp	       ; cb
.text:00406C50		       call    __malloc_crt
.text:00406C55		       cmp     eax, ebx
.text:00406C57		       pop     ecx
.text:00406C58		       mov     [esp+18h+nSizeW], eax
.text:00406C5C		       jz      short loc_406C81
.text:00406C5E		       push    ebx	       ; lpUsedDefaultChar
.text:00406C5F		       push    ebx	       ; lpDefaultChar
.text:00406C60		       push    ebp	       ; cbMultiByte
.text:00406C61		       push    eax	       ; lpMultiByteStr
.text:00406C62		       push    [esp+28h+cchWideChar] ; cchWideChar
.text:00406C66		       push    esi	       ; lpWideCharStr
.text:00406C67		       push    ebx	       ; dwFlags
.text:00406C68		       push    ebx	       ; CodePage
.text:00406C69		       call    edi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00406C6B		       test    eax, eax
.text:00406C6D		       jnz     short loc_406C7D
.text:00406C6F		       push    [esp+18h+nSizeW]	; pBlock
.text:00406C73		       call    _free
.text:00406C78		       pop     ecx
.text:00406C79		       mov     [esp+18h+nSizeW], ebx
.text:00406C7D
.text:00406C7D loc_406C7D:			       ; CODE XREF: ___crtGetEnvironmentStringsA+B7j
.text:00406C7D		       mov     ebx, [esp+18h+nSizeW]
.text:00406C81
.text:00406C81 loc_406C81:			       ; CODE XREF: ___crtGetEnvironmentStringsA+97j
.text:00406C81					       ; ___crtGetEnvironmentStringsA+A6j
.text:00406C81		       push    esi	       ; LPWCH
.text:00406C82		       call    ds:__imp__FreeEnvironmentStringsW@4 ; FreeEnvironmentStringsW(x)
.text:00406C88		       mov     eax, ebx
.text:00406C8A		       jmp     short loc_406CE4
.text:00406C8C ; ---------------------------------------------------------------------------
.text:00406C8C
.text:00406C8C loc_406C8C:			       ; CODE XREF: ___crtGetEnvironmentStringsA+4Cj
.text:00406C8C		       cmp     eax, ebp
.text:00406C8E		       jz      short loc_406C94
.text:00406C90		       cmp     eax, ebx
.text:00406C92		       jnz     short loc_406C14
.text:00406C94
.text:00406C94 loc_406C94:			       ; CODE XREF: ___crtGetEnvironmentStringsA+D8j
.text:00406C94		       call    ds:__imp__GetEnvironmentStrings@0 ; GetEnvironmentStrings()
.text:00406C9A		       mov     esi, eax
.text:00406C9C		       cmp     esi, ebx
.text:00406C9E		       jz      loc_406C14
.text:00406CA4		       cmp     [esi], bl
.text:00406CA6		       jz      short loc_406CB2
.text:00406CA8
.text:00406CA8 loc_406CA8:			       ; CODE XREF: ___crtGetEnvironmentStringsA+F5j
.text:00406CA8					       ; ___crtGetEnvironmentStringsA+FAj
.text:00406CA8		       inc     eax
.text:00406CA9		       cmp     [eax], bl
.text:00406CAB		       jnz     short loc_406CA8
.text:00406CAD		       inc     eax
.text:00406CAE		       cmp     [eax], bl
.text:00406CB0		       jnz     short loc_406CA8
.text:00406CB2
.text:00406CB2 loc_406CB2:			       ; CODE XREF: ___crtGetEnvironmentStringsA+F0j
.text:00406CB2		       sub     eax, esi
.text:00406CB4		       inc     eax
.text:00406CB5		       mov     ebp, eax
.text:00406CB7		       push    ebp	       ; cb
.text:00406CB8		       call    __malloc_crt
.text:00406CBD		       mov     edi, eax
.text:00406CBF		       cmp     edi, ebx
.text:00406CC1		       pop     ecx
.text:00406CC2		       jnz     short loc_406CD0
.text:00406CC4		       push    esi	       ; LPCH
.text:00406CC5		       call    ds:__imp__FreeEnvironmentStringsA@4 ; FreeEnvironmentStringsA(x)
.text:00406CCB		       jmp     loc_406C14
.text:00406CD0 ; ---------------------------------------------------------------------------
.text:00406CD0
.text:00406CD0 loc_406CD0:			       ; CODE XREF: ___crtGetEnvironmentStringsA+10Cj
.text:00406CD0		       push    ebp	       ; count
.text:00406CD1		       push    esi	       ; src
.text:00406CD2		       push    edi	       ; dst
.text:00406CD3		       call    _memcpy
.text:00406CD8		       add     esp, 0Ch
.text:00406CDB		       push    esi	       ; LPCH
.text:00406CDC		       call    ds:__imp__FreeEnvironmentStringsA@4 ; FreeEnvironmentStringsA(x)
.text:00406CE2		       mov     eax, edi
.text:00406CE4
.text:00406CE4 loc_406CE4:			       ; CODE XREF: ___crtGetEnvironmentStringsA+60j
.text:00406CE4					       ; ___crtGetEnvironmentStringsA+D4j
.text:00406CE4		       pop     edi
.text:00406CE5		       pop     esi
.text:00406CE6		       pop     ebp
.text:00406CE7		       pop     ebx
.text:00406CE8		       pop     ecx
.text:00406CE9		       pop     ecx
.text:00406CEA		       retn
.text:00406CEA ___crtGetEnvironmentStringsA endp
.text:00406CEA
.text:00406CEB
.text:00406CEB ; =============== S U B R O U T I N E =======================================
.text:00406CEB
.text:00406CEB ; Attributes: bp-based frame
.text:00406CEB
.text:00406CEB ___security_init_cookie proc near       ; CODE XREF: _mainCRTStartupp
.text:00406CEB
.text:00406CEB perfctr	       = _LARGE_INTEGER	ptr -10h
.text:00406CEB systime	       = FT ptr	-8
.text:00406CEB
.text:00406CEB		       push    ebp
.text:00406CEC		       mov     ebp, esp
.text:00406CEE		       sub     esp, 10h
.text:00406CF1		       mov     eax, ___security_cookie
.text:00406CF6		       and     dword ptr [ebp+systime],	0
.text:00406CFA		       and     dword ptr [ebp+systime+4], 0
.text:00406CFE		       push    ebx
.text:00406CFF		       push    edi
.text:00406D00		       mov     edi, 0BB40E64Eh
.text:00406D05		       cmp     eax, edi
.text:00406D07		       mov     ebx, 0FFFF0000h
.text:00406D0C		       jz      short loc_406D1B
.text:00406D0E		       test    ebx, eax
.text:00406D10		       jz      short loc_406D1B
.text:00406D12		       not     eax
.text:00406D14		       mov     ___security_cookie_complement, eax
.text:00406D19		       jmp     short loc_406D7B
.text:00406D1B ; ---------------------------------------------------------------------------
.text:00406D1B
.text:00406D1B loc_406D1B:			       ; CODE XREF: ___security_init_cookie+21j
.text:00406D1B					       ; ___security_init_cookie+25j
.text:00406D1B		       push    esi
.text:00406D1C		       lea     eax, [ebp+systime]
.text:00406D1F		       push    eax	       ; lpSystemTimeAsFileTime
.text:00406D20		       call    ds:__imp__GetSystemTimeAsFileTime@4 ; GetSystemTimeAsFileTime(x)
.text:00406D26		       mov     esi, dword ptr [ebp+systime+4]
.text:00406D29		       xor     esi, dword ptr [ebp+systime]
.text:00406D2C		       call    ds:__imp__GetCurrentProcessId@0 ; GetCurrentProcessId()
.text:00406D32		       xor     esi, eax
.text:00406D34		       call    ds:__imp__GetCurrentThreadId@0 ;	GetCurrentThreadId()
.text:00406D3A		       xor     esi, eax
.text:00406D3C		       call    ds:__imp__GetTickCount@0	; GetTickCount()
.text:00406D42		       xor     esi, eax
.text:00406D44		       lea     eax, [ebp+perfctr]
.text:00406D47		       push    eax	       ; lpPerformanceCount
.text:00406D48		       call    ds:__imp__QueryPerformanceCounter@4 ; QueryPerformanceCounter(x)
.text:00406D4E		       mov     eax, dword ptr [ebp+perfctr+4]
.text:00406D51		       xor     eax, dword ptr [ebp+perfctr]
.text:00406D54		       xor     esi, eax
.text:00406D56		       cmp     esi, edi
.text:00406D58		       jnz     short loc_406D61
.text:00406D5A		       mov     esi, 0BB40E64Fh
.text:00406D5F		       jmp     short loc_406D6C
.text:00406D61 ; ---------------------------------------------------------------------------
.text:00406D61
.text:00406D61 loc_406D61:			       ; CODE XREF: ___security_init_cookie+6Dj
.text:00406D61		       test    ebx, esi
.text:00406D63		       jnz     short loc_406D6C
.text:00406D65		       mov     eax, esi
.text:00406D67		       shl     eax, 10h
.text:00406D6A		       or      esi, eax
.text:00406D6C
.text:00406D6C loc_406D6C:			       ; CODE XREF: ___security_init_cookie+74j
.text:00406D6C					       ; ___security_init_cookie+78j
.text:00406D6C		       mov     ___security_cookie, esi
.text:00406D72		       not     esi
.text:00406D74		       mov     ___security_cookie_complement, esi
.text:00406D7A		       pop     esi
.text:00406D7B
.text:00406D7B loc_406D7B:			       ; CODE XREF: ___security_init_cookie+2Ej
.text:00406D7B		       pop     edi
.text:00406D7C		       pop     ebx
.text:00406D7D		       leave
.text:00406D7E		       retn
.text:00406D7E ___security_init_cookie endp
.text:00406D7E
.text:00406D7F
.text:00406D7F ; =============== S U B R O U T I N E =======================================
.text:00406D7F
.text:00406D7F
.text:00406D7F ; int __cdecl _isatty(int fh)
.text:00406D7F __isatty	       proc near	       ; CODE XREF: __stbuf+Cp
.text:00406D7F					       ; __flsbuf+91p ...
.text:00406D7F
.text:00406D7F fh	       = dword ptr  4
.text:00406D7F
.text:00406D7F		       mov     eax, [esp+fh]
.text:00406D83		       cmp     eax, 0FFFFFFFEh
.text:00406D86		       jnz     short loc_406D96
.text:00406D88		       call    __errno
.text:00406D8D		       mov     dword ptr [eax],	9
.text:00406D93		       xor     eax, eax
.text:00406D95		       retn
.text:00406D96 ; ---------------------------------------------------------------------------
.text:00406D96
.text:00406D96 loc_406D96:			       ; CODE XREF: __isatty+7j
.text:00406D96		       push    esi
.text:00406D97		       xor     esi, esi
.text:00406D99		       cmp     eax, esi
.text:00406D9B		       jl      short loc_406DA5
.text:00406D9D		       cmp     eax, __nhandle
.text:00406DA3		       jb      short loc_406DC1
.text:00406DA5
.text:00406DA5 loc_406DA5:			       ; CODE XREF: __isatty+1Cj
.text:00406DA5		       call    __errno
.text:00406DAA		       push    esi	       ; pReserved
.text:00406DAB		       push    esi	       ; nLine
.text:00406DAC		       push    esi	       ; pszFile
.text:00406DAD		       push    esi	       ; pszFunction
.text:00406DAE		       push    esi	       ; pszExpression
.text:00406DAF		       mov     dword ptr [eax],	9
.text:00406DB5		       call    __invalid_parameter
.text:00406DBA		       add     esp, 14h
.text:00406DBD		       xor     eax, eax
.text:00406DBF		       pop     esi
.text:00406DC0		       retn
.text:00406DC1 ; ---------------------------------------------------------------------------
.text:00406DC1
.text:00406DC1 loc_406DC1:			       ; CODE XREF: __isatty+24j
.text:00406DC1		       mov     ecx, eax
.text:00406DC3		       and     eax, 1Fh
.text:00406DC6		       sar     ecx, 5
.text:00406DC9		       mov     ecx, ___pioinfo[ecx*4]
.text:00406DD0		       shl     eax, 6
.text:00406DD3		       movzx   eax, byte ptr [ecx+eax+4]
.text:00406DD8		       and     eax, 40h
.text:00406DDB		       pop     esi
.text:00406DDC		       retn
.text:00406DDC __isatty	       endp
.text:00406DDC
.text:00406DDD
.text:00406DDD ; =============== S U B R O U T I N E =======================================
.text:00406DDD
.text:00406DDD
.text:00406DDD ; int __usercall	CPtoLCID<eax>(int codepage<eax>)
.text:00406DDD CPtoLCID	       proc near	       ; CODE XREF: __setmbcp_nolock+14Cp
.text:00406DDD					       ; __setmbcp_nolock+1A1p
.text:00406DDD codepage	= eax
.text:00406DDD		       sub     codepage, 3A4h
.text:00406DE2		       jz      short loc_406E06
.text:00406DE4		       sub     codepage, 4
.text:00406DE7		       jz      short loc_406E00
.text:00406DE9		       sub     codepage, 0Dh
.text:00406DEC		       jz      short loc_406DFA
.text:00406DEE		       dec     codepage
.text:00406DEF		       jz      short loc_406DF4
.text:00406DF1		       xor     codepage, codepage
.text:00406DF3		       retn
.text:00406DF4 ; ---------------------------------------------------------------------------
.text:00406DF4
.text:00406DF4 loc_406DF4:			       ; CODE XREF: CPtoLCID+12j
.text:00406DF4		       mov     codepage, 404h
.text:00406DF9		       retn
.text:00406DFA ; ---------------------------------------------------------------------------
.text:00406DFA
.text:00406DFA loc_406DFA:			       ; CODE XREF: CPtoLCID+Fj
.text:00406DFA		       mov     codepage, 412h
.text:00406DFF		       retn
.text:00406E00 ; ---------------------------------------------------------------------------
.text:00406E00
.text:00406E00 loc_406E00:			       ; CODE XREF: CPtoLCID+Aj
.text:00406E00		       mov     codepage, 804h
.text:00406E05		       retn
.text:00406E06 ; ---------------------------------------------------------------------------
.text:00406E06
.text:00406E06 loc_406E06:			       ; CODE XREF: CPtoLCID+5j
.text:00406E06		       mov     codepage, 411h
.text:00406E0B		       retn
.text:00406E0B CPtoLCID	       endp
.text:00406E0B
.text:00406E0C
.text:00406E0C ; =============== S U B R O U T I N E =======================================
.text:00406E0C
.text:00406E0C
.text:00406E0C ; void __usercall setSBCS(threadmbcinfostruct *ptmbci<eax>)
.text:00406E0C setSBCS	       proc near	       ; CODE XREF: __setmbcp_nolock+2Bp
.text:00406E0C ptmbci =	eax
.text:00406E0C		       push    ebx
.text:00406E0D		       push    ebp
.text:00406E0E		       push    esi
.text:00406E0F		       push    edi
.text:00406E10		       mov     ebp, 101h
.text:00406E15		       mov     esi, ptmbci
.text:00406E17		       push    ebp
.text:00406E18		       xor     edi, edi
.text:00406E1A		       lea     ebx, [esi+1Ch]
.text:00406E1D		       push    edi	       ; value
.text:00406E1E		       push    ebx	       ; dst
.text:00406E1F		       call    _memset
.text:00406E24		       mov     [esi+4],	edi
.text:00406E27		       mov     [esi+8],	edi
.text:00406E2A		       mov     [esi+0Ch], edi
.text:00406E2D		       xor     ptmbci, ptmbci
.text:00406E2F		       lea     edi, [esi+10h]
.text:00406E32		       stosd
.text:00406E33		       stosd
.text:00406E34		       stosd
.text:00406E35		       mov     ptmbci, offset ___initialmbcinfo
.text:00406E3A		       add     esp, 0Ch
.text:00406E3D		       sub     ptmbci, esi
.text:00406E3F
.text:00406E3F loc_406E3F:			       ; CODE XREF: setSBCS+3Aj
.text:00406E3F		       mov     cl, [ptmbci+ebx]
.text:00406E42		       mov     [ebx], cl
.text:00406E44		       inc     ebx
.text:00406E45		       dec     ebp
.text:00406E46		       jnz     short loc_406E3F
.text:00406E48		       lea     ecx, [esi+11Dh]
.text:00406E4E		       mov     esi, 100h
.text:00406E53
.text:00406E53 loc_406E53:			       ; CODE XREF: setSBCS+4Ej
.text:00406E53		       mov     dl, [ecx+ptmbci]
.text:00406E56		       mov     [ecx], dl
.text:00406E58		       inc     ecx
.text:00406E59		       dec     esi
.text:00406E5A		       jnz     short loc_406E53
.text:00406E5C		       pop     edi
.text:00406E5D		       pop     esi
.text:00406E5E		       pop     ebp
.text:00406E5F		       pop     ebx
.text:00406E60		       retn
.text:00406E60 setSBCS	       endp
.text:00406E60
.text:00406E61
.text:00406E61 ; =============== S U B R O U T I N E =======================================
.text:00406E61
.text:00406E61 ; Attributes: bp-based frame fpd=49Ch
.text:00406E61
.text:00406E61 ; void __usercall setSBUpLow(threadmbcinfostruct	*ptmbci<esi>)
.text:00406E61 setSBUpLow      proc near	       ; CODE XREF: __setmbcp_nolock+16Fp
.text:00406E61
.text:00406E61 var_51C	       = dword ptr -51Ch
.text:00406E61 cpinfo	       = _cpinfo ptr -518h
.text:00406E61 wVector	       = word ptr -504h
.text:00406E61 upVector	       = byte ptr -304h
.text:00406E61 lowVector       = byte ptr -204h
.text:00406E61 sbVector	       = byte ptr -104h
.text:00406E61 var_4	       = dword ptr -4
.text:00406E61
.text:00406E61 ptmbci =	esi
.text:00406E61		       push    ebp
.text:00406E62		       lea     ebp, [esp-49Ch]
.text:00406E69		       sub     esp, 51Ch
.text:00406E6F		       mov     eax, ___security_cookie
.text:00406E74		       xor     eax, ebp
.text:00406E76		       mov     [ebp+49Ch+var_4], eax
.text:00406E7C		       push    ebx
.text:00406E7D		       push    edi
.text:00406E7E		       lea     eax, [ebp+49Ch+cpinfo]
.text:00406E81		       push    eax	       ; lpCPInfo
.text:00406E82		       push    dword ptr [ptmbci+4] ; CodePage
.text:00406E85		       call    ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:00406E8B		       test    eax, eax
.text:00406E8D		       mov     edi, 100h
.text:00406E92		       jz      loc_406F87
.text:00406E98		       xor     eax, eax
.text:00406E9A
.text:00406E9A loc_406E9A:			       ; CODE XREF: setSBUpLow+43j
.text:00406E9A		       mov     [ebp+eax+49Ch+sbVector],	al
.text:00406EA1		       inc     eax
.text:00406EA2		       cmp     eax, edi
.text:00406EA4		       jb      short loc_406E9A
.text:00406EA6		       mov     al, [ebp+49Ch+cpinfo.LeadByte]
.text:00406EA9		       test    al, al
.text:00406EAB		       mov     [ebp+49Ch+sbVector], 20h
.text:00406EB2		       jz      short loc_406EDF
.text:00406EB4		       lea     ebx, [ebp+49Ch+cpinfo.LeadByte+1]
.text:00406EB7
.text:00406EB7 loc_406EB7:			       ; CODE XREF: setSBUpLow+7Cj
.text:00406EB7		       movzx   ecx, al
.text:00406EBA		       movzx   eax, byte ptr [ebx]
.text:00406EBD		       cmp     ecx, eax
.text:00406EBF		       ja      short loc_406ED7
.text:00406EC1		       sub     eax, ecx
.text:00406EC3		       inc     eax
.text:00406EC4		       push    eax	       ; count
.text:00406EC5		       lea     edx, [ebp+ecx+49Ch+sbVector]
.text:00406ECC		       push    20h	       ; value
.text:00406ECE		       push    edx	       ; dst
.text:00406ECF		       call    _memset
.text:00406ED4		       add     esp, 0Ch
.text:00406ED7
.text:00406ED7 loc_406ED7:			       ; CODE XREF: setSBUpLow+5Ej
.text:00406ED7		       inc     ebx
.text:00406ED8		       mov     al, [ebx]
.text:00406EDA		       inc     ebx
.text:00406EDB		       test    al, al
.text:00406EDD		       jnz     short loc_406EB7
.text:00406EDF
.text:00406EDF loc_406EDF:			       ; CODE XREF: setSBUpLow+51j
.text:00406EDF		       push    0	       ; bError
.text:00406EE1		       push    dword ptr [ptmbci+0Ch] ;	lcid
.text:00406EE4		       lea     eax, [ebp+49Ch+wVector]
.text:00406EE7		       push    dword ptr [ptmbci+4] ; code_page
.text:00406EEA		       push    eax	       ; lpCharType
.text:00406EEB		       push    edi	       ; cchSrc
.text:00406EEC		       lea     eax, [ebp+49Ch+sbVector]
.text:00406EF2		       push    eax	       ; lpSrcStr
.text:00406EF3		       push    1	       ; dwInfoType
.text:00406EF5		       push    0	       ; plocinfo
.text:00406EF7		       call    ___crtGetStringTypeA
.text:00406EFC		       xor     ebx, ebx
.text:00406EFE		       push    ebx	       ; bError
.text:00406EFF		       push    dword ptr [ptmbci+4] ; code_page
.text:00406F02		       lea     eax, [ebp+49Ch+lowVector]
.text:00406F08		       push    edi	       ; cchDest
.text:00406F09		       push    eax	       ; lpDestStr
.text:00406F0A		       push    edi	       ; cchSrc
.text:00406F0B		       lea     eax, [ebp+49Ch+sbVector]
.text:00406F11		       push    eax	       ; lpSrcStr
.text:00406F12		       push    edi	       ; dwMapFlags
.text:00406F13		       push    dword ptr [ptmbci+0Ch] ;	Locale
.text:00406F16		       push    ebx	       ; plocinfo
.text:00406F17		       call    ___crtLCMapStringA
.text:00406F1C		       add     esp, 44h
.text:00406F1F		       push    ebx	       ; bError
.text:00406F20		       push    dword ptr [ptmbci+4] ; code_page
.text:00406F23		       lea     eax, [ebp+49Ch+upVector]
.text:00406F29		       push    edi	       ; cchDest
.text:00406F2A		       push    eax	       ; lpDestStr
.text:00406F2B		       push    edi	       ; cchSrc
.text:00406F2C		       lea     eax, [ebp+49Ch+sbVector]
.text:00406F32		       push    eax	       ; lpSrcStr
.text:00406F33		       push    200h	       ; dwMapFlags
.text:00406F38		       push    dword ptr [ptmbci+0Ch] ;	Locale
.text:00406F3B		       push    ebx	       ; plocinfo
.text:00406F3C		       call    ___crtLCMapStringA
.text:00406F41		       add     esp, 24h
.text:00406F44		       xor     eax, eax
.text:00406F46
.text:00406F46 loc_406F46:			       ; CODE XREF: setSBUpLow+122j
.text:00406F46		       movzx   ecx, [ebp+eax*2+49Ch+wVector]
.text:00406F4B		       test    cl, 1
.text:00406F4E		       jz      short loc_406F5E
.text:00406F50		       or      byte ptr	[ptmbci+eax+1Dh], 10h
.text:00406F55		       mov     cl, [ebp+eax+49Ch+lowVector]
.text:00406F5C		       jmp     short loc_406F6F
.text:00406F5E ; ---------------------------------------------------------------------------
.text:00406F5E
.text:00406F5E loc_406F5E:			       ; CODE XREF: setSBUpLow+EDj
.text:00406F5E		       test    cl, 2
.text:00406F61		       jz      short loc_406F78
.text:00406F63		       or      byte ptr	[ptmbci+eax+1Dh], 20h
.text:00406F68		       mov     cl, [ebp+eax+49Ch+upVector]
.text:00406F6F
.text:00406F6F loc_406F6F:			       ; CODE XREF: setSBUpLow+FBj
.text:00406F6F		       mov     [ptmbci+eax+11Dh], cl
.text:00406F76		       jmp     short loc_406F80
.text:00406F78 ; ---------------------------------------------------------------------------
.text:00406F78
.text:00406F78 loc_406F78:			       ; CODE XREF: setSBUpLow+100j
.text:00406F78		       mov     byte ptr	[ptmbci+eax+11Dh], 0
.text:00406F80
.text:00406F80 loc_406F80:			       ; CODE XREF: setSBUpLow+115j
.text:00406F80		       inc     eax
.text:00406F81		       cmp     eax, edi
.text:00406F83		       jb      short loc_406F46
.text:00406F85		       jmp     short loc_406FD4
.text:00406F87 ; ---------------------------------------------------------------------------
.text:00406F87
.text:00406F87 loc_406F87:			       ; CODE XREF: setSBUpLow+31j
.text:00406F87		       lea     eax, [ptmbci+11Dh]
.text:00406F8D		       mov     [ebp+49Ch+var_51C], 0FFFFFF9Fh
.text:00406F94		       xor     ecx, ecx
.text:00406F96		       sub     [ebp+49Ch+var_51C], eax
.text:00406F99
.text:00406F99 loc_406F99:			       ; CODE XREF: setSBUpLow+171j
.text:00406F99		       mov     edx, [ebp+49Ch+var_51C]
.text:00406F9C		       lea     eax, [ptmbci+ecx+11Dh]
.text:00406FA3		       add     edx, eax
.text:00406FA5		       lea     ebx, [edx+20h]
.text:00406FA8		       cmp     ebx, 19h
.text:00406FAB		       ja      short loc_406FB9
.text:00406FAD		       or      byte ptr	[ptmbci+ecx+1Dh], 10h
.text:00406FB2		       mov     dl, cl
.text:00406FB4		       add     dl, 20h
.text:00406FB7		       jmp     short loc_406FC8
.text:00406FB9 ; ---------------------------------------------------------------------------
.text:00406FB9
.text:00406FB9 loc_406FB9:			       ; CODE XREF: setSBUpLow+14Aj
.text:00406FB9		       cmp     edx, 19h
.text:00406FBC		       ja      short loc_406FCC
.text:00406FBE		       or      byte ptr	[ptmbci+ecx+1Dh], 20h
.text:00406FC3		       mov     dl, cl
.text:00406FC5		       sub     dl, 20h
.text:00406FC8
.text:00406FC8 loc_406FC8:			       ; CODE XREF: setSBUpLow+156j
.text:00406FC8		       mov     [eax], dl
.text:00406FCA		       jmp     short loc_406FCF
.text:00406FCC ; ---------------------------------------------------------------------------
.text:00406FCC
.text:00406FCC loc_406FCC:			       ; CODE XREF: setSBUpLow+15Bj
.text:00406FCC		       mov     byte ptr	[eax], 0
.text:00406FCF
.text:00406FCF loc_406FCF:			       ; CODE XREF: setSBUpLow+169j
.text:00406FCF		       inc     ecx
.text:00406FD0		       cmp     ecx, edi
.text:00406FD2		       jb      short loc_406F99
.text:00406FD4
.text:00406FD4 loc_406FD4:			       ; CODE XREF: setSBUpLow+124j
.text:00406FD4		       mov     ecx, [ebp+49Ch+var_4]
.text:00406FDA		       pop     edi
.text:00406FDB		       xor     ecx, ebp
.text:00406FDD		       pop     ebx
.text:00406FDE		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00406FE3		       add     ebp, 49Ch
.text:00406FE9		       leave
.text:00406FEA		       retn
.text:00406FEA setSBUpLow      endp
.text:00406FEA
.text:00406FEB
.text:00406FEB ; =============== S U B R O U T I N E =======================================
.text:00406FEB
.text:00406FEB ; Attributes: bp-based frame
.text:00406FEB
.text:00406FEB ; threadmbcinfostruct *__cdecl __updatetmbcinfo()
.text:00406FEB ___updatetmbcinfo proc near	       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+57p
.text:00406FEB					       ; __setmbcp+1Ap	...
.text:00406FEB
.text:00406FEB ptmbci	       = dword ptr -1Ch
.text:00406FEB ms_exc	       = CPPEH_RECORD ptr -18h
.text:00406FEB
.text:00406FEB		       push    0Ch
.text:00406FED		       push    offset dword_421740
.text:00406FF2		       call    __SEH_prolog4
.text:00406FF7		       call    __getptd
.text:00406FFC		       mov     edi, eax
.text:00406FFE		       mov     eax, ___globallocalestatus
.text:00407003		       test    [edi+70h], eax
.text:00407006		       jz      short loc_407025
.text:00407008		       cmp     dword ptr [edi+6Ch], 0
.text:0040700C		       jz      short loc_407025
.text:0040700E		       mov     esi, [edi+68h]
.text:00407011
.text:00407011 $LN14_1:				       ; CODE XREF: ___updatetmbcinfo+96j
.text:00407011		       test    esi, esi
.text:00407013		       jnz     short loc_40701D
.text:00407015		       push    20h	       ; rterrnum
.text:00407017		       call    __amsg_exit
.text:0040701C		       pop     ecx
.text:0040701D
.text:0040701D loc_40701D:			       ; CODE XREF: ___updatetmbcinfo+28j
.text:0040701D		       mov     eax, esi
.text:0040701F		       call    __SEH_epilog4
.text:00407024		       retn
.text:00407025 ; ---------------------------------------------------------------------------
.text:00407025
.text:00407025 loc_407025:			       ; CODE XREF: ___updatetmbcinfo+1Bj
.text:00407025					       ; ___updatetmbcinfo+21j
.text:00407025		       push    0Dh	       ; locknum
.text:00407027		       call    __lock
.text:0040702C		       pop     ecx
.text:0040702D		       and     [ebp+ms_exc.disabled], 0
.text:00407031		       mov     esi, [edi+68h]
.text:00407034		       mov     [ebp+ptmbci], esi
.text:00407037		       cmp     esi, ___ptmbcinfo ; ___ptmbcinfo
.text:0040703D		       jz      short loc_407075
.text:0040703F		       test    esi, esi
.text:00407041		       jz      short loc_40705D
.text:00407043		       push    esi	       ; lpAddend
.text:00407044		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040704A		       test    eax, eax
.text:0040704C		       jnz     short loc_40705D
.text:0040704E		       cmp     esi, offset ___initialmbcinfo
.text:00407054		       jz      short loc_40705D
.text:00407056		       push    esi	       ; pBlock
.text:00407057		       call    _free
.text:0040705C		       pop     ecx
.text:0040705D
.text:0040705D loc_40705D:			       ; CODE XREF: ___updatetmbcinfo+56j
.text:0040705D					       ; ___updatetmbcinfo+61j	...
.text:0040705D		       mov     eax, ___ptmbcinfo ; ___ptmbcinfo
.text:00407062		       mov     [edi+68h], eax
.text:00407065		       mov     esi, ___ptmbcinfo ; ___ptmbcinfo
.text:0040706B		       mov     [ebp+ptmbci], esi
.text:0040706E		       push    esi	       ; lpAddend
.text:0040706F		       call    ds:__imp__InterlockedIncrement@4	; InterlockedIncrement(x)
.text:00407075
.text:00407075 loc_407075:			       ; CODE XREF: ___updatetmbcinfo+52j
.text:00407075		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040707C		       call    $LN13_3
.text:00407081		       jmp     short $LN14_1
.text:00407083 ; ---------------------------------------------------------------------------
.text:00407083
.text:00407083 $LN11_3:				       ; DATA XREF: .rdata:00421758o
.text:00407083		       mov     esi, [ebp+ptmbci]
.text:00407086
.text:00407086 $LN13_3:				       ; CODE XREF: ___updatetmbcinfo+91p
.text:00407086		       push    0Dh	       ; locknum
.text:00407088		       call    __unlock
.text:0040708D		       pop     ecx
.text:0040708E
.text:0040708E $LN12_4:
.text:0040708E		       retn
.text:0040708E ___updatetmbcinfo endp ;	sp-analysis failed
.text:0040708E
.text:0040708F
.text:0040708F ; =============== S U B R O U T I N E =======================================
.text:0040708F
.text:0040708F ; Attributes: bp-based frame
.text:0040708F
.text:0040708F ; int __usercall	getSystemCP<eax>(int codepage<esi>)
.text:0040708F getSystemCP     proc near	       ; CODE XREF: __setmbcp_nolock+19p
.text:0040708F					       ; __setmbcp+25p
.text:0040708F
.text:0040708F _loc_update     = _LocaleUpdate ptr -10h
.text:0040708F
.text:0040708F codepage	= esi
.text:0040708F		       push    ebp
.text:00407090		       mov     ebp, esp
.text:00407092		       sub     esp, 10h
.text:00407095		       push    ebx
.text:00407096		       xor     ebx, ebx
.text:00407098		       push    ebx	       ; plocinfo
.text:00407099		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040709C		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004070A1		       cmp     codepage, 0FFFFFFFEh
.text:004070A4		       mov     fSystemSet, ebx
.text:004070AA		       jnz     short loc_4070CA
.text:004070AC		       mov     fSystemSet, 1
.text:004070B6		       call    ds:__imp__GetOEMCP@0 ; GetOEMCP()
.text:004070BC
.text:004070BC loc_4070BC:			       ; CODE XREF: getSystemCP+50j
.text:004070BC					       ; getSystemCP+67j
.text:004070BC		       cmp     [ebp+_loc_update.updated], bl
.text:004070BF		       jz      short loc_407106
.text:004070C1		       mov     ecx, [ebp+_loc_update.ptd]
.text:004070C4		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:004070C8		       jmp     short loc_407106
.text:004070CA ; ---------------------------------------------------------------------------
.text:004070CA
.text:004070CA loc_4070CA:			       ; CODE XREF: getSystemCP+1Bj
.text:004070CA		       cmp     codepage, 0FFFFFFFDh
.text:004070CD		       jnz     short loc_4070E1
.text:004070CF		       mov     fSystemSet, 1
.text:004070D9		       call    ds:__imp__GetACP@0 ; GetACP()
.text:004070DF		       jmp     short loc_4070BC
.text:004070E1 ; ---------------------------------------------------------------------------
.text:004070E1
.text:004070E1 loc_4070E1:			       ; CODE XREF: getSystemCP+3Ej
.text:004070E1		       cmp     codepage, 0FFFFFFFCh
.text:004070E4		       jnz     short loc_4070F8
.text:004070E6		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004070E9		       mov     eax, [eax+4]
.text:004070EC		       mov     fSystemSet, 1
.text:004070F6		       jmp     short loc_4070BC
.text:004070F8 ; ---------------------------------------------------------------------------
.text:004070F8
.text:004070F8 loc_4070F8:			       ; CODE XREF: getSystemCP+55j
.text:004070F8		       cmp     [ebp+_loc_update.updated], bl
.text:004070FB		       jz      short loc_407104
.text:004070FD		       mov     eax, [ebp+_loc_update.ptd]
.text:00407100		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00407104
.text:00407104 loc_407104:			       ; CODE XREF: getSystemCP+6Cj
.text:00407104		       mov     eax, codepage
.text:00407106
.text:00407106 loc_407106:			       ; CODE XREF: getSystemCP+30j
.text:00407106					       ; getSystemCP+39j
.text:00407106		       pop     ebx
.text:00407107		       leave
.text:00407108		       retn
.text:00407108 getSystemCP     endp
.text:00407108
.text:00407109
.text:00407109 ; =============== S U B R O U T I N E =======================================
.text:00407109
.text:00407109 ; Attributes: bp-based frame
.text:00407109
.text:00407109 ; int __cdecl _setmbcp_nolock(int codepage, threadmbcinfostruct *ptmbci)
.text:00407109 __setmbcp_nolock	proc near	       ; CODE XREF: __setmbcp+5Ep
.text:00407109					       ; __create_locale+B4p
.text:00407109
.text:00407109 irg	       = dword ptr -20h
.text:00407109 icp	       = dword ptr -1Ch
.text:00407109 cpinfo	       = _cpinfo ptr -18h
.text:00407109 var_4	       = dword ptr -4
.text:00407109 codepage	       = dword ptr  8
.text:00407109 ptmbci	       = dword ptr  0Ch
.text:00407109
.text:00407109		       push    ebp
.text:0040710A		       mov     ebp, esp
.text:0040710C		       sub     esp, 20h
.text:0040710F		       mov     eax, ___security_cookie
.text:00407114		       xor     eax, ebp
.text:00407116		       mov     [ebp+var_4], eax
.text:00407119		       push    ebx
.text:0040711A		       mov     ebx, [ebp+ptmbci]
.text:0040711D		       push    esi
.text:0040711E		       mov     esi, [ebp+codepage] ; codepage
.text:00407121		       push    edi
.text:00407122		       call    getSystemCP
.text:00407127		       mov     edi, eax
.text:00407129		       xor     esi, esi
.text:0040712B		       cmp     edi, esi
.text:0040712D		       mov     [ebp+codepage], edi
.text:00407130		       jnz     short loc_407140
.text:00407132
.text:00407132 loc_407132:			       ; CODE XREF: __setmbcp_nolock+1C1j
.text:00407132		       mov     eax, ebx	       ; ptmbci
.text:00407134		       call    setSBCS
.text:00407139
.text:00407139 loc_407139:			       ; CODE XREF: __setmbcp_nolock+174j
.text:00407139		       xor     eax, eax
.text:0040713B		       jmp     loc_4072D3
.text:00407140 ; ---------------------------------------------------------------------------
.text:00407140
.text:00407140 loc_407140:			       ; CODE XREF: __setmbcp_nolock+27j
.text:00407140		       mov     [ebp+icp], esi
.text:00407143		       xor     eax, eax
.text:00407145
.text:00407145 loc_407145:			       ; CODE XREF: __setmbcp_nolock+53j
.text:00407145		       cmp     dword ptr __rgcode_page_info.code_page[eax], edi
.text:0040714B		       jz      loc_4071E2
.text:00407151		       inc     [ebp+icp]
.text:00407154		       add     eax, 30h
.text:00407157		       cmp     eax, 0F0h
.text:0040715C		       jb      short loc_407145
.text:0040715E		       cmp     edi, 0FDE8h
.text:00407164		       jz      loc_4072D0
.text:0040716A		       cmp     edi, 0FDE9h
.text:00407170		       jz      loc_4072D0
.text:00407176		       movzx   eax, di
.text:00407179		       push    eax	       ; CodePage
.text:0040717A		       call    ds:__imp__IsValidCodePage@4 ; IsValidCodePage(x)
.text:00407180		       test    eax, eax
.text:00407182		       jz      loc_4072D0
.text:00407188		       lea     eax, [ebp+cpinfo]
.text:0040718B		       push    eax	       ; lpCPInfo
.text:0040718C		       push    edi	       ; CodePage
.text:0040718D		       call    ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:00407193		       test    eax, eax
.text:00407195		       jz      loc_4072C4
.text:0040719B		       push    101h	       ; count
.text:004071A0		       lea     eax, [ebx+1Ch]
.text:004071A3		       push    esi	       ; value
.text:004071A4		       push    eax	       ; dst
.text:004071A5		       call    _memset
.text:004071AA		       xor     edx, edx
.text:004071AC		       inc     edx
.text:004071AD		       add     esp, 0Ch
.text:004071B0		       cmp     [ebp+cpinfo.MaxCharSize], edx
.text:004071B3		       mov     [ebx+4],	edi
.text:004071B6		       mov     [ebx+0Ch], esi
.text:004071B9		       jbe     loc_4072B7
.text:004071BF		       cmp     [ebp+cpinfo.LeadByte], 0
.text:004071C3		       jz      loc_407298
.text:004071C9		       lea     esi, [ebp+cpinfo.LeadByte+1]
.text:004071CC
.text:004071CC loc_4071CC:			       ; CODE XREF: __setmbcp_nolock+189j
.text:004071CC		       mov     cl, [esi]
.text:004071CE		       test    cl, cl
.text:004071D0		       jz      loc_407298
.text:004071D6		       movzx   eax, byte ptr [esi-1]
.text:004071DA		       movzx   ecx, cl
.text:004071DD		       jmp     loc_407288
.text:004071E2 ; ---------------------------------------------------------------------------
.text:004071E2
.text:004071E2 loc_4071E2:			       ; CODE XREF: __setmbcp_nolock+42j
.text:004071E2		       push    101h	       ; count
.text:004071E7		       lea     eax, [ebx+1Ch]
.text:004071EA		       push    esi	       ; value
.text:004071EB		       push    eax	       ; dst
.text:004071EC		       call    _memset
.text:004071F1		       mov     ecx, [ebp+icp]
.text:004071F4		       add     esp, 0Ch
.text:004071F7		       imul    ecx, 30h
.text:004071FA		       mov     [ebp+irg], esi
.text:004071FD		       lea     esi, __rgcode_page_info.rgrange[ecx]
.text:00407203		       mov     [ebp+icp], esi
.text:00407206		       jmp     short loc_407232
.text:00407208 ; ---------------------------------------------------------------------------
.text:00407208
.text:00407208 loc_407208:			       ; CODE XREF: __setmbcp_nolock+12Cj
.text:00407208		       mov     al, [esi+1]
.text:0040720B		       test    al, al
.text:0040720D		       jz      short loc_407237
.text:0040720F		       movzx   edi, byte ptr [esi]
.text:00407212		       movzx   eax, al
.text:00407215		       jmp     short loc_407229
.text:00407217 ; ---------------------------------------------------------------------------
.text:00407217
.text:00407217 loc_407217:			       ; CODE XREF: __setmbcp_nolock+122j
.text:00407217		       mov     eax, [ebp+irg]
.text:0040721A		       mov     al, __rgctypeflag[eax]
.text:00407220		       or      [ebx+edi+1Dh], al
.text:00407224		       movzx   eax, byte ptr [esi+1]
.text:00407228		       inc     edi
.text:00407229
.text:00407229 loc_407229:			       ; CODE XREF: __setmbcp_nolock+10Cj
.text:00407229		       cmp     edi, eax
.text:0040722B		       jbe     short loc_407217
.text:0040722D		       mov     edi, [ebp+codepage]
.text:00407230		       inc     esi
.text:00407231		       inc     esi
.text:00407232
.text:00407232 loc_407232:			       ; CODE XREF: __setmbcp_nolock+FDj
.text:00407232					       ; __setmbcp_nolock+13Ej
.text:00407232		       cmp     byte ptr	[esi], 0
.text:00407235		       jnz     short loc_407208
.text:00407237
.text:00407237 loc_407237:			       ; CODE XREF: __setmbcp_nolock+104j
.text:00407237		       mov     esi, [ebp+icp]
.text:0040723A		       inc     [ebp+irg]
.text:0040723D		       add     esi, 8
.text:00407240		       cmp     [ebp+irg], 4
.text:00407244		       mov     [ebp+icp], esi
.text:00407247		       jb      short loc_407232
.text:00407249		       mov     eax, edi	       ; codepage
.text:0040724B		       mov     [ebx+4],	edi
.text:0040724E		       mov     dword ptr [ebx+8], 1
.text:00407255		       call    CPtoLCID
.text:0040725A		       push    6
.text:0040725C		       mov     [ebx+0Ch], eax
.text:0040725F		       lea     eax, [ebx+10h]
.text:00407262		       lea     ecx, __rgcode_page_info.mbulinfo[ecx]
.text:00407268		       pop     edx
.text:00407269
.text:00407269 loc_407269:			       ; CODE XREF: __setmbcp_nolock+16Bj
.text:00407269		       mov     si, [ecx]
.text:0040726C		       inc     ecx
.text:0040726D		       mov     [eax], si
.text:00407270		       inc     ecx
.text:00407271		       inc     eax
.text:00407272		       inc     eax
.text:00407273		       dec     edx
.text:00407274		       jnz     short loc_407269
.text:00407276
.text:00407276 loc_407276:			       ; CODE XREF: __setmbcp_nolock+1B9j
.text:00407276		       mov     esi, ebx	       ; ptmbci
.text:00407278		       call    setSBUpLow
.text:0040727D		       jmp     loc_407139
.text:00407282 ; ---------------------------------------------------------------------------
.text:00407282
.text:00407282 loc_407282:			       ; CODE XREF: __setmbcp_nolock+181j
.text:00407282		       or      byte ptr	[ebx+eax+1Dh], 4
.text:00407287		       inc     eax
.text:00407288
.text:00407288 loc_407288:			       ; CODE XREF: __setmbcp_nolock+D4j
.text:00407288		       cmp     eax, ecx
.text:0040728A		       jbe     short loc_407282
.text:0040728C		       inc     esi
.text:0040728D		       inc     esi
.text:0040728E		       cmp     byte ptr	[esi-1], 0
.text:00407292		       jnz     loc_4071CC
.text:00407298
.text:00407298 loc_407298:			       ; CODE XREF: __setmbcp_nolock+BAj
.text:00407298					       ; __setmbcp_nolock+C7j
.text:00407298		       lea     eax, [ebx+1Eh]
.text:0040729B		       mov     ecx, 0FEh
.text:004072A0
.text:004072A0 loc_4072A0:			       ; CODE XREF: __setmbcp_nolock+19Cj
.text:004072A0		       or      byte ptr	[eax], 8
.text:004072A3		       inc     eax
.text:004072A4		       dec     ecx
.text:004072A5		       jnz     short loc_4072A0
.text:004072A7		       mov     eax, [ebx+4]    ; codepage
.text:004072AA		       call    CPtoLCID
.text:004072AF		       mov     [ebx+0Ch], eax
.text:004072B2		       mov     [ebx+8],	edx
.text:004072B5		       jmp     short loc_4072BA
.text:004072B7 ; ---------------------------------------------------------------------------
.text:004072B7
.text:004072B7 loc_4072B7:			       ; CODE XREF: __setmbcp_nolock+B0j
.text:004072B7		       mov     [ebx+8],	esi
.text:004072BA
.text:004072BA loc_4072BA:			       ; CODE XREF: __setmbcp_nolock+1ACj
.text:004072BA		       xor     eax, eax
.text:004072BC		       lea     edi, [ebx+10h]
.text:004072BF		       stosd
.text:004072C0		       stosd
.text:004072C1		       stosd
.text:004072C2		       jmp     short loc_407276
.text:004072C4 ; ---------------------------------------------------------------------------
.text:004072C4
.text:004072C4 loc_4072C4:			       ; CODE XREF: __setmbcp_nolock+8Cj
.text:004072C4		       cmp     fSystemSet, esi
.text:004072CA		       jnz     loc_407132
.text:004072D0
.text:004072D0 loc_4072D0:			       ; CODE XREF: __setmbcp_nolock+5Bj
.text:004072D0					       ; __setmbcp_nolock+67j ...
.text:004072D0		       or      eax, 0FFFFFFFFh
.text:004072D3
.text:004072D3 loc_4072D3:			       ; CODE XREF: __setmbcp_nolock+32j
.text:004072D3		       mov     ecx, [ebp+var_4]
.text:004072D6		       pop     edi
.text:004072D7		       pop     esi
.text:004072D8		       xor     ecx, ebp
.text:004072DA		       pop     ebx
.text:004072DB		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004072E0		       leave
.text:004072E1		       retn
.text:004072E1 __setmbcp_nolock	endp
.text:004072E1
.text:004072E2
.text:004072E2 ; =============== S U B R O U T I N E =======================================
.text:004072E2
.text:004072E2 ; Attributes: bp-based frame
.text:004072E2
.text:004072E2 ; int __cdecl _getmbcp()
.text:004072E2 __getmbcp       proc near
.text:004072E2
.text:004072E2 _loc_update     = _LocaleUpdate ptr -10h
.text:004072E2
.text:004072E2		       push    ebp
.text:004072E3		       mov     ebp, esp
.text:004072E5		       sub     esp, 10h
.text:004072E8		       push    0	       ; plocinfo
.text:004072EA		       lea     ecx, [ebp+_loc_update] ;	this
.text:004072ED		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004072F2		       mov     eax, [ebp+_loc_update.localeinfo.mbcinfo]
.text:004072F5		       cmp     dword ptr [eax+8], 0
.text:004072F9		       jz      short loc_40730D
.text:004072FB		       cmp     [ebp+_loc_update.updated], 0
.text:004072FF		       mov     eax, [eax+4]
.text:00407302		       jz      short locret_40731C
.text:00407304		       mov     ecx, [ebp+_loc_update.ptd]
.text:00407307		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040730B		       leave
.text:0040730C		       retn
.text:0040730D ; ---------------------------------------------------------------------------
.text:0040730D
.text:0040730D loc_40730D:			       ; CODE XREF: __getmbcp+17j
.text:0040730D		       cmp     [ebp+_loc_update.updated], 0
.text:00407311		       jz      short loc_40731A
.text:00407313		       mov     eax, [ebp+_loc_update.ptd]
.text:00407316		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040731A
.text:0040731A loc_40731A:			       ; CODE XREF: __getmbcp+2Fj
.text:0040731A		       xor     eax, eax
.text:0040731C
.text:0040731C locret_40731C:			       ; CODE XREF: __getmbcp+20j
.text:0040731C		       leave
.text:0040731D		       retn
.text:0040731D __getmbcp       endp
.text:0040731D
.text:0040731E
.text:0040731E ; =============== S U B R O U T I N E =======================================
.text:0040731E
.text:0040731E ; Attributes: bp-based frame
.text:0040731E
.text:0040731E ; int __cdecl _setmbcp(int codepage)
.text:0040731E __setmbcp       proc near	       ; CODE XREF: ___initmbctable+Bp
.text:0040731E
.text:0040731E ptd	       = dword ptr -24h
.text:0040731E retcode	       = dword ptr -20h
.text:0040731E i	       = dword ptr -1Ch
.text:0040731E ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040731E codepage	       = dword ptr  8
.text:0040731E
.text:0040731E		       push    14h
.text:00407320		       push    offset dword_421760
.text:00407325		       call    __SEH_prolog4
.text:0040732A		       or      [ebp+retcode], 0FFFFFFFFh
.text:0040732E		       call    __getptd
.text:00407333		       mov     edi, eax
.text:00407335		       mov     [ebp+ptd], edi
.text:00407338		       call    ___updatetmbcinfo
.text:0040733D		       mov     ebx, [edi+68h]
.text:00407340		       mov     esi, [ebp+codepage] ; codepage
.text:00407343		       call    getSystemCP
.text:00407348		       mov     [ebp+codepage], eax
.text:0040734B		       cmp     eax, [ebx+4]
.text:0040734E		       jz      loc_4074AB
.text:00407354		       push    220h	       ; cb
.text:00407359		       call    __malloc_crt
.text:0040735E		       pop     ecx
.text:0040735F		       mov     ebx, eax
.text:00407361		       test    ebx, ebx
.text:00407363		       jz      $LN28
.text:00407369		       mov     ecx, 88h
.text:0040736E		       mov     esi, [edi+68h]
.text:00407371		       mov     edi, ebx
.text:00407373		       rep movsd
.text:00407375		       and     dword ptr [ebx],	0
.text:00407378		       push    ebx	       ; ptmbci
.text:00407379		       push    [ebp+codepage]  ; codepage
.text:0040737C		       call    __setmbcp_nolock
.text:00407381		       pop     ecx
.text:00407382		       pop     ecx
.text:00407383		       mov     [ebp+retcode], eax
.text:00407386		       test    eax, eax
.text:00407388		       jnz     loc_40748A
.text:0040738E		       mov     esi, [ebp+ptd]
.text:00407391		       push    dword ptr [esi+68h] ; lpAddend
.text:00407394		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040739A		       test    eax, eax
.text:0040739C		       jnz     short loc_4073AF
.text:0040739E		       mov     eax, [esi+68h]
.text:004073A1		       cmp     eax, offset ___initialmbcinfo
.text:004073A6		       jz      short loc_4073AF
.text:004073A8		       push    eax	       ; pBlock
.text:004073A9		       call    _free
.text:004073AE		       pop     ecx
.text:004073AF
.text:004073AF loc_4073AF:			       ; CODE XREF: __setmbcp+7Ej
.text:004073AF					       ; __setmbcp+88j
.text:004073AF		       mov     [esi+68h], ebx
.text:004073B2		       push    ebx	       ; lpAddend
.text:004073B3		       mov     edi, ds:__imp__InterlockedIncrement@4 ; InterlockedIncrement(x)
.text:004073B9		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:004073BB		       test    byte ptr	[esi+70h], 2
.text:004073BF		       jnz     $LN28
.text:004073C5		       test    byte ptr	___globallocalestatus, 1
.text:004073CC		       jnz     $LN28
.text:004073D2		       push    0Dh	       ; locknum
.text:004073D4		       call    __lock
.text:004073D9		       pop     ecx
.text:004073DA		       and     [ebp+ms_exc.disabled], 0
.text:004073DE		       mov     eax, [ebx+4]
.text:004073E1		       mov     ___mbcodepage, eax
.text:004073E6		       mov     eax, [ebx+8]
.text:004073E9		       mov     ___ismbcodepage,	eax
.text:004073EE		       mov     eax, [ebx+0Ch]
.text:004073F1		       mov     ___mblcid, eax
.text:004073F6		       xor     eax, eax
.text:004073F8
.text:004073F8 loc_4073F8:			       ; CODE XREF: __setmbcp+F0j
.text:004073F8		       mov     [ebp+i],	eax
.text:004073FB		       cmp     eax, 5
.text:004073FE		       jge     short loc_407410
.text:00407400		       mov     cx, [ebx+eax*2+10h]
.text:00407405		       mov     ___mbulinfo[eax*2], cx
.text:0040740D		       inc     eax
.text:0040740E		       jmp     short loc_4073F8
.text:00407410 ; ---------------------------------------------------------------------------
.text:00407410
.text:00407410 loc_407410:			       ; CODE XREF: __setmbcp+E0j
.text:00407410		       xor     eax, eax
.text:00407412
.text:00407412 loc_407412:			       ; CODE XREF: __setmbcp+109j
.text:00407412		       mov     [ebp+i],	eax
.text:00407415		       cmp     eax, 101h
.text:0040741A		       jge     short loc_407429
.text:0040741C		       mov     cl, [eax+ebx+1Ch]
.text:00407420		       mov     __mbctype[eax], cl
.text:00407426		       inc     eax
.text:00407427		       jmp     short loc_407412
.text:00407429 ; ---------------------------------------------------------------------------
.text:00407429
.text:00407429 loc_407429:			       ; CODE XREF: __setmbcp+FCj
.text:00407429		       xor     eax, eax
.text:0040742B
.text:0040742B loc_40742B:			       ; CODE XREF: __setmbcp+125j
.text:0040742B		       mov     [ebp+i],	eax
.text:0040742E		       cmp     eax, 100h
.text:00407433		       jge     short loc_407445
.text:00407435		       mov     cl, [eax+ebx+11Dh]
.text:0040743C		       mov     __mbcasemap[eax], cl
.text:00407442		       inc     eax
.text:00407443		       jmp     short loc_40742B
.text:00407445 ; ---------------------------------------------------------------------------
.text:00407445
.text:00407445 loc_407445:			       ; CODE XREF: __setmbcp+115j
.text:00407445		       push    ___ptmbcinfo    ; lpAddend
.text:0040744B		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:00407451		       test    eax, eax
.text:00407453		       jnz     short loc_407468
.text:00407455		       mov     eax, ___ptmbcinfo ; ___ptmbcinfo
.text:0040745A		       cmp     eax, offset ___initialmbcinfo
.text:0040745F		       jz      short loc_407468
.text:00407461		       push    eax	       ; pBlock
.text:00407462		       call    _free
.text:00407467		       pop     ecx
.text:00407468
.text:00407468 loc_407468:			       ; CODE XREF: __setmbcp+135j
.text:00407468					       ; __setmbcp+141j
.text:00407468		       mov     ___ptmbcinfo, ebx ; ___ptmbcinfo
.text:0040746E		       push    ebx	       ; lpAddend
.text:0040746F		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:00407471		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00407478		       call    $LN25_0
.text:0040747D		       jmp     short $LN28
.text:0040747F ; ---------------------------------------------------------------------------
.text:0040747F
.text:0040747F $LN25_0:				       ; CODE XREF: __setmbcp+15Ap
.text:0040747F					       ; DATA XREF: .rdata:00421778o
.text:0040747F		       push    0Dh	       ; locknum
.text:00407481		       call    __unlock
.text:00407486		       pop     ecx
.text:00407487
.text:00407487 $LN26:
.text:00407487		       retn
.text:00407488 ; ---------------------------------------------------------------------------
.text:00407488		       jmp     short $LN28
.text:0040748A ; ---------------------------------------------------------------------------
.text:0040748A
.text:0040748A loc_40748A:			       ; CODE XREF: __setmbcp+6Aj
.text:0040748A		       cmp     eax, 0FFFFFFFFh
.text:0040748D		       jnz     short $LN28
.text:0040748F		       cmp     ebx, offset ___initialmbcinfo
.text:00407495		       jz      short loc_40749E
.text:00407497		       push    ebx	       ; pBlock
.text:00407498		       call    _free
.text:0040749D		       pop     ecx
.text:0040749E
.text:0040749E loc_40749E:			       ; CODE XREF: __setmbcp+177j
.text:0040749E		       call    __errno
.text:004074A3		       mov     dword ptr [eax],	16h
.text:004074A9		       jmp     short $LN28
.text:004074AB ; ---------------------------------------------------------------------------
.text:004074AB
.text:004074AB loc_4074AB:			       ; CODE XREF: __setmbcp+30j
.text:004074AB		       and     [ebp+retcode], 0
.text:004074AF
.text:004074AF $LN28:				       ; CODE XREF: __setmbcp+45j
.text:004074AF					       ; __setmbcp+A1j	...
.text:004074AF		       mov     eax, [ebp+retcode]
.text:004074B2		       call    __SEH_epilog4
.text:004074B7		       retn
.text:004074B7 __setmbcp       endp
.text:004074B7
.text:004074B8
.text:004074B8 ; =============== S U B R O U T I N E =======================================
.text:004074B8
.text:004074B8
.text:004074B8 ; int __cdecl __initmbctable()
.text:004074B8 ___initmbctable proc near	       ; CODE XREF: __setenvp+Dp
.text:004074B8					       ; __setargv+13p
.text:004074B8					       ; DATA XREF: ...
.text:004074B8		       cmp     ___mbctype_initialized, 0
.text:004074BF		       jnz     short loc_4074D3
.text:004074C1		       push    0FFFFFFFDh      ; codepage
.text:004074C3		       call    __setmbcp
.text:004074C8		       pop     ecx
.text:004074C9		       mov     ___mbctype_initialized, 1
.text:004074D3
.text:004074D3 loc_4074D3:			       ; CODE XREF: ___initmbctable+7j
.text:004074D3		       xor     eax, eax
.text:004074D5		       retn
.text:004074D5 ___initmbctable endp
.text:004074D5
.text:004074D6
.text:004074D6 ; =============== S U B R O U T I N E =======================================
.text:004074D6
.text:004074D6
.text:004074D6 ; int __cdecl ___setlc_active_func()
.text:004074D6 ____setlc_active_func proc near
.text:004074D6		       mov     eax, ___setlc_active
.text:004074DB		       retn
.text:004074DB ____setlc_active_func endp
.text:004074DB
.text:004074DC
.text:004074DC ; =============== S U B R O U T I N E =======================================
.text:004074DC
.text:004074DC
.text:004074DC ; int *__cdecl ___unguarded_readlc_active_add_func()
.text:004074DC ____unguarded_readlc_active_add_func proc near
.text:004074DC		       mov     eax, offset ___unguarded_readlc_active
.text:004074E1		       retn
.text:004074E1 ____unguarded_readlc_active_add_func endp
.text:004074E1
.text:004074E2
.text:004074E2 ; =============== S U B R O U T I N E =======================================
.text:004074E2
.text:004074E2
.text:004074E2 ; void __cdecl __freetlocinfo(threadlocaleinfostruct *ptloci)
.text:004074E2 ___freetlocinfo proc near	       ; CODE XREF: _freefls(x)+E8p
.text:004074E2					       ; _updatetlocinfoEx_nolock+31p ...
.text:004074E2
.text:004074E2 ptloci	       = dword ptr  4
.text:004074E2
.text:004074E2		       push    ebx
.text:004074E3		       push    ebp
.text:004074E4		       push    esi
.text:004074E5		       mov     esi, [esp+0Ch+ptloci]
.text:004074E9		       mov     eax, [esi+0BCh]
.text:004074EF		       xor     ebp, ebp
.text:004074F1		       cmp     eax, ebp
.text:004074F3		       push    edi
.text:004074F4		       jz      short loc_407565
.text:004074F6		       cmp     eax, offset ___lconv_c
.text:004074FB		       jz      short loc_407565
.text:004074FD		       mov     eax, [esi+0B0h]
.text:00407503		       cmp     eax, ebp
.text:00407505		       jz      short loc_407565
.text:00407507		       cmp     [eax], ebp
.text:00407509		       jnz     short loc_407565
.text:0040750B		       mov     eax, [esi+0B8h]
.text:00407511		       cmp     eax, ebp
.text:00407513		       jz      short loc_40752C
.text:00407515		       cmp     [eax], ebp
.text:00407517		       jnz     short loc_40752C
.text:00407519		       push    eax	       ; pBlock
.text:0040751A		       call    _free
.text:0040751F		       push    dword ptr [esi+0BCh] ; l
.text:00407525		       call    ___free_lconv_mon
.text:0040752A		       pop     ecx
.text:0040752B		       pop     ecx
.text:0040752C
.text:0040752C loc_40752C:			       ; CODE XREF: ___freetlocinfo+31j
.text:0040752C					       ; ___freetlocinfo+35j
.text:0040752C		       mov     eax, [esi+0B4h]
.text:00407532		       cmp     eax, ebp
.text:00407534		       jz      short loc_40754D
.text:00407536		       cmp     [eax], ebp
.text:00407538		       jnz     short loc_40754D
.text:0040753A		       push    eax	       ; pBlock
.text:0040753B		       call    _free
.text:00407540		       push    dword ptr [esi+0BCh] ; l
.text:00407546		       call    ___free_lconv_num
.text:0040754B		       pop     ecx
.text:0040754C		       pop     ecx
.text:0040754D
.text:0040754D loc_40754D:			       ; CODE XREF: ___freetlocinfo+52j
.text:0040754D					       ; ___freetlocinfo+56j
.text:0040754D		       push    dword ptr [esi+0B0h] ; pBlock
.text:00407553		       call    _free
.text:00407558		       push    dword ptr [esi+0BCh] ; pBlock
.text:0040755E		       call    _free
.text:00407563		       pop     ecx
.text:00407564		       pop     ecx
.text:00407565
.text:00407565 loc_407565:			       ; CODE XREF: ___freetlocinfo+12j
.text:00407565					       ; ___freetlocinfo+19j ...
.text:00407565		       mov     eax, [esi+0C0h]
.text:0040756B		       cmp     eax, ebp
.text:0040756D		       jz      short loc_4075B3
.text:0040756F		       cmp     [eax], ebp
.text:00407571		       jnz     short loc_4075B3
.text:00407573		       mov     eax, [esi+0C4h]
.text:00407579		       sub     eax, 0FEh
.text:0040757E		       push    eax	       ; pBlock
.text:0040757F		       call    _free
.text:00407584		       mov     eax, [esi+0CCh]
.text:0040758A		       mov     edi, 80h
.text:0040758F		       sub     eax, edi
.text:00407591		       push    eax	       ; pBlock
.text:00407592		       call    _free
.text:00407597		       mov     eax, [esi+0D0h]
.text:0040759D		       sub     eax, edi
.text:0040759F		       push    eax	       ; pBlock
.text:004075A0		       call    _free
.text:004075A5		       push    dword ptr [esi+0C0h] ; pBlock
.text:004075AB		       call    _free
.text:004075B0		       add     esp, 10h
.text:004075B3
.text:004075B3 loc_4075B3:			       ; CODE XREF: ___freetlocinfo+8Bj
.text:004075B3					       ; ___freetlocinfo+8Fj
.text:004075B3		       lea     edi, [esi+0D4h]
.text:004075B9		       mov     eax, [edi]
.text:004075BB		       cmp     eax, offset ___lc_time_c
.text:004075C0		       jz      short loc_4075D9
.text:004075C2		       cmp     [eax+0B4h], ebp
.text:004075C8		       jnz     short loc_4075D9
.text:004075CA		       push    eax	       ; lc_time
.text:004075CB		       call    ___free_lc_time
.text:004075D0		       push    dword ptr [edi] ; pBlock
.text:004075D2		       call    _free
.text:004075D7		       pop     ecx
.text:004075D8		       pop     ecx
.text:004075D9
.text:004075D9 loc_4075D9:			       ; CODE XREF: ___freetlocinfo+DEj
.text:004075D9					       ; ___freetlocinfo+E6j
.text:004075D9		       push    6
.text:004075DB		       lea     edi, [esi+50h]
.text:004075DE		       pop     ebx
.text:004075DF
.text:004075DF loc_4075DF:			       ; CODE XREF: ___freetlocinfo+132j
.text:004075DF		       cmp     dword ptr [edi-8], offset ___clocalestr ; "C"
.text:004075E6		       jz      short loc_4075F9
.text:004075E8		       mov     eax, [edi]
.text:004075EA		       cmp     eax, ebp
.text:004075EC		       jz      short loc_4075F9
.text:004075EE		       cmp     [eax], ebp
.text:004075F0		       jnz     short loc_4075F9
.text:004075F2		       push    eax	       ; pBlock
.text:004075F3		       call    _free
.text:004075F8		       pop     ecx
.text:004075F9
.text:004075F9 loc_4075F9:			       ; CODE XREF: ___freetlocinfo+104j
.text:004075F9					       ; ___freetlocinfo+10Aj ...
.text:004075F9		       cmp     [edi-4],	ebp
.text:004075FC		       jz      short loc_407610
.text:004075FE		       mov     eax, [edi+4]
.text:00407601		       cmp     eax, ebp
.text:00407603		       jz      short loc_407610
.text:00407605		       cmp     [eax], ebp
.text:00407607		       jnz     short loc_407610
.text:00407609		       push    eax	       ; pBlock
.text:0040760A		       call    _free
.text:0040760F		       pop     ecx
.text:00407610
.text:00407610 loc_407610:			       ; CODE XREF: ___freetlocinfo+11Aj
.text:00407610					       ; ___freetlocinfo+121j ...
.text:00407610		       add     edi, 10h
.text:00407613		       dec     ebx
.text:00407614		       jnz     short loc_4075DF
.text:00407616		       push    esi	       ; pBlock
.text:00407617		       call    _free
.text:0040761C		       pop     ecx
.text:0040761D		       pop     edi
.text:0040761E		       pop     esi
.text:0040761F		       pop     ebp
.text:00407620		       pop     ebx
.text:00407621		       retn
.text:00407621 ___freetlocinfo endp
.text:00407621
.text:00407622
.text:00407622 ; =============== S U B R O U T I N E =======================================
.text:00407622
.text:00407622
.text:00407622 ; void __cdecl __addlocaleref(threadlocaleinfostruct *ptloci)
.text:00407622 ___addlocaleref proc near	       ; CODE XREF: __initptd+9Ep
.text:00407622					       ; _copytlocinfo_nolock+1Bp ...
.text:00407622
.text:00407622 ptloci	       = dword ptr  4
.text:00407622
.text:00407622		       push    ebx
.text:00407623		       push    ebp
.text:00407624		       push    esi
.text:00407625		       mov     esi, [esp+0Ch+ptloci]
.text:00407629		       push    edi
.text:0040762A		       mov     edi, ds:__imp__InterlockedIncrement@4 ; InterlockedIncrement(x)
.text:00407630		       push    esi	       ; lpAddend
.text:00407631		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:00407633		       mov     eax, [esi+0B0h]
.text:00407639		       test    eax, eax
.text:0040763B		       jz      short loc_407640
.text:0040763D		       push    eax	       ; lpAddend
.text:0040763E		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:00407640
.text:00407640 loc_407640:			       ; CODE XREF: ___addlocaleref+19j
.text:00407640		       mov     eax, [esi+0B8h]
.text:00407646		       test    eax, eax
.text:00407648		       jz      short loc_40764D
.text:0040764A		       push    eax	       ; lpAddend
.text:0040764B		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:0040764D
.text:0040764D loc_40764D:			       ; CODE XREF: ___addlocaleref+26j
.text:0040764D		       mov     eax, [esi+0B4h]
.text:00407653		       test    eax, eax
.text:00407655		       jz      short loc_40765A
.text:00407657		       push    eax	       ; lpAddend
.text:00407658		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:0040765A
.text:0040765A loc_40765A:			       ; CODE XREF: ___addlocaleref+33j
.text:0040765A		       mov     eax, [esi+0C0h]
.text:00407660		       test    eax, eax
.text:00407662		       jz      short loc_407667
.text:00407664		       push    eax	       ; lpAddend
.text:00407665		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:00407667
.text:00407667 loc_407667:			       ; CODE XREF: ___addlocaleref+40j
.text:00407667		       push    6
.text:00407669		       lea     ebx, [esi+50h]
.text:0040766C		       pop     ebp
.text:0040766D
.text:0040766D loc_40766D:			       ; CODE XREF: ___addlocaleref+71j
.text:0040766D		       cmp     dword ptr [ebx-8], offset ___clocalestr ; "C"
.text:00407674		       jz      short loc_40767F
.text:00407676		       mov     eax, [ebx]
.text:00407678		       test    eax, eax
.text:0040767A		       jz      short loc_40767F
.text:0040767C		       push    eax	       ; lpAddend
.text:0040767D		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:0040767F
.text:0040767F loc_40767F:			       ; CODE XREF: ___addlocaleref+52j
.text:0040767F					       ; ___addlocaleref+58j
.text:0040767F		       cmp     dword ptr [ebx-4], 0
.text:00407683		       jz      short loc_40768F
.text:00407685		       mov     eax, [ebx+4]
.text:00407688		       test    eax, eax
.text:0040768A		       jz      short loc_40768F
.text:0040768C		       push    eax	       ; lpAddend
.text:0040768D		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:0040768F
.text:0040768F loc_40768F:			       ; CODE XREF: ___addlocaleref+61j
.text:0040768F					       ; ___addlocaleref+68j
.text:0040768F		       add     ebx, 10h
.text:00407692		       dec     ebp
.text:00407693		       jnz     short loc_40766D
.text:00407695		       mov     eax, [esi+0D4h]
.text:0040769B		       add     eax, 0B4h
.text:004076A0		       push    eax	       ; lpAddend
.text:004076A1		       call    edi ; InterlockedIncrement(x) ; InterlockedIncrement(x)
.text:004076A3		       pop     edi
.text:004076A4		       pop     esi
.text:004076A5		       pop     ebp
.text:004076A6		       pop     ebx
.text:004076A7		       retn
.text:004076A7 ___addlocaleref endp
.text:004076A7
.text:004076A8
.text:004076A8 ; =============== S U B R O U T I N E =======================================
.text:004076A8
.text:004076A8
.text:004076A8 ; void *__cdecl __removelocaleref(threadlocaleinfostruct	*ptloci)
.text:004076A8 ___removelocaleref proc near	       ; CODE XREF: _freefls(x)+CCp
.text:004076A8					       ; _updatetlocinfoEx_nolock+1Dp ...
.text:004076A8
.text:004076A8 ptloci	       = dword ptr  4
.text:004076A8
.text:004076A8		       push    esi
.text:004076A9		       mov     esi, [esp+4+ptloci]
.text:004076AD		       test    esi, esi
.text:004076AF		       jz      short loc_407730
.text:004076B1		       push    ebx
.text:004076B2		       push    ebp
.text:004076B3		       push    edi
.text:004076B4		       mov     edi, ds:__imp__InterlockedDecrement@4 ; InterlockedDecrement(x)
.text:004076BA		       push    esi	       ; lpAddend
.text:004076BB		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:004076BD		       mov     eax, [esi+0B0h]
.text:004076C3		       test    eax, eax
.text:004076C5		       jz      short loc_4076CA
.text:004076C7		       push    eax	       ; lpAddend
.text:004076C8		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:004076CA
.text:004076CA loc_4076CA:			       ; CODE XREF: ___removelocaleref+1Dj
.text:004076CA		       mov     eax, [esi+0B8h]
.text:004076D0		       test    eax, eax
.text:004076D2		       jz      short loc_4076D7
.text:004076D4		       push    eax	       ; lpAddend
.text:004076D5		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:004076D7
.text:004076D7 loc_4076D7:			       ; CODE XREF: ___removelocaleref+2Aj
.text:004076D7		       mov     eax, [esi+0B4h]
.text:004076DD		       test    eax, eax
.text:004076DF		       jz      short loc_4076E4
.text:004076E1		       push    eax	       ; lpAddend
.text:004076E2		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:004076E4
.text:004076E4 loc_4076E4:			       ; CODE XREF: ___removelocaleref+37j
.text:004076E4		       mov     eax, [esi+0C0h]
.text:004076EA		       test    eax, eax
.text:004076EC		       jz      short loc_4076F1
.text:004076EE		       push    eax	       ; lpAddend
.text:004076EF		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:004076F1
.text:004076F1 loc_4076F1:			       ; CODE XREF: ___removelocaleref+44j
.text:004076F1		       push    6
.text:004076F3		       lea     ebx, [esi+50h]
.text:004076F6		       pop     ebp
.text:004076F7
.text:004076F7 loc_4076F7:			       ; CODE XREF: ___removelocaleref+75j
.text:004076F7		       cmp     dword ptr [ebx-8], offset ___clocalestr ; "C"
.text:004076FE		       jz      short loc_407709
.text:00407700		       mov     eax, [ebx]
.text:00407702		       test    eax, eax
.text:00407704		       jz      short loc_407709
.text:00407706		       push    eax	       ; lpAddend
.text:00407707		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407709
.text:00407709 loc_407709:			       ; CODE XREF: ___removelocaleref+56j
.text:00407709					       ; ___removelocaleref+5Cj
.text:00407709		       cmp     dword ptr [ebx-4], 0
.text:0040770D		       jz      short loc_407719
.text:0040770F		       mov     eax, [ebx+4]
.text:00407712		       test    eax, eax
.text:00407714		       jz      short loc_407719
.text:00407716		       push    eax	       ; lpAddend
.text:00407717		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407719
.text:00407719 loc_407719:			       ; CODE XREF: ___removelocaleref+65j
.text:00407719					       ; ___removelocaleref+6Cj
.text:00407719		       add     ebx, 10h
.text:0040771C		       dec     ebp
.text:0040771D		       jnz     short loc_4076F7
.text:0040771F		       mov     eax, [esi+0D4h]
.text:00407725		       add     eax, 0B4h
.text:0040772A		       push    eax	       ; lpAddend
.text:0040772B		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:0040772D		       pop     edi
.text:0040772E		       pop     ebp
.text:0040772F		       pop     ebx
.text:00407730
.text:00407730 loc_407730:			       ; CODE XREF: ___removelocaleref+7j
.text:00407730		       mov     eax, esi
.text:00407732		       pop     esi
.text:00407733		       retn
.text:00407733 ___removelocaleref endp
.text:00407733
.text:00407734
.text:00407734 ; =============== S U B R O U T I N E =======================================
.text:00407734
.text:00407734
.text:00407734 ; void __usercall copytlocinfo_nolock(threadlocaleinfostruct *ptlocid<eax>, threadlocaleinfostruct *ptlocis<ecx>)
.text:00407734 _copytlocinfo_nolock proc near	       ; CODE XREF: __create_locale+7Ap
.text:00407734					       ; _setlocale+7Bp
.text:00407734 ptlocid = eax
.text:00407734 ptlocis = ecx
.text:00407734		       push    esi
.text:00407735		       mov     esi, ptlocis
.text:00407737		       test    esi, esi
.text:00407739		       jz      short loc_407756
.text:0040773B		       test    ptlocid,	ptlocid
.text:0040773D		       jz      short loc_407756
.text:0040773F		       cmp     ptlocid,	esi
.text:00407741		       jz      short loc_407756
.text:00407743		       push    edi
.text:00407744		       push    36h
.text:00407746		       pop     ptlocis
.text:00407747		       mov     edi, ptlocid
.text:00407749		       rep movsd
.text:0040774B		       and     dword ptr [ptlocid], 0
.text:0040774E		       push    ptlocid	       ; ptloci
.text:0040774F		       call    ___addlocaleref
.text:00407754		       pop     ptlocis
.text:00407755		       pop     edi
.text:00407756
.text:00407756 loc_407756:			       ; CODE XREF: _copytlocinfo_nolock+5j
.text:00407756					       ; _copytlocinfo_nolock+9j ...
.text:00407756		       pop     esi
.text:00407757		       retn
.text:00407757 _copytlocinfo_nolock endp
.text:00407757
.text:00407758
.text:00407758 ; =============== S U B R O U T I N E =======================================
.text:00407758
.text:00407758
.text:00407758 ; threadlocaleinfostruct	*__usercall updatetlocinfoEx_nolock<eax>(threadlocaleinfostruct	**pptlocid<eax>, threadlocaleinfostruct	*ptlocis<edi>)
.text:00407758 _updatetlocinfoEx_nolock	proc near      ; CODE XREF: ___updatetlocinfo+54p
.text:00407758					       ; _setlocale+D7p ...
.text:00407758 pptlocid	= eax
.text:00407758 ptlocis = edi
.text:00407758		       test    ptlocis,	ptlocis
.text:0040775A		       jz      short loc_407793
.text:0040775C		       test    pptlocid, pptlocid
.text:0040775E		       jz      short loc_407793
.text:00407760		       push    esi
.text:00407761		       mov     esi, [pptlocid]
.text:00407763		       cmp     esi, ptlocis
.text:00407765		       jz      short loc_40778F
.text:00407767		       push    ptlocis	       ; ptloci
.text:00407768		       mov     [pptlocid], ptlocis
.text:0040776A		       call    ___addlocaleref
.text:0040776F		       test    esi, esi
.text:00407771		       pop     ecx
.text:00407772		       jz      short loc_40778F
.text:00407774		       push    esi	       ; ptloci
.text:00407775		       call    ___removelocaleref
.text:0040777A		       cmp     dword ptr [esi],	0
.text:0040777D		       pop     ecx
.text:0040777E		       jnz     short loc_40778F
.text:00407780		       cmp     esi, offset ___initiallocinfo
.text:00407786		       jz      short loc_40778F
.text:00407788		       push    esi	       ; ptloci
.text:00407789		       call    ___freetlocinfo
.text:0040778E		       pop     ecx
.text:0040778F
.text:0040778F loc_40778F:			       ; CODE XREF: _updatetlocinfoEx_nolock+Dj
.text:0040778F					       ; _updatetlocinfoEx_nolock+1Aj ...
.text:0040778F		       mov     pptlocid, ptlocis
.text:00407791		       pop     esi
.text:00407792		       retn
.text:00407793 ; ---------------------------------------------------------------------------
.text:00407793
.text:00407793 loc_407793:			       ; CODE XREF: _updatetlocinfoEx_nolock+2j
.text:00407793					       ; _updatetlocinfoEx_nolock+6j
.text:00407793		       xor     pptlocid, pptlocid
.text:00407795		       retn
.text:00407795 _updatetlocinfoEx_nolock	endp
.text:00407795
.text:00407796
.text:00407796 ; =============== S U B R O U T I N E =======================================
.text:00407796
.text:00407796 ; Attributes: bp-based frame
.text:00407796
.text:00407796 ; threadlocaleinfostruct	*__cdecl __updatetlocinfo()
.text:00407796 ___updatetlocinfo proc near	       ; CODE XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+37p
.text:00407796					       ; __get_current_locale:loc_407996p ...
.text:00407796
.text:00407796 ptloci	       = dword ptr -1Ch
.text:00407796 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00407796
.text:00407796		       push    0Ch
.text:00407798		       push    offset dword_421780
.text:0040779D		       call    __SEH_prolog4
.text:004077A2		       call    __getptd
.text:004077A7		       mov     esi, eax
.text:004077A9		       mov     eax, ___globallocalestatus
.text:004077AE		       test    [esi+70h], eax
.text:004077B1		       jz      short loc_4077D5
.text:004077B3		       cmp     dword ptr [esi+6Ch], 0
.text:004077B7		       jz      short loc_4077D5
.text:004077B9		       call    __getptd
.text:004077BE		       mov     esi, [eax+6Ch]
.text:004077C1
.text:004077C1 $LN12_5:				       ; CODE XREF: ___updatetlocinfo+68j
.text:004077C1		       test    esi, esi
.text:004077C3		       jnz     short loc_4077CD
.text:004077C5		       push    20h	       ; rterrnum
.text:004077C7		       call    __amsg_exit
.text:004077CC		       pop     ecx
.text:004077CD
.text:004077CD loc_4077CD:			       ; CODE XREF: ___updatetlocinfo+2Dj
.text:004077CD		       mov     eax, esi
.text:004077CF		       call    __SEH_epilog4
.text:004077D4		       retn
.text:004077D5 ; ---------------------------------------------------------------------------
.text:004077D5
.text:004077D5 loc_4077D5:			       ; CODE XREF: ___updatetlocinfo+1Bj
.text:004077D5					       ; ___updatetlocinfo+21j
.text:004077D5		       push    0Ch	       ; locknum
.text:004077D7		       call    __lock
.text:004077DC		       pop     ecx
.text:004077DD		       and     [ebp+ms_exc.disabled], 0
.text:004077E1		       lea     eax, [esi+6Ch]  ; pptlocid
.text:004077E4		       mov     edi, ___ptlocinfo ; ptlocis
.text:004077EA		       call    _updatetlocinfoEx_nolock
.text:004077EF		       mov     [ebp+ptloci], eax
.text:004077F2		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004077F9		       call    $LN9_4
.text:004077FE		       jmp     short $LN12_5
.text:00407800 ; ---------------------------------------------------------------------------
.text:00407800
.text:00407800 $LN9_4:				       ; CODE XREF: ___updatetlocinfo+63p
.text:00407800					       ; DATA XREF: .rdata:00421798o
.text:00407800		       push    0Ch	       ; locknum
.text:00407802		       call    __unlock
.text:00407807		       pop     ecx
.text:00407808
.text:00407808 $LN10_2:
.text:00407808		       mov     esi, [ebp+ptloci]
.text:0040780B		       retn
.text:0040780B ___updatetlocinfo endp
.text:0040780B
.text:0040780C
.text:0040780C ; =============== S U B R O U T I N E =======================================
.text:0040780C
.text:0040780C
.text:0040780C ; int __cdecl _configthreadlocale(int i)
.text:0040780C __configthreadlocale proc near
.text:0040780C
.text:0040780C i	       = dword ptr  4
.text:0040780C
.text:0040780C		       push    esi
.text:0040780D		       push    edi
.text:0040780E		       call    __getptd
.text:00407813		       mov     ecx, [eax+70h]
.text:00407816		       mov     edx, ecx
.text:00407818		       and     dl, 2
.text:0040781B		       neg     dl
.text:0040781D		       sbb     edx, edx
.text:0040781F		       inc     edx
.text:00407820		       inc     edx
.text:00407821		       mov     edi, edx
.text:00407823		       mov     edx, [esp+8+i]
.text:00407827		       cmp     edx, 0FFFFFFFFh
.text:0040782A		       jz      short loc_407866
.text:0040782C		       xor     esi, esi
.text:0040782E		       cmp     edx, esi
.text:00407830		       jz      short loc_40786D
.text:00407832		       cmp     edx, 1
.text:00407835		       jz      short loc_40785E
.text:00407837		       cmp     edx, 2
.text:0040783A		       jz      short loc_407859
.text:0040783C		       call    __errno
.text:00407841		       push    esi	       ; pReserved
.text:00407842		       push    esi	       ; nLine
.text:00407843		       push    esi	       ; pszFile
.text:00407844		       push    esi	       ; pszFunction
.text:00407845		       push    esi	       ; pszExpression
.text:00407846		       mov     dword ptr [eax],	16h
.text:0040784C		       call    __invalid_parameter
.text:00407851		       add     esp, 14h
.text:00407854		       or      eax, 0FFFFFFFFh
.text:00407857		       jmp     short loc_40786F
.text:00407859 ; ---------------------------------------------------------------------------
.text:00407859
.text:00407859 loc_407859:			       ; CODE XREF: __configthreadlocale+2Ej
.text:00407859		       and     ecx, 0FFFFFFFDh
.text:0040785C		       jmp     short loc_407861
.text:0040785E ; ---------------------------------------------------------------------------
.text:0040785E
.text:0040785E loc_40785E:			       ; CODE XREF: __configthreadlocale+29j
.text:0040785E		       or      ecx, 2
.text:00407861
.text:00407861 loc_407861:			       ; CODE XREF: __configthreadlocale+50j
.text:00407861		       mov     [eax+70h], ecx
.text:00407864		       jmp     short loc_40786D
.text:00407866 ; ---------------------------------------------------------------------------
.text:00407866
.text:00407866 loc_407866:			       ; CODE XREF: __configthreadlocale+1Ej
.text:00407866		       or      ___globallocalestatus, 0FFFFFFFFh
.text:0040786D
.text:0040786D loc_40786D:			       ; CODE XREF: __configthreadlocale+24j
.text:0040786D					       ; __configthreadlocale+58j
.text:0040786D		       mov     eax, edi
.text:0040786F
.text:0040786F loc_40786F:			       ; CODE XREF: __configthreadlocale+4Bj
.text:0040786F		       pop     edi
.text:00407870		       pop     esi
.text:00407871		       retn
.text:00407871 __configthreadlocale endp
.text:00407871
.text:00407872
.text:00407872 ; =============== S U B R O U T I N E =======================================
.text:00407872
.text:00407872
.text:00407872 sync_legacy_variables_lk	proc near      ; CODE XREF: _setlocale+116p
.text:00407872		       mov     eax, ___ptlocinfo ; ___ptlocinfo
.text:00407877		       mov     ecx, [eax+4]
.text:0040787A		       mov     ___lc_codepage, ecx
.text:00407880		       mov     ecx, [eax+8]
.text:00407883		       mov     ___lc_collate_cp, ecx
.text:00407889		       mov     ecx, [eax+0A8h]
.text:0040788F		       mov     ___lc_clike, ecx
.text:00407895		       mov     ecx, [eax+0D4h]
.text:0040789B		       mov     ___lc_time_curr,	ecx
.text:004078A1		       mov     ecx, [eax+0BCh]
.text:004078A7		       mov     ___lconv, ecx
.text:004078AD		       mov     ecx, [eax+0C8h]
.text:004078B3		       mov     __pctype, ecx
.text:004078B9		       mov     eax, [eax+0ACh]
.text:004078BF		       mov     ___mb_cur_max, eax
.text:004078C4		       retn
.text:004078C4 sync_legacy_variables_lk	endp
.text:004078C4
.text:004078C5
.text:004078C5 ; =============== S U B R O U T I N E =======================================
.text:004078C5
.text:004078C5 ; Attributes: bp-based frame
.text:004078C5
.text:004078C5 ; void __cdecl _free_locale(localeinfo_struct *plocinfo)
.text:004078C5 __free_locale   proc near	       ; CODE XREF: ___free_localej
.text:004078C5
.text:004078C5 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004078C5 plocinfo	       = dword ptr  8
.text:004078C5
.text:004078C5		       push    8
.text:004078C7		       push    offset dword_4217A0
.text:004078CC		       call    __SEH_prolog4
.text:004078D1		       mov     esi, [ebp+plocinfo]
.text:004078D4		       xor     edi, edi
.text:004078D6		       cmp     esi, edi
.text:004078D8		       jz      short loc_407949
.text:004078DA		       mov     eax, [esi+4]
.text:004078DD		       cmp     eax, edi
.text:004078DF		       jz      short loc_4078FD
.text:004078E1		       push    eax	       ; lpAddend
.text:004078E2		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:004078E8		       test    eax, eax
.text:004078EA		       jnz     short loc_4078FD
.text:004078EC		       mov     eax, [esi+4]
.text:004078EF		       cmp     eax, offset ___initialmbcinfo
.text:004078F4		       jz      short loc_4078FD
.text:004078F6		       push    eax	       ; pBlock
.text:004078F7		       call    _free
.text:004078FC		       pop     ecx
.text:004078FD
.text:004078FD loc_4078FD:			       ; CODE XREF: __free_locale+1Aj
.text:004078FD					       ; __free_locale+25j ...
.text:004078FD		       cmp     [esi], edi
.text:004078FF		       jz      short $LN12_6
.text:00407901		       push    0Ch	       ; locknum
.text:00407903		       call    __lock
.text:00407908		       pop     ecx
.text:00407909		       mov     [ebp+ms_exc.disabled], edi
.text:0040790C		       push    dword ptr [esi] ; ptloci
.text:0040790E		       call    ___removelocaleref
.text:00407913		       pop     ecx
.text:00407914		       mov     eax, [esi]
.text:00407916		       cmp     eax, edi
.text:00407918		       jz      short loc_40792C
.text:0040791A		       cmp     [eax], edi
.text:0040791C		       jnz     short loc_40792C
.text:0040791E		       cmp     eax, offset ___initiallocinfo
.text:00407923		       jz      short loc_40792C
.text:00407925		       push    eax	       ; ptloci
.text:00407926		       call    ___freetlocinfo
.text:0040792B		       pop     ecx
.text:0040792C
.text:0040792C loc_40792C:			       ; CODE XREF: __free_locale+53j
.text:0040792C					       ; __free_locale+57j ...
.text:0040792C		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00407933		       call    $LN11_4
.text:00407938
.text:00407938 $LN12_6:				       ; CODE XREF: __free_locale+3Aj
.text:00407938		       mov     eax, 0BAADF00Dh
.text:0040793D		       mov     [esi], eax
.text:0040793F		       mov     [esi+4],	eax
.text:00407942		       push    esi	       ; pBlock
.text:00407943		       call    _free
.text:00407948		       pop     ecx
.text:00407949
.text:00407949 loc_407949:			       ; CODE XREF: __free_locale+13j
.text:00407949		       call    __SEH_epilog4
.text:0040794E		       retn
.text:0040794F ; ---------------------------------------------------------------------------
.text:0040794F
.text:0040794F $LN9_5:				       ; DATA XREF: .rdata:004217B8o
.text:0040794F		       mov     esi, [ebp+plocinfo]
.text:00407952
.text:00407952 $LN11_4:				       ; CODE XREF: __free_locale+6Ep
.text:00407952		       push    0Ch	       ; locknum
.text:00407954		       call    __unlock
.text:00407959		       pop     ecx
.text:0040795A
.text:0040795A $LN10_3:
.text:0040795A		       retn
.text:0040795A __free_locale   endp ; sp-analysis failed
.text:0040795A
.text:0040795B ; [00000005 BYTES: COLLAPSED FUNCTION ___free_locale. PRESS KEYPAD "+" TO EXPAND]
.text:00407960
.text:00407960 ; =============== S U B R O U T I N E =======================================
.text:00407960
.text:00407960 ; Attributes: bp-based frame
.text:00407960
.text:00407960 ; localeinfo_struct *__cdecl _get_current_locale()
.text:00407960 __get_current_locale proc near	       ; CODE XREF: ___get_current_localej
.text:00407960
.text:00407960 retval	       = dword ptr -1Ch
.text:00407960 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00407960
.text:00407960		       push    0Ch
.text:00407962		       push    offset dword_4217C0
.text:00407967		       call    __SEH_prolog4
.text:0040796C		       call    __getptd
.text:00407971		       mov     edi, eax
.text:00407973		       push    1	       ; size
.text:00407975		       push    8	       ; count
.text:00407977		       call    __calloc_crt
.text:0040797C		       pop     ecx
.text:0040797D		       pop     ecx
.text:0040797E		       mov     esi, eax
.text:00407980		       mov     [ebp+retval], esi
.text:00407983		       test    esi, esi
.text:00407985		       jnz     short loc_407996
.text:00407987		       call    __errno
.text:0040798C		       mov     dword ptr [eax],	0Ch
.text:00407992		       xor     eax, eax
.text:00407994		       jmp     short loc_4079D6
.text:00407996 ; ---------------------------------------------------------------------------
.text:00407996
.text:00407996 loc_407996:			       ; CODE XREF: __get_current_locale+25j
.text:00407996		       call    ___updatetlocinfo
.text:0040799B		       call    ___updatetmbcinfo
.text:004079A0		       mov     eax, [edi+6Ch]
.text:004079A3		       mov     [esi], eax
.text:004079A5		       mov     eax, [edi+68h]
.text:004079A8		       mov     [esi+4],	eax
.text:004079AB		       push    0Ch	       ; locknum
.text:004079AD		       call    __lock
.text:004079B2		       pop     ecx
.text:004079B3		       and     [ebp+ms_exc.disabled], 0
.text:004079B7		       push    dword ptr [esi] ; ptloci
.text:004079B9		       call    ___addlocaleref
.text:004079BE		       pop     ecx
.text:004079BF		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004079C6		       call    $LN8_3
.text:004079CB
.text:004079CB $LN9_6:				       ; lpAddend
.text:004079CB		       push    dword ptr [esi+4]
.text:004079CE		       call    ds:__imp__InterlockedIncrement@4	; InterlockedIncrement(x)
.text:004079D4		       mov     eax, esi
.text:004079D6
.text:004079D6 loc_4079D6:			       ; CODE XREF: __get_current_locale+34j
.text:004079D6		       call    __SEH_epilog4
.text:004079DB		       retn
.text:004079DC ; ---------------------------------------------------------------------------
.text:004079DC
.text:004079DC $LN6_7:				       ; DATA XREF: .rdata:004217D8o
.text:004079DC		       mov     esi, [ebp+retval]
.text:004079DF
.text:004079DF $LN8_3:				       ; CODE XREF: __get_current_locale+66p
.text:004079DF		       push    0Ch	       ; locknum
.text:004079E1		       call    __unlock
.text:004079E6		       pop     ecx
.text:004079E7
.text:004079E7 $LN7_6:
.text:004079E7		       retn
.text:004079E7 __get_current_locale endp ; sp-analysis failed
.text:004079E7
.text:004079E8 ; [00000005 BYTES: COLLAPSED FUNCTION ___get_current_locale. PRESS KEYPAD "+" TO	EXPAND]
.text:004079ED
.text:004079ED ; =============== S U B R O U T I N E =======================================
.text:004079ED
.text:004079ED
.text:004079ED ; int __cdecl __init_dummy(threadlocaleinfostruct *ploci)
.text:004079ED ___init_dummy   proc near	       ; CODE XREF: _setlocale_set_cat+255p
.text:004079ED					       ; DATA XREF: .rdata:off_41F3E0o
.text:004079ED
.text:004079ED ploci	       = dword ptr  4
.text:004079ED
.text:004079ED		       xor     eax, eax
.text:004079EF		       retn
.text:004079EF ___init_dummy   endp
.text:004079EF
.text:004079F0
.text:004079F0 ; =============== S U B R O U T I N E =======================================
.text:004079F0
.text:004079F0
.text:004079F0 ; void __cdecl _strcats(char *outstr, unsigned int sizeInBytes, int n)
.text:004079F0 __strcats       proc near	       ; CODE XREF: ___lc_lctostr+3Fp
.text:004079F0					       ; ___lc_lctostr+61p ...
.text:004079F0
.text:004079F0 outstr	       = dword ptr  4
.text:004079F0 sizeInBytes     = dword ptr  8
.text:004079F0 n	       = dword ptr  0Ch
.text:004079F0
.text:004079F0		       push    ebx
.text:004079F1		       push    edi
.text:004079F2		       mov     edi, [esp+8+n]
.text:004079F6		       xor     ebx, ebx
.text:004079F8		       cmp     edi, ebx
.text:004079FA		       jle     short loc_407A2B
.text:004079FC		       push    esi
.text:004079FD		       lea     esi, [esp+0Ch+n]
.text:00407A01
.text:00407A01 loc_407A01:			       ; CODE XREF: __strcats+38j
.text:00407A01		       add     esi, 4
.text:00407A04		       push    dword ptr [esi] ; _Src
.text:00407A06		       push    [esp+10h+sizeInBytes] ; _SizeInBytes
.text:00407A0A		       push    [esp+14h+outstr]	; _Dst
.text:00407A0E		       call    _strcat_s
.text:00407A13		       add     esp, 0Ch
.text:00407A16		       test    eax, eax
.text:00407A18		       jz      short loc_407A27
.text:00407A1A		       push    ebx	       ; pReserved
.text:00407A1B		       push    ebx	       ; nLine
.text:00407A1C		       push    ebx	       ; pszFile
.text:00407A1D		       push    ebx	       ; pszFunction
.text:00407A1E		       push    ebx	       ; pszExpression
.text:00407A1F		       call    __invoke_watson
.text:00407A24		       add     esp, 14h
.text:00407A27
.text:00407A27 loc_407A27:			       ; CODE XREF: __strcats+28j
.text:00407A27		       dec     edi
.text:00407A28		       jnz     short loc_407A01
.text:00407A2A		       pop     esi
.text:00407A2B
.text:00407A2B loc_407A2B:			       ; CODE XREF: __strcats+Aj
.text:00407A2B		       pop     edi
.text:00407A2C		       pop     ebx
.text:00407A2D		       retn
.text:00407A2D __strcats       endp
.text:00407A2D
.text:00407A2E
.text:00407A2E ; =============== S U B R O U T I N E =======================================
.text:00407A2E
.text:00407A2E ; Attributes: bp-based frame
.text:00407A2E
.text:00407A2E ; int __cdecl __lc_strtolc(tagLC_STRINGS	*names,	const char *locale)
.text:00407A2E ___lc_strtolc   proc near	       ; CODE XREF: __expandlocale+F9p
.text:00407A2E
.text:00407A2E names	       = dword ptr  8
.text:00407A2E i	       = dword ptr  0Ch
.text:00407A2E
.text:00407A2E		       push    ebp
.text:00407A2F		       mov     ebp, esp
.text:00407A31		       push    ebx
.text:00407A32		       push    esi
.text:00407A33		       push    edi
.text:00407A34		       mov     edi, [ebp+names]
.text:00407A37		       push    90h	       ; count
.text:00407A3C		       xor     ebx, ebx
.text:00407A3E		       push    ebx	       ; value
.text:00407A3F		       push    edi	       ; dst
.text:00407A40		       call    _memset
.text:00407A45		       mov     esi, [ebp+i]
.text:00407A48		       mov     al, [esi]
.text:00407A4A		       add     esp, 0Ch
.text:00407A4D		       test    al, al
.text:00407A4F		       jnz     short loc_407A58
.text:00407A51
.text:00407A51 loc_407A51:			       ; CODE XREF: ___lc_strtolc+60j
.text:00407A51					       ; ___lc_strtolc+F8j ...
.text:00407A51		       xor     eax, eax
.text:00407A53		       jmp     loc_407B52
.text:00407A58 ; ---------------------------------------------------------------------------
.text:00407A58
.text:00407A58 loc_407A58:			       ; CODE XREF: ___lc_strtolc+21j
.text:00407A58		       cmp     al, 2Eh
.text:00407A5A		       jnz     short loc_407A90
.text:00407A5C		       lea     eax, [esi+1]
.text:00407A5F		       cmp     [eax], bl
.text:00407A61		       jz      short loc_407A90
.text:00407A63		       push    0Fh	       ; _Count
.text:00407A65		       push    eax	       ; _Src
.text:00407A66		       lea     eax, [edi+80h]
.text:00407A6C		       push    10h	       ; _SizeInBytes
.text:00407A6E		       push    eax	       ; _Dst
.text:00407A6F		       call    _strncpy_s
.text:00407A74		       add     esp, 10h
.text:00407A77		       test    eax, eax
.text:00407A79		       jz      short loc_407A88
.text:00407A7B		       push    ebx	       ; pReserved
.text:00407A7C		       push    ebx	       ; nLine
.text:00407A7D		       push    ebx	       ; pszFile
.text:00407A7E		       push    ebx	       ; pszFunction
.text:00407A7F		       push    ebx	       ; pszExpression
.text:00407A80		       call    __invoke_watson
.text:00407A85		       add     esp, 14h
.text:00407A88
.text:00407A88 loc_407A88:			       ; CODE XREF: ___lc_strtolc+4Bj
.text:00407A88		       mov     [edi+8Fh], bl
.text:00407A8E		       jmp     short loc_407A51
.text:00407A90 ; ---------------------------------------------------------------------------
.text:00407A90
.text:00407A90 loc_407A90:			       ; CODE XREF: ___lc_strtolc+2Cj
.text:00407A90					       ; ___lc_strtolc+33j
.text:00407A90		       push    offset control  ; "_.,"
.text:00407A95		       push    esi	       ; string
.text:00407A96		       mov     [ebp+i],	ebx
.text:00407A99		       call    _strcspn
.text:00407A9E		       cmp     eax, ebx
.text:00407AA0		       jmp     loc_407B47
.text:00407AA5 ; ---------------------------------------------------------------------------
.text:00407AA5
.text:00407AA5 loc_407AA5:			       ; CODE XREF: ___lc_strtolc+11Bj
.text:00407AA5		       cmp     [ebp+i],	0
.text:00407AA9		       lea     edi, [eax+esi]
.text:00407AAC		       mov     bl, [edi]
.text:00407AAE		       jnz     short loc_407ACB
.text:00407AB0		       cmp     eax, 40h
.text:00407AB3		       jnb     loc_407B4F
.text:00407AB9		       cmp     bl, 2Eh
.text:00407ABC		       jz      loc_407B4F
.text:00407AC2		       push    eax
.text:00407AC3		       push    esi
.text:00407AC4		       push    40h
.text:00407AC6		       push    [ebp+names]
.text:00407AC9		       jmp     short loc_407B08
.text:00407ACB ; ---------------------------------------------------------------------------
.text:00407ACB
.text:00407ACB loc_407ACB:			       ; CODE XREF: ___lc_strtolc+80j
.text:00407ACB		       cmp     [ebp+i],	1
.text:00407ACF		       jnz     short loc_407AE7
.text:00407AD1		       cmp     eax, 40h
.text:00407AD4		       jnb     short loc_407B4F
.text:00407AD6		       cmp     bl, 5Fh
.text:00407AD9		       jz      short loc_407B4F
.text:00407ADB		       push    eax
.text:00407ADC		       mov     eax, [ebp+names]
.text:00407ADF		       push    esi
.text:00407AE0		       push    40h
.text:00407AE2		       add     eax, 40h
.text:00407AE5		       jmp     short loc_407B07
.text:00407AE7 ; ---------------------------------------------------------------------------
.text:00407AE7
.text:00407AE7 loc_407AE7:			       ; CODE XREF: ___lc_strtolc+A1j
.text:00407AE7		       cmp     [ebp+i],	2
.text:00407AEB		       jnz     short loc_407B4F
.text:00407AED		       cmp     eax, 10h
.text:00407AF0		       jnb     short loc_407B4F
.text:00407AF2		       test    bl, bl
.text:00407AF4		       jz      short loc_407AFB
.text:00407AF6		       cmp     bl, 2Ch
.text:00407AF9		       jnz     short loc_407B4F
.text:00407AFB
.text:00407AFB loc_407AFB:			       ; CODE XREF: ___lc_strtolc+C6j
.text:00407AFB		       push    eax	       ; _Count
.text:00407AFC		       mov     eax, [ebp+names]
.text:00407AFF		       push    esi	       ; _Src
.text:00407B00		       push    10h	       ; _SizeInBytes
.text:00407B02		       add     eax, 80h
.text:00407B07
.text:00407B07 loc_407B07:			       ; CODE XREF: ___lc_strtolc+B7j
.text:00407B07		       push    eax	       ; _Dst
.text:00407B08
.text:00407B08 loc_407B08:			       ; CODE XREF: ___lc_strtolc+9Bj
.text:00407B08		       call    _strncpy_s
.text:00407B0D		       add     esp, 10h
.text:00407B10		       test    eax, eax
.text:00407B12		       jz      short loc_407B23
.text:00407B14		       xor     eax, eax
.text:00407B16		       push    eax	       ; pReserved
.text:00407B17		       push    eax	       ; nLine
.text:00407B18		       push    eax	       ; pszFile
.text:00407B19		       push    eax	       ; pszFunction
.text:00407B1A		       push    eax	       ; pszExpression
.text:00407B1B		       call    __invoke_watson
.text:00407B20		       add     esp, 14h
.text:00407B23
.text:00407B23 loc_407B23:			       ; CODE XREF: ___lc_strtolc+E4j
.text:00407B23		       cmp     bl, 2Ch
.text:00407B26		       jz      loc_407A51
.text:00407B2C		       test    bl, bl
.text:00407B2E		       jz      loc_407A51
.text:00407B34		       inc     [ebp+i]
.text:00407B37		       lea     esi, [edi+1]
.text:00407B3A		       push    offset control  ; "_.,"
.text:00407B3F		       push    esi	       ; string
.text:00407B40		       call    _strcspn
.text:00407B45		       test    eax, eax
.text:00407B47
.text:00407B47 loc_407B47:			       ; CODE XREF: ___lc_strtolc+72j
.text:00407B47		       pop     ecx
.text:00407B48		       pop     ecx
.text:00407B49		       jnz     loc_407AA5
.text:00407B4F
.text:00407B4F loc_407B4F:			       ; CODE XREF: ___lc_strtolc+85j
.text:00407B4F					       ; ___lc_strtolc+8Ej ...
.text:00407B4F		       or      eax, 0FFFFFFFFh
.text:00407B52
.text:00407B52 loc_407B52:			       ; CODE XREF: ___lc_strtolc+25j
.text:00407B52		       pop     edi
.text:00407B53		       pop     esi
.text:00407B54		       pop     ebx
.text:00407B55		       pop     ebp
.text:00407B56		       retn
.text:00407B56 ___lc_strtolc   endp
.text:00407B56
.text:00407B57
.text:00407B57 ; =============== S U B R O U T I N E =======================================
.text:00407B57
.text:00407B57 ; Attributes: bp-based frame
.text:00407B57
.text:00407B57 ; void __cdecl __lc_lctostr(char	*locale, unsigned int sizeInBytes, tagLC_STRINGS *names)
.text:00407B57 ___lc_lctostr   proc near	       ; CODE XREF: __expandlocale+12Fp
.text:00407B57
.text:00407B57 locale	       = dword ptr  8
.text:00407B57 sizeInBytes     = dword ptr  0Ch
.text:00407B57 names	       = dword ptr  10h
.text:00407B57
.text:00407B57		       push    ebp
.text:00407B58		       mov     ebp, esp
.text:00407B5A		       push    ebx
.text:00407B5B		       push    esi
.text:00407B5C		       mov     esi, [ebp+names]
.text:00407B5F		       push    esi	       ; _Src
.text:00407B60		       push    [ebp+sizeInBytes] ; _SizeInBytes
.text:00407B63		       push    [ebp+locale]    ; _Dst
.text:00407B66		       call    _strcpy_s
.text:00407B6B		       add     esp, 0Ch
.text:00407B6E		       xor     ebx, ebx
.text:00407B70		       test    eax, eax
.text:00407B72		       jz      short loc_407B81
.text:00407B74		       push    ebx	       ; pReserved
.text:00407B75		       push    ebx	       ; nLine
.text:00407B76		       push    ebx	       ; pszFile
.text:00407B77		       push    ebx	       ; pszFunction
.text:00407B78		       push    ebx	       ; pszExpression
.text:00407B79		       call    __invoke_watson
.text:00407B7E		       add     esp, 14h
.text:00407B81
.text:00407B81 loc_407B81:			       ; CODE XREF: ___lc_lctostr+1Bj
.text:00407B81		       lea     eax, [esi+40h]
.text:00407B84		       cmp     [eax], bl
.text:00407B86		       jz      short loc_407B9E
.text:00407B88		       push    eax
.text:00407B89		       push    offset a_       ; "_"
.text:00407B8E		       push    2	       ; n
.text:00407B90		       push    [ebp+sizeInBytes] ; sizeInBytes
.text:00407B93		       push    [ebp+locale]    ; outstr
.text:00407B96		       call    __strcats
.text:00407B9B		       add     esp, 14h
.text:00407B9E
.text:00407B9E loc_407B9E:			       ; CODE XREF: ___lc_lctostr+2Fj
.text:00407B9E		       lea     eax, [esi+80h]
.text:00407BA4		       cmp     [eax], bl
.text:00407BA6		       pop     esi
.text:00407BA7		       pop     ebx
.text:00407BA8		       jz      short loc_407BC0
.text:00407BAA		       push    eax
.text:00407BAB		       push    offset a__0     ; "."
.text:00407BB0		       push    2	       ; n
.text:00407BB2		       push    [ebp+sizeInBytes] ; sizeInBytes
.text:00407BB5		       push    [ebp+locale]    ; outstr
.text:00407BB8		       call    __strcats
.text:00407BBD		       add     esp, 14h
.text:00407BC0
.text:00407BC0 loc_407BC0:			       ; CODE XREF: ___lc_lctostr+51j
.text:00407BC0		       pop     ebp
.text:00407BC1		       retn
.text:00407BC1 ___lc_lctostr   endp
.text:00407BC1
.text:00407BC2
.text:00407BC2 ; =============== S U B R O U T I N E =======================================
.text:00407BC2
.text:00407BC2
.text:00407BC2 ; char *__usercall setlocale_get_all<eax>(threadlocaleinfostruct	*ploci<esi>)
.text:00407BC2 _setlocale_get_all proc near	       ; CODE XREF: _setlocale_nolock:loc_4083B4p
.text:00407BC2
.text:00407BC2 i	       = dword ptr -10h
.text:00407BC2 same	       = dword ptr -0Ch
.text:00407BC2 refcount	       = dword ptr -8
.text:00407BC2 pBlock	       = dword ptr -4
.text:00407BC2
.text:00407BC2 ploci = esi
.text:00407BC2		       sub     esp, 10h
.text:00407BC5		       push    ebx
.text:00407BC6		       xor     ebx, ebx
.text:00407BC8		       inc     ebx
.text:00407BC9		       push    355h	       ; cb
.text:00407BCE		       mov     [esp+18h+refcount], ebx
.text:00407BD2		       call    __malloc_crt
.text:00407BD7		       test    eax, eax
.text:00407BD9		       pop     ecx
.text:00407BDA		       mov     [esp+14h+pBlock], eax
.text:00407BDE		       jz      loc_407D2E
.text:00407BE4		       push    ebp
.text:00407BE5		       push    edi
.text:00407BE6		       lea     edi, [eax+4]
.text:00407BE9		       mov     byte ptr	[edi], 0
.text:00407BEC		       mov     [eax], ebx
.text:00407BEE		       lea     ebp, [ploci+10h]
.text:00407BF1		       mov     [esp+1Ch+same], ebx
.text:00407BF5		       lea     ebx, [ebp+48h]
.text:00407BF8		       push    dword ptr [ebx]
.text:00407BFA		       push    offset asc_41F4B0 ; "="
.text:00407BFF		       push    ds:off_41F3E4
.text:00407C05		       push    3	       ; n
.text:00407C07		       push    351h	       ; sizeInBytes
.text:00407C0C		       push    edi	       ; outstr
.text:00407C0D		       call    __strcats
.text:00407C12		       add     esp, 18h
.text:00407C15		       mov     [esp+1Ch+i], offset off_41F3E4
.text:00407C1D
.text:00407C1D loc_407C1D:			       ; CODE XREF: _setlocale_get_all+D1j
.text:00407C1D		       push    offset asc_41F4AC ; ";"
.text:00407C22		       push    351h	       ; _SizeInBytes
.text:00407C27		       push    edi	       ; _Dst
.text:00407C28		       call    _strcat_s
.text:00407C2D		       add     esp, 0Ch
.text:00407C30		       test    eax, eax
.text:00407C32		       jz      short loc_407C43
.text:00407C34		       xor     eax, eax
.text:00407C36		       push    eax	       ; pReserved
.text:00407C37		       push    eax	       ; nLine
.text:00407C38		       push    eax	       ; pszFile
.text:00407C39		       push    eax	       ; pszFunction
.text:00407C3A		       push    eax	       ; pszExpression
.text:00407C3B		       call    __invoke_watson
.text:00407C40		       add     esp, 14h
.text:00407C43
.text:00407C43 loc_407C43:			       ; CODE XREF: _setlocale_get_all+70j
.text:00407C43		       push    dword ptr [ebp+58h] ; str2
.text:00407C46		       push    dword ptr [ebx] ; str1
.text:00407C48		       call    _strcmp
.text:00407C4D		       test    eax, eax
.text:00407C4F		       pop     ecx
.text:00407C50		       pop     ecx
.text:00407C51		       jz      short loc_407C58
.text:00407C53		       and     [esp+1Ch+refcount], 0
.text:00407C58
.text:00407C58 loc_407C58:			       ; CODE XREF: _setlocale_get_all+8Fj
.text:00407C58		       inc     [esp+1Ch+same]
.text:00407C5C		       mov     eax, [esp+1Ch+same]
.text:00407C60		       add     [esp+1Ch+i], 0Ch
.text:00407C65		       shl     eax, 4
.text:00407C68		       lea     ebp, [eax+ploci]
.text:00407C6B		       mov     eax, [esp+1Ch+i]
.text:00407C6F		       lea     ebx, [ebp+48h]
.text:00407C72		       push    dword ptr [ebx]
.text:00407C74		       push    offset asc_41F4B0 ; "="
.text:00407C79		       push    dword ptr [eax]
.text:00407C7B		       push    3	       ; n
.text:00407C7D		       push    351h	       ; sizeInBytes
.text:00407C82		       push    edi	       ; outstr
.text:00407C83		       call    __strcats
.text:00407C88		       add     esp, 18h
.text:00407C8B		       cmp     [esp+1Ch+i], offset off_41F414
.text:00407C93		       jl      short loc_407C1D
.text:00407C95		       xor     ebp, ebp
.text:00407C97		       cmp     [esp+1Ch+refcount], ebp
.text:00407C9B		       jnz     short loc_407CDF
.text:00407C9D		       mov     eax, [ploci+50h]
.text:00407CA0		       cmp     eax, ebp
.text:00407CA2		       mov     ebx, ds:__imp__InterlockedDecrement@4 ; InterlockedDecrement(x)
.text:00407CA8		       jz      short loc_407CBA
.text:00407CAA		       push    eax	       ; lpAddend
.text:00407CAB		       call    ebx ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407CAD		       test    eax, eax
.text:00407CAF		       jnz     short loc_407CBA
.text:00407CB1		       push    dword ptr [ploci+50h] ; pBlock
.text:00407CB4		       call    _free
.text:00407CB9		       pop     ecx
.text:00407CBA
.text:00407CBA loc_407CBA:			       ; CODE XREF: _setlocale_get_all+E6j
.text:00407CBA					       ; _setlocale_get_all+EDj
.text:00407CBA		       mov     eax, [ploci+54h]
.text:00407CBD		       cmp     eax, ebp
.text:00407CBF		       jz      short loc_407CD1
.text:00407CC1		       push    eax	       ; lpAddend
.text:00407CC2		       call    ebx ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407CC4		       test    eax, eax
.text:00407CC6		       jnz     short loc_407CD1
.text:00407CC8		       push    dword ptr [ploci+54h] ; pBlock
.text:00407CCB		       call    _free
.text:00407CD0		       pop     ecx
.text:00407CD1
.text:00407CD1 loc_407CD1:			       ; CODE XREF: _setlocale_get_all+FDj
.text:00407CD1					       ; _setlocale_get_all+104j
.text:00407CD1		       mov     eax, [esp+1Ch+pBlock]
.text:00407CD5		       mov     [ploci+50h], eax
.text:00407CD8		       mov     [ploci+48h], edi
.text:00407CDB		       mov     eax, edi
.text:00407CDD		       jmp     short loc_407D26
.text:00407CDF ; ---------------------------------------------------------------------------
.text:00407CDF
.text:00407CDF loc_407CDF:			       ; CODE XREF: _setlocale_get_all+D9j
.text:00407CDF		       push    [esp+1Ch+pBlock]	; pBlock
.text:00407CE3		       call    _free
.text:00407CE8		       mov     eax, [ploci+50h]
.text:00407CEB		       cmp     eax, ebp
.text:00407CED		       mov     edi, ds:__imp__InterlockedDecrement@4 ; InterlockedDecrement(x)
.text:00407CF3		       pop     ecx
.text:00407CF4		       jz      short loc_407D06
.text:00407CF6		       push    eax	       ; lpAddend
.text:00407CF7		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407CF9		       test    eax, eax
.text:00407CFB		       jnz     short loc_407D06
.text:00407CFD		       push    dword ptr [ploci+50h] ; pBlock
.text:00407D00		       call    _free
.text:00407D05		       pop     ecx
.text:00407D06
.text:00407D06 loc_407D06:			       ; CODE XREF: _setlocale_get_all+132j
.text:00407D06					       ; _setlocale_get_all+139j
.text:00407D06		       mov     eax, [ploci+54h]
.text:00407D09		       cmp     eax, ebp
.text:00407D0B		       jz      short loc_407D1D
.text:00407D0D		       push    eax	       ; lpAddend
.text:00407D0E		       call    edi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:00407D10		       test    eax, eax
.text:00407D12		       jnz     short loc_407D1D
.text:00407D14		       push    dword ptr [ploci+54h] ; pBlock
.text:00407D17		       call    _free
.text:00407D1C		       pop     ecx
.text:00407D1D
.text:00407D1D loc_407D1D:			       ; CODE XREF: _setlocale_get_all+149j
.text:00407D1D					       ; _setlocale_get_all+150j
.text:00407D1D		       mov     eax, [ploci+68h]
.text:00407D20		       mov     [ploci+50h], ebp
.text:00407D23		       mov     [ploci+48h], ebp
.text:00407D26
.text:00407D26 loc_407D26:			       ; CODE XREF: _setlocale_get_all+11Bj
.text:00407D26		       pop     edi
.text:00407D27		       mov     [ploci+4Ch], ebp
.text:00407D2A		       mov     [ploci+54h], ebp
.text:00407D2D		       pop     ebp
.text:00407D2E
.text:00407D2E loc_407D2E:			       ; CODE XREF: _setlocale_get_all+1Cj
.text:00407D2E		       pop     ebx
.text:00407D2F		       add     esp, 10h
.text:00407D32		       retn
.text:00407D32 _setlocale_get_all endp
.text:00407D32
.text:00407D33
.text:00407D33 ; =============== S U B R O U T I N E =======================================
.text:00407D33
.text:00407D33 ; Attributes: bp-based frame fpd=60h
.text:00407D33
.text:00407D33 ; char *__cdecl _expandlocale(char *expr, char *output, unsigned	int sizeInChars, tagLC_ID *id, unsigned	int *cp, int category)
.text:00407D33 __expandlocale  proc near	       ; CODE XREF: _setlocale_set_cat+41p
.text:00407D33					       ; _setlocale_nolock+168p
.text:00407D33
.text:00407D33 charactersInSource= dword ptr -0B4h
.text:00407D33 charactersInExpression= dword ptr -0B0h
.text:00407D33 pcachecp	       = dword ptr -0ACh
.text:00407D33 cachein	       = dword ptr -0A8h
.text:00407D33 dst	       = dword ptr -0A4h
.text:00407D33 var_A0	       = dword ptr -0A0h
.text:00407D33 _Dst	       = dword ptr -9Ch
.text:00407D33 cacheout	       = dword ptr -98h
.text:00407D33 names	       = tagLC_STRINGS ptr -94h
.text:00407D33 var_4	       = dword ptr -4
.text:00407D33 expr	       = dword ptr  8
.text:00407D33 output	       = dword ptr  0Ch
.text:00407D33 sizeInChars     = dword ptr  10h
.text:00407D33 id	       = dword ptr  14h
.text:00407D33 cp	       = dword ptr  18h
.text:00407D33 category	       = dword ptr  1Ch
.text:00407D33
.text:00407D33		       push    ebp
.text:00407D34		       lea     ebp, [esp-60h]
.text:00407D38		       sub     esp, 0B4h
.text:00407D3E		       mov     eax, ___security_cookie
.text:00407D43		       xor     eax, ebp
.text:00407D45		       mov     [ebp+60h+var_4],	eax
.text:00407D48		       mov     eax, [ebp+60h+output]
.text:00407D4B		       push    ebx
.text:00407D4C		       push    esi
.text:00407D4D		       mov     esi, [ebp+60h+expr]
.text:00407D50		       push    edi
.text:00407D51		       mov     edi, [ebp+60h+id]
.text:00407D54		       mov     [ebp+60h+_Dst], eax
.text:00407D57		       mov     eax, [ebp+60h+cp]
.text:00407D5A		       mov     [ebp+60h+dst], edi
.text:00407D5D		       mov     [ebp+60h+var_A0], eax
.text:00407D60		       call    __getptd
.text:00407D65		       add     eax, 9Ch
.text:00407D6A		       lea     ecx, [eax+28h]
.text:00407D6D		       mov     [ebp+60h+pcachecp], ecx
.text:00407D70		       lea     ecx, [eax+2Ch]
.text:00407D73		       lea     ebx, [eax+20h]
.text:00407D76		       add     eax, 0AFh
.text:00407D7B		       test    esi, esi
.text:00407D7D		       mov     [ebp+60h+cachein], ecx
.text:00407D80		       mov     [ebp+60h+cacheout], eax
.text:00407D83		       jz      loc_407EF3
.text:00407D89		       cmp     [ebp+60h+_Dst], 0
.text:00407D8D		       jz      loc_407EF3
.text:00407D93		       cmp     [ebp+60h+sizeInChars], 0
.text:00407D97		       jz      loc_407EF3
.text:00407D9D		       cmp     byte ptr	[esi], 43h
.text:00407DA0		       jnz     short loc_407DEE
.text:00407DA2		       cmp     byte ptr	[esi+1], 0
.text:00407DA6		       jnz     short loc_407DEE
.text:00407DA8		       push    offset aC       ; "C"
.text:00407DAD		       push    [ebp+60h+sizeInChars] ; _SizeInBytes
.text:00407DB0		       push    [ebp+60h+_Dst]  ; _Dst
.text:00407DB3		       call    _strcpy_s
.text:00407DB8		       add     esp, 0Ch
.text:00407DBB		       xor     esi, esi
.text:00407DBD		       test    eax, eax
.text:00407DBF		       jz      short loc_407DCE
.text:00407DC1		       push    esi	       ; pReserved
.text:00407DC2		       push    esi	       ; nLine
.text:00407DC3		       push    esi	       ; pszFile
.text:00407DC4		       push    esi	       ; pszFunction
.text:00407DC5		       push    esi	       ; pszExpression
.text:00407DC6		       call    __invoke_watson
.text:00407DCB		       add     esp, 14h
.text:00407DCE
.text:00407DCE loc_407DCE:			       ; CODE XREF: __expandlocale+8Cj
.text:00407DCE		       cmp     edi, esi
.text:00407DD0		       jz      short loc_407DDD
.text:00407DD2		       mov     [edi], si
.text:00407DD5		       mov     [edi+2],	si
.text:00407DD9		       mov     [edi+4],	si
.text:00407DDD
.text:00407DDD loc_407DDD:			       ; CODE XREF: __expandlocale+9Dj
.text:00407DDD		       mov     eax, [ebp+60h+var_A0]
.text:00407DE0		       cmp     eax, esi
.text:00407DE2		       jz      short loc_407DE6
.text:00407DE4		       mov     [eax], esi
.text:00407DE6
.text:00407DE6 loc_407DE6:			       ; CODE XREF: __expandlocale+AFj
.text:00407DE6		       mov     eax, [ebp+60h+_Dst]
.text:00407DE9		       jmp     loc_407EF5
.text:00407DEE ; ---------------------------------------------------------------------------
.text:00407DEE
.text:00407DEE loc_407DEE:			       ; CODE XREF: __expandlocale+6Dj
.text:00407DEE					       ; __expandlocale+73j
.text:00407DEE		       push    esi	       ; buf
.text:00407DEF		       call    _strlen
.text:00407DF4		       mov     edi, 83h
.text:00407DF9		       cmp     eax, edi
.text:00407DFB		       pop     ecx
.text:00407DFC		       mov     [ebp+60h+charactersInExpression], eax
.text:00407DFF		       jnb     short loc_407E23
.text:00407E01		       push    esi	       ; str2
.text:00407E02		       push    [ebp+60h+cacheout] ; str1
.text:00407E05		       call    _strcmp
.text:00407E0A		       test    eax, eax
.text:00407E0C		       pop     ecx
.text:00407E0D		       pop     ecx
.text:00407E0E		       jz      loc_407EA2
.text:00407E14		       push    esi	       ; str2
.text:00407E15		       push    [ebp+60h+cachein] ; str1
.text:00407E18		       call    _strcmp
.text:00407E1D		       test    eax, eax
.text:00407E1F		       pop     ecx
.text:00407E20		       pop     ecx
.text:00407E21		       jz      short loc_407EA2
.text:00407E23
.text:00407E23 loc_407E23:			       ; CODE XREF: __expandlocale+CCj
.text:00407E23		       and     [ebp+60h+charactersInSource], 0
.text:00407E27		       lea     eax, [ebp+60h+names]
.text:00407E2A		       push    esi	       ; locale
.text:00407E2B		       push    eax	       ; names
.text:00407E2C		       call    ___lc_strtolc
.text:00407E31		       test    eax, eax
.text:00407E33		       pop     ecx
.text:00407E34		       pop     ecx
.text:00407E35		       jnz     loc_407EF3
.text:00407E3B		       lea     eax, [ebp+60h+names]
.text:00407E3E		       push    eax	       ; lpOutStr
.text:00407E3F		       push    ebx	       ; lpOutId
.text:00407E40		       push    eax	       ; lpInStr
.text:00407E41		       call    ___get_qualified_locale
.text:00407E46		       add     esp, 0Ch
.text:00407E49		       test    eax, eax
.text:00407E4B		       jz      loc_407EF3
.text:00407E51		       movzx   eax, word ptr [ebx+4]
.text:00407E55		       mov     ecx, [ebp+60h+pcachecp]
.text:00407E58		       mov     [ecx], eax
.text:00407E5A		       lea     eax, [ebp+60h+names]
.text:00407E5D		       push    eax	       ; names
.text:00407E5E		       push    edi	       ; sizeInBytes
.text:00407E5F		       push    [ebp+60h+cacheout] ; locale
.text:00407E62		       call    ___lc_lctostr
.text:00407E67		       add     esp, 0Ch
.text:00407E6A		       cmp     byte ptr	[esi], 0
.text:00407E6D		       jz      short loc_407E76
.text:00407E6F		       mov     eax, [ebp+60h+charactersInExpression]
.text:00407E72		       cmp     eax, edi
.text:00407E74		       jb      short loc_407E7E
.text:00407E76
.text:00407E76 loc_407E76:			       ; CODE XREF: __expandlocale+13Aj
.text:00407E76		       mov     eax, [ebp+60h+charactersInSource]
.text:00407E79		       mov     esi, offset word_41F4B2
.text:00407E7E
.text:00407E7E loc_407E7E:			       ; CODE XREF: __expandlocale+141j
.text:00407E7E		       inc     eax
.text:00407E7F		       push    eax	       ; _Count
.text:00407E80		       push    esi	       ; _Src
.text:00407E81		       push    edi	       ; _SizeInBytes
.text:00407E82		       push    [ebp+60h+cachein] ; _Dst
.text:00407E85		       call    _strncpy_s
.text:00407E8A		       add     esp, 10h
.text:00407E8D		       test    eax, eax
.text:00407E8F		       jz      short loc_407EA2
.text:00407E91		       xor     esi, esi
.text:00407E93		       push    esi	       ; pReserved
.text:00407E94		       push    esi	       ; nLine
.text:00407E95		       push    esi	       ; pszFile
.text:00407E96		       push    esi	       ; pszFunction
.text:00407E97		       push    esi	       ; pszExpression
.text:00407E98		       call    __invoke_watson
.text:00407E9D		       add     esp, 14h
.text:00407EA0		       jmp     short loc_407EA4
.text:00407EA2 ; ---------------------------------------------------------------------------
.text:00407EA2
.text:00407EA2 loc_407EA2:			       ; CODE XREF: __expandlocale+DBj
.text:00407EA2					       ; __expandlocale+EEj ...
.text:00407EA2		       xor     esi, esi
.text:00407EA4
.text:00407EA4 loc_407EA4:			       ; CODE XREF: __expandlocale+16Dj
.text:00407EA4		       cmp     [ebp+60h+dst], esi
.text:00407EA7		       jz      short loc_407EB7
.text:00407EA9		       push    6	       ; count
.text:00407EAB		       push    ebx	       ; src
.text:00407EAC		       push    [ebp+60h+dst]   ; dst
.text:00407EAF		       call    _memcpy
.text:00407EB4		       add     esp, 0Ch
.text:00407EB7
.text:00407EB7 loc_407EB7:			       ; CODE XREF: __expandlocale+174j
.text:00407EB7		       cmp     [ebp+60h+var_A0], esi
.text:00407EBA		       jz      short loc_407ECC
.text:00407EBC		       push    4	       ; count
.text:00407EBE		       push    [ebp+60h+pcachecp] ; src
.text:00407EC1		       push    [ebp+60h+var_A0]	; dst
.text:00407EC4		       call    _memcpy
.text:00407EC9		       add     esp, 0Ch
.text:00407ECC
.text:00407ECC loc_407ECC:			       ; CODE XREF: __expandlocale+187j
.text:00407ECC		       push    [ebp+60h+cacheout] ; _Src
.text:00407ECF		       push    [ebp+60h+sizeInChars] ; _SizeInBytes
.text:00407ED2		       push    [ebp+60h+_Dst]  ; _Dst
.text:00407ED5		       call    _strcpy_s
.text:00407EDA		       add     esp, 0Ch
.text:00407EDD		       test    eax, eax
.text:00407EDF		       jz      short loc_407EEE
.text:00407EE1		       push    esi	       ; pReserved
.text:00407EE2		       push    esi	       ; nLine
.text:00407EE3		       push    esi	       ; pszFile
.text:00407EE4		       push    esi	       ; pszFunction
.text:00407EE5		       push    esi	       ; pszExpression
.text:00407EE6		       call    __invoke_watson
.text:00407EEB		       add     esp, 14h
.text:00407EEE
.text:00407EEE loc_407EEE:			       ; CODE XREF: __expandlocale+1ACj
.text:00407EEE		       mov     eax, [ebp+60h+cacheout]
.text:00407EF1		       jmp     short loc_407EF5
.text:00407EF3 ; ---------------------------------------------------------------------------
.text:00407EF3
.text:00407EF3 loc_407EF3:			       ; CODE XREF: __expandlocale+50j
.text:00407EF3					       ; __expandlocale+5Aj ...
.text:00407EF3		       xor     eax, eax
.text:00407EF5
.text:00407EF5 loc_407EF5:			       ; CODE XREF: __expandlocale+B6j
.text:00407EF5					       ; __expandlocale+1BEj
.text:00407EF5		       mov     ecx, [ebp+60h+var_4]
.text:00407EF8		       pop     edi
.text:00407EF9		       pop     esi
.text:00407EFA		       xor     ecx, ebp
.text:00407EFC		       pop     ebx
.text:00407EFD		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00407F02		       add     ebp, 60h
.text:00407F05		       leave
.text:00407F06		       retn
.text:00407F06 __expandlocale  endp
.text:00407F06
.text:00407F07
.text:00407F07 ; =============== S U B R O U T I N E =======================================
.text:00407F07
.text:00407F07 ; Attributes: bp-based frame fpd=74h
.text:00407F07
.text:00407F07 ; char *__usercall setlocale_set_cat<eax>(threadlocaleinfostruct	*ploci<esi>, int category, const char *locale<ecx>)
.text:00407F07 _setlocale_set_cat proc near	       ; CODE XREF: _setlocale_nolock+2Bp
.text:00407F07					       ; _setlocale_nolock+12Dp ...
.text:00407F07
.text:00407F07 oldid	       = tagLC_ID ptr -1C4h
.text:00407F07 buf2	       = _is_ctype_compatible ptr -1BCh
.text:00407F07 oldcodepage     = dword ptr -1B4h
.text:00407F07 idtemp	       = tagLC_ID ptr -1B0h
.text:00407F07 oldhandle       = dword ptr -1A8h
.text:00407F07 oldlocale       = dword ptr -1A4h
.text:00407F07 buf1	       = _is_ctype_compatible ptr -1A0h
.text:00407F07 cptemp	       = dword ptr -198h
.text:00407F07 var_194	       = dword ptr -194h
.text:00407F07 pch	       = dword ptr -190h
.text:00407F07 i	       = dword ptr -18Ch
.text:00407F07 out	       = word ptr -188h
.text:00407F07 lctemp	       = byte ptr -88h
.text:00407F07 var_4	       = dword ptr -4
.text:00407F07 category	       = dword ptr  8
.text:00407F07
.text:00407F07 ploci = esi
.text:00407F07 locale =	ecx
.text:00407F07		       push    ebp
.text:00407F08		       lea     ebp, [esp-74h]
.text:00407F0C		       sub     esp, 1C4h
.text:00407F12		       mov     eax, ___security_cookie
.text:00407F17		       xor     eax, ebp
.text:00407F19		       mov     [ebp+74h+var_4],	eax
.text:00407F1C		       push    ebx
.text:00407F1D		       push    edi
.text:00407F1E		       mov     ebx, locale
.text:00407F20		       call    __getptd
.text:00407F25		       push    [ebp+74h+category] ; category
.text:00407F28		       mov     edi, eax
.text:00407F2A		       lea     eax, [ebp+74h+cptemp]
.text:00407F30		       push    eax	       ; cp
.text:00407F31		       lea     eax, [ebp+74h+idtemp]
.text:00407F37		       push    eax	       ; id
.text:00407F38		       push    83h	       ; sizeInChars
.text:00407F3D		       lea     eax, [ebp+74h+lctemp]
.text:00407F40		       push    eax	       ; output
.text:00407F41		       push    ebx	       ; expr
.text:00407F42		       add     edi, 1D0h
.text:00407F48		       call    __expandlocale
.text:00407F4D		       add     esp, 18h
.text:00407F50		       test    eax, eax
.text:00407F52		       jnz     short loc_407F5B
.text:00407F54
.text:00407F54 loc_407F54:			       ; CODE XREF: _setlocale_set_cat+95j
.text:00407F54					       ; _setlocale_set_cat+28Cj
.text:00407F54		       xor     eax, eax
.text:00407F56		       jmp     loc_4081EC
.text:00407F5B ; ---------------------------------------------------------------------------
.text:00407F5B
.text:00407F5B loc_407F5B:			       ; CODE XREF: _setlocale_set_cat+4Bj
.text:00407F5B		       mov     eax, [ebp+74h+category]
.text:00407F5E		       shl     eax, 4
.text:00407F61		       lea     ebx, [eax+ploci]
.text:00407F64		       push    dword ptr [ebx+48h] ; str2
.text:00407F67		       lea     eax, [ebp+74h+lctemp]
.text:00407F6A		       push    eax	       ; str1
.text:00407F6B		       call    _strcmp
.text:00407F70		       test    eax, eax
.text:00407F72		       pop     locale
.text:00407F73		       pop     locale
.text:00407F74		       jz      loc_4081E9
.text:00407F7A		       lea     eax, [ebp+74h+lctemp]
.text:00407F7D		       push    eax	       ; buf
.text:00407F7E		       call    _strlen
.text:00407F83		       add     eax, 5
.text:00407F86		       push    eax	       ; cb
.text:00407F87		       mov     [ebp+74h+i], eax
.text:00407F8D		       call    __malloc_crt
.text:00407F92		       test    eax, eax
.text:00407F94		       pop     locale
.text:00407F95		       pop     locale
.text:00407F96		       mov     [ebp+74h+pch], eax
.text:00407F9C		       jz      short loc_407F54
.text:00407F9E		       mov     eax, [ebx+48h]
.text:00407FA1		       mov     locale, [ebp+74h+category]
.text:00407FA4		       mov     [ebp+74h+oldlocale], eax
.text:00407FAA		       lea     eax, [ploci+locale*4+0Ch]
.text:00407FAE		       add     locale, 6
.text:00407FB1		       imul    locale, 6
.text:00407FB4		       mov     [ebp+74h+var_194], eax
.text:00407FBA		       mov     eax, [eax]
.text:00407FBC		       mov     [ebp+74h+oldhandle], eax
.text:00407FC2		       lea     eax, [locale+ploci]
.text:00407FC5		       push    6	       ; count
.text:00407FC7		       push    eax	       ; src
.text:00407FC8		       mov     [ebp+74h+buf1.is_clike],	eax
.text:00407FCE		       lea     eax, [ebp+74h+oldid]
.text:00407FD4		       push    eax	       ; dst
.text:00407FD5		       call    _memcpy
.text:00407FDA		       mov     eax, [ploci+4]
.text:00407FDD		       lea     locale, [ebp+74h+lctemp]
.text:00407FE0		       push    locale	       ; _Src
.text:00407FE1		       mov     locale, [ebp+74h+i]
.text:00407FE7		       mov     [ebp+74h+oldcodepage], eax
.text:00407FED		       mov     eax, [ebp+74h+pch]
.text:00407FF3		       add     locale, 0FFFFFFFCh
.text:00407FF6		       add     eax, 4
.text:00407FF9		       push    locale	       ; _SizeInBytes
.text:00407FFA		       push    eax	       ; _Dst
.text:00407FFB		       call    _strcpy_s
.text:00408000		       add     esp, 18h
.text:00408003		       test    eax, eax
.text:00408005		       jz      short loc_408016
.text:00408007		       xor     eax, eax
.text:00408009		       push    eax	       ; pReserved
.text:0040800A		       push    eax	       ; nLine
.text:0040800B		       push    eax	       ; pszFile
.text:0040800C		       push    eax	       ; pszFunction
.text:0040800D		       push    eax	       ; pszExpression
.text:0040800E		       call    __invoke_watson
.text:00408013		       add     esp, 14h
.text:00408016
.text:00408016 loc_408016:			       ; CODE XREF: _setlocale_set_cat+FEj
.text:00408016		       mov     eax, [ebp+74h+pch]
.text:0040801C		       mov     locale, [ebp+74h+var_194]
.text:00408022		       add     eax, 4
.text:00408025		       mov     [ebx+48h], eax
.text:00408028		       movzx   eax, [ebp+74h+idtemp.wLanguage]
.text:0040802F		       mov     [locale], eax
.text:00408031		       push    6	       ; count
.text:00408033		       lea     eax, [ebp+74h+idtemp]
.text:00408039		       push    eax	       ; src
.text:0040803A		       push    [ebp+74h+buf1.is_clike] ; dst
.text:00408040		       call    _memcpy
.text:00408045		       add     esp, 0Ch
.text:00408048		       cmp     [ebp+74h+category], 2
.text:0040804C		       jnz     loc_408146
.text:00408052		       mov     eax, [ebp+74h+cptemp]
.text:00408058		       and     [ebp+74h+i], 0
.text:0040805F		       mov     [ploci+4], eax
.text:00408062		       mov     eax, [edi+24h]
.text:00408065		       mov     locale, [edi+20h]
.text:00408068		       mov     [ebp+74h+buf1.is_clike],	eax
.text:0040806E		       mov     eax, edi
.text:00408070
.text:00408070 loc_408070:			       ; CODE XREF: _setlocale_set_cat+1A2j
.text:00408070		       mov     edx, [ploci+4]
.text:00408073		       cmp     edx, [eax]
.text:00408075		       jz      short loc_4080AD
.text:00408077		       mov     edx, [eax]
.text:00408079		       inc     [ebp+74h+i]
.text:0040807F		       mov     [eax], locale
.text:00408081		       mov     locale, [ebp+74h+buf1.is_clike]
.text:00408087		       mov     [ebp+74h+buf2.id], edx
.text:0040808D		       mov     edx, [eax+4]
.text:00408090		       mov     [eax+4],	locale
.text:00408093		       mov     locale, [ebp+74h+buf2.id]
.text:00408099		       add     eax, 8
.text:0040809C		       cmp     [ebp+74h+i], 5
.text:004080A3		       mov     [ebp+74h+buf1.is_clike],	edx
.text:004080A9		       jl      short loc_408070
.text:004080AB		       jmp     short loc_4080CF
.text:004080AD ; ---------------------------------------------------------------------------
.text:004080AD
.text:004080AD loc_4080AD:			       ; CODE XREF: _setlocale_set_cat+16Ej
.text:004080AD		       mov     eax, [ebp+74h+i]
.text:004080B3		       test    eax, eax
.text:004080B5		       jz      short loc_4080CF
.text:004080B7		       lea     eax, [edi+eax*8]
.text:004080BA		       mov     edx, [eax]
.text:004080BC		       mov     [edi], edx
.text:004080BE		       mov     edx, [eax+4]
.text:004080C1		       mov     [edi+4],	edx
.text:004080C4		       mov     [eax], locale
.text:004080C6		       mov     locale, [ebp+74h+buf1.is_clike]
.text:004080CC		       mov     [eax+4],	locale
.text:004080CF
.text:004080CF loc_4080CF:			       ; CODE XREF: _setlocale_set_cat+1A4j
.text:004080CF					       ; _setlocale_set_cat+1AEj
.text:004080CF		       cmp     [ebp+74h+i], 5
.text:004080D6		       jnz     short loc_40813D
.text:004080D8		       push    1	       ; bError
.text:004080DA		       push    dword ptr [ploci+14h] ; lcid
.text:004080DD		       lea     eax, [ebp+74h+out]
.text:004080E3		       push    dword ptr [ploci+4] ; code_page
.text:004080E6		       push    eax	       ; lpCharType
.text:004080E7		       push    7Fh	       ; cchSrc
.text:004080E9		       push    offset _first_127char ; lpSrcStr
.text:004080EE		       push    1	       ; dwInfoType
.text:004080F0		       push    0	       ; plocinfo
.text:004080F2		       call    ___crtGetStringTypeA
.text:004080F7		       add     esp, 20h
.text:004080FA		       test    eax, eax
.text:004080FC		       jz      short loc_408134
.text:004080FE		       xor     eax, eax
.text:00408100
.text:00408100 loc_408100:			       ; CODE XREF: _setlocale_set_cat+207j
.text:00408100		       and     [ebp+eax*2+74h+out], 1FFh
.text:0040810A		       inc     eax
.text:0040810B		       cmp     eax, 7Fh
.text:0040810E		       jb      short loc_408100
.text:00408110		       push    0FEh	       ; siz
.text:00408115		       push    _ctype_loc_style	; rhs
.text:0040811B		       lea     eax, [ebp+74h+out]
.text:00408121		       push    eax	       ; lhs
.text:00408122		       call    _memcmp
.text:00408127		       add     esp, 0Ch
.text:0040812A		       neg     eax
.text:0040812C		       sbb     eax, eax
.text:0040812E		       inc     eax
.text:0040812F		       mov     [edi+4],	eax
.text:00408132		       jmp     short loc_408138
.text:00408134 ; ---------------------------------------------------------------------------
.text:00408134
.text:00408134 loc_408134:			       ; CODE XREF: _setlocale_set_cat+1F5j
.text:00408134		       and     dword ptr [edi+4], 0
.text:00408138
.text:00408138 loc_408138:			       ; CODE XREF: _setlocale_set_cat+22Bj
.text:00408138		       mov     eax, [ploci+4]
.text:0040813B		       mov     [edi], eax
.text:0040813D
.text:0040813D loc_40813D:			       ; CODE XREF: _setlocale_set_cat+1CFj
.text:0040813D		       mov     eax, [edi+4]
.text:00408140		       mov     [ploci+0A8h], eax
.text:00408146
.text:00408146 loc_408146:			       ; CODE XREF: _setlocale_set_cat+145j
.text:00408146		       cmp     [ebp+74h+category], 1
.text:0040814A		       jnz     short loc_408155
.text:0040814C		       mov     eax, [ebp+74h+cptemp]
.text:00408152		       mov     [ploci+8], eax
.text:00408155
.text:00408155 loc_408155:			       ; CODE XREF: _setlocale_set_cat+243j
.text:00408155		       mov     eax, [ebp+74h+category]
.text:00408158		       imul    eax, 0Ch
.text:0040815B		       push    ploci	       ; ploci
.text:0040815C		       call    ds:off_41F3E0[eax]
.text:00408162		       test    eax, eax
.text:00408164		       pop     locale
.text:00408165		       jz      short loc_408198
.text:00408167		       mov     eax, [ebp+74h+oldlocale]
.text:0040816D		       push    [ebp+74h+pch]   ; pBlock
.text:00408173		       mov     [ebx+48h], eax
.text:00408176		       call    _free
.text:0040817B		       mov     eax, [ebp+74h+oldhandle]
.text:00408181		       pop     locale
.text:00408182		       mov     locale, [ebp+74h+var_194]
.text:00408188		       mov     [locale], eax
.text:0040818A		       mov     eax, [ebp+74h+oldcodepage]
.text:00408190		       mov     [ploci+4], eax
.text:00408193		       jmp     loc_407F54
.text:00408198 ; ---------------------------------------------------------------------------
.text:00408198
.text:00408198 loc_408198:			       ; CODE XREF: _setlocale_set_cat+25Ej
.text:00408198		       cmp     [ebp+74h+oldlocale], offset ___clocalestr ; "C"
.text:004081A2		       jz      short loc_4081D1
.text:004081A4		       mov     eax, [ebp+74h+category]
.text:004081A7		       add     eax, 5
.text:004081AA		       shl     eax, 4
.text:004081AD		       lea     edi, [eax+ploci]
.text:004081B0		       push    dword ptr [edi] ; lpAddend
.text:004081B2		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:004081B8		       test    eax, eax
.text:004081BA		       jnz     short loc_4081D1
.text:004081BC		       push    dword ptr [edi] ; pBlock
.text:004081BE		       call    _free
.text:004081C3		       push    dword ptr [ebx+54h] ; pBlock
.text:004081C6		       call    _free
.text:004081CB		       and     dword ptr [ebx+4Ch], 0
.text:004081CF		       pop     locale
.text:004081D0		       pop     locale
.text:004081D1
.text:004081D1 loc_4081D1:			       ; CODE XREF: _setlocale_set_cat+29Bj
.text:004081D1					       ; _setlocale_set_cat+2B3j
.text:004081D1		       mov     locale, [ebp+74h+category]
.text:004081D4		       mov     eax, [ebp+74h+pch]
.text:004081DA		       add     locale, 5
.text:004081DD		       shl     locale, 4
.text:004081E0		       mov     dword ptr [eax],	1
.text:004081E6		       mov     [locale+ploci], eax
.text:004081E9
.text:004081E9 loc_4081E9:			       ; CODE XREF: _setlocale_set_cat+6Dj
.text:004081E9		       mov     eax, [ebx+48h]
.text:004081EC
.text:004081EC loc_4081EC:			       ; CODE XREF: _setlocale_set_cat+4Fj
.text:004081EC		       mov     locale, [ebp+74h+var_4]
.text:004081EF		       pop     edi
.text:004081F0		       xor     locale, ebp
.text:004081F2		       pop     ebx
.text:004081F3		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004081F8		       add     ebp, 74h
.text:004081FB		       leave
.text:004081FC		       retn
.text:004081FC _setlocale_set_cat endp
.text:004081FC
.text:004081FD
.text:004081FD ; =============== S U B R O U T I N E =======================================
.text:004081FD
.text:004081FD ; Attributes: bp-based frame fpd=74h
.text:004081FD
.text:004081FD ; char *__usercall setlocale_nolock<eax>(threadlocaleinfostruct *ploci<edx>, int	_category, const char *_locale<ecx>)
.text:004081FD _setlocale_nolock proc near	       ; CODE XREF: __create_locale+89p
.text:004081FD					       ; _setlocale+90p
.text:004081FD
.text:004081FD ploci	       = dword ptr -98h
.text:004081FD i	       = dword ptr -94h
.text:004081FD len	       = dword ptr -90h
.text:004081FD fLocaleSet      = dword ptr -8Ch
.text:004081FD lctemp	       = byte ptr -88h
.text:004081FD var_4	       = dword ptr -4
.text:004081FD _category       = dword ptr  8
.text:004081FD
.text:004081FD ploci = edx
.text:004081FD _locale = ecx
.text:004081FD		       push    ebp
.text:004081FE		       lea     ebp, [esp-74h]
.text:00408202		       sub     esp, 98h
.text:00408208		       mov     eax, ___security_cookie
.text:0040820D		       xor     eax, ebp
.text:0040820F		       mov     [ebp+74h+var_4],	eax
.text:00408212		       mov     eax, [ebp+74h+_category]
.text:00408215		       push    ebx
.text:00408216		       push    esi
.text:00408217		       xor     ebx, ebx
.text:00408219		       cmp     eax, ebx
.text:0040821B		       mov     esi, ploci      ; ploci
.text:0040821D		       push    edi
.text:0040821E		       mov     [ebp+74h+ploci],	esi
.text:00408221		       jz      short loc_40823F
.text:00408223		       cmp     _locale,	ebx
.text:00408225		       jz      short loc_408233
.text:00408227		       push    eax	       ; category
.text:00408228		       call    _setlocale_set_cat
.text:0040822D		       pop     _locale
.text:0040822E		       jmp     loc_4083B9
.text:00408233 ; ---------------------------------------------------------------------------
.text:00408233
.text:00408233 loc_408233:			       ; CODE XREF: _setlocale_nolock+28j
.text:00408233		       shl     eax, 4
.text:00408236		       mov     eax, [eax+esi+48h]
.text:0040823A		       jmp     loc_4083B9
.text:0040823F ; ---------------------------------------------------------------------------
.text:0040823F
.text:0040823F loc_40823F:			       ; CODE XREF: _setlocale_nolock+24j
.text:0040823F		       cmp     _locale,	ebx
.text:00408241		       mov     [ebp+74h+len], 1
.text:00408248		       mov     [ebp+74h+fLocaleSet], ebx
.text:0040824B		       jz      loc_4083B4
.text:00408251		       cmp     byte ptr	[_locale], 4Ch
.text:00408254		       jnz     loc_408358
.text:0040825A		       cmp     byte ptr	[_locale+1], 43h
.text:0040825E		       jnz     loc_408358
.text:00408264		       cmp     byte ptr	[_locale+2], 5Fh
.text:00408268		       jnz     loc_408358
.text:0040826E		       mov     edi, _locale
.text:00408270
.text:00408270 loc_408270:			       ; CODE XREF: _setlocale_nolock+145j
.text:00408270		       push    offset asc_41F4B8 ; "=;"
.text:00408275		       push    edi	       ; string
.text:00408276		       call    _strpbrk
.text:0040827B		       mov     ebx, eax
.text:0040827D		       test    ebx, ebx
.text:0040827F		       pop     _locale
.text:00408280		       pop     _locale
.text:00408281		       jz      loc_408354
.text:00408287		       sub     eax, edi
.text:00408289		       mov     [ebp+74h+len], eax
.text:0040828C		       jz      loc_408354
.text:00408292		       cmp     byte ptr	[ebx], 3Bh
.text:00408295		       jz      loc_408354
.text:0040829B		       mov     [ebp+74h+i], 1
.text:004082A2		       mov     esi, offset off_41F3E4
.text:004082A7		       jmp     short loc_4082AC
.text:004082A9 ; ---------------------------------------------------------------------------
.text:004082A9
.text:004082A9 loc_4082A9:			       ; CODE XREF: _setlocale_nolock+D8j
.text:004082A9		       mov     eax, [ebp+74h+len]
.text:004082AC
.text:004082AC loc_4082AC:			       ; CODE XREF: _setlocale_nolock+AAj
.text:004082AC		       push    eax	       ; count
.text:004082AD		       push    edi	       ; last
.text:004082AE		       push    dword ptr [esi] ; first
.text:004082B0		       call    _strncmp
.text:004082B5		       add     esp, 0Ch
.text:004082B8		       test    eax, eax
.text:004082BA		       jnz     short loc_4082C9
.text:004082BC		       push    dword ptr [esi] ; buf
.text:004082BE		       call    _strlen
.text:004082C3		       cmp     [ebp+74h+len], eax
.text:004082C6		       pop     _locale
.text:004082C7		       jz      short loc_4082D7
.text:004082C9
.text:004082C9 loc_4082C9:			       ; CODE XREF: _setlocale_nolock+BDj
.text:004082C9		       inc     [ebp+74h+i]
.text:004082CC		       add     esi, 0Ch
.text:004082CF		       cmp     esi, offset off_41F414
.text:004082D5		       jle     short loc_4082A9
.text:004082D7
.text:004082D7 loc_4082D7:			       ; CODE XREF: _setlocale_nolock+CAj
.text:004082D7		       inc     ebx
.text:004082D8		       push    offset asc_41F4AC ; ";"
.text:004082DD		       push    ebx	       ; string
.text:004082DE		       call    _strcspn
.text:004082E3		       mov     edi, eax
.text:004082E5		       xor     esi, esi
.text:004082E7		       cmp     edi, esi
.text:004082E9		       pop     _locale
.text:004082EA		       pop     _locale
.text:004082EB		       jnz     short loc_4082F2
.text:004082ED		       cmp     byte ptr	[ebx], 3Bh
.text:004082F0		       jnz     short loc_408354
.text:004082F2
.text:004082F2 loc_4082F2:			       ; CODE XREF: _setlocale_nolock+EEj
.text:004082F2		       cmp     [ebp+74h+i], 5
.text:004082F6		       jg      short loc_408337
.text:004082F8		       push    edi	       ; _Count
.text:004082F9		       push    ebx	       ; _Src
.text:004082FA		       lea     eax, [ebp+74h+lctemp]
.text:004082FD		       push    83h	       ; _SizeInBytes
.text:00408302		       push    eax	       ; _Dst
.text:00408303		       call    _strncpy_s
.text:00408308		       add     esp, 10h
.text:0040830B		       test    eax, eax
.text:0040830D		       jz      short loc_40831C
.text:0040830F		       push    esi	       ; pReserved
.text:00408310		       push    esi	       ; nLine
.text:00408311		       push    esi	       ; pszFile
.text:00408312		       push    esi	       ; pszFunction
.text:00408313		       push    esi	       ; pszExpression
.text:00408314		       call    __invoke_watson
.text:00408319		       add     esp, 14h
.text:0040831C
.text:0040831C loc_40831C:			       ; CODE XREF: _setlocale_nolock+110j
.text:0040831C		       push    [ebp+74h+i]     ; category
.text:0040831F		       mov     esi, [ebp+74h+ploci] ; ploci
.text:00408322		       lea     _locale,	[ebp+74h+lctemp] ; locale
.text:00408325		       mov     [ebp+edi+74h+lctemp], 0
.text:0040832A		       call    _setlocale_set_cat
.text:0040832F		       test    eax, eax
.text:00408331		       pop     _locale
.text:00408332		       jz      short loc_408337
.text:00408334		       inc     [ebp+74h+fLocaleSet]
.text:00408337
.text:00408337 loc_408337:			       ; CODE XREF: _setlocale_nolock+F9j
.text:00408337					       ; _setlocale_nolock+135j
.text:00408337		       add     edi, ebx
.text:00408339		       cmp     byte ptr	[edi], 0
.text:0040833C		       jz      short loc_408348
.text:0040833E		       inc     edi
.text:0040833F		       cmp     byte ptr	[edi], 0
.text:00408342		       jnz     loc_408270
.text:00408348
.text:00408348 loc_408348:			       ; CODE XREF: _setlocale_nolock+13Fj
.text:00408348		       xor     eax, eax
.text:0040834A		       cmp     [ebp+74h+fLocaleSet], eax
.text:0040834D		       jz      short loc_4083B9
.text:0040834F		       mov     esi, [ebp+74h+ploci] ; ploci
.text:00408352		       jmp     short loc_4083B4
.text:00408354 ; ---------------------------------------------------------------------------
.text:00408354
.text:00408354 loc_408354:			       ; CODE XREF: _setlocale_nolock+84j
.text:00408354					       ; _setlocale_nolock+8Fj	...
.text:00408354		       xor     eax, eax
.text:00408356		       jmp     short loc_4083B9
.text:00408358 ; ---------------------------------------------------------------------------
.text:00408358
.text:00408358 loc_408358:			       ; CODE XREF: _setlocale_nolock+57j
.text:00408358					       ; _setlocale_nolock+61j	...
.text:00408358		       push    ebx	       ; category
.text:00408359		       push    ebx	       ; cp
.text:0040835A		       push    ebx	       ; id
.text:0040835B		       push    83h	       ; sizeInChars
.text:00408360		       lea     eax, [ebp+74h+lctemp]
.text:00408363		       push    eax	       ; output
.text:00408364		       push    _locale	       ; expr
.text:00408365		       call    __expandlocale
.text:0040836A		       add     esp, 18h
.text:0040836D		       cmp     eax, ebx
.text:0040836F		       jz      short loc_4083B9
.text:00408371		       lea     edi, [esi+48h]
.text:00408374
.text:00408374 loc_408374:			       ; CODE XREF: _setlocale_nolock+1A9j
.text:00408374		       test    ebx, ebx
.text:00408376		       jz      short loc_40839F
.text:00408378		       push    dword ptr [edi] ; str2
.text:0040837A		       lea     eax, [ebp+74h+lctemp]
.text:0040837D		       push    eax	       ; str1
.text:0040837E		       call    _strcmp
.text:00408383		       test    eax, eax
.text:00408385		       pop     _locale
.text:00408386		       pop     _locale
.text:00408387		       jz      short loc_40839C
.text:00408389		       push    ebx	       ; category
.text:0040838A		       lea     _locale,	[ebp+74h+lctemp] ; locale
.text:0040838D		       call    _setlocale_set_cat
.text:00408392		       test    eax, eax
.text:00408394		       pop     _locale
.text:00408395		       jnz     short loc_40839C
.text:00408397		       and     [ebp+74h+len], eax
.text:0040839A		       jmp     short loc_40839F
.text:0040839C ; ---------------------------------------------------------------------------
.text:0040839C
.text:0040839C loc_40839C:			       ; CODE XREF: _setlocale_nolock+18Aj
.text:0040839C					       ; _setlocale_nolock+198j
.text:0040839C		       inc     [ebp+74h+fLocaleSet]
.text:0040839F
.text:0040839F loc_40839F:			       ; CODE XREF: _setlocale_nolock+179j
.text:0040839F					       ; _setlocale_nolock+19Dj
.text:0040839F		       inc     ebx
.text:004083A0		       add     edi, 10h
.text:004083A3		       cmp     ebx, 5
.text:004083A6		       jle     short loc_408374
.text:004083A8		       xor     eax, eax
.text:004083AA		       cmp     [ebp+74h+len], eax
.text:004083AD		       jnz     short loc_4083B4
.text:004083AF		       cmp     [ebp+74h+fLocaleSet], eax
.text:004083B2		       jz      short loc_4083B9
.text:004083B4
.text:004083B4 loc_4083B4:			       ; CODE XREF: _setlocale_nolock+4Ej
.text:004083B4					       ; _setlocale_nolock+155j ...
.text:004083B4		       call    _setlocale_get_all
.text:004083B9
.text:004083B9 loc_4083B9:			       ; CODE XREF: _setlocale_nolock+31j
.text:004083B9					       ; _setlocale_nolock+3Dj	...
.text:004083B9		       mov     _locale,	[ebp+74h+var_4]
.text:004083BC		       pop     edi
.text:004083BD		       pop     esi
.text:004083BE		       xor     _locale,	ebp
.text:004083C0		       pop     ebx
.text:004083C1		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004083C6		       add     ebp, 74h
.text:004083C9		       leave
.text:004083CA		       retn
.text:004083CA _setlocale_nolock endp
.text:004083CA
.text:004083CB
.text:004083CB ; =============== S U B R O U T I N E =======================================
.text:004083CB
.text:004083CB
.text:004083CB ; localeinfo_struct *__cdecl _create_locale(int _category, const	char *_locale)
.text:004083CB __create_locale proc near	       ; CODE XREF: ___create_localej
.text:004083CB
.text:004083CB _category       = dword ptr  4
.text:004083CB _locale	       = dword ptr  8
.text:004083CB
.text:004083CB		       cmp     [esp+_category],	5
.text:004083D0		       push    esi
.text:004083D1		       push    edi
.text:004083D2		       ja      short loc_4083F9
.text:004083D4		       cmp     [esp+8+_locale],	0
.text:004083D9		       jz      short loc_4083F9
.text:004083DB		       xor     edi, edi
.text:004083DD		       inc     edi
.text:004083DE		       push    edi	       ; size
.text:004083DF		       push    8	       ; count
.text:004083E1		       call    __calloc_crt
.text:004083E6		       mov     esi, eax
.text:004083E8		       test    esi, esi
.text:004083EA		       pop     ecx
.text:004083EB		       pop     ecx
.text:004083EC		       jnz     short loc_4083FE
.text:004083EE
.text:004083EE loc_4083EE:			       ; CODE XREF: __create_locale+4Dj
.text:004083EE		       call    __errno
.text:004083F3		       mov     dword ptr [eax],	0Ch
.text:004083F9
.text:004083F9 loc_4083F9:			       ; CODE XREF: __create_locale+7j
.text:004083F9					       ; __create_locale+Ej
.text:004083F9		       xor     eax, eax
.text:004083FB
.text:004083FB loc_4083FB:			       ; CODE XREF: __create_locale+EEj
.text:004083FB		       pop     edi
.text:004083FC		       pop     esi
.text:004083FD		       retn
.text:004083FE ; ---------------------------------------------------------------------------
.text:004083FE
.text:004083FE loc_4083FE:			       ; CODE XREF: __create_locale+21j
.text:004083FE		       push    edi	       ; size
.text:004083FF		       push    0D8h	       ; count
.text:00408404		       call    __calloc_crt
.text:00408409		       pop     ecx
.text:0040840A		       pop     ecx
.text:0040840B		       mov     [esi], eax
.text:0040840D		       test    eax, eax
.text:0040840F		       jnz     short loc_40841A
.text:00408411		       push    esi	       ; pBlock
.text:00408412		       call    _free
.text:00408417
.text:00408417 loc_408417:			       ; CODE XREF: __create_locale+71j
.text:00408417		       pop     ecx
.text:00408418		       jmp     short loc_4083EE
.text:0040841A ; ---------------------------------------------------------------------------
.text:0040841A
.text:0040841A loc_40841A:			       ; CODE XREF: __create_locale+44j
.text:0040841A		       push    edi	       ; size
.text:0040841B		       push    220h	       ; count
.text:00408420		       call    __calloc_crt
.text:00408425		       test    eax, eax
.text:00408427		       pop     ecx
.text:00408428		       pop     ecx
.text:00408429		       mov     [esi+4],	eax
.text:0040842C		       jnz     short loc_40843E
.text:0040842E		       push    dword ptr [esi] ; pBlock
.text:00408430		       call    _free
.text:00408435		       push    esi	       ; pBlock
.text:00408436		       call    _free
.text:0040843B		       pop     ecx
.text:0040843C		       jmp     short loc_408417
.text:0040843E ; ---------------------------------------------------------------------------
.text:0040843E
.text:0040843E loc_40843E:			       ; CODE XREF: __create_locale+61j
.text:0040843E		       mov     eax, [esi]      ; ptlocid
.text:00408440		       mov     ecx, offset ___initiallocinfo ; ptlocis
.text:00408445		       call    _copytlocinfo_nolock
.text:0040844A		       push    [esp+8+_category] ; _category
.text:0040844E		       mov     ecx, [esp+0Ch+_locale] ;	_locale
.text:00408452		       mov     edx, [esi]      ; ploci
.text:00408454		       call    _setlocale_nolock
.text:00408459		       test    eax, eax
.text:0040845B		       pop     ecx
.text:0040845C		       jnz     short loc_408477
.text:0040845E		       push    dword ptr [esi] ; ptloci
.text:00408460		       call    ___removelocaleref
.text:00408465		       push    dword ptr [esi] ; ptloci
.text:00408467		       call    ___freetlocinfo
.text:0040846C		       push    esi	       ; pBlock
.text:0040846D		       call    _free
.text:00408472		       add     esp, 0Ch
.text:00408475		       jmp     short loc_4084A9
.text:00408477 ; ---------------------------------------------------------------------------
.text:00408477
.text:00408477 loc_408477:			       ; CODE XREF: __create_locale+91j
.text:00408477		       push    dword ptr [esi+4] ; ptmbci
.text:0040847A		       mov     eax, [esi]
.text:0040847C		       push    dword ptr [eax+4] ; codepage
.text:0040847F		       call    __setmbcp_nolock
.text:00408484		       test    eax, eax
.text:00408486		       pop     ecx
.text:00408487		       pop     ecx
.text:00408488		       jz      short loc_4084AD
.text:0040848A		       push    dword ptr [esi+4] ; pBlock
.text:0040848D		       call    _free
.text:00408492		       push    dword ptr [esi] ; ptloci
.text:00408494		       call    ___removelocaleref
.text:00408499		       push    dword ptr [esi] ; ptloci
.text:0040849B		       call    ___freetlocinfo
.text:004084A0		       push    esi	       ; pBlock
.text:004084A1		       call    _free
.text:004084A6		       add     esp, 10h
.text:004084A9
.text:004084A9 loc_4084A9:			       ; CODE XREF: __create_locale+AAj
.text:004084A9		       xor     esi, esi
.text:004084AB		       jmp     short loc_4084B7
.text:004084AD ; ---------------------------------------------------------------------------
.text:004084AD
.text:004084AD loc_4084AD:			       ; CODE XREF: __create_locale+BDj
.text:004084AD		       mov     eax, [esi+4]
.text:004084B0		       mov     [eax], edi
.text:004084B2		       mov     eax, [esi+4]
.text:004084B5		       mov     [eax], edi
.text:004084B7
.text:004084B7 loc_4084B7:			       ; CODE XREF: __create_locale+E0j
.text:004084B7		       mov     eax, esi
.text:004084B9		       jmp     loc_4083FB
.text:004084B9 __create_locale endp
.text:004084B9
.text:004084BE ; [00000005 BYTES: COLLAPSED FUNCTION ___create_locale. PRESS KEYPAD "+"	TO EXPAND]
.text:004084C3
.text:004084C3 ; =============== S U B R O U T I N E =======================================
.text:004084C3
.text:004084C3 ; Attributes: bp-based frame
.text:004084C3
.text:004084C3 ; char *__cdecl setlocale(int _category,	const char *_locale)
.text:004084C3 _setlocale      proc near
.text:004084C3
.text:004084C3 ptloci	       = dword ptr -24h
.text:004084C3 retval	       = dword ptr -20h
.text:004084C3 ptd	       = dword ptr -1Ch
.text:004084C3 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004084C3 _category       = dword ptr  8
.text:004084C3 _locale	       = dword ptr  0Ch
.text:004084C3
.text:004084C3		       push    14h
.text:004084C5		       push    offset dword_4217E0
.text:004084CA		       call    __SEH_prolog4
.text:004084CF		       xor     ebx, ebx
.text:004084D1		       mov     [ebp+retval], ebx
.text:004084D4		       cmp     [ebp+_category],	5
.text:004084D8		       jbe     short loc_4084F9
.text:004084DA		       call    __errno
.text:004084DF		       mov     dword ptr [eax],	16h
.text:004084E5		       push    ebx	       ; pReserved
.text:004084E6		       push    ebx	       ; nLine
.text:004084E7		       push    ebx	       ; pszFile
.text:004084E8		       push    ebx	       ; pszFunction
.text:004084E9		       push    ebx	       ; pszExpression
.text:004084EA		       call    __invalid_parameter
.text:004084EF		       add     esp, 14h
.text:004084F2		       xor     eax, eax
.text:004084F4		       jmp     loc_408625
.text:004084F9 ; ---------------------------------------------------------------------------
.text:004084F9
.text:004084F9 loc_4084F9:			       ; CODE XREF: _setlocale+15j
.text:004084F9		       call    __getptd
.text:004084FE		       mov     esi, eax
.text:00408500		       mov     [ebp+ptd], esi
.text:00408503		       call    ___updatetlocinfo
.text:00408508		       or      dword ptr [esi+70h], 10h
.text:0040850C		       mov     [ebp+ms_exc.disabled], ebx
.text:0040850F		       push    1	       ; size
.text:00408511		       push    0D8h	       ; count
.text:00408516		       call    __calloc_crt
.text:0040851B		       pop     ecx
.text:0040851C		       pop     ecx
.text:0040851D		       mov     edi, eax	       ; ptlocis
.text:0040851F		       mov     [ebp+ptloci], edi
.text:00408522		       cmp     edi, ebx
.text:00408524		       jz      $LN26_0
.text:0040852A		       push    0Ch	       ; locknum
.text:0040852C		       call    __lock
.text:00408531		       pop     ecx
.text:00408532		       mov     [ebp+ms_exc.disabled], 1
.text:00408539		       mov     ecx, [esi+6Ch]  ; ptlocis
.text:0040853C		       mov     eax, edi	       ; ptlocid
.text:0040853E		       call    _copytlocinfo_nolock
.text:00408543		       mov     [ebp+ms_exc.disabled], ebx
.text:00408546		       call    $LN21_1
.text:0040854B
.text:0040854B $LN22_1:				       ; _category
.text:0040854B		       push    [ebp+_category]
.text:0040854E		       mov     ecx, [ebp+_locale] ; _locale
.text:00408551		       mov     edx, edi	       ; ploci
.text:00408553		       call    _setlocale_nolock
.text:00408558		       pop     ecx
.text:00408559		       mov     [ebp+retval], eax
.text:0040855C		       cmp     eax, ebx
.text:0040855E		       jz      loc_408608
.text:00408564		       cmp     [ebp+_locale], ebx
.text:00408567		       jz      short loc_408586
.text:00408569		       push    offset ___clocalestr ; "C"
.text:0040856E		       push    [ebp+_locale]   ; str1
.text:00408571		       call    _strcmp
.text:00408576		       pop     ecx
.text:00408577		       pop     ecx
.text:00408578		       test    eax, eax
.text:0040857A		       jz      short loc_408586
.text:0040857C		       mov     ___locale_changed, 1
.text:00408586
.text:00408586 loc_408586:			       ; CODE XREF: _setlocale+A4j
.text:00408586					       ; _setlocale+B7j
.text:00408586		       push    0Ch	       ; locknum
.text:00408588		       call    __lock
.text:0040858D		       pop     ecx
.text:0040858E		       mov     [ebp+ms_exc.disabled], 2
.text:00408595		       lea     ebx, [esi+6Ch]
.text:00408598		       mov     eax, ebx	       ; pptlocid
.text:0040859A		       call    _updatetlocinfoEx_nolock
.text:0040859F		       push    edi	       ; ptloci
.text:004085A0		       call    ___removelocaleref
.text:004085A5		       pop     ecx
.text:004085A6		       test    byte ptr	[esi+70h], 2
.text:004085AA		       jnz     short loc_4085DE
.text:004085AC		       test    byte ptr	___globallocalestatus, 1
.text:004085B3		       jnz     short loc_4085DE
.text:004085B5		       mov     edi, [ebx]      ; ptlocis
.text:004085B7		       mov     eax, offset ___ptlocinfo	; pptlocid
.text:004085BC		       call    _updatetlocinfoEx_nolock
.text:004085C1		       push    18h	       ; count
.text:004085C3		       mov     eax, ___ptlocinfo ; ___ptlocinfo
.text:004085C8		       add     eax, 0Ch
.text:004085CB		       push    eax	       ; src
.text:004085CC		       push    offset ___lc_handle ; dst
.text:004085D1		       call    _memcpy
.text:004085D6		       add     esp, 0Ch
.text:004085D9		       call    sync_legacy_variables_lk
.text:004085DE
.text:004085DE loc_4085DE:			       ; CODE XREF: _setlocale+E7j
.text:004085DE					       ; _setlocale+F0j
.text:004085DE		       and     [ebp+ms_exc.disabled], 0
.text:004085E2		       call    $LN25_1
.text:004085E7		       jmp     short $LN26_0
.text:004085E9 ; ---------------------------------------------------------------------------
.text:004085E9
.text:004085E9 $LN19_4:				       ; DATA XREF: .rdata:00421804o
.text:004085E9		       mov     edi, [ebp+ptloci]
.text:004085EC		       mov     esi, [ebp+ptd]
.text:004085EF		       xor     ebx, ebx
.text:004085F1
.text:004085F1 $LN21_1:				       ; CODE XREF: _setlocale+83p
.text:004085F1		       push    0Ch	       ; locknum
.text:004085F3		       call    __unlock
.text:004085F8		       pop     ecx
.text:004085F9
.text:004085F9 $LN20_0:
.text:004085F9		       retn
.text:004085FA ; ---------------------------------------------------------------------------
.text:004085FA
.text:004085FA $LN23_1:				       ; DATA XREF: .rdata:00421810o
.text:004085FA		       mov     esi, [ebp+ptd]
.text:004085FD
.text:004085FD $LN25_1:				       ; CODE XREF: _setlocale+11Fp
.text:004085FD		       push    0Ch	       ; locknum
.text:004085FF		       call    __unlock
.text:00408604		       pop     ecx
.text:00408605
.text:00408605 $LN24_1:
.text:00408605		       retn
.text:00408606 ; ---------------------------------------------------------------------------
.text:00408606		       jmp     short $LN26_0
.text:00408608 ; ---------------------------------------------------------------------------
.text:00408608
.text:00408608 loc_408608:			       ; CODE XREF: _setlocale+9Bj
.text:00408608		       push    edi	       ; ptloci
.text:00408609		       call    ___removelocaleref
.text:0040860E		       push    edi	       ; ptloci
.text:0040860F		       call    ___freetlocinfo
.text:00408614		       pop     ecx
.text:00408615		       pop     ecx
.text:00408616
.text:00408616 $LN26_0:				       ; CODE XREF: _setlocale+61j
.text:00408616					       ; _setlocale+124j ...
.text:00408616		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040861D		       call    $LN17_3
.text:00408622
.text:00408622 $LN18_1:
.text:00408622		       mov     eax, [ebp+retval]
.text:00408625
.text:00408625 loc_408625:			       ; CODE XREF: _setlocale+31j
.text:00408625		       call    __SEH_epilog4
.text:0040862A		       retn
.text:0040862B ; ---------------------------------------------------------------------------
.text:0040862B
.text:0040862B $LN15_2:				       ; DATA XREF: .rdata:004217F8o
.text:0040862B		       mov     esi, [ebp+ptd]
.text:0040862E
.text:0040862E $LN17_3:				       ; CODE XREF: _setlocale+15Ap
.text:0040862E		       and     dword ptr [esi+70h], 0FFFFFFEFh
.text:00408632
.text:00408632 $LN16_3:
.text:00408632		       retn
.text:00408632 _setlocale      endp ; sp-analysis failed
.text:00408632
.text:00408633
.text:00408633 ; =============== S U B R O U T I N E =======================================
.text:00408633
.text:00408633 ; Attributes: bp-based frame
.text:00408633
.text:00408633 ; int __cdecl _flsbuf(int ch, _iobuf *str)
.text:00408633 __flsbuf	       proc near	       ; CODE XREF: write_char+21p
.text:00408633					       ; write_char_0+21p ...
.text:00408633
.text:00408633 written	       = dword ptr -4
.text:00408633 buf	       = dword ptr  8
.text:00408633 fh	       = dword ptr  0Ch
.text:00408633
.text:00408633		       push    ebp
.text:00408634		       mov     ebp, esp
.text:00408636		       push    ecx
.text:00408637		       push    esi
.text:00408638		       mov     esi, [ebp+fh]
.text:0040863B		       push    esi	       ; stream
.text:0040863C		       call    __fileno
.text:00408641		       mov     [ebp+fh], eax
.text:00408644		       mov     eax, [esi+0Ch]
.text:00408647		       test    al, 82h
.text:00408649		       pop     ecx
.text:0040864A		       jnz     short loc_408663
.text:0040864C		       call    __errno
.text:00408651		       mov     dword ptr [eax],	9
.text:00408657
.text:00408657 loc_408657:			       ; CODE XREF: __flsbuf+3Fj
.text:00408657		       or      dword ptr [esi+0Ch], 20h
.text:0040865B		       or      eax, 0FFFFFFFFh
.text:0040865E		       jmp     loc_408790
.text:00408663 ; ---------------------------------------------------------------------------
.text:00408663
.text:00408663 loc_408663:			       ; CODE XREF: __flsbuf+17j
.text:00408663		       test    al, 40h
.text:00408665		       jz      short loc_408674
.text:00408667		       call    __errno
.text:0040866C		       mov     dword ptr [eax],	22h
.text:00408672		       jmp     short loc_408657
.text:00408674 ; ---------------------------------------------------------------------------
.text:00408674
.text:00408674 loc_408674:			       ; CODE XREF: __flsbuf+32j
.text:00408674		       push    ebx
.text:00408675		       xor     ebx, ebx
.text:00408677		       test    al, 1
.text:00408679		       jz      short loc_408691
.text:0040867B		       test    al, 10h
.text:0040867D		       mov     [esi+4],	ebx
.text:00408680		       jz      loc_40870B
.text:00408686		       mov     ecx, [esi+8]
.text:00408689		       and     eax, 0FFFFFFFEh
.text:0040868C		       mov     [esi], ecx
.text:0040868E		       mov     [esi+0Ch], eax
.text:00408691
.text:00408691 loc_408691:			       ; CODE XREF: __flsbuf+46j
.text:00408691		       mov     eax, [esi+0Ch]
.text:00408694		       and     eax, 0FFFFFFEFh
.text:00408697		       or      eax, 2
.text:0040869A		       test    ax, 10Ch
.text:0040869E		       mov     [esi+0Ch], eax
.text:004086A1		       mov     [esi+4],	ebx
.text:004086A4		       mov     [ebp+written], ebx
.text:004086A7		       jnz     short loc_4086D5
.text:004086A9		       call    ___iob_func
.text:004086AE		       add     eax, 20h
.text:004086B1		       cmp     esi, eax
.text:004086B3		       jz      short loc_4086C1
.text:004086B5		       call    ___iob_func
.text:004086BA		       add     eax, 40h
.text:004086BD		       cmp     esi, eax
.text:004086BF		       jnz     short loc_4086CE
.text:004086C1
.text:004086C1 loc_4086C1:			       ; CODE XREF: __flsbuf+80j
.text:004086C1		       push    [ebp+fh]	       ; fh
.text:004086C4		       call    __isatty
.text:004086C9		       test    eax, eax
.text:004086CB		       pop     ecx
.text:004086CC		       jnz     short loc_4086D5
.text:004086CE
.text:004086CE loc_4086CE:			       ; CODE XREF: __flsbuf+8Cj
.text:004086CE		       push    esi	       ; str
.text:004086CF		       call    __getbuf
.text:004086D4		       pop     ecx
.text:004086D5
.text:004086D5 loc_4086D5:			       ; CODE XREF: __flsbuf+74j
.text:004086D5					       ; __flsbuf+99j
.text:004086D5		       test    word ptr	[esi+0Ch], 108h
.text:004086DB		       push    edi
.text:004086DC		       jz      loc_408762
.text:004086E2		       mov     eax, [esi+8]
.text:004086E5		       mov     edi, [esi]
.text:004086E7		       lea     ecx, [eax+1]
.text:004086EA		       mov     [esi], ecx
.text:004086EC		       mov     ecx, [esi+18h]
.text:004086EF		       sub     edi, eax
.text:004086F1		       dec     ecx
.text:004086F2		       cmp     edi, ebx
.text:004086F4		       mov     [esi+4],	ecx
.text:004086F7		       jle     short loc_408716
.text:004086F9		       push    edi	       ; cnt
.text:004086FA		       push    eax	       ; buf
.text:004086FB		       push    [ebp+fh]	       ; fh
.text:004086FE		       call    __write
.text:00408703		       add     esp, 0Ch
.text:00408706		       mov     [ebp+written], eax
.text:00408709		       jmp     short loc_408758
.text:0040870B ; ---------------------------------------------------------------------------
.text:0040870B
.text:0040870B loc_40870B:			       ; CODE XREF: __flsbuf+4Dj
.text:0040870B		       or      eax, 20h
.text:0040870E		       mov     [esi+0Ch], eax
.text:00408711		       or      eax, 0FFFFFFFFh
.text:00408714		       jmp     short loc_40878F
.text:00408716 ; ---------------------------------------------------------------------------
.text:00408716
.text:00408716 loc_408716:			       ; CODE XREF: __flsbuf+C4j
.text:00408716		       mov     ecx, [ebp+fh]
.text:00408719		       cmp     ecx, 0FFFFFFFFh
.text:0040871C		       jz      short loc_408739
.text:0040871E		       cmp     ecx, 0FFFFFFFEh
.text:00408721		       jz      short loc_408739
.text:00408723		       mov     eax, ecx
.text:00408725		       and     eax, 1Fh
.text:00408728		       mov     edx, ecx
.text:0040872A		       sar     edx, 5
.text:0040872D		       shl     eax, 6
.text:00408730		       add     eax, ___pioinfo[edx*4]
.text:00408737		       jmp     short loc_40873E
.text:00408739 ; ---------------------------------------------------------------------------
.text:00408739
.text:00408739 loc_408739:			       ; CODE XREF: __flsbuf+E9j
.text:00408739					       ; __flsbuf+EEj
.text:00408739		       mov     eax, offset ___badioinfo
.text:0040873E
.text:0040873E loc_40873E:			       ; CODE XREF: __flsbuf+104j
.text:0040873E		       test    byte ptr	[eax+4], 20h
.text:00408742		       jz      short loc_408758
.text:00408744		       push    2	       ; mthd
.text:00408746		       push    ebx
.text:00408747		       push    ebx	       ; pos
.text:00408748		       push    ecx	       ; fh
.text:00408749		       call    __lseeki64
.text:0040874E		       and     eax, edx
.text:00408750		       add     esp, 10h
.text:00408753		       cmp     eax, 0FFFFFFFFh
.text:00408756		       jz      short loc_40877D
.text:00408758
.text:00408758 loc_408758:			       ; CODE XREF: __flsbuf+D6j
.text:00408758					       ; __flsbuf+10Fj
.text:00408758		       mov     eax, [esi+8]
.text:0040875B		       mov     cl, byte	ptr [ebp+buf]
.text:0040875E		       mov     [eax], cl
.text:00408760		       jmp     short loc_408778
.text:00408762 ; ---------------------------------------------------------------------------
.text:00408762
.text:00408762 loc_408762:			       ; CODE XREF: __flsbuf+A9j
.text:00408762		       xor     edi, edi
.text:00408764		       inc     edi
.text:00408765		       push    edi	       ; cnt
.text:00408766		       lea     eax, [ebp+buf]
.text:00408769		       push    eax	       ; buf
.text:0040876A		       push    [ebp+fh]	       ; fh
.text:0040876D		       call    __write
.text:00408772		       add     esp, 0Ch
.text:00408775		       mov     [ebp+written], eax
.text:00408778
.text:00408778 loc_408778:			       ; CODE XREF: __flsbuf+12Dj
.text:00408778		       cmp     [ebp+written], edi
.text:0040877B		       jz      short loc_408786
.text:0040877D
.text:0040877D loc_40877D:			       ; CODE XREF: __flsbuf+123j
.text:0040877D		       or      dword ptr [esi+0Ch], 20h
.text:00408781		       or      eax, 0FFFFFFFFh
.text:00408784		       jmp     short loc_40878E
.text:00408786 ; ---------------------------------------------------------------------------
.text:00408786
.text:00408786 loc_408786:			       ; CODE XREF: __flsbuf+148j
.text:00408786		       mov     eax, [ebp+buf]
.text:00408789		       and     eax, 0FFh
.text:0040878E
.text:0040878E loc_40878E:			       ; CODE XREF: __flsbuf+151j
.text:0040878E		       pop     edi
.text:0040878F
.text:0040878F loc_40878F:			       ; CODE XREF: __flsbuf+E1j
.text:0040878F		       pop     ebx
.text:00408790
.text:00408790 loc_408790:			       ; CODE XREF: __flsbuf+2Bj
.text:00408790		       pop     esi
.text:00408791		       leave
.text:00408792		       retn
.text:00408792 __flsbuf	       endp
.text:00408792
.text:00408792 ; ---------------------------------------------------------------------------
.text:00408793		       align 10h
.text:004087A0
.text:004087A0 ; =============== S U B R O U T I N E =======================================
.text:004087A0
.text:004087A0
.text:004087A0 ; void __cdecl strlen(char *buf)
.text:004087A0 _strlen	       proc near	       ; CODE XREF: __output_l:loc_402BD7p
.text:004087A0					       ; __NMSG_WRITE+CAp ...
.text:004087A0
.text:004087A0 arg_0	       = dword ptr  4
.text:004087A0 buf	       = dword ptr  8
.text:004087A0
.text:004087A0		       mov     ecx, [esp+arg_0]
.text:004087A4		       test    ecx, 3
.text:004087AA		       jz      short main_loop
.text:004087AC
.text:004087AC str_misaligned:			       ; CODE XREF: _strlen+1Bj
.text:004087AC		       mov     al, [ecx]
.text:004087AE		       add     ecx, 1
.text:004087B1		       test    al, al
.text:004087B3		       jz      short loc_408803
.text:004087B5		       test    ecx, 3
.text:004087BB		       jnz     short str_misaligned
.text:004087BD		       add     eax, 0
.text:004087C2		       lea     esp, [esp+0]
.text:004087C9		       lea     esp, [esp+0]
.text:004087D0
.text:004087D0 main_loop:			       ; CODE XREF: _strlen+Aj
.text:004087D0					       ; _strlen+46j ...
.text:004087D0		       mov     eax, [ecx]
.text:004087D2		       mov     edx, 7EFEFEFFh
.text:004087D7		       add     edx, eax
.text:004087D9		       xor     eax, 0FFFFFFFFh
.text:004087DC		       xor     eax, edx
.text:004087DE		       add     ecx, 4
.text:004087E1		       test    eax, 81010100h
.text:004087E6		       jz      short main_loop
.text:004087E8		       mov     eax, [ecx-4]
.text:004087EB		       test    al, al
.text:004087ED		       jz      short loc_408821
.text:004087EF		       test    ah, ah
.text:004087F1		       jz      short loc_408817
.text:004087F3		       test    eax, 0FF0000h
.text:004087F8		       jz      short loc_40880D
.text:004087FA		       test    eax, 0FF000000h
.text:004087FF		       jz      short loc_408803
.text:00408801		       jmp     short main_loop
.text:00408803 ; ---------------------------------------------------------------------------
.text:00408803
.text:00408803 loc_408803:			       ; CODE XREF: _strlen+13j
.text:00408803					       ; _strlen+5Fj
.text:00408803		       lea     eax, [ecx-1]
.text:00408806		       mov     ecx, [esp+arg_0]
.text:0040880A		       sub     eax, ecx
.text:0040880C		       retn
.text:0040880D ; ---------------------------------------------------------------------------
.text:0040880D
.text:0040880D loc_40880D:			       ; CODE XREF: _strlen+58j
.text:0040880D		       lea     eax, [ecx-2]
.text:00408810		       mov     ecx, [esp+arg_0]
.text:00408814		       sub     eax, ecx
.text:00408816		       retn
.text:00408817 ; ---------------------------------------------------------------------------
.text:00408817
.text:00408817 loc_408817:			       ; CODE XREF: _strlen+51j
.text:00408817		       lea     eax, [ecx-3]
.text:0040881A		       mov     ecx, [esp+arg_0]
.text:0040881E		       sub     eax, ecx
.text:00408820		       retn
.text:00408821 ; ---------------------------------------------------------------------------
.text:00408821
.text:00408821 loc_408821:			       ; CODE XREF: _strlen+4Dj
.text:00408821		       lea     eax, [ecx-4]
.text:00408824		       mov     ecx, [esp+arg_0]
.text:00408828		       sub     eax, ecx
.text:0040882A		       retn
.text:0040882A _strlen	       endp
.text:0040882A
.text:0040882B
.text:0040882B ; =============== S U B R O U T I N E =======================================
.text:0040882B
.text:0040882B ; Attributes: bp-based frame
.text:0040882B
.text:0040882B ; int __cdecl _wctomb_s_l(int *pRetValue, char *dst, unsigned int sizeInBytes, wchar_t wchar, localeinfo_struct *plocinfo)
.text:0040882B __wctomb_s_l    proc near	       ; CODE XREF: _wctomb_s+12p
.text:0040882B					       ; __wctomb_l+2Cp ...
.text:0040882B
.text:0040882B _loc_update     = _LocaleUpdate ptr -10h
.text:0040882B pRetValue       = dword ptr  8
.text:0040882B defused	       = dword ptr  0Ch
.text:0040882B sizeInBytes     = dword ptr  10h
.text:0040882B wchar	       = word ptr  14h
.text:0040882B plocinfo	       = dword ptr  18h
.text:0040882B
.text:0040882B		       push    ebp
.text:0040882C		       mov     ebp, esp
.text:0040882E		       sub     esp, 10h
.text:00408831		       push    ebx
.text:00408832		       push    esi
.text:00408833		       mov     esi, [ebp+defused]
.text:00408836		       xor     ebx, ebx
.text:00408838		       cmp     esi, ebx
.text:0040883A		       push    edi
.text:0040883B		       mov     edi, [ebp+sizeInBytes]
.text:0040883E		       jnz     short loc_408851
.text:00408840		       cmp     edi, ebx
.text:00408842		       jbe     short loc_408851
.text:00408844		       mov     eax, [ebp+pRetValue]
.text:00408847		       cmp     eax, ebx
.text:00408849		       jz      short loc_40884D
.text:0040884B		       mov     [eax], ebx
.text:0040884D
.text:0040884D loc_40884D:			       ; CODE XREF: __wctomb_s_l+1Ej
.text:0040884D					       ; __wctomb_s_l+ECj ...
.text:0040884D		       xor     eax, eax
.text:0040884F		       jmp     short loc_4088D0
.text:00408851 ; ---------------------------------------------------------------------------
.text:00408851
.text:00408851 loc_408851:			       ; CODE XREF: __wctomb_s_l+13j
.text:00408851					       ; __wctomb_s_l+17j
.text:00408851		       mov     eax, [ebp+pRetValue]
.text:00408854		       cmp     eax, ebx
.text:00408856		       jz      short loc_40885B
.text:00408858		       or      dword ptr [eax],	0FFFFFFFFh
.text:0040885B
.text:0040885B loc_40885B:			       ; CODE XREF: __wctomb_s_l+2Bj
.text:0040885B		       cmp     edi, 7FFFFFFFh
.text:00408861		       jbe     short loc_40887E
.text:00408863		       call    __errno
.text:00408868		       push    16h
.text:0040886A		       pop     esi
.text:0040886B		       push    ebx	       ; pReserved
.text:0040886C		       push    ebx	       ; nLine
.text:0040886D		       push    ebx	       ; pszFile
.text:0040886E		       push    ebx	       ; pszFunction
.text:0040886F		       push    ebx	       ; pszExpression
.text:00408870		       mov     [eax], esi
.text:00408872		       call    __invalid_parameter
.text:00408877		       add     esp, 14h
.text:0040887A
.text:0040887A loc_40887A:			       ; CODE XREF: __wctomb_s_l+CCj
.text:0040887A					       ; __wctomb_s_l+D5j
.text:0040887A		       mov     eax, esi
.text:0040887C		       jmp     short loc_4088D0
.text:0040887E ; ---------------------------------------------------------------------------
.text:0040887E
.text:0040887E loc_40887E:			       ; CODE XREF: __wctomb_s_l+36j
.text:0040887E		       push    [ebp+plocinfo]  ; plocinfo
.text:00408881		       lea     ecx, [ebp+_loc_update] ;	this
.text:00408884		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00408889		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040888C		       cmp     [eax+14h], ebx
.text:0040888F		       jnz     loc_408929
.text:00408895		       mov     ax, [ebp+wchar]
.text:00408899		       cmp     ax, 0FFh
.text:0040889D		       jbe     short loc_4088D5
.text:0040889F		       cmp     esi, ebx
.text:004088A1		       jz      short loc_4088B2
.text:004088A3		       cmp     edi, ebx
.text:004088A5		       jbe     short loc_4088B2
.text:004088A7		       push    edi	       ; count
.text:004088A8		       push    ebx	       ; value
.text:004088A9		       push    esi	       ; dst
.text:004088AA		       call    _memset
.text:004088AF		       add     esp, 0Ch
.text:004088B2
.text:004088B2 loc_4088B2:			       ; CODE XREF: __wctomb_s_l+76j
.text:004088B2					       ; __wctomb_s_l+7Aj ...
.text:004088B2		       call    __errno
.text:004088B7		       mov     dword ptr [eax],	2Ah
.text:004088BD		       call    __errno
.text:004088C2		       cmp     [ebp+_loc_update.updated], bl
.text:004088C5		       mov     eax, [eax]
.text:004088C7		       jz      short loc_4088D0
.text:004088C9		       mov     ecx, [ebp+_loc_update.ptd]
.text:004088CC		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:004088D0
.text:004088D0 loc_4088D0:			       ; CODE XREF: __wctomb_s_l+24j
.text:004088D0					       ; __wctomb_s_l+51j ...
.text:004088D0		       pop     edi
.text:004088D1		       pop     esi
.text:004088D2		       pop     ebx
.text:004088D3		       leave
.text:004088D4		       retn
.text:004088D5 ; ---------------------------------------------------------------------------
.text:004088D5
.text:004088D5 loc_4088D5:			       ; CODE XREF: __wctomb_s_l+72j
.text:004088D5		       cmp     esi, ebx
.text:004088D7		       jz      short loc_408907
.text:004088D9		       cmp     edi, ebx
.text:004088DB		       ja      short loc_408905
.text:004088DD
.text:004088DD loc_4088DD:			       ; CODE XREF: __wctomb_s_l+141j
.text:004088DD					       ; __wctomb_s_l+149j ...
.text:004088DD		       call    __errno
.text:004088E2		       push    22h
.text:004088E4		       pop     esi
.text:004088E5		       push    ebx	       ; pReserved
.text:004088E6		       push    ebx	       ; nLine
.text:004088E7		       push    ebx	       ; pszFile
.text:004088E8		       push    ebx	       ; pszFunction
.text:004088E9		       push    ebx	       ; pszExpression
.text:004088EA		       mov     [eax], esi
.text:004088EC		       call    __invalid_parameter
.text:004088F1		       add     esp, 14h
.text:004088F4		       cmp     [ebp+_loc_update.updated], bl
.text:004088F7		       jz      short loc_40887A
.text:004088F9		       mov     eax, [ebp+_loc_update.ptd]
.text:004088FC		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00408900		       jmp     loc_40887A
.text:00408905 ; ---------------------------------------------------------------------------
.text:00408905
.text:00408905 loc_408905:			       ; CODE XREF: __wctomb_s_l+B0j
.text:00408905		       mov     [esi], al
.text:00408907
.text:00408907 loc_408907:			       ; CODE XREF: __wctomb_s_l+ACj
.text:00408907		       mov     eax, [ebp+pRetValue]
.text:0040890A		       cmp     eax, ebx
.text:0040890C		       jz      short loc_408914
.text:0040890E		       mov     dword ptr [eax],	1
.text:00408914
.text:00408914 loc_408914:			       ; CODE XREF: __wctomb_s_l+E1j
.text:00408914					       ; __wctomb_s_l+12Aj ...
.text:00408914		       cmp     [ebp+_loc_update.updated], bl
.text:00408917		       jz      loc_40884D
.text:0040891D		       mov     eax, [ebp+_loc_update.ptd]
.text:00408920		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00408924		       jmp     loc_40884D
.text:00408929 ; ---------------------------------------------------------------------------
.text:00408929
.text:00408929 loc_408929:			       ; CODE XREF: __wctomb_s_l+64j
.text:00408929		       lea     ecx, [ebp+defused]
.text:0040892C		       push    ecx	       ; lpUsedDefaultChar
.text:0040892D		       push    ebx	       ; lpDefaultChar
.text:0040892E		       push    edi	       ; cbMultiByte
.text:0040892F		       push    esi	       ; lpMultiByteStr
.text:00408930		       push    1	       ; cchWideChar
.text:00408932		       lea     ecx, [ebp+wchar]
.text:00408935		       push    ecx	       ; lpWideCharStr
.text:00408936		       push    ebx	       ; dwFlags
.text:00408937		       mov     [ebp+defused], ebx
.text:0040893A		       push    dword ptr [eax+4] ; CodePage
.text:0040893D		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00408943		       cmp     eax, ebx
.text:00408945		       jz      short loc_40895B
.text:00408947		       cmp     [ebp+defused], ebx
.text:0040894A		       jnz     loc_4088B2
.text:00408950		       mov     ecx, [ebp+pRetValue]
.text:00408953		       cmp     ecx, ebx
.text:00408955		       jz      short loc_408914
.text:00408957		       mov     [ecx], eax
.text:00408959		       jmp     short loc_408914
.text:0040895B ; ---------------------------------------------------------------------------
.text:0040895B
.text:0040895B loc_40895B:			       ; CODE XREF: __wctomb_s_l+11Aj
.text:0040895B		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00408961		       cmp     eax, 7Ah
.text:00408964		       jnz     loc_4088B2
.text:0040896A		       cmp     esi, ebx
.text:0040896C		       jz      loc_4088DD
.text:00408972		       cmp     edi, ebx
.text:00408974		       jbe     loc_4088DD
.text:0040897A		       push    edi	       ; count
.text:0040897B		       push    ebx	       ; value
.text:0040897C		       push    esi	       ; dst
.text:0040897D		       call    _memset
.text:00408982		       add     esp, 0Ch
.text:00408985		       jmp     loc_4088DD
.text:00408985 __wctomb_s_l    endp
.text:00408985
.text:0040898A
.text:0040898A ; =============== S U B R O U T I N E =======================================
.text:0040898A
.text:0040898A
.text:0040898A ; int __cdecl wctomb_s(int *pRetValue, char *dst, unsigned int sizeInBytes, wchar_t wchar)
.text:0040898A _wctomb_s       proc near	       ; CODE XREF: __output_l+487p
.text:0040898A					       ; __output_l+8B0p ...
.text:0040898A
.text:0040898A pRetValue       = dword ptr  4
.text:0040898A dst	       = dword ptr  8
.text:0040898A sizeInBytes     = dword ptr  0Ch
.text:0040898A wchar	       = dword ptr  10h
.text:0040898A
.text:0040898A		       push    0	       ; plocinfo
.text:0040898C		       push    [esp+4+wchar]   ; wchar
.text:00408990		       push    [esp+8+sizeInBytes] ; sizeInBytes
.text:00408994		       push    [esp+0Ch+dst]   ; dst
.text:00408998		       push    [esp+10h+pRetValue] ; pRetValue
.text:0040899C		       call    __wctomb_s_l
.text:004089A1		       add     esp, 14h
.text:004089A4		       retn
.text:004089A4 _wctomb_s       endp
.text:004089A4
.text:004089A5
.text:004089A5 ; =============== S U B R O U T I N E =======================================
.text:004089A5
.text:004089A5 ; Attributes: bp-based frame
.text:004089A5
.text:004089A5 ; int __cdecl _wctomb_l(char *s,	wchar_t	wchar, localeinfo_struct *plocinfo)
.text:004089A5 __wctomb_l      proc near
.text:004089A5
.text:004089A5 _loc_update     = _LocaleUpdate ptr -14h
.text:004089A5 retval	       = dword ptr -4
.text:004089A5 s	       = dword ptr  8
.text:004089A5 wchar	       = dword ptr  0Ch
.text:004089A5 plocinfo	       = dword ptr  10h
.text:004089A5
.text:004089A5		       push    ebp
.text:004089A6		       mov     ebp, esp
.text:004089A8		       sub     esp, 14h
.text:004089AB		       push    [ebp+plocinfo]  ; plocinfo
.text:004089AE		       or      [ebp+retval], 0FFFFFFFFh
.text:004089B2		       lea     ecx, [ebp+_loc_update] ;	this
.text:004089B5		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004089BA		       lea     eax, [ebp+_loc_update]
.text:004089BD		       push    eax	       ; plocinfo
.text:004089BE		       push    [ebp+wchar]     ; wchar
.text:004089C1		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004089C4		       push    dword ptr [eax+0ACh] ; sizeInBytes
.text:004089CA		       lea     eax, [ebp+retval]
.text:004089CD		       push    [ebp+s]	       ; dst
.text:004089D0		       push    eax	       ; pRetValue
.text:004089D1		       call    __wctomb_s_l
.text:004089D6		       add     esp, 14h
.text:004089D9		       test    eax, eax
.text:004089DB		       jnz     short loc_4089E2
.text:004089DD		       mov     eax, [ebp+retval]
.text:004089E0		       jmp     short loc_4089E5
.text:004089E2 ; ---------------------------------------------------------------------------
.text:004089E2
.text:004089E2 loc_4089E2:			       ; CODE XREF: __wctomb_l+36j
.text:004089E2		       or      eax, 0FFFFFFFFh
.text:004089E5
.text:004089E5 loc_4089E5:			       ; CODE XREF: __wctomb_l+3Bj
.text:004089E5		       cmp     [ebp+_loc_update.updated], 0
.text:004089E9		       jz      short locret_4089F2
.text:004089EB		       mov     ecx, [ebp+_loc_update.ptd]
.text:004089EE		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:004089F2
.text:004089F2 locret_4089F2:			       ; CODE XREF: __wctomb_l+44j
.text:004089F2		       leave
.text:004089F3		       retn
.text:004089F3 __wctomb_l      endp
.text:004089F3
.text:004089F4
.text:004089F4 ; =============== S U B R O U T I N E =======================================
.text:004089F4
.text:004089F4 ; Attributes: bp-based frame
.text:004089F4
.text:004089F4 ; int __cdecl wctomb(char *s, wchar_t wchar)
.text:004089F4 _wctomb	       proc near
.text:004089F4
.text:004089F4 retval	       = dword ptr -4
.text:004089F4 s	       = dword ptr  8
.text:004089F4 wchar	       = dword ptr  0Ch
.text:004089F4
.text:004089F4		       push    ebp
.text:004089F5		       mov     ebp, esp
.text:004089F7		       push    ecx
.text:004089F8		       or      [ebp+retval], 0FFFFFFFFh
.text:004089FC		       push    0	       ; plocinfo
.text:004089FE		       push    [ebp+wchar]     ; wchar
.text:00408A01		       call    ____mb_cur_max_func
.text:00408A06		       push    eax	       ; sizeInBytes
.text:00408A07		       push    [ebp+s]	       ; dst
.text:00408A0A		       lea     eax, [ebp+retval]
.text:00408A0D		       push    eax	       ; pRetValue
.text:00408A0E		       call    __wctomb_s_l
.text:00408A13		       add     esp, 14h
.text:00408A16		       test    eax, eax
.text:00408A18		       jnz     short loc_408A1F
.text:00408A1A		       mov     eax, [ebp+retval]
.text:00408A1D		       leave
.text:00408A1E		       retn
.text:00408A1F ; ---------------------------------------------------------------------------
.text:00408A1F
.text:00408A1F loc_408A1F:			       ; CODE XREF: _wctomb+24j
.text:00408A1F		       or      eax, 0FFFFFFFFh
.text:00408A22		       leave
.text:00408A23		       retn
.text:00408A23 _wctomb	       endp
.text:00408A23
.text:00408A24
.text:00408A24 ; =============== S U B R O U T I N E =======================================
.text:00408A24
.text:00408A24 ; Attributes: bp-based frame
.text:00408A24
.text:00408A24 ; int __cdecl _isleadbyte_l(int c, localeinfo_struct *plocinfo)
.text:00408A24 __isleadbyte_l  proc near	       ; CODE XREF: __output_l+34Dp
.text:00408A24					       ; _isleadbyte+6p ...
.text:00408A24
.text:00408A24 _loc_update     = _LocaleUpdate ptr -10h
.text:00408A24 c	       = dword ptr  8
.text:00408A24 plocinfo	       = dword ptr  0Ch
.text:00408A24
.text:00408A24		       push    ebp
.text:00408A25		       mov     ebp, esp
.text:00408A27		       sub     esp, 10h
.text:00408A2A		       push    [ebp+plocinfo]  ; plocinfo
.text:00408A2D		       lea     ecx, [ebp+_loc_update] ;	this
.text:00408A30		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00408A35		       movzx   eax, byte ptr [ebp+c]
.text:00408A39		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:00408A3C		       mov     ecx, [ecx+0C8h]
.text:00408A42		       movzx   eax, word ptr [ecx+eax*2]
.text:00408A46		       and     eax, 8000h
.text:00408A4B		       cmp     [ebp+_loc_update.updated], 0
.text:00408A4F		       jz      short locret_408A58
.text:00408A51		       mov     ecx, [ebp+_loc_update.ptd]
.text:00408A54		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00408A58
.text:00408A58 locret_408A58:			       ; CODE XREF: __isleadbyte_l+2Bj
.text:00408A58		       leave
.text:00408A59		       retn
.text:00408A59 __isleadbyte_l  endp
.text:00408A59
.text:00408A5A
.text:00408A5A ; =============== S U B R O U T I N E =======================================
.text:00408A5A
.text:00408A5A
.text:00408A5A ; int __cdecl isleadbyte(int c)
.text:00408A5A _isleadbyte     proc near	       ; CODE XREF: __write_nolock+1AAp
.text:00408A5A
.text:00408A5A c	       = dword ptr  4
.text:00408A5A
.text:00408A5A		       push    0	       ; plocinfo
.text:00408A5C		       push    [esp+4+c]       ; c
.text:00408A60		       call    __isleadbyte_l
.text:00408A65		       pop     ecx
.text:00408A66		       pop     ecx
.text:00408A67		       retn
.text:00408A67 _isleadbyte     endp
.text:00408A67
.text:00408A68
.text:00408A68 ; =============== S U B R O U T I N E =======================================
.text:00408A68
.text:00408A68
.text:00408A68 ; int __cdecl _iswalpha_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408A68 __iswalpha_l    proc near
.text:00408A68
.text:00408A68 c	       = dword ptr  4
.text:00408A68 plocinfo	       = dword ptr  8
.text:00408A68
.text:00408A68		       push    [esp+plocinfo]  ; plocinfo
.text:00408A6C		       push    103h	       ; mask
.text:00408A71		       push    [esp+8+c]       ; c
.text:00408A75		       call    __iswctype_l
.text:00408A7A		       add     esp, 0Ch
.text:00408A7D		       retn
.text:00408A7D __iswalpha_l    endp
.text:00408A7D
.text:00408A7E
.text:00408A7E ; =============== S U B R O U T I N E =======================================
.text:00408A7E
.text:00408A7E
.text:00408A7E ; int __cdecl iswalpha(unsigned __int16 c)
.text:00408A7E _iswalpha       proc near
.text:00408A7E
.text:00408A7E c	       = dword ptr  4
.text:00408A7E
.text:00408A7E		       push    103h	       ; mask
.text:00408A83		       push    [esp+4+c]       ; c
.text:00408A87		       call    _iswctype
.text:00408A8C		       pop     ecx
.text:00408A8D		       pop     ecx
.text:00408A8E		       retn
.text:00408A8E _iswalpha       endp
.text:00408A8E
.text:00408A8F
.text:00408A8F ; =============== S U B R O U T I N E =======================================
.text:00408A8F
.text:00408A8F
.text:00408A8F ; int __cdecl _iswupper_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408A8F __iswupper_l    proc near
.text:00408A8F
.text:00408A8F c	       = dword ptr  4
.text:00408A8F plocinfo	       = dword ptr  8
.text:00408A8F
.text:00408A8F		       push    [esp+plocinfo]  ; plocinfo
.text:00408A93		       push    1	       ; mask
.text:00408A95		       push    [esp+8+c]       ; c
.text:00408A99		       call    __iswctype_l
.text:00408A9E		       add     esp, 0Ch
.text:00408AA1		       retn
.text:00408AA1 __iswupper_l    endp
.text:00408AA1
.text:00408AA2
.text:00408AA2 ; =============== S U B R O U T I N E =======================================
.text:00408AA2
.text:00408AA2
.text:00408AA2 ; int __cdecl iswupper(unsigned __int16 c)
.text:00408AA2 _iswupper       proc near
.text:00408AA2
.text:00408AA2 c	       = dword ptr  4
.text:00408AA2
.text:00408AA2		       push    1	       ; mask
.text:00408AA4		       push    [esp+4+c]       ; c
.text:00408AA8		       call    _iswctype
.text:00408AAD		       pop     ecx
.text:00408AAE		       pop     ecx
.text:00408AAF		       retn
.text:00408AAF _iswupper       endp
.text:00408AAF
.text:00408AB0
.text:00408AB0 ; =============== S U B R O U T I N E =======================================
.text:00408AB0
.text:00408AB0
.text:00408AB0 ; int __cdecl _iswlower_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408AB0 __iswlower_l    proc near
.text:00408AB0
.text:00408AB0 c	       = dword ptr  4
.text:00408AB0 plocinfo	       = dword ptr  8
.text:00408AB0
.text:00408AB0		       push    [esp+plocinfo]  ; plocinfo
.text:00408AB4		       push    2	       ; mask
.text:00408AB6		       push    [esp+8+c]       ; c
.text:00408ABA		       call    __iswctype_l
.text:00408ABF		       add     esp, 0Ch
.text:00408AC2		       retn
.text:00408AC2 __iswlower_l    endp
.text:00408AC2
.text:00408AC3
.text:00408AC3 ; =============== S U B R O U T I N E =======================================
.text:00408AC3
.text:00408AC3
.text:00408AC3 ; int __cdecl iswlower(unsigned __int16 c)
.text:00408AC3 _iswlower       proc near
.text:00408AC3
.text:00408AC3 c	       = dword ptr  4
.text:00408AC3
.text:00408AC3		       push    2	       ; mask
.text:00408AC5		       push    [esp+4+c]       ; c
.text:00408AC9		       call    _iswctype
.text:00408ACE		       pop     ecx
.text:00408ACF		       pop     ecx
.text:00408AD0		       retn
.text:00408AD0 _iswlower       endp
.text:00408AD0
.text:00408AD1
.text:00408AD1 ; =============== S U B R O U T I N E =======================================
.text:00408AD1
.text:00408AD1
.text:00408AD1 ; int __cdecl _iswdigit_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408AD1 __iswdigit_l    proc near
.text:00408AD1
.text:00408AD1 c	       = dword ptr  4
.text:00408AD1 plocinfo	       = dword ptr  8
.text:00408AD1
.text:00408AD1		       push    [esp+plocinfo]  ; plocinfo
.text:00408AD5		       push    4	       ; mask
.text:00408AD7		       push    [esp+8+c]       ; c
.text:00408ADB		       call    __iswctype_l
.text:00408AE0		       add     esp, 0Ch
.text:00408AE3		       retn
.text:00408AE3 __iswdigit_l    endp
.text:00408AE3
.text:00408AE4
.text:00408AE4 ; =============== S U B R O U T I N E =======================================
.text:00408AE4
.text:00408AE4
.text:00408AE4 ; int __cdecl iswdigit(unsigned __int16 c)
.text:00408AE4 _iswdigit       proc near
.text:00408AE4
.text:00408AE4 c	       = dword ptr  4
.text:00408AE4
.text:00408AE4		       push    4	       ; mask
.text:00408AE6		       push    [esp+4+c]       ; c
.text:00408AEA		       call    _iswctype
.text:00408AEF		       pop     ecx
.text:00408AF0		       pop     ecx
.text:00408AF1		       retn
.text:00408AF1 _iswdigit       endp
.text:00408AF1
.text:00408AF2
.text:00408AF2 ; =============== S U B R O U T I N E =======================================
.text:00408AF2
.text:00408AF2
.text:00408AF2 ; int __cdecl _iswxdigit_l(unsigned __int16 c, localeinfo_struct	*plocinfo)
.text:00408AF2 __iswxdigit_l   proc near
.text:00408AF2
.text:00408AF2 c	       = dword ptr  4
.text:00408AF2 plocinfo	       = dword ptr  8
.text:00408AF2
.text:00408AF2		       push    [esp+plocinfo]  ; plocinfo
.text:00408AF6		       push    80h	       ; mask
.text:00408AFB		       push    [esp+8+c]       ; c
.text:00408AFF		       call    __iswctype_l
.text:00408B04		       add     esp, 0Ch
.text:00408B07		       retn
.text:00408B07 __iswxdigit_l   endp
.text:00408B07
.text:00408B08
.text:00408B08 ; =============== S U B R O U T I N E =======================================
.text:00408B08
.text:00408B08
.text:00408B08 ; int __cdecl iswxdigit(unsigned	__int16	c)
.text:00408B08 _iswxdigit      proc near
.text:00408B08
.text:00408B08 c	       = dword ptr  4
.text:00408B08
.text:00408B08		       push    80h	       ; mask
.text:00408B0D		       push    [esp+4+c]       ; c
.text:00408B11		       call    _iswctype
.text:00408B16		       pop     ecx
.text:00408B17		       pop     ecx
.text:00408B18		       retn
.text:00408B18 _iswxdigit      endp
.text:00408B18
.text:00408B19
.text:00408B19 ; =============== S U B R O U T I N E =======================================
.text:00408B19
.text:00408B19
.text:00408B19 ; int __cdecl _iswspace_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408B19 __iswspace_l    proc near
.text:00408B19
.text:00408B19 c	       = dword ptr  4
.text:00408B19 plocinfo	       = dword ptr  8
.text:00408B19
.text:00408B19		       push    [esp+plocinfo]  ; plocinfo
.text:00408B1D		       push    8	       ; mask
.text:00408B1F		       push    [esp+8+c]       ; c
.text:00408B23		       call    __iswctype_l
.text:00408B28		       add     esp, 0Ch
.text:00408B2B		       retn
.text:00408B2B __iswspace_l    endp
.text:00408B2B
.text:00408B2C
.text:00408B2C ; =============== S U B R O U T I N E =======================================
.text:00408B2C
.text:00408B2C
.text:00408B2C ; int __cdecl iswspace(unsigned __int16 c)
.text:00408B2C _iswspace       proc near
.text:00408B2C
.text:00408B2C c	       = dword ptr  4
.text:00408B2C
.text:00408B2C		       push    8	       ; mask
.text:00408B2E		       push    [esp+4+c]       ; c
.text:00408B32		       call    _iswctype
.text:00408B37		       pop     ecx
.text:00408B38		       pop     ecx
.text:00408B39		       retn
.text:00408B39 _iswspace       endp
.text:00408B39
.text:00408B3A
.text:00408B3A ; =============== S U B R O U T I N E =======================================
.text:00408B3A
.text:00408B3A
.text:00408B3A ; int __cdecl _iswpunct_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408B3A __iswpunct_l    proc near
.text:00408B3A
.text:00408B3A c	       = dword ptr  4
.text:00408B3A plocinfo	       = dword ptr  8
.text:00408B3A
.text:00408B3A		       push    [esp+plocinfo]  ; plocinfo
.text:00408B3E		       push    10h	       ; mask
.text:00408B40		       push    [esp+8+c]       ; c
.text:00408B44		       call    __iswctype_l
.text:00408B49		       add     esp, 0Ch
.text:00408B4C		       retn
.text:00408B4C __iswpunct_l    endp
.text:00408B4C
.text:00408B4D
.text:00408B4D ; =============== S U B R O U T I N E =======================================
.text:00408B4D
.text:00408B4D
.text:00408B4D ; int __cdecl iswpunct(unsigned __int16 c)
.text:00408B4D _iswpunct       proc near
.text:00408B4D
.text:00408B4D c	       = dword ptr  4
.text:00408B4D
.text:00408B4D		       push    10h	       ; mask
.text:00408B4F		       push    [esp+4+c]       ; c
.text:00408B53		       call    _iswctype
.text:00408B58		       pop     ecx
.text:00408B59		       pop     ecx
.text:00408B5A		       retn
.text:00408B5A _iswpunct       endp
.text:00408B5A
.text:00408B5B
.text:00408B5B ; =============== S U B R O U T I N E =======================================
.text:00408B5B
.text:00408B5B
.text:00408B5B ; int __cdecl _iswalnum_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408B5B __iswalnum_l    proc near
.text:00408B5B
.text:00408B5B c	       = dword ptr  4
.text:00408B5B plocinfo	       = dword ptr  8
.text:00408B5B
.text:00408B5B		       push    [esp+plocinfo]  ; plocinfo
.text:00408B5F		       push    107h	       ; mask
.text:00408B64		       push    [esp+8+c]       ; c
.text:00408B68		       call    __iswctype_l
.text:00408B6D		       add     esp, 0Ch
.text:00408B70		       retn
.text:00408B70 __iswalnum_l    endp
.text:00408B70
.text:00408B71
.text:00408B71 ; =============== S U B R O U T I N E =======================================
.text:00408B71
.text:00408B71
.text:00408B71 ; int __cdecl iswalnum(unsigned __int16 c)
.text:00408B71 _iswalnum       proc near
.text:00408B71
.text:00408B71 c	       = dword ptr  4
.text:00408B71
.text:00408B71		       push    107h	       ; mask
.text:00408B76		       push    [esp+4+c]       ; c
.text:00408B7A		       call    _iswctype
.text:00408B7F		       pop     ecx
.text:00408B80		       pop     ecx
.text:00408B81		       retn
.text:00408B81 _iswalnum       endp
.text:00408B81
.text:00408B82
.text:00408B82 ; =============== S U B R O U T I N E =======================================
.text:00408B82
.text:00408B82
.text:00408B82 ; int __cdecl _iswprint_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408B82 __iswprint_l    proc near
.text:00408B82
.text:00408B82 c	       = dword ptr  4
.text:00408B82 plocinfo	       = dword ptr  8
.text:00408B82
.text:00408B82		       push    [esp+plocinfo]  ; plocinfo
.text:00408B86		       push    157h	       ; mask
.text:00408B8B		       push    [esp+8+c]       ; c
.text:00408B8F		       call    __iswctype_l
.text:00408B94		       add     esp, 0Ch
.text:00408B97		       retn
.text:00408B97 __iswprint_l    endp
.text:00408B97
.text:00408B98
.text:00408B98 ; =============== S U B R O U T I N E =======================================
.text:00408B98
.text:00408B98
.text:00408B98 ; int __cdecl iswprint(unsigned __int16 c)
.text:00408B98 _iswprint       proc near
.text:00408B98
.text:00408B98 c	       = dword ptr  4
.text:00408B98
.text:00408B98		       push    157h	       ; mask
.text:00408B9D		       push    [esp+4+c]       ; c
.text:00408BA1		       call    _iswctype
.text:00408BA6		       pop     ecx
.text:00408BA7		       pop     ecx
.text:00408BA8		       retn
.text:00408BA8 _iswprint       endp
.text:00408BA8
.text:00408BA9
.text:00408BA9 ; =============== S U B R O U T I N E =======================================
.text:00408BA9
.text:00408BA9
.text:00408BA9 ; int __cdecl _iswgraph_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408BA9 __iswgraph_l    proc near
.text:00408BA9
.text:00408BA9 c	       = dword ptr  4
.text:00408BA9 plocinfo	       = dword ptr  8
.text:00408BA9
.text:00408BA9		       push    [esp+plocinfo]  ; plocinfo
.text:00408BAD		       push    117h	       ; mask
.text:00408BB2		       push    [esp+8+c]       ; c
.text:00408BB6		       call    __iswctype_l
.text:00408BBB		       add     esp, 0Ch
.text:00408BBE		       retn
.text:00408BBE __iswgraph_l    endp
.text:00408BBE
.text:00408BBF
.text:00408BBF ; =============== S U B R O U T I N E =======================================
.text:00408BBF
.text:00408BBF
.text:00408BBF ; int __cdecl iswgraph(unsigned __int16 c)
.text:00408BBF _iswgraph       proc near
.text:00408BBF
.text:00408BBF c	       = dword ptr  4
.text:00408BBF
.text:00408BBF		       push    117h	       ; mask
.text:00408BC4		       push    [esp+4+c]       ; c
.text:00408BC8		       call    _iswctype
.text:00408BCD		       pop     ecx
.text:00408BCE		       pop     ecx
.text:00408BCF		       retn
.text:00408BCF _iswgraph       endp
.text:00408BCF
.text:00408BD0
.text:00408BD0 ; =============== S U B R O U T I N E =======================================
.text:00408BD0
.text:00408BD0
.text:00408BD0 ; int __cdecl _iswcntrl_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408BD0 __iswcntrl_l    proc near
.text:00408BD0
.text:00408BD0 c	       = dword ptr  4
.text:00408BD0 plocinfo	       = dword ptr  8
.text:00408BD0
.text:00408BD0		       push    [esp+plocinfo]  ; plocinfo
.text:00408BD4		       push    20h	       ; mask
.text:00408BD6		       push    [esp+8+c]       ; c
.text:00408BDA		       call    __iswctype_l
.text:00408BDF		       add     esp, 0Ch
.text:00408BE2		       retn
.text:00408BE2 __iswcntrl_l    endp
.text:00408BE2
.text:00408BE3
.text:00408BE3 ; =============== S U B R O U T I N E =======================================
.text:00408BE3
.text:00408BE3
.text:00408BE3 ; int __cdecl iswcntrl(unsigned __int16 c)
.text:00408BE3 _iswcntrl       proc near
.text:00408BE3
.text:00408BE3 c	       = dword ptr  4
.text:00408BE3
.text:00408BE3		       push    20h	       ; mask
.text:00408BE5		       push    [esp+4+c]       ; c
.text:00408BE9		       call    _iswctype
.text:00408BEE		       pop     ecx
.text:00408BEF		       pop     ecx
.text:00408BF0		       retn
.text:00408BF0 _iswcntrl       endp
.text:00408BF0
.text:00408BF1
.text:00408BF1 ; =============== S U B R O U T I N E =======================================
.text:00408BF1
.text:00408BF1
.text:00408BF1 ; int __cdecl iswascii(unsigned __int16 c)
.text:00408BF1 _iswascii       proc near
.text:00408BF1
.text:00408BF1 c	       = word ptr  4
.text:00408BF1
.text:00408BF1		       cmp     [esp+c],	80h
.text:00408BF8		       sbb     eax, eax
.text:00408BFA		       neg     eax
.text:00408BFC		       retn
.text:00408BFC _iswascii       endp
.text:00408BFC
.text:00408BFD
.text:00408BFD ; =============== S U B R O U T I N E =======================================
.text:00408BFD
.text:00408BFD
.text:00408BFD ; int __cdecl _iswcsym_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408BFD __iswcsym_l     proc near
.text:00408BFD
.text:00408BFD c	       = dword ptr  4
.text:00408BFD plocinfo	       = dword ptr  8
.text:00408BFD
.text:00408BFD		       push    [esp+plocinfo]  ; plocinfo
.text:00408C01		       push    107h	       ; mask
.text:00408C06		       push    [esp+8+c]       ; c
.text:00408C0A		       call    __iswctype_l
.text:00408C0F		       add     esp, 0Ch
.text:00408C12		       test    eax, eax
.text:00408C14		       jnz     short loc_408C1F
.text:00408C16		       cmp     word ptr	[esp+c], 5Fh
.text:00408C1C		       jz      short loc_408C1F
.text:00408C1E		       retn
.text:00408C1F ; ---------------------------------------------------------------------------
.text:00408C1F
.text:00408C1F loc_408C1F:			       ; CODE XREF: __iswcsym_l+17j
.text:00408C1F					       ; __iswcsym_l+1Fj
.text:00408C1F		       xor     eax, eax
.text:00408C21		       inc     eax
.text:00408C22		       retn
.text:00408C22 __iswcsym_l     endp
.text:00408C22
.text:00408C23
.text:00408C23 ; =============== S U B R O U T I N E =======================================
.text:00408C23
.text:00408C23
.text:00408C23 ; int __cdecl __iswcsym(unsigned	__int16	c)
.text:00408C23 ___iswcsym      proc near
.text:00408C23
.text:00408C23 c	       = dword ptr  4
.text:00408C23
.text:00408C23		       push    107h	       ; mask
.text:00408C28		       push    [esp+4+c]       ; c
.text:00408C2C		       call    _iswctype
.text:00408C31		       test    eax, eax
.text:00408C33		       pop     ecx
.text:00408C34		       pop     ecx
.text:00408C35		       jnz     short loc_408C40
.text:00408C37		       cmp     word ptr	[esp+c], 5Fh
.text:00408C3D		       jz      short loc_408C40
.text:00408C3F		       retn
.text:00408C40 ; ---------------------------------------------------------------------------
.text:00408C40
.text:00408C40 loc_408C40:			       ; CODE XREF: ___iswcsym+12j
.text:00408C40					       ; ___iswcsym+1Aj
.text:00408C40		       xor     eax, eax
.text:00408C42		       inc     eax
.text:00408C43		       retn
.text:00408C43 ___iswcsym      endp
.text:00408C43
.text:00408C44
.text:00408C44 ; =============== S U B R O U T I N E =======================================
.text:00408C44
.text:00408C44
.text:00408C44 ; int __cdecl _iswcsymf_l(unsigned __int16 c, localeinfo_struct *plocinfo)
.text:00408C44 __iswcsymf_l    proc near
.text:00408C44
.text:00408C44 c	       = dword ptr  4
.text:00408C44 plocinfo	       = dword ptr  8
.text:00408C44
.text:00408C44		       push    [esp+plocinfo]  ; plocinfo
.text:00408C48		       push    103h	       ; mask
.text:00408C4D		       push    [esp+8+c]       ; c
.text:00408C51		       call    __iswctype_l
.text:00408C56		       add     esp, 0Ch
.text:00408C59		       test    eax, eax
.text:00408C5B		       jnz     short loc_408C66
.text:00408C5D		       cmp     word ptr	[esp+c], 5Fh
.text:00408C63		       jz      short loc_408C66
.text:00408C65		       retn
.text:00408C66 ; ---------------------------------------------------------------------------
.text:00408C66
.text:00408C66 loc_408C66:			       ; CODE XREF: __iswcsymf_l+17j
.text:00408C66					       ; __iswcsymf_l+1Fj
.text:00408C66		       xor     eax, eax
.text:00408C68		       inc     eax
.text:00408C69		       retn
.text:00408C69 __iswcsymf_l    endp
.text:00408C69
.text:00408C6A
.text:00408C6A ; =============== S U B R O U T I N E =======================================
.text:00408C6A
.text:00408C6A
.text:00408C6A ; int __cdecl __iswcsymf(unsigned __int16 c)
.text:00408C6A ___iswcsymf     proc near
.text:00408C6A
.text:00408C6A c	       = dword ptr  4
.text:00408C6A
.text:00408C6A		       push    103h	       ; mask
.text:00408C6F		       push    [esp+4+c]       ; c
.text:00408C73		       call    _iswctype
.text:00408C78		       test    eax, eax
.text:00408C7A		       pop     ecx
.text:00408C7B		       pop     ecx
.text:00408C7C		       jnz     short loc_408C87
.text:00408C7E		       cmp     word ptr	[esp+c], 5Fh
.text:00408C84		       jz      short loc_408C87
.text:00408C86		       retn
.text:00408C87 ; ---------------------------------------------------------------------------
.text:00408C87
.text:00408C87 loc_408C87:			       ; CODE XREF: ___iswcsymf+12j
.text:00408C87					       ; ___iswcsymf+1Aj
.text:00408C87		       xor     eax, eax
.text:00408C89		       inc     eax
.text:00408C8A		       retn
.text:00408C8A ___iswcsymf     endp
.text:00408C8A
.text:00408C8B
.text:00408C8B ; =============== S U B R O U T I N E =======================================
.text:00408C8B
.text:00408C8B
.text:00408C8B ; void __fastcall __security_check_cookie(unsigned int cookie)
.text:00408C8B @__security_check_cookie@4 proc near    ; CODE XREF: __output_l+967p
.text:00408C8B					       ; __invoke_watson+EFp ...
.text:00408C8B cookie =	ecx
.text:00408C8B		       cmp     cookie, ___security_cookie
.text:00408C91		       jnz     short failure
.text:00408C93		       rep retn
.text:00408C95 ; ---------------------------------------------------------------------------
.text:00408C95
.text:00408C95 failure:				       ; CODE XREF: __security_check_cookie(x)+6j
.text:00408C95		       jmp     ___report_gsfailure
.text:00408C95 @__security_check_cookie@4 endp
.text:00408C95
.text:00408C95 ; ---------------------------------------------------------------------------
.text:00408C9A		       align 10h
.text:00408CA0
.text:00408CA0 ; =============== S U B R O U T I N E =======================================
.text:00408CA0
.text:00408CA0
.text:00408CA0 __aulldvrm      proc near	       ; CODE XREF: __output_l+785p
.text:00408CA0					       ; __output_s_l+791p ...
.text:00408CA0
.text:00408CA0 arg_0	       = dword ptr  4
.text:00408CA0 arg_4	       = dword ptr  8
.text:00408CA0 arg_8	       = dword ptr  0Ch
.text:00408CA0 arg_C	       = dword ptr  10h
.text:00408CA0
.text:00408CA0		       push    esi
.text:00408CA1		       mov     eax, [esp+4+arg_C]
.text:00408CA5		       or      eax, eax
.text:00408CA7		       jnz     short L1
.text:00408CA9		       mov     ecx, [esp+4+arg_8]
.text:00408CAD		       mov     eax, [esp+4+arg_4]
.text:00408CB1		       xor     edx, edx
.text:00408CB3		       div     ecx
.text:00408CB5		       mov     ebx, eax
.text:00408CB7		       mov     eax, [esp+4+arg_0]
.text:00408CBB		       div     ecx
.text:00408CBD		       mov     esi, eax
.text:00408CBF		       mov     eax, ebx
.text:00408CC1		       mul     [esp+4+arg_8]
.text:00408CC5		       mov     ecx, eax
.text:00408CC7		       mov     eax, esi
.text:00408CC9		       mul     [esp+4+arg_8]
.text:00408CCD		       add     edx, ecx
.text:00408CCF		       jmp     short L2
.text:00408CD1 ; ---------------------------------------------------------------------------
.text:00408CD1
.text:00408CD1 L1:				       ; CODE XREF: __aulldvrm+7j
.text:00408CD1		       mov     ecx, eax
.text:00408CD3		       mov     ebx, [esp+4+arg_8]
.text:00408CD7		       mov     edx, [esp+4+arg_4]
.text:00408CDB		       mov     eax, [esp+4+arg_0]
.text:00408CDF
.text:00408CDF L3:				       ; CODE XREF: __aulldvrm+49j
.text:00408CDF		       shr     ecx, 1
.text:00408CE1		       rcr     ebx, 1
.text:00408CE3		       shr     edx, 1
.text:00408CE5		       rcr     eax, 1
.text:00408CE7		       or      ecx, ecx
.text:00408CE9		       jnz     short L3
.text:00408CEB		       div     ebx
.text:00408CED		       mov     esi, eax
.text:00408CEF		       mul     [esp+4+arg_C]
.text:00408CF3		       mov     ecx, eax
.text:00408CF5		       mov     eax, [esp+4+arg_8]
.text:00408CF9		       mul     esi
.text:00408CFB		       add     edx, ecx
.text:00408CFD		       jb      short L4
.text:00408CFF		       cmp     edx, [esp+4+arg_4]
.text:00408D03		       ja      short L4
.text:00408D05		       jb      short L5
.text:00408D07		       cmp     eax, [esp+4+arg_0]
.text:00408D0B		       jbe     short L5
.text:00408D0D
.text:00408D0D L4:				       ; CODE XREF: __aulldvrm+5Dj
.text:00408D0D					       ; __aulldvrm+63j
.text:00408D0D		       dec     esi
.text:00408D0E		       sub     eax, [esp+4+arg_8]
.text:00408D12		       sbb     edx, [esp+4+arg_C]
.text:00408D16
.text:00408D16 L5:				       ; CODE XREF: __aulldvrm+65j
.text:00408D16					       ; __aulldvrm+6Bj
.text:00408D16		       xor     ebx, ebx
.text:00408D18
.text:00408D18 L2:				       ; CODE XREF: __aulldvrm+2Fj
.text:00408D18		       sub     eax, [esp+4+arg_0]
.text:00408D1C		       sbb     edx, [esp+4+arg_4]
.text:00408D20		       neg     edx
.text:00408D22		       neg     eax
.text:00408D24		       sbb     edx, 0
.text:00408D27		       mov     ecx, edx
.text:00408D29		       mov     edx, ebx
.text:00408D2B		       mov     ebx, ecx
.text:00408D2D		       mov     ecx, eax
.text:00408D2F		       mov     eax, esi
.text:00408D31		       pop     esi
.text:00408D32		       retn    10h
.text:00408D32 __aulldvrm      endp
.text:00408D32
.text:00408D35
.text:00408D35 ; =============== S U B R O U T I N E =======================================
.text:00408D35
.text:00408D35
.text:00408D35 ; void __cdecl _crt_debugger_hook(int _Reserved)
.text:00408D35 __crt_debugger_hook proc	near	       ; CODE XREF: __invoke_watson+CEp
.text:00408D35					       ; __invalid_parameter+18p ...
.text:00408D35
.text:00408D35 _Reserved       = dword ptr  4
.text:00408D35
.text:00408D35		       and     __debugger_hook_dummy, 0
.text:00408D3C		       retn
.text:00408D3C __crt_debugger_hook endp
.text:00408D3C
.text:00408D3C ; ---------------------------------------------------------------------------
.text:00408D3D		       align 10h
.text:00408D40
.text:00408D40 ; =============== S U B R O U T I N E =======================================
.text:00408D40
.text:00408D40
.text:00408D40 ; void __cdecl memset(char *dst,	char value, unsigned int count)
.text:00408D40 _memset	       proc near	       ; CODE XREF: __invoke_watson+8Cp
.text:00408D40					       ; setSBCS+13p ...
.text:00408D40
.text:00408D40 arg_0	       = dword ptr  4
.text:00408D40 dst	       = dword ptr  8
.text:00408D40 value	       = dword ptr  0Ch
.text:00408D40 count	       = dword ptr  10h
.text:00408D40
.text:00408D40		       mov     edx, [esp+value]
.text:00408D44		       mov     ecx, [esp+arg_0]
.text:00408D48		       test    edx, edx
.text:00408D4A		       jz      short toend
.text:00408D4C		       xor     eax, eax
.text:00408D4E		       mov     al, byte	ptr [esp+dst]
.text:00408D52		       test    al, al
.text:00408D54		       jnz     short dword_align
.text:00408D56		       cmp     edx, 100h
.text:00408D5C		       jb      short dword_align
.text:00408D5E		       cmp     ___sse2_available, 0
.text:00408D65		       jz      short dword_align
.text:00408D67		       jmp     __VEC_memzero
.text:00408D6C ; ---------------------------------------------------------------------------
.text:00408D6C
.text:00408D6C dword_align:			       ; CODE XREF: _memset+14j
.text:00408D6C					       ; _memset+1Cj ...
.text:00408D6C		       push    edi
.text:00408D6D		       mov     edi, ecx
.text:00408D6F		       cmp     edx, 4
.text:00408D72		       jb      short tail
.text:00408D74		       neg     ecx
.text:00408D76		       and     ecx, 3
.text:00408D79		       jz      short dwords
.text:00408D7B		       sub     edx, ecx
.text:00408D7D
.text:00408D7D adjust_loop:			       ; CODE XREF: _memset+45j
.text:00408D7D		       mov     [edi], al
.text:00408D7F		       add     edi, 1
.text:00408D82		       sub     ecx, 1
.text:00408D85		       jnz     short adjust_loop
.text:00408D87
.text:00408D87 dwords:				       ; CODE XREF: _memset+39j
.text:00408D87		       mov     ecx, eax
.text:00408D89		       shl     eax, 8
.text:00408D8C		       add     eax, ecx
.text:00408D8E		       mov     ecx, eax
.text:00408D90		       shl     eax, 10h
.text:00408D93		       add     eax, ecx
.text:00408D95		       mov     ecx, edx
.text:00408D97		       and     edx, 3
.text:00408D9A		       shr     ecx, 2
.text:00408D9D		       jz      short tail
.text:00408D9F		       rep stosd
.text:00408DA1
.text:00408DA1 main_loop_tail:
.text:00408DA1		       test    edx, edx
.text:00408DA3		       jz      short finish
.text:00408DA5
.text:00408DA5 tail:				       ; CODE XREF: _memset+32j
.text:00408DA5					       ; _memset+5Dj ...
.text:00408DA5		       mov     [edi], al
.text:00408DA7		       add     edi, 1
.text:00408DAA		       sub     edx, 1
.text:00408DAD		       jnz     short tail
.text:00408DAF
.text:00408DAF finish:				       ; CODE XREF: _memset+63j
.text:00408DAF		       mov     eax, [esp+4+arg_0]
.text:00408DB3		       pop     edi
.text:00408DB4		       retn
.text:00408DB5 ; ---------------------------------------------------------------------------
.text:00408DB5
.text:00408DB5 toend:				       ; CODE XREF: _memset+Aj
.text:00408DB5		       mov     eax, [esp+arg_0]
.text:00408DB9		       retn
.text:00408DB9 _memset	       endp
.text:00408DB9
.text:00408DB9 ; ---------------------------------------------------------------------------
.text:00408DBA		       align 4
.text:00408DBC
.text:00408DBC ; =============== S U B R O U T I N E =======================================
.text:00408DBC
.text:00408DBC
.text:00408DBC __local_unwind4 proc near	       ; CODE XREF: _unwind_handler4+2Dp
.text:00408DBC					       ; _seh_longjmp_unwind4(x)+10p ...
.text:00408DBC
.text:00408DBC var_20	       = dword ptr -20h
.text:00408DBC arg_0	       = dword ptr  4
.text:00408DBC arg_4	       = dword ptr  8
.text:00408DBC arg_8	       = dword ptr  0Ch
.text:00408DBC
.text:00408DBC		       push    ebx
.text:00408DBD		       push    esi
.text:00408DBE		       push    edi
.text:00408DBF		       mov     edx, [esp+0Ch+arg_0]
.text:00408DC3		       mov     eax, [esp+0Ch+arg_4]
.text:00408DC7		       mov     ecx, [esp+0Ch+arg_8]
.text:00408DCB		       push    ebp
.text:00408DCC		       push    edx
.text:00408DCD		       push    eax
.text:00408DCE		       push    ecx
.text:00408DCF		       push    ecx
.text:00408DD0		       push    offset _unwind_handler4
.text:00408DD5		       push    large dword ptr fs:0
.text:00408DDC		       mov     eax, ___security_cookie
.text:00408DE1		       xor     eax, esp
.text:00408DE3		       mov     [esp+28h+var_20], eax
.text:00408DE7		       mov     large fs:0, esp
.text:00408DEE
.text:00408DEE _lu_top:				       ; CODE XREF: __local_unwind4+64j
.text:00408DEE					       ; __local_unwind4+80j
.text:00408DEE		       mov     eax, [esp+28h+arg_4]
.text:00408DF2		       mov     ebx, [eax+8]
.text:00408DF5		       mov     ecx, [esp+28h+arg_0]
.text:00408DF9		       xor     ebx, [ecx]
.text:00408DFB		       mov     esi, [eax+0Ch]
.text:00408DFE		       cmp     esi, 0FFFFFFFEh
.text:00408E01		       jz      short _lu_done
.text:00408E03		       mov     edx, [esp+28h+arg_8]
.text:00408E07		       cmp     edx, 0FFFFFFFEh
.text:00408E0A		       jz      short loc_408E10
.text:00408E0C		       cmp     esi, edx
.text:00408E0E		       jbe     short _lu_done
.text:00408E10
.text:00408E10 loc_408E10:			       ; CODE XREF: __local_unwind4+4Ej
.text:00408E10		       lea     esi, [esi+esi*2]
.text:00408E13		       lea     ebx, [ebx+esi*4+10h]
.text:00408E17		       mov     ecx, [ebx]
.text:00408E19		       mov     [eax+0Ch], ecx
.text:00408E1C		       cmp     dword ptr [ebx+4], 0
.text:00408E20		       jnz     short _lu_top
.text:00408E22		       push    101h
.text:00408E27		       mov     eax, [ebx+8]
.text:00408E2A		       call    __NLG_Notify
.text:00408E2F		       mov     ecx, 1
.text:00408E34		       mov     eax, [ebx+8]
.text:00408E37		       call    __NLG_Call
.text:00408E3C		       jmp     short _lu_top
.text:00408E3E ; ---------------------------------------------------------------------------
.text:00408E3E
.text:00408E3E _lu_done:			       ; CODE XREF: __local_unwind4+45j
.text:00408E3E					       ; __local_unwind4+52j
.text:00408E3E		       pop     large dword ptr fs:0
.text:00408E45		       add     esp, 18h
.text:00408E48		       pop     edi
.text:00408E49		       pop     esi
.text:00408E4A		       pop     ebx
.text:00408E4B		       retn
.text:00408E4B __local_unwind4 endp
.text:00408E4B
.text:00408E4C
.text:00408E4C ; =============== S U B R O U T I N E =======================================
.text:00408E4C
.text:00408E4C
.text:00408E4C _unwind_handler4	proc near	       ; DATA XREF: __local_unwind4+14o
.text:00408E4C
.text:00408E4C arg_0	       = dword ptr  4
.text:00408E4C arg_4	       = dword ptr  8
.text:00408E4C arg_C	       = dword ptr  10h
.text:00408E4C
.text:00408E4C		       mov     ecx, [esp+arg_0]
.text:00408E50		       test    dword ptr [ecx+4], 6
.text:00408E57		       mov     eax, 1
.text:00408E5C		       jz      short locret_408E91
.text:00408E5E		       mov     eax, [esp+arg_4]
.text:00408E62		       mov     ecx, [eax+8]
.text:00408E65		       xor     ecx, eax	       ; cookie
.text:00408E67		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00408E6C		       push    ebp
.text:00408E6D		       mov     ebp, [eax+18h]
.text:00408E70		       push    dword ptr [eax+0Ch]
.text:00408E73		       push    dword ptr [eax+10h]
.text:00408E76		       push    dword ptr [eax+14h]
.text:00408E79		       call    __local_unwind4
.text:00408E7E		       add     esp, 0Ch
.text:00408E81		       pop     ebp
.text:00408E82		       mov     eax, [esp+arg_4]
.text:00408E86		       mov     edx, [esp+arg_C]
.text:00408E8A		       mov     [edx], eax
.text:00408E8C		       mov     eax, 3
.text:00408E91
.text:00408E91 locret_408E91:			       ; CODE XREF: _unwind_handler4+10j
.text:00408E91		       retn
.text:00408E91 _unwind_handler4	endp
.text:00408E91
.text:00408E92
.text:00408E92 ; =============== S U B R O U T I N E =======================================
.text:00408E92
.text:00408E92
.text:00408E92 ; void __stdcall	_seh_longjmp_unwind4(unsigned int Dummy)
.text:00408E92 __seh_longjmp_unwind4@4 proc near
.text:00408E92
.text:00408E92 arg_0	       = dword ptr  4
.text:00408E92 Dummy	       = dword ptr  8
.text:00408E92
.text:00408E92		       push    ebp
.text:00408E93		       mov     ecx, [esp+4+arg_0]
.text:00408E97		       mov     ebp, [ecx]
.text:00408E99		       push    dword ptr [ecx+1Ch]
.text:00408E9C		       push    dword ptr [ecx+18h]
.text:00408E9F		       push    dword ptr [ecx+28h]
.text:00408EA2		       call    __local_unwind4
.text:00408EA7		       add     esp, 0Ch
.text:00408EAA		       pop     ebp
.text:00408EAB		       retn    4
.text:00408EAB __seh_longjmp_unwind4@4 endp
.text:00408EAB
.text:00408EAE
.text:00408EAE ; =============== S U B R O U T I N E =======================================
.text:00408EAE
.text:00408EAE
.text:00408EAE ; __fastcall _EH4_CallFilterFunc(x, x)
.text:00408EAE @_EH4_CallFilterFunc@8 proc near	       ; CODE XREF: __except_handler4+89p
.text:00408EAE		       push    ebp
.text:00408EAF		       push    esi
.text:00408EB0		       push    edi
.text:00408EB1		       push    ebx
.text:00408EB2		       mov     ebp, edx
.text:00408EB4		       xor     eax, eax
.text:00408EB6		       xor     ebx, ebx
.text:00408EB8		       xor     edx, edx
.text:00408EBA		       xor     esi, esi
.text:00408EBC		       xor     edi, edi
.text:00408EBE		       call    ecx
.text:00408EC0		       pop     ebx
.text:00408EC1		       pop     edi
.text:00408EC2		       pop     esi
.text:00408EC3		       pop     ebp
.text:00408EC4		       retn
.text:00408EC4 @_EH4_CallFilterFunc@8 endp
.text:00408EC4
.text:00408EC5
.text:00408EC5 ; =============== S U B R O U T I N E =======================================
.text:00408EC5
.text:00408EC5
.text:00408EC5 ; __fastcall _EH4_TransferToHandler(x, x)
.text:00408EC5 @_EH4_TransferToHandler@8 proc near     ; CODE XREF: __except_handler4+170j
.text:00408EC5		       mov     ebp, edx
.text:00408EC7		       mov     esi, ecx
.text:00408EC9		       mov     eax, ecx
.text:00408ECB		       push    1
.text:00408ECD		       call    __NLG_Notify
.text:00408ED2		       xor     eax, eax
.text:00408ED4		       xor     ebx, ebx
.text:00408ED6		       xor     ecx, ecx
.text:00408ED8		       xor     edx, edx
.text:00408EDA		       xor     edi, edi
.text:00408EDC		       jmp     esi
.text:00408EDC @_EH4_TransferToHandler@8 endp
.text:00408EDC
.text:00408EDE
.text:00408EDE ; =============== S U B R O U T I N E =======================================
.text:00408EDE
.text:00408EDE ; Attributes: bp-based frame
.text:00408EDE
.text:00408EDE ; __fastcall _EH4_GlobalUnwind(x)
.text:00408EDE @_EH4_GlobalUnwind@4 proc near	       ; CODE XREF: __except_handler4+11Fp
.text:00408EDE		       push    ebp
.text:00408EDF		       mov     ebp, esp
.text:00408EE1		       push    ebx
.text:00408EE2		       push    esi
.text:00408EE3		       push    edi
.text:00408EE4		       push    0
.text:00408EE6		       push    0
.text:00408EE8		       push    offset ReturnPoint
.text:00408EED		       push    ecx
.text:00408EEE		       call    _RtlUnwind@16   ; RtlUnwind(x,x,x,x)
.text:00408EF3
.text:00408EF3 ReturnPoint:			       ; DATA XREF: _EH4_GlobalUnwind(x)+Ao
.text:00408EF3		       pop     edi
.text:00408EF4		       pop     esi
.text:00408EF5		       pop     ebx
.text:00408EF6		       pop     ebp
.text:00408EF7		       retn
.text:00408EF7 @_EH4_GlobalUnwind@4 endp
.text:00408EF7
.text:00408EF8
.text:00408EF8 ; =============== S U B R O U T I N E =======================================
.text:00408EF8
.text:00408EF8
.text:00408EF8 ; __fastcall _EH4_LocalUnwind(x,	x, x, x)
.text:00408EF8 @_EH4_LocalUnwind@16 proc near	       ; CODE XREF: __except_handler4+137p
.text:00408EF8					       ; __except_handler4+18Cp
.text:00408EF8
.text:00408EF8 arg_0	       = dword ptr  4
.text:00408EF8 arg_4	       = dword ptr  8
.text:00408EF8
.text:00408EF8		       push    ebp
.text:00408EF9		       mov     ebp, [esp+4+arg_0]
.text:00408EFD		       push    edx
.text:00408EFE		       push    ecx
.text:00408EFF		       push    [esp+0Ch+arg_4]
.text:00408F03		       call    __local_unwind4
.text:00408F08		       add     esp, 0Ch
.text:00408F0B		       pop     ebp
.text:00408F0C		       retn    8
.text:00408F0C @_EH4_LocalUnwind@16 endp
.text:00408F0C
.text:00408F0F
.text:00408F0F ; =============== S U B R O U T I N E =======================================
.text:00408F0F
.text:00408F0F
.text:00408F0F ; void __usercall write_char_0(char ch<al>, _iobuf *f<ecx>, int *pnumwritten<esi>)
.text:00408F0F write_char_0    proc near	       ; CODE XREF: write_multi_char_0+11p
.text:00408F0F					       ; write_string_0+22p ...
.text:00408F0F f = ecx
.text:00408F0F pnumwritten = esi
.text:00408F0F		       test    byte ptr	[f+0Ch], 40h
.text:00408F13		       jz      short loc_408F1B
.text:00408F15		       cmp     dword ptr [f+8],	0
.text:00408F19		       jz      short loc_408F3F
.text:00408F1B
.text:00408F1B loc_408F1B:			       ; CODE XREF: write_char_0+4j
.text:00408F1B		       dec     dword ptr [f+4]
.text:00408F1E		       js      short loc_408F2B
.text:00408F20		       mov     edx, [f]
.text:00408F22		       mov     [edx], al
.text:00408F24		       inc     dword ptr [f]
.text:00408F26		       movzx   eax, al
.text:00408F29		       jmp     short loc_408F37
.text:00408F2B ; ---------------------------------------------------------------------------
.text:00408F2B
.text:00408F2B loc_408F2B:			       ; CODE XREF: write_char_0+Fj
.text:00408F2B		       movsx   eax, al
.text:00408F2E		       push    f	       ; str
.text:00408F2F		       push    eax	       ; ch
.text:00408F30		       call    __flsbuf
.text:00408F35		       pop     f
.text:00408F36		       pop     f
.text:00408F37
.text:00408F37 loc_408F37:			       ; CODE XREF: write_char_0+1Aj
.text:00408F37		       cmp     eax, 0FFFFFFFFh
.text:00408F3A		       jnz     short loc_408F3F
.text:00408F3C		       or      [pnumwritten], eax
.text:00408F3E		       retn
.text:00408F3F ; ---------------------------------------------------------------------------
.text:00408F3F
.text:00408F3F loc_408F3F:			       ; CODE XREF: write_char_0+Aj
.text:00408F3F					       ; write_char_0+2Bj
.text:00408F3F		       inc     dword ptr [pnumwritten]
.text:00408F41		       retn
.text:00408F41 write_char_0    endp
.text:00408F41
.text:00408F42
.text:00408F42 ; =============== S U B R O U T I N E =======================================
.text:00408F42
.text:00408F42 ; Attributes: bp-based frame
.text:00408F42
.text:00408F42 ; void __usercall write_multi_char_0(char ch, int num, _iobuf *f, int *pnumwritten<eax>)
.text:00408F42 write_multi_char_0 proc near	       ; CODE XREF: __output_s_l+85Fp
.text:00408F42					       ; __output_s_l+88Cp ...
.text:00408F42
.text:00408F42 arg_0	       = byte ptr  8
.text:00408F42 num	       = dword ptr  0Ch
.text:00408F42 f	       = dword ptr  10h
.text:00408F42
.text:00408F42 pnumwritten = eax
.text:00408F42		       push    ebp
.text:00408F43		       mov     ebp, esp
.text:00408F45		       push    esi
.text:00408F46		       mov     esi, pnumwritten	; pnumwritten
.text:00408F48		       jmp     short loc_408F5D
.text:00408F4A ; ---------------------------------------------------------------------------
.text:00408F4A
.text:00408F4A loc_408F4A:			       ; CODE XREF: write_multi_char_0+1Fj
.text:00408F4A		       mov     ecx, [ebp+f]    ; f
.text:00408F4D		       mov     al, [ebp+arg_0] ; ch
.text:00408F50		       dec     [ebp+num]
.text:00408F53		       call    write_char_0
.text:00408F58		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00408F5B		       jz      short loc_408F63
.text:00408F5D
.text:00408F5D loc_408F5D:			       ; CODE XREF: write_multi_char_0+6j
.text:00408F5D		       cmp     [ebp+num], 0
.text:00408F61		       jg      short loc_408F4A
.text:00408F63
.text:00408F63 loc_408F63:			       ; CODE XREF: write_multi_char_0+19j
.text:00408F63		       pop     esi
.text:00408F64		       pop     ebp
.text:00408F65		       retn
.text:00408F65 write_multi_char_0 endp
.text:00408F65
.text:00408F66
.text:00408F66 ; =============== S U B R O U T I N E =======================================
.text:00408F66
.text:00408F66
.text:00408F66 ; void __usercall write_string_0(char *string<ecx>, int len, _iobuf *f<edi>, int	*pnumwritten<eax>)
.text:00408F66 write_string_0  proc near	       ; CODE XREF: __output_s_l+873p
.text:00408F66					       ; __output_s_l+8DAp ...
.text:00408F66
.text:00408F66 len	       = dword ptr  4
.text:00408F66
.text:00408F66 string =	ecx
.text:00408F66 f = edi
.text:00408F66 pnumwritten = eax
.text:00408F66		       test    byte ptr	[f+0Ch], 40h
.text:00408F6A		       push    ebx
.text:00408F6B		       push    esi
.text:00408F6C		       mov     esi, pnumwritten	; pnumwritten
.text:00408F6E		       mov     ebx, string
.text:00408F70		       jz      short loc_408FA6
.text:00408F72		       cmp     dword ptr [f+8],	0
.text:00408F76		       jnz     short loc_408FA6
.text:00408F78		       mov     pnumwritten, [esp+8+len]
.text:00408F7C		       add     [esi], pnumwritten
.text:00408F7E		       jmp     short loc_408FAD
.text:00408F80 ; ---------------------------------------------------------------------------
.text:00408F80
.text:00408F80 loc_408F80:			       ; CODE XREF: write_string_0+45j
.text:00408F80		       mov     al, [ebx]       ; ch
.text:00408F82		       dec     [esp+8+len]
.text:00408F86		       mov     string, f       ; f
.text:00408F88		       call    write_char_0
.text:00408F8D		       inc     ebx
.text:00408F8E		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00408F91		       jnz     short loc_408FA6
.text:00408F93		       call    __errno
.text:00408F98		       cmp     dword ptr [pnumwritten],	2Ah
.text:00408F9B		       jnz     short loc_408FAD
.text:00408F9D		       mov     string, f       ; f
.text:00408F9F		       mov     al, 3Fh	       ; ch
.text:00408FA1		       call    write_char_0
.text:00408FA6
.text:00408FA6 loc_408FA6:			       ; CODE XREF: write_string_0+Aj
.text:00408FA6					       ; write_string_0+10j ...
.text:00408FA6		       cmp     [esp+8+len], 0
.text:00408FAB		       jg      short loc_408F80
.text:00408FAD
.text:00408FAD loc_408FAD:			       ; CODE XREF: write_string_0+18j
.text:00408FAD					       ; write_string_0+35j
.text:00408FAD		       pop     esi
.text:00408FAE		       pop     ebx
.text:00408FAF		       retn
.text:00408FAF write_string_0  endp
.text:00408FAF
.text:00408FB0
.text:00408FB0 ; =============== S U B R O U T I N E =======================================
.text:00408FB0
.text:00408FB0 ; Attributes: bp-based frame fpd=1F8h
.text:00408FB0
.text:00408FB0 ; int __cdecl _output_s_l(_iobuf	*stream, const char *format, localeinfo_struct *plocinfo, char *argptr)
.text:00408FB0 __output_s_l    proc near	       ; DATA XREF: __vprintf_s_l+Co
.text:00408FB0					       ; _vprintf_s+Ao	...
.text:00408FB0
.text:00408FB0 tmp	       = _CRT_DOUBLE ptr -278h
.text:00408FB0 retval	       = dword ptr -270h
.text:00408FB0 capexp	       = dword ptr -26Ch
.text:00408FB0 count	       = dword ptr -264h
.text:00408FB0 no_output       = dword ptr -260h
.text:00408FB0 hexadd	       = dword ptr -25Ch
.text:00408FB0 heapbuf	       = dword ptr -258h
.text:00408FB0 _loc_update     = _LocaleUpdate ptr -254h
.text:00408FB0 var_244	       = dword ptr -244h
.text:00408FB0 state	       = dword ptr -240h
.text:00408FB0 bufferiswide    = dword ptr -23Ch
.text:00408FB0 fldwidth	       = dword ptr -238h
.text:00408FB0 prefixlen       = dword ptr -234h
.text:00408FB0 prefix	       = byte ptr -230h
.text:00408FB0 charsout	       = dword ptr -22Ch
.text:00408FB0 f	       = dword ptr -228h
.text:00408FB0 var_224	       = dword ptr -224h
.text:00408FB0 radix	       = dword ptr -220h
.text:00408FB0 text	       = $12F061FBE778B92DEB8200A0ACF7A038 ptr -21Ch
.text:00408FB0 precision       = dword ptr -218h
.text:00408FB0 var_211	       = byte ptr -211h
.text:00408FB0 flags	       = dword ptr -210h
.text:00408FB0 buffer	       = $C8014B43F160BFD769FAE3F15553333C ptr -20Ch
.text:00408FB0 L_buffer	       = byte ptr -0Ch
.text:00408FB0 var_4	       = dword ptr -4
.text:00408FB0 stream	       = dword ptr  8
.text:00408FB0 format	       = dword ptr  0Ch
.text:00408FB0 plocinfo	       = dword ptr  10h
.text:00408FB0 argptr	       = dword ptr  14h
.text:00408FB0
.text:00408FB0		       push    ebp
.text:00408FB1		       lea     ebp, [esp-1F8h]
.text:00408FB8		       sub     esp, 278h
.text:00408FBE		       mov     eax, ___security_cookie
.text:00408FC3		       xor     eax, ebp
.text:00408FC5		       mov     [ebp+1F8h+var_4], eax
.text:00408FCB		       mov     eax, [ebp+1F8h+stream]
.text:00408FD1		       push    ebx
.text:00408FD2		       mov     ebx, [ebp+1F8h+format]
.text:00408FD8		       push    esi
.text:00408FD9		       xor     esi, esi
.text:00408FDB		       push    edi
.text:00408FDC		       mov     edi, [ebp+1F8h+argptr]
.text:00408FE2		       push    [ebp+1F8h+plocinfo] ; plocinfo
.text:00408FE8		       lea     ecx, [ebp+1F8h+_loc_update] ; this
.text:00408FEB		       mov     [ebp+1F8h+f], eax
.text:00408FEE		       mov     [ebp+1F8h+var_224], edi
.text:00408FF1		       mov     [ebp+1F8h+hexadd], esi
.text:00408FF4		       mov     [ebp+1F8h+flags], esi
.text:00408FF7		       mov     [ebp+1F8h+fldwidth], esi
.text:00408FFA		       mov     [ebp+1F8h+precision], esi
.text:00408FFD		       mov     [ebp+1F8h+prefixlen], esi
.text:00409000		       mov     [ebp+1F8h+no_output], esi
.text:00409003		       mov     [ebp+1F8h+bufferiswide],	esi
.text:00409006		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040900B		       cmp     [ebp+1F8h+f], esi
.text:0040900E		       jnz     short loc_40903D
.text:00409010
.text:00409010 loc_409010:			       ; CODE XREF: __output_s_l+E5j
.text:00409010					       ; __output_s_l+138j ...
.text:00409010		       call    __errno
.text:00409015		       push    esi	       ; pReserved
.text:00409016		       push    esi	       ; nLine
.text:00409017		       push    esi	       ; pszFile
.text:00409018		       push    esi	       ; pszFunction
.text:00409019		       mov     dword ptr [eax],	16h
.text:0040901F		       push    esi	       ; pszExpression
.text:00409020
.text:00409020 loc_409020:			       ; CODE XREF: __output_s_l+951j
.text:00409020		       call    __invalid_parameter
.text:00409025		       add     esp, 14h
.text:00409028		       cmp     [ebp+1F8h+_loc_update.updated], 0
.text:0040902C		       jz      short loc_409035
.text:0040902E		       mov     eax, [ebp+1F8h+_loc_update.ptd]
.text:00409031		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00409035
.text:00409035 loc_409035:			       ; CODE XREF: __output_s_l+7Cj
.text:00409035		       or      eax, 0FFFFFFFFh
.text:00409038		       jmp     loc_409927
.text:0040903D ; ---------------------------------------------------------------------------
.text:0040903D
.text:0040903D loc_40903D:			       ; CODE XREF: __output_s_l+5Ej
.text:0040903D		       mov     eax, [ebp+1F8h+f]
.text:00409040		       test    byte ptr	[eax+0Ch], 40h
.text:00409044		       jnz     loc_4090EE
.text:0040904A		       push    eax	       ; stream
.text:0040904B		       call    __fileno
.text:00409050		       cmp     eax, 0FFFFFFFFh
.text:00409053		       pop     ecx
.text:00409054		       jz      short loc_40908C
.text:00409056		       push    [ebp+1F8h+f]    ; stream
.text:00409059		       call    __fileno
.text:0040905E		       cmp     eax, 0FFFFFFFEh
.text:00409061		       pop     ecx
.text:00409062		       jz      short loc_40908C
.text:00409064		       push    [ebp+1F8h+f]    ; stream
.text:00409067		       call    __fileno
.text:0040906C		       push    [ebp+1F8h+f]    ; stream
.text:0040906F		       sar     eax, 5
.text:00409072		       lea     esi, ds:423F00h[eax*4]
.text:00409079		       call    __fileno
.text:0040907E		       and     eax, 1Fh
.text:00409081		       shl     eax, 6
.text:00409084		       add     eax, [esi]
.text:00409086		       pop     ecx
.text:00409087		       pop     ecx
.text:00409088		       xor     esi, esi
.text:0040908A		       jmp     short loc_409091
.text:0040908C ; ---------------------------------------------------------------------------
.text:0040908C
.text:0040908C loc_40908C:			       ; CODE XREF: __output_s_l+A4j
.text:0040908C					       ; __output_s_l+B2j
.text:0040908C		       mov     eax, offset ___badioinfo
.text:00409091
.text:00409091 loc_409091:			       ; CODE XREF: __output_s_l+DAj
.text:00409091		       test    byte ptr	[eax+24h], 7Fh
.text:00409095		       jnz     loc_409010
.text:0040909B		       push    [ebp+1F8h+f]    ; stream
.text:0040909E		       call    __fileno
.text:004090A3		       cmp     eax, 0FFFFFFFFh
.text:004090A6		       pop     ecx
.text:004090A7		       jz      short loc_4090DF
.text:004090A9		       push    [ebp+1F8h+f]    ; stream
.text:004090AC		       call    __fileno
.text:004090B1		       cmp     eax, 0FFFFFFFEh
.text:004090B4		       pop     ecx
.text:004090B5		       jz      short loc_4090DF
.text:004090B7		       push    [ebp+1F8h+f]    ; stream
.text:004090BA		       call    __fileno
.text:004090BF		       push    [ebp+1F8h+f]    ; stream
.text:004090C2		       sar     eax, 5
.text:004090C5		       lea     esi, ds:423F00h[eax*4]
.text:004090CC		       call    __fileno
.text:004090D1		       and     eax, 1Fh
.text:004090D4		       shl     eax, 6
.text:004090D7		       add     eax, [esi]
.text:004090D9		       pop     ecx
.text:004090DA		       pop     ecx
.text:004090DB		       xor     esi, esi
.text:004090DD		       jmp     short loc_4090E4
.text:004090DF ; ---------------------------------------------------------------------------
.text:004090DF
.text:004090DF loc_4090DF:			       ; CODE XREF: __output_s_l+F7j
.text:004090DF					       ; __output_s_l+105j
.text:004090DF		       mov     eax, offset ___badioinfo
.text:004090E4
.text:004090E4 loc_4090E4:			       ; CODE XREF: __output_s_l+12Dj
.text:004090E4		       test    byte ptr	[eax+24h], 80h
.text:004090E8		       jnz     loc_409010
.text:004090EE
.text:004090EE loc_4090EE:			       ; CODE XREF: __output_s_l+94j
.text:004090EE		       cmp     ebx, esi
.text:004090F0		       jz      loc_409010
.text:004090F6		       mov     dl, [ebx]
.text:004090F8		       test    dl, dl
.text:004090FA		       mov     [ebp+1F8h+charsout], esi
.text:004090FD		       mov     [ebp+1F8h+radix], esi
.text:00409100		       mov     [ebp+1F8h+state], esi
.text:00409103		       mov     [ebp+1F8h+heapbuf], esi
.text:00409106		       mov     [ebp+1F8h+var_211], dl
.text:00409109		       jz      loc_409917
.text:0040910F
.text:0040910F loc_40910F:			       ; CODE XREF: __output_s_l+93Aj
.text:0040910F		       inc     ebx
.text:00409110		       xor     eax, eax
.text:00409112		       cmp     [ebp+1F8h+charsout], eax
.text:00409115		       mov     [ebp+1F8h+var_244], ebx
.text:00409118		       jl      loc_409906
.text:0040911E		       mov     cl, dl
.text:00409120		       sub     cl, 20h
.text:00409123		       cmp     cl, 58h
.text:00409126		       ja      short loc_409135
.text:00409128		       movsx   eax, dl
.text:0040912B		       movzx   eax, byte ptr ds:control[eax] ; "_.,"
.text:00409132		       and     eax, 0Fh
.text:00409135
.text:00409135 loc_409135:			       ; CODE XREF: __output_s_l+176j
.text:00409135		       mov     ecx, [ebp+1F8h+state]
.text:00409138		       imul    eax, 9
.text:0040913B		       movzx   eax, ds:___lookuptable_s[eax+ecx]
.text:00409143		       push    8
.text:00409145		       shr     eax, 4
.text:00409148		       pop     esi
.text:00409149		       cmp     eax, esi
.text:0040914B		       mov     [ebp+1F8h+state], eax
.text:0040914E		       jz      loc_4098EF
.text:00409154		       push    7
.text:00409156		       pop     ecx
.text:00409157		       cmp     eax, ecx	       ; switch	8 cases
.text:00409159		       ja      loc_4098D9      ; default
.text:0040915F		       jmp     ds:off_409940[eax*4] ; switch jump
.text:00409166
.text:00409166 $LN131:				       ; DATA XREF: __output_s_l:off_409940o
.text:00409166		       xor     eax, eax	       ; jumptable 0040915F case 1
.text:00409168		       or      [ebp+1F8h+precision], 0FFFFFFFFh
.text:0040916C		       mov     [ebp+1F8h+capexp], eax
.text:0040916F		       mov     [ebp+1F8h+no_output], eax
.text:00409172		       mov     [ebp+1F8h+fldwidth], eax
.text:00409175		       mov     [ebp+1F8h+prefixlen], eax
.text:00409178		       mov     [ebp+1F8h+flags], eax
.text:0040917B		       mov     [ebp+1F8h+bufferiswide],	eax
.text:0040917E		       jmp     loc_4098D9      ; default
.text:00409183 ; ---------------------------------------------------------------------------
.text:00409183
.text:00409183 $LN130_0:			       ; CODE XREF: __output_s_l+1AFj
.text:00409183					       ; DATA XREF: __output_s_l:off_409940o
.text:00409183		       movsx   eax, dl	       ; jumptable 0040915F case 2
.text:00409186		       sub     eax, 20h
.text:00409189		       jz      short loc_4091C7
.text:0040918B		       sub     eax, 3
.text:0040918E		       jz      short loc_4091BB
.text:00409190		       sub     eax, esi
.text:00409192		       jz      short loc_4091B2
.text:00409194		       dec     eax
.text:00409195		       dec     eax
.text:00409196		       jz      short loc_4091A9
.text:00409198		       sub     eax, 3
.text:0040919B		       jnz     loc_4098D9      ; default
.text:004091A1		       or      [ebp+1F8h+flags], esi
.text:004091A4		       jmp     loc_4098D9      ; default
.text:004091A9 ; ---------------------------------------------------------------------------
.text:004091A9
.text:004091A9 loc_4091A9:			       ; CODE XREF: __output_s_l+1E6j
.text:004091A9		       or      [ebp+1F8h+flags], 4
.text:004091AD		       jmp     loc_4098D9      ; default
.text:004091B2 ; ---------------------------------------------------------------------------
.text:004091B2
.text:004091B2 loc_4091B2:			       ; CODE XREF: __output_s_l+1E2j
.text:004091B2		       or      [ebp+1F8h+flags], 1
.text:004091B6		       jmp     loc_4098D9      ; default
.text:004091BB ; ---------------------------------------------------------------------------
.text:004091BB
.text:004091BB loc_4091BB:			       ; CODE XREF: __output_s_l+1DEj
.text:004091BB		       or      [ebp+1F8h+flags], 80h
.text:004091C2		       jmp     loc_4098D9      ; default
.text:004091C7 ; ---------------------------------------------------------------------------
.text:004091C7
.text:004091C7 loc_4091C7:			       ; CODE XREF: __output_s_l+1D9j
.text:004091C7		       or      [ebp+1F8h+flags], 2
.text:004091CB		       jmp     loc_4098D9      ; default
.text:004091D0 ; ---------------------------------------------------------------------------
.text:004091D0
.text:004091D0 $LN122:				       ; CODE XREF: __output_s_l+1AFj
.text:004091D0					       ; DATA XREF: __output_s_l:off_409940o
.text:004091D0		       cmp     dl, 2Ah	       ; jumptable 0040915F case 3
.text:004091D3		       jnz     short loc_4091F5
.text:004091D5		       add     edi, 4
.text:004091D8		       mov     [ebp+1F8h+var_224], edi
.text:004091DB		       mov     edi, [edi-4]
.text:004091DE		       test    edi, edi
.text:004091E0		       mov     [ebp+1F8h+fldwidth], edi
.text:004091E3		       jge     loc_4098D9      ; default
.text:004091E9		       or      [ebp+1F8h+flags], 4
.text:004091ED		       neg     [ebp+1F8h+fldwidth]
.text:004091F0		       jmp     loc_4098D9      ; default
.text:004091F5 ; ---------------------------------------------------------------------------
.text:004091F5
.text:004091F5 loc_4091F5:			       ; CODE XREF: __output_s_l+223j
.text:004091F5		       mov     eax, [ebp+1F8h+fldwidth]
.text:004091F8		       imul    eax, 0Ah
.text:004091FB		       movsx   ecx, dl
.text:004091FE		       lea     eax, [eax+ecx-30h]
.text:00409202		       mov     [ebp+1F8h+fldwidth], eax
.text:00409205		       jmp     loc_4098D9      ; default
.text:0040920A ; ---------------------------------------------------------------------------
.text:0040920A
.text:0040920A $LN118:				       ; CODE XREF: __output_s_l+1AFj
.text:0040920A					       ; DATA XREF: __output_s_l:off_409940o
.text:0040920A		       and     [ebp+1F8h+precision], 0 ; jumptable 0040915F case 4
.text:0040920E		       jmp     loc_4098D9      ; default
.text:00409213 ; ---------------------------------------------------------------------------
.text:00409213
.text:00409213 $LN117_0:			       ; CODE XREF: __output_s_l+1AFj
.text:00409213					       ; DATA XREF: __output_s_l:off_409940o
.text:00409213		       cmp     dl, 2Ah	       ; jumptable 0040915F case 5
.text:00409216		       jnz     short loc_409235
.text:00409218		       add     edi, 4
.text:0040921B		       mov     [ebp+1F8h+var_224], edi
.text:0040921E		       mov     edi, [edi-4]
.text:00409221		       test    edi, edi
.text:00409223		       mov     [ebp+1F8h+precision], edi
.text:00409226		       jge     loc_4098D9      ; default
.text:0040922C		       or      [ebp+1F8h+precision], 0FFFFFFFFh
.text:00409230		       jmp     loc_4098D9      ; default
.text:00409235 ; ---------------------------------------------------------------------------
.text:00409235
.text:00409235 loc_409235:			       ; CODE XREF: __output_s_l+266j
.text:00409235		       mov     eax, [ebp+1F8h+precision]
.text:00409238		       imul    eax, 0Ah
.text:0040923B		       movsx   ecx, dl
.text:0040923E		       lea     eax, [eax+ecx-30h]
.text:00409242		       mov     [ebp+1F8h+precision], eax
.text:00409245		       jmp     loc_4098D9      ; default
.text:0040924A ; ---------------------------------------------------------------------------
.text:0040924A
.text:0040924A $LN113:				       ; CODE XREF: __output_s_l+1AFj
.text:0040924A					       ; DATA XREF: __output_s_l:off_409940o
.text:0040924A		       cmp     dl, 49h	       ; jumptable 0040915F case 6
.text:0040924D		       jz      short loc_409295
.text:0040924F		       cmp     dl, 68h
.text:00409252		       jz      short loc_40928C
.text:00409254		       cmp     dl, 6Ch
.text:00409257		       jz      short loc_40926E
.text:00409259		       cmp     dl, 77h
.text:0040925C		       jnz     loc_4098D9      ; default
.text:00409262		       or      [ebp+1F8h+flags], 800h
.text:00409269		       jmp     loc_4098D9      ; default
.text:0040926E ; ---------------------------------------------------------------------------
.text:0040926E
.text:0040926E loc_40926E:			       ; CODE XREF: __output_s_l+2A7j
.text:0040926E		       cmp     byte ptr	[ebx], 6Ch
.text:00409271		       jnz     short loc_409283
.text:00409273		       inc     ebx
.text:00409274		       or      [ebp+1F8h+flags], 1000h
.text:0040927B		       mov     [ebp+1F8h+var_244], ebx
.text:0040927E		       jmp     loc_4098D9      ; default
.text:00409283 ; ---------------------------------------------------------------------------
.text:00409283
.text:00409283 loc_409283:			       ; CODE XREF: __output_s_l+2C1j
.text:00409283		       or      [ebp+1F8h+flags], 10h
.text:00409287		       jmp     loc_4098D9      ; default
.text:0040928C ; ---------------------------------------------------------------------------
.text:0040928C
.text:0040928C loc_40928C:			       ; CODE XREF: __output_s_l+2A2j
.text:0040928C		       or      [ebp+1F8h+flags], 20h
.text:00409290		       jmp     loc_4098D9      ; default
.text:00409295 ; ---------------------------------------------------------------------------
.text:00409295
.text:00409295 loc_409295:			       ; CODE XREF: __output_s_l+29Dj
.text:00409295		       mov     al, [ebx]
.text:00409297		       cmp     al, 36h
.text:00409299		       jnz     short loc_4092B2
.text:0040929B		       cmp     byte ptr	[ebx+1], 34h
.text:0040929F		       jnz     short loc_4092B2
.text:004092A1		       inc     ebx
.text:004092A2		       inc     ebx
.text:004092A3		       or      [ebp+1F8h+flags], 8000h
.text:004092AA		       mov     [ebp+1F8h+var_244], ebx
.text:004092AD		       jmp     loc_4098D9      ; default
.text:004092B2 ; ---------------------------------------------------------------------------
.text:004092B2
.text:004092B2 loc_4092B2:			       ; CODE XREF: __output_s_l+2E9j
.text:004092B2					       ; __output_s_l+2EFj
.text:004092B2		       cmp     al, 33h
.text:004092B4		       jnz     short loc_4092CD
.text:004092B6		       cmp     byte ptr	[ebx+1], 32h
.text:004092BA		       jnz     short loc_4092CD
.text:004092BC		       inc     ebx
.text:004092BD		       inc     ebx
.text:004092BE		       and     [ebp+1F8h+flags], 0FFFF7FFFh
.text:004092C5		       mov     [ebp+1F8h+var_244], ebx
.text:004092C8		       jmp     loc_4098D9      ; default
.text:004092CD ; ---------------------------------------------------------------------------
.text:004092CD
.text:004092CD loc_4092CD:			       ; CODE XREF: __output_s_l+304j
.text:004092CD					       ; __output_s_l+30Aj
.text:004092CD		       cmp     al, 64h
.text:004092CF		       jz      loc_4098D9      ; default
.text:004092D5		       cmp     al, 69h
.text:004092D7		       jz      loc_4098D9      ; default
.text:004092DD		       cmp     al, 6Fh
.text:004092DF		       jz      loc_4098D9      ; default
.text:004092E5		       cmp     al, 75h
.text:004092E7		       jz      loc_4098D9      ; default
.text:004092ED		       cmp     al, 78h
.text:004092EF		       jz      loc_4098D9      ; default
.text:004092F5		       cmp     al, 58h
.text:004092F7		       jz      loc_4098D9      ; default
.text:004092FD		       and     [ebp+1F8h+state], 0
.text:00409301
.text:00409301 NORMAL_STATE_0:			       ; CODE XREF: __output_s_l+1AFj
.text:00409301					       ; DATA XREF: __output_s_l:off_409940o
.text:00409301		       and     [ebp+1F8h+bufferiswide],	0 ; jumptable 0040915F case 0
.text:00409305		       lea     eax, [ebp+1F8h+_loc_update] ; ch
.text:00409308		       push    eax	       ; plocinfo
.text:00409309		       movzx   eax, dl
.text:0040930C		       push    eax	       ; c
.text:0040930D		       call    __isleadbyte_l
.text:00409312		       pop     ecx
.text:00409313		       test    eax, eax
.text:00409315		       mov     al, [ebp+1F8h+var_211]
.text:00409318		       pop     ecx
.text:00409319		       jz      short loc_409334
.text:0040931B		       mov     ecx, [ebp+1F8h+f] ; f
.text:0040931E		       lea     esi, [ebp+1F8h+charsout]	; pnumwritten
.text:00409321		       call    write_char_0
.text:00409326		       mov     al, [ebx]       ; ch
.text:00409328		       inc     ebx
.text:00409329		       test    al, al
.text:0040932B		       mov     [ebp+1F8h+var_244], ebx
.text:0040932E		       jz      loc_4098EF
.text:00409334
.text:00409334 loc_409334:			       ; CODE XREF: __output_s_l+369j
.text:00409334		       mov     ecx, [ebp+1F8h+f] ; f
.text:00409337		       lea     esi, [ebp+1F8h+charsout]	; pnumwritten
.text:0040933A		       call    write_char_0
.text:0040933F		       jmp     loc_4098D9      ; default
.text:00409344 ; ---------------------------------------------------------------------------
.text:00409344
.text:00409344 $LN97:				       ; CODE XREF: __output_s_l+1AFj
.text:00409344					       ; DATA XREF: __output_s_l:off_409940o
.text:00409344		       movsx   eax, dl	       ; jumptable 0040915F case 7
.text:00409347		       cmp     eax, 64h
.text:0040934A		       jg      loc_4094C4
.text:00409350		       jz      loc_40953F
.text:00409356		       cmp     eax, 53h
.text:00409359		       jg      loc_40940B
.text:0040935F		       jz      short loc_4093BC
.text:00409361		       sub     eax, 41h
.text:00409364		       jz      short loc_409376
.text:00409366		       dec     eax
.text:00409367		       dec     eax
.text:00409368		       jz      short loc_4093AB
.text:0040936A		       dec     eax
.text:0040936B		       dec     eax
.text:0040936C		       jz      short loc_409376
.text:0040936E		       dec     eax
.text:0040936F		       dec     eax
.text:00409370		       jnz     loc_4097C1
.text:00409376
.text:00409376 loc_409376:			       ; CODE XREF: __output_s_l+3B4j
.text:00409376					       ; __output_s_l+3BCj
.text:00409376		       add     dl, 20h
.text:00409379		       mov     [ebp+1F8h+capexp], 1
.text:00409380		       mov     [ebp+1F8h+var_211], dl
.text:00409383
.text:00409383 loc_409383:			       ; CODE XREF: __output_s_l+46Aj
.text:00409383					       ; __output_s_l+52Fj
.text:00409383		       or      [ebp+1F8h+flags], 40h
.text:00409387		       cmp     [ebp+1F8h+precision], 0
.text:0040938B		       lea     ebx, [ebp+1F8h+buffer]
.text:0040938E		       mov     eax, 200h
.text:00409393		       mov     dword ptr [ebp+1F8h+text], ebx
.text:00409396		       mov     [ebp+1F8h+count], eax
.text:00409399		       jge     loc_409563
.text:0040939F		       mov     [ebp+1F8h+precision], 6
.text:004093A6		       jmp     loc_4095B2
.text:004093AB ; ---------------------------------------------------------------------------
.text:004093AB
.text:004093AB loc_4093AB:			       ; CODE XREF: __output_s_l+3B8j
.text:004093AB		       test    word ptr	[ebp+1F8h+flags], 830h
.text:004093B1		       jnz     short loc_409428
.text:004093B3		       or      [ebp+1F8h+flags], 800h
.text:004093BA		       jmp     short loc_409428
.text:004093BC ; ---------------------------------------------------------------------------
.text:004093BC
.text:004093BC loc_4093BC:			       ; CODE XREF: __output_s_l+3AFj
.text:004093BC		       test    word ptr	[ebp+1F8h+flags], 830h
.text:004093C2		       jnz     short loc_4093CB
.text:004093C4		       or      [ebp+1F8h+flags], 800h
.text:004093CB
.text:004093CB loc_4093CB:			       ; CODE XREF: __output_s_l+412j
.text:004093CB					       ; __output_s_l+6A0j
.text:004093CB		       mov     ecx, [ebp+1F8h+precision]
.text:004093CE		       cmp     ecx, 0FFFFFFFFh
.text:004093D1		       jnz     short loc_4093D8
.text:004093D3		       mov     ecx, 7FFFFFFFh
.text:004093D8
.text:004093D8 loc_4093D8:			       ; CODE XREF: __output_s_l+421j
.text:004093D8		       add     edi, 4
.text:004093DB		       test    word ptr	[ebp+1F8h+flags], 810h
.text:004093E1		       mov     [ebp+1F8h+var_224], edi
.text:004093E4		       mov     edi, [edi-4]
.text:004093E7		       mov     dword ptr [ebp+1F8h+text], edi
.text:004093EA		       jz      loc_40979F
.text:004093F0		       test    edi, edi
.text:004093F2		       jnz     short loc_4093FC
.text:004093F4		       mov     eax, ___wnullstring
.text:004093F9		       mov     dword ptr [ebp+1F8h+text], eax
.text:004093FC
.text:004093FC loc_4093FC:			       ; CODE XREF: __output_s_l+442j
.text:004093FC		       mov     eax, dword ptr [ebp+1F8h+text]
.text:004093FF		       mov     [ebp+1F8h+bufferiswide],	1
.text:00409406		       jmp     loc_409794
.text:0040940B ; ---------------------------------------------------------------------------
.text:0040940B
.text:0040940B loc_40940B:			       ; CODE XREF: __output_s_l+3A9j
.text:0040940B		       sub     eax, 58h
.text:0040940E		       jz      loc_409648
.text:00409414		       dec     eax
.text:00409415		       dec     eax
.text:00409416		       jz      short loc_409475
.text:00409418		       sub     eax, ecx
.text:0040941A		       jz      loc_409383
.text:00409420		       dec     eax
.text:00409421		       dec     eax
.text:00409422		       jnz     loc_4097C1
.text:00409428
.text:00409428 loc_409428:			       ; CODE XREF: __output_s_l+401j
.text:00409428					       ; __output_s_l+40Aj
.text:00409428		       add     edi, 4
.text:0040942B		       test    word ptr	[ebp+1F8h+flags], 810h
.text:00409431		       mov     [ebp+1F8h+var_224], edi
.text:00409434		       jz      short loc_40945D
.text:00409436		       movzx   eax, word ptr [edi-4]
.text:0040943A		       push    eax	       ; wchar
.text:0040943B		       push    200h	       ; sizeInBytes
.text:00409440		       lea     eax, [ebp+1F8h+buffer]
.text:00409443		       push    eax	       ; dst
.text:00409444		       lea     eax, [ebp+1F8h+radix]
.text:00409447		       push    eax	       ; pRetValue
.text:00409448		       call    _wctomb_s
.text:0040944D		       add     esp, 10h
.text:00409450		       test    eax, eax
.text:00409452		       jz      short loc_40946A
.text:00409454		       mov     [ebp+1F8h+no_output], 1
.text:0040945B		       jmp     short loc_40946A
.text:0040945D ; ---------------------------------------------------------------------------
.text:0040945D
.text:0040945D loc_40945D:			       ; CODE XREF: __output_s_l+484j
.text:0040945D		       mov     al, [edi-4]
.text:00409460		       mov     byte ptr	[ebp+1F8h+buffer], al
.text:00409463		       mov     [ebp+1F8h+radix], 1
.text:0040946A
.text:0040946A loc_40946A:			       ; CODE XREF: __output_s_l+4A2j
.text:0040946A					       ; __output_s_l+4ABj
.text:0040946A		       lea     eax, [ebp+1F8h+buffer]
.text:0040946D		       mov     dword ptr [ebp+1F8h+text], eax
.text:00409470		       jmp     loc_4097C1
.text:00409475 ; ---------------------------------------------------------------------------
.text:00409475
.text:00409475 loc_409475:			       ; CODE XREF: __output_s_l+466j
.text:00409475		       mov     eax, [edi]
.text:00409477		       add     edi, 4
.text:0040947A		       test    eax, eax
.text:0040947C		       mov     [ebp+1F8h+var_224], edi
.text:0040947F		       jz      short loc_4094B0
.text:00409481		       mov     ecx, [eax+4]
.text:00409484		       test    ecx, ecx
.text:00409486		       jz      short loc_4094B0
.text:00409488		       test    word ptr	[ebp+1F8h+flags], 800h
.text:0040948E		       movsx   eax, word ptr [eax]
.text:00409491		       mov     dword ptr [ebp+1F8h+text], ecx
.text:00409494		       jz      short loc_4094A7
.text:00409496		       cdq
.text:00409497		       sub     eax, edx
.text:00409499		       sar     eax, 1
.text:0040949B		       mov     [ebp+1F8h+bufferiswide],	1
.text:004094A2		       jmp     loc_4097BE
.text:004094A7 ; ---------------------------------------------------------------------------
.text:004094A7
.text:004094A7 loc_4094A7:			       ; CODE XREF: __output_s_l+4E4j
.text:004094A7		       and     [ebp+1F8h+bufferiswide],	0
.text:004094AB		       jmp     loc_4097BE
.text:004094B0 ; ---------------------------------------------------------------------------
.text:004094B0
.text:004094B0 loc_4094B0:			       ; CODE XREF: __output_s_l+4CFj
.text:004094B0					       ; __output_s_l+4D6j
.text:004094B0		       mov     eax, ___nullstring
.text:004094B5		       mov     dword ptr [ebp+1F8h+text], eax
.text:004094B8		       push    eax	       ; buf
.text:004094B9
.text:004094B9 loc_4094B9:			       ; CODE XREF: __output_s_l+690j
.text:004094B9		       call    _strlen
.text:004094BE		       pop     ecx
.text:004094BF		       jmp     loc_4097BE
.text:004094C4 ; ---------------------------------------------------------------------------
.text:004094C4
.text:004094C4 loc_4094C4:			       ; CODE XREF: __output_s_l+39Aj
.text:004094C4		       cmp     eax, 70h
.text:004094C7		       jg      loc_40964D
.text:004094CD		       jz      loc_409645
.text:004094D3		       cmp     eax, 65h
.text:004094D6		       jl      loc_4097C1
.text:004094DC		       cmp     eax, 67h
.text:004094DF		       jle     loc_409383
.text:004094E5		       cmp     eax, 69h
.text:004094E8		       jz      short loc_40953F
.text:004094EA		       cmp     eax, 6Eh
.text:004094ED		       jz      short loc_40950A
.text:004094EF		       cmp     eax, 6Fh
.text:004094F2		       jnz     loc_4097C1
.text:004094F8		       test    byte ptr	[ebp+1F8h+flags], 80h
.text:004094FC		       mov     [ebp+1F8h+radix], esi
.text:004094FF		       jz      short COMMON_INT_0
.text:00409501		       or      [ebp+1F8h+flags], 200h
.text:00409508		       jmp     short COMMON_INT_0
.text:0040950A ; ---------------------------------------------------------------------------
.text:0040950A
.text:0040950A loc_40950A:			       ; CODE XREF: __output_s_l+53Dj
.text:0040950A		       mov     esi, [edi]
.text:0040950C		       add     edi, 4
.text:0040950F		       mov     [ebp+1F8h+var_224], edi
.text:00409512		       call    __get_printf_count_output
.text:00409517		       test    eax, eax
.text:00409519		       jz      loc_4098EF
.text:0040951F		       test    byte ptr	[ebp+1F8h+flags], 20h
.text:00409523		       jz      short loc_40952E
.text:00409525		       mov     ax, word	ptr [ebp+1F8h+charsout]
.text:00409529		       mov     [esi], ax
.text:0040952C		       jmp     short loc_409533
.text:0040952E ; ---------------------------------------------------------------------------
.text:0040952E
.text:0040952E loc_40952E:			       ; CODE XREF: __output_s_l+573j
.text:0040952E		       mov     eax, [ebp+1F8h+charsout]
.text:00409531		       mov     [esi], eax
.text:00409533
.text:00409533 loc_409533:			       ; CODE XREF: __output_s_l+57Cj
.text:00409533		       mov     [ebp+1F8h+no_output], 1
.text:0040953A		       jmp     loc_4098C6
.text:0040953F ; ---------------------------------------------------------------------------
.text:0040953F
.text:0040953F loc_40953F:			       ; CODE XREF: __output_s_l+3A0j
.text:0040953F					       ; __output_s_l+538j
.text:0040953F		       or      [ebp+1F8h+flags], 40h
.text:00409543
.text:00409543 loc_409543:			       ; CODE XREF: __output_s_l+6A8j
.text:00409543		       mov     [ebp+1F8h+radix], 0Ah
.text:0040954A
.text:0040954A COMMON_INT_0:			       ; CODE XREF: __output_s_l+54Fj
.text:0040954A					       ; __output_s_l+558j ...
.text:0040954A		       mov     ecx, [ebp+1F8h+flags]
.text:0040954D		       test    cx, cx
.text:00409550		       jns     loc_409697
.text:00409556
.text:00409556 loc_409556:			       ; CODE XREF: __output_s_l+6ECj
.text:00409556		       add     edi, esi
.text:00409558		       mov     eax, [edi-8]
.text:0040955B		       mov     edx, [edi-4]
.text:0040955E		       jmp     loc_4096CC
.text:00409563 ; ---------------------------------------------------------------------------
.text:00409563
.text:00409563 loc_409563:			       ; CODE XREF: __output_s_l+3E9j
.text:00409563		       jnz     short loc_409573
.text:00409565		       cmp     dl, 67h
.text:00409568		       jnz     short loc_4095B2
.text:0040956A		       mov     [ebp+1F8h+precision], 1
.text:00409571		       jmp     short loc_4095B2
.text:00409573 ; ---------------------------------------------------------------------------
.text:00409573
.text:00409573 loc_409573:			       ; CODE XREF: __output_s_l:loc_409563j
.text:00409573		       cmp     [ebp+1F8h+precision], eax
.text:00409576		       jle     short loc_40957B
.text:00409578		       mov     [ebp+1F8h+precision], eax
.text:0040957B
.text:0040957B loc_40957B:			       ; CODE XREF: __output_s_l+5C6j
.text:0040957B		       cmp     [ebp+1F8h+precision], 0A3h
.text:00409582		       jle     short loc_4095B2
.text:00409584		       mov     esi, [ebp+1F8h+precision]
.text:00409587		       add     esi, 15Dh
.text:0040958D		       push    esi	       ; cb
.text:0040958E		       call    __malloc_crt
.text:00409593		       test    eax, eax
.text:00409595		       mov     dl, [ebp+1F8h+var_211]
.text:00409598		       pop     ecx
.text:00409599		       mov     [ebp+1F8h+heapbuf], eax
.text:0040959C		       push    8
.text:0040959E		       jz      short loc_4095AA
.text:004095A0		       mov     dword ptr [ebp+1F8h+text], eax
.text:004095A3		       mov     [ebp+1F8h+count], esi
.text:004095A6		       mov     ebx, eax
.text:004095A8		       jmp     short loc_4095B1
.text:004095AA ; ---------------------------------------------------------------------------
.text:004095AA
.text:004095AA loc_4095AA:			       ; CODE XREF: __output_s_l+5EEj
.text:004095AA		       mov     [ebp+1F8h+precision], 0A3h
.text:004095B1
.text:004095B1 loc_4095B1:			       ; CODE XREF: __output_s_l+5F8j
.text:004095B1		       pop     esi
.text:004095B2
.text:004095B2 loc_4095B2:			       ; CODE XREF: __output_s_l+3F6j
.text:004095B2					       ; __output_s_l+5B8j ...
.text:004095B2		       add     edi, esi
.text:004095B4		       mov     eax, [edi-8]
.text:004095B7		       mov     dword ptr [ebp+1F8h+tmp.x], eax
.text:004095BA		       mov     eax, [edi-4]
.text:004095BD		       mov     dword ptr [ebp+1F8h+tmp.x+4], eax
.text:004095C0		       lea     eax, [ebp+1F8h+_loc_update]
.text:004095C3		       push    eax
.text:004095C4		       push    [ebp+1F8h+capexp]
.text:004095C7		       movsx   eax, dl
.text:004095CA		       push    [ebp+1F8h+precision]
.text:004095CD		       mov     [ebp+1F8h+var_224], edi
.text:004095D0		       push    eax
.text:004095D1		       push    [ebp+1F8h+count]
.text:004095D4		       lea     eax, [ebp+1F8h+tmp]
.text:004095D7		       push    ebx
.text:004095D8		       push    eax
.text:004095D9		       push    codedptr	       ; codedptr
.text:004095DF		       call    __decode_pointer
.text:004095E4		       pop     ecx
.text:004095E5		       call    eax
.text:004095E7		       mov     edi, [ebp+1F8h+flags]
.text:004095EA		       add     esp, 1Ch
.text:004095ED		       and     edi, 80h
.text:004095F3		       jz      short loc_409610
.text:004095F5		       cmp     [ebp+1F8h+precision], 0
.text:004095F9		       jnz     short loc_409610
.text:004095FB		       lea     eax, [ebp+1F8h+_loc_update]
.text:004095FE		       push    eax
.text:004095FF		       push    ebx
.text:00409600		       push    off_422694      ; codedptr
.text:00409606		       call    __decode_pointer
.text:0040960B		       pop     ecx
.text:0040960C		       call    eax
.text:0040960E		       pop     ecx
.text:0040960F		       pop     ecx
.text:00409610
.text:00409610 loc_409610:			       ; CODE XREF: __output_s_l+643j
.text:00409610					       ; __output_s_l+649j
.text:00409610		       cmp     [ebp+1F8h+var_211], 67h
.text:00409614		       jnz     short loc_40962F
.text:00409616		       test    edi, edi
.text:00409618		       jnz     short loc_40962F
.text:0040961A		       lea     eax, [ebp+1F8h+_loc_update]
.text:0040961D		       push    eax
.text:0040961E		       push    ebx
.text:0040961F		       push    off_422690      ; codedptr
.text:00409625		       call    __decode_pointer
.text:0040962A		       pop     ecx
.text:0040962B		       call    eax
.text:0040962D		       pop     ecx
.text:0040962E		       pop     ecx
.text:0040962F
.text:0040962F loc_40962F:			       ; CODE XREF: __output_s_l+664j
.text:0040962F					       ; __output_s_l+668j
.text:0040962F		       cmp     byte ptr	[ebx], 2Dh
.text:00409632		       jnz     short loc_40963F
.text:00409634		       or      [ebp+1F8h+flags], 100h
.text:0040963B		       inc     ebx
.text:0040963C		       mov     dword ptr [ebp+1F8h+text], ebx
.text:0040963F
.text:0040963F loc_40963F:			       ; CODE XREF: __output_s_l+682j
.text:0040963F		       push    ebx
.text:00409640		       jmp     loc_4094B9
.text:00409645 ; ---------------------------------------------------------------------------
.text:00409645
.text:00409645 loc_409645:			       ; CODE XREF: __output_s_l+51Dj
.text:00409645		       mov     [ebp+1F8h+precision], esi
.text:00409648
.text:00409648 loc_409648:			       ; CODE XREF: __output_s_l+45Ej
.text:00409648		       mov     [ebp+1F8h+hexadd], ecx
.text:0040964B		       jmp     short COMMON_HEX_0
.text:0040964D ; ---------------------------------------------------------------------------
.text:0040964D
.text:0040964D loc_40964D:			       ; CODE XREF: __output_s_l+517j
.text:0040964D		       sub     eax, 73h
.text:00409650		       jz      loc_4093CB
.text:00409656		       dec     eax
.text:00409657		       dec     eax
.text:00409658		       jz      loc_409543
.text:0040965E		       sub     eax, 3
.text:00409661		       jnz     loc_4097C1
.text:00409667		       mov     [ebp+1F8h+hexadd], 27h
.text:0040966E
.text:0040966E COMMON_HEX_0:			       ; CODE XREF: __output_s_l+69Bj
.text:0040966E		       test    byte ptr	[ebp+1F8h+flags], 80h
.text:00409672		       mov     [ebp+1F8h+radix], 10h
.text:00409679		       jz      COMMON_INT_0
.text:0040967F		       mov     al, byte	ptr [ebp+1F8h+hexadd]
.text:00409682		       add     al, 51h
.text:00409684		       mov     [ebp+1F8h+prefix], 30h
.text:00409688		       mov     [ebp+1F8h+prefix+1], al
.text:0040968B		       mov     [ebp+1F8h+prefixlen], 2
.text:00409692		       jmp     COMMON_INT_0
.text:00409697 ; ---------------------------------------------------------------------------
.text:00409697
.text:00409697 loc_409697:			       ; CODE XREF: __output_s_l+5A0j
.text:00409697		       test    cx, 1000h
.text:0040969C		       jnz     loc_409556
.text:004096A2		       add     edi, 4
.text:004096A5		       test    cl, 20h
.text:004096A8		       jz      short loc_4096BF
.text:004096AA		       test    cl, 40h
.text:004096AD		       mov     [ebp+1F8h+var_224], edi
.text:004096B0		       jz      short loc_4096B8
.text:004096B2		       movsx   eax, word ptr [edi-4]
.text:004096B6		       jmp     short loc_4096BC
.text:004096B8 ; ---------------------------------------------------------------------------
.text:004096B8
.text:004096B8 loc_4096B8:			       ; CODE XREF: __output_s_l+700j
.text:004096B8		       movzx   eax, word ptr [edi-4]
.text:004096BC
.text:004096BC loc_4096BC:			       ; CODE XREF: __output_s_l+706j
.text:004096BC		       cdq
.text:004096BD		       jmp     short loc_4096CF
.text:004096BF ; ---------------------------------------------------------------------------
.text:004096BF
.text:004096BF loc_4096BF:			       ; CODE XREF: __output_s_l+6F8j
.text:004096BF		       test    cl, 40h
.text:004096C2		       mov     eax, [edi-4]
.text:004096C5		       jz      short loc_4096CA
.text:004096C7		       cdq
.text:004096C8		       jmp     short loc_4096CC
.text:004096CA ; ---------------------------------------------------------------------------
.text:004096CA
.text:004096CA loc_4096CA:			       ; CODE XREF: __output_s_l+715j
.text:004096CA		       xor     edx, edx
.text:004096CC
.text:004096CC loc_4096CC:			       ; CODE XREF: __output_s_l+5AEj
.text:004096CC					       ; __output_s_l+718j
.text:004096CC		       mov     [ebp+1F8h+var_224], edi
.text:004096CF
.text:004096CF loc_4096CF:			       ; CODE XREF: __output_s_l+70Dj
.text:004096CF		       test    cl, 40h
.text:004096D2		       jz      short loc_4096EC
.text:004096D4		       test    edx, edx
.text:004096D6		       jg      short loc_4096EC
.text:004096D8		       jl      short loc_4096DE
.text:004096DA		       test    eax, eax
.text:004096DC		       jnb     short loc_4096EC
.text:004096DE
.text:004096DE loc_4096DE:			       ; CODE XREF: __output_s_l+728j
.text:004096DE		       neg     eax
.text:004096E0		       adc     edx, 0
.text:004096E3		       neg     edx
.text:004096E5		       or      [ebp+1F8h+flags], 100h
.text:004096EC
.text:004096EC loc_4096EC:			       ; CODE XREF: __output_s_l+722j
.text:004096EC					       ; __output_s_l+726j ...
.text:004096EC		       test    word ptr	[ebp+1F8h+flags], 9000h
.text:004096F2		       mov     ebx, edx
.text:004096F4		       mov     edi, eax
.text:004096F6		       jnz     short loc_4096FA
.text:004096F8		       xor     ebx, ebx
.text:004096FA
.text:004096FA loc_4096FA:			       ; CODE XREF: __output_s_l+746j
.text:004096FA		       cmp     [ebp+1F8h+precision], 0
.text:004096FE		       jge     short loc_409709
.text:00409700		       mov     [ebp+1F8h+precision], 1
.text:00409707		       jmp     short loc_40971A
.text:00409709 ; ---------------------------------------------------------------------------
.text:00409709
.text:00409709 loc_409709:			       ; CODE XREF: __output_s_l+74Ej
.text:00409709		       and     [ebp+1F8h+flags], 0FFFFFFF7h
.text:0040970D		       mov     eax, 200h
.text:00409712		       cmp     [ebp+1F8h+precision], eax
.text:00409715		       jle     short loc_40971A
.text:00409717		       mov     [ebp+1F8h+precision], eax
.text:0040971A
.text:0040971A loc_40971A:			       ; CODE XREF: __output_s_l+757j
.text:0040971A					       ; __output_s_l+765j
.text:0040971A		       mov     eax, edi
.text:0040971C		       or      eax, ebx
.text:0040971E		       jnz     short loc_409723
.text:00409720		       and     [ebp+1F8h+prefixlen], eax
.text:00409723
.text:00409723 loc_409723:			       ; CODE XREF: __output_s_l+76Ej
.text:00409723		       lea     esi, [ebp+1F8h+buffer+1FFh]
.text:00409729
.text:00409729 loc_409729:			       ; CODE XREF: __output_s_l+7ABj
.text:00409729		       mov     eax, [ebp+1F8h+precision]
.text:0040972C		       dec     [ebp+1F8h+precision]
.text:0040972F		       test    eax, eax
.text:00409731		       jg      short loc_409739
.text:00409733		       mov     eax, edi
.text:00409735		       or      eax, ebx
.text:00409737		       jz      short loc_40975D
.text:00409739
.text:00409739 loc_409739:			       ; CODE XREF: __output_s_l+781j
.text:00409739		       mov     eax, [ebp+1F8h+radix]
.text:0040973C		       cdq
.text:0040973D		       push    edx
.text:0040973E		       push    eax
.text:0040973F		       push    ebx
.text:00409740		       push    edi
.text:00409741		       call    __aulldvrm
.text:00409746		       add     ecx, 30h
.text:00409749		       cmp     ecx, 39h
.text:0040974C		       mov     [ebp+1F8h+count], ebx
.text:0040974F		       mov     edi, eax	       ; f
.text:00409751		       mov     ebx, edx
.text:00409753		       jle     short loc_409758
.text:00409755		       add     ecx, [ebp+1F8h+hexadd]
.text:00409758
.text:00409758 loc_409758:			       ; CODE XREF: __output_s_l+7A3j
.text:00409758		       mov     [esi], cl
.text:0040975A		       dec     esi
.text:0040975B		       jmp     short loc_409729
.text:0040975D ; ---------------------------------------------------------------------------
.text:0040975D
.text:0040975D loc_40975D:			       ; CODE XREF: __output_s_l+787j
.text:0040975D		       lea     eax, [ebp+1F8h+buffer+1FFh]
.text:00409763		       sub     eax, esi
.text:00409765		       inc     esi
.text:00409766		       test    word ptr	[ebp+1F8h+flags], 200h
.text:0040976C		       mov     [ebp+1F8h+radix], eax
.text:0040976F		       mov     dword ptr [ebp+1F8h+text], esi
.text:00409772		       jz      short loc_4097C1
.text:00409774		       test    eax, eax
.text:00409776		       jz      short loc_40977F
.text:00409778		       mov     ecx, esi
.text:0040977A		       cmp     byte ptr	[ecx], 30h
.text:0040977D		       jz      short loc_4097C1
.text:0040977F
.text:0040977F loc_40977F:			       ; CODE XREF: __output_s_l+7C6j
.text:0040977F		       dec     dword ptr [ebp+1F8h+text]
.text:00409782		       mov     ecx, dword ptr [ebp+1F8h+text]
.text:00409785		       mov     byte ptr	[ecx], 30h
.text:00409788		       inc     eax
.text:00409789		       jmp     short loc_4097BE
.text:0040978B ; ---------------------------------------------------------------------------
.text:0040978B
.text:0040978B loc_40978B:			       ; CODE XREF: __output_s_l+7E6j
.text:0040978B		       dec     ecx
.text:0040978C		       cmp     word ptr	[eax], 0
.text:00409790		       jz      short loc_409798
.text:00409792		       inc     eax
.text:00409793		       inc     eax
.text:00409794
.text:00409794 loc_409794:			       ; CODE XREF: __output_s_l+456j
.text:00409794		       test    ecx, ecx
.text:00409796		       jnz     short loc_40978B
.text:00409798
.text:00409798 loc_409798:			       ; CODE XREF: __output_s_l+7E0j
.text:00409798		       sub     eax, dword ptr [ebp+1F8h+text]
.text:0040979B		       sar     eax, 1
.text:0040979D		       jmp     short loc_4097BE
.text:0040979F ; ---------------------------------------------------------------------------
.text:0040979F
.text:0040979F loc_40979F:			       ; CODE XREF: __output_s_l+43Aj
.text:0040979F		       test    edi, edi
.text:004097A1		       jnz     short loc_4097AB
.text:004097A3		       mov     eax, ___nullstring
.text:004097A8		       mov     dword ptr [ebp+1F8h+text], eax
.text:004097AB
.text:004097AB loc_4097AB:			       ; CODE XREF: __output_s_l+7F1j
.text:004097AB		       mov     eax, dword ptr [ebp+1F8h+text]
.text:004097AE		       jmp     short loc_4097B7
.text:004097B0 ; ---------------------------------------------------------------------------
.text:004097B0
.text:004097B0 loc_4097B0:			       ; CODE XREF: __output_s_l+809j
.text:004097B0		       dec     ecx
.text:004097B1		       cmp     byte ptr	[eax], 0
.text:004097B4		       jz      short loc_4097BB
.text:004097B6		       inc     eax
.text:004097B7
.text:004097B7 loc_4097B7:			       ; CODE XREF: __output_s_l+7FEj
.text:004097B7		       test    ecx, ecx
.text:004097B9		       jnz     short loc_4097B0
.text:004097BB
.text:004097BB loc_4097BB:			       ; CODE XREF: __output_s_l+804j
.text:004097BB		       sub     eax, dword ptr [ebp+1F8h+text]
.text:004097BE
.text:004097BE loc_4097BE:			       ; CODE XREF: __output_s_l+4F2j
.text:004097BE					       ; __output_s_l+4FBj ...
.text:004097BE		       mov     [ebp+1F8h+radix], eax
.text:004097C1
.text:004097C1 loc_4097C1:			       ; CODE XREF: __output_s_l+3C0j
.text:004097C1					       ; __output_s_l+472j ...
.text:004097C1		       cmp     [ebp+1F8h+no_output], 0
.text:004097C5		       jnz     loc_4098C6
.text:004097CB		       mov     eax, [ebp+1F8h+flags]
.text:004097CE		       test    al, 40h
.text:004097D0		       jz      short loc_4097F7
.text:004097D2		       test    ax, 100h
.text:004097D6		       jz      short loc_4097DE
.text:004097D8		       mov     [ebp+1F8h+prefix], 2Dh
.text:004097DC		       jmp     short loc_4097F0
.text:004097DE ; ---------------------------------------------------------------------------
.text:004097DE
.text:004097DE loc_4097DE:			       ; CODE XREF: __output_s_l+826j
.text:004097DE		       test    al, 1
.text:004097E0		       jz      short loc_4097E8
.text:004097E2		       mov     [ebp+1F8h+prefix], 2Bh
.text:004097E6		       jmp     short loc_4097F0
.text:004097E8 ; ---------------------------------------------------------------------------
.text:004097E8
.text:004097E8 loc_4097E8:			       ; CODE XREF: __output_s_l+830j
.text:004097E8		       test    al, 2
.text:004097EA		       jz      short loc_4097F7
.text:004097EC		       mov     [ebp+1F8h+prefix], 20h
.text:004097F0
.text:004097F0 loc_4097F0:			       ; CODE XREF: __output_s_l+82Cj
.text:004097F0					       ; __output_s_l+836j
.text:004097F0		       mov     [ebp+1F8h+prefixlen], 1
.text:004097F7
.text:004097F7 loc_4097F7:			       ; CODE XREF: __output_s_l+820j
.text:004097F7					       ; __output_s_l+83Aj
.text:004097F7		       mov     ebx, [ebp+1F8h+fldwidth]
.text:004097FA		       sub     ebx, [ebp+1F8h+radix]
.text:004097FD		       sub     ebx, [ebp+1F8h+prefixlen]
.text:00409800		       test    byte ptr	[ebp+1F8h+flags], 0Ch
.text:00409804		       jnz     short loc_409817
.text:00409806		       push    [ebp+1F8h+f]    ; f
.text:00409809		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:0040980C		       push    ebx	       ; num
.text:0040980D		       push    20h	       ; ch
.text:0040980F		       call    write_multi_char_0
.text:00409814		       add     esp, 0Ch
.text:00409817
.text:00409817 loc_409817:			       ; CODE XREF: __output_s_l+854j
.text:00409817		       push    [ebp+1F8h+prefixlen] ; len
.text:0040981A		       mov     edi, [ebp+1F8h+f] ; f
.text:0040981D		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00409820		       lea     ecx, [ebp+1F8h+prefix] ;	string
.text:00409823		       call    write_string_0
.text:00409828		       test    byte ptr	[ebp+1F8h+flags], 8
.text:0040982C		       pop     ecx
.text:0040982D		       jz      short loc_409844
.text:0040982F		       test    byte ptr	[ebp+1F8h+flags], 4
.text:00409833		       jnz     short loc_409844
.text:00409835		       push    edi	       ; f
.text:00409836		       push    ebx	       ; num
.text:00409837		       push    30h	       ; ch
.text:00409839		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:0040983C		       call    write_multi_char_0
.text:00409841		       add     esp, 0Ch
.text:00409844
.text:00409844 loc_409844:			       ; CODE XREF: __output_s_l+87Dj
.text:00409844					       ; __output_s_l+883j
.text:00409844		       cmp     [ebp+1F8h+bufferiswide],	0
.text:00409848		       mov     eax, [ebp+1F8h+radix]
.text:0040984B		       jz      short loc_40989E
.text:0040984D		       test    eax, eax
.text:0040984F		       jle     short loc_40989E
.text:00409851		       mov     esi, dword ptr [ebp+1F8h+text]
.text:00409854		       mov     [ebp+1F8h+count], eax
.text:00409857
.text:00409857 loc_409857:			       ; CODE XREF: __output_s_l+8E4j
.text:00409857		       movzx   eax, word ptr [esi]
.text:0040985A		       dec     [ebp+1F8h+count]
.text:0040985D		       push    eax	       ; wchar
.text:0040985E		       push    6	       ; sizeInBytes
.text:00409860		       lea     eax, [ebp+1F8h+L_buffer]
.text:00409866		       push    eax	       ; dst
.text:00409867		       lea     eax, [ebp+1F8h+retval]
.text:0040986A		       inc     esi
.text:0040986B		       push    eax	       ; pRetValue
.text:0040986C		       inc     esi
.text:0040986D		       call    _wctomb_s
.text:00409872		       add     esp, 10h
.text:00409875		       test    eax, eax
.text:00409877		       jnz     short loc_409898
.text:00409879		       cmp     [ebp+1F8h+retval], eax
.text:0040987C		       jz      short loc_409898
.text:0040987E		       push    [ebp+1F8h+retval] ; len
.text:00409881		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:00409884		       lea     ecx, [ebp+1F8h+L_buffer]	; string
.text:0040988A		       call    write_string_0
.text:0040988F		       cmp     [ebp+1F8h+count], 0
.text:00409893		       pop     ecx
.text:00409894		       jnz     short loc_409857
.text:00409896		       jmp     short loc_4098AB
.text:00409898 ; ---------------------------------------------------------------------------
.text:00409898
.text:00409898 loc_409898:			       ; CODE XREF: __output_s_l+8C7j
.text:00409898					       ; __output_s_l+8CCj
.text:00409898		       or      [ebp+1F8h+charsout], 0FFFFFFFFh
.text:0040989C		       jmp     short loc_4098AB
.text:0040989E ; ---------------------------------------------------------------------------
.text:0040989E
.text:0040989E loc_40989E:			       ; CODE XREF: __output_s_l+89Bj
.text:0040989E					       ; __output_s_l+89Fj
.text:0040989E		       mov     ecx, dword ptr [ebp+1F8h+text] ;	string
.text:004098A1		       push    eax	       ; len
.text:004098A2		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:004098A5		       call    write_string_0
.text:004098AA		       pop     ecx
.text:004098AB
.text:004098AB loc_4098AB:			       ; CODE XREF: __output_s_l+8E6j
.text:004098AB					       ; __output_s_l+8ECj
.text:004098AB		       cmp     [ebp+1F8h+charsout], 0
.text:004098AF		       jl      short loc_4098C6
.text:004098B1		       test    byte ptr	[ebp+1F8h+flags], 4
.text:004098B5		       jz      short loc_4098C6
.text:004098B7		       push    edi	       ; f
.text:004098B8		       push    ebx	       ; num
.text:004098B9		       push    20h	       ; ch
.text:004098BB		       lea     eax, [ebp+1F8h+charsout]	; pnumwritten
.text:004098BE		       call    write_multi_char_0
.text:004098C3		       add     esp, 0Ch
.text:004098C6
.text:004098C6 loc_4098C6:			       ; CODE XREF: __output_s_l+58Aj
.text:004098C6					       ; __output_s_l+815j ...
.text:004098C6		       cmp     [ebp+1F8h+heapbuf], 0
.text:004098CA		       jz      short loc_4098D9	; default
.text:004098CC		       push    [ebp+1F8h+heapbuf] ; pBlock
.text:004098CF		       call    _free
.text:004098D4		       and     [ebp+1F8h+heapbuf], 0
.text:004098D8		       pop     ecx
.text:004098D9
.text:004098D9 loc_4098D9:			       ; CODE XREF: __output_s_l+1A9j
.text:004098D9					       ; __output_s_l+1CEj ...
.text:004098D9		       mov     ebx, [ebp+1F8h+var_244] ; default
.text:004098DC		       mov     al, [ebx]
.text:004098DE		       test    al, al
.text:004098E0		       mov     [ebp+1F8h+var_211], al
.text:004098E3		       jz      short loc_409906
.text:004098E5		       mov     edi, [ebp+1F8h+var_224]
.text:004098E8		       mov     dl, al
.text:004098EA		       jmp     loc_40910F
.text:004098EF ; ---------------------------------------------------------------------------
.text:004098EF
.text:004098EF loc_4098EF:			       ; CODE XREF: __output_s_l+19Ej
.text:004098EF					       ; __output_s_l+37Ej ...
.text:004098EF		       call    __errno
.text:004098F4		       mov     dword ptr [eax],	16h
.text:004098FA		       xor     eax, eax
.text:004098FC		       push    eax
.text:004098FD		       push    eax
.text:004098FE		       push    eax
.text:004098FF		       push    eax
.text:00409900		       push    eax
.text:00409901		       jmp     loc_409020
.text:00409906 ; ---------------------------------------------------------------------------
.text:00409906
.text:00409906 loc_409906:			       ; CODE XREF: __output_s_l+168j
.text:00409906					       ; __output_s_l+933j
.text:00409906		       xor     esi, esi
.text:00409908		       cmp     [ebp+1F8h+state], esi
.text:0040990B		       jz      short loc_409917
.text:0040990D		       cmp     [ebp+1F8h+state], 7
.text:00409911		       jnz     loc_409010
.text:00409917
.text:00409917 loc_409917:			       ; CODE XREF: __output_s_l+159j
.text:00409917					       ; __output_s_l+95Bj
.text:00409917		       cmp     [ebp+1F8h+_loc_update.updated], 0
.text:0040991B		       jz      short loc_409924
.text:0040991D		       mov     eax, [ebp+1F8h+_loc_update.ptd]
.text:00409920		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00409924
.text:00409924 loc_409924:			       ; CODE XREF: __output_s_l+96Bj
.text:00409924		       mov     eax, [ebp+1F8h+charsout]
.text:00409927
.text:00409927 loc_409927:			       ; CODE XREF: __output_s_l+88j
.text:00409927		       mov     ecx, [ebp+1F8h+var_4]
.text:0040992D		       pop     edi
.text:0040992E		       pop     esi
.text:0040992F		       xor     ecx, ebp
.text:00409931		       pop     ebx
.text:00409932		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00409937		       add     ebp, 1F8h
.text:0040993D		       leave
.text:0040993E		       retn
.text:0040993E ; ---------------------------------------------------------------------------
.text:0040993F		       align 10h
.text:00409940 off_409940      dd offset NORMAL_STATE_0	; DATA XREF: __output_s_l+1AFr
.text:00409940		       dd offset $LN131	       ; jump table for	switch statement
.text:00409940		       dd offset $LN130_0
.text:00409940		       dd offset $LN122
.text:00409940		       dd offset $LN118
.text:00409940		       dd offset $LN117_0
.text:00409940		       dd offset $LN113
.text:00409940		       dd offset $LN97
.text:00409940 __output_s_l    endp
.text:00409940
.text:00409960
.text:00409960 ; =============== S U B R O U T I N E =======================================
.text:00409960
.text:00409960 ; Attributes: bp-based frame
.text:00409960
.text:00409960 ; int __cdecl _validate_param_reuseA(positional_param *pos, ARG_TYPE get_fn_type, char cur_type,	int cur_flags)
.text:00409960 __validate_param_reuseA proc near       ; CODE XREF: __output_p_l+8CBp
.text:00409960					       ; __output_p_l+C01p
.text:00409960
.text:00409960 pos	       = dword ptr  8
.text:00409960 get_fn_type     = dword ptr  0Ch
.text:00409960 cur_type	       = byte ptr  10h
.text:00409960 cur_flags       = dword ptr  14h
.text:00409960
.text:00409960		       push    ebp
.text:00409961		       mov     ebp, esp
.text:00409963		       mov     dl, [ebp+cur_type]
.text:00409966		       push    esi
.text:00409967		       push    edi
.text:00409968		       mov     edi, [ebp+pos]
.text:0040996B		       mov     al, [edi+8]
.text:0040996E		       cmp     al, 70h
.text:00409970		       jz      loc_409A7C
.text:00409976		       cmp     dl, 70h
.text:00409979		       jz      loc_409A7C
.text:0040997F		       cmp     al, 73h
.text:00409981		       jz      short loc_40998B
.text:00409983		       cmp     al, 53h
.text:00409985		       jz      short loc_40998B
.text:00409987		       xor     esi, esi
.text:00409989		       jmp     short loc_40998E
.text:0040998B ; ---------------------------------------------------------------------------
.text:0040998B
.text:0040998B loc_40998B:			       ; CODE XREF: __validate_param_reuseA+21j
.text:0040998B					       ; __validate_param_reuseA+25j
.text:0040998B		       xor     esi, esi
.text:0040998D		       inc     esi
.text:0040998E
.text:0040998E loc_40998E:			       ; CODE XREF: __validate_param_reuseA+29j
.text:0040998E		       cmp     dl, 73h
.text:00409991		       jz      short loc_40999C
.text:00409993		       cmp     dl, 53h
.text:00409996		       jz      short loc_40999C
.text:00409998		       xor     ecx, ecx
.text:0040999A		       jmp     short loc_40999F
.text:0040999C ; ---------------------------------------------------------------------------
.text:0040999C
.text:0040999C loc_40999C:			       ; CODE XREF: __validate_param_reuseA+31j
.text:0040999C					       ; __validate_param_reuseA+36j
.text:0040999C		       xor     ecx, ecx
.text:0040999E		       inc     ecx
.text:0040999F
.text:0040999F loc_40999F:			       ; CODE XREF: __validate_param_reuseA+3Aj
.text:0040999F		       test    esi, esi
.text:004099A1		       jnz     loc_409A50
.text:004099A7		       test    ecx, ecx
.text:004099A9		       jnz     loc_409A78
.text:004099AF		       cmp     al, 64h
.text:004099B1		       jz      short loc_409A01
.text:004099B3		       cmp     al, 69h
.text:004099B5		       jz      short loc_4099E5
.text:004099B7		       cmp     al, 6Fh
.text:004099B9		       jz      short loc_4099E5
.text:004099BB		       cmp     al, 75h
.text:004099BD		       jz      short loc_4099E5
.text:004099BF		       cmp     al, 78h
.text:004099C1		       jz      short loc_4099E5
.text:004099C3		       cmp     al, 58h
.text:004099C5		       jz      short loc_4099E5
.text:004099C7		       cmp     dl, 64h
.text:004099CA		       jz      short loc_4099E5
.text:004099CC		       cmp     dl, 69h
.text:004099CF		       jz      short loc_4099E5
.text:004099D1		       cmp     dl, 6Fh
.text:004099D4		       jz      short loc_4099E5
.text:004099D6		       cmp     dl, 75h
.text:004099D9		       jz      short loc_4099E5
.text:004099DB		       cmp     dl, 78h
.text:004099DE		       jz      short loc_4099E5
.text:004099E0		       cmp     dl, 58h
.text:004099E3		       jnz     short loc_409A44
.text:004099E5
.text:004099E5 loc_4099E5:			       ; CODE XREF: __validate_param_reuseA+55j
.text:004099E5					       ; __validate_param_reuseA+59j ...
.text:004099E5		       cmp     al, 64h
.text:004099E7		       jz      short loc_409A01
.text:004099E9		       cmp     al, 69h
.text:004099EB		       jz      short loc_409A01
.text:004099ED		       cmp     al, 6Fh
.text:004099EF		       jz      short loc_409A01
.text:004099F1		       cmp     al, 75h
.text:004099F3		       jz      short loc_409A01
.text:004099F5		       cmp     al, 78h
.text:004099F7		       jz      short loc_409A01
.text:004099F9		       cmp     al, 58h
.text:004099FB		       jz      short loc_409A01
.text:004099FD		       xor     ecx, ecx
.text:004099FF		       jmp     short loc_409A04
.text:00409A01 ; ---------------------------------------------------------------------------
.text:00409A01
.text:00409A01 loc_409A01:			       ; CODE XREF: __validate_param_reuseA+51j
.text:00409A01					       ; __validate_param_reuseA+87j ...
.text:00409A01		       xor     ecx, ecx
.text:00409A03		       inc     ecx
.text:00409A04
.text:00409A04 loc_409A04:			       ; CODE XREF: __validate_param_reuseA+9Fj
.text:00409A04		       cmp     dl, 64h
.text:00409A07		       jz      short loc_409A26
.text:00409A09		       cmp     dl, 69h
.text:00409A0C		       jz      short loc_409A26
.text:00409A0E		       cmp     dl, 6Fh
.text:00409A11		       jz      short loc_409A26
.text:00409A13		       cmp     dl, 75h
.text:00409A16		       jz      short loc_409A26
.text:00409A18		       cmp     dl, 78h
.text:00409A1B		       jz      short loc_409A26
.text:00409A1D		       cmp     dl, 58h
.text:00409A20		       jz      short loc_409A26
.text:00409A22		       xor     eax, eax
.text:00409A24		       jmp     short loc_409A29
.text:00409A26 ; ---------------------------------------------------------------------------
.text:00409A26
.text:00409A26 loc_409A26:			       ; CODE XREF: __validate_param_reuseA+A7j
.text:00409A26					       ; __validate_param_reuseA+ACj ...
.text:00409A26		       xor     eax, eax
.text:00409A28		       inc     eax
.text:00409A29
.text:00409A29 loc_409A29:			       ; CODE XREF: __validate_param_reuseA+C4j
.text:00409A29		       cmp     ecx, eax
.text:00409A2B		       jnz     short loc_409A78
.text:00409A2D		       mov     eax, [edi+0Ch]
.text:00409A30		       mov     ecx, eax
.text:00409A32		       xor     ecx, [ebp+cur_flags]
.text:00409A35		       test    ecx, 10000h
.text:00409A3B		       jnz     short loc_409A78
.text:00409A3D		       xor     eax, [ebp+cur_flags]
.text:00409A40		       test    al, 20h
.text:00409A42		       jnz     short loc_409A78
.text:00409A44
.text:00409A44 loc_409A44:			       ; CODE XREF: __validate_param_reuseA+83j
.text:00409A44		       mov     ecx, [edi]
.text:00409A46		       xor     eax, eax
.text:00409A48		       cmp     ecx, [ebp+get_fn_type]
.text:00409A4B		       setz    al
.text:00409A4E		       jmp     short loc_409A85
.text:00409A50 ; ---------------------------------------------------------------------------
.text:00409A50
.text:00409A50 loc_409A50:			       ; CODE XREF: __validate_param_reuseA+41j
.text:00409A50		       cmp     esi, ecx
.text:00409A52		       jnz     short loc_409A78
.text:00409A54		       mov     ecx, [edi+0Ch]
.text:00409A57		       mov     edx, [ebp+cur_flags]
.text:00409A5A		       mov     eax, 810h
.text:00409A5F		       and     ecx, eax
.text:00409A61		       neg     ecx
.text:00409A63		       sbb     ecx, ecx
.text:00409A65		       and     edx, eax
.text:00409A67		       neg     ecx
.text:00409A69		       neg     edx
.text:00409A6B		       sbb     edx, edx
.text:00409A6D		       neg     edx
.text:00409A6F		       cmp     ecx, edx
.text:00409A71		       jnz     short loc_409A78
.text:00409A73		       xor     eax, eax
.text:00409A75		       inc     eax
.text:00409A76		       jmp     short loc_409A85
.text:00409A78 ; ---------------------------------------------------------------------------
.text:00409A78
.text:00409A78 loc_409A78:			       ; CODE XREF: __validate_param_reuseA+49j
.text:00409A78					       ; __validate_param_reuseA+CBj ...
.text:00409A78		       xor     eax, eax
.text:00409A7A		       jmp     short loc_409A85
.text:00409A7C ; ---------------------------------------------------------------------------
.text:00409A7C
.text:00409A7C loc_409A7C:			       ; CODE XREF: __validate_param_reuseA+10j
.text:00409A7C					       ; __validate_param_reuseA+19j
.text:00409A7C		       xor     ecx, ecx
.text:00409A7E		       cmp     al, dl
.text:00409A80		       setz    cl
.text:00409A83		       mov     eax, ecx
.text:00409A85
.text:00409A85 loc_409A85:			       ; CODE XREF: __validate_param_reuseA+EEj
.text:00409A85					       ; __validate_param_reuseA+116j ...
.text:00409A85		       pop     edi
.text:00409A86		       pop     esi
.text:00409A87		       pop     ebp
.text:00409A88		       retn
.text:00409A88 __validate_param_reuseA endp
.text:00409A88
.text:00409A89
.text:00409A89 ; =============== S U B R O U T I N E =======================================
.text:00409A89
.text:00409A89
.text:00409A89 ; void __usercall write_char_1(char ch<al>, _iobuf *f<ecx>, int *pnumwritten<esi>)
.text:00409A89 write_char_1    proc near	       ; CODE XREF: write_multi_char_1+11p
.text:00409A89					       ; write_string_1+22p ...
.text:00409A89 f = ecx
.text:00409A89 pnumwritten = esi
.text:00409A89		       test    byte ptr	[f+0Ch], 40h
.text:00409A8D		       jz      short loc_409A95
.text:00409A8F		       cmp     dword ptr [f+8],	0
.text:00409A93		       jz      short loc_409AB9
.text:00409A95
.text:00409A95 loc_409A95:			       ; CODE XREF: write_char_1+4j
.text:00409A95		       dec     dword ptr [f+4]
.text:00409A98		       js      short loc_409AA5
.text:00409A9A		       mov     edx, [f]
.text:00409A9C		       mov     [edx], al
.text:00409A9E		       inc     dword ptr [f]
.text:00409AA0		       movzx   eax, al
.text:00409AA3		       jmp     short loc_409AB1
.text:00409AA5 ; ---------------------------------------------------------------------------
.text:00409AA5
.text:00409AA5 loc_409AA5:			       ; CODE XREF: write_char_1+Fj
.text:00409AA5		       movsx   eax, al
.text:00409AA8		       push    f	       ; str
.text:00409AA9		       push    eax	       ; ch
.text:00409AAA		       call    __flsbuf
.text:00409AAF		       pop     f
.text:00409AB0		       pop     f
.text:00409AB1
.text:00409AB1 loc_409AB1:			       ; CODE XREF: write_char_1+1Aj
.text:00409AB1		       cmp     eax, 0FFFFFFFFh
.text:00409AB4		       jnz     short loc_409AB9
.text:00409AB6		       or      [pnumwritten], eax
.text:00409AB8		       retn
.text:00409AB9 ; ---------------------------------------------------------------------------
.text:00409AB9
.text:00409AB9 loc_409AB9:			       ; CODE XREF: write_char_1+Aj
.text:00409AB9					       ; write_char_1+2Bj
.text:00409AB9		       inc     dword ptr [pnumwritten]
.text:00409ABB		       retn
.text:00409ABB write_char_1    endp
.text:00409ABB
.text:00409ABC
.text:00409ABC ; =============== S U B R O U T I N E =======================================
.text:00409ABC
.text:00409ABC ; Attributes: bp-based frame
.text:00409ABC
.text:00409ABC ; void __usercall write_multi_char_1(char ch, int num, _iobuf *f, int *pnumwritten<eax>)
.text:00409ABC write_multi_char_1 proc near	       ; CODE XREF: __output_p_l+DECp
.text:00409ABC					       ; __output_p_l+E1Fp ...
.text:00409ABC
.text:00409ABC arg_0	       = byte ptr  8
.text:00409ABC num	       = dword ptr  0Ch
.text:00409ABC f	       = dword ptr  10h
.text:00409ABC
.text:00409ABC pnumwritten = eax
.text:00409ABC		       push    ebp
.text:00409ABD		       mov     ebp, esp
.text:00409ABF		       push    esi
.text:00409AC0		       mov     esi, pnumwritten	; pnumwritten
.text:00409AC2		       jmp     short loc_409AD7
.text:00409AC4 ; ---------------------------------------------------------------------------
.text:00409AC4
.text:00409AC4 loc_409AC4:			       ; CODE XREF: write_multi_char_1+1Fj
.text:00409AC4		       mov     ecx, [ebp+f]    ; f
.text:00409AC7		       mov     al, [ebp+arg_0] ; ch
.text:00409ACA		       dec     [ebp+num]
.text:00409ACD		       call    write_char_1
.text:00409AD2		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00409AD5		       jz      short loc_409ADD
.text:00409AD7
.text:00409AD7 loc_409AD7:			       ; CODE XREF: write_multi_char_1+6j
.text:00409AD7		       cmp     [ebp+num], 0
.text:00409ADB		       jg      short loc_409AC4
.text:00409ADD
.text:00409ADD loc_409ADD:			       ; CODE XREF: write_multi_char_1+19j
.text:00409ADD		       pop     esi
.text:00409ADE		       pop     ebp
.text:00409ADF		       retn
.text:00409ADF write_multi_char_1 endp
.text:00409ADF
.text:00409AE0
.text:00409AE0 ; =============== S U B R O U T I N E =======================================
.text:00409AE0
.text:00409AE0
.text:00409AE0 ; void __usercall write_string_1(char *string<ecx>, int len, _iobuf *f<edi>, int	*pnumwritten<eax>)
.text:00409AE0 write_string_1  proc near	       ; CODE XREF: __output_p_l+E00p
.text:00409AE0					       ; __output_p_l+E6Dp ...
.text:00409AE0
.text:00409AE0 len	       = dword ptr  4
.text:00409AE0
.text:00409AE0 string =	ecx
.text:00409AE0 f = edi
.text:00409AE0 pnumwritten = eax
.text:00409AE0		       test    byte ptr	[f+0Ch], 40h
.text:00409AE4		       push    ebx
.text:00409AE5		       push    esi
.text:00409AE6		       mov     esi, pnumwritten	; pnumwritten
.text:00409AE8		       mov     ebx, string
.text:00409AEA		       jz      short loc_409B20
.text:00409AEC		       cmp     dword ptr [f+8],	0
.text:00409AF0		       jnz     short loc_409B20
.text:00409AF2		       mov     pnumwritten, [esp+8+len]
.text:00409AF6		       add     [esi], pnumwritten
.text:00409AF8		       jmp     short loc_409B27
.text:00409AFA ; ---------------------------------------------------------------------------
.text:00409AFA
.text:00409AFA loc_409AFA:			       ; CODE XREF: write_string_1+45j
.text:00409AFA		       mov     al, [ebx]       ; ch
.text:00409AFC		       dec     [esp+8+len]
.text:00409B00		       mov     string, f       ; f
.text:00409B02		       call    write_char_1
.text:00409B07		       inc     ebx
.text:00409B08		       cmp     dword ptr [esi],	0FFFFFFFFh
.text:00409B0B		       jnz     short loc_409B20
.text:00409B0D		       call    __errno
.text:00409B12		       cmp     dword ptr [pnumwritten],	2Ah
.text:00409B15		       jnz     short loc_409B27
.text:00409B17		       mov     string, f       ; f
.text:00409B19		       mov     al, 3Fh	       ; ch
.text:00409B1B		       call    write_char_1
.text:00409B20
.text:00409B20 loc_409B20:			       ; CODE XREF: write_string_1+Aj
.text:00409B20					       ; write_string_1+10j ...
.text:00409B20		       cmp     [esp+8+len], 0
.text:00409B25		       jg      short loc_409AFA
.text:00409B27
.text:00409B27 loc_409B27:			       ; CODE XREF: write_string_1+18j
.text:00409B27					       ; write_string_1+35j
.text:00409B27		       pop     esi
.text:00409B28		       pop     ebx
.text:00409B29		       retn
.text:00409B29 write_string_1  endp
.text:00409B29
.text:00409B2A
.text:00409B2A ; =============== S U B R O U T I N E =======================================
.text:00409B2A
.text:00409B2A
.text:00409B2A ; _CRT_DOUBLE __cdecl get_crtdouble_arg(char **pargptr)
.text:00409B2A _get_crtdouble_arg proc near
.text:00409B2A
.text:00409B2A pargptr	       = dword ptr  4
.text:00409B2A
.text:00409B2A		       mov     eax, [esp+pargptr]
.text:00409B2E		       add     dword ptr [eax],	8
.text:00409B31		       mov     ecx, [eax]
.text:00409B33		       mov     eax, [ecx-8]
.text:00409B36		       mov     edx, [ecx-4]
.text:00409B39		       retn
.text:00409B39 _get_crtdouble_arg endp
.text:00409B39
.text:00409B3A
.text:00409B3A ; =============== S U B R O U T I N E =======================================
.text:00409B3A
.text:00409B3A ; Attributes: bp-based frame fpd=290h
.text:00409B3A
.text:00409B3A ; int __cdecl _output_p_l(_iobuf	*stream, const char *format, localeinfo_struct *plocinfo, char *argptr)
.text:00409B3A __output_p_l    proc near	       ; DATA XREF: __vprintf_p_l+Co
.text:00409B3A					       ; __vprintf_p+Ao ...
.text:00409B3A
.text:00409B3A pos_value       = positional_param ptr -8D0h
.text:00409B3A saved_format    = dword ptr -290h
.text:00409B3A tmp	       = _CRT_DOUBLE ptr -28Ch
.text:00409B3A retval	       = dword ptr -284h
.text:00409B3A capexp	       = dword ptr -280h
.text:00409B3A heapbuf	       = dword ptr -27Ch
.text:00409B3A no_output       = dword ptr -278h
.text:00409B3A hexadd	       = dword ptr -274h
.text:00409B3A f	       = dword ptr -270h
.text:00409B3A textlen	       = dword ptr -268h
.text:00409B3A state	       = dword ptr -264h
.text:00409B3A bufferiswide    = dword ptr -260h
.text:00409B3A end_pos	       = dword ptr -25Ch
.text:00409B3A prefixlen       = dword ptr -258h
.text:00409B3A max_pos	       = dword ptr -254h
.text:00409B3A fldwidth	       = dword ptr -250h
.text:00409B3A count	       = dword ptr -24Ch
.text:00409B3A prefix	       = byte ptr -248h
.text:00409B3A charsout	       = dword ptr -244h
.text:00409B3A var_240	       = dword ptr -240h
.text:00409B3A _loc_update     = _LocaleUpdate ptr -23Ch
.text:00409B3A cur_type	       = byte ptr -22Ch
.text:00409B3A pass	       = dword ptr -228h
.text:00409B3A format_type     = dword ptr -224h
.text:00409B3A precision       = dword ptr -220h
.text:00409B3A text	       = $12F061FBE778B92DEB8200A0ACF7A038 ptr -21Ch
.text:00409B3A type_pos	       = dword ptr -218h
.text:00409B3A var_214	       = dword ptr -214h
.text:00409B3A flags	       = dword ptr -210h
.text:00409B3A buffer	       = $C8014B43F160BFD769FAE3F15553333C ptr -20Ch
.text:00409B3A L_buffer	       = byte ptr -0Ch
.text:00409B3A var_4	       = dword ptr -4
.text:00409B3A stream	       = dword ptr  8
.text:00409B3A format	       = dword ptr  0Ch
.text:00409B3A plocinfo	       = dword ptr  10h
.text:00409B3A argptr	       = dword ptr  14h
.text:00409B3A
.text:00409B3A		       push    ebp
.text:00409B3B		       lea     ebp, [esp-290h]
.text:00409B42		       sub     esp, 8D0h
.text:00409B48		       mov     eax, ___security_cookie
.text:00409B4D		       xor     eax, ebp
.text:00409B4F		       mov     [ebp+290h+var_4], eax
.text:00409B55		       mov     eax, [ebp+290h+argptr]
.text:00409B5B		       push    ebx
.text:00409B5C		       push    esi
.text:00409B5D		       mov     esi, [ebp+290h+format]
.text:00409B63		       push    edi
.text:00409B64		       mov     edi, [ebp+290h+stream]
.text:00409B6A		       push    [ebp+290h+plocinfo] ; plocinfo
.text:00409B70		       xor     ebx, ebx
.text:00409B72		       lea     ecx, [ebp+290h+_loc_update] ; this
.text:00409B75		       mov     [ebp+290h+f], edi
.text:00409B78		       mov     [ebp+290h+var_240], esi
.text:00409B7B		       mov     [ebp+290h+var_214], eax
.text:00409B7E		       mov     [ebp+290h+hexadd], ebx
.text:00409B81		       mov     [ebp+290h+flags], ebx
.text:00409B87		       mov     [ebp+290h+prefixlen], ebx
.text:00409B8A		       mov     [ebp+290h+no_output], ebx
.text:00409B8D		       mov     [ebp+290h+bufferiswide],	ebx
.text:00409B90		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00409B95		       or      [ebp+290h+format_type], 0FFFFFFFFh
.text:00409B99		       cmp     edi, ebx
.text:00409B9B		       mov     [ebp+290h+end_pos], ebx
.text:00409B9E		       jnz     short loc_409BCC
.text:00409BA0
.text:00409BA0 loc_409BA0:			       ; CODE XREF: __output_p_l+DFj
.text:00409BA0					       ; __output_p_l+124j ...
.text:00409BA0		       call    __errno
.text:00409BA5		       push    ebx	       ; pReserved
.text:00409BA6		       push    ebx	       ; nLine
.text:00409BA7		       push    ebx	       ; pszFile
.text:00409BA8		       push    ebx	       ; pszFunction
.text:00409BA9		       push    ebx	       ; pszExpression
.text:00409BAA		       mov     dword ptr [eax],	16h
.text:00409BB0		       call    __invalid_parameter
.text:00409BB5		       add     esp, 14h
.text:00409BB8		       cmp     [ebp+290h+_loc_update.updated], bl
.text:00409BBB
.text:00409BBB loc_409BBB:			       ; CODE XREF: __output_p_l+8F7j
.text:00409BBB		       jz      short loc_409BC4
.text:00409BBD		       mov     eax, [ebp+290h+_loc_update.ptd]
.text:00409BC0		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00409BC4
.text:00409BC4 loc_409BC4:			       ; CODE XREF: __output_p_l:loc_409BBBj
.text:00409BC4		       or      eax, 0FFFFFFFFh
.text:00409BC7		       jmp     loc_40AA8A
.text:00409BCC ; ---------------------------------------------------------------------------
.text:00409BCC
.text:00409BCC loc_409BCC:			       ; CODE XREF: __output_p_l+64j
.text:00409BCC		       test    byte ptr	[edi+0Ch], 40h
.text:00409BD0		       jnz     loc_409C67
.text:00409BD6		       push    edi	       ; stream
.text:00409BD7		       call    __fileno
.text:00409BDC		       cmp     eax, 0FFFFFFFFh
.text:00409BDF		       pop     ecx
.text:00409BE0		       jz      short loc_409C10
.text:00409BE2		       push    edi	       ; stream
.text:00409BE3		       call    __fileno
.text:00409BE8		       cmp     eax, 0FFFFFFFEh
.text:00409BEB		       pop     ecx
.text:00409BEC		       jz      short loc_409C10
.text:00409BEE		       push    edi	       ; stream
.text:00409BEF		       call    __fileno
.text:00409BF4		       sar     eax, 5
.text:00409BF7		       push    edi	       ; stream
.text:00409BF8		       lea     esi, ds:423F00h[eax*4]
.text:00409BFF		       call    __fileno
.text:00409C04		       and     eax, 1Fh
.text:00409C07		       pop     ecx
.text:00409C08		       shl     eax, 6
.text:00409C0B		       add     eax, [esi]
.text:00409C0D		       pop     ecx
.text:00409C0E		       jmp     short loc_409C15
.text:00409C10 ; ---------------------------------------------------------------------------
.text:00409C10
.text:00409C10 loc_409C10:			       ; CODE XREF: __output_p_l+A6j
.text:00409C10					       ; __output_p_l+B2j
.text:00409C10		       mov     eax, offset ___badioinfo
.text:00409C15
.text:00409C15 loc_409C15:			       ; CODE XREF: __output_p_l+D4j
.text:00409C15		       test    byte ptr	[eax+24h], 7Fh
.text:00409C19		       jnz     short loc_409BA0
.text:00409C1B		       push    edi	       ; stream
.text:00409C1C		       call    __fileno
.text:00409C21		       cmp     eax, 0FFFFFFFFh
.text:00409C24		       pop     ecx
.text:00409C25		       jz      short loc_409C55
.text:00409C27		       push    edi	       ; stream
.text:00409C28		       call    __fileno
.text:00409C2D		       cmp     eax, 0FFFFFFFEh
.text:00409C30		       pop     ecx
.text:00409C31		       jz      short loc_409C55
.text:00409C33		       push    edi	       ; stream
.text:00409C34		       call    __fileno
.text:00409C39		       sar     eax, 5
.text:00409C3C		       push    edi	       ; stream
.text:00409C3D		       lea     esi, ds:423F00h[eax*4]
.text:00409C44		       call    __fileno
.text:00409C49		       and     eax, 1Fh
.text:00409C4C		       pop     ecx
.text:00409C4D		       shl     eax, 6
.text:00409C50		       add     eax, [esi]
.text:00409C52		       pop     ecx
.text:00409C53		       jmp     short loc_409C5A
.text:00409C55 ; ---------------------------------------------------------------------------
.text:00409C55
.text:00409C55 loc_409C55:			       ; CODE XREF: __output_p_l+EBj
.text:00409C55					       ; __output_p_l+F7j
.text:00409C55		       mov     eax, offset ___badioinfo
.text:00409C5A
.text:00409C5A loc_409C5A:			       ; CODE XREF: __output_p_l+119j
.text:00409C5A		       test    byte ptr	[eax+24h], 80h
.text:00409C5E		       jnz     loc_409BA0
.text:00409C64		       mov     esi, [ebp+290h+var_240]
.text:00409C67
.text:00409C67 loc_409C67:			       ; CODE XREF: __output_p_l+96j
.text:00409C67		       cmp     esi, ebx
.text:00409C69		       jz      loc_409BA0
.text:00409C6F		       mov     [ebp+290h+charsout], ebx
.text:00409C72		       mov     [ebp+290h+saved_format],	esi
.text:00409C75		       mov     [ebp+290h+pass],	ebx
.text:00409C78
.text:00409C78 loc_409C78:			       ; CODE XREF: __output_p_l+F3Bj
.text:00409C78		       cmp     [ebp+290h+pass],	1
.text:00409C7C		       jnz     short loc_409C89
.text:00409C7E		       cmp     [ebp+290h+format_type], ebx
.text:00409C81		       jz      loc_40AA7A
.text:00409C87		       xor     ebx, ebx
.text:00409C89
.text:00409C89 loc_409C89:			       ; CODE XREF: __output_p_l+142j
.text:00409C89		       mov     eax, [ebp+290h+saved_format]
.text:00409C8C		       or      [ebp+290h+max_pos], 0FFFFFFFFh
.text:00409C90		       or      [ebp+290h+type_pos], 0FFFFFFFFh
.text:00409C94		       or      [ebp+290h+format_type], 0FFFFFFFFh
.text:00409C98		       mov     [ebp+290h+textlen], ebx
.text:00409C9B		       mov     dl, [eax]
.text:00409C9D		       test    dl, dl
.text:00409C9F		       mov     [ebp+290h+state], ebx
.text:00409CA2		       mov     [ebp+290h+heapbuf], ebx
.text:00409CA5		       mov     [ebp+290h+fldwidth], ebx
.text:00409CA8		       mov     [ebp+290h+precision], ebx
.text:00409CAB		       mov     [ebp+290h+var_240], eax
.text:00409CAE		       mov     [ebp+290h+cur_type], dl
.text:00409CB1		       jz      loc_40AA6A
.text:00409CB7		       mov     esi, eax
.text:00409CB9		       jmp     short loc_409CBE
.text:00409CBB ; ---------------------------------------------------------------------------
.text:00409CBB
.text:00409CBB loc_409CBB:			       ; CODE XREF: __output_p_l+EC9j
.text:00409CBB		       mov     dl, [ebp+290h+cur_type]
.text:00409CBE
.text:00409CBE loc_409CBE:			       ; CODE XREF: __output_p_l+17Fj
.text:00409CBE		       inc     esi
.text:00409CBF		       xor     edi, edi
.text:00409CC1		       cmp     [ebp+290h+charsout], edi
.text:00409CC4		       mov     [ebp+290h+var_240], esi
.text:00409CC7		       jl      loc_40AA0B
.text:00409CCD		       mov     al, dl
.text:00409CCF		       sub     al, 20h
.text:00409CD1		       cmp     al, 58h
.text:00409CD3		       ja      short loc_409CE4
.text:00409CD5		       movsx   eax, dl
.text:00409CD8		       movzx   eax, byte ptr ds:control[eax] ; "_.,"
.text:00409CDF		       and     eax, 0Fh
.text:00409CE2		       jmp     short loc_409CE6
.text:00409CE4 ; ---------------------------------------------------------------------------
.text:00409CE4
.text:00409CE4 loc_409CE4:			       ; CODE XREF: __output_p_l+199j
.text:00409CE4		       xor     eax, eax
.text:00409CE6
.text:00409CE6 loc_409CE6:			       ; CODE XREF: __output_p_l+1A8j
.text:00409CE6		       mov     ecx, [ebp+290h+state]
.text:00409CE9		       imul    eax, 9
.text:00409CEC		       movzx   eax, ds:___lookuptable_s[eax+ecx]
.text:00409CF4		       xor     ebx, ebx
.text:00409CF6		       shr     eax, 4
.text:00409CF9		       inc     ebx
.text:00409CFA		       cmp     eax, ebx
.text:00409CFC		       mov     [ebp+290h+state], eax
.text:00409CFF		       jnz     loc_409DAB
.text:00409D05		       cmp     byte ptr	[esi], 25h
.text:00409D08		       jz      loc_409DA1
.text:00409D0E		       cmp     [ebp+290h+format_type], 0FFFFFFFFh
.text:00409D12		       jnz     short loc_409D54
.text:00409D14		       push    0Ah	       ; ibase
.text:00409D16		       lea     eax, [ebp+290h+end_pos]
.text:00409D19		       push    eax	       ; endptr
.text:00409D1A		       push    esi	       ; nptr
.text:00409D1B		       call    _strtol
.text:00409D20		       add     esp, 0Ch
.text:00409D23		       test    eax, eax
.text:00409D25		       jle     short loc_409D4E
.text:00409D27		       mov     eax, [ebp+290h+end_pos]
.text:00409D2A		       cmp     byte ptr	[eax], 24h
.text:00409D2D		       jnz     short loc_409D4E
.text:00409D2F		       cmp     [ebp+290h+pass],	edi
.text:00409D32		       jnz     short loc_409D49
.text:00409D34		       push    640h	       ; count
.text:00409D39		       lea     eax, [ebp+290h+pos_value]
.text:00409D3F		       push    edi	       ; value
.text:00409D40		       push    eax	       ; dst
.text:00409D41		       call    _memset
.text:00409D46		       add     esp, 0Ch
.text:00409D49
.text:00409D49 loc_409D49:			       ; CODE XREF: __output_p_l+1F8j
.text:00409D49		       mov     [ebp+290h+format_type], ebx
.text:00409D4C		       jmp     short loc_409D59
.text:00409D4E ; ---------------------------------------------------------------------------
.text:00409D4E
.text:00409D4E loc_409D4E:			       ; CODE XREF: __output_p_l+1EBj
.text:00409D4E					       ; __output_p_l+1F3j
.text:00409D4E		       mov     dl, [ebp+290h+cur_type]
.text:00409D51		       mov     [ebp+290h+format_type], edi
.text:00409D54
.text:00409D54 loc_409D54:			       ; CODE XREF: __output_p_l+1D8j
.text:00409D54		       cmp     [ebp+290h+format_type], ebx
.text:00409D57		       jnz     short loc_409DA1
.text:00409D59
.text:00409D59 loc_409D59:			       ; CODE XREF: __output_p_l+212j
.text:00409D59		       push    0Ah	       ; ibase
.text:00409D5B		       lea     eax, [ebp+290h+end_pos]
.text:00409D5E		       push    eax	       ; endptr
.text:00409D5F		       push    esi	       ; nptr
.text:00409D60		       call    _strtol
.text:00409D65		       mov     ecx, [ebp+290h+end_pos]
.text:00409D68		       add     esp, 0Ch
.text:00409D6B		       dec     eax
.text:00409D6C		       cmp     [ebp+290h+pass],	edi
.text:00409D6F		       lea     edx, [ecx+1]
.text:00409D72		       mov     [ebp+290h+type_pos], eax
.text:00409D75		       mov     [ebp+290h+var_240], edx
.text:00409D78		       jnz     short loc_409D9C
.text:00409D7A		       cmp     eax, edi
.text:00409D7C		       jl      loc_40A415
.text:00409D82		       cmp     byte ptr	[ecx], 24h
.text:00409D85		       jnz     loc_40A415
.text:00409D8B		       cmp     eax, 64h
.text:00409D8E		       jge     loc_40A415
.text:00409D94		       cmp     eax, [ebp+290h+max_pos]
.text:00409D97		       jle     short loc_409D9C
.text:00409D99		       mov     [ebp+290h+max_pos], eax
.text:00409D9C
.text:00409D9C loc_409D9C:			       ; CODE XREF: __output_p_l+23Ej
.text:00409D9C					       ; __output_p_l+25Dj
.text:00409D9C		       mov     esi, edx
.text:00409D9E		       mov     dl, [ebp+290h+cur_type]
.text:00409DA1
.text:00409DA1 loc_409DA1:			       ; CODE XREF: __output_p_l+1CEj
.text:00409DA1					       ; __output_p_l+21Dj ...
.text:00409DA1		       mov     eax, [ebp+290h+state]
.text:00409DA4		       jmp     ds:off_40AAA2[eax*4]
.text:00409DAB ; ---------------------------------------------------------------------------
.text:00409DAB
.text:00409DAB loc_409DAB:			       ; CODE XREF: __output_p_l+1C5j
.text:00409DAB		       cmp     eax, 8
.text:00409DAE		       jz      loc_40A415
.text:00409DB4		       cmp     eax, 7
.text:00409DB7		       ja      loc_40A9F9
.text:00409DBD		       jmp     short loc_409DA1
.text:00409DBF ; ---------------------------------------------------------------------------
.text:00409DBF
.text:00409DBF $LN265:				       ; CODE XREF: __output_p_l+26Aj
.text:00409DBF					       ; DATA XREF: __output_p_l:off_40AAA2o
.text:00409DBF		       cmp     [ebp+290h+pass],	edi
.text:00409DC2		       jnz     short loc_409DCD
.text:00409DC4		       cmp     [ebp+290h+format_type], ebx
.text:00409DC7		       jz      loc_40A9F9
.text:00409DCD
.text:00409DCD loc_409DCD:			       ; CODE XREF: __output_p_l+288j
.text:00409DCD		       cmp     [ebp+290h+pass],	ebx
.text:00409DD0		       jnz     NORMAL_STATE_1
.text:00409DD6		       cmp     [ebp+290h+format_type], 0FFFFFFFFh
.text:00409DDA		       jnz     NORMAL_STATE_1
.text:00409DE0		       jmp     loc_40A9F9
.text:00409DE5 ; ---------------------------------------------------------------------------
.text:00409DE5
.text:00409DE5 $LN259:				       ; CODE XREF: __output_p_l+26Aj
.text:00409DE5					       ; DATA XREF: __output_p_l+F6Co
.text:00409DE5		       or      [ebp+290h+precision], 0FFFFFFFFh
.text:00409DE9		       mov     [ebp+290h+capexp], edi
.text:00409DEC		       mov     [ebp+290h+no_output], edi
.text:00409DEF		       mov     [ebp+290h+fldwidth], edi
.text:00409DF2		       mov     [ebp+290h+prefixlen], edi
.text:00409DF5		       mov     [ebp+290h+flags], edi
.text:00409DFB		       mov     [ebp+290h+bufferiswide],	edi
.text:00409DFE		       jmp     loc_40A9F9
.text:00409E03 ; ---------------------------------------------------------------------------
.text:00409E03
.text:00409E03 $LN258:				       ; CODE XREF: __output_p_l+26Aj
.text:00409E03					       ; DATA XREF: __output_p_l+F70o
.text:00409E03		       movsx   eax, dl
.text:00409E06		       sub     eax, 20h
.text:00409E09		       jz      short loc_409E54
.text:00409E0B		       sub     eax, 3
.text:00409E0E		       jz      short loc_409E45
.text:00409E10		       sub     eax, 8
.text:00409E13		       jz      short loc_409E3A
.text:00409E15		       dec     eax
.text:00409E16		       dec     eax
.text:00409E17		       jz      short loc_409E2E
.text:00409E19		       sub     eax, 3
.text:00409E1C		       jnz     loc_40A9F9
.text:00409E22		       or      [ebp+290h+flags], 8
.text:00409E29		       jmp     loc_40A9F9
.text:00409E2E ; ---------------------------------------------------------------------------
.text:00409E2E
.text:00409E2E loc_409E2E:			       ; CODE XREF: __output_p_l+2DDj
.text:00409E2E		       or      [ebp+290h+flags], 4
.text:00409E35		       jmp     loc_40A9F9
.text:00409E3A ; ---------------------------------------------------------------------------
.text:00409E3A
.text:00409E3A loc_409E3A:			       ; CODE XREF: __output_p_l+2D9j
.text:00409E3A		       or      [ebp+290h+flags], ebx
.text:00409E40		       jmp     loc_40A9F9
.text:00409E45 ; ---------------------------------------------------------------------------
.text:00409E45
.text:00409E45 loc_409E45:			       ; CODE XREF: __output_p_l+2D4j
.text:00409E45		       or      [ebp+290h+flags], 80h
.text:00409E4F		       jmp     loc_40A9F9
.text:00409E54 ; ---------------------------------------------------------------------------
.text:00409E54
.text:00409E54 loc_409E54:			       ; CODE XREF: __output_p_l+2CFj
.text:00409E54		       or      [ebp+290h+flags], 2
.text:00409E5B		       jmp     loc_40A9F9
.text:00409E60 ; ---------------------------------------------------------------------------
.text:00409E60
.text:00409E60 $LN250:				       ; CODE XREF: __output_p_l+26Aj
.text:00409E60					       ; DATA XREF: __output_p_l+F74o
.text:00409E60		       cmp     dl, 2Ah
.text:00409E63		       jnz     loc_409F01
.text:00409E69		       cmp     [ebp+290h+format_type], edi
.text:00409E6C		       jnz     short loc_409E7A
.text:00409E6E		       add     [ebp+290h+var_214], 4
.text:00409E72		       mov     eax, [ebp+290h+var_214]
.text:00409E75		       mov     eax, [eax-4]
.text:00409E78		       jmp     short loc_409EE7
.text:00409E7A ; ---------------------------------------------------------------------------
.text:00409E7A
.text:00409E7A loc_409E7A:			       ; CODE XREF: __output_p_l+332j
.text:00409E7A		       push    0Ah	       ; ibase
.text:00409E7C		       lea     eax, [ebp+290h+end_pos]
.text:00409E7F		       push    eax	       ; endptr
.text:00409E80		       push    esi	       ; nptr
.text:00409E81		       call    _strtol
.text:00409E86		       mov     ecx, [ebp+290h+end_pos]
.text:00409E89		       add     esp, 0Ch
.text:00409E8C		       dec     eax
.text:00409E8D		       cmp     [ebp+290h+pass],	edi
.text:00409E90		       lea     edx, [ecx+1]
.text:00409E93		       mov     [ebp+290h+var_240], edx
.text:00409E96		       jnz     short loc_409EDB
.text:00409E98
.text:00409E98 loc_409E98:			       ; CODE XREF: __output_p_l+416j
.text:00409E98		       cmp     eax, edi
.text:00409E9A		       jl      loc_40A415
.text:00409EA0		       cmp     byte ptr	[ecx], 24h
.text:00409EA3		       jnz     loc_40A415
.text:00409EA9		       cmp     [ebp+290h+type_pos], 64h
.text:00409EAD		       jge     loc_40A415
.text:00409EB3		       cmp     eax, [ebp+290h+max_pos]
.text:00409EB6		       jle     short loc_409EBB
.text:00409EB8		       mov     [ebp+290h+max_pos], eax
.text:00409EBB
.text:00409EBB loc_409EBB:			       ; CODE XREF: __output_p_l+37Cj
.text:00409EBB		       shl     eax, 4
.text:00409EBE		       lea     ecx, [ebp+eax+290h+pos_value]
.text:00409EC5		       cmp     [ecx], edi
.text:00409EC7		       jz      loc_409F76
.text:00409ECD		       push    [ebp+290h+flags]
.text:00409ED3		       push    2Ah
.text:00409ED5		       push    ebx
.text:00409ED6		       jmp     loc_40A404
.text:00409EDB ; ---------------------------------------------------------------------------
.text:00409EDB
.text:00409EDB loc_409EDB:			       ; CODE XREF: __output_p_l+35Cj
.text:00409EDB		       shl     eax, 4
.text:00409EDE		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:00409EE5		       mov     eax, [eax]
.text:00409EE7
.text:00409EE7 loc_409EE7:			       ; CODE XREF: __output_p_l+33Ej
.text:00409EE7		       cmp     eax, edi
.text:00409EE9		       mov     [ebp+290h+fldwidth], eax
.text:00409EEC		       jge     loc_40A9F9
.text:00409EF2		       or      [ebp+290h+flags], 4
.text:00409EF9		       neg     [ebp+290h+fldwidth]
.text:00409EFC		       jmp     loc_40A9F9
.text:00409F01 ; ---------------------------------------------------------------------------
.text:00409F01
.text:00409F01 loc_409F01:			       ; CODE XREF: __output_p_l+329j
.text:00409F01		       mov     eax, [ebp+290h+fldwidth]
.text:00409F04		       imul    eax, 0Ah
.text:00409F07		       movsx   ecx, dl
.text:00409F0A		       lea     eax, [eax+ecx-30h]
.text:00409F0E		       mov     [ebp+290h+fldwidth], eax
.text:00409F11		       jmp     loc_40A9F9
.text:00409F16 ; ---------------------------------------------------------------------------
.text:00409F16
.text:00409F16 $LN238:				       ; CODE XREF: __output_p_l+26Aj
.text:00409F16					       ; DATA XREF: __output_p_l+F78o
.text:00409F16		       mov     [ebp+290h+precision], edi
.text:00409F19		       jmp     loc_40A9F9
.text:00409F1E ; ---------------------------------------------------------------------------
.text:00409F1E
.text:00409F1E $LN237:				       ; CODE XREF: __output_p_l+26Aj
.text:00409F1E					       ; DATA XREF: __output_p_l+F7Co
.text:00409F1E		       cmp     dl, 2Ah
.text:00409F21		       jnz     short loc_409F92
.text:00409F23		       cmp     [ebp+290h+format_type], edi
.text:00409F26		       jnz     short loc_409F34
.text:00409F28		       add     [ebp+290h+var_214], 4
.text:00409F2C		       mov     eax, [ebp+290h+var_214]
.text:00409F2F		       mov     eax, [eax-4]
.text:00409F32		       jmp     short loc_409F62
.text:00409F34 ; ---------------------------------------------------------------------------
.text:00409F34
.text:00409F34 loc_409F34:			       ; CODE XREF: __output_p_l+3ECj
.text:00409F34		       push    0Ah	       ; ibase
.text:00409F36		       lea     eax, [ebp+290h+end_pos]
.text:00409F39		       push    eax	       ; endptr
.text:00409F3A		       push    esi	       ; nptr
.text:00409F3B		       call    _strtol
.text:00409F40		       mov     ecx, [ebp+290h+end_pos]
.text:00409F43		       add     esp, 0Ch
.text:00409F46		       dec     eax
.text:00409F47		       cmp     [ebp+290h+pass],	edi
.text:00409F4A		       lea     edx, [ecx+1]
.text:00409F4D		       mov     [ebp+290h+var_240], edx
.text:00409F50		       jz      loc_409E98
.text:00409F56		       shl     eax, 4
.text:00409F59		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:00409F60		       mov     eax, [eax]
.text:00409F62
.text:00409F62 loc_409F62:			       ; CODE XREF: __output_p_l+3F8j
.text:00409F62		       cmp     eax, edi
.text:00409F64		       mov     [ebp+290h+precision], eax
.text:00409F67		       jge     loc_40A9F9
.text:00409F6D		       or      [ebp+290h+precision], 0FFFFFFFFh
.text:00409F71		       jmp     loc_40A9F9
.text:00409F76 ; ---------------------------------------------------------------------------
.text:00409F76
.text:00409F76 loc_409F76:			       ; CODE XREF: __output_p_l+38Dj
.text:00409F76		       mov     [ecx], ebx
.text:00409F78		       mov     [ebp+eax+290h+pos_value.type], 2Ah
.text:00409F80
.text:00409F80 loc_409F80:			       ; CODE XREF: __output_p_l+5F7j
.text:00409F80		       mov     ecx, [ebp+290h+flags]
.text:00409F86		       mov     [ebp+eax+290h+pos_value.flags], ecx
.text:00409F8D		       jmp     loc_40A9F9
.text:00409F92 ; ---------------------------------------------------------------------------
.text:00409F92
.text:00409F92 loc_409F92:			       ; CODE XREF: __output_p_l+3E7j
.text:00409F92		       mov     eax, [ebp+290h+precision]
.text:00409F95		       imul    eax, 0Ah
.text:00409F98		       movsx   ecx, dl
.text:00409F9B		       lea     eax, [eax+ecx-30h]
.text:00409F9F		       mov     [ebp+290h+precision], eax
.text:00409FA2		       jmp     loc_40A9F9
.text:00409FA7 ; ---------------------------------------------------------------------------
.text:00409FA7
.text:00409FA7 $LN225:				       ; CODE XREF: __output_p_l+26Aj
.text:00409FA7					       ; DATA XREF: __output_p_l+F80o
.text:00409FA7		       cmp     dl, 49h
.text:00409FAA		       jz      short loc_409FFE
.text:00409FAC		       cmp     dl, 68h
.text:00409FAF		       jz      short loc_409FF2
.text:00409FB1		       cmp     dl, 6Ch
.text:00409FB4		       jz      short loc_409FCE
.text:00409FB6		       cmp     dl, 77h
.text:00409FB9		       jnz     loc_40A9F9
.text:00409FBF		       or      [ebp+290h+flags], 800h
.text:00409FC9		       jmp     loc_40A9F9
.text:00409FCE ; ---------------------------------------------------------------------------
.text:00409FCE
.text:00409FCE loc_409FCE:			       ; CODE XREF: __output_p_l+47Aj
.text:00409FCE		       cmp     byte ptr	[esi], 6Ch
.text:00409FD1		       jnz     short loc_409FE6
.text:00409FD3		       inc     esi
.text:00409FD4		       or      [ebp+290h+flags], 1000h
.text:00409FDE		       mov     [ebp+290h+var_240], esi
.text:00409FE1		       jmp     loc_40A9F9
.text:00409FE6 ; ---------------------------------------------------------------------------
.text:00409FE6
.text:00409FE6 loc_409FE6:			       ; CODE XREF: __output_p_l+497j
.text:00409FE6		       or      [ebp+290h+flags], 10h
.text:00409FED		       jmp     loc_40A9F9
.text:00409FF2 ; ---------------------------------------------------------------------------
.text:00409FF2
.text:00409FF2 loc_409FF2:			       ; CODE XREF: __output_p_l+475j
.text:00409FF2		       or      [ebp+290h+flags], 20h
.text:00409FF9		       jmp     loc_40A9F9
.text:00409FFE ; ---------------------------------------------------------------------------
.text:00409FFE
.text:00409FFE loc_409FFE:			       ; CODE XREF: __output_p_l+470j
.text:00409FFE		       mov     al, [esi]
.text:0040A000		       cmp     al, 36h
.text:0040A002		       jnz     short loc_40A01E
.text:0040A004		       cmp     byte ptr	[esi+1], 34h
.text:0040A008		       jnz     short loc_40A01E
.text:0040A00A		       inc     esi
.text:0040A00B		       inc     esi
.text:0040A00C		       or      [ebp+290h+flags], 8000h
.text:0040A016		       mov     [ebp+290h+var_240], esi
.text:0040A019		       jmp     loc_40A9F9
.text:0040A01E ; ---------------------------------------------------------------------------
.text:0040A01E
.text:0040A01E loc_40A01E:			       ; CODE XREF: __output_p_l+4C8j
.text:0040A01E					       ; __output_p_l+4CEj
.text:0040A01E		       cmp     al, 33h
.text:0040A020		       jnz     short loc_40A03C
.text:0040A022		       cmp     byte ptr	[esi+1], 32h
.text:0040A026		       jnz     short loc_40A03C
.text:0040A028		       inc     esi
.text:0040A029		       inc     esi
.text:0040A02A		       and     [ebp+290h+flags], 0FFFF7FFFh
.text:0040A034		       mov     [ebp+290h+var_240], esi
.text:0040A037		       jmp     loc_40A9F9
.text:0040A03C ; ---------------------------------------------------------------------------
.text:0040A03C
.text:0040A03C loc_40A03C:			       ; CODE XREF: __output_p_l+4E6j
.text:0040A03C					       ; __output_p_l+4ECj
.text:0040A03C		       cmp     al, 64h
.text:0040A03E		       jz      short loc_40A09B
.text:0040A040		       cmp     al, 69h
.text:0040A042		       jz      short loc_40A09B
.text:0040A044		       cmp     al, 6Fh
.text:0040A046		       jz      short loc_40A09B
.text:0040A048		       cmp     al, 75h
.text:0040A04A		       jz      short loc_40A09B
.text:0040A04C		       cmp     al, 78h
.text:0040A04E		       jz      short loc_40A09B
.text:0040A050		       cmp     al, 58h
.text:0040A052		       jz      short loc_40A09B
.text:0040A054		       mov     [ebp+290h+state], edi
.text:0040A057
.text:0040A057 NORMAL_STATE_1:			       ; CODE XREF: __output_p_l+296j
.text:0040A057					       ; __output_p_l+2A0j
.text:0040A057		       lea     eax, [ebp+290h+_loc_update] ; ch
.text:0040A05A		       push    eax	       ; plocinfo
.text:0040A05B		       movzx   eax, dl
.text:0040A05E		       push    eax	       ; c
.text:0040A05F		       mov     [ebp+290h+bufferiswide],	edi
.text:0040A062		       call    __isleadbyte_l
.text:0040A067		       pop     ecx
.text:0040A068		       test    eax, eax
.text:0040A06A		       mov     al, [ebp+290h+cur_type]
.text:0040A06D		       pop     ecx
.text:0040A06E		       jz      short loc_40A08B
.text:0040A070		       mov     ecx, [ebp+290h+f] ; f
.text:0040A073		       lea     esi, [ebp+290h+charsout]	; pnumwritten
.text:0040A076		       call    write_char_1
.text:0040A07B		       mov     eax, [ebp+290h+var_240]
.text:0040A07E		       mov     al, [eax]       ; ch
.text:0040A080		       inc     [ebp+290h+var_240]
.text:0040A083		       test    al, al
.text:0040A085		       jz      loc_40A415
.text:0040A08B
.text:0040A08B loc_40A08B:			       ; CODE XREF: __output_p_l+534j
.text:0040A08B		       mov     ecx, [ebp+290h+f] ; f
.text:0040A08E		       lea     esi, [ebp+290h+charsout]	; pnumwritten
.text:0040A091		       call    write_char_1
.text:0040A096		       jmp     loc_40A9F9
.text:0040A09B ; ---------------------------------------------------------------------------
.text:0040A09B
.text:0040A09B loc_40A09B:			       ; CODE XREF: __output_p_l+504j
.text:0040A09B					       ; __output_p_l+508j ...
.text:0040A09B		       or      [ebp+290h+flags], 10000h
.text:0040A0A5		       jmp     loc_40A9F9
.text:0040A0AA ; ---------------------------------------------------------------------------
.text:0040A0AA
.text:0040A0AA $LN209:				       ; CODE XREF: __output_p_l+26Aj
.text:0040A0AA					       ; DATA XREF: __output_p_l+F84o
.text:0040A0AA		       movsx   eax, dl
.text:0040A0AD		       cmp     eax, 64h
.text:0040A0B0		       jg      loc_40A2EF
.text:0040A0B6		       jz      loc_40A3C0
.text:0040A0BC		       cmp     eax, 53h
.text:0040A0BF		       jg      loc_40A187
.text:0040A0C5		       jz      loc_40A14D
.text:0040A0CB		       sub     eax, 41h
.text:0040A0CE		       jz      short loc_40A0E3
.text:0040A0D0		       push    2
.text:0040A0D2		       pop     esi
.text:0040A0D3		       sub     eax, esi
.text:0040A0D5		       jz      short loc_40A136
.text:0040A0D7		       sub     eax, esi
.text:0040A0D9		       jz      short loc_40A0E3
.text:0040A0DB		       sub     eax, esi
.text:0040A0DD		       jnz     loc_40A8C7
.text:0040A0E3
.text:0040A0E3 loc_40A0E3:			       ; CODE XREF: __output_p_l+594j
.text:0040A0E3					       ; __output_p_l+59Fj
.text:0040A0E3		       add     dl, 20h
.text:0040A0E6		       mov     [ebp+290h+capexp], ebx
.text:0040A0E9		       mov     [ebp+290h+cur_type], dl
.text:0040A0EC
.text:0040A0EC loc_40A0EC:			       ; CODE XREF: __output_p_l+661j
.text:0040A0EC					       ; __output_p_l+7D0j
.text:0040A0EC		       or      [ebp+290h+flags], 40h
.text:0040A0F3		       cmp     [ebp+290h+format_type], ebx
.text:0040A0F6		       jnz     loc_40A436
.text:0040A0FC		       cmp     [ebp+290h+pass],	edi
.text:0040A0FF		       jnz     loc_40A436
.text:0040A105		       cmp     [ebp+290h+type_pos], 63h
.text:0040A109		       ja      loc_40A415
.text:0040A10F		       mov     eax, [ebp+290h+type_pos]
.text:0040A112		       shl     eax, 4
.text:0040A115		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A11C		       cmp     [ecx], edi
.text:0040A11E		       jnz     loc_40A3F9
.text:0040A124		       mov     dword ptr [ecx],	8
.text:0040A12A		       mov     [ebp+eax+290h+pos_value.type], dl
.text:0040A131		       jmp     loc_409F80
.text:0040A136 ; ---------------------------------------------------------------------------
.text:0040A136
.text:0040A136 loc_40A136:			       ; CODE XREF: __output_p_l+59Bj
.text:0040A136		       test    word ptr	[ebp+290h+flags], 830h
.text:0040A13F		       jnz     short loc_40A1AC
.text:0040A141		       or      [ebp+290h+flags], 800h
.text:0040A14B		       jmp     short loc_40A1AC
.text:0040A14D ; ---------------------------------------------------------------------------
.text:0040A14D
.text:0040A14D loc_40A14D:			       ; CODE XREF: __output_p_l+58Bj
.text:0040A14D		       test    word ptr	[ebp+290h+flags], 830h
.text:0040A156		       jnz     short loc_40A162
.text:0040A158		       or      [ebp+290h+flags], 800h
.text:0040A162
.text:0040A162 loc_40A162:			       ; CODE XREF: __output_p_l+61Cj
.text:0040A162					       ; __output_p_l+A33j
.text:0040A162		       mov     ecx, [ebp+290h+precision]
.text:0040A165		       cmp     ecx, 0FFFFFFFFh
.text:0040A168		       jnz     short loc_40A16F
.text:0040A16A		       mov     ecx, 7FFFFFFFh
.text:0040A16F
.text:0040A16F loc_40A16F:			       ; CODE XREF: __output_p_l+62Ej
.text:0040A16F		       cmp     [ebp+290h+format_type], edi
.text:0040A172		       jnz     loc_40A832
.text:0040A178		       add     [ebp+290h+var_214], 4
.text:0040A17C		       mov     eax, [ebp+290h+var_214]
.text:0040A17F		       mov     eax, [eax-4]
.text:0040A182		       jmp     loc_40A853
.text:0040A187 ; ---------------------------------------------------------------------------
.text:0040A187
.text:0040A187 loc_40A187:			       ; CODE XREF: __output_p_l+585j
.text:0040A187		       sub     eax, 58h
.text:0040A18A		       jz      loc_40A561
.text:0040A190		       dec     eax
.text:0040A191		       dec     eax
.text:0040A192		       jz      loc_40A277
.text:0040A198		       sub     eax, 7
.text:0040A19B		       jz      loc_40A0EC
.text:0040A1A1		       dec     eax
.text:0040A1A2		       dec     eax
.text:0040A1A3		       jnz     loc_40A8C7
.text:0040A1A9		       push    2
.text:0040A1AB		       pop     esi
.text:0040A1AC
.text:0040A1AC loc_40A1AC:			       ; CODE XREF: __output_p_l+605j
.text:0040A1AC					       ; __output_p_l+611j
.text:0040A1AC		       test    word ptr	[ebp+290h+flags], 810h
.text:0040A1B5		       jz      short loc_40A22B
.text:0040A1B7		       cmp     [ebp+290h+format_type], edi
.text:0040A1BA		       jnz     short loc_40A1C9
.text:0040A1BC		       add     [ebp+290h+var_214], 4
.text:0040A1C0		       mov     eax, [ebp+290h+var_214]
.text:0040A1C3		       movzx   eax, word ptr [eax-4]
.text:0040A1C7		       jmp     short loc_40A209
.text:0040A1C9 ; ---------------------------------------------------------------------------
.text:0040A1C9
.text:0040A1C9 loc_40A1C9:			       ; CODE XREF: __output_p_l+680j
.text:0040A1C9		       cmp     [ebp+290h+type_pos], 63h
.text:0040A1CD		       ja      loc_40A415
.text:0040A1D3		       mov     eax, [ebp+290h+type_pos]
.text:0040A1D6		       shl     eax, 4
.text:0040A1D9		       cmp     [ebp+290h+pass],	edi
.text:0040A1DC		       jnz     short loc_40A1FF
.text:0040A1DE		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A1E5		       cmp     [ecx], edi
.text:0040A1E7		       jnz     short loc_40A1F0
.text:0040A1E9		       mov     [ecx], esi
.text:0040A1EB		       jmp     loc_40A87B
.text:0040A1F0 ; ---------------------------------------------------------------------------
.text:0040A1F0
.text:0040A1F0 loc_40A1F0:			       ; CODE XREF: __output_p_l+6ADj
.text:0040A1F0		       push    [ebp+290h+flags]
.text:0040A1F6		       push    dword ptr [ebp+290h+cur_type]
.text:0040A1F9		       push    esi
.text:0040A1FA		       jmp     loc_40A73A
.text:0040A1FF ; ---------------------------------------------------------------------------
.text:0040A1FF
.text:0040A1FF loc_40A1FF:			       ; CODE XREF: __output_p_l+6A2j
.text:0040A1FF		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A206		       movzx   eax, word ptr [eax]
.text:0040A209
.text:0040A209 loc_40A209:			       ; CODE XREF: __output_p_l+68Dj
.text:0040A209		       push    eax	       ; wchar
.text:0040A20A		       push    200h	       ; sizeInBytes
.text:0040A20F		       lea     eax, [ebp+290h+buffer]
.text:0040A215		       push    eax	       ; dst
.text:0040A216		       lea     eax, [ebp+290h+textlen]
.text:0040A219		       push    eax	       ; pRetValue
.text:0040A21A		       call    _wctomb_s
.text:0040A21F		       add     esp, 10h
.text:0040A222		       test    eax, eax
.text:0040A224		       jz      short loc_40A269
.text:0040A226		       mov     [ebp+290h+no_output], ebx
.text:0040A229		       jmp     short loc_40A269
.text:0040A22B ; ---------------------------------------------------------------------------
.text:0040A22B
.text:0040A22B loc_40A22B:			       ; CODE XREF: __output_p_l+67Bj
.text:0040A22B		       cmp     [ebp+290h+format_type], edi
.text:0040A22E		       jnz     short loc_40A23D
.text:0040A230		       add     [ebp+290h+var_214], 4
.text:0040A234		       mov     eax, [ebp+290h+var_214]
.text:0040A237		       movzx   eax, word ptr [eax-4]
.text:0040A23B		       jmp     short loc_40A260
.text:0040A23D ; ---------------------------------------------------------------------------
.text:0040A23D
.text:0040A23D loc_40A23D:			       ; CODE XREF: __output_p_l+6F4j
.text:0040A23D		       cmp     [ebp+290h+type_pos], 63h
.text:0040A241		       ja      loc_40A415
.text:0040A247		       mov     eax, [ebp+290h+type_pos]
.text:0040A24A		       shl     eax, 4
.text:0040A24D		       cmp     [ebp+290h+pass],	edi
.text:0040A250		       jz      loc_40A71E
.text:0040A256		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A25D		       movzx   eax, word ptr [eax]
.text:0040A260
.text:0040A260 loc_40A260:			       ; CODE XREF: __output_p_l+701j
.text:0040A260		       mov     byte ptr	[ebp+290h+buffer], al
.text:0040A266		       mov     [ebp+290h+textlen], ebx
.text:0040A269
.text:0040A269 loc_40A269:			       ; CODE XREF: __output_p_l+6EAj
.text:0040A269					       ; __output_p_l+6EFj
.text:0040A269		       lea     eax, [ebp+290h+buffer]
.text:0040A26F		       mov     dword ptr [ebp+290h+text], eax
.text:0040A272		       jmp     loc_40A8C7
.text:0040A277 ; ---------------------------------------------------------------------------
.text:0040A277
.text:0040A277 loc_40A277:			       ; CODE XREF: __output_p_l+658j
.text:0040A277		       cmp     [ebp+290h+format_type], edi
.text:0040A27A		       jnz     short loc_40A288
.text:0040A27C		       add     [ebp+290h+var_214], 4
.text:0040A280		       mov     eax, [ebp+290h+var_214]
.text:0040A283		       mov     eax, [eax-4]
.text:0040A286		       jmp     short loc_40A2AA
.text:0040A288 ; ---------------------------------------------------------------------------
.text:0040A288
.text:0040A288 loc_40A288:			       ; CODE XREF: __output_p_l+740j
.text:0040A288		       cmp     [ebp+290h+type_pos], 63h
.text:0040A28C		       ja      loc_40A415
.text:0040A292		       mov     eax, [ebp+290h+type_pos]
.text:0040A295		       shl     eax, 4
.text:0040A298		       cmp     [ebp+290h+pass],	edi
.text:0040A29B		       jz      loc_40A370
.text:0040A2A1		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A2A8		       mov     eax, [eax]
.text:0040A2AA
.text:0040A2AA loc_40A2AA:			       ; CODE XREF: __output_p_l+74Cj
.text:0040A2AA		       cmp     eax, edi
.text:0040A2AC		       jz      short loc_40A2DB
.text:0040A2AE		       mov     ecx, [eax+4]
.text:0040A2B1		       cmp     ecx, edi
.text:0040A2B3		       jz      short loc_40A2DB
.text:0040A2B5		       test    word ptr	[ebp+290h+flags], 800h
.text:0040A2BE		       movsx   eax, word ptr [eax]
.text:0040A2C1		       mov     dword ptr [ebp+290h+text], ecx
.text:0040A2C4		       jz      short loc_40A2D3
.text:0040A2C6		       cdq
.text:0040A2C7		       sub     eax, edx
.text:0040A2C9		       sar     eax, 1
.text:0040A2CB		       mov     [ebp+290h+bufferiswide],	ebx
.text:0040A2CE		       jmp     loc_40A8C4
.text:0040A2D3 ; ---------------------------------------------------------------------------
.text:0040A2D3
.text:0040A2D3 loc_40A2D3:			       ; CODE XREF: __output_p_l+78Aj
.text:0040A2D3		       mov     [ebp+290h+bufferiswide],	edi
.text:0040A2D6		       jmp     loc_40A8C4
.text:0040A2DB ; ---------------------------------------------------------------------------
.text:0040A2DB
.text:0040A2DB loc_40A2DB:			       ; CODE XREF: __output_p_l+772j
.text:0040A2DB					       ; __output_p_l+779j
.text:0040A2DB		       mov     eax, ___nullstring
.text:0040A2E0		       mov     dword ptr [ebp+290h+text], eax
.text:0040A2E3		       push    eax	       ; buf
.text:0040A2E4
.text:0040A2E4 loc_40A2E4:			       ; CODE XREF: __output_p_l+A1Bj
.text:0040A2E4		       call    _strlen
.text:0040A2E9		       pop     ecx
.text:0040A2EA		       jmp     loc_40A8C4
.text:0040A2EF ; ---------------------------------------------------------------------------
.text:0040A2EF
.text:0040A2EF loc_40A2EF:			       ; CODE XREF: __output_p_l+576j
.text:0040A2EF		       cmp     eax, 70h
.text:0040A2F2		       jg      loc_40A56A
.text:0040A2F8		       jz      loc_40A55A
.text:0040A2FE		       cmp     eax, 65h
.text:0040A301		       jl      loc_40A8C7
.text:0040A307		       cmp     eax, 67h
.text:0040A30A		       jle     loc_40A0EC
.text:0040A310		       cmp     eax, 69h
.text:0040A313		       jz      loc_40A3C0
.text:0040A319		       cmp     eax, 6Eh
.text:0040A31C		       jz      short loc_40A34A
.text:0040A31E		       cmp     eax, 6Fh
.text:0040A321		       jnz     loc_40A8C7
.text:0040A327		       test    byte ptr	[ebp+290h+flags], 80h
.text:0040A32E		       mov     [ebp+290h+count], 8
.text:0040A335		       jz      COMMON_INT_1
.text:0040A33B		       or      [ebp+290h+flags], 200h
.text:0040A345		       jmp     COMMON_INT_1
.text:0040A34A ; ---------------------------------------------------------------------------
.text:0040A34A
.text:0040A34A loc_40A34A:			       ; CODE XREF: __output_p_l+7E2j
.text:0040A34A		       cmp     [ebp+290h+format_type], edi
.text:0040A34D		       jnz     short loc_40A35B
.text:0040A34F		       add     [ebp+290h+var_214], 4
.text:0040A353		       mov     eax, [ebp+290h+var_214]
.text:0040A356		       mov     esi, [eax-4]
.text:0040A359		       jmp     short loc_40A398
.text:0040A35B ; ---------------------------------------------------------------------------
.text:0040A35B
.text:0040A35B loc_40A35B:			       ; CODE XREF: __output_p_l+813j
.text:0040A35B		       cmp     [ebp+290h+type_pos], 63h
.text:0040A35F		       ja      loc_40A415
.text:0040A365		       mov     eax, [ebp+290h+type_pos]
.text:0040A368		       shl     eax, 4
.text:0040A36B		       cmp     [ebp+290h+pass],	edi
.text:0040A36E		       jnz     short loc_40A38F
.text:0040A370
.text:0040A370 loc_40A370:			       ; CODE XREF: __output_p_l+761j
.text:0040A370					       ; __output_p_l+D0Aj
.text:0040A370		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A377		       cmp     [ecx], edi
.text:0040A379		       jz      loc_40A875
.text:0040A37F		       push    [ebp+290h+flags]
.text:0040A385		       push    dword ptr [ebp+290h+cur_type]
.text:0040A388		       push    3
.text:0040A38A		       jmp     loc_40A73A
.text:0040A38F ; ---------------------------------------------------------------------------
.text:0040A38F
.text:0040A38F loc_40A38F:			       ; CODE XREF: __output_p_l+834j
.text:0040A38F		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A396		       mov     esi, [eax]
.text:0040A398
.text:0040A398 loc_40A398:			       ; CODE XREF: __output_p_l+81Fj
.text:0040A398		       call    __get_printf_count_output
.text:0040A39D		       test    eax, eax
.text:0040A39F		       jz      short loc_40A415
.text:0040A3A1		       test    byte ptr	[ebp+290h+flags], 20h
.text:0040A3A8		       jz      short loc_40A3B3
.text:0040A3AA		       mov     ax, word	ptr [ebp+290h+charsout]
.text:0040A3AE		       mov     [esi], ax
.text:0040A3B1		       jmp     short loc_40A3B8
.text:0040A3B3 ; ---------------------------------------------------------------------------
.text:0040A3B3
.text:0040A3B3 loc_40A3B3:			       ; CODE XREF: __output_p_l+86Ej
.text:0040A3B3		       mov     eax, [ebp+290h+charsout]
.text:0040A3B6		       mov     [esi], eax
.text:0040A3B8
.text:0040A3B8 loc_40A3B8:			       ; CODE XREF: __output_p_l+877j
.text:0040A3B8		       mov     [ebp+290h+no_output], ebx
.text:0040A3BB		       jmp     loc_40A8C7
.text:0040A3C0 ; ---------------------------------------------------------------------------
.text:0040A3C0
.text:0040A3C0 loc_40A3C0:			       ; CODE XREF: __output_p_l+57Cj
.text:0040A3C0					       ; __output_p_l+7D9j
.text:0040A3C0		       or      [ebp+290h+flags], 40h
.text:0040A3C7
.text:0040A3C7 loc_40A3C7:			       ; CODE XREF: __output_p_l+A3Bj
.text:0040A3C7		       mov     [ebp+290h+count], 0Ah
.text:0040A3CE
.text:0040A3CE COMMON_INT_1:			       ; CODE XREF: __output_p_l+7FBj
.text:0040A3CE					       ; __output_p_l+80Bj ...
.text:0040A3CE		       mov     eax, [ebp+290h+flags]
.text:0040A3D4		       test    ax, ax
.text:0040A3D7		       jns     loc_40A5F2
.text:0040A3DD		       cmp     [ebp+290h+format_type], edi
.text:0040A3E0		       jnz     loc_40A5B7
.text:0040A3E6
.text:0040A3E6 loc_40A3E6:			       ; CODE XREF: __output_p_l+AC1j
.text:0040A3E6		       mov     ecx, [ebp+290h+var_214]
.text:0040A3E9		       mov     eax, [ecx]
.text:0040A3EB		       mov     edx, [ecx+4]
.text:0040A3EE		       add     ecx, 8
.text:0040A3F1		       mov     [ebp+290h+var_214], ecx
.text:0040A3F4		       jmp     loc_40A75B
.text:0040A3F9 ; ---------------------------------------------------------------------------
.text:0040A3F9
.text:0040A3F9 loc_40A3F9:			       ; CODE XREF: __output_p_l+5E4j
.text:0040A3F9		       push    [ebp+290h+flags]	; cur_flags
.text:0040A3FF		       push    dword ptr [ebp+290h+cur_type] ; cur_type
.text:0040A402		       push    8	       ; get_fn_type
.text:0040A404
.text:0040A404 loc_40A404:			       ; CODE XREF: __output_p_l+39Cj
.text:0040A404		       push    ecx	       ; pos
.text:0040A405		       call    __validate_param_reuseA
.text:0040A40A		       add     esp, 10h
.text:0040A40D		       test    eax, eax
.text:0040A40F		       jnz     loc_40A9F9
.text:0040A415
.text:0040A415 loc_40A415:			       ; CODE XREF: __output_p_l+242j
.text:0040A415					       ; __output_p_l+24Bj ...
.text:0040A415		       call    __errno
.text:0040A41A		       push    edi	       ; pReserved
.text:0040A41B		       push    edi	       ; nLine
.text:0040A41C		       push    edi	       ; pszFile
.text:0040A41D		       push    edi	       ; pszFunction
.text:0040A41E		       push    edi	       ; pszExpression
.text:0040A41F		       mov     dword ptr [eax],	16h
.text:0040A425		       call    __invalid_parameter
.text:0040A42A		       add     esp, 14h
.text:0040A42D		       cmp     [ebp+290h+_loc_update.updated], 0
.text:0040A431		       jmp     loc_409BBB
.text:0040A436 ; ---------------------------------------------------------------------------
.text:0040A436
.text:0040A436 loc_40A436:			       ; CODE XREF: __output_p_l+5BCj
.text:0040A436					       ; __output_p_l+5C5j
.text:0040A436		       cmp     [ebp+290h+precision], edi
.text:0040A439		       lea     eax, [ebp+290h+buffer]
.text:0040A43F		       mov     dword ptr [ebp+290h+text], eax
.text:0040A442		       mov     eax, 200h
.text:0040A447		       mov     [ebp+290h+count], eax
.text:0040A44A		       jge     short loc_40A455
.text:0040A44C		       mov     [ebp+290h+precision], 6
.text:0040A453		       jmp     short loc_40A45F
.text:0040A455 ; ---------------------------------------------------------------------------
.text:0040A455
.text:0040A455 loc_40A455:			       ; CODE XREF: __output_p_l+910j
.text:0040A455		       jnz     short loc_40A46F
.text:0040A457		       cmp     dl, 67h
.text:0040A45A		       jnz     short loc_40A45F
.text:0040A45C
.text:0040A45C loc_40A45C:			       ; CODE XREF: __output_p_l+95Fj
.text:0040A45C		       mov     [ebp+290h+precision], ebx
.text:0040A45F
.text:0040A45F loc_40A45F:			       ; CODE XREF: __output_p_l+919j
.text:0040A45F					       ; __output_p_l+920j ...
.text:0040A45F		       cmp     [ebp+290h+format_type], edi
.text:0040A462		       jnz     short loc_40A4A3
.text:0040A464		       mov     eax, [ebp+290h+var_214]
.text:0040A467		       add     eax, 8
.text:0040A46A		       mov     [ebp+290h+var_214], eax
.text:0040A46D		       jmp     short loc_40A4BD
.text:0040A46F ; ---------------------------------------------------------------------------
.text:0040A46F
.text:0040A46F loc_40A46F:			       ; CODE XREF: __output_p_l:loc_40A455j
.text:0040A46F		       cmp     [ebp+290h+precision], eax
.text:0040A472		       jle     short loc_40A477
.text:0040A474		       mov     [ebp+290h+precision], eax
.text:0040A477
.text:0040A477 loc_40A477:			       ; CODE XREF: __output_p_l+938j
.text:0040A477		       mov     ebx, 0A3h
.text:0040A47C		       cmp     [ebp+290h+precision], ebx
.text:0040A47F		       jle     short loc_40A45F
.text:0040A481		       mov     esi, [ebp+290h+precision]
.text:0040A484		       add     esi, 15Dh
.text:0040A48A		       push    esi	       ; cb
.text:0040A48B		       call    __malloc_crt
.text:0040A490		       cmp     eax, edi
.text:0040A492		       mov     dl, [ebp+290h+cur_type]
.text:0040A495		       pop     ecx
.text:0040A496		       mov     [ebp+290h+heapbuf], eax
.text:0040A499		       jz      short loc_40A45C
.text:0040A49B		       mov     dword ptr [ebp+290h+text], eax
.text:0040A49E		       mov     [ebp+290h+count], esi
.text:0040A4A1		       jmp     short loc_40A45F
.text:0040A4A3 ; ---------------------------------------------------------------------------
.text:0040A4A3
.text:0040A4A3 loc_40A4A3:			       ; CODE XREF: __output_p_l+928j
.text:0040A4A3		       cmp     [ebp+290h+type_pos], 63h
.text:0040A4A7		       ja      loc_40A415
.text:0040A4AD		       mov     eax, [ebp+290h+type_pos]
.text:0040A4B0		       shl     eax, 4
.text:0040A4B3		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A4BA		       add     eax, 8
.text:0040A4BD
.text:0040A4BD loc_40A4BD:			       ; CODE XREF: __output_p_l+933j
.text:0040A4BD		       mov     ecx, [eax-8]
.text:0040A4C0		       mov     dword ptr [ebp+290h+tmp.x], ecx
.text:0040A4C3		       mov     eax, [eax-4]
.text:0040A4C6		       mov     dword ptr [ebp+290h+tmp.x+4], eax
.text:0040A4C9		       lea     eax, [ebp+290h+_loc_update]
.text:0040A4CC		       push    eax
.text:0040A4CD		       push    [ebp+290h+capexp]
.text:0040A4D0		       movsx   eax, dl
.text:0040A4D3		       push    [ebp+290h+precision]
.text:0040A4D6		       push    eax
.text:0040A4D7		       push    [ebp+290h+count]
.text:0040A4DA		       lea     eax, [ebp+290h+tmp]
.text:0040A4DD		       push    dword ptr [ebp+290h+text]
.text:0040A4E0		       push    eax
.text:0040A4E1		       push    codedptr	       ; codedptr
.text:0040A4E7		       call    __decode_pointer
.text:0040A4EC		       pop     ecx
.text:0040A4ED		       call    eax
.text:0040A4EF		       mov     esi, [ebp+290h+flags]
.text:0040A4F5		       add     esp, 1Ch
.text:0040A4F8		       and     esi, 80h
.text:0040A4FE		       jz      short loc_40A51C
.text:0040A500		       cmp     [ebp+290h+precision], edi
.text:0040A503		       jnz     short loc_40A51C
.text:0040A505		       lea     eax, [ebp+290h+_loc_update]
.text:0040A508		       push    eax
.text:0040A509		       push    dword ptr [ebp+290h+text]
.text:0040A50C		       push    off_422694      ; codedptr
.text:0040A512		       call    __decode_pointer
.text:0040A517		       pop     ecx
.text:0040A518		       call    eax
.text:0040A51A		       pop     ecx
.text:0040A51B		       pop     ecx
.text:0040A51C
.text:0040A51C loc_40A51C:			       ; CODE XREF: __output_p_l+9C4j
.text:0040A51C					       ; __output_p_l+9C9j
.text:0040A51C		       cmp     [ebp+290h+cur_type], 67h
.text:0040A520		       jnz     short loc_40A53D
.text:0040A522		       cmp     esi, edi
.text:0040A524		       jnz     short loc_40A53D
.text:0040A526		       lea     eax, [ebp+290h+_loc_update]
.text:0040A529		       push    eax
.text:0040A52A		       push    dword ptr [ebp+290h+text]
.text:0040A52D		       push    off_422690      ; codedptr
.text:0040A533		       call    __decode_pointer
.text:0040A538		       pop     ecx
.text:0040A539		       call    eax
.text:0040A53B		       pop     ecx
.text:0040A53C		       pop     ecx
.text:0040A53D
.text:0040A53D loc_40A53D:			       ; CODE XREF: __output_p_l+9E6j
.text:0040A53D					       ; __output_p_l+9EAj
.text:0040A53D		       mov     eax, dword ptr [ebp+290h+text]
.text:0040A540		       cmp     byte ptr	[eax], 2Dh
.text:0040A543		       jnz     short loc_40A552
.text:0040A545		       or      [ebp+290h+flags], 100h
.text:0040A54F		       inc     dword ptr [ebp+290h+text]
.text:0040A552
.text:0040A552 loc_40A552:			       ; CODE XREF: __output_p_l+A09j
.text:0040A552		       push    dword ptr [ebp+290h+text]
.text:0040A555		       jmp     loc_40A2E4
.text:0040A55A ; ---------------------------------------------------------------------------
.text:0040A55A
.text:0040A55A loc_40A55A:			       ; CODE XREF: __output_p_l+7BEj
.text:0040A55A		       mov     [ebp+290h+precision], 8
.text:0040A561
.text:0040A561 loc_40A561:			       ; CODE XREF: __output_p_l+650j
.text:0040A561		       mov     [ebp+290h+hexadd], 7
.text:0040A568		       jmp     short COMMON_HEX_1
.text:0040A56A ; ---------------------------------------------------------------------------
.text:0040A56A
.text:0040A56A loc_40A56A:			       ; CODE XREF: __output_p_l+7B8j
.text:0040A56A		       sub     eax, 73h
.text:0040A56D		       jz      loc_40A162
.text:0040A573		       dec     eax
.text:0040A574		       dec     eax
.text:0040A575		       jz      loc_40A3C7
.text:0040A57B		       sub     eax, 3
.text:0040A57E		       jnz     loc_40A8C7
.text:0040A584		       mov     [ebp+290h+hexadd], 27h
.text:0040A58B
.text:0040A58B COMMON_HEX_1:			       ; CODE XREF: __output_p_l+A2Ej
.text:0040A58B		       test    byte ptr	[ebp+290h+flags], 80h
.text:0040A592		       mov     [ebp+290h+count], 10h
.text:0040A599		       jz      COMMON_INT_1
.text:0040A59F		       mov     al, byte	ptr [ebp+290h+hexadd]
.text:0040A5A2		       add     al, 51h
.text:0040A5A4		       mov     [ebp+290h+prefix], 30h
.text:0040A5A8		       mov     [ebp+290h+prefix+1], al
.text:0040A5AB		       mov     [ebp+290h+prefixlen], 2
.text:0040A5B2		       jmp     COMMON_INT_1
.text:0040A5B7 ; ---------------------------------------------------------------------------
.text:0040A5B7
.text:0040A5B7 loc_40A5B7:			       ; CODE XREF: __output_p_l+8A6j
.text:0040A5B7		       cmp     [ebp+290h+type_pos], 63h
.text:0040A5BB		       ja      loc_40A415
.text:0040A5C1		       mov     eax, [ebp+290h+type_pos]
.text:0040A5C4		       shl     eax, 4
.text:0040A5C7		       cmp     [ebp+290h+pass],	edi
.text:0040A5CA		       jnz     short loc_40A63C
.text:0040A5CC		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A5D3		       cmp     [ecx], edi
.text:0040A5D5		       jnz     short loc_40A5E2
.text:0040A5D7		       mov     dword ptr [ecx],	4
.text:0040A5DD		       jmp     loc_40A87B
.text:0040A5E2 ; ---------------------------------------------------------------------------
.text:0040A5E2
.text:0040A5E2 loc_40A5E2:			       ; CODE XREF: __output_p_l+A9Bj
.text:0040A5E2		       push    [ebp+290h+flags]
.text:0040A5E8		       push    dword ptr [ebp+290h+cur_type]
.text:0040A5EB		       push    4
.text:0040A5ED		       jmp     loc_40A73A
.text:0040A5F2 ; ---------------------------------------------------------------------------
.text:0040A5F2
.text:0040A5F2 loc_40A5F2:			       ; CODE XREF: __output_p_l+89Dj
.text:0040A5F2		       test    ax, 1000h
.text:0040A5F6		       jz      short loc_40A64D
.text:0040A5F8		       cmp     [ebp+290h+format_type], edi
.text:0040A5FB		       jz      loc_40A3E6
.text:0040A601		       cmp     [ebp+290h+type_pos], 63h
.text:0040A605		       ja      loc_40A415
.text:0040A60B		       mov     eax, [ebp+290h+type_pos]
.text:0040A60E		       shl     eax, 4
.text:0040A611		       cmp     [ebp+290h+pass],	edi
.text:0040A614		       jnz     short loc_40A63C
.text:0040A616		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A61D		       cmp     [ecx], edi
.text:0040A61F		       jnz     short loc_40A62C
.text:0040A621		       mov     dword ptr [ecx],	5
.text:0040A627		       jmp     loc_40A87B
.text:0040A62C ; ---------------------------------------------------------------------------
.text:0040A62C
.text:0040A62C loc_40A62C:			       ; CODE XREF: __output_p_l+AE5j
.text:0040A62C		       push    [ebp+290h+flags]
.text:0040A632		       push    dword ptr [ebp+290h+cur_type]
.text:0040A635		       push    5
.text:0040A637		       jmp     loc_40A73A
.text:0040A63C ; ---------------------------------------------------------------------------
.text:0040A63C
.text:0040A63C loc_40A63C:			       ; CODE XREF: __output_p_l+A90j
.text:0040A63C					       ; __output_p_l+ADAj
.text:0040A63C		       mov     ecx, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A643		       mov     eax, [ecx]
.text:0040A645		       mov     edx, [ecx+4]
.text:0040A648		       jmp     loc_40A75B
.text:0040A64D ; ---------------------------------------------------------------------------
.text:0040A64D
.text:0040A64D loc_40A64D:			       ; CODE XREF: __output_p_l+ABCj
.text:0040A64D		       test    al, 20h
.text:0040A64F		       jz      short loc_40A6C2
.text:0040A651		       test    al, 40h
.text:0040A653		       jz      short loc_40A68F
.text:0040A655		       cmp     [ebp+290h+format_type], edi
.text:0040A658		       jnz     short loc_40A66A
.text:0040A65A		       add     [ebp+290h+var_214], 4
.text:0040A65E		       mov     eax, [ebp+290h+var_214]
.text:0040A661		       movsx   eax, word ptr [eax-4]
.text:0040A665		       jmp     loc_40A6F5
.text:0040A66A ; ---------------------------------------------------------------------------
.text:0040A66A
.text:0040A66A loc_40A66A:			       ; CODE XREF: __output_p_l+B1Ej
.text:0040A66A		       cmp     [ebp+290h+type_pos], 63h
.text:0040A66E		       ja      loc_40A415
.text:0040A674		       mov     eax, [ebp+290h+type_pos]
.text:0040A677		       shl     eax, 4
.text:0040A67A		       cmp     [ebp+290h+pass],	edi
.text:0040A67D		       jz      loc_40A71E
.text:0040A683		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A68A		       movsx   eax, word ptr [eax]
.text:0040A68D		       jmp     short loc_40A6F5
.text:0040A68F ; ---------------------------------------------------------------------------
.text:0040A68F
.text:0040A68F loc_40A68F:			       ; CODE XREF: __output_p_l+B19j
.text:0040A68F		       cmp     [ebp+290h+format_type], edi
.text:0040A692		       jnz     short loc_40A6A1
.text:0040A694		       add     [ebp+290h+var_214], 4
.text:0040A698		       mov     eax, [ebp+290h+var_214]
.text:0040A69B		       movzx   eax, word ptr [eax-4]
.text:0040A69F		       jmp     short loc_40A6F5
.text:0040A6A1 ; ---------------------------------------------------------------------------
.text:0040A6A1
.text:0040A6A1 loc_40A6A1:			       ; CODE XREF: __output_p_l+B58j
.text:0040A6A1		       cmp     [ebp+290h+type_pos], 63h
.text:0040A6A5		       ja      loc_40A415
.text:0040A6AB		       mov     eax, [ebp+290h+type_pos]
.text:0040A6AE		       shl     eax, 4
.text:0040A6B1		       cmp     [ebp+290h+pass],	edi
.text:0040A6B4		       jz      short loc_40A71E
.text:0040A6B6		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A6BD		       movzx   eax, word ptr [eax]
.text:0040A6C0		       jmp     short loc_40A6F5
.text:0040A6C2 ; ---------------------------------------------------------------------------
.text:0040A6C2
.text:0040A6C2 loc_40A6C2:			       ; CODE XREF: __output_p_l+B15j
.text:0040A6C2		       test    al, 40h
.text:0040A6C4		       jz      short loc_40A6F8
.text:0040A6C6		       cmp     [ebp+290h+format_type], edi
.text:0040A6C9		       jnz     short loc_40A6D7
.text:0040A6CB		       add     [ebp+290h+var_214], 4
.text:0040A6CF		       mov     eax, [ebp+290h+var_214]
.text:0040A6D2		       mov     eax, [eax-4]
.text:0040A6D5		       jmp     short loc_40A6F5
.text:0040A6D7 ; ---------------------------------------------------------------------------
.text:0040A6D7
.text:0040A6D7 loc_40A6D7:			       ; CODE XREF: __output_p_l+B8Fj
.text:0040A6D7		       cmp     [ebp+290h+type_pos], 63h
.text:0040A6DB		       ja      loc_40A415
.text:0040A6E1		       mov     eax, [ebp+290h+type_pos]
.text:0040A6E4		       shl     eax, 4
.text:0040A6E7		       cmp     [ebp+290h+pass],	edi
.text:0040A6EA		       jz      short loc_40A71E
.text:0040A6EC		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A6F3		       mov     eax, [eax]
.text:0040A6F5
.text:0040A6F5 loc_40A6F5:			       ; CODE XREF: __output_p_l+B2Bj
.text:0040A6F5					       ; __output_p_l+B53j ...
.text:0040A6F5		       cdq
.text:0040A6F6		       jmp     short loc_40A75B
.text:0040A6F8 ; ---------------------------------------------------------------------------
.text:0040A6F8
.text:0040A6F8 loc_40A6F8:			       ; CODE XREF: __output_p_l+B8Aj
.text:0040A6F8		       cmp     [ebp+290h+format_type], edi
.text:0040A6FB		       jnz     short loc_40A709
.text:0040A6FD		       add     [ebp+290h+var_214], 4
.text:0040A701		       mov     eax, [ebp+290h+var_214]
.text:0040A704		       mov     eax, [eax-4]
.text:0040A707		       jmp     short loc_40A759
.text:0040A709 ; ---------------------------------------------------------------------------
.text:0040A709
.text:0040A709 loc_40A709:			       ; CODE XREF: __output_p_l+BC1j
.text:0040A709		       cmp     [ebp+290h+type_pos], 63h
.text:0040A70D		       ja      loc_40A415
.text:0040A713		       mov     eax, [ebp+290h+type_pos]
.text:0040A716		       shl     eax, 4
.text:0040A719		       cmp     [ebp+290h+pass],	edi
.text:0040A71C		       jnz     short loc_40A750
.text:0040A71E
.text:0040A71E loc_40A71E:			       ; CODE XREF: __output_p_l+716j
.text:0040A71E					       ; __output_p_l+B43j ...
.text:0040A71E		       lea     ecx, [ebp+eax+290h+pos_value]
.text:0040A725		       cmp     [ecx], edi
.text:0040A727		       jnz     short loc_40A730
.text:0040A729		       mov     [ecx], ebx
.text:0040A72B		       jmp     loc_40A87B
.text:0040A730 ; ---------------------------------------------------------------------------
.text:0040A730
.text:0040A730 loc_40A730:			       ; CODE XREF: __output_p_l+BEDj
.text:0040A730		       push    [ebp+290h+flags]	; cur_flags
.text:0040A736		       push    dword ptr [ebp+290h+cur_type] ; cur_type
.text:0040A739		       push    ebx	       ; get_fn_type
.text:0040A73A
.text:0040A73A loc_40A73A:			       ; CODE XREF: __output_p_l+6C0j
.text:0040A73A					       ; __output_p_l+850j ...
.text:0040A73A		       push    ecx	       ; pos
.text:0040A73B		       call    __validate_param_reuseA
.text:0040A740		       add     esp, 10h
.text:0040A743		       test    eax, eax
.text:0040A745		       jz      loc_40A415
.text:0040A74B		       jmp     loc_40A8C7
.text:0040A750 ; ---------------------------------------------------------------------------
.text:0040A750
.text:0040A750 loc_40A750:			       ; CODE XREF: __output_p_l+BE2j
.text:0040A750		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A757		       mov     eax, [eax]
.text:0040A759
.text:0040A759 loc_40A759:			       ; CODE XREF: __output_p_l+BCDj
.text:0040A759		       xor     edx, edx
.text:0040A75B
.text:0040A75B loc_40A75B:			       ; CODE XREF: __output_p_l+8BAj
.text:0040A75B					       ; __output_p_l+B0Ej ...
.text:0040A75B		       test    byte ptr	[ebp+290h+flags], 40h
.text:0040A762		       jz      short loc_40A77F
.text:0040A764		       cmp     edx, edi
.text:0040A766		       jg      short loc_40A77F
.text:0040A768		       jl      short loc_40A76E
.text:0040A76A		       cmp     eax, edi
.text:0040A76C		       jnb     short loc_40A77F
.text:0040A76E
.text:0040A76E loc_40A76E:			       ; CODE XREF: __output_p_l+C2Ej
.text:0040A76E		       neg     eax
.text:0040A770		       adc     edx, 0
.text:0040A773		       neg     edx
.text:0040A775		       or      [ebp+290h+flags], 100h
.text:0040A77F
.text:0040A77F loc_40A77F:			       ; CODE XREF: __output_p_l+C28j
.text:0040A77F					       ; __output_p_l+C2Cj ...
.text:0040A77F		       test    word ptr	[ebp+290h+flags], 9000h
.text:0040A788		       mov     ebx, edx
.text:0040A78A		       mov     edi, eax
.text:0040A78C		       jnz     short loc_40A790
.text:0040A78E		       xor     ebx, ebx
.text:0040A790
.text:0040A790 loc_40A790:			       ; CODE XREF: __output_p_l+C52j
.text:0040A790		       cmp     [ebp+290h+precision], 0
.text:0040A794		       jge     short loc_40A79F
.text:0040A796		       mov     [ebp+290h+precision], 1
.text:0040A79D		       jmp     short loc_40A7B3
.text:0040A79F ; ---------------------------------------------------------------------------
.text:0040A79F
.text:0040A79F loc_40A79F:			       ; CODE XREF: __output_p_l+C5Aj
.text:0040A79F		       and     [ebp+290h+flags], 0FFFFFFF7h
.text:0040A7A6		       mov     eax, 200h
.text:0040A7AB		       cmp     [ebp+290h+precision], eax
.text:0040A7AE		       jle     short loc_40A7B3
.text:0040A7B0		       mov     [ebp+290h+precision], eax
.text:0040A7B3
.text:0040A7B3 loc_40A7B3:			       ; CODE XREF: __output_p_l+C63j
.text:0040A7B3					       ; __output_p_l+C74j
.text:0040A7B3		       mov     eax, edi
.text:0040A7B5		       or      eax, ebx
.text:0040A7B7		       jnz     short loc_40A7BC
.text:0040A7B9		       and     [ebp+290h+prefixlen], eax
.text:0040A7BC
.text:0040A7BC loc_40A7BC:			       ; CODE XREF: __output_p_l+C7Dj
.text:0040A7BC		       lea     esi, [ebp+290h+buffer+1FFh]
.text:0040A7C2
.text:0040A7C2 loc_40A7C2:			       ; CODE XREF: __output_p_l+CBAj
.text:0040A7C2		       mov     eax, [ebp+290h+precision]
.text:0040A7C5		       dec     [ebp+290h+precision]
.text:0040A7C8		       test    eax, eax
.text:0040A7CA		       jg      short loc_40A7D2
.text:0040A7CC		       mov     eax, edi
.text:0040A7CE		       or      eax, ebx
.text:0040A7D0		       jz      short loc_40A7F6
.text:0040A7D2
.text:0040A7D2 loc_40A7D2:			       ; CODE XREF: __output_p_l+C90j
.text:0040A7D2		       mov     eax, [ebp+290h+count]
.text:0040A7D5		       cdq
.text:0040A7D6		       push    edx
.text:0040A7D7		       push    eax
.text:0040A7D8		       push    ebx
.text:0040A7D9		       push    edi
.text:0040A7DA		       call    __aulldvrm
.text:0040A7DF		       add     ecx, 30h
.text:0040A7E2		       cmp     ecx, 39h
.text:0040A7E5		       mov     [ebp+290h+textlen], ebx
.text:0040A7E8		       mov     edi, eax	       ; f
.text:0040A7EA		       mov     ebx, edx
.text:0040A7EC		       jle     short loc_40A7F1
.text:0040A7EE		       add     ecx, [ebp+290h+hexadd]
.text:0040A7F1
.text:0040A7F1 loc_40A7F1:			       ; CODE XREF: __output_p_l+CB2j
.text:0040A7F1		       mov     [esi], cl
.text:0040A7F3		       dec     esi
.text:0040A7F4		       jmp     short loc_40A7C2
.text:0040A7F6 ; ---------------------------------------------------------------------------
.text:0040A7F6
.text:0040A7F6 loc_40A7F6:			       ; CODE XREF: __output_p_l+C96j
.text:0040A7F6		       lea     eax, [ebp+290h+buffer+1FFh]
.text:0040A7FC		       sub     eax, esi
.text:0040A7FE		       inc     esi
.text:0040A7FF		       test    word ptr	[ebp+290h+flags], 200h
.text:0040A808		       mov     [ebp+290h+textlen], eax
.text:0040A80B		       mov     dword ptr [ebp+290h+text], esi
.text:0040A80E		       jz      loc_40A8C7
.text:0040A814		       test    eax, eax
.text:0040A816		       jz      short loc_40A823
.text:0040A818		       mov     ecx, esi
.text:0040A81A		       cmp     byte ptr	[ecx], 30h
.text:0040A81D		       jz      loc_40A8C7
.text:0040A823
.text:0040A823 loc_40A823:			       ; CODE XREF: __output_p_l+CDCj
.text:0040A823		       dec     dword ptr [ebp+290h+text]
.text:0040A826		       mov     ecx, dword ptr [ebp+290h+text]
.text:0040A829		       mov     byte ptr	[ecx], 30h
.text:0040A82C		       inc     eax
.text:0040A82D		       jmp     loc_40A8C4
.text:0040A832 ; ---------------------------------------------------------------------------
.text:0040A832
.text:0040A832 loc_40A832:			       ; CODE XREF: __output_p_l+638j
.text:0040A832		       mov     eax, [ebp+290h+type_pos]
.text:0040A835		       cmp     eax, 63h
.text:0040A838		       ja      loc_40A415
.text:0040A83E		       shl     eax, 4
.text:0040A841		       cmp     [ebp+290h+pass],	edi
.text:0040A844		       jz      loc_40A370
.text:0040A84A		       mov     eax, [ebp+eax+290h+pos_value.arg_ptr]
.text:0040A851		       mov     eax, [eax]
.text:0040A853
.text:0040A853 loc_40A853:			       ; CODE XREF: __output_p_l+648j
.text:0040A853		       test    word ptr	[ebp+290h+flags], 810h
.text:0040A85C		       mov     dword ptr [ebp+290h+text], eax
.text:0040A85F		       jz      short loc_40A8A4
.text:0040A861		       cmp     eax, edi
.text:0040A863		       jnz     short loc_40A86D
.text:0040A865		       mov     eax, ___wnullstring
.text:0040A86A		       mov     dword ptr [ebp+290h+text], eax
.text:0040A86D
.text:0040A86D loc_40A86D:			       ; CODE XREF: __output_p_l+D29j
.text:0040A86D		       mov     eax, dword ptr [ebp+290h+text]
.text:0040A870		       mov     [ebp+290h+bufferiswide],	ebx
.text:0040A873		       jmp     short loc_40A899
.text:0040A875 ; ---------------------------------------------------------------------------
.text:0040A875
.text:0040A875 loc_40A875:			       ; CODE XREF: __output_p_l+83Fj
.text:0040A875		       mov     dword ptr [ecx],	3
.text:0040A87B
.text:0040A87B loc_40A87B:			       ; CODE XREF: __output_p_l+6B1j
.text:0040A87B					       ; __output_p_l+AA3j ...
.text:0040A87B		       mov     ecx, [ebp+290h+flags]
.text:0040A881		       mov     [ebp+eax+290h+pos_value.type], dl
.text:0040A888		       mov     [ebp+eax+290h+pos_value.flags], ecx
.text:0040A88F		       jmp     short loc_40A8C7
.text:0040A891 ; ---------------------------------------------------------------------------
.text:0040A891
.text:0040A891 loc_40A891:			       ; CODE XREF: __output_p_l+D61j
.text:0040A891		       dec     ecx
.text:0040A892		       cmp     [eax], di
.text:0040A895		       jz      short loc_40A89D
.text:0040A897		       inc     eax
.text:0040A898		       inc     eax
.text:0040A899
.text:0040A899 loc_40A899:			       ; CODE XREF: __output_p_l+D39j
.text:0040A899		       cmp     ecx, edi
.text:0040A89B		       jnz     short loc_40A891
.text:0040A89D
.text:0040A89D loc_40A89D:			       ; CODE XREF: __output_p_l+D5Bj
.text:0040A89D		       sub     eax, dword ptr [ebp+290h+text]
.text:0040A8A0		       sar     eax, 1
.text:0040A8A2		       jmp     short loc_40A8C4
.text:0040A8A4 ; ---------------------------------------------------------------------------
.text:0040A8A4
.text:0040A8A4 loc_40A8A4:			       ; CODE XREF: __output_p_l+D25j
.text:0040A8A4		       cmp     dword ptr [ebp+290h+text], edi
.text:0040A8A7		       jnz     short loc_40A8B1
.text:0040A8A9		       mov     eax, ___nullstring
.text:0040A8AE		       mov     dword ptr [ebp+290h+text], eax
.text:0040A8B1
.text:0040A8B1 loc_40A8B1:			       ; CODE XREF: __output_p_l+D6Dj
.text:0040A8B1		       mov     eax, dword ptr [ebp+290h+text]
.text:0040A8B4		       jmp     short loc_40A8BD
.text:0040A8B6 ; ---------------------------------------------------------------------------
.text:0040A8B6
.text:0040A8B6 loc_40A8B6:			       ; CODE XREF: __output_p_l+D85j
.text:0040A8B6		       dec     ecx
.text:0040A8B7		       cmp     byte ptr	[eax], 0
.text:0040A8BA		       jz      short loc_40A8C1
.text:0040A8BC		       inc     eax
.text:0040A8BD
.text:0040A8BD loc_40A8BD:			       ; CODE XREF: __output_p_l+D7Aj
.text:0040A8BD		       cmp     ecx, edi
.text:0040A8BF		       jnz     short loc_40A8B6
.text:0040A8C1
.text:0040A8C1 loc_40A8C1:			       ; CODE XREF: __output_p_l+D80j
.text:0040A8C1		       sub     eax, dword ptr [ebp+290h+text]
.text:0040A8C4
.text:0040A8C4 loc_40A8C4:			       ; CODE XREF: __output_p_l+794j
.text:0040A8C4					       ; __output_p_l+79Cj ...
.text:0040A8C4		       mov     [ebp+290h+textlen], eax
.text:0040A8C7
.text:0040A8C7 loc_40A8C7:			       ; CODE XREF: __output_p_l+5A3j
.text:0040A8C7					       ; __output_p_l+669j ...
.text:0040A8C7		       cmp     [ebp+290h+format_type], 1
.text:0040A8CB		       jnz     short loc_40A8D7
.text:0040A8CD		       cmp     [ebp+290h+pass],	0
.text:0040A8D1		       jz      loc_40A9F9
.text:0040A8D7
.text:0040A8D7 loc_40A8D7:			       ; CODE XREF: __output_p_l+D91j
.text:0040A8D7		       cmp     [ebp+290h+no_output], 0
.text:0040A8DB		       jnz     loc_40A9E6
.text:0040A8E1		       mov     eax, [ebp+290h+flags]
.text:0040A8E7		       test    al, 40h
.text:0040A8E9		       jz      short loc_40A910
.text:0040A8EB		       test    ax, 100h
.text:0040A8EF		       jz      short loc_40A8F7
.text:0040A8F1		       mov     [ebp+290h+prefix], 2Dh
.text:0040A8F5		       jmp     short loc_40A909
.text:0040A8F7 ; ---------------------------------------------------------------------------
.text:0040A8F7
.text:0040A8F7 loc_40A8F7:			       ; CODE XREF: __output_p_l+DB5j
.text:0040A8F7		       test    al, 1
.text:0040A8F9		       jz      short loc_40A901
.text:0040A8FB		       mov     [ebp+290h+prefix], 2Bh
.text:0040A8FF		       jmp     short loc_40A909
.text:0040A901 ; ---------------------------------------------------------------------------
.text:0040A901
.text:0040A901 loc_40A901:			       ; CODE XREF: __output_p_l+DBFj
.text:0040A901		       test    al, 2
.text:0040A903		       jz      short loc_40A910
.text:0040A905		       mov     [ebp+290h+prefix], 20h
.text:0040A909
.text:0040A909 loc_40A909:			       ; CODE XREF: __output_p_l+DBBj
.text:0040A909					       ; __output_p_l+DC5j
.text:0040A909		       mov     [ebp+290h+prefixlen], 1
.text:0040A910
.text:0040A910 loc_40A910:			       ; CODE XREF: __output_p_l+DAFj
.text:0040A910					       ; __output_p_l+DC9j
.text:0040A910		       mov     ebx, [ebp+290h+fldwidth]
.text:0040A913		       sub     ebx, [ebp+290h+textlen]
.text:0040A916		       sub     ebx, [ebp+290h+prefixlen]
.text:0040A919		       test    al, 0Ch
.text:0040A91B		       jnz     short loc_40A92E
.text:0040A91D		       push    [ebp+290h+f]    ; f
.text:0040A920		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A923		       push    ebx	       ; num
.text:0040A924		       push    20h	       ; ch
.text:0040A926		       call    write_multi_char_1
.text:0040A92B		       add     esp, 0Ch
.text:0040A92E
.text:0040A92E loc_40A92E:			       ; CODE XREF: __output_p_l+DE1j
.text:0040A92E		       push    [ebp+290h+prefixlen] ; len
.text:0040A931		       mov     edi, [ebp+290h+f] ; f
.text:0040A934		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A937		       lea     ecx, [ebp+290h+prefix] ;	string
.text:0040A93A		       call    write_string_1
.text:0040A93F		       test    byte ptr	[ebp+290h+flags], 8
.text:0040A946		       pop     ecx
.text:0040A947		       jz      short loc_40A961
.text:0040A949		       test    byte ptr	[ebp+290h+flags], 4
.text:0040A950		       jnz     short loc_40A961
.text:0040A952		       push    edi	       ; f
.text:0040A953		       push    ebx	       ; num
.text:0040A954		       push    30h	       ; ch
.text:0040A956		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A959		       call    write_multi_char_1
.text:0040A95E		       add     esp, 0Ch
.text:0040A961
.text:0040A961 loc_40A961:			       ; CODE XREF: __output_p_l+E0Dj
.text:0040A961					       ; __output_p_l+E16j
.text:0040A961		       cmp     [ebp+290h+bufferiswide],	0
.text:0040A965		       mov     eax, [ebp+290h+textlen]
.text:0040A968		       jz      short loc_40A9BB
.text:0040A96A		       test    eax, eax
.text:0040A96C		       jle     short loc_40A9BB
.text:0040A96E		       mov     esi, dword ptr [ebp+290h+text]
.text:0040A971		       mov     [ebp+290h+count], eax
.text:0040A974
.text:0040A974 loc_40A974:			       ; CODE XREF: __output_p_l+E77j
.text:0040A974		       movzx   eax, word ptr [esi]
.text:0040A977		       dec     [ebp+290h+count]
.text:0040A97A		       push    eax	       ; wchar
.text:0040A97B		       push    6	       ; sizeInBytes
.text:0040A97D		       lea     eax, [ebp+290h+L_buffer]
.text:0040A983		       push    eax	       ; dst
.text:0040A984		       lea     eax, [ebp+290h+retval]
.text:0040A987		       inc     esi
.text:0040A988		       push    eax	       ; pRetValue
.text:0040A989		       inc     esi
.text:0040A98A		       call    _wctomb_s
.text:0040A98F		       add     esp, 10h
.text:0040A992		       test    eax, eax
.text:0040A994		       jnz     short loc_40A9B5
.text:0040A996		       cmp     [ebp+290h+retval], eax
.text:0040A999		       jz      short loc_40A9B5
.text:0040A99B		       push    [ebp+290h+retval] ; len
.text:0040A99E		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A9A1		       lea     ecx, [ebp+290h+L_buffer]	; string
.text:0040A9A7		       call    write_string_1
.text:0040A9AC		       cmp     [ebp+290h+count], 0
.text:0040A9B0		       pop     ecx
.text:0040A9B1		       jnz     short loc_40A974
.text:0040A9B3		       jmp     short loc_40A9C8
.text:0040A9B5 ; ---------------------------------------------------------------------------
.text:0040A9B5
.text:0040A9B5 loc_40A9B5:			       ; CODE XREF: __output_p_l+E5Aj
.text:0040A9B5					       ; __output_p_l+E5Fj
.text:0040A9B5		       or      [ebp+290h+charsout], 0FFFFFFFFh
.text:0040A9B9		       jmp     short loc_40A9C8
.text:0040A9BB ; ---------------------------------------------------------------------------
.text:0040A9BB
.text:0040A9BB loc_40A9BB:			       ; CODE XREF: __output_p_l+E2Ej
.text:0040A9BB					       ; __output_p_l+E32j
.text:0040A9BB		       mov     ecx, dword ptr [ebp+290h+text] ;	string
.text:0040A9BE		       push    eax	       ; len
.text:0040A9BF		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A9C2		       call    write_string_1
.text:0040A9C7		       pop     ecx
.text:0040A9C8
.text:0040A9C8 loc_40A9C8:			       ; CODE XREF: __output_p_l+E79j
.text:0040A9C8					       ; __output_p_l+E7Fj
.text:0040A9C8		       cmp     [ebp+290h+charsout], 0
.text:0040A9CC		       jl      short loc_40A9E6
.text:0040A9CE		       test    byte ptr	[ebp+290h+flags], 4
.text:0040A9D5		       jz      short loc_40A9E6
.text:0040A9D7		       push    edi	       ; f
.text:0040A9D8		       push    ebx	       ; num
.text:0040A9D9		       push    20h	       ; ch
.text:0040A9DB		       lea     eax, [ebp+290h+charsout]	; pnumwritten
.text:0040A9DE		       call    write_multi_char_1
.text:0040A9E3		       add     esp, 0Ch
.text:0040A9E6
.text:0040A9E6 loc_40A9E6:			       ; CODE XREF: __output_p_l+DA1j
.text:0040A9E6					       ; __output_p_l+E92j ...
.text:0040A9E6		       cmp     [ebp+290h+heapbuf], 0
.text:0040A9EA		       jz      short loc_40A9F9
.text:0040A9EC		       push    [ebp+290h+heapbuf] ; pBlock
.text:0040A9EF		       call    _free
.text:0040A9F4		       and     [ebp+290h+heapbuf], 0
.text:0040A9F8		       pop     ecx
.text:0040A9F9
.text:0040A9F9 loc_40A9F9:			       ; CODE XREF: __output_p_l+27Dj
.text:0040A9F9					       ; __output_p_l+28Dj ...
.text:0040A9F9		       mov     esi, [ebp+290h+var_240]
.text:0040A9FC		       mov     al, [esi]
.text:0040A9FE		       test    al, al
.text:0040AA00		       mov     [ebp+290h+cur_type], al
.text:0040AA03		       jnz     loc_409CBB
.text:0040AA09		       xor     edi, edi
.text:0040AA0B
.text:0040AA0B loc_40AA0B:			       ; CODE XREF: __output_p_l+18Dj
.text:0040AA0B		       cmp     [ebp+290h+state], edi
.text:0040AA0E		       jz      short loc_40AA1A
.text:0040AA10		       cmp     [ebp+290h+state], 7
.text:0040AA14		       jnz     loc_40A415
.text:0040AA1A
.text:0040AA1A loc_40AA1A:			       ; CODE XREF: __output_p_l+ED4j
.text:0040AA1A		       cmp     [ebp+290h+format_type], 1
.text:0040AA1E		       jnz     short loc_40AA6A
.text:0040AA20		       cmp     [ebp+290h+pass],	edi
.text:0040AA23		       jnz     short loc_40AA6A
.text:0040AA25		       xor     esi, esi
.text:0040AA27		       cmp     [ebp+290h+max_pos], edi
.text:0040AA2A		       jl      short loc_40AA6A
.text:0040AA2C		       mov     edx, [ebp+290h+var_214]
.text:0040AA2F		       lea     eax, [ebp+290h+pos_value.arg_ptr]
.text:0040AA35
.text:0040AA35 loc_40AA35:			       ; CODE XREF: __output_p_l+F2Ej
.text:0040AA35		       mov     ecx, [eax-4]
.text:0040AA38		       dec     ecx
.text:0040AA39		       jz      short loc_40AA59
.text:0040AA3B		       dec     ecx
.text:0040AA3C		       jz      short loc_40AA59
.text:0040AA3E		       dec     ecx
.text:0040AA3F		       jz      short loc_40AA59
.text:0040AA41		       dec     ecx
.text:0040AA42		       jz      short loc_40AA52
.text:0040AA44		       dec     ecx
.text:0040AA45		       jz      short loc_40AA52
.text:0040AA47		       dec     ecx
.text:0040AA48		       jz      short loc_40AA59
.text:0040AA4A		       dec     ecx
.text:0040AA4B		       dec     ecx
.text:0040AA4C		       jnz     loc_40A415
.text:0040AA52
.text:0040AA52 loc_40AA52:			       ; CODE XREF: __output_p_l+F08j
.text:0040AA52					       ; __output_p_l+F0Bj
.text:0040AA52		       mov     [eax], edx
.text:0040AA54		       add     edx, 8
.text:0040AA57		       jmp     short loc_40AA5E
.text:0040AA59 ; ---------------------------------------------------------------------------
.text:0040AA59
.text:0040AA59 loc_40AA59:			       ; CODE XREF: __output_p_l+EFFj
.text:0040AA59					       ; __output_p_l+F02j ...
.text:0040AA59		       mov     [eax], edx
.text:0040AA5B		       add     edx, 4
.text:0040AA5E
.text:0040AA5E loc_40AA5E:			       ; CODE XREF: __output_p_l+F1Dj
.text:0040AA5E		       inc     esi
.text:0040AA5F		       add     eax, 10h
.text:0040AA62		       cmp     esi, [ebp+290h+max_pos]
.text:0040AA65		       mov     [ebp+290h+var_214], edx
.text:0040AA68		       jle     short loc_40AA35
.text:0040AA6A
.text:0040AA6A loc_40AA6A:			       ; CODE XREF: __output_p_l+177j
.text:0040AA6A					       ; __output_p_l+EE4j ...
.text:0040AA6A		       inc     [ebp+290h+pass]
.text:0040AA6D		       cmp     [ebp+290h+pass],	2
.text:0040AA71		       jge     short loc_40AA7A
.text:0040AA73		       xor     ebx, ebx
.text:0040AA75		       jmp     loc_409C78
.text:0040AA7A ; ---------------------------------------------------------------------------
.text:0040AA7A
.text:0040AA7A loc_40AA7A:			       ; CODE XREF: __output_p_l+147j
.text:0040AA7A					       ; __output_p_l+F37j
.text:0040AA7A		       cmp     [ebp+290h+_loc_update.updated], 0
.text:0040AA7E		       jz      short loc_40AA87
.text:0040AA80		       mov     eax, [ebp+290h+_loc_update.ptd]
.text:0040AA83		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040AA87
.text:0040AA87 loc_40AA87:			       ; CODE XREF: __output_p_l+F44j
.text:0040AA87		       mov     eax, [ebp+290h+charsout]
.text:0040AA8A
.text:0040AA8A loc_40AA8A:			       ; CODE XREF: __output_p_l+8Dj
.text:0040AA8A		       mov     ecx, [ebp+290h+var_4]
.text:0040AA90		       pop     edi
.text:0040AA91		       pop     esi
.text:0040AA92		       xor     ecx, ebp
.text:0040AA94		       pop     ebx
.text:0040AA95		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040AA9A		       add     ebp, 290h
.text:0040AAA0		       leave
.text:0040AAA1		       retn
.text:0040AAA1 ; ---------------------------------------------------------------------------
.text:0040AAA2 off_40AAA2      dd offset $LN265	       ; DATA XREF: __output_p_l+26Ar
.text:0040AAA6		       dd offset $LN259
.text:0040AAAA		       dd offset $LN258
.text:0040AAAE		       dd offset $LN250
.text:0040AAB2		       dd offset $LN238
.text:0040AAB6		       dd offset $LN237
.text:0040AABA		       dd offset $LN225
.text:0040AABE		       dd offset $LN209
.text:0040AABE __output_p_l    endp
.text:0040AABE
.text:0040AAC2		       align 10h
.text:0040AAD0
.text:0040AAD0 ; =============== S U B R O U T I N E =======================================
.text:0040AAD0
.text:0040AAD0 ; Attributes: bp-based frame
.text:0040AAD0
.text:0040AAD0 ; void __cdecl memmove(char *dst, char *src, unsigned int count)
.text:0040AAD0 _memmove	       proc near	       ; CODE XREF: ___sbh_free_block+2DAp
.text:0040AAD0					       ; ___sbh_heapmin+B7p ...
.text:0040AAD0
.text:0040AAD0 dst	       = dword ptr  8
.text:0040AAD0 src	       = dword ptr  0Ch
.text:0040AAD0 count	       = dword ptr  10h
.text:0040AAD0
.text:0040AAD0		       push    ebp
.text:0040AAD1		       mov     ebp, esp
.text:0040AAD3		       push    edi
.text:0040AAD4		       push    esi
.text:0040AAD5		       mov     esi, [ebp+src]
.text:0040AAD8		       mov     ecx, [ebp+count]
.text:0040AADB		       mov     edi, [ebp+dst]
.text:0040AADE		       mov     eax, ecx
.text:0040AAE0		       mov     edx, ecx
.text:0040AAE2		       add     eax, esi
.text:0040AAE4		       cmp     edi, esi
.text:0040AAE6		       jbe     short CopyUp
.text:0040AAE8		       cmp     edi, eax
.text:0040AAEA		       jb      CopyDown
.text:0040AAF0
.text:0040AAF0 CopyUp:				       ; CODE XREF: _memmove+16j
.text:0040AAF0		       cmp     ecx, 100h
.text:0040AAF6		       jb      short Dword_align
.text:0040AAF8		       cmp     ___sse2_available, 0
.text:0040AAFF		       jz      short Dword_align
.text:0040AB01		       push    edi
.text:0040AB02		       push    esi
.text:0040AB03		       and     edi, 0Fh
.text:0040AB06		       and     esi, 0Fh
.text:0040AB09		       cmp     edi, esi
.text:0040AB0B		       pop     esi
.text:0040AB0C		       pop     edi
.text:0040AB0D		       jnz     short Dword_align
.text:0040AB0F		       pop     esi
.text:0040AB10		       pop     edi
.text:0040AB11		       pop     ebp
.text:0040AB12		       jmp     __VEC_memcpy
.text:0040AB17 ; ---------------------------------------------------------------------------
.text:0040AB17
.text:0040AB17 Dword_align:			       ; CODE XREF: _memmove+26j
.text:0040AB17					       ; _memmove+2Fj ...
.text:0040AB17		       test    edi, 3
.text:0040AB1D		       jnz     short CopyLeadUp
.text:0040AB1F		       shr     ecx, 2
.text:0040AB22		       and     edx, 3
.text:0040AB25		       cmp     ecx, 8
.text:0040AB28		       jb      short CopyUnwindUp
.text:0040AB2A		       rep movsd
.text:0040AB2C		       jmp     ds:TrailUpVec[edx*4]
.text:0040AB2C ; ---------------------------------------------------------------------------
.text:0040AB33		       align 4
.text:0040AB34
.text:0040AB34 CopyLeadUp:			       ; CODE XREF: _memmove+4Dj
.text:0040AB34		       mov     eax, edi
.text:0040AB36		       mov     edx, 3
.text:0040AB3B		       sub     ecx, 4
.text:0040AB3E		       jb      short ByteCopyUp
.text:0040AB40		       and     eax, 3
.text:0040AB43		       add     ecx, eax
.text:0040AB45		       jmp     dword ptr ds:CopyUnwindUp+4[eax*4]
.text:0040AB4C ; ---------------------------------------------------------------------------
.text:0040AB4C
.text:0040AB4C ByteCopyUp:			       ; CODE XREF: _memmove+6Ej
.text:0040AB4C		       jmp     ds:TrailUp0[ecx*4]
.text:0040AB4C ; ---------------------------------------------------------------------------
.text:0040AB53		       align 4
.text:0040AB54
.text:0040AB54 CopyUnwindUp:			       ; CODE XREF: _memmove+58j
.text:0040AB54					       ; _memmove+B6j ...
.text:0040AB54		       jmp     ds:UnwindUpVec[ecx*4]
.text:0040AB54 ; ---------------------------------------------------------------------------
.text:0040AB5B		       align 4
.text:0040AB5C ; unsigned int LeadUpVec
.text:0040AB5C LeadUpVec       dd offset LeadUp1
.text:0040AB60		       dd offset LeadUp2
.text:0040AB64		       dd offset LeadUp3
.text:0040AB68 ; ---------------------------------------------------------------------------
.text:0040AB68
.text:0040AB68 LeadUp1:				       ; DATA XREF: _memmove:LeadUpVeco
.text:0040AB68		       and     edx, ecx
.text:0040AB6A		       mov     al, [esi]
.text:0040AB6C		       mov     [edi], al
.text:0040AB6E		       mov     al, [esi+1]
.text:0040AB71		       mov     [edi+1],	al
.text:0040AB74		       mov     al, [esi+2]
.text:0040AB77		       shr     ecx, 2
.text:0040AB7A		       mov     [edi+2],	al
.text:0040AB7D		       add     esi, 3
.text:0040AB80		       add     edi, 3
.text:0040AB83		       cmp     ecx, 8
.text:0040AB86		       jb      short CopyUnwindUp
.text:0040AB88		       rep movsd
.text:0040AB8A		       jmp     ds:TrailUpVec[edx*4]
.text:0040AB8A ; ---------------------------------------------------------------------------
.text:0040AB91		       align 4
.text:0040AB94
.text:0040AB94 LeadUp2:				       ; DATA XREF: _memmove+90o
.text:0040AB94		       and     edx, ecx
.text:0040AB96		       mov     al, [esi]
.text:0040AB98		       mov     [edi], al
.text:0040AB9A		       mov     al, [esi+1]
.text:0040AB9D		       shr     ecx, 2
.text:0040ABA0		       mov     [edi+1],	al
.text:0040ABA3		       add     esi, 2
.text:0040ABA6		       add     edi, 2
.text:0040ABA9		       cmp     ecx, 8
.text:0040ABAC		       jb      short CopyUnwindUp
.text:0040ABAE		       rep movsd
.text:0040ABB0		       jmp     ds:TrailUpVec[edx*4]
.text:0040ABB0 ; ---------------------------------------------------------------------------
.text:0040ABB7		       align 4
.text:0040ABB8
.text:0040ABB8 LeadUp3:				       ; DATA XREF: _memmove+94o
.text:0040ABB8		       and     edx, ecx
.text:0040ABBA		       mov     al, [esi]
.text:0040ABBC		       mov     [edi], al
.text:0040ABBE		       add     esi, 1
.text:0040ABC1		       shr     ecx, 2
.text:0040ABC4		       add     edi, 1
.text:0040ABC7		       cmp     ecx, 8
.text:0040ABCA		       jb      short CopyUnwindUp
.text:0040ABCC		       rep movsd
.text:0040ABCE		       jmp     ds:TrailUpVec[edx*4]
.text:0040ABCE ; ---------------------------------------------------------------------------
.text:0040ABD5		       align 4
.text:0040ABD8 ; unsigned int UnwindUpVec
.text:0040ABD8 UnwindUpVec     dd offset UnwindUp0     ; DATA XREF: _memmove:CopyUnwindUpr
.text:0040ABDC		       dd offset UnwindUp1
.text:0040ABE0		       dd offset UnwindUp2
.text:0040ABE4		       dd offset UnwindUp3
.text:0040ABE8		       dd offset UnwindUp4
.text:0040ABEC		       dd offset UnwindUp5
.text:0040ABF0		       dd offset UnwindUp6
.text:0040ABF4		       dd offset UnwindUp7
.text:0040ABF8 ; ---------------------------------------------------------------------------
.text:0040ABF8
.text:0040ABF8 UnwindUp7:			       ; CODE XREF: _memmove:CopyUnwindUpj
.text:0040ABF8					       ; DATA XREF: _memmove+124o
.text:0040ABF8		       mov     eax, [esi+ecx*4-1Ch]
.text:0040ABFC		       mov     [edi+ecx*4-1Ch],	eax
.text:0040AC00
.text:0040AC00 UnwindUp6:			       ; CODE XREF: _memmove:CopyUnwindUpj
.text:0040AC00					       ; DATA XREF: _memmove+120o
.text:0040AC00		       mov     eax, [esi+ecx*4-18h]
.text:0040AC04		       mov     [edi+ecx*4-18h],	eax
.text:0040AC08
.text:0040AC08 UnwindUp5:			       ; CODE XREF: _memmove:CopyUnwindUpj
.text:0040AC08					       ; DATA XREF: _memmove+11Co
.text:0040AC08		       mov     eax, [esi+ecx*4-14h]
.text:0040AC0C		       mov     [edi+ecx*4-14h],	eax
.text:0040AC10
.text:0040AC10 UnwindUp4:			       ; CODE XREF: _memmove:CopyUnwindUpj
.text:0040AC10					       ; DATA XREF: _memmove+118o
.text:0040AC10		       mov     eax, [esi+ecx*4-10h]
.text:0040AC14		       mov     [edi+ecx*4-10h],	eax
.text:0040AC18
.text:0040AC18 UnwindUp3:			       ; CODE XREF: _memmove:CopyUnwindUpj
.text:0040AC18					       ; DATA XREF: _memmove+114o
.text:0040AC18		       mov     eax, [esi+ecx*4-0Ch]
.text:0040AC1C		       mov     [edi+ecx*4-0Ch],	eax
.text:0040AC20
.text:0040AC20 UnwindUp2:			       ; CODE XREF: _memmove:CopyUnwindUpj
.text:0040AC20					       ; DATA XREF: _memmove+110o
.text:0040AC20		       mov     eax, [esi+ecx*4-8]
.text:0040AC24		       mov     [edi+ecx*4-8], eax
.text:0040AC28
.text:0040AC28 UnwindUp1:			       ; CODE XREF: _memmove:CopyUnwindUpj
.text:0040AC28					       ; DATA XREF: _memmove+10Co
.text:0040AC28		       mov     eax, [esi+ecx*4-4]
.text:0040AC2C		       mov     [edi+ecx*4-4], eax
.text:0040AC30		       lea     eax, ds:0[ecx*4]
.text:0040AC37		       add     esi, eax
.text:0040AC39		       add     edi, eax
.text:0040AC3B
.text:0040AC3B UnwindUp0:			       ; CODE XREF: _memmove:CopyUnwindUpj
.text:0040AC3B					       ; DATA XREF: _memmove:UnwindUpVeco
.text:0040AC3B		       jmp     ds:TrailUpVec[edx*4]
.text:0040AC3B ; ---------------------------------------------------------------------------
.text:0040AC42		       align 4
.text:0040AC44 ; unsigned int TrailUpVec
.text:0040AC44 TrailUpVec      dd offset TrailUp0      ; DATA XREF: _memmove+5Cr
.text:0040AC44					       ; _memmove+BAr ...
.text:0040AC48		       dd offset TrailUp1
.text:0040AC4C		       dd offset TrailUp2
.text:0040AC50		       dd offset TrailUp3
.text:0040AC54 TrailUp0	       dd 5E08458Bh	       ; CODE XREF: _memmove+5Cj
.text:0040AC54					       ; DATA XREF: _memmove:ByteCopyUpr ...
.text:0040AC58 ; ---------------------------------------------------------------------------
.text:0040AC58		       pop     edi
.text:0040AC59		       leave
.text:0040AC5A		       retn
.text:0040AC5A ; ---------------------------------------------------------------------------
.text:0040AC5B		       align 4
.text:0040AC5C
.text:0040AC5C TrailUp1:			       ; CODE XREF: _memmove+5Cj
.text:0040AC5C					       ; DATA XREF: _memmove+178o
.text:0040AC5C		       mov     al, [esi]
.text:0040AC5E		       mov     [edi], al
.text:0040AC60		       mov     eax, [ebp+dst]
.text:0040AC63		       pop     esi
.text:0040AC64		       pop     edi
.text:0040AC65		       leave
.text:0040AC66		       retn
.text:0040AC66 ; ---------------------------------------------------------------------------
.text:0040AC67		       align 4
.text:0040AC68
.text:0040AC68 TrailUp2:			       ; CODE XREF: _memmove+5Cj
.text:0040AC68					       ; DATA XREF: _memmove+17Co
.text:0040AC68		       mov     al, [esi]
.text:0040AC6A		       mov     [edi], al
.text:0040AC6C		       mov     al, [esi+1]
.text:0040AC6F		       mov     [edi+1],	al
.text:0040AC72		       mov     eax, [ebp+dst]
.text:0040AC75		       pop     esi
.text:0040AC76		       pop     edi
.text:0040AC77		       leave
.text:0040AC78		       retn
.text:0040AC78 ; ---------------------------------------------------------------------------
.text:0040AC79		       align 4
.text:0040AC7C
.text:0040AC7C TrailUp3:			       ; CODE XREF: _memmove+5Cj
.text:0040AC7C					       ; DATA XREF: _memmove+180o
.text:0040AC7C		       mov     al, [esi]
.text:0040AC7E		       mov     [edi], al
.text:0040AC80		       mov     al, [esi+1]
.text:0040AC83		       mov     [edi+1],	al
.text:0040AC86		       mov     al, [esi+2]
.text:0040AC89		       mov     [edi+2],	al
.text:0040AC8C		       mov     eax, [ebp+dst]
.text:0040AC8F		       pop     esi
.text:0040AC90		       pop     edi
.text:0040AC91		       leave
.text:0040AC92		       retn
.text:0040AC92 ; ---------------------------------------------------------------------------
.text:0040AC93		       align 4
.text:0040AC94
.text:0040AC94 CopyDown:			       ; CODE XREF: _memmove+1Aj
.text:0040AC94		       lea     esi, [ecx+esi-4]
.text:0040AC98		       lea     edi, [ecx+edi-4]
.text:0040AC9C		       test    edi, 3
.text:0040ACA2		       jnz     short CopyLeadDown
.text:0040ACA4		       shr     ecx, 2
.text:0040ACA7		       and     edx, 3
.text:0040ACAA		       cmp     ecx, 8
.text:0040ACAD		       jb      short CopyUnwindDown
.text:0040ACAF		       std
.text:0040ACB0		       rep movsd
.text:0040ACB2		       cld
.text:0040ACB3		       jmp     ds:TrailDownVec[edx*4]
.text:0040ACB3 ; ---------------------------------------------------------------------------
.text:0040ACBA		       align 4
.text:0040ACBC
.text:0040ACBC CopyUnwindDown:			       ; CODE XREF: _memmove+1DDj
.text:0040ACBC					       ; _memmove+238j	...
.text:0040ACBC		       neg     ecx
.text:0040ACBE		       jmp     ds:off_40AD90[ecx*4]
.text:0040ACBE ; ---------------------------------------------------------------------------
.text:0040ACC5		       align 4
.text:0040ACC8
.text:0040ACC8 CopyLeadDown:			       ; CODE XREF: _memmove+1D2j
.text:0040ACC8		       mov     eax, edi
.text:0040ACCA		       mov     edx, 3
.text:0040ACCF		       cmp     ecx, 4
.text:0040ACD2		       jb      short ByteCopyDown
.text:0040ACD4		       and     eax, 3
.text:0040ACD7		       sub     ecx, eax
.text:0040ACD9		       jmp     dword ptr ds:ByteCopyDown+4[eax*4]
.text:0040ACE0 ; ---------------------------------------------------------------------------
.text:0040ACE0
.text:0040ACE0 ByteCopyDown:			       ; CODE XREF: _memmove+202j
.text:0040ACE0					       ; DATA XREF: _memmove+209r
.text:0040ACE0		       jmp     ds:TrailDownVec[ecx*4]
.text:0040ACE0 ; ---------------------------------------------------------------------------
.text:0040ACE7		       align 4
.text:0040ACE8 ; unsigned int LeadDownVec
.text:0040ACE8 LeadDownVec     dd offset LeadDown1
.text:0040ACEC		       dd offset LeadDown2
.text:0040ACF0		       dd offset LeadDown3
.text:0040ACF4 ; ---------------------------------------------------------------------------
.text:0040ACF4
.text:0040ACF4 LeadDown1:			       ; DATA XREF: _memmove:LeadDownVeco
.text:0040ACF4		       mov     al, [esi+3]
.text:0040ACF7		       and     edx, ecx
.text:0040ACF9		       mov     [edi+3],	al
.text:0040ACFC		       sub     esi, 1
.text:0040ACFF		       shr     ecx, 2
.text:0040AD02		       sub     edi, 1
.text:0040AD05		       cmp     ecx, 8
.text:0040AD08		       jb      short CopyUnwindDown
.text:0040AD0A		       std
.text:0040AD0B		       rep movsd
.text:0040AD0D		       cld
.text:0040AD0E		       jmp     ds:TrailDownVec[edx*4]
.text:0040AD0E ; ---------------------------------------------------------------------------
.text:0040AD15		       align 4
.text:0040AD18
.text:0040AD18 LeadDown2:			       ; DATA XREF: _memmove+21Co
.text:0040AD18		       mov     al, [esi+3]
.text:0040AD1B		       and     edx, ecx
.text:0040AD1D		       mov     [edi+3],	al
.text:0040AD20		       mov     al, [esi+2]
.text:0040AD23		       shr     ecx, 2
.text:0040AD26		       mov     [edi+2],	al
.text:0040AD29		       sub     esi, 2
.text:0040AD2C		       sub     edi, 2
.text:0040AD2F		       cmp     ecx, 8
.text:0040AD32		       jb      short CopyUnwindDown
.text:0040AD34		       std
.text:0040AD35		       rep movsd
.text:0040AD37		       cld
.text:0040AD38		       jmp     ds:TrailDownVec[edx*4]
.text:0040AD38 ; ---------------------------------------------------------------------------
.text:0040AD3F		       align 10h
.text:0040AD40
.text:0040AD40 LeadDown3:			       ; DATA XREF: _memmove+220o
.text:0040AD40		       mov     al, [esi+3]
.text:0040AD43		       and     edx, ecx
.text:0040AD45		       mov     [edi+3],	al
.text:0040AD48		       mov     al, [esi+2]
.text:0040AD4B		       mov     [edi+2],	al
.text:0040AD4E		       mov     al, [esi+1]
.text:0040AD51		       shr     ecx, 2
.text:0040AD54		       mov     [edi+1],	al
.text:0040AD57		       sub     esi, 3
.text:0040AD5A		       sub     edi, 3
.text:0040AD5D		       cmp     ecx, 8
.text:0040AD60		       jb      CopyUnwindDown
.text:0040AD66		       std
.text:0040AD67		       rep movsd
.text:0040AD69		       cld
.text:0040AD6A		       jmp     ds:TrailDownVec[edx*4]
.text:0040AD6A ; ---------------------------------------------------------------------------
.text:0040AD71		       align 4
.text:0040AD74 ; unsigned int UnwindDownVec
.text:0040AD74 UnwindDownVec   dd offset UnwindDown7
.text:0040AD78		       dd offset UnwindDown6
.text:0040AD7C		       dd offset UnwindDown5
.text:0040AD80		       dd offset UnwindDown4
.text:0040AD84		       dd offset UnwindDown3
.text:0040AD88		       dd offset UnwindDown2
.text:0040AD8C		       dd offset UnwindDown1
.text:0040AD90 off_40AD90      dd offset UnwindDown0   ; DATA XREF: _memmove+1EEr
.text:0040AD94 ; ---------------------------------------------------------------------------
.text:0040AD94
.text:0040AD94 UnwindDown7:			       ; DATA XREF: _memmove:UnwindDownVeco
.text:0040AD94		       mov     eax, [esi+ecx*4+1Ch]
.text:0040AD98		       mov     [edi+ecx*4+1Ch],	eax
.text:0040AD9C
.text:0040AD9C UnwindDown6:			       ; DATA XREF: _memmove+2A8o
.text:0040AD9C		       mov     eax, [esi+ecx*4+18h]
.text:0040ADA0		       mov     [edi+ecx*4+18h],	eax
.text:0040ADA4
.text:0040ADA4 UnwindDown5:			       ; DATA XREF: _memmove+2ACo
.text:0040ADA4		       mov     eax, [esi+ecx*4+14h]
.text:0040ADA8		       mov     [edi+ecx*4+14h],	eax
.text:0040ADAC
.text:0040ADAC UnwindDown4:			       ; DATA XREF: _memmove+2B0o
.text:0040ADAC		       mov     eax, [esi+ecx*4+10h]
.text:0040ADB0		       mov     [edi+ecx*4+10h],	eax
.text:0040ADB4
.text:0040ADB4 UnwindDown3:			       ; DATA XREF: _memmove+2B4o
.text:0040ADB4		       mov     eax, [esi+ecx*4+0Ch]
.text:0040ADB8		       mov     [edi+ecx*4+0Ch],	eax
.text:0040ADBC
.text:0040ADBC UnwindDown2:			       ; DATA XREF: _memmove+2B8o
.text:0040ADBC		       mov     eax, [esi+ecx*4+8]
.text:0040ADC0		       mov     [edi+ecx*4+8], eax
.text:0040ADC4
.text:0040ADC4 UnwindDown1:			       ; DATA XREF: _memmove+2BCo
.text:0040ADC4		       mov     eax, [esi+ecx*4+4]
.text:0040ADC8		       mov     [edi+ecx*4+4], eax
.text:0040ADCC		       lea     eax, ds:0[ecx*4]
.text:0040ADD3		       add     esi, eax
.text:0040ADD5		       add     edi, eax
.text:0040ADD7
.text:0040ADD7 UnwindDown0:			       ; CODE XREF: _memmove+1EEj
.text:0040ADD7					       ; DATA XREF: _memmove:off_40AD90o
.text:0040ADD7		       jmp     ds:TrailDownVec[edx*4]
.text:0040ADD7 ; ---------------------------------------------------------------------------
.text:0040ADDE		       align 10h
.text:0040ADE0 ; unsigned int TrailDownVec
.text:0040ADE0 TrailDownVec    dd offset TrailDown0    ; DATA XREF: _memmove+1E3r
.text:0040ADE0					       ; _memmove:ByteCopyDownr ...
.text:0040ADE4		       dd offset TrailDown1
.text:0040ADE8		       dd offset TrailDown2
.text:0040ADEC		       dd offset TrailDown3
.text:0040ADF0 ; ---------------------------------------------------------------------------
.text:0040ADF0
.text:0040ADF0 TrailDown0:			       ; CODE XREF: _memmove+1E3j
.text:0040ADF0					       ; _memmove:ByteCopyDownj ...
.text:0040ADF0		       mov     eax, [ebp+dst]
.text:0040ADF3		       pop     esi
.text:0040ADF4		       pop     edi
.text:0040ADF5		       leave
.text:0040ADF6		       retn
.text:0040ADF6 ; ---------------------------------------------------------------------------
.text:0040ADF7		       align 4
.text:0040ADF8
.text:0040ADF8 TrailDown1:			       ; CODE XREF: _memmove+1E3j
.text:0040ADF8					       ; _memmove:ByteCopyDownj ...
.text:0040ADF8		       mov     al, [esi+3]
.text:0040ADFB		       mov     [edi+3],	al
.text:0040ADFE		       mov     eax, [ebp+dst]
.text:0040AE01		       pop     esi
.text:0040AE02		       pop     edi
.text:0040AE03		       leave
.text:0040AE04		       retn
.text:0040AE04 ; ---------------------------------------------------------------------------
.text:0040AE05		       align 4
.text:0040AE08
.text:0040AE08 TrailDown2:			       ; CODE XREF: _memmove+1E3j
.text:0040AE08					       ; _memmove:ByteCopyDownj ...
.text:0040AE08		       mov     al, [esi+3]
.text:0040AE0B		       mov     [edi+3],	al
.text:0040AE0E		       mov     al, [esi+2]
.text:0040AE11		       mov     [edi+2],	al
.text:0040AE14		       mov     eax, [ebp+dst]
.text:0040AE17		       pop     esi
.text:0040AE18		       pop     edi
.text:0040AE19		       leave
.text:0040AE1A		       retn
.text:0040AE1A ; ---------------------------------------------------------------------------
.text:0040AE1B		       align 4
.text:0040AE1C
.text:0040AE1C TrailDown3:			       ; CODE XREF: _memmove+1E3j
.text:0040AE1C					       ; _memmove:ByteCopyDownj ...
.text:0040AE1C		       mov     al, [esi+3]
.text:0040AE1F		       mov     [edi+3],	al
.text:0040AE22		       mov     al, [esi+2]
.text:0040AE25		       mov     [edi+2],	al
.text:0040AE28		       mov     al, [esi+1]
.text:0040AE2B		       mov     [edi+1],	al
.text:0040AE2E		       mov     eax, [ebp+dst]
.text:0040AE31		       pop     esi
.text:0040AE32		       pop     edi
.text:0040AE33		       leave
.text:0040AE34		       retn
.text:0040AE34 _memmove	       endp
.text:0040AE34
.text:0040AE34 ; ---------------------------------------------------------------------------
.text:0040AE35		       align 10h
.text:0040AE40
.text:0040AE40 ; =============== S U B R O U T I N E =======================================
.text:0040AE40
.text:0040AE40
.text:0040AE40 ; void __cdecl strcmp(char *str1, char *str2)
.text:0040AE40 _strcmp	       proc near	       ; CODE XREF: _use_encode_pointer+47p
.text:0040AE40					       ; _setlocale_get_all+86p ...
.text:0040AE40
.text:0040AE40 arg_0	       = dword ptr  4
.text:0040AE40 str1	       = dword ptr  8
.text:0040AE40 str2	       = dword ptr  0Ch
.text:0040AE40
.text:0040AE40		       mov     edx, [esp+arg_0]
.text:0040AE44		       mov     ecx, [esp+str1]
.text:0040AE48		       test    edx, 3
.text:0040AE4E		       jnz     short dopartial
.text:0040AE50
.text:0040AE50 dodwords:			       ; CODE XREF: _strcmp+3Cj
.text:0040AE50					       ; _strcmp+6Aj ...
.text:0040AE50		       mov     eax, [edx]
.text:0040AE52		       cmp     al, [ecx]
.text:0040AE54		       jnz     short donene
.text:0040AE56		       or      al, al
.text:0040AE58		       jz      short doneeq
.text:0040AE5A		       cmp     ah, [ecx+1]
.text:0040AE5D		       jnz     short donene
.text:0040AE5F		       or      ah, ah
.text:0040AE61		       jz      short doneeq
.text:0040AE63		       shr     eax, 10h
.text:0040AE66		       cmp     al, [ecx+2]
.text:0040AE69		       jnz     short donene
.text:0040AE6B		       or      al, al
.text:0040AE6D		       jz      short doneeq
.text:0040AE6F		       cmp     ah, [ecx+3]
.text:0040AE72		       jnz     short donene
.text:0040AE74		       add     ecx, 4
.text:0040AE77		       add     edx, 4
.text:0040AE7A		       or      ah, ah
.text:0040AE7C		       jnz     short dodwords
.text:0040AE7E		       mov     edi, edi
.text:0040AE80
.text:0040AE80 doneeq:				       ; CODE XREF: _strcmp+18j
.text:0040AE80					       ; _strcmp+21j ...
.text:0040AE80		       xor     eax, eax
.text:0040AE82		       retn
.text:0040AE82 ; ---------------------------------------------------------------------------
.text:0040AE83		       align 4
.text:0040AE84
.text:0040AE84 donene:				       ; CODE XREF: _strcmp+14j
.text:0040AE84					       ; _strcmp+1Dj ...
.text:0040AE84		       sbb     eax, eax
.text:0040AE86		       shl     eax, 1
.text:0040AE88		       add     eax, 1
.text:0040AE8B		       retn
.text:0040AE8C ; ---------------------------------------------------------------------------
.text:0040AE8C
.text:0040AE8C dopartial:			       ; CODE XREF: _strcmp+Ej
.text:0040AE8C		       test    edx, 1
.text:0040AE92		       jz      short doword
.text:0040AE94		       mov     al, [edx]
.text:0040AE96		       add     edx, 1
.text:0040AE99		       cmp     al, [ecx]
.text:0040AE9B		       jnz     short donene
.text:0040AE9D		       add     ecx, 1
.text:0040AEA0		       or      al, al
.text:0040AEA2		       jz      short doneeq
.text:0040AEA4		       test    edx, 2
.text:0040AEAA		       jz      short dodwords
.text:0040AEAC
.text:0040AEAC doword:				       ; CODE XREF: _strcmp+52j
.text:0040AEAC		       mov     ax, [edx]
.text:0040AEAF		       add     edx, 2
.text:0040AEB2		       cmp     al, [ecx]
.text:0040AEB4		       jnz     short donene
.text:0040AEB6		       or      al, al
.text:0040AEB8		       jz      short doneeq
.text:0040AEBA		       cmp     ah, [ecx+1]
.text:0040AEBD		       jnz     short donene
.text:0040AEBF		       or      ah, ah
.text:0040AEC1		       jz      short doneeq
.text:0040AEC3		       add     ecx, 2
.text:0040AEC6		       jmp     short dodwords
.text:0040AEC6 _strcmp	       endp
.text:0040AEC6
.text:0040AEC8
.text:0040AEC8 ; =============== S U B R O U T I N E =======================================
.text:0040AEC8
.text:0040AEC8 ; Attributes: bp-based frame
.text:0040AEC8
.text:0040AEC8 ; int __cdecl __crtMessageBoxA(const char *lpText, const	char *lpCaption, unsigned int uType)
.text:0040AEC8 ___crtMessageBoxA proc near	       ; CODE XREF: __NMSG_WRITE+15Dp
.text:0040AEC8
.text:0040AEC8 var_30	       = dword ptr -30h
.text:0040AEC8 uof	       = tagUSEROBJECTFLAGS ptr	-20h
.text:0040AEC8 nDummy	       = dword ptr -14h
.text:0040AEC8 winmajor	       = dword ptr -10h
.text:0040AEC8 osplatform      = dword ptr -0Ch
.text:0040AEC8 enull	       = dword ptr -8
.text:0040AEC8 hWndParent      = dword ptr -4
.text:0040AEC8 lpText	       = dword ptr  8
.text:0040AEC8 lpCaption       = dword ptr  0Ch
.text:0040AEC8 uType	       = dword ptr  10h
.text:0040AEC8
.text:0040AEC8		       push    ebp
.text:0040AEC9		       mov     ebp, esp
.text:0040AECB		       sub     esp, 20h
.text:0040AECE		       push    ebx
.text:0040AECF		       push    esi
.text:0040AED0		       push    edi
.text:0040AED1		       call    __encoded_null
.text:0040AED6		       xor     ebx, ebx
.text:0040AED8		       cmp     pfnMessageBox, ebx
.text:0040AEDE		       mov     [ebp+enull], eax
.text:0040AEE1		       mov     [ebp+hWndParent], ebx
.text:0040AEE4		       mov     [ebp+osplatform], ebx
.text:0040AEE7		       mov     [ebp+winmajor], ebx
.text:0040AEEA		       jnz     loc_40AF9E
.text:0040AEF0		       push    offset aUser32_dll ; "USER32.DLL"
.text:0040AEF5		       call    ds:__imp__LoadLibraryA@4	; LoadLibraryA(x)
.text:0040AEFB		       mov     edi, eax
.text:0040AEFD		       cmp     edi, ebx
.text:0040AEFF		       jz      loc_40B07E
.text:0040AF05		       mov     esi, ds:__imp__GetProcAddress@8 ; GetProcAddress(x,x)
.text:0040AF0B		       push    offset aMessageboxa ; "MessageBoxA"
.text:0040AF10		       push    edi	       ; hModule
.text:0040AF11		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040AF13		       cmp     eax, ebx
.text:0040AF15		       jz      loc_40B07E
.text:0040AF1B		       push    eax	       ; lpProcName
.text:0040AF1C		       call    __encode_pointer
.text:0040AF21		       mov     [esp+30h+var_30], offset	aGetactivewindo	; "GetActiveWindow"
.text:0040AF28		       push    edi	       ; hModule
.text:0040AF29		       mov     pfnMessageBox, eax
.text:0040AF2E		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040AF30		       push    eax	       ; lpProcName
.text:0040AF31		       call    __encode_pointer
.text:0040AF36		       mov     [esp+30h+var_30], offset	aGetlastactivep	; "GetLastActivePopup"
.text:0040AF3D		       push    edi	       ; hModule
.text:0040AF3E		       mov     pfnGetActiveWindow, eax
.text:0040AF43		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040AF45		       push    eax	       ; ptr
.text:0040AF46		       call    __encode_pointer
.text:0040AF4B		       mov     pfnGetLastActivePopup, eax
.text:0040AF50		       lea     eax, [ebp+osplatform]
.text:0040AF53		       push    eax	       ; pValue
.text:0040AF54		       call    __get_osplatform
.text:0040AF59		       test    eax, eax
.text:0040AF5B		       pop     ecx
.text:0040AF5C		       pop     ecx
.text:0040AF5D		       jz      short loc_40AF6C
.text:0040AF5F		       push    ebx	       ; pReserved
.text:0040AF60		       push    ebx	       ; nLine
.text:0040AF61		       push    ebx	       ; pszFile
.text:0040AF62		       push    ebx	       ; pszFunction
.text:0040AF63		       push    ebx	       ; pszExpression
.text:0040AF64		       call    __invoke_watson
.text:0040AF69		       add     esp, 14h
.text:0040AF6C
.text:0040AF6C loc_40AF6C:			       ; CODE XREF: ___crtMessageBoxA+95j
.text:0040AF6C		       cmp     [ebp+osplatform], 2
.text:0040AF70		       jnz     short loc_40AF9E
.text:0040AF72		       push    offset aGetuserobjecti ;	"GetUserObjectInformationA"
.text:0040AF77		       push    edi	       ; hModule
.text:0040AF78		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040AF7A		       push    eax	       ; ptr
.text:0040AF7B		       call    __encode_pointer
.text:0040AF80		       cmp     eax, ebx
.text:0040AF82		       pop     ecx
.text:0040AF83		       mov     pfnGetUserObjectInformation, eax
.text:0040AF88		       jz      short loc_40AF9E
.text:0040AF8A		       push    offset aGetprocesswind ;	"GetProcessWindowStation"
.text:0040AF8F		       push    edi	       ; hModule
.text:0040AF90		       call    esi ; GetProcAddress(x,x) ; GetProcAddress(x,x)
.text:0040AF92		       push    eax	       ; ptr
.text:0040AF93		       call    __encode_pointer
.text:0040AF98		       pop     ecx
.text:0040AF99		       mov     pfnGetProcessWindowStation, eax
.text:0040AF9E
.text:0040AF9E loc_40AF9E:			       ; CODE XREF: ___crtMessageBoxA+22j
.text:0040AF9E					       ; ___crtMessageBoxA+A8j	...
.text:0040AF9E		       mov     eax, pfnGetProcessWindowStation
.text:0040AFA3		       mov     ecx, [ebp+enull]
.text:0040AFA6		       cmp     eax, ecx
.text:0040AFA8		       jz      short loc_40B023
.text:0040AFAA		       cmp     pfnGetUserObjectInformation, ecx
.text:0040AFB0		       jz      short loc_40B023
.text:0040AFB2		       push    eax	       ; codedptr
.text:0040AFB3		       call    __decode_pointer
.text:0040AFB8		       push    pfnGetUserObjectInformation ; codedptr
.text:0040AFBE		       mov     esi, eax
.text:0040AFC0		       call    __decode_pointer
.text:0040AFC5		       cmp     esi, ebx
.text:0040AFC7		       pop     ecx
.text:0040AFC8		       pop     ecx
.text:0040AFC9		       mov     edi, eax
.text:0040AFCB		       jz      short loc_40B023
.text:0040AFCD		       cmp     edi, ebx
.text:0040AFCF		       jz      short loc_40B023
.text:0040AFD1		       call    esi
.text:0040AFD3		       cmp     eax, ebx
.text:0040AFD5		       jz      short loc_40AFF0
.text:0040AFD7		       lea     ecx, [ebp+nDummy]
.text:0040AFDA		       push    ecx
.text:0040AFDB		       push    0Ch
.text:0040AFDD		       lea     ecx, [ebp+uof]
.text:0040AFE0		       push    ecx
.text:0040AFE1		       push    1
.text:0040AFE3		       push    eax
.text:0040AFE4		       call    edi
.text:0040AFE6		       test    eax, eax
.text:0040AFE8		       jz      short loc_40AFF0
.text:0040AFEA		       test    byte ptr	[ebp+uof.dwFlags], 1
.text:0040AFEE		       jnz     short loc_40B023
.text:0040AFF0
.text:0040AFF0 loc_40AFF0:			       ; CODE XREF: ___crtMessageBoxA+10Dj
.text:0040AFF0					       ; ___crtMessageBoxA+120j
.text:0040AFF0		       lea     eax, [ebp+winmajor]
.text:0040AFF3		       push    eax	       ; pValue
.text:0040AFF4		       call    __get_winmajor
.text:0040AFF9		       test    eax, eax
.text:0040AFFB		       pop     ecx
.text:0040AFFC		       jz      short loc_40B00B
.text:0040AFFE		       push    ebx	       ; pReserved
.text:0040AFFF		       push    ebx	       ; nLine
.text:0040B000		       push    ebx	       ; pszFile
.text:0040B001		       push    ebx	       ; pszFunction
.text:0040B002		       push    ebx	       ; pszExpression
.text:0040B003		       call    __invoke_watson
.text:0040B008		       add     esp, 14h
.text:0040B00B
.text:0040B00B loc_40B00B:			       ; CODE XREF: ___crtMessageBoxA+134j
.text:0040B00B		       cmp     [ebp+winmajor], 4
.text:0040B00F		       jb      short loc_40B01A
.text:0040B011		       or      [ebp+uType], 200000h
.text:0040B018		       jmp     short loc_40B05E
.text:0040B01A ; ---------------------------------------------------------------------------
.text:0040B01A
.text:0040B01A loc_40B01A:			       ; CODE XREF: ___crtMessageBoxA+147j
.text:0040B01A		       or      [ebp+uType], 40000h
.text:0040B021		       jmp     short loc_40B05E
.text:0040B023 ; ---------------------------------------------------------------------------
.text:0040B023
.text:0040B023 loc_40B023:			       ; CODE XREF: ___crtMessageBoxA+E0j
.text:0040B023					       ; ___crtMessageBoxA+E8j	...
.text:0040B023		       mov     eax, pfnGetActiveWindow
.text:0040B028		       cmp     eax, [ebp+enull]
.text:0040B02B		       jz      short loc_40B05E
.text:0040B02D		       push    eax	       ; codedptr
.text:0040B02E		       call    __decode_pointer
.text:0040B033		       cmp     eax, ebx
.text:0040B035		       pop     ecx
.text:0040B036		       jz      short loc_40B05E
.text:0040B038		       call    eax
.text:0040B03A		       cmp     eax, ebx
.text:0040B03C		       mov     [ebp+hWndParent], eax
.text:0040B03F		       jz      short loc_40B05E
.text:0040B041		       mov     eax, pfnGetLastActivePopup
.text:0040B046		       cmp     eax, [ebp+enull]
.text:0040B049		       jz      short loc_40B05E
.text:0040B04B		       push    eax	       ; codedptr
.text:0040B04C		       call    __decode_pointer
.text:0040B051		       cmp     eax, ebx
.text:0040B053		       pop     ecx
.text:0040B054		       jz      short loc_40B05E
.text:0040B056		       push    [ebp+hWndParent]
.text:0040B059		       call    eax
.text:0040B05B		       mov     [ebp+hWndParent], eax
.text:0040B05E
.text:0040B05E loc_40B05E:			       ; CODE XREF: ___crtMessageBoxA+150j
.text:0040B05E					       ; ___crtMessageBoxA+159j ...
.text:0040B05E		       push    pfnMessageBox   ; codedptr
.text:0040B064		       call    __decode_pointer
.text:0040B069		       cmp     eax, ebx
.text:0040B06B		       pop     ecx
.text:0040B06C		       jz      short loc_40B07E
.text:0040B06E		       push    [ebp+uType]
.text:0040B071		       push    [ebp+lpCaption]
.text:0040B074		       push    [ebp+lpText]
.text:0040B077		       push    [ebp+hWndParent]
.text:0040B07A		       call    eax
.text:0040B07C		       jmp     short loc_40B080
.text:0040B07E ; ---------------------------------------------------------------------------
.text:0040B07E
.text:0040B07E loc_40B07E:			       ; CODE XREF: ___crtMessageBoxA+37j
.text:0040B07E					       ; ___crtMessageBoxA+4Dj	...
.text:0040B07E		       xor     eax, eax
.text:0040B080
.text:0040B080 loc_40B080:			       ; CODE XREF: ___crtMessageBoxA+1B4j
.text:0040B080		       pop     edi
.text:0040B081		       pop     esi
.text:0040B082		       pop     ebx
.text:0040B083		       leave
.text:0040B084		       retn
.text:0040B084 ___crtMessageBoxA endp
.text:0040B084
.text:0040B085
.text:0040B085 ; =============== S U B R O U T I N E =======================================
.text:0040B085
.text:0040B085
.text:0040B085 ; int __cdecl strcat_s(char *_Dst, unsigned int _SizeInBytes, const char	*_Src)
.text:0040B085 _strcat_s       proc near	       ; CODE XREF: __NMSG_WRITE+117p
.text:0040B085					       ; __NMSG_WRITE+139p ...
.text:0040B085
.text:0040B085 _Dst	       = dword ptr  4
.text:0040B085 _SizeInBytes    = dword ptr  8
.text:0040B085 _Src	       = dword ptr  0Ch
.text:0040B085
.text:0040B085		       mov     eax, [esp+_Dst]
.text:0040B089		       push    ebx
.text:0040B08A		       xor     ebx, ebx
.text:0040B08C		       cmp     eax, ebx
.text:0040B08E		       push    esi
.text:0040B08F		       push    edi
.text:0040B090		       jz      short loc_40B09A
.text:0040B092		       mov     edi, [esp+0Ch+_SizeInBytes]
.text:0040B096		       cmp     edi, ebx
.text:0040B098		       ja      short loc_40B0B5
.text:0040B09A
.text:0040B09A loc_40B09A:			       ; CODE XREF: _strcat_s+Bj
.text:0040B09A					       ; _strcat_s+3Aj
.text:0040B09A		       call    __errno
.text:0040B09F		       push    16h
.text:0040B0A1		       pop     esi
.text:0040B0A2		       mov     [eax], esi
.text:0040B0A4
.text:0040B0A4 loc_40B0A4:			       ; CODE XREF: _strcat_s+69j
.text:0040B0A4		       push    ebx	       ; pReserved
.text:0040B0A5		       push    ebx	       ; nLine
.text:0040B0A6		       push    ebx	       ; pszFile
.text:0040B0A7		       push    ebx	       ; pszFunction
.text:0040B0A8		       push    ebx	       ; pszExpression
.text:0040B0A9		       call    __invalid_parameter
.text:0040B0AE		       add     esp, 14h
.text:0040B0B1		       mov     eax, esi
.text:0040B0B3		       jmp     short loc_40B0F2
.text:0040B0B5 ; ---------------------------------------------------------------------------
.text:0040B0B5
.text:0040B0B5 loc_40B0B5:			       ; CODE XREF: _strcat_s+13j
.text:0040B0B5		       mov     esi, [esp+0Ch+_Src]
.text:0040B0B9		       cmp     esi, ebx
.text:0040B0BB		       jnz     short loc_40B0C1
.text:0040B0BD
.text:0040B0BD loc_40B0BD:			       ; CODE XREF: _strcat_s+48j
.text:0040B0BD		       mov     [eax], bl
.text:0040B0BF		       jmp     short loc_40B09A
.text:0040B0C1 ; ---------------------------------------------------------------------------
.text:0040B0C1
.text:0040B0C1 loc_40B0C1:			       ; CODE XREF: _strcat_s+36j
.text:0040B0C1		       mov     edx, eax
.text:0040B0C3
.text:0040B0C3 loc_40B0C3:			       ; CODE XREF: _strcat_s+44j
.text:0040B0C3		       cmp     [edx], bl
.text:0040B0C5		       jz      short loc_40B0CB
.text:0040B0C7		       inc     edx
.text:0040B0C8		       dec     edi
.text:0040B0C9		       jnz     short loc_40B0C3
.text:0040B0CB
.text:0040B0CB loc_40B0CB:			       ; CODE XREF: _strcat_s+40j
.text:0040B0CB		       cmp     edi, ebx
.text:0040B0CD		       jz      short loc_40B0BD
.text:0040B0CF
.text:0040B0CF loc_40B0CF:			       ; CODE XREF: _strcat_s+55j
.text:0040B0CF		       mov     cl, [esi]
.text:0040B0D1		       mov     [edx], cl
.text:0040B0D3		       inc     edx
.text:0040B0D4		       inc     esi
.text:0040B0D5		       cmp     cl, bl
.text:0040B0D7		       jz      short loc_40B0DC
.text:0040B0D9		       dec     edi
.text:0040B0DA		       jnz     short loc_40B0CF
.text:0040B0DC
.text:0040B0DC loc_40B0DC:			       ; CODE XREF: _strcat_s+52j
.text:0040B0DC		       cmp     edi, ebx
.text:0040B0DE		       jnz     short loc_40B0F0
.text:0040B0E0		       mov     [eax], bl
.text:0040B0E2		       call    __errno
.text:0040B0E7		       push    22h
.text:0040B0E9		       pop     ecx
.text:0040B0EA		       mov     [eax], ecx
.text:0040B0EC		       mov     esi, ecx
.text:0040B0EE		       jmp     short loc_40B0A4
.text:0040B0F0 ; ---------------------------------------------------------------------------
.text:0040B0F0
.text:0040B0F0 loc_40B0F0:			       ; CODE XREF: _strcat_s+59j
.text:0040B0F0		       xor     eax, eax
.text:0040B0F2
.text:0040B0F2 loc_40B0F2:			       ; CODE XREF: _strcat_s+2Ej
.text:0040B0F2		       pop     edi
.text:0040B0F3		       pop     esi
.text:0040B0F4		       pop     ebx
.text:0040B0F5		       retn
.text:0040B0F5 _strcat_s       endp
.text:0040B0F5
.text:0040B0F6
.text:0040B0F6 ; =============== S U B R O U T I N E =======================================
.text:0040B0F6
.text:0040B0F6 ; Attributes: bp-based frame
.text:0040B0F6
.text:0040B0F6 ; int __cdecl strncpy_s(char *_Dst, unsigned int	_SizeInBytes, const char *_Src,	unsigned int _Count)
.text:0040B0F6 _strncpy_s      proc near	       ; CODE XREF: __NMSG_WRITE+F1p
.text:0040B0F6					       ; ___getlocaleinfo+E6p ...
.text:0040B0F6
.text:0040B0F6 _Dst	       = dword ptr  8
.text:0040B0F6 _SizeInBytes    = dword ptr  0Ch
.text:0040B0F6 _Src	       = dword ptr  10h
.text:0040B0F6 _Count	       = dword ptr  14h
.text:0040B0F6
.text:0040B0F6		       push    ebp
.text:0040B0F7		       mov     ebp, esp
.text:0040B0F9		       push    ebx
.text:0040B0FA		       push    esi
.text:0040B0FB		       mov     esi, [ebp+_Dst]
.text:0040B0FE		       xor     ebx, ebx
.text:0040B100		       cmp     [ebp+_Count], ebx
.text:0040B103		       push    edi
.text:0040B104		       jnz     short loc_40B116
.text:0040B106		       cmp     esi, ebx
.text:0040B108		       jnz     short loc_40B11A
.text:0040B10A		       cmp     [ebp+_SizeInBytes], ebx
.text:0040B10D		       jnz     short loc_40B121
.text:0040B10F
.text:0040B10F loc_40B10F:			       ; CODE XREF: _strncpy_s+4Dj
.text:0040B10F					       ; _strncpy_s+8Cj
.text:0040B10F		       xor     eax, eax
.text:0040B111
.text:0040B111 loc_40B111:			       ; CODE XREF: _strncpy_s+44j
.text:0040B111					       ; _strncpy_s+9Ej
.text:0040B111		       pop     edi
.text:0040B112		       pop     esi
.text:0040B113		       pop     ebx
.text:0040B114		       pop     ebp
.text:0040B115		       retn
.text:0040B116 ; ---------------------------------------------------------------------------
.text:0040B116
.text:0040B116 loc_40B116:			       ; CODE XREF: _strncpy_s+Ej
.text:0040B116		       cmp     esi, ebx
.text:0040B118		       jz      short loc_40B121
.text:0040B11A
.text:0040B11A loc_40B11A:			       ; CODE XREF: _strncpy_s+12j
.text:0040B11A		       mov     edi, [ebp+_SizeInBytes]
.text:0040B11D		       cmp     edi, ebx
.text:0040B11F		       ja      short loc_40B13C
.text:0040B121
.text:0040B121 loc_40B121:			       ; CODE XREF: _strncpy_s+17j
.text:0040B121					       ; _strncpy_s+22j ...
.text:0040B121		       call    __errno
.text:0040B126		       push    16h
.text:0040B128		       pop     esi
.text:0040B129		       mov     [eax], esi
.text:0040B12B
.text:0040B12B loc_40B12B:			       ; CODE XREF: _strncpy_s+B1j
.text:0040B12B		       push    ebx	       ; pReserved
.text:0040B12C		       push    ebx	       ; nLine
.text:0040B12D		       push    ebx	       ; pszFile
.text:0040B12E		       push    ebx	       ; pszFunction
.text:0040B12F		       push    ebx	       ; pszExpression
.text:0040B130		       call    __invalid_parameter
.text:0040B135		       add     esp, 14h
.text:0040B138		       mov     eax, esi
.text:0040B13A		       jmp     short loc_40B111
.text:0040B13C ; ---------------------------------------------------------------------------
.text:0040B13C
.text:0040B13C loc_40B13C:			       ; CODE XREF: _strncpy_s+29j
.text:0040B13C		       cmp     [ebp+_Count], ebx
.text:0040B13F		       jnz     short loc_40B145
.text:0040B141		       mov     [esi], bl
.text:0040B143		       jmp     short loc_40B10F
.text:0040B145 ; ---------------------------------------------------------------------------
.text:0040B145
.text:0040B145 loc_40B145:			       ; CODE XREF: _strncpy_s+49j
.text:0040B145		       mov     edx, [ebp+_Src]
.text:0040B148		       cmp     edx, ebx
.text:0040B14A		       jnz     short loc_40B150
.text:0040B14C		       mov     [esi], bl
.text:0040B14E		       jmp     short loc_40B121
.text:0040B150 ; ---------------------------------------------------------------------------
.text:0040B150
.text:0040B150 loc_40B150:			       ; CODE XREF: _strncpy_s+54j
.text:0040B150		       cmp     [ebp+_Count], 0FFFFFFFFh
.text:0040B154		       mov     eax, esi
.text:0040B156		       jnz     short loc_40B167
.text:0040B158
.text:0040B158 loc_40B158:			       ; CODE XREF: _strncpy_s+6Dj
.text:0040B158		       mov     cl, [edx]
.text:0040B15A		       mov     [eax], cl
.text:0040B15C		       inc     eax
.text:0040B15D		       inc     edx
.text:0040B15E		       cmp     cl, bl
.text:0040B160		       jz      short loc_40B180
.text:0040B162		       dec     edi
.text:0040B163		       jnz     short loc_40B158
.text:0040B165		       jmp     short loc_40B180
.text:0040B167 ; ---------------------------------------------------------------------------
.text:0040B167
.text:0040B167 loc_40B167:			       ; CODE XREF: _strncpy_s+60j
.text:0040B167					       ; _strncpy_s+81j
.text:0040B167		       mov     cl, [edx]
.text:0040B169		       mov     [eax], cl
.text:0040B16B		       inc     eax
.text:0040B16C		       inc     edx
.text:0040B16D		       cmp     cl, bl
.text:0040B16F		       jz      short loc_40B179
.text:0040B171		       dec     edi
.text:0040B172		       jz      short loc_40B179
.text:0040B174		       dec     [ebp+_Count]
.text:0040B177		       jnz     short loc_40B167
.text:0040B179
.text:0040B179 loc_40B179:			       ; CODE XREF: _strncpy_s+79j
.text:0040B179					       ; _strncpy_s+7Cj
.text:0040B179		       cmp     [ebp+_Count], ebx
.text:0040B17C		       jnz     short loc_40B180
.text:0040B17E		       mov     [eax], bl
.text:0040B180
.text:0040B180 loc_40B180:			       ; CODE XREF: _strncpy_s+6Aj
.text:0040B180					       ; _strncpy_s+6Fj ...
.text:0040B180		       cmp     edi, ebx
.text:0040B182		       jnz     short loc_40B10F
.text:0040B184		       cmp     [ebp+_Count], 0FFFFFFFFh
.text:0040B188		       jnz     short loc_40B199
.text:0040B18A		       mov     eax, [ebp+_SizeInBytes]
.text:0040B18D		       push    50h
.text:0040B18F		       mov     [esi+eax-1], bl
.text:0040B193		       pop     eax
.text:0040B194		       jmp     loc_40B111
.text:0040B199 ; ---------------------------------------------------------------------------
.text:0040B199
.text:0040B199 loc_40B199:			       ; CODE XREF: _strncpy_s+92j
.text:0040B199		       mov     [esi], bl
.text:0040B19B		       call    __errno
.text:0040B1A0		       push    22h
.text:0040B1A2		       pop     ecx
.text:0040B1A3		       mov     [eax], ecx
.text:0040B1A5		       mov     esi, ecx
.text:0040B1A7		       jmp     short loc_40B12B
.text:0040B1A7 _strncpy_s      endp
.text:0040B1A7
.text:0040B1A9
.text:0040B1A9 ; =============== S U B R O U T I N E =======================================
.text:0040B1A9
.text:0040B1A9
.text:0040B1A9 ; int __cdecl strcpy_s(char *_Dst, unsigned int _SizeInBytes, const char	*_Src)
.text:0040B1A9 _strcpy_s       proc near	       ; CODE XREF: __NMSG_WRITE+6Cp
.text:0040B1A9					       ; __NMSG_WRITE+AEp ...
.text:0040B1A9
.text:0040B1A9 _Dst	       = dword ptr  4
.text:0040B1A9 _SizeInBytes    = dword ptr  8
.text:0040B1A9 _Src	       = dword ptr  0Ch
.text:0040B1A9
.text:0040B1A9		       mov     ecx, [esp+_Dst]
.text:0040B1AD		       push    ebx
.text:0040B1AE		       xor     ebx, ebx
.text:0040B1B0		       cmp     ecx, ebx
.text:0040B1B2		       push    esi
.text:0040B1B3		       push    edi
.text:0040B1B4		       jz      short loc_40B1BE
.text:0040B1B6		       mov     edi, [esp+0Ch+_SizeInBytes]
.text:0040B1BA		       cmp     edi, ebx
.text:0040B1BC		       ja      short loc_40B1D9
.text:0040B1BE
.text:0040B1BE loc_40B1BE:			       ; CODE XREF: _strcpy_s+Bj
.text:0040B1BE					       ; _strcpy_s+3Aj
.text:0040B1BE		       call    __errno
.text:0040B1C3		       push    16h
.text:0040B1C5		       pop     esi
.text:0040B1C6		       mov     [eax], esi
.text:0040B1C8
.text:0040B1C8 loc_40B1C8:			       ; CODE XREF: _strcpy_s+5Dj
.text:0040B1C8		       push    ebx	       ; pReserved
.text:0040B1C9		       push    ebx	       ; nLine
.text:0040B1CA		       push    ebx	       ; pszFile
.text:0040B1CB		       push    ebx	       ; pszFunction
.text:0040B1CC		       push    ebx	       ; pszExpression
.text:0040B1CD		       call    __invalid_parameter
.text:0040B1D2		       add     esp, 14h
.text:0040B1D5		       mov     eax, esi
.text:0040B1D7		       jmp     short loc_40B20A
.text:0040B1D9 ; ---------------------------------------------------------------------------
.text:0040B1D9
.text:0040B1D9 loc_40B1D9:			       ; CODE XREF: _strcpy_s+13j
.text:0040B1D9		       mov     esi, [esp+0Ch+_Src]
.text:0040B1DD		       cmp     esi, ebx
.text:0040B1DF		       jnz     short loc_40B1E5
.text:0040B1E1		       mov     [ecx], bl
.text:0040B1E3		       jmp     short loc_40B1BE
.text:0040B1E5 ; ---------------------------------------------------------------------------
.text:0040B1E5
.text:0040B1E5 loc_40B1E5:			       ; CODE XREF: _strcpy_s+36j
.text:0040B1E5		       mov     edx, ecx
.text:0040B1E7
.text:0040B1E7 loc_40B1E7:			       ; CODE XREF: _strcpy_s+49j
.text:0040B1E7		       mov     al, [esi]
.text:0040B1E9		       mov     [edx], al
.text:0040B1EB		       inc     edx
.text:0040B1EC		       inc     esi
.text:0040B1ED		       cmp     al, bl
.text:0040B1EF		       jz      short loc_40B1F4
.text:0040B1F1		       dec     edi
.text:0040B1F2		       jnz     short loc_40B1E7
.text:0040B1F4
.text:0040B1F4 loc_40B1F4:			       ; CODE XREF: _strcpy_s+46j
.text:0040B1F4		       cmp     edi, ebx
.text:0040B1F6		       jnz     short loc_40B208
.text:0040B1F8		       mov     [ecx], bl
.text:0040B1FA		       call    __errno
.text:0040B1FF		       push    22h
.text:0040B201		       pop     ecx
.text:0040B202		       mov     [eax], ecx
.text:0040B204		       mov     esi, ecx
.text:0040B206		       jmp     short loc_40B1C8
.text:0040B208 ; ---------------------------------------------------------------------------
.text:0040B208
.text:0040B208 loc_40B208:			       ; CODE XREF: _strcpy_s+4Dj
.text:0040B208		       xor     eax, eax
.text:0040B20A
.text:0040B20A loc_40B20A:			       ; CODE XREF: _strcpy_s+2Ej
.text:0040B20A		       pop     edi
.text:0040B20B		       pop     esi
.text:0040B20C		       pop     ebx
.text:0040B20D		       retn
.text:0040B20D _strcpy_s       endp
.text:0040B20D
.text:0040B20E
.text:0040B20E ; =============== S U B R O U T I N E =======================================
.text:0040B20E
.text:0040B20E
.text:0040B20E ; int __cdecl _set_error_mode(int em)
.text:0040B20E __set_error_mode	proc near	       ; CODE XREF: __NMSG_WRITE+27p
.text:0040B20E					       ; __NMSG_WRITE+38p ...
.text:0040B20E
.text:0040B20E em	       = dword ptr  4
.text:0040B20E
.text:0040B20E		       mov     ecx, [esp+em]
.text:0040B212		       push    esi
.text:0040B213		       xor     esi, esi
.text:0040B215		       cmp     ecx, esi
.text:0040B217		       jl      short loc_40B237
.text:0040B219		       cmp     ecx, 2
.text:0040B21C		       jle     short loc_40B22A
.text:0040B21E		       cmp     ecx, 3
.text:0040B221		       jnz     short loc_40B237
.text:0040B223		       mov     eax, ___error_mode
.text:0040B228		       pop     esi
.text:0040B229		       retn
.text:0040B22A ; ---------------------------------------------------------------------------
.text:0040B22A
.text:0040B22A loc_40B22A:			       ; CODE XREF: __set_error_mode+Ej
.text:0040B22A		       mov     eax, ___error_mode
.text:0040B22F		       mov     ___error_mode, ecx
.text:0040B235		       pop     esi
.text:0040B236		       retn
.text:0040B237 ; ---------------------------------------------------------------------------
.text:0040B237
.text:0040B237 loc_40B237:			       ; CODE XREF: __set_error_mode+9j
.text:0040B237					       ; __set_error_mode+13j
.text:0040B237		       call    __errno
.text:0040B23C		       push    esi	       ; pReserved
.text:0040B23D		       push    esi	       ; nLine
.text:0040B23E		       push    esi	       ; pszFile
.text:0040B23F		       push    esi	       ; pszFunction
.text:0040B240		       push    esi	       ; pszExpression
.text:0040B241		       mov     dword ptr [eax],	16h
.text:0040B247		       call    __invalid_parameter
.text:0040B24C		       add     esp, 14h
.text:0040B24F		       or      eax, 0FFFFFFFFh
.text:0040B252		       pop     esi
.text:0040B253		       retn
.text:0040B253 __set_error_mode	endp
.text:0040B253
.text:0040B254
.text:0040B254 ; =============== S U B R O U T I N E =======================================
.text:0040B254
.text:0040B254
.text:0040B254 ; void __cdecl __set_app_type(int at)
.text:0040B254 ___set_app_type proc near
.text:0040B254
.text:0040B254 at	       = dword ptr  4
.text:0040B254
.text:0040B254		       mov     eax, [esp+at]
.text:0040B258		       mov     ___app_type, eax
.text:0040B25D		       retn
.text:0040B25D ___set_app_type endp
.text:0040B25D
.text:0040B25E
.text:0040B25E ; =============== S U B R O U T I N E =======================================
.text:0040B25E
.text:0040B25E
.text:0040B25E ; int __cdecl __get_app_type()
.text:0040B25E ___get_app_type proc near
.text:0040B25E		       mov     eax, ___app_type
.text:0040B263		       retn
.text:0040B263 ___get_app_type endp
.text:0040B263
.text:0040B264
.text:0040B264 ; =============== S U B R O U T I N E =======================================
.text:0040B264
.text:0040B264 ; Attributes: bp-based frame
.text:0040B264
.text:0040B264 ; unsigned int __cdecl _msize(void *pblock)
.text:0040B264 __msize	       proc near	       ; CODE XREF: _onexit_nolock+3Ap
.text:0040B264					       ; __recalloc+45p
.text:0040B264
.text:0040B264 pHeader	       = dword ptr -20h
.text:0040B264 retval	       = dword ptr -1Ch
.text:0040B264 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040B264 pblock	       = dword ptr  8
.text:0040B264
.text:0040B264		       push    10h
.text:0040B266		       push    offset dword_421818
.text:0040B26B		       call    __SEH_prolog4
.text:0040B270		       xor     eax, eax
.text:0040B272		       mov     ebx, [ebp+pblock]
.text:0040B275		       xor     edi, edi
.text:0040B277		       cmp     ebx, edi
.text:0040B279		       setnz   al
.text:0040B27C		       cmp     eax, edi
.text:0040B27E		       jnz     short loc_40B29D
.text:0040B280		       call    __errno
.text:0040B285		       mov     dword ptr [eax],	16h
.text:0040B28B		       push    edi	       ; pReserved
.text:0040B28C		       push    edi	       ; nLine
.text:0040B28D		       push    edi	       ; pszFile
.text:0040B28E		       push    edi	       ; pszFunction
.text:0040B28F		       push    edi	       ; pszExpression
.text:0040B290		       call    __invalid_parameter
.text:0040B295		       add     esp, 14h
.text:0040B298		       or      eax, 0FFFFFFFFh
.text:0040B29B		       jmp     short loc_40B2F0
.text:0040B29D ; ---------------------------------------------------------------------------
.text:0040B29D
.text:0040B29D loc_40B29D:			       ; CODE XREF: __msize+1Aj
.text:0040B29D		       cmp     ___active_heap, 3
.text:0040B2A4		       jnz     short loc_40B2DE
.text:0040B2A6		       push    4	       ; locknum
.text:0040B2A8		       call    __lock
.text:0040B2AD		       pop     ecx
.text:0040B2AE		       mov     [ebp+ms_exc.disabled], edi
.text:0040B2B1		       push    ebx	       ; pvAlloc
.text:0040B2B2		       call    ___sbh_find_block
.text:0040B2B7		       pop     ecx
.text:0040B2B8		       mov     [ebp+pHeader], eax
.text:0040B2BB		       cmp     eax, edi
.text:0040B2BD		       jz      short loc_40B2CA
.text:0040B2BF		       mov     esi, [ebx-4]
.text:0040B2C2		       sub     esi, 9
.text:0040B2C5		       mov     [ebp+retval], esi
.text:0040B2C8		       jmp     short loc_40B2CD
.text:0040B2CA ; ---------------------------------------------------------------------------
.text:0040B2CA
.text:0040B2CA loc_40B2CA:			       ; CODE XREF: __msize+59j
.text:0040B2CA		       mov     esi, [ebp+retval]
.text:0040B2CD
.text:0040B2CD loc_40B2CD:			       ; CODE XREF: __msize+64j
.text:0040B2CD		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040B2D4		       call    $LN12_7
.text:0040B2D9
.text:0040B2D9 $LN13_4:
.text:0040B2D9		       cmp     [ebp+pHeader], edi
.text:0040B2DC		       jnz     short loc_40B2EE
.text:0040B2DE
.text:0040B2DE loc_40B2DE:			       ; CODE XREF: __msize+40j
.text:0040B2DE		       push    ebx	       ; lpMem
.text:0040B2DF		       push    edi	       ; dwFlags
.text:0040B2E0		       push    __crtheap       ; hHeap
.text:0040B2E6		       call    ds:__imp__HeapSize@12 ; HeapSize(x,x,x)
.text:0040B2EC		       mov     esi, eax
.text:0040B2EE
.text:0040B2EE loc_40B2EE:			       ; CODE XREF: __msize+78j
.text:0040B2EE		       mov     eax, esi
.text:0040B2F0
.text:0040B2F0 loc_40B2F0:			       ; CODE XREF: __msize+37j
.text:0040B2F0		       call    __SEH_epilog4
.text:0040B2F5		       retn
.text:0040B2F6 ; ---------------------------------------------------------------------------
.text:0040B2F6
.text:0040B2F6 $LN10_4:				       ; DATA XREF: .rdata:00421830o
.text:0040B2F6		       xor     edi, edi
.text:0040B2F8		       mov     ebx, [ebp+pblock]
.text:0040B2FB		       mov     esi, [ebp+retval]
.text:0040B2FE
.text:0040B2FE $LN12_7:				       ; CODE XREF: __msize+70p
.text:0040B2FE		       push    4	       ; locknum
.text:0040B300		       call    __unlock
.text:0040B305		       pop     ecx
.text:0040B306
.text:0040B306 $LN11_5:
.text:0040B306		       retn
.text:0040B306 __msize	       endp ; sp-analysis failed
.text:0040B306
.text:0040B307
.text:0040B307 ; =============== S U B R O U T I N E =======================================
.text:0040B307
.text:0040B307
.text:0040B307 __fptrap	       proc near	       ; DATA XREF: .data:__cfltcvt_tabo
.text:0040B307					       ; .data:00422674o ...
.text:0040B307		       push    2	       ; rterrnum
.text:0040B309		       call    __amsg_exit
.text:0040B30E		       pop     ecx
.text:0040B30F		       retn
.text:0040B30F __fptrap	       endp
.text:0040B30F
.text:0040B310
.text:0040B310 ; =============== S U B R O U T I N E =======================================
.text:0040B310
.text:0040B310 ; Attributes: noreturn bp-based frame fpd=2A8h
.text:0040B310
.text:0040B310 ; void __cdecl abort()
.text:0040B310 _abort	       proc near	       ; CODE XREF: terminate(void):loc_4054B9p
.text:0040B310
.text:0040B310 ExceptionRecord = _EXCEPTION_RECORD ptr -328h
.text:0040B310 ExceptionPointers= _EXCEPTION_POINTERS ptr -2D8h
.text:0040B310 ContextRecord   = _CONTEXT ptr -2D0h
.text:0040B310 var_4	       = dword ptr -4
.text:0040B310
.text:0040B310		       push    ebp
.text:0040B311		       lea     ebp, [esp-2A8h]
.text:0040B318		       sub     esp, 328h
.text:0040B31E		       mov     eax, ___security_cookie
.text:0040B323		       xor     eax, ebp
.text:0040B325		       mov     [ebp+2A8h+var_4], eax
.text:0040B32B		       test    byte ptr	___abort_behavior, 1
.text:0040B332		       push    esi
.text:0040B333		       jz      short loc_40B33D
.text:0040B335		       push    0Ah	       ; rterrnum
.text:0040B337		       call    __NMSG_WRITE
.text:0040B33C		       pop     ecx
.text:0040B33D
.text:0040B33D loc_40B33D:			       ; CODE XREF: _abort+23j
.text:0040B33D		       call    ___get_sigabrt
.text:0040B342		       test    eax, eax
.text:0040B344		       jz      short loc_40B34E
.text:0040B346		       push    16h	       ; signum
.text:0040B348		       call    _raise
.text:0040B34D		       pop     ecx
.text:0040B34E
.text:0040B34E loc_40B34E:			       ; CODE XREF: _abort+34j
.text:0040B34E		       test    byte ptr	___abort_behavior, 2
.text:0040B355		       jz      loc_40B3FB
.text:0040B35B		       mov     [ebp+2A8h+ContextRecord._Eax], eax
.text:0040B361		       mov     [ebp+2A8h+ContextRecord._Ecx], ecx
.text:0040B367		       mov     [ebp+2A8h+ContextRecord._Edx], edx
.text:0040B36D		       mov     [ebp+2A8h+ContextRecord._Ebx], ebx
.text:0040B370		       mov     [ebp+2A8h+ContextRecord._Esi], esi
.text:0040B373		       mov     [ebp+2A8h+ContextRecord._Edi], edi
.text:0040B376		       mov     word ptr	[ebp+2A8h+ContextRecord.SegSs],	ss
.text:0040B37D		       mov     word ptr	[ebp+2A8h+ContextRecord.SegCs],	cs
.text:0040B384		       mov     word ptr	[ebp+2A8h+ContextRecord.SegDs],	ds
.text:0040B388		       mov     word ptr	[ebp+2A8h+ContextRecord.SegEs],	es
.text:0040B38C		       mov     word ptr	[ebp+2A8h+ContextRecord.SegFs],	fs
.text:0040B390		       mov     word ptr	[ebp+2A8h+ContextRecord.SegGs],	gs
.text:0040B394		       pushf
.text:0040B395		       pop     [ebp+2A8h+ContextRecord.EFlags]
.text:0040B39B		       mov     esi, [ebp+2ACh]
.text:0040B3A1		       lea     eax, [ebp+2ACh]
.text:0040B3A7		       mov     [ebp+2A8h+ContextRecord._Esp], eax
.text:0040B3AD		       mov     [ebp+2A8h+ContextRecord.ContextFlags], 10001h
.text:0040B3B4		       mov     [ebp+2A8h+ContextRecord._Eip], esi
.text:0040B3BA		       mov     eax, [eax-4]
.text:0040B3BD		       push    50h	       ; count
.text:0040B3BF		       mov     [ebp+2A8h+ContextRecord._Ebp], eax
.text:0040B3C5		       lea     eax, [ebp+2A8h+ExceptionRecord]
.text:0040B3C8		       push    0	       ; value
.text:0040B3CA		       push    eax	       ; dst
.text:0040B3CB		       call    _memset
.text:0040B3D0		       lea     eax, [ebp+2A8h+ExceptionRecord]
.text:0040B3D3		       add     esp, 0Ch
.text:0040B3D6		       mov     [ebp+2A8h+ExceptionPointers.ExceptionRecord], eax
.text:0040B3D9		       lea     eax, [ebp+2A8h+ContextRecord]
.text:0040B3DC		       push    0	       ; lpTopLevelExceptionFilter
.text:0040B3DE		       mov     [ebp+2A8h+ExceptionRecord.ExceptionCode], 40000015h
.text:0040B3E5		       mov     [ebp+2A8h+ExceptionRecord.ExceptionAddress], esi
.text:0040B3E8		       mov     [ebp+2A8h+ExceptionPointers.ContextRecord], eax
.text:0040B3EB		       call    ds:__imp__SetUnhandledExceptionFilter@4 ; SetUnhandledExceptionFilter(x)
.text:0040B3F1		       lea     eax, [ebp+2A8h+ExceptionPointers]
.text:0040B3F4		       push    eax	       ; ExceptionInfo
.text:0040B3F5		       call    ds:__imp__UnhandledExceptionFilter@4 ; UnhandledExceptionFilter(x)
.text:0040B3FB
.text:0040B3FB loc_40B3FB:			       ; CODE XREF: _abort+45j
.text:0040B3FB		       push    3	       ; code
.text:0040B3FD		       call    __exit
.text:0040B3FD ; ---------------------------------------------------------------------------
.text:0040B402 $LN7_7	       db 0CCh
.text:0040B402 _abort	       endp
.text:0040B402
.text:0040B403
.text:0040B403 ; =============== S U B R O U T I N E =======================================
.text:0040B403
.text:0040B403
.text:0040B403 ; unsigned int __cdecl _set_abort_behavior(unsigned int flags, unsigned int mask)
.text:0040B403 __set_abort_behavior proc near
.text:0040B403
.text:0040B403 flags	       = dword ptr  4
.text:0040B403 mask	       = dword ptr  8
.text:0040B403
.text:0040B403		       mov     ecx, [esp+mask]
.text:0040B407		       mov     eax, ___abort_behavior
.text:0040B40C		       mov     edx, [esp+flags]
.text:0040B410		       and     edx, [esp+mask]
.text:0040B414		       not     ecx
.text:0040B416		       and     ecx, eax
.text:0040B418		       or      ecx, edx
.text:0040B41A		       mov     ___abort_behavior, ecx
.text:0040B420		       retn
.text:0040B420 __set_abort_behavior endp
.text:0040B420
.text:0040B420 ; ---------------------------------------------------------------------------
.text:0040B421		       align 10h
.text:0040B430
.text:0040B430 ; =============== S U B R O U T I N E =======================================
.text:0040B430
.text:0040B430 ; Attributes: bp-based frame
.text:0040B430
.text:0040B430 ; void __cdecl memcpy(char *dst,	char *src, unsigned int	count)
.text:0040B430 _memcpy	       proc near	       ; CODE XREF: _signal+A2p
.text:0040B430					       ; ___crtGetEnvironmentStringsA+11Dp ...
.text:0040B430
.text:0040B430 dst	       = dword ptr  8
.text:0040B430 src	       = dword ptr  0Ch
.text:0040B430 count	       = dword ptr  10h
.text:0040B430
.text:0040B430		       push    ebp
.text:0040B431		       mov     ebp, esp
.text:0040B433		       push    edi
.text:0040B434		       push    esi
.text:0040B435		       mov     esi, [ebp+src]
.text:0040B438		       mov     ecx, [ebp+count]
.text:0040B43B		       mov     edi, [ebp+dst]
.text:0040B43E		       mov     eax, ecx
.text:0040B440		       mov     edx, ecx
.text:0040B442		       add     eax, esi
.text:0040B444		       cmp     edi, esi
.text:0040B446		       jbe     short CopyUp_0
.text:0040B448		       cmp     edi, eax
.text:0040B44A		       jb      CopyDown_0
.text:0040B450
.text:0040B450 CopyUp_0:			       ; CODE XREF: _memcpy+16j
.text:0040B450		       cmp     ecx, 100h
.text:0040B456		       jb      short Dword_align_0
.text:0040B458		       cmp     ___sse2_available, 0
.text:0040B45F		       jz      short Dword_align_0
.text:0040B461		       push    edi
.text:0040B462		       push    esi
.text:0040B463		       and     edi, 0Fh
.text:0040B466		       and     esi, 0Fh
.text:0040B469		       cmp     edi, esi
.text:0040B46B		       pop     esi
.text:0040B46C		       pop     edi
.text:0040B46D		       jnz     short Dword_align_0
.text:0040B46F		       pop     esi
.text:0040B470		       pop     edi
.text:0040B471		       pop     ebp
.text:0040B472		       jmp     __VEC_memcpy
.text:0040B477 ; ---------------------------------------------------------------------------
.text:0040B477
.text:0040B477 Dword_align_0:			       ; CODE XREF: _memcpy+26j
.text:0040B477					       ; _memcpy+2Fj ...
.text:0040B477		       test    edi, 3
.text:0040B47D		       jnz     short CopyLeadUp_0
.text:0040B47F		       shr     ecx, 2
.text:0040B482		       and     edx, 3
.text:0040B485		       cmp     ecx, 8
.text:0040B488		       jb      short CopyUnwindUp_0
.text:0040B48A		       rep movsd
.text:0040B48C		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040B48C ; ---------------------------------------------------------------------------
.text:0040B493		       align 4
.text:0040B494
.text:0040B494 CopyLeadUp_0:			       ; CODE XREF: _memcpy+4Dj
.text:0040B494		       mov     eax, edi
.text:0040B496		       mov     edx, 3
.text:0040B49B		       sub     ecx, 4
.text:0040B49E		       jb      short ByteCopyUp_0
.text:0040B4A0		       and     eax, 3
.text:0040B4A3		       add     ecx, eax
.text:0040B4A5		       jmp     dword ptr ds:CopyUnwindUp_0+4[eax*4]
.text:0040B4AC ; ---------------------------------------------------------------------------
.text:0040B4AC
.text:0040B4AC ByteCopyUp_0:			       ; CODE XREF: _memcpy+6Ej
.text:0040B4AC		       jmp     ds:TrailUp0_0[ecx*4]
.text:0040B4AC ; ---------------------------------------------------------------------------
.text:0040B4B3		       align 4
.text:0040B4B4
.text:0040B4B4 CopyUnwindUp_0:			       ; CODE XREF: _memcpy+58j
.text:0040B4B4					       ; _memcpy+B6j ...
.text:0040B4B4		       jmp     ds:UnwindUpVec_0[ecx*4]
.text:0040B4B4 ; ---------------------------------------------------------------------------
.text:0040B4BB		       align 4
.text:0040B4BC ; unsigned int LeadUpVec_0
.text:0040B4BC LeadUpVec_0     dd offset LeadUp1_0
.text:0040B4C0		       dd offset LeadUp2_0
.text:0040B4C4		       dd offset LeadUp3_0
.text:0040B4C8 ; ---------------------------------------------------------------------------
.text:0040B4C8
.text:0040B4C8 LeadUp1_0:			       ; DATA XREF: _memcpy:LeadUpVec_0o
.text:0040B4C8		       and     edx, ecx
.text:0040B4CA		       mov     al, [esi]
.text:0040B4CC		       mov     [edi], al
.text:0040B4CE		       mov     al, [esi+1]
.text:0040B4D1		       mov     [edi+1],	al
.text:0040B4D4		       mov     al, [esi+2]
.text:0040B4D7		       shr     ecx, 2
.text:0040B4DA		       mov     [edi+2],	al
.text:0040B4DD		       add     esi, 3
.text:0040B4E0		       add     edi, 3
.text:0040B4E3		       cmp     ecx, 8
.text:0040B4E6		       jb      short CopyUnwindUp_0
.text:0040B4E8		       rep movsd
.text:0040B4EA		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040B4EA ; ---------------------------------------------------------------------------
.text:0040B4F1		       align 4
.text:0040B4F4
.text:0040B4F4 LeadUp2_0:			       ; DATA XREF: _memcpy+90o
.text:0040B4F4		       and     edx, ecx
.text:0040B4F6		       mov     al, [esi]
.text:0040B4F8		       mov     [edi], al
.text:0040B4FA		       mov     al, [esi+1]
.text:0040B4FD		       shr     ecx, 2
.text:0040B500		       mov     [edi+1],	al
.text:0040B503		       add     esi, 2
.text:0040B506		       add     edi, 2
.text:0040B509		       cmp     ecx, 8
.text:0040B50C		       jb      short CopyUnwindUp_0
.text:0040B50E		       rep movsd
.text:0040B510		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040B510 ; ---------------------------------------------------------------------------
.text:0040B517		       align 4
.text:0040B518
.text:0040B518 LeadUp3_0:			       ; DATA XREF: _memcpy+94o
.text:0040B518		       and     edx, ecx
.text:0040B51A		       mov     al, [esi]
.text:0040B51C		       mov     [edi], al
.text:0040B51E		       add     esi, 1
.text:0040B521		       shr     ecx, 2
.text:0040B524		       add     edi, 1
.text:0040B527		       cmp     ecx, 8
.text:0040B52A		       jb      short CopyUnwindUp_0
.text:0040B52C		       rep movsd
.text:0040B52E		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040B52E ; ---------------------------------------------------------------------------
.text:0040B535		       align 4
.text:0040B538 ; unsigned int UnwindUpVec_0
.text:0040B538 UnwindUpVec_0   dd offset UnwindUp0_0   ; DATA XREF: _memcpy:CopyUnwindUp_0r
.text:0040B53C		       dd offset UnwindUp1_0
.text:0040B540		       dd offset UnwindUp2_0
.text:0040B544		       dd offset UnwindUp3_0
.text:0040B548		       dd offset UnwindUp4_0
.text:0040B54C		       dd offset UnwindUp5_0
.text:0040B550		       dd offset UnwindUp6_0
.text:0040B554		       dd offset UnwindUp7_0
.text:0040B558 ; ---------------------------------------------------------------------------
.text:0040B558
.text:0040B558 UnwindUp7_0:			       ; CODE XREF: _memcpy:CopyUnwindUp_0j
.text:0040B558					       ; DATA XREF: _memcpy+124o
.text:0040B558		       mov     eax, [esi+ecx*4-1Ch]
.text:0040B55C		       mov     [edi+ecx*4-1Ch],	eax
.text:0040B560
.text:0040B560 UnwindUp6_0:			       ; CODE XREF: _memcpy:CopyUnwindUp_0j
.text:0040B560					       ; DATA XREF: _memcpy+120o
.text:0040B560		       mov     eax, [esi+ecx*4-18h]
.text:0040B564		       mov     [edi+ecx*4-18h],	eax
.text:0040B568
.text:0040B568 UnwindUp5_0:			       ; CODE XREF: _memcpy:CopyUnwindUp_0j
.text:0040B568					       ; DATA XREF: _memcpy+11Co
.text:0040B568		       mov     eax, [esi+ecx*4-14h]
.text:0040B56C		       mov     [edi+ecx*4-14h],	eax
.text:0040B570
.text:0040B570 UnwindUp4_0:			       ; CODE XREF: _memcpy:CopyUnwindUp_0j
.text:0040B570					       ; DATA XREF: _memcpy+118o
.text:0040B570		       mov     eax, [esi+ecx*4-10h]
.text:0040B574		       mov     [edi+ecx*4-10h],	eax
.text:0040B578
.text:0040B578 UnwindUp3_0:			       ; CODE XREF: _memcpy:CopyUnwindUp_0j
.text:0040B578					       ; DATA XREF: _memcpy+114o
.text:0040B578		       mov     eax, [esi+ecx*4-0Ch]
.text:0040B57C		       mov     [edi+ecx*4-0Ch],	eax
.text:0040B580
.text:0040B580 UnwindUp2_0:			       ; CODE XREF: _memcpy:CopyUnwindUp_0j
.text:0040B580					       ; DATA XREF: _memcpy+110o
.text:0040B580		       mov     eax, [esi+ecx*4-8]
.text:0040B584		       mov     [edi+ecx*4-8], eax
.text:0040B588
.text:0040B588 UnwindUp1_0:			       ; CODE XREF: _memcpy:CopyUnwindUp_0j
.text:0040B588					       ; DATA XREF: _memcpy+10Co
.text:0040B588		       mov     eax, [esi+ecx*4-4]
.text:0040B58C		       mov     [edi+ecx*4-4], eax
.text:0040B590		       lea     eax, ds:0[ecx*4]
.text:0040B597		       add     esi, eax
.text:0040B599		       add     edi, eax
.text:0040B59B
.text:0040B59B UnwindUp0_0:			       ; CODE XREF: _memcpy:CopyUnwindUp_0j
.text:0040B59B					       ; DATA XREF: _memcpy:UnwindUpVec_0o
.text:0040B59B		       jmp     ds:TrailUpVec_0[edx*4]
.text:0040B59B ; ---------------------------------------------------------------------------
.text:0040B5A2		       align 4
.text:0040B5A4 ; unsigned int TrailUpVec_0
.text:0040B5A4 TrailUpVec_0    dd offset TrailUp0_0    ; DATA XREF: _memcpy+5Cr
.text:0040B5A4					       ; _memcpy+BAr ...
.text:0040B5A8		       dd offset TrailUp1_0
.text:0040B5AC		       dd offset TrailUp2_0
.text:0040B5B0		       dd offset TrailUp3_0
.text:0040B5B4 TrailUp0_0      dd 5E08458Bh	       ; CODE XREF: _memcpy+5Cj
.text:0040B5B4					       ; DATA XREF: _memcpy:ByteCopyUp_0r ...
.text:0040B5B8 ; ---------------------------------------------------------------------------
.text:0040B5B8		       pop     edi
.text:0040B5B9		       leave
.text:0040B5BA		       retn
.text:0040B5BA ; ---------------------------------------------------------------------------
.text:0040B5BB		       align 4
.text:0040B5BC
.text:0040B5BC TrailUp1_0:			       ; CODE XREF: _memcpy+5Cj
.text:0040B5BC					       ; DATA XREF: _memcpy+178o
.text:0040B5BC		       mov     al, [esi]
.text:0040B5BE		       mov     [edi], al
.text:0040B5C0		       mov     eax, [ebp+dst]
.text:0040B5C3		       pop     esi
.text:0040B5C4		       pop     edi
.text:0040B5C5		       leave
.text:0040B5C6		       retn
.text:0040B5C6 ; ---------------------------------------------------------------------------
.text:0040B5C7		       align 4
.text:0040B5C8
.text:0040B5C8 TrailUp2_0:			       ; CODE XREF: _memcpy+5Cj
.text:0040B5C8					       ; DATA XREF: _memcpy+17Co
.text:0040B5C8		       mov     al, [esi]
.text:0040B5CA		       mov     [edi], al
.text:0040B5CC		       mov     al, [esi+1]
.text:0040B5CF		       mov     [edi+1],	al
.text:0040B5D2		       mov     eax, [ebp+dst]
.text:0040B5D5		       pop     esi
.text:0040B5D6		       pop     edi
.text:0040B5D7		       leave
.text:0040B5D8		       retn
.text:0040B5D8 ; ---------------------------------------------------------------------------
.text:0040B5D9		       align 4
.text:0040B5DC
.text:0040B5DC TrailUp3_0:			       ; CODE XREF: _memcpy+5Cj
.text:0040B5DC					       ; DATA XREF: _memcpy+180o
.text:0040B5DC		       mov     al, [esi]
.text:0040B5DE		       mov     [edi], al
.text:0040B5E0		       mov     al, [esi+1]
.text:0040B5E3		       mov     [edi+1],	al
.text:0040B5E6		       mov     al, [esi+2]
.text:0040B5E9		       mov     [edi+2],	al
.text:0040B5EC		       mov     eax, [ebp+dst]
.text:0040B5EF		       pop     esi
.text:0040B5F0		       pop     edi
.text:0040B5F1		       leave
.text:0040B5F2		       retn
.text:0040B5F2 ; ---------------------------------------------------------------------------
.text:0040B5F3		       align 4
.text:0040B5F4
.text:0040B5F4 CopyDown_0:			       ; CODE XREF: _memcpy+1Aj
.text:0040B5F4		       lea     esi, [ecx+esi-4]
.text:0040B5F8		       lea     edi, [ecx+edi-4]
.text:0040B5FC		       test    edi, 3
.text:0040B602		       jnz     short CopyLeadDown_0
.text:0040B604		       shr     ecx, 2
.text:0040B607		       and     edx, 3
.text:0040B60A		       cmp     ecx, 8
.text:0040B60D		       jb      short CopyUnwindDown_0
.text:0040B60F		       std
.text:0040B610		       rep movsd
.text:0040B612		       cld
.text:0040B613		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040B613 ; ---------------------------------------------------------------------------
.text:0040B61A		       align 4
.text:0040B61C
.text:0040B61C CopyUnwindDown_0:		       ; CODE XREF: _memcpy+1DDj
.text:0040B61C					       ; _memcpy+238j ...
.text:0040B61C		       neg     ecx
.text:0040B61E		       jmp     ds:off_40B6F0[ecx*4]
.text:0040B61E ; ---------------------------------------------------------------------------
.text:0040B625		       align 4
.text:0040B628
.text:0040B628 CopyLeadDown_0:			       ; CODE XREF: _memcpy+1D2j
.text:0040B628		       mov     eax, edi
.text:0040B62A		       mov     edx, 3
.text:0040B62F		       cmp     ecx, 4
.text:0040B632		       jb      short ByteCopyDown_0
.text:0040B634		       and     eax, 3
.text:0040B637		       sub     ecx, eax
.text:0040B639		       jmp     dword ptr ds:ByteCopyDown_0+4[eax*4]
.text:0040B640 ; ---------------------------------------------------------------------------
.text:0040B640
.text:0040B640 ByteCopyDown_0:			       ; CODE XREF: _memcpy+202j
.text:0040B640					       ; DATA XREF: _memcpy+209r
.text:0040B640		       jmp     ds:TrailDownVec_0[ecx*4]
.text:0040B640 ; ---------------------------------------------------------------------------
.text:0040B647		       align 4
.text:0040B648 ; unsigned int LeadDownVec_0
.text:0040B648 LeadDownVec_0   dd offset LeadDown1_0
.text:0040B64C		       dd offset LeadDown2_0
.text:0040B650		       dd offset LeadDown3_0
.text:0040B654 ; ---------------------------------------------------------------------------
.text:0040B654
.text:0040B654 LeadDown1_0:			       ; DATA XREF: _memcpy:LeadDownVec_0o
.text:0040B654		       mov     al, [esi+3]
.text:0040B657		       and     edx, ecx
.text:0040B659		       mov     [edi+3],	al
.text:0040B65C		       sub     esi, 1
.text:0040B65F		       shr     ecx, 2
.text:0040B662		       sub     edi, 1
.text:0040B665		       cmp     ecx, 8
.text:0040B668		       jb      short CopyUnwindDown_0
.text:0040B66A		       std
.text:0040B66B		       rep movsd
.text:0040B66D		       cld
.text:0040B66E		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040B66E ; ---------------------------------------------------------------------------
.text:0040B675		       align 4
.text:0040B678
.text:0040B678 LeadDown2_0:			       ; DATA XREF: _memcpy+21Co
.text:0040B678		       mov     al, [esi+3]
.text:0040B67B		       and     edx, ecx
.text:0040B67D		       mov     [edi+3],	al
.text:0040B680		       mov     al, [esi+2]
.text:0040B683		       shr     ecx, 2
.text:0040B686		       mov     [edi+2],	al
.text:0040B689		       sub     esi, 2
.text:0040B68C		       sub     edi, 2
.text:0040B68F		       cmp     ecx, 8
.text:0040B692		       jb      short CopyUnwindDown_0
.text:0040B694		       std
.text:0040B695		       rep movsd
.text:0040B697		       cld
.text:0040B698		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040B698 ; ---------------------------------------------------------------------------
.text:0040B69F		       align 10h
.text:0040B6A0
.text:0040B6A0 LeadDown3_0:			       ; DATA XREF: _memcpy+220o
.text:0040B6A0		       mov     al, [esi+3]
.text:0040B6A3		       and     edx, ecx
.text:0040B6A5		       mov     [edi+3],	al
.text:0040B6A8		       mov     al, [esi+2]
.text:0040B6AB		       mov     [edi+2],	al
.text:0040B6AE		       mov     al, [esi+1]
.text:0040B6B1		       shr     ecx, 2
.text:0040B6B4		       mov     [edi+1],	al
.text:0040B6B7		       sub     esi, 3
.text:0040B6BA		       sub     edi, 3
.text:0040B6BD		       cmp     ecx, 8
.text:0040B6C0		       jb      CopyUnwindDown_0
.text:0040B6C6		       std
.text:0040B6C7		       rep movsd
.text:0040B6C9		       cld
.text:0040B6CA		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040B6CA ; ---------------------------------------------------------------------------
.text:0040B6D1		       align 4
.text:0040B6D4 ; unsigned int UnwindDownVec_0
.text:0040B6D4 UnwindDownVec_0 dd offset UnwindDown7_0
.text:0040B6D8		       dd offset UnwindDown6_0
.text:0040B6DC		       dd offset UnwindDown5_0
.text:0040B6E0		       dd offset UnwindDown4_0
.text:0040B6E4		       dd offset UnwindDown3_0
.text:0040B6E8		       dd offset UnwindDown2_0
.text:0040B6EC		       dd offset UnwindDown1_0
.text:0040B6F0 off_40B6F0      dd offset UnwindDown0_0 ; DATA XREF: _memcpy+1EEr
.text:0040B6F4 ; ---------------------------------------------------------------------------
.text:0040B6F4
.text:0040B6F4 UnwindDown7_0:			       ; DATA XREF: _memcpy:UnwindDownVec_0o
.text:0040B6F4		       mov     eax, [esi+ecx*4+1Ch]
.text:0040B6F8		       mov     [edi+ecx*4+1Ch],	eax
.text:0040B6FC
.text:0040B6FC UnwindDown6_0:			       ; DATA XREF: _memcpy+2A8o
.text:0040B6FC		       mov     eax, [esi+ecx*4+18h]
.text:0040B700		       mov     [edi+ecx*4+18h],	eax
.text:0040B704
.text:0040B704 UnwindDown5_0:			       ; DATA XREF: _memcpy+2ACo
.text:0040B704		       mov     eax, [esi+ecx*4+14h]
.text:0040B708		       mov     [edi+ecx*4+14h],	eax
.text:0040B70C
.text:0040B70C UnwindDown4_0:			       ; DATA XREF: _memcpy+2B0o
.text:0040B70C		       mov     eax, [esi+ecx*4+10h]
.text:0040B710		       mov     [edi+ecx*4+10h],	eax
.text:0040B714
.text:0040B714 UnwindDown3_0:			       ; DATA XREF: _memcpy+2B4o
.text:0040B714		       mov     eax, [esi+ecx*4+0Ch]
.text:0040B718		       mov     [edi+ecx*4+0Ch],	eax
.text:0040B71C
.text:0040B71C UnwindDown2_0:			       ; DATA XREF: _memcpy+2B8o
.text:0040B71C		       mov     eax, [esi+ecx*4+8]
.text:0040B720		       mov     [edi+ecx*4+8], eax
.text:0040B724
.text:0040B724 UnwindDown1_0:			       ; DATA XREF: _memcpy+2BCo
.text:0040B724		       mov     eax, [esi+ecx*4+4]
.text:0040B728		       mov     [edi+ecx*4+4], eax
.text:0040B72C		       lea     eax, ds:0[ecx*4]
.text:0040B733		       add     esi, eax
.text:0040B735		       add     edi, eax
.text:0040B737
.text:0040B737 UnwindDown0_0:			       ; CODE XREF: _memcpy+1EEj
.text:0040B737					       ; DATA XREF: _memcpy:off_40B6F0o
.text:0040B737		       jmp     ds:TrailDownVec_0[edx*4]
.text:0040B737 ; ---------------------------------------------------------------------------
.text:0040B73E		       align 10h
.text:0040B740 ; unsigned int TrailDownVec_0
.text:0040B740 TrailDownVec_0  dd offset TrailDown0_0  ; DATA XREF: _memcpy+1E3r
.text:0040B740					       ; _memcpy:ByteCopyDown_0r ...
.text:0040B744		       dd offset TrailDown1_0
.text:0040B748		       dd offset TrailDown2_0
.text:0040B74C		       dd offset TrailDown3_0
.text:0040B750 ; ---------------------------------------------------------------------------
.text:0040B750
.text:0040B750 TrailDown0_0:			       ; CODE XREF: _memcpy+1E3j
.text:0040B750					       ; _memcpy:ByteCopyDown_0j ...
.text:0040B750		       mov     eax, [ebp+dst]
.text:0040B753		       pop     esi
.text:0040B754		       pop     edi
.text:0040B755		       leave
.text:0040B756		       retn
.text:0040B756 ; ---------------------------------------------------------------------------
.text:0040B757		       align 4
.text:0040B758
.text:0040B758 TrailDown1_0:			       ; CODE XREF: _memcpy+1E3j
.text:0040B758					       ; _memcpy:ByteCopyDown_0j ...
.text:0040B758		       mov     al, [esi+3]
.text:0040B75B		       mov     [edi+3],	al
.text:0040B75E		       mov     eax, [ebp+dst]
.text:0040B761		       pop     esi
.text:0040B762		       pop     edi
.text:0040B763		       leave
.text:0040B764		       retn
.text:0040B764 ; ---------------------------------------------------------------------------
.text:0040B765		       align 4
.text:0040B768
.text:0040B768 TrailDown2_0:			       ; CODE XREF: _memcpy+1E3j
.text:0040B768					       ; _memcpy:ByteCopyDown_0j ...
.text:0040B768		       mov     al, [esi+3]
.text:0040B76B		       mov     [edi+3],	al
.text:0040B76E		       mov     al, [esi+2]
.text:0040B771		       mov     [edi+2],	al
.text:0040B774		       mov     eax, [ebp+dst]
.text:0040B777		       pop     esi
.text:0040B778		       pop     edi
.text:0040B779		       leave
.text:0040B77A		       retn
.text:0040B77A ; ---------------------------------------------------------------------------
.text:0040B77B		       align 4
.text:0040B77C
.text:0040B77C TrailDown3_0:			       ; CODE XREF: _memcpy+1E3j
.text:0040B77C					       ; _memcpy:ByteCopyDown_0j ...
.text:0040B77C		       mov     al, [esi+3]
.text:0040B77F		       mov     [edi+3],	al
.text:0040B782		       mov     al, [esi+2]
.text:0040B785		       mov     [edi+2],	al
.text:0040B788		       mov     al, [esi+1]
.text:0040B78B		       mov     [edi+1],	al
.text:0040B78E		       mov     eax, [ebp+dst]
.text:0040B791		       pop     esi
.text:0040B792		       pop     edi
.text:0040B793		       leave
.text:0040B794		       retn
.text:0040B794 _memcpy	       endp
.text:0040B794
.text:0040B795
.text:0040B795 ; =============== S U B R O U T I N E =======================================
.text:0040B795
.text:0040B795 ; Attributes: bp-based frame
.text:0040B795
.text:0040B795 ; int __cdecl _isalpha_l(int c, localeinfo_struct *plocinfo)
.text:0040B795 __isalpha_l     proc near	       ; CODE XREF: _isalpha+23p
.text:0040B795					       ; __iscsymf_l+8p
.text:0040B795
.text:0040B795 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B795 c	       = dword ptr  8
.text:0040B795 plocinfo	       = dword ptr  0Ch
.text:0040B795
.text:0040B795		       push    ebp
.text:0040B796		       mov     ebp, esp
.text:0040B798		       sub     esp, 10h
.text:0040B79B		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B79E		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B7A1		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B7A6		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B7A9		       cmp     dword ptr [eax+0ACh], 1
.text:0040B7B0		       jle     short loc_40B7C8
.text:0040B7B2		       lea     eax, [ebp+_loc_update]
.text:0040B7B5		       push    eax	       ; plocinfo
.text:0040B7B6		       push    103h	       ; mask
.text:0040B7BB		       push    [ebp+c]	       ; c
.text:0040B7BE		       call    __isctype_l
.text:0040B7C3		       add     esp, 0Ch
.text:0040B7C6		       jmp     short loc_40B7DA
.text:0040B7C8 ; ---------------------------------------------------------------------------
.text:0040B7C8
.text:0040B7C8 loc_40B7C8:			       ; CODE XREF: __isalpha_l+1Bj
.text:0040B7C8		       mov     eax, [eax+0C8h]
.text:0040B7CE		       mov     ecx, [ebp+c]
.text:0040B7D1		       movzx   eax, word ptr [eax+ecx*2]
.text:0040B7D5		       and     eax, 103h
.text:0040B7DA
.text:0040B7DA loc_40B7DA:			       ; CODE XREF: __isalpha_l+31j
.text:0040B7DA		       cmp     [ebp+_loc_update.updated], 0
.text:0040B7DE		       jz      short locret_40B7E7
.text:0040B7E0		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B7E3		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B7E7
.text:0040B7E7 locret_40B7E7:			       ; CODE XREF: __isalpha_l+49j
.text:0040B7E7		       leave
.text:0040B7E8		       retn
.text:0040B7E8 __isalpha_l     endp
.text:0040B7E8
.text:0040B7E9
.text:0040B7E9 ; =============== S U B R O U T I N E =======================================
.text:0040B7E9
.text:0040B7E9
.text:0040B7E9 ; int __cdecl isalpha(int c)
.text:0040B7E9 _isalpha	       proc near	       ; CODE XREF: ___iscsymf+4p
.text:0040B7E9
.text:0040B7E9 c	       = dword ptr  4
.text:0040B7E9
.text:0040B7E9		       cmp     ___locale_changed, 0
.text:0040B7F0		       jnz     short loc_40B806
.text:0040B7F2		       mov     eax, [esp+c]
.text:0040B7F6		       mov     ecx, ___initiallocinfo.pctype
.text:0040B7FC		       movzx   eax, word ptr [ecx+eax*2]
.text:0040B800		       and     eax, 103h
.text:0040B805		       retn
.text:0040B806 ; ---------------------------------------------------------------------------
.text:0040B806
.text:0040B806 loc_40B806:			       ; CODE XREF: _isalpha+7j
.text:0040B806		       push    0	       ; plocinfo
.text:0040B808		       push    [esp+4+c]       ; c
.text:0040B80C		       call    __isalpha_l
.text:0040B811		       pop     ecx
.text:0040B812		       pop     ecx
.text:0040B813		       retn
.text:0040B813 _isalpha	       endp
.text:0040B813
.text:0040B814
.text:0040B814 ; =============== S U B R O U T I N E =======================================
.text:0040B814
.text:0040B814 ; Attributes: bp-based frame
.text:0040B814
.text:0040B814 ; int __cdecl _isupper_l(int c, localeinfo_struct *plocinfo)
.text:0040B814 __isupper_l     proc near	       ; CODE XREF: _isupper+21p
.text:0040B814
.text:0040B814 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B814 c	       = dword ptr  8
.text:0040B814 plocinfo	       = dword ptr  0Ch
.text:0040B814
.text:0040B814		       push    ebp
.text:0040B815		       mov     ebp, esp
.text:0040B817		       sub     esp, 10h
.text:0040B81A		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B81D		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B820		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B825		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B828		       cmp     dword ptr [eax+0ACh], 1
.text:0040B82F		       jle     short loc_40B844
.text:0040B831		       lea     eax, [ebp+_loc_update]
.text:0040B834		       push    eax	       ; plocinfo
.text:0040B835		       push    1	       ; mask
.text:0040B837		       push    [ebp+c]	       ; c
.text:0040B83A		       call    __isctype_l
.text:0040B83F		       add     esp, 0Ch
.text:0040B842		       jmp     short loc_40B854
.text:0040B844 ; ---------------------------------------------------------------------------
.text:0040B844
.text:0040B844 loc_40B844:			       ; CODE XREF: __isupper_l+1Bj
.text:0040B844		       mov     eax, [eax+0C8h]
.text:0040B84A		       mov     ecx, [ebp+c]
.text:0040B84D		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B851		       and     eax, 1
.text:0040B854
.text:0040B854 loc_40B854:			       ; CODE XREF: __isupper_l+2Ej
.text:0040B854		       cmp     [ebp+_loc_update.updated], 0
.text:0040B858		       jz      short locret_40B861
.text:0040B85A		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B85D		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B861
.text:0040B861 locret_40B861:			       ; CODE XREF: __isupper_l+44j
.text:0040B861		       leave
.text:0040B862		       retn
.text:0040B862 __isupper_l     endp
.text:0040B862
.text:0040B863
.text:0040B863 ; =============== S U B R O U T I N E =======================================
.text:0040B863
.text:0040B863
.text:0040B863 ; int __cdecl isupper(int c)
.text:0040B863 _isupper	       proc near
.text:0040B863
.text:0040B863 c	       = dword ptr  4
.text:0040B863
.text:0040B863		       cmp     ___locale_changed, 0
.text:0040B86A		       jnz     short loc_40B87E
.text:0040B86C		       mov     eax, [esp+c]
.text:0040B870		       mov     ecx, ___initiallocinfo.pctype
.text:0040B876		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B87A		       and     eax, 1
.text:0040B87D		       retn
.text:0040B87E ; ---------------------------------------------------------------------------
.text:0040B87E
.text:0040B87E loc_40B87E:			       ; CODE XREF: _isupper+7j
.text:0040B87E		       push    0	       ; plocinfo
.text:0040B880		       push    [esp+4+c]       ; c
.text:0040B884		       call    __isupper_l
.text:0040B889		       pop     ecx
.text:0040B88A		       pop     ecx
.text:0040B88B		       retn
.text:0040B88B _isupper	       endp
.text:0040B88B
.text:0040B88C
.text:0040B88C ; =============== S U B R O U T I N E =======================================
.text:0040B88C
.text:0040B88C ; Attributes: bp-based frame
.text:0040B88C
.text:0040B88C ; int __cdecl _islower_l(int c, localeinfo_struct *plocinfo)
.text:0040B88C __islower_l     proc near	       ; CODE XREF: _islower+21p
.text:0040B88C
.text:0040B88C _loc_update     = _LocaleUpdate ptr -10h
.text:0040B88C c	       = dword ptr  8
.text:0040B88C plocinfo	       = dword ptr  0Ch
.text:0040B88C
.text:0040B88C		       push    ebp
.text:0040B88D		       mov     ebp, esp
.text:0040B88F		       sub     esp, 10h
.text:0040B892		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B895		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B898		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B89D		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B8A0		       cmp     dword ptr [eax+0ACh], 1
.text:0040B8A7		       jle     short loc_40B8BC
.text:0040B8A9		       lea     eax, [ebp+_loc_update]
.text:0040B8AC		       push    eax	       ; plocinfo
.text:0040B8AD		       push    2	       ; mask
.text:0040B8AF		       push    [ebp+c]	       ; c
.text:0040B8B2		       call    __isctype_l
.text:0040B8B7		       add     esp, 0Ch
.text:0040B8BA		       jmp     short loc_40B8CC
.text:0040B8BC ; ---------------------------------------------------------------------------
.text:0040B8BC
.text:0040B8BC loc_40B8BC:			       ; CODE XREF: __islower_l+1Bj
.text:0040B8BC		       mov     eax, [eax+0C8h]
.text:0040B8C2		       mov     ecx, [ebp+c]
.text:0040B8C5		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B8C9		       and     eax, 2
.text:0040B8CC
.text:0040B8CC loc_40B8CC:			       ; CODE XREF: __islower_l+2Ej
.text:0040B8CC		       cmp     [ebp+_loc_update.updated], 0
.text:0040B8D0		       jz      short locret_40B8D9
.text:0040B8D2		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B8D5		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B8D9
.text:0040B8D9 locret_40B8D9:			       ; CODE XREF: __islower_l+44j
.text:0040B8D9		       leave
.text:0040B8DA		       retn
.text:0040B8DA __islower_l     endp
.text:0040B8DA
.text:0040B8DB
.text:0040B8DB ; =============== S U B R O U T I N E =======================================
.text:0040B8DB
.text:0040B8DB
.text:0040B8DB ; int __cdecl islower(int c)
.text:0040B8DB _islower	       proc near
.text:0040B8DB
.text:0040B8DB c	       = dword ptr  4
.text:0040B8DB
.text:0040B8DB		       cmp     ___locale_changed, 0
.text:0040B8E2		       jnz     short loc_40B8F6
.text:0040B8E4		       mov     eax, [esp+c]
.text:0040B8E8		       mov     ecx, ___initiallocinfo.pctype
.text:0040B8EE		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B8F2		       and     eax, 2
.text:0040B8F5		       retn
.text:0040B8F6 ; ---------------------------------------------------------------------------
.text:0040B8F6
.text:0040B8F6 loc_40B8F6:			       ; CODE XREF: _islower+7j
.text:0040B8F6		       push    0	       ; plocinfo
.text:0040B8F8		       push    [esp+4+c]       ; c
.text:0040B8FC		       call    __islower_l
.text:0040B901		       pop     ecx
.text:0040B902		       pop     ecx
.text:0040B903		       retn
.text:0040B903 _islower	       endp
.text:0040B903
.text:0040B904
.text:0040B904 ; =============== S U B R O U T I N E =======================================
.text:0040B904
.text:0040B904 ; Attributes: bp-based frame
.text:0040B904
.text:0040B904 ; int __cdecl _isdigit_l(int c, localeinfo_struct *plocinfo)
.text:0040B904 __isdigit_l     proc near	       ; CODE XREF: _isdigit+21p
.text:0040B904
.text:0040B904 _loc_update     = _LocaleUpdate ptr -10h
.text:0040B904 c	       = dword ptr  8
.text:0040B904 plocinfo	       = dword ptr  0Ch
.text:0040B904
.text:0040B904		       push    ebp
.text:0040B905		       mov     ebp, esp
.text:0040B907		       sub     esp, 10h
.text:0040B90A		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B90D		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B910		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B915		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B918		       cmp     dword ptr [eax+0ACh], 1
.text:0040B91F		       jle     short loc_40B934
.text:0040B921		       lea     eax, [ebp+_loc_update]
.text:0040B924		       push    eax	       ; plocinfo
.text:0040B925		       push    4	       ; mask
.text:0040B927		       push    [ebp+c]	       ; c
.text:0040B92A		       call    __isctype_l
.text:0040B92F		       add     esp, 0Ch
.text:0040B932		       jmp     short loc_40B944
.text:0040B934 ; ---------------------------------------------------------------------------
.text:0040B934
.text:0040B934 loc_40B934:			       ; CODE XREF: __isdigit_l+1Bj
.text:0040B934		       mov     eax, [eax+0C8h]
.text:0040B93A		       mov     ecx, [ebp+c]
.text:0040B93D		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B941		       and     eax, 4
.text:0040B944
.text:0040B944 loc_40B944:			       ; CODE XREF: __isdigit_l+2Ej
.text:0040B944		       cmp     [ebp+_loc_update.updated], 0
.text:0040B948		       jz      short locret_40B951
.text:0040B94A		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B94D		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B951
.text:0040B951 locret_40B951:			       ; CODE XREF: __isdigit_l+44j
.text:0040B951		       leave
.text:0040B952		       retn
.text:0040B952 __isdigit_l     endp
.text:0040B952
.text:0040B953
.text:0040B953 ; =============== S U B R O U T I N E =======================================
.text:0040B953
.text:0040B953
.text:0040B953 ; int __cdecl isdigit(int c)
.text:0040B953 _isdigit	       proc near	       ; CODE XREF: ___getlocaleinfo+138p
.text:0040B953
.text:0040B953 c	       = dword ptr  4
.text:0040B953
.text:0040B953		       cmp     ___locale_changed, 0
.text:0040B95A		       jnz     short loc_40B96E
.text:0040B95C		       mov     eax, [esp+c]
.text:0040B960		       mov     ecx, ___initiallocinfo.pctype
.text:0040B966		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B96A		       and     eax, 4
.text:0040B96D		       retn
.text:0040B96E ; ---------------------------------------------------------------------------
.text:0040B96E
.text:0040B96E loc_40B96E:			       ; CODE XREF: _isdigit+7j
.text:0040B96E		       push    0	       ; plocinfo
.text:0040B970		       push    [esp+4+c]       ; c
.text:0040B974		       call    __isdigit_l
.text:0040B979		       pop     ecx
.text:0040B97A		       pop     ecx
.text:0040B97B		       retn
.text:0040B97B _isdigit	       endp
.text:0040B97B
.text:0040B97C
.text:0040B97C ; =============== S U B R O U T I N E =======================================
.text:0040B97C
.text:0040B97C ; Attributes: bp-based frame
.text:0040B97C
.text:0040B97C ; int __cdecl _isxdigit_l(int c,	localeinfo_struct *plocinfo)
.text:0040B97C __isxdigit_l    proc near	       ; CODE XREF: _isxdigit+23p
.text:0040B97C
.text:0040B97C _loc_update     = _LocaleUpdate ptr -10h
.text:0040B97C c	       = dword ptr  8
.text:0040B97C plocinfo	       = dword ptr  0Ch
.text:0040B97C
.text:0040B97C		       push    ebp
.text:0040B97D		       mov     ebp, esp
.text:0040B97F		       sub     esp, 10h
.text:0040B982		       push    [ebp+plocinfo]  ; plocinfo
.text:0040B985		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040B988		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040B98D		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040B990		       cmp     dword ptr [eax+0ACh], 1
.text:0040B997		       jle     short loc_40B9AF
.text:0040B999		       lea     eax, [ebp+_loc_update]
.text:0040B99C		       push    eax	       ; plocinfo
.text:0040B99D		       push    80h	       ; mask
.text:0040B9A2		       push    [ebp+c]	       ; c
.text:0040B9A5		       call    __isctype_l
.text:0040B9AA		       add     esp, 0Ch
.text:0040B9AD		       jmp     short loc_40B9C1
.text:0040B9AF ; ---------------------------------------------------------------------------
.text:0040B9AF
.text:0040B9AF loc_40B9AF:			       ; CODE XREF: __isxdigit_l+1Bj
.text:0040B9AF		       mov     eax, [eax+0C8h]
.text:0040B9B5		       mov     ecx, [ebp+c]
.text:0040B9B8		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040B9BC		       and     eax, 80h
.text:0040B9C1
.text:0040B9C1 loc_40B9C1:			       ; CODE XREF: __isxdigit_l+31j
.text:0040B9C1		       cmp     [ebp+_loc_update.updated], 0
.text:0040B9C5		       jz      short locret_40B9CE
.text:0040B9C7		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040B9CA		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040B9CE
.text:0040B9CE locret_40B9CE:			       ; CODE XREF: __isxdigit_l+49j
.text:0040B9CE		       leave
.text:0040B9CF		       retn
.text:0040B9CF __isxdigit_l    endp
.text:0040B9CF
.text:0040B9D0
.text:0040B9D0 ; =============== S U B R O U T I N E =======================================
.text:0040B9D0
.text:0040B9D0
.text:0040B9D0 ; int __cdecl isxdigit(int c)
.text:0040B9D0 _isxdigit       proc near
.text:0040B9D0
.text:0040B9D0 c	       = dword ptr  4
.text:0040B9D0
.text:0040B9D0		       cmp     ___locale_changed, 0
.text:0040B9D7		       jnz     short loc_40B9ED
.text:0040B9D9		       mov     eax, [esp+c]
.text:0040B9DD		       mov     ecx, ___initiallocinfo.pctype
.text:0040B9E3		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040B9E7		       and     eax, 80h
.text:0040B9EC		       retn
.text:0040B9ED ; ---------------------------------------------------------------------------
.text:0040B9ED
.text:0040B9ED loc_40B9ED:			       ; CODE XREF: _isxdigit+7j
.text:0040B9ED		       push    0	       ; plocinfo
.text:0040B9EF		       push    [esp+4+c]       ; c
.text:0040B9F3		       call    __isxdigit_l
.text:0040B9F8		       pop     ecx
.text:0040B9F9		       pop     ecx
.text:0040B9FA		       retn
.text:0040B9FA _isxdigit       endp
.text:0040B9FA
.text:0040B9FB
.text:0040B9FB ; =============== S U B R O U T I N E =======================================
.text:0040B9FB
.text:0040B9FB ; Attributes: bp-based frame
.text:0040B9FB
.text:0040B9FB ; int __cdecl _isspace_l(int c, localeinfo_struct *plocinfo)
.text:0040B9FB __isspace_l     proc near	       ; CODE XREF: _isspace+21p
.text:0040B9FB
.text:0040B9FB _loc_update     = _LocaleUpdate ptr -10h
.text:0040B9FB c	       = dword ptr  8
.text:0040B9FB plocinfo	       = dword ptr  0Ch
.text:0040B9FB
.text:0040B9FB		       push    ebp
.text:0040B9FC		       mov     ebp, esp
.text:0040B9FE		       sub     esp, 10h
.text:0040BA01		       push    [ebp+plocinfo]  ; plocinfo
.text:0040BA04		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040BA07		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040BA0C		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040BA0F		       cmp     dword ptr [eax+0ACh], 1
.text:0040BA16		       jle     short loc_40BA2B
.text:0040BA18		       lea     eax, [ebp+_loc_update]
.text:0040BA1B		       push    eax	       ; plocinfo
.text:0040BA1C		       push    8	       ; mask
.text:0040BA1E		       push    [ebp+c]	       ; c
.text:0040BA21		       call    __isctype_l
.text:0040BA26		       add     esp, 0Ch
.text:0040BA29		       jmp     short loc_40BA3B
.text:0040BA2B ; ---------------------------------------------------------------------------
.text:0040BA2B
.text:0040BA2B loc_40BA2B:			       ; CODE XREF: __isspace_l+1Bj
.text:0040BA2B		       mov     eax, [eax+0C8h]
.text:0040BA31		       mov     ecx, [ebp+c]
.text:0040BA34		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040BA38		       and     eax, 8
.text:0040BA3B
.text:0040BA3B loc_40BA3B:			       ; CODE XREF: __isspace_l+2Ej
.text:0040BA3B		       cmp     [ebp+_loc_update.updated], 0
.text:0040BA3F		       jz      short locret_40BA48
.text:0040BA41		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040BA44		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040BA48
.text:0040BA48 locret_40BA48:			       ; CODE XREF: __isspace_l+44j
.text:0040BA48		       leave
.text:0040BA49		       retn
.text:0040BA49 __isspace_l     endp
.text:0040BA49
.text:0040BA4A
.text:0040BA4A ; =============== S U B R O U T I N E =======================================
.text:0040BA4A
.text:0040BA4A
.text:0040BA4A ; int __cdecl isspace(int c)
.text:0040BA4A _isspace	       proc near
.text:0040BA4A
.text:0040BA4A c	       = dword ptr  4
.text:0040BA4A
.text:0040BA4A		       cmp     ___locale_changed, 0
.text:0040BA51		       jnz     short loc_40BA65
.text:0040BA53		       mov     eax, [esp+c]
.text:0040BA57		       mov     ecx, ___initiallocinfo.pctype
.text:0040BA5D		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040BA61		       and     eax, 8
.text:0040BA64		       retn
.text:0040BA65 ; ---------------------------------------------------------------------------
.text:0040BA65
.text:0040BA65 loc_40BA65:			       ; CODE XREF: _isspace+7j
.text:0040BA65		       push    0	       ; plocinfo
.text:0040BA67		       push    [esp+4+c]       ; c
.text:0040BA6B		       call    __isspace_l
.text:0040BA70		       pop     ecx
.text:0040BA71		       pop     ecx
.text:0040BA72		       retn
.text:0040BA72 _isspace	       endp
.text:0040BA72
.text:0040BA73
.text:0040BA73 ; =============== S U B R O U T I N E =======================================
.text:0040BA73
.text:0040BA73 ; Attributes: bp-based frame
.text:0040BA73
.text:0040BA73 ; int __cdecl _ispunct_l(int c, localeinfo_struct *plocinfo)
.text:0040BA73 __ispunct_l     proc near	       ; CODE XREF: _ispunct+21p
.text:0040BA73
.text:0040BA73 _loc_update     = _LocaleUpdate ptr -10h
.text:0040BA73 c	       = dword ptr  8
.text:0040BA73 plocinfo	       = dword ptr  0Ch
.text:0040BA73
.text:0040BA73		       push    ebp
.text:0040BA74		       mov     ebp, esp
.text:0040BA76		       sub     esp, 10h
.text:0040BA79		       push    [ebp+plocinfo]  ; plocinfo
.text:0040BA7C		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040BA7F		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040BA84		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040BA87		       cmp     dword ptr [eax+0ACh], 1
.text:0040BA8E		       jle     short loc_40BAA3
.text:0040BA90		       lea     eax, [ebp+_loc_update]
.text:0040BA93		       push    eax	       ; plocinfo
.text:0040BA94		       push    10h	       ; mask
.text:0040BA96		       push    [ebp+c]	       ; c
.text:0040BA99		       call    __isctype_l
.text:0040BA9E		       add     esp, 0Ch
.text:0040BAA1		       jmp     short loc_40BAB3
.text:0040BAA3 ; ---------------------------------------------------------------------------
.text:0040BAA3
.text:0040BAA3 loc_40BAA3:			       ; CODE XREF: __ispunct_l+1Bj
.text:0040BAA3		       mov     eax, [eax+0C8h]
.text:0040BAA9		       mov     ecx, [ebp+c]
.text:0040BAAC		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040BAB0		       and     eax, 10h
.text:0040BAB3
.text:0040BAB3 loc_40BAB3:			       ; CODE XREF: __ispunct_l+2Ej
.text:0040BAB3		       cmp     [ebp+_loc_update.updated], 0
.text:0040BAB7		       jz      short locret_40BAC0
.text:0040BAB9		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040BABC		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040BAC0
.text:0040BAC0 locret_40BAC0:			       ; CODE XREF: __ispunct_l+44j
.text:0040BAC0		       leave
.text:0040BAC1		       retn
.text:0040BAC1 __ispunct_l     endp
.text:0040BAC1
.text:0040BAC2
.text:0040BAC2 ; =============== S U B R O U T I N E =======================================
.text:0040BAC2
.text:0040BAC2
.text:0040BAC2 ; int __cdecl ispunct(int c)
.text:0040BAC2 _ispunct	       proc near
.text:0040BAC2
.text:0040BAC2 c	       = dword ptr  4
.text:0040BAC2
.text:0040BAC2		       cmp     ___locale_changed, 0
.text:0040BAC9		       jnz     short loc_40BADD
.text:0040BACB		       mov     eax, [esp+c]
.text:0040BACF		       mov     ecx, ___initiallocinfo.pctype
.text:0040BAD5		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040BAD9		       and     eax, 10h
.text:0040BADC		       retn
.text:0040BADD ; ---------------------------------------------------------------------------
.text:0040BADD
.text:0040BADD loc_40BADD:			       ; CODE XREF: _ispunct+7j
.text:0040BADD		       push    0	       ; plocinfo
.text:0040BADF		       push    [esp+4+c]       ; c
.text:0040BAE3		       call    __ispunct_l
.text:0040BAE8		       pop     ecx
.text:0040BAE9		       pop     ecx
.text:0040BAEA		       retn
.text:0040BAEA _ispunct	       endp
.text:0040BAEA
.text:0040BAEB
.text:0040BAEB ; =============== S U B R O U T I N E =======================================
.text:0040BAEB
.text:0040BAEB ; Attributes: bp-based frame
.text:0040BAEB
.text:0040BAEB ; int __cdecl _isalnum_l(int c, localeinfo_struct *plocinfo)
.text:0040BAEB __isalnum_l     proc near	       ; CODE XREF: _isalnum+23p
.text:0040BAEB					       ; __iscsym_l+8p
.text:0040BAEB
.text:0040BAEB _loc_update     = _LocaleUpdate ptr -10h
.text:0040BAEB c	       = dword ptr  8
.text:0040BAEB plocinfo	       = dword ptr  0Ch
.text:0040BAEB
.text:0040BAEB		       push    ebp
.text:0040BAEC		       mov     ebp, esp
.text:0040BAEE		       sub     esp, 10h
.text:0040BAF1		       push    [ebp+plocinfo]  ; plocinfo
.text:0040BAF4		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040BAF7		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040BAFC		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040BAFF		       cmp     dword ptr [eax+0ACh], 1
.text:0040BB06		       jle     short loc_40BB1E
.text:0040BB08		       lea     eax, [ebp+_loc_update]
.text:0040BB0B		       push    eax	       ; plocinfo
.text:0040BB0C		       push    107h	       ; mask
.text:0040BB11		       push    [ebp+c]	       ; c
.text:0040BB14		       call    __isctype_l
.text:0040BB19		       add     esp, 0Ch
.text:0040BB1C		       jmp     short loc_40BB30
.text:0040BB1E ; ---------------------------------------------------------------------------
.text:0040BB1E
.text:0040BB1E loc_40BB1E:			       ; CODE XREF: __isalnum_l+1Bj
.text:0040BB1E		       mov     eax, [eax+0C8h]
.text:0040BB24		       mov     ecx, [ebp+c]
.text:0040BB27		       movzx   eax, word ptr [eax+ecx*2]
.text:0040BB2B		       and     eax, 107h
.text:0040BB30
.text:0040BB30 loc_40BB30:			       ; CODE XREF: __isalnum_l+31j
.text:0040BB30		       cmp     [ebp+_loc_update.updated], 0
.text:0040BB34		       jz      short locret_40BB3D
.text:0040BB36		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040BB39		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040BB3D
.text:0040BB3D locret_40BB3D:			       ; CODE XREF: __isalnum_l+49j
.text:0040BB3D		       leave
.text:0040BB3E		       retn
.text:0040BB3E __isalnum_l     endp
.text:0040BB3E
.text:0040BB3F
.text:0040BB3F ; =============== S U B R O U T I N E =======================================
.text:0040BB3F
.text:0040BB3F
.text:0040BB3F ; int __cdecl isalnum(int c)
.text:0040BB3F _isalnum	       proc near	       ; CODE XREF: ___iscsym+6p
.text:0040BB3F
.text:0040BB3F c	       = dword ptr  4
.text:0040BB3F
.text:0040BB3F		       cmp     ___locale_changed, 0
.text:0040BB46		       jnz     short loc_40BB5C
.text:0040BB48		       mov     eax, [esp+c]
.text:0040BB4C		       mov     ecx, ___initiallocinfo.pctype
.text:0040BB52		       movzx   eax, word ptr [ecx+eax*2]
.text:0040BB56		       and     eax, 107h
.text:0040BB5B		       retn
.text:0040BB5C ; ---------------------------------------------------------------------------
.text:0040BB5C
.text:0040BB5C loc_40BB5C:			       ; CODE XREF: _isalnum+7j
.text:0040BB5C		       push    0	       ; plocinfo
.text:0040BB5E		       push    [esp+4+c]       ; c
.text:0040BB62		       call    __isalnum_l
.text:0040BB67		       pop     ecx
.text:0040BB68		       pop     ecx
.text:0040BB69		       retn
.text:0040BB69 _isalnum	       endp
.text:0040BB69
.text:0040BB6A
.text:0040BB6A ; =============== S U B R O U T I N E =======================================
.text:0040BB6A
.text:0040BB6A ; Attributes: bp-based frame
.text:0040BB6A
.text:0040BB6A ; int __cdecl _isprint_l(int c, localeinfo_struct *plocinfo)
.text:0040BB6A __isprint_l     proc near	       ; CODE XREF: _isprint+23p
.text:0040BB6A
.text:0040BB6A _loc_update     = _LocaleUpdate ptr -10h
.text:0040BB6A c	       = dword ptr  8
.text:0040BB6A plocinfo	       = dword ptr  0Ch
.text:0040BB6A
.text:0040BB6A		       push    ebp
.text:0040BB6B		       mov     ebp, esp
.text:0040BB6D		       sub     esp, 10h
.text:0040BB70		       push    [ebp+plocinfo]  ; plocinfo
.text:0040BB73		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040BB76		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040BB7B		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040BB7E		       cmp     dword ptr [eax+0ACh], 1
.text:0040BB85		       jle     short loc_40BB9D
.text:0040BB87		       lea     eax, [ebp+_loc_update]
.text:0040BB8A		       push    eax	       ; plocinfo
.text:0040BB8B		       push    157h	       ; mask
.text:0040BB90		       push    [ebp+c]	       ; c
.text:0040BB93		       call    __isctype_l
.text:0040BB98		       add     esp, 0Ch
.text:0040BB9B		       jmp     short loc_40BBAF
.text:0040BB9D ; ---------------------------------------------------------------------------
.text:0040BB9D
.text:0040BB9D loc_40BB9D:			       ; CODE XREF: __isprint_l+1Bj
.text:0040BB9D		       mov     eax, [eax+0C8h]
.text:0040BBA3		       mov     ecx, [ebp+c]
.text:0040BBA6		       movzx   eax, word ptr [eax+ecx*2]
.text:0040BBAA		       and     eax, 157h
.text:0040BBAF
.text:0040BBAF loc_40BBAF:			       ; CODE XREF: __isprint_l+31j
.text:0040BBAF		       cmp     [ebp+_loc_update.updated], 0
.text:0040BBB3		       jz      short locret_40BBBC
.text:0040BBB5		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040BBB8		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040BBBC
.text:0040BBBC locret_40BBBC:			       ; CODE XREF: __isprint_l+49j
.text:0040BBBC		       leave
.text:0040BBBD		       retn
.text:0040BBBD __isprint_l     endp
.text:0040BBBD
.text:0040BBBE
.text:0040BBBE ; =============== S U B R O U T I N E =======================================
.text:0040BBBE
.text:0040BBBE
.text:0040BBBE ; int __cdecl isprint(int c)
.text:0040BBBE _isprint	       proc near
.text:0040BBBE
.text:0040BBBE c	       = dword ptr  4
.text:0040BBBE
.text:0040BBBE		       cmp     ___locale_changed, 0
.text:0040BBC5		       jnz     short loc_40BBDB
.text:0040BBC7		       mov     eax, [esp+c]
.text:0040BBCB		       mov     ecx, ___initiallocinfo.pctype
.text:0040BBD1		       movzx   eax, word ptr [ecx+eax*2]
.text:0040BBD5		       and     eax, 157h
.text:0040BBDA		       retn
.text:0040BBDB ; ---------------------------------------------------------------------------
.text:0040BBDB
.text:0040BBDB loc_40BBDB:			       ; CODE XREF: _isprint+7j
.text:0040BBDB		       push    0	       ; plocinfo
.text:0040BBDD		       push    [esp+4+c]       ; c
.text:0040BBE1		       call    __isprint_l
.text:0040BBE6		       pop     ecx
.text:0040BBE7		       pop     ecx
.text:0040BBE8		       retn
.text:0040BBE8 _isprint	       endp
.text:0040BBE8
.text:0040BBE9
.text:0040BBE9 ; =============== S U B R O U T I N E =======================================
.text:0040BBE9
.text:0040BBE9 ; Attributes: bp-based frame
.text:0040BBE9
.text:0040BBE9 ; int __cdecl _isgraph_l(int c, localeinfo_struct *plocinfo)
.text:0040BBE9 __isgraph_l     proc near	       ; CODE XREF: _isgraph+23p
.text:0040BBE9
.text:0040BBE9 _loc_update     = _LocaleUpdate ptr -10h
.text:0040BBE9 c	       = dword ptr  8
.text:0040BBE9 plocinfo	       = dword ptr  0Ch
.text:0040BBE9
.text:0040BBE9		       push    ebp
.text:0040BBEA		       mov     ebp, esp
.text:0040BBEC		       sub     esp, 10h
.text:0040BBEF		       push    [ebp+plocinfo]  ; plocinfo
.text:0040BBF2		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040BBF5		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040BBFA		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040BBFD		       cmp     dword ptr [eax+0ACh], 1
.text:0040BC04		       jle     short loc_40BC1C
.text:0040BC06		       lea     eax, [ebp+_loc_update]
.text:0040BC09		       push    eax	       ; plocinfo
.text:0040BC0A		       push    117h	       ; mask
.text:0040BC0F		       push    [ebp+c]	       ; c
.text:0040BC12		       call    __isctype_l
.text:0040BC17		       add     esp, 0Ch
.text:0040BC1A		       jmp     short loc_40BC2E
.text:0040BC1C ; ---------------------------------------------------------------------------
.text:0040BC1C
.text:0040BC1C loc_40BC1C:			       ; CODE XREF: __isgraph_l+1Bj
.text:0040BC1C		       mov     eax, [eax+0C8h]
.text:0040BC22		       mov     ecx, [ebp+c]
.text:0040BC25		       movzx   eax, word ptr [eax+ecx*2]
.text:0040BC29		       and     eax, 117h
.text:0040BC2E
.text:0040BC2E loc_40BC2E:			       ; CODE XREF: __isgraph_l+31j
.text:0040BC2E		       cmp     [ebp+_loc_update.updated], 0
.text:0040BC32		       jz      short locret_40BC3B
.text:0040BC34		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040BC37		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040BC3B
.text:0040BC3B locret_40BC3B:			       ; CODE XREF: __isgraph_l+49j
.text:0040BC3B		       leave
.text:0040BC3C		       retn
.text:0040BC3C __isgraph_l     endp
.text:0040BC3C
.text:0040BC3D
.text:0040BC3D ; =============== S U B R O U T I N E =======================================
.text:0040BC3D
.text:0040BC3D
.text:0040BC3D ; int __cdecl isgraph(int c)
.text:0040BC3D _isgraph	       proc near
.text:0040BC3D
.text:0040BC3D c	       = dword ptr  4
.text:0040BC3D
.text:0040BC3D		       cmp     ___locale_changed, 0
.text:0040BC44		       jnz     short loc_40BC5A
.text:0040BC46		       mov     eax, [esp+c]
.text:0040BC4A		       mov     ecx, ___initiallocinfo.pctype
.text:0040BC50		       movzx   eax, word ptr [ecx+eax*2]
.text:0040BC54		       and     eax, 117h
.text:0040BC59		       retn
.text:0040BC5A ; ---------------------------------------------------------------------------
.text:0040BC5A
.text:0040BC5A loc_40BC5A:			       ; CODE XREF: _isgraph+7j
.text:0040BC5A		       push    0	       ; plocinfo
.text:0040BC5C		       push    [esp+4+c]       ; c
.text:0040BC60		       call    __isgraph_l
.text:0040BC65		       pop     ecx
.text:0040BC66		       pop     ecx
.text:0040BC67		       retn
.text:0040BC67 _isgraph	       endp
.text:0040BC67
.text:0040BC68
.text:0040BC68 ; =============== S U B R O U T I N E =======================================
.text:0040BC68
.text:0040BC68 ; Attributes: bp-based frame
.text:0040BC68
.text:0040BC68 ; int __cdecl _iscntrl_l(int c, localeinfo_struct *plocinfo)
.text:0040BC68 __iscntrl_l     proc near	       ; CODE XREF: _iscntrl+21p
.text:0040BC68
.text:0040BC68 _loc_update     = _LocaleUpdate ptr -10h
.text:0040BC68 c	       = dword ptr  8
.text:0040BC68 plocinfo	       = dword ptr  0Ch
.text:0040BC68
.text:0040BC68		       push    ebp
.text:0040BC69		       mov     ebp, esp
.text:0040BC6B		       sub     esp, 10h
.text:0040BC6E		       push    [ebp+plocinfo]  ; plocinfo
.text:0040BC71		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040BC74		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040BC79		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040BC7C		       cmp     dword ptr [eax+0ACh], 1
.text:0040BC83		       jle     short loc_40BC98
.text:0040BC85		       lea     eax, [ebp+_loc_update]
.text:0040BC88		       push    eax	       ; plocinfo
.text:0040BC89		       push    20h	       ; mask
.text:0040BC8B		       push    [ebp+c]	       ; c
.text:0040BC8E		       call    __isctype_l
.text:0040BC93		       add     esp, 0Ch
.text:0040BC96		       jmp     short loc_40BCA8
.text:0040BC98 ; ---------------------------------------------------------------------------
.text:0040BC98
.text:0040BC98 loc_40BC98:			       ; CODE XREF: __iscntrl_l+1Bj
.text:0040BC98		       mov     eax, [eax+0C8h]
.text:0040BC9E		       mov     ecx, [ebp+c]
.text:0040BCA1		       movzx   eax, byte ptr [eax+ecx*2]
.text:0040BCA5		       and     eax, 20h
.text:0040BCA8
.text:0040BCA8 loc_40BCA8:			       ; CODE XREF: __iscntrl_l+2Ej
.text:0040BCA8		       cmp     [ebp+_loc_update.updated], 0
.text:0040BCAC		       jz      short locret_40BCB5
.text:0040BCAE		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040BCB1		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040BCB5
.text:0040BCB5 locret_40BCB5:			       ; CODE XREF: __iscntrl_l+44j
.text:0040BCB5		       leave
.text:0040BCB6		       retn
.text:0040BCB6 __iscntrl_l     endp
.text:0040BCB6
.text:0040BCB7
.text:0040BCB7 ; =============== S U B R O U T I N E =======================================
.text:0040BCB7
.text:0040BCB7
.text:0040BCB7 ; int __cdecl iscntrl(int c)
.text:0040BCB7 _iscntrl	       proc near
.text:0040BCB7
.text:0040BCB7 c	       = dword ptr  4
.text:0040BCB7
.text:0040BCB7		       cmp     ___locale_changed, 0
.text:0040BCBE		       jnz     short loc_40BCD2
.text:0040BCC0		       mov     eax, [esp+c]
.text:0040BCC4		       mov     ecx, ___initiallocinfo.pctype
.text:0040BCCA		       movzx   eax, byte ptr [ecx+eax*2]
.text:0040BCCE		       and     eax, 20h
.text:0040BCD1		       retn
.text:0040BCD2 ; ---------------------------------------------------------------------------
.text:0040BCD2
.text:0040BCD2 loc_40BCD2:			       ; CODE XREF: _iscntrl+7j
.text:0040BCD2		       push    0	       ; plocinfo
.text:0040BCD4		       push    [esp+4+c]       ; c
.text:0040BCD8		       call    __iscntrl_l
.text:0040BCDD		       pop     ecx
.text:0040BCDE		       pop     ecx
.text:0040BCDF		       retn
.text:0040BCDF _iscntrl	       endp
.text:0040BCDF
.text:0040BCE0
.text:0040BCE0 ; =============== S U B R O U T I N E =======================================
.text:0040BCE0
.text:0040BCE0
.text:0040BCE0 ; int __cdecl __isascii(int c)
.text:0040BCE0 ___isascii      proc near
.text:0040BCE0
.text:0040BCE0 c	       = dword ptr  4
.text:0040BCE0
.text:0040BCE0		       cmp     [esp+c],	80h
.text:0040BCE8		       sbb     eax, eax
.text:0040BCEA		       neg     eax
.text:0040BCEC		       retn
.text:0040BCEC ___isascii      endp
.text:0040BCEC
.text:0040BCED
.text:0040BCED ; =============== S U B R O U T I N E =======================================
.text:0040BCED
.text:0040BCED
.text:0040BCED ; int __cdecl __toascii(int c)
.text:0040BCED ___toascii      proc near
.text:0040BCED
.text:0040BCED c	       = dword ptr  4
.text:0040BCED
.text:0040BCED		       mov     eax, [esp+c]
.text:0040BCF1		       and     eax, 7Fh
.text:0040BCF4		       retn
.text:0040BCF4 ___toascii      endp
.text:0040BCF4
.text:0040BCF5
.text:0040BCF5 ; =============== S U B R O U T I N E =======================================
.text:0040BCF5
.text:0040BCF5
.text:0040BCF5 ; int __cdecl _iscsymf_l(int c, localeinfo_struct *plocinfo)
.text:0040BCF5 __iscsymf_l     proc near
.text:0040BCF5
.text:0040BCF5 c	       = dword ptr  4
.text:0040BCF5 plocinfo	       = dword ptr  8
.text:0040BCF5
.text:0040BCF5		       push    [esp+plocinfo]  ; plocinfo
.text:0040BCF9		       push    [esp+4+c]       ; c
.text:0040BCFD		       call    __isalpha_l
.text:0040BD02		       test    eax, eax
.text:0040BD04		       pop     ecx
.text:0040BD05		       pop     ecx
.text:0040BD06		       jnz     short loc_40BD10
.text:0040BD08		       cmp     [esp+c],	5Fh
.text:0040BD0D		       jz      short loc_40BD10
.text:0040BD0F		       retn
.text:0040BD10 ; ---------------------------------------------------------------------------
.text:0040BD10
.text:0040BD10 loc_40BD10:			       ; CODE XREF: __iscsymf_l+11j
.text:0040BD10					       ; __iscsymf_l+18j
.text:0040BD10		       xor     eax, eax
.text:0040BD12		       inc     eax
.text:0040BD13		       retn
.text:0040BD13 __iscsymf_l     endp
.text:0040BD13
.text:0040BD14
.text:0040BD14 ; =============== S U B R O U T I N E =======================================
.text:0040BD14
.text:0040BD14
.text:0040BD14 ; int __cdecl __iscsymf(int c)
.text:0040BD14 ___iscsymf      proc near
.text:0040BD14
.text:0040BD14 c	       = dword ptr  4
.text:0040BD14
.text:0040BD14		       push    [esp+c]	       ; c
.text:0040BD18		       call    _isalpha
.text:0040BD1D		       test    eax, eax
.text:0040BD1F		       pop     ecx
.text:0040BD20		       jnz     short loc_40BD2A
.text:0040BD22		       cmp     [esp+c],	5Fh
.text:0040BD27		       jz      short loc_40BD2A
.text:0040BD29		       retn
.text:0040BD2A ; ---------------------------------------------------------------------------
.text:0040BD2A
.text:0040BD2A loc_40BD2A:			       ; CODE XREF: ___iscsymf+Cj
.text:0040BD2A					       ; ___iscsymf+13j
.text:0040BD2A		       xor     eax, eax
.text:0040BD2C		       inc     eax
.text:0040BD2D		       retn
.text:0040BD2D ___iscsymf      endp
.text:0040BD2D
.text:0040BD2E
.text:0040BD2E ; =============== S U B R O U T I N E =======================================
.text:0040BD2E
.text:0040BD2E
.text:0040BD2E ; int __cdecl _iscsym_l(int c, localeinfo_struct	*plocinfo)
.text:0040BD2E __iscsym_l      proc near
.text:0040BD2E
.text:0040BD2E c	       = dword ptr  4
.text:0040BD2E plocinfo	       = dword ptr  8
.text:0040BD2E
.text:0040BD2E		       push    [esp+plocinfo]  ; plocinfo
.text:0040BD32		       push    [esp+4+c]       ; c
.text:0040BD36		       call    __isalnum_l
.text:0040BD3B		       test    eax, eax
.text:0040BD3D		       pop     ecx
.text:0040BD3E		       pop     ecx
.text:0040BD3F		       jnz     short loc_40BD49
.text:0040BD41		       cmp     [esp+c],	5Fh
.text:0040BD46		       jz      short loc_40BD49
.text:0040BD48		       retn
.text:0040BD49 ; ---------------------------------------------------------------------------
.text:0040BD49
.text:0040BD49 loc_40BD49:			       ; CODE XREF: __iscsym_l+11j
.text:0040BD49					       ; __iscsym_l+18j
.text:0040BD49		       xor     eax, eax
.text:0040BD4B		       inc     eax
.text:0040BD4C		       retn
.text:0040BD4C __iscsym_l      endp
.text:0040BD4C
.text:0040BD4D
.text:0040BD4D ; =============== S U B R O U T I N E =======================================
.text:0040BD4D
.text:0040BD4D
.text:0040BD4D ; int __cdecl __iscsym(int c)
.text:0040BD4D ___iscsym       proc near
.text:0040BD4D
.text:0040BD4D c	       = dword ptr  4
.text:0040BD4D
.text:0040BD4D		       movzx   eax, byte ptr [esp+c]
.text:0040BD52		       push    eax	       ; c
.text:0040BD53		       call    _isalnum
.text:0040BD58		       test    eax, eax
.text:0040BD5A		       pop     ecx
.text:0040BD5B		       jnz     short loc_40BD65
.text:0040BD5D		       cmp     byte ptr	[esp+c], 5Fh
.text:0040BD62		       jz      short loc_40BD65
.text:0040BD64		       retn
.text:0040BD65 ; ---------------------------------------------------------------------------
.text:0040BD65
.text:0040BD65 loc_40BD65:			       ; CODE XREF: ___iscsym+Ej
.text:0040BD65					       ; ___iscsym+15j
.text:0040BD65		       xor     eax, eax
.text:0040BD67		       inc     eax
.text:0040BD68		       retn
.text:0040BD68 ___iscsym       endp
.text:0040BD68
.text:0040BD69
.text:0040BD69 ; =============== S U B R O U T I N E =======================================
.text:0040BD69
.text:0040BD69
.text:0040BD69 ; void *__cdecl _MarkAllocaS(void *_Ptr,	unsigned int _Marker)
.text:0040BD69 __MarkAllocaS   proc near
.text:0040BD69
.text:0040BD69 _Ptr	       = dword ptr  4
.text:0040BD69 _Marker	       = dword ptr  8
.text:0040BD69
.text:0040BD69		       mov     eax, [esp+_Ptr]
.text:0040BD6D		       test    eax, eax
.text:0040BD6F		       jz      short locret_40BD7A
.text:0040BD71		       mov     ecx, [esp+_Marker]
.text:0040BD75		       mov     [eax], ecx
.text:0040BD77		       add     eax, 8
.text:0040BD7A
.text:0040BD7A locret_40BD7A:			       ; CODE XREF: __MarkAllocaS+6j
.text:0040BD7A		       retn
.text:0040BD7A __MarkAllocaS   endp
.text:0040BD7A
.text:0040BD7B
.text:0040BD7B ; =============== S U B R O U T I N E =======================================
.text:0040BD7B
.text:0040BD7B
.text:0040BD7B ; void __cdecl _freea(void *_Memory)
.text:0040BD7B __freea	       proc near	       ; CODE XREF: __crtGetLocaleInfoW_stat+120p
.text:0040BD7B					       ; __crtGetLocaleInfoA_stat+10Fp	...
.text:0040BD7B
.text:0040BD7B _Memory	       = dword ptr  4
.text:0040BD7B
.text:0040BD7B		       mov     eax, [esp+_Memory]
.text:0040BD7F		       test    eax, eax
.text:0040BD81		       jz      short locret_40BD95
.text:0040BD83		       sub     eax, 8
.text:0040BD86		       cmp     dword ptr [eax],	0DDDDh
.text:0040BD8C		       jnz     short locret_40BD95
.text:0040BD8E		       push    eax	       ; pBlock
.text:0040BD8F		       call    _free
.text:0040BD94		       pop     ecx
.text:0040BD95
.text:0040BD95 locret_40BD95:			       ; CODE XREF: __freea+6j
.text:0040BD95					       ; __freea+11j
.text:0040BD95		       retn
.text:0040BD95 __freea	       endp
.text:0040BD95
.text:0040BD96
.text:0040BD96 ; =============== S U B R O U T I N E =======================================
.text:0040BD96
.text:0040BD96 ; Attributes: bp-based frame
.text:0040BD96
.text:0040BD96 ; int __cdecl _crtGetLocaleInfoW_stat(localeinfo_struct *plocinfo, unsigned int Locale, unsigned	int LCType, wchar_t *lpLCData, int cchData, int	code_page)
.text:0040BD96 __crtGetLocaleInfoW_stat	proc near      ; CODE XREF: ___crtGetLocaleInfoW+24p
.text:0040BD96
.text:0040BD96 retval	       = dword ptr -8
.text:0040BD96 var_4	       = dword ptr -4
.text:0040BD96 plocinfo	       = dword ptr  8
.text:0040BD96 Locale	       = dword ptr  0Ch
.text:0040BD96 LCType	       = dword ptr  10h
.text:0040BD96 lpLCData	       = dword ptr  14h
.text:0040BD96 cchData	       = dword ptr  18h
.text:0040BD96 code_page       = dword ptr  1Ch
.text:0040BD96
.text:0040BD96		       push    ebp
.text:0040BD97		       mov     ebp, esp
.text:0040BD99		       push    ecx
.text:0040BD9A		       push    ecx
.text:0040BD9B		       mov     eax, ___security_cookie
.text:0040BDA0		       xor     eax, ebp
.text:0040BDA2		       mov     [ebp+var_4], eax
.text:0040BDA5		       mov     eax, f_use_0
.text:0040BDAA		       push    ebx
.text:0040BDAB		       push    esi
.text:0040BDAC		       mov     esi, ds:__imp__GetLocaleInfoW@16	; GetLocaleInfoW(x,x,x,x)
.text:0040BDB2		       push    edi
.text:0040BDB3		       xor     edi, edi
.text:0040BDB5		       cmp     eax, edi
.text:0040BDB7		       jnz     short loc_40BDE8
.text:0040BDB9		       push    edi	       ; cchData
.text:0040BDBA		       push    edi	       ; lpLCData
.text:0040BDBB		       xor     ebx, ebx
.text:0040BDBD		       inc     ebx
.text:0040BDBE		       push    ebx	       ; LCType
.text:0040BDBF		       push    edi	       ; Locale
.text:0040BDC0		       call    esi ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040BDC2		       test    eax, eax
.text:0040BDC4		       jz      short loc_40BDCE
.text:0040BDC6		       mov     f_use_0,	ebx
.text:0040BDCC		       jmp     short loc_40BDED
.text:0040BDCE ; ---------------------------------------------------------------------------
.text:0040BDCE
.text:0040BDCE loc_40BDCE:			       ; CODE XREF: __crtGetLocaleInfoW_stat+2Ej
.text:0040BDCE		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040BDD4		       cmp     eax, 78h
.text:0040BDD7		       jnz     short loc_40BDE3
.text:0040BDD9		       push    2
.text:0040BDDB		       pop     eax
.text:0040BDDC		       mov     f_use_0,	eax
.text:0040BDE1		       jmp     short loc_40BDE8
.text:0040BDE3 ; ---------------------------------------------------------------------------
.text:0040BDE3
.text:0040BDE3 loc_40BDE3:			       ; CODE XREF: __crtGetLocaleInfoW_stat+41j
.text:0040BDE3		       mov     eax, f_use_0
.text:0040BDE8
.text:0040BDE8 loc_40BDE8:			       ; CODE XREF: __crtGetLocaleInfoW_stat+21j
.text:0040BDE8					       ; __crtGetLocaleInfoW_stat+4Bj
.text:0040BDE8		       cmp     eax, 1
.text:0040BDEB		       jnz     short loc_40BE00
.text:0040BDED
.text:0040BDED loc_40BDED:			       ; CODE XREF: __crtGetLocaleInfoW_stat+36j
.text:0040BDED		       push    [ebp+cchData]   ; cchData
.text:0040BDF0		       push    [ebp+lpLCData]  ; lpLCData
.text:0040BDF3		       push    [ebp+LCType]    ; LCType
.text:0040BDF6		       push    [ebp+Locale]    ; Locale
.text:0040BDF9		       call    esi ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040BDFB		       jmp     loc_40BEBF
.text:0040BE00 ; ---------------------------------------------------------------------------
.text:0040BE00
.text:0040BE00 loc_40BE00:			       ; CODE XREF: __crtGetLocaleInfoW_stat+55j
.text:0040BE00		       cmp     eax, 2
.text:0040BE03		       jz      short loc_40BE09
.text:0040BE05		       cmp     eax, edi
.text:0040BE07		       jnz     short loc_40BE32
.text:0040BE09
.text:0040BE09 loc_40BE09:			       ; CODE XREF: __crtGetLocaleInfoW_stat+6Dj
.text:0040BE09		       cmp     [ebp+code_page],	edi
.text:0040BE0C		       mov     [ebp+retval], edi
.text:0040BE0F		       jnz     short loc_40BE1C
.text:0040BE11		       mov     eax, [ebp+plocinfo]
.text:0040BE14		       mov     eax, [eax]
.text:0040BE16		       mov     eax, [eax+4]
.text:0040BE19		       mov     [ebp+code_page],	eax
.text:0040BE1C
.text:0040BE1C loc_40BE1C:			       ; CODE XREF: __crtGetLocaleInfoW_stat+79j
.text:0040BE1C		       push    edi	       ; cchData
.text:0040BE1D		       push    edi	       ; lpLCData
.text:0040BE1E		       push    [ebp+LCType]    ; LCType
.text:0040BE21		       mov     edi, ds:__imp__GetLocaleInfoA@16	; GetLocaleInfoA(x,x,x,x)
.text:0040BE27		       push    [ebp+Locale]    ; Locale
.text:0040BE2A		       call    edi ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040BE2C		       mov     ebx, eax
.text:0040BE2E		       test    ebx, ebx
.text:0040BE30		       jnz     short loc_40BE39
.text:0040BE32
.text:0040BE32 loc_40BE32:			       ; CODE XREF: __crtGetLocaleInfoW_stat+71j
.text:0040BE32					       ; __crtGetLocaleInfoW_stat+C4j ...
.text:0040BE32		       xor     eax, eax
.text:0040BE34		       jmp     loc_40BEBF
.text:0040BE39 ; ---------------------------------------------------------------------------
.text:0040BE39
.text:0040BE39 loc_40BE39:			       ; CODE XREF: __crtGetLocaleInfoW_stat+9Aj
.text:0040BE39		       jle     short loc_40BE7F
.text:0040BE3B		       push    0FFFFFFE0h
.text:0040BE3D		       xor     edx, edx
.text:0040BE3F		       pop     eax
.text:0040BE40		       div     ebx
.text:0040BE42		       cmp     eax, 1
.text:0040BE45		       jb      short loc_40BE7F
.text:0040BE47		       lea     eax, [ebx+8]
.text:0040BE4A		       cmp     eax, 400h
.text:0040BE4F		       ja      short loc_40BE67
.text:0040BE51		       call    __alloca_probe_16
.text:0040BE56		       mov     esi, esp
.text:0040BE58		       test    esi, esi
.text:0040BE5A		       jz      short loc_40BE32
.text:0040BE5C		       mov     dword ptr [esi],	0CCCCh
.text:0040BE62		       add     esi, 8
.text:0040BE65		       jmp     short loc_40BE81
.text:0040BE67 ; ---------------------------------------------------------------------------
.text:0040BE67
.text:0040BE67 loc_40BE67:			       ; CODE XREF: __crtGetLocaleInfoW_stat+B9j
.text:0040BE67		       push    eax	       ; size
.text:0040BE68		       call    _malloc
.text:0040BE6D		       test    eax, eax
.text:0040BE6F		       pop     ecx
.text:0040BE70		       jz      short loc_40BE7B
.text:0040BE72		       mov     dword ptr [eax],	0DDDDh
.text:0040BE78		       add     eax, 8
.text:0040BE7B
.text:0040BE7B loc_40BE7B:			       ; CODE XREF: __crtGetLocaleInfoW_stat+DAj
.text:0040BE7B		       mov     esi, eax
.text:0040BE7D		       jmp     short loc_40BE81
.text:0040BE7F ; ---------------------------------------------------------------------------
.text:0040BE7F
.text:0040BE7F loc_40BE7F:			       ; CODE XREF: __crtGetLocaleInfoW_stat:loc_40BE39j
.text:0040BE7F					       ; __crtGetLocaleInfoW_stat+AFj
.text:0040BE7F		       xor     esi, esi
.text:0040BE81
.text:0040BE81 loc_40BE81:			       ; CODE XREF: __crtGetLocaleInfoW_stat+CFj
.text:0040BE81					       ; __crtGetLocaleInfoW_stat+E7j
.text:0040BE81		       test    esi, esi
.text:0040BE83		       jz      short loc_40BE32
.text:0040BE85		       push    ebx	       ; cchData
.text:0040BE86		       push    esi	       ; lpLCData
.text:0040BE87		       push    [ebp+LCType]    ; LCType
.text:0040BE8A		       push    [ebp+Locale]    ; Locale
.text:0040BE8D		       call    edi ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040BE8F		       test    eax, eax
.text:0040BE91		       jz      short error_cleanup
.text:0040BE93		       xor     eax, eax
.text:0040BE95		       cmp     [ebp+cchData], eax
.text:0040BE98		       jnz     short loc_40BE9E
.text:0040BE9A		       push    eax
.text:0040BE9B		       push    eax
.text:0040BE9C		       jmp     short loc_40BEA4
.text:0040BE9E ; ---------------------------------------------------------------------------
.text:0040BE9E
.text:0040BE9E loc_40BE9E:			       ; CODE XREF: __crtGetLocaleInfoW_stat+102j
.text:0040BE9E		       push    [ebp+cchData]   ; cchWideChar
.text:0040BEA1		       push    [ebp+lpLCData]  ; lpWideCharStr
.text:0040BEA4
.text:0040BEA4 loc_40BEA4:			       ; CODE XREF: __crtGetLocaleInfoW_stat+106j
.text:0040BEA4		       push    0FFFFFFFFh      ; cbMultiByte
.text:0040BEA6		       push    esi	       ; lpMultiByteStr
.text:0040BEA7		       push    1	       ; dwFlags
.text:0040BEA9		       push    [ebp+code_page] ; CodePage
.text:0040BEAC		       call    ds:__imp__MultiByteToWideChar@24	; MultiByteToWideChar(x,x,x,x,x,x)
.text:0040BEB2		       mov     [ebp+retval], eax
.text:0040BEB5
.text:0040BEB5 error_cleanup:			       ; CODE XREF: __crtGetLocaleInfoW_stat+FBj
.text:0040BEB5		       push    esi	       ; _Memory
.text:0040BEB6		       call    __freea
.text:0040BEBB		       mov     eax, [ebp+retval]
.text:0040BEBE		       pop     ecx
.text:0040BEBF
.text:0040BEBF loc_40BEBF:			       ; CODE XREF: __crtGetLocaleInfoW_stat+65j
.text:0040BEBF					       ; __crtGetLocaleInfoW_stat+9Ej
.text:0040BEBF		       lea     esp, [ebp-14h]
.text:0040BEC2		       pop     edi
.text:0040BEC3		       pop     esi
.text:0040BEC4		       pop     ebx
.text:0040BEC5		       mov     ecx, [ebp+var_4]
.text:0040BEC8		       xor     ecx, ebp	       ; cookie
.text:0040BECA		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040BECF		       leave
.text:0040BED0		       retn
.text:0040BED0 __crtGetLocaleInfoW_stat	endp
.text:0040BED0
.text:0040BED1
.text:0040BED1 ; =============== S U B R O U T I N E =======================================
.text:0040BED1
.text:0040BED1 ; Attributes: bp-based frame
.text:0040BED1
.text:0040BED1 ; int __cdecl __crtGetLocaleInfoW(localeinfo_struct *plocinfo, unsigned int Locale, unsigned int	LCType,	wchar_t	*lpLCData, int cchData,	int code_page)
.text:0040BED1 ___crtGetLocaleInfoW proc near	       ; CODE XREF: ___getlocaleinfo+124p
.text:0040BED1
.text:0040BED1 _loc_update     = _LocaleUpdate ptr -10h
.text:0040BED1 plocinfo	       = dword ptr  8
.text:0040BED1 Locale	       = dword ptr  0Ch
.text:0040BED1 LCType	       = dword ptr  10h
.text:0040BED1 lpLCData	       = dword ptr  14h
.text:0040BED1 cchData	       = dword ptr  18h
.text:0040BED1 code_page       = dword ptr  1Ch
.text:0040BED1
.text:0040BED1		       push    ebp
.text:0040BED2		       mov     ebp, esp
.text:0040BED4		       sub     esp, 10h
.text:0040BED7		       push    [ebp+plocinfo]  ; plocinfo
.text:0040BEDA		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040BEDD		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040BEE2		       push    [ebp+code_page] ; code_page
.text:0040BEE5		       lea     eax, [ebp+_loc_update]
.text:0040BEE8		       push    [ebp+cchData]   ; cchData
.text:0040BEEB		       push    [ebp+lpLCData]  ; lpLCData
.text:0040BEEE		       push    [ebp+LCType]    ; LCType
.text:0040BEF1		       push    [ebp+Locale]    ; Locale
.text:0040BEF4		       push    eax	       ; plocinfo
.text:0040BEF5		       call    __crtGetLocaleInfoW_stat
.text:0040BEFA		       add     esp, 18h
.text:0040BEFD		       cmp     [ebp+_loc_update.updated], 0
.text:0040BF01		       jz      short locret_40BF0A
.text:0040BF03		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040BF06		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040BF0A
.text:0040BF0A locret_40BF0A:			       ; CODE XREF: ___crtGetLocaleInfoW+30j
.text:0040BF0A		       leave
.text:0040BF0B		       retn
.text:0040BF0B ___crtGetLocaleInfoW endp
.text:0040BF0B
.text:0040BF0C
.text:0040BF0C ; =============== S U B R O U T I N E =======================================
.text:0040BF0C
.text:0040BF0C ; Attributes: bp-based frame
.text:0040BF0C
.text:0040BF0C ; int __cdecl _crtGetLocaleInfoA_stat(localeinfo_struct *plocinfo, unsigned int Locale, unsigned	int LCType, char *lpLCData, int	cchData, int code_page)
.text:0040BF0C __crtGetLocaleInfoA_stat	proc near      ; CODE XREF: ___crtGetLocaleInfoA+24p
.text:0040BF0C
.text:0040BF0C buff_size       = dword ptr -8
.text:0040BF0C var_4	       = dword ptr -4
.text:0040BF0C plocinfo	       = dword ptr  8
.text:0040BF0C Locale	       = dword ptr  0Ch
.text:0040BF0C LCType	       = dword ptr  10h
.text:0040BF0C lpLCData	       = dword ptr  14h
.text:0040BF0C cchData	       = dword ptr  18h
.text:0040BF0C code_page       = dword ptr  1Ch
.text:0040BF0C
.text:0040BF0C		       push    ebp
.text:0040BF0D		       mov     ebp, esp
.text:0040BF0F		       push    ecx
.text:0040BF10		       push    ecx
.text:0040BF11		       mov     eax, ___security_cookie
.text:0040BF16		       xor     eax, ebp
.text:0040BF18		       mov     [ebp+var_4], eax
.text:0040BF1B		       mov     eax, f_use_1
.text:0040BF20		       push    ebx
.text:0040BF21		       mov     ebx, ds:__imp__GetLocaleInfoW@16	; GetLocaleInfoW(x,x,x,x)
.text:0040BF27		       push    esi
.text:0040BF28		       push    edi
.text:0040BF29		       xor     edi, edi
.text:0040BF2B		       xor     esi, esi
.text:0040BF2D		       inc     edi
.text:0040BF2E		       cmp     eax, esi
.text:0040BF30		       jnz     short loc_40BF5E
.text:0040BF32		       push    esi	       ; cchData
.text:0040BF33		       push    esi	       ; lpLCData
.text:0040BF34		       push    edi	       ; LCType
.text:0040BF35		       push    esi	       ; Locale
.text:0040BF36		       call    ebx ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040BF38		       test    eax, eax
.text:0040BF3A		       jz      short loc_40BF44
.text:0040BF3C		       mov     f_use_1,	edi
.text:0040BF42		       jmp     short loc_40BF73
.text:0040BF44 ; ---------------------------------------------------------------------------
.text:0040BF44
.text:0040BF44 loc_40BF44:			       ; CODE XREF: __crtGetLocaleInfoA_stat+2Ej
.text:0040BF44		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040BF4A		       cmp     eax, 78h
.text:0040BF4D		       jnz     short loc_40BF59
.text:0040BF4F		       push    2
.text:0040BF51		       pop     eax
.text:0040BF52		       mov     f_use_1,	eax
.text:0040BF57		       jmp     short loc_40BF5E
.text:0040BF59 ; ---------------------------------------------------------------------------
.text:0040BF59
.text:0040BF59 loc_40BF59:			       ; CODE XREF: __crtGetLocaleInfoA_stat+41j
.text:0040BF59		       mov     eax, f_use_1
.text:0040BF5E
.text:0040BF5E loc_40BF5E:			       ; CODE XREF: __crtGetLocaleInfoA_stat+24j
.text:0040BF5E					       ; __crtGetLocaleInfoA_stat+4Bj
.text:0040BF5E		       cmp     eax, 2
.text:0040BF61		       jz      loc_40C025
.text:0040BF67		       cmp     eax, esi
.text:0040BF69		       jz      loc_40C025
.text:0040BF6F		       cmp     eax, edi
.text:0040BF71		       jnz     short loc_40BF96
.text:0040BF73
.text:0040BF73 loc_40BF73:			       ; CODE XREF: __crtGetLocaleInfoA_stat+36j
.text:0040BF73		       cmp     [ebp+code_page],	esi
.text:0040BF76		       jnz     short loc_40BF83
.text:0040BF78		       mov     eax, [ebp+plocinfo]
.text:0040BF7B		       mov     eax, [eax]
.text:0040BF7D		       mov     eax, [eax+4]
.text:0040BF80		       mov     [ebp+code_page],	eax
.text:0040BF83
.text:0040BF83 loc_40BF83:			       ; CODE XREF: __crtGetLocaleInfoA_stat+6Aj
.text:0040BF83		       push    esi	       ; cchData
.text:0040BF84		       push    esi	       ; lpLCData
.text:0040BF85		       push    [ebp+LCType]    ; LCType
.text:0040BF88		       push    [ebp+Locale]    ; Locale
.text:0040BF8B		       call    ebx ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040BF8D		       mov     ecx, eax
.text:0040BF8F		       cmp     ecx, esi
.text:0040BF91		       mov     [ebp+buff_size],	ecx
.text:0040BF94		       jnz     short loc_40BF9D
.text:0040BF96
.text:0040BF96 loc_40BF96:			       ; CODE XREF: __crtGetLocaleInfoA_stat+65j
.text:0040BF96					       ; __crtGetLocaleInfoA_stat+B3j ...
.text:0040BF96		       xor     eax, eax
.text:0040BF98		       jmp     loc_40C037
.text:0040BF9D ; ---------------------------------------------------------------------------
.text:0040BF9D
.text:0040BF9D loc_40BF9D:			       ; CODE XREF: __crtGetLocaleInfoA_stat+88j
.text:0040BF9D		       jle     short loc_40BFE4
.text:0040BF9F		       push    0FFFFFFE0h
.text:0040BFA1		       xor     edx, edx
.text:0040BFA3		       pop     eax
.text:0040BFA4		       div     ecx
.text:0040BFA6		       cmp     eax, 2
.text:0040BFA9		       jb      short loc_40BFE4
.text:0040BFAB		       lea     eax, [ecx+ecx+8]
.text:0040BFAF		       cmp     eax, 400h
.text:0040BFB4		       ja      short loc_40BFCC
.text:0040BFB6		       call    __alloca_probe_16
.text:0040BFBB		       mov     edi, esp
.text:0040BFBD		       cmp     edi, esi
.text:0040BFBF		       jz      short loc_40BF96
.text:0040BFC1		       mov     dword ptr [edi],	0CCCCh
.text:0040BFC7		       add     edi, 8
.text:0040BFCA		       jmp     short loc_40BFE6
.text:0040BFCC ; ---------------------------------------------------------------------------
.text:0040BFCC
.text:0040BFCC loc_40BFCC:			       ; CODE XREF: __crtGetLocaleInfoA_stat+A8j
.text:0040BFCC		       push    eax	       ; size
.text:0040BFCD		       call    _malloc
.text:0040BFD2		       cmp     eax, esi
.text:0040BFD4		       pop     ecx
.text:0040BFD5		       jz      short loc_40BFE0
.text:0040BFD7		       mov     dword ptr [eax],	0DDDDh
.text:0040BFDD		       add     eax, 8
.text:0040BFE0
.text:0040BFE0 loc_40BFE0:			       ; CODE XREF: __crtGetLocaleInfoA_stat+C9j
.text:0040BFE0		       mov     edi, eax
.text:0040BFE2		       jmp     short loc_40BFE6
.text:0040BFE4 ; ---------------------------------------------------------------------------
.text:0040BFE4
.text:0040BFE4 loc_40BFE4:			       ; CODE XREF: __crtGetLocaleInfoA_stat:loc_40BF9Dj
.text:0040BFE4					       ; __crtGetLocaleInfoA_stat+9Dj
.text:0040BFE4		       xor     edi, edi
.text:0040BFE6
.text:0040BFE6 loc_40BFE6:			       ; CODE XREF: __crtGetLocaleInfoA_stat+BEj
.text:0040BFE6					       ; __crtGetLocaleInfoA_stat+D6j
.text:0040BFE6		       cmp     edi, esi
.text:0040BFE8		       jz      short loc_40BF96
.text:0040BFEA		       push    [ebp+buff_size] ; cchData
.text:0040BFED		       push    edi	       ; lpLCData
.text:0040BFEE		       push    [ebp+LCType]    ; LCType
.text:0040BFF1		       push    [ebp+Locale]    ; Locale
.text:0040BFF4		       call    ebx ; GetLocaleInfoW(x,x,x,x) ; GetLocaleInfoW(x,x,x,x)
.text:0040BFF6		       test    eax, eax
.text:0040BFF8		       jz      short error_cleanup_0
.text:0040BFFA		       cmp     [ebp+cchData], esi
.text:0040BFFD		       push    esi	       ; lpUsedDefaultChar
.text:0040BFFE		       push    esi	       ; lpDefaultChar
.text:0040BFFF		       jnz     short loc_40C005
.text:0040C001		       push    esi
.text:0040C002		       push    esi
.text:0040C003		       jmp     short loc_40C00B
.text:0040C005 ; ---------------------------------------------------------------------------
.text:0040C005
.text:0040C005 loc_40C005:			       ; CODE XREF: __crtGetLocaleInfoA_stat+F3j
.text:0040C005		       push    [ebp+cchData]   ; cbMultiByte
.text:0040C008		       push    [ebp+lpLCData]  ; lpMultiByteStr
.text:0040C00B
.text:0040C00B loc_40C00B:			       ; CODE XREF: __crtGetLocaleInfoA_stat+F7j
.text:0040C00B		       push    0FFFFFFFFh      ; cchWideChar
.text:0040C00D		       push    edi	       ; lpWideCharStr
.text:0040C00E		       push    esi	       ; dwFlags
.text:0040C00F		       push    [ebp+code_page] ; CodePage
.text:0040C012		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040C018		       mov     esi, eax
.text:0040C01A
.text:0040C01A error_cleanup_0:			       ; CODE XREF: __crtGetLocaleInfoA_stat+ECj
.text:0040C01A		       push    edi	       ; _Memory
.text:0040C01B		       call    __freea
.text:0040C020		       pop     ecx
.text:0040C021		       mov     eax, esi
.text:0040C023		       jmp     short loc_40C037
.text:0040C025 ; ---------------------------------------------------------------------------
.text:0040C025
.text:0040C025 loc_40C025:			       ; CODE XREF: __crtGetLocaleInfoA_stat+55j
.text:0040C025					       ; __crtGetLocaleInfoA_stat+5Dj
.text:0040C025		       push    [ebp+cchData]   ; cchData
.text:0040C028		       push    [ebp+lpLCData]  ; lpLCData
.text:0040C02B		       push    [ebp+LCType]    ; LCType
.text:0040C02E		       push    [ebp+Locale]    ; Locale
.text:0040C031		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040C037
.text:0040C037 loc_40C037:			       ; CODE XREF: __crtGetLocaleInfoA_stat+8Cj
.text:0040C037					       ; __crtGetLocaleInfoA_stat+117j
.text:0040C037		       lea     esp, [ebp-14h]
.text:0040C03A		       pop     edi
.text:0040C03B		       pop     esi
.text:0040C03C		       pop     ebx
.text:0040C03D		       mov     ecx, [ebp+var_4]
.text:0040C040		       xor     ecx, ebp	       ; cookie
.text:0040C042		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040C047		       leave
.text:0040C048		       retn
.text:0040C048 __crtGetLocaleInfoA_stat	endp
.text:0040C048
.text:0040C049
.text:0040C049 ; =============== S U B R O U T I N E =======================================
.text:0040C049
.text:0040C049 ; Attributes: bp-based frame
.text:0040C049
.text:0040C049 ; int __cdecl __crtGetLocaleInfoA(localeinfo_struct *plocinfo, unsigned int Locale, unsigned int	LCType,	char *lpLCData,	int cchData, int code_page)
.text:0040C049 ___crtGetLocaleInfoA proc near	       ; CODE XREF: ___getlocaleinfo+46p
.text:0040C049					       ; ___getlocaleinfo+6Bp ...
.text:0040C049
.text:0040C049 _loc_update     = _LocaleUpdate ptr -10h
.text:0040C049 plocinfo	       = dword ptr  8
.text:0040C049 Locale	       = dword ptr  0Ch
.text:0040C049 LCType	       = dword ptr  10h
.text:0040C049 lpLCData	       = dword ptr  14h
.text:0040C049 cchData	       = dword ptr  18h
.text:0040C049 code_page       = dword ptr  1Ch
.text:0040C049
.text:0040C049		       push    ebp
.text:0040C04A		       mov     ebp, esp
.text:0040C04C		       sub     esp, 10h
.text:0040C04F		       push    [ebp+plocinfo]  ; plocinfo
.text:0040C052		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040C055		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040C05A		       push    [ebp+code_page] ; code_page
.text:0040C05D		       lea     eax, [ebp+_loc_update]
.text:0040C060		       push    [ebp+cchData]   ; cchData
.text:0040C063		       push    [ebp+lpLCData]  ; lpLCData
.text:0040C066		       push    [ebp+LCType]    ; LCType
.text:0040C069		       push    [ebp+Locale]    ; Locale
.text:0040C06C		       push    eax	       ; plocinfo
.text:0040C06D		       call    __crtGetLocaleInfoA_stat
.text:0040C072		       add     esp, 18h
.text:0040C075		       cmp     [ebp+_loc_update.updated], 0
.text:0040C079		       jz      short locret_40C082
.text:0040C07B		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040C07E		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040C082
.text:0040C082 locret_40C082:			       ; CODE XREF: ___crtGetLocaleInfoA+30j
.text:0040C082		       leave
.text:0040C083		       retn
.text:0040C083 ___crtGetLocaleInfoA endp
.text:0040C083
.text:0040C084
.text:0040C084 ; =============== S U B R O U T I N E =======================================
.text:0040C084
.text:0040C084 ; Attributes: bp-based frame
.text:0040C084
.text:0040C084 ; void *__cdecl _calloc_impl(unsigned int num, unsigned int size, int *errno_tmp)
.text:0040C084 __calloc_impl   proc near	       ; CODE XREF: __calloc_crt+Ep
.text:0040C084					       ; _calloc+13p
.text:0040C084
.text:0040C084 pvReturn	       = dword ptr -1Ch
.text:0040C084 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040C084 _Expr_val       = dword ptr  8
.text:0040C084 size	       = dword ptr  0Ch
.text:0040C084 errno_tmp       = dword ptr  10h
.text:0040C084
.text:0040C084		       push    0Ch
.text:0040C086		       push    offset dword_421838
.text:0040C08B		       call    __SEH_prolog4
.text:0040C090		       mov     ecx, [ebp+_Expr_val]
.text:0040C093		       xor     edi, edi
.text:0040C095		       cmp     ecx, edi
.text:0040C097		       jbe     short loc_40C0C7
.text:0040C099		       push    0FFFFFFE0h
.text:0040C09B		       pop     eax
.text:0040C09C		       xor     edx, edx
.text:0040C09E		       div     ecx
.text:0040C0A0		       cmp     eax, [ebp+size]
.text:0040C0A3		       sbb     eax, eax
.text:0040C0A5		       inc     eax
.text:0040C0A6		       jnz     short loc_40C0C7
.text:0040C0A8		       call    __errno
.text:0040C0AD		       mov     dword ptr [eax],	0Ch
.text:0040C0B3		       push    edi	       ; pReserved
.text:0040C0B4		       push    edi	       ; nLine
.text:0040C0B5		       push    edi	       ; pszFile
.text:0040C0B6		       push    edi	       ; pszFunction
.text:0040C0B7		       push    edi	       ; pszExpression
.text:0040C0B8		       call    __invalid_parameter
.text:0040C0BD		       add     esp, 14h
.text:0040C0C0
.text:0040C0C0 loc_40C0C0:			       ; CODE XREF: __calloc_impl+E6j
.text:0040C0C0					       ; __calloc_impl+F2j
.text:0040C0C0		       xor     eax, eax
.text:0040C0C2		       jmp     loc_40C19C
.text:0040C0C7 ; ---------------------------------------------------------------------------
.text:0040C0C7
.text:0040C0C7 loc_40C0C7:			       ; CODE XREF: __calloc_impl+13j
.text:0040C0C7					       ; __calloc_impl+22j
.text:0040C0C7		       imul    ecx, [ebp+size]
.text:0040C0CB		       mov     esi, ecx
.text:0040C0CD		       mov     [ebp+_Expr_val],	esi
.text:0040C0D0		       cmp     esi, edi
.text:0040C0D2		       jnz     short loc_40C0D7
.text:0040C0D4		       xor     esi, esi
.text:0040C0D6		       inc     esi
.text:0040C0D7
.text:0040C0D7 loc_40C0D7:			       ; CODE XREF: __calloc_impl+4Ej
.text:0040C0D7					       ; __calloc_impl+DBj
.text:0040C0D7		       xor     ebx, ebx
.text:0040C0D9		       mov     [ebp+pvReturn], ebx
.text:0040C0DC		       cmp     esi, 0FFFFFFE0h
.text:0040C0DF		       ja      short loc_40C14A
.text:0040C0E1		       cmp     ___active_heap, 3
.text:0040C0E8		       jnz     short loc_40C135
.text:0040C0EA		       add     esi, 0Fh
.text:0040C0ED		       and     esi, 0FFFFFFF0h
.text:0040C0F0		       mov     [ebp+size], esi
.text:0040C0F3		       mov     eax, [ebp+_Expr_val]
.text:0040C0F6		       cmp     eax, ___sbh_threshold
.text:0040C0FC		       ja      short loc_40C135
.text:0040C0FE		       push    4	       ; locknum
.text:0040C100		       call    __lock
.text:0040C105		       pop     ecx
.text:0040C106		       mov     [ebp+ms_exc.disabled], edi
.text:0040C109		       push    [ebp+_Expr_val] ; intSize
.text:0040C10C		       call    ___sbh_alloc_block
.text:0040C111		       pop     ecx
.text:0040C112		       mov     [ebp+pvReturn], eax
.text:0040C115		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040C11C		       call    $LN24_2
.text:0040C121
.text:0040C121 $LN25_2:
.text:0040C121		       mov     ebx, [ebp+pvReturn]
.text:0040C124		       cmp     ebx, edi
.text:0040C126		       jz      short loc_40C139
.text:0040C128		       push    [ebp+_Expr_val] ; count
.text:0040C12B		       push    edi	       ; value
.text:0040C12C		       push    ebx	       ; dst
.text:0040C12D		       call    _memset
.text:0040C132		       add     esp, 0Ch
.text:0040C135
.text:0040C135 loc_40C135:			       ; CODE XREF: __calloc_impl+64j
.text:0040C135					       ; __calloc_impl+78j
.text:0040C135		       cmp     ebx, edi
.text:0040C137		       jnz     short loc_40C19A
.text:0040C139
.text:0040C139 loc_40C139:			       ; CODE XREF: __calloc_impl+A2j
.text:0040C139		       push    esi	       ; dwBytes
.text:0040C13A		       push    8	       ; dwFlags
.text:0040C13C		       push    __crtheap       ; hHeap
.text:0040C142		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:0040C148		       mov     ebx, eax
.text:0040C14A
.text:0040C14A loc_40C14A:			       ; CODE XREF: __calloc_impl+5Bj
.text:0040C14A		       cmp     ebx, edi
.text:0040C14C		       jnz     short loc_40C19A
.text:0040C14E		       cmp     __newmode, edi
.text:0040C154		       jz      short loc_40C189
.text:0040C156		       push    esi	       ; size
.text:0040C157		       call    __callnewh
.text:0040C15C		       pop     ecx
.text:0040C15D		       test    eax, eax
.text:0040C15F		       jnz     loc_40C0D7
.text:0040C165		       mov     eax, [ebp+errno_tmp]
.text:0040C168		       cmp     eax, edi
.text:0040C16A		       jz      loc_40C0C0
.text:0040C170		       mov     dword ptr [eax],	0Ch
.text:0040C176		       jmp     loc_40C0C0
.text:0040C17B ; ---------------------------------------------------------------------------
.text:0040C17B
.text:0040C17B $LN22_2:				       ; DATA XREF: .rdata:00421850o
.text:0040C17B		       xor     edi, edi
.text:0040C17D		       mov     esi, [ebp+size]
.text:0040C180
.text:0040C180 $LN24_2:				       ; CODE XREF: __calloc_impl+98p
.text:0040C180		       push    4	       ; locknum
.text:0040C182		       call    __unlock
.text:0040C187		       pop     ecx
.text:0040C188
.text:0040C188 $LN23_2:
.text:0040C188		       retn
.text:0040C189 ; ---------------------------------------------------------------------------
.text:0040C189
.text:0040C189 loc_40C189:			       ; CODE XREF: __calloc_impl+D0j
.text:0040C189		       cmp     ebx, edi
.text:0040C18B		       jnz     short loc_40C19A
.text:0040C18D		       mov     eax, [ebp+errno_tmp]
.text:0040C190		       cmp     eax, edi
.text:0040C192		       jz      short loc_40C19A
.text:0040C194		       mov     dword ptr [eax],	0Ch
.text:0040C19A
.text:0040C19A loc_40C19A:			       ; CODE XREF: __calloc_impl+B3j
.text:0040C19A					       ; __calloc_impl+C8j ...
.text:0040C19A		       mov     eax, ebx
.text:0040C19C
.text:0040C19C loc_40C19C:			       ; CODE XREF: __calloc_impl+3Ej
.text:0040C19C		       call    __SEH_epilog4
.text:0040C1A1		       retn
.text:0040C1A1 __calloc_impl   endp ; sp-analysis failed
.text:0040C1A1
.text:0040C1A2
.text:0040C1A2 ; =============== S U B R O U T I N E =======================================
.text:0040C1A2
.text:0040C1A2 ; Attributes: bp-based frame
.text:0040C1A2
.text:0040C1A2 ; void *__cdecl calloc(unsigned int num,	unsigned int size)
.text:0040C1A2 _calloc	       proc near	       ; CODE XREF: _dupenv_s_helper+53p
.text:0040C1A2					       ; __dupenv_s+79p
.text:0040C1A2
.text:0040C1A2 errno_tmp       = dword ptr -4
.text:0040C1A2 num	       = dword ptr  8
.text:0040C1A2 size	       = dword ptr  0Ch
.text:0040C1A2
.text:0040C1A2		       push    ebp
.text:0040C1A3		       mov     ebp, esp
.text:0040C1A5		       push    ecx
.text:0040C1A6		       and     [ebp+errno_tmp],	0
.text:0040C1AA		       push    edi
.text:0040C1AB		       lea     eax, [ebp+errno_tmp]
.text:0040C1AE		       push    eax	       ; errno_tmp
.text:0040C1AF		       push    [ebp+size]      ; size
.text:0040C1B2		       push    [ebp+num]       ; num
.text:0040C1B5		       call    __calloc_impl
.text:0040C1BA		       mov     edi, eax
.text:0040C1BC		       add     esp, 0Ch
.text:0040C1BF		       test    edi, edi
.text:0040C1C1		       jnz     short loc_40C1DC
.text:0040C1C3		       push    esi
.text:0040C1C4		       mov     esi, [ebp+errno_tmp]
.text:0040C1C7		       test    esi, esi
.text:0040C1C9		       jz      short loc_40C1DB
.text:0040C1CB		       call    __errno
.text:0040C1D0		       test    eax, eax
.text:0040C1D2		       jz      short loc_40C1DB
.text:0040C1D4		       call    __errno
.text:0040C1D9		       mov     [eax], esi
.text:0040C1DB
.text:0040C1DB loc_40C1DB:			       ; CODE XREF: _calloc+27j
.text:0040C1DB					       ; _calloc+30j
.text:0040C1DB		       pop     esi
.text:0040C1DC
.text:0040C1DC loc_40C1DC:			       ; CODE XREF: _calloc+1Fj
.text:0040C1DC		       mov     eax, edi
.text:0040C1DE		       pop     edi
.text:0040C1DF		       leave
.text:0040C1E0		       retn
.text:0040C1E0 _calloc	       endp
.text:0040C1E0
.text:0040C1E1
.text:0040C1E1 ; =============== S U B R O U T I N E =======================================
.text:0040C1E1
.text:0040C1E1 ; Attributes: bp-based frame
.text:0040C1E1
.text:0040C1E1 ; void *__cdecl realloc(void *pBlock, unsigned int newsize)
.text:0040C1E1 _realloc	       proc near	       ; CODE XREF: __realloc_crt+Cp
.text:0040C1E1					       ; __recalloc+51p
.text:0040C1E1
.text:0040C1E1 pHeader	       = dword ptr -20h
.text:0040C1E1 pvReturn	       = dword ptr -1Ch
.text:0040C1E1 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040C1E1 pBlock	       = dword ptr  8
.text:0040C1E1 newsize	       = dword ptr  0Ch
.text:0040C1E1
.text:0040C1E1		       push    10h
.text:0040C1E3		       push    offset dword_421858
.text:0040C1E8		       call    __SEH_prolog4
.text:0040C1ED		       mov     ebx, [ebp+pBlock]
.text:0040C1F0		       test    ebx, ebx
.text:0040C1F2		       jnz     short loc_40C202
.text:0040C1F4		       push    [ebp+newsize]   ; size
.text:0040C1F7		       call    _malloc
.text:0040C1FC		       pop     ecx
.text:0040C1FD		       jmp     loc_40C3CE
.text:0040C202 ; ---------------------------------------------------------------------------
.text:0040C202
.text:0040C202 loc_40C202:			       ; CODE XREF: _realloc+11j
.text:0040C202		       mov     esi, [ebp+newsize]
.text:0040C205		       test    esi, esi
.text:0040C207		       jnz     short loc_40C215
.text:0040C209		       push    ebx	       ; pBlock
.text:0040C20A		       call    _free
.text:0040C20F		       pop     ecx
.text:0040C210		       jmp     loc_40C3CC
.text:0040C215 ; ---------------------------------------------------------------------------
.text:0040C215
.text:0040C215 loc_40C215:			       ; CODE XREF: _realloc+26j
.text:0040C215		       cmp     ___active_heap, 3
.text:0040C21C		       jnz     loc_40C3B5
.text:0040C222
.text:0040C222 loc_40C222:			       ; CODE XREF: _realloc+169j
.text:0040C222		       xor     edi, edi
.text:0040C224		       mov     [ebp+pvReturn], edi
.text:0040C227		       cmp     esi, 0FFFFFFE0h
.text:0040C22A		       ja      loc_40C3BA
.text:0040C230		       push    4	       ; locknum
.text:0040C232		       call    __lock
.text:0040C237		       pop     ecx
.text:0040C238		       mov     [ebp+ms_exc.disabled], edi
.text:0040C23B		       push    ebx	       ; pvAlloc
.text:0040C23C		       call    ___sbh_find_block
.text:0040C241		       pop     ecx
.text:0040C242		       mov     [ebp+pHeader], eax
.text:0040C245		       cmp     eax, edi
.text:0040C247		       jz      loc_40C2EB
.text:0040C24D		       cmp     esi, ___sbh_threshold
.text:0040C253		       ja      short loc_40C29E
.text:0040C255		       push    esi	       ; intNew
.text:0040C256		       push    ebx	       ; pvAlloc
.text:0040C257		       push    eax	       ; pHeader
.text:0040C258		       call    ___sbh_resize_block
.text:0040C25D		       add     esp, 0Ch
.text:0040C260		       test    eax, eax
.text:0040C262		       jz      short loc_40C269
.text:0040C264		       mov     [ebp+pvReturn], ebx
.text:0040C267		       jmp     short loc_40C29E
.text:0040C269 ; ---------------------------------------------------------------------------
.text:0040C269
.text:0040C269 loc_40C269:			       ; CODE XREF: _realloc+81j
.text:0040C269		       push    esi	       ; intSize
.text:0040C26A		       call    ___sbh_alloc_block
.text:0040C26F		       pop     ecx
.text:0040C270		       mov     [ebp+pvReturn], eax
.text:0040C273		       cmp     eax, edi
.text:0040C275		       jz      short loc_40C29E
.text:0040C277		       mov     eax, [ebx-4]
.text:0040C27A		       dec     eax
.text:0040C27B		       cmp     eax, esi
.text:0040C27D		       jb      short loc_40C281
.text:0040C27F		       mov     eax, esi
.text:0040C281
.text:0040C281 loc_40C281:			       ; CODE XREF: _realloc+9Cj
.text:0040C281		       push    eax	       ; count
.text:0040C282		       push    ebx	       ; src
.text:0040C283		       push    [ebp+pvReturn]  ; dst
.text:0040C286		       call    _memcpy
.text:0040C28B		       push    ebx	       ; pvAlloc
.text:0040C28C		       call    ___sbh_find_block
.text:0040C291		       mov     [ebp+pHeader], eax
.text:0040C294		       push    ebx	       ; pvAlloc
.text:0040C295		       push    eax	       ; pHeader
.text:0040C296		       call    ___sbh_free_block
.text:0040C29B		       add     esp, 18h
.text:0040C29E
.text:0040C29E loc_40C29E:			       ; CODE XREF: _realloc+72j
.text:0040C29E					       ; _realloc+86j ...
.text:0040C29E		       cmp     [ebp+pvReturn], edi
.text:0040C2A1		       jnz     short loc_40C2EB
.text:0040C2A3		       cmp     esi, edi
.text:0040C2A5		       jnz     short loc_40C2AD
.text:0040C2A7		       xor     esi, esi
.text:0040C2A9		       inc     esi
.text:0040C2AA		       mov     [ebp+newsize], esi
.text:0040C2AD
.text:0040C2AD loc_40C2AD:			       ; CODE XREF: _realloc+C4j
.text:0040C2AD		       add     esi, 0Fh
.text:0040C2B0		       and     esi, 0FFFFFFF0h
.text:0040C2B3		       mov     [ebp+newsize], esi
.text:0040C2B6		       push    esi	       ; dwBytes
.text:0040C2B7		       push    edi	       ; dwFlags
.text:0040C2B8		       push    __crtheap       ; hHeap
.text:0040C2BE		       call    ds:__imp__HeapAlloc@12 ;	HeapAlloc(x,x,x)
.text:0040C2C4		       mov     [ebp+pvReturn], eax
.text:0040C2C7		       cmp     eax, edi
.text:0040C2C9		       jz      short loc_40C2EB
.text:0040C2CB		       mov     eax, [ebx-4]
.text:0040C2CE		       dec     eax
.text:0040C2CF		       cmp     eax, esi
.text:0040C2D1		       jb      short loc_40C2D5
.text:0040C2D3		       mov     eax, esi
.text:0040C2D5
.text:0040C2D5 loc_40C2D5:			       ; CODE XREF: _realloc+F0j
.text:0040C2D5		       push    eax	       ; count
.text:0040C2D6		       push    ebx	       ; src
.text:0040C2D7		       push    [ebp+pvReturn]  ; dst
.text:0040C2DA		       call    _memcpy
.text:0040C2DF		       push    ebx	       ; pvAlloc
.text:0040C2E0		       push    [ebp+pHeader]   ; pHeader
.text:0040C2E3		       call    ___sbh_free_block
.text:0040C2E8		       add     esp, 14h
.text:0040C2EB
.text:0040C2EB loc_40C2EB:			       ; CODE XREF: _realloc+66j
.text:0040C2EB					       ; _realloc+C0j ...
.text:0040C2EB		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040C2F2		       call    $LN48
.text:0040C2F7
.text:0040C2F7 $LN49:
.text:0040C2F7		       cmp     [ebp+pHeader], 0
.text:0040C2FB		       jnz     short loc_40C32E
.text:0040C2FD		       test    esi, esi
.text:0040C2FF		       jnz     short loc_40C302
.text:0040C301		       inc     esi
.text:0040C302
.text:0040C302 loc_40C302:			       ; CODE XREF: _realloc+11Ej
.text:0040C302		       add     esi, 0Fh
.text:0040C305		       and     esi, 0FFFFFFF0h
.text:0040C308		       mov     [ebp+newsize], esi
.text:0040C30B		       push    esi	       ; dwBytes
.text:0040C30C		       push    ebx	       ; lpMem
.text:0040C30D		       push    0	       ; dwFlags
.text:0040C30F		       push    __crtheap       ; hHeap
.text:0040C315		       call    ds:__imp__HeapReAlloc@16	; HeapReAlloc(x,x,x,x)
.text:0040C31B		       mov     edi, eax
.text:0040C31D		       jmp     short loc_40C331
.text:0040C31F ; ---------------------------------------------------------------------------
.text:0040C31F
.text:0040C31F $LN46:				       ; DATA XREF: .rdata:00421870o
.text:0040C31F		       mov     esi, [ebp+newsize]
.text:0040C322		       mov     ebx, [ebp+pBlock]
.text:0040C325
.text:0040C325 $LN48:				       ; CODE XREF: _realloc+111p
.text:0040C325		       push    4	       ; locknum
.text:0040C327		       call    __unlock
.text:0040C32C		       pop     ecx
.text:0040C32D
.text:0040C32D $LN47:
.text:0040C32D		       retn
.text:0040C32E ; ---------------------------------------------------------------------------
.text:0040C32E
.text:0040C32E loc_40C32E:			       ; CODE XREF: _realloc+11Aj
.text:0040C32E		       mov     edi, [ebp+pvReturn]
.text:0040C331
.text:0040C331 loc_40C331:			       ; CODE XREF: _realloc+13Cj
.text:0040C331		       test    edi, edi
.text:0040C333		       jnz     loc_40C3F8
.text:0040C339		       cmp     __newmode, edi
.text:0040C33F		       jz      short loc_40C36D
.text:0040C341		       push    esi	       ; size
.text:0040C342		       call    __callnewh
.text:0040C347		       pop     ecx
.text:0040C348		       test    eax, eax
.text:0040C34A		       jnz     loc_40C222
.text:0040C350		       call    __errno
.text:0040C355		       cmp     [ebp+pHeader], edi
.text:0040C358		       jnz     short loc_40C3C6
.text:0040C35A
.text:0040C35A loc_40C35A:			       ; CODE XREF: _realloc+1F8j
.text:0040C35A		       mov     esi, eax
.text:0040C35C		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040C362		       push    eax	       ; oserrno
.text:0040C363		       call    __get_errno_from_oserr
.text:0040C368		       pop     ecx
.text:0040C369		       mov     [esi], eax
.text:0040C36B		       jmp     short loc_40C3CC
.text:0040C36D ; ---------------------------------------------------------------------------
.text:0040C36D
.text:0040C36D loc_40C36D:			       ; CODE XREF: _realloc+15Ej
.text:0040C36D		       test    edi, edi
.text:0040C36F		       jnz     loc_40C3F8
.text:0040C375		       call    __errno
.text:0040C37A		       cmp     [ebp+pHeader], edi
.text:0040C37D		       jz      short loc_40C3E7
.text:0040C37F		       mov     dword ptr [eax],	0Ch
.text:0040C385		       jmp     short loc_40C3F8
.text:0040C387 ; ---------------------------------------------------------------------------
.text:0040C387
.text:0040C387 loc_40C387:			       ; CODE XREF: _realloc+1D7j
.text:0040C387		       test    esi, esi
.text:0040C389		       jnz     short loc_40C38C
.text:0040C38B		       inc     esi
.text:0040C38C
.text:0040C38C loc_40C38C:			       ; CODE XREF: _realloc+1A8j
.text:0040C38C		       push    esi	       ; dwBytes
.text:0040C38D		       push    ebx	       ; lpMem
.text:0040C38E		       push    0	       ; dwFlags
.text:0040C390		       push    __crtheap       ; hHeap
.text:0040C396		       call    ds:__imp__HeapReAlloc@16	; HeapReAlloc(x,x,x,x)
.text:0040C39C		       mov     edi, eax
.text:0040C39E		       test    edi, edi
.text:0040C3A0		       jnz     short loc_40C3F8
.text:0040C3A2		       cmp     __newmode, eax
.text:0040C3A8		       jz      short loc_40C3DE
.text:0040C3AA		       push    esi	       ; size
.text:0040C3AB		       call    __callnewh
.text:0040C3B0		       pop     ecx
.text:0040C3B1		       test    eax, eax
.text:0040C3B3		       jz      short loc_40C3D4
.text:0040C3B5
.text:0040C3B5 loc_40C3B5:			       ; CODE XREF: _realloc+3Bj
.text:0040C3B5		       cmp     esi, 0FFFFFFE0h
.text:0040C3B8		       jbe     short loc_40C387
.text:0040C3BA
.text:0040C3BA loc_40C3BA:			       ; CODE XREF: _realloc+49j
.text:0040C3BA		       push    esi	       ; size
.text:0040C3BB		       call    __callnewh
.text:0040C3C0		       pop     ecx
.text:0040C3C1		       call    __errno
.text:0040C3C6
.text:0040C3C6 loc_40C3C6:			       ; CODE XREF: _realloc+177j
.text:0040C3C6		       mov     dword ptr [eax],	0Ch
.text:0040C3CC
.text:0040C3CC loc_40C3CC:			       ; CODE XREF: _realloc+2Fj
.text:0040C3CC					       ; _realloc+18Aj
.text:0040C3CC		       xor     eax, eax
.text:0040C3CE
.text:0040C3CE loc_40C3CE:			       ; CODE XREF: _realloc+1Cj
.text:0040C3CE					       ; _realloc+219j
.text:0040C3CE		       call    __SEH_epilog4
.text:0040C3D3		       retn
.text:0040C3D4 ; ---------------------------------------------------------------------------
.text:0040C3D4
.text:0040C3D4 loc_40C3D4:			       ; CODE XREF: _realloc+1D2j
.text:0040C3D4		       call    __errno
.text:0040C3D9		       jmp     loc_40C35A
.text:0040C3DE ; ---------------------------------------------------------------------------
.text:0040C3DE
.text:0040C3DE loc_40C3DE:			       ; CODE XREF: _realloc+1C7j
.text:0040C3DE		       test    edi, edi
.text:0040C3E0		       jnz     short loc_40C3F8
.text:0040C3E2		       call    __errno
.text:0040C3E7
.text:0040C3E7 loc_40C3E7:			       ; CODE XREF: _realloc+19Cj
.text:0040C3E7		       mov     esi, eax
.text:0040C3E9		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040C3EF		       push    eax	       ; oserrno
.text:0040C3F0		       call    __get_errno_from_oserr
.text:0040C3F5		       mov     [esi], eax
.text:0040C3F7		       pop     ecx
.text:0040C3F8
.text:0040C3F8 loc_40C3F8:			       ; CODE XREF: _realloc+152j
.text:0040C3F8					       ; _realloc+18Ej	...
.text:0040C3F8		       mov     eax, edi
.text:0040C3FA		       jmp     short loc_40C3CE
.text:0040C3FA _realloc	       endp ; sp-analysis failed
.text:0040C3FA
.text:0040C3FC
.text:0040C3FC ; =============== S U B R O U T I N E =======================================
.text:0040C3FC
.text:0040C3FC ; Attributes: bp-based frame
.text:0040C3FC
.text:0040C3FC ; void *__cdecl _recalloc(void *memblock, unsigned int count, unsigned int size)
.text:0040C3FC __recalloc      proc near	       ; CODE XREF: __recalloc_crt+10p
.text:0040C3FC
.text:0040C3FC memblock	       = dword ptr  8
.text:0040C3FC count	       = dword ptr  0Ch
.text:0040C3FC size	       = dword ptr  10h
.text:0040C3FC
.text:0040C3FC		       push    ebp
.text:0040C3FD		       mov     ebp, esp
.text:0040C3FF		       mov     ecx, [ebp+count]
.text:0040C402		       push    ebx
.text:0040C403		       xor     ebx, ebx
.text:0040C405		       cmp     ecx, ebx
.text:0040C407		       jbe     short loc_40C431
.text:0040C409		       push    0FFFFFFE0h
.text:0040C40B		       xor     edx, edx
.text:0040C40D		       pop     eax
.text:0040C40E		       div     ecx
.text:0040C410		       cmp     eax, [ebp+size]
.text:0040C413		       jnb     short loc_40C431
.text:0040C415		       call    __errno
.text:0040C41A		       push    ebx	       ; pReserved
.text:0040C41B		       push    ebx	       ; nLine
.text:0040C41C		       push    ebx	       ; pszFile
.text:0040C41D		       push    ebx	       ; pszFunction
.text:0040C41E		       push    ebx	       ; pszExpression
.text:0040C41F		       mov     dword ptr [eax],	0Ch
.text:0040C425		       call    __invalid_parameter
.text:0040C42A		       add     esp, 14h
.text:0040C42D		       xor     eax, eax
.text:0040C42F		       jmp     short loc_40C472
.text:0040C431 ; ---------------------------------------------------------------------------
.text:0040C431
.text:0040C431 loc_40C431:			       ; CODE XREF: __recalloc+Bj
.text:0040C431					       ; __recalloc+17j
.text:0040C431		       imul    ecx, [ebp+size]
.text:0040C435		       cmp     [ebp+memblock], ebx
.text:0040C438		       push    esi
.text:0040C439		       push    edi
.text:0040C43A		       mov     esi, ecx
.text:0040C43C		       jz      short loc_40C449
.text:0040C43E		       push    [ebp+memblock]  ; pblock
.text:0040C441		       call    __msize
.text:0040C446		       pop     ecx
.text:0040C447		       mov     ebx, eax
.text:0040C449
.text:0040C449 loc_40C449:			       ; CODE XREF: __recalloc+40j
.text:0040C449		       push    esi	       ; newsize
.text:0040C44A		       push    [ebp+memblock]  ; pBlock
.text:0040C44D		       call    _realloc
.text:0040C452		       mov     edi, eax
.text:0040C454		       test    edi, edi
.text:0040C456		       pop     ecx
.text:0040C457		       pop     ecx
.text:0040C458		       jz      short loc_40C46E
.text:0040C45A		       cmp     ebx, esi
.text:0040C45C		       jnb     short loc_40C46E
.text:0040C45E		       sub     esi, ebx
.text:0040C460		       push    esi	       ; count
.text:0040C461		       push    0	       ; value
.text:0040C463		       add     ebx, edi
.text:0040C465		       push    ebx	       ; dst
.text:0040C466		       call    _memset
.text:0040C46B		       add     esp, 0Ch
.text:0040C46E
.text:0040C46E loc_40C46E:			       ; CODE XREF: __recalloc+5Cj
.text:0040C46E					       ; __recalloc+60j
.text:0040C46E		       mov     eax, edi
.text:0040C470		       pop     edi
.text:0040C471		       pop     esi
.text:0040C472
.text:0040C472 loc_40C472:			       ; CODE XREF: __recalloc+33j
.text:0040C472		       pop     ebx
.text:0040C473		       pop     ebp
.text:0040C474		       retn
.text:0040C474 __recalloc      endp
.text:0040C474
.text:0040C475
.text:0040C475 ; =============== S U B R O U T I N E =======================================
.text:0040C475
.text:0040C475
.text:0040C475 ; int __cdecl _fclose_nolock(_iobuf *str)
.text:0040C475 __fclose_nolock proc near	       ; CODE XREF: _fclose+5Ap
.text:0040C475
.text:0040C475 str	       = dword ptr  4
.text:0040C475
.text:0040C475		       push    ebx
.text:0040C476		       push    esi
.text:0040C477		       mov     esi, [esp+8+str]
.text:0040C47B		       push    edi
.text:0040C47C		       xor     edi, edi
.text:0040C47E		       or      ebx, 0FFFFFFFFh
.text:0040C481		       cmp     esi, edi
.text:0040C483		       jnz     short loc_40C4A1
.text:0040C485		       call    __errno
.text:0040C48A		       push    edi	       ; pReserved
.text:0040C48B		       push    edi	       ; nLine
.text:0040C48C		       push    edi	       ; pszFile
.text:0040C48D		       push    edi	       ; pszFunction
.text:0040C48E		       push    edi	       ; pszExpression
.text:0040C48F		       mov     dword ptr [eax],	16h
.text:0040C495		       call    __invalid_parameter
.text:0040C49A		       add     esp, 14h
.text:0040C49D		       or      eax, ebx
.text:0040C49F		       jmp     short loc_40C4E3
.text:0040C4A1 ; ---------------------------------------------------------------------------
.text:0040C4A1
.text:0040C4A1 loc_40C4A1:			       ; CODE XREF: __fclose_nolock+Ej
.text:0040C4A1		       test    byte ptr	[esi+0Ch], 83h
.text:0040C4A5		       jz      short loc_40C4DE
.text:0040C4A7		       push    esi	       ; str
.text:0040C4A8		       call    __flush
.text:0040C4AD		       push    esi	       ; stream
.text:0040C4AE		       mov     ebx, eax
.text:0040C4B0		       call    __freebuf
.text:0040C4B5		       push    esi	       ; stream
.text:0040C4B6		       call    __fileno
.text:0040C4BB		       push    eax	       ; fh
.text:0040C4BC		       call    __close
.text:0040C4C1		       add     esp, 10h
.text:0040C4C4		       test    eax, eax
.text:0040C4C6		       jge     short loc_40C4CD
.text:0040C4C8		       or      ebx, 0FFFFFFFFh
.text:0040C4CB		       jmp     short loc_40C4DE
.text:0040C4CD ; ---------------------------------------------------------------------------
.text:0040C4CD
.text:0040C4CD loc_40C4CD:			       ; CODE XREF: __fclose_nolock+51j
.text:0040C4CD		       mov     eax, [esi+1Ch]
.text:0040C4D0		       cmp     eax, edi
.text:0040C4D2		       jz      short loc_40C4DE
.text:0040C4D4		       push    eax	       ; pBlock
.text:0040C4D5		       call    _free
.text:0040C4DA		       pop     ecx
.text:0040C4DB		       mov     [esi+1Ch], edi
.text:0040C4DE
.text:0040C4DE loc_40C4DE:			       ; CODE XREF: __fclose_nolock+30j
.text:0040C4DE					       ; __fclose_nolock+56j ...
.text:0040C4DE		       mov     [esi+0Ch], edi
.text:0040C4E1		       mov     eax, ebx
.text:0040C4E3
.text:0040C4E3 loc_40C4E3:			       ; CODE XREF: __fclose_nolock+2Aj
.text:0040C4E3		       pop     edi
.text:0040C4E4		       pop     esi
.text:0040C4E5		       pop     ebx
.text:0040C4E6		       retn
.text:0040C4E6 __fclose_nolock endp
.text:0040C4E6
.text:0040C4E7
.text:0040C4E7 ; =============== S U B R O U T I N E =======================================
.text:0040C4E7
.text:0040C4E7 ; Attributes: bp-based frame
.text:0040C4E7
.text:0040C4E7 ; int __cdecl fclose(_iobuf *stream)
.text:0040C4E7 _fclose	       proc near	       ; CODE XREF: __fcloseall+43p
.text:0040C4E7
.text:0040C4E7 result	       = dword ptr -1Ch
.text:0040C4E7 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040C4E7 stream	       = dword ptr  8
.text:0040C4E7
.text:0040C4E7		       push    0Ch
.text:0040C4E9		       push    offset dword_421878
.text:0040C4EE		       call    __SEH_prolog4
.text:0040C4F3		       or      [ebp+result], 0FFFFFFFFh
.text:0040C4F7		       xor     eax, eax
.text:0040C4F9		       mov     esi, [ebp+stream]
.text:0040C4FC		       xor     edi, edi
.text:0040C4FE		       cmp     esi, edi
.text:0040C500		       setnz   al
.text:0040C503		       cmp     eax, edi
.text:0040C505		       jnz     short loc_40C524
.text:0040C507		       call    __errno
.text:0040C50C		       mov     dword ptr [eax],	16h
.text:0040C512		       push    edi	       ; pReserved
.text:0040C513		       push    edi	       ; nLine
.text:0040C514		       push    edi	       ; pszFile
.text:0040C515		       push    edi	       ; pszFunction
.text:0040C516		       push    edi	       ; pszExpression
.text:0040C517		       call    __invalid_parameter
.text:0040C51C		       add     esp, 14h
.text:0040C51F		       or      eax, 0FFFFFFFFh
.text:0040C522		       jmp     short loc_40C530
.text:0040C524 ; ---------------------------------------------------------------------------
.text:0040C524
.text:0040C524 loc_40C524:			       ; CODE XREF: _fclose+1Ej
.text:0040C524		       test    byte ptr	[esi+0Ch], 40h
.text:0040C528		       jz      short loc_40C536
.text:0040C52A		       mov     [esi+0Ch], edi
.text:0040C52D
.text:0040C52D $LN11_6:				       ; CODE XREF: _fclose+6Fj
.text:0040C52D		       mov     eax, [ebp+result]
.text:0040C530
.text:0040C530 loc_40C530:			       ; CODE XREF: _fclose+3Bj
.text:0040C530		       call    __SEH_epilog4
.text:0040C535		       retn
.text:0040C536 ; ---------------------------------------------------------------------------
.text:0040C536
.text:0040C536 loc_40C536:			       ; CODE XREF: _fclose+41j
.text:0040C536		       push    esi	       ; pf
.text:0040C537		       call    __lock_file
.text:0040C53C		       pop     ecx
.text:0040C53D		       mov     [ebp+ms_exc.disabled], edi
.text:0040C540		       push    esi	       ; str
.text:0040C541		       call    __fclose_nolock
.text:0040C546		       pop     ecx
.text:0040C547		       mov     [ebp+result], eax
.text:0040C54A		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040C551		       call    $LN10_5
.text:0040C556		       jmp     short $LN11_6
.text:0040C558 ; ---------------------------------------------------------------------------
.text:0040C558
.text:0040C558 $LN8_4:				       ; DATA XREF: .rdata:00421890o
.text:0040C558		       mov     esi, [ebp+stream]
.text:0040C55B
.text:0040C55B $LN10_5:				       ; CODE XREF: _fclose+6Ap
.text:0040C55B		       push    esi	       ; pf
.text:0040C55C		       call    __unlock_file
.text:0040C561		       pop     ecx
.text:0040C562
.text:0040C562 $LN9_7:
.text:0040C562		       retn
.text:0040C562 _fclose	       endp ; sp-analysis failed
.text:0040C562
.text:0040C563
.text:0040C563 ; =============== S U B R O U T I N E =======================================
.text:0040C563
.text:0040C563 ; Attributes: bp-based frame fpd=514h
.text:0040C563
.text:0040C563 ; int __cdecl _write_nolock(int fh, const void *buf, unsigned int cnt)
.text:0040C563 __write_nolock  proc near	       ; CODE XREF: __write+9Ap
.text:0040C563
.text:0040C563 consoleCP       = dword ptr -590h
.text:0040C563 bCR	       = dword ptr -58Ch
.text:0040C563 tmode	       = byte ptr -585h
.text:0040C563 var_584	       = dword ptr -584h
.text:0040C563 written	       = dword ptr -580h
.text:0040C563 lfcount	       = dword ptr -57Ch
.text:0040C563 lpBuffer	       = dword ptr -578h
.text:0040C563 charcount       = dword ptr -574h
.text:0040C563 p	       = dword ptr -570h
.text:0040C563 tmpchar	       = dword ptr -56Ch
.text:0040C563 pu	       = dword ptr -568h
.text:0040C563 utf8_buf	       = byte ptr -564h
.text:0040C563 utf16_buf       = word ptr -160h
.text:0040C563 mboutbuf	       = byte ptr -0Ch
.text:0040C563 var_4	       = dword ptr -4
.text:0040C563 fh	       = dword ptr  8
.text:0040C563 buf	       = dword ptr  0Ch
.text:0040C563 cnt	       = dword ptr  10h
.text:0040C563
.text:0040C563		       push    ebp
.text:0040C564		       lea     ebp, [esp-514h]
.text:0040C56B		       sub     esp, 590h
.text:0040C571		       mov     eax, ___security_cookie
.text:0040C576		       xor     eax, ebp
.text:0040C578		       mov     [ebp+514h+var_4], eax
.text:0040C57E		       mov     eax, [ebp+514h+buf]
.text:0040C584		       push    esi
.text:0040C585		       xor     esi, esi
.text:0040C587		       cmp     [ebp+514h+cnt], esi
.text:0040C58D		       mov     [ebp+514h+lpBuffer], eax
.text:0040C590		       mov     [ebp+514h+charcount], esi
.text:0040C593		       mov     [ebp+514h+lfcount], esi
.text:0040C596		       jnz     short loc_40C59F
.text:0040C598		       xor     eax, eax
.text:0040C59A		       jmp     loc_40CB6F
.text:0040C59F ; ---------------------------------------------------------------------------
.text:0040C59F
.text:0040C59F loc_40C59F:			       ; CODE XREF: __write_nolock+33j
.text:0040C59F		       cmp     eax, esi
.text:0040C5A1		       jnz     short loc_40C5CA
.text:0040C5A3		       call    ___doserrno
.text:0040C5A8		       mov     [eax], esi
.text:0040C5AA		       call    __errno
.text:0040C5AF		       push    esi	       ; pReserved
.text:0040C5B0		       push    esi	       ; nLine
.text:0040C5B1		       push    esi	       ; pszFile
.text:0040C5B2		       push    esi	       ; pszFunction
.text:0040C5B3		       push    esi	       ; pszExpression
.text:0040C5B4		       mov     dword ptr [eax],	16h
.text:0040C5BA		       call    __invalid_parameter
.text:0040C5BF		       add     esp, 14h
.text:0040C5C2		       or      eax, 0FFFFFFFFh
.text:0040C5C5		       jmp     loc_40CB6F
.text:0040C5CA ; ---------------------------------------------------------------------------
.text:0040C5CA
.text:0040C5CA loc_40C5CA:			       ; CODE XREF: __write_nolock+3Ej
.text:0040C5CA		       push    ebx
.text:0040C5CB		       push    edi
.text:0040C5CC		       mov     edi, [ebp+514h+fh]
.text:0040C5D2		       mov     eax, edi
.text:0040C5D4		       sar     eax, 5
.text:0040C5D7		       lea     esi, ds:423F00h[eax*4]
.text:0040C5DE		       mov     eax, [esi]
.text:0040C5E0		       and     edi, 1Fh
.text:0040C5E3		       shl     edi, 6
.text:0040C5E6		       add     eax, edi
.text:0040C5E8		       mov     bl, [eax+24h]
.text:0040C5EB		       add     bl, bl
.text:0040C5ED		       sar     bl, 1
.text:0040C5EF		       cmp     bl, 2
.text:0040C5F2		       mov     [ebp+514h+var_584], esi
.text:0040C5F5		       mov     [ebp+514h+tmode], bl
.text:0040C5F8		       jz      short loc_40C5FF
.text:0040C5FA		       cmp     bl, 1
.text:0040C5FD		       jnz     short loc_40C632
.text:0040C5FF
.text:0040C5FF loc_40C5FF:			       ; CODE XREF: __write_nolock+95j
.text:0040C5FF		       mov     ecx, [ebp+514h+cnt]
.text:0040C605		       not     ecx
.text:0040C607		       test    cl, 1
.text:0040C60A		       jnz     short loc_40C632
.text:0040C60C		       call    ___doserrno
.text:0040C611		       xor     esi, esi
.text:0040C613		       mov     [eax], esi
.text:0040C615		       call    __errno
.text:0040C61A		       push    esi	       ; pReserved
.text:0040C61B		       push    esi	       ; nLine
.text:0040C61C		       push    esi	       ; pszFile
.text:0040C61D		       push    esi	       ; pszFunction
.text:0040C61E		       push    esi	       ; pszExpression
.text:0040C61F		       mov     dword ptr [eax],	16h
.text:0040C625		       call    __invalid_parameter
.text:0040C62A		       add     esp, 14h
.text:0040C62D		       jmp     loc_40CB62
.text:0040C632 ; ---------------------------------------------------------------------------
.text:0040C632
.text:0040C632 loc_40C632:			       ; CODE XREF: __write_nolock+9Aj
.text:0040C632					       ; __write_nolock+A7j
.text:0040C632		       test    byte ptr	[eax+4], 20h
.text:0040C636		       jz      short loc_40C64C
.text:0040C638		       push    2	       ; mthd
.text:0040C63A		       push    0
.text:0040C63C		       push    0	       ; pos
.text:0040C63E		       push    [ebp+514h+fh]   ; fh
.text:0040C644		       call    __lseeki64_nolock
.text:0040C649		       add     esp, 10h
.text:0040C64C
.text:0040C64C loc_40C64C:			       ; CODE XREF: __write_nolock+D3j
.text:0040C64C		       push    [ebp+514h+fh]   ; fh
.text:0040C652		       call    __isatty
.text:0040C657		       test    eax, eax
.text:0040C659		       pop     ecx
.text:0040C65A		       jz      loc_40C899
.text:0040C660		       mov     eax, [esi]
.text:0040C662		       test    byte ptr	[edi+eax+4], 80h
.text:0040C667		       jz      loc_40C899
.text:0040C66D		       call    __getptd
.text:0040C672		       mov     eax, [eax+6Ch]
.text:0040C675		       xor     ecx, ecx
.text:0040C677		       cmp     [eax+14h], ecx
.text:0040C67A		       lea     eax, [ebp+514h+consoleCP]
.text:0040C67D		       setz    cl
.text:0040C680		       push    eax	       ; lpMode
.text:0040C681		       mov     eax, [esi]
.text:0040C683		       push    dword ptr [edi+eax] ; hConsoleHandle
.text:0040C686		       mov     [ebp+514h+bCR], ecx
.text:0040C689		       call    ds:__imp__GetConsoleMode@8 ; GetConsoleMode(x,x)
.text:0040C68F		       test    eax, eax
.text:0040C691		       jz      loc_40C899
.text:0040C697		       xor     ecx, ecx
.text:0040C699		       cmp     [ebp+514h+bCR], ecx
.text:0040C69C		       jz      short loc_40C6A6
.text:0040C69E		       test    bl, bl
.text:0040C6A0		       jz      loc_40C89B
.text:0040C6A6
.text:0040C6A6 loc_40C6A6:			       ; CODE XREF: __write_nolock+139j
.text:0040C6A6		       call    ds:__imp__GetConsoleCP@0	; GetConsoleCP()
.text:0040C6AC		       mov     ebx, [ebp+514h+lpBuffer]
.text:0040C6AF		       mov     [ebp+514h+consoleCP], eax
.text:0040C6B2		       xor     eax, eax
.text:0040C6B4		       cmp     [ebp+514h+cnt], eax
.text:0040C6BA		       mov     [ebp+514h+p], eax
.text:0040C6BD		       jbe     loc_40CB0A
.text:0040C6C3		       mov     [ebp+514h+pu], eax
.text:0040C6C6
.text:0040C6C6 loc_40C6C6:			       ; CODE XREF: __write_nolock+315j
.text:0040C6C6		       mov     al, [ebp+514h+tmode]
.text:0040C6C9		       test    al, al
.text:0040C6CB		       jnz     loc_40C80E
.text:0040C6D1		       mov     cl, [ebx]
.text:0040C6D3		       mov     esi, [ebp+514h+var_584]
.text:0040C6D6		       xor     eax, eax
.text:0040C6D8		       cmp     cl, 0Ah
.text:0040C6DB		       setz    al
.text:0040C6DE		       mov     [ebp+514h+bCR], eax
.text:0040C6E1		       mov     eax, [esi]
.text:0040C6E3		       add     eax, edi
.text:0040C6E5		       cmp     dword ptr [eax+38h], 0
.text:0040C6E9		       jz      short loc_40C709
.text:0040C6EB		       mov     dl, [eax+34h]
.text:0040C6EE		       mov     [ebp+514h+mboutbuf], dl
.text:0040C6F4		       mov     [ebp+514h+mboutbuf+1], cl
.text:0040C6FA		       and     dword ptr [eax+38h], 0
.text:0040C6FE		       push    2
.text:0040C700		       lea     eax, [ebp+514h+mboutbuf]
.text:0040C706		       push    eax
.text:0040C707		       jmp     short loc_40C74E
.text:0040C709 ; ---------------------------------------------------------------------------
.text:0040C709
.text:0040C709 loc_40C709:			       ; CODE XREF: __write_nolock+186j
.text:0040C709		       movsx   eax, cl
.text:0040C70C		       push    eax	       ; c
.text:0040C70D		       call    _isleadbyte
.text:0040C712		       test    eax, eax
.text:0040C714		       pop     ecx
.text:0040C715		       jz      short loc_40C74B
.text:0040C717		       mov     ecx, [ebp+514h+lpBuffer]
.text:0040C71A		       sub     ecx, ebx
.text:0040C71C		       add     ecx, [ebp+514h+cnt]
.text:0040C722		       xor     eax, eax
.text:0040C724		       inc     eax
.text:0040C725		       cmp     ecx, eax
.text:0040C727		       jbe     loc_40C883
.text:0040C72D		       push    2	       ; n
.text:0040C72F		       lea     eax, [ebp+514h+tmpchar]
.text:0040C732		       push    ebx	       ; s
.text:0040C733		       push    eax	       ; pwc
.text:0040C734		       call    _mbtowc
.text:0040C739		       add     esp, 0Ch
.text:0040C73C		       cmp     eax, 0FFFFFFFFh
.text:0040C73F		       jz      loc_40CB04
.text:0040C745		       inc     ebx
.text:0040C746		       inc     [ebp+514h+pu]
.text:0040C749		       jmp     short loc_40C763
.text:0040C74B ; ---------------------------------------------------------------------------
.text:0040C74B
.text:0040C74B loc_40C74B:			       ; CODE XREF: __write_nolock+1B2j
.text:0040C74B		       push    1	       ; n
.text:0040C74D		       push    ebx	       ; s
.text:0040C74E
.text:0040C74E loc_40C74E:			       ; CODE XREF: __write_nolock+1A4j
.text:0040C74E		       lea     eax, [ebp+514h+tmpchar]
.text:0040C751		       push    eax	       ; pwc
.text:0040C752		       call    _mbtowc
.text:0040C757		       add     esp, 0Ch
.text:0040C75A		       cmp     eax, 0FFFFFFFFh
.text:0040C75D		       jz      loc_40CB04
.text:0040C763
.text:0040C763 loc_40C763:			       ; CODE XREF: __write_nolock+1E6j
.text:0040C763		       xor     eax, eax
.text:0040C765		       push    eax	       ; lpUsedDefaultChar
.text:0040C766		       push    eax	       ; lpDefaultChar
.text:0040C767		       push    5	       ; cbMultiByte
.text:0040C769		       lea     ecx, [ebp+514h+mboutbuf]
.text:0040C76F		       push    ecx	       ; lpMultiByteStr
.text:0040C770		       push    1	       ; cchWideChar
.text:0040C772		       lea     ecx, [ebp+514h+tmpchar]
.text:0040C775		       push    ecx	       ; lpWideCharStr
.text:0040C776		       push    eax	       ; dwFlags
.text:0040C777		       push    [ebp+514h+consoleCP] ; CodePage
.text:0040C77A		       inc     ebx
.text:0040C77B		       inc     [ebp+514h+pu]
.text:0040C77E		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040C784		       mov     esi, eax
.text:0040C786		       test    esi, esi
.text:0040C788		       jz      loc_40CB04
.text:0040C78E		       push    0	       ; lpOverlapped
.text:0040C790		       lea     eax, [ebp+514h+p]
.text:0040C793		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C794		       push    esi	       ; nNumberOfBytesToWrite
.text:0040C795		       lea     eax, [ebp+514h+mboutbuf]
.text:0040C79B		       push    eax	       ; lpBuffer
.text:0040C79C		       mov     eax, [ebp+514h+var_584]
.text:0040C79F		       mov     eax, [eax]
.text:0040C7A1		       push    dword ptr [edi+eax] ; hFile
.text:0040C7A4		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C7AA		       test    eax, eax
.text:0040C7AC		       jz      loc_40CAFB
.text:0040C7B2		       mov     eax, [ebp+514h+pu]
.text:0040C7B5		       mov     ecx, [ebp+514h+lfcount]
.text:0040C7B8		       add     eax, ecx
.text:0040C7BA		       cmp     [ebp+514h+p], esi
.text:0040C7BD		       mov     [ebp+514h+charcount], eax
.text:0040C7C0		       jl      loc_40CB04
.text:0040C7C6		       cmp     [ebp+514h+bCR], 0
.text:0040C7CA		       jz      loc_40C86F
.text:0040C7D0		       push    0	       ; lpOverlapped
.text:0040C7D2		       lea     eax, [ebp+514h+p]
.text:0040C7D5		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C7D6		       push    1	       ; nNumberOfBytesToWrite
.text:0040C7D8		       lea     eax, [ebp+514h+mboutbuf]
.text:0040C7DE		       push    eax	       ; lpBuffer
.text:0040C7DF		       mov     eax, [ebp+514h+var_584]
.text:0040C7E2		       mov     eax, [eax]
.text:0040C7E4		       mov     [ebp+514h+mboutbuf], 0Dh
.text:0040C7EB		       push    dword ptr [edi+eax] ; hFile
.text:0040C7EE		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C7F4		       test    eax, eax
.text:0040C7F6		       jz      loc_40CAFB
.text:0040C7FC		       cmp     [ebp+514h+p], 1
.text:0040C800		       jl      loc_40CB04
.text:0040C806		       inc     [ebp+514h+lfcount]
.text:0040C809		       inc     [ebp+514h+charcount]
.text:0040C80C		       jmp     short loc_40C86F
.text:0040C80E ; ---------------------------------------------------------------------------
.text:0040C80E
.text:0040C80E loc_40C80E:			       ; CODE XREF: __write_nolock+168j
.text:0040C80E		       cmp     al, 1
.text:0040C810		       jz      short loc_40C816
.text:0040C812		       cmp     al, 2
.text:0040C814		       jnz     short loc_40C82E
.text:0040C816
.text:0040C816 loc_40C816:			       ; CODE XREF: __write_nolock+2ADj
.text:0040C816		       movzx   esi, word ptr [ebx]
.text:0040C819		       xor     ecx, ecx
.text:0040C81B		       cmp     si, 0Ah
.text:0040C81F		       setz    cl
.text:0040C822		       inc     ebx
.text:0040C823		       inc     ebx
.text:0040C824		       add     [ebp+514h+pu], 2
.text:0040C828		       mov     [ebp+514h+tmpchar], esi
.text:0040C82B		       mov     [ebp+514h+bCR], ecx
.text:0040C82E
.text:0040C82E loc_40C82E:			       ; CODE XREF: __write_nolock+2B1j
.text:0040C82E		       cmp     al, 1
.text:0040C830		       jz      short loc_40C836
.text:0040C832		       cmp     al, 2
.text:0040C834		       jnz     short loc_40C86F
.text:0040C836
.text:0040C836 loc_40C836:			       ; CODE XREF: __write_nolock+2CDj
.text:0040C836		       push    [ebp+514h+tmpchar] ; ch
.text:0040C839		       call    __putwch_nolock
.text:0040C83E		       cmp     ax, word	ptr [ebp+514h+tmpchar]
.text:0040C842		       pop     ecx
.text:0040C843		       jnz     loc_40CAFB
.text:0040C849		       inc     [ebp+514h+charcount]
.text:0040C84C		       cmp     [ebp+514h+bCR], 0
.text:0040C850		       jz      short loc_40C86F
.text:0040C852		       push    0Dh
.text:0040C854		       pop     eax
.text:0040C855		       push    eax	       ; ch
.text:0040C856		       mov     [ebp+514h+tmpchar], eax
.text:0040C859		       call    __putwch_nolock
.text:0040C85E		       cmp     ax, word	ptr [ebp+514h+tmpchar]
.text:0040C862		       pop     ecx
.text:0040C863		       jnz     loc_40CAFB
.text:0040C869		       inc     [ebp+514h+charcount]
.text:0040C86C		       inc     [ebp+514h+lfcount]
.text:0040C86F
.text:0040C86F loc_40C86F:			       ; CODE XREF: __write_nolock+267j
.text:0040C86F					       ; __write_nolock+2A9j ...
.text:0040C86F		       mov     eax, [ebp+514h+cnt]
.text:0040C875		       cmp     [ebp+514h+pu], eax
.text:0040C878		       jb      loc_40C6C6
.text:0040C87E		       jmp     loc_40CB04
.text:0040C883 ; ---------------------------------------------------------------------------
.text:0040C883
.text:0040C883 loc_40C883:			       ; CODE XREF: __write_nolock+1C4j
.text:0040C883		       mov     ecx, [esi]
.text:0040C885		       mov     dl, [ebx]
.text:0040C887		       inc     [ebp+514h+charcount]
.text:0040C88A		       mov     [edi+ecx+34h], dl
.text:0040C88E		       mov     ecx, [esi]
.text:0040C890		       mov     [edi+ecx+38h], eax
.text:0040C894		       jmp     loc_40CB04
.text:0040C899 ; ---------------------------------------------------------------------------
.text:0040C899
.text:0040C899 loc_40C899:			       ; CODE XREF: __write_nolock+F7j
.text:0040C899					       ; __write_nolock+104j ...
.text:0040C899		       xor     ecx, ecx
.text:0040C89B
.text:0040C89B loc_40C89B:			       ; CODE XREF: __write_nolock+13Dj
.text:0040C89B		       mov     eax, [esi]
.text:0040C89D		       add     eax, edi
.text:0040C89F		       test    byte ptr	[eax+4], 80h
.text:0040C8A3		       jz      loc_40CAD4
.text:0040C8A9		       test    bl, bl
.text:0040C8AB		       mov     eax, [ebp+514h+lpBuffer]
.text:0040C8AE		       mov     [ebp+514h+tmpchar], ecx
.text:0040C8B1		       jnz     loc_40C94D
.text:0040C8B7		       cmp     [ebp+514h+cnt], ecx
.text:0040C8BD		       mov     [ebp+514h+p], eax
.text:0040C8C0		       jbe     loc_40CB3A
.text:0040C8C6		       jmp     short loc_40C8CB
.text:0040C8C8 ; ---------------------------------------------------------------------------
.text:0040C8C8
.text:0040C8C8 loc_40C8C8:			       ; CODE XREF: __write_nolock+3E3j
.text:0040C8C8		       mov     esi, [ebp+514h+var_584]
.text:0040C8CB
.text:0040C8CB loc_40C8CB:			       ; CODE XREF: __write_nolock+363j
.text:0040C8CB		       mov     ecx, [ebp+514h+p]
.text:0040C8CE		       and     [ebp+514h+pu], 0
.text:0040C8D2		       sub     ecx, [ebp+514h+lpBuffer]
.text:0040C8D5		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C8D8
.text:0040C8D8 loc_40C8D8:			       ; CODE XREF: __write_nolock+3A2j
.text:0040C8D8		       cmp     ecx, [ebp+514h+cnt]
.text:0040C8DE		       jnb     short loc_40C907
.text:0040C8E0		       mov     edx, [ebp+514h+p]
.text:0040C8E3		       inc     [ebp+514h+p]
.text:0040C8E6		       mov     dl, [edx]
.text:0040C8E8		       inc     ecx
.text:0040C8E9		       cmp     dl, 0Ah
.text:0040C8EC		       jnz     short loc_40C8F8
.text:0040C8EE		       inc     [ebp+514h+lfcount]
.text:0040C8F1		       mov     byte ptr	[eax], 0Dh
.text:0040C8F4		       inc     eax
.text:0040C8F5		       inc     [ebp+514h+pu]
.text:0040C8F8
.text:0040C8F8 loc_40C8F8:			       ; CODE XREF: __write_nolock+389j
.text:0040C8F8		       mov     [eax], dl
.text:0040C8FA		       inc     eax
.text:0040C8FB		       inc     [ebp+514h+pu]
.text:0040C8FE		       cmp     [ebp+514h+pu], 400h
.text:0040C905		       jb      short loc_40C8D8
.text:0040C907
.text:0040C907 loc_40C907:			       ; CODE XREF: __write_nolock+37Bj
.text:0040C907		       mov     ebx, eax
.text:0040C909		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C90C		       sub     ebx, eax
.text:0040C90E		       push    0	       ; lpOverlapped
.text:0040C910		       lea     eax, [ebp+514h+written]
.text:0040C913		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C914		       push    ebx	       ; nNumberOfBytesToWrite
.text:0040C915		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C918		       push    eax	       ; lpBuffer
.text:0040C919		       mov     eax, [esi]
.text:0040C91B		       push    dword ptr [edi+eax] ; hFile
.text:0040C91E		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C924		       test    eax, eax
.text:0040C926		       jz      loc_40CAFB
.text:0040C92C		       mov     eax, [ebp+514h+written]
.text:0040C92F		       add     [ebp+514h+charcount], eax
.text:0040C932		       cmp     eax, ebx
.text:0040C934		       jl      loc_40CB04
.text:0040C93A		       mov     eax, [ebp+514h+p]
.text:0040C93D		       sub     eax, [ebp+514h+lpBuffer]
.text:0040C940		       cmp     eax, [ebp+514h+cnt]
.text:0040C946		       jb      short loc_40C8C8
.text:0040C948		       jmp     loc_40CB04
.text:0040C94D ; ---------------------------------------------------------------------------
.text:0040C94D
.text:0040C94D loc_40C94D:			       ; CODE XREF: __write_nolock+34Ej
.text:0040C94D		       cmp     bl, 2
.text:0040C950		       mov     [ebp+514h+pu], eax
.text:0040C953		       jnz     loc_40C9FC
.text:0040C959		       cmp     [ebp+514h+cnt], ecx
.text:0040C95F		       jbe     loc_40CB3A
.text:0040C965		       jmp     short loc_40C96A
.text:0040C967 ; ---------------------------------------------------------------------------
.text:0040C967
.text:0040C967 loc_40C967:			       ; CODE XREF: __write_nolock+48Ej
.text:0040C967		       mov     esi, [ebp+514h+var_584]
.text:0040C96A
.text:0040C96A loc_40C96A:			       ; CODE XREF: __write_nolock+402j
.text:0040C96A		       mov     ecx, [ebp+514h+pu]
.text:0040C96D		       and     [ebp+514h+p], 0
.text:0040C971		       sub     ecx, [ebp+514h+lpBuffer]
.text:0040C974		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C977
.text:0040C977 loc_40C977:			       ; CODE XREF: __write_nolock+44Dj
.text:0040C977		       cmp     ecx, [ebp+514h+cnt]
.text:0040C97D		       jnb     short loc_40C9B2
.text:0040C97F		       mov     edx, [ebp+514h+pu]
.text:0040C982		       add     [ebp+514h+pu], 2
.text:0040C986		       movzx   edx, word ptr [edx]
.text:0040C989		       inc     ecx
.text:0040C98A		       inc     ecx
.text:0040C98B		       cmp     dx, 0Ah
.text:0040C98F		       jnz     short loc_40C9A0
.text:0040C991		       add     [ebp+514h+lfcount], 2
.text:0040C995		       mov     word ptr	[eax], 0Dh
.text:0040C99A		       inc     eax
.text:0040C99B		       inc     eax
.text:0040C99C		       add     [ebp+514h+p], 2
.text:0040C9A0
.text:0040C9A0 loc_40C9A0:			       ; CODE XREF: __write_nolock+42Cj
.text:0040C9A0		       add     [ebp+514h+p], 2
.text:0040C9A4		       mov     [eax], dx
.text:0040C9A7		       inc     eax
.text:0040C9A8		       inc     eax
.text:0040C9A9		       cmp     [ebp+514h+p], 3FFh
.text:0040C9B0		       jb      short loc_40C977
.text:0040C9B2
.text:0040C9B2 loc_40C9B2:			       ; CODE XREF: __write_nolock+41Aj
.text:0040C9B2		       mov     ebx, eax
.text:0040C9B4		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C9B7		       sub     ebx, eax
.text:0040C9B9		       push    0	       ; lpOverlapped
.text:0040C9BB		       lea     eax, [ebp+514h+written]
.text:0040C9BE		       push    eax	       ; lpNumberOfBytesWritten
.text:0040C9BF		       push    ebx	       ; nNumberOfBytesToWrite
.text:0040C9C0		       lea     eax, [ebp+514h+utf8_buf]
.text:0040C9C3		       push    eax	       ; lpBuffer
.text:0040C9C4		       mov     eax, [esi]
.text:0040C9C6		       push    dword ptr [edi+eax] ; hFile
.text:0040C9C9		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040C9CF		       test    eax, eax
.text:0040C9D1		       jz      loc_40CAFB
.text:0040C9D7		       mov     eax, [ebp+514h+written]
.text:0040C9DA		       add     [ebp+514h+charcount], eax
.text:0040C9DD		       cmp     eax, ebx
.text:0040C9DF		       jl      loc_40CB04
.text:0040C9E5		       mov     eax, [ebp+514h+pu]
.text:0040C9E8		       sub     eax, [ebp+514h+lpBuffer]
.text:0040C9EB		       cmp     eax, [ebp+514h+cnt]
.text:0040C9F1		       jb      loc_40C967
.text:0040C9F7		       jmp     loc_40CB04
.text:0040C9FC ; ---------------------------------------------------------------------------
.text:0040C9FC
.text:0040C9FC loc_40C9FC:			       ; CODE XREF: __write_nolock+3F0j
.text:0040C9FC		       cmp     [ebp+514h+cnt], ecx
.text:0040CA02		       jbe     loc_40CB3A
.text:0040CA08
.text:0040CA08 loc_40CA08:			       ; CODE XREF: __write_nolock+569j
.text:0040CA08		       mov     ecx, [ebp+514h+pu]
.text:0040CA0B		       and     [ebp+514h+p], 0
.text:0040CA0F		       sub     ecx, [ebp+514h+lpBuffer]
.text:0040CA12		       push    2
.text:0040CA14		       lea     eax, [ebp+514h+utf16_buf]
.text:0040CA1A		       pop     esi
.text:0040CA1B
.text:0040CA1B loc_40CA1B:			       ; CODE XREF: __write_nolock+4EAj
.text:0040CA1B		       cmp     ecx, [ebp+514h+cnt]
.text:0040CA21		       jnb     short loc_40CA4F
.text:0040CA23		       mov     edx, [ebp+514h+pu]
.text:0040CA26		       movzx   edx, word ptr [edx]
.text:0040CA29		       add     [ebp+514h+pu], esi
.text:0040CA2C		       add     ecx, esi
.text:0040CA2E		       cmp     dx, 0Ah
.text:0040CA32		       jnz     short loc_40CA3E
.text:0040CA34		       mov     word ptr	[eax], 0Dh
.text:0040CA39		       add     eax, esi
.text:0040CA3B		       add     [ebp+514h+p], esi
.text:0040CA3E
.text:0040CA3E loc_40CA3E:			       ; CODE XREF: __write_nolock+4CFj
.text:0040CA3E		       add     [ebp+514h+p], esi
.text:0040CA41		       mov     [eax], dx
.text:0040CA44		       add     eax, esi
.text:0040CA46		       cmp     [ebp+514h+p], 152h
.text:0040CA4D		       jb      short loc_40CA1B
.text:0040CA4F
.text:0040CA4F loc_40CA4F:			       ; CODE XREF: __write_nolock+4BEj
.text:0040CA4F		       xor     esi, esi
.text:0040CA51		       push    esi	       ; lpUsedDefaultChar
.text:0040CA52		       push    esi	       ; lpDefaultChar
.text:0040CA53		       push    2ABh	       ; cbMultiByte
.text:0040CA58		       lea     ecx, [ebp+514h+utf8_buf+154h]
.text:0040CA5E		       push    ecx	       ; lpMultiByteStr
.text:0040CA5F		       lea     ecx, [ebp+514h+utf16_buf]
.text:0040CA65		       sub     eax, ecx
.text:0040CA67		       cdq
.text:0040CA68		       sub     eax, edx
.text:0040CA6A		       sar     eax, 1
.text:0040CA6C		       push    eax	       ; cchWideChar
.text:0040CA6D		       mov     eax, ecx
.text:0040CA6F		       push    eax	       ; lpWideCharStr
.text:0040CA70		       push    esi	       ; dwFlags
.text:0040CA71		       push    0FDE9h	       ; CodePage
.text:0040CA76		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040CA7C		       mov     ebx, eax
.text:0040CA7E		       cmp     ebx, esi
.text:0040CA80		       jz      short loc_40CAFB
.text:0040CA82
.text:0040CA82 loc_40CA82:			       ; CODE XREF: __write_nolock+549j
.text:0040CA82		       push    0	       ; lpOverlapped
.text:0040CA84		       lea     eax, [ebp+514h+written]
.text:0040CA87		       push    eax	       ; lpNumberOfBytesWritten
.text:0040CA88		       mov     eax, ebx
.text:0040CA8A		       sub     eax, esi
.text:0040CA8C		       push    eax	       ; nNumberOfBytesToWrite
.text:0040CA8D		       lea     eax, [ebp+esi+514h+utf8_buf+154h]
.text:0040CA94		       push    eax	       ; lpBuffer
.text:0040CA95		       mov     eax, [ebp+514h+var_584]
.text:0040CA98		       mov     eax, [eax]
.text:0040CA9A		       push    dword ptr [edi+eax] ; hFile
.text:0040CA9D		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040CAA3		       test    eax, eax
.text:0040CAA5		       jz      short loc_40CAB0
.text:0040CAA7		       add     esi, [ebp+514h+written]
.text:0040CAAA		       cmp     ebx, esi
.text:0040CAAC		       jg      short loc_40CA82
.text:0040CAAE		       jmp     short loc_40CAB9
.text:0040CAB0 ; ---------------------------------------------------------------------------
.text:0040CAB0
.text:0040CAB0 loc_40CAB0:			       ; CODE XREF: __write_nolock+542j
.text:0040CAB0		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040CAB6		       mov     [ebp+514h+tmpchar], eax
.text:0040CAB9
.text:0040CAB9 loc_40CAB9:			       ; CODE XREF: __write_nolock+54Bj
.text:0040CAB9		       cmp     ebx, esi
.text:0040CABB		       jg      short loc_40CB04
.text:0040CABD		       mov     eax, [ebp+514h+pu]
.text:0040CAC0		       sub     eax, [ebp+514h+lpBuffer]
.text:0040CAC3		       cmp     eax, [ebp+514h+cnt]
.text:0040CAC9		       mov     [ebp+514h+charcount], eax
.text:0040CACC		       jb      loc_40CA08
.text:0040CAD2		       jmp     short loc_40CB04
.text:0040CAD4 ; ---------------------------------------------------------------------------
.text:0040CAD4
.text:0040CAD4 loc_40CAD4:			       ; CODE XREF: __write_nolock+340j
.text:0040CAD4		       push    0	       ; lpOverlapped
.text:0040CAD6		       lea     ecx, [ebp+514h+written]
.text:0040CAD9		       push    ecx	       ; lpNumberOfBytesWritten
.text:0040CADA		       push    [ebp+514h+cnt]  ; nNumberOfBytesToWrite
.text:0040CAE0		       push    [ebp+514h+lpBuffer] ; lpBuffer
.text:0040CAE3		       push    dword ptr [eax] ; hFile
.text:0040CAE5		       call    ds:__imp__WriteFile@20 ;	WriteFile(x,x,x,x,x)
.text:0040CAEB		       test    eax, eax
.text:0040CAED		       jz      short loc_40CAFB
.text:0040CAEF		       mov     eax, [ebp+514h+written]
.text:0040CAF2		       and     [ebp+514h+tmpchar], 0
.text:0040CAF6		       mov     [ebp+514h+charcount], eax
.text:0040CAF9		       jmp     short loc_40CB04
.text:0040CAFB ; ---------------------------------------------------------------------------
.text:0040CAFB
.text:0040CAFB loc_40CAFB:			       ; CODE XREF: __write_nolock+249j
.text:0040CAFB					       ; __write_nolock+293j ...
.text:0040CAFB		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040CB01		       mov     [ebp+514h+tmpchar], eax
.text:0040CB04
.text:0040CB04 loc_40CB04:			       ; CODE XREF: __write_nolock+1DCj
.text:0040CB04					       ; __write_nolock+1FAj ...
.text:0040CB04		       cmp     [ebp+514h+charcount], 0
.text:0040CB08		       jnz     short loc_40CB67
.text:0040CB0A
.text:0040CB0A loc_40CB0A:			       ; CODE XREF: __write_nolock+15Aj
.text:0040CB0A		       cmp     [ebp+514h+tmpchar], 0
.text:0040CB0E		       jz      short loc_40CB37
.text:0040CB10		       push    5
.text:0040CB12		       pop     esi
.text:0040CB13		       cmp     [ebp+514h+tmpchar], esi
.text:0040CB16		       jnz     short loc_40CB2C
.text:0040CB18		       call    __errno
.text:0040CB1D		       mov     dword ptr [eax],	9
.text:0040CB23		       call    ___doserrno
.text:0040CB28		       mov     [eax], esi
.text:0040CB2A		       jmp     short loc_40CB62
.text:0040CB2C ; ---------------------------------------------------------------------------
.text:0040CB2C
.text:0040CB2C loc_40CB2C:			       ; CODE XREF: __write_nolock+5B3j
.text:0040CB2C		       push    [ebp+514h+tmpchar] ; oserrno
.text:0040CB2F		       call    __dosmaperr
.text:0040CB34		       pop     ecx
.text:0040CB35		       jmp     short loc_40CB62
.text:0040CB37 ; ---------------------------------------------------------------------------
.text:0040CB37
.text:0040CB37 loc_40CB37:			       ; CODE XREF: __write_nolock+5ABj
.text:0040CB37		       mov     esi, [ebp+514h+var_584]
.text:0040CB3A
.text:0040CB3A loc_40CB3A:			       ; CODE XREF: __write_nolock+35Dj
.text:0040CB3A					       ; __write_nolock+3FCj ...
.text:0040CB3A		       mov     eax, [esi]
.text:0040CB3C		       test    byte ptr	[edi+eax+4], 40h
.text:0040CB41		       jz      short loc_40CB4F
.text:0040CB43		       mov     eax, [ebp+514h+lpBuffer]
.text:0040CB46		       cmp     byte ptr	[eax], 1Ah
.text:0040CB49		       jnz     short loc_40CB4F
.text:0040CB4B		       xor     eax, eax
.text:0040CB4D		       jmp     short loc_40CB6D
.text:0040CB4F ; ---------------------------------------------------------------------------
.text:0040CB4F
.text:0040CB4F loc_40CB4F:			       ; CODE XREF: __write_nolock+5DEj
.text:0040CB4F					       ; __write_nolock+5E6j
.text:0040CB4F		       call    __errno
.text:0040CB54		       mov     dword ptr [eax],	1Ch
.text:0040CB5A		       call    ___doserrno
.text:0040CB5F		       and     dword ptr [eax],	0
.text:0040CB62
.text:0040CB62 loc_40CB62:			       ; CODE XREF: __write_nolock+CAj
.text:0040CB62					       ; __write_nolock+5C7j ...
.text:0040CB62		       or      eax, 0FFFFFFFFh
.text:0040CB65		       jmp     short loc_40CB6D
.text:0040CB67 ; ---------------------------------------------------------------------------
.text:0040CB67
.text:0040CB67 loc_40CB67:			       ; CODE XREF: __write_nolock+5A5j
.text:0040CB67		       mov     eax, [ebp+514h+charcount]
.text:0040CB6A		       sub     eax, [ebp+514h+lfcount]
.text:0040CB6D
.text:0040CB6D loc_40CB6D:			       ; CODE XREF: __write_nolock+5EAj
.text:0040CB6D					       ; __write_nolock+602j
.text:0040CB6D		       pop     edi
.text:0040CB6E		       pop     ebx
.text:0040CB6F
.text:0040CB6F loc_40CB6F:			       ; CODE XREF: __write_nolock+37j
.text:0040CB6F					       ; __write_nolock+62j
.text:0040CB6F		       mov     ecx, [ebp+514h+var_4]
.text:0040CB75		       xor     ecx, ebp
.text:0040CB77		       pop     esi
.text:0040CB78		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040CB7D		       add     ebp, 514h
.text:0040CB83		       leave
.text:0040CB84		       retn
.text:0040CB84 __write_nolock  endp
.text:0040CB84
.text:0040CB85
.text:0040CB85 ; =============== S U B R O U T I N E =======================================
.text:0040CB85
.text:0040CB85 ; Attributes: bp-based frame
.text:0040CB85
.text:0040CB85 ; int __cdecl _write(int	fh, const void *buf, unsigned int cnt)
.text:0040CB85 __write	       proc near	       ; CODE XREF: __flush+31p
.text:0040CB85					       ; __flsbuf+CBp ...
.text:0040CB85
.text:0040CB85 _Expr_val       = dword ptr -20h
.text:0040CB85 r	       = dword ptr -1Ch
.text:0040CB85 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040CB85 fh	       = dword ptr  8
.text:0040CB85 buf	       = dword ptr  0Ch
.text:0040CB85 cnt	       = dword ptr  10h
.text:0040CB85
.text:0040CB85		       push    10h
.text:0040CB87		       push    offset dword_421898
.text:0040CB8C		       call    __SEH_prolog4
.text:0040CB91		       mov     eax, [ebp+fh]
.text:0040CB94		       cmp     eax, 0FFFFFFFEh
.text:0040CB97		       jnz     short loc_40CBB4
.text:0040CB99		       call    ___doserrno
.text:0040CB9E		       and     dword ptr [eax],	0
.text:0040CBA1		       call    __errno
.text:0040CBA6		       mov     dword ptr [eax],	9
.text:0040CBAC
.text:0040CBAC loc_40CBAC:			       ; CODE XREF: __write+5Cj
.text:0040CBAC		       or      eax, 0FFFFFFFFh
.text:0040CBAF		       jmp     loc_40CC51
.text:0040CBB4 ; ---------------------------------------------------------------------------
.text:0040CBB4
.text:0040CBB4 loc_40CBB4:			       ; CODE XREF: __write+12j
.text:0040CBB4		       xor     edi, edi
.text:0040CBB6		       cmp     eax, edi
.text:0040CBB8		       jl      short loc_40CBC2
.text:0040CBBA		       cmp     eax, __nhandle
.text:0040CBC0		       jb      short loc_40CBE3
.text:0040CBC2
.text:0040CBC2 loc_40CBC2:			       ; CODE XREF: __write+33j
.text:0040CBC2					       ; __write+7Cj
.text:0040CBC2		       call    ___doserrno
.text:0040CBC7		       mov     [eax], edi
.text:0040CBC9		       call    __errno
.text:0040CBCE		       mov     dword ptr [eax],	9
.text:0040CBD4		       push    edi	       ; pReserved
.text:0040CBD5		       push    edi	       ; nLine
.text:0040CBD6		       push    edi	       ; pszFile
.text:0040CBD7		       push    edi	       ; pszFunction
.text:0040CBD8		       push    edi	       ; pszExpression
.text:0040CBD9		       call    __invalid_parameter
.text:0040CBDE		       add     esp, 14h
.text:0040CBE1		       jmp     short loc_40CBAC
.text:0040CBE3 ; ---------------------------------------------------------------------------
.text:0040CBE3
.text:0040CBE3 loc_40CBE3:			       ; CODE XREF: __write+3Bj
.text:0040CBE3		       mov     ecx, eax
.text:0040CBE5		       sar     ecx, 5
.text:0040CBE8		       lea     ebx, ds:423F00h[ecx*4]
.text:0040CBEF		       mov     esi, eax
.text:0040CBF1		       and     esi, 1Fh
.text:0040CBF4		       shl     esi, 6
.text:0040CBF7		       mov     ecx, [ebx]
.text:0040CBF9		       movzx   ecx, byte ptr [ecx+esi+4]
.text:0040CBFE		       and     ecx, 1
.text:0040CC01		       jz      short loc_40CBC2
.text:0040CC03		       push    eax	       ; fh
.text:0040CC04		       call    ___lock_fhandle
.text:0040CC09		       pop     ecx
.text:0040CC0A		       mov     [ebp+ms_exc.disabled], edi
.text:0040CC0D		       mov     eax, [ebx]
.text:0040CC0F		       test    byte ptr	[eax+esi+4], 1
.text:0040CC14		       jz      short loc_40CC2C
.text:0040CC16		       push    [ebp+cnt]       ; cnt
.text:0040CC19		       push    [ebp+buf]       ; buf
.text:0040CC1C		       push    [ebp+fh]	       ; fh
.text:0040CC1F		       call    __write_nolock
.text:0040CC24		       add     esp, 0Ch
.text:0040CC27		       mov     [ebp+r],	eax
.text:0040CC2A		       jmp     short loc_40CC42
.text:0040CC2C ; ---------------------------------------------------------------------------
.text:0040CC2C
.text:0040CC2C loc_40CC2C:			       ; CODE XREF: __write+8Fj
.text:0040CC2C		       call    __errno
.text:0040CC31		       mov     dword ptr [eax],	9
.text:0040CC37		       call    ___doserrno
.text:0040CC3C		       mov     [eax], edi
.text:0040CC3E		       or      [ebp+r],	0FFFFFFFFh
.text:0040CC42
.text:0040CC42 loc_40CC42:			       ; CODE XREF: __write+A5j
.text:0040CC42		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040CC49		       call    $LN12_8
.text:0040CC4E
.text:0040CC4E $LN15_3:
.text:0040CC4E		       mov     eax, [ebp+r]
.text:0040CC51
.text:0040CC51 loc_40CC51:			       ; CODE XREF: __write+2Aj
.text:0040CC51		       call    __SEH_epilog4
.text:0040CC56		       retn
.text:0040CC57 ; ---------------------------------------------------------------------------
.text:0040CC57
.text:0040CC57 $LN12_8:				       ; CODE XREF: __write+C4p
.text:0040CC57					       ; DATA XREF: .rdata:004218B0o
.text:0040CC57		       push    [ebp+fh]	       ; fh
.text:0040CC5A		       call    __unlock_fhandle
.text:0040CC5F		       pop     ecx
.text:0040CC60
.text:0040CC60 $LN13_5:
.text:0040CC60		       retn
.text:0040CC60 __write	       endp
.text:0040CC60
.text:0040CC61
.text:0040CC61 ; =============== S U B R O U T I N E =======================================
.text:0040CC61
.text:0040CC61 ; Attributes: bp-based frame
.text:0040CC61
.text:0040CC61 ; int __cdecl _commit(int filedes)
.text:0040CC61 __commit	       proc near	       ; CODE XREF: __fflush_nolock+31p
.text:0040CC61
.text:0040CC61 _Expr_val       = dword ptr -20h
.text:0040CC61 retval	       = dword ptr -1Ch
.text:0040CC61 ms_exc	       = CPPEH_RECORD ptr -18h
.text:0040CC61 filedes	       = dword ptr  8
.text:0040CC61
.text:0040CC61		       push    10h
.text:0040CC63		       push    offset dword_4218B8
.text:0040CC68		       call    __SEH_prolog4
.text:0040CC6D		       mov     eax, [ebp+filedes]
.text:0040CC70		       cmp     eax, 0FFFFFFFEh
.text:0040CC73		       jnz     short loc_40CC88
.text:0040CC75		       call    __errno
.text:0040CC7A		       mov     dword ptr [eax],	9
.text:0040CC80
.text:0040CC80 loc_40CC80:			       ; CODE XREF: __commit+4Dj
.text:0040CC80		       or      eax, 0FFFFFFFFh
.text:0040CC83		       jmp     loc_40CD32
.text:0040CC88 ; ---------------------------------------------------------------------------
.text:0040CC88
.text:0040CC88 loc_40CC88:			       ; CODE XREF: __commit+12j
.text:0040CC88		       xor     ebx, ebx
.text:0040CC8A		       cmp     eax, ebx
.text:0040CC8C		       jl      short loc_40CC96
.text:0040CC8E		       cmp     eax, __nhandle
.text:0040CC94		       jb      short loc_40CCB0
.text:0040CC96
.text:0040CC96 loc_40CC96:			       ; CODE XREF: __commit+2Bj
.text:0040CC96					       ; __commit+6Dj
.text:0040CC96		       call    __errno
.text:0040CC9B		       mov     dword ptr [eax],	9
.text:0040CCA1		       push    ebx	       ; pReserved
.text:0040CCA2		       push    ebx	       ; nLine
.text:0040CCA3		       push    ebx	       ; pszFile
.text:0040CCA4		       push    ebx	       ; pszFunction
.text:0040CCA5		       push    ebx	       ; pszExpression
.text:0040CCA6		       call    __invalid_parameter
.text:0040CCAB		       add     esp, 14h
.text:0040CCAE		       jmp     short loc_40CC80
.text:0040CCB0 ; ---------------------------------------------------------------------------
.text:0040CCB0
.text:0040CCB0 loc_40CCB0:			       ; CODE XREF: __commit+33j
.text:0040CCB0		       mov     ecx, eax
.text:0040CCB2		       sar     ecx, 5
.text:0040CCB5		       lea     edi, ds:423F00h[ecx*4]
.text:0040CCBC		       mov     esi, eax
.text:0040CCBE		       and     esi, 1Fh
.text:0040CCC1		       shl     esi, 6
.text:0040CCC4		       mov     ecx, [edi]
.text:0040CCC6		       movzx   ecx, byte ptr [esi+ecx+4]
.text:0040CCCB		       and     ecx, 1
.text:0040CCCE		       jz      short loc_40CC96
.text:0040CCD0		       push    eax	       ; fh
.text:0040CCD1		       call    ___lock_fhandle
.text:0040CCD6		       pop     ecx
.text:0040CCD7		       mov     [ebp+ms_exc.disabled], ebx
.text:0040CCDA		       mov     eax, [edi]
.text:0040CCDC		       test    byte ptr	[esi+eax+4], 1
.text:0040CCE1		       jz      short loc_40CD14
.text:0040CCE3		       push    [ebp+filedes]   ; fh
.text:0040CCE6		       call    __get_osfhandle
.text:0040CCEB		       pop     ecx
.text:0040CCEC		       push    eax	       ; hFile
.text:0040CCED		       call    ds:__imp__FlushFileBuffers@4 ; FlushFileBuffers(x)
.text:0040CCF3		       test    eax, eax
.text:0040CCF5		       jnz     short loc_40CD02
.text:0040CCF7		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040CCFD		       mov     [ebp+retval], eax
.text:0040CD00		       jmp     short loc_40CD05
.text:0040CD02 ; ---------------------------------------------------------------------------
.text:0040CD02
.text:0040CD02 loc_40CD02:			       ; CODE XREF: __commit+94j
.text:0040CD02		       mov     [ebp+retval], ebx
.text:0040CD05
.text:0040CD05 loc_40CD05:			       ; CODE XREF: __commit+9Fj
.text:0040CD05		       cmp     [ebp+retval], ebx
.text:0040CD08		       jz      short good
.text:0040CD0A		       call    ___doserrno
.text:0040CD0F		       mov     ecx, [ebp+retval]
.text:0040CD12		       mov     [eax], ecx
.text:0040CD14
.text:0040CD14 loc_40CD14:			       ; CODE XREF: __commit+80j
.text:0040CD14		       call    __errno
.text:0040CD19		       mov     dword ptr [eax],	9
.text:0040CD1F		       or      [ebp+retval], 0FFFFFFFFh
.text:0040CD23
.text:0040CD23 good:				       ; CODE XREF: __commit+A7j
.text:0040CD23		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0040CD2A		       call    $LN14_2
.text:0040CD2F
.text:0040CD2F $LN17_4:
.text:0040CD2F		       mov     eax, [ebp+retval]
.text:0040CD32
.text:0040CD32 loc_40CD32:			       ; CODE XREF: __commit+22j
.text:0040CD32		       call    __SEH_epilog4
.text:0040CD37		       retn
.text:0040CD38 ; ---------------------------------------------------------------------------
.text:0040CD38
.text:0040CD38 $LN14_2:				       ; CODE XREF: __commit+C9p
.text:0040CD38					       ; DATA XREF: .rdata:004218D0o
.text:0040CD38		       push    [ebp+filedes]   ; fh
.text:0040CD3B		       call    __unlock_fhandle
.text:0040CD40		       pop     ecx
.text:0040CD41
.text:0040CD41 $LN15_4:
.text:0040CD41		       retn
.text:0040CD41 __commit	       endp
.text:0040CD41
.text:0040CD42
.text:0040CD42 ; =============== S U B R O U T I N E =======================================
.text:0040CD42
.text:0040CD42 ; Attributes: bp-based frame
.text:0040CD42
.text:0040CD42 ; int __cdecl x_ismbbtype_l(localeinfo_struct *plocinfo,	unsigned int tst, int cmask, int kmask)
.text:0040CD42 x_ismbbtype_l   proc near	       ; CODE XREF: __ismbbkalnum_l+Cp
.text:0040CD42					       ; __ismbbkalnum+Ap ...
.text:0040CD42
.text:0040CD42 _loc_update     = _LocaleUpdate ptr -10h
.text:0040CD42 plocinfo	       = dword ptr  8
.text:0040CD42 tst	       = dword ptr  0Ch
.text:0040CD42 cmask	       = dword ptr  10h
.text:0040CD42 kmask	       = dword ptr  14h
.text:0040CD42
.text:0040CD42		       push    ebp
.text:0040CD43		       mov     ebp, esp
.text:0040CD45		       sub     esp, 10h
.text:0040CD48		       push    [ebp+plocinfo]  ; plocinfo
.text:0040CD4B		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040CD4E		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040CD53		       movzx   eax, byte ptr [ebp+tst]
.text:0040CD57		       mov     ecx, [ebp+_loc_update.localeinfo.mbcinfo]
.text:0040CD5A		       mov     dl, byte	ptr [ebp+kmask]
.text:0040CD5D		       test    [ecx+eax+1Dh], dl
.text:0040CD61		       jnz     short loc_40CD81
.text:0040CD63		       cmp     [ebp+cmask], 0
.text:0040CD67		       jz      short loc_40CD7B
.text:0040CD69		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:0040CD6C		       mov     ecx, [ecx+0C8h]
.text:0040CD72		       movzx   eax, word ptr [ecx+eax*2]
.text:0040CD76		       and     eax, [ebp+cmask]
.text:0040CD79		       jmp     short loc_40CD7D
.text:0040CD7B ; ---------------------------------------------------------------------------
.text:0040CD7B
.text:0040CD7B loc_40CD7B:			       ; CODE XREF: x_ismbbtype_l+25j
.text:0040CD7B		       xor     eax, eax
.text:0040CD7D
.text:0040CD7D loc_40CD7D:			       ; CODE XREF: x_ismbbtype_l+37j
.text:0040CD7D		       test    eax, eax
.text:0040CD7F		       jz      short loc_40CD84
.text:0040CD81
.text:0040CD81 loc_40CD81:			       ; CODE XREF: x_ismbbtype_l+1Fj
.text:0040CD81		       xor     eax, eax
.text:0040CD83		       inc     eax
.text:0040CD84
.text:0040CD84 loc_40CD84:			       ; CODE XREF: x_ismbbtype_l+3Dj
.text:0040CD84		       cmp     [ebp+_loc_update.updated], 0
.text:0040CD88		       jz      short locret_40CD91
.text:0040CD8A		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040CD8D		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040CD91
.text:0040CD91 locret_40CD91:			       ; CODE XREF: x_ismbbtype_l+46j
.text:0040CD91		       leave
.text:0040CD92		       retn
.text:0040CD92 x_ismbbtype_l   endp
.text:0040CD92
.text:0040CD93
.text:0040CD93 ; =============== S U B R O U T I N E =======================================
.text:0040CD93
.text:0040CD93
.text:0040CD93 ; int __cdecl _ismbbkalnum_l(unsigned int tst, localeinfo_struct	*plocinfo)
.text:0040CD93 __ismbbkalnum_l proc near
.text:0040CD93
.text:0040CD93 tst	       = dword ptr  4
.text:0040CD93 plocinfo	       = dword ptr  8
.text:0040CD93
.text:0040CD93		       push    1	       ; kmask
.text:0040CD95		       push    0	       ; cmask
.text:0040CD97		       push    [esp+8+tst]     ; tst
.text:0040CD9B		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CD9F		       call    x_ismbbtype_l
.text:0040CDA4		       add     esp, 10h
.text:0040CDA7		       retn
.text:0040CDA7 __ismbbkalnum_l endp
.text:0040CDA7
.text:0040CDA8
.text:0040CDA8 ; =============== S U B R O U T I N E =======================================
.text:0040CDA8
.text:0040CDA8
.text:0040CDA8 ; int __cdecl _ismbbkalnum(unsigned int tst)
.text:0040CDA8 __ismbbkalnum   proc near
.text:0040CDA8
.text:0040CDA8 tst	       = dword ptr  4
.text:0040CDA8
.text:0040CDA8		       push    1	       ; kmask
.text:0040CDAA		       push    0	       ; cmask
.text:0040CDAC		       push    [esp+8+tst]     ; tst
.text:0040CDB0		       push    0	       ; plocinfo
.text:0040CDB2		       call    x_ismbbtype_l
.text:0040CDB7		       add     esp, 10h
.text:0040CDBA		       retn
.text:0040CDBA __ismbbkalnum   endp
.text:0040CDBA
.text:0040CDBB
.text:0040CDBB ; =============== S U B R O U T I N E =======================================
.text:0040CDBB
.text:0040CDBB
.text:0040CDBB ; int __cdecl _ismbbkprint_l(unsigned int tst, localeinfo_struct	*plocinfo)
.text:0040CDBB __ismbbkprint_l proc near
.text:0040CDBB
.text:0040CDBB tst	       = dword ptr  4
.text:0040CDBB plocinfo	       = dword ptr  8
.text:0040CDBB
.text:0040CDBB		       push    3	       ; kmask
.text:0040CDBD		       push    0	       ; cmask
.text:0040CDBF		       push    [esp+8+tst]     ; tst
.text:0040CDC3		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CDC7		       call    x_ismbbtype_l
.text:0040CDCC		       add     esp, 10h
.text:0040CDCF		       retn
.text:0040CDCF __ismbbkprint_l endp
.text:0040CDCF
.text:0040CDD0
.text:0040CDD0 ; =============== S U B R O U T I N E =======================================
.text:0040CDD0
.text:0040CDD0
.text:0040CDD0 ; int __cdecl _ismbbkprint(unsigned int tst)
.text:0040CDD0 __ismbbkprint   proc near
.text:0040CDD0
.text:0040CDD0 tst	       = dword ptr  4
.text:0040CDD0
.text:0040CDD0		       push    3	       ; kmask
.text:0040CDD2		       push    0	       ; cmask
.text:0040CDD4		       push    [esp+8+tst]     ; tst
.text:0040CDD8		       push    0	       ; plocinfo
.text:0040CDDA		       call    x_ismbbtype_l
.text:0040CDDF		       add     esp, 10h
.text:0040CDE2		       retn
.text:0040CDE2 __ismbbkprint   endp
.text:0040CDE2
.text:0040CDE3
.text:0040CDE3 ; =============== S U B R O U T I N E =======================================
.text:0040CDE3
.text:0040CDE3
.text:0040CDE3 ; int __cdecl _ismbbkpunct_l(unsigned int tst, localeinfo_struct	*plocinfo)
.text:0040CDE3 __ismbbkpunct_l proc near
.text:0040CDE3
.text:0040CDE3 tst	       = dword ptr  4
.text:0040CDE3 plocinfo	       = dword ptr  8
.text:0040CDE3
.text:0040CDE3		       push    2	       ; kmask
.text:0040CDE5		       push    0	       ; cmask
.text:0040CDE7		       push    [esp+8+tst]     ; tst
.text:0040CDEB		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CDEF		       call    x_ismbbtype_l
.text:0040CDF4		       add     esp, 10h
.text:0040CDF7		       retn
.text:0040CDF7 __ismbbkpunct_l endp
.text:0040CDF7
.text:0040CDF8
.text:0040CDF8 ; =============== S U B R O U T I N E =======================================
.text:0040CDF8
.text:0040CDF8
.text:0040CDF8 ; int __cdecl _ismbbkpunct(unsigned int tst)
.text:0040CDF8 __ismbbkpunct   proc near
.text:0040CDF8
.text:0040CDF8 tst	       = dword ptr  4
.text:0040CDF8
.text:0040CDF8		       push    2	       ; kmask
.text:0040CDFA		       push    0	       ; cmask
.text:0040CDFC		       push    [esp+8+tst]     ; tst
.text:0040CE00		       push    0	       ; plocinfo
.text:0040CE02		       call    x_ismbbtype_l
.text:0040CE07		       add     esp, 10h
.text:0040CE0A		       retn
.text:0040CE0A __ismbbkpunct   endp
.text:0040CE0A
.text:0040CE0B
.text:0040CE0B ; =============== S U B R O U T I N E =======================================
.text:0040CE0B
.text:0040CE0B
.text:0040CE0B ; int __cdecl _ismbbalnum_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CE0B __ismbbalnum_l  proc near
.text:0040CE0B
.text:0040CE0B tst	       = dword ptr  4
.text:0040CE0B plocinfo	       = dword ptr  8
.text:0040CE0B
.text:0040CE0B		       push    1	       ; kmask
.text:0040CE0D		       push    107h	       ; cmask
.text:0040CE12		       push    [esp+8+tst]     ; tst
.text:0040CE16		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CE1A		       call    x_ismbbtype_l
.text:0040CE1F		       add     esp, 10h
.text:0040CE22		       retn
.text:0040CE22 __ismbbalnum_l  endp
.text:0040CE22
.text:0040CE23
.text:0040CE23 ; =============== S U B R O U T I N E =======================================
.text:0040CE23
.text:0040CE23
.text:0040CE23 ; int __cdecl _ismbbalnum(unsigned int tst)
.text:0040CE23 __ismbbalnum    proc near
.text:0040CE23
.text:0040CE23 tst	       = dword ptr  4
.text:0040CE23
.text:0040CE23		       push    1	       ; kmask
.text:0040CE25		       push    107h	       ; cmask
.text:0040CE2A		       push    [esp+8+tst]     ; tst
.text:0040CE2E		       push    0	       ; plocinfo
.text:0040CE30		       call    x_ismbbtype_l
.text:0040CE35		       add     esp, 10h
.text:0040CE38		       retn
.text:0040CE38 __ismbbalnum    endp
.text:0040CE38
.text:0040CE39
.text:0040CE39 ; =============== S U B R O U T I N E =======================================
.text:0040CE39
.text:0040CE39
.text:0040CE39 ; int __cdecl _ismbbalpha_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CE39 __ismbbalpha_l  proc near
.text:0040CE39
.text:0040CE39 tst	       = dword ptr  4
.text:0040CE39 plocinfo	       = dword ptr  8
.text:0040CE39
.text:0040CE39		       push    1	       ; kmask
.text:0040CE3B		       push    103h	       ; cmask
.text:0040CE40		       push    [esp+8+tst]     ; tst
.text:0040CE44		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CE48		       call    x_ismbbtype_l
.text:0040CE4D		       add     esp, 10h
.text:0040CE50		       retn
.text:0040CE50 __ismbbalpha_l  endp
.text:0040CE50
.text:0040CE51
.text:0040CE51 ; =============== S U B R O U T I N E =======================================
.text:0040CE51
.text:0040CE51
.text:0040CE51 ; int __cdecl _ismbbalpha(unsigned int tst)
.text:0040CE51 __ismbbalpha    proc near
.text:0040CE51
.text:0040CE51 tst	       = dword ptr  4
.text:0040CE51
.text:0040CE51		       push    1	       ; kmask
.text:0040CE53		       push    103h	       ; cmask
.text:0040CE58		       push    [esp+8+tst]     ; tst
.text:0040CE5C		       push    0	       ; plocinfo
.text:0040CE5E		       call    x_ismbbtype_l
.text:0040CE63		       add     esp, 10h
.text:0040CE66		       retn
.text:0040CE66 __ismbbalpha    endp
.text:0040CE66
.text:0040CE67
.text:0040CE67 ; =============== S U B R O U T I N E =======================================
.text:0040CE67
.text:0040CE67
.text:0040CE67 ; int __cdecl _ismbbgraph_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CE67 __ismbbgraph_l  proc near
.text:0040CE67
.text:0040CE67 tst	       = dword ptr  4
.text:0040CE67 plocinfo	       = dword ptr  8
.text:0040CE67
.text:0040CE67		       push    3	       ; kmask
.text:0040CE69		       push    117h	       ; cmask
.text:0040CE6E		       push    [esp+8+tst]     ; tst
.text:0040CE72		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CE76		       call    x_ismbbtype_l
.text:0040CE7B		       add     esp, 10h
.text:0040CE7E		       retn
.text:0040CE7E __ismbbgraph_l  endp
.text:0040CE7E
.text:0040CE7F
.text:0040CE7F ; =============== S U B R O U T I N E =======================================
.text:0040CE7F
.text:0040CE7F
.text:0040CE7F ; int __cdecl _ismbbgraph(unsigned int tst)
.text:0040CE7F __ismbbgraph    proc near
.text:0040CE7F
.text:0040CE7F tst	       = dword ptr  4
.text:0040CE7F
.text:0040CE7F		       push    3	       ; kmask
.text:0040CE81		       push    117h	       ; cmask
.text:0040CE86		       push    [esp+8+tst]     ; tst
.text:0040CE8A		       push    0	       ; plocinfo
.text:0040CE8C		       call    x_ismbbtype_l
.text:0040CE91		       add     esp, 10h
.text:0040CE94		       retn
.text:0040CE94 __ismbbgraph    endp
.text:0040CE94
.text:0040CE95
.text:0040CE95 ; =============== S U B R O U T I N E =======================================
.text:0040CE95
.text:0040CE95
.text:0040CE95 ; int __cdecl _ismbbprint_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CE95 __ismbbprint_l  proc near
.text:0040CE95
.text:0040CE95 tst	       = dword ptr  4
.text:0040CE95 plocinfo	       = dword ptr  8
.text:0040CE95
.text:0040CE95		       push    3	       ; kmask
.text:0040CE97		       push    157h	       ; cmask
.text:0040CE9C		       push    [esp+8+tst]     ; tst
.text:0040CEA0		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CEA4		       call    x_ismbbtype_l
.text:0040CEA9		       add     esp, 10h
.text:0040CEAC		       retn
.text:0040CEAC __ismbbprint_l  endp
.text:0040CEAC
.text:0040CEAD
.text:0040CEAD ; =============== S U B R O U T I N E =======================================
.text:0040CEAD
.text:0040CEAD
.text:0040CEAD ; int __cdecl _ismbbprint(unsigned int tst)
.text:0040CEAD __ismbbprint    proc near
.text:0040CEAD
.text:0040CEAD tst	       = dword ptr  4
.text:0040CEAD
.text:0040CEAD		       push    3	       ; kmask
.text:0040CEAF		       push    157h	       ; cmask
.text:0040CEB4		       push    [esp+8+tst]     ; tst
.text:0040CEB8		       push    0	       ; plocinfo
.text:0040CEBA		       call    x_ismbbtype_l
.text:0040CEBF		       add     esp, 10h
.text:0040CEC2		       retn
.text:0040CEC2 __ismbbprint    endp
.text:0040CEC2
.text:0040CEC3
.text:0040CEC3 ; =============== S U B R O U T I N E =======================================
.text:0040CEC3
.text:0040CEC3
.text:0040CEC3 ; int __cdecl _ismbbpunct_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CEC3 __ismbbpunct_l  proc near
.text:0040CEC3
.text:0040CEC3 tst	       = dword ptr  4
.text:0040CEC3 plocinfo	       = dword ptr  8
.text:0040CEC3
.text:0040CEC3		       push    2	       ; kmask
.text:0040CEC5		       push    10h	       ; cmask
.text:0040CEC7		       push    [esp+8+tst]     ; tst
.text:0040CECB		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CECF		       call    x_ismbbtype_l
.text:0040CED4		       add     esp, 10h
.text:0040CED7		       retn
.text:0040CED7 __ismbbpunct_l  endp
.text:0040CED7
.text:0040CED8
.text:0040CED8 ; =============== S U B R O U T I N E =======================================
.text:0040CED8
.text:0040CED8
.text:0040CED8 ; int __cdecl _ismbbpunct(unsigned int tst)
.text:0040CED8 __ismbbpunct    proc near
.text:0040CED8
.text:0040CED8 tst	       = dword ptr  4
.text:0040CED8
.text:0040CED8		       push    2	       ; kmask
.text:0040CEDA		       push    10h	       ; cmask
.text:0040CEDC		       push    [esp+8+tst]     ; tst
.text:0040CEE0		       push    0	       ; plocinfo
.text:0040CEE2		       call    x_ismbbtype_l
.text:0040CEE7		       add     esp, 10h
.text:0040CEEA		       retn
.text:0040CEEA __ismbbpunct    endp
.text:0040CEEA
.text:0040CEEB
.text:0040CEEB ; =============== S U B R O U T I N E =======================================
.text:0040CEEB
.text:0040CEEB
.text:0040CEEB ; int __cdecl _ismbblead_l(unsigned int tst, localeinfo_struct *plocinfo)
.text:0040CEEB __ismbblead_l   proc near
.text:0040CEEB
.text:0040CEEB tst	       = dword ptr  4
.text:0040CEEB plocinfo	       = dword ptr  8
.text:0040CEEB
.text:0040CEEB		       push    4	       ; kmask
.text:0040CEED		       push    0	       ; cmask
.text:0040CEEF		       push    [esp+8+tst]     ; tst
.text:0040CEF3		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CEF7		       call    x_ismbbtype_l
.text:0040CEFC		       add     esp, 10h
.text:0040CEFF		       retn
.text:0040CEFF __ismbblead_l   endp
.text:0040CEFF
.text:0040CF00
.text:0040CF00 ; =============== S U B R O U T I N E =======================================
.text:0040CF00
.text:0040CF00
.text:0040CF00 ; int __cdecl _ismbblead(unsigned int tst)
.text:0040CF00 __ismbblead     proc near	       ; CODE XREF: parse_cmdline+53p
.text:0040CF00					       ; parse_cmdline+138p ...
.text:0040CF00
.text:0040CF00 tst	       = dword ptr  4
.text:0040CF00
.text:0040CF00		       push    4	       ; kmask
.text:0040CF02		       push    0	       ; cmask
.text:0040CF04		       push    [esp+8+tst]     ; tst
.text:0040CF08		       push    0	       ; plocinfo
.text:0040CF0A		       call    x_ismbbtype_l
.text:0040CF0F		       add     esp, 10h
.text:0040CF12		       retn
.text:0040CF12 __ismbblead     endp
.text:0040CF12
.text:0040CF13
.text:0040CF13 ; =============== S U B R O U T I N E =======================================
.text:0040CF13
.text:0040CF13
.text:0040CF13 ; int __cdecl _ismbbtrail_l(unsigned int	tst, localeinfo_struct *plocinfo)
.text:0040CF13 __ismbbtrail_l  proc near
.text:0040CF13
.text:0040CF13 tst	       = dword ptr  4
.text:0040CF13 plocinfo	       = dword ptr  8
.text:0040CF13
.text:0040CF13		       push    8	       ; kmask
.text:0040CF15		       push    0	       ; cmask
.text:0040CF17		       push    [esp+8+tst]     ; tst
.text:0040CF1B		       push    [esp+0Ch+plocinfo] ; plocinfo
.text:0040CF1F		       call    x_ismbbtype_l
.text:0040CF24		       add     esp, 10h
.text:0040CF27		       retn
.text:0040CF27 __ismbbtrail_l  endp
.text:0040CF27
.text:0040CF28
.text:0040CF28 ; =============== S U B R O U T I N E =======================================
.text:0040CF28
.text:0040CF28
.text:0040CF28 ; int __cdecl _ismbbtrail(unsigned int tst)
.text:0040CF28 __ismbbtrail    proc near
.text:0040CF28
.text:0040CF28 tst	       = dword ptr  4
.text:0040CF28
.text:0040CF28		       push    8	       ; kmask
.text:0040CF2A		       push    0	       ; cmask
.text:0040CF2C		       push    [esp+8+tst]     ; tst
.text:0040CF30		       push    0	       ; plocinfo
.text:0040CF32		       call    x_ismbbtype_l
.text:0040CF37		       add     esp, 10h
.text:0040CF3A		       retn
.text:0040CF3A __ismbbtrail    endp
.text:0040CF3A
.text:0040CF3B
.text:0040CF3B ; =============== S U B R O U T I N E =======================================
.text:0040CF3B
.text:0040CF3B ; Attributes: bp-based frame
.text:0040CF3B
.text:0040CF3B ; int __cdecl _ismbbkana_l(unsigned int tst, localeinfo_struct *plocinfo)
.text:0040CF3B __ismbbkana_l   proc near	       ; CODE XREF: __ismbbkana+6p
.text:0040CF3B
.text:0040CF3B _loc_update     = _LocaleUpdate ptr -10h
.text:0040CF3B tst	       = dword ptr  8
.text:0040CF3B plocinfo	       = dword ptr  0Ch
.text:0040CF3B
.text:0040CF3B		       push    ebp
.text:0040CF3C		       mov     ebp, esp
.text:0040CF3E		       sub     esp, 10h
.text:0040CF41		       push    [ebp+plocinfo]  ; plocinfo
.text:0040CF44		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040CF47		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040CF4C		       mov     eax, [ebp+_loc_update.localeinfo.mbcinfo]
.text:0040CF4F		       test    eax, eax
.text:0040CF51		       jz      short loc_40CF7D
.text:0040CF53		       cmp     dword ptr [eax+4], 3A4h
.text:0040CF5A		       jnz     short loc_40CF7D
.text:0040CF5C		       push    3	       ; kmask
.text:0040CF5E		       push    0	       ; cmask
.text:0040CF60		       push    [ebp+tst]       ; tst
.text:0040CF63		       push    [ebp+plocinfo]  ; plocinfo
.text:0040CF66		       call    x_ismbbtype_l
.text:0040CF6B		       add     esp, 10h
.text:0040CF6E		       cmp     [ebp+_loc_update.updated], 0
.text:0040CF72		       jz      short locret_40CF8C
.text:0040CF74		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040CF77		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040CF7B		       leave
.text:0040CF7C		       retn
.text:0040CF7D ; ---------------------------------------------------------------------------
.text:0040CF7D
.text:0040CF7D loc_40CF7D:			       ; CODE XREF: __ismbbkana_l+16j
.text:0040CF7D					       ; __ismbbkana_l+1Fj
.text:0040CF7D		       cmp     [ebp+_loc_update.updated], 0
.text:0040CF81		       jz      short loc_40CF8A
.text:0040CF83		       mov     eax, [ebp+_loc_update.ptd]
.text:0040CF86		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040CF8A
.text:0040CF8A loc_40CF8A:			       ; CODE XREF: __ismbbkana_l+46j
.text:0040CF8A		       xor     eax, eax
.text:0040CF8C
.text:0040CF8C locret_40CF8C:			       ; CODE XREF: __ismbbkana_l+37j
.text:0040CF8C		       leave
.text:0040CF8D		       retn
.text:0040CF8D __ismbbkana_l   endp
.text:0040CF8D
.text:0040CF8E
.text:0040CF8E ; =============== S U B R O U T I N E =======================================
.text:0040CF8E
.text:0040CF8E
.text:0040CF8E ; int __cdecl _ismbbkana(unsigned int tst)
.text:0040CF8E __ismbbkana     proc near
.text:0040CF8E
.text:0040CF8E tst	       = dword ptr  4
.text:0040CF8E
.text:0040CF8E		       push    0	       ; plocinfo
.text:0040CF90		       push    [esp+4+tst]     ; tst
.text:0040CF94		       call    __ismbbkana_l
.text:0040CF99		       pop     ecx
.text:0040CF9A		       pop     ecx
.text:0040CF9B		       retn
.text:0040CF9B __ismbbkana     endp
.text:0040CF9B
.text:0040CF9C
.text:0040CF9C ; =============== S U B R O U T I N E =======================================
.text:0040CF9C
.text:0040CF9C
.text:0040CF9C ; int __usercall	strncnt<eax>(const char	*string<eax>, int cnt)
.text:0040CF9C strncnt	       proc near
.text:0040CF9C
.text:0040CF9C cnt	       = dword ptr  4
.text:0040CF9C
.text:0040CF9C string =	eax
.text:0040CF9C		       mov     ecx, [esp+cnt]
.text:0040CFA0		       jmp     short loc_40CFA9
.text:0040CFA2 ; ---------------------------------------------------------------------------
.text:0040CFA2
.text:0040CFA2 loc_40CFA2:			       ; CODE XREF: strncnt+Fj
.text:0040CFA2		       dec     ecx
.text:0040CFA3		       cmp     byte ptr	[string], 0
.text:0040CFA6		       jz      short loc_40CFAE
.text:0040CFA8		       inc     string
.text:0040CFA9
.text:0040CFA9 loc_40CFA9:			       ; CODE XREF: strncnt+4j
.text:0040CFA9		       test    ecx, ecx
.text:0040CFAB		       jnz     short loc_40CFA2
.text:0040CFAD		       dec     ecx
.text:0040CFAE
.text:0040CFAE loc_40CFAE:			       ; CODE XREF: strncnt+Aj
.text:0040CFAE		       mov     string, [esp+cnt]
.text:0040CFB2		       sub     string, ecx
.text:0040CFB4		       dec     string
.text:0040CFB5		       retn
.text:0040CFB5 strncnt	       endp
.text:0040CFB5
.text:0040CFB6
.text:0040CFB6 ; =============== S U B R O U T I N E =======================================
.text:0040CFB6
.text:0040CFB6 ; Attributes: bp-based frame
.text:0040CFB6
.text:0040CFB6 ; int __usercall	_crtLCMapStringA_stat<eax>(localeinfo_struct *plocinfo<ecx>, unsigned int Locale, unsigned int dwMapFlags, const char *lpSrcStr, int cchSrc, char *lpDestStr, int cchDest, int code_page, int bError)
.text:0040CFB6 __crtLCMapStringA_stat proc near	       ; CODE XREF: ___crtLCMapStringA+2Cp
.text:0040CFB6
.text:0040CFB6 AnsiCP	       = dword ptr -14h
.text:0040CFB6 cbuffer2	       = dword ptr -10h
.text:0040CFB6 inwbuffer       = dword ptr -0Ch
.text:0040CFB6 retval	       = dword ptr -8
.text:0040CFB6 var_4	       = dword ptr -4
.text:0040CFB6 Locale	       = dword ptr  8
.text:0040CFB6 dwMapFlags      = dword ptr  0Ch
.text:0040CFB6 lpSrcStr	       = dword ptr  10h
.text:0040CFB6 cchSrc	       = dword ptr  14h
.text:0040CFB6 lpDestStr       = dword ptr  18h
.text:0040CFB6 cchDest	       = dword ptr  1Ch
.text:0040CFB6 code_page       = dword ptr  20h
.text:0040CFB6 bError	       = dword ptr  24h
.text:0040CFB6
.text:0040CFB6 plocinfo	= ecx
.text:0040CFB6		       push    ebp
.text:0040CFB7		       mov     ebp, esp
.text:0040CFB9		       sub     esp, 14h
.text:0040CFBC		       mov     eax, ___security_cookie
.text:0040CFC1		       xor     eax, ebp
.text:0040CFC3		       mov     [ebp+var_4], eax
.text:0040CFC6		       push    ebx
.text:0040CFC7		       push    esi
.text:0040CFC8		       xor     ebx, ebx
.text:0040CFCA		       cmp     f_use_2,	ebx
.text:0040CFD0		       push    edi
.text:0040CFD1		       mov     esi, plocinfo
.text:0040CFD3		       jnz     short loc_40D00D
.text:0040CFD5		       push    ebx	       ; cchDest
.text:0040CFD6		       push    ebx	       ; lpDestStr
.text:0040CFD7		       xor     edi, edi
.text:0040CFD9		       inc     edi
.text:0040CFDA		       push    edi	       ; cchSrc
.text:0040CFDB		       push    offset SrcStr   ; lpSrcStr
.text:0040CFE0		       push    100h	       ; dwMapFlags
.text:0040CFE5		       push    ebx	       ; Locale
.text:0040CFE6		       call    ds:__imp__LCMapStringW@24 ; LCMapStringW(x,x,x,x,x,x)
.text:0040CFEC		       test    eax, eax
.text:0040CFEE		       jz      short loc_40CFF8
.text:0040CFF0		       mov     f_use_2,	edi
.text:0040CFF6		       jmp     short loc_40D00D
.text:0040CFF8 ; ---------------------------------------------------------------------------
.text:0040CFF8
.text:0040CFF8 loc_40CFF8:			       ; CODE XREF: __crtLCMapStringA_stat+38j
.text:0040CFF8		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040CFFE		       cmp     eax, 78h
.text:0040D001		       jnz     short loc_40D00D
.text:0040D003		       mov     f_use_2,	2
.text:0040D00D
.text:0040D00D loc_40D00D:			       ; CODE XREF: __crtLCMapStringA_stat+1Dj
.text:0040D00D					       ; __crtLCMapStringA_stat+40j ...
.text:0040D00D		       cmp     [ebp+cchSrc], ebx
.text:0040D010		       jle     short loc_40D034
.text:0040D012		       mov     plocinfo, [ebp+cchSrc]
.text:0040D015		       mov     eax, [ebp+lpSrcStr]
.text:0040D018
.text:0040D018 loc_40D018:			       ; CODE XREF: __crtLCMapStringA_stat+6Aj
.text:0040D018		       dec     plocinfo
.text:0040D019		       cmp     [eax], bl
.text:0040D01B		       jz      short loc_40D025
.text:0040D01D		       inc     eax
.text:0040D01E		       cmp     plocinfo, ebx
.text:0040D020		       jnz     short loc_40D018
.text:0040D022		       or      plocinfo, 0FFFFFFFFh
.text:0040D025
.text:0040D025 loc_40D025:			       ; CODE XREF: __crtLCMapStringA_stat+65j
.text:0040D025		       mov     eax, [ebp+cchSrc]
.text:0040D028		       sub     eax, plocinfo
.text:0040D02A		       dec     eax
.text:0040D02B		       cmp     eax, [ebp+cchSrc]
.text:0040D02E		       jge     short loc_40D031
.text:0040D030		       inc     eax
.text:0040D031
.text:0040D031 loc_40D031:			       ; CODE XREF: __crtLCMapStringA_stat+78j
.text:0040D031		       mov     [ebp+cchSrc], eax
.text:0040D034
.text:0040D034 loc_40D034:			       ; CODE XREF: __crtLCMapStringA_stat+5Aj
.text:0040D034		       mov     eax, f_use_2
.text:0040D039		       cmp     eax, 2
.text:0040D03C		       jz      loc_40D1ED
.text:0040D042		       cmp     eax, ebx
.text:0040D044		       jz      loc_40D1ED
.text:0040D04A		       cmp     eax, 1
.text:0040D04D		       jnz     loc_40D21E
.text:0040D053		       cmp     [ebp+code_page],	ebx
.text:0040D056		       mov     [ebp+retval], ebx
.text:0040D059		       jnz     short loc_40D063
.text:0040D05B		       mov     eax, [esi]
.text:0040D05D		       mov     eax, [eax+4]
.text:0040D060		       mov     [ebp+code_page],	eax
.text:0040D063
.text:0040D063 loc_40D063:			       ; CODE XREF: __crtLCMapStringA_stat+A3j
.text:0040D063		       mov     esi, ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D069		       xor     eax, eax
.text:0040D06B		       cmp     [ebp+bError], ebx
.text:0040D06E		       push    ebx	       ; cchWideChar
.text:0040D06F		       push    ebx	       ; lpWideCharStr
.text:0040D070		       push    [ebp+cchSrc]    ; cbMultiByte
.text:0040D073		       setnz   al
.text:0040D076		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0040D079		       lea     eax, ds:1[eax*8]
.text:0040D080		       push    eax	       ; dwFlags
.text:0040D081		       push    [ebp+code_page] ; CodePage
.text:0040D084		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D086		       mov     edi, eax
.text:0040D088		       cmp     edi, ebx
.text:0040D08A		       jz      loc_40D21E
.text:0040D090		       jle     short loc_40D0D5
.text:0040D092		       push    0FFFFFFE0h
.text:0040D094		       xor     edx, edx
.text:0040D096		       pop     eax
.text:0040D097		       div     edi
.text:0040D099		       cmp     eax, 2
.text:0040D09C		       jb      short loc_40D0D5
.text:0040D09E		       lea     eax, [edi+edi+8]
.text:0040D0A2		       cmp     eax, 400h
.text:0040D0A7		       ja      short loc_40D0BC
.text:0040D0A9		       call    __alloca_probe_16
.text:0040D0AE		       mov     eax, esp
.text:0040D0B0		       cmp     eax, ebx
.text:0040D0B2		       jz      short loc_40D0D0
.text:0040D0B4		       mov     dword ptr [eax],	0CCCCh
.text:0040D0BA		       jmp     short loc_40D0CD
.text:0040D0BC ; ---------------------------------------------------------------------------
.text:0040D0BC
.text:0040D0BC loc_40D0BC:			       ; CODE XREF: __crtLCMapStringA_stat+F1j
.text:0040D0BC		       push    eax	       ; size
.text:0040D0BD		       call    _malloc
.text:0040D0C2		       cmp     eax, ebx
.text:0040D0C4		       pop     plocinfo
.text:0040D0C5		       jz      short loc_40D0D0
.text:0040D0C7		       mov     dword ptr [eax],	0DDDDh
.text:0040D0CD
.text:0040D0CD loc_40D0CD:			       ; CODE XREF: __crtLCMapStringA_stat+104j
.text:0040D0CD		       add     eax, 8
.text:0040D0D0
.text:0040D0D0 loc_40D0D0:			       ; CODE XREF: __crtLCMapStringA_stat+FCj
.text:0040D0D0					       ; __crtLCMapStringA_stat+10Fj
.text:0040D0D0		       mov     [ebp+inwbuffer],	eax
.text:0040D0D3		       jmp     short loc_40D0D8
.text:0040D0D5 ; ---------------------------------------------------------------------------
.text:0040D0D5
.text:0040D0D5 loc_40D0D5:			       ; CODE XREF: __crtLCMapStringA_stat+DAj
.text:0040D0D5					       ; __crtLCMapStringA_stat+E6j
.text:0040D0D5		       mov     [ebp+inwbuffer],	ebx
.text:0040D0D8
.text:0040D0D8 loc_40D0D8:			       ; CODE XREF: __crtLCMapStringA_stat+11Dj
.text:0040D0D8		       cmp     [ebp+inwbuffer],	ebx
.text:0040D0DB		       jz      loc_40D21E
.text:0040D0E1		       push    edi	       ; cchWideChar
.text:0040D0E2		       push    [ebp+inwbuffer] ; lpWideCharStr
.text:0040D0E5		       push    [ebp+cchSrc]    ; cbMultiByte
.text:0040D0E8		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0040D0EB		       push    1	       ; dwFlags
.text:0040D0ED		       push    [ebp+code_page] ; CodePage
.text:0040D0F0		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D0F2		       test    eax, eax
.text:0040D0F4		       jz      loc_40D1DC
.text:0040D0FA		       mov     esi, ds:__imp__LCMapStringW@24 ;	LCMapStringW(x,x,x,x,x,x)
.text:0040D100		       push    ebx	       ; cchDest
.text:0040D101		       push    ebx	       ; lpDestStr
.text:0040D102		       push    edi	       ; cchSrc
.text:0040D103		       push    [ebp+inwbuffer] ; lpSrcStr
.text:0040D106		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040D109		       push    [ebp+Locale]    ; Locale
.text:0040D10C		       call    esi ; LCMapStringW(x,x,x,x,x,x) ; LCMapStringW(x,x,x,x,x,x)
.text:0040D10E		       mov     plocinfo, eax
.text:0040D110		       cmp     plocinfo, ebx
.text:0040D112		       mov     [ebp+retval], plocinfo
.text:0040D115		       jz      loc_40D1DC
.text:0040D11B		       test    word ptr	[ebp+dwMapFlags], 400h
.text:0040D121		       jz      short loc_40D14C
.text:0040D123		       cmp     [ebp+cchDest], ebx
.text:0040D126		       jz      loc_40D1DC
.text:0040D12C		       cmp     plocinfo, [ebp+cchDest]
.text:0040D12F		       jg      loc_40D1DC
.text:0040D135		       push    [ebp+cchDest]   ; cchDest
.text:0040D138		       push    [ebp+lpDestStr] ; lpDestStr
.text:0040D13B		       push    edi	       ; cchSrc
.text:0040D13C		       push    [ebp+inwbuffer] ; lpSrcStr
.text:0040D13F		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040D142		       push    [ebp+Locale]    ; Locale
.text:0040D145		       call    esi ; LCMapStringW(x,x,x,x,x,x) ; LCMapStringW(x,x,x,x,x,x)
.text:0040D147		       jmp     loc_40D1DC
.text:0040D14C ; ---------------------------------------------------------------------------
.text:0040D14C
.text:0040D14C loc_40D14C:			       ; CODE XREF: __crtLCMapStringA_stat+16Bj
.text:0040D14C		       cmp     plocinfo, ebx
.text:0040D14E		       jle     short loc_40D195
.text:0040D150		       push    0FFFFFFE0h
.text:0040D152		       xor     edx, edx
.text:0040D154		       pop     eax
.text:0040D155		       div     plocinfo
.text:0040D157		       cmp     eax, 2
.text:0040D15A		       jb      short loc_40D195
.text:0040D15C		       lea     eax, [plocinfo+plocinfo+8]
.text:0040D160		       cmp     eax, 400h
.text:0040D165		       ja      short loc_40D17D
.text:0040D167		       call    __alloca_probe_16
.text:0040D16C		       mov     esi, esp
.text:0040D16E		       cmp     esi, ebx
.text:0040D170		       jz      short loc_40D1DC
.text:0040D172		       mov     dword ptr [esi],	0CCCCh
.text:0040D178		       add     esi, 8
.text:0040D17B		       jmp     short loc_40D197
.text:0040D17D ; ---------------------------------------------------------------------------
.text:0040D17D
.text:0040D17D loc_40D17D:			       ; CODE XREF: __crtLCMapStringA_stat+1AFj
.text:0040D17D		       push    eax	       ; size
.text:0040D17E		       call    _malloc
.text:0040D183		       cmp     eax, ebx
.text:0040D185		       pop     plocinfo
.text:0040D186		       jz      short loc_40D191
.text:0040D188		       mov     dword ptr [eax],	0DDDDh
.text:0040D18E		       add     eax, 8
.text:0040D191
.text:0040D191 loc_40D191:			       ; CODE XREF: __crtLCMapStringA_stat+1D0j
.text:0040D191		       mov     esi, eax
.text:0040D193		       jmp     short loc_40D197
.text:0040D195 ; ---------------------------------------------------------------------------
.text:0040D195
.text:0040D195 loc_40D195:			       ; CODE XREF: __crtLCMapStringA_stat+198j
.text:0040D195					       ; __crtLCMapStringA_stat+1A4j
.text:0040D195		       xor     esi, esi
.text:0040D197
.text:0040D197 loc_40D197:			       ; CODE XREF: __crtLCMapStringA_stat+1C5j
.text:0040D197					       ; __crtLCMapStringA_stat+1DDj
.text:0040D197		       cmp     esi, ebx
.text:0040D199		       jz      short loc_40D1DC
.text:0040D19B		       push    [ebp+retval]    ; cchDest
.text:0040D19E		       push    esi	       ; lpDestStr
.text:0040D19F		       push    edi	       ; cchSrc
.text:0040D1A0		       push    [ebp+inwbuffer] ; lpSrcStr
.text:0040D1A3		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040D1A6		       push    [ebp+Locale]    ; Locale
.text:0040D1A9		       call    ds:__imp__LCMapStringW@24 ; LCMapStringW(x,x,x,x,x,x)
.text:0040D1AF		       test    eax, eax
.text:0040D1B1		       jz      short error_cleanup_1
.text:0040D1B3		       cmp     [ebp+cchDest], ebx
.text:0040D1B6		       push    ebx	       ; lpUsedDefaultChar
.text:0040D1B7		       push    ebx	       ; lpDefaultChar
.text:0040D1B8		       jnz     short loc_40D1BE
.text:0040D1BA		       push    ebx
.text:0040D1BB		       push    ebx
.text:0040D1BC		       jmp     short loc_40D1C4
.text:0040D1BE ; ---------------------------------------------------------------------------
.text:0040D1BE
.text:0040D1BE loc_40D1BE:			       ; CODE XREF: __crtLCMapStringA_stat+202j
.text:0040D1BE		       push    [ebp+cchDest]   ; cbMultiByte
.text:0040D1C1		       push    [ebp+lpDestStr] ; lpMultiByteStr
.text:0040D1C4
.text:0040D1C4 loc_40D1C4:			       ; CODE XREF: __crtLCMapStringA_stat+206j
.text:0040D1C4		       push    [ebp+retval]    ; cchWideChar
.text:0040D1C7		       push    esi	       ; lpWideCharStr
.text:0040D1C8		       push    ebx	       ; dwFlags
.text:0040D1C9		       push    [ebp+code_page] ; CodePage
.text:0040D1CC		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0040D1D2		       mov     [ebp+retval], eax
.text:0040D1D5
.text:0040D1D5 error_cleanup_1:			       ; CODE XREF: __crtLCMapStringA_stat+1FBj
.text:0040D1D5		       push    esi	       ; _Memory
.text:0040D1D6		       call    __freea
.text:0040D1DB		       pop     plocinfo
.text:0040D1DC
.text:0040D1DC loc_40D1DC:			       ; CODE XREF: __crtLCMapStringA_stat+13Ej
.text:0040D1DC					       ; __crtLCMapStringA_stat+15Fj ...
.text:0040D1DC		       push    [ebp+inwbuffer] ; _Memory
.text:0040D1DF		       call    __freea
.text:0040D1E4		       mov     eax, [ebp+retval]
.text:0040D1E7		       pop     plocinfo
.text:0040D1E8		       jmp     loc_40D346
.text:0040D1ED ; ---------------------------------------------------------------------------
.text:0040D1ED
.text:0040D1ED loc_40D1ED:			       ; CODE XREF: __crtLCMapStringA_stat+86j
.text:0040D1ED					       ; __crtLCMapStringA_stat+8Ej
.text:0040D1ED		       cmp     [ebp+Locale], ebx
.text:0040D1F0		       mov     [ebp+inwbuffer],	ebx
.text:0040D1F3		       mov     [ebp+cbuffer2], ebx
.text:0040D1F6		       jnz     short loc_40D200
.text:0040D1F8		       mov     eax, [esi]
.text:0040D1FA		       mov     eax, [eax+14h]
.text:0040D1FD		       mov     [ebp+Locale], eax
.text:0040D200
.text:0040D200 loc_40D200:			       ; CODE XREF: __crtLCMapStringA_stat+240j
.text:0040D200		       cmp     [ebp+code_page],	ebx
.text:0040D203		       jnz     short loc_40D20D
.text:0040D205		       mov     eax, [esi]
.text:0040D207		       mov     eax, [eax+4]
.text:0040D20A		       mov     [ebp+code_page],	eax
.text:0040D20D
.text:0040D20D loc_40D20D:			       ; CODE XREF: __crtLCMapStringA_stat+24Dj
.text:0040D20D		       push    [ebp+Locale]    ; lcid
.text:0040D210		       call    ___ansicp
.text:0040D215		       cmp     eax, 0FFFFFFFFh
.text:0040D218		       pop     plocinfo
.text:0040D219		       mov     [ebp+AnsiCP], eax
.text:0040D21C		       jnz     short loc_40D225
.text:0040D21E
.text:0040D21E loc_40D21E:			       ; CODE XREF: __crtLCMapStringA_stat+97j
.text:0040D21E					       ; __crtLCMapStringA_stat+D4j ...
.text:0040D21E		       xor     eax, eax
.text:0040D220		       jmp     loc_40D346
.text:0040D225 ; ---------------------------------------------------------------------------
.text:0040D225
.text:0040D225 loc_40D225:			       ; CODE XREF: __crtLCMapStringA_stat+266j
.text:0040D225		       cmp     eax, [ebp+code_page]
.text:0040D228		       jz      loc_40D309
.text:0040D22E		       push    ebx	       ; cchDest
.text:0040D22F		       push    ebx	       ; lpDestStr
.text:0040D230		       lea     plocinfo, [ebp+cchSrc]
.text:0040D233		       push    plocinfo	       ; pcchSrc
.text:0040D234		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D237		       push    eax	       ; toCP
.text:0040D238		       push    [ebp+code_page] ; fromCP
.text:0040D23B		       call    ___convertcp
.text:0040D240		       add     esp, 18h
.text:0040D243		       cmp     eax, ebx
.text:0040D245		       mov     [ebp+inwbuffer],	eax
.text:0040D248		       jz      short loc_40D21E
.text:0040D24A		       mov     esi, ds:__imp__LCMapStringA@24 ;	LCMapStringA(x,x,x,x,x,x)
.text:0040D250		       push    ebx	       ; cchDest
.text:0040D251		       push    ebx	       ; lpDestStr
.text:0040D252		       push    [ebp+cchSrc]    ; cchSrc
.text:0040D255		       push    eax	       ; lpSrcStr
.text:0040D256		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040D259		       push    [ebp+Locale]    ; Locale
.text:0040D25C		       call    esi ; LCMapStringA(x,x,x,x,x,x) ; LCMapStringA(x,x,x,x,x,x)
.text:0040D25E		       cmp     eax, ebx
.text:0040D260		       mov     [ebp+retval], eax
.text:0040D263		       jnz     short loc_40D26C
.text:0040D265
.text:0040D265 loc_40D265:			       ; CODE XREF: __crtLCMapStringA_stat+2D0j
.text:0040D265					       ; __crtLCMapStringA_stat+2F9j
.text:0040D265		       xor     esi, esi
.text:0040D267		       jmp     loc_40D323
.text:0040D26C ; ---------------------------------------------------------------------------
.text:0040D26C
.text:0040D26C loc_40D26C:			       ; CODE XREF: __crtLCMapStringA_stat+2ADj
.text:0040D26C		       jle     short loc_40D2AB
.text:0040D26E		       cmp     eax, 0FFFFFFE0h
.text:0040D271		       ja      short loc_40D2AB
.text:0040D273		       add     eax, 8
.text:0040D276		       cmp     eax, 400h
.text:0040D27B		       ja      short loc_40D293
.text:0040D27D		       call    __alloca_probe_16
.text:0040D282		       mov     edi, esp
.text:0040D284		       cmp     edi, ebx
.text:0040D286		       jz      short loc_40D265
.text:0040D288		       mov     dword ptr [edi],	0CCCCh
.text:0040D28E		       add     edi, 8
.text:0040D291		       jmp     short loc_40D2AD
.text:0040D293 ; ---------------------------------------------------------------------------
.text:0040D293
.text:0040D293 loc_40D293:			       ; CODE XREF: __crtLCMapStringA_stat+2C5j
.text:0040D293		       push    eax	       ; size
.text:0040D294		       call    _malloc
.text:0040D299		       cmp     eax, ebx
.text:0040D29B		       pop     plocinfo
.text:0040D29C		       jz      short loc_40D2A7
.text:0040D29E		       mov     dword ptr [eax],	0DDDDh
.text:0040D2A4		       add     eax, 8
.text:0040D2A7
.text:0040D2A7 loc_40D2A7:			       ; CODE XREF: __crtLCMapStringA_stat+2E6j
.text:0040D2A7		       mov     edi, eax
.text:0040D2A9		       jmp     short loc_40D2AD
.text:0040D2AB ; ---------------------------------------------------------------------------
.text:0040D2AB
.text:0040D2AB loc_40D2AB:			       ; CODE XREF: __crtLCMapStringA_stat:loc_40D26Cj
.text:0040D2AB					       ; __crtLCMapStringA_stat+2BBj
.text:0040D2AB		       xor     edi, edi
.text:0040D2AD
.text:0040D2AD loc_40D2AD:			       ; CODE XREF: __crtLCMapStringA_stat+2DBj
.text:0040D2AD					       ; __crtLCMapStringA_stat+2F3j
.text:0040D2AD		       cmp     edi, ebx
.text:0040D2AF		       jz      short loc_40D265
.text:0040D2B1		       push    [ebp+retval]    ; count
.text:0040D2B4		       push    ebx	       ; value
.text:0040D2B5		       push    edi	       ; dst
.text:0040D2B6		       call    _memset
.text:0040D2BB		       add     esp, 0Ch
.text:0040D2BE		       push    [ebp+retval]    ; cchDest
.text:0040D2C1		       push    edi	       ; lpDestStr
.text:0040D2C2		       push    [ebp+cchSrc]    ; cchSrc
.text:0040D2C5		       push    [ebp+inwbuffer] ; lpSrcStr
.text:0040D2C8		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040D2CB		       push    [ebp+Locale]    ; Locale
.text:0040D2CE		       call    esi ; LCMapStringA(x,x,x,x,x,x) ; LCMapStringA(x,x,x,x,x,x)
.text:0040D2D0		       cmp     eax, ebx
.text:0040D2D2		       mov     [ebp+retval], eax
.text:0040D2D5		       jnz     short loc_40D2DB
.text:0040D2D7		       xor     esi, esi
.text:0040D2D9		       jmp     short cleanupA
.text:0040D2DB ; ---------------------------------------------------------------------------
.text:0040D2DB
.text:0040D2DB loc_40D2DB:			       ; CODE XREF: __crtLCMapStringA_stat+31Fj
.text:0040D2DB		       push    [ebp+cchDest]   ; cchDest
.text:0040D2DE		       lea     eax, [ebp+retval]
.text:0040D2E1		       push    [ebp+lpDestStr] ; lpDestStr
.text:0040D2E4		       push    eax	       ; pcchSrc
.text:0040D2E5		       push    edi	       ; lpSrcStr
.text:0040D2E6		       push    [ebp+code_page] ; toCP
.text:0040D2E9		       push    [ebp+AnsiCP]    ; fromCP
.text:0040D2EC		       call    ___convertcp
.text:0040D2F1		       mov     esi, eax
.text:0040D2F3		       mov     [ebp+cbuffer2], esi
.text:0040D2F6		       add     esp, 18h
.text:0040D2F9		       neg     esi
.text:0040D2FB		       sbb     esi, esi
.text:0040D2FD		       and     esi, [ebp+retval]
.text:0040D300
.text:0040D300 cleanupA:			       ; CODE XREF: __crtLCMapStringA_stat+323j
.text:0040D300		       push    edi	       ; _Memory
.text:0040D301		       call    __freea
.text:0040D306		       pop     plocinfo
.text:0040D307		       jmp     short loc_40D323
.text:0040D309 ; ---------------------------------------------------------------------------
.text:0040D309
.text:0040D309 loc_40D309:			       ; CODE XREF: __crtLCMapStringA_stat+272j
.text:0040D309		       push    [ebp+cchDest]   ; cchDest
.text:0040D30C		       push    [ebp+lpDestStr] ; lpDestStr
.text:0040D30F		       push    [ebp+cchSrc]    ; cchSrc
.text:0040D312		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D315		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040D318		       push    [ebp+Locale]    ; Locale
.text:0040D31B		       call    ds:__imp__LCMapStringA@24 ; LCMapStringA(x,x,x,x,x,x)
.text:0040D321		       mov     esi, eax
.text:0040D323
.text:0040D323 loc_40D323:			       ; CODE XREF: __crtLCMapStringA_stat+2B1j
.text:0040D323					       ; __crtLCMapStringA_stat+351j
.text:0040D323		       cmp     [ebp+inwbuffer],	ebx
.text:0040D326		       jz      short loc_40D331
.text:0040D328		       push    [ebp+inwbuffer] ; pBlock
.text:0040D32B		       call    _free
.text:0040D330		       pop     plocinfo
.text:0040D331
.text:0040D331 loc_40D331:			       ; CODE XREF: __crtLCMapStringA_stat+370j
.text:0040D331		       mov     eax, [ebp+cbuffer2]
.text:0040D334		       cmp     eax, ebx
.text:0040D336		       jz      short loc_40D344
.text:0040D338		       cmp     [ebp+lpDestStr],	eax
.text:0040D33B		       jz      short loc_40D344
.text:0040D33D		       push    eax	       ; pBlock
.text:0040D33E		       call    _free
.text:0040D343		       pop     plocinfo
.text:0040D344
.text:0040D344 loc_40D344:			       ; CODE XREF: __crtLCMapStringA_stat+380j
.text:0040D344					       ; __crtLCMapStringA_stat+385j
.text:0040D344		       mov     eax, esi
.text:0040D346
.text:0040D346 loc_40D346:			       ; CODE XREF: __crtLCMapStringA_stat+232j
.text:0040D346					       ; __crtLCMapStringA_stat+26Aj
.text:0040D346		       lea     esp, [ebp-20h]
.text:0040D349		       pop     edi
.text:0040D34A		       pop     esi
.text:0040D34B		       pop     ebx
.text:0040D34C		       mov     plocinfo, [ebp+var_4]
.text:0040D34F		       xor     plocinfo, ebp   ; cookie
.text:0040D351		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040D356		       leave
.text:0040D357		       retn
.text:0040D357 __crtLCMapStringA_stat endp
.text:0040D357
.text:0040D358
.text:0040D358 ; =============== S U B R O U T I N E =======================================
.text:0040D358
.text:0040D358 ; Attributes: bp-based frame
.text:0040D358
.text:0040D358 ; int __cdecl __crtLCMapStringA(localeinfo_struct *plocinfo, unsigned int Locale, unsigned int dwMapFlags, const	char *lpSrcStr,	int cchSrc, char *lpDestStr, int cchDest, int code_page, int bError)
.text:0040D358 ___crtLCMapStringA proc near	       ; CODE XREF: setSBUpLow+B6p
.text:0040D358					       ; setSBUpLow+DBp ...
.text:0040D358
.text:0040D358 _loc_update     = _LocaleUpdate ptr -10h
.text:0040D358 plocinfo	       = dword ptr  8
.text:0040D358 Locale	       = dword ptr  0Ch
.text:0040D358 dwMapFlags      = dword ptr  10h
.text:0040D358 lpSrcStr	       = dword ptr  14h
.text:0040D358 cchSrc	       = dword ptr  18h
.text:0040D358 lpDestStr       = dword ptr  1Ch
.text:0040D358 cchDest	       = dword ptr  20h
.text:0040D358 code_page       = dword ptr  24h
.text:0040D358 bError	       = dword ptr  28h
.text:0040D358
.text:0040D358		       push    ebp
.text:0040D359		       mov     ebp, esp
.text:0040D35B		       sub     esp, 10h
.text:0040D35E		       push    [ebp+plocinfo]  ; plocinfo
.text:0040D361		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040D364		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040D369		       push    [ebp+bError]    ; bError
.text:0040D36C		       lea     ecx, [ebp+_loc_update] ;	plocinfo
.text:0040D36F		       push    [ebp+code_page] ; code_page
.text:0040D372		       push    [ebp+cchDest]   ; cchDest
.text:0040D375		       push    [ebp+lpDestStr] ; lpDestStr
.text:0040D378		       push    [ebp+cchSrc]    ; cchSrc
.text:0040D37B		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D37E		       push    [ebp+dwMapFlags]	; dwMapFlags
.text:0040D381		       push    [ebp+Locale]    ; Locale
.text:0040D384		       call    __crtLCMapStringA_stat
.text:0040D389		       add     esp, 20h
.text:0040D38C		       cmp     [ebp+_loc_update.updated], 0
.text:0040D390		       jz      short locret_40D399
.text:0040D392		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040D395		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040D399
.text:0040D399 locret_40D399:			       ; CODE XREF: ___crtLCMapStringA+38j
.text:0040D399		       leave
.text:0040D39A		       retn
.text:0040D39A ___crtLCMapStringA endp
.text:0040D39A
.text:0040D39B
.text:0040D39B ; =============== S U B R O U T I N E =======================================
.text:0040D39B
.text:0040D39B ; Attributes: bp-based frame
.text:0040D39B
.text:0040D39B ; int __usercall	_crtGetStringTypeA_stat<eax>(localeinfo_struct *plocinfo<ecx>, unsigned	int dwInfoType,	const char *lpSrcStr, int cchSrc, unsigned __int16 *lpCharType,	int code_page, int lcid, int bError)
.text:0040D39B __crtGetStringTypeA_stat	proc near      ; CODE XREF: ___crtGetStringTypeA+29p
.text:0040D39B
.text:0040D39B retval2	       = dword ptr -8
.text:0040D39B var_4	       = dword ptr -4
.text:0040D39B dwInfoType      = dword ptr  8
.text:0040D39B lpSrcStr	       = dword ptr  0Ch
.text:0040D39B cchSrc	       = dword ptr  10h
.text:0040D39B lpCharType      = dword ptr  14h
.text:0040D39B code_page       = dword ptr  18h
.text:0040D39B lcid	       = dword ptr  1Ch
.text:0040D39B bError	       = dword ptr  20h
.text:0040D39B
.text:0040D39B plocinfo	= ecx
.text:0040D39B		       push    ebp
.text:0040D39C		       mov     ebp, esp
.text:0040D39E		       push    plocinfo
.text:0040D39F		       push    plocinfo
.text:0040D3A0		       mov     eax, ___security_cookie
.text:0040D3A5		       xor     eax, ebp
.text:0040D3A7		       mov     [ebp+var_4], eax
.text:0040D3AA		       mov     eax, f_use_3
.text:0040D3AF		       push    ebx
.text:0040D3B0		       push    esi
.text:0040D3B1		       xor     ebx, ebx
.text:0040D3B3		       cmp     eax, ebx
.text:0040D3B5		       push    edi
.text:0040D3B6		       mov     edi, plocinfo
.text:0040D3B8		       jnz     short loc_40D3F4
.text:0040D3BA		       lea     eax, [ebp+retval2]
.text:0040D3BD		       push    eax	       ; lpCharType
.text:0040D3BE		       xor     esi, esi
.text:0040D3C0		       inc     esi
.text:0040D3C1		       push    esi	       ; cchSrc
.text:0040D3C2		       push    offset SrcStr   ; lpSrcStr
.text:0040D3C7		       push    esi	       ; dwInfoType
.text:0040D3C8		       call    ds:__imp__GetStringTypeW@16 ; GetStringTypeW(x,x,x,x)
.text:0040D3CE		       test    eax, eax
.text:0040D3D0		       jz      short loc_40D3DA
.text:0040D3D2		       mov     f_use_3,	esi
.text:0040D3D8		       jmp     short loc_40D40E
.text:0040D3DA ; ---------------------------------------------------------------------------
.text:0040D3DA
.text:0040D3DA loc_40D3DA:			       ; CODE XREF: __crtGetStringTypeA_stat+35j
.text:0040D3DA		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0040D3E0		       cmp     eax, 78h
.text:0040D3E3		       jnz     short loc_40D3EF
.text:0040D3E5		       push    2
.text:0040D3E7		       pop     eax
.text:0040D3E8		       mov     f_use_3,	eax
.text:0040D3ED		       jmp     short loc_40D3F4
.text:0040D3EF ; ---------------------------------------------------------------------------
.text:0040D3EF
.text:0040D3EF loc_40D3EF:			       ; CODE XREF: __crtGetStringTypeA_stat+48j
.text:0040D3EF		       mov     eax, f_use_3
.text:0040D3F4
.text:0040D3F4 loc_40D3F4:			       ; CODE XREF: __crtGetStringTypeA_stat+1Dj
.text:0040D3F4					       ; __crtGetStringTypeA_stat+52j
.text:0040D3F4		       cmp     eax, 2
.text:0040D3F7		       jz      loc_40D4CC
.text:0040D3FD		       cmp     eax, ebx
.text:0040D3FF		       jz      loc_40D4CC
.text:0040D405		       cmp     eax, 1
.text:0040D408		       jnz     loc_40D4F6
.text:0040D40E
.text:0040D40E loc_40D40E:			       ; CODE XREF: __crtGetStringTypeA_stat+3Dj
.text:0040D40E		       cmp     [ebp+code_page],	ebx
.text:0040D411		       mov     [ebp+retval2], ebx
.text:0040D414		       jnz     short loc_40D41E
.text:0040D416		       mov     eax, [edi]
.text:0040D418		       mov     eax, [eax+4]
.text:0040D41B		       mov     [ebp+code_page],	eax
.text:0040D41E
.text:0040D41E loc_40D41E:			       ; CODE XREF: __crtGetStringTypeA_stat+79j
.text:0040D41E		       mov     esi, ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D424		       xor     eax, eax
.text:0040D426		       cmp     [ebp+bError], ebx
.text:0040D429		       push    ebx	       ; cchWideChar
.text:0040D42A		       push    ebx	       ; lpWideCharStr
.text:0040D42B		       push    [ebp+cchSrc]    ; cbMultiByte
.text:0040D42E		       setnz   al
.text:0040D431		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0040D434		       lea     eax, ds:1[eax*8]
.text:0040D43B		       push    eax	       ; dwFlags
.text:0040D43C		       push    [ebp+code_page] ; CodePage
.text:0040D43F		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D441		       mov     edi, eax
.text:0040D443		       cmp     edi, ebx
.text:0040D445		       jz      loc_40D4F6
.text:0040D44B		       jle     short loc_40D489
.text:0040D44D		       cmp     edi, 7FFFFFF0h
.text:0040D453		       ja      short loc_40D489
.text:0040D455		       lea     eax, [edi+edi+8]
.text:0040D459		       cmp     eax, 400h
.text:0040D45E		       ja      short loc_40D473
.text:0040D460		       call    __alloca_probe_16
.text:0040D465		       mov     eax, esp
.text:0040D467		       cmp     eax, ebx
.text:0040D469		       jz      short loc_40D487
.text:0040D46B		       mov     dword ptr [eax],	0CCCCh
.text:0040D471		       jmp     short loc_40D484
.text:0040D473 ; ---------------------------------------------------------------------------
.text:0040D473
.text:0040D473 loc_40D473:			       ; CODE XREF: __crtGetStringTypeA_stat+C3j
.text:0040D473		       push    eax	       ; size
.text:0040D474		       call    _malloc
.text:0040D479		       cmp     eax, ebx
.text:0040D47B		       pop     plocinfo
.text:0040D47C		       jz      short loc_40D487
.text:0040D47E		       mov     dword ptr [eax],	0DDDDh
.text:0040D484
.text:0040D484 loc_40D484:			       ; CODE XREF: __crtGetStringTypeA_stat+D6j
.text:0040D484		       add     eax, 8
.text:0040D487
.text:0040D487 loc_40D487:			       ; CODE XREF: __crtGetStringTypeA_stat+CEj
.text:0040D487					       ; __crtGetStringTypeA_stat+E1j
.text:0040D487		       mov     ebx, eax
.text:0040D489
.text:0040D489 loc_40D489:			       ; CODE XREF: __crtGetStringTypeA_stat+B0j
.text:0040D489					       ; __crtGetStringTypeA_stat+B8j
.text:0040D489		       test    ebx, ebx
.text:0040D48B		       jz      short loc_40D4F6
.text:0040D48D		       lea     eax, [edi+edi]
.text:0040D490		       push    eax	       ; count
.text:0040D491		       push    0	       ; value
.text:0040D493		       push    ebx	       ; dst
.text:0040D494		       call    _memset
.text:0040D499		       add     esp, 0Ch
.text:0040D49C		       push    edi	       ; cchWideChar
.text:0040D49D		       push    ebx	       ; lpWideCharStr
.text:0040D49E		       push    [ebp+cchSrc]    ; cbMultiByte
.text:0040D4A1		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0040D4A4		       push    1	       ; dwFlags
.text:0040D4A6		       push    [ebp+code_page] ; CodePage
.text:0040D4A9		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0040D4AB		       test    eax, eax
.text:0040D4AD		       jz      short loc_40D4C0
.text:0040D4AF		       push    [ebp+lpCharType]	; lpCharType
.text:0040D4B2		       push    eax	       ; cchSrc
.text:0040D4B3		       push    ebx	       ; lpSrcStr
.text:0040D4B4		       push    [ebp+dwInfoType]	; dwInfoType
.text:0040D4B7		       call    ds:__imp__GetStringTypeW@16 ; GetStringTypeW(x,x,x,x)
.text:0040D4BD		       mov     [ebp+retval2], eax
.text:0040D4C0
.text:0040D4C0 loc_40D4C0:			       ; CODE XREF: __crtGetStringTypeA_stat+112j
.text:0040D4C0		       push    ebx	       ; _Memory
.text:0040D4C1		       call    __freea
.text:0040D4C6		       mov     eax, [ebp+retval2]
.text:0040D4C9		       pop     plocinfo
.text:0040D4CA		       jmp     short loc_40D541
.text:0040D4CC ; ---------------------------------------------------------------------------
.text:0040D4CC
.text:0040D4CC loc_40D4CC:			       ; CODE XREF: __crtGetStringTypeA_stat+5Cj
.text:0040D4CC					       ; __crtGetStringTypeA_stat+64j
.text:0040D4CC		       xor     esi, esi
.text:0040D4CE		       cmp     [ebp+lcid], ebx
.text:0040D4D1		       jnz     short loc_40D4DB
.text:0040D4D3		       mov     eax, [edi]
.text:0040D4D5		       mov     eax, [eax+14h]
.text:0040D4D8		       mov     [ebp+lcid], eax
.text:0040D4DB
.text:0040D4DB loc_40D4DB:			       ; CODE XREF: __crtGetStringTypeA_stat+136j
.text:0040D4DB		       cmp     [ebp+code_page],	ebx
.text:0040D4DE		       jnz     short loc_40D4E8
.text:0040D4E0		       mov     eax, [edi]
.text:0040D4E2		       mov     eax, [eax+4]
.text:0040D4E5		       mov     [ebp+code_page],	eax
.text:0040D4E8
.text:0040D4E8 loc_40D4E8:			       ; CODE XREF: __crtGetStringTypeA_stat+143j
.text:0040D4E8		       push    [ebp+lcid]      ; lcid
.text:0040D4EB		       call    ___ansicp
.text:0040D4F0		       cmp     eax, 0FFFFFFFFh
.text:0040D4F3		       pop     plocinfo
.text:0040D4F4		       jnz     short loc_40D4FA
.text:0040D4F6
.text:0040D4F6 loc_40D4F6:			       ; CODE XREF: __crtGetStringTypeA_stat+6Dj
.text:0040D4F6					       ; __crtGetStringTypeA_stat+AAj ...
.text:0040D4F6		       xor     eax, eax
.text:0040D4F8		       jmp     short loc_40D541
.text:0040D4FA ; ---------------------------------------------------------------------------
.text:0040D4FA
.text:0040D4FA loc_40D4FA:			       ; CODE XREF: __crtGetStringTypeA_stat+159j
.text:0040D4FA		       cmp     eax, [ebp+code_page]
.text:0040D4FD		       jz      short loc_40D51D
.text:0040D4FF		       push    ebx	       ; cchDest
.text:0040D500		       push    ebx	       ; lpDestStr
.text:0040D501		       lea     plocinfo, [ebp+cchSrc]
.text:0040D504		       push    plocinfo	       ; pcchSrc
.text:0040D505		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D508		       push    eax	       ; toCP
.text:0040D509		       push    [ebp+code_page] ; fromCP
.text:0040D50C		       call    ___convertcp
.text:0040D511		       mov     esi, eax
.text:0040D513		       add     esp, 18h
.text:0040D516		       cmp     esi, ebx
.text:0040D518		       jz      short loc_40D4F6
.text:0040D51A		       mov     [ebp+lpSrcStr], esi
.text:0040D51D
.text:0040D51D loc_40D51D:			       ; CODE XREF: __crtGetStringTypeA_stat+162j
.text:0040D51D		       push    [ebp+lpCharType]	; lpCharType
.text:0040D520		       push    [ebp+cchSrc]    ; cchSrc
.text:0040D523		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D526		       push    [ebp+dwInfoType]	; dwInfoType
.text:0040D529		       push    [ebp+lcid]      ; Locale
.text:0040D52C		       call    ds:__imp__GetStringTypeA@20 ; GetStringTypeA(x,x,x,x,x)
.text:0040D532		       cmp     esi, ebx
.text:0040D534		       mov     edi, eax
.text:0040D536		       jz      short loc_40D53F
.text:0040D538		       push    esi	       ; pBlock
.text:0040D539		       call    _free
.text:0040D53E		       pop     plocinfo
.text:0040D53F
.text:0040D53F loc_40D53F:			       ; CODE XREF: __crtGetStringTypeA_stat+19Bj
.text:0040D53F		       mov     eax, edi
.text:0040D541
.text:0040D541 loc_40D541:			       ; CODE XREF: __crtGetStringTypeA_stat+12Fj
.text:0040D541					       ; __crtGetStringTypeA_stat+15Dj
.text:0040D541		       lea     esp, [ebp-14h]
.text:0040D544		       pop     edi
.text:0040D545		       pop     esi
.text:0040D546		       pop     ebx
.text:0040D547		       mov     plocinfo, [ebp+var_4]
.text:0040D54A		       xor     plocinfo, ebp   ; cookie
.text:0040D54C		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040D551		       leave
.text:0040D552		       retn
.text:0040D552 __crtGetStringTypeA_stat	endp
.text:0040D552
.text:0040D553
.text:0040D553 ; =============== S U B R O U T I N E =======================================
.text:0040D553
.text:0040D553 ; Attributes: bp-based frame
.text:0040D553
.text:0040D553 ; int __cdecl __crtGetStringTypeA(localeinfo_struct *plocinfo, unsigned int dwInfoType, const char *lpSrcStr, int cchSrc, unsigned __int16 *lpCharType, int code_page, int lcid,	int bError)
.text:0040D553 ___crtGetStringTypeA proc near	       ; CODE XREF: setSBUpLow+96p
.text:0040D553					       ; _setlocale_set_cat+1EBp ...
.text:0040D553
.text:0040D553 _loc_update     = _LocaleUpdate ptr -10h
.text:0040D553 plocinfo	       = dword ptr  8
.text:0040D553 dwInfoType      = dword ptr  0Ch
.text:0040D553 lpSrcStr	       = dword ptr  10h
.text:0040D553 cchSrc	       = dword ptr  14h
.text:0040D553 lpCharType      = dword ptr  18h
.text:0040D553 code_page       = dword ptr  1Ch
.text:0040D553 lcid	       = dword ptr  20h
.text:0040D553 bError	       = dword ptr  24h
.text:0040D553
.text:0040D553		       push    ebp
.text:0040D554		       mov     ebp, esp
.text:0040D556		       sub     esp, 10h
.text:0040D559		       push    [ebp+plocinfo]  ; plocinfo
.text:0040D55C		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040D55F		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040D564		       push    [ebp+bError]    ; bError
.text:0040D567		       lea     ecx, [ebp+_loc_update] ;	plocinfo
.text:0040D56A		       push    [ebp+lcid]      ; lcid
.text:0040D56D		       push    [ebp+code_page] ; code_page
.text:0040D570		       push    [ebp+lpCharType]	; lpCharType
.text:0040D573		       push    [ebp+cchSrc]    ; cchSrc
.text:0040D576		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0040D579		       push    [ebp+dwInfoType]	; dwInfoType
.text:0040D57C		       call    __crtGetStringTypeA_stat
.text:0040D581		       add     esp, 1Ch
.text:0040D584		       cmp     [ebp+_loc_update.updated], 0
.text:0040D588		       jz      short locret_40D591
.text:0040D58A		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040D58D		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040D591
.text:0040D591 locret_40D591:			       ; CODE XREF: ___crtGetStringTypeA+35j
.text:0040D591		       leave
.text:0040D592		       retn
.text:0040D592 ___crtGetStringTypeA endp
.text:0040D592
.text:0040D593
.text:0040D593 ; =============== S U B R O U T I N E =======================================
.text:0040D593
.text:0040D593
.text:0040D593 ; const unsigned	__int16	*__cdecl __pwctype_func()
.text:0040D593 ___pwctype_func proc near
.text:0040D593		       mov     eax, __pwctype
.text:0040D598		       retn
.text:0040D598 ___pwctype_func endp
.text:0040D598
.text:0040D599
.text:0040D599 ; =============== S U B R O U T I N E =======================================
.text:0040D599
.text:0040D599
.text:0040D599 ; const unsigned	__int16	*__cdecl __pctype_func()
.text:0040D599 ___pctype_func  proc near
.text:0040D599		       call    __getptd
.text:0040D59E		       mov     ecx, eax
.text:0040D5A0		       mov     eax, [ecx+6Ch]
.text:0040D5A3		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040D5A9		       jz      short loc_40D5BB
.text:0040D5AB		       mov     edx, ___globallocalestatus
.text:0040D5B1		       test    [ecx+70h], edx
.text:0040D5B4		       jnz     short loc_40D5BB
.text:0040D5B6		       call    ___updatetlocinfo
.text:0040D5BB
.text:0040D5BB loc_40D5BB:			       ; CODE XREF: ___pctype_func+10j
.text:0040D5BB					       ; ___pctype_func+1Bj
.text:0040D5BB		       mov     eax, [eax+0C8h]
.text:0040D5C1		       retn
.text:0040D5C1 ___pctype_func  endp
.text:0040D5C1
.text:0040D5C2
.text:0040D5C2 ; =============== S U B R O U T I N E =======================================
.text:0040D5C2
.text:0040D5C2 ; Attributes: bp-based frame
.text:0040D5C2
.text:0040D5C2 ; int __usercall	get_lc_time<eax>(__lc_time_data	*lc_time<esi>, threadlocaleinfostruct *ploci<eax>)
.text:0040D5C2 _get_lc_time    proc near	       ; CODE XREF: ___init_time+2Fp
.text:0040D5C2
.text:0040D5C2 locinfo	       = localeinfo_struct ptr -10h
.text:0040D5C2 ctryid	       = dword ptr -8
.text:0040D5C2 langid	       = dword ptr -4
.text:0040D5C2
.text:0040D5C2 lc_time = esi
.text:0040D5C2 ploci = eax
.text:0040D5C2		       push    ebp
.text:0040D5C3		       mov     ebp, esp
.text:0040D5C5		       sub     esp, 10h
.text:0040D5C8		       test    lc_time,	lc_time
.text:0040D5CA		       movzx   ecx, word ptr [ploci+42h]
.text:0040D5CE		       movzx   edx, word ptr [ploci+44h]
.text:0040D5D2		       mov     [ebp+langid], ecx
.text:0040D5D5		       mov     [ebp+ctryid], edx
.text:0040D5D8		       jnz     short loc_40D5DF
.text:0040D5DA		       or      ploci, 0FFFFFFFFh
.text:0040D5DD		       leave
.text:0040D5DE		       retn
.text:0040D5DF ; ---------------------------------------------------------------------------
.text:0040D5DF
.text:0040D5DF loc_40D5DF:			       ; CODE XREF: _get_lc_time+16j
.text:0040D5DF		       and     [ebp+locinfo.mbcinfo], 0
.text:0040D5E3		       push    ebx
.text:0040D5E4		       push    edi
.text:0040D5E5		       mov     [ebp+locinfo.locinfo], ploci
.text:0040D5E8		       lea     ploci, [lc_time+4]
.text:0040D5EB		       push    ploci	       ; address
.text:0040D5EC		       push    31h	       ; fieldtype
.text:0040D5EE		       push    ecx	       ; localehandle
.text:0040D5EF		       xor     ebx, ebx
.text:0040D5F1		       inc     ebx
.text:0040D5F2		       lea     ploci, [ebp+locinfo]
.text:0040D5F5		       push    ebx	       ; lc_type
.text:0040D5F6		       push    ploci	       ; plocinfo
.text:0040D5F7		       call    ___getlocaleinfo
.text:0040D5FC		       mov     edi, ploci
.text:0040D5FE		       lea     ploci, [lc_time+8]
.text:0040D601		       push    ploci	       ; address
.text:0040D602		       push    32h	       ; fieldtype
.text:0040D604		       push    [ebp+langid]    ; localehandle
.text:0040D607		       lea     ploci, [ebp+locinfo]
.text:0040D60A		       push    ebx	       ; lc_type
.text:0040D60B		       push    ploci	       ; plocinfo
.text:0040D60C		       call    ___getlocaleinfo
.text:0040D611		       or      edi, ploci
.text:0040D613		       lea     ploci, [lc_time+0Ch]
.text:0040D616		       push    ploci	       ; address
.text:0040D617		       push    33h	       ; fieldtype
.text:0040D619		       push    [ebp+langid]    ; localehandle
.text:0040D61C		       lea     ploci, [ebp+locinfo]
.text:0040D61F		       push    ebx	       ; lc_type
.text:0040D620		       push    ploci	       ; plocinfo
.text:0040D621		       call    ___getlocaleinfo
.text:0040D626		       or      edi, ploci
.text:0040D628		       lea     ploci, [lc_time+10h]
.text:0040D62B		       push    ploci	       ; address
.text:0040D62C		       push    34h	       ; fieldtype
.text:0040D62E		       push    [ebp+langid]    ; localehandle
.text:0040D631		       lea     ploci, [ebp+locinfo]
.text:0040D634		       push    ebx	       ; lc_type
.text:0040D635		       push    ploci	       ; plocinfo
.text:0040D636		       call    ___getlocaleinfo
.text:0040D63B		       add     esp, 50h
.text:0040D63E		       or      edi, ploci
.text:0040D640		       lea     ploci, [lc_time+14h]
.text:0040D643		       push    ploci	       ; address
.text:0040D644		       push    35h	       ; fieldtype
.text:0040D646		       push    [ebp+langid]    ; localehandle
.text:0040D649		       lea     ploci, [ebp+locinfo]
.text:0040D64C		       push    ebx	       ; lc_type
.text:0040D64D		       push    ploci	       ; plocinfo
.text:0040D64E		       call    ___getlocaleinfo
.text:0040D653		       or      edi, ploci
.text:0040D655		       lea     ploci, [lc_time+18h]
.text:0040D658		       push    ploci	       ; address
.text:0040D659		       push    36h	       ; fieldtype
.text:0040D65B		       push    [ebp+langid]    ; localehandle
.text:0040D65E		       lea     ploci, [ebp+locinfo]
.text:0040D661		       push    ebx	       ; lc_type
.text:0040D662		       push    ploci	       ; plocinfo
.text:0040D663		       call    ___getlocaleinfo
.text:0040D668		       push    lc_time	       ; address
.text:0040D669		       push    37h	       ; fieldtype
.text:0040D66B		       push    [ebp+langid]    ; localehandle
.text:0040D66E		       or      edi, ploci
.text:0040D670		       lea     ploci, [ebp+locinfo]
.text:0040D673		       push    ebx	       ; lc_type
.text:0040D674		       push    ploci	       ; plocinfo
.text:0040D675		       call    ___getlocaleinfo
.text:0040D67A		       or      edi, ploci
.text:0040D67C		       lea     ploci, [lc_time+20h]
.text:0040D67F		       push    ploci	       ; address
.text:0040D680		       push    2Ah	       ; fieldtype
.text:0040D682		       push    [ebp+langid]    ; localehandle
.text:0040D685		       lea     ploci, [ebp+locinfo]
.text:0040D688		       push    ebx	       ; lc_type
.text:0040D689		       push    ploci	       ; plocinfo
.text:0040D68A		       call    ___getlocaleinfo
.text:0040D68F		       add     esp, 50h
.text:0040D692		       or      edi, ploci
.text:0040D694		       lea     ploci, [lc_time+24h]
.text:0040D697		       push    ploci	       ; address
.text:0040D698		       push    2Bh	       ; fieldtype
.text:0040D69A		       push    [ebp+langid]    ; localehandle
.text:0040D69D		       lea     ploci, [ebp+locinfo]
.text:0040D6A0		       push    ebx	       ; lc_type
.text:0040D6A1		       push    ploci	       ; plocinfo
.text:0040D6A2		       call    ___getlocaleinfo
.text:0040D6A7		       or      edi, ploci
.text:0040D6A9		       lea     ploci, [lc_time+28h]
.text:0040D6AC		       push    ploci	       ; address
.text:0040D6AD		       push    2Ch	       ; fieldtype
.text:0040D6AF		       push    [ebp+langid]    ; localehandle
.text:0040D6B2		       lea     ploci, [ebp+locinfo]
.text:0040D6B5		       push    ebx	       ; lc_type
.text:0040D6B6		       push    ploci	       ; plocinfo
.text:0040D6B7		       call    ___getlocaleinfo
.text:0040D6BC		       or      edi, ploci
.text:0040D6BE		       lea     ploci, [lc_time+2Ch]
.text:0040D6C1		       push    ploci	       ; address
.text:0040D6C2		       push    2Dh	       ; fieldtype
.text:0040D6C4		       push    [ebp+langid]    ; localehandle
.text:0040D6C7		       lea     ploci, [ebp+locinfo]
.text:0040D6CA		       push    ebx	       ; lc_type
.text:0040D6CB		       push    ploci	       ; plocinfo
.text:0040D6CC		       call    ___getlocaleinfo
.text:0040D6D1		       or      edi, ploci
.text:0040D6D3		       lea     ploci, [lc_time+30h]
.text:0040D6D6		       push    ploci	       ; address
.text:0040D6D7		       push    2Eh	       ; fieldtype
.text:0040D6D9		       push    [ebp+langid]    ; localehandle
.text:0040D6DC		       lea     ploci, [ebp+locinfo]
.text:0040D6DF		       push    ebx	       ; lc_type
.text:0040D6E0		       push    ploci	       ; plocinfo
.text:0040D6E1		       call    ___getlocaleinfo
.text:0040D6E6		       add     esp, 50h
.text:0040D6E9		       or      edi, ploci
.text:0040D6EB		       lea     ploci, [lc_time+34h]
.text:0040D6EE		       push    ploci	       ; address
.text:0040D6EF		       push    2Fh	       ; fieldtype
.text:0040D6F1		       push    [ebp+langid]    ; localehandle
.text:0040D6F4		       lea     ploci, [ebp+locinfo]
.text:0040D6F7		       push    ebx	       ; lc_type
.text:0040D6F8		       push    ploci	       ; plocinfo
.text:0040D6F9		       call    ___getlocaleinfo
.text:0040D6FE		       or      edi, ploci
.text:0040D700		       lea     ploci, [lc_time+1Ch]
.text:0040D703		       push    ploci	       ; address
.text:0040D704		       push    30h	       ; fieldtype
.text:0040D706		       push    [ebp+langid]    ; localehandle
.text:0040D709		       lea     ploci, [ebp+locinfo]
.text:0040D70C		       push    ebx	       ; lc_type
.text:0040D70D		       push    ploci	       ; plocinfo
.text:0040D70E		       call    ___getlocaleinfo
.text:0040D713		       or      edi, ploci
.text:0040D715		       lea     ploci, [lc_time+38h]
.text:0040D718		       push    ploci	       ; address
.text:0040D719		       push    44h	       ; fieldtype
.text:0040D71B		       push    [ebp+langid]    ; localehandle
.text:0040D71E		       lea     ploci, [ebp+locinfo]
.text:0040D721		       push    ebx	       ; lc_type
.text:0040D722		       push    ploci	       ; plocinfo
.text:0040D723		       call    ___getlocaleinfo
.text:0040D728		       or      edi, ploci
.text:0040D72A		       lea     ploci, [lc_time+3Ch]
.text:0040D72D		       push    ploci	       ; address
.text:0040D72E		       push    45h	       ; fieldtype
.text:0040D730		       push    [ebp+langid]    ; localehandle
.text:0040D733		       lea     ploci, [ebp+locinfo]
.text:0040D736		       push    ebx	       ; lc_type
.text:0040D737		       push    ploci	       ; plocinfo
.text:0040D738		       call    ___getlocaleinfo
.text:0040D73D		       add     esp, 50h
.text:0040D740		       or      edi, ploci
.text:0040D742		       lea     ploci, [lc_time+40h]
.text:0040D745		       push    ploci	       ; address
.text:0040D746		       push    46h	       ; fieldtype
.text:0040D748		       push    [ebp+langid]    ; localehandle
.text:0040D74B		       lea     ploci, [ebp+locinfo]
.text:0040D74E		       push    ebx	       ; lc_type
.text:0040D74F		       push    ploci	       ; plocinfo
.text:0040D750		       call    ___getlocaleinfo
.text:0040D755		       or      edi, ploci
.text:0040D757		       lea     ploci, [lc_time+44h]
.text:0040D75A		       push    ploci	       ; address
.text:0040D75B		       push    47h	       ; fieldtype
.text:0040D75D		       push    [ebp+langid]    ; localehandle
.text:0040D760		       lea     ploci, [ebp+locinfo]
.text:0040D763		       push    ebx	       ; lc_type
.text:0040D764		       push    ploci	       ; plocinfo
.text:0040D765		       call    ___getlocaleinfo
.text:0040D76A		       or      edi, ploci
.text:0040D76C		       lea     ploci, [lc_time+48h]
.text:0040D76F		       push    ploci	       ; address
.text:0040D770		       push    48h	       ; fieldtype
.text:0040D772		       push    [ebp+langid]    ; localehandle
.text:0040D775		       lea     ploci, [ebp+locinfo]
.text:0040D778		       push    ebx	       ; lc_type
.text:0040D779		       push    ploci	       ; plocinfo
.text:0040D77A		       call    ___getlocaleinfo
.text:0040D77F		       or      edi, ploci
.text:0040D781		       lea     ploci, [lc_time+4Ch]
.text:0040D784		       push    ploci	       ; address
.text:0040D785		       push    49h	       ; fieldtype
.text:0040D787		       push    [ebp+langid]    ; localehandle
.text:0040D78A		       lea     ploci, [ebp+locinfo]
.text:0040D78D		       push    ebx	       ; lc_type
.text:0040D78E		       push    ploci	       ; plocinfo
.text:0040D78F		       call    ___getlocaleinfo
.text:0040D794		       add     esp, 50h
.text:0040D797		       or      edi, ploci
.text:0040D799		       lea     ploci, [lc_time+50h]
.text:0040D79C		       push    ploci	       ; address
.text:0040D79D		       push    4Ah	       ; fieldtype
.text:0040D79F		       push    [ebp+langid]    ; localehandle
.text:0040D7A2		       lea     ploci, [ebp+locinfo]
.text:0040D7A5		       push    ebx	       ; lc_type
.text:0040D7A6		       push    ploci	       ; plocinfo
.text:0040D7A7		       call    ___getlocaleinfo
.text:0040D7AC		       or      edi, ploci
.text:0040D7AE		       lea     ploci, [lc_time+54h]
.text:0040D7B1		       push    ploci	       ; address
.text:0040D7B2		       push    4Bh	       ; fieldtype
.text:0040D7B4		       push    [ebp+langid]    ; localehandle
.text:0040D7B7		       lea     ploci, [ebp+locinfo]
.text:0040D7BA		       push    ebx	       ; lc_type
.text:0040D7BB		       push    ploci	       ; plocinfo
.text:0040D7BC		       call    ___getlocaleinfo
.text:0040D7C1		       or      edi, ploci
.text:0040D7C3		       lea     ploci, [lc_time+58h]
.text:0040D7C6		       push    ploci	       ; address
.text:0040D7C7		       push    4Ch	       ; fieldtype
.text:0040D7C9		       push    [ebp+langid]    ; localehandle
.text:0040D7CC		       lea     ploci, [ebp+locinfo]
.text:0040D7CF		       push    ebx	       ; lc_type
.text:0040D7D0		       push    ploci	       ; plocinfo
.text:0040D7D1		       call    ___getlocaleinfo
.text:0040D7D6		       or      edi, ploci
.text:0040D7D8		       lea     ploci, [lc_time+5Ch]
.text:0040D7DB		       push    ploci	       ; address
.text:0040D7DC		       push    4Dh	       ; fieldtype
.text:0040D7DE		       push    [ebp+langid]    ; localehandle
.text:0040D7E1		       lea     ploci, [ebp+locinfo]
.text:0040D7E4		       push    ebx	       ; lc_type
.text:0040D7E5		       push    ploci	       ; plocinfo
.text:0040D7E6		       call    ___getlocaleinfo
.text:0040D7EB		       add     esp, 50h
.text:0040D7EE		       or      edi, ploci
.text:0040D7F0		       lea     ploci, [lc_time+60h]
.text:0040D7F3		       push    ploci	       ; address
.text:0040D7F4		       push    4Eh	       ; fieldtype
.text:0040D7F6		       push    [ebp+langid]    ; localehandle
.text:0040D7F9		       lea     ploci, [ebp+locinfo]
.text:0040D7FC		       push    ebx	       ; lc_type
.text:0040D7FD		       push    ploci	       ; plocinfo
.text:0040D7FE		       call    ___getlocaleinfo
.text:0040D803		       or      edi, ploci
.text:0040D805		       lea     ploci, [lc_time+64h]
.text:0040D808		       push    ploci	       ; address
.text:0040D809		       push    4Fh	       ; fieldtype
.text:0040D80B		       push    [ebp+langid]    ; localehandle
.text:0040D80E		       lea     ploci, [ebp+locinfo]
.text:0040D811		       push    ebx	       ; lc_type
.text:0040D812		       push    ploci	       ; plocinfo
.text:0040D813		       call    ___getlocaleinfo
.text:0040D818		       or      edi, ploci
.text:0040D81A		       lea     ploci, [lc_time+68h]
.text:0040D81D		       push    ploci	       ; address
.text:0040D81E		       push    38h	       ; fieldtype
.text:0040D820		       push    [ebp+langid]    ; localehandle
.text:0040D823		       lea     ploci, [ebp+locinfo]
.text:0040D826		       push    ebx	       ; lc_type
.text:0040D827		       push    ploci	       ; plocinfo
.text:0040D828		       call    ___getlocaleinfo
.text:0040D82D		       or      edi, ploci
.text:0040D82F		       lea     ploci, [lc_time+6Ch]
.text:0040D832		       push    ploci	       ; address
.text:0040D833		       push    39h	       ; fieldtype
.text:0040D835		       push    [ebp+langid]    ; localehandle
.text:0040D838		       lea     ploci, [ebp+locinfo]
.text:0040D83B		       push    ebx	       ; lc_type
.text:0040D83C		       push    ploci	       ; plocinfo
.text:0040D83D		       call    ___getlocaleinfo
.text:0040D842		       add     esp, 50h
.text:0040D845		       or      edi, ploci
.text:0040D847		       lea     ploci, [lc_time+70h]
.text:0040D84A		       push    ploci	       ; address
.text:0040D84B		       push    3Ah	       ; fieldtype
.text:0040D84D		       push    [ebp+langid]    ; localehandle
.text:0040D850		       lea     ploci, [ebp+locinfo]
.text:0040D853		       push    ebx	       ; lc_type
.text:0040D854		       push    ploci	       ; plocinfo
.text:0040D855		       call    ___getlocaleinfo
.text:0040D85A		       or      edi, ploci
.text:0040D85C		       lea     ploci, [lc_time+74h]
.text:0040D85F		       push    ploci	       ; address
.text:0040D860		       push    3Bh	       ; fieldtype
.text:0040D862		       push    [ebp+langid]    ; localehandle
.text:0040D865		       lea     ploci, [ebp+locinfo]
.text:0040D868		       push    ebx	       ; lc_type
.text:0040D869		       push    ploci	       ; plocinfo
.text:0040D86A		       call    ___getlocaleinfo
.text:0040D86F		       or      edi, ploci
.text:0040D871		       lea     ploci, [lc_time+78h]
.text:0040D874		       push    ploci	       ; address
.text:0040D875		       push    3Ch	       ; fieldtype
.text:0040D877		       push    [ebp+langid]    ; localehandle
.text:0040D87A		       lea     ploci, [ebp+locinfo]
.text:0040D87D		       push    ebx	       ; lc_type
.text:0040D87E		       push    ploci	       ; plocinfo
.text:0040D87F		       call    ___getlocaleinfo
.text:0040D884		       or      edi, ploci
.text:0040D886		       lea     ploci, [lc_time+7Ch]
.text:0040D889		       push    ploci	       ; address
.text:0040D88A		       push    3Dh	       ; fieldtype
.text:0040D88C		       push    [ebp+langid]    ; localehandle
.text:0040D88F		       lea     ploci, [ebp+locinfo]
.text:0040D892		       push    ebx	       ; lc_type
.text:0040D893		       push    ploci	       ; plocinfo
.text:0040D894		       call    ___getlocaleinfo
.text:0040D899		       add     esp, 50h
.text:0040D89C		       or      edi, ploci
.text:0040D89E		       lea     ploci, [lc_time+80h]
.text:0040D8A4		       push    ploci	       ; address
.text:0040D8A5		       push    3Eh	       ; fieldtype
.text:0040D8A7		       push    [ebp+langid]    ; localehandle
.text:0040D8AA		       lea     ploci, [ebp+locinfo]
.text:0040D8AD		       push    ebx	       ; lc_type
.text:0040D8AE		       push    ploci	       ; plocinfo
.text:0040D8AF		       call    ___getlocaleinfo
.text:0040D8B4		       or      edi, ploci
.text:0040D8B6		       lea     ploci, [lc_time+84h]
.text:0040D8BC		       push    ploci	       ; address
.text:0040D8BD		       push    3Fh	       ; fieldtype
.text:0040D8BF		       push    [ebp+langid]    ; localehandle
.text:0040D8C2		       lea     ploci, [ebp+locinfo]
.text:0040D8C5		       push    ebx	       ; lc_type
.text:0040D8C6		       push    ploci	       ; plocinfo
.text:0040D8C7		       call    ___getlocaleinfo
.text:0040D8CC		       or      edi, ploci
.text:0040D8CE		       lea     ploci, [lc_time+88h]
.text:0040D8D4		       push    ploci	       ; address
.text:0040D8D5		       push    40h	       ; fieldtype
.text:0040D8D7		       push    [ebp+langid]    ; localehandle
.text:0040D8DA		       push    ebx	       ; lc_type
.text:0040D8DB		       lea     ploci, [ebp+locinfo]
.text:0040D8DE		       push    ploci	       ; plocinfo
.text:0040D8DF		       call    ___getlocaleinfo
.text:0040D8E4		       or      edi, ploci
.text:0040D8E6		       lea     ploci, [lc_time+8Ch]
.text:0040D8EC		       push    ploci	       ; address
.text:0040D8ED		       push    41h	       ; fieldtype
.text:0040D8EF		       push    [ebp+langid]    ; localehandle
.text:0040D8F2		       lea     ploci, [ebp+locinfo]
.text:0040D8F5		       push    ebx	       ; lc_type
.text:0040D8F6		       push    ploci	       ; plocinfo
.text:0040D8F7		       call    ___getlocaleinfo
.text:0040D8FC		       add     esp, 50h
.text:0040D8FF		       or      edi, ploci
.text:0040D901		       lea     ploci, [lc_time+90h]
.text:0040D907		       push    ploci	       ; address
.text:0040D908		       push    42h	       ; fieldtype
.text:0040D90A		       push    [ebp+langid]    ; localehandle
.text:0040D90D		       lea     ploci, [ebp+locinfo]
.text:0040D910		       push    ebx	       ; lc_type
.text:0040D911		       push    ploci	       ; plocinfo
.text:0040D912		       call    ___getlocaleinfo
.text:0040D917		       or      edi, ploci
.text:0040D919		       lea     ploci, [lc_time+94h]
.text:0040D91F		       push    ploci	       ; address
.text:0040D920		       push    43h	       ; fieldtype
.text:0040D922		       push    [ebp+langid]    ; localehandle
.text:0040D925		       lea     ploci, [ebp+locinfo]
.text:0040D928		       push    ebx	       ; lc_type
.text:0040D929		       push    ploci	       ; plocinfo
.text:0040D92A		       call    ___getlocaleinfo
.text:0040D92F		       or      edi, ploci
.text:0040D931		       lea     ploci, [lc_time+98h]
.text:0040D937		       push    ploci	       ; address
.text:0040D938		       push    28h	       ; fieldtype
.text:0040D93A		       push    [ebp+langid]    ; localehandle
.text:0040D93D		       lea     ploci, [ebp+locinfo]
.text:0040D940		       push    ebx	       ; lc_type
.text:0040D941		       push    ploci	       ; plocinfo
.text:0040D942		       call    ___getlocaleinfo
.text:0040D947		       or      edi, ploci
.text:0040D949		       lea     ploci, [lc_time+9Ch]
.text:0040D94F		       push    ploci	       ; address
.text:0040D950		       push    29h	       ; fieldtype
.text:0040D952		       push    [ebp+langid]    ; localehandle
.text:0040D955		       lea     ploci, [ebp+locinfo]
.text:0040D958		       push    ebx	       ; lc_type
.text:0040D959		       push    ploci	       ; plocinfo
.text:0040D95A		       call    ___getlocaleinfo
.text:0040D95F		       add     esp, 50h
.text:0040D962		       or      edi, ploci
.text:0040D964		       lea     ploci, [lc_time+0A0h]
.text:0040D96A		       push    ploci	       ; address
.text:0040D96B		       push    1Fh	       ; fieldtype
.text:0040D96D		       push    [ebp+ctryid]    ; localehandle
.text:0040D970		       lea     ploci, [ebp+locinfo]
.text:0040D973		       push    ebx	       ; lc_type
.text:0040D974		       push    ploci	       ; plocinfo
.text:0040D975		       call    ___getlocaleinfo
.text:0040D97A		       or      edi, ploci
.text:0040D97C		       lea     ploci, [lc_time+0A4h]
.text:0040D982		       push    ploci	       ; address
.text:0040D983		       push    20h	       ; fieldtype
.text:0040D985		       push    [ebp+ctryid]    ; localehandle
.text:0040D988		       lea     ploci, [ebp+locinfo]
.text:0040D98B		       push    ebx	       ; lc_type
.text:0040D98C		       push    ploci	       ; plocinfo
.text:0040D98D		       call    ___getlocaleinfo
.text:0040D992		       or      edi, ploci
.text:0040D994		       lea     ploci, [lc_time+0A8h]
.text:0040D99A		       push    ploci	       ; address
.text:0040D99B		       push    1003h	       ; fieldtype
.text:0040D9A0		       push    [ebp+ctryid]    ; localehandle
.text:0040D9A3		       lea     ploci, [ebp+locinfo]
.text:0040D9A6		       push    ebx	       ; lc_type
.text:0040D9A7		       push    ploci	       ; plocinfo
.text:0040D9A8		       call    ___getlocaleinfo
.text:0040D9AD		       or      edi, ploci
.text:0040D9AF		       lea     ploci, [lc_time+0B0h]
.text:0040D9B5		       push    ploci	       ; address
.text:0040D9B6		       push    1009h	       ; fieldtype
.text:0040D9BB		       mov     ebx, [ebp+ctryid]
.text:0040D9BE		       push    ebx	       ; localehandle
.text:0040D9BF		       lea     ploci, [ebp+locinfo]
.text:0040D9C2		       push    0	       ; lc_type
.text:0040D9C4		       push    ploci	       ; plocinfo
.text:0040D9C5		       call    ___getlocaleinfo
.text:0040D9CA		       add     esp, 50h
.text:0040D9CD		       or      edi, ploci
.text:0040D9CF		       mov     ploci, edi
.text:0040D9D1		       pop     edi
.text:0040D9D2		       mov     [lc_time+0ACh], ebx
.text:0040D9D8		       pop     ebx
.text:0040D9D9		       leave
.text:0040D9DA		       retn
.text:0040D9DA _get_lc_time    endp
.text:0040D9DA
.text:0040D9DB
.text:0040D9DB ; =============== S U B R O U T I N E =======================================
.text:0040D9DB
.text:0040D9DB
.text:0040D9DB ; void __cdecl __free_lc_time(__lc_time_data *lc_time)
.text:0040D9DB ___free_lc_time proc near	       ; CODE XREF: ___freetlocinfo+E9p
.text:0040D9DB					       ; ___init_time+39p
.text:0040D9DB
.text:0040D9DB lc_time	       = dword ptr  4
.text:0040D9DB
.text:0040D9DB		       push    esi
.text:0040D9DC		       mov     esi, [esp+4+lc_time]
.text:0040D9E0		       test    esi, esi
.text:0040D9E2		       jz      loc_40DB69
.text:0040D9E8		       push    dword ptr [esi+4] ; pBlock
.text:0040D9EB		       call    _free
.text:0040D9F0		       push    dword ptr [esi+8] ; pBlock
.text:0040D9F3		       call    _free
.text:0040D9F8		       push    dword ptr [esi+0Ch] ; pBlock
.text:0040D9FB		       call    _free
.text:0040DA00		       push    dword ptr [esi+10h] ; pBlock
.text:0040DA03		       call    _free
.text:0040DA08		       push    dword ptr [esi+14h] ; pBlock
.text:0040DA0B		       call    _free
.text:0040DA10		       push    dword ptr [esi+18h] ; pBlock
.text:0040DA13		       call    _free
.text:0040DA18		       push    dword ptr [esi] ; pBlock
.text:0040DA1A		       call    _free
.text:0040DA1F		       push    dword ptr [esi+20h] ; pBlock
.text:0040DA22		       call    _free
.text:0040DA27		       push    dword ptr [esi+24h] ; pBlock
.text:0040DA2A		       call    _free
.text:0040DA2F		       push    dword ptr [esi+28h] ; pBlock
.text:0040DA32		       call    _free
.text:0040DA37		       push    dword ptr [esi+2Ch] ; pBlock
.text:0040DA3A		       call    _free
.text:0040DA3F		       push    dword ptr [esi+30h] ; pBlock
.text:0040DA42		       call    _free
.text:0040DA47		       push    dword ptr [esi+34h] ; pBlock
.text:0040DA4A		       call    _free
.text:0040DA4F		       push    dword ptr [esi+1Ch] ; pBlock
.text:0040DA52		       call    _free
.text:0040DA57		       push    dword ptr [esi+38h] ; pBlock
.text:0040DA5A		       call    _free
.text:0040DA5F		       push    dword ptr [esi+3Ch] ; pBlock
.text:0040DA62		       call    _free
.text:0040DA67		       add     esp, 40h
.text:0040DA6A		       push    dword ptr [esi+40h] ; pBlock
.text:0040DA6D		       call    _free
.text:0040DA72		       push    dword ptr [esi+44h] ; pBlock
.text:0040DA75		       call    _free
.text:0040DA7A		       push    dword ptr [esi+48h] ; pBlock
.text:0040DA7D		       call    _free
.text:0040DA82		       push    dword ptr [esi+4Ch] ; pBlock
.text:0040DA85		       call    _free
.text:0040DA8A		       push    dword ptr [esi+50h] ; pBlock
.text:0040DA8D		       call    _free
.text:0040DA92		       push    dword ptr [esi+54h] ; pBlock
.text:0040DA95		       call    _free
.text:0040DA9A		       push    dword ptr [esi+58h] ; pBlock
.text:0040DA9D		       call    _free
.text:0040DAA2		       push    dword ptr [esi+5Ch] ; pBlock
.text:0040DAA5		       call    _free
.text:0040DAAA		       push    dword ptr [esi+60h] ; pBlock
.text:0040DAAD		       call    _free
.text:0040DAB2		       push    dword ptr [esi+64h] ; pBlock
.text:0040DAB5		       call    _free
.text:0040DABA		       push    dword ptr [esi+68h] ; pBlock
.text:0040DABD		       call    _free
.text:0040DAC2		       push    dword ptr [esi+6Ch] ; pBlock
.text:0040DAC5		       call    _free
.text:0040DACA		       push    dword ptr [esi+70h] ; pBlock
.text:0040DACD		       call    _free
.text:0040DAD2		       push    dword ptr [esi+74h] ; pBlock
.text:0040DAD5		       call    _free
.text:0040DADA		       push    dword ptr [esi+78h] ; pBlock
.text:0040DADD		       call    _free
.text:0040DAE2		       push    dword ptr [esi+7Ch] ; pBlock
.text:0040DAE5		       call    _free
.text:0040DAEA		       add     esp, 40h
.text:0040DAED		       push    dword ptr [esi+80h] ; pBlock
.text:0040DAF3		       call    _free
.text:0040DAF8		       push    dword ptr [esi+84h] ; pBlock
.text:0040DAFE		       call    _free
.text:0040DB03		       push    dword ptr [esi+88h] ; pBlock
.text:0040DB09		       call    _free
.text:0040DB0E		       push    dword ptr [esi+8Ch] ; pBlock
.text:0040DB14		       call    _free
.text:0040DB19		       push    dword ptr [esi+90h] ; pBlock
.text:0040DB1F		       call    _free
.text:0040DB24		       push    dword ptr [esi+94h] ; pBlock
.text:0040DB2A		       call    _free
.text:0040DB2F		       push    dword ptr [esi+98h] ; pBlock
.text:0040DB35		       call    _free
.text:0040DB3A		       push    dword ptr [esi+9Ch] ; pBlock
.text:0040DB40		       call    _free
.text:0040DB45		       push    dword ptr [esi+0A0h] ; pBlock
.text:0040DB4B		       call    _free
.text:0040DB50		       push    dword ptr [esi+0A4h] ; pBlock
.text:0040DB56		       call    _free
.text:0040DB5B		       push    dword ptr [esi+0A8h] ; pBlock
.text:0040DB61		       call    _free
.text:0040DB66		       add     esp, 2Ch
.text:0040DB69
.text:0040DB69 loc_40DB69:			       ; CODE XREF: ___free_lc_time+7j
.text:0040DB69		       pop     esi
.text:0040DB6A		       retn
.text:0040DB6A ___free_lc_time endp
.text:0040DB6A
.text:0040DB6B
.text:0040DB6B ; =============== S U B R O U T I N E =======================================
.text:0040DB6B
.text:0040DB6B
.text:0040DB6B ; int __cdecl __init_time(threadlocaleinfostruct	*ploci)
.text:0040DB6B ___init_time    proc near	       ; DATA XREF: .rdata:0041F41Co
.text:0040DB6B
.text:0040DB6B ploci	       = dword ptr  4
.text:0040DB6B
.text:0040DB6B		       push    ebx
.text:0040DB6C		       push    ebp
.text:0040DB6D		       push    esi
.text:0040DB6E		       push    edi
.text:0040DB6F		       mov     edi, [esp+10h+ploci]
.text:0040DB73		       cmp     dword ptr [edi+20h], 0
.text:0040DB77		       mov     ebx, offset ___lc_time_c
.text:0040DB7C		       jz      short loc_40DBBB
.text:0040DB7E		       xor     ebp, ebp
.text:0040DB80		       push    0B8h	       ; size
.text:0040DB85		       inc     ebp
.text:0040DB86		       push    ebp	       ; count
.text:0040DB87		       call    __calloc_crt
.text:0040DB8C		       mov     esi, eax
.text:0040DB8E		       test    esi, esi
.text:0040DB90		       pop     ecx
.text:0040DB91		       pop     ecx
.text:0040DB92		       jnz     short loc_40DB98
.text:0040DB94
.text:0040DB94 loc_40DB94:			       ; CODE XREF: ___init_time+46j
.text:0040DB94		       mov     eax, ebp
.text:0040DB96		       jmp     short loc_40DBD9
.text:0040DB98 ; ---------------------------------------------------------------------------
.text:0040DB98
.text:0040DB98 loc_40DB98:			       ; CODE XREF: ___init_time+27j
.text:0040DB98		       mov     eax, edi	       ; ploci
.text:0040DB9A		       call    _get_lc_time
.text:0040DB9F		       test    eax, eax
.text:0040DBA1		       jz      short loc_40DBB3
.text:0040DBA3		       push    esi	       ; lc_time
.text:0040DBA4		       call    ___free_lc_time
.text:0040DBA9		       push    esi	       ; pBlock
.text:0040DBAA		       call    _free
.text:0040DBAF		       pop     ecx
.text:0040DBB0		       pop     ecx
.text:0040DBB1		       jmp     short loc_40DB94
.text:0040DBB3 ; ---------------------------------------------------------------------------
.text:0040DBB3
.text:0040DBB3 loc_40DBB3:			       ; CODE XREF: ___init_time+36j
.text:0040DBB3		       mov     [esi+0B4h], ebp
.text:0040DBB9		       jmp     short loc_40DBBD
.text:0040DBBB ; ---------------------------------------------------------------------------
.text:0040DBBB
.text:0040DBBB loc_40DBBB:			       ; CODE XREF: ___init_time+11j
.text:0040DBBB		       mov     esi, ebx
.text:0040DBBD
.text:0040DBBD loc_40DBBD:			       ; CODE XREF: ___init_time+4Ej
.text:0040DBBD		       add     edi, 0D4h
.text:0040DBC3		       mov     eax, [edi]
.text:0040DBC5		       cmp     eax, ebx
.text:0040DBC7		       jz      short loc_40DBD5
.text:0040DBC9		       add     eax, 0B4h
.text:0040DBCE		       push    eax	       ; lpAddend
.text:0040DBCF		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040DBD5
.text:0040DBD5 loc_40DBD5:			       ; CODE XREF: ___init_time+5Cj
.text:0040DBD5		       mov     [edi], esi
.text:0040DBD7		       xor     eax, eax
.text:0040DBD9
.text:0040DBD9 loc_40DBD9:			       ; CODE XREF: ___init_time+2Bj
.text:0040DBD9		       pop     edi
.text:0040DBDA		       pop     esi
.text:0040DBDB		       pop     ebp
.text:0040DBDC		       pop     ebx
.text:0040DBDD		       retn
.text:0040DBDD ___init_time    endp
.text:0040DBDD
.text:0040DBDE
.text:0040DBDE ; =============== S U B R O U T I N E =======================================
.text:0040DBDE
.text:0040DBDE
.text:0040DBDE ; void __usercall fix_grouping(char *grouping<ecx>)
.text:0040DBDE fix_grouping    proc near
.text:0040DBDE grouping	= ecx
.text:0040DBDE		       xor     dl, dl
.text:0040DBE0		       cmp     [grouping], dl
.text:0040DBE2		       jz      short locret_40DBFB
.text:0040DBE4		       push    ebx
.text:0040DBE5		       push    esi
.text:0040DBE6
.text:0040DBE6 loc_40DBE6:			       ; CODE XREF: fix_grouping+19j
.text:0040DBE6		       mov     al, [grouping]
.text:0040DBE8		       cmp     al, 30h
.text:0040DBEA		       jl      short loc_40DBFC
.text:0040DBEC		       cmp     al, 39h
.text:0040DBEE		       jg      short loc_40DBFC
.text:0040DBF0		       sub     al, 30h
.text:0040DBF2		       mov     [grouping], al
.text:0040DBF4
.text:0040DBF4 loc_40DBF4:			       ; CODE XREF: fix_grouping+20j
.text:0040DBF4		       inc     grouping
.text:0040DBF5
.text:0040DBF5 loc_40DBF5:			       ; CODE XREF: fix_grouping+31j
.text:0040DBF5		       cmp     [grouping], dl
.text:0040DBF7		       jnz     short loc_40DBE6
.text:0040DBF9		       pop     esi
.text:0040DBFA		       pop     ebx
.text:0040DBFB
.text:0040DBFB locret_40DBFB:			       ; CODE XREF: fix_grouping+4j
.text:0040DBFB		       retn
.text:0040DBFC ; ---------------------------------------------------------------------------
.text:0040DBFC
.text:0040DBFC loc_40DBFC:			       ; CODE XREF: fix_grouping+Cj
.text:0040DBFC					       ; fix_grouping+10j
.text:0040DBFC		       cmp     al, 3Bh
.text:0040DBFE		       jnz     short loc_40DBF4
.text:0040DC00		       mov     eax, grouping
.text:0040DC02
.text:0040DC02 loc_40DC02:			       ; CODE XREF: fix_grouping+2Fj
.text:0040DC02		       lea     esi, [eax+1]
.text:0040DC05		       mov     bl, [esi]
.text:0040DC07		       mov     [eax], bl
.text:0040DC09		       mov     eax, esi
.text:0040DC0B		       cmp     [eax], dl
.text:0040DC0D		       jnz     short loc_40DC02
.text:0040DC0F		       jmp     short loc_40DBF5
.text:0040DC0F fix_grouping    endp
.text:0040DC0F
.text:0040DC11
.text:0040DC11 ; =============== S U B R O U T I N E =======================================
.text:0040DC11
.text:0040DC11
.text:0040DC11 ; void __cdecl __free_lconv_num(lconv *l)
.text:0040DC11 ___free_lconv_num proc near	       ; CODE XREF: ___freetlocinfo+64p
.text:0040DC11					       ; ___init_numeric+F7p
.text:0040DC11
.text:0040DC11 l	       = dword ptr  4
.text:0040DC11
.text:0040DC11		       push    esi
.text:0040DC12		       mov     esi, [esp+4+l]
.text:0040DC16		       test    esi, esi
.text:0040DC18		       jz      short loc_40DC4F
.text:0040DC1A		       mov     eax, [esi]
.text:0040DC1C		       cmp     eax, ___lconv_c
.text:0040DC22		       jz      short loc_40DC2B
.text:0040DC24		       push    eax	       ; pBlock
.text:0040DC25		       call    _free
.text:0040DC2A		       pop     ecx
.text:0040DC2B
.text:0040DC2B loc_40DC2B:			       ; CODE XREF: ___free_lconv_num+11j
.text:0040DC2B		       mov     eax, [esi+4]
.text:0040DC2E		       cmp     eax, off_422E5C
.text:0040DC34		       jz      short loc_40DC3D
.text:0040DC36		       push    eax	       ; pBlock
.text:0040DC37		       call    _free
.text:0040DC3C		       pop     ecx
.text:0040DC3D
.text:0040DC3D loc_40DC3D:			       ; CODE XREF: ___free_lconv_num+23j
.text:0040DC3D		       mov     esi, [esi+8]
.text:0040DC40		       cmp     esi, off_422E60
.text:0040DC46		       jz      short loc_40DC4F
.text:0040DC48		       push    esi	       ; pBlock
.text:0040DC49		       call    _free
.text:0040DC4E		       pop     ecx
.text:0040DC4F
.text:0040DC4F loc_40DC4F:			       ; CODE XREF: ___free_lconv_num+7j
.text:0040DC4F					       ; ___free_lconv_num+35j
.text:0040DC4F		       pop     esi
.text:0040DC50		       retn
.text:0040DC50 ___free_lconv_num endp
.text:0040DC50
.text:0040DC51
.text:0040DC51 ; =============== S U B R O U T I N E =======================================
.text:0040DC51
.text:0040DC51 ; Attributes: bp-based frame
.text:0040DC51
.text:0040DC51 ; int __cdecl __init_numeric(threadlocaleinfostruct *ploci)
.text:0040DC51 ___init_numeric proc near	       ; DATA XREF: .rdata:0041F410o
.text:0040DC51
.text:0040DC51 locinfo	       = localeinfo_struct ptr -18h
.text:0040DC51 var_10	       = dword ptr -10h
.text:0040DC51 ret	       = dword ptr -0Ch
.text:0040DC51 lc_refcount     = dword ptr -8
.text:0040DC51 lconv_num_refcount= dword ptr -4
.text:0040DC51 lc	       = dword ptr  8
.text:0040DC51
.text:0040DC51		       push    ebp
.text:0040DC52		       mov     ebp, esp
.text:0040DC54		       sub     esp, 18h
.text:0040DC57		       push    ebx
.text:0040DC58		       mov     ebx, [ebp+lc]
.text:0040DC5B		       push    esi
.text:0040DC5C		       xor     esi, esi
.text:0040DC5E		       cmp     [ebx+1Ch], esi
.text:0040DC61		       push    edi
.text:0040DC62		       mov     [ebp+locinfo.locinfo], ebx
.text:0040DC65		       mov     [ebp+locinfo.mbcinfo], esi
.text:0040DC68		       jnz     short loc_40DC81
.text:0040DC6A		       cmp     [ebx+18h], esi
.text:0040DC6D		       jnz     short loc_40DC81
.text:0040DC6F		       mov     [ebp+lconv_num_refcount], esi
.text:0040DC72		       mov     [ebp+lc_refcount], esi
.text:0040DC75		       mov     [ebp+lc], offset	___lconv_c
.text:0040DC7C		       jmp     loc_40DDBB
.text:0040DC81 ; ---------------------------------------------------------------------------
.text:0040DC81
.text:0040DC81 loc_40DC81:			       ; CODE XREF: ___init_numeric+17j
.text:0040DC81					       ; ___init_numeric+1Cj
.text:0040DC81		       push    30h	       ; size
.text:0040DC83		       push    1	       ; count
.text:0040DC85		       call    __calloc_crt
.text:0040DC8A		       mov     edi, eax
.text:0040DC8C		       cmp     edi, esi
.text:0040DC8E		       pop     ecx
.text:0040DC8F		       pop     ecx
.text:0040DC90		       mov     [ebp+lc], edi
.text:0040DC93		       jnz     short loc_40DC9D
.text:0040DC95
.text:0040DC95 loc_40DC95:			       ; CODE XREF: ___init_numeric+71j
.text:0040DC95		       xor     eax, eax
.text:0040DC97		       inc     eax
.text:0040DC98		       jmp     loc_40DE14
.text:0040DC9D ; ---------------------------------------------------------------------------
.text:0040DC9D
.text:0040DC9D loc_40DC9D:			       ; CODE XREF: ___init_numeric+42j
.text:0040DC9D		       mov     esi, [ebx+0BCh]
.text:0040DCA3		       push    0Ch
.text:0040DCA5		       pop     ecx
.text:0040DCA6		       push    4	       ; cb
.text:0040DCA8		       rep movsd
.text:0040DCAA		       call    __malloc_crt
.text:0040DCAF		       xor     esi, esi
.text:0040DCB1		       cmp     eax, esi
.text:0040DCB3		       pop     ecx
.text:0040DCB4		       mov     [ebp+lc_refcount], eax
.text:0040DCB7		       jnz     short loc_40DCC4
.text:0040DCB9		       push    [ebp+lc]	       ; pBlock
.text:0040DCBC		       call    _free
.text:0040DCC1		       pop     ecx
.text:0040DCC2		       jmp     short loc_40DC95
.text:0040DCC4 ; ---------------------------------------------------------------------------
.text:0040DCC4
.text:0040DCC4 loc_40DCC4:			       ; CODE XREF: ___init_numeric+66j
.text:0040DCC4		       mov     [eax], esi
.text:0040DCC6		       cmp     [ebx+1Ch], esi
.text:0040DCC9		       jz      loc_40DD8A
.text:0040DCCF		       push    4	       ; cb
.text:0040DCD1		       call    __malloc_crt
.text:0040DCD6		       cmp     eax, esi
.text:0040DCD8		       pop     ecx
.text:0040DCD9		       mov     [ebp+lconv_num_refcount], eax
.text:0040DCDC		       jnz     short loc_40DCFA
.text:0040DCDE		       xor     esi, esi
.text:0040DCE0		       inc     esi
.text:0040DCE1
.text:0040DCE1 loc_40DCE1:			       ; CODE XREF: ___init_numeric+100j
.text:0040DCE1		       push    [ebp+lc]	       ; pBlock
.text:0040DCE4		       call    _free
.text:0040DCE9		       push    [ebp+lc_refcount] ; pBlock
.text:0040DCEC		       call    _free
.text:0040DCF1		       pop     ecx
.text:0040DCF2		       pop     ecx
.text:0040DCF3		       mov     eax, esi
.text:0040DCF5		       jmp     loc_40DE14
.text:0040DCFA ; ---------------------------------------------------------------------------
.text:0040DCFA
.text:0040DCFA loc_40DCFA:			       ; CODE XREF: ___init_numeric+8Bj
.text:0040DCFA		       mov     [eax], esi
.text:0040DCFC		       mov     esi, [ebp+lc]
.text:0040DCFF		       movzx   edi, word ptr [ebx+3Eh]
.text:0040DD03		       push    esi	       ; address
.text:0040DD04		       push    0Eh	       ; fieldtype
.text:0040DD06		       push    edi	       ; localehandle
.text:0040DD07		       lea     eax, [ebp+locinfo]
.text:0040DD0A		       push    1	       ; lc_type
.text:0040DD0C		       push    eax	       ; plocinfo
.text:0040DD0D		       call    ___getlocaleinfo
.text:0040DD12		       mov     [ebp+ret], eax
.text:0040DD15		       lea     eax, [esi+4]
.text:0040DD18		       push    eax	       ; address
.text:0040DD19		       push    0Fh	       ; fieldtype
.text:0040DD1B		       push    edi	       ; localehandle
.text:0040DD1C		       lea     eax, [ebp+locinfo]
.text:0040DD1F		       push    1	       ; lc_type
.text:0040DD21		       push    eax	       ; plocinfo
.text:0040DD22		       call    ___getlocaleinfo
.text:0040DD27		       or      [ebp+ret], eax
.text:0040DD2A		       lea     eax, [esi+8]
.text:0040DD2D		       push    eax	       ; address
.text:0040DD2E		       push    10h	       ; fieldtype
.text:0040DD30		       push    edi	       ; localehandle
.text:0040DD31		       mov     [ebp+var_10], eax
.text:0040DD34		       lea     eax, [ebp+locinfo]
.text:0040DD37		       push    1	       ; lc_type
.text:0040DD39		       push    eax	       ; plocinfo
.text:0040DD3A		       call    ___getlocaleinfo
.text:0040DD3F		       add     esp, 3Ch
.text:0040DD42		       or      eax, [ebp+ret]
.text:0040DD45		       jz      short loc_40DD53
.text:0040DD47		       push    esi	       ; l
.text:0040DD48		       call    ___free_lconv_num
.text:0040DD4D		       pop     ecx
.text:0040DD4E		       or      esi, 0FFFFFFFFh
.text:0040DD51		       jmp     short loc_40DCE1
.text:0040DD53 ; ---------------------------------------------------------------------------
.text:0040DD53
.text:0040DD53 loc_40DD53:			       ; CODE XREF: ___init_numeric+F4j
.text:0040DD53		       mov     eax, [ebp+var_10]
.text:0040DD56		       mov     eax, [eax]
.text:0040DD58		       jmp     short loc_40DD6C
.text:0040DD5A ; ---------------------------------------------------------------------------
.text:0040DD5A
.text:0040DD5A loc_40DD5A:			       ; CODE XREF: ___init_numeric+11Ej
.text:0040DD5A		       mov     cl, [eax]
.text:0040DD5C		       cmp     cl, 30h
.text:0040DD5F		       jl      short loc_40DD73
.text:0040DD61		       cmp     cl, 39h
.text:0040DD64		       jg      short loc_40DD73
.text:0040DD66		       sub     cl, 30h
.text:0040DD69		       mov     [eax], cl
.text:0040DD6B
.text:0040DD6B loc_40DD6B:			       ; CODE XREF: ___init_numeric+125j
.text:0040DD6B		       inc     eax
.text:0040DD6C
.text:0040DD6C loc_40DD6C:			       ; CODE XREF: ___init_numeric+107j
.text:0040DD6C					       ; ___init_numeric+137j
.text:0040DD6C		       cmp     byte ptr	[eax], 0
.text:0040DD6F		       jnz     short loc_40DD5A
.text:0040DD71		       jmp     short loc_40DDAA
.text:0040DD73 ; ---------------------------------------------------------------------------
.text:0040DD73
.text:0040DD73 loc_40DD73:			       ; CODE XREF: ___init_numeric+10Ej
.text:0040DD73					       ; ___init_numeric+113j
.text:0040DD73		       cmp     cl, 3Bh
.text:0040DD76		       jnz     short loc_40DD6B
.text:0040DD78		       mov     esi, eax
.text:0040DD7A
.text:0040DD7A loc_40DD7A:			       ; CODE XREF: ___init_numeric+135j
.text:0040DD7A		       lea     edi, [esi+1]
.text:0040DD7D		       mov     cl, [edi]
.text:0040DD7F		       mov     [esi], cl
.text:0040DD81		       mov     esi, edi
.text:0040DD83		       cmp     byte ptr	[esi], 0
.text:0040DD86		       jnz     short loc_40DD7A
.text:0040DD88		       jmp     short loc_40DD6C
.text:0040DD8A ; ---------------------------------------------------------------------------
.text:0040DD8A
.text:0040DD8A loc_40DD8A:			       ; CODE XREF: ___init_numeric+78j
.text:0040DD8A		       mov     ecx, ___lconv_c
.text:0040DD90		       mov     eax, [ebp+lc]
.text:0040DD93		       mov     [eax], ecx
.text:0040DD95		       mov     ecx, off_422E5C
.text:0040DD9B		       mov     [eax+4],	ecx
.text:0040DD9E		       mov     ecx, off_422E60
.text:0040DDA4		       mov     [ebp+lconv_num_refcount], esi
.text:0040DDA7		       mov     [eax+8],	ecx
.text:0040DDAA
.text:0040DDAA loc_40DDAA:			       ; CODE XREF: ___init_numeric+120j
.text:0040DDAA		       mov     eax, [ebp+lc_refcount]
.text:0040DDAD		       xor     ecx, ecx
.text:0040DDAF		       inc     ecx
.text:0040DDB0		       mov     [eax], ecx
.text:0040DDB2		       mov     eax, [ebp+lconv_num_refcount]
.text:0040DDB5		       test    eax, eax
.text:0040DDB7		       jz      short loc_40DDBB
.text:0040DDB9		       mov     [eax], ecx
.text:0040DDBB
.text:0040DDBB loc_40DDBB:			       ; CODE XREF: ___init_numeric+2Bj
.text:0040DDBB					       ; ___init_numeric+166j
.text:0040DDBB		       mov     eax, [ebx+0B4h]
.text:0040DDC1		       test    eax, eax
.text:0040DDC3		       mov     esi, ds:__imp__InterlockedDecrement@4 ; InterlockedDecrement(x)
.text:0040DDC9		       jz      short loc_40DDCE
.text:0040DDCB		       push    eax	       ; lpAddend
.text:0040DDCC		       call    esi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:0040DDCE
.text:0040DDCE loc_40DDCE:			       ; CODE XREF: ___init_numeric+178j
.text:0040DDCE		       mov     eax, [ebx+0B0h]
.text:0040DDD4		       test    eax, eax
.text:0040DDD6		       jz      short loc_40DDF7
.text:0040DDD8		       push    eax	       ; lpAddend
.text:0040DDD9		       call    esi ; InterlockedDecrement(x) ; InterlockedDecrement(x)
.text:0040DDDB		       test    eax, eax
.text:0040DDDD		       jnz     short loc_40DDF7
.text:0040DDDF		       push    dword ptr [ebx+0B0h] ; pBlock
.text:0040DDE5		       call    _free
.text:0040DDEA		       push    dword ptr [ebx+0BCh] ; pBlock
.text:0040DDF0		       call    _free
.text:0040DDF5		       pop     ecx
.text:0040DDF6		       pop     ecx
.text:0040DDF7
.text:0040DDF7 loc_40DDF7:			       ; CODE XREF: ___init_numeric+185j
.text:0040DDF7					       ; ___init_numeric+18Cj
.text:0040DDF7		       mov     eax, [ebp+lconv_num_refcount]
.text:0040DDFA		       mov     [ebx+0B4h], eax
.text:0040DE00		       mov     eax, [ebp+lc_refcount]
.text:0040DE03		       mov     [ebx+0B0h], eax
.text:0040DE09		       mov     eax, [ebp+lc]
.text:0040DE0C		       mov     [ebx+0BCh], eax
.text:0040DE12		       xor     eax, eax
.text:0040DE14
.text:0040DE14 loc_40DE14:			       ; CODE XREF: ___init_numeric+47j
.text:0040DE14					       ; ___init_numeric+A4j
.text:0040DE14		       pop     edi
.text:0040DE15		       pop     esi
.text:0040DE16		       pop     ebx
.text:0040DE17		       leave
.text:0040DE18		       retn
.text:0040DE18 ___init_numeric endp
.text:0040DE18
.text:0040DE19
.text:0040DE19 ; =============== S U B R O U T I N E =======================================
.text:0040DE19
.text:0040DE19
.text:0040DE19 ; void __usercall fix_grouping_0(char *grouping<ecx>)
.text:0040DE19 fix_grouping_0  proc near
.text:0040DE19 grouping	= ecx
.text:0040DE19		       xor     dl, dl
.text:0040DE1B		       cmp     [grouping], dl
.text:0040DE1D		       jz      short locret_40DE36
.text:0040DE1F		       push    ebx
.text:0040DE20		       push    esi
.text:0040DE21
.text:0040DE21 loc_40DE21:			       ; CODE XREF: fix_grouping_0+19j
.text:0040DE21		       mov     al, [grouping]
.text:0040DE23		       cmp     al, 30h
.text:0040DE25		       jl      short loc_40DE37
.text:0040DE27		       cmp     al, 39h
.text:0040DE29		       jg      short loc_40DE37
.text:0040DE2B		       sub     al, 30h
.text:0040DE2D		       mov     [grouping], al
.text:0040DE2F
.text:0040DE2F loc_40DE2F:			       ; CODE XREF: fix_grouping_0+20j
.text:0040DE2F		       inc     grouping
.text:0040DE30
.text:0040DE30 loc_40DE30:			       ; CODE XREF: fix_grouping_0+31j
.text:0040DE30		       cmp     [grouping], dl
.text:0040DE32		       jnz     short loc_40DE21
.text:0040DE34		       pop     esi
.text:0040DE35		       pop     ebx
.text:0040DE36
.text:0040DE36 locret_40DE36:			       ; CODE XREF: fix_grouping_0+4j
.text:0040DE36		       retn
.text:0040DE37 ; ---------------------------------------------------------------------------
.text:0040DE37
.text:0040DE37 loc_40DE37:			       ; CODE XREF: fix_grouping_0+Cj
.text:0040DE37					       ; fix_grouping_0+10j
.text:0040DE37		       cmp     al, 3Bh
.text:0040DE39		       jnz     short loc_40DE2F
.text:0040DE3B		       mov     eax, grouping
.text:0040DE3D
.text:0040DE3D loc_40DE3D:			       ; CODE XREF: fix_grouping_0+2Fj
.text:0040DE3D		       lea     esi, [eax+1]
.text:0040DE40		       mov     bl, [esi]
.text:0040DE42		       mov     [eax], bl
.text:0040DE44		       mov     eax, esi
.text:0040DE46		       cmp     [eax], dl
.text:0040DE48		       jnz     short loc_40DE3D
.text:0040DE4A		       jmp     short loc_40DE30
.text:0040DE4A fix_grouping_0  endp
.text:0040DE4A
.text:0040DE4C
.text:0040DE4C ; =============== S U B R O U T I N E =======================================
.text:0040DE4C
.text:0040DE4C
.text:0040DE4C ; void __cdecl __free_lconv_mon(lconv *l)
.text:0040DE4C ___free_lconv_mon proc near	       ; CODE XREF: ___freetlocinfo+43p
.text:0040DE4C					       ; ___init_monetary+1CEp
.text:0040DE4C
.text:0040DE4C l	       = dword ptr  4
.text:0040DE4C
.text:0040DE4C		       push    esi
.text:0040DE4D		       mov     esi, [esp+4+l]
.text:0040DE51		       test    esi, esi
.text:0040DE53		       jz      short loc_40DED3
.text:0040DE55		       mov     eax, [esi+0Ch]
.text:0040DE58		       cmp     eax, off_422E64
.text:0040DE5E		       jz      short loc_40DE67
.text:0040DE60		       push    eax	       ; pBlock
.text:0040DE61		       call    _free
.text:0040DE66		       pop     ecx
.text:0040DE67
.text:0040DE67 loc_40DE67:			       ; CODE XREF: ___free_lconv_mon+12j
.text:0040DE67		       mov     eax, [esi+10h]
.text:0040DE6A		       cmp     eax, off_422E68
.text:0040DE70		       jz      short loc_40DE79
.text:0040DE72		       push    eax	       ; pBlock
.text:0040DE73		       call    _free
.text:0040DE78		       pop     ecx
.text:0040DE79
.text:0040DE79 loc_40DE79:			       ; CODE XREF: ___free_lconv_mon+24j
.text:0040DE79		       mov     eax, [esi+14h]
.text:0040DE7C		       cmp     eax, off_422E6C
.text:0040DE82		       jz      short loc_40DE8B
.text:0040DE84		       push    eax	       ; pBlock
.text:0040DE85		       call    _free
.text:0040DE8A		       pop     ecx
.text:0040DE8B
.text:0040DE8B loc_40DE8B:			       ; CODE XREF: ___free_lconv_mon+36j
.text:0040DE8B		       mov     eax, [esi+18h]
.text:0040DE8E		       cmp     eax, off_422E70
.text:0040DE94		       jz      short loc_40DE9D
.text:0040DE96		       push    eax	       ; pBlock
.text:0040DE97		       call    _free
.text:0040DE9C		       pop     ecx
.text:0040DE9D
.text:0040DE9D loc_40DE9D:			       ; CODE XREF: ___free_lconv_mon+48j
.text:0040DE9D		       mov     eax, [esi+1Ch]
.text:0040DEA0		       cmp     eax, off_422E74
.text:0040DEA6		       jz      short loc_40DEAF
.text:0040DEA8		       push    eax	       ; pBlock
.text:0040DEA9		       call    _free
.text:0040DEAE		       pop     ecx
.text:0040DEAF
.text:0040DEAF loc_40DEAF:			       ; CODE XREF: ___free_lconv_mon+5Aj
.text:0040DEAF		       mov     eax, [esi+20h]
.text:0040DEB2		       cmp     eax, off_422E78
.text:0040DEB8		       jz      short loc_40DEC1
.text:0040DEBA		       push    eax	       ; pBlock
.text:0040DEBB		       call    _free
.text:0040DEC0		       pop     ecx
.text:0040DEC1
.text:0040DEC1 loc_40DEC1:			       ; CODE XREF: ___free_lconv_mon+6Cj
.text:0040DEC1		       mov     esi, [esi+24h]
.text:0040DEC4		       cmp     esi, off_422E7C
.text:0040DECA		       jz      short loc_40DED3
.text:0040DECC		       push    esi	       ; pBlock
.text:0040DECD		       call    _free
.text:0040DED2		       pop     ecx
.text:0040DED3
.text:0040DED3 loc_40DED3:			       ; CODE XREF: ___free_lconv_mon+7j
.text:0040DED3					       ; ___free_lconv_mon+7Ej
.text:0040DED3		       pop     esi
.text:0040DED4		       retn
.text:0040DED4 ___free_lconv_mon endp
.text:0040DED4
.text:0040DED5
.text:0040DED5 ; =============== S U B R O U T I N E =======================================
.text:0040DED5
.text:0040DED5 ; Attributes: bp-based frame
.text:0040DED5
.text:0040DED5 ; int __cdecl __init_monetary(threadlocaleinfostruct *ploci)
.text:0040DED5 ___init_monetary	proc near	       ; DATA XREF: .rdata:0041F404o
.text:0040DED5
.text:0040DED5 locinfo	       = localeinfo_struct ptr -10h
.text:0040DED5 lc_refcount     = dword ptr -8
.text:0040DED5 lconv_mon_refcount= dword ptr -4
.text:0040DED5 ploci	       = dword ptr  8
.text:0040DED5
.text:0040DED5		       push    ebp
.text:0040DED6		       mov     ebp, esp
.text:0040DED8		       sub     esp, 10h
.text:0040DEDB		       push    ebx
.text:0040DEDC		       push    esi
.text:0040DEDD		       mov     esi, [ebp+ploci]
.text:0040DEE0		       push    edi
.text:0040DEE1		       xor     edi, edi
.text:0040DEE3		       cmp     [esi+18h], edi
.text:0040DEE6		       mov     [ebp+lconv_mon_refcount], edi
.text:0040DEE9		       mov     [ebp+locinfo.locinfo], esi
.text:0040DEEC		       mov     [ebp+locinfo.mbcinfo], edi
.text:0040DEEF		       jnz     short loc_40DF06
.text:0040DEF1		       cmp     [esi+1Ch], edi
.text:0040DEF4		       jnz     short loc_40DF06
.text:0040DEF6		       mov     [ebp+lconv_mon_refcount], edi
.text:0040DEF9		       mov     [ebp+lc_refcount], edi
.text:0040DEFC		       mov     ebx, offset ___lconv_c
.text:0040DF01		       jmp     loc_40E13C
.text:0040DF06 ; ---------------------------------------------------------------------------
.text:0040DF06
.text:0040DF06 loc_40DF06:			       ; CODE XREF: ___init_monetary+1Aj
.text:0040DF06					       ; ___init_monetary+1Fj
.text:0040DF06		       push    30h	       ; size
.text:0040DF08		       push    1	       ; count
.text:0040DF0A		       call    __calloc_crt
.text:0040DF0F		       mov     ebx, eax
.text:0040DF11		       cmp     ebx, edi
.text:0040DF13		       pop     ecx
.text:0040DF14		       pop     ecx
.text:0040DF15		       jnz     short loc_40DF1F
.text:0040DF17
.text:0040DF17 loc_40DF17:			       ; CODE XREF: ___init_monetary+60j
.text:0040DF17					       ; ___init_monetary+1ECj
.text:0040DF17		       xor     eax, eax
.text:0040DF19		       inc     eax
.text:0040DF1A		       jmp     loc_40E194
.text:0040DF1F ; ---------------------------------------------------------------------------
.text:0040DF1F
.text:0040DF1F loc_40DF1F:			       ; CODE XREF: ___init_monetary+40j
.text:0040DF1F		       push    4	       ; cb
.text:0040DF21		       call    __malloc_crt
.text:0040DF26		       cmp     eax, edi
.text:0040DF28		       pop     ecx
.text:0040DF29		       mov     [ebp+lc_refcount], eax
.text:0040DF2C		       jnz     short loc_40DF37
.text:0040DF2E		       push    ebx	       ; pBlock
.text:0040DF2F		       call    _free
.text:0040DF34
.text:0040DF34 loc_40DF34:			       ; CODE XREF: ___init_monetary+8Bj
.text:0040DF34		       pop     ecx
.text:0040DF35		       jmp     short loc_40DF17
.text:0040DF37 ; ---------------------------------------------------------------------------
.text:0040DF37
.text:0040DF37 loc_40DF37:			       ; CODE XREF: ___init_monetary+57j
.text:0040DF37		       mov     [eax], edi
.text:0040DF39		       cmp     [esi+18h], edi
.text:0040DF3C		       jz      loc_40E0FB
.text:0040DF42		       push    4	       ; cb
.text:0040DF44		       call    __malloc_crt
.text:0040DF49		       cmp     eax, edi
.text:0040DF4B		       pop     ecx
.text:0040DF4C		       mov     [ebp+lconv_mon_refcount], eax
.text:0040DF4F		       jnz     short loc_40DF62
.text:0040DF51		       push    ebx	       ; pBlock
.text:0040DF52		       call    _free
.text:0040DF57		       push    [ebp+lc_refcount] ; pBlock
.text:0040DF5A		       call    _free
.text:0040DF5F		       pop     ecx
.text:0040DF60		       jmp     short loc_40DF34
.text:0040DF62 ; ---------------------------------------------------------------------------
.text:0040DF62
.text:0040DF62 loc_40DF62:			       ; CODE XREF: ___init_monetary+7Aj
.text:0040DF62		       mov     [eax], edi
.text:0040DF64		       movzx   esi, word ptr [esi+38h]
.text:0040DF68		       lea     eax, [ebx+0Ch]
.text:0040DF6B		       push    eax	       ; address
.text:0040DF6C		       push    15h	       ; fieldtype
.text:0040DF6E		       push    esi	       ; localehandle
.text:0040DF6F		       lea     eax, [ebp+locinfo]
.text:0040DF72		       push    1	       ; lc_type
.text:0040DF74		       push    eax	       ; plocinfo
.text:0040DF75		       call    ___getlocaleinfo
.text:0040DF7A		       mov     edi, eax
.text:0040DF7C		       lea     eax, [ebx+10h]
.text:0040DF7F		       push    eax	       ; address
.text:0040DF80		       push    14h	       ; fieldtype
.text:0040DF82		       push    esi	       ; localehandle
.text:0040DF83		       lea     eax, [ebp+locinfo]
.text:0040DF86		       push    1	       ; lc_type
.text:0040DF88		       push    eax	       ; plocinfo
.text:0040DF89		       call    ___getlocaleinfo
.text:0040DF8E		       or      edi, eax
.text:0040DF90		       lea     eax, [ebx+14h]
.text:0040DF93		       push    eax	       ; address
.text:0040DF94		       push    16h	       ; fieldtype
.text:0040DF96		       push    esi	       ; localehandle
.text:0040DF97		       lea     eax, [ebp+locinfo]
.text:0040DF9A		       push    1	       ; lc_type
.text:0040DF9C		       push    eax	       ; plocinfo
.text:0040DF9D		       call    ___getlocaleinfo
.text:0040DFA2		       or      edi, eax
.text:0040DFA4		       lea     eax, [ebx+18h]
.text:0040DFA7		       push    eax	       ; address
.text:0040DFA8		       push    17h	       ; fieldtype
.text:0040DFAA		       push    esi	       ; localehandle
.text:0040DFAB		       lea     eax, [ebp+locinfo]
.text:0040DFAE		       push    1	       ; lc_type
.text:0040DFB0		       push    eax	       ; plocinfo
.text:0040DFB1		       call    ___getlocaleinfo
.text:0040DFB6		       add     esp, 50h
.text:0040DFB9		       or      edi, eax
.text:0040DFBB		       lea     eax, [ebx+1Ch]
.text:0040DFBE		       push    eax	       ; address
.text:0040DFBF		       push    18h	       ; fieldtype
.text:0040DFC1		       push    esi	       ; localehandle
.text:0040DFC2		       lea     eax, [ebp+locinfo]
.text:0040DFC5		       push    1	       ; lc_type
.text:0040DFC7		       push    eax	       ; plocinfo
.text:0040DFC8		       call    ___getlocaleinfo
.text:0040DFCD		       or      edi, eax
.text:0040DFCF		       lea     eax, [ebx+20h]
.text:0040DFD2		       push    eax	       ; address
.text:0040DFD3		       push    50h	       ; fieldtype
.text:0040DFD5		       push    esi	       ; localehandle
.text:0040DFD6		       lea     eax, [ebp+locinfo]
.text:0040DFD9		       push    1	       ; lc_type
.text:0040DFDB		       push    eax	       ; plocinfo
.text:0040DFDC		       call    ___getlocaleinfo
.text:0040DFE1		       or      edi, eax
.text:0040DFE3		       lea     eax, [ebx+24h]
.text:0040DFE6		       push    eax	       ; address
.text:0040DFE7		       push    51h	       ; fieldtype
.text:0040DFE9		       push    esi	       ; localehandle
.text:0040DFEA		       lea     eax, [ebp+locinfo]
.text:0040DFED		       push    1	       ; lc_type
.text:0040DFEF		       push    eax	       ; plocinfo
.text:0040DFF0		       call    ___getlocaleinfo
.text:0040DFF5		       or      edi, eax
.text:0040DFF7		       lea     eax, [ebx+28h]
.text:0040DFFA		       push    eax	       ; address
.text:0040DFFB		       push    1Ah	       ; fieldtype
.text:0040DFFD		       push    esi	       ; localehandle
.text:0040DFFE		       lea     eax, [ebp+locinfo]
.text:0040E001		       push    0	       ; lc_type
.text:0040E003		       push    eax	       ; plocinfo
.text:0040E004		       call    ___getlocaleinfo
.text:0040E009		       add     esp, 50h
.text:0040E00C		       or      edi, eax
.text:0040E00E		       lea     eax, [ebx+29h]
.text:0040E011		       push    eax	       ; address
.text:0040E012		       push    19h	       ; fieldtype
.text:0040E014		       push    esi	       ; localehandle
.text:0040E015		       push    0	       ; lc_type
.text:0040E017		       lea     eax, [ebp+locinfo]
.text:0040E01A		       push    eax	       ; plocinfo
.text:0040E01B		       call    ___getlocaleinfo
.text:0040E020		       or      edi, eax
.text:0040E022		       lea     eax, [ebx+2Ah]
.text:0040E025		       push    eax	       ; address
.text:0040E026		       push    54h	       ; fieldtype
.text:0040E028		       push    esi	       ; localehandle
.text:0040E029		       lea     eax, [ebp+locinfo]
.text:0040E02C		       push    0	       ; lc_type
.text:0040E02E		       push    eax	       ; plocinfo
.text:0040E02F		       call    ___getlocaleinfo
.text:0040E034		       or      edi, eax
.text:0040E036		       lea     eax, [ebx+2Bh]
.text:0040E039		       push    eax	       ; address
.text:0040E03A		       push    55h	       ; fieldtype
.text:0040E03C		       push    esi	       ; localehandle
.text:0040E03D		       lea     eax, [ebp+locinfo]
.text:0040E040		       push    0	       ; lc_type
.text:0040E042		       push    eax	       ; plocinfo
.text:0040E043		       call    ___getlocaleinfo
.text:0040E048		       or      edi, eax
.text:0040E04A		       lea     eax, [ebx+2Ch]
.text:0040E04D		       push    eax	       ; address
.text:0040E04E		       push    56h	       ; fieldtype
.text:0040E050		       push    esi	       ; localehandle
.text:0040E051		       lea     eax, [ebp+locinfo]
.text:0040E054		       push    0	       ; lc_type
.text:0040E056		       push    eax	       ; plocinfo
.text:0040E057		       call    ___getlocaleinfo
.text:0040E05C		       add     esp, 50h
.text:0040E05F		       or      edi, eax
.text:0040E061		       lea     eax, [ebx+2Dh]
.text:0040E064		       push    eax	       ; address
.text:0040E065		       push    57h	       ; fieldtype
.text:0040E067		       push    esi	       ; localehandle
.text:0040E068		       lea     eax, [ebp+locinfo]
.text:0040E06B		       push    0	       ; lc_type
.text:0040E06D		       push    eax	       ; plocinfo
.text:0040E06E		       call    ___getlocaleinfo
.text:0040E073		       or      edi, eax
.text:0040E075		       lea     eax, [ebx+2Eh]
.text:0040E078		       push    eax	       ; address
.text:0040E079		       push    52h	       ; fieldtype
.text:0040E07B		       push    esi	       ; localehandle
.text:0040E07C		       lea     eax, [ebp+locinfo]
.text:0040E07F		       push    0	       ; lc_type
.text:0040E081		       push    eax	       ; plocinfo
.text:0040E082		       call    ___getlocaleinfo
.text:0040E087		       or      edi, eax
.text:0040E089		       lea     eax, [ebx+2Fh]
.text:0040E08C		       push    eax	       ; address
.text:0040E08D		       push    53h	       ; fieldtype
.text:0040E08F		       push    esi	       ; localehandle
.text:0040E090		       lea     eax, [ebp+locinfo]
.text:0040E093		       push    0	       ; lc_type
.text:0040E095		       push    eax	       ; plocinfo
.text:0040E096		       call    ___getlocaleinfo
.text:0040E09B		       add     esp, 3Ch
.text:0040E09E		       or      eax, edi
.text:0040E0A0		       jz      short loc_40E0C6
.text:0040E0A2		       push    ebx	       ; l
.text:0040E0A3		       call    ___free_lconv_mon
.text:0040E0A8		       push    ebx	       ; pBlock
.text:0040E0A9		       call    _free
.text:0040E0AE		       push    [ebp+lc_refcount] ; pBlock
.text:0040E0B1		       call    _free
.text:0040E0B6		       push    [ebp+lconv_mon_refcount]	; pBlock
.text:0040E0B9		       call    _free
.text:0040E0BE		       add     esp, 10h
.text:0040E0C1		       jmp     loc_40DF17
.text:0040E0C6 ; ---------------------------------------------------------------------------
.text:0040E0C6
.text:0040E0C6 loc_40E0C6:			       ; CODE XREF: ___init_monetary+1CBj
.text:0040E0C6		       mov     eax, [ebx+1Ch]
.text:0040E0C9		       jmp     short loc_40E0DD
.text:0040E0CB ; ---------------------------------------------------------------------------
.text:0040E0CB
.text:0040E0CB loc_40E0CB:			       ; CODE XREF: ___init_monetary+20Bj
.text:0040E0CB		       mov     cl, [eax]
.text:0040E0CD		       cmp     cl, 30h
.text:0040E0D0		       jl      short loc_40E0E4
.text:0040E0D2		       cmp     cl, 39h
.text:0040E0D5		       jg      short loc_40E0E4
.text:0040E0D7		       sub     cl, 30h
.text:0040E0DA		       mov     [eax], cl
.text:0040E0DC
.text:0040E0DC loc_40E0DC:			       ; CODE XREF: ___init_monetary+212j
.text:0040E0DC		       inc     eax
.text:0040E0DD
.text:0040E0DD loc_40E0DD:			       ; CODE XREF: ___init_monetary+1F4j
.text:0040E0DD					       ; ___init_monetary+224j
.text:0040E0DD		       cmp     byte ptr	[eax], 0
.text:0040E0E0		       jnz     short loc_40E0CB
.text:0040E0E2		       jmp     short loc_40E107
.text:0040E0E4 ; ---------------------------------------------------------------------------
.text:0040E0E4
.text:0040E0E4 loc_40E0E4:			       ; CODE XREF: ___init_monetary+1FBj
.text:0040E0E4					       ; ___init_monetary+200j
.text:0040E0E4		       cmp     cl, 3Bh
.text:0040E0E7		       jnz     short loc_40E0DC
.text:0040E0E9		       mov     esi, eax
.text:0040E0EB
.text:0040E0EB loc_40E0EB:			       ; CODE XREF: ___init_monetary+222j
.text:0040E0EB		       lea     edi, [esi+1]
.text:0040E0EE		       mov     cl, [edi]
.text:0040E0F0		       mov     [esi], cl
.text:0040E0F2		       mov     esi, edi
.text:0040E0F4		       cmp     byte ptr	[esi], 0
.text:0040E0F7		       jnz     short loc_40E0EB
.text:0040E0F9		       jmp     short loc_40E0DD
.text:0040E0FB ; ---------------------------------------------------------------------------
.text:0040E0FB
.text:0040E0FB loc_40E0FB:			       ; CODE XREF: ___init_monetary+67j
.text:0040E0FB		       push    0Ch
.text:0040E0FD		       pop     ecx
.text:0040E0FE		       mov     esi, offset ___lconv_c
.text:0040E103		       mov     edi, ebx
.text:0040E105		       rep movsd
.text:0040E107
.text:0040E107 loc_40E107:			       ; CODE XREF: ___init_monetary+20Dj
.text:0040E107		       mov     eax, [ebp+ploci]
.text:0040E10A		       mov     esi, [ebp+ploci]
.text:0040E10D		       add     eax, 0BCh
.text:0040E112		       mov     ecx, [eax]
.text:0040E114		       mov     ecx, [ecx]
.text:0040E116		       mov     [ebx], ecx
.text:0040E118		       mov     ecx, [eax]
.text:0040E11A		       mov     ecx, [ecx+4]
.text:0040E11D		       mov     [ebx+4],	ecx
.text:0040E120		       mov     eax, [eax]
.text:0040E122		       mov     eax, [eax+8]
.text:0040E125		       mov     ecx, [ebp+lc_refcount]
.text:0040E128		       mov     [ebx+8],	eax
.text:0040E12B		       xor     eax, eax
.text:0040E12D		       inc     eax
.text:0040E12E		       xor     edi, edi
.text:0040E130		       cmp     [ebp+lconv_mon_refcount], edi
.text:0040E133		       mov     [ecx], eax
.text:0040E135		       jz      short loc_40E13C
.text:0040E137		       mov     ecx, [ebp+lconv_mon_refcount]
.text:0040E13A		       mov     [ecx], eax
.text:0040E13C
.text:0040E13C loc_40E13C:			       ; CODE XREF: ___init_monetary+2Cj
.text:0040E13C					       ; ___init_monetary+260j
.text:0040E13C		       mov     eax, [esi+0B8h]
.text:0040E142		       cmp     eax, edi
.text:0040E144		       jz      short loc_40E14D
.text:0040E146		       push    eax	       ; lpAddend
.text:0040E147		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040E14D
.text:0040E14D loc_40E14D:			       ; CODE XREF: ___init_monetary+26Fj
.text:0040E14D		       mov     eax, [esi+0B0h]
.text:0040E153		       cmp     eax, edi
.text:0040E155		       jz      short loc_40E17A
.text:0040E157		       push    eax	       ; lpAddend
.text:0040E158		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040E15E		       test    eax, eax
.text:0040E160		       jnz     short loc_40E17A
.text:0040E162		       push    dword ptr [esi+0BCh] ; pBlock
.text:0040E168		       call    _free
.text:0040E16D		       push    dword ptr [esi+0B0h] ; pBlock
.text:0040E173		       call    _free
.text:0040E178		       pop     ecx
.text:0040E179		       pop     ecx
.text:0040E17A
.text:0040E17A loc_40E17A:			       ; CODE XREF: ___init_monetary+280j
.text:0040E17A					       ; ___init_monetary+28Bj
.text:0040E17A		       mov     eax, [ebp+lconv_mon_refcount]
.text:0040E17D		       mov     [esi+0B8h], eax
.text:0040E183		       mov     eax, [ebp+lc_refcount]
.text:0040E186		       mov     [esi+0B0h], eax
.text:0040E18C		       mov     [esi+0BCh], ebx
.text:0040E192		       xor     eax, eax
.text:0040E194
.text:0040E194 loc_40E194:			       ; CODE XREF: ___init_monetary+45j
.text:0040E194		       pop     edi
.text:0040E195		       pop     esi
.text:0040E196		       pop     ebx
.text:0040E197		       leave
.text:0040E198		       retn
.text:0040E198 ___init_monetary	endp
.text:0040E198
.text:0040E199
.text:0040E199 ; =============== S U B R O U T I N E =======================================
.text:0040E199
.text:0040E199 ; Attributes: bp-based frame
.text:0040E199
.text:0040E199 ; int __cdecl __init_ctype(threadlocaleinfostruct *ploci)
.text:0040E199 ___init_ctype   proc near	       ; DATA XREF: .rdata:0041F3F8o
.text:0040E199
.text:0040E199 locinfo	       = localeinfo_struct ptr -48h
.text:0040E199 var_40	       = dword ptr -40h
.text:0040E199 var_3C	       = dword ptr -3Ch
.text:0040E199 var_38	       = dword ptr -38h
.text:0040E199 var_34	       = dword ptr -34h
.text:0040E199 mb_cur_max      = dword ptr -30h
.text:0040E199 refcount	       = dword ptr -2Ch
.text:0040E199 newcumap	       = dword ptr -28h
.text:0040E199 newctype1       = dword ptr -24h
.text:0040E199 cbuffer	       = dword ptr -20h
.text:0040E199 newclmap	       = dword ptr -1Ch
.text:0040E199 lpCPInfo	       = _cpinfo ptr -18h
.text:0040E199 var_4	       = dword ptr -4
.text:0040E199 ploci	       = dword ptr  8
.text:0040E199
.text:0040E199		       push    ebp
.text:0040E19A		       mov     ebp, esp
.text:0040E19C		       sub     esp, 48h
.text:0040E19F		       mov     eax, ___security_cookie
.text:0040E1A4		       xor     eax, ebp
.text:0040E1A6		       mov     [ebp+var_4], eax
.text:0040E1A9		       push    ebx
.text:0040E1AA		       xor     ebx, ebx
.text:0040E1AC		       push    esi
.text:0040E1AD		       mov     esi, [ebp+ploci]
.text:0040E1B0		       cmp     [esi+14h], ebx
.text:0040E1B3		       push    edi
.text:0040E1B4		       mov     [ebp+refcount], ebx
.text:0040E1B7		       mov     [ebp+newctype1],	ebx
.text:0040E1BA		       mov     [ebp+newclmap], ebx
.text:0040E1BD		       mov     [ebp+newcumap], ebx
.text:0040E1C0		       mov     [ebp+cbuffer], ebx
.text:0040E1C3		       mov     [ebp+locinfo.locinfo], esi
.text:0040E1C6		       mov     [ebp+locinfo.mbcinfo], ebx
.text:0040E1C9		       jz      loc_40E4DA
.text:0040E1CF		       lea     eax, [esi+4]
.text:0040E1D2		       cmp     [eax], ebx
.text:0040E1D4		       jnz     short loc_40E1F6
.text:0040E1D6		       push    eax	       ; address
.text:0040E1D7		       movzx   eax, word ptr [esi+30h]
.text:0040E1DB		       push    1004h	       ; fieldtype
.text:0040E1E0		       push    eax	       ; localehandle
.text:0040E1E1		       lea     eax, [ebp+locinfo]
.text:0040E1E4		       push    ebx	       ; lc_type
.text:0040E1E5		       push    eax	       ; plocinfo
.text:0040E1E6		       call    ___getlocaleinfo
.text:0040E1EB		       add     esp, 14h
.text:0040E1EE		       test    eax, eax
.text:0040E1F0		       jnz     error_cleanup_2
.text:0040E1F6
.text:0040E1F6 loc_40E1F6:			       ; CODE XREF: ___init_ctype+3Bj
.text:0040E1F6		       push    4	       ; cb
.text:0040E1F8		       call    __malloc_crt
.text:0040E1FD		       push    2	       ; size
.text:0040E1FF		       mov     edi, 180h
.text:0040E204		       push    edi	       ; count
.text:0040E205		       mov     [ebp+refcount], eax
.text:0040E208		       call    __calloc_crt
.text:0040E20D		       push    1	       ; size
.text:0040E20F		       push    edi	       ; count
.text:0040E210		       mov     [ebp+newctype1],	eax
.text:0040E213		       call    __calloc_crt
.text:0040E218		       push    1	       ; size
.text:0040E21A		       push    edi	       ; count
.text:0040E21B		       mov     [ebp+newclmap], eax
.text:0040E21E		       call    __calloc_crt
.text:0040E223		       push    1	       ; size
.text:0040E225		       push    101h	       ; count
.text:0040E22A		       mov     [ebp+newcumap], eax
.text:0040E22D		       call    __calloc_crt
.text:0040E232		       add     esp, 24h
.text:0040E235		       cmp     [ebp+refcount], ebx
.text:0040E238		       mov     [ebp+cbuffer], eax
.text:0040E23B		       jz      error_cleanup_2
.text:0040E241		       cmp     [ebp+newctype1],	ebx
.text:0040E244		       jz      error_cleanup_2
.text:0040E24A		       cmp     eax, ebx
.text:0040E24C		       jz      error_cleanup_2
.text:0040E252		       cmp     [ebp+newclmap], ebx
.text:0040E255		       jz      error_cleanup_2
.text:0040E25B		       cmp     [ebp+newcumap], ebx
.text:0040E25E		       jz      error_cleanup_2
.text:0040E264		       mov     eax, [ebp+refcount]
.text:0040E267		       mov     [eax], ebx
.text:0040E269		       xor     eax, eax
.text:0040E26B
.text:0040E26B loc_40E26B:			       ; CODE XREF: ___init_ctype+DEj
.text:0040E26B		       mov     ecx, [ebp+cbuffer]
.text:0040E26E		       mov     [eax+ecx], al
.text:0040E271		       inc     eax
.text:0040E272		       cmp     eax, 100h
.text:0040E277		       jl      short loc_40E26B
.text:0040E279		       lea     eax, [ebp+lpCPInfo]
.text:0040E27C		       push    eax	       ; lpCPInfo
.text:0040E27D		       push    dword ptr [esi+4] ; CodePage
.text:0040E280		       call    ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:0040E286		       test    eax, eax
.text:0040E288		       jz      error_cleanup_2
.text:0040E28E		       cmp     [ebp+lpCPInfo.MaxCharSize], 5
.text:0040E292		       ja      error_cleanup_2
.text:0040E298		       movzx   eax, word ptr [ebp+lpCPInfo.MaxCharSize]
.text:0040E29C		       cmp     eax, 1
.text:0040E29F		       mov     [ebp+mb_cur_max], eax
.text:0040E2A2		       jle     short loc_40E2D1
.text:0040E2A4		       cmp     [ebp+lpCPInfo.LeadByte],	bl
.text:0040E2A7		       jz      short loc_40E2D1
.text:0040E2A9		       lea     eax, [ebp+lpCPInfo.LeadByte+1]
.text:0040E2AC
.text:0040E2AC loc_40E2AC:			       ; CODE XREF: ___init_ctype+136j
.text:0040E2AC		       mov     cl, [eax]
.text:0040E2AE		       cmp     cl, bl
.text:0040E2B0		       jz      short loc_40E2D1
.text:0040E2B2		       movzx   edi, byte ptr [eax-1]
.text:0040E2B6		       movzx   ecx, cl
.text:0040E2B9		       jmp     short loc_40E2C6
.text:0040E2BB ; ---------------------------------------------------------------------------
.text:0040E2BB
.text:0040E2BB loc_40E2BB:			       ; CODE XREF: ___init_ctype+12Fj
.text:0040E2BB		       mov     ecx, [ebp+cbuffer]
.text:0040E2BE		       mov     byte ptr	[edi+ecx], 20h
.text:0040E2C2		       movzx   ecx, byte ptr [eax]
.text:0040E2C5		       inc     edi
.text:0040E2C6
.text:0040E2C6 loc_40E2C6:			       ; CODE XREF: ___init_ctype+120j
.text:0040E2C6		       cmp     edi, ecx
.text:0040E2C8		       jle     short loc_40E2BB
.text:0040E2CA		       inc     eax
.text:0040E2CB		       inc     eax
.text:0040E2CC		       cmp     [eax-1],	bl
.text:0040E2CF		       jnz     short loc_40E2AC
.text:0040E2D1
.text:0040E2D1 loc_40E2D1:			       ; CODE XREF: ___init_ctype+109j
.text:0040E2D1					       ; ___init_ctype+10Ej ...
.text:0040E2D1		       mov     eax, [ebp+newctype1]
.text:0040E2D4		       push    ebx	       ; bError
.text:0040E2D5		       push    ebx	       ; lcid
.text:0040E2D6		       push    dword ptr [esi+4] ; code_page
.text:0040E2D9		       add     eax, 100h
.text:0040E2DE		       push    eax	       ; lpCharType
.text:0040E2DF		       push    100h	       ; cchSrc
.text:0040E2E4		       push    [ebp+cbuffer]   ; lpSrcStr
.text:0040E2E7		       mov     [ebp+var_3C], eax
.text:0040E2EA		       push    1	       ; dwInfoType
.text:0040E2EC		       push    ebx	       ; plocinfo
.text:0040E2ED		       call    ___crtGetStringTypeA
.text:0040E2F2		       add     esp, 20h
.text:0040E2F5		       test    eax, eax
.text:0040E2F7		       jz      error_cleanup_2
.text:0040E2FD		       mov     ecx, [ebp+newclmap]
.text:0040E300		       mov     eax, [ebp+cbuffer]
.text:0040E303		       push    ebx	       ; bError
.text:0040E304		       push    dword ptr [esi+4] ; code_page
.text:0040E307		       mov     edi, 0FFh
.text:0040E30C		       push    edi	       ; cchDest
.text:0040E30D		       add     ecx, 81h
.text:0040E313		       push    ecx	       ; lpDestStr
.text:0040E314		       push    edi	       ; cchSrc
.text:0040E315		       inc     eax
.text:0040E316		       push    eax	       ; lpSrcStr
.text:0040E317		       push    100h	       ; dwMapFlags
.text:0040E31C		       push    dword ptr [esi+14h] ; Locale
.text:0040E31F		       push    ebx	       ; plocinfo
.text:0040E320		       call    ___crtLCMapStringA
.text:0040E325		       add     esp, 24h
.text:0040E328		       test    eax, eax
.text:0040E32A		       jz      error_cleanup_2
.text:0040E330		       mov     eax, [ebp+newcumap]
.text:0040E333		       push    ebx	       ; bError
.text:0040E334		       push    dword ptr [esi+4] ; code_page
.text:0040E337		       add     eax, 81h
.text:0040E33C		       push    edi	       ; cchDest
.text:0040E33D		       push    eax	       ; lpDestStr
.text:0040E33E		       mov     eax, [ebp+cbuffer]
.text:0040E341		       push    edi	       ; cchSrc
.text:0040E342		       inc     eax
.text:0040E343		       push    eax	       ; lpSrcStr
.text:0040E344		       push    200h	       ; dwMapFlags
.text:0040E349		       push    dword ptr [esi+14h] ; Locale
.text:0040E34C		       push    ebx	       ; plocinfo
.text:0040E34D		       call    ___crtLCMapStringA
.text:0040E352		       add     esp, 24h
.text:0040E355		       test    eax, eax
.text:0040E357		       jz      error_cleanup_2
.text:0040E35D		       cmp     [ebp+mb_cur_max], 1
.text:0040E361		       mov     eax, [ebp+newctype1]
.text:0040E364		       mov     edi, [ebp+newclmap]
.text:0040E367		       mov     edx, [ebp+newcumap]
.text:0040E36A		       lea     ecx, [eax+0FEh]
.text:0040E370		       mov     [ecx], bx
.text:0040E373		       mov     [ebp+var_38], ecx
.text:0040E376		       lea     ecx, [edi+80h]
.text:0040E37C		       mov     [edi+7Fh], bl
.text:0040E37F		       mov     [edx+7Fh], bl
.text:0040E382		       mov     [ecx], bl
.text:0040E384		       mov     [ebp+var_40], ecx
.text:0040E387		       lea     ecx, [edx+80h]
.text:0040E38D		       mov     [ebp+var_34], ecx
.text:0040E390		       mov     [ecx], bl
.text:0040E392		       jle     short loc_40E3DE
.text:0040E394		       cmp     [ebp+lpCPInfo.LeadByte],	bl
.text:0040E397		       jz      short loc_40E3DE
.text:0040E399		       lea     ecx, [ebp+lpCPInfo.LeadByte+1]
.text:0040E39C		       mov     [ebp+newclmap], ecx
.text:0040E39F
.text:0040E39F loc_40E39F:			       ; CODE XREF: ___init_ctype+243j
.text:0040E39F		       mov     dl, [ecx]
.text:0040E3A1		       cmp     dl, bl
.text:0040E3A3		       jz      short loc_40E3DE
.text:0040E3A5		       movzx   ecx, byte ptr [ecx-1]
.text:0040E3A9		       movzx   edx, dl
.text:0040E3AC		       cmp     ecx, edx
.text:0040E3AE		       jg      short loc_40E3D1
.text:0040E3B0		       lea     edx, [eax+ecx*2+100h]
.text:0040E3B7		       jmp     short loc_40E3BC
.text:0040E3B9 ; ---------------------------------------------------------------------------
.text:0040E3B9
.text:0040E3B9 loc_40E3B9:			       ; CODE XREF: ___init_ctype+236j
.text:0040E3B9		       mov     edx, [ebp+newctype1]
.text:0040E3BC
.text:0040E3BC loc_40E3BC:			       ; CODE XREF: ___init_ctype+21Ej
.text:0040E3BC		       mov     word ptr	[edx], 8000h
.text:0040E3C1		       inc     ecx
.text:0040E3C2		       inc     edx
.text:0040E3C3		       inc     edx
.text:0040E3C4		       mov     [ebp+newctype1],	edx
.text:0040E3C7		       mov     edx, [ebp+newclmap]
.text:0040E3CA		       movzx   edx, byte ptr [edx]
.text:0040E3CD		       cmp     ecx, edx
.text:0040E3CF		       jle     short loc_40E3B9
.text:0040E3D1
.text:0040E3D1 loc_40E3D1:			       ; CODE XREF: ___init_ctype+215j
.text:0040E3D1		       mov     ecx, [ebp+newclmap]
.text:0040E3D4		       inc     ecx
.text:0040E3D5		       inc     ecx
.text:0040E3D6		       cmp     [ecx-1],	bl
.text:0040E3D9		       mov     [ebp+newclmap], ecx
.text:0040E3DC		       jnz     short loc_40E39F
.text:0040E3DE
.text:0040E3DE loc_40E3DE:			       ; CODE XREF: ___init_ctype+1F9j
.text:0040E3DE					       ; ___init_ctype+1FEj ...
.text:0040E3DE		       push    0FEh	       ; count
.text:0040E3E3		       lea     ecx, [eax+200h]
.text:0040E3E9		       push    ecx	       ; src
.text:0040E3EA		       push    eax	       ; dst
.text:0040E3EB		       call    _memcpy
.text:0040E3F0		       push    7Fh	       ; count
.text:0040E3F2		       lea     eax, [edi+100h]
.text:0040E3F8		       push    eax	       ; src
.text:0040E3F9		       push    edi	       ; dst
.text:0040E3FA		       call    _memcpy
.text:0040E3FF		       mov     eax, [ebp+newcumap]
.text:0040E402		       push    7Fh	       ; count
.text:0040E404		       lea     ecx, [eax+100h]
.text:0040E40A		       push    ecx	       ; src
.text:0040E40B		       push    eax	       ; dst
.text:0040E40C		       call    _memcpy
.text:0040E411		       mov     eax, [esi+0C0h]
.text:0040E417		       add     esp, 24h
.text:0040E41A		       cmp     eax, ebx
.text:0040E41C		       jz      short loc_40E469
.text:0040E41E		       push    eax	       ; lpAddend
.text:0040E41F		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040E425		       test    eax, eax
.text:0040E427		       jnz     short loc_40E469
.text:0040E429		       mov     eax, [esi+0C4h]
.text:0040E42F		       sub     eax, 0FEh
.text:0040E434		       push    eax	       ; pBlock
.text:0040E435		       call    _free
.text:0040E43A		       mov     eax, [esi+0CCh]
.text:0040E440		       mov     edi, 80h
.text:0040E445		       sub     eax, edi
.text:0040E447		       push    eax	       ; pBlock
.text:0040E448		       call    _free
.text:0040E44D		       mov     eax, [esi+0D0h]
.text:0040E453		       sub     eax, edi
.text:0040E455		       push    eax	       ; pBlock
.text:0040E456		       call    _free
.text:0040E45B		       push    dword ptr [esi+0C0h] ; pBlock
.text:0040E461		       call    _free
.text:0040E466		       add     esp, 10h
.text:0040E469
.text:0040E469 loc_40E469:			       ; CODE XREF: ___init_ctype+283j
.text:0040E469					       ; ___init_ctype+28Ej
.text:0040E469		       mov     eax, [ebp+refcount]
.text:0040E46C		       mov     dword ptr [eax],	1
.text:0040E472		       mov     [esi+0C0h], eax
.text:0040E478		       mov     eax, [ebp+var_3C]
.text:0040E47B		       mov     [esi+0C8h], eax
.text:0040E481		       mov     eax, [ebp+var_38]
.text:0040E484		       mov     [esi+0C4h], eax
.text:0040E48A		       mov     eax, [ebp+var_40]
.text:0040E48D		       mov     [esi+0CCh], eax
.text:0040E493		       mov     eax, [ebp+var_34]
.text:0040E496		       mov     [esi+0D0h], eax
.text:0040E49C		       mov     eax, [ebp+mb_cur_max]
.text:0040E49F		       mov     [esi+0ACh], eax
.text:0040E4A5
.text:0040E4A5 loc_40E4A5:			       ; CODE XREF: ___init_ctype+33Fj
.text:0040E4A5		       push    [ebp+cbuffer]   ; pBlock
.text:0040E4A8		       call    _free
.text:0040E4AD		       pop     ecx
.text:0040E4AE		       mov     eax, ebx
.text:0040E4B0		       jmp     short loc_40E51F
.text:0040E4B2 ; ---------------------------------------------------------------------------
.text:0040E4B2
.text:0040E4B2 error_cleanup_2:			       ; CODE XREF: ___init_ctype+57j
.text:0040E4B2					       ; ___init_ctype+A2j ...
.text:0040E4B2		       push    [ebp+refcount]  ; pBlock
.text:0040E4B5		       call    _free
.text:0040E4BA		       push    [ebp+newctype1] ; pBlock
.text:0040E4BD		       call    _free
.text:0040E4C2		       push    [ebp+newclmap]  ; pBlock
.text:0040E4C5		       call    _free
.text:0040E4CA		       push    [ebp+newcumap]  ; pBlock
.text:0040E4CD		       call    _free
.text:0040E4D2		       xor     ebx, ebx
.text:0040E4D4		       add     esp, 10h
.text:0040E4D7		       inc     ebx
.text:0040E4D8		       jmp     short loc_40E4A5
.text:0040E4DA ; ---------------------------------------------------------------------------
.text:0040E4DA
.text:0040E4DA loc_40E4DA:			       ; CODE XREF: ___init_ctype+30j
.text:0040E4DA		       lea     edi, [esi+0C0h]
.text:0040E4E0		       mov     eax, [edi]
.text:0040E4E2		       cmp     eax, ebx
.text:0040E4E4		       jz      short loc_40E4ED
.text:0040E4E6		       push    eax	       ; lpAddend
.text:0040E4E7		       call    ds:__imp__InterlockedDecrement@4	; InterlockedDecrement(x)
.text:0040E4ED
.text:0040E4ED loc_40E4ED:			       ; CODE XREF: ___init_ctype+34Bj
.text:0040E4ED		       mov     [edi], ebx
.text:0040E4EF		       mov     [esi+0C4h], ebx
.text:0040E4F5		       mov     dword ptr [esi+0C8h], offset asc_41F690 ; "	   (((((		  H"
.text:0040E4FF		       mov     dword ptr [esi+0CCh], offset dword_41FB18
.text:0040E509		       mov     dword ptr [esi+0D0h], offset dword_41FC98
.text:0040E513		       mov     dword ptr [esi+0ACh], 1
.text:0040E51D		       xor     eax, eax
.text:0040E51F
.text:0040E51F loc_40E51F:			       ; CODE XREF: ___init_ctype+317j
.text:0040E51F		       mov     ecx, [ebp+var_4]
.text:0040E522		       pop     edi
.text:0040E523		       pop     esi
.text:0040E524		       xor     ecx, ebp
.text:0040E526		       pop     ebx
.text:0040E527		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040E52C		       leave
.text:0040E52D		       retn
.text:0040E52D ___init_ctype   endp
.text:0040E52D
.text:0040E52E
.text:0040E52E ; =============== S U B R O U T I N E =======================================
.text:0040E52E
.text:0040E52E
.text:0040E52E ; int __cdecl ___mb_cur_max_func()
.text:0040E52E ____mb_cur_max_func proc	near	       ; CODE XREF: _wctomb+Dp
.text:0040E52E					       ; ____mb_cur_max_l_func+8j
.text:0040E52E		       call    __getptd
.text:0040E533		       mov     ecx, eax
.text:0040E535		       mov     eax, [ecx+6Ch]
.text:0040E538		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040E53E		       jz      short loc_40E550
.text:0040E540		       mov     edx, ___globallocalestatus
.text:0040E546		       test    [ecx+70h], edx
.text:0040E549		       jnz     short loc_40E550
.text:0040E54B		       call    ___updatetlocinfo
.text:0040E550
.text:0040E550 loc_40E550:			       ; CODE XREF: ____mb_cur_max_func+10j
.text:0040E550					       ; ____mb_cur_max_func+1Bj
.text:0040E550		       mov     eax, [eax+0ACh]
.text:0040E556		       retn
.text:0040E556 ____mb_cur_max_func endp
.text:0040E556
.text:0040E557
.text:0040E557 ; =============== S U B R O U T I N E =======================================
.text:0040E557
.text:0040E557
.text:0040E557 ; int __cdecl ___mb_cur_max_l_func(localeinfo_struct *loc)
.text:0040E557 ____mb_cur_max_l_func proc near
.text:0040E557
.text:0040E557 loc	       = dword ptr  4
.text:0040E557
.text:0040E557		       mov     eax, [esp+loc]
.text:0040E55B		       test    eax, eax
.text:0040E55D		       jnz     short loc_40E564
.text:0040E55F		       jmp     ____mb_cur_max_func
.text:0040E564 ; ---------------------------------------------------------------------------
.text:0040E564
.text:0040E564 loc_40E564:			       ; CODE XREF: ____mb_cur_max_l_func+6j
.text:0040E564		       mov     eax, [eax]
.text:0040E566		       mov     eax, [eax+0ACh]
.text:0040E56C		       retn
.text:0040E56C ____mb_cur_max_l_func endp
.text:0040E56C
.text:0040E56D
.text:0040E56D ; =============== S U B R O U T I N E =======================================
.text:0040E56D
.text:0040E56D
.text:0040E56D ; unsigned int __cdecl ___lc_codepage_func()
.text:0040E56D ____lc_codepage_func proc near	       ; CODE XREF: _tzset_nolock:loc_414400p
.text:0040E56D		       call    __getptd
.text:0040E572		       mov     ecx, eax
.text:0040E574		       mov     eax, [ecx+6Ch]
.text:0040E577		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040E57D		       jz      short loc_40E58F
.text:0040E57F		       mov     edx, ___globallocalestatus
.text:0040E585		       test    [ecx+70h], edx
.text:0040E588		       jnz     short loc_40E58F
.text:0040E58A		       call    ___updatetlocinfo
.text:0040E58F
.text:0040E58F loc_40E58F:			       ; CODE XREF: ____lc_codepage_func+10j
.text:0040E58F					       ; ____lc_codepage_func+1Bj
.text:0040E58F		       mov     eax, [eax+4]
.text:0040E592		       retn
.text:0040E592 ____lc_codepage_func endp
.text:0040E592
.text:0040E593
.text:0040E593 ; =============== S U B R O U T I N E =======================================
.text:0040E593
.text:0040E593
.text:0040E593 ; unsigned int __cdecl ___lc_collate_cp_func()
.text:0040E593 ____lc_collate_cp_func proc near
.text:0040E593		       call    __getptd
.text:0040E598		       mov     ecx, eax
.text:0040E59A		       mov     eax, [ecx+6Ch]
.text:0040E59D		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040E5A3		       jz      short loc_40E5B5
.text:0040E5A5		       mov     edx, ___globallocalestatus
.text:0040E5AB		       test    [ecx+70h], edx
.text:0040E5AE		       jnz     short loc_40E5B5
.text:0040E5B0		       call    ___updatetlocinfo
.text:0040E5B5
.text:0040E5B5 loc_40E5B5:			       ; CODE XREF: ____lc_collate_cp_func+10j
.text:0040E5B5					       ; ____lc_collate_cp_func+1Bj
.text:0040E5B5		       mov     eax, [eax+8]
.text:0040E5B8		       retn
.text:0040E5B8 ____lc_collate_cp_func endp
.text:0040E5B8
.text:0040E5B9
.text:0040E5B9 ; =============== S U B R O U T I N E =======================================
.text:0040E5B9
.text:0040E5B9
.text:0040E5B9 ; unsigned int *__cdecl ___lc_handle_func()
.text:0040E5B9 ____lc_handle_func proc near
.text:0040E5B9		       call    __getptd
.text:0040E5BE		       mov     ecx, eax
.text:0040E5C0		       mov     eax, [ecx+6Ch]
.text:0040E5C3		       cmp     eax, ___ptlocinfo ; ___ptlocinfo
.text:0040E5C9		       jz      short loc_40E5DB
.text:0040E5CB		       mov     edx, ___globallocalestatus
.text:0040E5D1		       test    [ecx+70h], edx
.text:0040E5D4		       jnz     short loc_40E5DB
.text:0040E5D6		       call    ___updatetlocinfo
.text:0040E5DB
.text:0040E5DB loc_40E5DB:			       ; CODE XREF: ____lc_handle_func+10j
.text:0040E5DB					       ; ____lc_handle_func+1Bj
.text:0040E5DB		       add     eax, 0Ch
.text:0040E5DE		       retn
.text:0040E5DE ____lc_handle_func endp
.text:0040E5DE
.text:0040E5DF
.text:0040E5DF ; =============== S U B R O U T I N E =======================================
.text:0040E5DF
.text:0040E5DF
.text:0040E5DF ; int __cdecl __init_collate(threadlocaleinfostruct *ploci)
.text:0040E5DF ___init_collate proc near	       ; DATA XREF: .rdata:0041F3ECo
.text:0040E5DF
.text:0040E5DF ploci	       = dword ptr  4
.text:0040E5DF
.text:0040E5DF		       xor     eax, eax
.text:0040E5E1		       retn
.text:0040E5E1 ___init_collate endp
.text:0040E5E1
.text:0040E5E2
.text:0040E5E2 ; =============== S U B R O U T I N E =======================================
.text:0040E5E2
.text:0040E5E2 ; Attributes: bp-based frame
.text:0040E5E2
.text:0040E5E2 ; char *__cdecl _Getdays_l(localeinfo_struct *plocinfo)
.text:0040E5E2 __Getdays_l     proc near	       ; CODE XREF: __Getdays+2p
.text:0040E5E2
.text:0040E5E2 _loc_update     = _LocaleUpdate ptr -18h
.text:0040E5E2 p	       = dword ptr -8
.text:0040E5E2 n	       = dword ptr -4
.text:0040E5E2 plocinfo	       = dword ptr  8
.text:0040E5E2
.text:0040E5E2		       push    ebp
.text:0040E5E3		       mov     ebp, esp
.text:0040E5E5		       sub     esp, 18h
.text:0040E5E8		       push    ebx
.text:0040E5E9		       push    esi
.text:0040E5EA		       push    edi
.text:0040E5EB		       push    [ebp+plocinfo]  ; plocinfo
.text:0040E5EE		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040E5F1		       xor     ebx, ebx
.text:0040E5F3		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040E5F8		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040E5FB		       mov     edi, [eax+0D4h]
.text:0040E601		       mov     [ebp+n],	ebx
.text:0040E604
.text:0040E604 loc_40E604:			       ; CODE XREF: __Getdays_l+4Ej
.text:0040E604		       mov     esi, [ebp+n]
.text:0040E607		       shl     esi, 2
.text:0040E60A		       push    dword ptr [esi+edi+1Ch] ; buf
.text:0040E60E		       call    _strlen
.text:0040E613		       push    dword ptr [esi+edi] ; buf
.text:0040E616		       mov     [ebp+p],	eax
.text:0040E619		       call    _strlen
.text:0040E61E		       add     eax, ebx
.text:0040E620		       inc     [ebp+n]
.text:0040E623		       cmp     [ebp+n],	7
.text:0040E627		       pop     ecx
.text:0040E628		       pop     ecx
.text:0040E629		       mov     ecx, [ebp+p]
.text:0040E62C		       lea     ebx, [eax+ecx+2]
.text:0040E630		       jb      short loc_40E604
.text:0040E632		       lea     eax, [ebx+1]
.text:0040E635		       push    eax	       ; cb
.text:0040E636		       call    __malloc_crt
.text:0040E63B		       mov     esi, eax
.text:0040E63D		       test    esi, esi
.text:0040E63F		       pop     ecx
.text:0040E640		       mov     [ebp+p],	esi
.text:0040E643		       jz      loc_40E6CB
.text:0040E649		       and     [ebp+n],	0
.text:0040E64D
.text:0040E64D loc_40E64D:			       ; CODE XREF: __Getdays_l+E4j
.text:0040E64D		       mov     eax, [ebp+n]
.text:0040E650		       mov     byte ptr	[esi], 3Ah
.text:0040E653		       push    dword ptr [edi+eax*4] ; _Src
.text:0040E656		       mov     eax, [ebp+p]
.text:0040E659		       inc     esi
.text:0040E65A		       sub     eax, esi
.text:0040E65C		       lea     eax, [eax+ebx+1]
.text:0040E660		       push    eax	       ; _SizeInBytes
.text:0040E661		       push    esi	       ; _Dst
.text:0040E662		       call    _strcpy_s
.text:0040E667		       add     esp, 0Ch
.text:0040E66A		       test    eax, eax
.text:0040E66C		       jz      short loc_40E67D
.text:0040E66E		       xor     eax, eax
.text:0040E670		       push    eax	       ; pReserved
.text:0040E671		       push    eax	       ; nLine
.text:0040E672		       push    eax	       ; pszFile
.text:0040E673		       push    eax	       ; pszFunction
.text:0040E674		       push    eax	       ; pszExpression
.text:0040E675		       call    __invoke_watson
.text:0040E67A		       add     esp, 14h
.text:0040E67D
.text:0040E67D loc_40E67D:			       ; CODE XREF: __Getdays_l+8Aj
.text:0040E67D		       push    esi	       ; buf
.text:0040E67E		       call    _strlen
.text:0040E683		       add     esi, eax
.text:0040E685		       mov     eax, [ebp+n]
.text:0040E688		       mov     byte ptr	[esi], 3Ah
.text:0040E68B		       push    dword ptr [edi+eax*4+1Ch] ; _Src
.text:0040E68F		       mov     eax, [ebp+p]
.text:0040E692		       inc     esi
.text:0040E693		       sub     eax, esi
.text:0040E695		       lea     eax, [eax+ebx+1]
.text:0040E699		       push    eax	       ; _SizeInBytes
.text:0040E69A		       push    esi	       ; _Dst
.text:0040E69B		       call    _strcpy_s
.text:0040E6A0		       add     esp, 10h
.text:0040E6A3		       test    eax, eax
.text:0040E6A5		       jz      short loc_40E6B6
.text:0040E6A7		       xor     eax, eax
.text:0040E6A9		       push    eax	       ; pReserved
.text:0040E6AA		       push    eax	       ; nLine
.text:0040E6AB		       push    eax	       ; pszFile
.text:0040E6AC		       push    eax	       ; pszFunction
.text:0040E6AD		       push    eax	       ; pszExpression
.text:0040E6AE		       call    __invoke_watson
.text:0040E6B3		       add     esp, 14h
.text:0040E6B6
.text:0040E6B6 loc_40E6B6:			       ; CODE XREF: __Getdays_l+C3j
.text:0040E6B6		       push    esi	       ; buf
.text:0040E6B7		       call    _strlen
.text:0040E6BC		       add     esi, eax
.text:0040E6BE		       inc     [ebp+n]
.text:0040E6C1		       cmp     [ebp+n],	7
.text:0040E6C5		       pop     ecx
.text:0040E6C6		       jb      short loc_40E64D
.text:0040E6C8		       mov     byte ptr	[esi], 0
.text:0040E6CB
.text:0040E6CB loc_40E6CB:			       ; CODE XREF: __Getdays_l+61j
.text:0040E6CB		       cmp     [ebp+_loc_update.updated], 0
.text:0040E6CF		       pop     edi
.text:0040E6D0		       pop     esi
.text:0040E6D1		       pop     ebx
.text:0040E6D2		       jz      short loc_40E6DB
.text:0040E6D4		       mov     eax, [ebp+_loc_update.ptd]
.text:0040E6D7		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040E6DB
.text:0040E6DB loc_40E6DB:			       ; CODE XREF: __Getdays_l+F0j
.text:0040E6DB		       mov     eax, [ebp+p]
.text:0040E6DE		       leave
.text:0040E6DF		       retn
.text:0040E6DF __Getdays_l     endp
.text:0040E6DF
.text:0040E6E0
.text:0040E6E0 ; =============== S U B R O U T I N E =======================================
.text:0040E6E0
.text:0040E6E0
.text:0040E6E0 ; char *__cdecl _Getdays()
.text:0040E6E0 __Getdays       proc near
.text:0040E6E0		       push    0	       ; plocinfo
.text:0040E6E2		       call    __Getdays_l
.text:0040E6E7		       pop     ecx
.text:0040E6E8		       retn
.text:0040E6E8 __Getdays       endp
.text:0040E6E8
.text:0040E6E9
.text:0040E6E9 ; =============== S U B R O U T I N E =======================================
.text:0040E6E9
.text:0040E6E9 ; Attributes: bp-based frame
.text:0040E6E9
.text:0040E6E9 ; char *__cdecl _Getmonths_l(localeinfo_struct *plocinfo)
.text:0040E6E9 __Getmonths_l   proc near	       ; CODE XREF: __Getmonths+2p
.text:0040E6E9
.text:0040E6E9 _loc_update     = _LocaleUpdate ptr -1Ch
.text:0040E6E9 var_C	       = dword ptr -0Ch
.text:0040E6E9 var_8	       = dword ptr -8
.text:0040E6E9 p	       = dword ptr -4
.text:0040E6E9 plocinfo	       = dword ptr  8
.text:0040E6E9
.text:0040E6E9		       push    ebp
.text:0040E6EA		       mov     ebp, esp
.text:0040E6EC		       sub     esp, 1Ch
.text:0040E6EF		       push    ebx
.text:0040E6F0		       push    esi
.text:0040E6F1		       push    edi
.text:0040E6F2		       push    [ebp+plocinfo]  ; plocinfo
.text:0040E6F5		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040E6F8		       xor     ebx, ebx
.text:0040E6FA		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040E6FF		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040E702		       mov     edi, [eax+0D4h]
.text:0040E708		       lea     esi, [edi+38h]
.text:0040E70B		       mov     [ebp+p],	esi
.text:0040E70E		       mov     [ebp+var_8], 0Ch
.text:0040E715
.text:0040E715 loc_40E715:			       ; CODE XREF: __Getmonths_l+55j
.text:0040E715		       push    dword ptr [esi+30h] ; buf
.text:0040E718		       call    _strlen
.text:0040E71D		       push    dword ptr [esi] ; buf
.text:0040E71F		       mov     [ebp+var_C], eax
.text:0040E722		       call    _strlen
.text:0040E727		       mov     esi, [ebp+p]
.text:0040E72A		       pop     ecx
.text:0040E72B		       pop     ecx
.text:0040E72C		       mov     ecx, [ebp+var_C]
.text:0040E72F		       add     eax, ebx
.text:0040E731		       add     esi, 4
.text:0040E734		       dec     [ebp+var_8]
.text:0040E737		       lea     ebx, [eax+ecx+2]
.text:0040E73B		       mov     [ebp+p],	esi
.text:0040E73E		       jnz     short loc_40E715
.text:0040E740		       lea     eax, [ebx+1]
.text:0040E743		       push    eax	       ; cb
.text:0040E744		       call    __malloc_crt
.text:0040E749		       mov     esi, eax
.text:0040E74B		       test    esi, esi
.text:0040E74D		       pop     ecx
.text:0040E74E		       mov     [ebp+p],	esi
.text:0040E751		       jz      short loc_40E7D2
.text:0040E753		       add     edi, 68h
.text:0040E756		       mov     [ebp+var_8], 0Ch
.text:0040E75D
.text:0040E75D loc_40E75D:			       ; CODE XREF: __Getmonths_l+E4j
.text:0040E75D		       mov     eax, [ebp+p]
.text:0040E760		       mov     byte ptr	[esi], 3Ah
.text:0040E763		       push    dword ptr [edi-30h] ; _Src
.text:0040E766		       inc     esi
.text:0040E767		       sub     eax, esi
.text:0040E769		       lea     eax, [eax+ebx+1]
.text:0040E76D		       push    eax	       ; _SizeInBytes
.text:0040E76E		       push    esi	       ; _Dst
.text:0040E76F		       call    _strcpy_s
.text:0040E774		       add     esp, 0Ch
.text:0040E777		       test    eax, eax
.text:0040E779		       jz      short loc_40E78A
.text:0040E77B		       xor     eax, eax
.text:0040E77D		       push    eax	       ; pReserved
.text:0040E77E		       push    eax	       ; nLine
.text:0040E77F		       push    eax	       ; pszFile
.text:0040E780		       push    eax	       ; pszFunction
.text:0040E781		       push    eax	       ; pszExpression
.text:0040E782		       call    __invoke_watson
.text:0040E787		       add     esp, 14h
.text:0040E78A
.text:0040E78A loc_40E78A:			       ; CODE XREF: __Getmonths_l+90j
.text:0040E78A		       push    esi	       ; buf
.text:0040E78B		       call    _strlen
.text:0040E790		       add     esi, eax
.text:0040E792		       mov     eax, [ebp+p]
.text:0040E795		       mov     byte ptr	[esi], 3Ah
.text:0040E798		       push    dword ptr [edi] ; _Src
.text:0040E79A		       inc     esi
.text:0040E79B		       sub     eax, esi
.text:0040E79D		       lea     eax, [eax+ebx+1]
.text:0040E7A1		       push    eax	       ; _SizeInBytes
.text:0040E7A2		       push    esi	       ; _Dst
.text:0040E7A3		       call    _strcpy_s
.text:0040E7A8		       add     esp, 10h
.text:0040E7AB		       test    eax, eax
.text:0040E7AD		       jz      short loc_40E7BE
.text:0040E7AF		       xor     eax, eax
.text:0040E7B1		       push    eax	       ; pReserved
.text:0040E7B2		       push    eax	       ; nLine
.text:0040E7B3		       push    eax	       ; pszFile
.text:0040E7B4		       push    eax	       ; pszFunction
.text:0040E7B5		       push    eax	       ; pszExpression
.text:0040E7B6		       call    __invoke_watson
.text:0040E7BB		       add     esp, 14h
.text:0040E7BE
.text:0040E7BE loc_40E7BE:			       ; CODE XREF: __Getmonths_l+C4j
.text:0040E7BE		       push    esi	       ; buf
.text:0040E7BF		       call    _strlen
.text:0040E7C4		       add     esi, eax
.text:0040E7C6		       add     edi, 4
.text:0040E7C9		       dec     [ebp+var_8]
.text:0040E7CC		       pop     ecx
.text:0040E7CD		       jnz     short loc_40E75D
.text:0040E7CF		       mov     byte ptr	[esi], 0
.text:0040E7D2
.text:0040E7D2 loc_40E7D2:			       ; CODE XREF: __Getmonths_l+68j
.text:0040E7D2		       cmp     [ebp+_loc_update.updated], 0
.text:0040E7D6		       pop     edi
.text:0040E7D7		       pop     esi
.text:0040E7D8		       pop     ebx
.text:0040E7D9		       jz      short loc_40E7E2
.text:0040E7DB		       mov     eax, [ebp+_loc_update.ptd]
.text:0040E7DE		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040E7E2
.text:0040E7E2 loc_40E7E2:			       ; CODE XREF: __Getmonths_l+F0j
.text:0040E7E2		       mov     eax, [ebp+p]
.text:0040E7E5		       leave
.text:0040E7E6		       retn
.text:0040E7E6 __Getmonths_l   endp
.text:0040E7E6
.text:0040E7E7
.text:0040E7E7 ; =============== S U B R O U T I N E =======================================
.text:0040E7E7
.text:0040E7E7
.text:0040E7E7 ; char *__cdecl _Getmonths()
.text:0040E7E7 __Getmonths     proc near
.text:0040E7E7		       push    0	       ; plocinfo
.text:0040E7E9		       call    __Getmonths_l
.text:0040E7EE		       pop     ecx
.text:0040E7EF		       retn
.text:0040E7EF __Getmonths     endp
.text:0040E7EF
.text:0040E7F0
.text:0040E7F0 ; =============== S U B R O U T I N E =======================================
.text:0040E7F0
.text:0040E7F0 ; Attributes: bp-based frame
.text:0040E7F0
.text:0040E7F0 ; void *__cdecl _Gettnames_l(localeinfo_struct *plocinfo)
.text:0040E7F0 __Gettnames_l   proc near	       ; CODE XREF: __Gettnames+2p
.text:0040E7F0
.text:0040E7F0 _loc_update     = _LocaleUpdate ptr -24h
.text:0040E7F0 var_14	       = dword ptr -14h
.text:0040E7F0 var_10	       = dword ptr -10h
.text:0040E7F0 var_C	       = dword ptr -0Ch
.text:0040E7F0 len	       = dword ptr -8
.text:0040E7F0 n	       = dword ptr -4
.text:0040E7F0 plocinfo	       = dword ptr  8
.text:0040E7F0
.text:0040E7F0		       push    ebp
.text:0040E7F1		       mov     ebp, esp
.text:0040E7F3		       sub     esp, 24h
.text:0040E7F6		       push    ebx
.text:0040E7F7		       push    esi
.text:0040E7F8		       push    edi
.text:0040E7F9		       push    [ebp+plocinfo]  ; plocinfo
.text:0040E7FC		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040E7FF		       xor     edi, edi
.text:0040E801		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040E806		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040E809		       mov     esi, [eax+0D4h]
.text:0040E80F		       mov     [ebp+n],	edi
.text:0040E812
.text:0040E812 loc_40E812:			       ; CODE XREF: __Gettnames_l+4Ej
.text:0040E812		       mov     ebx, [ebp+n]
.text:0040E815		       shl     ebx, 2
.text:0040E818		       push    dword ptr [ebx+esi+1Ch] ; buf
.text:0040E81C		       call    _strlen
.text:0040E821		       push    dword ptr [ebx+esi] ; buf
.text:0040E824		       mov     [ebp+var_14], eax
.text:0040E827		       call    _strlen
.text:0040E82C		       add     eax, edi
.text:0040E82E		       inc     [ebp+n]
.text:0040E831		       cmp     [ebp+n],	7
.text:0040E835		       pop     ecx
.text:0040E836		       pop     ecx
.text:0040E837		       mov     ecx, [ebp+var_14]
.text:0040E83A		       lea     edi, [eax+ecx+2]
.text:0040E83E		       jb      short loc_40E812
.text:0040E840		       lea     eax, [esi+38h]
.text:0040E843		       mov     [ebp+var_10], eax
.text:0040E846		       mov     [ebp+var_C], 0Ch
.text:0040E84D
.text:0040E84D loc_40E84D:			       ; CODE XREF: __Gettnames_l+84j
.text:0040E84D		       mov     ebx, [ebp+var_10]
.text:0040E850		       push    dword ptr [ebx+30h] ; buf
.text:0040E853		       call    _strlen
.text:0040E858		       push    dword ptr [ebx] ; buf
.text:0040E85A		       mov     [ebp+var_14], eax
.text:0040E85D		       call    _strlen
.text:0040E862		       add     [ebp+var_10], 4
.text:0040E866		       pop     ecx
.text:0040E867		       pop     ecx
.text:0040E868		       mov     ecx, [ebp+var_14]
.text:0040E86B		       add     eax, edi
.text:0040E86D		       dec     [ebp+var_C]
.text:0040E870		       lea     edi, [eax+ecx+2]
.text:0040E874		       jnz     short loc_40E84D
.text:0040E876		       push    dword ptr [esi+9Ch] ; buf
.text:0040E87C		       call    _strlen
.text:0040E881		       push    dword ptr [esi+98h] ; buf
.text:0040E887		       mov     ebx, eax
.text:0040E889		       call    _strlen
.text:0040E88E		       push    dword ptr [esi+0A0h] ; buf
.text:0040E894		       add     eax, edi
.text:0040E896		       lea     edi, [eax+ebx+2]
.text:0040E89A		       call    _strlen
.text:0040E89F		       push    dword ptr [esi+0A4h] ; buf
.text:0040E8A5		       lea     edi, [edi+eax+1]
.text:0040E8A9		       call    _strlen
.text:0040E8AE		       push    dword ptr [esi+0A8h] ; buf
.text:0040E8B4		       lea     edi, [edi+eax+1]
.text:0040E8B8		       call    _strlen
.text:0040E8BD		       lea     eax, [edi+eax+0B9h]
.text:0040E8C4		       push    eax	       ; cb
.text:0040E8C5		       mov     [ebp+len], eax
.text:0040E8C8		       call    __malloc_crt
.text:0040E8CD		       mov     ebx, eax
.text:0040E8CF		       add     esp, 18h
.text:0040E8D2		       test    ebx, ebx
.text:0040E8D4		       jz      loc_40EB31
.text:0040E8DA		       push    0B8h	       ; count
.text:0040E8DF		       push    esi	       ; src
.text:0040E8E0		       push    ebx	       ; dst
.text:0040E8E1		       lea     edi, [ebx+0B8h]
.text:0040E8E7		       call    _memcpy
.text:0040E8EC		       and     [ebp+n],	0
.text:0040E8F0		       lea     eax, [esi+1Ch]
.text:0040E8F3		       mov     [ebp+var_10], ebx
.text:0040E8F6		       add     esp, 0Ch
.text:0040E8F9		       sub     [ebp+var_10], esi
.text:0040E8FC		       mov     [ebp+var_C], eax
.text:0040E8FF
.text:0040E8FF loc_40E8FF:			       ; CODE XREF: __Gettnames_l+18Ej
.text:0040E8FF		       mov     eax, [ebp+n]
.text:0040E902		       mov     [ebx+eax*4], edi
.text:0040E905		       mov     eax, [ebp+var_C]
.text:0040E908		       push    dword ptr [eax-1Ch] ; _Src
.text:0040E90B		       mov     eax, ebx
.text:0040E90D		       sub     eax, edi
.text:0040E90F		       add     eax, [ebp+len]
.text:0040E912		       push    eax	       ; _SizeInBytes
.text:0040E913		       push    edi	       ; _Dst
.text:0040E914		       call    _strcpy_s
.text:0040E919		       add     esp, 0Ch
.text:0040E91C		       test    eax, eax
.text:0040E91E		       jz      short loc_40E92F
.text:0040E920		       xor     eax, eax
.text:0040E922		       push    eax	       ; pReserved
.text:0040E923		       push    eax	       ; nLine
.text:0040E924		       push    eax	       ; pszFile
.text:0040E925		       push    eax	       ; pszFunction
.text:0040E926		       push    eax	       ; pszExpression
.text:0040E927		       call    __invoke_watson
.text:0040E92C		       add     esp, 14h
.text:0040E92F
.text:0040E92F loc_40E92F:			       ; CODE XREF: __Gettnames_l+12Ej
.text:0040E92F		       push    edi	       ; buf
.text:0040E930		       call    _strlen
.text:0040E935		       mov     ecx, [ebp+var_10]
.text:0040E938		       lea     edi, [edi+eax+1]
.text:0040E93C		       mov     eax, [ebp+var_C]
.text:0040E93F		       mov     [ecx+eax], edi
.text:0040E942		       push    dword ptr [eax] ; _Src
.text:0040E944		       mov     eax, ebx
.text:0040E946		       sub     eax, edi
.text:0040E948		       add     eax, [ebp+len]
.text:0040E94B		       push    eax	       ; _SizeInBytes
.text:0040E94C		       push    edi	       ; _Dst
.text:0040E94D		       call    _strcpy_s
.text:0040E952		       add     esp, 10h
.text:0040E955		       test    eax, eax
.text:0040E957		       jz      short loc_40E968
.text:0040E959		       xor     eax, eax
.text:0040E95B		       push    eax	       ; pReserved
.text:0040E95C		       push    eax	       ; nLine
.text:0040E95D		       push    eax	       ; pszFile
.text:0040E95E		       push    eax	       ; pszFunction
.text:0040E95F		       push    eax	       ; pszExpression
.text:0040E960		       call    __invoke_watson
.text:0040E965		       add     esp, 14h
.text:0040E968
.text:0040E968 loc_40E968:			       ; CODE XREF: __Gettnames_l+167j
.text:0040E968		       push    edi	       ; buf
.text:0040E969		       call    _strlen
.text:0040E96E		       inc     [ebp+n]
.text:0040E971		       add     [ebp+var_C], 4
.text:0040E975		       cmp     [ebp+n],	7
.text:0040E979		       pop     ecx
.text:0040E97A		       lea     edi, [edi+eax+1]
.text:0040E97E		       jb      loc_40E8FF
.text:0040E984		       lea     eax, [ebx+68h]
.text:0040E987		       mov     [ebp+n],	eax
.text:0040E98A		       lea     eax, [esi+38h]
.text:0040E98D		       mov     [ebp+var_C], eax
.text:0040E990		       mov     [ebp+var_14], 0Ch
.text:0040E997		       jmp     short loc_40E99C
.text:0040E999 ; ---------------------------------------------------------------------------
.text:0040E999
.text:0040E999 loc_40E999:			       ; CODE XREF: __Gettnames_l+227j
.text:0040E999		       mov     eax, [ebp+var_C]
.text:0040E99C
.text:0040E99C loc_40E99C:			       ; CODE XREF: __Gettnames_l+1A7j
.text:0040E99C		       mov     ecx, [ebp+var_10]
.text:0040E99F		       mov     [eax+ecx], edi
.text:0040E9A2		       push    dword ptr [eax] ; _Src
.text:0040E9A4		       mov     eax, ebx
.text:0040E9A6		       sub     eax, edi
.text:0040E9A8		       add     eax, [ebp+len]
.text:0040E9AB		       push    eax	       ; _SizeInBytes
.text:0040E9AC		       push    edi	       ; _Dst
.text:0040E9AD		       call    _strcpy_s
.text:0040E9B2		       add     esp, 0Ch
.text:0040E9B5		       test    eax, eax
.text:0040E9B7		       jz      short loc_40E9C8
.text:0040E9B9		       xor     eax, eax
.text:0040E9BB		       push    eax	       ; pReserved
.text:0040E9BC		       push    eax	       ; nLine
.text:0040E9BD		       push    eax	       ; pszFile
.text:0040E9BE		       push    eax	       ; pszFunction
.text:0040E9BF		       push    eax	       ; pszExpression
.text:0040E9C0		       call    __invoke_watson
.text:0040E9C5		       add     esp, 14h
.text:0040E9C8
.text:0040E9C8 loc_40E9C8:			       ; CODE XREF: __Gettnames_l+1C7j
.text:0040E9C8		       push    edi	       ; buf
.text:0040E9C9		       call    _strlen
.text:0040E9CE		       lea     edi, [edi+eax+1]
.text:0040E9D2		       mov     eax, [ebp+n]
.text:0040E9D5		       mov     [eax], edi
.text:0040E9D7		       mov     eax, [ebp+var_C]
.text:0040E9DA		       push    dword ptr [eax+30h] ; _Src
.text:0040E9DD		       mov     eax, ebx
.text:0040E9DF		       sub     eax, edi
.text:0040E9E1		       add     eax, [ebp+len]
.text:0040E9E4		       push    eax	       ; _SizeInBytes
.text:0040E9E5		       push    edi	       ; _Dst
.text:0040E9E6		       call    _strcpy_s
.text:0040E9EB		       add     esp, 10h
.text:0040E9EE		       test    eax, eax
.text:0040E9F0		       jz      short loc_40EA01
.text:0040E9F2		       xor     eax, eax
.text:0040E9F4		       push    eax	       ; pReserved
.text:0040E9F5		       push    eax	       ; nLine
.text:0040E9F6		       push    eax	       ; pszFile
.text:0040E9F7		       push    eax	       ; pszFunction
.text:0040E9F8		       push    eax	       ; pszExpression
.text:0040E9F9		       call    __invoke_watson
.text:0040E9FE		       add     esp, 14h
.text:0040EA01
.text:0040EA01 loc_40EA01:			       ; CODE XREF: __Gettnames_l+200j
.text:0040EA01		       push    edi	       ; buf
.text:0040EA02		       call    _strlen
.text:0040EA07		       add     [ebp+var_C], 4
.text:0040EA0B		       add     [ebp+n],	4
.text:0040EA0F		       dec     [ebp+var_14]
.text:0040EA12		       pop     ecx
.text:0040EA13		       lea     edi, [edi+eax+1]
.text:0040EA17		       jnz     short loc_40E999
.text:0040EA19		       mov     eax, ebx
.text:0040EA1B		       sub     eax, edi
.text:0040EA1D		       add     eax, [ebp+len]
.text:0040EA20		       mov     [ebx+98h], edi
.text:0040EA26		       push    dword ptr [esi+98h] ; _Src
.text:0040EA2C		       push    eax	       ; _SizeInBytes
.text:0040EA2D		       push    edi	       ; _Dst
.text:0040EA2E		       call    _strcpy_s
.text:0040EA33		       add     esp, 0Ch
.text:0040EA36		       test    eax, eax
.text:0040EA38		       jz      short loc_40EA49
.text:0040EA3A		       xor     eax, eax
.text:0040EA3C		       push    eax	       ; pReserved
.text:0040EA3D		       push    eax	       ; nLine
.text:0040EA3E		       push    eax	       ; pszFile
.text:0040EA3F		       push    eax	       ; pszFunction
.text:0040EA40		       push    eax	       ; pszExpression
.text:0040EA41		       call    __invoke_watson
.text:0040EA46		       add     esp, 14h
.text:0040EA49
.text:0040EA49 loc_40EA49:			       ; CODE XREF: __Gettnames_l+248j
.text:0040EA49		       push    edi	       ; buf
.text:0040EA4A		       call    _strlen
.text:0040EA4F		       lea     edi, [edi+eax+1]
.text:0040EA53		       mov     eax, ebx
.text:0040EA55		       sub     eax, edi
.text:0040EA57		       add     eax, [ebp+len]
.text:0040EA5A		       mov     [ebx+9Ch], edi
.text:0040EA60		       push    dword ptr [esi+9Ch] ; _Src
.text:0040EA66		       push    eax	       ; _SizeInBytes
.text:0040EA67		       push    edi	       ; _Dst
.text:0040EA68		       call    _strcpy_s
.text:0040EA6D		       add     esp, 10h
.text:0040EA70		       test    eax, eax
.text:0040EA72		       jz      short loc_40EA83
.text:0040EA74		       xor     eax, eax
.text:0040EA76		       push    eax	       ; pReserved
.text:0040EA77		       push    eax	       ; nLine
.text:0040EA78		       push    eax	       ; pszFile
.text:0040EA79		       push    eax	       ; pszFunction
.text:0040EA7A		       push    eax	       ; pszExpression
.text:0040EA7B		       call    __invoke_watson
.text:0040EA80		       add     esp, 14h
.text:0040EA83
.text:0040EA83 loc_40EA83:			       ; CODE XREF: __Gettnames_l+282j
.text:0040EA83		       push    edi	       ; buf
.text:0040EA84		       call    _strlen
.text:0040EA89		       lea     edi, [edi+eax+1]
.text:0040EA8D		       mov     eax, ebx
.text:0040EA8F		       sub     eax, edi
.text:0040EA91		       add     eax, [ebp+len]
.text:0040EA94		       mov     [ebx+0A0h], edi
.text:0040EA9A		       push    dword ptr [esi+0A0h] ; _Src
.text:0040EAA0		       push    eax	       ; _SizeInBytes
.text:0040EAA1		       push    edi	       ; _Dst
.text:0040EAA2		       call    _strcpy_s
.text:0040EAA7		       add     esp, 10h
.text:0040EAAA		       test    eax, eax
.text:0040EAAC		       jz      short loc_40EABD
.text:0040EAAE		       xor     eax, eax
.text:0040EAB0		       push    eax	       ; pReserved
.text:0040EAB1		       push    eax	       ; nLine
.text:0040EAB2		       push    eax	       ; pszFile
.text:0040EAB3		       push    eax	       ; pszFunction
.text:0040EAB4		       push    eax	       ; pszExpression
.text:0040EAB5		       call    __invoke_watson
.text:0040EABA		       add     esp, 14h
.text:0040EABD
.text:0040EABD loc_40EABD:			       ; CODE XREF: __Gettnames_l+2BCj
.text:0040EABD		       push    edi	       ; buf
.text:0040EABE		       call    _strlen
.text:0040EAC3		       lea     edi, [edi+eax+1]
.text:0040EAC7		       mov     eax, ebx
.text:0040EAC9		       sub     eax, edi
.text:0040EACB		       add     eax, [ebp+len]
.text:0040EACE		       mov     [ebx+0A4h], edi
.text:0040EAD4		       push    dword ptr [esi+0A4h] ; _Src
.text:0040EADA		       push    eax	       ; _SizeInBytes
.text:0040EADB		       push    edi	       ; _Dst
.text:0040EADC		       call    _strcpy_s
.text:0040EAE1		       add     esp, 10h
.text:0040EAE4		       test    eax, eax
.text:0040EAE6		       jz      short loc_40EAF7
.text:0040EAE8		       xor     eax, eax
.text:0040EAEA		       push    eax	       ; pReserved
.text:0040EAEB		       push    eax	       ; nLine
.text:0040EAEC		       push    eax	       ; pszFile
.text:0040EAED		       push    eax	       ; pszFunction
.text:0040EAEE		       push    eax	       ; pszExpression
.text:0040EAEF		       call    __invoke_watson
.text:0040EAF4		       add     esp, 14h
.text:0040EAF7
.text:0040EAF7 loc_40EAF7:			       ; CODE XREF: __Gettnames_l+2F6j
.text:0040EAF7		       push    edi	       ; buf
.text:0040EAF8		       call    _strlen
.text:0040EAFD		       lea     eax, [edi+eax+1]
.text:0040EB01		       mov     ecx, ebx
.text:0040EB03		       sub     ecx, eax
.text:0040EB05		       add     ecx, [ebp+len]
.text:0040EB08		       mov     [ebx+0A8h], eax
.text:0040EB0E		       push    dword ptr [esi+0A8h] ; _Src
.text:0040EB14		       push    ecx	       ; _SizeInBytes
.text:0040EB15		       push    eax	       ; _Dst
.text:0040EB16		       call    _strcpy_s
.text:0040EB1B		       add     esp, 10h
.text:0040EB1E		       test    eax, eax
.text:0040EB20		       jz      short loc_40EB31
.text:0040EB22		       xor     eax, eax
.text:0040EB24		       push    eax	       ; pReserved
.text:0040EB25		       push    eax	       ; nLine
.text:0040EB26		       push    eax	       ; pszFile
.text:0040EB27		       push    eax	       ; pszFunction
.text:0040EB28		       push    eax	       ; pszExpression
.text:0040EB29		       call    __invoke_watson
.text:0040EB2E		       add     esp, 14h
.text:0040EB31
.text:0040EB31 loc_40EB31:			       ; CODE XREF: __Gettnames_l+E4j
.text:0040EB31					       ; __Gettnames_l+330j
.text:0040EB31		       cmp     [ebp+_loc_update.updated], 0
.text:0040EB35		       jz      short loc_40EB3E
.text:0040EB37		       mov     eax, [ebp+_loc_update.ptd]
.text:0040EB3A		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040EB3E
.text:0040EB3E loc_40EB3E:			       ; CODE XREF: __Gettnames_l+345j
.text:0040EB3E		       pop     edi
.text:0040EB3F		       pop     esi
.text:0040EB40		       mov     eax, ebx
.text:0040EB42		       pop     ebx
.text:0040EB43		       leave
.text:0040EB44		       retn
.text:0040EB44 __Gettnames_l   endp
.text:0040EB44
.text:0040EB45
.text:0040EB45 ; =============== S U B R O U T I N E =======================================
.text:0040EB45
.text:0040EB45
.text:0040EB45 ; void *__cdecl _Gettnames()
.text:0040EB45 __Gettnames     proc near
.text:0040EB45		       push    0	       ; plocinfo
.text:0040EB47		       call    __Gettnames_l
.text:0040EB4C		       pop     ecx
.text:0040EB4D		       retn
.text:0040EB4D __Gettnames     endp
.text:0040EB4D
.text:0040EB4E
.text:0040EB4E ; =============== S U B R O U T I N E =======================================
.text:0040EB4E
.text:0040EB4E
.text:0040EB4E ; void __usercall store_str(char	*in<edx>, char **out<ecx>, unsigned int	*count<eax>)
.text:0040EB4E _store_str      proc near	       ; CODE XREF: _expandtime+3D9p
.text:0040EB4E in = edx
.text:0040EB4E out = ecx
.text:0040EB4E count = eax
.text:0040EB4E		       cmp     dword ptr [count], 0
.text:0040EB51		       push    esi
.text:0040EB52		       mov     esi, in
.text:0040EB54		       jz      short loc_40EB6C
.text:0040EB56		       push    edi
.text:0040EB57
.text:0040EB57 loc_40EB57:			       ; CODE XREF: _store_str+1Bj
.text:0040EB57		       mov     dl, [esi]
.text:0040EB59		       test    dl, dl
.text:0040EB5B		       jz      short loc_40EB6B
.text:0040EB5D		       mov     edi, [out]
.text:0040EB5F		       mov     [edi], dl
.text:0040EB61		       inc     dword ptr [out]
.text:0040EB63		       inc     esi
.text:0040EB64		       dec     dword ptr [count]
.text:0040EB66		       cmp     dword ptr [count], 0
.text:0040EB69		       jnz     short loc_40EB57
.text:0040EB6B
.text:0040EB6B loc_40EB6B:			       ; CODE XREF: _store_str+Dj
.text:0040EB6B		       pop     edi
.text:0040EB6C
.text:0040EB6C loc_40EB6C:			       ; CODE XREF: _store_str+6j
.text:0040EB6C		       pop     esi
.text:0040EB6D		       retn
.text:0040EB6D _store_str      endp
.text:0040EB6D
.text:0040EB6E
.text:0040EB6E ; =============== S U B R O U T I N E =======================================
.text:0040EB6E
.text:0040EB6E
.text:0040EB6E ; void __usercall store_number(int num<eax>, char **out<edi>, unsigned int *count<esi>)
.text:0040EB6E _store_number   proc near
.text:0040EB6E num = eax
.text:0040EB6E out = edi
.text:0040EB6E count = esi
.text:0040EB6E		       cmp     dword ptr [count], 1
.text:0040EB71		       mov     ecx, [out]
.text:0040EB73		       push    ebx
.text:0040EB74		       jbe     short loc_40EB8F
.text:0040EB76
.text:0040EB76 loc_40EB76:			       ; CODE XREF: _store_number+1Fj
.text:0040EB76		       push    0Ah
.text:0040EB78		       cdq
.text:0040EB79		       pop     ebx
.text:0040EB7A		       idiv    ebx
.text:0040EB7C		       add     dl, 30h
.text:0040EB7F		       mov     [ecx], dl
.text:0040EB81		       inc     ecx
.text:0040EB82		       dec     dword ptr [count]
.text:0040EB84		       test    num, num
.text:0040EB86		       mov     edx, [count]
.text:0040EB88		       jle     short loc_40EB8F
.text:0040EB8A		       cmp     edx, 1
.text:0040EB8D		       ja      short loc_40EB76
.text:0040EB8F
.text:0040EB8F loc_40EB8F:			       ; CODE XREF: _store_number+6j
.text:0040EB8F					       ; _store_number+1Aj
.text:0040EB8F		       mov     num, [out]
.text:0040EB91		       mov     [out], ecx
.text:0040EB93		       dec     ecx
.text:0040EB94
.text:0040EB94 loc_40EB94:			       ; CODE XREF: _store_number+32j
.text:0040EB94		       mov     bl, [num]
.text:0040EB96		       mov     dl, [ecx]
.text:0040EB98		       mov     [ecx], bl
.text:0040EB9A		       dec     ecx
.text:0040EB9B		       mov     [num], dl
.text:0040EB9D		       inc     num
.text:0040EB9E		       cmp     num, ecx
.text:0040EBA0		       jb      short loc_40EB94
.text:0040EBA2		       pop     ebx
.text:0040EBA3		       retn
.text:0040EBA3 _store_number   endp
.text:0040EBA3
.text:0040EBA4
.text:0040EBA4 ; =============== S U B R O U T I N E =======================================
.text:0040EBA4
.text:0040EBA4 ; Attributes: bp-based frame
.text:0040EBA4
.text:0040EBA4 ; void __usercall store_num(int num<eax>, int digits<edx>, char **out<edi>, unsigned int	*count<ecx>, unsigned int no_lead_zeros)
.text:0040EBA4 _store_num      proc near	       ; CODE XREF: _expandtime+250p
.text:0040EBA4
.text:0040EBA4 temp	       = dword ptr -4
.text:0040EBA4 no_lead_zeros   = dword ptr  8
.text:0040EBA4
.text:0040EBA4 num = eax
.text:0040EBA4 digits =	edx
.text:0040EBA4 out = edi
.text:0040EBA4 count = ecx
.text:0040EBA4		       push    ebp
.text:0040EBA5		       mov     ebp, esp
.text:0040EBA7		       push    count
.text:0040EBA8		       push    ebx
.text:0040EBA9		       push    esi
.text:0040EBAA		       mov     esi, digits
.text:0040EBAC		       xor     digits, digits
.text:0040EBAE		       cmp     [ebp+no_lead_zeros], digits
.text:0040EBB1		       mov     [ebp+temp], digits
.text:0040EBB4		       jz      short loc_40EBEB
.text:0040EBB6		       cmp     dword ptr [count], 1
.text:0040EBB9		       mov     esi, [out]
.text:0040EBBB		       jbe     short loc_40EBD6
.text:0040EBBD
.text:0040EBBD loc_40EBBD:			       ; CODE XREF: _store_num+30j
.text:0040EBBD		       push    0Ah
.text:0040EBBF		       cdq
.text:0040EBC0		       pop     ebx
.text:0040EBC1		       idiv    ebx
.text:0040EBC3		       add     dl, 30h
.text:0040EBC6		       mov     [esi], dl
.text:0040EBC8		       inc     esi
.text:0040EBC9		       dec     dword ptr [count]
.text:0040EBCB		       test    num, num
.text:0040EBCD		       mov     digits, [count]
.text:0040EBCF		       jle     short loc_40EBD6
.text:0040EBD1		       cmp     digits, 1
.text:0040EBD4		       ja      short loc_40EBBD
.text:0040EBD6
.text:0040EBD6 loc_40EBD6:			       ; CODE XREF: _store_num+17j
.text:0040EBD6					       ; _store_num+2Bj
.text:0040EBD6		       mov     num, [out]
.text:0040EBD8		       mov     [out], esi
.text:0040EBDA		       dec     esi
.text:0040EBDB
.text:0040EBDB loc_40EBDB:			       ; CODE XREF: _store_num+43j
.text:0040EBDB		       mov     dl, [num]
.text:0040EBDD		       mov     cl, [esi]
.text:0040EBDF		       mov     [esi], dl
.text:0040EBE1		       dec     esi
.text:0040EBE2		       mov     [num], cl
.text:0040EBE4		       inc     num
.text:0040EBE5		       cmp     num, esi
.text:0040EBE7		       jb      short loc_40EBDB
.text:0040EBE9		       jmp     short loc_40EC19
.text:0040EBEB ; ---------------------------------------------------------------------------
.text:0040EBEB
.text:0040EBEB loc_40EBEB:			       ; CODE XREF: _store_num+10j
.text:0040EBEB		       cmp     esi, [count]
.text:0040EBED		       jnb     short loc_40EC17
.text:0040EBEF		       dec     esi
.text:0040EBF0		       lea     digits, [esi+1]
.text:0040EBF3		       test    digits, digits
.text:0040EBF5		       jz      short loc_40EC0E
.text:0040EBF7
.text:0040EBF7 loc_40EBF7:			       ; CODE XREF: _store_num+68j
.text:0040EBF7		       push    0Ah
.text:0040EBF9		       cdq
.text:0040EBFA		       pop     ebx
.text:0040EBFB		       idiv    ebx
.text:0040EBFD		       mov     ebx, [out]
.text:0040EBFF		       add     dl, 30h
.text:0040EC02		       inc     [ebp+temp]
.text:0040EC05		       mov     [esi+ebx], dl
.text:0040EC08		       dec     esi
.text:0040EC09		       cmp     esi, 0FFFFFFFFh
.text:0040EC0C		       jnz     short loc_40EBF7
.text:0040EC0E
.text:0040EC0E loc_40EC0E:			       ; CODE XREF: _store_num+51j
.text:0040EC0E		       mov     num, [ebp+temp]
.text:0040EC11		       add     [out], num
.text:0040EC13		       sub     [count],	num
.text:0040EC15		       jmp     short loc_40EC19
.text:0040EC17 ; ---------------------------------------------------------------------------
.text:0040EC17
.text:0040EC17 loc_40EC17:			       ; CODE XREF: _store_num+49j
.text:0040EC17		       mov     [count],	digits
.text:0040EC19
.text:0040EC19 loc_40EC19:			       ; CODE XREF: _store_num+45j
.text:0040EC19					       ; _store_num+71j
.text:0040EC19		       pop     esi
.text:0040EC1A		       pop     ebx
.text:0040EC1B		       leave
.text:0040EC1C		       retn
.text:0040EC1C _store_num      endp
.text:0040EC1C
.text:0040EC1D
.text:0040EC1D ; =============== S U B R O U T I N E =======================================
.text:0040EC1D
.text:0040EC1D ; Attributes: bp-based frame
.text:0040EC1D
.text:0040EC1D ; int __usercall	expandtime<eax>(localeinfo_struct *plocinfo, char specifier<al>, tm *timeptr<edx>, char	**string<ecx>, unsigned	int *left, __lc_time_data *lc_time, unsigned int alternate_form)
.text:0040EC1D _expandtime     proc near	       ; CODE XREF: _store_winword+442p
.text:0040EC1D					       ; __Strftime_l+11Bp
.text:0040EC1D
.text:0040EC1D var_4	       = dword ptr -4
.text:0040EC1D plocinfo	       = dword ptr  8
.text:0040EC1D left	       = dword ptr  0Ch
.text:0040EC1D lc_time	       = dword ptr  10h
.text:0040EC1D alternate_form  = dword ptr  14h
.text:0040EC1D
.text:0040EC1D specifier = al
.text:0040EC1D timeptr = edx
.text:0040EC1D string =	ecx
.text:0040EC1D		       push    ebp
.text:0040EC1E		       mov     ebp, esp
.text:0040EC20		       push    string
.text:0040EC21		       push    ebx
.text:0040EC22		       movsx   eax, specifier
.text:0040EC25		       cmp     eax, 59h
.text:0040EC28		       push    esi
.text:0040EC29		       push    edi
.text:0040EC2A		       mov     ebx, string
.text:0040EC2C		       mov     esi, timeptr
.text:0040EC2E		       jg      loc_40EDF1
.text:0040EC34		       jz      loc_40EDBF
.text:0040EC3A		       cmp     eax, 49h
.text:0040EC3D		       jg      loc_40ED0E
.text:0040EC43		       jz      loc_40ECE1
.text:0040EC49		       sub     eax, 4
.text:0040EC4C		       jz      loc_40EFFB
.text:0040EC52		       sub     eax, 9
.text:0040EC55		       jz      loc_40EFFB
.text:0040EC5B		       sub     eax, 18h
.text:0040EC5E		       jz      short loc_40ECD0
.text:0040EC60		       sub     eax, 1Ch
.text:0040EC63		       jz      short loc_40ECAE
.text:0040EC65		       dec     eax
.text:0040EC66		       jz      short loc_40EC8C
.text:0040EC68		       sub     eax, 6
.text:0040EC6B		       jnz     loc_40EF0B
.text:0040EC71		       mov     eax, [esi+8]
.text:0040EC74		       xor     edi, edi
.text:0040EC76		       cmp     eax, edi
.text:0040EC78		       jl      loc_40EEF3
.text:0040EC7E		       cmp     eax, 17h
.text:0040EC81
.text:0040EC81 loc_40EC81:			       ; CODE XREF: _expandtime+198j
.text:0040EC81		       jg      loc_40EEF3
.text:0040EC87		       jmp     loc_40EE62
.text:0040EC8C ; ---------------------------------------------------------------------------
.text:0040EC8C
.text:0040EC8C loc_40EC8C:			       ; CODE XREF: _expandtime+49j
.text:0040EC8C		       mov     esi, [esi+10h]
.text:0040EC8F		       xor     edi, edi
.text:0040EC91		       cmp     esi, edi
.text:0040EC93		       jl      loc_40EEF3
.text:0040EC99		       cmp     esi, 0Bh
.text:0040EC9C		       jg      loc_40EEF3
.text:0040ECA2		       mov     timeptr,	[ebp+lc_time]
.text:0040ECA5		       mov     timeptr,	[timeptr+esi*4+68h]
.text:0040ECA9		       jmp     loc_40EFF3
.text:0040ECAE ; ---------------------------------------------------------------------------
.text:0040ECAE
.text:0040ECAE loc_40ECAE:			       ; CODE XREF: _expandtime+46j
.text:0040ECAE		       mov     esi, [esi+18h]
.text:0040ECB1		       xor     edi, edi
.text:0040ECB3		       cmp     esi, edi
.text:0040ECB5		       jl      loc_40EEF3
.text:0040ECBB		       cmp     esi, 6
.text:0040ECBE		       jg      loc_40EEF3
.text:0040ECC4		       mov     timeptr,	[ebp+lc_time]
.text:0040ECC7		       mov     timeptr,	[timeptr+esi*4+1Ch]
.text:0040ECCB		       jmp     loc_40EFF3
.text:0040ECD0 ; ---------------------------------------------------------------------------
.text:0040ECD0
.text:0040ECD0 loc_40ECD0:			       ; CODE XREF: _expandtime+41j
.text:0040ECD0		       mov     eax, [ebx]
.text:0040ECD2		       mov     byte ptr	[eax], 25h
.text:0040ECD5		       mov     eax, [ebp+left]
.text:0040ECD8		       inc     dword ptr [ebx]
.text:0040ECDA		       dec     dword ptr [eax]
.text:0040ECDC		       jmp     loc_40EFFB
.text:0040ECE1 ; ---------------------------------------------------------------------------
.text:0040ECE1
.text:0040ECE1 loc_40ECE1:			       ; CODE XREF: _expandtime+26j
.text:0040ECE1		       mov     eax, [esi+8]
.text:0040ECE4		       xor     edi, edi
.text:0040ECE6		       cmp     eax, edi
.text:0040ECE8		       jl      loc_40EEF3
.text:0040ECEE		       cmp     eax, 17h
.text:0040ECF1		       jg      loc_40EEF3
.text:0040ECF7		       cdq
.text:0040ECF8		       push    0Ch
.text:0040ECFA		       pop     string
.text:0040ECFB		       idiv    string
.text:0040ECFD		       mov     eax, timeptr
.text:0040ECFF		       cmp     eax, edi
.text:0040ED01		       jnz     loc_40EE62
.text:0040ED07		       push    string
.text:0040ED08		       pop     eax
.text:0040ED09		       jmp     loc_40EE62
.text:0040ED0E ; ---------------------------------------------------------------------------
.text:0040ED0E
.text:0040ED0E loc_40ED0E:			       ; CODE XREF: _expandtime+20j
.text:0040ED0E		       sub     eax, 4Dh
.text:0040ED11		       jz      loc_40EDBA
.text:0040ED17		       push    6
.text:0040ED19		       pop     string
.text:0040ED1A		       sub     eax, string
.text:0040ED1C		       jz      loc_40EDA6
.text:0040ED22		       dec     eax
.text:0040ED23		       dec     eax
.text:0040ED24		       jz      short loc_40ED5A
.text:0040ED26		       dec     eax
.text:0040ED27		       dec     eax
.text:0040ED28		       jz      short loc_40ED3C
.text:0040ED2A		       dec     eax
.text:0040ED2B		       jnz     loc_40EF0B
.text:0040ED31		       push    [ebp+lc_time]
.text:0040ED34		       push    [ebp+left]
.text:0040ED37		       jmp     loc_40EEAF
.text:0040ED3C ; ---------------------------------------------------------------------------
.text:0040ED3C
.text:0040ED3C loc_40ED3C:			       ; CODE XREF: _expandtime+10Bj
.text:0040ED3C		       mov     eax, [esi+18h]
.text:0040ED3F		       xor     edi, edi
.text:0040ED41		       cmp     eax, edi
.text:0040ED43		       jl      loc_40EEF3
.text:0040ED49		       cmp     eax, string
.text:0040ED4B		       jg      loc_40EEF3
.text:0040ED51		       cmp     eax, edi
.text:0040ED53		       jz      short weeknum
.text:0040ED55		       lea     string, [eax-1]
.text:0040ED58		       jmp     short weeknum
.text:0040ED5A ; ---------------------------------------------------------------------------
.text:0040ED5A
.text:0040ED5A loc_40ED5A:			       ; CODE XREF: _expandtime+107j
.text:0040ED5A		       mov     eax, [esi+18h]
.text:0040ED5D		       xor     edi, edi
.text:0040ED5F		       cmp     eax, edi
.text:0040ED61		       jl      loc_40EEF3
.text:0040ED67		       cmp     eax, string
.text:0040ED69		       jg      loc_40EEF3
.text:0040ED6F		       mov     string, eax
.text:0040ED71
.text:0040ED71 weeknum:				       ; CODE XREF: _expandtime+136j
.text:0040ED71					       ; _expandtime+13Bj
.text:0040ED71		       mov     eax, [esi+1Ch]
.text:0040ED74		       cmp     eax, edi
.text:0040ED76		       jl      loc_40EEF3
.text:0040ED7C		       cmp     eax, 16Dh
.text:0040ED81		       jg      loc_40EEF3
.text:0040ED87		       cmp     eax, string
.text:0040ED89		       jge     short loc_40ED92
.text:0040ED8B		       xor     eax, eax
.text:0040ED8D		       jmp     loc_40EE62
.text:0040ED92 ; ---------------------------------------------------------------------------
.text:0040ED92
.text:0040ED92 loc_40ED92:			       ; CODE XREF: _expandtime+16Cj
.text:0040ED92		       push    7
.text:0040ED94		       cdq
.text:0040ED95		       pop     esi
.text:0040ED96		       idiv    esi
.text:0040ED98		       cmp     timeptr,	string
.text:0040ED9A		       jl      loc_40EE62
.text:0040EDA0		       inc     eax
.text:0040EDA1		       jmp     loc_40EE62
.text:0040EDA6 ; ---------------------------------------------------------------------------
.text:0040EDA6
.text:0040EDA6 loc_40EDA6:			       ; CODE XREF: _expandtime+FFj
.text:0040EDA6		       mov     eax, [esi]
.text:0040EDA8
.text:0040EDA8 loc_40EDA8:			       ; CODE XREF: _expandtime+1A0j
.text:0040EDA8		       xor     edi, edi
.text:0040EDAA		       cmp     eax, edi
.text:0040EDAC		       jl      loc_40EEF3
.text:0040EDB2		       cmp     eax, 3Bh
.text:0040EDB5		       jmp     loc_40EC81
.text:0040EDBA ; ---------------------------------------------------------------------------
.text:0040EDBA
.text:0040EDBA loc_40EDBA:			       ; CODE XREF: _expandtime+F4j
.text:0040EDBA		       mov     eax, [esi+4]
.text:0040EDBD		       jmp     short loc_40EDA8
.text:0040EDBF ; ---------------------------------------------------------------------------
.text:0040EDBF
.text:0040EDBF loc_40EDBF:			       ; CODE XREF: _expandtime+17j
.text:0040EDBF		       mov     eax, [esi+14h]
.text:0040EDC2		       cmp     eax, 0FFFFF894h
.text:0040EDC7		       jl      short loc_40EDD0
.text:0040EDC9		       cmp     eax, 1FA3h
.text:0040EDCE		       jle     short loc_40EDDC
.text:0040EDD0
.text:0040EDD0 loc_40EDD0:			       ; CODE XREF: _expandtime+1AAj
.text:0040EDD0					       ; _expandtime+234j ...
.text:0040EDD0		       call    __errno
.text:0040EDD5		       xor     edi, edi
.text:0040EDD7		       jmp     loc_40EEF8
.text:0040EDDC ; ---------------------------------------------------------------------------
.text:0040EDDC
.text:0040EDDC loc_40EDDC:			       ; CODE XREF: _expandtime+1B1j
.text:0040EDDC		       cdq		       ; digits
.text:0040EDDD		       push    64h
.text:0040EDDF		       pop     string
.text:0040EDE0		       idiv    string
.text:0040EDE2		       push    [ebp+alternate_form]
.text:0040EDE5		       push    4
.text:0040EDE7		       add     eax, 13h
.text:0040EDEA		       imul    eax, 64h
.text:0040EDED		       add     eax, timeptr
.text:0040EDEF		       jmp     short loc_40EE67
.text:0040EDF1 ; ---------------------------------------------------------------------------
.text:0040EDF1
.text:0040EDF1 loc_40EDF1:			       ; CODE XREF: _expandtime+11j
.text:0040EDF1		       cmp     eax, 6Dh
.text:0040EDF4		       jg      loc_40EF33
.text:0040EDFA		       jz      loc_40EF1D
.text:0040EE00		       sub     eax, 5Ah
.text:0040EE03		       jz      loc_40EF4A
.text:0040EE09		       sub     eax, 7
.text:0040EE0C		       jz      loc_40EEE5
.text:0040EE12		       dec     eax
.text:0040EE13		       jz      loc_40EECB
.text:0040EE19		       dec     eax
.text:0040EE1A		       jz      short loc_40EE78
.text:0040EE1C		       dec     eax
.text:0040EE1D		       jz      short loc_40EE4B
.text:0040EE1F		       sub     eax, 6
.text:0040EE22		       jnz     loc_40EF0B
.text:0040EE28		       mov     esi, [esi+1Ch]
.text:0040EE2B		       xor     edi, edi
.text:0040EE2D		       cmp     esi, edi
.text:0040EE2F		       jl      loc_40EEF3
.text:0040EE35		       cmp     esi, 16Dh
.text:0040EE3B		       jg      loc_40EEF3
.text:0040EE41		       push    [ebp+alternate_form]
.text:0040EE44		       lea     eax, [esi+1]
.text:0040EE47		       push    3
.text:0040EE49		       jmp     short loc_40EE67
.text:0040EE4B ; ---------------------------------------------------------------------------
.text:0040EE4B
.text:0040EE4B loc_40EE4B:			       ; CODE XREF: _expandtime+200j
.text:0040EE4B		       mov     esi, [esi+0Ch]
.text:0040EE4E		       cmp     esi, 1
.text:0040EE51		       jl      loc_40EDD0
.text:0040EE57		       cmp     esi, 1Fh
.text:0040EE5A		       jg      loc_40EDD0
.text:0040EE60		       mov     eax, esi	       ; num
.text:0040EE62
.text:0040EE62 loc_40EE62:			       ; CODE XREF: _expandtime+6Aj
.text:0040EE62					       ; _expandtime+E4j ...
.text:0040EE62		       push    [ebp+alternate_form] ; no_lead_zeros
.text:0040EE65
.text:0040EE65 loc_40EE65:			       ; CODE XREF: _expandtime+368j
.text:0040EE65		       push    2
.text:0040EE67
.text:0040EE67 loc_40EE67:			       ; CODE XREF: _expandtime+1D2j
.text:0040EE67					       ; _expandtime+22Cj
.text:0040EE67		       pop     timeptr
.text:0040EE68
.text:0040EE68 loc_40EE68:			       ; CODE XREF: _expandtime+3A5j
.text:0040EE68		       mov     string, [ebp+left] ; count
.text:0040EE6B		       mov     edi, ebx	       ; out
.text:0040EE6D		       call    _store_num
.text:0040EE72		       pop     string
.text:0040EE73		       jmp     loc_40EFFB
.text:0040EE78 ; ---------------------------------------------------------------------------
.text:0040EE78
.text:0040EE78 loc_40EE78:			       ; CODE XREF: _expandtime+1FDj
.text:0040EE78		       push    [ebp+lc_time]   ; lc_time
.text:0040EE7B		       xor     edi, edi
.text:0040EE7D		       cmp     [ebp+alternate_form], edi
.text:0040EE80		       push    [ebp+left]      ; count
.text:0040EE83		       push    ebx	       ; out
.text:0040EE84		       push    esi	       ; tmptr
.text:0040EE85		       jz      short loc_40EEC8
.text:0040EE87		       push    1	       ; field_code
.text:0040EE89
.text:0040EE89 loc_40EE89:			       ; CODE XREF: _expandtime+2ACj
.text:0040EE89		       push    [ebp+plocinfo]  ; plocinfo
.text:0040EE8C		       call    _store_winword
.text:0040EE91		       add     esp, 18h
.text:0040EE94		       test    eax, eax
.text:0040EE96		       jz      short loc_40EF0B
.text:0040EE98		       mov     eax, [ebp+left]
.text:0040EE9B		       cmp     [eax], edi
.text:0040EE9D		       jz      short loc_40EF0B
.text:0040EE9F		       mov     eax, [ebx]
.text:0040EEA1		       push    [ebp+lc_time]   ; lc_time
.text:0040EEA4		       mov     byte ptr	[eax], 20h
.text:0040EEA7		       mov     eax, [ebp+left]
.text:0040EEAA		       inc     dword ptr [ebx]
.text:0040EEAC		       dec     dword ptr [eax]
.text:0040EEAE		       push    eax	       ; count
.text:0040EEAF
.text:0040EEAF loc_40EEAF:			       ; CODE XREF: _expandtime+11Aj
.text:0040EEAF		       push    ebx	       ; out
.text:0040EEB0		       push    esi	       ; tmptr
.text:0040EEB1		       push    2	       ; field_code
.text:0040EEB3
.text:0040EEB3 loc_40EEB3:			       ; CODE XREF: _expandtime+37Ej
.text:0040EEB3					       ; _expandtime+384j
.text:0040EEB3		       push    [ebp+plocinfo]  ; plocinfo
.text:0040EEB6		       call    _store_winword
.text:0040EEBB		       add     esp, 18h
.text:0040EEBE		       test    eax, eax
.text:0040EEC0		       jnz     loc_40EFFB
.text:0040EEC6		       jmp     short loc_40EF0B
.text:0040EEC8 ; ---------------------------------------------------------------------------
.text:0040EEC8
.text:0040EEC8 loc_40EEC8:			       ; CODE XREF: _expandtime+268j
.text:0040EEC8		       push    edi
.text:0040EEC9		       jmp     short loc_40EE89
.text:0040EECB ; ---------------------------------------------------------------------------
.text:0040EECB
.text:0040EECB loc_40EECB:			       ; CODE XREF: _expandtime+1F6j
.text:0040EECB		       mov     esi, [esi+10h]
.text:0040EECE		       xor     edi, edi
.text:0040EED0		       cmp     esi, edi
.text:0040EED2		       jl      short loc_40EEF3
.text:0040EED4		       cmp     esi, 0Bh
.text:0040EED7		       jg      short loc_40EEF3
.text:0040EED9		       mov     timeptr,	[ebp+lc_time]
.text:0040EEDC		       mov     timeptr,	[timeptr+esi*4+38h]
.text:0040EEE0		       jmp     loc_40EFF3
.text:0040EEE5 ; ---------------------------------------------------------------------------
.text:0040EEE5
.text:0040EEE5 loc_40EEE5:			       ; CODE XREF: _expandtime+1EFj
.text:0040EEE5		       mov     esi, [esi+18h]
.text:0040EEE8		       xor     edi, edi
.text:0040EEEA		       cmp     esi, edi
.text:0040EEEC		       jl      short loc_40EEF3
.text:0040EEEE		       cmp     esi, 6
.text:0040EEF1		       jle     short loc_40EF12
.text:0040EEF3
.text:0040EEF3 loc_40EEF3:			       ; CODE XREF: _expandtime+5Bj
.text:0040EEF3					       ; _expandtime:loc_40EC81j ...
.text:0040EEF3		       call    __errno
.text:0040EEF8
.text:0040EEF8 loc_40EEF8:			       ; CODE XREF: _expandtime+1BAj
.text:0040EEF8		       push    edi	       ; pReserved
.text:0040EEF9		       push    edi	       ; nLine
.text:0040EEFA		       push    edi	       ; pszFile
.text:0040EEFB		       push    edi	       ; pszFunction
.text:0040EEFC		       push    edi	       ; pszExpression
.text:0040EEFD		       mov     dword ptr [eax],	16h
.text:0040EF03		       call    __invalid_parameter
.text:0040EF08		       add     esp, 14h
.text:0040EF0B
.text:0040EF0B loc_40EF0B:			       ; CODE XREF: _expandtime+4Ej
.text:0040EF0B					       ; _expandtime+10Ej ...
.text:0040EF0B		       xor     eax, eax
.text:0040EF0D		       jmp     loc_40EFFE
.text:0040EF12 ; ---------------------------------------------------------------------------
.text:0040EF12
.text:0040EF12 loc_40EF12:			       ; CODE XREF: _expandtime+2D4j
.text:0040EF12		       mov     timeptr,	[ebp+lc_time]
.text:0040EF15		       mov     timeptr,	[timeptr+esi*4]
.text:0040EF18		       jmp     loc_40EFF3
.text:0040EF1D ; ---------------------------------------------------------------------------
.text:0040EF1D
.text:0040EF1D loc_40EF1D:			       ; CODE XREF: _expandtime+1DDj
.text:0040EF1D		       mov     esi, [esi+10h]
.text:0040EF20		       xor     edi, edi
.text:0040EF22		       cmp     esi, edi
.text:0040EF24		       jl      short loc_40EEF3
.text:0040EF26		       cmp     esi, 0Bh
.text:0040EF29		       jg      short loc_40EEF3
.text:0040EF2B		       lea     eax, [esi+1]
.text:0040EF2E		       jmp     loc_40EE62
.text:0040EF33 ; ---------------------------------------------------------------------------
.text:0040EF33
.text:0040EF33 loc_40EF33:			       ; CODE XREF: _expandtime+1D7j
.text:0040EF33		       sub     eax, 70h
.text:0040EF36		       jz      loc_40EFC7
.text:0040EF3C		       sub     eax, 7
.text:0040EF3F		       jz      short loc_40EFA6
.text:0040EF41		       dec     eax
.text:0040EF42		       jz      short loc_40EF8A
.text:0040EF44		       dec     eax
.text:0040EF45		       jz      short loc_40EF6D
.text:0040EF47		       dec     eax
.text:0040EF48		       jnz     short loc_40EF0B
.text:0040EF4A
.text:0040EF4A loc_40EF4A:			       ; CODE XREF: _expandtime+1E6j
.text:0040EF4A		       call    ___tzset
.text:0040EF4F		       call    ___tzname
.text:0040EF54		       mov     timeptr,	eax
.text:0040EF56		       xor     eax, eax
.text:0040EF58		       cmp     [esi+20h], eax
.text:0040EF5B		       mov     string, ebx     ; out
.text:0040EF5D		       setnz   specifier
.text:0040EF60		       mov     ebx, eax
.text:0040EF62		       mov     timeptr,	[timeptr+ebx*4]
.text:0040EF65		       mov     [ebp+var_4], eax
.text:0040EF68		       jmp     loc_40EFF3
.text:0040EF6D ; ---------------------------------------------------------------------------
.text:0040EF6D
.text:0040EF6D loc_40EF6D:			       ; CODE XREF: _expandtime+328j
.text:0040EF6D		       mov     eax, [esi+14h]
.text:0040EF70		       xor     edi, edi
.text:0040EF72		       cmp     eax, edi
.text:0040EF74		       jl      loc_40EEF3
.text:0040EF7A		       push    [ebp+alternate_form]
.text:0040EF7D		       cdq
.text:0040EF7E		       push    64h
.text:0040EF80		       pop     string
.text:0040EF81		       idiv    string
.text:0040EF83		       mov     eax, timeptr
.text:0040EF85		       jmp     loc_40EE65
.text:0040EF8A ; ---------------------------------------------------------------------------
.text:0040EF8A
.text:0040EF8A loc_40EF8A:			       ; CODE XREF: _expandtime+325j
.text:0040EF8A		       push    [ebp+lc_time]
.text:0040EF8D		       xor     edi, edi
.text:0040EF8F		       cmp     [ebp+alternate_form], edi
.text:0040EF92		       push    [ebp+left]
.text:0040EF95		       push    ebx
.text:0040EF96		       push    esi
.text:0040EF97		       jz      short loc_40EFA0
.text:0040EF99		       push    1
.text:0040EF9B		       jmp     loc_40EEB3
.text:0040EFA0 ; ---------------------------------------------------------------------------
.text:0040EFA0
.text:0040EFA0 loc_40EFA0:			       ; CODE XREF: _expandtime+37Aj
.text:0040EFA0		       push    edi
.text:0040EFA1		       jmp     loc_40EEB3
.text:0040EFA6 ; ---------------------------------------------------------------------------
.text:0040EFA6
.text:0040EFA6 loc_40EFA6:			       ; CODE XREF: _expandtime+322j
.text:0040EFA6		       mov     eax, [esi+18h]
.text:0040EFA9		       xor     edi, edi
.text:0040EFAB		       cmp     eax, edi
.text:0040EFAD		       jl      loc_40EEF3
.text:0040EFB3		       cmp     eax, 6
.text:0040EFB6		       jg      loc_40EEF3
.text:0040EFBC		       push    [ebp+alternate_form]
.text:0040EFBF		       xor     timeptr,	timeptr
.text:0040EFC1		       inc     timeptr
.text:0040EFC2		       jmp     loc_40EE68
.text:0040EFC7 ; ---------------------------------------------------------------------------
.text:0040EFC7
.text:0040EFC7 loc_40EFC7:			       ; CODE XREF: _expandtime+319j
.text:0040EFC7		       mov     esi, [esi+8]
.text:0040EFCA		       xor     edi, edi
.text:0040EFCC		       cmp     esi, edi
.text:0040EFCE		       jl      loc_40EEF3
.text:0040EFD4		       cmp     esi, 17h
.text:0040EFD7		       jg      loc_40EEF3
.text:0040EFDD		       cmp     esi, 0Bh
.text:0040EFE0		       mov     timeptr,	[ebp+lc_time]
.text:0040EFE3		       jg      short loc_40EFED
.text:0040EFE5		       mov     timeptr,	[timeptr+98h]
.text:0040EFEB		       jmp     short loc_40EFF3
.text:0040EFED ; ---------------------------------------------------------------------------
.text:0040EFED
.text:0040EFED loc_40EFED:			       ; CODE XREF: _expandtime+3C6j
.text:0040EFED		       mov     timeptr,	[timeptr+9Ch] ;	in
.text:0040EFF3
.text:0040EFF3 loc_40EFF3:			       ; CODE XREF: _expandtime+8Cj
.text:0040EFF3					       ; _expandtime+AEj ...
.text:0040EFF3		       mov     eax, [ebp+left] ; count
.text:0040EFF6		       call    _store_str
.text:0040EFFB
.text:0040EFFB loc_40EFFB:			       ; CODE XREF: _expandtime+2Fj
.text:0040EFFB					       ; _expandtime+38j ...
.text:0040EFFB		       xor     eax, eax
.text:0040EFFD		       inc     eax
.text:0040EFFE
.text:0040EFFE loc_40EFFE:			       ; CODE XREF: _expandtime+2F0j
.text:0040EFFE		       pop     edi
.text:0040EFFF		       pop     esi
.text:0040F000		       pop     ebx
.text:0040F001		       leave
.text:0040F002		       retn
.text:0040F002 _expandtime     endp
.text:0040F002
.text:0040F003
.text:0040F003 ; =============== S U B R O U T I N E =======================================
.text:0040F003
.text:0040F003 ; Attributes: bp-based frame
.text:0040F003
.text:0040F003 ; int __cdecl store_winword(localeinfo_struct *plocinfo,	int field_code,	tm *tmptr, char	**out, unsigned	int *count, __lc_time_data *lc_time)
.text:0040F003 _store_winword  proc near	       ; CODE XREF: _expandtime+26Fp
.text:0040F003					       ; _expandtime+299p
.text:0040F003
.text:0040F003 SystemTime      = _SYSTEMTIME ptr -20h
.text:0040F003 cch	       = dword ptr -10h
.text:0040F003 FormatFunc      = dword ptr -0Ch
.text:0040F003 buffer	       = dword ptr -8
.text:0040F003 var_4	       = dword ptr -4
.text:0040F003 plocinfo	       = dword ptr  8
.text:0040F003 field_code      = dword ptr  0Ch
.text:0040F003 tmptr	       = dword ptr  10h
.text:0040F003 out	       = dword ptr  14h
.text:0040F003 count	       = dword ptr  18h
.text:0040F003 lc_time	       = dword ptr  1Ch
.text:0040F003
.text:0040F003		       push    ebp
.text:0040F004		       mov     ebp, esp
.text:0040F006		       sub     esp, 20h
.text:0040F009		       mov     eax, ___security_cookie
.text:0040F00E		       xor     eax, ebp
.text:0040F010		       mov     [ebp+var_4], eax
.text:0040F013		       mov     eax, [ebp+field_code]
.text:0040F016		       push    ebx
.text:0040F017		       push    esi
.text:0040F018		       mov     esi, [ebp+lc_time]
.text:0040F01B		       xor     ebx, ebx
.text:0040F01D		       sub     eax, ebx
.text:0040F01F		       push    edi
.text:0040F020		       jz      short loc_40F035
.text:0040F022		       dec     eax
.text:0040F023		       jz      short loc_40F02D
.text:0040F025		       mov     edi, [esi+0A8h]
.text:0040F02B		       jmp     short loc_40F03B
.text:0040F02D ; ---------------------------------------------------------------------------
.text:0040F02D
.text:0040F02D loc_40F02D:			       ; CODE XREF: _store_winword+20j
.text:0040F02D		       mov     edi, [esi+0A4h]
.text:0040F033		       jmp     short loc_40F03B
.text:0040F035 ; ---------------------------------------------------------------------------
.text:0040F035
.text:0040F035 loc_40F035:			       ; CODE XREF: _store_winword+1Dj
.text:0040F035		       mov     edi, [esi+0A0h]
.text:0040F03B
.text:0040F03B loc_40F03B:			       ; CODE XREF: _store_winword+28j
.text:0040F03B					       ; _store_winword+30j
.text:0040F03B		       cmp     dword ptr [esi+0B0h], 1
.text:0040F042		       mov     eax, [ebp+tmptr]
.text:0040F045		       jz      loc_40F147
.text:0040F04B		       cmp     [ebp+field_code], 2
.text:0040F04F		       mov     ecx, ds:__imp__GetDateFormatA@24	; GetDateFormatA(x,x,x,x,x,x)
.text:0040F055		       jnz     short loc_40F05D
.text:0040F057		       mov     ecx, ds:__imp__GetTimeFormatA@24	; GetTimeFormatA(x,x,x,x,x,x)
.text:0040F05D
.text:0040F05D loc_40F05D:			       ; CODE XREF: _store_winword+52j
.text:0040F05D		       mov     dx, [eax+14h]
.text:0040F061		       add     dx, 76Ch
.text:0040F066		       mov     [ebp+SystemTime.wYear], dx
.text:0040F06A		       mov     dx, [eax+10h]
.text:0040F06E		       inc     dx
.text:0040F070		       mov     [ebp+SystemTime.wMonth],	dx
.text:0040F074		       mov     dx, [eax+0Ch]
.text:0040F078		       mov     [ebp+SystemTime.wDay], dx
.text:0040F07C		       mov     dx, [eax+8]
.text:0040F080		       push    ebx	       ; cchDate
.text:0040F081		       mov     [ebp+SystemTime.wHour], dx
.text:0040F085		       mov     dx, [eax+4]
.text:0040F089		       mov     ax, [eax]
.text:0040F08C		       push    ebx	       ; lpDateStr
.text:0040F08D		       push    edi	       ; lpFormat
.text:0040F08E		       mov     [ebp+SystemTime.wSecond], ax
.text:0040F092		       lea     eax, [ebp+SystemTime]
.text:0040F095		       push    eax	       ; lpDate
.text:0040F096		       push    ebx	       ; dwFlags
.text:0040F097		       push    dword ptr [esi+0ACh] ; Locale
.text:0040F09D		       mov     [ebp+FormatFunc], ecx
.text:0040F0A0		       mov     [ebp+SystemTime.wMinute], dx
.text:0040F0A4		       mov     [ebp+SystemTime.wMilliseconds], bx
.text:0040F0A8		       call    ecx ; GetDateFormatA(x,x,x,x,x,x) ; GetDateFormatA(x,x,x,x,x,x)
.text:0040F0AA		       cmp     eax, ebx
.text:0040F0AC		       mov     [ebp+cch], eax
.text:0040F0AF		       jz      loc_40F147
.text:0040F0B5		       add     eax, 8
.text:0040F0B8		       cmp     eax, 400h
.text:0040F0BD		       jg      short loc_40F0D2
.text:0040F0BF		       call    __alloca_probe_16
.text:0040F0C4		       mov     eax, esp
.text:0040F0C6		       cmp     eax, ebx
.text:0040F0C8		       jz      short loc_40F0E6
.text:0040F0CA		       mov     dword ptr [eax],	0CCCCh
.text:0040F0D0		       jmp     short loc_40F0E3
.text:0040F0D2 ; ---------------------------------------------------------------------------
.text:0040F0D2
.text:0040F0D2 loc_40F0D2:			       ; CODE XREF: _store_winword+BAj
.text:0040F0D2		       push    eax	       ; size
.text:0040F0D3		       call    _malloc
.text:0040F0D8		       cmp     eax, ebx
.text:0040F0DA		       pop     ecx
.text:0040F0DB		       jz      short loc_40F0E6
.text:0040F0DD		       mov     dword ptr [eax],	0DDDDh
.text:0040F0E3
.text:0040F0E3 loc_40F0E3:			       ; CODE XREF: _store_winword+CDj
.text:0040F0E3		       add     eax, 8
.text:0040F0E6
.text:0040F0E6 loc_40F0E6:			       ; CODE XREF: _store_winword+C5j
.text:0040F0E6					       ; _store_winword+D8j
.text:0040F0E6		       cmp     eax, ebx
.text:0040F0E8		       mov     [ebp+buffer], eax
.text:0040F0EB		       jz      short loc_40F147
.text:0040F0ED		       push    [ebp+cch]
.text:0040F0F0		       mov     ebx, eax
.text:0040F0F2		       push    ebx
.text:0040F0F3		       push    edi
.text:0040F0F4		       lea     eax, [ebp+SystemTime]
.text:0040F0F7		       push    eax
.text:0040F0F8		       push    0
.text:0040F0FA		       push    dword ptr [esi+0ACh]
.text:0040F100		       call    [ebp+FormatFunc]
.text:0040F103		       dec     eax
.text:0040F104		       test    eax, eax
.text:0040F106		       jle     short loc_40F129
.text:0040F108		       mov     esi, [ebp+count]
.text:0040F10B		       mov     ecx, [ebp+out]
.text:0040F10E
.text:0040F10E loc_40F10E:			       ; CODE XREF: _store_winword+124j
.text:0040F10E		       cmp     dword ptr [esi],	0
.text:0040F111		       jbe     short loc_40F129
.text:0040F113		       mov     edx, [ecx]
.text:0040F115		       mov     [ebp+cch], eax
.text:0040F118		       mov     al, [ebx]
.text:0040F11A		       mov     [edx], al
.text:0040F11C		       inc     dword ptr [ecx]
.text:0040F11E		       mov     eax, [ebp+cch]
.text:0040F121		       inc     ebx
.text:0040F122		       dec     dword ptr [esi]
.text:0040F124		       dec     eax
.text:0040F125		       test    eax, eax
.text:0040F127		       jg      short loc_40F10E
.text:0040F129
.text:0040F129 loc_40F129:			       ; CODE XREF: _store_winword+103j
.text:0040F129					       ; _store_winword+10Ej
.text:0040F129		       push    [ebp+buffer]    ; _Memory
.text:0040F12C		       call    __freea
.text:0040F131		       pop     ecx
.text:0040F132
.text:0040F132 loc_40F132:			       ; CODE XREF: _store_winword+148j
.text:0040F132					       ; _store_winword+153j ...
.text:0040F132		       xor     eax, eax
.text:0040F134		       inc     eax
.text:0040F135
.text:0040F135 loc_40F135:			       ; CODE XREF: _store_winword+458j
.text:0040F135		       lea     esp, [ebp-2Ch]
.text:0040F138		       pop     edi
.text:0040F139		       pop     esi
.text:0040F13A		       pop     ebx
.text:0040F13B		       mov     ecx, [ebp+var_4]
.text:0040F13E		       xor     ecx, ebp	       ; cookie
.text:0040F140		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F145		       leave
.text:0040F146		       retn
.text:0040F147 ; ---------------------------------------------------------------------------
.text:0040F147
.text:0040F147 loc_40F147:			       ; CODE XREF: _store_winword+42j
.text:0040F147					       ; _store_winword+ACj ...
.text:0040F147		       mov     al, [edi]
.text:0040F149		       test    al, al
.text:0040F14B		       jz      short loc_40F132
.text:0040F14D		       mov     ebx, [ebp+count]
.text:0040F150		       mov     esi, [ebp+out]
.text:0040F153
.text:0040F153 loc_40F153:			       ; CODE XREF: _store_winword+1D7j
.text:0040F153		       cmp     dword ptr [ebx],	0
.text:0040F156		       jz      short loc_40F132
.text:0040F158		       xor     edx, edx
.text:0040F15A		       mov     [ebp+buffer], edx
.text:0040F15D		       mov     ecx, edi
.text:0040F15F
.text:0040F15F loc_40F15F:			       ; CODE XREF: _store_winword+160j
.text:0040F15F		       inc     ecx
.text:0040F160		       inc     edx
.text:0040F161		       cmp     [ecx], al
.text:0040F163		       jz      short loc_40F15F
.text:0040F165		       mov     [ebp+FormatFunc], ecx
.text:0040F168		       movsx   ecx, al
.text:0040F16B		       cmp     ecx, 64h
.text:0040F16E		       jg      loc_40F2F6
.text:0040F174		       jz      loc_40F2C8
.text:0040F17A		       cmp     ecx, 27h
.text:0040F17D		       jz      loc_40F25B
.text:0040F183		       cmp     ecx, 41h
.text:0040F186		       jz      loc_40F227
.text:0040F18C		       cmp     ecx, 48h
.text:0040F18F		       jz      short loc_40F20F
.text:0040F191		       cmp     ecx, 4Dh
.text:0040F194		       jz      short loc_40F1E5
.text:0040F196		       cmp     ecx, 61h
.text:0040F199		       jz      loc_40F227
.text:0040F19F
.text:0040F19F loc_40F19F:			       ; CODE XREF: _store_winword+1EEj
.text:0040F19F					       ; _store_winword+214j ...
.text:0040F19F		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F1A2		       push    ecx	       ; c
.text:0040F1A3		       call    __isleadbyte_l
.text:0040F1A8		       test    eax, eax
.text:0040F1AA		       pop     ecx
.text:0040F1AB		       pop     ecx
.text:0040F1AC		       jz      short loc_40F1CB
.text:0040F1AE		       cmp     dword ptr [ebx],	1
.text:0040F1B1		       jbe     short loc_40F1CB
.text:0040F1B3		       lea     eax, [edi+1]
.text:0040F1B6		       cmp     byte ptr	[eax], 0
.text:0040F1B9		       jz      loc_40F459
.text:0040F1BF		       mov     dl, [edi]
.text:0040F1C1		       mov     ecx, [esi]
.text:0040F1C3		       mov     [ecx], dl
.text:0040F1C5		       inc     dword ptr [esi]
.text:0040F1C7		       dec     dword ptr [ebx]
.text:0040F1C9		       mov     edi, eax
.text:0040F1CB
.text:0040F1CB loc_40F1CB:			       ; CODE XREF: _store_winword+1A9j
.text:0040F1CB					       ; _store_winword+1AEj
.text:0040F1CB		       mov     cl, [edi]
.text:0040F1CD		       mov     eax, [esi]
.text:0040F1CF		       mov     [eax], cl
.text:0040F1D1		       inc     dword ptr [esi]
.text:0040F1D3		       inc     edi
.text:0040F1D4		       dec     dword ptr [ebx]
.text:0040F1D6
.text:0040F1D6 loc_40F1D6:			       ; CODE XREF: _store_winword+25Dj
.text:0040F1D6					       ; _store_winword+270j ...
.text:0040F1D6		       mov     al, [edi]
.text:0040F1D8		       test    al, al
.text:0040F1DA		       jnz     loc_40F153
.text:0040F1E0		       jmp     loc_40F132
.text:0040F1E5 ; ---------------------------------------------------------------------------
.text:0040F1E5
.text:0040F1E5 loc_40F1E5:			       ; CODE XREF: _store_winword+191j
.text:0040F1E5		       mov     eax, edx
.text:0040F1E7		       dec     eax
.text:0040F1E8		       jz      short loc_40F201
.text:0040F1EA		       dec     eax
.text:0040F1EB		       jz      short loc_40F208
.text:0040F1ED		       dec     eax
.text:0040F1EE		       jz      short loc_40F1FA
.text:0040F1F0		       dec     eax
.text:0040F1F1		       jnz     short loc_40F19F
.text:0040F1F3		       mov     al, 42h
.text:0040F1F5		       jmp     loc_40F436
.text:0040F1FA ; ---------------------------------------------------------------------------
.text:0040F1FA
.text:0040F1FA loc_40F1FA:			       ; CODE XREF: _store_winword+1EBj
.text:0040F1FA		       mov     al, 62h
.text:0040F1FC		       jmp     loc_40F436
.text:0040F201 ; ---------------------------------------------------------------------------
.text:0040F201
.text:0040F201 loc_40F201:			       ; CODE XREF: _store_winword+1E5j
.text:0040F201		       mov     [ebp+buffer], 1
.text:0040F208
.text:0040F208 loc_40F208:			       ; CODE XREF: _store_winword+1E8j
.text:0040F208		       mov     al, 6Dh
.text:0040F20A		       jmp     loc_40F436
.text:0040F20F ; ---------------------------------------------------------------------------
.text:0040F20F
.text:0040F20F loc_40F20F:			       ; CODE XREF: _store_winword+18Cj
.text:0040F20F		       mov     eax, edx
.text:0040F211		       dec     eax
.text:0040F212		       jz      short loc_40F219
.text:0040F214		       dec     eax
.text:0040F215		       jz      short loc_40F220
.text:0040F217		       jmp     short loc_40F19F
.text:0040F219 ; ---------------------------------------------------------------------------
.text:0040F219
.text:0040F219 loc_40F219:			       ; CODE XREF: _store_winword+20Fj
.text:0040F219		       mov     [ebp+buffer], 1
.text:0040F220
.text:0040F220 loc_40F220:			       ; CODE XREF: _store_winword+212j
.text:0040F220		       mov     al, 48h
.text:0040F222		       jmp     loc_40F436
.text:0040F227 ; ---------------------------------------------------------------------------
.text:0040F227
.text:0040F227 loc_40F227:			       ; CODE XREF: _store_winword+183j
.text:0040F227					       ; _store_winword+196j
.text:0040F227		       push    offset src      ; "am/pm"
.text:0040F22C		       push    edi	       ; dst
.text:0040F22D		       call    ___ascii_stricmp
.text:0040F232		       test    eax, eax
.text:0040F234		       pop     ecx
.text:0040F235		       pop     ecx
.text:0040F236		       jnz     short loc_40F23D
.text:0040F238		       add     edi, 5
.text:0040F23B		       jmp     short loc_40F251
.text:0040F23D ; ---------------------------------------------------------------------------
.text:0040F23D
.text:0040F23D loc_40F23D:			       ; CODE XREF: _store_winword+233j
.text:0040F23D		       push    offset aAP      ; "a/p"
.text:0040F242		       push    edi	       ; dst
.text:0040F243		       call    ___ascii_stricmp
.text:0040F248		       test    eax, eax
.text:0040F24A		       pop     ecx
.text:0040F24B		       pop     ecx
.text:0040F24C		       jnz     short loc_40F254
.text:0040F24E		       add     edi, 3
.text:0040F251
.text:0040F251 loc_40F251:			       ; CODE XREF: _store_winword+238j
.text:0040F251		       mov     [ebp+FormatFunc], edi
.text:0040F254
.text:0040F254 loc_40F254:			       ; CODE XREF: _store_winword+249j
.text:0040F254		       mov     al, 70h
.text:0040F256		       jmp     loc_40F436
.text:0040F25B ; ---------------------------------------------------------------------------
.text:0040F25B
.text:0040F25B loc_40F25B:			       ; CODE XREF: _store_winword+17Aj
.text:0040F25B		       add     edi, edx
.text:0040F25D		       test    dl, 1
.text:0040F260		       jz      loc_40F1D6
.text:0040F266		       mov     al, [edi]
.text:0040F268		       test    al, al
.text:0040F26A		       jz      loc_40F132
.text:0040F270
.text:0040F270 loc_40F270:			       ; CODE XREF: _store_winword+2B8j
.text:0040F270		       cmp     dword ptr [ebx],	0
.text:0040F273		       jz      loc_40F1D6
.text:0040F279		       cmp     al, 27h
.text:0040F27B		       jz      short loc_40F2C2
.text:0040F27D		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F280		       movsx   eax, al
.text:0040F283		       push    eax	       ; c
.text:0040F284		       call    __isleadbyte_l
.text:0040F289		       test    eax, eax
.text:0040F28B		       pop     ecx
.text:0040F28C		       pop     ecx
.text:0040F28D		       jz      short loc_40F2AC
.text:0040F28F		       cmp     dword ptr [ebx],	1
.text:0040F292		       jbe     short loc_40F2AC
.text:0040F294		       lea     eax, [edi+1]
.text:0040F297		       cmp     byte ptr	[eax], 0
.text:0040F29A		       jz      loc_40F459
.text:0040F2A0		       mov     dl, [edi]
.text:0040F2A2		       mov     ecx, [esi]
.text:0040F2A4		       mov     [ecx], dl
.text:0040F2A6		       inc     dword ptr [esi]
.text:0040F2A8		       dec     dword ptr [ebx]
.text:0040F2AA		       mov     edi, eax
.text:0040F2AC
.text:0040F2AC loc_40F2AC:			       ; CODE XREF: _store_winword+28Aj
.text:0040F2AC					       ; _store_winword+28Fj
.text:0040F2AC		       mov     eax, [esi]
.text:0040F2AE		       mov     cl, [edi]
.text:0040F2B0		       mov     [eax], cl
.text:0040F2B2		       inc     dword ptr [esi]
.text:0040F2B4		       inc     edi
.text:0040F2B5		       dec     dword ptr [ebx]
.text:0040F2B7		       mov     al, [edi]
.text:0040F2B9		       test    al, al
.text:0040F2BB		       jnz     short loc_40F270
.text:0040F2BD		       jmp     loc_40F1D6
.text:0040F2C2 ; ---------------------------------------------------------------------------
.text:0040F2C2
.text:0040F2C2 loc_40F2C2:			       ; CODE XREF: _store_winword+278j
.text:0040F2C2		       inc     edi
.text:0040F2C3		       jmp     loc_40F1D6
.text:0040F2C8 ; ---------------------------------------------------------------------------
.text:0040F2C8
.text:0040F2C8 loc_40F2C8:			       ; CODE XREF: _store_winword+171j
.text:0040F2C8		       mov     eax, edx
.text:0040F2CA		       dec     eax
.text:0040F2CB		       jz      short loc_40F2E8
.text:0040F2CD		       dec     eax
.text:0040F2CE		       jz      short loc_40F2EF
.text:0040F2D0		       dec     eax
.text:0040F2D1		       jz      short loc_40F2E1
.text:0040F2D3		       dec     eax
.text:0040F2D4		       jnz     loc_40F19F
.text:0040F2DA		       mov     al, 41h
.text:0040F2DC		       jmp     loc_40F436
.text:0040F2E1 ; ---------------------------------------------------------------------------
.text:0040F2E1
.text:0040F2E1 loc_40F2E1:			       ; CODE XREF: _store_winword+2CEj
.text:0040F2E1		       mov     al, 61h
.text:0040F2E3		       jmp     loc_40F436
.text:0040F2E8 ; ---------------------------------------------------------------------------
.text:0040F2E8
.text:0040F2E8 loc_40F2E8:			       ; CODE XREF: _store_winword+2C8j
.text:0040F2E8		       mov     [ebp+buffer], 1
.text:0040F2EF
.text:0040F2EF loc_40F2EF:			       ; CODE XREF: _store_winword+2CBj
.text:0040F2EF		       mov     al, 64h
.text:0040F2F1		       jmp     loc_40F436
.text:0040F2F6 ; ---------------------------------------------------------------------------
.text:0040F2F6
.text:0040F2F6 loc_40F2F6:			       ; CODE XREF: _store_winword+16Bj
.text:0040F2F6		       mov     eax, ecx
.text:0040F2F8		       sub     eax, 68h
.text:0040F2FB		       jz      loc_40F420
.text:0040F301		       sub     eax, 5
.text:0040F304		       jz      loc_40F408
.text:0040F30A		       sub     eax, 6
.text:0040F30D		       jz      loc_40F3F0
.text:0040F313		       dec     eax
.text:0040F314		       jz      short loc_40F33B
.text:0040F316		       sub     eax, 5
.text:0040F319		       jnz     loc_40F19F
.text:0040F31F		       mov     eax, edx
.text:0040F321		       dec     eax
.text:0040F322		       dec     eax
.text:0040F323		       jz      short loc_40F334
.text:0040F325		       dec     eax
.text:0040F326		       dec     eax
.text:0040F327		       jnz     loc_40F19F
.text:0040F32D		       mov     al, 59h
.text:0040F32F		       jmp     loc_40F436
.text:0040F334 ; ---------------------------------------------------------------------------
.text:0040F334
.text:0040F334 loc_40F334:			       ; CODE XREF: _store_winword+320j
.text:0040F334		       mov     al, 79h
.text:0040F336		       jmp     loc_40F436
.text:0040F33B ; ---------------------------------------------------------------------------
.text:0040F33B
.text:0040F33B loc_40F33B:			       ; CODE XREF: _store_winword+311j
.text:0040F33B		       mov     eax, [ebp+tmptr]
.text:0040F33E		       cmp     dword ptr [eax+8], 0Bh
.text:0040F342		       mov     eax, [ebp+lc_time]
.text:0040F345		       jg      short loc_40F34F
.text:0040F347		       mov     edi, [eax+98h]
.text:0040F34D		       jmp     short loc_40F355
.text:0040F34F ; ---------------------------------------------------------------------------
.text:0040F34F
.text:0040F34F loc_40F34F:			       ; CODE XREF: _store_winword+342j
.text:0040F34F		       mov     edi, [eax+9Ch]
.text:0040F355
.text:0040F355 loc_40F355:			       ; CODE XREF: _store_winword+34Aj
.text:0040F355		       cmp     edx, 1
.text:0040F358		       jnz     loc_40F3E8
.text:0040F35E		       cmp     dword ptr [ebx],	0
.text:0040F361		       jbe     loc_40F3E8
.text:0040F367		       movsx   eax, byte ptr [edi]
.text:0040F36A		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F36D		       push    eax	       ; c
.text:0040F36E		       call    __isleadbyte_l
.text:0040F373		       test    eax, eax
.text:0040F375		       pop     ecx
.text:0040F376		       pop     ecx
.text:0040F377		       jz      short loc_40F396
.text:0040F379		       cmp     dword ptr [ebx],	1
.text:0040F37C		       jbe     short loc_40F396
.text:0040F37E		       lea     eax, [edi+1]
.text:0040F381		       cmp     byte ptr	[eax], 0
.text:0040F384		       jz      loc_40F459
.text:0040F38A		       mov     dl, [edi]
.text:0040F38C		       mov     ecx, [esi]
.text:0040F38E		       mov     [ecx], dl
.text:0040F390		       inc     dword ptr [esi]
.text:0040F392		       dec     dword ptr [ebx]
.text:0040F394		       mov     edi, eax
.text:0040F396
.text:0040F396 loc_40F396:			       ; CODE XREF: _store_winword+374j
.text:0040F396					       ; _store_winword+379j
.text:0040F396		       mov     eax, [esi]
.text:0040F398		       mov     cl, [edi]
.text:0040F39A		       mov     [eax], cl
.text:0040F39C		       inc     dword ptr [esi]
.text:0040F39E		       dec     dword ptr [ebx]
.text:0040F3A0		       jmp     loc_40F451
.text:0040F3A5 ; ---------------------------------------------------------------------------
.text:0040F3A5
.text:0040F3A5 loc_40F3A5:			       ; CODE XREF: _store_winword+3E9j
.text:0040F3A5		       cmp     dword ptr [ebx],	0
.text:0040F3A8		       jbe     loc_40F451
.text:0040F3AE		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F3B1		       movsx   eax, al
.text:0040F3B4		       push    eax	       ; c
.text:0040F3B5		       call    __isleadbyte_l
.text:0040F3BA		       test    eax, eax
.text:0040F3BC		       pop     ecx
.text:0040F3BD		       pop     ecx
.text:0040F3BE		       jz      short loc_40F3DD
.text:0040F3C0		       cmp     dword ptr [ebx],	1
.text:0040F3C3		       jbe     short loc_40F3DD
.text:0040F3C5		       lea     eax, [edi+1]
.text:0040F3C8		       cmp     byte ptr	[eax], 0
.text:0040F3CB		       jz      loc_40F459
.text:0040F3D1		       mov     dl, [edi]
.text:0040F3D3		       mov     ecx, [esi]
.text:0040F3D5		       mov     [ecx], dl
.text:0040F3D7		       inc     dword ptr [esi]
.text:0040F3D9		       dec     dword ptr [ebx]
.text:0040F3DB		       mov     edi, eax
.text:0040F3DD
.text:0040F3DD loc_40F3DD:			       ; CODE XREF: _store_winword+3BBj
.text:0040F3DD					       ; _store_winword+3C0j
.text:0040F3DD		       mov     cl, [edi]
.text:0040F3DF		       mov     eax, [esi]
.text:0040F3E1		       mov     [eax], cl
.text:0040F3E3		       inc     dword ptr [esi]
.text:0040F3E5		       inc     edi
.text:0040F3E6		       dec     dword ptr [ebx]
.text:0040F3E8
.text:0040F3E8 loc_40F3E8:			       ; CODE XREF: _store_winword+355j
.text:0040F3E8					       ; _store_winword+35Ej
.text:0040F3E8		       mov     al, [edi]
.text:0040F3EA		       test    al, al
.text:0040F3EC		       jnz     short loc_40F3A5
.text:0040F3EE		       jmp     short loc_40F451
.text:0040F3F0 ; ---------------------------------------------------------------------------
.text:0040F3F0
.text:0040F3F0 loc_40F3F0:			       ; CODE XREF: _store_winword+30Aj
.text:0040F3F0		       mov     eax, edx
.text:0040F3F2		       dec     eax
.text:0040F3F3		       jz      short loc_40F3FD
.text:0040F3F5		       dec     eax
.text:0040F3F6		       jz      short loc_40F404
.text:0040F3F8		       jmp     loc_40F19F
.text:0040F3FD ; ---------------------------------------------------------------------------
.text:0040F3FD
.text:0040F3FD loc_40F3FD:			       ; CODE XREF: _store_winword+3F0j
.text:0040F3FD		       mov     [ebp+buffer], 1
.text:0040F404
.text:0040F404 loc_40F404:			       ; CODE XREF: _store_winword+3F3j
.text:0040F404		       mov     al, 53h
.text:0040F406		       jmp     short loc_40F436
.text:0040F408 ; ---------------------------------------------------------------------------
.text:0040F408
.text:0040F408 loc_40F408:			       ; CODE XREF: _store_winword+301j
.text:0040F408		       mov     eax, edx
.text:0040F40A		       dec     eax
.text:0040F40B		       jz      short loc_40F415
.text:0040F40D		       dec     eax
.text:0040F40E		       jz      short loc_40F41C
.text:0040F410		       jmp     loc_40F19F
.text:0040F415 ; ---------------------------------------------------------------------------
.text:0040F415
.text:0040F415 loc_40F415:			       ; CODE XREF: _store_winword+408j
.text:0040F415		       mov     [ebp+buffer], 1
.text:0040F41C
.text:0040F41C loc_40F41C:			       ; CODE XREF: _store_winword+40Bj
.text:0040F41C		       mov     al, 4Dh
.text:0040F41E		       jmp     short loc_40F436
.text:0040F420 ; ---------------------------------------------------------------------------
.text:0040F420
.text:0040F420 loc_40F420:			       ; CODE XREF: _store_winword+2F8j
.text:0040F420		       mov     eax, edx
.text:0040F422		       dec     eax
.text:0040F423		       jz      short loc_40F42D
.text:0040F425		       dec     eax
.text:0040F426		       jz      short loc_40F434
.text:0040F428		       jmp     loc_40F19F
.text:0040F42D ; ---------------------------------------------------------------------------
.text:0040F42D
.text:0040F42D loc_40F42D:			       ; CODE XREF: _store_winword+420j
.text:0040F42D		       mov     [ebp+buffer], 1
.text:0040F434
.text:0040F434 loc_40F434:			       ; CODE XREF: _store_winword+423j
.text:0040F434		       mov     al, 49h	       ; specifier
.text:0040F436
.text:0040F436 loc_40F436:			       ; CODE XREF: _store_winword+1F2j
.text:0040F436					       ; _store_winword+1F9j ...
.text:0040F436		       push    [ebp+buffer]    ; alternate_form
.text:0040F439		       mov     edx, [ebp+tmptr]	; timeptr
.text:0040F43C		       push    [ebp+lc_time]   ; lc_time
.text:0040F43F		       mov     ecx, esi	       ; string
.text:0040F441		       push    ebx	       ; left
.text:0040F442		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F445		       call    _expandtime
.text:0040F44A		       add     esp, 10h
.text:0040F44D		       test    eax, eax
.text:0040F44F		       jz      short loc_40F459
.text:0040F451
.text:0040F451 loc_40F451:			       ; CODE XREF: _store_winword+39Dj
.text:0040F451					       ; _store_winword+3A5j ...
.text:0040F451		       mov     edi, [ebp+FormatFunc]
.text:0040F454		       jmp     loc_40F1D6
.text:0040F459 ; ---------------------------------------------------------------------------
.text:0040F459
.text:0040F459 loc_40F459:			       ; CODE XREF: _store_winword+1B6j
.text:0040F459					       ; _store_winword+297j ...
.text:0040F459		       xor     eax, eax
.text:0040F45B		       jmp     loc_40F135
.text:0040F45B _store_winword  endp
.text:0040F45B
.text:0040F460
.text:0040F460 ; =============== S U B R O U T I N E =======================================
.text:0040F460
.text:0040F460 ; Attributes: bp-based frame
.text:0040F460
.text:0040F460 ; unsigned int __cdecl _Strftime_l(char *string,	unsigned int maxsize, const char *format, tm *timeptr, void *lc_time_arg, localeinfo_struct *plocinfo)
.text:0040F460 __Strftime_l    proc near	       ; CODE XREF: __strftime_l+14p
.text:0040F460					       ; _strftime+14p	...
.text:0040F460
.text:0040F460 _loc_update     = _LocaleUpdate ptr -20h
.text:0040F460 strstart	       = dword ptr -10h
.text:0040F460 lc_time	       = dword ptr -0Ch
.text:0040F460 failed	       = dword ptr -8
.text:0040F460 left	       = dword ptr -4
.text:0040F460 string	       = dword ptr  8
.text:0040F460 maxsize	       = dword ptr  0Ch
.text:0040F460 format	       = dword ptr  10h
.text:0040F460 timeptr	       = dword ptr  14h
.text:0040F460 lc_time_arg     = dword ptr  18h
.text:0040F460 plocinfo	       = dword ptr  1Ch
.text:0040F460
.text:0040F460		       push    ebp
.text:0040F461		       mov     ebp, esp
.text:0040F463		       sub     esp, 20h
.text:0040F466		       mov     eax, [ebp+string]
.text:0040F469		       push    ebx
.text:0040F46A		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F46D		       xor     ebx, ebx
.text:0040F46F		       lea     ecx, [ebp+_loc_update] ;	this
.text:0040F472		       mov     [ebp+failed], ebx
.text:0040F475		       mov     [ebp+strstart], eax
.text:0040F478		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0040F47D		       mov     eax, [ebp+string]
.text:0040F480		       cmp     eax, ebx
.text:0040F482		       jnz     short loc_40F4AF
.text:0040F484		       call    __errno
.text:0040F489		       push    ebx	       ; pReserved
.text:0040F48A		       push    ebx	       ; nLine
.text:0040F48B		       push    ebx	       ; pszFile
.text:0040F48C		       push    ebx	       ; pszFunction
.text:0040F48D		       push    ebx	       ; pszExpression
.text:0040F48E		       mov     dword ptr [eax],	16h
.text:0040F494		       call    __invalid_parameter
.text:0040F499		       add     esp, 14h
.text:0040F49C		       cmp     [ebp+_loc_update.updated], bl
.text:0040F49F		       jz      short loc_40F4A8
.text:0040F4A1		       mov     eax, [ebp+_loc_update.ptd]
.text:0040F4A4		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040F4A8
.text:0040F4A8 loc_40F4A8:			       ; CODE XREF: __Strftime_l+3Fj
.text:0040F4A8		       xor     eax, eax
.text:0040F4AA		       jmp     loc_40F60C
.text:0040F4AF ; ---------------------------------------------------------------------------
.text:0040F4AF
.text:0040F4AF loc_40F4AF:			       ; CODE XREF: __Strftime_l+22j
.text:0040F4AF		       push    edi
.text:0040F4B0		       mov     edi, [ebp+maxsize]
.text:0040F4B3		       cmp     edi, ebx
.text:0040F4B5		       jnz     short loc_40F4E2
.text:0040F4B7		       call    __errno
.text:0040F4BC		       push    ebx	       ; pReserved
.text:0040F4BD		       push    ebx	       ; nLine
.text:0040F4BE		       push    ebx	       ; pszFile
.text:0040F4BF		       push    ebx	       ; pszFunction
.text:0040F4C0		       push    ebx	       ; pszExpression
.text:0040F4C1		       mov     dword ptr [eax],	16h
.text:0040F4C7		       call    __invalid_parameter
.text:0040F4CC		       add     esp, 14h
.text:0040F4CF		       cmp     [ebp+_loc_update.updated], bl
.text:0040F4D2		       jz      short loc_40F4DB
.text:0040F4D4		       mov     eax, [ebp+_loc_update.ptd]
.text:0040F4D7		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040F4DB
.text:0040F4DB loc_40F4DB:			       ; CODE XREF: __Strftime_l+72j
.text:0040F4DB		       xor     eax, eax
.text:0040F4DD		       jmp     loc_40F60B
.text:0040F4E2 ; ---------------------------------------------------------------------------
.text:0040F4E2
.text:0040F4E2 loc_40F4E2:			       ; CODE XREF: __Strftime_l+55j
.text:0040F4E2		       push    esi
.text:0040F4E3		       mov     esi, [ebp+format]
.text:0040F4E6		       cmp     esi, ebx
.text:0040F4E8		       mov     [eax], bl
.text:0040F4EA		       jz      loc_40F5E4
.text:0040F4F0		       mov     eax, [ebp+lc_time_arg]
.text:0040F4F3		       cmp     eax, ebx
.text:0040F4F5		       jnz     short loc_40F500
.text:0040F4F7		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:0040F4FA		       mov     eax, [eax+0D4h]
.text:0040F500
.text:0040F500 loc_40F500:			       ; CODE XREF: __Strftime_l+95j
.text:0040F500		       cmp     edi, ebx
.text:0040F502		       mov     [ebp+lc_time], eax
.text:0040F505		       mov     [ebp+left], edi
.text:0040F508		       jbe     loc_40F5AD
.text:0040F50E
.text:0040F50E loc_40F50E:			       ; CODE XREF: __Strftime_l+12Bj
.text:0040F50E		       mov     al, [esi]
.text:0040F510		       cmp     al, bl
.text:0040F512		       jz      short loc_40F58D
.text:0040F514		       cmp     al, 25h
.text:0040F516		       jz      short loc_40F559
.text:0040F518		       lea     ecx, [ebp+_loc_update]
.text:0040F51B		       movsx   eax, al
.text:0040F51E		       push    ecx	       ; plocinfo
.text:0040F51F		       push    eax	       ; c
.text:0040F520		       call    __isleadbyte_l
.text:0040F525		       test    eax, eax
.text:0040F527		       pop     ecx
.text:0040F528		       pop     ecx
.text:0040F529		       jz      short loc_40F549
.text:0040F52B		       xor     ecx, ecx
.text:0040F52D		       inc     ecx
.text:0040F52E		       cmp     [ebp+left], ecx
.text:0040F531		       jbe     short loc_40F549
.text:0040F533		       lea     eax, [esi+1]
.text:0040F536		       cmp     [eax], bl
.text:0040F538		       jz      short loc_40F5AA
.text:0040F53A		       mov     cl, [esi]
.text:0040F53C		       mov     edx, [ebp+string]
.text:0040F53F		       mov     [edx], cl
.text:0040F541		       inc     [ebp+string]
.text:0040F544		       dec     [ebp+left]
.text:0040F547		       mov     esi, eax
.text:0040F549
.text:0040F549 loc_40F549:			       ; CODE XREF: __Strftime_l+C9j
.text:0040F549					       ; __Strftime_l+D1j
.text:0040F549		       mov     al, [esi]
.text:0040F54B		       mov     ecx, [ebp+string]
.text:0040F54E		       mov     [ecx], al
.text:0040F550		       inc     [ebp+string]
.text:0040F553		       inc     esi
.text:0040F554		       dec     [ebp+left]
.text:0040F557		       jmp     short loc_40F588
.text:0040F559 ; ---------------------------------------------------------------------------
.text:0040F559
.text:0040F559 loc_40F559:			       ; CODE XREF: __Strftime_l+B6j
.text:0040F559		       mov     edx, [ebp+timeptr] ; timeptr
.text:0040F55C		       cmp     edx, ebx
.text:0040F55E		       jz      short loc_40F5C9
.text:0040F560		       inc     esi
.text:0040F561		       xor     eax, eax
.text:0040F563		       cmp     byte ptr	[esi], 23h
.text:0040F566		       jnz     short loc_40F56A
.text:0040F568		       inc     eax
.text:0040F569		       inc     esi
.text:0040F56A
.text:0040F56A loc_40F56A:			       ; CODE XREF: __Strftime_l+106j
.text:0040F56A		       push    eax	       ; alternate_form
.text:0040F56B		       push    [ebp+lc_time]   ; lc_time
.text:0040F56E		       lea     eax, [ebp+left]
.text:0040F571		       push    eax	       ; left
.text:0040F572		       lea     eax, [ebp+_loc_update]
.text:0040F575		       push    eax	       ; plocinfo
.text:0040F576		       mov     al, [esi]       ; specifier
.text:0040F578		       lea     ecx, [ebp+string] ; string
.text:0040F57B		       call    _expandtime
.text:0040F580		       add     esp, 10h
.text:0040F583		       test    eax, eax
.text:0040F585		       jz      short loc_40F5D6
.text:0040F587		       inc     esi
.text:0040F588
.text:0040F588 loc_40F588:			       ; CODE XREF: __Strftime_l+F7j
.text:0040F588		       cmp     [ebp+left], ebx
.text:0040F58B		       ja      short loc_40F50E
.text:0040F58D
.text:0040F58D loc_40F58D:			       ; CODE XREF: __Strftime_l+B2j
.text:0040F58D		       cmp     [ebp+left], ebx
.text:0040F590		       jbe     short loc_40F5AD
.text:0040F592		       mov     eax, [ebp+string]
.text:0040F595		       mov     [eax], bl
.text:0040F597		       sub     edi, [ebp+left]
.text:0040F59A		       cmp     [ebp+_loc_update.updated], bl
.text:0040F59D		       mov     eax, edi
.text:0040F59F		       jz      short loc_40F60A
.text:0040F5A1		       mov     ecx, [ebp+_loc_update.ptd]
.text:0040F5A4		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0040F5A8		       jmp     short loc_40F60A
.text:0040F5AA ; ---------------------------------------------------------------------------
.text:0040F5AA
.text:0040F5AA loc_40F5AA:			       ; CODE XREF: __Strftime_l+D8j
.text:0040F5AA		       mov     [ebp+failed], ecx
.text:0040F5AD
.text:0040F5AD loc_40F5AD:			       ; CODE XREF: __Strftime_l+A8j
.text:0040F5AD					       ; __Strftime_l+130j ...
.text:0040F5AD		       cmp     [ebp+failed], ebx
.text:0040F5B0		       mov     eax, [ebp+strstart]
.text:0040F5B3		       mov     [eax], bl
.text:0040F5B5		       jnz     short loc_40F5E4
.text:0040F5B7		       cmp     [ebp+left], ebx
.text:0040F5BA		       ja      short loc_40F5E4
.text:0040F5BC		       call    __errno
.text:0040F5C1		       mov     dword ptr [eax],	22h
.text:0040F5C7		       jmp     short loc_40F5FC
.text:0040F5C9 ; ---------------------------------------------------------------------------
.text:0040F5C9
.text:0040F5C9 loc_40F5C9:			       ; CODE XREF: __Strftime_l+FEj
.text:0040F5C9		       call    __errno
.text:0040F5CE		       mov     dword ptr [eax],	16h
.text:0040F5D4		       jmp     short loc_40F5FC
.text:0040F5D6 ; ---------------------------------------------------------------------------
.text:0040F5D6
.text:0040F5D6 loc_40F5D6:			       ; CODE XREF: __Strftime_l+125j
.text:0040F5D6		       cmp     [ebp+left], ebx
.text:0040F5D9		       jbe     short loc_40F5AD
.text:0040F5DB		       mov     [ebp+failed], 1
.text:0040F5E2
.text:0040F5E2 done:
.text:0040F5E2		       jmp     short loc_40F5AD
.text:0040F5E4 ; ---------------------------------------------------------------------------
.text:0040F5E4
.text:0040F5E4 loc_40F5E4:			       ; CODE XREF: __Strftime_l+8Aj
.text:0040F5E4					       ; __Strftime_l+155j ...
.text:0040F5E4		       call    __errno
.text:0040F5E9		       push    ebx	       ; pReserved
.text:0040F5EA		       push    ebx	       ; nLine
.text:0040F5EB		       push    ebx	       ; pszFile
.text:0040F5EC		       push    ebx	       ; pszFunction
.text:0040F5ED		       push    ebx	       ; pszExpression
.text:0040F5EE		       mov     dword ptr [eax],	16h
.text:0040F5F4		       call    __invalid_parameter
.text:0040F5F9		       add     esp, 14h
.text:0040F5FC
.text:0040F5FC loc_40F5FC:			       ; CODE XREF: __Strftime_l+167j
.text:0040F5FC					       ; __Strftime_l+174j
.text:0040F5FC		       cmp     [ebp+_loc_update.updated], bl
.text:0040F5FF		       jz      short loc_40F608
.text:0040F601		       mov     eax, [ebp+_loc_update.ptd]
.text:0040F604		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0040F608
.text:0040F608 loc_40F608:			       ; CODE XREF: __Strftime_l+19Fj
.text:0040F608		       xor     eax, eax
.text:0040F60A
.text:0040F60A loc_40F60A:			       ; CODE XREF: __Strftime_l+13Fj
.text:0040F60A					       ; __Strftime_l+148j
.text:0040F60A		       pop     esi
.text:0040F60B
.text:0040F60B loc_40F60B:			       ; CODE XREF: __Strftime_l+7Dj
.text:0040F60B		       pop     edi
.text:0040F60C
.text:0040F60C loc_40F60C:			       ; CODE XREF: __Strftime_l+4Aj
.text:0040F60C		       pop     ebx
.text:0040F60D		       leave
.text:0040F60E		       retn
.text:0040F60E __Strftime_l    endp
.text:0040F60E
.text:0040F60F
.text:0040F60F ; =============== S U B R O U T I N E =======================================
.text:0040F60F
.text:0040F60F ; Attributes: bp-based frame
.text:0040F60F
.text:0040F60F ; unsigned int __cdecl _strftime_l(char *string,	unsigned int maxsize, const char *format, tm *timeptr, localeinfo_struct *plocinfo)
.text:0040F60F __strftime_l    proc near
.text:0040F60F
.text:0040F60F string	       = dword ptr  8
.text:0040F60F maxsize	       = dword ptr  0Ch
.text:0040F60F format	       = dword ptr  10h
.text:0040F60F timeptr	       = dword ptr  14h
.text:0040F60F plocinfo	       = dword ptr  18h
.text:0040F60F
.text:0040F60F		       push    ebp
.text:0040F610		       mov     ebp, esp
.text:0040F612		       push    [ebp+plocinfo]  ; plocinfo
.text:0040F615		       push    0	       ; lc_time_arg
.text:0040F617		       push    [ebp+timeptr]   ; timeptr
.text:0040F61A		       push    [ebp+format]    ; format
.text:0040F61D		       push    [ebp+maxsize]   ; maxsize
.text:0040F620		       push    [ebp+string]    ; string
.text:0040F623		       call    __Strftime_l
.text:0040F628		       add     esp, 18h
.text:0040F62B		       pop     ebp
.text:0040F62C		       retn
.text:0040F62C __strftime_l    endp
.text:0040F62C
.text:0040F62D
.text:0040F62D ; =============== S U B R O U T I N E =======================================
.text:0040F62D
.text:0040F62D
.text:0040F62D ; unsigned int __cdecl strftime(char *string, unsigned int maxsize, const char *format, tm *timeptr)
.text:0040F62D _strftime       proc near
.text:0040F62D
.text:0040F62D string	       = dword ptr  4
.text:0040F62D maxsize	       = dword ptr  8
.text:0040F62D format	       = dword ptr  0Ch
.text:0040F62D timeptr	       = dword ptr  10h
.text:0040F62D
.text:0040F62D		       push    0	       ; plocinfo
.text:0040F62F		       push    0	       ; lc_time_arg
.text:0040F631		       push    [esp+8+timeptr] ; timeptr
.text:0040F635		       push    [esp+0Ch+format]	; format
.text:0040F639		       push    [esp+10h+maxsize] ; maxsize
.text:0040F63D		       push    [esp+14h+string]	; string
.text:0040F641		       call    __Strftime_l
.text:0040F646		       add     esp, 18h
.text:0040F649		       retn
.text:0040F649 _strftime       endp
.text:0040F649
.text:0040F64A
.text:0040F64A ; =============== S U B R O U T I N E =======================================
.text:0040F64A
.text:0040F64A ; Attributes: bp-based frame
.text:0040F64A
.text:0040F64A ; unsigned int __cdecl _Strftime(char *string, unsigned int maxsize, const char *format,	tm *timeptr, void *lc_time_arg)
.text:0040F64A __Strftime      proc near
.text:0040F64A
.text:0040F64A string	       = dword ptr  8
.text:0040F64A maxsize	       = dword ptr  0Ch
.text:0040F64A format	       = dword ptr  10h
.text:0040F64A timeptr	       = dword ptr  14h
.text:0040F64A lc_time_arg     = dword ptr  18h
.text:0040F64A
.text:0040F64A		       push    ebp
.text:0040F64B		       mov     ebp, esp
.text:0040F64D		       push    0	       ; plocinfo
.text:0040F64F		       push    [ebp+lc_time_arg] ; lc_time_arg
.text:0040F652		       push    [ebp+timeptr]   ; timeptr
.text:0040F655		       push    [ebp+format]    ; format
.text:0040F658		       push    [ebp+maxsize]   ; maxsize
.text:0040F65B		       push    [ebp+string]    ; string
.text:0040F65E		       call    __Strftime_l
.text:0040F663		       add     esp, 18h
.text:0040F666		       pop     ebp
.text:0040F667		       retn
.text:0040F667 __Strftime      endp
.text:0040F667
.text:0040F668
.text:0040F668 ; =============== S U B R O U T I N E =======================================
.text:0040F668
.text:0040F668
.text:0040F668 ; lconv *__cdecl	localeconv()
.text:0040F668 _localeconv     proc near
.text:0040F668		       call    __getptd
.text:0040F66D		       mov     ecx, [eax+6Ch]
.text:0040F670		       cmp     ecx, ___ptlocinfo ; ___ptlocinfo
.text:0040F676		       jz      short loc_40F688
.text:0040F678		       mov     ecx, ___globallocalestatus
.text:0040F67E		       test    [eax+70h], ecx
.text:0040F681		       jnz     short loc_40F688
.text:0040F683		       call    ___updatetlocinfo
.text:0040F688
.text:0040F688 loc_40F688:			       ; CODE XREF: _localeconv+Ej
.text:0040F688					       ; _localeconv+19j
.text:0040F688		       mov     eax, ___lconv
.text:0040F68D		       retn
.text:0040F68D _localeconv     endp
.text:0040F68D
.text:0040F68D ; ---------------------------------------------------------------------------
.text:0040F68E		       align 10h
.text:0040F690
.text:0040F690 ; =============== S U B R O U T I N E =======================================
.text:0040F690
.text:0040F690 ; Attributes: bp-based frame
.text:0040F690
.text:0040F690 ; void __cdecl strcspn(char *string, char *control)
.text:0040F690 _strcspn	       proc near	       ; CODE XREF: ___lc_strtolc+6Bp
.text:0040F690					       ; ___lc_strtolc+112p ...
.text:0040F690
.text:0040F690 var_24	       = dword ptr -24h
.text:0040F690 string	       = dword ptr  8
.text:0040F690 control	       = dword ptr  0Ch
.text:0040F690
.text:0040F690		       push    ebp
.text:0040F691		       mov     ebp, esp
.text:0040F693		       push    esi
.text:0040F694		       xor     eax, eax
.text:0040F696		       push    eax
.text:0040F697		       push    eax
.text:0040F698		       push    eax
.text:0040F699		       push    eax
.text:0040F69A		       push    eax
.text:0040F69B		       push    eax
.text:0040F69C		       push    eax
.text:0040F69D		       push    eax
.text:0040F69E		       mov     edx, [ebp+control]
.text:0040F6A1		       lea     ecx, [ecx+0]
.text:0040F6A4
.text:0040F6A4 listnext:			       ; CODE XREF: _strcspn+21j
.text:0040F6A4		       mov     al, [edx]
.text:0040F6A6		       or      al, al
.text:0040F6A8		       jz      short listdone
.text:0040F6AA		       add     edx, 1
.text:0040F6AD		       bts     [esp+24h+var_24], eax
.text:0040F6B1		       jmp     short listnext
.text:0040F6B3 ; ---------------------------------------------------------------------------
.text:0040F6B3
.text:0040F6B3 listdone:			       ; CODE XREF: _strcspn+18j
.text:0040F6B3		       mov     esi, [ebp+string]
.text:0040F6B6		       or      ecx, 0FFFFFFFFh
.text:0040F6B9		       lea     ecx, [ecx+0]
.text:0040F6BC
.text:0040F6BC dstnext:				       ; CODE XREF: _strcspn+3Cj
.text:0040F6BC		       add     ecx, 1
.text:0040F6BF		       mov     al, [esi]
.text:0040F6C1		       or      al, al
.text:0040F6C3		       jz      short dstdone
.text:0040F6C5		       add     esi, 1
.text:0040F6C8		       bt      [esp+24h+var_24], eax
.text:0040F6CC		       jnb     short dstnext
.text:0040F6CE
.text:0040F6CE dstdone:				       ; CODE XREF: _strcspn+33j
.text:0040F6CE		       mov     eax, ecx
.text:0040F6D0		       add     esp, 20h
.text:0040F6D3		       pop     esi
.text:0040F6D4		       leave
.text:0040F6D5		       retn
.text:0040F6D5 _strcspn	       endp
.text:0040F6D5
.text:0040F6D6
.text:0040F6D6 ; =============== S U B R O U T I N E =======================================
.text:0040F6D6
.text:0040F6D6 ; Attributes: bp-based frame
.text:0040F6D6
.text:0040F6D6 ; int __cdecl TranslateName(tagLOCALETAB	*lpTable, int high, const char **ppchName)
.text:0040F6D6 TranslateName   proc near	       ; CODE XREF: ___get_qualified_locale+41p
.text:0040F6D6					       ; ___get_qualified_locale+79p
.text:0040F6D6
.text:0040F6D6 lpTable	       = dword ptr  8
.text:0040F6D6 high	       = dword ptr  0Ch
.text:0040F6D6 ppchName	       = dword ptr  10h
.text:0040F6D6
.text:0040F6D6		       push    ebp
.text:0040F6D7		       mov     ebp, esp
.text:0040F6D9		       xor     eax, eax
.text:0040F6DB		       push    ebx
.text:0040F6DC		       xor     ebx, ebx
.text:0040F6DE		       inc     eax
.text:0040F6DF		       cmp     [ebp+high], ebx
.text:0040F6E2		       jl      short loc_40F72A
.text:0040F6E4		       push    esi
.text:0040F6E5		       push    edi
.text:0040F6E6
.text:0040F6E6 loc_40F6E6:			       ; CODE XREF: TranslateName+50j
.text:0040F6E6		       test    eax, eax
.text:0040F6E8		       jz      short loc_40F728
.text:0040F6EA		       mov     eax, [ebp+high]
.text:0040F6ED		       add     eax, ebx
.text:0040F6EF		       cdq
.text:0040F6F0		       sub     eax, edx
.text:0040F6F2		       mov     esi, eax
.text:0040F6F4		       mov     eax, [ebp+lpTable]
.text:0040F6F7		       sar     esi, 1
.text:0040F6F9		       lea     edi, [eax+esi*8]
.text:0040F6FC		       push    dword ptr [edi] ; src
.text:0040F6FE		       mov     eax, [ebp+ppchName]
.text:0040F701		       push    dword ptr [eax] ; dst
.text:0040F703		       call    __stricmp
.text:0040F708		       test    eax, eax
.text:0040F70A		       pop     ecx
.text:0040F70B		       pop     ecx
.text:0040F70C		       jnz     short loc_40F718
.text:0040F70E		       mov     ecx, [ebp+ppchName]
.text:0040F711		       add     edi, 4
.text:0040F714		       mov     [ecx], edi
.text:0040F716		       jmp     short loc_40F723
.text:0040F718 ; ---------------------------------------------------------------------------
.text:0040F718
.text:0040F718 loc_40F718:			       ; CODE XREF: TranslateName+36j
.text:0040F718		       jge     short loc_40F720
.text:0040F71A		       dec     esi
.text:0040F71B		       mov     [ebp+high], esi
.text:0040F71E		       jmp     short loc_40F723
.text:0040F720 ; ---------------------------------------------------------------------------
.text:0040F720
.text:0040F720 loc_40F720:			       ; CODE XREF: TranslateName:loc_40F718j
.text:0040F720		       lea     ebx, [esi+1]
.text:0040F723
.text:0040F723 loc_40F723:			       ; CODE XREF: TranslateName+40j
.text:0040F723					       ; TranslateName+48j
.text:0040F723		       cmp     ebx, [ebp+high]
.text:0040F726		       jle     short loc_40F6E6
.text:0040F728
.text:0040F728 loc_40F728:			       ; CODE XREF: TranslateName+12j
.text:0040F728		       pop     edi
.text:0040F729		       pop     esi
.text:0040F72A
.text:0040F72A loc_40F72A:			       ; CODE XREF: TranslateName+Cj
.text:0040F72A		       xor     ecx, ecx
.text:0040F72C		       test    eax, eax
.text:0040F72E		       setz    cl
.text:0040F731		       pop     ebx
.text:0040F732		       mov     eax, ecx
.text:0040F734		       pop     ebp
.text:0040F735		       retn
.text:0040F735 TranslateName   endp
.text:0040F735
.text:0040F736
.text:0040F736 ; =============== S U B R O U T I N E =======================================
.text:0040F736
.text:0040F736
.text:0040F736 ; void __usercall GetLcidFromDefault(setloc_struct *_psetloc_data<esi>)
.text:0040F736 GetLcidFromDefault proc near
.text:0040F736 _psetloc_data = esi
.text:0040F736		       or      dword ptr [_psetloc_data+8], 104h
.text:0040F73D		       call    ds:__imp__GetUserDefaultLCID@0 ;	GetUserDefaultLCID()
.text:0040F743		       mov     [_psetloc_data+1Ch], eax
.text:0040F746		       mov     [_psetloc_data+18h], eax
.text:0040F749		       retn
.text:0040F749 GetLcidFromDefault endp
.text:0040F749
.text:0040F74A
.text:0040F74A ; =============== S U B R O U T I N E =======================================
.text:0040F74A
.text:0040F74A ; Attributes: bp-based frame
.text:0040F74A
.text:0040F74A ; int __usercall	ProcessCodePage<eax>(char *lpCodePageStr<ecx>, setloc_struct *_psetloc_data<edi>)
.text:0040F74A ProcessCodePage proc near	       ; CODE XREF: ___get_qualified_locale+FDp
.text:0040F74A
.text:0040F74A chCodePage      = byte ptr -0Ch
.text:0040F74A var_4	       = dword ptr -4
.text:0040F74A
.text:0040F74A lpCodePageStr = ecx
.text:0040F74A _psetloc_data = edi
.text:0040F74A		       push    ebp
.text:0040F74B		       mov     ebp, esp
.text:0040F74D		       sub     esp, 0Ch
.text:0040F750		       mov     eax, ___security_cookie
.text:0040F755		       xor     eax, ebp
.text:0040F757		       mov     [ebp+var_4], eax
.text:0040F75A		       push    esi
.text:0040F75B		       mov     esi, lpCodePageStr
.text:0040F75D		       test    esi, esi
.text:0040F75F		       jz      short loc_40F792
.text:0040F761		       cmp     byte ptr	[esi], 0
.text:0040F764		       jz      short loc_40F792
.text:0040F766		       push    offset str2     ; "ACP"
.text:0040F76B		       push    esi	       ; str1
.text:0040F76C		       call    _strcmp
.text:0040F771		       test    eax, eax
.text:0040F773		       pop     lpCodePageStr
.text:0040F774		       pop     lpCodePageStr
.text:0040F775		       jz      short loc_40F792
.text:0040F777		       push    offset aOcp     ; "OCP"
.text:0040F77C		       push    esi	       ; str1
.text:0040F77D		       call    _strcmp
.text:0040F782		       test    eax, eax
.text:0040F784		       pop     lpCodePageStr
.text:0040F785		       pop     lpCodePageStr
.text:0040F786		       jnz     short loc_40F7AD
.text:0040F788		       push    8
.text:0040F78A		       lea     eax, [ebp+chCodePage]
.text:0040F78D		       push    eax
.text:0040F78E		       push    0Bh
.text:0040F790		       jmp     short loc_40F79D
.text:0040F792 ; ---------------------------------------------------------------------------
.text:0040F792
.text:0040F792 loc_40F792:			       ; CODE XREF: ProcessCodePage+15j
.text:0040F792					       ; ProcessCodePage+1Aj ...
.text:0040F792		       push    8	       ; cchData
.text:0040F794		       lea     eax, [ebp+chCodePage]
.text:0040F797		       push    eax	       ; lpLCData
.text:0040F798		       push    1004h	       ; LCType
.text:0040F79D
.text:0040F79D loc_40F79D:			       ; CODE XREF: ProcessCodePage+46j
.text:0040F79D		       push    dword ptr [_psetloc_data+1Ch] ; Locale
.text:0040F7A0		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040F7A6		       test    eax, eax
.text:0040F7A8		       jz      short loc_40F7B4
.text:0040F7AA		       lea     esi, [ebp+chCodePage]
.text:0040F7AD
.text:0040F7AD loc_40F7AD:			       ; CODE XREF: ProcessCodePage+3Cj
.text:0040F7AD		       push    esi	       ; nptr
.text:0040F7AE		       call    _atol
.text:0040F7B3		       pop     lpCodePageStr
.text:0040F7B4
.text:0040F7B4 loc_40F7B4:			       ; CODE XREF: ProcessCodePage+5Ej
.text:0040F7B4		       mov     lpCodePageStr, [ebp+var_4]
.text:0040F7B7		       xor     lpCodePageStr, ebp
.text:0040F7B9		       pop     esi
.text:0040F7BA		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F7BF		       leave
.text:0040F7C0		       retn
.text:0040F7C0 ProcessCodePage endp
.text:0040F7C0
.text:0040F7C1
.text:0040F7C1 ; =============== S U B R O U T I N E =======================================
.text:0040F7C1
.text:0040F7C1
.text:0040F7C1 ; int __cdecl TestDefaultCountry(unsigned int lcid)
.text:0040F7C1 TestDefaultCountry proc near	       ; CODE XREF: CountryEnumProc+67p
.text:0040F7C1					       ; LangCountryEnumProc+F1p
.text:0040F7C1
.text:0040F7C1 lcid	       = dword ptr  4
.text:0040F7C1
.text:0040F7C1		       xor     eax, eax
.text:0040F7C3
.text:0040F7C3 loc_40F7C3:			       ; CODE XREF: TestDefaultCountry+15j
.text:0040F7C3		       mov     cx, word	ptr [esp+lcid]
.text:0040F7C8		       cmp     cx, ds:___rglangidNotDefault[eax]
.text:0040F7CF		       jz      short loc_40F7DC
.text:0040F7D1		       inc     eax
.text:0040F7D2		       inc     eax
.text:0040F7D3		       cmp     eax, 14h
.text:0040F7D6		       jb      short loc_40F7C3
.text:0040F7D8		       xor     eax, eax
.text:0040F7DA		       inc     eax
.text:0040F7DB		       retn
.text:0040F7DC ; ---------------------------------------------------------------------------
.text:0040F7DC
.text:0040F7DC loc_40F7DC:			       ; CODE XREF: TestDefaultCountry+Ej
.text:0040F7DC		       xor     eax, eax
.text:0040F7DE		       retn
.text:0040F7DE TestDefaultCountry endp
.text:0040F7DE
.text:0040F7DF
.text:0040F7DF ; =============== S U B R O U T I N E =======================================
.text:0040F7DF
.text:0040F7DF
.text:0040F7DF ; unsigned int __usercall LcidFromHexString<eax>(char *lpHexString<edx>)
.text:0040F7DF LcidFromHexString proc near	       ; CODE XREF: CountryEnumProc+24p
.text:0040F7DF					       ; TestDefaultLanguage+3Ap ...
.text:0040F7DF lpHexString = edx
.text:0040F7DF		       push    esi
.text:0040F7E0		       xor     esi, esi
.text:0040F7E2		       jmp     short loc_40F807
.text:0040F7E4 ; ---------------------------------------------------------------------------
.text:0040F7E4
.text:0040F7E4 loc_40F7E4:			       ; CODE XREF: LcidFromHexString+2Cj
.text:0040F7E4		       mov     al, cl
.text:0040F7E6		       sub     al, 61h
.text:0040F7E8		       inc     lpHexString
.text:0040F7E9		       cmp     al, 5
.text:0040F7EB		       ja      short loc_40F7F2
.text:0040F7ED		       add     cl, 0D9h
.text:0040F7F0		       jmp     short loc_40F7FD
.text:0040F7F2 ; ---------------------------------------------------------------------------
.text:0040F7F2
.text:0040F7F2 loc_40F7F2:			       ; CODE XREF: LcidFromHexString+Cj
.text:0040F7F2		       mov     al, cl
.text:0040F7F4		       sub     al, 41h
.text:0040F7F6		       cmp     al, 5
.text:0040F7F8		       ja      short loc_40F7FD
.text:0040F7FA		       add     cl, 0F9h
.text:0040F7FD
.text:0040F7FD loc_40F7FD:			       ; CODE XREF: LcidFromHexString+11j
.text:0040F7FD					       ; LcidFromHexString+19j
.text:0040F7FD		       movsx   eax, cl
.text:0040F800		       shl     esi, 4
.text:0040F803		       lea     esi, [esi+eax-30h]
.text:0040F807
.text:0040F807 loc_40F807:			       ; CODE XREF: LcidFromHexString+3j
.text:0040F807		       mov     cl, [lpHexString]
.text:0040F809		       test    cl, cl
.text:0040F80B		       jnz     short loc_40F7E4
.text:0040F80D		       mov     eax, esi
.text:0040F80F		       pop     esi
.text:0040F810		       retn
.text:0040F810 LcidFromHexString endp
.text:0040F810
.text:0040F811
.text:0040F811 ; =============== S U B R O U T I N E =======================================
.text:0040F811
.text:0040F811
.text:0040F811 ; int __usercall	GetPrimaryLen<eax>(char	*pchLanguage<edx>)
.text:0040F811 GetPrimaryLen   proc near	       ; CODE XREF: TestDefaultLanguage+4Fp
.text:0040F811					       ; GetLcidFromLangCountry+38p ...
.text:0040F811 pchLanguage = edx
.text:0040F811		       xor     eax, eax
.text:0040F813
.text:0040F813 loc_40F813:			       ; CODE XREF: GetPrimaryLen+18j
.text:0040F813		       mov     cl, [pchLanguage]
.text:0040F815		       inc     pchLanguage
.text:0040F816		       cmp     cl, 41h
.text:0040F819		       jl      short loc_40F820
.text:0040F81B		       cmp     cl, 5Ah
.text:0040F81E		       jle     short loc_40F828
.text:0040F820
.text:0040F820 loc_40F820:			       ; CODE XREF: GetPrimaryLen+8j
.text:0040F820		       sub     cl, 61h
.text:0040F823		       cmp     cl, 19h
.text:0040F826		       ja      short locret_40F82B
.text:0040F828
.text:0040F828 loc_40F828:			       ; CODE XREF: GetPrimaryLen+Dj
.text:0040F828		       inc     eax
.text:0040F829		       jmp     short loc_40F813
.text:0040F82B ; ---------------------------------------------------------------------------
.text:0040F82B
.text:0040F82B locret_40F82B:			       ; CODE XREF: GetPrimaryLen+15j
.text:0040F82B		       retn
.text:0040F82B GetPrimaryLen   endp
.text:0040F82B
.text:0040F82C
.text:0040F82C ; =============== S U B R O U T I N E =======================================
.text:0040F82C
.text:0040F82C ; Attributes: bp-based frame
.text:0040F82C
.text:0040F82C ; int __stdcall CountryEnumProc(char *lpLcidString)
.text:0040F82C CountryEnumProc proc near	       ; DATA XREF: GetLcidFromCountry+13o
.text:0040F82C					       ; ___get_qualified_locale+B8o
.text:0040F82C
.text:0040F82C rgcInfo	       = byte ptr -7Ch
.text:0040F82C var_4	       = dword ptr -4
.text:0040F82C lpLcidString    = dword ptr  8
.text:0040F82C
.text:0040F82C		       push    ebp
.text:0040F82D		       mov     ebp, esp
.text:0040F82F		       sub     esp, 7Ch
.text:0040F832		       mov     eax, ___security_cookie
.text:0040F837		       xor     eax, ebp
.text:0040F839		       mov     [ebp+var_4], eax
.text:0040F83C		       push    esi
.text:0040F83D		       push    edi
.text:0040F83E		       mov     edi, [ebp+lpLcidString]
.text:0040F841		       call    __getptd
.text:0040F846		       mov     esi, eax
.text:0040F848		       mov     edx, edi	       ; lpHexString
.text:0040F84A		       add     esi, 9Ch
.text:0040F850		       call    LcidFromHexString
.text:0040F855		       mov     edi, eax
.text:0040F857		       push    78h	       ; cchData
.text:0040F859		       lea     eax, [ebp+rgcInfo]
.text:0040F85C		       push    eax	       ; lpLCData
.text:0040F85D		       mov     eax, [esi+14h]
.text:0040F860		       neg     eax
.text:0040F862		       sbb     eax, eax
.text:0040F864		       and     eax, 0FFFFF005h
.text:0040F869		       add     eax, 1002h
.text:0040F86E		       push    eax	       ; LCType
.text:0040F86F		       push    edi	       ; Locale
.text:0040F870		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040F876		       test    eax, eax
.text:0040F878		       jnz     short loc_40F880
.text:0040F87A		       and     [esi+8],	eax
.text:0040F87D		       inc     eax
.text:0040F87E		       jmp     short loc_40F8B2
.text:0040F880 ; ---------------------------------------------------------------------------
.text:0040F880
.text:0040F880 loc_40F880:			       ; CODE XREF: CountryEnumProc+4Cj
.text:0040F880		       lea     eax, [ebp+rgcInfo]
.text:0040F883		       push    eax	       ; src
.text:0040F884		       push    dword ptr [esi+4] ; dst
.text:0040F887		       call    __stricmp
.text:0040F88C		       test    eax, eax
.text:0040F88E		       pop     ecx
.text:0040F88F		       pop     ecx
.text:0040F890		       jnz     short loc_40F8A7
.text:0040F892		       push    edi	       ; lcid
.text:0040F893		       call    TestDefaultCountry
.text:0040F898		       test    eax, eax
.text:0040F89A		       pop     ecx
.text:0040F89B		       jz      short loc_40F8A7
.text:0040F89D		       or      dword ptr [esi+8], 4
.text:0040F8A1		       mov     [esi+1Ch], edi
.text:0040F8A4		       mov     [esi+18h], edi
.text:0040F8A7
.text:0040F8A7 loc_40F8A7:			       ; CODE XREF: CountryEnumProc+64j
.text:0040F8A7					       ; CountryEnumProc+6Fj
.text:0040F8A7		       mov     eax, [esi+8]
.text:0040F8AA		       shr     eax, 2
.text:0040F8AD		       not     eax
.text:0040F8AF		       and     eax, 1
.text:0040F8B2
.text:0040F8B2 loc_40F8B2:			       ; CODE XREF: CountryEnumProc+52j
.text:0040F8B2		       mov     ecx, [ebp+var_4]
.text:0040F8B5		       pop     edi
.text:0040F8B6		       xor     ecx, ebp
.text:0040F8B8		       pop     esi
.text:0040F8B9		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F8BE		       leave
.text:0040F8BF		       retn    4
.text:0040F8BF CountryEnumProc endp
.text:0040F8BF
.text:0040F8C2
.text:0040F8C2 ; =============== S U B R O U T I N E =======================================
.text:0040F8C2
.text:0040F8C2 ; Attributes: bp-based frame
.text:0040F8C2
.text:0040F8C2 ; int __usercall	TestDefaultLanguage<eax>(unsigned int lcid, int	bTestPrimary, setloc_struct *_psetloc_data<ecx>)
.text:0040F8C2 TestDefaultLanguage proc	near	       ; CODE XREF: LangCountryEnumProc+19Ap
.text:0040F8C2					       ; LanguageEnumProc+8Fp
.text:0040F8C2
.text:0040F8C2 rgcInfo	       = byte ptr -7Ch
.text:0040F8C2 var_4	       = dword ptr -4
.text:0040F8C2 lcid	       = dword ptr  8
.text:0040F8C2 bTestPrimary    = dword ptr  0Ch
.text:0040F8C2
.text:0040F8C2 _psetloc_data = ecx
.text:0040F8C2		       push    ebp
.text:0040F8C3		       mov     ebp, esp
.text:0040F8C5		       sub     esp, 7Ch
.text:0040F8C8		       mov     eax, ___security_cookie
.text:0040F8CD		       xor     eax, ebp
.text:0040F8CF		       mov     [ebp+var_4], eax
.text:0040F8D2		       push    esi
.text:0040F8D3		       push    78h	       ; cchData
.text:0040F8D5		       lea     eax, [ebp+rgcInfo]
.text:0040F8D8		       push    eax	       ; lpLCData
.text:0040F8D9		       mov     eax, [ebp+lcid]
.text:0040F8DC		       and     eax, 3FFh
.text:0040F8E1		       push    1	       ; LCType
.text:0040F8E3		       or      eax, 400h
.text:0040F8E8		       push    eax	       ; Locale
.text:0040F8E9		       mov     esi, _psetloc_data
.text:0040F8EB		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040F8F1		       test    eax, eax
.text:0040F8F3		       jnz     short loc_40F8F9
.text:0040F8F5
.text:0040F8F5 loc_40F8F5:			       ; CODE XREF: TestDefaultLanguage+60j
.text:0040F8F5		       xor     eax, eax
.text:0040F8F7		       jmp     short loc_40F927
.text:0040F8F9 ; ---------------------------------------------------------------------------
.text:0040F8F9
.text:0040F8F9 loc_40F8F9:			       ; CODE XREF: TestDefaultLanguage+31j
.text:0040F8F9		       lea     edx, [ebp+rgcInfo] ; lpHexString
.text:0040F8FC		       call    LcidFromHexString
.text:0040F901		       cmp     [ebp+lcid], eax
.text:0040F904		       jz      short loc_40F924
.text:0040F906		       cmp     [ebp+bTestPrimary], 0
.text:0040F90A		       jz      short loc_40F924
.text:0040F90C		       mov     esi, [esi]
.text:0040F90E		       push    edi
.text:0040F90F		       mov     edx, esi	       ; pchLanguage
.text:0040F911		       call    GetPrimaryLen
.text:0040F916		       push    esi	       ; buf
.text:0040F917		       mov     edi, eax
.text:0040F919		       call    _strlen
.text:0040F91E		       pop     _psetloc_data
.text:0040F91F		       cmp     edi, eax
.text:0040F921		       pop     edi
.text:0040F922		       jz      short loc_40F8F5
.text:0040F924
.text:0040F924 loc_40F924:			       ; CODE XREF: TestDefaultLanguage+42j
.text:0040F924					       ; TestDefaultLanguage+48j
.text:0040F924		       xor     eax, eax
.text:0040F926		       inc     eax
.text:0040F927
.text:0040F927 loc_40F927:			       ; CODE XREF: TestDefaultLanguage+35j
.text:0040F927		       mov     _psetloc_data, [ebp+var_4]
.text:0040F92A		       xor     _psetloc_data, ebp
.text:0040F92C		       pop     esi
.text:0040F92D		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040F932		       leave
.text:0040F933		       retn
.text:0040F933 TestDefaultLanguage endp
.text:0040F933
.text:0040F934
.text:0040F934 ; =============== S U B R O U T I N E =======================================
.text:0040F934
.text:0040F934 ; Attributes: bp-based frame
.text:0040F934
.text:0040F934 ; int __stdcall LangCountryEnumProc(char	*lpLcidString)
.text:0040F934 LangCountryEnumProc proc	near	       ; DATA XREF: GetLcidFromLangCountry+3Fo
.text:0040F934
.text:0040F934 rgcInfo	       = byte ptr -7Ch
.text:0040F934 var_4	       = dword ptr -4
.text:0040F934 lpLcidString    = dword ptr  8
.text:0040F934
.text:0040F934		       push    ebp
.text:0040F935		       mov     ebp, esp
.text:0040F937		       sub     esp, 7Ch
.text:0040F93A		       mov     eax, ___security_cookie
.text:0040F93F		       xor     eax, ebp
.text:0040F941		       mov     [ebp+var_4], eax
.text:0040F944		       push    ebx
.text:0040F945		       push    esi
.text:0040F946		       push    edi
.text:0040F947		       mov     edi, [ebp+lpLcidString]
.text:0040F94A		       call    __getptd
.text:0040F94F		       mov     esi, eax
.text:0040F951		       mov     edx, edi	       ; lpHexString
.text:0040F953		       add     esi, 9Ch
.text:0040F959		       call    LcidFromHexString
.text:0040F95E		       mov     ebx, ds:__imp__GetLocaleInfoA@16	; GetLocaleInfoA(x,x,x,x)
.text:0040F964		       mov     edi, eax
.text:0040F966		       push    78h	       ; cchData
.text:0040F968		       lea     eax, [ebp+rgcInfo]
.text:0040F96B		       push    eax	       ; lpLCData
.text:0040F96C		       mov     eax, [esi+14h]
.text:0040F96F		       neg     eax
.text:0040F971		       sbb     eax, eax
.text:0040F973		       and     eax, 0FFFFF005h
.text:0040F978		       add     eax, 1002h
.text:0040F97D		       push    eax	       ; LCType
.text:0040F97E		       push    edi	       ; Locale
.text:0040F97F		       call    ebx ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040F981		       test    eax, eax
.text:0040F983		       jnz     short loc_40F991
.text:0040F985
.text:0040F985 loc_40F985:			       ; CODE XREF: LangCountryEnumProc+90j
.text:0040F985					       ; LangCountryEnumProc+133j
.text:0040F985		       and     dword ptr [esi+8], 0
.text:0040F989		       xor     eax, eax
.text:0040F98B		       inc     eax
.text:0040F98C		       jmp     loc_40FAF3
.text:0040F991 ; ---------------------------------------------------------------------------
.text:0040F991
.text:0040F991 loc_40F991:			       ; CODE XREF: LangCountryEnumProc+4Fj
.text:0040F991		       lea     eax, [ebp+rgcInfo]
.text:0040F994		       push    eax	       ; src
.text:0040F995		       push    dword ptr [esi+4] ; dst
.text:0040F998		       call    __stricmp
.text:0040F99D		       test    eax, eax
.text:0040F99F		       pop     ecx
.text:0040F9A0		       pop     ecx
.text:0040F9A1		       jnz     loc_40FA38
.text:0040F9A7		       push    78h	       ; cchData
.text:0040F9A9		       lea     eax, [ebp+rgcInfo]
.text:0040F9AC		       push    eax	       ; lpLCData
.text:0040F9AD		       mov     eax, [esi+10h]
.text:0040F9B0		       neg     eax
.text:0040F9B2		       sbb     eax, eax
.text:0040F9B4		       and     eax, 0FFFFF002h
.text:0040F9B9		       add     eax, 1001h
.text:0040F9BE		       push    eax	       ; LCType
.text:0040F9BF		       push    edi	       ; Locale
.text:0040F9C0		       call    ebx ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040F9C2		       test    eax, eax
.text:0040F9C4		       jz      short loc_40F985
.text:0040F9C6		       lea     eax, [ebp+rgcInfo]
.text:0040F9C9		       push    eax	       ; src
.text:0040F9CA		       push    dword ptr [esi] ; dst
.text:0040F9CC		       call    __stricmp
.text:0040F9D1		       test    eax, eax
.text:0040F9D3		       pop     ecx
.text:0040F9D4		       pop     ecx
.text:0040F9D5		       jnz     short loc_40F9E3
.text:0040F9D7		       or      dword ptr [esi+8], 304h
.text:0040F9DE		       mov     [esi+18h], edi
.text:0040F9E1		       jmp     short loc_40FA35
.text:0040F9E3 ; ---------------------------------------------------------------------------
.text:0040F9E3
.text:0040F9E3 loc_40F9E3:			       ; CODE XREF: LangCountryEnumProc+A1j
.text:0040F9E3		       test    byte ptr	[esi+8], 2
.text:0040F9E7		       jnz     short loc_40FA38
.text:0040F9E9		       mov     eax, [esi+0Ch]
.text:0040F9EC		       test    eax, eax
.text:0040F9EE		       jz      short loc_40FA1C
.text:0040F9F0		       push    eax	       ; count
.text:0040F9F1		       lea     eax, [ebp+rgcInfo]
.text:0040F9F4		       push    eax	       ; src
.text:0040F9F5		       push    dword ptr [esi] ; dst
.text:0040F9F7		       call    __strnicmp
.text:0040F9FC		       add     esp, 0Ch
.text:0040F9FF		       test    eax, eax
.text:0040FA01		       jnz     short loc_40FA1C
.text:0040FA03		       push    dword ptr [esi] ; buf
.text:0040FA05		       or      dword ptr [esi+8], 2
.text:0040FA09		       mov     [esi+1Ch], edi
.text:0040FA0C		       call    _strlen
.text:0040FA11		       cmp     eax, [esi+0Ch]
.text:0040FA14		       pop     ecx
.text:0040FA15		       jnz     short loc_40FA38
.text:0040FA17		       mov     [esi+18h], edi
.text:0040FA1A		       jmp     short loc_40FA38
.text:0040FA1C ; ---------------------------------------------------------------------------
.text:0040FA1C
.text:0040FA1C loc_40FA1C:			       ; CODE XREF: LangCountryEnumProc+BAj
.text:0040FA1C					       ; LangCountryEnumProc+CDj
.text:0040FA1C		       mov     edx, [esi+8]
.text:0040FA1F		       test    dl, 1
.text:0040FA22		       jnz     short loc_40FA38
.text:0040FA24		       push    edi	       ; lcid
.text:0040FA25		       call    TestDefaultCountry
.text:0040FA2A		       test    eax, eax
.text:0040FA2C		       pop     ecx
.text:0040FA2D		       jz      short loc_40FA38
.text:0040FA2F		       or      edx, 1
.text:0040FA32		       mov     [esi+8],	edx
.text:0040FA35
.text:0040FA35 loc_40FA35:			       ; CODE XREF: LangCountryEnumProc+ADj
.text:0040FA35		       mov     [esi+1Ch], edi
.text:0040FA38
.text:0040FA38 loc_40FA38:			       ; CODE XREF: LangCountryEnumProc+6Dj
.text:0040FA38					       ; LangCountryEnumProc+B3j ...
.text:0040FA38		       mov     ecx, [esi+8]
.text:0040FA3B		       mov     eax, 300h
.text:0040FA40		       and     ecx, eax
.text:0040FA42		       cmp     ecx, eax
.text:0040FA44		       jz      loc_40FAE8
.text:0040FA4A		       push    78h	       ; cchData
.text:0040FA4C		       lea     eax, [ebp+rgcInfo]
.text:0040FA4F		       push    eax	       ; lpLCData
.text:0040FA50		       mov     eax, [esi+10h]
.text:0040FA53		       neg     eax
.text:0040FA55		       sbb     eax, eax
.text:0040FA57		       and     eax, 0FFFFF002h
.text:0040FA5C		       add     eax, 1001h
.text:0040FA61		       push    eax	       ; LCType
.text:0040FA62		       push    edi	       ; Locale
.text:0040FA63		       call    ebx ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040FA65		       test    eax, eax
.text:0040FA67		       jz      loc_40F985
.text:0040FA6D		       lea     eax, [ebp+rgcInfo]
.text:0040FA70		       push    eax	       ; src
.text:0040FA71		       push    dword ptr [esi] ; dst
.text:0040FA73		       call    __stricmp
.text:0040FA78		       pop     ecx
.text:0040FA79		       xor     ebx, ebx
.text:0040FA7B		       test    eax, eax
.text:0040FA7D		       pop     ecx
.text:0040FA7E		       jnz     short loc_40FAAF
.text:0040FA80		       or      dword ptr [esi+8], 200h
.text:0040FA87		       cmp     [esi+10h], ebx
.text:0040FA8A		       mov     eax, [esi+8]
.text:0040FA8D		       jz      short loc_40FA99
.text:0040FA8F		       or      eax, 100h
.text:0040FA94		       mov     [esi+8],	eax
.text:0040FA97		       jmp     short loc_40FAE0
.text:0040FA99 ; ---------------------------------------------------------------------------
.text:0040FA99
.text:0040FA99 loc_40FA99:			       ; CODE XREF: LangCountryEnumProc+159j
.text:0040FA99		       cmp     [esi+0Ch], ebx
.text:0040FA9C		       jz      short loc_40FAD9
.text:0040FA9E		       push    dword ptr [esi] ; buf
.text:0040FAA0		       call    _strlen
.text:0040FAA5		       cmp     eax, [esi+0Ch]
.text:0040FAA8		       pop     ecx
.text:0040FAA9		       jnz     short loc_40FAD9
.text:0040FAAB		       push    1
.text:0040FAAD		       jmp     short loc_40FACB
.text:0040FAAF ; ---------------------------------------------------------------------------
.text:0040FAAF
.text:0040FAAF loc_40FAAF:			       ; CODE XREF: LangCountryEnumProc+14Aj
.text:0040FAAF		       cmp     [esi+10h], ebx
.text:0040FAB2		       jnz     short loc_40FAE8
.text:0040FAB4		       cmp     [esi+0Ch], ebx
.text:0040FAB7		       jz      short loc_40FAE8
.text:0040FAB9		       lea     eax, [ebp+rgcInfo]
.text:0040FABC		       push    eax	       ; src
.text:0040FABD		       push    dword ptr [esi] ; dst
.text:0040FABF		       call    __stricmp
.text:0040FAC4		       test    eax, eax
.text:0040FAC6		       pop     ecx
.text:0040FAC7		       pop     ecx
.text:0040FAC8		       jnz     short loc_40FAE8
.text:0040FACA		       push    ebx	       ; bTestPrimary
.text:0040FACB
.text:0040FACB loc_40FACB:			       ; CODE XREF: LangCountryEnumProc+179j
.text:0040FACB		       push    edi	       ; lcid
.text:0040FACC		       mov     ecx, esi	       ; _psetloc_data
.text:0040FACE		       call    TestDefaultLanguage
.text:0040FAD3		       test    eax, eax
.text:0040FAD5		       pop     ecx
.text:0040FAD6		       pop     ecx
.text:0040FAD7		       jz      short loc_40FAE8
.text:0040FAD9
.text:0040FAD9 loc_40FAD9:			       ; CODE XREF: LangCountryEnumProc+168j
.text:0040FAD9					       ; LangCountryEnumProc+175j
.text:0040FAD9		       or      dword ptr [esi+8], 100h
.text:0040FAE0
.text:0040FAE0 loc_40FAE0:			       ; CODE XREF: LangCountryEnumProc+163j
.text:0040FAE0		       cmp     [esi+18h], ebx
.text:0040FAE3		       jnz     short loc_40FAE8
.text:0040FAE5		       mov     [esi+18h], edi
.text:0040FAE8
.text:0040FAE8 loc_40FAE8:			       ; CODE XREF: LangCountryEnumProc+110j
.text:0040FAE8					       ; LangCountryEnumProc+17Ej ...
.text:0040FAE8		       mov     eax, [esi+8]
.text:0040FAEB		       shr     eax, 2
.text:0040FAEE		       not     eax
.text:0040FAF0		       and     eax, 1
.text:0040FAF3
.text:0040FAF3 loc_40FAF3:			       ; CODE XREF: LangCountryEnumProc+58j
.text:0040FAF3		       mov     ecx, [ebp+var_4]
.text:0040FAF6		       pop     edi
.text:0040FAF7		       pop     esi
.text:0040FAF8		       xor     ecx, ebp
.text:0040FAFA		       pop     ebx
.text:0040FAFB		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040FB00		       leave
.text:0040FB01		       retn    4
.text:0040FB01 LangCountryEnumProc endp
.text:0040FB01
.text:0040FB04
.text:0040FB04 ; =============== S U B R O U T I N E =======================================
.text:0040FB04
.text:0040FB04 ; Attributes: bp-based frame
.text:0040FB04
.text:0040FB04 ; int __stdcall LanguageEnumProc(char *lpLcidString)
.text:0040FB04 LanguageEnumProc	proc near	       ; DATA XREF: GetLcidFromLanguage+23o
.text:0040FB04
.text:0040FB04 rgcInfo	       = byte ptr -7Ch
.text:0040FB04 var_4	       = dword ptr -4
.text:0040FB04 lpLcidString    = dword ptr  8
.text:0040FB04
.text:0040FB04		       push    ebp
.text:0040FB05		       mov     ebp, esp
.text:0040FB07		       sub     esp, 7Ch
.text:0040FB0A		       mov     eax, ___security_cookie
.text:0040FB0F		       xor     eax, ebp
.text:0040FB11		       mov     [ebp+var_4], eax
.text:0040FB14		       push    esi
.text:0040FB15		       push    edi
.text:0040FB16		       mov     edi, [ebp+lpLcidString]
.text:0040FB19		       call    __getptd
.text:0040FB1E		       mov     esi, eax
.text:0040FB20		       mov     edx, edi	       ; lpHexString
.text:0040FB22		       add     esi, 9Ch
.text:0040FB28		       call    LcidFromHexString
.text:0040FB2D		       mov     edi, eax
.text:0040FB2F		       push    78h	       ; cchData
.text:0040FB31		       lea     eax, [ebp+rgcInfo]
.text:0040FB34		       push    eax	       ; lpLCData
.text:0040FB35		       mov     eax, [esi+10h]
.text:0040FB38		       neg     eax
.text:0040FB3A		       sbb     eax, eax
.text:0040FB3C		       and     eax, 0FFFFF002h
.text:0040FB41		       add     eax, 1001h
.text:0040FB46		       push    eax	       ; LCType
.text:0040FB47		       push    edi	       ; Locale
.text:0040FB48		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:0040FB4E		       test    eax, eax
.text:0040FB50		       jnz     short loc_40FB58
.text:0040FB52		       and     [esi+8],	eax
.text:0040FB55		       inc     eax
.text:0040FB56		       jmp     short loc_40FBB3
.text:0040FB58 ; ---------------------------------------------------------------------------
.text:0040FB58
.text:0040FB58 loc_40FB58:			       ; CODE XREF: LanguageEnumProc+4Cj
.text:0040FB58		       lea     eax, [ebp+rgcInfo]
.text:0040FB5B		       push    eax	       ; src
.text:0040FB5C		       push    dword ptr [esi] ; dst
.text:0040FB5E		       call    __stricmp
.text:0040FB63		       test    eax, eax
.text:0040FB65		       pop     ecx
.text:0040FB66		       pop     ecx
.text:0040FB67		       jnz     short loc_40FB72
.text:0040FB69		       cmp     [esi+10h], eax
.text:0040FB6C		       jnz     short loc_40FB9E
.text:0040FB6E		       push    1
.text:0040FB70		       jmp     short loc_40FB90
.text:0040FB72 ; ---------------------------------------------------------------------------
.text:0040FB72
.text:0040FB72 loc_40FB72:			       ; CODE XREF: LanguageEnumProc+63j
.text:0040FB72		       cmp     dword ptr [esi+10h], 0
.text:0040FB76		       jnz     short loc_40FBA8
.text:0040FB78		       cmp     dword ptr [esi+0Ch], 0
.text:0040FB7C		       jz      short loc_40FBA8
.text:0040FB7E		       lea     eax, [ebp+rgcInfo]
.text:0040FB81		       push    eax	       ; src
.text:0040FB82		       push    dword ptr [esi] ; dst
.text:0040FB84		       call    __stricmp
.text:0040FB89		       test    eax, eax
.text:0040FB8B		       pop     ecx
.text:0040FB8C		       pop     ecx
.text:0040FB8D		       jnz     short loc_40FBA8
.text:0040FB8F		       push    eax	       ; bTestPrimary
.text:0040FB90
.text:0040FB90 loc_40FB90:			       ; CODE XREF: LanguageEnumProc+6Cj
.text:0040FB90		       push    edi	       ; lcid
.text:0040FB91		       mov     ecx, esi	       ; _psetloc_data
.text:0040FB93		       call    TestDefaultLanguage
.text:0040FB98		       test    eax, eax
.text:0040FB9A		       pop     ecx
.text:0040FB9B		       pop     ecx
.text:0040FB9C		       jz      short loc_40FBA8
.text:0040FB9E
.text:0040FB9E loc_40FB9E:			       ; CODE XREF: LanguageEnumProc+68j
.text:0040FB9E		       or      dword ptr [esi+8], 4
.text:0040FBA2		       mov     [esi+18h], edi
.text:0040FBA5		       mov     [esi+1Ch], edi
.text:0040FBA8
.text:0040FBA8 loc_40FBA8:			       ; CODE XREF: LanguageEnumProc+72j
.text:0040FBA8					       ; LanguageEnumProc+78j ...
.text:0040FBA8		       mov     eax, [esi+8]
.text:0040FBAB		       shr     eax, 2
.text:0040FBAE		       not     eax
.text:0040FBB0		       and     eax, 1
.text:0040FBB3
.text:0040FBB3 loc_40FBB3:			       ; CODE XREF: LanguageEnumProc+52j
.text:0040FBB3		       mov     ecx, [ebp+var_4]
.text:0040FBB6		       pop     edi
.text:0040FBB7		       xor     ecx, ebp
.text:0040FBB9		       pop     esi
.text:0040FBBA		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0040FBBF		       leave
.text:0040FBC0		       retn    4
.text:0040FBC0 LanguageEnumProc	endp
.text:0040FBC0
.text:0040FBC3
.text:0040FBC3 ; =============== S U B R O U T I N E =======================================
.text:0040FBC3
.text:0040FBC3
.text:0040FBC3 ; void __usercall GetLcidFromCountry(setloc_struct *_psetloc_data<esi>)
.text:0040FBC3 GetLcidFromCountry proc near
.text:0040FBC3 _psetloc_data = esi
.text:0040FBC3		       push    dword ptr [_psetloc_data+4] ; buf
.text:0040FBC6		       call    _strlen
.text:0040FBCB		       sub     eax, 3
.text:0040FBCE		       neg     eax
.text:0040FBD0		       pop     ecx
.text:0040FBD1		       sbb     eax, eax
.text:0040FBD3		       push    1	       ; dwFlags
.text:0040FBD5		       inc     eax
.text:0040FBD6		       push    offset CountryEnumProc ;	lpLocaleEnumProc
.text:0040FBDB		       mov     [_psetloc_data+14h], eax
.text:0040FBDE		       call    ds:__imp__EnumSystemLocalesA@8 ;	EnumSystemLocalesA(x,x)
.text:0040FBE4		       test    byte ptr	[_psetloc_data+8], 4
.text:0040FBE8		       jnz     short locret_40FBEE
.text:0040FBEA		       and     dword ptr [_psetloc_data+8], 0
.text:0040FBEE
.text:0040FBEE locret_40FBEE:			       ; CODE XREF: GetLcidFromCountry+25j
.text:0040FBEE		       retn
.text:0040FBEE GetLcidFromCountry endp
.text:0040FBEE
.text:0040FBEF
.text:0040FBEF ; =============== S U B R O U T I N E =======================================
.text:0040FBEF
.text:0040FBEF
.text:0040FBEF ; void __usercall GetLcidFromLangCountry(setloc_struct *_psetloc_data<esi>)
.text:0040FBEF GetLcidFromLangCountry proc near	       ; CODE XREF: ___get_qualified_locale+60p
.text:0040FBEF					       ; ___get_qualified_locale+8Fp
.text:0040FBEF _psetloc_data = esi
.text:0040FBEF		       push    dword ptr [_psetloc_data] ; buf
.text:0040FBF1		       call    _strlen
.text:0040FBF6		       push    dword ptr [_psetloc_data+4] ; buf
.text:0040FBF9		       sub     eax, 3
.text:0040FBFC		       neg     eax
.text:0040FBFE		       sbb     eax, eax
.text:0040FC00		       inc     eax
.text:0040FC01		       mov     [_psetloc_data+10h], eax
.text:0040FC04		       call    _strlen
.text:0040FC09		       sub     eax, 3
.text:0040FC0C		       neg     eax
.text:0040FC0E		       sbb     eax, eax
.text:0040FC10		       and     dword ptr [_psetloc_data+18h], 0
.text:0040FC14		       inc     eax
.text:0040FC15		       cmp     dword ptr [_psetloc_data+10h], 0
.text:0040FC19		       pop     ecx
.text:0040FC1A		       pop     ecx
.text:0040FC1B		       mov     [_psetloc_data+14h], eax
.text:0040FC1E		       jz      short loc_40FC25
.text:0040FC20		       push    2
.text:0040FC22		       pop     eax
.text:0040FC23		       jmp     short loc_40FC2C
.text:0040FC25 ; ---------------------------------------------------------------------------
.text:0040FC25
.text:0040FC25 loc_40FC25:			       ; CODE XREF: GetLcidFromLangCountry+2Fj
.text:0040FC25		       mov     edx, [_psetloc_data] ; pchLanguage
.text:0040FC27		       call    GetPrimaryLen
.text:0040FC2C
.text:0040FC2C loc_40FC2C:			       ; CODE XREF: GetLcidFromLangCountry+34j
.text:0040FC2C		       push    1	       ; dwFlags
.text:0040FC2E		       push    offset LangCountryEnumProc ; lpLocaleEnumProc
.text:0040FC33		       mov     [_psetloc_data+0Ch], eax
.text:0040FC36		       call    ds:__imp__EnumSystemLocalesA@8 ;	EnumSystemLocalesA(x,x)
.text:0040FC3C		       mov     eax, [_psetloc_data+8]
.text:0040FC3F		       test    ax, 100h
.text:0040FC43		       jz      short loc_40FC4F
.text:0040FC45		       test    ax, 200h
.text:0040FC49		       jz      short loc_40FC4F
.text:0040FC4B		       test    al, 7
.text:0040FC4D		       jnz     short locret_40FC53
.text:0040FC4F
.text:0040FC4F loc_40FC4F:			       ; CODE XREF: GetLcidFromLangCountry+54j
.text:0040FC4F					       ; GetLcidFromLangCountry+5Aj
.text:0040FC4F		       and     dword ptr [_psetloc_data+8], 0
.text:0040FC53
.text:0040FC53 locret_40FC53:			       ; CODE XREF: GetLcidFromLangCountry+5Ej
.text:0040FC53		       retn
.text:0040FC53 GetLcidFromLangCountry endp
.text:0040FC53
.text:0040FC54
.text:0040FC54 ; =============== S U B R O U T I N E =======================================
.text:0040FC54
.text:0040FC54
.text:0040FC54 ; void __usercall GetLcidFromLanguage(setloc_struct *_psetloc_data<esi>)
.text:0040FC54 GetLcidFromLanguage proc	near	       ; CODE XREF: ___get_qualified_locale:loc_40FCF7p
.text:0040FC54					       ; ___get_qualified_locale:loc_40FD26p
.text:0040FC54 _psetloc_data = esi
.text:0040FC54		       push    dword ptr [_psetloc_data] ; buf
.text:0040FC56		       call    _strlen
.text:0040FC5B		       sub     eax, 3
.text:0040FC5E		       neg     eax
.text:0040FC60		       sbb     eax, eax
.text:0040FC62		       inc     eax
.text:0040FC63		       pop     ecx
.text:0040FC64		       mov     [_psetloc_data+10h], eax
.text:0040FC67		       jz      short loc_40FC6E
.text:0040FC69		       push    2
.text:0040FC6B		       pop     eax
.text:0040FC6C		       jmp     short loc_40FC75
.text:0040FC6E ; ---------------------------------------------------------------------------
.text:0040FC6E
.text:0040FC6E loc_40FC6E:			       ; CODE XREF: GetLcidFromLanguage+13j
.text:0040FC6E		       mov     edx, [_psetloc_data] ; pchLanguage
.text:0040FC70		       call    GetPrimaryLen
.text:0040FC75
.text:0040FC75 loc_40FC75:			       ; CODE XREF: GetLcidFromLanguage+18j
.text:0040FC75		       push    1	       ; dwFlags
.text:0040FC77		       push    offset LanguageEnumProc ; lpLocaleEnumProc
.text:0040FC7C		       mov     [_psetloc_data+0Ch], eax
.text:0040FC7F		       call    ds:__imp__EnumSystemLocalesA@8 ;	EnumSystemLocalesA(x,x)
.text:0040FC85		       test    byte ptr	[_psetloc_data+8], 4
.text:0040FC89		       jnz     short locret_40FC8F
.text:0040FC8B		       and     dword ptr [_psetloc_data+8], 0
.text:0040FC8F
.text:0040FC8F locret_40FC8F:			       ; CODE XREF: GetLcidFromLanguage+35j
.text:0040FC8F		       retn
.text:0040FC8F GetLcidFromLanguage endp
.text:0040FC8F
.text:0040FC90
.text:0040FC90 ; =============== S U B R O U T I N E =======================================
.text:0040FC90
.text:0040FC90
.text:0040FC90 ; int __cdecl __get_qualified_locale(tagLC_STRINGS *const lpInStr, tagLC_ID *lpOutId, tagLC_STRINGS *lpOutStr)
.text:0040FC90 ___get_qualified_locale proc near       ; CODE XREF: __expandlocale+10Ep
.text:0040FC90
.text:0040FC90 lpInStr	       = dword ptr  4
.text:0040FC90 lpOutId	       = dword ptr  8
.text:0040FC90 lpOutStr	       = dword ptr  0Ch
.text:0040FC90
.text:0040FC90		       push    ebx
.text:0040FC91		       push    ebp
.text:0040FC92		       push    esi
.text:0040FC93		       push    edi
.text:0040FC94		       call    __getptd
.text:0040FC99		       mov     ebp, [esp+10h+lpInStr]
.text:0040FC9D		       mov     esi, eax
.text:0040FC9F		       xor     ebx, ebx
.text:0040FCA1		       add     esi, 9Ch	       ; _psetloc_data
.text:0040FCA7		       cmp     ebp, ebx
.text:0040FCA9		       jnz     short loc_40FCB7
.text:0040FCAB		       or      dword ptr [esi+8], 104h
.text:0040FCB2		       jmp     loc_40FD68
.text:0040FCB7 ; ---------------------------------------------------------------------------
.text:0040FCB7
.text:0040FCB7 loc_40FCB7:			       ; CODE XREF: ___get_qualified_locale+19j
.text:0040FCB7		       lea     eax, [ebp+40h]
.text:0040FCBA		       cmp     eax, ebx
.text:0040FCBC		       lea     edi, [esi+4]
.text:0040FCBF		       mov     [esi], ebp
.text:0040FCC1		       mov     [edi], eax
.text:0040FCC3		       jz      short loc_40FCD9
.text:0040FCC5		       cmp     [eax], bl
.text:0040FCC7		       jz      short loc_40FCD9
.text:0040FCC9		       push    edi	       ; ppchName
.text:0040FCCA		       push    16h	       ; high
.text:0040FCCC		       push    offset ___rg_country ; lpTable
.text:0040FCD1		       call    TranslateName
.text:0040FCD6		       add     esp, 0Ch
.text:0040FCD9
.text:0040FCD9 loc_40FCD9:			       ; CODE XREF: ___get_qualified_locale+33j
.text:0040FCD9					       ; ___get_qualified_locale+37j
.text:0040FCD9		       mov     eax, [esi]
.text:0040FCDB		       cmp     eax, ebx
.text:0040FCDD		       mov     [esi+8],	ebx
.text:0040FCE0		       jz      short loc_40FD2D
.text:0040FCE2		       cmp     [eax], bl
.text:0040FCE4		       jz      short loc_40FD2D
.text:0040FCE6		       mov     eax, [edi]
.text:0040FCE8		       cmp     eax, ebx
.text:0040FCEA		       jz      short loc_40FCF7
.text:0040FCEC		       cmp     [eax], bl
.text:0040FCEE		       jz      short loc_40FCF7
.text:0040FCF0		       call    GetLcidFromLangCountry
.text:0040FCF5		       jmp     short loc_40FCFC
.text:0040FCF7 ; ---------------------------------------------------------------------------
.text:0040FCF7
.text:0040FCF7 loc_40FCF7:			       ; CODE XREF: ___get_qualified_locale+5Aj
.text:0040FCF7					       ; ___get_qualified_locale+5Ej
.text:0040FCF7		       call    GetLcidFromLanguage
.text:0040FCFC
.text:0040FCFC loc_40FCFC:			       ; CODE XREF: ___get_qualified_locale+65j
.text:0040FCFC		       cmp     [esi+8],	ebx
.text:0040FCFF		       jnz     short loc_40FD7D
.text:0040FD01		       push    esi	       ; ppchName
.text:0040FD02		       push    40h	       ; high
.text:0040FD04		       push    offset ___rg_language ; lpTable
.text:0040FD09		       call    TranslateName
.text:0040FD0E		       add     esp, 0Ch
.text:0040FD11		       test    eax, eax
.text:0040FD13		       jz      short loc_40FD74
.text:0040FD15		       mov     edi, [edi]
.text:0040FD17		       cmp     edi, ebx
.text:0040FD19		       jz      short loc_40FD26
.text:0040FD1B		       cmp     [edi], bl
.text:0040FD1D		       jz      short loc_40FD26
.text:0040FD1F		       call    GetLcidFromLangCountry
.text:0040FD24		       jmp     short loc_40FD74
.text:0040FD26 ; ---------------------------------------------------------------------------
.text:0040FD26
.text:0040FD26 loc_40FD26:			       ; CODE XREF: ___get_qualified_locale+89j
.text:0040FD26					       ; ___get_qualified_locale+8Dj
.text:0040FD26		       call    GetLcidFromLanguage
.text:0040FD2B		       jmp     short loc_40FD74
.text:0040FD2D ; ---------------------------------------------------------------------------
.text:0040FD2D
.text:0040FD2D loc_40FD2D:			       ; CODE XREF: ___get_qualified_locale+50j
.text:0040FD2D					       ; ___get_qualified_locale+54j
.text:0040FD2D		       mov     edi, [edi]
.text:0040FD2F		       cmp     edi, ebx
.text:0040FD31		       jz      short loc_40FD61
.text:0040FD33		       cmp     [edi], bl
.text:0040FD35		       jz      short loc_40FD61
.text:0040FD37		       push    edi	       ; buf
.text:0040FD38		       call    _strlen
.text:0040FD3D		       sub     eax, 3
.text:0040FD40		       neg     eax
.text:0040FD42		       pop     ecx
.text:0040FD43		       sbb     eax, eax
.text:0040FD45		       push    1	       ; dwFlags
.text:0040FD47		       inc     eax
.text:0040FD48		       push    offset CountryEnumProc ;	lpLocaleEnumProc
.text:0040FD4D		       mov     [esi+14h], eax
.text:0040FD50		       call    ds:__imp__EnumSystemLocalesA@8 ;	EnumSystemLocalesA(x,x)
.text:0040FD56		       test    byte ptr	[esi+8], 4
.text:0040FD5A		       jnz     short loc_40FD74
.text:0040FD5C		       mov     [esi+8],	ebx
.text:0040FD5F		       jmp     short loc_40FD74
.text:0040FD61 ; ---------------------------------------------------------------------------
.text:0040FD61
.text:0040FD61 loc_40FD61:			       ; CODE XREF: ___get_qualified_locale+A1j
.text:0040FD61					       ; ___get_qualified_locale+A5j
.text:0040FD61		       mov     dword ptr [esi+8], 104h
.text:0040FD68
.text:0040FD68 loc_40FD68:			       ; CODE XREF: ___get_qualified_locale+22j
.text:0040FD68		       call    ds:__imp__GetUserDefaultLCID@0 ;	GetUserDefaultLCID()
.text:0040FD6E		       mov     [esi+18h], eax
.text:0040FD71		       mov     [esi+1Ch], eax
.text:0040FD74
.text:0040FD74 loc_40FD74:			       ; CODE XREF: ___get_qualified_locale+83j
.text:0040FD74					       ; ___get_qualified_locale+94j ...
.text:0040FD74		       cmp     [esi+8],	ebx
.text:0040FD77		       jz      loc_40FE6C
.text:0040FD7D
.text:0040FD7D loc_40FD7D:			       ; CODE XREF: ___get_qualified_locale+6Fj
.text:0040FD7D		       mov     ecx, ebp
.text:0040FD7F		       add     ebp, 80h
.text:0040FD85		       neg     ecx
.text:0040FD87		       sbb     ecx, ecx
.text:0040FD89		       and     ecx, ebp	       ; lpCodePageStr
.text:0040FD8B		       mov     edi, esi	       ; _psetloc_data
.text:0040FD8D		       call    ProcessCodePage
.text:0040FD92		       mov     ebx, eax
.text:0040FD94		       test    ebx, ebx
.text:0040FD96		       jz      loc_40FE6C
.text:0040FD9C		       cmp     ebx, 0FDE8h
.text:0040FDA2		       jz      loc_40FE6C
.text:0040FDA8		       cmp     ebx, 0FDE9h
.text:0040FDAE		       jz      loc_40FE6C
.text:0040FDB4		       movzx   eax, bx
.text:0040FDB7		       push    eax	       ; CodePage
.text:0040FDB8		       call    ds:__imp__IsValidCodePage@4 ; IsValidCodePage(x)
.text:0040FDBE		       test    eax, eax
.text:0040FDC0		       jz      loc_40FE6C
.text:0040FDC6		       push    1	       ; dwFlags
.text:0040FDC8		       push    dword ptr [esi+18h] ; Locale
.text:0040FDCB		       call    ds:__imp__IsValidLocale@8 ; IsValidLocale(x,x)
.text:0040FDD1		       test    eax, eax
.text:0040FDD3		       jz      loc_40FE6C
.text:0040FDD9		       mov     eax, [esp+10h+lpOutId]
.text:0040FDDD		       test    eax, eax
.text:0040FDDF		       jz      short loc_40FDF4
.text:0040FDE1		       mov     cx, [esi+18h]
.text:0040FDE5		       mov     [eax], cx
.text:0040FDE8		       mov     cx, [esi+1Ch]
.text:0040FDEC		       mov     [eax+2],	cx
.text:0040FDF0		       mov     [eax+4],	bx
.text:0040FDF4
.text:0040FDF4 loc_40FDF4:			       ; CODE XREF: ___get_qualified_locale+14Fj
.text:0040FDF4		       mov     edi, [esp+10h+lpOutStr]
.text:0040FDF8		       test    edi, edi
.text:0040FDFA		       jz      short loc_40FE67
.text:0040FDFC		       cmp     word ptr	[eax], 814h
.text:0040FE01		       mov     ebp, ds:__imp__GetLocaleInfoA@16	; GetLocaleInfoA(x,x,x,x)
.text:0040FE07		       jnz     short loc_40FE2E
.text:0040FE09		       push    offset aNorwegianNynor ;	"Norwegian-Nynorsk"
.text:0040FE0E		       push    40h	       ; _SizeInBytes
.text:0040FE10		       push    edi	       ; _Dst
.text:0040FE11		       call    _strcpy_s
.text:0040FE16		       add     esp, 0Ch
.text:0040FE19		       test    eax, eax
.text:0040FE1B		       jz      short loc_40FE3F
.text:0040FE1D		       xor     eax, eax
.text:0040FE1F		       push    eax	       ; pReserved
.text:0040FE20		       push    eax	       ; nLine
.text:0040FE21		       push    eax	       ; pszFile
.text:0040FE22		       push    eax	       ; pszFunction
.text:0040FE23		       push    eax	       ; pszExpression
.text:0040FE24		       call    __invoke_watson
.text:0040FE29		       add     esp, 14h
.text:0040FE2C		       jmp     short loc_40FE3F
.text:0040FE2E ; ---------------------------------------------------------------------------
.text:0040FE2E
.text:0040FE2E loc_40FE2E:			       ; CODE XREF: ___get_qualified_locale+177j
.text:0040FE2E		       push    40h	       ; cchData
.text:0040FE30		       push    edi	       ; lpLCData
.text:0040FE31		       push    1001h	       ; LCType
.text:0040FE36		       push    dword ptr [esi+18h] ; Locale
.text:0040FE39		       call    ebp ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040FE3B		       test    eax, eax
.text:0040FE3D		       jz      short loc_40FE6C
.text:0040FE3F
.text:0040FE3F loc_40FE3F:			       ; CODE XREF: ___get_qualified_locale+18Bj
.text:0040FE3F					       ; ___get_qualified_locale+19Cj
.text:0040FE3F		       push    40h	       ; cchData
.text:0040FE41		       lea     eax, [edi+40h]
.text:0040FE44		       push    eax	       ; lpLCData
.text:0040FE45		       push    1002h	       ; LCType
.text:0040FE4A		       push    dword ptr [esi+1Ch] ; Locale
.text:0040FE4D		       call    ebp ; GetLocaleInfoA(x,x,x,x) ; GetLocaleInfoA(x,x,x,x)
.text:0040FE4F		       test    eax, eax
.text:0040FE51		       jz      short loc_40FE6C
.text:0040FE53		       push    0Ah	       ; radix
.text:0040FE55		       push    10h	       ; sizeInTChars
.text:0040FE57		       add     edi, 80h
.text:0040FE5D		       push    edi	       ; buf
.text:0040FE5E		       push    ebx	       ; val
.text:0040FE5F		       call    __itoa_s
.text:0040FE64		       add     esp, 10h
.text:0040FE67
.text:0040FE67 loc_40FE67:			       ; CODE XREF: ___get_qualified_locale+16Aj
.text:0040FE67		       xor     eax, eax
.text:0040FE69		       inc     eax
.text:0040FE6A		       jmp     short loc_40FE6E
.text:0040FE6C ; ---------------------------------------------------------------------------
.text:0040FE6C
.text:0040FE6C loc_40FE6C:			       ; CODE XREF: ___get_qualified_locale+E7j
.text:0040FE6C					       ; ___get_qualified_locale+106j ...
.text:0040FE6C		       xor     eax, eax
.text:0040FE6E
.text:0040FE6E loc_40FE6E:			       ; CODE XREF: ___get_qualified_locale+1DAj
.text:0040FE6E		       pop     edi
.text:0040FE6F		       pop     esi
.text:0040FE70		       pop     ebp
.text:0040FE71		       pop     ebx
.text:0040FE72		       retn
.text:0040FE72 ___get_qualified_locale endp
.text:0040FE72
.text:0040FE73
.text:0040FE73 ; =============== S U B R O U T I N E =======================================
.text:0040FE73
.text:0040FE73
.text:0040FE73 ; int __usercall	cmpResult<eax>(int cmp<eax>)
.text:0040FE73 cmpResult       proc near
.text:0040FE73 cmp = eax
.text:0040FE73		       test    cmp, cmp
.text:0040FE75		       jz      short locret_40FE84
.text:0040FE77		       xor     ecx, ecx
.text:0040FE79		       test    cmp, cmp
.text:0040FE7B		       setnle  cl
.text:0040FE7E		       lea     ecx, [ecx+ecx-1]
.text:0040FE82		       mov     cmp, ecx
.text:0040FE84
.text:0040FE84 locret_40FE84:			       ; CODE XREF: cmpResult+2j
.text:0040FE84		       retn
.text:0040FE84 cmpResult       endp
.text:0040FE84
.text:0040FE85
.text:0040FE85 ; =============== S U B R O U T I N E =======================================
.text:0040FE85
.text:0040FE85
.text:0040FE85 ; int __usercall	cmpBYTE<eax>(const void	*lhs<eax>, const void *rhs<ecx>)
.text:0040FE85 cmpBYTE	       proc near
.text:0040FE85 lhs = eax
.text:0040FE85 rhs = ecx
.text:0040FE85		       movzx   lhs, byte ptr [lhs]
.text:0040FE88		       movzx   rhs, byte ptr [rhs]
.text:0040FE8B		       sub     lhs, rhs
.text:0040FE8D		       jz      short locret_40FE9C
.text:0040FE8F		       xor     rhs, rhs
.text:0040FE91		       test    lhs, lhs
.text:0040FE93		       setnle  cl
.text:0040FE96		       lea     rhs, [rhs+rhs-1]
.text:0040FE9A		       mov     lhs, rhs
.text:0040FE9C
.text:0040FE9C locret_40FE9C:			       ; CODE XREF: cmpBYTE+8j
.text:0040FE9C		       retn
.text:0040FE9C cmpBYTE	       endp
.text:0040FE9C
.text:0040FE9D
.text:0040FE9D ; =============== S U B R O U T I N E =======================================
.text:0040FE9D
.text:0040FE9D
.text:0040FE9D ; int __usercall	cmpWORD<eax>(const void	*lhs<esi>, const void *rhs<ecx>)
.text:0040FE9D cmpWORD	       proc near
.text:0040FE9D lhs = esi
.text:0040FE9D rhs = ecx
.text:0040FE9D		       mov     ax, [lhs]
.text:0040FEA0		       cmp     ax, [rhs]
.text:0040FEA3		       jz      short loc_40FEDA
.text:0040FEA5		       movzx   edx, byte ptr [rhs]
.text:0040FEA8		       movzx   eax, al
.text:0040FEAB		       sub     eax, edx
.text:0040FEAD		       jz      short loc_40FEC0
.text:0040FEAF		       xor     edx, edx
.text:0040FEB1		       test    eax, eax
.text:0040FEB3		       setnle  dl
.text:0040FEB6		       lea     edx, [edx+edx-1]
.text:0040FEBA		       mov     eax, edx
.text:0040FEBC		       test    eax, eax
.text:0040FEBE		       jnz     short locret_40FEDC
.text:0040FEC0
.text:0040FEC0 loc_40FEC0:			       ; CODE XREF: cmpWORD+10j
.text:0040FEC0		       movzx   eax, byte ptr [lhs+1]
.text:0040FEC4		       movzx   rhs, byte ptr [rhs+1]
.text:0040FEC8		       sub     eax, rhs
.text:0040FECA		       jz      short locret_40FEDC
.text:0040FECC		       xor     rhs, rhs
.text:0040FECE		       test    eax, eax
.text:0040FED0		       setnle  cl
.text:0040FED3		       lea     rhs, [rhs+rhs-1]
.text:0040FED7		       mov     eax, rhs
.text:0040FED9		       retn
.text:0040FEDA ; ---------------------------------------------------------------------------
.text:0040FEDA
.text:0040FEDA loc_40FEDA:			       ; CODE XREF: cmpWORD+6j
.text:0040FEDA		       xor     eax, eax
.text:0040FEDC
.text:0040FEDC locret_40FEDC:			       ; CODE XREF: cmpWORD+21j
.text:0040FEDC					       ; cmpWORD+2Dj
.text:0040FEDC		       retn
.text:0040FEDC cmpWORD	       endp
.text:0040FEDC
.text:0040FEDD
.text:0040FEDD ; =============== S U B R O U T I N E =======================================
.text:0040FEDD
.text:0040FEDD
.text:0040FEDD ; int __usercall	cmpDWORD<eax>(const void *lhs<esi>, const void *rhs<ecx>)
.text:0040FEDD cmpDWORD	       proc near
.text:0040FEDD lhs = esi
.text:0040FEDD rhs = ecx
.text:0040FEDD		       mov     eax, [lhs]
.text:0040FEDF		       cmp     eax, [rhs]
.text:0040FEE1		       jz      short loc_40FF52
.text:0040FEE3		       movzx   edx, byte ptr [rhs]
.text:0040FEE6		       movzx   eax, al
.text:0040FEE9		       sub     eax, edx
.text:0040FEEB		       jz      short loc_40FEFE
.text:0040FEED		       xor     edx, edx
.text:0040FEEF		       test    eax, eax
.text:0040FEF1		       setnle  dl
.text:0040FEF4		       lea     edx, [edx+edx-1]
.text:0040FEF8		       mov     eax, edx
.text:0040FEFA		       test    eax, eax
.text:0040FEFC		       jnz     short locret_40FF54
.text:0040FEFE
.text:0040FEFE loc_40FEFE:			       ; CODE XREF: cmpDWORD+Ej
.text:0040FEFE		       movzx   eax, byte ptr [lhs+1]
.text:0040FF02		       movzx   edx, byte ptr [rhs+1]
.text:0040FF06		       sub     eax, edx
.text:0040FF08		       jz      short loc_40FF1B
.text:0040FF0A		       xor     edx, edx
.text:0040FF0C		       test    eax, eax
.text:0040FF0E		       setnle  dl
.text:0040FF11		       lea     edx, [edx+edx-1]
.text:0040FF15		       mov     eax, edx
.text:0040FF17		       test    eax, eax
.text:0040FF19		       jnz     short locret_40FF54
.text:0040FF1B
.text:0040FF1B loc_40FF1B:			       ; CODE XREF: cmpDWORD+2Bj
.text:0040FF1B		       movzx   eax, byte ptr [lhs+2]
.text:0040FF1F		       movzx   edx, byte ptr [rhs+2]
.text:0040FF23		       sub     eax, edx
.text:0040FF25		       jz      short loc_40FF38
.text:0040FF27		       xor     edx, edx
.text:0040FF29		       test    eax, eax
.text:0040FF2B		       setnle  dl
.text:0040FF2E		       lea     edx, [edx+edx-1]
.text:0040FF32		       mov     eax, edx
.text:0040FF34		       test    eax, eax
.text:0040FF36		       jnz     short locret_40FF54
.text:0040FF38
.text:0040FF38 loc_40FF38:			       ; CODE XREF: cmpDWORD+48j
.text:0040FF38		       movzx   eax, byte ptr [lhs+3]
.text:0040FF3C		       movzx   rhs, byte ptr [rhs+3]
.text:0040FF40		       sub     eax, rhs
.text:0040FF42		       jz      short locret_40FF54
.text:0040FF44		       xor     rhs, rhs
.text:0040FF46		       test    eax, eax
.text:0040FF48		       setnle  cl
.text:0040FF4B		       lea     rhs, [rhs+rhs-1]
.text:0040FF4F		       mov     eax, rhs
.text:0040FF51		       retn
.text:0040FF52 ; ---------------------------------------------------------------------------
.text:0040FF52
.text:0040FF52 loc_40FF52:			       ; CODE XREF: cmpDWORD+4j
.text:0040FF52		       xor     eax, eax
.text:0040FF54
.text:0040FF54 locret_40FF54:			       ; CODE XREF: cmpDWORD+1Fj
.text:0040FF54					       ; cmpDWORD+3Cj ...
.text:0040FF54		       retn
.text:0040FF54 cmpDWORD	       endp
.text:0040FF54
.text:0040FF55
.text:0040FF55 ; =============== S U B R O U T I N E =======================================
.text:0040FF55
.text:0040FF55
.text:0040FF55 ; int __usercall	unaligned_memcmp<eax>(const char *bLHS<ecx>, const char	*bRHS<edx>, unsigned int siz<eax>)
.text:0040FF55 unaligned_memcmp	proc near
.text:0040FF55 bLHS = ecx
.text:0040FF55 bRHS = edx
.text:0040FF55 siz = eax
.text:0040FF55		       push    esi
.text:0040FF56		       push    edi
.text:0040FF57		       mov     edi, siz
.text:0040FF59		       jmp     loc_4103BC
.text:0040FF5E ; ---------------------------------------------------------------------------
.text:0040FF5E
.text:0040FF5E loc_40FF5E:			       ; CODE XREF: unaligned_memcmp+46Aj
.text:0040FF5E		       mov     siz, [bLHS]
.text:0040FF60		       cmp     siz, [bRHS]
.text:0040FF62		       jz      short loc_40FFDC
.text:0040FF64		       movzx   esi, al
.text:0040FF67		       movzx   siz, byte ptr [bRHS]
.text:0040FF6A		       sub     esi, siz
.text:0040FF6C		       jz      short loc_40FF81
.text:0040FF6E		       xor     siz, siz
.text:0040FF70		       test    esi, esi
.text:0040FF72		       setnle  al
.text:0040FF75		       lea     siz, [siz+siz-1]
.text:0040FF79		       test    siz, siz
.text:0040FF7B		       jnz     loc_410793
.text:0040FF81
.text:0040FF81 loc_40FF81:			       ; CODE XREF: unaligned_memcmp+17j
.text:0040FF81		       movzx   esi, byte ptr [bLHS+1]
.text:0040FF85		       movzx   siz, byte ptr [bRHS+1]
.text:0040FF89		       sub     esi, siz
.text:0040FF8B		       jz      short loc_40FFA0
.text:0040FF8D		       xor     siz, siz
.text:0040FF8F		       test    esi, esi
.text:0040FF91		       setnle  al
.text:0040FF94		       lea     siz, [siz+siz-1]
.text:0040FF98		       test    siz, siz
.text:0040FF9A		       jnz     loc_410793
.text:0040FFA0
.text:0040FFA0 loc_40FFA0:			       ; CODE XREF: unaligned_memcmp+36j
.text:0040FFA0		       movzx   esi, byte ptr [bLHS+2]
.text:0040FFA4		       movzx   siz, byte ptr [bRHS+2]
.text:0040FFA8		       sub     esi, siz
.text:0040FFAA		       jz      short loc_40FFBF
.text:0040FFAC		       xor     siz, siz
.text:0040FFAE		       test    esi, esi
.text:0040FFB0		       setnle  al
.text:0040FFB3		       lea     siz, [siz+siz-1]
.text:0040FFB7		       test    siz, siz
.text:0040FFB9		       jnz     loc_410793
.text:0040FFBF
.text:0040FFBF loc_40FFBF:			       ; CODE XREF: unaligned_memcmp+55j
.text:0040FFBF		       movzx   esi, byte ptr [bLHS+3]
.text:0040FFC3		       movzx   siz, byte ptr [bRHS+3]
.text:0040FFC7		       sub     esi, siz
.text:0040FFC9		       jz      short loc_40FFD8
.text:0040FFCB		       xor     siz, siz
.text:0040FFCD		       test    esi, esi
.text:0040FFCF		       setnle  al
.text:0040FFD2		       lea     siz, [siz+siz-1]
.text:0040FFD6		       mov     esi, siz
.text:0040FFD8
.text:0040FFD8 loc_40FFD8:			       ; CODE XREF: unaligned_memcmp+74j
.text:0040FFD8		       mov     siz, esi
.text:0040FFDA		       jmp     short loc_40FFDE
.text:0040FFDC ; ---------------------------------------------------------------------------
.text:0040FFDC
.text:0040FFDC loc_40FFDC:			       ; CODE XREF: unaligned_memcmp+Dj
.text:0040FFDC		       xor     siz, siz
.text:0040FFDE
.text:0040FFDE loc_40FFDE:			       ; CODE XREF: unaligned_memcmp+85j
.text:0040FFDE		       test    siz, siz
.text:0040FFE0		       jnz     loc_410793
.text:0040FFE6		       mov     siz, [bLHS+4]
.text:0040FFE9		       cmp     siz, [bRHS+4]
.text:0040FFEC		       jz      short loc_410067
.text:0040FFEE		       movzx   esi, al
.text:0040FFF1		       movzx   siz, byte ptr [bRHS+4]
.text:0040FFF5		       sub     esi, siz
.text:0040FFF7		       jz      short loc_41000C
.text:0040FFF9		       xor     siz, siz
.text:0040FFFB		       test    esi, esi
.text:0040FFFD		       setnle  al
.text:00410000		       lea     siz, [siz+siz-1]
.text:00410004		       test    siz, siz
.text:00410006		       jnz     loc_410793
.text:0041000C
.text:0041000C loc_41000C:			       ; CODE XREF: unaligned_memcmp+A2j
.text:0041000C		       movzx   esi, byte ptr [bLHS+5]
.text:00410010		       movzx   siz, byte ptr [bRHS+5]
.text:00410014		       sub     esi, siz
.text:00410016		       jz      short loc_41002B
.text:00410018		       xor     siz, siz
.text:0041001A		       test    esi, esi
.text:0041001C		       setnle  al
.text:0041001F		       lea     siz, [siz+siz-1]
.text:00410023		       test    siz, siz
.text:00410025		       jnz     loc_410793
.text:0041002B
.text:0041002B loc_41002B:			       ; CODE XREF: unaligned_memcmp+C1j
.text:0041002B		       movzx   esi, byte ptr [bLHS+6]
.text:0041002F		       movzx   siz, byte ptr [bRHS+6]
.text:00410033		       sub     esi, siz
.text:00410035		       jz      short loc_41004A
.text:00410037		       xor     siz, siz
.text:00410039		       test    esi, esi
.text:0041003B		       setnle  al
.text:0041003E		       lea     siz, [siz+siz-1]
.text:00410042		       test    siz, siz
.text:00410044		       jnz     loc_410793
.text:0041004A
.text:0041004A loc_41004A:			       ; CODE XREF: unaligned_memcmp+E0j
.text:0041004A		       movzx   esi, byte ptr [bLHS+7]
.text:0041004E		       movzx   siz, byte ptr [bRHS+7]
.text:00410052		       sub     esi, siz
.text:00410054		       jz      short loc_410063
.text:00410056		       xor     siz, siz
.text:00410058		       test    esi, esi
.text:0041005A		       setnle  al
.text:0041005D		       lea     siz, [siz+siz-1]
.text:00410061		       mov     esi, siz
.text:00410063
.text:00410063 loc_410063:			       ; CODE XREF: unaligned_memcmp+FFj
.text:00410063		       mov     siz, esi
.text:00410065		       jmp     short loc_410069
.text:00410067 ; ---------------------------------------------------------------------------
.text:00410067
.text:00410067 loc_410067:			       ; CODE XREF: unaligned_memcmp+97j
.text:00410067		       xor     siz, siz
.text:00410069
.text:00410069 loc_410069:			       ; CODE XREF: unaligned_memcmp+110j
.text:00410069		       test    siz, siz
.text:0041006B		       jnz     loc_410793
.text:00410071		       mov     siz, [bLHS+8]
.text:00410074		       cmp     siz, [bRHS+8]
.text:00410077		       jz      short loc_4100F2
.text:00410079		       movzx   esi, al
.text:0041007C		       movzx   siz, byte ptr [bRHS+8]
.text:00410080		       sub     esi, siz
.text:00410082		       jz      short loc_410097
.text:00410084		       xor     siz, siz
.text:00410086		       test    esi, esi
.text:00410088		       setnle  al
.text:0041008B		       lea     siz, [siz+siz-1]
.text:0041008F		       test    siz, siz
.text:00410091		       jnz     loc_410793
.text:00410097
.text:00410097 loc_410097:			       ; CODE XREF: unaligned_memcmp+12Dj
.text:00410097		       movzx   esi, byte ptr [bLHS+9]
.text:0041009B		       movzx   siz, byte ptr [bRHS+9]
.text:0041009F		       sub     esi, siz
.text:004100A1		       jz      short loc_4100B6
.text:004100A3		       xor     siz, siz
.text:004100A5		       test    esi, esi
.text:004100A7		       setnle  al
.text:004100AA		       lea     siz, [siz+siz-1]
.text:004100AE		       test    siz, siz
.text:004100B0		       jnz     loc_410793
.text:004100B6
.text:004100B6 loc_4100B6:			       ; CODE XREF: unaligned_memcmp+14Cj
.text:004100B6		       movzx   esi, byte ptr [bLHS+0Ah]
.text:004100BA		       movzx   siz, byte ptr [bRHS+0Ah]
.text:004100BE		       sub     esi, siz
.text:004100C0		       jz      short loc_4100D5
.text:004100C2		       xor     siz, siz
.text:004100C4		       test    esi, esi
.text:004100C6		       setnle  al
.text:004100C9		       lea     siz, [siz+siz-1]
.text:004100CD		       test    siz, siz
.text:004100CF		       jnz     loc_410793
.text:004100D5
.text:004100D5 loc_4100D5:			       ; CODE XREF: unaligned_memcmp+16Bj
.text:004100D5		       movzx   esi, byte ptr [bLHS+0Bh]
.text:004100D9		       movzx   siz, byte ptr [bRHS+0Bh]
.text:004100DD		       sub     esi, siz
.text:004100DF		       jz      short loc_4100EE
.text:004100E1		       xor     siz, siz
.text:004100E3		       test    esi, esi
.text:004100E5		       setnle  al
.text:004100E8		       lea     siz, [siz+siz-1]
.text:004100EC		       mov     esi, siz
.text:004100EE
.text:004100EE loc_4100EE:			       ; CODE XREF: unaligned_memcmp+18Aj
.text:004100EE		       mov     siz, esi
.text:004100F0		       jmp     short loc_4100F4
.text:004100F2 ; ---------------------------------------------------------------------------
.text:004100F2
.text:004100F2 loc_4100F2:			       ; CODE XREF: unaligned_memcmp+122j
.text:004100F2		       xor     siz, siz
.text:004100F4
.text:004100F4 loc_4100F4:			       ; CODE XREF: unaligned_memcmp+19Bj
.text:004100F4		       test    siz, siz
.text:004100F6		       jnz     loc_410793
.text:004100FC		       mov     siz, [bLHS+0Ch]
.text:004100FF		       cmp     siz, [bRHS+0Ch]
.text:00410102		       jz      short loc_41017D
.text:00410104		       movzx   esi, al
.text:00410107		       movzx   siz, byte ptr [bRHS+0Ch]
.text:0041010B		       sub     esi, siz
.text:0041010D		       jz      short loc_410122
.text:0041010F		       xor     siz, siz
.text:00410111		       test    esi, esi
.text:00410113		       setnle  al
.text:00410116		       lea     siz, [siz+siz-1]
.text:0041011A		       test    siz, siz
.text:0041011C		       jnz     loc_410793
.text:00410122
.text:00410122 loc_410122:			       ; CODE XREF: unaligned_memcmp+1B8j
.text:00410122		       movzx   esi, byte ptr [bLHS+0Dh]
.text:00410126		       movzx   siz, byte ptr [bRHS+0Dh]
.text:0041012A		       sub     esi, siz
.text:0041012C		       jz      short loc_410141
.text:0041012E		       xor     siz, siz
.text:00410130		       test    esi, esi
.text:00410132		       setnle  al
.text:00410135		       lea     siz, [siz+siz-1]
.text:00410139		       test    siz, siz
.text:0041013B		       jnz     loc_410793
.text:00410141
.text:00410141 loc_410141:			       ; CODE XREF: unaligned_memcmp+1D7j
.text:00410141		       movzx   esi, byte ptr [bLHS+0Eh]
.text:00410145		       movzx   siz, byte ptr [bRHS+0Eh]
.text:00410149		       sub     esi, siz
.text:0041014B		       jz      short loc_410160
.text:0041014D		       xor     siz, siz
.text:0041014F		       test    esi, esi
.text:00410151		       setnle  al
.text:00410154		       lea     siz, [siz+siz-1]
.text:00410158		       test    siz, siz
.text:0041015A		       jnz     loc_410793
.text:00410160
.text:00410160 loc_410160:			       ; CODE XREF: unaligned_memcmp+1F6j
.text:00410160		       movzx   esi, byte ptr [bLHS+0Fh]
.text:00410164		       movzx   siz, byte ptr [bRHS+0Fh]
.text:00410168		       sub     esi, siz
.text:0041016A		       jz      short loc_410179
.text:0041016C		       xor     siz, siz
.text:0041016E		       test    esi, esi
.text:00410170		       setnle  al
.text:00410173		       lea     siz, [siz+siz-1]
.text:00410177		       mov     esi, siz
.text:00410179
.text:00410179 loc_410179:			       ; CODE XREF: unaligned_memcmp+215j
.text:00410179		       mov     siz, esi
.text:0041017B		       jmp     short loc_41017F
.text:0041017D ; ---------------------------------------------------------------------------
.text:0041017D
.text:0041017D loc_41017D:			       ; CODE XREF: unaligned_memcmp+1ADj
.text:0041017D		       xor     siz, siz
.text:0041017F
.text:0041017F loc_41017F:			       ; CODE XREF: unaligned_memcmp+226j
.text:0041017F		       test    siz, siz
.text:00410181		       jnz     loc_410793
.text:00410187		       mov     siz, [bLHS+10h]
.text:0041018A		       cmp     siz, [bRHS+10h]
.text:0041018D		       jz      short loc_410208
.text:0041018F		       movzx   esi, al
.text:00410192		       movzx   siz, byte ptr [bRHS+10h]
.text:00410196		       sub     esi, siz
.text:00410198		       jz      short loc_4101AD
.text:0041019A		       xor     siz, siz
.text:0041019C		       test    esi, esi
.text:0041019E		       setnle  al
.text:004101A1		       lea     siz, [siz+siz-1]
.text:004101A5		       test    siz, siz
.text:004101A7		       jnz     loc_410793
.text:004101AD
.text:004101AD loc_4101AD:			       ; CODE XREF: unaligned_memcmp+243j
.text:004101AD		       movzx   esi, byte ptr [bLHS+11h]
.text:004101B1		       movzx   siz, byte ptr [bRHS+11h]
.text:004101B5		       sub     esi, siz
.text:004101B7		       jz      short loc_4101CC
.text:004101B9		       xor     siz, siz
.text:004101BB		       test    esi, esi
.text:004101BD		       setnle  al
.text:004101C0		       lea     siz, [siz+siz-1]
.text:004101C4		       test    siz, siz
.text:004101C6		       jnz     loc_410793
.text:004101CC
.text:004101CC loc_4101CC:			       ; CODE XREF: unaligned_memcmp+262j
.text:004101CC		       movzx   esi, byte ptr [bLHS+12h]
.text:004101D0		       movzx   siz, byte ptr [bRHS+12h]
.text:004101D4		       sub     esi, siz
.text:004101D6		       jz      short loc_4101EB
.text:004101D8		       xor     siz, siz
.text:004101DA		       test    esi, esi
.text:004101DC		       setnle  al
.text:004101DF		       lea     siz, [siz+siz-1]
.text:004101E3		       test    siz, siz
.text:004101E5		       jnz     loc_410793
.text:004101EB
.text:004101EB loc_4101EB:			       ; CODE XREF: unaligned_memcmp+281j
.text:004101EB		       movzx   esi, byte ptr [bLHS+13h]
.text:004101EF		       movzx   siz, byte ptr [bRHS+13h]
.text:004101F3		       sub     esi, siz
.text:004101F5		       jz      short loc_410204
.text:004101F7		       xor     siz, siz
.text:004101F9		       test    esi, esi
.text:004101FB		       setnle  al
.text:004101FE		       lea     siz, [siz+siz-1]
.text:00410202		       mov     esi, siz
.text:00410204
.text:00410204 loc_410204:			       ; CODE XREF: unaligned_memcmp+2A0j
.text:00410204		       mov     siz, esi
.text:00410206		       jmp     short loc_41020A
.text:00410208 ; ---------------------------------------------------------------------------
.text:00410208
.text:00410208 loc_410208:			       ; CODE XREF: unaligned_memcmp+238j
.text:00410208		       xor     siz, siz
.text:0041020A
.text:0041020A loc_41020A:			       ; CODE XREF: unaligned_memcmp+2B1j
.text:0041020A		       test    siz, siz
.text:0041020C		       jnz     loc_410793
.text:00410212		       mov     siz, [bLHS+14h]
.text:00410215		       cmp     siz, [bRHS+14h]
.text:00410218		       jz      short loc_410293
.text:0041021A		       movzx   esi, al
.text:0041021D		       movzx   siz, byte ptr [bRHS+14h]
.text:00410221		       sub     esi, siz
.text:00410223		       jz      short loc_410238
.text:00410225		       xor     siz, siz
.text:00410227		       test    esi, esi
.text:00410229		       setnle  al
.text:0041022C		       lea     siz, [siz+siz-1]
.text:00410230		       test    siz, siz
.text:00410232		       jnz     loc_410793
.text:00410238
.text:00410238 loc_410238:			       ; CODE XREF: unaligned_memcmp+2CEj
.text:00410238		       movzx   esi, byte ptr [bLHS+15h]
.text:0041023C		       movzx   siz, byte ptr [bRHS+15h]
.text:00410240		       sub     esi, siz
.text:00410242		       jz      short loc_410257
.text:00410244		       xor     siz, siz
.text:00410246		       test    esi, esi
.text:00410248		       setnle  al
.text:0041024B		       lea     siz, [siz+siz-1]
.text:0041024F		       test    siz, siz
.text:00410251		       jnz     loc_410793
.text:00410257
.text:00410257 loc_410257:			       ; CODE XREF: unaligned_memcmp+2EDj
.text:00410257		       movzx   esi, byte ptr [bLHS+16h]
.text:0041025B		       movzx   siz, byte ptr [bRHS+16h]
.text:0041025F		       sub     esi, siz
.text:00410261		       jz      short loc_410276
.text:00410263		       xor     siz, siz
.text:00410265		       test    esi, esi
.text:00410267		       setnle  al
.text:0041026A		       lea     siz, [siz+siz-1]
.text:0041026E		       test    siz, siz
.text:00410270		       jnz     loc_410793
.text:00410276
.text:00410276 loc_410276:			       ; CODE XREF: unaligned_memcmp+30Cj
.text:00410276		       movzx   esi, byte ptr [bLHS+17h]
.text:0041027A		       movzx   siz, byte ptr [bRHS+17h]
.text:0041027E		       sub     esi, siz
.text:00410280		       jz      short loc_41028F
.text:00410282		       xor     siz, siz
.text:00410284		       test    esi, esi
.text:00410286		       setnle  al
.text:00410289		       lea     siz, [siz+siz-1]
.text:0041028D		       mov     esi, siz
.text:0041028F
.text:0041028F loc_41028F:			       ; CODE XREF: unaligned_memcmp+32Bj
.text:0041028F		       mov     siz, esi
.text:00410291		       jmp     short loc_410295
.text:00410293 ; ---------------------------------------------------------------------------
.text:00410293
.text:00410293 loc_410293:			       ; CODE XREF: unaligned_memcmp+2C3j
.text:00410293		       xor     siz, siz
.text:00410295
.text:00410295 loc_410295:			       ; CODE XREF: unaligned_memcmp+33Cj
.text:00410295		       test    siz, siz
.text:00410297		       jnz     loc_410793
.text:0041029D		       mov     siz, [bLHS+18h]
.text:004102A0		       cmp     siz, [bRHS+18h]
.text:004102A3		       jz      short loc_41031E
.text:004102A5		       movzx   esi, al
.text:004102A8		       movzx   siz, byte ptr [bRHS+18h]
.text:004102AC		       sub     esi, siz
.text:004102AE		       jz      short loc_4102C3
.text:004102B0		       xor     siz, siz
.text:004102B2		       test    esi, esi
.text:004102B4		       setnle  al
.text:004102B7		       lea     siz, [siz+siz-1]
.text:004102BB		       test    siz, siz
.text:004102BD		       jnz     loc_410793
.text:004102C3
.text:004102C3 loc_4102C3:			       ; CODE XREF: unaligned_memcmp+359j
.text:004102C3		       movzx   esi, byte ptr [bLHS+19h]
.text:004102C7		       movzx   siz, byte ptr [bRHS+19h]
.text:004102CB		       sub     esi, siz
.text:004102CD		       jz      short loc_4102E2
.text:004102CF		       xor     siz, siz
.text:004102D1		       test    esi, esi
.text:004102D3		       setnle  al
.text:004102D6		       lea     siz, [siz+siz-1]
.text:004102DA		       test    siz, siz
.text:004102DC		       jnz     loc_410793
.text:004102E2
.text:004102E2 loc_4102E2:			       ; CODE XREF: unaligned_memcmp+378j
.text:004102E2		       movzx   esi, byte ptr [bLHS+1Ah]
.text:004102E6		       movzx   siz, byte ptr [bRHS+1Ah]
.text:004102EA		       sub     esi, siz
.text:004102EC		       jz      short loc_410301
.text:004102EE		       xor     siz, siz
.text:004102F0		       test    esi, esi
.text:004102F2		       setnle  al
.text:004102F5		       lea     siz, [siz+siz-1]
.text:004102F9		       test    siz, siz
.text:004102FB		       jnz     loc_410793
.text:00410301
.text:00410301 loc_410301:			       ; CODE XREF: unaligned_memcmp+397j
.text:00410301		       movzx   esi, byte ptr [bLHS+1Bh]
.text:00410305		       movzx   siz, byte ptr [bRHS+1Bh]
.text:00410309		       sub     esi, siz
.text:0041030B		       jz      short loc_41031A
.text:0041030D		       xor     siz, siz
.text:0041030F		       test    esi, esi
.text:00410311		       setnle  al
.text:00410314		       lea     siz, [siz+siz-1]
.text:00410318		       mov     esi, siz
.text:0041031A
.text:0041031A loc_41031A:			       ; CODE XREF: unaligned_memcmp+3B6j
.text:0041031A		       mov     siz, esi
.text:0041031C		       jmp     short loc_410320
.text:0041031E ; ---------------------------------------------------------------------------
.text:0041031E
.text:0041031E loc_41031E:			       ; CODE XREF: unaligned_memcmp+34Ej
.text:0041031E		       xor     siz, siz
.text:00410320
.text:00410320 loc_410320:			       ; CODE XREF: unaligned_memcmp+3C7j
.text:00410320		       test    siz, siz
.text:00410322		       jnz     loc_410793
.text:00410328		       mov     siz, [bLHS+1Ch]
.text:0041032B		       cmp     siz, [bRHS+1Ch]
.text:0041032E		       jz      short loc_4103A9
.text:00410330		       movzx   esi, al
.text:00410333		       movzx   siz, byte ptr [bRHS+1Ch]
.text:00410337		       sub     esi, siz
.text:00410339		       jz      short loc_41034E
.text:0041033B		       xor     siz, siz
.text:0041033D		       test    esi, esi
.text:0041033F		       setnle  al
.text:00410342		       lea     siz, [siz+siz-1]
.text:00410346		       test    siz, siz
.text:00410348		       jnz     loc_410793
.text:0041034E
.text:0041034E loc_41034E:			       ; CODE XREF: unaligned_memcmp+3E4j
.text:0041034E		       movzx   esi, byte ptr [bLHS+1Dh]
.text:00410352		       movzx   siz, byte ptr [bRHS+1Dh]
.text:00410356		       sub     esi, siz
.text:00410358		       jz      short loc_41036D
.text:0041035A		       xor     siz, siz
.text:0041035C		       test    esi, esi
.text:0041035E		       setnle  al
.text:00410361		       lea     siz, [siz+siz-1]
.text:00410365		       test    siz, siz
.text:00410367		       jnz     loc_410793
.text:0041036D
.text:0041036D loc_41036D:			       ; CODE XREF: unaligned_memcmp+403j
.text:0041036D		       movzx   esi, byte ptr [bLHS+1Eh]
.text:00410371		       movzx   siz, byte ptr [bRHS+1Eh]
.text:00410375		       sub     esi, siz
.text:00410377		       jz      short loc_41038C
.text:00410379		       xor     siz, siz
.text:0041037B		       test    esi, esi
.text:0041037D		       setnle  al
.text:00410380		       lea     siz, [siz+siz-1]
.text:00410384		       test    siz, siz
.text:00410386		       jnz     loc_410793
.text:0041038C
.text:0041038C loc_41038C:			       ; CODE XREF: unaligned_memcmp+422j
.text:0041038C		       movzx   esi, byte ptr [bLHS+1Fh]
.text:00410390		       movzx   siz, byte ptr [bRHS+1Fh]
.text:00410394		       sub     esi, siz
.text:00410396		       jz      short loc_4103A5
.text:00410398		       xor     siz, siz
.text:0041039A		       test    esi, esi
.text:0041039C		       setnle  al
.text:0041039F		       lea     siz, [siz+siz-1]
.text:004103A3		       mov     esi, siz
.text:004103A5
.text:004103A5 loc_4103A5:			       ; CODE XREF: unaligned_memcmp+441j
.text:004103A5		       mov     siz, esi
.text:004103A7		       jmp     short loc_4103AB
.text:004103A9 ; ---------------------------------------------------------------------------
.text:004103A9
.text:004103A9 loc_4103A9:			       ; CODE XREF: unaligned_memcmp+3D9j
.text:004103A9		       xor     siz, siz
.text:004103AB
.text:004103AB loc_4103AB:			       ; CODE XREF: unaligned_memcmp+452j
.text:004103AB		       test    siz, siz
.text:004103AD		       jnz     loc_410793
.text:004103B3		       add     bLHS, 20h
.text:004103B6		       add     bRHS, 20h
.text:004103B9		       sub     edi, 20h
.text:004103BC
.text:004103BC loc_4103BC:			       ; CODE XREF: unaligned_memcmp+4j
.text:004103BC		       cmp     edi, 20h
.text:004103BF		       jnb     loc_40FF5E
.text:004103C5		       add     bLHS, edi
.text:004103C7		       add     bRHS, edi
.text:004103C9		       cmp     edi, 1Fh	       ; switch	32 cases
.text:004103CC		       ja      $LN61	       ; default
.text:004103CC					       ; jumptable 004103D2 case 0
.text:004103D2		       jmp     ds:off_411365[edi*4] ; switch jump
.text:004103D9
.text:004103D9 $LN60:				       ; DATA XREF: unaligned_memcmp:off_411365o
.text:004103D9		       mov     siz, [bLHS-1Ch] ; jumptable 004103D2 case 28
.text:004103DC		       cmp     siz, [bRHS-1Ch]
.text:004103DF		       jz      short loc_41045B
.text:004103E1		       movzx   siz, byte ptr [bRHS-1Ch]
.text:004103E5		       movzx   esi, byte ptr [bLHS-1Ch]
.text:004103E9		       sub     esi, siz
.text:004103EB		       jz      short loc_410400
.text:004103ED		       xor     siz, siz
.text:004103EF		       test    esi, esi
.text:004103F1		       setnle  al
.text:004103F4		       lea     siz, [siz+siz-1]
.text:004103F8		       test    siz, siz
.text:004103FA		       jnz     loc_410793
.text:00410400
.text:00410400 loc_410400:			       ; CODE XREF: unaligned_memcmp+496j
.text:00410400		       movzx   esi, byte ptr [bLHS-1Bh]
.text:00410404		       movzx   siz, byte ptr [bRHS-1Bh]
.text:00410408		       sub     esi, siz
.text:0041040A		       jz      short loc_41041F
.text:0041040C		       xor     siz, siz
.text:0041040E		       test    esi, esi
.text:00410410		       setnle  al
.text:00410413		       lea     siz, [siz+siz-1]
.text:00410417		       test    siz, siz
.text:00410419		       jnz     loc_410793
.text:0041041F
.text:0041041F loc_41041F:			       ; CODE XREF: unaligned_memcmp+4B5j
.text:0041041F		       movzx   esi, byte ptr [bLHS-1Ah]
.text:00410423		       movzx   siz, byte ptr [bRHS-1Ah]
.text:00410427		       sub     esi, siz
.text:00410429		       jz      short loc_41043E
.text:0041042B		       xor     siz, siz
.text:0041042D		       test    esi, esi
.text:0041042F		       setnle  al
.text:00410432		       lea     siz, [siz+siz-1]
.text:00410436		       test    siz, siz
.text:00410438		       jnz     loc_410793
.text:0041043E
.text:0041043E loc_41043E:			       ; CODE XREF: unaligned_memcmp+4D4j
.text:0041043E		       movzx   esi, byte ptr [bLHS-19h]
.text:00410442		       movzx   siz, byte ptr [bRHS-19h]
.text:00410446		       sub     esi, siz
.text:00410448		       jz      short loc_410457
.text:0041044A		       xor     siz, siz
.text:0041044C		       test    esi, esi
.text:0041044E		       setnle  al
.text:00410451		       lea     siz, [siz+siz-1]
.text:00410455		       mov     esi, siz
.text:00410457
.text:00410457 loc_410457:			       ; CODE XREF: unaligned_memcmp+4F3j
.text:00410457		       mov     siz, esi
.text:00410459		       jmp     short loc_41045D
.text:0041045B ; ---------------------------------------------------------------------------
.text:0041045B
.text:0041045B loc_41045B:			       ; CODE XREF: unaligned_memcmp+48Aj
.text:0041045B		       xor     siz, siz
.text:0041045D
.text:0041045D loc_41045D:			       ; CODE XREF: unaligned_memcmp+504j
.text:0041045D		       test    siz, siz
.text:0041045F		       jnz     loc_410793
.text:00410465
.text:00410465 $LN1169:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410465					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410465		       mov     siz, [bLHS-18h] ; jumptable 004103D2 case 24
.text:00410468		       cmp     siz, [bRHS-18h]
.text:0041046B		       jz      short loc_4104E6
.text:0041046D		       movzx   esi, al
.text:00410470		       movzx   siz, byte ptr [bRHS-18h]
.text:00410474		       sub     esi, siz
.text:00410476		       jz      short loc_41048B
.text:00410478		       xor     siz, siz
.text:0041047A		       test    esi, esi
.text:0041047C		       setnle  al
.text:0041047F		       lea     siz, [siz+siz-1]
.text:00410483		       test    siz, siz
.text:00410485		       jnz     loc_410793
.text:0041048B
.text:0041048B loc_41048B:			       ; CODE XREF: unaligned_memcmp+521j
.text:0041048B		       movzx   esi, byte ptr [bLHS-17h]
.text:0041048F		       movzx   siz, byte ptr [bRHS-17h]
.text:00410493		       sub     esi, siz
.text:00410495		       jz      short loc_4104AA
.text:00410497		       xor     siz, siz
.text:00410499		       test    esi, esi
.text:0041049B		       setnle  al
.text:0041049E		       lea     siz, [siz+siz-1]
.text:004104A2		       test    siz, siz
.text:004104A4		       jnz     loc_410793
.text:004104AA
.text:004104AA loc_4104AA:			       ; CODE XREF: unaligned_memcmp+540j
.text:004104AA		       movzx   esi, byte ptr [bLHS-16h]
.text:004104AE		       movzx   siz, byte ptr [bRHS-16h]
.text:004104B2		       sub     esi, siz
.text:004104B4		       jz      short loc_4104C9
.text:004104B6		       xor     siz, siz
.text:004104B8		       test    esi, esi
.text:004104BA		       setnle  al
.text:004104BD		       lea     siz, [siz+siz-1]
.text:004104C1		       test    siz, siz
.text:004104C3		       jnz     loc_410793
.text:004104C9
.text:004104C9 loc_4104C9:			       ; CODE XREF: unaligned_memcmp+55Fj
.text:004104C9		       movzx   esi, byte ptr [bLHS-15h]
.text:004104CD		       movzx   siz, byte ptr [bRHS-15h]
.text:004104D1		       sub     esi, siz
.text:004104D3		       jz      short loc_4104E2
.text:004104D5		       xor     siz, siz
.text:004104D7		       test    esi, esi
.text:004104D9		       setnle  al
.text:004104DC		       lea     siz, [siz+siz-1]
.text:004104E0		       mov     esi, siz
.text:004104E2
.text:004104E2 loc_4104E2:			       ; CODE XREF: unaligned_memcmp+57Ej
.text:004104E2		       mov     siz, esi
.text:004104E4		       jmp     short loc_4104E8
.text:004104E6 ; ---------------------------------------------------------------------------
.text:004104E6
.text:004104E6 loc_4104E6:			       ; CODE XREF: unaligned_memcmp+516j
.text:004104E6		       xor     siz, siz
.text:004104E8
.text:004104E8 loc_4104E8:			       ; CODE XREF: unaligned_memcmp+58Fj
.text:004104E8		       test    siz, siz
.text:004104EA		       jnz     loc_410793
.text:004104F0
.text:004104F0 $LN1170:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004104F0					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:004104F0		       mov     siz, [bLHS-14h] ; jumptable 004103D2 case 20
.text:004104F3		       cmp     siz, [bRHS-14h]
.text:004104F6		       jz      short loc_410571
.text:004104F8		       movzx   esi, al
.text:004104FB		       movzx   siz, byte ptr [bRHS-14h]
.text:004104FF		       sub     esi, siz
.text:00410501		       jz      short loc_410516
.text:00410503		       xor     siz, siz
.text:00410505		       test    esi, esi
.text:00410507		       setnle  al
.text:0041050A		       lea     siz, [siz+siz-1]
.text:0041050E		       test    siz, siz
.text:00410510		       jnz     loc_410793
.text:00410516
.text:00410516 loc_410516:			       ; CODE XREF: unaligned_memcmp+5ACj
.text:00410516		       movzx   esi, byte ptr [bLHS-13h]
.text:0041051A		       movzx   siz, byte ptr [bRHS-13h]
.text:0041051E		       sub     esi, siz
.text:00410520		       jz      short loc_410535
.text:00410522		       xor     siz, siz
.text:00410524		       test    esi, esi
.text:00410526		       setnle  al
.text:00410529		       lea     siz, [siz+siz-1]
.text:0041052D		       test    siz, siz
.text:0041052F		       jnz     loc_410793
.text:00410535
.text:00410535 loc_410535:			       ; CODE XREF: unaligned_memcmp+5CBj
.text:00410535		       movzx   esi, byte ptr [bLHS-12h]
.text:00410539		       movzx   siz, byte ptr [bRHS-12h]
.text:0041053D		       sub     esi, siz
.text:0041053F		       jz      short loc_410554
.text:00410541		       xor     siz, siz
.text:00410543		       test    esi, esi
.text:00410545		       setnle  al
.text:00410548		       lea     siz, [siz+siz-1]
.text:0041054C		       test    siz, siz
.text:0041054E		       jnz     loc_410793
.text:00410554
.text:00410554 loc_410554:			       ; CODE XREF: unaligned_memcmp+5EAj
.text:00410554		       movzx   esi, byte ptr [bLHS-11h]
.text:00410558		       movzx   siz, byte ptr [bRHS-11h]
.text:0041055C		       sub     esi, siz
.text:0041055E		       jz      short loc_41056D
.text:00410560		       xor     siz, siz
.text:00410562		       test    esi, esi
.text:00410564		       setnle  al
.text:00410567		       lea     siz, [siz+siz-1]
.text:0041056B		       mov     esi, siz
.text:0041056D
.text:0041056D loc_41056D:			       ; CODE XREF: unaligned_memcmp+609j
.text:0041056D		       mov     siz, esi
.text:0041056F		       jmp     short loc_410573
.text:00410571 ; ---------------------------------------------------------------------------
.text:00410571
.text:00410571 loc_410571:			       ; CODE XREF: unaligned_memcmp+5A1j
.text:00410571		       xor     siz, siz
.text:00410573
.text:00410573 loc_410573:			       ; CODE XREF: unaligned_memcmp+61Aj
.text:00410573		       test    siz, siz
.text:00410575		       jnz     loc_410793
.text:0041057B
.text:0041057B $LN1171:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:0041057B					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:0041057B		       mov     siz, [bLHS-10h] ; jumptable 004103D2 case 16
.text:0041057E		       cmp     siz, [bRHS-10h]
.text:00410581		       jz      short loc_4105FC
.text:00410583		       movzx   esi, al
.text:00410586		       movzx   siz, byte ptr [bRHS-10h]
.text:0041058A		       sub     esi, siz
.text:0041058C		       jz      short loc_4105A1
.text:0041058E		       xor     siz, siz
.text:00410590		       test    esi, esi
.text:00410592		       setnle  al
.text:00410595		       lea     siz, [siz+siz-1]
.text:00410599		       test    siz, siz
.text:0041059B		       jnz     loc_410793
.text:004105A1
.text:004105A1 loc_4105A1:			       ; CODE XREF: unaligned_memcmp+637j
.text:004105A1		       movzx   esi, byte ptr [bLHS-0Fh]
.text:004105A5		       movzx   siz, byte ptr [bRHS-0Fh]
.text:004105A9		       sub     esi, siz
.text:004105AB		       jz      short loc_4105C0
.text:004105AD		       xor     siz, siz
.text:004105AF		       test    esi, esi
.text:004105B1		       setnle  al
.text:004105B4		       lea     siz, [siz+siz-1]
.text:004105B8		       test    siz, siz
.text:004105BA		       jnz     loc_410793
.text:004105C0
.text:004105C0 loc_4105C0:			       ; CODE XREF: unaligned_memcmp+656j
.text:004105C0		       movzx   esi, byte ptr [bLHS-0Eh]
.text:004105C4		       movzx   siz, byte ptr [bRHS-0Eh]
.text:004105C8		       sub     esi, siz
.text:004105CA		       jz      short loc_4105DF
.text:004105CC		       xor     siz, siz
.text:004105CE		       test    esi, esi
.text:004105D0		       setnle  al
.text:004105D3		       lea     siz, [siz+siz-1]
.text:004105D7		       test    siz, siz
.text:004105D9		       jnz     loc_410793
.text:004105DF
.text:004105DF loc_4105DF:			       ; CODE XREF: unaligned_memcmp+675j
.text:004105DF		       movzx   esi, byte ptr [bLHS-0Dh]
.text:004105E3		       movzx   siz, byte ptr [bRHS-0Dh]
.text:004105E7		       sub     esi, siz
.text:004105E9		       jz      short loc_4105F8
.text:004105EB		       xor     siz, siz
.text:004105ED		       test    esi, esi
.text:004105EF		       setnle  al
.text:004105F2		       lea     siz, [siz+siz-1]
.text:004105F6		       mov     esi, siz
.text:004105F8
.text:004105F8 loc_4105F8:			       ; CODE XREF: unaligned_memcmp+694j
.text:004105F8		       mov     siz, esi
.text:004105FA		       jmp     short loc_4105FE
.text:004105FC ; ---------------------------------------------------------------------------
.text:004105FC
.text:004105FC loc_4105FC:			       ; CODE XREF: unaligned_memcmp+62Cj
.text:004105FC		       xor     siz, siz
.text:004105FE
.text:004105FE loc_4105FE:			       ; CODE XREF: unaligned_memcmp+6A5j
.text:004105FE		       test    siz, siz
.text:00410600		       jnz     loc_410793
.text:00410606
.text:00410606 $LN1172:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410606					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410606		       mov     siz, [bLHS-0Ch] ; jumptable 004103D2 case 12
.text:00410609		       cmp     siz, [bRHS-0Ch]
.text:0041060C		       jz      short loc_410687
.text:0041060E		       movzx   esi, al
.text:00410611		       movzx   siz, byte ptr [bRHS-0Ch]
.text:00410615		       sub     esi, siz
.text:00410617		       jz      short loc_41062C
.text:00410619		       xor     siz, siz
.text:0041061B		       test    esi, esi
.text:0041061D		       setnle  al
.text:00410620		       lea     siz, [siz+siz-1]
.text:00410624		       test    siz, siz
.text:00410626		       jnz     loc_410793
.text:0041062C
.text:0041062C loc_41062C:			       ; CODE XREF: unaligned_memcmp+6C2j
.text:0041062C		       movzx   esi, byte ptr [bLHS-0Bh]
.text:00410630		       movzx   siz, byte ptr [bRHS-0Bh]
.text:00410634		       sub     esi, siz
.text:00410636		       jz      short loc_41064B
.text:00410638		       xor     siz, siz
.text:0041063A		       test    esi, esi
.text:0041063C		       setnle  al
.text:0041063F		       lea     siz, [siz+siz-1]
.text:00410643		       test    siz, siz
.text:00410645		       jnz     loc_410793
.text:0041064B
.text:0041064B loc_41064B:			       ; CODE XREF: unaligned_memcmp+6E1j
.text:0041064B		       movzx   esi, byte ptr [bLHS-0Ah]
.text:0041064F		       movzx   siz, byte ptr [bRHS-0Ah]
.text:00410653		       sub     esi, siz
.text:00410655		       jz      short loc_41066A
.text:00410657		       xor     siz, siz
.text:00410659		       test    esi, esi
.text:0041065B		       setnle  al
.text:0041065E		       lea     siz, [siz+siz-1]
.text:00410662		       test    siz, siz
.text:00410664		       jnz     loc_410793
.text:0041066A
.text:0041066A loc_41066A:			       ; CODE XREF: unaligned_memcmp+700j
.text:0041066A		       movzx   esi, byte ptr [bLHS-9]
.text:0041066E		       movzx   siz, byte ptr [bRHS-9]
.text:00410672		       sub     esi, siz
.text:00410674		       jz      short loc_410683
.text:00410676		       xor     siz, siz
.text:00410678		       test    esi, esi
.text:0041067A		       setnle  al
.text:0041067D		       lea     siz, [siz+siz-1]
.text:00410681		       mov     esi, siz
.text:00410683
.text:00410683 loc_410683:			       ; CODE XREF: unaligned_memcmp+71Fj
.text:00410683		       mov     siz, esi
.text:00410685		       jmp     short loc_410689
.text:00410687 ; ---------------------------------------------------------------------------
.text:00410687
.text:00410687 loc_410687:			       ; CODE XREF: unaligned_memcmp+6B7j
.text:00410687		       xor     siz, siz
.text:00410689
.text:00410689 loc_410689:			       ; CODE XREF: unaligned_memcmp+730j
.text:00410689		       test    siz, siz
.text:0041068B		       jnz     loc_410793
.text:00410691
.text:00410691 $LN1173:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410691					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410691		       mov     siz, [bLHS-8]   ; jumptable 004103D2 case 8
.text:00410694		       cmp     siz, [bRHS-8]
.text:00410697		       jz      short loc_410712
.text:00410699		       movzx   esi, al
.text:0041069C		       movzx   siz, byte ptr [bRHS-8]
.text:004106A0		       sub     esi, siz
.text:004106A2		       jz      short loc_4106B7
.text:004106A4		       xor     siz, siz
.text:004106A6		       test    esi, esi
.text:004106A8		       setnle  al
.text:004106AB		       lea     siz, [siz+siz-1]
.text:004106AF		       test    siz, siz
.text:004106B1		       jnz     loc_410793
.text:004106B7
.text:004106B7 loc_4106B7:			       ; CODE XREF: unaligned_memcmp+74Dj
.text:004106B7		       movzx   esi, byte ptr [bLHS-7]
.text:004106BB		       movzx   siz, byte ptr [bRHS-7]
.text:004106BF		       sub     esi, siz
.text:004106C1		       jz      short loc_4106D6
.text:004106C3		       xor     siz, siz
.text:004106C5		       test    esi, esi
.text:004106C7		       setnle  al
.text:004106CA		       lea     siz, [siz+siz-1]
.text:004106CE		       test    siz, siz
.text:004106D0		       jnz     loc_410793
.text:004106D6
.text:004106D6 loc_4106D6:			       ; CODE XREF: unaligned_memcmp+76Cj
.text:004106D6		       movzx   esi, byte ptr [bLHS-6]
.text:004106DA		       movzx   siz, byte ptr [bRHS-6]
.text:004106DE		       sub     esi, siz
.text:004106E0		       jz      short loc_4106F5
.text:004106E2		       xor     siz, siz
.text:004106E4		       test    esi, esi
.text:004106E6		       setnle  al
.text:004106E9		       lea     siz, [siz+siz-1]
.text:004106ED		       test    siz, siz
.text:004106EF		       jnz     loc_410793
.text:004106F5
.text:004106F5 loc_4106F5:			       ; CODE XREF: unaligned_memcmp+78Bj
.text:004106F5		       movzx   esi, byte ptr [bLHS-5]
.text:004106F9		       movzx   siz, byte ptr [bRHS-5]
.text:004106FD		       sub     esi, siz
.text:004106FF		       jz      short loc_41070E
.text:00410701		       xor     siz, siz
.text:00410703		       test    esi, esi
.text:00410705		       setnle  al
.text:00410708		       lea     siz, [siz+siz-1]
.text:0041070C		       mov     esi, siz
.text:0041070E
.text:0041070E loc_41070E:			       ; CODE XREF: unaligned_memcmp+7AAj
.text:0041070E		       mov     siz, esi
.text:00410710		       jmp     short loc_410714
.text:00410712 ; ---------------------------------------------------------------------------
.text:00410712
.text:00410712 loc_410712:			       ; CODE XREF: unaligned_memcmp+742j
.text:00410712		       xor     siz, siz
.text:00410714
.text:00410714 loc_410714:			       ; CODE XREF: unaligned_memcmp+7BBj
.text:00410714		       test    siz, siz
.text:00410716		       jnz     short loc_410793
.text:00410718
.text:00410718 $LN1174:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410718					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410718		       mov     siz, [bLHS-4]   ; jumptable 004103D2 case 4
.text:0041071B		       cmp     siz, [bRHS-4]
.text:0041071E		       jz      short loc_41078B
.text:00410720		       movzx   esi, al
.text:00410723		       movzx   siz, byte ptr [bRHS-4]
.text:00410727		       sub     esi, siz
.text:00410729		       jz      short loc_41073A
.text:0041072B		       xor     siz, siz
.text:0041072D		       test    esi, esi
.text:0041072F		       setnle  al
.text:00410732		       lea     siz, [siz+siz-1]
.text:00410736		       test    siz, siz
.text:00410738		       jnz     short loc_410793
.text:0041073A
.text:0041073A loc_41073A:			       ; CODE XREF: unaligned_memcmp+7D4j
.text:0041073A		       movzx   esi, byte ptr [bLHS-3]
.text:0041073E		       movzx   siz, byte ptr [bRHS-3]
.text:00410742		       sub     esi, siz
.text:00410744		       jz      short loc_410755
.text:00410746		       xor     siz, siz
.text:00410748		       test    esi, esi
.text:0041074A		       setnle  al
.text:0041074D		       lea     siz, [siz+siz-1]
.text:00410751		       test    siz, siz
.text:00410753		       jnz     short loc_410793
.text:00410755
.text:00410755 loc_410755:			       ; CODE XREF: unaligned_memcmp+7EFj
.text:00410755		       movzx   esi, byte ptr [bLHS-2]
.text:00410759		       movzx   siz, byte ptr [bRHS-2]
.text:0041075D		       sub     esi, siz
.text:0041075F		       jz      short loc_410770
.text:00410761		       xor     siz, siz
.text:00410763		       test    esi, esi
.text:00410765		       setnle  al
.text:00410768		       lea     siz, [siz+siz-1]
.text:0041076C		       test    siz, siz
.text:0041076E		       jnz     short loc_410793
.text:00410770
.text:00410770 loc_410770:			       ; CODE XREF: unaligned_memcmp+80Aj
.text:00410770		       movzx   siz, byte ptr [bLHS-1]
.text:00410774		       movzx   bLHS, byte ptr [bRHS-1]
.text:00410778		       sub     siz, bLHS
.text:0041077A		       jz      short loc_41078D
.text:0041077C		       xor     bLHS, bLHS
.text:0041077E		       test    siz, siz
.text:00410780		       setnle  cl
.text:00410783		       lea     bLHS, [bLHS+bLHS-1]
.text:00410787		       mov     siz, bLHS
.text:00410789		       jmp     short loc_41078D
.text:0041078B ; ---------------------------------------------------------------------------
.text:0041078B
.text:0041078B loc_41078B:			       ; CODE XREF: unaligned_memcmp+7C9j
.text:0041078B		       xor     siz, siz
.text:0041078D
.text:0041078D loc_41078D:			       ; CODE XREF: unaligned_memcmp+825j
.text:0041078D					       ; unaligned_memcmp+834j
.text:0041078D		       test    siz, siz
.text:0041078F		       jnz     short loc_410793
.text:00410791
.text:00410791 $LN61:				       ; CODE XREF: unaligned_memcmp+477j
.text:00410791					       ; unaligned_memcmp+47Dj	...
.text:00410791		       xor     siz, siz	       ; default
.text:00410791					       ; jumptable 004103D2 case 0
.text:00410793
.text:00410793 loc_410793:			       ; CODE XREF: unaligned_memcmp+26j
.text:00410793					       ; unaligned_memcmp+45j ...
.text:00410793		       pop     edi
.text:00410794		       pop     esi
.text:00410795		       retn
.text:00410796 ; ---------------------------------------------------------------------------
.text:00410796
.text:00410796 $LN45:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410796					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410796		       mov     siz, [bLHS-1Dh] ; jumptable 004103D2 case 29
.text:00410799		       cmp     siz, [bRHS-1Dh]
.text:0041079C		       jz      short loc_41080B
.text:0041079E		       movzx   esi, al
.text:004107A1		       movzx   siz, byte ptr [bRHS-1Dh]
.text:004107A5		       sub     esi, siz
.text:004107A7		       jz      short loc_4107B8
.text:004107A9		       xor     siz, siz
.text:004107AB		       test    esi, esi
.text:004107AD		       setnle  al
.text:004107B0		       lea     siz, [siz+siz-1]
.text:004107B4		       test    siz, siz
.text:004107B6		       jnz     short loc_410793
.text:004107B8
.text:004107B8 loc_4107B8:			       ; CODE XREF: unaligned_memcmp+852j
.text:004107B8		       movzx   esi, byte ptr [bLHS-1Ch]
.text:004107BC		       movzx   siz, byte ptr [bRHS-1Ch]
.text:004107C0		       sub     esi, siz
.text:004107C2		       jz      short loc_4107D3
.text:004107C4		       xor     siz, siz
.text:004107C6		       test    esi, esi
.text:004107C8		       setnle  al
.text:004107CB		       lea     siz, [siz+siz-1]
.text:004107CF		       test    siz, siz
.text:004107D1		       jnz     short loc_410793
.text:004107D3
.text:004107D3 loc_4107D3:			       ; CODE XREF: unaligned_memcmp+86Dj
.text:004107D3		       movzx   esi, byte ptr [bLHS-1Bh]
.text:004107D7		       movzx   siz, byte ptr [bRHS-1Bh]
.text:004107DB		       sub     esi, siz
.text:004107DD		       jz      short loc_4107EE
.text:004107DF		       xor     siz, siz
.text:004107E1		       test    esi, esi
.text:004107E3		       setnle  al
.text:004107E6		       lea     siz, [siz+siz-1]
.text:004107EA		       test    siz, siz
.text:004107EC		       jnz     short loc_410793
.text:004107EE
.text:004107EE loc_4107EE:			       ; CODE XREF: unaligned_memcmp+888j
.text:004107EE		       movzx   esi, byte ptr [bLHS-1Ah]
.text:004107F2		       movzx   siz, byte ptr [bRHS-1Ah]
.text:004107F6		       sub     esi, siz
.text:004107F8		       jz      short loc_410807
.text:004107FA		       xor     siz, siz
.text:004107FC		       test    esi, esi
.text:004107FE		       setnle  al
.text:00410801		       lea     siz, [siz+siz-1]
.text:00410805		       mov     esi, siz
.text:00410807
.text:00410807 loc_410807:			       ; CODE XREF: unaligned_memcmp+8A3j
.text:00410807		       mov     siz, esi
.text:00410809		       jmp     short loc_41080D
.text:0041080B ; ---------------------------------------------------------------------------
.text:0041080B
.text:0041080B loc_41080B:			       ; CODE XREF: unaligned_memcmp+847j
.text:0041080B		       xor     siz, siz
.text:0041080D
.text:0041080D loc_41080D:			       ; CODE XREF: unaligned_memcmp+8B4j
.text:0041080D		       test    siz, siz
.text:0041080F		       jnz     short loc_410793
.text:00410811
.text:00410811 $LN1176:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410811					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410811		       mov     siz, [bLHS-19h] ; jumptable 004103D2 case 25
.text:00410814		       cmp     siz, [bRHS-19h]
.text:00410817		       jz      short loc_410893
.text:00410819		       movzx   siz, byte ptr [bRHS-19h]
.text:0041081D		       movzx   esi, byte ptr [bLHS-19h]
.text:00410821		       sub     esi, siz
.text:00410823		       jz      short loc_410838
.text:00410825		       xor     siz, siz
.text:00410827		       test    esi, esi
.text:00410829		       setnle  al
.text:0041082C		       lea     siz, [siz+siz-1]
.text:00410830		       test    siz, siz
.text:00410832		       jnz     loc_410793
.text:00410838
.text:00410838 loc_410838:			       ; CODE XREF: unaligned_memcmp+8CEj
.text:00410838		       movzx   esi, byte ptr [bLHS-18h]
.text:0041083C		       movzx   siz, byte ptr [bRHS-18h]
.text:00410840		       sub     esi, siz
.text:00410842		       jz      short loc_410857
.text:00410844		       xor     siz, siz
.text:00410846		       test    esi, esi
.text:00410848		       setnle  al
.text:0041084B		       lea     siz, [siz+siz-1]
.text:0041084F		       test    siz, siz
.text:00410851		       jnz     loc_410793
.text:00410857
.text:00410857 loc_410857:			       ; CODE XREF: unaligned_memcmp+8EDj
.text:00410857		       movzx   esi, byte ptr [bLHS-17h]
.text:0041085B		       movzx   siz, byte ptr [bRHS-17h]
.text:0041085F		       sub     esi, siz
.text:00410861		       jz      short loc_410876
.text:00410863		       xor     siz, siz
.text:00410865		       test    esi, esi
.text:00410867		       setnle  al
.text:0041086A		       lea     siz, [siz+siz-1]
.text:0041086E		       test    siz, siz
.text:00410870		       jnz     loc_410793
.text:00410876
.text:00410876 loc_410876:			       ; CODE XREF: unaligned_memcmp+90Cj
.text:00410876		       movzx   esi, byte ptr [bLHS-16h]
.text:0041087A		       movzx   siz, byte ptr [bRHS-16h]
.text:0041087E		       sub     esi, siz
.text:00410880		       jz      short loc_41088F
.text:00410882		       xor     siz, siz
.text:00410884		       test    esi, esi
.text:00410886		       setnle  al
.text:00410889		       lea     siz, [siz+siz-1]
.text:0041088D		       mov     esi, siz
.text:0041088F
.text:0041088F loc_41088F:			       ; CODE XREF: unaligned_memcmp+92Bj
.text:0041088F		       mov     siz, esi
.text:00410891		       jmp     short loc_410895
.text:00410893 ; ---------------------------------------------------------------------------
.text:00410893
.text:00410893 loc_410893:			       ; CODE XREF: unaligned_memcmp+8C2j
.text:00410893		       xor     siz, siz
.text:00410895
.text:00410895 loc_410895:			       ; CODE XREF: unaligned_memcmp+93Cj
.text:00410895		       test    siz, siz
.text:00410897		       jnz     loc_410793
.text:0041089D
.text:0041089D $LN1177:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:0041089D					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:0041089D		       mov     siz, [bLHS-15h] ; jumptable 004103D2 case 21
.text:004108A0		       cmp     siz, [bRHS-15h]
.text:004108A3		       jz      short loc_41091E
.text:004108A5		       movzx   esi, al
.text:004108A8		       movzx   siz, byte ptr [bRHS-15h]
.text:004108AC		       sub     esi, siz
.text:004108AE		       jz      short loc_4108C3
.text:004108B0		       xor     siz, siz
.text:004108B2		       test    esi, esi
.text:004108B4		       setnle  al
.text:004108B7		       lea     siz, [siz+siz-1]
.text:004108BB		       test    siz, siz
.text:004108BD		       jnz     loc_410793
.text:004108C3
.text:004108C3 loc_4108C3:			       ; CODE XREF: unaligned_memcmp+959j
.text:004108C3		       movzx   esi, byte ptr [bLHS-14h]
.text:004108C7		       movzx   siz, byte ptr [bRHS-14h]
.text:004108CB		       sub     esi, siz
.text:004108CD		       jz      short loc_4108E2
.text:004108CF		       xor     siz, siz
.text:004108D1		       test    esi, esi
.text:004108D3		       setnle  al
.text:004108D6		       lea     siz, [siz+siz-1]
.text:004108DA		       test    siz, siz
.text:004108DC		       jnz     loc_410793
.text:004108E2
.text:004108E2 loc_4108E2:			       ; CODE XREF: unaligned_memcmp+978j
.text:004108E2		       movzx   esi, byte ptr [bLHS-13h]
.text:004108E6		       movzx   siz, byte ptr [bRHS-13h]
.text:004108EA		       sub     esi, siz
.text:004108EC		       jz      short loc_410901
.text:004108EE		       xor     siz, siz
.text:004108F0		       test    esi, esi
.text:004108F2		       setnle  al
.text:004108F5		       lea     siz, [siz+siz-1]
.text:004108F9		       test    siz, siz
.text:004108FB		       jnz     loc_410793
.text:00410901
.text:00410901 loc_410901:			       ; CODE XREF: unaligned_memcmp+997j
.text:00410901		       movzx   esi, byte ptr [bLHS-12h]
.text:00410905		       movzx   siz, byte ptr [bRHS-12h]
.text:00410909		       sub     esi, siz
.text:0041090B		       jz      short loc_41091A
.text:0041090D		       xor     siz, siz
.text:0041090F		       test    esi, esi
.text:00410911		       setnle  al
.text:00410914		       lea     siz, [siz+siz-1]
.text:00410918		       mov     esi, siz
.text:0041091A
.text:0041091A loc_41091A:			       ; CODE XREF: unaligned_memcmp+9B6j
.text:0041091A		       mov     siz, esi
.text:0041091C		       jmp     short loc_410920
.text:0041091E ; ---------------------------------------------------------------------------
.text:0041091E
.text:0041091E loc_41091E:			       ; CODE XREF: unaligned_memcmp+94Ej
.text:0041091E		       xor     siz, siz
.text:00410920
.text:00410920 loc_410920:			       ; CODE XREF: unaligned_memcmp+9C7j
.text:00410920		       test    siz, siz
.text:00410922		       jnz     loc_410793
.text:00410928
.text:00410928 $LN1178:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410928					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410928		       mov     siz, [bLHS-11h] ; jumptable 004103D2 case 17
.text:0041092B		       cmp     siz, [bRHS-11h]
.text:0041092E		       jz      short loc_4109A9
.text:00410930		       movzx   esi, al
.text:00410933		       movzx   siz, byte ptr [bRHS-11h]
.text:00410937		       sub     esi, siz
.text:00410939		       jz      short loc_41094E
.text:0041093B		       xor     siz, siz
.text:0041093D		       test    esi, esi
.text:0041093F		       setnle  al
.text:00410942		       lea     siz, [siz+siz-1]
.text:00410946		       test    siz, siz
.text:00410948		       jnz     loc_410793
.text:0041094E
.text:0041094E loc_41094E:			       ; CODE XREF: unaligned_memcmp+9E4j
.text:0041094E		       movzx   esi, byte ptr [bLHS-10h]
.text:00410952		       movzx   siz, byte ptr [bRHS-10h]
.text:00410956		       sub     esi, siz
.text:00410958		       jz      short loc_41096D
.text:0041095A		       xor     siz, siz
.text:0041095C		       test    esi, esi
.text:0041095E		       setnle  al
.text:00410961		       lea     siz, [siz+siz-1]
.text:00410965		       test    siz, siz
.text:00410967		       jnz     loc_410793
.text:0041096D
.text:0041096D loc_41096D:			       ; CODE XREF: unaligned_memcmp+A03j
.text:0041096D		       movzx   esi, byte ptr [bLHS-0Fh]
.text:00410971		       movzx   siz, byte ptr [bRHS-0Fh]
.text:00410975		       sub     esi, siz
.text:00410977		       jz      short loc_41098C
.text:00410979		       xor     siz, siz
.text:0041097B		       test    esi, esi
.text:0041097D		       setnle  al
.text:00410980		       lea     siz, [siz+siz-1]
.text:00410984		       test    siz, siz
.text:00410986		       jnz     loc_410793
.text:0041098C
.text:0041098C loc_41098C:			       ; CODE XREF: unaligned_memcmp+A22j
.text:0041098C		       movzx   esi, byte ptr [bLHS-0Eh]
.text:00410990		       movzx   siz, byte ptr [bRHS-0Eh]
.text:00410994		       sub     esi, siz
.text:00410996		       jz      short loc_4109A5
.text:00410998		       xor     siz, siz
.text:0041099A		       test    esi, esi
.text:0041099C		       setnle  al
.text:0041099F		       lea     siz, [siz+siz-1]
.text:004109A3		       mov     esi, siz
.text:004109A5
.text:004109A5 loc_4109A5:			       ; CODE XREF: unaligned_memcmp+A41j
.text:004109A5		       mov     siz, esi
.text:004109A7		       jmp     short loc_4109AB
.text:004109A9 ; ---------------------------------------------------------------------------
.text:004109A9
.text:004109A9 loc_4109A9:			       ; CODE XREF: unaligned_memcmp+9D9j
.text:004109A9		       xor     siz, siz
.text:004109AB
.text:004109AB loc_4109AB:			       ; CODE XREF: unaligned_memcmp+A52j
.text:004109AB		       test    siz, siz
.text:004109AD		       jnz     loc_410793
.text:004109B3
.text:004109B3 $LN1179:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004109B3					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:004109B3		       mov     siz, [bLHS-0Dh] ; jumptable 004103D2 case 13
.text:004109B6		       cmp     siz, [bRHS-0Dh]
.text:004109B9		       jz      short loc_410A34
.text:004109BB		       movzx   esi, al
.text:004109BE		       movzx   siz, byte ptr [bRHS-0Dh]
.text:004109C2		       sub     esi, siz
.text:004109C4		       jz      short loc_4109D9
.text:004109C6		       xor     siz, siz
.text:004109C8		       test    esi, esi
.text:004109CA		       setnle  al
.text:004109CD		       lea     siz, [siz+siz-1]
.text:004109D1		       test    siz, siz
.text:004109D3		       jnz     loc_410793
.text:004109D9
.text:004109D9 loc_4109D9:			       ; CODE XREF: unaligned_memcmp+A6Fj
.text:004109D9		       movzx   esi, byte ptr [bLHS-0Ch]
.text:004109DD		       movzx   siz, byte ptr [bRHS-0Ch]
.text:004109E1		       sub     esi, siz
.text:004109E3		       jz      short loc_4109F8
.text:004109E5		       xor     siz, siz
.text:004109E7		       test    esi, esi
.text:004109E9		       setnle  al
.text:004109EC		       lea     siz, [siz+siz-1]
.text:004109F0		       test    siz, siz
.text:004109F2		       jnz     loc_410793
.text:004109F8
.text:004109F8 loc_4109F8:			       ; CODE XREF: unaligned_memcmp+A8Ej
.text:004109F8		       movzx   esi, byte ptr [bLHS-0Bh]
.text:004109FC		       movzx   siz, byte ptr [bRHS-0Bh]
.text:00410A00		       sub     esi, siz
.text:00410A02		       jz      short loc_410A17
.text:00410A04		       xor     siz, siz
.text:00410A06		       test    esi, esi
.text:00410A08		       setnle  al
.text:00410A0B		       lea     siz, [siz+siz-1]
.text:00410A0F		       test    siz, siz
.text:00410A11		       jnz     loc_410793
.text:00410A17
.text:00410A17 loc_410A17:			       ; CODE XREF: unaligned_memcmp+AADj
.text:00410A17		       movzx   esi, byte ptr [bLHS-0Ah]
.text:00410A1B		       movzx   siz, byte ptr [bRHS-0Ah]
.text:00410A1F		       sub     esi, siz
.text:00410A21		       jz      short loc_410A30
.text:00410A23		       xor     siz, siz
.text:00410A25		       test    esi, esi
.text:00410A27		       setnle  al
.text:00410A2A		       lea     siz, [siz+siz-1]
.text:00410A2E		       mov     esi, siz
.text:00410A30
.text:00410A30 loc_410A30:			       ; CODE XREF: unaligned_memcmp+ACCj
.text:00410A30		       mov     siz, esi
.text:00410A32		       jmp     short loc_410A36
.text:00410A34 ; ---------------------------------------------------------------------------
.text:00410A34
.text:00410A34 loc_410A34:			       ; CODE XREF: unaligned_memcmp+A64j
.text:00410A34		       xor     siz, siz
.text:00410A36
.text:00410A36 loc_410A36:			       ; CODE XREF: unaligned_memcmp+ADDj
.text:00410A36		       test    siz, siz
.text:00410A38		       jnz     loc_410793
.text:00410A3E
.text:00410A3E $LN1180:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410A3E					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410A3E		       mov     siz, [bLHS-9]   ; jumptable 004103D2 case 9
.text:00410A41		       cmp     siz, [bRHS-9]
.text:00410A44		       jz      short loc_410ABF
.text:00410A46		       movzx   esi, al
.text:00410A49		       movzx   siz, byte ptr [bRHS-9]
.text:00410A4D		       sub     esi, siz
.text:00410A4F		       jz      short loc_410A64
.text:00410A51		       xor     siz, siz
.text:00410A53		       test    esi, esi
.text:00410A55		       setnle  al
.text:00410A58		       lea     siz, [siz+siz-1]
.text:00410A5C		       test    siz, siz
.text:00410A5E		       jnz     loc_410793
.text:00410A64
.text:00410A64 loc_410A64:			       ; CODE XREF: unaligned_memcmp+AFAj
.text:00410A64		       movzx   esi, byte ptr [bLHS-8]
.text:00410A68		       movzx   siz, byte ptr [bRHS-8]
.text:00410A6C		       sub     esi, siz
.text:00410A6E		       jz      short loc_410A83
.text:00410A70		       xor     siz, siz
.text:00410A72		       test    esi, esi
.text:00410A74		       setnle  al
.text:00410A77		       lea     siz, [siz+siz-1]
.text:00410A7B		       test    siz, siz
.text:00410A7D		       jnz     loc_410793
.text:00410A83
.text:00410A83 loc_410A83:			       ; CODE XREF: unaligned_memcmp+B19j
.text:00410A83		       movzx   esi, byte ptr [bLHS-7]
.text:00410A87		       movzx   siz, byte ptr [bRHS-7]
.text:00410A8B		       sub     esi, siz
.text:00410A8D		       jz      short loc_410AA2
.text:00410A8F		       xor     siz, siz
.text:00410A91		       test    esi, esi
.text:00410A93		       setnle  al
.text:00410A96		       lea     siz, [siz+siz-1]
.text:00410A9A		       test    siz, siz
.text:00410A9C		       jnz     loc_410793
.text:00410AA2
.text:00410AA2 loc_410AA2:			       ; CODE XREF: unaligned_memcmp+B38j
.text:00410AA2		       movzx   esi, byte ptr [bLHS-6]
.text:00410AA6		       movzx   siz, byte ptr [bRHS-6]
.text:00410AAA		       sub     esi, siz
.text:00410AAC		       jz      short loc_410ABB
.text:00410AAE		       xor     siz, siz
.text:00410AB0		       test    esi, esi
.text:00410AB2		       setnle  al
.text:00410AB5		       lea     siz, [siz+siz-1]
.text:00410AB9		       mov     esi, siz
.text:00410ABB
.text:00410ABB loc_410ABB:			       ; CODE XREF: unaligned_memcmp+B57j
.text:00410ABB		       mov     siz, esi
.text:00410ABD		       jmp     short loc_410AC1
.text:00410ABF ; ---------------------------------------------------------------------------
.text:00410ABF
.text:00410ABF loc_410ABF:			       ; CODE XREF: unaligned_memcmp+AEFj
.text:00410ABF		       xor     siz, siz
.text:00410AC1
.text:00410AC1 loc_410AC1:			       ; CODE XREF: unaligned_memcmp+B68j
.text:00410AC1		       test    siz, siz
.text:00410AC3		       jnz     loc_410793
.text:00410AC9
.text:00410AC9 $LN1181:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410AC9					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410AC9		       mov     siz, [bLHS-5]   ; jumptable 004103D2 case 5
.text:00410ACC		       cmp     siz, [bRHS-5]
.text:00410ACF		       jz      short loc_410B4A
.text:00410AD1		       movzx   esi, al
.text:00410AD4		       movzx   siz, byte ptr [bRHS-5]
.text:00410AD8		       sub     esi, siz
.text:00410ADA		       jz      short loc_410AEF
.text:00410ADC		       xor     siz, siz
.text:00410ADE		       test    esi, esi
.text:00410AE0		       setnle  al
.text:00410AE3		       lea     siz, [siz+siz-1]
.text:00410AE7		       test    siz, siz
.text:00410AE9		       jnz     loc_410793
.text:00410AEF
.text:00410AEF loc_410AEF:			       ; CODE XREF: unaligned_memcmp+B85j
.text:00410AEF		       movzx   esi, byte ptr [bLHS-4]
.text:00410AF3		       movzx   siz, byte ptr [bRHS-4]
.text:00410AF7		       sub     esi, siz
.text:00410AF9		       jz      short loc_410B0E
.text:00410AFB		       xor     siz, siz
.text:00410AFD		       test    esi, esi
.text:00410AFF		       setnle  al
.text:00410B02		       lea     siz, [siz+siz-1]
.text:00410B06		       test    siz, siz
.text:00410B08		       jnz     loc_410793
.text:00410B0E
.text:00410B0E loc_410B0E:			       ; CODE XREF: unaligned_memcmp+BA4j
.text:00410B0E		       movzx   esi, byte ptr [bLHS-3]
.text:00410B12		       movzx   siz, byte ptr [bRHS-3]
.text:00410B16		       sub     esi, siz
.text:00410B18		       jz      short loc_410B2D
.text:00410B1A		       xor     siz, siz
.text:00410B1C		       test    esi, esi
.text:00410B1E		       setnle  al
.text:00410B21		       lea     siz, [siz+siz-1]
.text:00410B25		       test    siz, siz
.text:00410B27		       jnz     loc_410793
.text:00410B2D
.text:00410B2D loc_410B2D:			       ; CODE XREF: unaligned_memcmp+BC3j
.text:00410B2D		       movzx   esi, byte ptr [bLHS-2]
.text:00410B31		       movzx   siz, byte ptr [bRHS-2]
.text:00410B35		       sub     esi, siz
.text:00410B37		       jz      short loc_410B46
.text:00410B39		       xor     siz, siz
.text:00410B3B		       test    esi, esi
.text:00410B3D		       setnle  al
.text:00410B40		       lea     siz, [siz+siz-1]
.text:00410B44		       mov     esi, siz
.text:00410B46
.text:00410B46 loc_410B46:			       ; CODE XREF: unaligned_memcmp+BE2j
.text:00410B46		       mov     siz, esi
.text:00410B48		       jmp     short loc_410B4C
.text:00410B4A ; ---------------------------------------------------------------------------
.text:00410B4A
.text:00410B4A loc_410B4A:			       ; CODE XREF: unaligned_memcmp+B7Aj
.text:00410B4A		       xor     siz, siz
.text:00410B4C
.text:00410B4C loc_410B4C:			       ; CODE XREF: unaligned_memcmp+BF3j
.text:00410B4C					       ; unaligned_memcmp+140Aj
.text:00410B4C		       test    siz, siz
.text:00410B4E		       jnz     loc_410793
.text:00410B54
.text:00410B54 $LN1182:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410B54					       ; unaligned_memcmp+13F9j
.text:00410B54					       ; DATA XREF: ...
.text:00410B54		       movzx   siz, byte ptr [bLHS-1] ;	jumptable 004103D2 case	1
.text:00410B58		       movzx   bLHS, byte ptr [bRHS-1]
.text:00410B5C		       sub     siz, bLHS
.text:00410B5E		       jz      loc_410793
.text:00410B64		       xor     bLHS, bLHS
.text:00410B66		       test    siz, siz
.text:00410B68		       setnle  cl
.text:00410B6B		       lea     bLHS, [bLHS+bLHS-1]
.text:00410B6F		       mov     siz, bLHS
.text:00410B71		       jmp     loc_410793
.text:00410B76 ; ---------------------------------------------------------------------------
.text:00410B76
.text:00410B76 $LN30_0:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410B76					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410B76		       mov     siz, [bLHS-1Eh] ; jumptable 004103D2 case 30
.text:00410B79		       cmp     siz, [bRHS-1Eh]
.text:00410B7C		       jz      short loc_410BF7
.text:00410B7E		       movzx   esi, al
.text:00410B81		       movzx   siz, byte ptr [bRHS-1Eh]
.text:00410B85		       sub     esi, siz
.text:00410B87		       jz      short loc_410B9C
.text:00410B89		       xor     siz, siz
.text:00410B8B		       test    esi, esi
.text:00410B8D		       setnle  al
.text:00410B90		       lea     siz, [siz+siz-1]
.text:00410B94		       test    siz, siz
.text:00410B96		       jnz     loc_410793
.text:00410B9C
.text:00410B9C loc_410B9C:			       ; CODE XREF: unaligned_memcmp+C32j
.text:00410B9C		       movzx   esi, byte ptr [bLHS-1Dh]
.text:00410BA0		       movzx   siz, byte ptr [bRHS-1Dh]
.text:00410BA4		       sub     esi, siz
.text:00410BA6		       jz      short loc_410BBB
.text:00410BA8		       xor     siz, siz
.text:00410BAA		       test    esi, esi
.text:00410BAC		       setnle  al
.text:00410BAF		       lea     siz, [siz+siz-1]
.text:00410BB3		       test    siz, siz
.text:00410BB5		       jnz     loc_410793
.text:00410BBB
.text:00410BBB loc_410BBB:			       ; CODE XREF: unaligned_memcmp+C51j
.text:00410BBB		       movzx   esi, byte ptr [bLHS-1Ch]
.text:00410BBF		       movzx   siz, byte ptr [bRHS-1Ch]
.text:00410BC3		       sub     esi, siz
.text:00410BC5		       jz      short loc_410BDA
.text:00410BC7		       xor     siz, siz
.text:00410BC9		       test    esi, esi
.text:00410BCB		       setnle  al
.text:00410BCE		       lea     siz, [siz+siz-1]
.text:00410BD2		       test    siz, siz
.text:00410BD4		       jnz     loc_410793
.text:00410BDA
.text:00410BDA loc_410BDA:			       ; CODE XREF: unaligned_memcmp+C70j
.text:00410BDA		       movzx   esi, byte ptr [bLHS-1Bh]
.text:00410BDE		       movzx   siz, byte ptr [bRHS-1Bh]
.text:00410BE2		       sub     esi, siz
.text:00410BE4		       jz      short loc_410BF3
.text:00410BE6		       xor     siz, siz
.text:00410BE8		       test    esi, esi
.text:00410BEA		       setnle  al
.text:00410BED		       lea     siz, [siz+siz-1]
.text:00410BF1		       mov     esi, siz
.text:00410BF3
.text:00410BF3 loc_410BF3:			       ; CODE XREF: unaligned_memcmp+C8Fj
.text:00410BF3		       mov     siz, esi
.text:00410BF5		       jmp     short loc_410BF9
.text:00410BF7 ; ---------------------------------------------------------------------------
.text:00410BF7
.text:00410BF7 loc_410BF7:			       ; CODE XREF: unaligned_memcmp+C27j
.text:00410BF7		       xor     siz, siz
.text:00410BF9
.text:00410BF9 loc_410BF9:			       ; CODE XREF: unaligned_memcmp+CA0j
.text:00410BF9		       test    siz, siz
.text:00410BFB		       jnz     loc_410793
.text:00410C01
.text:00410C01 $LN1184:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410C01					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410C01		       mov     siz, [bLHS-1Ah] ; jumptable 004103D2 case 26
.text:00410C04		       cmp     siz, [bRHS-1Ah]
.text:00410C07		       jz      short loc_410C83
.text:00410C09		       movzx   siz, byte ptr [bRHS-1Ah]
.text:00410C0D		       movzx   esi, byte ptr [bLHS-1Ah]
.text:00410C11		       sub     esi, siz
.text:00410C13		       jz      short loc_410C28
.text:00410C15		       xor     siz, siz
.text:00410C17		       test    esi, esi
.text:00410C19		       setnle  al
.text:00410C1C		       lea     siz, [siz+siz-1]
.text:00410C20		       test    siz, siz
.text:00410C22		       jnz     loc_410793
.text:00410C28
.text:00410C28 loc_410C28:			       ; CODE XREF: unaligned_memcmp+CBEj
.text:00410C28		       movzx   esi, byte ptr [bLHS-19h]
.text:00410C2C		       movzx   siz, byte ptr [bRHS-19h]
.text:00410C30		       sub     esi, siz
.text:00410C32		       jz      short loc_410C47
.text:00410C34		       xor     siz, siz
.text:00410C36		       test    esi, esi
.text:00410C38		       setnle  al
.text:00410C3B		       lea     siz, [siz+siz-1]
.text:00410C3F		       test    siz, siz
.text:00410C41		       jnz     loc_410793
.text:00410C47
.text:00410C47 loc_410C47:			       ; CODE XREF: unaligned_memcmp+CDDj
.text:00410C47		       movzx   esi, byte ptr [bLHS-18h]
.text:00410C4B		       movzx   siz, byte ptr [bRHS-18h]
.text:00410C4F		       sub     esi, siz
.text:00410C51		       jz      short loc_410C66
.text:00410C53		       xor     siz, siz
.text:00410C55		       test    esi, esi
.text:00410C57		       setnle  al
.text:00410C5A		       lea     siz, [siz+siz-1]
.text:00410C5E		       test    siz, siz
.text:00410C60		       jnz     loc_410793
.text:00410C66
.text:00410C66 loc_410C66:			       ; CODE XREF: unaligned_memcmp+CFCj
.text:00410C66		       movzx   esi, byte ptr [bLHS-17h]
.text:00410C6A		       movzx   siz, byte ptr [bRHS-17h]
.text:00410C6E		       sub     esi, siz
.text:00410C70		       jz      short loc_410C7F
.text:00410C72		       xor     siz, siz
.text:00410C74		       test    esi, esi
.text:00410C76		       setnle  al
.text:00410C79		       lea     siz, [siz+siz-1]
.text:00410C7D		       mov     esi, siz
.text:00410C7F
.text:00410C7F loc_410C7F:			       ; CODE XREF: unaligned_memcmp+D1Bj
.text:00410C7F		       mov     siz, esi
.text:00410C81		       jmp     short loc_410C85
.text:00410C83 ; ---------------------------------------------------------------------------
.text:00410C83
.text:00410C83 loc_410C83:			       ; CODE XREF: unaligned_memcmp+CB2j
.text:00410C83		       xor     siz, siz
.text:00410C85
.text:00410C85 loc_410C85:			       ; CODE XREF: unaligned_memcmp+D2Cj
.text:00410C85		       test    siz, siz
.text:00410C87		       jnz     loc_410793
.text:00410C8D
.text:00410C8D $LN1185:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410C8D					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410C8D		       mov     siz, [bLHS-16h] ; jumptable 004103D2 case 22
.text:00410C90		       cmp     siz, [bRHS-16h]
.text:00410C93		       jz      short loc_410D0E
.text:00410C95		       movzx   esi, al
.text:00410C98		       movzx   siz, byte ptr [bRHS-16h]
.text:00410C9C		       sub     esi, siz
.text:00410C9E		       jz      short loc_410CB3
.text:00410CA0		       xor     siz, siz
.text:00410CA2		       test    esi, esi
.text:00410CA4		       setnle  al
.text:00410CA7		       lea     siz, [siz+siz-1]
.text:00410CAB		       test    siz, siz
.text:00410CAD		       jnz     loc_410793
.text:00410CB3
.text:00410CB3 loc_410CB3:			       ; CODE XREF: unaligned_memcmp+D49j
.text:00410CB3		       movzx   esi, byte ptr [bLHS-15h]
.text:00410CB7		       movzx   siz, byte ptr [bRHS-15h]
.text:00410CBB		       sub     esi, siz
.text:00410CBD		       jz      short loc_410CD2
.text:00410CBF		       xor     siz, siz
.text:00410CC1		       test    esi, esi
.text:00410CC3		       setnle  al
.text:00410CC6		       lea     siz, [siz+siz-1]
.text:00410CCA		       test    siz, siz
.text:00410CCC		       jnz     loc_410793
.text:00410CD2
.text:00410CD2 loc_410CD2:			       ; CODE XREF: unaligned_memcmp+D68j
.text:00410CD2		       movzx   esi, byte ptr [bLHS-14h]
.text:00410CD6		       movzx   siz, byte ptr [bRHS-14h]
.text:00410CDA		       sub     esi, siz
.text:00410CDC		       jz      short loc_410CF1
.text:00410CDE		       xor     siz, siz
.text:00410CE0		       test    esi, esi
.text:00410CE2		       setnle  al
.text:00410CE5		       lea     siz, [siz+siz-1]
.text:00410CE9		       test    siz, siz
.text:00410CEB		       jnz     loc_410793
.text:00410CF1
.text:00410CF1 loc_410CF1:			       ; CODE XREF: unaligned_memcmp+D87j
.text:00410CF1		       movzx   esi, byte ptr [bLHS-13h]
.text:00410CF5		       movzx   siz, byte ptr [bRHS-13h]
.text:00410CF9		       sub     esi, siz
.text:00410CFB		       jz      short loc_410D0A
.text:00410CFD		       xor     siz, siz
.text:00410CFF		       test    esi, esi
.text:00410D01		       setnle  al
.text:00410D04		       lea     siz, [siz+siz-1]
.text:00410D08		       mov     esi, siz
.text:00410D0A
.text:00410D0A loc_410D0A:			       ; CODE XREF: unaligned_memcmp+DA6j
.text:00410D0A		       mov     siz, esi
.text:00410D0C		       jmp     short loc_410D10
.text:00410D0E ; ---------------------------------------------------------------------------
.text:00410D0E
.text:00410D0E loc_410D0E:			       ; CODE XREF: unaligned_memcmp+D3Ej
.text:00410D0E		       xor     siz, siz
.text:00410D10
.text:00410D10 loc_410D10:			       ; CODE XREF: unaligned_memcmp+DB7j
.text:00410D10		       test    siz, siz
.text:00410D12		       jnz     loc_410793
.text:00410D18
.text:00410D18 $LN1186:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410D18					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410D18		       mov     siz, [bLHS-12h] ; jumptable 004103D2 case 18
.text:00410D1B		       cmp     siz, [bRHS-12h]
.text:00410D1E		       jz      short loc_410D99
.text:00410D20		       movzx   esi, al
.text:00410D23		       movzx   siz, byte ptr [bRHS-12h]
.text:00410D27		       sub     esi, siz
.text:00410D29		       jz      short loc_410D3E
.text:00410D2B		       xor     siz, siz
.text:00410D2D		       test    esi, esi
.text:00410D2F		       setnle  al
.text:00410D32		       lea     siz, [siz+siz-1]
.text:00410D36		       test    siz, siz
.text:00410D38		       jnz     loc_410793
.text:00410D3E
.text:00410D3E loc_410D3E:			       ; CODE XREF: unaligned_memcmp+DD4j
.text:00410D3E		       movzx   esi, byte ptr [bLHS-11h]
.text:00410D42		       movzx   siz, byte ptr [bRHS-11h]
.text:00410D46		       sub     esi, siz
.text:00410D48		       jz      short loc_410D5D
.text:00410D4A		       xor     siz, siz
.text:00410D4C		       test    esi, esi
.text:00410D4E		       setnle  al
.text:00410D51		       lea     siz, [siz+siz-1]
.text:00410D55		       test    siz, siz
.text:00410D57		       jnz     loc_410793
.text:00410D5D
.text:00410D5D loc_410D5D:			       ; CODE XREF: unaligned_memcmp+DF3j
.text:00410D5D		       movzx   esi, byte ptr [bLHS-10h]
.text:00410D61		       movzx   siz, byte ptr [bRHS-10h]
.text:00410D65		       sub     esi, siz
.text:00410D67		       jz      short loc_410D7C
.text:00410D69		       xor     siz, siz
.text:00410D6B		       test    esi, esi
.text:00410D6D		       setnle  al
.text:00410D70		       lea     siz, [siz+siz-1]
.text:00410D74		       test    siz, siz
.text:00410D76		       jnz     loc_410793
.text:00410D7C
.text:00410D7C loc_410D7C:			       ; CODE XREF: unaligned_memcmp+E12j
.text:00410D7C		       movzx   esi, byte ptr [bLHS-0Fh]
.text:00410D80		       movzx   siz, byte ptr [bRHS-0Fh]
.text:00410D84		       sub     esi, siz
.text:00410D86		       jz      short loc_410D95
.text:00410D88		       xor     siz, siz
.text:00410D8A		       test    esi, esi
.text:00410D8C		       setnle  al
.text:00410D8F		       lea     siz, [siz+siz-1]
.text:00410D93		       mov     esi, siz
.text:00410D95
.text:00410D95 loc_410D95:			       ; CODE XREF: unaligned_memcmp+E31j
.text:00410D95		       mov     siz, esi
.text:00410D97		       jmp     short loc_410D9B
.text:00410D99 ; ---------------------------------------------------------------------------
.text:00410D99
.text:00410D99 loc_410D99:			       ; CODE XREF: unaligned_memcmp+DC9j
.text:00410D99		       xor     siz, siz
.text:00410D9B
.text:00410D9B loc_410D9B:			       ; CODE XREF: unaligned_memcmp+E42j
.text:00410D9B		       test    siz, siz
.text:00410D9D		       jnz     loc_410793
.text:00410DA3
.text:00410DA3 $LN1187:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410DA3					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410DA3		       mov     siz, [bLHS-0Eh] ; jumptable 004103D2 case 14
.text:00410DA6		       cmp     siz, [bRHS-0Eh]
.text:00410DA9		       jz      short loc_410E24
.text:00410DAB		       movzx   esi, al
.text:00410DAE		       movzx   siz, byte ptr [bRHS-0Eh]
.text:00410DB2		       sub     esi, siz
.text:00410DB4		       jz      short loc_410DC9
.text:00410DB6		       xor     siz, siz
.text:00410DB8		       test    esi, esi
.text:00410DBA		       setnle  al
.text:00410DBD		       lea     siz, [siz+siz-1]
.text:00410DC1		       test    siz, siz
.text:00410DC3		       jnz     loc_410793
.text:00410DC9
.text:00410DC9 loc_410DC9:			       ; CODE XREF: unaligned_memcmp+E5Fj
.text:00410DC9		       movzx   esi, byte ptr [bLHS-0Dh]
.text:00410DCD		       movzx   siz, byte ptr [bRHS-0Dh]
.text:00410DD1		       sub     esi, siz
.text:00410DD3		       jz      short loc_410DE8
.text:00410DD5		       xor     siz, siz
.text:00410DD7		       test    esi, esi
.text:00410DD9		       setnle  al
.text:00410DDC		       lea     siz, [siz+siz-1]
.text:00410DE0		       test    siz, siz
.text:00410DE2		       jnz     loc_410793
.text:00410DE8
.text:00410DE8 loc_410DE8:			       ; CODE XREF: unaligned_memcmp+E7Ej
.text:00410DE8		       movzx   esi, byte ptr [bLHS-0Ch]
.text:00410DEC		       movzx   siz, byte ptr [bRHS-0Ch]
.text:00410DF0		       sub     esi, siz
.text:00410DF2		       jz      short loc_410E07
.text:00410DF4		       xor     siz, siz
.text:00410DF6		       test    esi, esi
.text:00410DF8		       setnle  al
.text:00410DFB		       lea     siz, [siz+siz-1]
.text:00410DFF		       test    siz, siz
.text:00410E01		       jnz     loc_410793
.text:00410E07
.text:00410E07 loc_410E07:			       ; CODE XREF: unaligned_memcmp+E9Dj
.text:00410E07		       movzx   esi, byte ptr [bLHS-0Bh]
.text:00410E0B		       movzx   siz, byte ptr [bRHS-0Bh]
.text:00410E0F		       sub     esi, siz
.text:00410E11		       jz      short loc_410E20
.text:00410E13		       xor     siz, siz
.text:00410E15		       test    esi, esi
.text:00410E17		       setnle  al
.text:00410E1A		       lea     siz, [siz+siz-1]
.text:00410E1E		       mov     esi, siz
.text:00410E20
.text:00410E20 loc_410E20:			       ; CODE XREF: unaligned_memcmp+EBCj
.text:00410E20		       mov     siz, esi
.text:00410E22		       jmp     short loc_410E26
.text:00410E24 ; ---------------------------------------------------------------------------
.text:00410E24
.text:00410E24 loc_410E24:			       ; CODE XREF: unaligned_memcmp+E54j
.text:00410E24		       xor     siz, siz
.text:00410E26
.text:00410E26 loc_410E26:			       ; CODE XREF: unaligned_memcmp+ECDj
.text:00410E26		       test    siz, siz
.text:00410E28		       jnz     loc_410793
.text:00410E2E
.text:00410E2E $LN1188:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410E2E					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410E2E		       mov     siz, [bLHS-0Ah] ; jumptable 004103D2 case 10
.text:00410E31		       cmp     siz, [bRHS-0Ah]
.text:00410E34		       jz      short loc_410EAF
.text:00410E36		       movzx   esi, al
.text:00410E39		       movzx   siz, byte ptr [bRHS-0Ah]
.text:00410E3D		       sub     esi, siz
.text:00410E3F		       jz      short loc_410E54
.text:00410E41		       xor     siz, siz
.text:00410E43		       test    esi, esi
.text:00410E45		       setnle  al
.text:00410E48		       lea     siz, [siz+siz-1]
.text:00410E4C		       test    siz, siz
.text:00410E4E		       jnz     loc_410793
.text:00410E54
.text:00410E54 loc_410E54:			       ; CODE XREF: unaligned_memcmp+EEAj
.text:00410E54		       movzx   esi, byte ptr [bLHS-9]
.text:00410E58		       movzx   siz, byte ptr [bRHS-9]
.text:00410E5C		       sub     esi, siz
.text:00410E5E		       jz      short loc_410E73
.text:00410E60		       xor     siz, siz
.text:00410E62		       test    esi, esi
.text:00410E64		       setnle  al
.text:00410E67		       lea     siz, [siz+siz-1]
.text:00410E6B		       test    siz, siz
.text:00410E6D		       jnz     loc_410793
.text:00410E73
.text:00410E73 loc_410E73:			       ; CODE XREF: unaligned_memcmp+F09j
.text:00410E73		       movzx   esi, byte ptr [bLHS-8]
.text:00410E77		       movzx   siz, byte ptr [bRHS-8]
.text:00410E7B		       sub     esi, siz
.text:00410E7D		       jz      short loc_410E92
.text:00410E7F		       xor     siz, siz
.text:00410E81		       test    esi, esi
.text:00410E83		       setnle  al
.text:00410E86		       lea     siz, [siz+siz-1]
.text:00410E8A		       test    siz, siz
.text:00410E8C		       jnz     loc_410793
.text:00410E92
.text:00410E92 loc_410E92:			       ; CODE XREF: unaligned_memcmp+F28j
.text:00410E92		       movzx   esi, byte ptr [bLHS-7]
.text:00410E96		       movzx   siz, byte ptr [bRHS-7]
.text:00410E9A		       sub     esi, siz
.text:00410E9C		       jz      short loc_410EAB
.text:00410E9E		       xor     siz, siz
.text:00410EA0		       test    esi, esi
.text:00410EA2		       setnle  al
.text:00410EA5		       lea     siz, [siz+siz-1]
.text:00410EA9		       mov     esi, siz
.text:00410EAB
.text:00410EAB loc_410EAB:			       ; CODE XREF: unaligned_memcmp+F47j
.text:00410EAB		       mov     siz, esi
.text:00410EAD		       jmp     short loc_410EB1
.text:00410EAF ; ---------------------------------------------------------------------------
.text:00410EAF
.text:00410EAF loc_410EAF:			       ; CODE XREF: unaligned_memcmp+EDFj
.text:00410EAF		       xor     siz, siz
.text:00410EB1
.text:00410EB1 loc_410EB1:			       ; CODE XREF: unaligned_memcmp+F58j
.text:00410EB1		       test    siz, siz
.text:00410EB3		       jnz     loc_410793
.text:00410EB9
.text:00410EB9 $LN1189:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410EB9					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410EB9		       mov     siz, [bLHS-6]   ; jumptable 004103D2 case 6
.text:00410EBC		       cmp     siz, [bRHS-6]
.text:00410EBF		       jz      short loc_410F3A
.text:00410EC1		       movzx   esi, al
.text:00410EC4		       movzx   siz, byte ptr [bRHS-6]
.text:00410EC8		       sub     esi, siz
.text:00410ECA		       jz      short loc_410EDF
.text:00410ECC		       xor     siz, siz
.text:00410ECE		       test    esi, esi
.text:00410ED0		       setnle  al
.text:00410ED3		       lea     siz, [siz+siz-1]
.text:00410ED7		       test    siz, siz
.text:00410ED9		       jnz     loc_410793
.text:00410EDF
.text:00410EDF loc_410EDF:			       ; CODE XREF: unaligned_memcmp+F75j
.text:00410EDF		       movzx   esi, byte ptr [bLHS-5]
.text:00410EE3		       movzx   siz, byte ptr [bRHS-5]
.text:00410EE7		       sub     esi, siz
.text:00410EE9		       jz      short loc_410EFE
.text:00410EEB		       xor     siz, siz
.text:00410EED		       test    esi, esi
.text:00410EEF		       setnle  al
.text:00410EF2		       lea     siz, [siz+siz-1]
.text:00410EF6		       test    siz, siz
.text:00410EF8		       jnz     loc_410793
.text:00410EFE
.text:00410EFE loc_410EFE:			       ; CODE XREF: unaligned_memcmp+F94j
.text:00410EFE		       movzx   esi, byte ptr [bLHS-4]
.text:00410F02		       movzx   siz, byte ptr [bRHS-4]
.text:00410F06		       sub     esi, siz
.text:00410F08		       jz      short loc_410F1D
.text:00410F0A		       xor     siz, siz
.text:00410F0C		       test    esi, esi
.text:00410F0E		       setnle  al
.text:00410F11		       lea     siz, [siz+siz-1]
.text:00410F15		       test    siz, siz
.text:00410F17		       jnz     loc_410793
.text:00410F1D
.text:00410F1D loc_410F1D:			       ; CODE XREF: unaligned_memcmp+FB3j
.text:00410F1D		       movzx   esi, byte ptr [bLHS-3]
.text:00410F21		       movzx   siz, byte ptr [bRHS-3]
.text:00410F25		       sub     esi, siz
.text:00410F27		       jz      short loc_410F36
.text:00410F29		       xor     siz, siz
.text:00410F2B		       test    esi, esi
.text:00410F2D		       setnle  al
.text:00410F30		       lea     siz, [siz+siz-1]
.text:00410F34		       mov     esi, siz
.text:00410F36
.text:00410F36 loc_410F36:			       ; CODE XREF: unaligned_memcmp+FD2j
.text:00410F36		       mov     siz, esi
.text:00410F38		       jmp     short loc_410F3C
.text:00410F3A ; ---------------------------------------------------------------------------
.text:00410F3A
.text:00410F3A loc_410F3A:			       ; CODE XREF: unaligned_memcmp+F6Aj
.text:00410F3A		       xor     siz, siz
.text:00410F3C
.text:00410F3C loc_410F3C:			       ; CODE XREF: unaligned_memcmp+FE3j
.text:00410F3C		       test    siz, siz
.text:00410F3E		       jnz     loc_410793
.text:00410F44
.text:00410F44 $LN1190:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410F44					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410F44		       mov     ax, [bLHS-2]    ; jumptable 004103D2 case 2
.text:00410F48		       cmp     ax, [bRHS-2]
.text:00410F4C		       jz      $LN61	       ; default
.text:00410F4C					       ; jumptable 004103D2 case 0
.text:00410F52		       jmp     loc_411344
.text:00410F57 ; ---------------------------------------------------------------------------
.text:00410F57
.text:00410F57 $LN15_5:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410F57					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410F57		       mov     siz, [bLHS-1Fh] ; jumptable 004103D2 case 31
.text:00410F5A		       cmp     siz, [bRHS-1Fh]
.text:00410F5D		       jz      short loc_410FD9
.text:00410F5F		       movzx   siz, byte ptr [bRHS-1Fh]
.text:00410F63		       movzx   esi, byte ptr [bLHS-1Fh]
.text:00410F67		       sub     esi, siz
.text:00410F69		       jz      short loc_410F7E
.text:00410F6B		       xor     siz, siz
.text:00410F6D		       test    esi, esi
.text:00410F6F		       setnle  al
.text:00410F72		       lea     siz, [siz+siz-1]
.text:00410F76		       test    siz, siz
.text:00410F78		       jnz     loc_410793
.text:00410F7E
.text:00410F7E loc_410F7E:			       ; CODE XREF: unaligned_memcmp+1014j
.text:00410F7E		       movzx   esi, byte ptr [bLHS-1Eh]
.text:00410F82		       movzx   siz, byte ptr [bRHS-1Eh]
.text:00410F86		       sub     esi, siz
.text:00410F88		       jz      short loc_410F9D
.text:00410F8A		       xor     siz, siz
.text:00410F8C		       test    esi, esi
.text:00410F8E		       setnle  al
.text:00410F91		       lea     siz, [siz+siz-1]
.text:00410F95		       test    siz, siz
.text:00410F97		       jnz     loc_410793
.text:00410F9D
.text:00410F9D loc_410F9D:			       ; CODE XREF: unaligned_memcmp+1033j
.text:00410F9D		       movzx   esi, byte ptr [bLHS-1Dh]
.text:00410FA1		       movzx   siz, byte ptr [bRHS-1Dh]
.text:00410FA5		       sub     esi, siz
.text:00410FA7		       jz      short loc_410FBC
.text:00410FA9		       xor     siz, siz
.text:00410FAB		       test    esi, esi
.text:00410FAD		       setnle  al
.text:00410FB0		       lea     siz, [siz+siz-1]
.text:00410FB4		       test    siz, siz
.text:00410FB6		       jnz     loc_410793
.text:00410FBC
.text:00410FBC loc_410FBC:			       ; CODE XREF: unaligned_memcmp+1052j
.text:00410FBC		       movzx   esi, byte ptr [bLHS-1Ch]
.text:00410FC0		       movzx   siz, byte ptr [bRHS-1Ch]
.text:00410FC4		       sub     esi, siz
.text:00410FC6		       jz      short loc_410FD5
.text:00410FC8		       xor     siz, siz
.text:00410FCA		       test    esi, esi
.text:00410FCC		       setnle  al
.text:00410FCF		       lea     siz, [siz+siz-1]
.text:00410FD3		       mov     esi, siz
.text:00410FD5
.text:00410FD5 loc_410FD5:			       ; CODE XREF: unaligned_memcmp+1071j
.text:00410FD5		       mov     siz, esi
.text:00410FD7		       jmp     short loc_410FDB
.text:00410FD9 ; ---------------------------------------------------------------------------
.text:00410FD9
.text:00410FD9 loc_410FD9:			       ; CODE XREF: unaligned_memcmp+1008j
.text:00410FD9		       xor     siz, siz
.text:00410FDB
.text:00410FDB loc_410FDB:			       ; CODE XREF: unaligned_memcmp+1082j
.text:00410FDB		       test    siz, siz
.text:00410FDD		       jnz     loc_410793
.text:00410FE3
.text:00410FE3 $LN1192:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00410FE3					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00410FE3		       mov     siz, [bLHS-1Bh] ; jumptable 004103D2 case 27
.text:00410FE6		       cmp     siz, [bRHS-1Bh]
.text:00410FE9		       jz      short loc_411064
.text:00410FEB		       movzx   esi, al
.text:00410FEE		       movzx   siz, byte ptr [bRHS-1Bh]
.text:00410FF2		       sub     esi, siz
.text:00410FF4		       jz      short loc_411009
.text:00410FF6		       xor     siz, siz
.text:00410FF8		       test    esi, esi
.text:00410FFA		       setnle  al
.text:00410FFD		       lea     siz, [siz+siz-1]
.text:00411001		       test    siz, siz
.text:00411003		       jnz     loc_410793
.text:00411009
.text:00411009 loc_411009:			       ; CODE XREF: unaligned_memcmp+109Fj
.text:00411009		       movzx   esi, byte ptr [bLHS-1Ah]
.text:0041100D		       movzx   siz, byte ptr [bRHS-1Ah]
.text:00411011		       sub     esi, siz
.text:00411013		       jz      short loc_411028
.text:00411015		       xor     siz, siz
.text:00411017		       test    esi, esi
.text:00411019		       setnle  al
.text:0041101C		       lea     siz, [siz+siz-1]
.text:00411020		       test    siz, siz
.text:00411022		       jnz     loc_410793
.text:00411028
.text:00411028 loc_411028:			       ; CODE XREF: unaligned_memcmp+10BEj
.text:00411028		       movzx   esi, byte ptr [bLHS-19h]
.text:0041102C		       movzx   siz, byte ptr [bRHS-19h]
.text:00411030		       sub     esi, siz
.text:00411032		       jz      short loc_411047
.text:00411034		       xor     siz, siz
.text:00411036		       test    esi, esi
.text:00411038		       setnle  al
.text:0041103B		       lea     siz, [siz+siz-1]
.text:0041103F		       test    siz, siz
.text:00411041		       jnz     loc_410793
.text:00411047
.text:00411047 loc_411047:			       ; CODE XREF: unaligned_memcmp+10DDj
.text:00411047		       movzx   esi, byte ptr [bLHS-18h]
.text:0041104B		       movzx   siz, byte ptr [bRHS-18h]
.text:0041104F		       sub     esi, siz
.text:00411051		       jz      short loc_411060
.text:00411053		       xor     siz, siz
.text:00411055		       test    esi, esi
.text:00411057		       setnle  al
.text:0041105A		       lea     siz, [siz+siz-1]
.text:0041105E		       mov     esi, siz
.text:00411060
.text:00411060 loc_411060:			       ; CODE XREF: unaligned_memcmp+10FCj
.text:00411060		       mov     siz, esi
.text:00411062		       jmp     short loc_411066
.text:00411064 ; ---------------------------------------------------------------------------
.text:00411064
.text:00411064 loc_411064:			       ; CODE XREF: unaligned_memcmp+1094j
.text:00411064		       xor     siz, siz
.text:00411066
.text:00411066 loc_411066:			       ; CODE XREF: unaligned_memcmp+110Dj
.text:00411066		       test    siz, siz
.text:00411068		       jnz     loc_410793
.text:0041106E
.text:0041106E $LN1193:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:0041106E					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:0041106E		       mov     siz, [bLHS-17h] ; jumptable 004103D2 case 23
.text:00411071		       cmp     siz, [bRHS-17h]
.text:00411074		       jz      short loc_4110EF
.text:00411076		       movzx   esi, al
.text:00411079		       movzx   siz, byte ptr [bRHS-17h]
.text:0041107D		       sub     esi, siz
.text:0041107F		       jz      short loc_411094
.text:00411081		       xor     siz, siz
.text:00411083		       test    esi, esi
.text:00411085		       setnle  al
.text:00411088		       lea     siz, [siz+siz-1]
.text:0041108C		       test    siz, siz
.text:0041108E		       jnz     loc_410793
.text:00411094
.text:00411094 loc_411094:			       ; CODE XREF: unaligned_memcmp+112Aj
.text:00411094		       movzx   esi, byte ptr [bLHS-16h]
.text:00411098		       movzx   siz, byte ptr [bRHS-16h]
.text:0041109C		       sub     esi, siz
.text:0041109E		       jz      short loc_4110B3
.text:004110A0		       xor     siz, siz
.text:004110A2		       test    esi, esi
.text:004110A4		       setnle  al
.text:004110A7		       lea     siz, [siz+siz-1]
.text:004110AB		       test    siz, siz
.text:004110AD		       jnz     loc_410793
.text:004110B3
.text:004110B3 loc_4110B3:			       ; CODE XREF: unaligned_memcmp+1149j
.text:004110B3		       movzx   esi, byte ptr [bLHS-15h]
.text:004110B7		       movzx   siz, byte ptr [bRHS-15h]
.text:004110BB		       sub     esi, siz
.text:004110BD		       jz      short loc_4110D2
.text:004110BF		       xor     siz, siz
.text:004110C1		       test    esi, esi
.text:004110C3		       setnle  al
.text:004110C6		       lea     siz, [siz+siz-1]
.text:004110CA		       test    siz, siz
.text:004110CC		       jnz     loc_410793
.text:004110D2
.text:004110D2 loc_4110D2:			       ; CODE XREF: unaligned_memcmp+1168j
.text:004110D2		       movzx   esi, byte ptr [bLHS-14h]
.text:004110D6		       movzx   siz, byte ptr [bRHS-14h]
.text:004110DA		       sub     esi, siz
.text:004110DC		       jz      short loc_4110EB
.text:004110DE		       xor     siz, siz
.text:004110E0		       test    esi, esi
.text:004110E2		       setnle  al
.text:004110E5		       lea     siz, [siz+siz-1]
.text:004110E9		       mov     esi, siz
.text:004110EB
.text:004110EB loc_4110EB:			       ; CODE XREF: unaligned_memcmp+1187j
.text:004110EB		       mov     siz, esi
.text:004110ED		       jmp     short loc_4110F1
.text:004110EF ; ---------------------------------------------------------------------------
.text:004110EF
.text:004110EF loc_4110EF:			       ; CODE XREF: unaligned_memcmp+111Fj
.text:004110EF		       xor     siz, siz
.text:004110F1
.text:004110F1 loc_4110F1:			       ; CODE XREF: unaligned_memcmp+1198j
.text:004110F1		       test    siz, siz
.text:004110F3		       jnz     loc_410793
.text:004110F9
.text:004110F9 $LN1194:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:004110F9					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:004110F9		       mov     siz, [bLHS-13h] ; jumptable 004103D2 case 19
.text:004110FC		       cmp     siz, [bRHS-13h]
.text:004110FF		       jz      short loc_41117A
.text:00411101		       movzx   esi, al
.text:00411104		       movzx   siz, byte ptr [bRHS-13h]
.text:00411108		       sub     esi, siz
.text:0041110A		       jz      short loc_41111F
.text:0041110C		       xor     siz, siz
.text:0041110E		       test    esi, esi
.text:00411110		       setnle  al
.text:00411113		       lea     siz, [siz+siz-1]
.text:00411117		       test    siz, siz
.text:00411119		       jnz     loc_410793
.text:0041111F
.text:0041111F loc_41111F:			       ; CODE XREF: unaligned_memcmp+11B5j
.text:0041111F		       movzx   esi, byte ptr [bLHS-12h]
.text:00411123		       movzx   siz, byte ptr [bRHS-12h]
.text:00411127		       sub     esi, siz
.text:00411129		       jz      short loc_41113E
.text:0041112B		       xor     siz, siz
.text:0041112D		       test    esi, esi
.text:0041112F		       setnle  al
.text:00411132		       lea     siz, [siz+siz-1]
.text:00411136		       test    siz, siz
.text:00411138		       jnz     loc_410793
.text:0041113E
.text:0041113E loc_41113E:			       ; CODE XREF: unaligned_memcmp+11D4j
.text:0041113E		       movzx   esi, byte ptr [bLHS-11h]
.text:00411142		       movzx   siz, byte ptr [bRHS-11h]
.text:00411146		       sub     esi, siz
.text:00411148		       jz      short loc_41115D
.text:0041114A		       xor     siz, siz
.text:0041114C		       test    esi, esi
.text:0041114E		       setnle  al
.text:00411151		       lea     siz, [siz+siz-1]
.text:00411155		       test    siz, siz
.text:00411157		       jnz     loc_410793
.text:0041115D
.text:0041115D loc_41115D:			       ; CODE XREF: unaligned_memcmp+11F3j
.text:0041115D		       movzx   esi, byte ptr [bLHS-10h]
.text:00411161		       movzx   siz, byte ptr [bRHS-10h]
.text:00411165		       sub     esi, siz
.text:00411167		       jz      short loc_411176
.text:00411169		       xor     siz, siz
.text:0041116B		       test    esi, esi
.text:0041116D		       setnle  al
.text:00411170		       lea     siz, [siz+siz-1]
.text:00411174		       mov     esi, siz
.text:00411176
.text:00411176 loc_411176:			       ; CODE XREF: unaligned_memcmp+1212j
.text:00411176		       mov     siz, esi
.text:00411178		       jmp     short loc_41117C
.text:0041117A ; ---------------------------------------------------------------------------
.text:0041117A
.text:0041117A loc_41117A:			       ; CODE XREF: unaligned_memcmp+11AAj
.text:0041117A		       xor     siz, siz
.text:0041117C
.text:0041117C loc_41117C:			       ; CODE XREF: unaligned_memcmp+1223j
.text:0041117C		       test    siz, siz
.text:0041117E		       jnz     loc_410793
.text:00411184
.text:00411184 $LN1195:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00411184					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00411184		       mov     siz, [bLHS-0Fh] ; jumptable 004103D2 case 15
.text:00411187		       cmp     siz, [bRHS-0Fh]
.text:0041118A		       jz      short loc_411205
.text:0041118C		       movzx   esi, al
.text:0041118F		       movzx   siz, byte ptr [bRHS-0Fh]
.text:00411193		       sub     esi, siz
.text:00411195		       jz      short loc_4111AA
.text:00411197		       xor     siz, siz
.text:00411199		       test    esi, esi
.text:0041119B		       setnle  al
.text:0041119E		       lea     siz, [siz+siz-1]
.text:004111A2		       test    siz, siz
.text:004111A4		       jnz     loc_410793
.text:004111AA
.text:004111AA loc_4111AA:			       ; CODE XREF: unaligned_memcmp+1240j
.text:004111AA		       movzx   esi, byte ptr [bLHS-0Eh]
.text:004111AE		       movzx   siz, byte ptr [bRHS-0Eh]
.text:004111B2		       sub     esi, siz
.text:004111B4		       jz      short loc_4111C9
.text:004111B6		       xor     siz, siz
.text:004111B8		       test    esi, esi
.text:004111BA		       setnle  al
.text:004111BD		       lea     siz, [siz+siz-1]
.text:004111C1		       test    siz, siz
.text:004111C3		       jnz     loc_410793
.text:004111C9
.text:004111C9 loc_4111C9:			       ; CODE XREF: unaligned_memcmp+125Fj
.text:004111C9		       movzx   esi, byte ptr [bLHS-0Dh]
.text:004111CD		       movzx   siz, byte ptr [bRHS-0Dh]
.text:004111D1		       sub     esi, siz
.text:004111D3		       jz      short loc_4111E8
.text:004111D5		       xor     siz, siz
.text:004111D7		       test    esi, esi
.text:004111D9		       setnle  al
.text:004111DC		       lea     siz, [siz+siz-1]
.text:004111E0		       test    siz, siz
.text:004111E2		       jnz     loc_410793
.text:004111E8
.text:004111E8 loc_4111E8:			       ; CODE XREF: unaligned_memcmp+127Ej
.text:004111E8		       movzx   esi, byte ptr [bLHS-0Ch]
.text:004111EC		       movzx   siz, byte ptr [bRHS-0Ch]
.text:004111F0		       sub     esi, siz
.text:004111F2		       jz      short loc_411201
.text:004111F4		       xor     siz, siz
.text:004111F6		       test    esi, esi
.text:004111F8		       setnle  al
.text:004111FB		       lea     siz, [siz+siz-1]
.text:004111FF		       mov     esi, siz
.text:00411201
.text:00411201 loc_411201:			       ; CODE XREF: unaligned_memcmp+129Dj
.text:00411201		       mov     siz, esi
.text:00411203		       jmp     short loc_411207
.text:00411205 ; ---------------------------------------------------------------------------
.text:00411205
.text:00411205 loc_411205:			       ; CODE XREF: unaligned_memcmp+1235j
.text:00411205		       xor     siz, siz
.text:00411207
.text:00411207 loc_411207:			       ; CODE XREF: unaligned_memcmp+12AEj
.text:00411207		       test    siz, siz
.text:00411209		       jnz     loc_410793
.text:0041120F
.text:0041120F $LN1196:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:0041120F					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:0041120F		       mov     siz, [bLHS-0Bh] ; jumptable 004103D2 case 11
.text:00411212		       cmp     siz, [bRHS-0Bh]
.text:00411215		       jz      short loc_411290
.text:00411217		       movzx   esi, al
.text:0041121A		       movzx   siz, byte ptr [bRHS-0Bh]
.text:0041121E		       sub     esi, siz
.text:00411220		       jz      short loc_411235
.text:00411222		       xor     siz, siz
.text:00411224		       test    esi, esi
.text:00411226		       setnle  al
.text:00411229		       lea     siz, [siz+siz-1]
.text:0041122D		       test    siz, siz
.text:0041122F		       jnz     loc_410793
.text:00411235
.text:00411235 loc_411235:			       ; CODE XREF: unaligned_memcmp+12CBj
.text:00411235		       movzx   esi, byte ptr [bLHS-0Ah]
.text:00411239		       movzx   siz, byte ptr [bRHS-0Ah]
.text:0041123D		       sub     esi, siz
.text:0041123F		       jz      short loc_411254
.text:00411241		       xor     siz, siz
.text:00411243		       test    esi, esi
.text:00411245		       setnle  al
.text:00411248		       lea     siz, [siz+siz-1]
.text:0041124C		       test    siz, siz
.text:0041124E		       jnz     loc_410793
.text:00411254
.text:00411254 loc_411254:			       ; CODE XREF: unaligned_memcmp+12EAj
.text:00411254		       movzx   esi, byte ptr [bLHS-9]
.text:00411258		       movzx   siz, byte ptr [bRHS-9]
.text:0041125C		       sub     esi, siz
.text:0041125E		       jz      short loc_411273
.text:00411260		       xor     siz, siz
.text:00411262		       test    esi, esi
.text:00411264		       setnle  al
.text:00411267		       lea     siz, [siz+siz-1]
.text:0041126B		       test    siz, siz
.text:0041126D		       jnz     loc_410793
.text:00411273
.text:00411273 loc_411273:			       ; CODE XREF: unaligned_memcmp+1309j
.text:00411273		       movzx   esi, byte ptr [bLHS-8]
.text:00411277		       movzx   siz, byte ptr [bRHS-8]
.text:0041127B		       sub     esi, siz
.text:0041127D		       jz      short loc_41128C
.text:0041127F		       xor     siz, siz
.text:00411281		       test    esi, esi
.text:00411283		       setnle  al
.text:00411286		       lea     siz, [siz+siz-1]
.text:0041128A		       mov     esi, siz
.text:0041128C
.text:0041128C loc_41128C:			       ; CODE XREF: unaligned_memcmp+1328j
.text:0041128C		       mov     siz, esi
.text:0041128E		       jmp     short loc_411292
.text:00411290 ; ---------------------------------------------------------------------------
.text:00411290
.text:00411290 loc_411290:			       ; CODE XREF: unaligned_memcmp+12C0j
.text:00411290		       xor     siz, siz
.text:00411292
.text:00411292 loc_411292:			       ; CODE XREF: unaligned_memcmp+1339j
.text:00411292		       test    siz, siz
.text:00411294		       jnz     loc_410793
.text:0041129A
.text:0041129A $LN1197:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:0041129A					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:0041129A		       mov     siz, [bLHS-7]   ; jumptable 004103D2 case 7
.text:0041129D		       cmp     siz, [bRHS-7]
.text:004112A0		       jz      short loc_41131B
.text:004112A2		       movzx   esi, al
.text:004112A5		       movzx   siz, byte ptr [bRHS-7]
.text:004112A9		       sub     esi, siz
.text:004112AB		       jz      short loc_4112C0
.text:004112AD		       xor     siz, siz
.text:004112AF		       test    esi, esi
.text:004112B1		       setnle  al
.text:004112B4		       lea     siz, [siz+siz-1]
.text:004112B8		       test    siz, siz
.text:004112BA		       jnz     loc_410793
.text:004112C0
.text:004112C0 loc_4112C0:			       ; CODE XREF: unaligned_memcmp+1356j
.text:004112C0		       movzx   esi, byte ptr [bLHS-6]
.text:004112C4		       movzx   siz, byte ptr [bRHS-6]
.text:004112C8		       sub     esi, siz
.text:004112CA		       jz      short loc_4112DF
.text:004112CC		       xor     siz, siz
.text:004112CE		       test    esi, esi
.text:004112D0		       setnle  al
.text:004112D3		       lea     siz, [siz+siz-1]
.text:004112D7		       test    siz, siz
.text:004112D9		       jnz     loc_410793
.text:004112DF
.text:004112DF loc_4112DF:			       ; CODE XREF: unaligned_memcmp+1375j
.text:004112DF		       movzx   esi, byte ptr [bLHS-5]
.text:004112E3		       movzx   siz, byte ptr [bRHS-5]
.text:004112E7		       sub     esi, siz
.text:004112E9		       jz      short loc_4112FE
.text:004112EB		       xor     siz, siz
.text:004112ED		       test    esi, esi
.text:004112EF		       setnle  al
.text:004112F2		       lea     siz, [siz+siz-1]
.text:004112F6		       test    siz, siz
.text:004112F8		       jnz     loc_410793
.text:004112FE
.text:004112FE loc_4112FE:			       ; CODE XREF: unaligned_memcmp+1394j
.text:004112FE		       movzx   esi, byte ptr [bLHS-4]
.text:00411302		       movzx   siz, byte ptr [bRHS-4]
.text:00411306		       sub     esi, siz
.text:00411308		       jz      short loc_411317
.text:0041130A		       xor     siz, siz
.text:0041130C		       test    esi, esi
.text:0041130E		       setnle  al
.text:00411311		       lea     siz, [siz+siz-1]
.text:00411315		       mov     esi, siz
.text:00411317
.text:00411317 loc_411317:			       ; CODE XREF: unaligned_memcmp+13B3j
.text:00411317		       mov     siz, esi
.text:00411319		       jmp     short loc_41131D
.text:0041131B ; ---------------------------------------------------------------------------
.text:0041131B
.text:0041131B loc_41131B:			       ; CODE XREF: unaligned_memcmp+134Bj
.text:0041131B		       xor     siz, siz
.text:0041131D
.text:0041131D loc_41131D:			       ; CODE XREF: unaligned_memcmp+13C4j
.text:0041131D		       test    siz, siz
.text:0041131F		       jnz     loc_410793
.text:00411325
.text:00411325 $LN1198:				       ; CODE XREF: unaligned_memcmp+47Dj
.text:00411325					       ; DATA XREF: unaligned_memcmp:off_411365o
.text:00411325		       movzx   esi, byte ptr [bLHS-3] ;	jumptable 004103D2 case	3
.text:00411329		       movzx   siz, byte ptr [bRHS-3]
.text:0041132D		       sub     esi, siz
.text:0041132F		       jz      short loc_411344
.text:00411331		       xor     siz, siz
.text:00411333		       test    esi, esi
.text:00411335		       setnle  al
.text:00411338		       lea     siz, [siz+siz-1]
.text:0041133C		       test    siz, siz
.text:0041133E		       jnz     loc_410793
.text:00411344
.text:00411344 loc_411344:			       ; CODE XREF: unaligned_memcmp+FFDj
.text:00411344					       ; unaligned_memcmp+13DAj
.text:00411344		       movzx   esi, byte ptr [bLHS-2]
.text:00411348		       movzx   siz, byte ptr [bRHS-2]
.text:0041134C		       sub     esi, siz
.text:0041134E		       jz      $LN1182	       ; jumptable 004103D2 case 1
.text:00411354		       xor     siz, siz
.text:00411356		       test    esi, esi
.text:00411358		       setnle  al
.text:0041135B		       lea     siz, [siz+siz-1]
.text:0041135F		       jmp     loc_410B4C
.text:0041135F ; ---------------------------------------------------------------------------
.text:00411364		       db 90h
.text:00411365 off_411365      dd offset $LN61	       ; DATA XREF: unaligned_memcmp+47Dr
.text:00411365		       dd offset $LN1182       ; jump table for	switch statement
.text:00411365		       dd offset $LN1190
.text:00411365		       dd offset $LN1198
.text:00411365		       dd offset $LN1174
.text:00411365		       dd offset $LN1181
.text:00411365		       dd offset $LN1189
.text:00411365		       dd offset $LN1197
.text:00411365		       dd offset $LN1173
.text:00411365		       dd offset $LN1180
.text:00411365		       dd offset $LN1188
.text:00411365		       dd offset $LN1196
.text:00411365		       dd offset $LN1172
.text:00411365		       dd offset $LN1179
.text:00411365		       dd offset $LN1187
.text:00411365		       dd offset $LN1195
.text:00411365		       dd offset $LN1171
.text:00411365		       dd offset $LN1178
.text:00411365		       dd offset $LN1186
.text:00411365		       dd offset $LN1194
.text:00411365		       dd offset $LN1170
.text:00411365		       dd offset $LN1177
.text:00411365		       dd offset $LN1185
.text:00411365		       dd offset $LN1193
.text:00411365		       dd offset $LN1169
.text:00411365		       dd offset $LN1176
.text:00411365		       dd offset $LN1184
.text:00411365		       dd offset $LN1192
.text:00411365		       dd offset $LN60
.text:00411365		       dd offset $LN45
.text:00411365		       dd offset $LN30_0
.text:00411365		       dd offset $LN15_5
.text:00411365 unaligned_memcmp	endp
.text:00411365
.text:004113E5
.text:004113E5 ; =============== S U B R O U T I N E =======================================
.text:004113E5
.text:004113E5 ; Attributes: bp-based frame
.text:004113E5
.text:004113E5 ; int __cdecl memcmp(const void *lhs, const void	*rhs, unsigned int siz)
.text:004113E5 _memcmp	       proc near	       ; CODE XREF: _setlocale_set_cat+21Bp
.text:004113E5
.text:004113E5 lhs	       = dword ptr  8
.text:004113E5 rhs	       = dword ptr  0Ch
.text:004113E5 siz	       = dword ptr  10h
.text:004113E5
.text:004113E5		       push    ebp
.text:004113E6		       mov     ebp, esp
.text:004113E8		       push    esi
.text:004113E9		       push    edi
.text:004113EA		       mov     edi, [ebp+siz]
.text:004113ED		       mov     eax, edi
.text:004113EF		       sub     eax, 0
.text:004113F2		       jz      loc_4129DD
.text:004113F8		       dec     eax
.text:004113F9		       jz      loc_4129CC
.text:004113FF		       dec     eax
.text:00411400		       jz      loc_41299E
.text:00411406		       dec     eax
.text:00411407		       jz      loc_412956
.text:0041140D		       dec     eax
.text:0041140E		       jz      loc_4128CD
.text:00411414		       mov     ecx, [ebp+rhs]
.text:00411417		       mov     eax, [ebp+lhs]
.text:0041141A		       push    ebx
.text:0041141B		       push    20h
.text:0041141D		       pop     edx
.text:0041141E		       jmp     loc_411895
.text:00411423 ; ---------------------------------------------------------------------------
.text:00411423
.text:00411423 loc_411423:			       ; CODE XREF: _memcmp+4B2j
.text:00411423		       mov     esi, [eax]
.text:00411425		       cmp     esi, [ecx]
.text:00411427		       jz      short loc_4114A5
.text:00411429		       movzx   esi, byte ptr [eax]
.text:0041142C		       movzx   ebx, byte ptr [ecx]
.text:0041142F		       sub     esi, ebx
.text:00411431		       jz      short loc_411448
.text:00411433		       xor     ebx, ebx
.text:00411435		       test    esi, esi
.text:00411437		       setnle  bl
.text:0041143A		       lea     ebx, [ebx+ebx-1]
.text:0041143E		       mov     esi, ebx
.text:00411440		       test    esi, esi
.text:00411442		       jnz     loc_4118B1
.text:00411448
.text:00411448 loc_411448:			       ; CODE XREF: _memcmp+4Cj
.text:00411448		       movzx   esi, byte ptr [eax+1]
.text:0041144C		       movzx   ebx, byte ptr [ecx+1]
.text:00411450		       sub     esi, ebx
.text:00411452		       jz      short loc_411469
.text:00411454		       xor     ebx, ebx
.text:00411456		       test    esi, esi
.text:00411458		       setnle  bl
.text:0041145B		       lea     ebx, [ebx+ebx-1]
.text:0041145F		       mov     esi, ebx
.text:00411461		       test    esi, esi
.text:00411463		       jnz     loc_4118B1
.text:00411469
.text:00411469 loc_411469:			       ; CODE XREF: _memcmp+6Dj
.text:00411469		       movzx   esi, byte ptr [eax+2]
.text:0041146D		       movzx   ebx, byte ptr [ecx+2]
.text:00411471		       sub     esi, ebx
.text:00411473		       jz      short loc_41148A
.text:00411475		       xor     ebx, ebx
.text:00411477		       test    esi, esi
.text:00411479		       setnle  bl
.text:0041147C		       lea     ebx, [ebx+ebx-1]
.text:00411480		       mov     esi, ebx
.text:00411482		       test    esi, esi
.text:00411484		       jnz     loc_4118B1
.text:0041148A
.text:0041148A loc_41148A:			       ; CODE XREF: _memcmp+8Ej
.text:0041148A		       movzx   esi, byte ptr [eax+3]
.text:0041148E		       movzx   ebx, byte ptr [ecx+3]
.text:00411492		       sub     esi, ebx
.text:00411494		       jz      short loc_4114A7
.text:00411496		       xor     ebx, ebx
.text:00411498		       test    esi, esi
.text:0041149A		       setnle  bl
.text:0041149D		       lea     ebx, [ebx+ebx-1]
.text:004114A1		       mov     esi, ebx
.text:004114A3		       jmp     short loc_4114A7
.text:004114A5 ; ---------------------------------------------------------------------------
.text:004114A5
.text:004114A5 loc_4114A5:			       ; CODE XREF: _memcmp+42j
.text:004114A5		       xor     esi, esi
.text:004114A7
.text:004114A7 loc_4114A7:			       ; CODE XREF: _memcmp+AFj
.text:004114A7					       ; _memcmp+BEj
.text:004114A7		       test    esi, esi
.text:004114A9		       jnz     loc_4118B1
.text:004114AF		       mov     esi, [eax+4]
.text:004114B2		       cmp     esi, [ecx+4]
.text:004114B5		       jz      short loc_411535
.text:004114B7		       movzx   esi, byte ptr [eax+4]
.text:004114BB		       movzx   ebx, byte ptr [ecx+4]
.text:004114BF		       sub     esi, ebx
.text:004114C1		       jz      short loc_4114D8
.text:004114C3		       xor     ebx, ebx
.text:004114C5		       test    esi, esi
.text:004114C7		       setnle  bl
.text:004114CA		       lea     ebx, [ebx+ebx-1]
.text:004114CE		       mov     esi, ebx
.text:004114D0		       test    esi, esi
.text:004114D2		       jnz     loc_4118B1
.text:004114D8
.text:004114D8 loc_4114D8:			       ; CODE XREF: _memcmp+DCj
.text:004114D8		       movzx   esi, byte ptr [eax+5]
.text:004114DC		       movzx   ebx, byte ptr [ecx+5]
.text:004114E0		       sub     esi, ebx
.text:004114E2		       jz      short loc_4114F9
.text:004114E4		       xor     ebx, ebx
.text:004114E6		       test    esi, esi
.text:004114E8		       setnle  bl
.text:004114EB		       lea     ebx, [ebx+ebx-1]
.text:004114EF		       mov     esi, ebx
.text:004114F1		       test    esi, esi
.text:004114F3		       jnz     loc_4118B1
.text:004114F9
.text:004114F9 loc_4114F9:			       ; CODE XREF: _memcmp+FDj
.text:004114F9		       movzx   esi, byte ptr [eax+6]
.text:004114FD		       movzx   ebx, byte ptr [ecx+6]
.text:00411501		       sub     esi, ebx
.text:00411503		       jz      short loc_41151A
.text:00411505		       xor     ebx, ebx
.text:00411507		       test    esi, esi
.text:00411509		       setnle  bl
.text:0041150C		       lea     ebx, [ebx+ebx-1]
.text:00411510		       mov     esi, ebx
.text:00411512		       test    esi, esi
.text:00411514		       jnz     loc_4118B1
.text:0041151A
.text:0041151A loc_41151A:			       ; CODE XREF: _memcmp+11Ej
.text:0041151A		       movzx   esi, byte ptr [eax+7]
.text:0041151E		       movzx   ebx, byte ptr [ecx+7]
.text:00411522		       sub     esi, ebx
.text:00411524		       jz      short loc_411537
.text:00411526		       xor     ebx, ebx
.text:00411528		       test    esi, esi
.text:0041152A		       setnle  bl
.text:0041152D		       lea     ebx, [ebx+ebx-1]
.text:00411531		       mov     esi, ebx
.text:00411533		       jmp     short loc_411537
.text:00411535 ; ---------------------------------------------------------------------------
.text:00411535
.text:00411535 loc_411535:			       ; CODE XREF: _memcmp+D0j
.text:00411535		       xor     esi, esi
.text:00411537
.text:00411537 loc_411537:			       ; CODE XREF: _memcmp+13Fj
.text:00411537					       ; _memcmp+14Ej
.text:00411537		       test    esi, esi
.text:00411539		       jnz     loc_4118B1
.text:0041153F		       mov     esi, [eax+8]
.text:00411542		       cmp     esi, [ecx+8]
.text:00411545		       jz      short loc_4115C5
.text:00411547		       movzx   esi, byte ptr [eax+8]
.text:0041154B		       movzx   ebx, byte ptr [ecx+8]
.text:0041154F		       sub     esi, ebx
.text:00411551		       jz      short loc_411568
.text:00411553		       xor     ebx, ebx
.text:00411555		       test    esi, esi
.text:00411557		       setnle  bl
.text:0041155A		       lea     ebx, [ebx+ebx-1]
.text:0041155E		       mov     esi, ebx
.text:00411560		       test    esi, esi
.text:00411562		       jnz     loc_4118B1
.text:00411568
.text:00411568 loc_411568:			       ; CODE XREF: _memcmp+16Cj
.text:00411568		       movzx   esi, byte ptr [eax+9]
.text:0041156C		       movzx   ebx, byte ptr [ecx+9]
.text:00411570		       sub     esi, ebx
.text:00411572		       jz      short loc_411589
.text:00411574		       xor     ebx, ebx
.text:00411576		       test    esi, esi
.text:00411578		       setnle  bl
.text:0041157B		       lea     ebx, [ebx+ebx-1]
.text:0041157F		       mov     esi, ebx
.text:00411581		       test    esi, esi
.text:00411583		       jnz     loc_4118B1
.text:00411589
.text:00411589 loc_411589:			       ; CODE XREF: _memcmp+18Dj
.text:00411589		       movzx   esi, byte ptr [eax+0Ah]
.text:0041158D		       movzx   ebx, byte ptr [ecx+0Ah]
.text:00411591		       sub     esi, ebx
.text:00411593		       jz      short loc_4115AA
.text:00411595		       xor     ebx, ebx
.text:00411597		       test    esi, esi
.text:00411599		       setnle  bl
.text:0041159C		       lea     ebx, [ebx+ebx-1]
.text:004115A0		       mov     esi, ebx
.text:004115A2		       test    esi, esi
.text:004115A4		       jnz     loc_4118B1
.text:004115AA
.text:004115AA loc_4115AA:			       ; CODE XREF: _memcmp+1AEj
.text:004115AA		       movzx   esi, byte ptr [eax+0Bh]
.text:004115AE		       movzx   ebx, byte ptr [ecx+0Bh]
.text:004115B2		       sub     esi, ebx
.text:004115B4		       jz      short loc_4115C7
.text:004115B6		       xor     ebx, ebx
.text:004115B8		       test    esi, esi
.text:004115BA		       setnle  bl
.text:004115BD		       lea     ebx, [ebx+ebx-1]
.text:004115C1		       mov     esi, ebx
.text:004115C3		       jmp     short loc_4115C7
.text:004115C5 ; ---------------------------------------------------------------------------
.text:004115C5
.text:004115C5 loc_4115C5:			       ; CODE XREF: _memcmp+160j
.text:004115C5		       xor     esi, esi
.text:004115C7
.text:004115C7 loc_4115C7:			       ; CODE XREF: _memcmp+1CFj
.text:004115C7					       ; _memcmp+1DEj
.text:004115C7		       test    esi, esi
.text:004115C9		       jnz     loc_4118B1
.text:004115CF		       mov     esi, [eax+0Ch]
.text:004115D2		       cmp     esi, [ecx+0Ch]
.text:004115D5		       jz      short loc_411655
.text:004115D7		       movzx   esi, byte ptr [eax+0Ch]
.text:004115DB		       movzx   ebx, byte ptr [ecx+0Ch]
.text:004115DF		       sub     esi, ebx
.text:004115E1		       jz      short loc_4115F8
.text:004115E3		       xor     ebx, ebx
.text:004115E5		       test    esi, esi
.text:004115E7		       setnle  bl
.text:004115EA		       lea     ebx, [ebx+ebx-1]
.text:004115EE		       mov     esi, ebx
.text:004115F0		       test    esi, esi
.text:004115F2		       jnz     loc_4118B1
.text:004115F8
.text:004115F8 loc_4115F8:			       ; CODE XREF: _memcmp+1FCj
.text:004115F8		       movzx   esi, byte ptr [eax+0Dh]
.text:004115FC		       movzx   ebx, byte ptr [ecx+0Dh]
.text:00411600		       sub     esi, ebx
.text:00411602		       jz      short loc_411619
.text:00411604		       xor     ebx, ebx
.text:00411606		       test    esi, esi
.text:00411608		       setnle  bl
.text:0041160B		       lea     ebx, [ebx+ebx-1]
.text:0041160F		       mov     esi, ebx
.text:00411611		       test    esi, esi
.text:00411613		       jnz     loc_4118B1
.text:00411619
.text:00411619 loc_411619:			       ; CODE XREF: _memcmp+21Dj
.text:00411619		       movzx   esi, byte ptr [eax+0Eh]
.text:0041161D		       movzx   ebx, byte ptr [ecx+0Eh]
.text:00411621		       sub     esi, ebx
.text:00411623		       jz      short loc_41163A
.text:00411625		       xor     ebx, ebx
.text:00411627		       test    esi, esi
.text:00411629		       setnle  bl
.text:0041162C		       lea     ebx, [ebx+ebx-1]
.text:00411630		       mov     esi, ebx
.text:00411632		       test    esi, esi
.text:00411634		       jnz     loc_4118B1
.text:0041163A
.text:0041163A loc_41163A:			       ; CODE XREF: _memcmp+23Ej
.text:0041163A		       movzx   esi, byte ptr [eax+0Fh]
.text:0041163E		       movzx   ebx, byte ptr [ecx+0Fh]
.text:00411642		       sub     esi, ebx
.text:00411644		       jz      short loc_411657
.text:00411646		       xor     ebx, ebx
.text:00411648		       test    esi, esi
.text:0041164A		       setnle  bl
.text:0041164D		       lea     ebx, [ebx+ebx-1]
.text:00411651		       mov     esi, ebx
.text:00411653		       jmp     short loc_411657
.text:00411655 ; ---------------------------------------------------------------------------
.text:00411655
.text:00411655 loc_411655:			       ; CODE XREF: _memcmp+1F0j
.text:00411655		       xor     esi, esi
.text:00411657
.text:00411657 loc_411657:			       ; CODE XREF: _memcmp+25Fj
.text:00411657					       ; _memcmp+26Ej
.text:00411657		       test    esi, esi
.text:00411659		       jnz     loc_4118B1
.text:0041165F		       mov     esi, [eax+10h]
.text:00411662		       cmp     esi, [ecx+10h]
.text:00411665		       jz      short loc_4116E5
.text:00411667		       movzx   ebx, byte ptr [ecx+10h]
.text:0041166B		       movzx   esi, byte ptr [eax+10h]
.text:0041166F		       sub     esi, ebx
.text:00411671		       jz      short loc_411688
.text:00411673		       xor     ebx, ebx
.text:00411675		       test    esi, esi
.text:00411677		       setnle  bl
.text:0041167A		       lea     ebx, [ebx+ebx-1]
.text:0041167E		       mov     esi, ebx
.text:00411680		       test    esi, esi
.text:00411682		       jnz     loc_4118B1
.text:00411688
.text:00411688 loc_411688:			       ; CODE XREF: _memcmp+28Cj
.text:00411688		       movzx   esi, byte ptr [eax+11h]
.text:0041168C		       movzx   ebx, byte ptr [ecx+11h]
.text:00411690		       sub     esi, ebx
.text:00411692		       jz      short loc_4116A9
.text:00411694		       xor     ebx, ebx
.text:00411696		       test    esi, esi
.text:00411698		       setnle  bl
.text:0041169B		       lea     ebx, [ebx+ebx-1]
.text:0041169F		       mov     esi, ebx
.text:004116A1		       test    esi, esi
.text:004116A3		       jnz     loc_4118B1
.text:004116A9
.text:004116A9 loc_4116A9:			       ; CODE XREF: _memcmp+2ADj
.text:004116A9		       movzx   esi, byte ptr [eax+12h]
.text:004116AD		       movzx   ebx, byte ptr [ecx+12h]
.text:004116B1		       sub     esi, ebx
.text:004116B3		       jz      short loc_4116CA
.text:004116B5		       xor     ebx, ebx
.text:004116B7		       test    esi, esi
.text:004116B9		       setnle  bl
.text:004116BC		       lea     ebx, [ebx+ebx-1]
.text:004116C0		       mov     esi, ebx
.text:004116C2		       test    esi, esi
.text:004116C4		       jnz     loc_4118B1
.text:004116CA
.text:004116CA loc_4116CA:			       ; CODE XREF: _memcmp+2CEj
.text:004116CA		       movzx   esi, byte ptr [eax+13h]
.text:004116CE		       movzx   ebx, byte ptr [ecx+13h]
.text:004116D2		       sub     esi, ebx
.text:004116D4		       jz      short loc_4116E7
.text:004116D6		       xor     ebx, ebx
.text:004116D8		       test    esi, esi
.text:004116DA		       setnle  bl
.text:004116DD		       lea     ebx, [ebx+ebx-1]
.text:004116E1		       mov     esi, ebx
.text:004116E3		       jmp     short loc_4116E7
.text:004116E5 ; ---------------------------------------------------------------------------
.text:004116E5
.text:004116E5 loc_4116E5:			       ; CODE XREF: _memcmp+280j
.text:004116E5		       xor     esi, esi
.text:004116E7
.text:004116E7 loc_4116E7:			       ; CODE XREF: _memcmp+2EFj
.text:004116E7					       ; _memcmp+2FEj
.text:004116E7		       test    esi, esi
.text:004116E9		       jnz     loc_4118B1
.text:004116EF		       mov     esi, [eax+14h]
.text:004116F2		       cmp     esi, [ecx+14h]
.text:004116F5		       jz      short loc_411775
.text:004116F7		       movzx   esi, byte ptr [eax+14h]
.text:004116FB		       movzx   ebx, byte ptr [ecx+14h]
.text:004116FF		       sub     esi, ebx
.text:00411701		       jz      short loc_411718
.text:00411703		       xor     ebx, ebx
.text:00411705		       test    esi, esi
.text:00411707		       setnle  bl
.text:0041170A		       lea     ebx, [ebx+ebx-1]
.text:0041170E		       mov     esi, ebx
.text:00411710		       test    esi, esi
.text:00411712		       jnz     loc_4118B1
.text:00411718
.text:00411718 loc_411718:			       ; CODE XREF: _memcmp+31Cj
.text:00411718		       movzx   esi, byte ptr [eax+15h]
.text:0041171C		       movzx   ebx, byte ptr [ecx+15h]
.text:00411720		       sub     esi, ebx
.text:00411722		       jz      short loc_411739
.text:00411724		       xor     ebx, ebx
.text:00411726		       test    esi, esi
.text:00411728		       setnle  bl
.text:0041172B		       lea     ebx, [ebx+ebx-1]
.text:0041172F		       mov     esi, ebx
.text:00411731		       test    esi, esi
.text:00411733		       jnz     loc_4118B1
.text:00411739
.text:00411739 loc_411739:			       ; CODE XREF: _memcmp+33Dj
.text:00411739		       movzx   esi, byte ptr [eax+16h]
.text:0041173D		       movzx   ebx, byte ptr [ecx+16h]
.text:00411741		       sub     esi, ebx
.text:00411743		       jz      short loc_41175A
.text:00411745		       xor     ebx, ebx
.text:00411747		       test    esi, esi
.text:00411749		       setnle  bl
.text:0041174C		       lea     ebx, [ebx+ebx-1]
.text:00411750		       mov     esi, ebx
.text:00411752		       test    esi, esi
.text:00411754		       jnz     loc_4118B1
.text:0041175A
.text:0041175A loc_41175A:			       ; CODE XREF: _memcmp+35Ej
.text:0041175A		       movzx   esi, byte ptr [eax+17h]
.text:0041175E		       movzx   ebx, byte ptr [ecx+17h]
.text:00411762		       sub     esi, ebx
.text:00411764		       jz      short loc_411777
.text:00411766		       xor     ebx, ebx
.text:00411768		       test    esi, esi
.text:0041176A		       setnle  bl
.text:0041176D		       lea     ebx, [ebx+ebx-1]
.text:00411771		       mov     esi, ebx
.text:00411773		       jmp     short loc_411777
.text:00411775 ; ---------------------------------------------------------------------------
.text:00411775
.text:00411775 loc_411775:			       ; CODE XREF: _memcmp+310j
.text:00411775		       xor     esi, esi
.text:00411777
.text:00411777 loc_411777:			       ; CODE XREF: _memcmp+37Fj
.text:00411777					       ; _memcmp+38Ej
.text:00411777		       test    esi, esi
.text:00411779		       jnz     loc_4118B1
.text:0041177F		       mov     esi, [eax+18h]
.text:00411782		       cmp     esi, [ecx+18h]
.text:00411785		       jz      short loc_411805
.text:00411787		       movzx   esi, byte ptr [eax+18h]
.text:0041178B		       movzx   ebx, byte ptr [ecx+18h]
.text:0041178F		       sub     esi, ebx
.text:00411791		       jz      short loc_4117A8
.text:00411793		       xor     ebx, ebx
.text:00411795		       test    esi, esi
.text:00411797		       setnle  bl
.text:0041179A		       lea     ebx, [ebx+ebx-1]
.text:0041179E		       mov     esi, ebx
.text:004117A0		       test    esi, esi
.text:004117A2		       jnz     loc_4118B1
.text:004117A8
.text:004117A8 loc_4117A8:			       ; CODE XREF: _memcmp+3ACj
.text:004117A8		       movzx   esi, byte ptr [eax+19h]
.text:004117AC		       movzx   ebx, byte ptr [ecx+19h]
.text:004117B0		       sub     esi, ebx
.text:004117B2		       jz      short loc_4117C9
.text:004117B4		       xor     ebx, ebx
.text:004117B6		       test    esi, esi
.text:004117B8		       setnle  bl
.text:004117BB		       lea     ebx, [ebx+ebx-1]
.text:004117BF		       mov     esi, ebx
.text:004117C1		       test    esi, esi
.text:004117C3		       jnz     loc_4118B1
.text:004117C9
.text:004117C9 loc_4117C9:			       ; CODE XREF: _memcmp+3CDj
.text:004117C9		       movzx   esi, byte ptr [eax+1Ah]
.text:004117CD		       movzx   ebx, byte ptr [ecx+1Ah]
.text:004117D1		       sub     esi, ebx
.text:004117D3		       jz      short loc_4117EA
.text:004117D5		       xor     ebx, ebx
.text:004117D7		       test    esi, esi
.text:004117D9		       setnle  bl
.text:004117DC		       lea     ebx, [ebx+ebx-1]
.text:004117E0		       mov     esi, ebx
.text:004117E2		       test    esi, esi
.text:004117E4		       jnz     loc_4118B1
.text:004117EA
.text:004117EA loc_4117EA:			       ; CODE XREF: _memcmp+3EEj
.text:004117EA		       movzx   esi, byte ptr [eax+1Bh]
.text:004117EE		       movzx   ebx, byte ptr [ecx+1Bh]
.text:004117F2		       sub     esi, ebx
.text:004117F4		       jz      short loc_411807
.text:004117F6		       xor     ebx, ebx
.text:004117F8		       test    esi, esi
.text:004117FA		       setnle  bl
.text:004117FD		       lea     ebx, [ebx+ebx-1]
.text:00411801		       mov     esi, ebx
.text:00411803		       jmp     short loc_411807
.text:00411805 ; ---------------------------------------------------------------------------
.text:00411805
.text:00411805 loc_411805:			       ; CODE XREF: _memcmp+3A0j
.text:00411805		       xor     esi, esi
.text:00411807
.text:00411807 loc_411807:			       ; CODE XREF: _memcmp+40Fj
.text:00411807					       ; _memcmp+41Ej
.text:00411807		       test    esi, esi
.text:00411809		       jnz     loc_4118B1
.text:0041180F		       mov     esi, [eax+1Ch]
.text:00411812		       cmp     esi, [ecx+1Ch]
.text:00411815		       jz      short loc_411889
.text:00411817		       movzx   esi, byte ptr [eax+1Ch]
.text:0041181B		       movzx   ebx, byte ptr [ecx+1Ch]
.text:0041181F		       sub     esi, ebx
.text:00411821		       jz      short loc_411834
.text:00411823		       xor     ebx, ebx
.text:00411825		       test    esi, esi
.text:00411827		       setnle  bl
.text:0041182A		       lea     ebx, [ebx+ebx-1]
.text:0041182E		       mov     esi, ebx
.text:00411830		       test    esi, esi
.text:00411832		       jnz     short loc_4118B1
.text:00411834
.text:00411834 loc_411834:			       ; CODE XREF: _memcmp+43Cj
.text:00411834		       movzx   esi, byte ptr [eax+1Dh]
.text:00411838		       movzx   ebx, byte ptr [ecx+1Dh]
.text:0041183C		       sub     esi, ebx
.text:0041183E		       jz      short loc_411851
.text:00411840		       xor     ebx, ebx
.text:00411842		       test    esi, esi
.text:00411844		       setnle  bl
.text:00411847		       lea     ebx, [ebx+ebx-1]
.text:0041184B		       mov     esi, ebx
.text:0041184D		       test    esi, esi
.text:0041184F		       jnz     short loc_4118B1
.text:00411851
.text:00411851 loc_411851:			       ; CODE XREF: _memcmp+459j
.text:00411851		       movzx   esi, byte ptr [eax+1Eh]
.text:00411855		       movzx   ebx, byte ptr [ecx+1Eh]
.text:00411859		       sub     esi, ebx
.text:0041185B		       jz      short loc_41186E
.text:0041185D		       xor     ebx, ebx
.text:0041185F		       test    esi, esi
.text:00411861		       setnle  bl
.text:00411864		       lea     ebx, [ebx+ebx-1]
.text:00411868		       mov     esi, ebx
.text:0041186A		       test    esi, esi
.text:0041186C		       jnz     short loc_4118B1
.text:0041186E
.text:0041186E loc_41186E:			       ; CODE XREF: _memcmp+476j
.text:0041186E		       movzx   esi, byte ptr [eax+1Fh]
.text:00411872		       movzx   ebx, byte ptr [ecx+1Fh]
.text:00411876		       sub     esi, ebx
.text:00411878		       jz      short loc_41188B
.text:0041187A		       xor     ebx, ebx
.text:0041187C		       test    esi, esi
.text:0041187E		       setnle  bl
.text:00411881		       lea     ebx, [ebx+ebx-1]
.text:00411885		       mov     esi, ebx
.text:00411887		       jmp     short loc_41188B
.text:00411889 ; ---------------------------------------------------------------------------
.text:00411889
.text:00411889 loc_411889:			       ; CODE XREF: _memcmp+430j
.text:00411889		       xor     esi, esi
.text:0041188B
.text:0041188B loc_41188B:			       ; CODE XREF: _memcmp+493j
.text:0041188B					       ; _memcmp+4A2j
.text:0041188B		       test    esi, esi
.text:0041188D		       jnz     short loc_4118B1
.text:0041188F		       add     eax, edx
.text:00411891		       add     ecx, edx
.text:00411893		       sub     edi, edx
.text:00411895
.text:00411895 loc_411895:			       ; CODE XREF: _memcmp+39j
.text:00411895		       cmp     edi, edx
.text:00411897		       jnb     loc_411423
.text:0041189D		       add     eax, edi
.text:0041189F		       add     ecx, edi
.text:004118A1		       cmp     edi, 1Fh	       ; switch	32 cases
.text:004118A4		       ja      $LN132	       ; default
.text:004118A4					       ; jumptable 004118AA case 0
.text:004118AA		       jmp     ds:off_4129E5[edi*4] ; switch jump
.text:004118B1 ; ---------------------------------------------------------------------------
.text:004118B1
.text:004118B1 loc_4118B1:			       ; CODE XREF: _memcmp+5Dj
.text:004118B1					       ; _memcmp+7Ej ...
.text:004118B1		       mov     eax, esi
.text:004118B3		       jmp     loc_411C86
.text:004118B8 ; ---------------------------------------------------------------------------
.text:004118B8
.text:004118B8 $LN131_0:			       ; CODE XREF: _memcmp+4C5j
.text:004118B8					       ; DATA XREF: _memcmp:off_4129E5o
.text:004118B8		       mov     edx, [eax-1Ch]  ; jumptable 004118AA case 28
.text:004118BB		       cmp     edx, [ecx-1Ch]
.text:004118BE		       jz      short loc_411931
.text:004118C0		       movzx   esi, dl
.text:004118C3		       movzx   edx, byte ptr [ecx-1Ch]
.text:004118C7		       sub     esi, edx
.text:004118C9		       jz      short loc_4118DC
.text:004118CB		       xor     edx, edx
.text:004118CD		       test    esi, esi
.text:004118CF		       setnle  dl
.text:004118D2		       lea     edx, [edx+edx-1]
.text:004118D6		       mov     esi, edx
.text:004118D8		       test    esi, esi
.text:004118DA		       jnz     short loc_4118B1
.text:004118DC
.text:004118DC loc_4118DC:			       ; CODE XREF: _memcmp+4E4j
.text:004118DC		       movzx   esi, byte ptr [eax-1Bh]
.text:004118E0		       movzx   edx, byte ptr [ecx-1Bh]
.text:004118E4		       sub     esi, edx
.text:004118E6		       jz      short loc_4118F9
.text:004118E8		       xor     edx, edx
.text:004118EA		       test    esi, esi
.text:004118EC		       setnle  dl
.text:004118EF		       lea     edx, [edx+edx-1]
.text:004118F3		       mov     esi, edx
.text:004118F5		       test    esi, esi
.text:004118F7		       jnz     short loc_4118B1
.text:004118F9
.text:004118F9 loc_4118F9:			       ; CODE XREF: _memcmp+501j
.text:004118F9		       movzx   esi, byte ptr [eax-1Ah]
.text:004118FD		       movzx   edx, byte ptr [ecx-1Ah]
.text:00411901		       sub     esi, edx
.text:00411903		       jz      short loc_411916
.text:00411905		       xor     edx, edx
.text:00411907		       test    esi, esi
.text:00411909		       setnle  dl
.text:0041190C		       lea     edx, [edx+edx-1]
.text:00411910		       mov     esi, edx
.text:00411912		       test    esi, esi
.text:00411914		       jnz     short loc_4118B1
.text:00411916
.text:00411916 loc_411916:			       ; CODE XREF: _memcmp+51Ej
.text:00411916		       movzx   esi, byte ptr [eax-19h]
.text:0041191A		       movzx   edx, byte ptr [ecx-19h]
.text:0041191E		       sub     esi, edx
.text:00411920		       jz      short loc_411933
.text:00411922		       xor     edx, edx
.text:00411924		       test    esi, esi
.text:00411926		       setnle  dl
.text:00411929		       lea     edx, [edx+edx-1]
.text:0041192D		       mov     esi, edx
.text:0041192F		       jmp     short loc_411933
.text:00411931 ; ---------------------------------------------------------------------------
.text:00411931
.text:00411931 loc_411931:			       ; CODE XREF: _memcmp+4D9j
.text:00411931		       xor     esi, esi
.text:00411933
.text:00411933 loc_411933:			       ; CODE XREF: _memcmp+53Bj
.text:00411933					       ; _memcmp+54Aj
.text:00411933		       test    esi, esi
.text:00411935		       jnz     loc_4118B1
.text:0041193B
.text:0041193B $LN130_1:			       ; CODE XREF: _memcmp+4C5j
.text:0041193B					       ; DATA XREF: _memcmp:off_4129E5o
.text:0041193B		       mov     edx, [eax-18h]  ; jumptable 004118AA case 24
.text:0041193E		       cmp     edx, [ecx-18h]
.text:00411941		       jz      short loc_4119C0
.text:00411943		       movzx   esi, dl
.text:00411946		       movzx   edx, byte ptr [ecx-18h]
.text:0041194A		       sub     esi, edx
.text:0041194C		       jz      short loc_411963
.text:0041194E		       xor     edx, edx
.text:00411950		       test    esi, esi
.text:00411952		       setnle  dl
.text:00411955		       lea     edx, [edx+edx-1]
.text:00411959		       mov     esi, edx
.text:0041195B		       test    esi, esi
.text:0041195D		       jnz     loc_4118B1
.text:00411963
.text:00411963 loc_411963:			       ; CODE XREF: _memcmp+567j
.text:00411963		       movzx   esi, byte ptr [eax-17h]
.text:00411967		       movzx   edx, byte ptr [ecx-17h]
.text:0041196B		       sub     esi, edx
.text:0041196D		       jz      short loc_411984
.text:0041196F		       xor     edx, edx
.text:00411971		       test    esi, esi
.text:00411973		       setnle  dl
.text:00411976		       lea     edx, [edx+edx-1]
.text:0041197A		       mov     esi, edx
.text:0041197C		       test    esi, esi
.text:0041197E		       jnz     loc_4118B1
.text:00411984
.text:00411984 loc_411984:			       ; CODE XREF: _memcmp+588j
.text:00411984		       movzx   esi, byte ptr [eax-16h]
.text:00411988		       movzx   edx, byte ptr [ecx-16h]
.text:0041198C		       sub     esi, edx
.text:0041198E		       jz      short loc_4119A5
.text:00411990		       xor     edx, edx
.text:00411992		       test    esi, esi
.text:00411994		       setnle  dl
.text:00411997		       lea     edx, [edx+edx-1]
.text:0041199B		       mov     esi, edx
.text:0041199D		       test    esi, esi
.text:0041199F		       jnz     loc_4118B1
.text:004119A5
.text:004119A5 loc_4119A5:			       ; CODE XREF: _memcmp+5A9j
.text:004119A5		       movzx   esi, byte ptr [eax-15h]
.text:004119A9		       movzx   edx, byte ptr [ecx-15h]
.text:004119AD		       sub     esi, edx
.text:004119AF		       jz      short loc_4119C2
.text:004119B1		       xor     edx, edx
.text:004119B3		       test    esi, esi
.text:004119B5		       setnle  dl
.text:004119B8		       lea     edx, [edx+edx-1]
.text:004119BC		       mov     esi, edx
.text:004119BE		       jmp     short loc_4119C2
.text:004119C0 ; ---------------------------------------------------------------------------
.text:004119C0
.text:004119C0 loc_4119C0:			       ; CODE XREF: _memcmp+55Cj
.text:004119C0		       xor     esi, esi
.text:004119C2
.text:004119C2 loc_4119C2:			       ; CODE XREF: _memcmp+5CAj
.text:004119C2					       ; _memcmp+5D9j
.text:004119C2		       test    esi, esi
.text:004119C4		       jnz     loc_4118B1
.text:004119CA
.text:004119CA $LN128:				       ; CODE XREF: _memcmp+4C5j
.text:004119CA					       ; DATA XREF: _memcmp:off_4129E5o
.text:004119CA		       mov     edx, [eax-14h]  ; jumptable 004118AA case 20
.text:004119CD		       cmp     edx, [ecx-14h]
.text:004119D0		       jz      short loc_411A4F
.text:004119D2		       movzx   esi, dl
.text:004119D5		       movzx   edx, byte ptr [ecx-14h]
.text:004119D9		       sub     esi, edx
.text:004119DB		       jz      short loc_4119F2
.text:004119DD		       xor     edx, edx
.text:004119DF		       test    esi, esi
.text:004119E1		       setnle  dl
.text:004119E4		       lea     edx, [edx+edx-1]
.text:004119E8		       mov     esi, edx
.text:004119EA		       test    esi, esi
.text:004119EC		       jnz     loc_4118B1
.text:004119F2
.text:004119F2 loc_4119F2:			       ; CODE XREF: _memcmp+5F6j
.text:004119F2		       movzx   esi, byte ptr [eax-13h]
.text:004119F6		       movzx   edx, byte ptr [ecx-13h]
.text:004119FA		       sub     esi, edx
.text:004119FC		       jz      short loc_411A13
.text:004119FE		       xor     edx, edx
.text:00411A00		       test    esi, esi
.text:00411A02		       setnle  dl
.text:00411A05		       lea     edx, [edx+edx-1]
.text:00411A09		       mov     esi, edx
.text:00411A0B		       test    esi, esi
.text:00411A0D		       jnz     loc_4118B1
.text:00411A13
.text:00411A13 loc_411A13:			       ; CODE XREF: _memcmp+617j
.text:00411A13		       movzx   esi, byte ptr [eax-12h]
.text:00411A17		       movzx   edx, byte ptr [ecx-12h]
.text:00411A1B		       sub     esi, edx
.text:00411A1D		       jz      short loc_411A34
.text:00411A1F		       xor     edx, edx
.text:00411A21		       test    esi, esi
.text:00411A23		       setnle  dl
.text:00411A26		       lea     edx, [edx+edx-1]
.text:00411A2A		       mov     esi, edx
.text:00411A2C		       test    esi, esi
.text:00411A2E		       jnz     loc_4118B1
.text:00411A34
.text:00411A34 loc_411A34:			       ; CODE XREF: _memcmp+638j
.text:00411A34		       movzx   esi, byte ptr [eax-11h]
.text:00411A38		       movzx   edx, byte ptr [ecx-11h]
.text:00411A3C		       sub     esi, edx
.text:00411A3E		       jz      short loc_411A51
.text:00411A40		       xor     edx, edx
.text:00411A42		       test    esi, esi
.text:00411A44		       setnle  dl
.text:00411A47		       lea     edx, [edx+edx-1]
.text:00411A4B		       mov     esi, edx
.text:00411A4D		       jmp     short loc_411A51
.text:00411A4F ; ---------------------------------------------------------------------------
.text:00411A4F
.text:00411A4F loc_411A4F:			       ; CODE XREF: _memcmp+5EBj
.text:00411A4F		       xor     esi, esi
.text:00411A51
.text:00411A51 loc_411A51:			       ; CODE XREF: _memcmp+659j
.text:00411A51					       ; _memcmp+668j
.text:00411A51		       test    esi, esi
.text:00411A53		       jnz     loc_4118B1
.text:00411A59
.text:00411A59 $LN126:				       ; CODE XREF: _memcmp+4C5j
.text:00411A59					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411A59		       mov     edx, [eax-10h]  ; jumptable 004118AA case 16
.text:00411A5C		       cmp     edx, [ecx-10h]
.text:00411A5F		       jz      short loc_411ADE
.text:00411A61		       movzx   esi, dl
.text:00411A64		       movzx   edx, byte ptr [ecx-10h]
.text:00411A68		       sub     esi, edx
.text:00411A6A		       jz      short loc_411A81
.text:00411A6C		       xor     edx, edx
.text:00411A6E		       test    esi, esi
.text:00411A70		       setnle  dl
.text:00411A73		       lea     edx, [edx+edx-1]
.text:00411A77		       mov     esi, edx
.text:00411A79		       test    esi, esi
.text:00411A7B		       jnz     loc_4118B1
.text:00411A81
.text:00411A81 loc_411A81:			       ; CODE XREF: _memcmp+685j
.text:00411A81		       movzx   esi, byte ptr [eax-0Fh]
.text:00411A85		       movzx   edx, byte ptr [ecx-0Fh]
.text:00411A89		       sub     esi, edx
.text:00411A8B		       jz      short loc_411AA2
.text:00411A8D		       xor     edx, edx
.text:00411A8F		       test    esi, esi
.text:00411A91		       setnle  dl
.text:00411A94		       lea     edx, [edx+edx-1]
.text:00411A98		       mov     esi, edx
.text:00411A9A		       test    esi, esi
.text:00411A9C		       jnz     loc_4118B1
.text:00411AA2
.text:00411AA2 loc_411AA2:			       ; CODE XREF: _memcmp+6A6j
.text:00411AA2		       movzx   esi, byte ptr [eax-0Eh]
.text:00411AA6		       movzx   edx, byte ptr [ecx-0Eh]
.text:00411AAA		       sub     esi, edx
.text:00411AAC		       jz      short loc_411AC3
.text:00411AAE		       xor     edx, edx
.text:00411AB0		       test    esi, esi
.text:00411AB2		       setnle  dl
.text:00411AB5		       lea     edx, [edx+edx-1]
.text:00411AB9		       mov     esi, edx
.text:00411ABB		       test    esi, esi
.text:00411ABD		       jnz     loc_4118B1
.text:00411AC3
.text:00411AC3 loc_411AC3:			       ; CODE XREF: _memcmp+6C7j
.text:00411AC3		       movzx   esi, byte ptr [eax-0Dh]
.text:00411AC7		       movzx   edx, byte ptr [ecx-0Dh]
.text:00411ACB		       sub     esi, edx
.text:00411ACD		       jz      short loc_411AE0
.text:00411ACF		       xor     edx, edx
.text:00411AD1		       test    esi, esi
.text:00411AD3		       setnle  dl
.text:00411AD6		       lea     edx, [edx+edx-1]
.text:00411ADA		       mov     esi, edx
.text:00411ADC		       jmp     short loc_411AE0
.text:00411ADE ; ---------------------------------------------------------------------------
.text:00411ADE
.text:00411ADE loc_411ADE:			       ; CODE XREF: _memcmp+67Aj
.text:00411ADE		       xor     esi, esi
.text:00411AE0
.text:00411AE0 loc_411AE0:			       ; CODE XREF: _memcmp+6E8j
.text:00411AE0					       ; _memcmp+6F7j
.text:00411AE0		       test    esi, esi
.text:00411AE2		       jnz     loc_4118B1
.text:00411AE8
.text:00411AE8 $LN124:				       ; CODE XREF: _memcmp+4C5j
.text:00411AE8					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411AE8		       mov     edx, [eax-0Ch]  ; jumptable 004118AA case 12
.text:00411AEB		       cmp     edx, [ecx-0Ch]
.text:00411AEE		       jz      short loc_411B6E
.text:00411AF0		       movzx   edx, byte ptr [ecx-0Ch]
.text:00411AF4		       movzx   esi, byte ptr [eax-0Ch]
.text:00411AF8		       sub     esi, edx
.text:00411AFA		       jz      short loc_411B11
.text:00411AFC		       xor     edx, edx
.text:00411AFE		       test    esi, esi
.text:00411B00		       setnle  dl
.text:00411B03		       lea     edx, [edx+edx-1]
.text:00411B07		       mov     esi, edx
.text:00411B09		       test    esi, esi
.text:00411B0B		       jnz     loc_4118B1
.text:00411B11
.text:00411B11 loc_411B11:			       ; CODE XREF: _memcmp+715j
.text:00411B11		       movzx   esi, byte ptr [eax-0Bh]
.text:00411B15		       movzx   edx, byte ptr [ecx-0Bh]
.text:00411B19		       sub     esi, edx
.text:00411B1B		       jz      short loc_411B32
.text:00411B1D		       xor     edx, edx
.text:00411B1F		       test    esi, esi
.text:00411B21		       setnle  dl
.text:00411B24		       lea     edx, [edx+edx-1]
.text:00411B28		       mov     esi, edx
.text:00411B2A		       test    esi, esi
.text:00411B2C		       jnz     loc_4118B1
.text:00411B32
.text:00411B32 loc_411B32:			       ; CODE XREF: _memcmp+736j
.text:00411B32		       movzx   esi, byte ptr [eax-0Ah]
.text:00411B36		       movzx   edx, byte ptr [ecx-0Ah]
.text:00411B3A		       sub     esi, edx
.text:00411B3C		       jz      short loc_411B53
.text:00411B3E		       xor     edx, edx
.text:00411B40		       test    esi, esi
.text:00411B42		       setnle  dl
.text:00411B45		       lea     edx, [edx+edx-1]
.text:00411B49		       mov     esi, edx
.text:00411B4B		       test    esi, esi
.text:00411B4D		       jnz     loc_4118B1
.text:00411B53
.text:00411B53 loc_411B53:			       ; CODE XREF: _memcmp+757j
.text:00411B53		       movzx   esi, byte ptr [eax-9]
.text:00411B57		       movzx   edx, byte ptr [ecx-9]
.text:00411B5B		       sub     esi, edx
.text:00411B5D		       jz      short loc_411B70
.text:00411B5F		       xor     edx, edx
.text:00411B61		       test    esi, esi
.text:00411B63		       setnle  dl
.text:00411B66		       lea     edx, [edx+edx-1]
.text:00411B6A		       mov     esi, edx
.text:00411B6C		       jmp     short loc_411B70
.text:00411B6E ; ---------------------------------------------------------------------------
.text:00411B6E
.text:00411B6E loc_411B6E:			       ; CODE XREF: _memcmp+709j
.text:00411B6E		       xor     esi, esi
.text:00411B70
.text:00411B70 loc_411B70:			       ; CODE XREF: _memcmp+778j
.text:00411B70					       ; _memcmp+787j
.text:00411B70		       test    esi, esi
.text:00411B72		       jnz     loc_4118B1
.text:00411B78
.text:00411B78 $LN122_0:			       ; CODE XREF: _memcmp+4C5j
.text:00411B78					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411B78		       mov     edx, [eax-8]    ; jumptable 004118AA case 8
.text:00411B7B		       cmp     edx, [ecx-8]
.text:00411B7E		       jz      short loc_411BFD
.text:00411B80		       movzx   esi, dl
.text:00411B83		       movzx   edx, byte ptr [ecx-8]
.text:00411B87		       sub     esi, edx
.text:00411B89		       jz      short loc_411BA0
.text:00411B8B		       xor     edx, edx
.text:00411B8D		       test    esi, esi
.text:00411B8F		       setnle  dl
.text:00411B92		       lea     edx, [edx+edx-1]
.text:00411B96		       mov     esi, edx
.text:00411B98		       test    esi, esi
.text:00411B9A		       jnz     loc_4118B1
.text:00411BA0
.text:00411BA0 loc_411BA0:			       ; CODE XREF: _memcmp+7A4j
.text:00411BA0		       movzx   esi, byte ptr [eax-7]
.text:00411BA4		       movzx   edx, byte ptr [ecx-7]
.text:00411BA8		       sub     esi, edx
.text:00411BAA		       jz      short loc_411BC1
.text:00411BAC		       xor     edx, edx
.text:00411BAE		       test    esi, esi
.text:00411BB0		       setnle  dl
.text:00411BB3		       lea     edx, [edx+edx-1]
.text:00411BB7		       mov     esi, edx
.text:00411BB9		       test    esi, esi
.text:00411BBB		       jnz     loc_4118B1
.text:00411BC1
.text:00411BC1 loc_411BC1:			       ; CODE XREF: _memcmp+7C5j
.text:00411BC1		       movzx   esi, byte ptr [eax-6]
.text:00411BC5		       movzx   edx, byte ptr [ecx-6]
.text:00411BC9		       sub     esi, edx
.text:00411BCB		       jz      short loc_411BE2
.text:00411BCD		       xor     edx, edx
.text:00411BCF		       test    esi, esi
.text:00411BD1		       setnle  dl
.text:00411BD4		       lea     edx, [edx+edx-1]
.text:00411BD8		       mov     esi, edx
.text:00411BDA		       test    esi, esi
.text:00411BDC		       jnz     loc_4118B1
.text:00411BE2
.text:00411BE2 loc_411BE2:			       ; CODE XREF: _memcmp+7E6j
.text:00411BE2		       movzx   esi, byte ptr [eax-5]
.text:00411BE6		       movzx   edx, byte ptr [ecx-5]
.text:00411BEA		       sub     esi, edx
.text:00411BEC		       jz      short loc_411BFF
.text:00411BEE		       xor     edx, edx
.text:00411BF0		       test    esi, esi
.text:00411BF2		       setnle  dl
.text:00411BF5		       lea     edx, [edx+edx-1]
.text:00411BF9		       mov     esi, edx
.text:00411BFB		       jmp     short loc_411BFF
.text:00411BFD ; ---------------------------------------------------------------------------
.text:00411BFD
.text:00411BFD loc_411BFD:			       ; CODE XREF: _memcmp+799j
.text:00411BFD		       xor     esi, esi
.text:00411BFF
.text:00411BFF loc_411BFF:			       ; CODE XREF: _memcmp+807j
.text:00411BFF					       ; _memcmp+816j
.text:00411BFF		       test    esi, esi
.text:00411C01		       jnz     loc_4118B1
.text:00411C07
.text:00411C07 $LN120:				       ; CODE XREF: _memcmp+4C5j
.text:00411C07					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411C07		       mov     edx, [eax-4]    ; jumptable 004118AA case 4
.text:00411C0A		       cmp     edx, [ecx-4]
.text:00411C0D		       jz      short loc_411C7E
.text:00411C0F		       movzx   esi, dl
.text:00411C12		       movzx   edx, byte ptr [ecx-4]
.text:00411C16		       sub     esi, edx
.text:00411C18		       jz      short loc_411C29
.text:00411C1A		       xor     edx, edx
.text:00411C1C		       test    esi, esi
.text:00411C1E		       setnle  dl
.text:00411C21		       lea     edx, [edx+edx-1]
.text:00411C25		       test    edx, edx
.text:00411C27		       jnz     short loc_411C5F
.text:00411C29
.text:00411C29 loc_411C29:			       ; CODE XREF: _memcmp+833j
.text:00411C29		       movzx   esi, byte ptr [eax-3]
.text:00411C2D		       movzx   edx, byte ptr [ecx-3]
.text:00411C31		       sub     esi, edx
.text:00411C33		       jz      short loc_411C44
.text:00411C35		       xor     edx, edx
.text:00411C37		       test    esi, esi
.text:00411C39		       setnle  dl
.text:00411C3C		       lea     edx, [edx+edx-1]
.text:00411C40		       test    edx, edx
.text:00411C42		       jnz     short loc_411C5F
.text:00411C44
.text:00411C44 loc_411C44:			       ; CODE XREF: _memcmp+84Ej
.text:00411C44		       movzx   esi, byte ptr [eax-2]
.text:00411C48		       movzx   edx, byte ptr [ecx-2]
.text:00411C4C		       sub     esi, edx
.text:00411C4E		       jz      short loc_411C63
.text:00411C50		       xor     edx, edx
.text:00411C52		       test    esi, esi
.text:00411C54		       setnle  dl
.text:00411C57		       lea     edx, [edx+edx-1]
.text:00411C5B		       test    edx, edx
.text:00411C5D		       jz      short loc_411C63
.text:00411C5F
.text:00411C5F loc_411C5F:			       ; CODE XREF: _memcmp+842j
.text:00411C5F					       ; _memcmp+85Dj
.text:00411C5F		       mov     eax, edx
.text:00411C61		       jmp     short loc_411C80
.text:00411C63 ; ---------------------------------------------------------------------------
.text:00411C63
.text:00411C63 loc_411C63:			       ; CODE XREF: _memcmp+869j
.text:00411C63					       ; _memcmp+878j
.text:00411C63		       movzx   eax, byte ptr [eax-1]
.text:00411C67		       movzx   ecx, byte ptr [ecx-1]
.text:00411C6B		       sub     eax, ecx
.text:00411C6D		       jz      short loc_411C80
.text:00411C6F		       xor     ecx, ecx
.text:00411C71		       test    eax, eax
.text:00411C73		       setnle  cl
.text:00411C76		       lea     ecx, [ecx+ecx-1]
.text:00411C7A		       mov     eax, ecx
.text:00411C7C		       jmp     short loc_411C80
.text:00411C7E ; ---------------------------------------------------------------------------
.text:00411C7E
.text:00411C7E loc_411C7E:			       ; CODE XREF: _memcmp+828j
.text:00411C7E		       xor     eax, eax
.text:00411C80
.text:00411C80 loc_411C80:			       ; CODE XREF: _memcmp+87Cj
.text:00411C80					       ; _memcmp+888j ...
.text:00411C80		       test    eax, eax
.text:00411C82		       jnz     short loc_411C86
.text:00411C84
.text:00411C84 $LN132:				       ; CODE XREF: _memcmp+4BFj
.text:00411C84					       ; _memcmp+4C5j ...
.text:00411C84		       xor     eax, eax	       ; default
.text:00411C84					       ; jumptable 004118AA case 0
.text:00411C86
.text:00411C86 loc_411C86:			       ; CODE XREF: _memcmp+4CEj
.text:00411C86					       ; _memcmp+89Dj ...
.text:00411C86		       pop     ebx
.text:00411C87		       jmp     loc_4129DF
.text:00411C8C ; ---------------------------------------------------------------------------
.text:00411C8C
.text:00411C8C $LN116_0:			       ; CODE XREF: _memcmp+4C5j
.text:00411C8C					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411C8C		       mov     edx, [eax-1Dh]  ; jumptable 004118AA case 29
.text:00411C8F		       cmp     edx, [ecx-1Dh]
.text:00411C92		       jz      short loc_411D11
.text:00411C94		       movzx   esi, dl
.text:00411C97		       movzx   edx, byte ptr [ecx-1Dh]
.text:00411C9B		       sub     esi, edx
.text:00411C9D		       jz      short loc_411CB4
.text:00411C9F		       xor     edx, edx
.text:00411CA1		       test    esi, esi
.text:00411CA3		       setnle  dl
.text:00411CA6		       lea     edx, [edx+edx-1]
.text:00411CAA		       mov     esi, edx
.text:00411CAC		       test    esi, esi
.text:00411CAE		       jnz     loc_4118B1
.text:00411CB4
.text:00411CB4 loc_411CB4:			       ; CODE XREF: _memcmp+8B8j
.text:00411CB4		       movzx   esi, byte ptr [eax-1Ch]
.text:00411CB8		       movzx   edx, byte ptr [ecx-1Ch]
.text:00411CBC		       sub     esi, edx
.text:00411CBE		       jz      short loc_411CD5
.text:00411CC0		       xor     edx, edx
.text:00411CC2		       test    esi, esi
.text:00411CC4		       setnle  dl
.text:00411CC7		       lea     edx, [edx+edx-1]
.text:00411CCB		       mov     esi, edx
.text:00411CCD		       test    esi, esi
.text:00411CCF		       jnz     loc_4118B1
.text:00411CD5
.text:00411CD5 loc_411CD5:			       ; CODE XREF: _memcmp+8D9j
.text:00411CD5		       movzx   esi, byte ptr [eax-1Bh]
.text:00411CD9		       movzx   edx, byte ptr [ecx-1Bh]
.text:00411CDD		       sub     esi, edx
.text:00411CDF		       jz      short loc_411CF6
.text:00411CE1		       xor     edx, edx
.text:00411CE3		       test    esi, esi
.text:00411CE5		       setnle  dl
.text:00411CE8		       lea     edx, [edx+edx-1]
.text:00411CEC		       mov     esi, edx
.text:00411CEE		       test    esi, esi
.text:00411CF0		       jnz     loc_4118B1
.text:00411CF6
.text:00411CF6 loc_411CF6:			       ; CODE XREF: _memcmp+8FAj
.text:00411CF6		       movzx   esi, byte ptr [eax-1Ah]
.text:00411CFA		       movzx   edx, byte ptr [ecx-1Ah]
.text:00411CFE		       sub     esi, edx
.text:00411D00		       jz      short loc_411D13
.text:00411D02		       xor     edx, edx
.text:00411D04		       test    esi, esi
.text:00411D06		       setnle  dl
.text:00411D09		       lea     edx, [edx+edx-1]
.text:00411D0D		       mov     esi, edx
.text:00411D0F		       jmp     short loc_411D13
.text:00411D11 ; ---------------------------------------------------------------------------
.text:00411D11
.text:00411D11 loc_411D11:			       ; CODE XREF: _memcmp+8ADj
.text:00411D11		       xor     esi, esi
.text:00411D13
.text:00411D13 loc_411D13:			       ; CODE XREF: _memcmp+91Bj
.text:00411D13					       ; _memcmp+92Aj
.text:00411D13		       test    esi, esi
.text:00411D15		       jnz     loc_4118B1
.text:00411D1B
.text:00411D1B $LN115:				       ; CODE XREF: _memcmp+4C5j
.text:00411D1B					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411D1B		       mov     edx, [eax-19h]  ; jumptable 004118AA case 25
.text:00411D1E		       cmp     edx, [ecx-19h]
.text:00411D21		       jz      short loc_411DA0
.text:00411D23		       movzx   esi, dl
.text:00411D26		       movzx   edx, byte ptr [ecx-19h]
.text:00411D2A		       sub     esi, edx
.text:00411D2C		       jz      short loc_411D43
.text:00411D2E		       xor     edx, edx
.text:00411D30		       test    esi, esi
.text:00411D32		       setnle  dl
.text:00411D35		       lea     edx, [edx+edx-1]
.text:00411D39		       mov     esi, edx
.text:00411D3B		       test    esi, esi
.text:00411D3D		       jnz     loc_4118B1
.text:00411D43
.text:00411D43 loc_411D43:			       ; CODE XREF: _memcmp+947j
.text:00411D43		       movzx   esi, byte ptr [eax-18h]
.text:00411D47		       movzx   edx, byte ptr [ecx-18h]
.text:00411D4B		       sub     esi, edx
.text:00411D4D		       jz      short loc_411D64
.text:00411D4F		       xor     edx, edx
.text:00411D51		       test    esi, esi
.text:00411D53		       setnle  dl
.text:00411D56		       lea     edx, [edx+edx-1]
.text:00411D5A		       mov     esi, edx
.text:00411D5C		       test    esi, esi
.text:00411D5E		       jnz     loc_4118B1
.text:00411D64
.text:00411D64 loc_411D64:			       ; CODE XREF: _memcmp+968j
.text:00411D64		       movzx   esi, byte ptr [eax-17h]
.text:00411D68		       movzx   edx, byte ptr [ecx-17h]
.text:00411D6C		       sub     esi, edx
.text:00411D6E		       jz      short loc_411D85
.text:00411D70		       xor     edx, edx
.text:00411D72		       test    esi, esi
.text:00411D74		       setnle  dl
.text:00411D77		       lea     edx, [edx+edx-1]
.text:00411D7B		       mov     esi, edx
.text:00411D7D		       test    esi, esi
.text:00411D7F		       jnz     loc_4118B1
.text:00411D85
.text:00411D85 loc_411D85:			       ; CODE XREF: _memcmp+989j
.text:00411D85		       movzx   esi, byte ptr [eax-16h]
.text:00411D89		       movzx   edx, byte ptr [ecx-16h]
.text:00411D8D		       sub     esi, edx
.text:00411D8F		       jz      short loc_411DA2
.text:00411D91		       xor     edx, edx
.text:00411D93		       test    esi, esi
.text:00411D95		       setnle  dl
.text:00411D98		       lea     edx, [edx+edx-1]
.text:00411D9C		       mov     esi, edx
.text:00411D9E		       jmp     short loc_411DA2
.text:00411DA0 ; ---------------------------------------------------------------------------
.text:00411DA0
.text:00411DA0 loc_411DA0:			       ; CODE XREF: _memcmp+93Cj
.text:00411DA0		       xor     esi, esi
.text:00411DA2
.text:00411DA2 loc_411DA2:			       ; CODE XREF: _memcmp+9AAj
.text:00411DA2					       ; _memcmp+9B9j
.text:00411DA2		       test    esi, esi
.text:00411DA4		       jnz     loc_4118B1
.text:00411DAA
.text:00411DAA $LN113_0:			       ; CODE XREF: _memcmp+4C5j
.text:00411DAA					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411DAA		       mov     edx, [eax-15h]  ; jumptable 004118AA case 21
.text:00411DAD		       cmp     edx, [ecx-15h]
.text:00411DB0		       jz      short loc_411E2F
.text:00411DB2		       movzx   esi, dl
.text:00411DB5		       movzx   edx, byte ptr [ecx-15h]
.text:00411DB9		       sub     esi, edx
.text:00411DBB		       jz      short loc_411DD2
.text:00411DBD		       xor     edx, edx
.text:00411DBF		       test    esi, esi
.text:00411DC1		       setnle  dl
.text:00411DC4		       lea     edx, [edx+edx-1]
.text:00411DC8		       mov     esi, edx
.text:00411DCA		       test    esi, esi
.text:00411DCC		       jnz     loc_4118B1
.text:00411DD2
.text:00411DD2 loc_411DD2:			       ; CODE XREF: _memcmp+9D6j
.text:00411DD2		       movzx   esi, byte ptr [eax-14h]
.text:00411DD6		       movzx   edx, byte ptr [ecx-14h]
.text:00411DDA		       sub     esi, edx
.text:00411DDC		       jz      short loc_411DF3
.text:00411DDE		       xor     edx, edx
.text:00411DE0		       test    esi, esi
.text:00411DE2		       setnle  dl
.text:00411DE5		       lea     edx, [edx+edx-1]
.text:00411DE9		       mov     esi, edx
.text:00411DEB		       test    esi, esi
.text:00411DED		       jnz     loc_4118B1
.text:00411DF3
.text:00411DF3 loc_411DF3:			       ; CODE XREF: _memcmp+9F7j
.text:00411DF3		       movzx   esi, byte ptr [eax-13h]
.text:00411DF7		       movzx   edx, byte ptr [ecx-13h]
.text:00411DFB		       sub     esi, edx
.text:00411DFD		       jz      short loc_411E14
.text:00411DFF		       xor     edx, edx
.text:00411E01		       test    esi, esi
.text:00411E03		       setnle  dl
.text:00411E06		       lea     edx, [edx+edx-1]
.text:00411E0A		       mov     esi, edx
.text:00411E0C		       test    esi, esi
.text:00411E0E		       jnz     loc_4118B1
.text:00411E14
.text:00411E14 loc_411E14:			       ; CODE XREF: _memcmp+A18j
.text:00411E14		       movzx   esi, byte ptr [eax-12h]
.text:00411E18		       movzx   edx, byte ptr [ecx-12h]
.text:00411E1C		       sub     esi, edx
.text:00411E1E		       jz      short loc_411E31
.text:00411E20		       xor     edx, edx
.text:00411E22		       test    esi, esi
.text:00411E24		       setnle  dl
.text:00411E27		       lea     edx, [edx+edx-1]
.text:00411E2B		       mov     esi, edx
.text:00411E2D		       jmp     short loc_411E31
.text:00411E2F ; ---------------------------------------------------------------------------
.text:00411E2F
.text:00411E2F loc_411E2F:			       ; CODE XREF: _memcmp+9CBj
.text:00411E2F		       xor     esi, esi
.text:00411E31
.text:00411E31 loc_411E31:			       ; CODE XREF: _memcmp+A39j
.text:00411E31					       ; _memcmp+A48j
.text:00411E31		       test    esi, esi
.text:00411E33		       jnz     loc_4118B1
.text:00411E39
.text:00411E39 $LN111:				       ; CODE XREF: _memcmp+4C5j
.text:00411E39					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411E39		       mov     edx, [eax-11h]  ; jumptable 004118AA case 17
.text:00411E3C		       cmp     edx, [ecx-11h]
.text:00411E3F		       jz      short loc_411EBE
.text:00411E41		       movzx   esi, dl
.text:00411E44		       movzx   edx, byte ptr [ecx-11h]
.text:00411E48		       sub     esi, edx
.text:00411E4A		       jz      short loc_411E61
.text:00411E4C		       xor     edx, edx
.text:00411E4E		       test    esi, esi
.text:00411E50		       setnle  dl
.text:00411E53		       lea     edx, [edx+edx-1]
.text:00411E57		       mov     esi, edx
.text:00411E59		       test    esi, esi
.text:00411E5B		       jnz     loc_4118B1
.text:00411E61
.text:00411E61 loc_411E61:			       ; CODE XREF: _memcmp+A65j
.text:00411E61		       movzx   esi, byte ptr [eax-10h]
.text:00411E65		       movzx   edx, byte ptr [ecx-10h]
.text:00411E69		       sub     esi, edx
.text:00411E6B		       jz      short loc_411E82
.text:00411E6D		       xor     edx, edx
.text:00411E6F		       test    esi, esi
.text:00411E71		       setnle  dl
.text:00411E74		       lea     edx, [edx+edx-1]
.text:00411E78		       mov     esi, edx
.text:00411E7A		       test    esi, esi
.text:00411E7C		       jnz     loc_4118B1
.text:00411E82
.text:00411E82 loc_411E82:			       ; CODE XREF: _memcmp+A86j
.text:00411E82		       movzx   esi, byte ptr [eax-0Fh]
.text:00411E86		       movzx   edx, byte ptr [ecx-0Fh]
.text:00411E8A		       sub     esi, edx
.text:00411E8C		       jz      short loc_411EA3
.text:00411E8E		       xor     edx, edx
.text:00411E90		       test    esi, esi
.text:00411E92		       setnle  dl
.text:00411E95		       lea     edx, [edx+edx-1]
.text:00411E99		       mov     esi, edx
.text:00411E9B		       test    esi, esi
.text:00411E9D		       jnz     loc_4118B1
.text:00411EA3
.text:00411EA3 loc_411EA3:			       ; CODE XREF: _memcmp+AA7j
.text:00411EA3		       movzx   esi, byte ptr [eax-0Eh]
.text:00411EA7		       movzx   edx, byte ptr [ecx-0Eh]
.text:00411EAB		       sub     esi, edx
.text:00411EAD		       jz      short loc_411EC0
.text:00411EAF		       xor     edx, edx
.text:00411EB1		       test    esi, esi
.text:00411EB3		       setnle  dl
.text:00411EB6		       lea     edx, [edx+edx-1]
.text:00411EBA		       mov     esi, edx
.text:00411EBC		       jmp     short loc_411EC0
.text:00411EBE ; ---------------------------------------------------------------------------
.text:00411EBE
.text:00411EBE loc_411EBE:			       ; CODE XREF: _memcmp+A5Aj
.text:00411EBE		       xor     esi, esi
.text:00411EC0
.text:00411EC0 loc_411EC0:			       ; CODE XREF: _memcmp+AC8j
.text:00411EC0					       ; _memcmp+AD7j
.text:00411EC0		       test    esi, esi
.text:00411EC2		       jnz     loc_4118B1
.text:00411EC8
.text:00411EC8 $LN109:				       ; CODE XREF: _memcmp+4C5j
.text:00411EC8					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411EC8		       mov     edx, [eax-0Dh]  ; jumptable 004118AA case 13
.text:00411ECB		       cmp     edx, [ecx-0Dh]
.text:00411ECE		       jz      short loc_411F4D
.text:00411ED0		       movzx   esi, dl
.text:00411ED3		       movzx   edx, byte ptr [ecx-0Dh]
.text:00411ED7		       sub     esi, edx
.text:00411ED9		       jz      short loc_411EF0
.text:00411EDB		       xor     edx, edx
.text:00411EDD		       test    esi, esi
.text:00411EDF		       setnle  dl
.text:00411EE2		       lea     edx, [edx+edx-1]
.text:00411EE6		       mov     esi, edx
.text:00411EE8		       test    esi, esi
.text:00411EEA		       jnz     loc_4118B1
.text:00411EF0
.text:00411EF0 loc_411EF0:			       ; CODE XREF: _memcmp+AF4j
.text:00411EF0		       movzx   esi, byte ptr [eax-0Ch]
.text:00411EF4		       movzx   edx, byte ptr [ecx-0Ch]
.text:00411EF8		       sub     esi, edx
.text:00411EFA		       jz      short loc_411F11
.text:00411EFC		       xor     edx, edx
.text:00411EFE		       test    esi, esi
.text:00411F00		       setnle  dl
.text:00411F03		       lea     edx, [edx+edx-1]
.text:00411F07		       mov     esi, edx
.text:00411F09		       test    esi, esi
.text:00411F0B		       jnz     loc_4118B1
.text:00411F11
.text:00411F11 loc_411F11:			       ; CODE XREF: _memcmp+B15j
.text:00411F11		       movzx   esi, byte ptr [eax-0Bh]
.text:00411F15		       movzx   edx, byte ptr [ecx-0Bh]
.text:00411F19		       sub     esi, edx
.text:00411F1B		       jz      short loc_411F32
.text:00411F1D		       xor     edx, edx
.text:00411F1F		       test    esi, esi
.text:00411F21		       setnle  dl
.text:00411F24		       lea     edx, [edx+edx-1]
.text:00411F28		       mov     esi, edx
.text:00411F2A		       test    esi, esi
.text:00411F2C		       jnz     loc_4118B1
.text:00411F32
.text:00411F32 loc_411F32:			       ; CODE XREF: _memcmp+B36j
.text:00411F32		       movzx   esi, byte ptr [eax-0Ah]
.text:00411F36		       movzx   edx, byte ptr [ecx-0Ah]
.text:00411F3A		       sub     esi, edx
.text:00411F3C		       jz      short loc_411F4F
.text:00411F3E		       xor     edx, edx
.text:00411F40		       test    esi, esi
.text:00411F42		       setnle  dl
.text:00411F45		       lea     edx, [edx+edx-1]
.text:00411F49		       mov     esi, edx
.text:00411F4B		       jmp     short loc_411F4F
.text:00411F4D ; ---------------------------------------------------------------------------
.text:00411F4D
.text:00411F4D loc_411F4D:			       ; CODE XREF: _memcmp+AE9j
.text:00411F4D		       xor     esi, esi
.text:00411F4F
.text:00411F4F loc_411F4F:			       ; CODE XREF: _memcmp+B57j
.text:00411F4F					       ; _memcmp+B66j
.text:00411F4F		       test    esi, esi
.text:00411F51		       jnz     loc_4118B1
.text:00411F57
.text:00411F57 $LN107:				       ; CODE XREF: _memcmp+4C5j
.text:00411F57					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411F57		       mov     edx, [eax-9]    ; jumptable 004118AA case 9
.text:00411F5A		       cmp     edx, [ecx-9]
.text:00411F5D		       jz      short loc_411FDD
.text:00411F5F		       movzx   edx, byte ptr [ecx-9]
.text:00411F63		       movzx   esi, byte ptr [eax-9]
.text:00411F67		       sub     esi, edx
.text:00411F69		       jz      short loc_411F80
.text:00411F6B		       xor     edx, edx
.text:00411F6D		       test    esi, esi
.text:00411F6F		       setnle  dl
.text:00411F72		       lea     edx, [edx+edx-1]
.text:00411F76		       mov     esi, edx
.text:00411F78		       test    esi, esi
.text:00411F7A		       jnz     loc_4118B1
.text:00411F80
.text:00411F80 loc_411F80:			       ; CODE XREF: _memcmp+B84j
.text:00411F80		       movzx   esi, byte ptr [eax-8]
.text:00411F84		       movzx   edx, byte ptr [ecx-8]
.text:00411F88		       sub     esi, edx
.text:00411F8A		       jz      short loc_411FA1
.text:00411F8C		       xor     edx, edx
.text:00411F8E		       test    esi, esi
.text:00411F90		       setnle  dl
.text:00411F93		       lea     edx, [edx+edx-1]
.text:00411F97		       mov     esi, edx
.text:00411F99		       test    esi, esi
.text:00411F9B		       jnz     loc_4118B1
.text:00411FA1
.text:00411FA1 loc_411FA1:			       ; CODE XREF: _memcmp+BA5j
.text:00411FA1		       movzx   esi, byte ptr [eax-7]
.text:00411FA5		       movzx   edx, byte ptr [ecx-7]
.text:00411FA9		       sub     esi, edx
.text:00411FAB		       jz      short loc_411FC2
.text:00411FAD		       xor     edx, edx
.text:00411FAF		       test    esi, esi
.text:00411FB1		       setnle  dl
.text:00411FB4		       lea     edx, [edx+edx-1]
.text:00411FB8		       mov     esi, edx
.text:00411FBA		       test    esi, esi
.text:00411FBC		       jnz     loc_4118B1
.text:00411FC2
.text:00411FC2 loc_411FC2:			       ; CODE XREF: _memcmp+BC6j
.text:00411FC2		       movzx   esi, byte ptr [eax-6]
.text:00411FC6		       movzx   edx, byte ptr [ecx-6]
.text:00411FCA		       sub     esi, edx
.text:00411FCC		       jz      short loc_411FDF
.text:00411FCE		       xor     edx, edx
.text:00411FD0		       test    esi, esi
.text:00411FD2		       setnle  dl
.text:00411FD5		       lea     edx, [edx+edx-1]
.text:00411FD9		       mov     esi, edx
.text:00411FDB		       jmp     short loc_411FDF
.text:00411FDD ; ---------------------------------------------------------------------------
.text:00411FDD
.text:00411FDD loc_411FDD:			       ; CODE XREF: _memcmp+B78j
.text:00411FDD		       xor     esi, esi
.text:00411FDF
.text:00411FDF loc_411FDF:			       ; CODE XREF: _memcmp+BE7j
.text:00411FDF					       ; _memcmp+BF6j
.text:00411FDF		       test    esi, esi
.text:00411FE1		       jnz     loc_4118B1
.text:00411FE7
.text:00411FE7 $LN105:				       ; CODE XREF: _memcmp+4C5j
.text:00411FE7					       ; DATA XREF: _memcmp:off_4129E5o
.text:00411FE7		       mov     edx, [eax-5]    ; jumptable 004118AA case 5
.text:00411FEA		       cmp     edx, [ecx-5]
.text:00411FED		       jz      short loc_41206C
.text:00411FEF		       movzx   esi, dl
.text:00411FF2		       movzx   edx, byte ptr [ecx-5]
.text:00411FF6		       sub     esi, edx
.text:00411FF8		       jz      short loc_41200F
.text:00411FFA		       xor     edx, edx
.text:00411FFC		       test    esi, esi
.text:00411FFE		       setnle  dl
.text:00412001		       lea     edx, [edx+edx-1]
.text:00412005		       mov     esi, edx
.text:00412007		       test    esi, esi
.text:00412009		       jnz     loc_4118B1
.text:0041200F
.text:0041200F loc_41200F:			       ; CODE XREF: _memcmp+C13j
.text:0041200F		       movzx   esi, byte ptr [eax-4]
.text:00412013		       movzx   edx, byte ptr [ecx-4]
.text:00412017		       sub     esi, edx
.text:00412019		       jz      short loc_412030
.text:0041201B		       xor     edx, edx
.text:0041201D		       test    esi, esi
.text:0041201F		       setnle  dl
.text:00412022		       lea     edx, [edx+edx-1]
.text:00412026		       mov     esi, edx
.text:00412028		       test    esi, esi
.text:0041202A		       jnz     loc_4118B1
.text:00412030
.text:00412030 loc_412030:			       ; CODE XREF: _memcmp+C34j
.text:00412030		       movzx   esi, byte ptr [eax-3]
.text:00412034		       movzx   edx, byte ptr [ecx-3]
.text:00412038		       sub     esi, edx
.text:0041203A		       jz      short loc_412051
.text:0041203C		       xor     edx, edx
.text:0041203E		       test    esi, esi
.text:00412040		       setnle  dl
.text:00412043		       lea     edx, [edx+edx-1]
.text:00412047		       mov     esi, edx
.text:00412049		       test    esi, esi
.text:0041204B		       jnz     loc_4118B1
.text:00412051
.text:00412051 loc_412051:			       ; CODE XREF: _memcmp+C55j
.text:00412051		       movzx   esi, byte ptr [eax-2]
.text:00412055		       movzx   edx, byte ptr [ecx-2]
.text:00412059		       sub     esi, edx
.text:0041205B		       jz      short loc_41206E
.text:0041205D		       xor     edx, edx
.text:0041205F		       test    esi, esi
.text:00412061		       setnle  dl
.text:00412064		       lea     edx, [edx+edx-1]
.text:00412068		       mov     esi, edx
.text:0041206A		       jmp     short loc_41206E
.text:0041206C ; ---------------------------------------------------------------------------
.text:0041206C
.text:0041206C loc_41206C:			       ; CODE XREF: _memcmp+C08j
.text:0041206C		       xor     esi, esi
.text:0041206E
.text:0041206E loc_41206E:			       ; CODE XREF: _memcmp+C76j
.text:0041206E					       ; _memcmp+C85j
.text:0041206E		       test    esi, esi
.text:00412070		       jnz     loc_4118B1
.text:00412076
.text:00412076 $LN103:				       ; CODE XREF: _memcmp+4C5j
.text:00412076					       ; _memcmp+10B5j	...
.text:00412076		       movzx   ecx, byte ptr [ecx-1] ; jumptable 004118AA case 1
.text:0041207A		       movzx   eax, byte ptr [eax-1]
.text:0041207E		       sub     eax, ecx
.text:00412080		       jz      loc_411C86
.text:00412086		       xor     ecx, ecx
.text:00412088		       test    eax, eax
.text:0041208A		       setnle  cl
.text:0041208D		       lea     ecx, [ecx+ecx-1]
.text:00412091		       mov     eax, ecx
.text:00412093		       jmp     loc_411C86
.text:00412098 ; ---------------------------------------------------------------------------
.text:00412098
.text:00412098 $LN101:				       ; CODE XREF: _memcmp+4C5j
.text:00412098					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412098		       mov     edx, [eax-1Eh]  ; jumptable 004118AA case 30
.text:0041209B		       cmp     edx, [ecx-1Eh]
.text:0041209E		       jz      short loc_41211D
.text:004120A0		       movzx   esi, dl
.text:004120A3		       movzx   edx, byte ptr [ecx-1Eh]
.text:004120A7		       sub     esi, edx
.text:004120A9		       jz      short loc_4120C0
.text:004120AB		       xor     edx, edx
.text:004120AD		       test    esi, esi
.text:004120AF		       setnle  dl
.text:004120B2		       lea     edx, [edx+edx-1]
.text:004120B6		       mov     esi, edx
.text:004120B8		       test    esi, esi
.text:004120BA		       jnz     loc_4118B1
.text:004120C0
.text:004120C0 loc_4120C0:			       ; CODE XREF: _memcmp+CC4j
.text:004120C0		       movzx   esi, byte ptr [eax-1Dh]
.text:004120C4		       movzx   edx, byte ptr [ecx-1Dh]
.text:004120C8		       sub     esi, edx
.text:004120CA		       jz      short loc_4120E1
.text:004120CC		       xor     edx, edx
.text:004120CE		       test    esi, esi
.text:004120D0		       setnle  dl
.text:004120D3		       lea     edx, [edx+edx-1]
.text:004120D7		       mov     esi, edx
.text:004120D9		       test    esi, esi
.text:004120DB		       jnz     loc_4118B1
.text:004120E1
.text:004120E1 loc_4120E1:			       ; CODE XREF: _memcmp+CE5j
.text:004120E1		       movzx   esi, byte ptr [eax-1Ch]
.text:004120E5		       movzx   edx, byte ptr [ecx-1Ch]
.text:004120E9		       sub     esi, edx
.text:004120EB		       jz      short loc_412102
.text:004120ED		       xor     edx, edx
.text:004120EF		       test    esi, esi
.text:004120F1		       setnle  dl
.text:004120F4		       lea     edx, [edx+edx-1]
.text:004120F8		       mov     esi, edx
.text:004120FA		       test    esi, esi
.text:004120FC		       jnz     loc_4118B1
.text:00412102
.text:00412102 loc_412102:			       ; CODE XREF: _memcmp+D06j
.text:00412102		       movzx   esi, byte ptr [eax-1Bh]
.text:00412106		       movzx   edx, byte ptr [ecx-1Bh]
.text:0041210A		       sub     esi, edx
.text:0041210C		       jz      short loc_41211F
.text:0041210E		       xor     edx, edx
.text:00412110		       test    esi, esi
.text:00412112		       setnle  dl
.text:00412115		       lea     edx, [edx+edx-1]
.text:00412119		       mov     esi, edx
.text:0041211B		       jmp     short loc_41211F
.text:0041211D ; ---------------------------------------------------------------------------
.text:0041211D
.text:0041211D loc_41211D:			       ; CODE XREF: _memcmp+CB9j
.text:0041211D		       xor     esi, esi
.text:0041211F
.text:0041211F loc_41211F:			       ; CODE XREF: _memcmp+D27j
.text:0041211F					       ; _memcmp+D36j
.text:0041211F		       test    esi, esi
.text:00412121		       jnz     loc_4118B1
.text:00412127
.text:00412127 $LN100:				       ; CODE XREF: _memcmp+4C5j
.text:00412127					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412127		       mov     edx, [eax-1Ah]  ; jumptable 004118AA case 26
.text:0041212A		       cmp     edx, [ecx-1Ah]
.text:0041212D		       jz      short loc_4121AC
.text:0041212F		       movzx   esi, dl
.text:00412132		       movzx   edx, byte ptr [ecx-1Ah]
.text:00412136		       sub     esi, edx
.text:00412138		       jz      short loc_41214F
.text:0041213A		       xor     edx, edx
.text:0041213C		       test    esi, esi
.text:0041213E		       setnle  dl
.text:00412141		       lea     edx, [edx+edx-1]
.text:00412145		       mov     esi, edx
.text:00412147		       test    esi, esi
.text:00412149		       jnz     loc_4118B1
.text:0041214F
.text:0041214F loc_41214F:			       ; CODE XREF: _memcmp+D53j
.text:0041214F		       movzx   esi, byte ptr [eax-19h]
.text:00412153		       movzx   edx, byte ptr [ecx-19h]
.text:00412157		       sub     esi, edx
.text:00412159		       jz      short loc_412170
.text:0041215B		       xor     edx, edx
.text:0041215D		       test    esi, esi
.text:0041215F		       setnle  dl
.text:00412162		       lea     edx, [edx+edx-1]
.text:00412166		       mov     esi, edx
.text:00412168		       test    esi, esi
.text:0041216A		       jnz     loc_4118B1
.text:00412170
.text:00412170 loc_412170:			       ; CODE XREF: _memcmp+D74j
.text:00412170		       movzx   esi, byte ptr [eax-18h]
.text:00412174		       movzx   edx, byte ptr [ecx-18h]
.text:00412178		       sub     esi, edx
.text:0041217A		       jz      short loc_412191
.text:0041217C		       xor     edx, edx
.text:0041217E		       test    esi, esi
.text:00412180		       setnle  dl
.text:00412183		       lea     edx, [edx+edx-1]
.text:00412187		       mov     esi, edx
.text:00412189		       test    esi, esi
.text:0041218B		       jnz     loc_4118B1
.text:00412191
.text:00412191 loc_412191:			       ; CODE XREF: _memcmp+D95j
.text:00412191		       movzx   esi, byte ptr [eax-17h]
.text:00412195		       movzx   edx, byte ptr [ecx-17h]
.text:00412199		       sub     esi, edx
.text:0041219B		       jz      short loc_4121AE
.text:0041219D		       xor     edx, edx
.text:0041219F		       test    esi, esi
.text:004121A1		       setnle  dl
.text:004121A4		       lea     edx, [edx+edx-1]
.text:004121A8		       mov     esi, edx
.text:004121AA		       jmp     short loc_4121AE
.text:004121AC ; ---------------------------------------------------------------------------
.text:004121AC
.text:004121AC loc_4121AC:			       ; CODE XREF: _memcmp+D48j
.text:004121AC		       xor     esi, esi
.text:004121AE
.text:004121AE loc_4121AE:			       ; CODE XREF: _memcmp+DB6j
.text:004121AE					       ; _memcmp+DC5j
.text:004121AE		       test    esi, esi
.text:004121B0		       jnz     loc_4118B1
.text:004121B6
.text:004121B6 $LN98:				       ; CODE XREF: _memcmp+4C5j
.text:004121B6					       ; DATA XREF: _memcmp:off_4129E5o
.text:004121B6		       mov     edx, [eax-16h]  ; jumptable 004118AA case 22
.text:004121B9		       cmp     edx, [ecx-16h]
.text:004121BC		       jz      short loc_41223B
.text:004121BE		       movzx   esi, dl
.text:004121C1		       movzx   edx, byte ptr [ecx-16h]
.text:004121C5		       sub     esi, edx
.text:004121C7		       jz      short loc_4121DE
.text:004121C9		       xor     edx, edx
.text:004121CB		       test    esi, esi
.text:004121CD		       setnle  dl
.text:004121D0		       lea     edx, [edx+edx-1]
.text:004121D4		       mov     esi, edx
.text:004121D6		       test    esi, esi
.text:004121D8		       jnz     loc_4118B1
.text:004121DE
.text:004121DE loc_4121DE:			       ; CODE XREF: _memcmp+DE2j
.text:004121DE		       movzx   esi, byte ptr [eax-15h]
.text:004121E2		       movzx   edx, byte ptr [ecx-15h]
.text:004121E6		       sub     esi, edx
.text:004121E8		       jz      short loc_4121FF
.text:004121EA		       xor     edx, edx
.text:004121EC		       test    esi, esi
.text:004121EE		       setnle  dl
.text:004121F1		       lea     edx, [edx+edx-1]
.text:004121F5		       mov     esi, edx
.text:004121F7		       test    esi, esi
.text:004121F9		       jnz     loc_4118B1
.text:004121FF
.text:004121FF loc_4121FF:			       ; CODE XREF: _memcmp+E03j
.text:004121FF		       movzx   esi, byte ptr [eax-14h]
.text:00412203		       movzx   edx, byte ptr [ecx-14h]
.text:00412207		       sub     esi, edx
.text:00412209		       jz      short loc_412220
.text:0041220B		       xor     edx, edx
.text:0041220D		       test    esi, esi
.text:0041220F		       setnle  dl
.text:00412212		       lea     edx, [edx+edx-1]
.text:00412216		       mov     esi, edx
.text:00412218		       test    esi, esi
.text:0041221A		       jnz     loc_4118B1
.text:00412220
.text:00412220 loc_412220:			       ; CODE XREF: _memcmp+E24j
.text:00412220		       movzx   esi, byte ptr [eax-13h]
.text:00412224		       movzx   edx, byte ptr [ecx-13h]
.text:00412228		       sub     esi, edx
.text:0041222A		       jz      short loc_41223D
.text:0041222C		       xor     edx, edx
.text:0041222E		       test    esi, esi
.text:00412230		       setnle  dl
.text:00412233		       lea     edx, [edx+edx-1]
.text:00412237		       mov     esi, edx
.text:00412239		       jmp     short loc_41223D
.text:0041223B ; ---------------------------------------------------------------------------
.text:0041223B
.text:0041223B loc_41223B:			       ; CODE XREF: _memcmp+DD7j
.text:0041223B		       xor     esi, esi
.text:0041223D
.text:0041223D loc_41223D:			       ; CODE XREF: _memcmp+E45j
.text:0041223D					       ; _memcmp+E54j
.text:0041223D		       test    esi, esi
.text:0041223F		       jnz     loc_4118B1
.text:00412245
.text:00412245 $LN96_0:				       ; CODE XREF: _memcmp+4C5j
.text:00412245					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412245		       mov     edx, [eax-12h]  ; jumptable 004118AA case 18
.text:00412248		       cmp     edx, [ecx-12h]
.text:0041224B		       jz      short loc_4122CA
.text:0041224D		       movzx   esi, dl
.text:00412250		       movzx   edx, byte ptr [ecx-12h]
.text:00412254		       sub     esi, edx
.text:00412256		       jz      short loc_41226D
.text:00412258		       xor     edx, edx
.text:0041225A		       test    esi, esi
.text:0041225C		       setnle  dl
.text:0041225F		       lea     edx, [edx+edx-1]
.text:00412263		       mov     esi, edx
.text:00412265		       test    esi, esi
.text:00412267		       jnz     loc_4118B1
.text:0041226D
.text:0041226D loc_41226D:			       ; CODE XREF: _memcmp+E71j
.text:0041226D		       movzx   esi, byte ptr [eax-11h]
.text:00412271		       movzx   edx, byte ptr [ecx-11h]
.text:00412275		       sub     esi, edx
.text:00412277		       jz      short loc_41228E
.text:00412279		       xor     edx, edx
.text:0041227B		       test    esi, esi
.text:0041227D		       setnle  dl
.text:00412280		       lea     edx, [edx+edx-1]
.text:00412284		       mov     esi, edx
.text:00412286		       test    esi, esi
.text:00412288		       jnz     loc_4118B1
.text:0041228E
.text:0041228E loc_41228E:			       ; CODE XREF: _memcmp+E92j
.text:0041228E		       movzx   esi, byte ptr [eax-10h]
.text:00412292		       movzx   edx, byte ptr [ecx-10h]
.text:00412296		       sub     esi, edx
.text:00412298		       jz      short loc_4122AF
.text:0041229A		       xor     edx, edx
.text:0041229C		       test    esi, esi
.text:0041229E		       setnle  dl
.text:004122A1		       lea     edx, [edx+edx-1]
.text:004122A5		       mov     esi, edx
.text:004122A7		       test    esi, esi
.text:004122A9		       jnz     loc_4118B1
.text:004122AF
.text:004122AF loc_4122AF:			       ; CODE XREF: _memcmp+EB3j
.text:004122AF		       movzx   esi, byte ptr [eax-0Fh]
.text:004122B3		       movzx   edx, byte ptr [ecx-0Fh]
.text:004122B7		       sub     esi, edx
.text:004122B9		       jz      short loc_4122CC
.text:004122BB		       xor     edx, edx
.text:004122BD		       test    esi, esi
.text:004122BF		       setnle  dl
.text:004122C2		       lea     edx, [edx+edx-1]
.text:004122C6		       mov     esi, edx
.text:004122C8		       jmp     short loc_4122CC
.text:004122CA ; ---------------------------------------------------------------------------
.text:004122CA
.text:004122CA loc_4122CA:			       ; CODE XREF: _memcmp+E66j
.text:004122CA		       xor     esi, esi
.text:004122CC
.text:004122CC loc_4122CC:			       ; CODE XREF: _memcmp+ED4j
.text:004122CC					       ; _memcmp+EE3j
.text:004122CC		       test    esi, esi
.text:004122CE		       jnz     loc_4118B1
.text:004122D4
.text:004122D4 $LN94:				       ; CODE XREF: _memcmp+4C5j
.text:004122D4					       ; DATA XREF: _memcmp:off_4129E5o
.text:004122D4		       mov     edx, [eax-0Eh]  ; jumptable 004118AA case 14
.text:004122D7		       cmp     edx, [ecx-0Eh]
.text:004122DA		       jz      short loc_412359
.text:004122DC		       movzx   esi, dl
.text:004122DF		       movzx   edx, byte ptr [ecx-0Eh]
.text:004122E3		       sub     esi, edx
.text:004122E5		       jz      short loc_4122FC
.text:004122E7		       xor     edx, edx
.text:004122E9		       test    esi, esi
.text:004122EB		       setnle  dl
.text:004122EE		       lea     edx, [edx+edx-1]
.text:004122F2		       mov     esi, edx
.text:004122F4		       test    esi, esi
.text:004122F6		       jnz     loc_4118B1
.text:004122FC
.text:004122FC loc_4122FC:			       ; CODE XREF: _memcmp+F00j
.text:004122FC		       movzx   esi, byte ptr [eax-0Dh]
.text:00412300		       movzx   edx, byte ptr [ecx-0Dh]
.text:00412304		       sub     esi, edx
.text:00412306		       jz      short loc_41231D
.text:00412308		       xor     edx, edx
.text:0041230A		       test    esi, esi
.text:0041230C		       setnle  dl
.text:0041230F		       lea     edx, [edx+edx-1]
.text:00412313		       mov     esi, edx
.text:00412315		       test    esi, esi
.text:00412317		       jnz     loc_4118B1
.text:0041231D
.text:0041231D loc_41231D:			       ; CODE XREF: _memcmp+F21j
.text:0041231D		       movzx   esi, byte ptr [eax-0Ch]
.text:00412321		       movzx   edx, byte ptr [ecx-0Ch]
.text:00412325		       sub     esi, edx
.text:00412327		       jz      short loc_41233E
.text:00412329		       xor     edx, edx
.text:0041232B		       test    esi, esi
.text:0041232D		       setnle  dl
.text:00412330		       lea     edx, [edx+edx-1]
.text:00412334		       mov     esi, edx
.text:00412336		       test    esi, esi
.text:00412338		       jnz     loc_4118B1
.text:0041233E
.text:0041233E loc_41233E:			       ; CODE XREF: _memcmp+F42j
.text:0041233E		       movzx   esi, byte ptr [eax-0Bh]
.text:00412342		       movzx   edx, byte ptr [ecx-0Bh]
.text:00412346		       sub     esi, edx
.text:00412348		       jz      short loc_41235B
.text:0041234A		       xor     edx, edx
.text:0041234C		       test    esi, esi
.text:0041234E		       setnle  dl
.text:00412351		       lea     edx, [edx+edx-1]
.text:00412355		       mov     esi, edx
.text:00412357		       jmp     short loc_41235B
.text:00412359 ; ---------------------------------------------------------------------------
.text:00412359
.text:00412359 loc_412359:			       ; CODE XREF: _memcmp+EF5j
.text:00412359		       xor     esi, esi
.text:0041235B
.text:0041235B loc_41235B:			       ; CODE XREF: _memcmp+F63j
.text:0041235B					       ; _memcmp+F72j
.text:0041235B		       test    esi, esi
.text:0041235D		       jnz     loc_4118B1
.text:00412363
.text:00412363 $LN92:				       ; CODE XREF: _memcmp+4C5j
.text:00412363					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412363		       mov     edx, [eax-0Ah]  ; jumptable 004118AA case 10
.text:00412366		       cmp     edx, [ecx-0Ah]
.text:00412369		       jz      short loc_4123E9
.text:0041236B		       movzx   edx, byte ptr [ecx-0Ah]
.text:0041236F		       movzx   esi, byte ptr [eax-0Ah]
.text:00412373		       sub     esi, edx
.text:00412375		       jz      short loc_41238C
.text:00412377		       xor     edx, edx
.text:00412379		       test    esi, esi
.text:0041237B		       setnle  dl
.text:0041237E		       lea     edx, [edx+edx-1]
.text:00412382		       mov     esi, edx
.text:00412384		       test    esi, esi
.text:00412386		       jnz     loc_4118B1
.text:0041238C
.text:0041238C loc_41238C:			       ; CODE XREF: _memcmp+F90j
.text:0041238C		       movzx   edx, byte ptr [ecx-9]
.text:00412390		       movzx   esi, byte ptr [eax-9]
.text:00412394		       sub     esi, edx
.text:00412396		       jz      short loc_4123AD
.text:00412398		       xor     edx, edx
.text:0041239A		       test    esi, esi
.text:0041239C		       setnle  dl
.text:0041239F		       lea     edx, [edx+edx-1]
.text:004123A3		       mov     esi, edx
.text:004123A5		       test    esi, esi
.text:004123A7		       jnz     loc_4118B1
.text:004123AD
.text:004123AD loc_4123AD:			       ; CODE XREF: _memcmp+FB1j
.text:004123AD		       movzx   edx, byte ptr [ecx-8]
.text:004123B1		       movzx   esi, byte ptr [eax-8]
.text:004123B5		       sub     esi, edx
.text:004123B7		       jz      short loc_4123CE
.text:004123B9		       xor     edx, edx
.text:004123BB		       test    esi, esi
.text:004123BD		       setnle  dl
.text:004123C0		       lea     edx, [edx+edx-1]
.text:004123C4		       mov     esi, edx
.text:004123C6		       test    esi, esi
.text:004123C8		       jnz     loc_4118B1
.text:004123CE
.text:004123CE loc_4123CE:			       ; CODE XREF: _memcmp+FD2j
.text:004123CE		       movzx   edx, byte ptr [ecx-7]
.text:004123D2		       movzx   esi, byte ptr [eax-7]
.text:004123D6		       sub     esi, edx
.text:004123D8		       jz      short loc_4123EB
.text:004123DA		       xor     edx, edx
.text:004123DC		       test    esi, esi
.text:004123DE		       setnle  dl
.text:004123E1		       lea     edx, [edx+edx-1]
.text:004123E5		       mov     esi, edx
.text:004123E7		       jmp     short loc_4123EB
.text:004123E9 ; ---------------------------------------------------------------------------
.text:004123E9
.text:004123E9 loc_4123E9:			       ; CODE XREF: _memcmp+F84j
.text:004123E9		       xor     esi, esi
.text:004123EB
.text:004123EB loc_4123EB:			       ; CODE XREF: _memcmp+FF3j
.text:004123EB					       ; _memcmp+1002j
.text:004123EB		       test    esi, esi
.text:004123ED		       jnz     loc_4118B1
.text:004123F3
.text:004123F3 $LN90:				       ; CODE XREF: _memcmp+4C5j
.text:004123F3					       ; DATA XREF: _memcmp:off_4129E5o
.text:004123F3		       mov     edx, [eax-6]    ; jumptable 004118AA case 6
.text:004123F6		       cmp     edx, [ecx-6]
.text:004123F9		       jz      short loc_412478
.text:004123FB		       movzx   esi, dl
.text:004123FE		       movzx   edx, byte ptr [ecx-6]
.text:00412402		       sub     esi, edx
.text:00412404		       jz      short loc_41241B
.text:00412406		       xor     edx, edx
.text:00412408		       test    esi, esi
.text:0041240A		       setnle  dl
.text:0041240D		       lea     edx, [edx+edx-1]
.text:00412411		       mov     esi, edx
.text:00412413		       test    esi, esi
.text:00412415		       jnz     loc_4118B1
.text:0041241B
.text:0041241B loc_41241B:			       ; CODE XREF: _memcmp+101Fj
.text:0041241B		       movzx   esi, byte ptr [eax-5]
.text:0041241F		       movzx   edx, byte ptr [ecx-5]
.text:00412423		       sub     esi, edx
.text:00412425		       jz      short loc_41243C
.text:00412427		       xor     edx, edx
.text:00412429		       test    esi, esi
.text:0041242B		       setnle  dl
.text:0041242E		       lea     edx, [edx+edx-1]
.text:00412432		       mov     esi, edx
.text:00412434		       test    esi, esi
.text:00412436		       jnz     loc_4118B1
.text:0041243C
.text:0041243C loc_41243C:			       ; CODE XREF: _memcmp+1040j
.text:0041243C		       movzx   esi, byte ptr [eax-4]
.text:00412440		       movzx   edx, byte ptr [ecx-4]
.text:00412444		       sub     esi, edx
.text:00412446		       jz      short loc_41245D
.text:00412448		       xor     edx, edx
.text:0041244A		       test    esi, esi
.text:0041244C		       setnle  dl
.text:0041244F		       lea     edx, [edx+edx-1]
.text:00412453		       mov     esi, edx
.text:00412455		       test    esi, esi
.text:00412457		       jnz     loc_4118B1
.text:0041245D
.text:0041245D loc_41245D:			       ; CODE XREF: _memcmp+1061j
.text:0041245D		       movzx   esi, byte ptr [eax-3]
.text:00412461		       movzx   edx, byte ptr [ecx-3]
.text:00412465		       sub     esi, edx
.text:00412467		       jz      short loc_41247A
.text:00412469		       xor     edx, edx
.text:0041246B		       test    esi, esi
.text:0041246D		       setnle  dl
.text:00412470		       lea     edx, [edx+edx-1]
.text:00412474		       mov     esi, edx
.text:00412476		       jmp     short loc_41247A
.text:00412478 ; ---------------------------------------------------------------------------
.text:00412478
.text:00412478 loc_412478:			       ; CODE XREF: _memcmp+1014j
.text:00412478		       xor     esi, esi
.text:0041247A
.text:0041247A loc_41247A:			       ; CODE XREF: _memcmp+1082j
.text:0041247A					       ; _memcmp+1091j
.text:0041247A		       test    esi, esi
.text:0041247C		       jnz     loc_4118B1
.text:00412482
.text:00412482 $LN88:				       ; CODE XREF: _memcmp+4C5j
.text:00412482					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412482		       mov     dx, [eax-2]     ; jumptable 004118AA case 2
.text:00412486		       cmp     dx, [ecx-2]
.text:0041248A		       jz      $LN132	       ; default
.text:0041248A					       ; jumptable 004118AA case 0
.text:00412490
.text:00412490 loc_412490:			       ; CODE XREF: _memcmp+14C8j
.text:00412490					       ; _memcmp+14DBj
.text:00412490		       movzx   edx, byte ptr [ecx-2]
.text:00412494		       movzx   esi, byte ptr [eax-2]
.text:00412498		       sub     esi, edx
.text:0041249A		       jz      $LN103	       ; jumptable 004118AA case 1
.text:004124A0		       xor     edx, edx
.text:004124A2		       test    esi, esi
.text:004124A4		       setnle  dl
.text:004124A7		       lea     edx, [edx+edx-1]
.text:004124AB		       test    edx, edx
.text:004124AD		       jnz     loc_4128C6
.text:004124B3		       jmp     $LN103	       ; jumptable 004118AA case 1
.text:004124B8 ; ---------------------------------------------------------------------------
.text:004124B8
.text:004124B8 $LN86:				       ; CODE XREF: _memcmp+4C5j
.text:004124B8					       ; DATA XREF: _memcmp:off_4129E5o
.text:004124B8		       mov     edx, [eax-1Fh]  ; jumptable 004118AA case 31
.text:004124BB		       cmp     edx, [ecx-1Fh]
.text:004124BE		       jz      short loc_41253E
.text:004124C0		       movzx   edx, byte ptr [ecx-1Fh]
.text:004124C4		       movzx   esi, byte ptr [eax-1Fh]
.text:004124C8		       sub     esi, edx
.text:004124CA		       jz      short loc_4124E1
.text:004124CC		       xor     edx, edx
.text:004124CE		       test    esi, esi
.text:004124D0		       setnle  dl
.text:004124D3		       lea     edx, [edx+edx-1]
.text:004124D7		       mov     esi, edx
.text:004124D9		       test    esi, esi
.text:004124DB		       jnz     loc_4118B1
.text:004124E1
.text:004124E1 loc_4124E1:			       ; CODE XREF: _memcmp+10E5j
.text:004124E1		       movzx   esi, byte ptr [eax-1Eh]
.text:004124E5		       movzx   edx, byte ptr [ecx-1Eh]
.text:004124E9		       sub     esi, edx
.text:004124EB		       jz      short loc_412502
.text:004124ED		       xor     edx, edx
.text:004124EF		       test    esi, esi
.text:004124F1		       setnle  dl
.text:004124F4		       lea     edx, [edx+edx-1]
.text:004124F8		       mov     esi, edx
.text:004124FA		       test    esi, esi
.text:004124FC		       jnz     loc_4118B1
.text:00412502
.text:00412502 loc_412502:			       ; CODE XREF: _memcmp+1106j
.text:00412502		       movzx   esi, byte ptr [eax-1Dh]
.text:00412506		       movzx   edx, byte ptr [ecx-1Dh]
.text:0041250A		       sub     esi, edx
.text:0041250C		       jz      short loc_412523
.text:0041250E		       xor     edx, edx
.text:00412510		       test    esi, esi
.text:00412512		       setnle  dl
.text:00412515		       lea     edx, [edx+edx-1]
.text:00412519		       mov     esi, edx
.text:0041251B		       test    esi, esi
.text:0041251D		       jnz     loc_4118B1
.text:00412523
.text:00412523 loc_412523:			       ; CODE XREF: _memcmp+1127j
.text:00412523		       movzx   esi, byte ptr [eax-1Ch]
.text:00412527		       movzx   edx, byte ptr [ecx-1Ch]
.text:0041252B		       sub     esi, edx
.text:0041252D		       jz      short loc_412540
.text:0041252F		       xor     edx, edx
.text:00412531		       test    esi, esi
.text:00412533		       setnle  dl
.text:00412536		       lea     edx, [edx+edx-1]
.text:0041253A		       mov     esi, edx
.text:0041253C		       jmp     short loc_412540
.text:0041253E ; ---------------------------------------------------------------------------
.text:0041253E
.text:0041253E loc_41253E:			       ; CODE XREF: _memcmp+10D9j
.text:0041253E		       xor     esi, esi
.text:00412540
.text:00412540 loc_412540:			       ; CODE XREF: _memcmp+1148j
.text:00412540					       ; _memcmp+1157j
.text:00412540		       test    esi, esi
.text:00412542		       jnz     loc_4118B1
.text:00412548
.text:00412548 $LN85:				       ; CODE XREF: _memcmp+4C5j
.text:00412548					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412548		       mov     edx, [eax-1Bh]  ; jumptable 004118AA case 27
.text:0041254B		       cmp     edx, [ecx-1Bh]
.text:0041254E		       jz      short loc_4125CD
.text:00412550		       movzx   esi, dl
.text:00412553		       movzx   edx, byte ptr [ecx-1Bh]
.text:00412557		       sub     esi, edx
.text:00412559		       jz      short loc_412570
.text:0041255B		       xor     edx, edx
.text:0041255D		       test    esi, esi
.text:0041255F		       setnle  dl
.text:00412562		       lea     edx, [edx+edx-1]
.text:00412566		       mov     esi, edx
.text:00412568		       test    esi, esi
.text:0041256A		       jnz     loc_4118B1
.text:00412570
.text:00412570 loc_412570:			       ; CODE XREF: _memcmp+1174j
.text:00412570		       movzx   esi, byte ptr [eax-1Ah]
.text:00412574		       movzx   edx, byte ptr [ecx-1Ah]
.text:00412578		       sub     esi, edx
.text:0041257A		       jz      short loc_412591
.text:0041257C		       xor     edx, edx
.text:0041257E		       test    esi, esi
.text:00412580		       setnle  dl
.text:00412583		       lea     edx, [edx+edx-1]
.text:00412587		       mov     esi, edx
.text:00412589		       test    esi, esi
.text:0041258B		       jnz     loc_4118B1
.text:00412591
.text:00412591 loc_412591:			       ; CODE XREF: _memcmp+1195j
.text:00412591		       movzx   esi, byte ptr [eax-19h]
.text:00412595		       movzx   edx, byte ptr [ecx-19h]
.text:00412599		       sub     esi, edx
.text:0041259B		       jz      short loc_4125B2
.text:0041259D		       xor     edx, edx
.text:0041259F		       test    esi, esi
.text:004125A1		       setnle  dl
.text:004125A4		       lea     edx, [edx+edx-1]
.text:004125A8		       mov     esi, edx
.text:004125AA		       test    esi, esi
.text:004125AC		       jnz     loc_4118B1
.text:004125B2
.text:004125B2 loc_4125B2:			       ; CODE XREF: _memcmp+11B6j
.text:004125B2		       movzx   esi, byte ptr [eax-18h]
.text:004125B6		       movzx   edx, byte ptr [ecx-18h]
.text:004125BA		       sub     esi, edx
.text:004125BC		       jz      short loc_4125CF
.text:004125BE		       xor     edx, edx
.text:004125C0		       test    esi, esi
.text:004125C2		       setnle  dl
.text:004125C5		       lea     edx, [edx+edx-1]
.text:004125C9		       mov     esi, edx
.text:004125CB		       jmp     short loc_4125CF
.text:004125CD ; ---------------------------------------------------------------------------
.text:004125CD
.text:004125CD loc_4125CD:			       ; CODE XREF: _memcmp+1169j
.text:004125CD		       xor     esi, esi
.text:004125CF
.text:004125CF loc_4125CF:			       ; CODE XREF: _memcmp+11D7j
.text:004125CF					       ; _memcmp+11E6j
.text:004125CF		       test    esi, esi
.text:004125D1		       jnz     loc_4118B1
.text:004125D7
.text:004125D7 $LN83:				       ; CODE XREF: _memcmp+4C5j
.text:004125D7					       ; DATA XREF: _memcmp:off_4129E5o
.text:004125D7		       mov     edx, [eax-17h]  ; jumptable 004118AA case 23
.text:004125DA		       cmp     edx, [ecx-17h]
.text:004125DD		       jz      short loc_41265C
.text:004125DF		       movzx   esi, dl
.text:004125E2		       movzx   edx, byte ptr [ecx-17h]
.text:004125E6		       sub     esi, edx
.text:004125E8		       jz      short loc_4125FF
.text:004125EA		       xor     edx, edx
.text:004125EC		       test    esi, esi
.text:004125EE		       setnle  dl
.text:004125F1		       lea     edx, [edx+edx-1]
.text:004125F5		       mov     esi, edx
.text:004125F7		       test    esi, esi
.text:004125F9		       jnz     loc_4118B1
.text:004125FF
.text:004125FF loc_4125FF:			       ; CODE XREF: _memcmp+1203j
.text:004125FF		       movzx   esi, byte ptr [eax-16h]
.text:00412603		       movzx   edx, byte ptr [ecx-16h]
.text:00412607		       sub     esi, edx
.text:00412609		       jz      short loc_412620
.text:0041260B		       xor     edx, edx
.text:0041260D		       test    esi, esi
.text:0041260F		       setnle  dl
.text:00412612		       lea     edx, [edx+edx-1]
.text:00412616		       mov     esi, edx
.text:00412618		       test    esi, esi
.text:0041261A		       jnz     loc_4118B1
.text:00412620
.text:00412620 loc_412620:			       ; CODE XREF: _memcmp+1224j
.text:00412620		       movzx   esi, byte ptr [eax-15h]
.text:00412624		       movzx   edx, byte ptr [ecx-15h]
.text:00412628		       sub     esi, edx
.text:0041262A		       jz      short loc_412641
.text:0041262C		       xor     edx, edx
.text:0041262E		       test    esi, esi
.text:00412630		       setnle  dl
.text:00412633		       lea     edx, [edx+edx-1]
.text:00412637		       mov     esi, edx
.text:00412639		       test    esi, esi
.text:0041263B		       jnz     loc_4118B1
.text:00412641
.text:00412641 loc_412641:			       ; CODE XREF: _memcmp+1245j
.text:00412641		       movzx   esi, byte ptr [eax-14h]
.text:00412645		       movzx   edx, byte ptr [ecx-14h]
.text:00412649		       sub     esi, edx
.text:0041264B		       jz      short loc_41265E
.text:0041264D		       xor     edx, edx
.text:0041264F		       test    esi, esi
.text:00412651		       setnle  dl
.text:00412654		       lea     edx, [edx+edx-1]
.text:00412658		       mov     esi, edx
.text:0041265A		       jmp     short loc_41265E
.text:0041265C ; ---------------------------------------------------------------------------
.text:0041265C
.text:0041265C loc_41265C:			       ; CODE XREF: _memcmp+11F8j
.text:0041265C		       xor     esi, esi
.text:0041265E
.text:0041265E loc_41265E:			       ; CODE XREF: _memcmp+1266j
.text:0041265E					       ; _memcmp+1275j
.text:0041265E		       test    esi, esi
.text:00412660		       jnz     loc_4118B1
.text:00412666
.text:00412666 $LN81:				       ; CODE XREF: _memcmp+4C5j
.text:00412666					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412666		       mov     edx, [eax-13h]  ; jumptable 004118AA case 19
.text:00412669		       cmp     edx, [ecx-13h]
.text:0041266C		       jz      short loc_4126EB
.text:0041266E		       movzx   esi, dl
.text:00412671		       movzx   edx, byte ptr [ecx-13h]
.text:00412675		       sub     esi, edx
.text:00412677		       jz      short loc_41268E
.text:00412679		       xor     edx, edx
.text:0041267B		       test    esi, esi
.text:0041267D		       setnle  dl
.text:00412680		       lea     edx, [edx+edx-1]
.text:00412684		       mov     esi, edx
.text:00412686		       test    esi, esi
.text:00412688		       jnz     loc_4118B1
.text:0041268E
.text:0041268E loc_41268E:			       ; CODE XREF: _memcmp+1292j
.text:0041268E		       movzx   esi, byte ptr [eax-12h]
.text:00412692		       movzx   edx, byte ptr [ecx-12h]
.text:00412696		       sub     esi, edx
.text:00412698		       jz      short loc_4126AF
.text:0041269A		       xor     edx, edx
.text:0041269C		       test    esi, esi
.text:0041269E		       setnle  dl
.text:004126A1		       lea     edx, [edx+edx-1]
.text:004126A5		       mov     esi, edx
.text:004126A7		       test    esi, esi
.text:004126A9		       jnz     loc_4118B1
.text:004126AF
.text:004126AF loc_4126AF:			       ; CODE XREF: _memcmp+12B3j
.text:004126AF		       movzx   esi, byte ptr [eax-11h]
.text:004126B3		       movzx   edx, byte ptr [ecx-11h]
.text:004126B7		       sub     esi, edx
.text:004126B9		       jz      short loc_4126D0
.text:004126BB		       xor     edx, edx
.text:004126BD		       test    esi, esi
.text:004126BF		       setnle  dl
.text:004126C2		       lea     edx, [edx+edx-1]
.text:004126C6		       mov     esi, edx
.text:004126C8		       test    esi, esi
.text:004126CA		       jnz     loc_4118B1
.text:004126D0
.text:004126D0 loc_4126D0:			       ; CODE XREF: _memcmp+12D4j
.text:004126D0		       movzx   esi, byte ptr [eax-10h]
.text:004126D4		       movzx   edx, byte ptr [ecx-10h]
.text:004126D8		       sub     esi, edx
.text:004126DA		       jz      short loc_4126ED
.text:004126DC		       xor     edx, edx
.text:004126DE		       test    esi, esi
.text:004126E0		       setnle  dl
.text:004126E3		       lea     edx, [edx+edx-1]
.text:004126E7		       mov     esi, edx
.text:004126E9		       jmp     short loc_4126ED
.text:004126EB ; ---------------------------------------------------------------------------
.text:004126EB
.text:004126EB loc_4126EB:			       ; CODE XREF: _memcmp+1287j
.text:004126EB		       xor     esi, esi
.text:004126ED
.text:004126ED loc_4126ED:			       ; CODE XREF: _memcmp+12F5j
.text:004126ED					       ; _memcmp+1304j
.text:004126ED		       test    esi, esi
.text:004126EF		       jnz     loc_4118B1
.text:004126F5
.text:004126F5 $LN79:				       ; CODE XREF: _memcmp+4C5j
.text:004126F5					       ; DATA XREF: _memcmp:off_4129E5o
.text:004126F5		       mov     edx, [eax-0Fh]  ; jumptable 004118AA case 15
.text:004126F8		       cmp     edx, [ecx-0Fh]
.text:004126FB		       jz      short loc_41277B
.text:004126FD		       movzx   edx, byte ptr [ecx-0Fh]
.text:00412701		       movzx   esi, byte ptr [eax-0Fh]
.text:00412705		       sub     esi, edx
.text:00412707		       jz      short loc_41271E
.text:00412709		       xor     edx, edx
.text:0041270B		       test    esi, esi
.text:0041270D		       setnle  dl
.text:00412710		       lea     edx, [edx+edx-1]
.text:00412714		       mov     esi, edx
.text:00412716		       test    esi, esi
.text:00412718		       jnz     loc_4118B1
.text:0041271E
.text:0041271E loc_41271E:			       ; CODE XREF: _memcmp+1322j
.text:0041271E		       movzx   esi, byte ptr [eax-0Eh]
.text:00412722		       movzx   edx, byte ptr [ecx-0Eh]
.text:00412726		       sub     esi, edx
.text:00412728		       jz      short loc_41273F
.text:0041272A		       xor     edx, edx
.text:0041272C		       test    esi, esi
.text:0041272E		       setnle  dl
.text:00412731		       lea     edx, [edx+edx-1]
.text:00412735		       mov     esi, edx
.text:00412737		       test    esi, esi
.text:00412739		       jnz     loc_4118B1
.text:0041273F
.text:0041273F loc_41273F:			       ; CODE XREF: _memcmp+1343j
.text:0041273F		       movzx   esi, byte ptr [eax-0Dh]
.text:00412743		       movzx   edx, byte ptr [ecx-0Dh]
.text:00412747		       sub     esi, edx
.text:00412749		       jz      short loc_412760
.text:0041274B		       xor     edx, edx
.text:0041274D		       test    esi, esi
.text:0041274F		       setnle  dl
.text:00412752		       lea     edx, [edx+edx-1]
.text:00412756		       mov     esi, edx
.text:00412758		       test    esi, esi
.text:0041275A		       jnz     loc_4118B1
.text:00412760
.text:00412760 loc_412760:			       ; CODE XREF: _memcmp+1364j
.text:00412760		       movzx   esi, byte ptr [eax-0Ch]
.text:00412764		       movzx   edx, byte ptr [ecx-0Ch]
.text:00412768		       sub     esi, edx
.text:0041276A		       jz      short loc_41277D
.text:0041276C		       xor     edx, edx
.text:0041276E		       test    esi, esi
.text:00412770		       setnle  dl
.text:00412773		       lea     edx, [edx+edx-1]
.text:00412777		       mov     esi, edx
.text:00412779		       jmp     short loc_41277D
.text:0041277B ; ---------------------------------------------------------------------------
.text:0041277B
.text:0041277B loc_41277B:			       ; CODE XREF: _memcmp+1316j
.text:0041277B		       xor     esi, esi
.text:0041277D
.text:0041277D loc_41277D:			       ; CODE XREF: _memcmp+1385j
.text:0041277D					       ; _memcmp+1394j
.text:0041277D		       test    esi, esi
.text:0041277F		       jnz     loc_4118B1
.text:00412785
.text:00412785 $LN77:				       ; CODE XREF: _memcmp+4C5j
.text:00412785					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412785		       mov     edx, [eax-0Bh]  ; jumptable 004118AA case 11
.text:00412788		       cmp     edx, [ecx-0Bh]
.text:0041278B		       jz      short loc_41280A
.text:0041278D		       movzx   esi, dl
.text:00412790		       movzx   edx, byte ptr [ecx-0Bh]
.text:00412794		       sub     esi, edx
.text:00412796		       jz      short loc_4127AD
.text:00412798		       xor     edx, edx
.text:0041279A		       test    esi, esi
.text:0041279C		       setnle  dl
.text:0041279F		       lea     edx, [edx+edx-1]
.text:004127A3		       mov     esi, edx
.text:004127A5		       test    esi, esi
.text:004127A7		       jnz     loc_4118B1
.text:004127AD
.text:004127AD loc_4127AD:			       ; CODE XREF: _memcmp+13B1j
.text:004127AD		       movzx   esi, byte ptr [eax-0Ah]
.text:004127B1		       movzx   edx, byte ptr [ecx-0Ah]
.text:004127B5		       sub     esi, edx
.text:004127B7		       jz      short loc_4127CE
.text:004127B9		       xor     edx, edx
.text:004127BB		       test    esi, esi
.text:004127BD		       setnle  dl
.text:004127C0		       lea     edx, [edx+edx-1]
.text:004127C4		       mov     esi, edx
.text:004127C6		       test    esi, esi
.text:004127C8		       jnz     loc_4118B1
.text:004127CE
.text:004127CE loc_4127CE:			       ; CODE XREF: _memcmp+13D2j
.text:004127CE		       movzx   esi, byte ptr [eax-9]
.text:004127D2		       movzx   edx, byte ptr [ecx-9]
.text:004127D6		       sub     esi, edx
.text:004127D8		       jz      short loc_4127EF
.text:004127DA		       xor     edx, edx
.text:004127DC		       test    esi, esi
.text:004127DE		       setnle  dl
.text:004127E1		       lea     edx, [edx+edx-1]
.text:004127E5		       mov     esi, edx
.text:004127E7		       test    esi, esi
.text:004127E9		       jnz     loc_4118B1
.text:004127EF
.text:004127EF loc_4127EF:			       ; CODE XREF: _memcmp+13F3j
.text:004127EF		       movzx   esi, byte ptr [eax-8]
.text:004127F3		       movzx   edx, byte ptr [ecx-8]
.text:004127F7		       sub     esi, edx
.text:004127F9		       jz      short loc_41280C
.text:004127FB		       xor     edx, edx
.text:004127FD		       test    esi, esi
.text:004127FF		       setnle  dl
.text:00412802		       lea     edx, [edx+edx-1]
.text:00412806		       mov     esi, edx
.text:00412808		       jmp     short loc_41280C
.text:0041280A ; ---------------------------------------------------------------------------
.text:0041280A
.text:0041280A loc_41280A:			       ; CODE XREF: _memcmp+13A6j
.text:0041280A		       xor     esi, esi
.text:0041280C
.text:0041280C loc_41280C:			       ; CODE XREF: _memcmp+1414j
.text:0041280C					       ; _memcmp+1423j
.text:0041280C		       test    esi, esi
.text:0041280E		       jnz     loc_4118B1
.text:00412814
.text:00412814 $LN75:				       ; CODE XREF: _memcmp+4C5j
.text:00412814					       ; DATA XREF: _memcmp:off_4129E5o
.text:00412814		       mov     edx, [eax-7]    ; jumptable 004118AA case 7
.text:00412817		       cmp     edx, [ecx-7]
.text:0041281A		       jz      short loc_412899
.text:0041281C		       movzx   esi, dl
.text:0041281F		       movzx   edx, byte ptr [ecx-7]
.text:00412823		       sub     esi, edx
.text:00412825		       jz      short loc_41283C
.text:00412827		       xor     edx, edx
.text:00412829		       test    esi, esi
.text:0041282B		       setnle  dl
.text:0041282E		       lea     edx, [edx+edx-1]
.text:00412832		       mov     esi, edx
.text:00412834		       test    esi, esi
.text:00412836		       jnz     loc_4118B1
.text:0041283C
.text:0041283C loc_41283C:			       ; CODE XREF: _memcmp+1440j
.text:0041283C		       movzx   esi, byte ptr [eax-6]
.text:00412840		       movzx   edx, byte ptr [ecx-6]
.text:00412844		       sub     esi, edx
.text:00412846		       jz      short loc_41285D
.text:00412848		       xor     edx, edx
.text:0041284A		       test    esi, esi
.text:0041284C		       setnle  dl
.text:0041284F		       lea     edx, [edx+edx-1]
.text:00412853		       mov     esi, edx
.text:00412855		       test    esi, esi
.text:00412857		       jnz     loc_4118B1
.text:0041285D
.text:0041285D loc_41285D:			       ; CODE XREF: _memcmp+1461j
.text:0041285D		       movzx   esi, byte ptr [eax-5]
.text:00412861		       movzx   edx, byte ptr [ecx-5]
.text:00412865		       sub     esi, edx
.text:00412867		       jz      short loc_41287E
.text:00412869		       xor     edx, edx
.text:0041286B		       test    esi, esi
.text:0041286D		       setnle  dl
.text:00412870		       lea     edx, [edx+edx-1]
.text:00412874		       mov     esi, edx
.text:00412876		       test    esi, esi
.text:00412878		       jnz     loc_4118B1
.text:0041287E
.text:0041287E loc_41287E:			       ; CODE XREF: _memcmp+1482j
.text:0041287E		       movzx   esi, byte ptr [eax-4]
.text:00412882		       movzx   edx, byte ptr [ecx-4]
.text:00412886		       sub     esi, edx
.text:00412888		       jz      short loc_41289B
.text:0041288A		       xor     edx, edx
.text:0041288C		       test    esi, esi
.text:0041288E		       setnle  dl
.text:00412891		       lea     edx, [edx+edx-1]
.text:00412895		       mov     esi, edx
.text:00412897		       jmp     short loc_41289B
.text:00412899 ; ---------------------------------------------------------------------------
.text:00412899
.text:00412899 loc_412899:			       ; CODE XREF: _memcmp+1435j
.text:00412899		       xor     esi, esi
.text:0041289B
.text:0041289B loc_41289B:			       ; CODE XREF: _memcmp+14A3j
.text:0041289B					       ; _memcmp+14B2j
.text:0041289B		       test    esi, esi
.text:0041289D		       jnz     loc_4118B1
.text:004128A3
.text:004128A3 $LN73:				       ; CODE XREF: _memcmp+4C5j
.text:004128A3					       ; DATA XREF: _memcmp:off_4129E5o
.text:004128A3		       movzx   esi, byte ptr [eax-3] ; jumptable 004118AA case 3
.text:004128A7		       movzx   edx, byte ptr [ecx-3]
.text:004128AB		       sub     esi, edx
.text:004128AD		       jz      loc_412490
.text:004128B3		       xor     edx, edx
.text:004128B5		       test    esi, esi
.text:004128B7		       setnle  dl
.text:004128BA		       lea     edx, [edx+edx-1]
.text:004128BE		       test    edx, edx
.text:004128C0		       jz      loc_412490
.text:004128C6
.text:004128C6 loc_4128C6:			       ; CODE XREF: _memcmp+10C8j
.text:004128C6		       mov     eax, edx
.text:004128C8		       jmp     loc_411C86
.text:004128CD ; ---------------------------------------------------------------------------
.text:004128CD
.text:004128CD loc_4128CD:			       ; CODE XREF: _memcmp+29j
.text:004128CD		       mov     ecx, [ebp+lhs]
.text:004128D0		       mov     esi, [ebp+rhs]
.text:004128D3		       movzx   eax, byte ptr [ecx]
.text:004128D6		       movzx   edx, byte ptr [esi]
.text:004128D9		       sub     eax, edx
.text:004128DB		       jz      short loc_4128F2
.text:004128DD		       xor     edx, edx
.text:004128DF		       test    eax, eax
.text:004128E1		       setnle  dl
.text:004128E4		       lea     edx, [edx+edx-1]
.text:004128E8		       mov     eax, edx
.text:004128EA		       test    eax, eax
.text:004128EC		       jnz     loc_4129DF
.text:004128F2
.text:004128F2 loc_4128F2:			       ; CODE XREF: _memcmp+14F6j
.text:004128F2		       movzx   eax, byte ptr [ecx+1]
.text:004128F6		       movzx   edx, byte ptr [esi+1]
.text:004128FA		       sub     eax, edx
.text:004128FC		       jz      short loc_412913
.text:004128FE		       xor     edx, edx
.text:00412900		       test    eax, eax
.text:00412902		       setnle  dl
.text:00412905		       lea     edx, [edx+edx-1]
.text:00412909		       mov     eax, edx
.text:0041290B		       test    eax, eax
.text:0041290D		       jnz     loc_4129DF
.text:00412913
.text:00412913 loc_412913:			       ; CODE XREF: _memcmp+1517j
.text:00412913		       movzx   eax, byte ptr [ecx+2]
.text:00412917		       movzx   edx, byte ptr [esi+2]
.text:0041291B		       sub     eax, edx
.text:0041291D		       jz      short loc_412934
.text:0041291F		       xor     edx, edx
.text:00412921		       test    eax, eax
.text:00412923		       setnle  dl
.text:00412926		       lea     edx, [edx+edx-1]
.text:0041292A		       mov     eax, edx
.text:0041292C		       test    eax, eax
.text:0041292E		       jnz     loc_4129DF
.text:00412934
.text:00412934 loc_412934:			       ; CODE XREF: _memcmp+1538j
.text:00412934		       movzx   eax, byte ptr [ecx+3]
.text:00412938		       movzx   ecx, byte ptr [esi+3]
.text:0041293C
.text:0041293C loc_41293C:			       ; CODE XREF: _memcmp+15B7j
.text:0041293C					       ; _memcmp+15E2j	...
.text:0041293C		       sub     eax, ecx
.text:0041293E		       jz      loc_4129DF
.text:00412944		       xor     ecx, ecx
.text:00412946		       test    eax, eax
.text:00412948		       setnle  cl
.text:0041294B		       lea     ecx, [ecx+ecx-1]
.text:0041294F		       mov     eax, ecx
.text:00412951		       jmp     loc_4129DF
.text:00412956 ; ---------------------------------------------------------------------------
.text:00412956
.text:00412956 loc_412956:			       ; CODE XREF: _memcmp+22j
.text:00412956		       mov     ecx, [ebp+lhs]
.text:00412959		       mov     esi, [ebp+rhs]
.text:0041295C		       movzx   eax, byte ptr [ecx]
.text:0041295F		       movzx   edx, byte ptr [esi]
.text:00412962		       sub     eax, edx
.text:00412964		       jz      short loc_412977
.text:00412966		       xor     edx, edx
.text:00412968		       test    eax, eax
.text:0041296A		       setnle  dl
.text:0041296D		       lea     edx, [edx+edx-1]
.text:00412971		       mov     eax, edx
.text:00412973		       test    eax, eax
.text:00412975		       jnz     short loc_4129DF
.text:00412977
.text:00412977 loc_412977:			       ; CODE XREF: _memcmp+157Fj
.text:00412977		       movzx   eax, byte ptr [ecx+1]
.text:0041297B		       movzx   edx, byte ptr [esi+1]
.text:0041297F		       sub     eax, edx
.text:00412981		       jz      short loc_412994
.text:00412983		       xor     edx, edx
.text:00412985		       test    eax, eax
.text:00412987		       setnle  dl
.text:0041298A		       lea     edx, [edx+edx-1]
.text:0041298E		       mov     eax, edx
.text:00412990		       test    eax, eax
.text:00412992		       jnz     short loc_4129DF
.text:00412994
.text:00412994 loc_412994:			       ; CODE XREF: _memcmp+159Cj
.text:00412994		       movzx   eax, byte ptr [ecx+2]
.text:00412998		       movzx   ecx, byte ptr [esi+2]
.text:0041299C		       jmp     short loc_41293C
.text:0041299E ; ---------------------------------------------------------------------------
.text:0041299E
.text:0041299E loc_41299E:			       ; CODE XREF: _memcmp+1Bj
.text:0041299E		       mov     ecx, [ebp+lhs]
.text:004129A1		       mov     esi, [ebp+rhs]
.text:004129A4		       movzx   eax, byte ptr [ecx]
.text:004129A7		       movzx   edx, byte ptr [esi]
.text:004129AA		       sub     eax, edx
.text:004129AC		       jz      short loc_4129BF
.text:004129AE		       xor     edx, edx
.text:004129B0		       test    eax, eax
.text:004129B2		       setnle  dl
.text:004129B5		       lea     edx, [edx+edx-1]
.text:004129B9		       mov     eax, edx
.text:004129BB		       test    eax, eax
.text:004129BD		       jnz     short loc_4129DF
.text:004129BF
.text:004129BF loc_4129BF:			       ; CODE XREF: _memcmp+15C7j
.text:004129BF		       movzx   eax, byte ptr [ecx+1]
.text:004129C3		       movzx   ecx, byte ptr [esi+1]
.text:004129C7		       jmp     loc_41293C
.text:004129CC ; ---------------------------------------------------------------------------
.text:004129CC
.text:004129CC loc_4129CC:			       ; CODE XREF: _memcmp+14j
.text:004129CC		       mov     eax, [ebp+lhs]
.text:004129CF		       mov     ecx, [ebp+rhs]
.text:004129D2		       movzx   eax, byte ptr [eax]
.text:004129D5		       movzx   ecx, byte ptr [ecx]
.text:004129D8		       jmp     loc_41293C
.text:004129DD ; ---------------------------------------------------------------------------
.text:004129DD
.text:004129DD loc_4129DD:			       ; CODE XREF: _memcmp+Dj
.text:004129DD		       xor     eax, eax
.text:004129DF
.text:004129DF loc_4129DF:			       ; CODE XREF: _memcmp+8A2j
.text:004129DF					       ; _memcmp+1507j	...
.text:004129DF		       pop     edi
.text:004129E0		       pop     esi
.text:004129E1		       pop     ebp
.text:004129E2		       retn
.text:004129E2 ; ---------------------------------------------------------------------------
.text:004129E3		       db 8Bh, 0FFh
.text:004129E5 off_4129E5      dd offset $LN132	       ; DATA XREF: _memcmp+4C5r
.text:004129E5		       dd offset $LN103	       ; jump table for	switch statement
.text:004129E5		       dd offset $LN88
.text:004129E5		       dd offset $LN73
.text:004129E5		       dd offset $LN120
.text:004129E5		       dd offset $LN105
.text:004129E5		       dd offset $LN90
.text:004129E5		       dd offset $LN75
.text:004129E5		       dd offset $LN122_0
.text:004129E5		       dd offset $LN107
.text:004129E5		       dd offset $LN92
.text:004129E5		       dd offset $LN77
.text:004129E5		       dd offset $LN124
.text:004129E5		       dd offset $LN109
.text:004129E5		       dd offset $LN94
.text:004129E5		       dd offset $LN79
.text:004129E5		       dd offset $LN126
.text:004129E5		       dd offset $LN111
.text:004129E5		       dd offset $LN96_0
.text:004129E5		       dd offset $LN81
.text:004129E5		       dd offset $LN128
.text:004129E5		       dd offset $LN113_0
.text:004129E5		       dd offset $LN98
.text:004129E5		       dd offset $LN83
.text:004129E5		       dd offset $LN130_1
.text:004129E5		       dd offset $LN115
.text:004129E5		       dd offset $LN100
.text:004129E5		       dd offset $LN85
.text:004129E5		       dd offset $LN131_0
.text:004129E5		       dd offset $LN116_0
.text:004129E5		       dd offset $LN101
.text:004129E5		       dd offset $LN86
.text:004129E5 _memcmp	       endp
.text:004129E5
.text:00412A65
.text:00412A65 ; =============== S U B R O U T I N E =======================================
.text:00412A65
.text:00412A65 ; Attributes: bp-based frame
.text:00412A65
.text:00412A65 ; int __cdecl strncmp(const char	*first,	const char *last, unsigned int count)
.text:00412A65 _strncmp	       proc near	       ; CODE XREF: _setlocale_nolock+B3p
.text:00412A65
.text:00412A65 n	       = dword ptr -4
.text:00412A65 first	       = dword ptr  8
.text:00412A65 last	       = dword ptr  0Ch
.text:00412A65 count	       = dword ptr  10h
.text:00412A65
.text:00412A65		       push    ebp
.text:00412A66		       mov     ebp, esp
.text:00412A68		       push    ecx
.text:00412A69		       and     [ebp+n],	0
.text:00412A6D		       push    ebx
.text:00412A6E		       mov     ebx, [ebp+count]
.text:00412A71		       test    ebx, ebx
.text:00412A73		       jnz     short loc_412A7C
.text:00412A75		       xor     eax, eax
.text:00412A77		       jmp     loc_412B16
.text:00412A7C ; ---------------------------------------------------------------------------
.text:00412A7C
.text:00412A7C loc_412A7C:			       ; CODE XREF: _strncmp+Ej
.text:00412A7C		       cmp     ebx, 4
.text:00412A7F		       push    edi
.text:00412A80		       jb      short loc_412AF7
.text:00412A82		       lea     edi, [ebx-4]
.text:00412A85		       test    edi, edi
.text:00412A87		       jbe     short loc_412AF7
.text:00412A89		       mov     ecx, [ebp+last]
.text:00412A8C		       mov     eax, [ebp+first]
.text:00412A8F
.text:00412A8F loc_412A8F:			       ; CODE XREF: _strncmp+66j
.text:00412A8F		       mov     dl, [eax]
.text:00412A91		       add     eax, 4
.text:00412A94		       add     ecx, 4
.text:00412A97		       test    dl, dl
.text:00412A99		       jz      short loc_412AED
.text:00412A9B		       cmp     dl, [ecx-4]
.text:00412A9E		       jnz     short loc_412AED
.text:00412AA0		       mov     dl, [eax-3]
.text:00412AA3		       test    dl, dl
.text:00412AA5		       jz      short loc_412AE3
.text:00412AA7		       cmp     dl, [ecx-3]
.text:00412AAA		       jnz     short loc_412AE3
.text:00412AAC		       mov     dl, [eax-2]
.text:00412AAF		       test    dl, dl
.text:00412AB1		       jz      short loc_412AD9
.text:00412AB3		       cmp     dl, [ecx-2]
.text:00412AB6		       jnz     short loc_412AD9
.text:00412AB8		       mov     dl, [eax-1]
.text:00412ABB		       test    dl, dl
.text:00412ABD		       jz      short loc_412ACF
.text:00412ABF		       cmp     dl, [ecx-1]
.text:00412AC2		       jnz     short loc_412ACF
.text:00412AC4		       add     [ebp+n],	4
.text:00412AC8		       cmp     [ebp+n],	edi
.text:00412ACB		       jb      short loc_412A8F
.text:00412ACD		       jmp     short loc_412B0E
.text:00412ACF ; ---------------------------------------------------------------------------
.text:00412ACF
.text:00412ACF loc_412ACF:			       ; CODE XREF: _strncmp+58j
.text:00412ACF					       ; _strncmp+5Dj
.text:00412ACF		       movzx   eax, byte ptr [eax-1]
.text:00412AD3		       movzx   ecx, byte ptr [ecx-1]
.text:00412AD7		       jmp     short loc_412B1F
.text:00412AD9 ; ---------------------------------------------------------------------------
.text:00412AD9
.text:00412AD9 loc_412AD9:			       ; CODE XREF: _strncmp+4Cj
.text:00412AD9					       ; _strncmp+51j
.text:00412AD9		       movzx   eax, byte ptr [eax-2]
.text:00412ADD		       movzx   ecx, byte ptr [ecx-2]
.text:00412AE1		       jmp     short loc_412B1F
.text:00412AE3 ; ---------------------------------------------------------------------------
.text:00412AE3
.text:00412AE3 loc_412AE3:			       ; CODE XREF: _strncmp+40j
.text:00412AE3					       ; _strncmp+45j
.text:00412AE3		       movzx   eax, byte ptr [eax-3]
.text:00412AE7		       movzx   ecx, byte ptr [ecx-3]
.text:00412AEB		       jmp     short loc_412B1F
.text:00412AED ; ---------------------------------------------------------------------------
.text:00412AED
.text:00412AED loc_412AED:			       ; CODE XREF: _strncmp+34j
.text:00412AED					       ; _strncmp+39j
.text:00412AED		       movzx   eax, byte ptr [eax-4]
.text:00412AF1		       movzx   ecx, byte ptr [ecx-4]
.text:00412AF5		       jmp     short loc_412B1F
.text:00412AF7 ; ---------------------------------------------------------------------------
.text:00412AF7
.text:00412AF7 loc_412AF7:			       ; CODE XREF: _strncmp+1Bj
.text:00412AF7					       ; _strncmp+22j
.text:00412AF7		       mov     ecx, [ebp+last]
.text:00412AFA		       mov     eax, [ebp+first]
.text:00412AFD		       jmp     short loc_412B0E
.text:00412AFF ; ---------------------------------------------------------------------------
.text:00412AFF
.text:00412AFF loc_412AFF:			       ; CODE XREF: _strncmp+ACj
.text:00412AFF		       mov     dl, [eax]
.text:00412B01		       test    dl, dl
.text:00412B03		       jz      short loc_412B19
.text:00412B05		       cmp     dl, [ecx]
.text:00412B07		       jnz     short loc_412B19
.text:00412B09		       inc     eax
.text:00412B0A		       inc     ecx
.text:00412B0B		       inc     [ebp+n]
.text:00412B0E
.text:00412B0E loc_412B0E:			       ; CODE XREF: _strncmp+68j
.text:00412B0E					       ; _strncmp+98j
.text:00412B0E		       cmp     [ebp+n],	ebx
.text:00412B11		       jb      short loc_412AFF
.text:00412B13		       xor     eax, eax
.text:00412B15
.text:00412B15 loc_412B15:			       ; CODE XREF: _strncmp+BCj
.text:00412B15		       pop     edi
.text:00412B16
.text:00412B16 loc_412B16:			       ; CODE XREF: _strncmp+12j
.text:00412B16		       pop     ebx
.text:00412B17		       leave
.text:00412B18		       retn
.text:00412B19 ; ---------------------------------------------------------------------------
.text:00412B19
.text:00412B19 loc_412B19:			       ; CODE XREF: _strncmp+9Ej
.text:00412B19					       ; _strncmp+A2j
.text:00412B19		       movzx   eax, byte ptr [eax]
.text:00412B1C		       movzx   ecx, byte ptr [ecx]
.text:00412B1F
.text:00412B1F loc_412B1F:			       ; CODE XREF: _strncmp+72j
.text:00412B1F					       ; _strncmp+7Cj ...
.text:00412B1F		       sub     eax, ecx
.text:00412B21		       jmp     short loc_412B15
.text:00412B21 _strncmp	       endp
.text:00412B21
.text:00412B21 ; ---------------------------------------------------------------------------
.text:00412B23		       align 10h
.text:00412B30
.text:00412B30 ; =============== S U B R O U T I N E =======================================
.text:00412B30
.text:00412B30 ; Attributes: bp-based frame
.text:00412B30
.text:00412B30 ; void __cdecl strpbrk(char *string, char *control)
.text:00412B30 _strpbrk	       proc near	       ; CODE XREF: _setlocale_nolock+79p
.text:00412B30
.text:00412B30 var_24	       = dword ptr -24h
.text:00412B30 string	       = dword ptr  8
.text:00412B30 control	       = dword ptr  0Ch
.text:00412B30
.text:00412B30		       push    ebp
.text:00412B31		       mov     ebp, esp
.text:00412B33		       push    esi
.text:00412B34		       xor     eax, eax
.text:00412B36		       push    eax
.text:00412B37		       push    eax
.text:00412B38		       push    eax
.text:00412B39		       push    eax
.text:00412B3A		       push    eax
.text:00412B3B		       push    eax
.text:00412B3C		       push    eax
.text:00412B3D		       push    eax
.text:00412B3E		       mov     edx, [ebp+control]
.text:00412B41		       lea     ecx, [ecx+0]
.text:00412B44
.text:00412B44 listnext_0:			       ; CODE XREF: _strpbrk+21j
.text:00412B44		       mov     al, [edx]
.text:00412B46		       or      al, al
.text:00412B48		       jz      short listdone_0
.text:00412B4A		       add     edx, 1
.text:00412B4D		       bts     [esp+24h+var_24], eax
.text:00412B51		       jmp     short listnext_0
.text:00412B53 ; ---------------------------------------------------------------------------
.text:00412B53
.text:00412B53 listdone_0:			       ; CODE XREF: _strpbrk+18j
.text:00412B53		       mov     esi, [ebp+string]
.text:00412B56		       mov     edi, edi
.text:00412B58
.text:00412B58 dstnext_0:			       ; CODE XREF: _strpbrk+35j
.text:00412B58		       mov     al, [esi]
.text:00412B5A		       or      al, al
.text:00412B5C		       jz      short dstdone_0
.text:00412B5E		       add     esi, 1
.text:00412B61		       bt      [esp+24h+var_24], eax
.text:00412B65		       jnb     short dstnext_0
.text:00412B67		       lea     eax, [esi-1]
.text:00412B6A
.text:00412B6A dstdone_0:			       ; CODE XREF: _strpbrk+2Cj
.text:00412B6A		       add     esp, 20h
.text:00412B6D		       pop     esi
.text:00412B6E		       leave
.text:00412B6F		       retn
.text:00412B6F _strpbrk	       endp
.text:00412B6F
.text:00412B70
.text:00412B70 ; =============== S U B R O U T I N E =======================================
.text:00412B70
.text:00412B70 ; Attributes: bp-based frame
.text:00412B70
.text:00412B70 ; __int64 __cdecl _lseeki64_nolock(int fh, __int64 pos, int mthd)
.text:00412B70 __lseeki64_nolock proc near	       ; CODE XREF: __write_nolock+E1p
.text:00412B70					       ; __lseeki64+CDp
.text:00412B70
.text:00412B70 newpos	       = doubleint ptr -8
.text:00412B70 fh	       = dword ptr  8
.text:00412B70 pos	       = qword ptr  0Ch
.text:00412B70 mthd	       = dword ptr  14h
.text:00412B70
.text:00412B70		       push    ebp
.text:00412B71		       mov     ebp, esp
.text:00412B73		       push    ecx
.text:00412B74		       push    ecx
.text:00412B75		       mov     eax, dword ptr [ebp+pos]
.text:00412B78		       push    esi
.text:00412B79		       mov     esi, [ebp+fh]
.text:00412B7C		       mov     dword ptr [ebp+newpos], eax
.text:00412B7F		       mov     eax, dword ptr [ebp+pos+4]
.text:00412B82		       push    edi
.text:00412B83		       push    esi	       ; fh
.text:00412B84		       mov     dword ptr [ebp+newpos+4], eax
.text:00412B87		       call    __get_osfhandle
.text:00412B8C		       or      edi, 0FFFFFFFFh
.text:00412B8F		       cmp     eax, edi
.text:00412B91		       pop     ecx
.text:00412B92		       jnz     short loc_412BA5
.text:00412B94		       call    __errno
.text:00412B99		       mov     dword ptr [eax],	9
.text:00412B9F
.text:00412B9F loc_412B9F:			       ; CODE XREF: __lseeki64_nolock+5Ej
.text:00412B9F		       mov     eax, edi
.text:00412BA1		       mov     edx, edi
.text:00412BA3		       jmp     short loc_412BEF
.text:00412BA5 ; ---------------------------------------------------------------------------
.text:00412BA5
.text:00412BA5 loc_412BA5:			       ; CODE XREF: __lseeki64_nolock+22j
.text:00412BA5		       push    [ebp+mthd]      ; dwMoveMethod
.text:00412BA8		       lea     ecx, [ebp+newpos+4]
.text:00412BAB		       push    ecx	       ; lpDistanceToMoveHigh
.text:00412BAC		       push    dword ptr [ebp+newpos] ;	lDistanceToMove
.text:00412BAF		       push    eax	       ; hFile
.text:00412BB0		       call    ds:__imp__SetFilePointer@16 ; SetFilePointer(x,x,x,x)
.text:00412BB6		       cmp     eax, edi
.text:00412BB8		       mov     dword ptr [ebp+newpos], eax
.text:00412BBB		       jnz     short loc_412BD0
.text:00412BBD		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00412BC3		       test    eax, eax
.text:00412BC5		       jz      short loc_412BD0
.text:00412BC7		       push    eax	       ; oserrno
.text:00412BC8		       call    __dosmaperr
.text:00412BCD		       pop     ecx
.text:00412BCE		       jmp     short loc_412B9F
.text:00412BD0 ; ---------------------------------------------------------------------------
.text:00412BD0
.text:00412BD0 loc_412BD0:			       ; CODE XREF: __lseeki64_nolock+4Bj
.text:00412BD0					       ; __lseeki64_nolock+55j
.text:00412BD0		       mov     eax, esi
.text:00412BD2		       sar     eax, 5
.text:00412BD5		       mov     eax, ___pioinfo[eax*4]
.text:00412BDC		       and     esi, 1Fh
.text:00412BDF		       shl     esi, 6
.text:00412BE2		       lea     eax, [eax+esi+4]
.text:00412BE6		       and     byte ptr	[eax], 0FDh
.text:00412BE9		       mov     eax, dword ptr [ebp+newpos]
.text:00412BEC		       mov     edx, dword ptr [ebp+newpos+4]
.text:00412BEF
.text:00412BEF loc_412BEF:			       ; CODE XREF: __lseeki64_nolock+33j
.text:00412BEF		       pop     edi
.text:00412BF0		       pop     esi
.text:00412BF1		       leave
.text:00412BF2		       retn
.text:00412BF2 __lseeki64_nolock endp
.text:00412BF2
.text:00412BF3
.text:00412BF3 ; =============== S U B R O U T I N E =======================================
.text:00412BF3
.text:00412BF3 ; Attributes: bp-based frame
.text:00412BF3
.text:00412BF3 ; __int64 __cdecl _lseeki64(int fh, __int64 pos,	int mthd)
.text:00412BF3 __lseeki64      proc near	       ; CODE XREF: __flsbuf+116p
.text:00412BF3
.text:00412BF3 r	       = qword ptr -24h
.text:00412BF3 _Expr_val       = dword ptr -1Ch
.text:00412BF3 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00412BF3 fh	       = dword ptr  8
.text:00412BF3 pos	       = qword ptr  0Ch
.text:00412BF3 mthd	       = dword ptr  14h
.text:00412BF3
.text:00412BF3		       push    14h
.text:00412BF5		       push    offset dword_4218D8
.text:00412BFA		       call    __SEH_prolog4
.text:00412BFF		       or      esi, 0FFFFFFFFh
.text:00412C02		       mov     dword ptr [ebp+r], esi
.text:00412C05		       mov     dword ptr [ebp+r+4], esi
.text:00412C08		       mov     eax, [ebp+fh]
.text:00412C0B		       cmp     eax, 0FFFFFFFEh
.text:00412C0E		       jnz     short loc_412C2C
.text:00412C10		       call    ___doserrno
.text:00412C15		       and     dword ptr [eax],	0
.text:00412C18		       call    __errno
.text:00412C1D		       mov     dword ptr [eax],	9
.text:00412C23
.text:00412C23 loc_412C23:			       ; CODE XREF: __lseeki64+66j
.text:00412C23		       mov     eax, esi
.text:00412C25		       mov     edx, esi
.text:00412C27		       jmp     loc_412CFC
.text:00412C2C ; ---------------------------------------------------------------------------
.text:00412C2C
.text:00412C2C loc_412C2C:			       ; CODE XREF: __lseeki64+1Bj
.text:00412C2C		       xor     edi, edi
.text:00412C2E		       cmp     eax, edi
.text:00412C30		       jl      short loc_412C3A
.text:00412C32		       cmp     eax, __nhandle
.text:00412C38		       jb      short loc_412C5B
.text:00412C3A
.text:00412C3A loc_412C3A:			       ; CODE XREF: __lseeki64+3Dj
.text:00412C3A		       call    ___doserrno
.text:00412C3F		       mov     [eax], edi
.text:00412C41		       call    __errno
.text:00412C46		       mov     dword ptr [eax],	9
.text:00412C4C		       push    edi	       ; pReserved
.text:00412C4D		       push    edi	       ; nLine
.text:00412C4E		       push    edi	       ; pszFile
.text:00412C4F		       push    edi	       ; pszFunction
.text:00412C50		       push    edi	       ; pszExpression
.text:00412C51		       call    __invalid_parameter
.text:00412C56		       add     esp, 14h
.text:00412C59		       jmp     short loc_412C23
.text:00412C5B ; ---------------------------------------------------------------------------
.text:00412C5B
.text:00412C5B loc_412C5B:			       ; CODE XREF: __lseeki64+45j
.text:00412C5B		       mov     ecx, eax
.text:00412C5D		       sar     ecx, 5
.text:00412C60		       lea     ebx, ds:423F00h[ecx*4]
.text:00412C67		       mov     esi, eax
.text:00412C69		       and     esi, 1Fh
.text:00412C6C		       shl     esi, 6
.text:00412C6F		       mov     ecx, [ebx]
.text:00412C71		       movzx   ecx, byte ptr [ecx+esi+4]
.text:00412C76		       and     ecx, 1
.text:00412C79		       jnz     short loc_412CA1
.text:00412C7B		       call    ___doserrno
.text:00412C80		       mov     [eax], edi
.text:00412C82		       call    __errno
.text:00412C87		       mov     dword ptr [eax],	9
.text:00412C8D		       push    edi	       ; pReserved
.text:00412C8E		       push    edi	       ; nLine
.text:00412C8F		       push    edi	       ; pszFile
.text:00412C90		       push    edi	       ; pszFunction
.text:00412C91		       push    edi	       ; pszExpression
.text:00412C92		       call    __invalid_parameter
.text:00412C97		       add     esp, 14h
.text:00412C9A		       or      edx, 0FFFFFFFFh
.text:00412C9D		       mov     eax, edx
.text:00412C9F		       jmp     short loc_412CFC
.text:00412CA1 ; ---------------------------------------------------------------------------
.text:00412CA1
.text:00412CA1 loc_412CA1:			       ; CODE XREF: __lseeki64+86j
.text:00412CA1		       push    eax	       ; fh
.text:00412CA2		       call    ___lock_fhandle
.text:00412CA7		       pop     ecx
.text:00412CA8		       mov     [ebp+ms_exc.disabled], edi
.text:00412CAB		       mov     eax, [ebx]
.text:00412CAD		       test    byte ptr	[eax+esi+4], 1
.text:00412CB2		       jz      short loc_412CD0
.text:00412CB4		       push    [ebp+mthd]      ; mthd
.text:00412CB7		       push    dword ptr [ebp+pos+4]
.text:00412CBA		       push    dword ptr [ebp+pos] ; pos
.text:00412CBD		       push    [ebp+fh]	       ; fh
.text:00412CC0		       call    __lseeki64_nolock
.text:00412CC5		       add     esp, 10h
.text:00412CC8		       mov     dword ptr [ebp+r], eax
.text:00412CCB		       mov     dword ptr [ebp+r+4], edx
.text:00412CCE		       jmp     short loc_412CEA
.text:00412CD0 ; ---------------------------------------------------------------------------
.text:00412CD0
.text:00412CD0 loc_412CD0:			       ; CODE XREF: __lseeki64+BFj
.text:00412CD0		       call    __errno
.text:00412CD5		       mov     dword ptr [eax],	9
.text:00412CDB		       call    ___doserrno
.text:00412CE0		       mov     [eax], edi
.text:00412CE2		       or      dword ptr [ebp+r], 0FFFFFFFFh
.text:00412CE6		       or      dword ptr [ebp+r+4], 0FFFFFFFFh
.text:00412CEA
.text:00412CEA loc_412CEA:			       ; CODE XREF: __lseeki64+DBj
.text:00412CEA		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00412CF1		       call    $LN12_9
.text:00412CF6
.text:00412CF6 $LN15_6:
.text:00412CF6		       mov     eax, dword ptr [ebp+r]
.text:00412CF9		       mov     edx, dword ptr [ebp+r+4]
.text:00412CFC
.text:00412CFC loc_412CFC:			       ; CODE XREF: __lseeki64+34j
.text:00412CFC					       ; __lseeki64+ACj
.text:00412CFC		       call    __SEH_epilog4
.text:00412D01		       retn
.text:00412D02 ; ---------------------------------------------------------------------------
.text:00412D02
.text:00412D02 $LN12_9:				       ; CODE XREF: __lseeki64+FEp
.text:00412D02					       ; DATA XREF: .rdata:004218F0o
.text:00412D02		       push    [ebp+fh]	       ; fh
.text:00412D05		       call    __unlock_fhandle
.text:00412D0A		       pop     ecx
.text:00412D0B
.text:00412D0B $LN13_6:
.text:00412D0B		       retn
.text:00412D0B __lseeki64      endp
.text:00412D0B
.text:00412D0C
.text:00412D0C ; =============== S U B R O U T I N E =======================================
.text:00412D0C
.text:00412D0C
.text:00412D0C ; void __cdecl _getbuf(_iobuf *str)
.text:00412D0C __getbuf	       proc near	       ; CODE XREF: __flsbuf+9Cp
.text:00412D0C
.text:00412D0C str	       = dword ptr  4
.text:00412D0C
.text:00412D0C		       inc     __cflush
.text:00412D12		       push    1000h	       ; cb
.text:00412D17		       call    __malloc_crt
.text:00412D1C		       test    eax, eax
.text:00412D1E		       pop     ecx
.text:00412D1F		       mov     ecx, [esp+str]
.text:00412D23		       mov     [ecx+8],	eax
.text:00412D26		       jz      short loc_412D35
.text:00412D28		       or      dword ptr [ecx+0Ch], 8
.text:00412D2C		       mov     dword ptr [ecx+18h], 1000h
.text:00412D33		       jmp     short loc_412D46
.text:00412D35 ; ---------------------------------------------------------------------------
.text:00412D35
.text:00412D35 loc_412D35:			       ; CODE XREF: __getbuf+1Aj
.text:00412D35		       or      dword ptr [ecx+0Ch], 4
.text:00412D39		       lea     eax, [ecx+14h]
.text:00412D3C		       mov     [ecx+8],	eax
.text:00412D3F		       mov     dword ptr [ecx+18h], 2
.text:00412D46
.text:00412D46 loc_412D46:			       ; CODE XREF: __getbuf+27j
.text:00412D46		       mov     eax, [ecx+8]
.text:00412D49		       and     dword ptr [ecx+4], 0
.text:00412D4D		       mov     [ecx], eax
.text:00412D4F		       retn
.text:00412D4F __getbuf	       endp
.text:00412D4F
.text:00412D50
.text:00412D50 ; =============== S U B R O U T I N E =======================================
.text:00412D50
.text:00412D50 ; Attributes: bp-based frame
.text:00412D50
.text:00412D50 ; int __cdecl _iswctype_l(unsigned __int16 c, unsigned __int16 mask, localeinfo_struct *plocinfo)
.text:00412D50 __iswctype_l    proc near	       ; CODE XREF: __iswalpha_l+Dp
.text:00412D50					       ; __iswupper_l+Ap ...
.text:00412D50
.text:00412D50 _loc_update     = _LocaleUpdate ptr -14h
.text:00412D50 d	       = dword ptr -4
.text:00412D50 c	       = word ptr  8
.text:00412D50 mask	       = word ptr  0Ch
.text:00412D50 plocinfo	       = dword ptr  10h
.text:00412D50
.text:00412D50		       push    ebp
.text:00412D51		       mov     ebp, esp
.text:00412D53		       sub     esp, 14h
.text:00412D56		       cmp     [ebp+c],	0FFFFh
.text:00412D5C		       jnz     short loc_412D64
.text:00412D5E		       and     [ebp+d],	0
.text:00412D62		       jmp     short loc_412DC6
.text:00412D64 ; ---------------------------------------------------------------------------
.text:00412D64
.text:00412D64 loc_412D64:			       ; CODE XREF: __iswctype_l+Cj
.text:00412D64		       cmp     [ebp+c],	100h
.text:00412D6A		       jnb     short loc_412D86
.text:00412D6C		       movzx   eax, [ebp+c]
.text:00412D70		       mov     ecx, __pwctype
.text:00412D76		       mov     ax, [ecx+eax*2]
.text:00412D7A		       and     ax, [ebp+mask]
.text:00412D7E		       movzx   eax, ax
.text:00412D81		       mov     [ebp+d],	eax
.text:00412D84		       jmp     short loc_412DC6
.text:00412D86 ; ---------------------------------------------------------------------------
.text:00412D86
.text:00412D86 loc_412D86:			       ; CODE XREF: __iswctype_l+1Aj
.text:00412D86		       push    [ebp+plocinfo]  ; plocinfo
.text:00412D89		       lea     ecx, [ebp+_loc_update] ;	this
.text:00412D8C		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00412D91		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00412D94		       push    dword ptr [eax+14h] ; lcid
.text:00412D97		       push    dword ptr [eax+4] ; code_page
.text:00412D9A		       lea     eax, [ebp+d]
.text:00412D9D		       push    eax	       ; lpCharType
.text:00412D9E		       push    1	       ; cchSrc
.text:00412DA0		       lea     eax, [ebp+c]
.text:00412DA3		       push    eax	       ; lpSrcStr
.text:00412DA4		       lea     eax, [ebp+_loc_update]
.text:00412DA7		       push    1	       ; dwInfoType
.text:00412DA9		       push    eax	       ; plocinfo
.text:00412DAA		       call    ___crtGetStringTypeW
.text:00412DAF		       add     esp, 1Ch
.text:00412DB2		       test    eax, eax
.text:00412DB4		       jnz     short loc_412DB9
.text:00412DB6		       and     [ebp+d],	eax
.text:00412DB9
.text:00412DB9 loc_412DB9:			       ; CODE XREF: __iswctype_l+64j
.text:00412DB9		       cmp     [ebp+_loc_update.updated], 0
.text:00412DBD		       jz      short loc_412DC6
.text:00412DBF		       mov     eax, [ebp+_loc_update.ptd]
.text:00412DC2		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00412DC6
.text:00412DC6 loc_412DC6:			       ; CODE XREF: __iswctype_l+12j
.text:00412DC6					       ; __iswctype_l+34j ...
.text:00412DC6		       movzx   eax, word ptr [ebp+d]
.text:00412DCA		       movzx   ecx, [ebp+mask]
.text:00412DCE		       and     eax, ecx
.text:00412DD0		       leave
.text:00412DD1		       retn
.text:00412DD1 __iswctype_l    endp
.text:00412DD1
.text:00412DD2
.text:00412DD2 ; =============== S U B R O U T I N E =======================================
.text:00412DD2
.text:00412DD2 ; Attributes: bp-based frame
.text:00412DD2
.text:00412DD2 ; int __cdecl iswctype(unsigned __int16 c, unsigned __int16 mask)
.text:00412DD2 _iswctype       proc near	       ; CODE XREF: _iswalpha+9p
.text:00412DD2					       ; _iswupper+6p ...
.text:00412DD2
.text:00412DD2 d	       = word ptr -4
.text:00412DD2 c	       = dword ptr  8
.text:00412DD2 mask	       = dword ptr  0Ch
.text:00412DD2
.text:00412DD2		       push    ebp
.text:00412DD3		       mov     ebp, esp
.text:00412DD5		       push    ecx
.text:00412DD6		       cmp     word ptr	[ebp+c], 0FFFFh
.text:00412DDC		       jnz     short loc_412DE2
.text:00412DDE		       xor     eax, eax
.text:00412DE0		       leave
.text:00412DE1		       retn
.text:00412DE2 ; ---------------------------------------------------------------------------
.text:00412DE2
.text:00412DE2 loc_412DE2:			       ; CODE XREF: _iswctype+Aj
.text:00412DE2		       cmp     word ptr	[ebp+c], 100h
.text:00412DE8		       jnb     short loc_412E00
.text:00412DEA		       movzx   eax, word ptr [ebp+c]
.text:00412DEE		       mov     ecx, __pwctype
.text:00412DF4		       movzx   eax, word ptr [ecx+eax*2]
.text:00412DF8		       movzx   ecx, word ptr [ebp+mask]
.text:00412DFC		       and     eax, ecx
.text:00412DFE		       leave
.text:00412DFF		       retn
.text:00412E00 ; ---------------------------------------------------------------------------
.text:00412E00
.text:00412E00 loc_412E00:			       ; CODE XREF: _iswctype+16j
.text:00412E00		       cmp     ___locale_changed, 0
.text:00412E07		       jnz     short loc_412E2E
.text:00412E09		       push    ___initiallocinfo.lc_handle+8 ; lcid
.text:00412E0F		       lea     eax, [ebp+d]
.text:00412E12		       push    ___initiallocinfo.lc_codepage ; code_page
.text:00412E18		       push    eax	       ; lpCharType
.text:00412E19		       push    1	       ; cchSrc
.text:00412E1B		       lea     eax, [ebp+c]
.text:00412E1E		       push    eax	       ; lpSrcStr
.text:00412E1F		       push    1	       ; dwInfoType
.text:00412E21		       push    offset ___initiallocalestructinfo ; plocinfo
.text:00412E26		       call    ___crtGetStringTypeW
.text:00412E2B		       add     esp, 1Ch
.text:00412E2E
.text:00412E2E loc_412E2E:			       ; CODE XREF: _iswctype+35j
.text:00412E2E		       push    0	       ; plocinfo
.text:00412E30		       push    [ebp+mask]      ; mask
.text:00412E33		       push    [ebp+c]	       ; c
.text:00412E36		       call    __iswctype_l
.text:00412E3B		       add     esp, 0Ch
.text:00412E3E		       leave
.text:00412E3F		       retn
.text:00412E3F _iswctype       endp
.text:00412E3F
.text:00412E40 ; [00000005 BYTES: COLLAPSED FUNCTION _is_wctype. PRESS KEYPAD "+" TO EXPAND]
.text:00412E45
.text:00412E45 ; =============== S U B R O U T I N E =======================================
.text:00412E45
.text:00412E45 ; Attributes: bp-based frame
.text:00412E45
.text:00412E45 ___report_gsfailure proc	near	       ; CODE XREF: __security_check_cookie(x):failurej
.text:00412E45
.text:00412E45 cookie	       = dword ptr -328h
.text:00412E45 dw	       = dword ptr -320h
.text:00412E45 arg_0	       = byte ptr  8
.text:00412E45
.text:00412E45		       push    ebp
.text:00412E46		       mov     ebp, esp
.text:00412E48		       sub     esp, 328h
.text:00412E4E		       mov     GS_ContextRecord._Eax, eax
.text:00412E53		       mov     GS_ContextRecord._Ecx, ecx
.text:00412E59		       mov     GS_ContextRecord._Edx, edx
.text:00412E5F		       mov     GS_ContextRecord._Ebx, ebx
.text:00412E65		       mov     GS_ContextRecord._Esi, esi
.text:00412E6B		       mov     GS_ContextRecord._Edi, edi
.text:00412E71		       mov     word ptr	GS_ContextRecord.SegSs,	ss
.text:00412E78		       mov     word ptr	GS_ContextRecord.SegCs,	cs
.text:00412E7F		       mov     word ptr	GS_ContextRecord.SegDs,	ds
.text:00412E86		       mov     word ptr	GS_ContextRecord.SegEs,	es
.text:00412E8D		       mov     word ptr	GS_ContextRecord.SegFs,	fs
.text:00412E94		       mov     word ptr	GS_ContextRecord.SegGs,	gs
.text:00412E9B		       pushf
.text:00412E9C		       pop     GS_ContextRecord.EFlags
.text:00412EA2		       mov     eax, [ebp+0]
.text:00412EA5		       mov     GS_ContextRecord._Ebp, eax
.text:00412EAA		       mov     eax, [ebp+4]
.text:00412EAD		       mov     GS_ContextRecord._Eip, eax
.text:00412EB2		       lea     eax, [ebp+arg_0]
.text:00412EB5		       mov     GS_ContextRecord._Esp, eax
.text:00412EBA		       mov     eax, [ebp+dw]
.text:00412EC0		       mov     GS_ContextRecord.ContextFlags, 10001h
.text:00412ECA		       mov     eax, GS_ContextRecord._Eip
.text:00412ECF		       mov     GS_ExceptionRecord.ExceptionAddress, eax
.text:00412ED4		       mov     GS_ExceptionRecord.ExceptionCode, 0C0000409h
.text:00412EDE		       mov     GS_ExceptionRecord.ExceptionFlags, 1
.text:00412EE8		       mov     eax, ___security_cookie
.text:00412EED		       mov     [ebp+cookie], eax
.text:00412EF3		       mov     eax, ___security_cookie_complement
.text:00412EF8		       mov     [ebp+cookie+4], eax
.text:00412EFE		       call    ds:__imp__IsDebuggerPresent@0 ; IsDebuggerPresent()
.text:00412F04		       mov     DebuggerWasPresent, eax
.text:00412F09		       push    1	       ; _Reserved
.text:00412F0B		       call    __crt_debugger_hook
.text:00412F10		       pop     ecx
.text:00412F11		       push    0	       ; lpTopLevelExceptionFilter
.text:00412F13		       call    ds:__imp__SetUnhandledExceptionFilter@4 ; SetUnhandledExceptionFilter(x)
.text:00412F19		       push    offset GS_ExceptionPointers ; ExceptionInfo
.text:00412F1E		       call    ds:__imp__UnhandledExceptionFilter@4 ; UnhandledExceptionFilter(x)
.text:00412F24		       cmp     DebuggerWasPresent, 0
.text:00412F2B		       jnz     short loc_412F35
.text:00412F2D		       push    1	       ; _Reserved
.text:00412F2F		       call    __crt_debugger_hook
.text:00412F34		       pop     ecx
.text:00412F35
.text:00412F35 loc_412F35:			       ; CODE XREF: ___report_gsfailure+E6j
.text:00412F35		       push    0C0000409h      ; uExitCode
.text:00412F3A		       call    ds:__imp__GetCurrentProcess@0 ; GetCurrentProcess()
.text:00412F40		       push    eax	       ; hProcess
.text:00412F41		       call    ds:__imp__TerminateProcess@8 ; TerminateProcess(x,x)
.text:00412F47		       leave
.text:00412F48		       retn
.text:00412F48 ___report_gsfailure endp
.text:00412F48
.text:00412F49
.text:00412F49 ; =============== S U B R O U T I N E =======================================
.text:00412F49
.text:00412F49 ; Attributes: bp-based frame
.text:00412F49
.text:00412F49 ; void __cdecl fastzero_I(void *dst, int	len)
.text:00412F49 fastzero_I      proc near	       ; CODE XREF: __VEC_memzero+31p
.text:00412F49
.text:00412F49 var_4	       = dword ptr -4
.text:00412F49 dst	       = dword ptr  8
.text:00412F49 len	       = dword ptr  0Ch
.text:00412F49
.text:00412F49		       push    ebp
.text:00412F4A		       mov     ebp, esp
.text:00412F4C		       sub     esp, 4
.text:00412F4F		       mov     [ebp+var_4], edi
.text:00412F52		       mov     edi, [ebp+dst]
.text:00412F55		       mov     ecx, [ebp+len]
.text:00412F58		       shr     ecx, 7
.text:00412F5B		       pxor    xmm0, xmm0
.text:00412F5F		       jmp     short L_1
.text:00412F5F ; ---------------------------------------------------------------------------
.text:00412F61		       db 8Dh, 0A4h, 24h, 4 dup(0)
.text:00412F68		       db 90h
.text:00412F69 ; ---------------------------------------------------------------------------
.text:00412F69
.text:00412F69 L_1:				       ; CODE XREF: fastzero_I+16j
.text:00412F69					       ; fastzero_I+4Ej
.text:00412F69		       movdqa  xmmword ptr [edi], xmm0
.text:00412F6D		       movdqa  xmmword ptr [edi+10h], xmm0
.text:00412F72		       movdqa  xmmword ptr [edi+20h], xmm0
.text:00412F77		       movdqa  xmmword ptr [edi+30h], xmm0
.text:00412F7C		       movdqa  xmmword ptr [edi+40h], xmm0
.text:00412F81		       movdqa  xmmword ptr [edi+50h], xmm0
.text:00412F86		       movdqa  xmmword ptr [edi+60h], xmm0
.text:00412F8B		       movdqa  xmmword ptr [edi+70h], xmm0
.text:00412F90		       lea     edi, [edi+80h]
.text:00412F96		       dec     ecx
.text:00412F97		       jnz     short L_1
.text:00412F99		       mov     edi, [ebp+var_4]
.text:00412F9C		       mov     esp, ebp
.text:00412F9E		       pop     ebp
.text:00412F9F		       retn
.text:00412F9F fastzero_I      endp
.text:00412F9F
.text:00412FA0
.text:00412FA0 ; =============== S U B R O U T I N E =======================================
.text:00412FA0
.text:00412FA0 ; Attributes: bp-based frame
.text:00412FA0
.text:00412FA0 ; void *__cdecl _VEC_memzero(void *dst, int val,	int len)
.text:00412FA0 __VEC_memzero   proc near	       ; CODE XREF: _memset+27j
.text:00412FA0					       ; __VEC_memzero+7Dp
.text:00412FA0
.text:00412FA0 var_10	       = dword ptr -10h
.text:00412FA0 var_C	       = dword ptr -0Ch
.text:00412FA0 var_8	       = dword ptr -8
.text:00412FA0 var_4	       = dword ptr -4
.text:00412FA0 dst	       = dword ptr  8
.text:00412FA0 val	       = dword ptr  0Ch
.text:00412FA0 len	       = dword ptr  10h
.text:00412FA0
.text:00412FA0		       push    ebp
.text:00412FA1		       mov     ebp, esp
.text:00412FA3		       sub     esp, 10h
.text:00412FA6		       mov     [ebp+var_4], edi
.text:00412FA9		       mov     eax, [ebp+dst]
.text:00412FAC		       cdq
.text:00412FAD		       mov     edi, eax
.text:00412FAF		       xor     edi, edx
.text:00412FB1		       sub     edi, edx
.text:00412FB3		       and     edi, 0Fh
.text:00412FB6		       xor     edi, edx
.text:00412FB8		       sub     edi, edx
.text:00412FBA		       test    edi, edi
.text:00412FBC		       jnz     short L_notaligned
.text:00412FBE		       mov     ecx, [ebp+len]
.text:00412FC1		       mov     edx, ecx
.text:00412FC3		       and     edx, 7Fh
.text:00412FC6		       mov     [ebp+var_C], edx
.text:00412FC9		       cmp     ecx, edx
.text:00412FCB		       jz      short L_trailing
.text:00412FCD		       sub     ecx, edx
.text:00412FCF		       push    ecx	       ; len
.text:00412FD0		       push    eax	       ; dst
.text:00412FD1		       call    fastzero_I
.text:00412FD6		       add     esp, 8
.text:00412FD9		       mov     eax, [ebp+dst]
.text:00412FDC		       mov     edx, [ebp+var_C]
.text:00412FDF
.text:00412FDF L_trailing:			       ; CODE XREF: __VEC_memzero+2Bj
.text:00412FDF		       test    edx, edx
.text:00412FE1		       jz      short L_return
.text:00412FE3		       add     eax, [ebp+len]
.text:00412FE6		       sub     eax, edx
.text:00412FE8		       mov     [ebp+var_8], eax
.text:00412FEB		       xor     eax, eax
.text:00412FED		       mov     edi, [ebp+var_8]
.text:00412FF0		       mov     ecx, [ebp+var_C]
.text:00412FF3		       rep stosb
.text:00412FF5		       mov     eax, [ebp+dst]
.text:00412FF8		       jmp     short L_return
.text:00412FFA ; ---------------------------------------------------------------------------
.text:00412FFA
.text:00412FFA L_notaligned:			       ; CODE XREF: __VEC_memzero+1Cj
.text:00412FFA		       neg     edi
.text:00412FFC		       add     edi, 10h
.text:00412FFF		       mov     [ebp+var_10], edi
.text:00413002		       xor     eax, eax
.text:00413004		       mov     edi, [ebp+dst]
.text:00413007		       mov     ecx, [ebp+var_10]
.text:0041300A		       rep stosb
.text:0041300C		       mov     eax, [ebp+var_10]
.text:0041300F		       mov     ecx, [ebp+dst]
.text:00413012		       mov     edx, [ebp+len]
.text:00413015		       add     ecx, eax
.text:00413017		       sub     edx, eax
.text:00413019		       push    edx	       ; len
.text:0041301A		       push    0	       ; val
.text:0041301C		       push    ecx	       ; dst
.text:0041301D		       call    __VEC_memzero
.text:00413022		       add     esp, 0Ch
.text:00413025		       mov     eax, [ebp+dst]
.text:00413028
.text:00413028 L_return:			       ; CODE XREF: __VEC_memzero+41j
.text:00413028					       ; __VEC_memzero+58j
.text:00413028		       mov     edi, [ebp+var_4]
.text:0041302B		       mov     esp, ebp
.text:0041302D		       pop     ebp
.text:0041302E		       retn
.text:0041302E __VEC_memzero   endp
.text:0041302E
.text:0041302F
.text:0041302F ; =============== S U B R O U T I N E =======================================
.text:0041302F
.text:0041302F
.text:0041302F ; int __cdecl _sse2_mathfcns_init()
.text:0041302F __sse2_mathfcns_init proc near	       ; DATA XREF: .rdata:pinit_2o
.text:0041302F		       and     ___use_sse2_mathfcns, 0
.text:00413036		       call    __get_sse2_info
.text:0041303B		       mov     ___use_sse2_mathfcns, eax
.text:00413040		       xor     eax, eax
.text:00413042		       retn
.text:00413042 __sse2_mathfcns_init endp
.text:00413042
.text:00413043
.text:00413043 ; =============== S U B R O U T I N E =======================================
.text:00413043
.text:00413043
.text:00413043 ; int __cdecl _set_SSE2_enable(int flag)
.text:00413043 __set_SSE2_enable proc near
.text:00413043
.text:00413043 flag	       = dword ptr  4
.text:00413043
.text:00413043		       mov     eax, [esp+flag]
.text:00413047		       neg     eax
.text:00413049		       sbb     eax, eax
.text:0041304B		       and     eax, ___sse2_available
.text:00413051		       mov     ___use_sse2_mathfcns, eax
.text:00413056		       retn
.text:00413056 __set_SSE2_enable endp
.text:00413056
.text:00413056 ; ---------------------------------------------------------------------------
.text:00413057		       align 4
.text:00413058
.text:00413058 ; =============== S U B R O U T I N E =======================================
.text:00413058
.text:00413058 ; Attributes: bp-based frame
.text:00413058
.text:00413058 __global_unwind2	proc near
.text:00413058
.text:00413058 arg_0	       = dword ptr  8
.text:00413058
.text:00413058		       push    ebp
.text:00413059		       mov     ebp, esp
.text:0041305B		       push    ebx
.text:0041305C		       push    esi
.text:0041305D		       push    edi
.text:0041305E		       push    ebp
.text:0041305F		       push    0
.text:00413061		       push    0
.text:00413063		       push    offset _gu_return
.text:00413068		       push    [ebp+arg_0]
.text:0041306B		       call    _RtlUnwind@16   ; RtlUnwind(x,x,x,x)
.text:00413070
.text:00413070 _gu_return:			       ; DATA XREF: __global_unwind2+Bo
.text:00413070		       pop     ebp
.text:00413071		       pop     edi
.text:00413072		       pop     esi
.text:00413073		       pop     ebx
.text:00413074		       mov     esp, ebp
.text:00413076		       pop     ebp
.text:00413077		       retn
.text:00413077 __global_unwind2	endp
.text:00413077
.text:00413078
.text:00413078 ; =============== S U B R O U T I N E =======================================
.text:00413078
.text:00413078
.text:00413078 __unwind_handler	proc near	       ; DATA XREF: __local_unwind2+Bo
.text:00413078					       ; __abnormal_termination+9o
.text:00413078
.text:00413078 arg_0	       = dword ptr  4
.text:00413078 arg_4	       = dword ptr  8
.text:00413078 arg_C	       = dword ptr  10h
.text:00413078 arg_10	       = dword ptr  14h
.text:00413078
.text:00413078		       mov     ecx, [esp+arg_0]
.text:0041307C		       test    dword ptr [ecx+4], 6
.text:00413083		       mov     eax, 1
.text:00413088		       jz      short _uh_return
.text:0041308A		       mov     eax, [esp+arg_10]
.text:0041308E		       mov     ecx, [eax-4]
.text:00413091		       xor     ecx, eax	       ; cookie
.text:00413093		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00413098		       push    ebp
.text:00413099		       mov     ebp, [eax+10h]
.text:0041309C		       mov     edx, [eax+28h]
.text:0041309F		       push    edx
.text:004130A0		       mov     edx, [eax+24h]
.text:004130A3		       push    edx
.text:004130A4		       call    __local_unwind2
.text:004130A9		       add     esp, 8
.text:004130AC		       pop     ebp
.text:004130AD		       mov     eax, [esp+arg_4]
.text:004130B1		       mov     edx, [esp+arg_C]
.text:004130B5		       mov     [edx], eax
.text:004130B7		       mov     eax, 3
.text:004130BC
.text:004130BC _uh_return:			       ; CODE XREF: __unwind_handler+10j
.text:004130BC		       retn
.text:004130BC __unwind_handler	endp
.text:004130BC
.text:004130BD
.text:004130BD ; =============== S U B R O U T I N E =======================================
.text:004130BD
.text:004130BD
.text:004130BD __local_unwind2 proc near	       ; CODE XREF: __unwind_handler+2Cp
.text:004130BD
.text:004130BD var_20	       = dword ptr -20h
.text:004130BD var_18	       = dword ptr -18h
.text:004130BD arg_0	       = dword ptr  4
.text:004130BD arg_4	       = dword ptr  8
.text:004130BD
.text:004130BD		       push    ebx
.text:004130BE		       push    esi
.text:004130BF		       push    edi
.text:004130C0		       mov     eax, [esp+0Ch+arg_0]
.text:004130C4		       push    ebp
.text:004130C5		       push    eax
.text:004130C6		       push    0FFFFFFFEh
.text:004130C8		       push    offset __unwind_handler
.text:004130CD		       push    large dword ptr fs:0
.text:004130D4		       mov     eax, ___security_cookie
.text:004130D9		       xor     eax, esp
.text:004130DB		       push    eax
.text:004130DC		       lea     eax, [esp+24h+var_20]
.text:004130E0		       mov     large fs:0, eax
.text:004130E6
.text:004130E6 _lu_top_0:			       ; CODE XREF: __local_unwind2:_lu_continuej
.text:004130E6		       mov     eax, [esp+24h+arg_0]
.text:004130EA		       mov     ebx, [eax+8]
.text:004130ED		       mov     esi, [eax+0Ch]
.text:004130F0		       cmp     esi, 0FFFFFFFFh
.text:004130F3		       jz      short _lu_done_0
.text:004130F5		       cmp     [esp+24h+arg_4],	0FFFFFFFFh
.text:004130FA		       jz      short _continue_
.text:004130FC		       cmp     esi, [esp+24h+arg_4]
.text:00413100		       jbe     short _lu_done_0
.text:00413102
.text:00413102 _continue_:			       ; CODE XREF: __local_unwind2+3Dj
.text:00413102		       lea     esi, [esi+esi*2]
.text:00413105		       mov     ecx, [ebx+esi*4]
.text:00413108		       mov     [esp+24h+var_18], ecx
.text:0041310C		       mov     [eax+0Ch], ecx
.text:0041310F		       cmp     dword ptr [ebx+esi*4+4],	0
.text:00413114		       jnz     short _lu_continue
.text:00413116		       push    101h
.text:0041311B		       mov     eax, [ebx+esi*4+8]
.text:0041311F		       call    __NLG_Notify
.text:00413124		       mov     eax, [ebx+esi*4+8]
.text:00413128		       call    __NLG_Call
.text:0041312D
.text:0041312D _lu_continue:			       ; CODE XREF: __local_unwind2+57j
.text:0041312D		       jmp     short _lu_top_0
.text:0041312F ; ---------------------------------------------------------------------------
.text:0041312F
.text:0041312F _lu_done_0:			       ; CODE XREF: __local_unwind2+36j
.text:0041312F					       ; __local_unwind2+43j
.text:0041312F		       mov     ecx, [esp+24h+var_20]
.text:00413133		       mov     large fs:0, ecx
.text:0041313A		       add     esp, 18h
.text:0041313D		       pop     edi
.text:0041313E		       pop     esi
.text:0041313F		       pop     ebx
.text:00413140		       retn
.text:00413140 __local_unwind2 endp
.text:00413140
.text:00413141
.text:00413141 ; =============== S U B R O U T I N E =======================================
.text:00413141
.text:00413141
.text:00413141 ; int __cdecl _abnormal_termination()
.text:00413141 __abnormal_termination proc near
.text:00413141		       xor     eax, eax
.text:00413143		       mov     ecx, large fs:0
.text:0041314A		       cmp     dword ptr [ecx+4], offset __unwind_handler
.text:00413151		       jnz     short _at_done
.text:00413153		       mov     edx, [ecx+0Ch]
.text:00413156		       mov     edx, [edx+0Ch]
.text:00413159		       cmp     [ecx+8],	edx
.text:0041315C		       jnz     short _at_done
.text:0041315E		       mov     eax, 1
.text:00413163
.text:00413163 _at_done:			       ; CODE XREF: __abnormal_termination+10j
.text:00413163					       ; __abnormal_termination+1Bj
.text:00413163		       retn
.text:00413163 __abnormal_termination endp
.text:00413163
.text:00413164
.text:00413164 ; =============== S U B R O U T I N E =======================================
.text:00413164
.text:00413164
.text:00413164 __NLG_Notify1   proc near
.text:00413164		       push    ebx
.text:00413165		       push    ecx
.text:00413166		       mov     ebx, offset __NLG_Destination
.text:0041316B		       jmp     short __NLG_Go
.text:0041316B __NLG_Notify1   endp
.text:0041316B
.text:0041316D
.text:0041316D ; =============== S U B R O U T I N E =======================================
.text:0041316D
.text:0041316D
.text:0041316D __NLG_Notify    proc near	       ; CODE XREF: __local_unwind4+6Ep
.text:0041316D					       ; _EH4_TransferToHandler(x,x)+8p ...
.text:0041316D
.text:0041316D arg_0	       = dword ptr  4
.text:0041316D
.text:0041316D		       push    ebx
.text:0041316E		       push    ecx
.text:0041316F		       mov     ebx, offset __NLG_Destination
.text:00413174		       mov     ecx, [esp+8+arg_0]
.text:00413178
.text:00413178 __NLG_Go:			       ; CODE XREF: __NLG_Notify1+7j
.text:00413178		       mov     [ebx+8],	ecx
.text:0041317B		       mov     [ebx+4],	eax
.text:0041317E		       mov     [ebx+0Ch], ebp
.text:00413181		       push    ebp
.text:00413182		       push    ecx
.text:00413183		       push    eax
.text:00413184
.text:00413184 __NLG_Dispatch2:
.text:00413184		       pop     eax
.text:00413185		       pop     ecx
.text:00413186		       pop     ebp
.text:00413187		       pop     ecx
.text:00413188		       pop     ebx
.text:00413189		       retn    4
.text:00413189 __NLG_Notify    endp
.text:00413189
.text:0041318C
.text:0041318C ; =============== S U B R O U T I N E =======================================
.text:0041318C
.text:0041318C
.text:0041318C __NLG_Call      proc near	       ; CODE XREF: __local_unwind4+7Bp
.text:0041318C					       ; __local_unwind2+6Bp
.text:0041318C		       call    eax
.text:0041318E
.text:0041318E __NLG_Return2:
.text:0041318E		       retn
.text:0041318E __NLG_Call      endp
.text:0041318E
.text:0041318F
.text:0041318F ; =============== S U B R O U T I N E =======================================
.text:0041318F
.text:0041318F ; Attributes: bp-based frame
.text:0041318F
.text:0041318F ; unsigned int __cdecl strtoxl(localeinfo_struct	*plocinfo, const char *nptr, const char	**endptr, int ibase, int flags)
.text:0041318F strtoxl	       proc near	       ; CODE XREF: _strtol:loc_4133D9p
.text:0041318F					       ; __strtol_l+12p ...
.text:0041318F
.text:0041318F _loc_update     = _LocaleUpdate ptr -14h
.text:0041318F number	       = dword ptr -4
.text:0041318F plocinfo	       = dword ptr  8
.text:0041318F nptr	       = dword ptr  0Ch
.text:0041318F endptr	       = dword ptr  10h
.text:0041318F ibase	       = dword ptr  14h
.text:0041318F flags	       = dword ptr  18h
.text:0041318F
.text:0041318F		       push    ebp
.text:00413190		       mov     ebp, esp
.text:00413192		       sub     esp, 14h
.text:00413195		       push    esi
.text:00413196		       push    edi
.text:00413197		       push    [ebp+plocinfo]  ; plocinfo
.text:0041319A		       lea     ecx, [ebp+_loc_update] ;	this
.text:0041319D		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004131A2		       mov     eax, [ebp+endptr]
.text:004131A5		       mov     esi, [ebp+nptr]
.text:004131A8		       xor     edi, edi
.text:004131AA		       cmp     eax, edi
.text:004131AC		       jz      short loc_4131B0
.text:004131AE		       mov     [eax], esi
.text:004131B0
.text:004131B0 loc_4131B0:			       ; CODE XREF: strtoxl+1Dj
.text:004131B0		       cmp     esi, edi
.text:004131B2		       jnz     short loc_4131E0
.text:004131B4
.text:004131B4 loc_4131B4:			       ; CODE XREF: strtoxl+5Aj
.text:004131B4					       ; strtoxl+60j
.text:004131B4		       call    __errno
.text:004131B9		       push    edi	       ; pReserved
.text:004131BA		       push    edi	       ; nLine
.text:004131BB		       push    edi	       ; pszFile
.text:004131BC		       push    edi	       ; pszFunction
.text:004131BD		       push    edi	       ; pszExpression
.text:004131BE		       mov     dword ptr [eax],	16h
.text:004131C4		       call    __invalid_parameter
.text:004131C9		       add     esp, 14h
.text:004131CC		       cmp     [ebp+_loc_update.updated], 0
.text:004131D0		       jz      short loc_4131D9
.text:004131D2		       mov     eax, [ebp+_loc_update.ptd]
.text:004131D5		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004131D9
.text:004131D9 loc_4131D9:			       ; CODE XREF: strtoxl+41j
.text:004131D9		       xor     eax, eax
.text:004131DB		       jmp     loc_4133B6
.text:004131E0 ; ---------------------------------------------------------------------------
.text:004131E0
.text:004131E0 loc_4131E0:			       ; CODE XREF: strtoxl+23j
.text:004131E0		       cmp     [ebp+ibase], edi
.text:004131E3		       jz      short loc_4131F1
.text:004131E5		       cmp     [ebp+ibase], 2
.text:004131E9		       jl      short loc_4131B4
.text:004131EB		       cmp     [ebp+ibase], 24h
.text:004131EF		       jg      short loc_4131B4
.text:004131F1
.text:004131F1 loc_4131F1:			       ; CODE XREF: strtoxl+54j
.text:004131F1		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:004131F4		       push    ebx
.text:004131F5		       mov     bl, [esi]
.text:004131F7		       mov     [ebp+number], edi
.text:004131FA		       lea     edi, [esi+1]
.text:004131FD
.text:004131FD loc_4131FD:			       ; CODE XREF: strtoxl+A5j
.text:004131FD		       cmp     dword ptr [ecx+0ACh], 1
.text:00413204		       jle     short loc_41321D
.text:00413206		       lea     eax, [ebp+_loc_update]
.text:00413209		       push    eax	       ; plocinfo
.text:0041320A		       movzx   eax, bl
.text:0041320D		       push    8	       ; mask
.text:0041320F		       push    eax	       ; c
.text:00413210		       call    __isctype_l
.text:00413215		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:00413218		       add     esp, 0Ch
.text:0041321B		       jmp     short loc_41322D
.text:0041321D ; ---------------------------------------------------------------------------
.text:0041321D
.text:0041321D loc_41321D:			       ; CODE XREF: strtoxl+75j
.text:0041321D		       mov     edx, [ecx+0C8h]
.text:00413223		       movzx   eax, bl
.text:00413226		       movzx   eax, byte ptr [edx+eax*2]
.text:0041322A		       and     eax, 8
.text:0041322D
.text:0041322D loc_41322D:			       ; CODE XREF: strtoxl+8Cj
.text:0041322D		       test    eax, eax
.text:0041322F		       jz      short loc_413236
.text:00413231		       mov     bl, [edi]
.text:00413233		       inc     edi
.text:00413234		       jmp     short loc_4131FD
.text:00413236 ; ---------------------------------------------------------------------------
.text:00413236
.text:00413236 loc_413236:			       ; CODE XREF: strtoxl+A0j
.text:00413236		       cmp     bl, 2Dh
.text:00413239		       jnz     short loc_413241
.text:0041323B		       or      [ebp+flags], 2
.text:0041323F		       jmp     short loc_413246
.text:00413241 ; ---------------------------------------------------------------------------
.text:00413241
.text:00413241 loc_413241:			       ; CODE XREF: strtoxl+AAj
.text:00413241		       cmp     bl, 2Bh
.text:00413244		       jnz     short loc_413249
.text:00413246
.text:00413246 loc_413246:			       ; CODE XREF: strtoxl+B0j
.text:00413246		       mov     bl, [edi]
.text:00413248		       inc     edi
.text:00413249
.text:00413249 loc_413249:			       ; CODE XREF: strtoxl+B5j
.text:00413249		       mov     eax, [ebp+ibase]
.text:0041324C		       test    eax, eax
.text:0041324E		       jl      loc_41339D
.text:00413254		       cmp     eax, 1
.text:00413257		       jz      loc_41339D
.text:0041325D		       cmp     eax, 24h
.text:00413260		       jg      loc_41339D
.text:00413266		       test    eax, eax
.text:00413268		       jnz     short loc_413294
.text:0041326A		       cmp     bl, 30h
.text:0041326D		       jz      short loc_413278
.text:0041326F		       mov     [ebp+ibase], 0Ah
.text:00413276		       jmp     short loc_4132AC
.text:00413278 ; ---------------------------------------------------------------------------
.text:00413278
.text:00413278 loc_413278:			       ; CODE XREF: strtoxl+DEj
.text:00413278		       mov     al, [edi]
.text:0041327A		       cmp     al, 78h
.text:0041327C		       jz      short loc_41328B
.text:0041327E		       cmp     al, 58h
.text:00413280		       jz      short loc_41328B
.text:00413282		       mov     [ebp+ibase], 8
.text:00413289		       jmp     short loc_4132AC
.text:0041328B ; ---------------------------------------------------------------------------
.text:0041328B
.text:0041328B loc_41328B:			       ; CODE XREF: strtoxl+EDj
.text:0041328B					       ; strtoxl+F1j
.text:0041328B		       mov     [ebp+ibase], 10h
.text:00413292		       jmp     short loc_41329E
.text:00413294 ; ---------------------------------------------------------------------------
.text:00413294
.text:00413294 loc_413294:			       ; CODE XREF: strtoxl+D9j
.text:00413294		       cmp     eax, 10h
.text:00413297		       jnz     short loc_4132AC
.text:00413299		       cmp     bl, 30h
.text:0041329C		       jnz     short loc_4132AC
.text:0041329E
.text:0041329E loc_41329E:			       ; CODE XREF: strtoxl+103j
.text:0041329E		       mov     al, [edi]
.text:004132A0		       cmp     al, 78h
.text:004132A2		       jz      short loc_4132A8
.text:004132A4		       cmp     al, 58h
.text:004132A6		       jnz     short loc_4132AC
.text:004132A8
.text:004132A8 loc_4132A8:			       ; CODE XREF: strtoxl+113j
.text:004132A8		       inc     edi
.text:004132A9		       mov     bl, [edi]
.text:004132AB		       inc     edi
.text:004132AC
.text:004132AC loc_4132AC:			       ; CODE XREF: strtoxl+E7j
.text:004132AC					       ; strtoxl+FAj ...
.text:004132AC		       mov     esi, [ecx+0C8h]
.text:004132B2		       or      eax, 0FFFFFFFFh
.text:004132B5		       xor     edx, edx
.text:004132B7		       div     [ebp+ibase]
.text:004132BA
.text:004132BA loc_4132BA:			       ; CODE XREF: strtoxl+19Dj
.text:004132BA		       movzx   ecx, bl
.text:004132BD		       movzx   ecx, word ptr [esi+ecx*2]
.text:004132C1		       test    cl, 4
.text:004132C4		       jz      short loc_4132CE
.text:004132C6		       movsx   ecx, bl
.text:004132C9		       sub     ecx, 30h
.text:004132CC		       jmp     short loc_4132E8
.text:004132CE ; ---------------------------------------------------------------------------
.text:004132CE
.text:004132CE loc_4132CE:			       ; CODE XREF: strtoxl+135j
.text:004132CE		       test    cx, 103h
.text:004132D3		       jz      short loc_413306
.text:004132D5		       mov     cl, bl
.text:004132D7		       sub     cl, 61h
.text:004132DA		       cmp     cl, 19h
.text:004132DD		       movsx   ecx, bl
.text:004132E0		       ja      short loc_4132E5
.text:004132E2		       sub     ecx, 20h
.text:004132E5
.text:004132E5 loc_4132E5:			       ; CODE XREF: strtoxl+151j
.text:004132E5		       add     ecx, 0FFFFFFC9h
.text:004132E8
.text:004132E8 loc_4132E8:			       ; CODE XREF: strtoxl+13Dj
.text:004132E8		       cmp     ecx, [ebp+ibase]
.text:004132EB		       jnb     short loc_413306
.text:004132ED		       or      [ebp+flags], 8
.text:004132F1		       cmp     [ebp+number], eax
.text:004132F4		       jb      short loc_41331D
.text:004132F6		       jnz     short loc_4132FC
.text:004132F8		       cmp     ecx, edx
.text:004132FA		       jbe     short loc_41331D
.text:004132FC
.text:004132FC loc_4132FC:			       ; CODE XREF: strtoxl+167j
.text:004132FC		       or      [ebp+flags], 4
.text:00413300		       cmp     [ebp+endptr], 0
.text:00413304		       jnz     short loc_413329
.text:00413306
.text:00413306 loc_413306:			       ; CODE XREF: strtoxl+144j
.text:00413306					       ; strtoxl+15Cj
.text:00413306		       mov     eax, [ebp+flags]
.text:00413309		       dec     edi
.text:0041330A		       test    al, 8
.text:0041330C		       jnz     short loc_41332E
.text:0041330E		       cmp     [ebp+endptr], 0
.text:00413312		       jz      short loc_413317
.text:00413314		       mov     edi, [ebp+nptr]
.text:00413317
.text:00413317 loc_413317:			       ; CODE XREF: strtoxl+183j
.text:00413317		       and     [ebp+number], 0
.text:0041331B		       jmp     short loc_413379
.text:0041331D ; ---------------------------------------------------------------------------
.text:0041331D
.text:0041331D loc_41331D:			       ; CODE XREF: strtoxl+165j
.text:0041331D					       ; strtoxl+16Bj
.text:0041331D		       mov     ebx, [ebp+number]
.text:00413320		       imul    ebx, [ebp+ibase]
.text:00413324		       add     ebx, ecx
.text:00413326		       mov     [ebp+number], ebx
.text:00413329
.text:00413329 loc_413329:			       ; CODE XREF: strtoxl+175j
.text:00413329		       mov     bl, [edi]
.text:0041332B		       inc     edi
.text:0041332C		       jmp     short loc_4132BA
.text:0041332E ; ---------------------------------------------------------------------------
.text:0041332E
.text:0041332E loc_41332E:			       ; CODE XREF: strtoxl+17Dj
.text:0041332E		       test    al, 4
.text:00413330		       mov     esi, 7FFFFFFFh
.text:00413335		       jnz     short loc_413352
.text:00413337		       test    al, 1
.text:00413339		       jnz     short loc_413379
.text:0041333B		       and     eax, 2
.text:0041333E		       jz      short loc_413349
.text:00413340		       cmp     [ebp+number], 80000000h
.text:00413347		       ja      short loc_413352
.text:00413349
.text:00413349 loc_413349:			       ; CODE XREF: strtoxl+1AFj
.text:00413349		       test    eax, eax
.text:0041334B		       jnz     short loc_413379
.text:0041334D		       cmp     [ebp+number], esi
.text:00413350		       jbe     short loc_413379
.text:00413352
.text:00413352 loc_413352:			       ; CODE XREF: strtoxl+1A6j
.text:00413352					       ; strtoxl+1B8j
.text:00413352		       call    __errno
.text:00413357		       test    byte ptr	[ebp+flags], 1
.text:0041335B		       mov     dword ptr [eax],	22h
.text:00413361		       jz      short loc_413369
.text:00413363		       or      [ebp+number], 0FFFFFFFFh
.text:00413367		       jmp     short loc_413379
.text:00413369 ; ---------------------------------------------------------------------------
.text:00413369
.text:00413369 loc_413369:			       ; CODE XREF: strtoxl+1D2j
.text:00413369		       mov     al, byte	ptr [ebp+flags]
.text:0041336C		       and     al, 2
.text:0041336E		       neg     al
.text:00413370		       sbb     eax, eax
.text:00413372		       neg     eax
.text:00413374		       add     eax, esi
.text:00413376		       mov     [ebp+number], eax
.text:00413379
.text:00413379 loc_413379:			       ; CODE XREF: strtoxl+18Cj
.text:00413379					       ; strtoxl+1AAj ...
.text:00413379		       mov     eax, [ebp+endptr]
.text:0041337C		       test    eax, eax
.text:0041337E		       jz      short loc_413382
.text:00413380		       mov     [eax], edi
.text:00413382
.text:00413382 loc_413382:			       ; CODE XREF: strtoxl+1EFj
.text:00413382		       test    byte ptr	[ebp+flags], 2
.text:00413386		       jz      short loc_41338B
.text:00413388		       neg     [ebp+number]
.text:0041338B
.text:0041338B loc_41338B:			       ; CODE XREF: strtoxl+1F7j
.text:0041338B		       cmp     [ebp+_loc_update.updated], 0
.text:0041338F		       jz      short loc_413398
.text:00413391		       mov     eax, [ebp+_loc_update.ptd]
.text:00413394		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00413398
.text:00413398 loc_413398:			       ; CODE XREF: strtoxl+200j
.text:00413398		       mov     eax, [ebp+number]
.text:0041339B		       jmp     short loc_4133B5
.text:0041339D ; ---------------------------------------------------------------------------
.text:0041339D
.text:0041339D loc_41339D:			       ; CODE XREF: strtoxl+BFj
.text:0041339D					       ; strtoxl+C8j ...
.text:0041339D		       mov     eax, [ebp+endptr]
.text:004133A0		       test    eax, eax
.text:004133A2		       jz      short loc_4133A6
.text:004133A4		       mov     [eax], esi
.text:004133A6
.text:004133A6 loc_4133A6:			       ; CODE XREF: strtoxl+213j
.text:004133A6		       cmp     [ebp+_loc_update.updated], 0
.text:004133AA		       jz      short loc_4133B3
.text:004133AC		       mov     eax, [ebp+_loc_update.ptd]
.text:004133AF		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004133B3
.text:004133B3 loc_4133B3:			       ; CODE XREF: strtoxl+21Bj
.text:004133B3		       xor     eax, eax
.text:004133B5
.text:004133B5 loc_4133B5:			       ; CODE XREF: strtoxl+20Cj
.text:004133B5		       pop     ebx
.text:004133B6
.text:004133B6 loc_4133B6:			       ; CODE XREF: strtoxl+4Cj
.text:004133B6		       pop     edi
.text:004133B7		       pop     esi
.text:004133B8		       leave
.text:004133B9		       retn
.text:004133B9 strtoxl	       endp
.text:004133B9
.text:004133BA
.text:004133BA ; =============== S U B R O U T I N E =======================================
.text:004133BA
.text:004133BA ; Attributes: bp-based frame
.text:004133BA
.text:004133BA ; int __cdecl strtol(const char *nptr, char **endptr, int ibase)
.text:004133BA _strtol	       proc near	       ; CODE XREF: __output_p_l+1E1p
.text:004133BA					       ; __output_p_l+226p ...
.text:004133BA
.text:004133BA nptr	       = dword ptr  8
.text:004133BA endptr	       = dword ptr  0Ch
.text:004133BA ibase	       = dword ptr  10h
.text:004133BA
.text:004133BA		       push    ebp
.text:004133BB		       mov     ebp, esp
.text:004133BD		       xor     eax, eax
.text:004133BF		       cmp     ___locale_changed, eax
.text:004133C5		       push    eax	       ; flags
.text:004133C6		       push    [ebp+ibase]     ; ibase
.text:004133C9		       push    [ebp+endptr]    ; endptr
.text:004133CC		       push    [ebp+nptr]      ; nptr
.text:004133CF		       jnz     short loc_4133D8
.text:004133D1		       push    offset ___initiallocalestructinfo
.text:004133D6		       jmp     short loc_4133D9
.text:004133D8 ; ---------------------------------------------------------------------------
.text:004133D8
.text:004133D8 loc_4133D8:			       ; CODE XREF: _strtol+15j
.text:004133D8		       push    eax	       ; plocinfo
.text:004133D9
.text:004133D9 loc_4133D9:			       ; CODE XREF: _strtol+1Cj
.text:004133D9		       call    strtoxl
.text:004133DE		       add     esp, 14h
.text:004133E1		       pop     ebp
.text:004133E2		       retn
.text:004133E2 _strtol	       endp
.text:004133E2
.text:004133E3
.text:004133E3 ; =============== S U B R O U T I N E =======================================
.text:004133E3
.text:004133E3
.text:004133E3 ; int __cdecl _strtol_l(const char *nptr, char **endptr,	int ibase, localeinfo_struct *plocinfo)
.text:004133E3 __strtol_l      proc near	       ; CODE XREF: __atol_l+Cp
.text:004133E3
.text:004133E3 nptr	       = dword ptr  4
.text:004133E3 endptr	       = dword ptr  8
.text:004133E3 ibase	       = dword ptr  0Ch
.text:004133E3 plocinfo	       = dword ptr  10h
.text:004133E3
.text:004133E3		       push    0	       ; flags
.text:004133E5		       push    [esp+4+ibase]   ; ibase
.text:004133E9		       push    [esp+8+endptr]  ; endptr
.text:004133ED		       push    [esp+0Ch+nptr]  ; nptr
.text:004133F1		       push    [esp+10h+plocinfo] ; plocinfo
.text:004133F5		       call    strtoxl
.text:004133FA		       add     esp, 14h
.text:004133FD		       retn
.text:004133FD __strtol_l      endp
.text:004133FD
.text:004133FE
.text:004133FE ; =============== S U B R O U T I N E =======================================
.text:004133FE
.text:004133FE ; Attributes: bp-based frame
.text:004133FE
.text:004133FE ; unsigned int __cdecl strtoul(const char *nptr,	char **endptr, int ibase)
.text:004133FE _strtoul	       proc near
.text:004133FE
.text:004133FE nptr	       = dword ptr  8
.text:004133FE endptr	       = dword ptr  0Ch
.text:004133FE ibase	       = dword ptr  10h
.text:004133FE
.text:004133FE		       push    ebp
.text:004133FF		       mov     ebp, esp
.text:00413401		       cmp     ___locale_changed, 0
.text:00413408		       push    1	       ; flags
.text:0041340A		       push    [ebp+ibase]     ; ibase
.text:0041340D		       push    [ebp+endptr]    ; endptr
.text:00413410		       push    [ebp+nptr]      ; nptr
.text:00413413		       jnz     short loc_41341C
.text:00413415		       push    offset ___initiallocalestructinfo
.text:0041341A		       jmp     short loc_41341E
.text:0041341C ; ---------------------------------------------------------------------------
.text:0041341C
.text:0041341C loc_41341C:			       ; CODE XREF: _strtoul+15j
.text:0041341C		       push    0	       ; plocinfo
.text:0041341E
.text:0041341E loc_41341E:			       ; CODE XREF: _strtoul+1Cj
.text:0041341E		       call    strtoxl
.text:00413423		       add     esp, 14h
.text:00413426		       pop     ebp
.text:00413427		       retn
.text:00413427 _strtoul	       endp
.text:00413427
.text:00413428
.text:00413428 ; =============== S U B R O U T I N E =======================================
.text:00413428
.text:00413428
.text:00413428 ; unsigned int __cdecl _strtoul_l(const char *nptr, char	**endptr, int ibase, localeinfo_struct *plocinfo)
.text:00413428 __strtoul_l     proc near
.text:00413428
.text:00413428 nptr	       = dword ptr  4
.text:00413428 endptr	       = dword ptr  8
.text:00413428 ibase	       = dword ptr  0Ch
.text:00413428 plocinfo	       = dword ptr  10h
.text:00413428
.text:00413428		       push    1	       ; flags
.text:0041342A		       push    [esp+4+ibase]   ; ibase
.text:0041342E		       push    [esp+8+endptr]  ; endptr
.text:00413432		       push    [esp+0Ch+nptr]  ; nptr
.text:00413436		       push    [esp+10h+plocinfo] ; plocinfo
.text:0041343A		       call    strtoxl
.text:0041343F		       add     esp, 14h
.text:00413442		       retn
.text:00413442 __strtoul_l     endp
.text:00413442
.text:00413443
.text:00413443 ; =============== S U B R O U T I N E =======================================
.text:00413443
.text:00413443 ; Attributes: bp-based frame
.text:00413443
.text:00413443 ; void __cdecl fastcopy_I(void *dst, void *src, int len)
.text:00413443 fastcopy_I      proc near	       ; CODE XREF: __VEC_memcpy+4Dp
.text:00413443
.text:00413443 var_8	       = dword ptr -8
.text:00413443 var_4	       = dword ptr -4
.text:00413443 dst	       = dword ptr  8
.text:00413443 src	       = dword ptr  0Ch
.text:00413443 len	       = dword ptr  10h
.text:00413443
.text:00413443		       push    ebp
.text:00413444		       mov     ebp, esp
.text:00413446		       sub     esp, 8
.text:00413449		       mov     [ebp+var_4], edi
.text:0041344C		       mov     [ebp+var_8], esi
.text:0041344F		       mov     esi, [ebp+src]
.text:00413452		       mov     edi, [ebp+dst]
.text:00413455		       mov     ecx, [ebp+len]
.text:00413458		       shr     ecx, 7
.text:0041345B		       jmp     short L_1_0
.text:0041345B ; ---------------------------------------------------------------------------
.text:0041345D		       db 8Dh, 9Bh, 4 dup(0)
.text:00413463 ; ---------------------------------------------------------------------------
.text:00413463
.text:00413463 L_1_0:				       ; CODE XREF: fastcopy_I+18j
.text:00413463					       ; fastcopy_I+7Bj
.text:00413463		       movdqa  xmm0, xmmword ptr [esi]
.text:00413467		       movdqa  xmm1, xmmword ptr [esi+10h]
.text:0041346C		       movdqa  xmm2, xmmword ptr [esi+20h]
.text:00413471		       movdqa  xmm3, xmmword ptr [esi+30h]
.text:00413476		       movdqa  xmmword ptr [edi], xmm0
.text:0041347A		       movdqa  xmmword ptr [edi+10h], xmm1
.text:0041347F		       movdqa  xmmword ptr [edi+20h], xmm2
.text:00413484		       movdqa  xmmword ptr [edi+30h], xmm3
.text:00413489		       movdqa  xmm4, xmmword ptr [esi+40h]
.text:0041348E		       movdqa  xmm5, xmmword ptr [esi+50h]
.text:00413493		       movdqa  xmm6, xmmword ptr [esi+60h]
.text:00413498		       movdqa  xmm7, xmmword ptr [esi+70h]
.text:0041349D		       movdqa  xmmword ptr [edi+40h], xmm4
.text:004134A2		       movdqa  xmmword ptr [edi+50h], xmm5
.text:004134A7		       movdqa  xmmword ptr [edi+60h], xmm6
.text:004134AC		       movdqa  xmmword ptr [edi+70h], xmm7
.text:004134B1		       lea     esi, [esi+80h]
.text:004134B7		       lea     edi, [edi+80h]
.text:004134BD		       dec     ecx
.text:004134BE		       jnz     short L_1_0
.text:004134C0		       mov     esi, [ebp+var_8]
.text:004134C3		       mov     edi, [ebp+var_4]
.text:004134C6		       mov     esp, ebp
.text:004134C8		       pop     ebp
.text:004134C9		       retn
.text:004134C9 fastcopy_I      endp
.text:004134C9
.text:004134CA
.text:004134CA ; =============== S U B R O U T I N E =======================================
.text:004134CA
.text:004134CA ; Attributes: bp-based frame
.text:004134CA
.text:004134CA ; void *__cdecl _VEC_memcpy(void	*dst, void *src, int len)
.text:004134CA __VEC_memcpy    proc near	       ; CODE XREF: _memmove+42j
.text:004134CA					       ; _memcpy+42j ...
.text:004134CA
.text:004134CA var_1C	       = dword ptr -1Ch
.text:004134CA var_18	       = dword ptr -18h
.text:004134CA var_14	       = dword ptr -14h
.text:004134CA var_10	       = dword ptr -10h
.text:004134CA var_C	       = dword ptr -0Ch
.text:004134CA var_8	       = dword ptr -8
.text:004134CA var_4	       = dword ptr -4
.text:004134CA dst	       = dword ptr  8
.text:004134CA src	       = dword ptr  0Ch
.text:004134CA len	       = dword ptr  10h
.text:004134CA
.text:004134CA		       push    ebp
.text:004134CB		       mov     ebp, esp
.text:004134CD		       sub     esp, 1Ch
.text:004134D0		       mov     [ebp+var_C], edi
.text:004134D3		       mov     [ebp+var_8], esi
.text:004134D6		       mov     [ebp+var_4], ebx
.text:004134D9		       mov     ebx, [ebp+src]
.text:004134DC		       mov     eax, ebx
.text:004134DE		       cdq
.text:004134DF		       mov     ecx, eax
.text:004134E1		       mov     eax, [ebp+dst]
.text:004134E4		       xor     ecx, edx
.text:004134E6		       sub     ecx, edx
.text:004134E8		       and     ecx, 0Fh
.text:004134EB		       xor     ecx, edx
.text:004134ED		       sub     ecx, edx
.text:004134EF		       cdq
.text:004134F0		       mov     edi, eax
.text:004134F2		       xor     edi, edx
.text:004134F4		       sub     edi, edx
.text:004134F6		       and     edi, 0Fh
.text:004134F9		       xor     edi, edx
.text:004134FB		       sub     edi, edx
.text:004134FD		       mov     edx, ecx
.text:004134FF		       or      edx, edi
.text:00413501		       jnz     short L_notaligned_0
.text:00413503		       mov     esi, [ebp+len]
.text:00413506		       mov     ecx, esi
.text:00413508		       and     ecx, 7Fh
.text:0041350B		       mov     [ebp+var_18], ecx
.text:0041350E		       cmp     esi, ecx
.text:00413510		       jz      short L_trailing_0
.text:00413512		       sub     esi, ecx
.text:00413514		       push    esi	       ; len
.text:00413515		       push    ebx	       ; src
.text:00413516		       push    eax	       ; dst
.text:00413517		       call    fastcopy_I
.text:0041351C		       add     esp, 0Ch
.text:0041351F		       mov     eax, [ebp+dst]
.text:00413522		       mov     ecx, [ebp+var_18]
.text:00413525
.text:00413525 L_trailing_0:			       ; CODE XREF: __VEC_memcpy+46j
.text:00413525		       test    ecx, ecx
.text:00413527		       jz      short L_return_0
.text:00413529		       mov     ebx, [ebp+len]
.text:0041352C		       mov     edx, [ebp+src]
.text:0041352F		       add     edx, ebx
.text:00413531		       sub     edx, ecx
.text:00413533		       mov     [ebp+var_14], edx
.text:00413536		       add     ebx, eax
.text:00413538		       sub     ebx, ecx
.text:0041353A		       mov     [ebp+var_10], ebx
.text:0041353D		       mov     esi, [ebp+var_14]
.text:00413540		       mov     edi, [ebp+var_10]
.text:00413543		       mov     ecx, [ebp+var_18]
.text:00413546		       rep movsb
.text:00413548		       mov     eax, [ebp+dst]
.text:0041354B		       jmp     short L_return_0
.text:0041354D ; ---------------------------------------------------------------------------
.text:0041354D
.text:0041354D L_notaligned_0:			       ; CODE XREF: __VEC_memcpy+37j
.text:0041354D		       cmp     ecx, edi
.text:0041354F		       jnz     short L_unequalalign
.text:00413551		       neg     ecx
.text:00413553		       add     ecx, 10h
.text:00413556		       mov     [ebp+var_1C], ecx
.text:00413559		       mov     esi, [ebp+src]
.text:0041355C		       mov     edi, [ebp+dst]
.text:0041355F		       mov     ecx, [ebp+var_1C]
.text:00413562		       rep movsb
.text:00413564		       mov     ecx, [ebp+dst]
.text:00413567		       add     ecx, [ebp+var_1C]
.text:0041356A		       mov     edx, [ebp+src]
.text:0041356D		       add     edx, [ebp+var_1C]
.text:00413570		       mov     eax, [ebp+len]
.text:00413573		       sub     eax, [ebp+var_1C]
.text:00413576		       push    eax	       ; len
.text:00413577		       push    edx	       ; src
.text:00413578		       push    ecx	       ; dst
.text:00413579		       call    __VEC_memcpy
.text:0041357E		       add     esp, 0Ch
.text:00413581		       mov     eax, [ebp+dst]
.text:00413584		       jmp     short L_return_0
.text:00413586 ; ---------------------------------------------------------------------------
.text:00413586
.text:00413586 L_unequalalign:			       ; CODE XREF: __VEC_memcpy+85j
.text:00413586		       mov     esi, [ebp+src]
.text:00413589		       mov     edi, [ebp+dst]
.text:0041358C		       mov     ecx, [ebp+len]
.text:0041358F		       mov     edx, ecx
.text:00413591		       shr     ecx, 2
.text:00413594		       rep movsd
.text:00413596		       mov     ecx, edx
.text:00413598		       and     ecx, 3
.text:0041359B		       rep movsb
.text:0041359D		       mov     eax, [ebp+dst]
.text:004135A0
.text:004135A0 L_return_0:			       ; CODE XREF: __VEC_memcpy+5Dj
.text:004135A0					       ; __VEC_memcpy+81j ...
.text:004135A0		       mov     ebx, [ebp+var_4]
.text:004135A3		       mov     esi, [ebp+var_8]
.text:004135A6		       mov     edi, [ebp+var_C]
.text:004135A9		       mov     esp, ebp
.text:004135AB		       pop     ebp
.text:004135AC		       retn
.text:004135AC __VEC_memcpy    endp
.text:004135AC
.text:004135AD
.text:004135AD ; =============== S U B R O U T I N E =======================================
.text:004135AD
.text:004135AD ; Attributes: bp-based frame
.text:004135AD
.text:004135AD ; int __cdecl _isctype_l(int c, int mask, localeinfo_struct *plocinfo)
.text:004135AD __isctype_l     proc near	       ; CODE XREF: __isalpha_l+29p
.text:004135AD					       ; __isupper_l+26p ...
.text:004135AD
.text:004135AD _loc_update     = _LocaleUpdate ptr -18h
.text:004135AD buffer	       = byte ptr -8
.text:004135AD chartype	       = word ptr -4
.text:004135AD c	       = dword ptr  8
.text:004135AD mask	       = dword ptr  0Ch
.text:004135AD plocinfo	       = dword ptr  10h
.text:004135AD
.text:004135AD		       push    ebp
.text:004135AE		       mov     ebp, esp
.text:004135B0		       sub     esp, 18h
.text:004135B3		       push    ebx
.text:004135B4		       push    [ebp+plocinfo]  ; plocinfo
.text:004135B7		       lea     ecx, [ebp+_loc_update] ;	this
.text:004135BA		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004135BF		       mov     ebx, [ebp+c]
.text:004135C2		       lea     eax, [ebx+1]
.text:004135C5		       cmp     eax, 100h
.text:004135CA		       ja      short loc_4135DB
.text:004135CC		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004135CF		       mov     eax, [eax+0C8h]
.text:004135D5		       movzx   eax, word ptr [eax+ebx*2]
.text:004135D9		       jmp     short loc_413650
.text:004135DB ; ---------------------------------------------------------------------------
.text:004135DB
.text:004135DB loc_4135DB:			       ; CODE XREF: __isctype_l+1Dj
.text:004135DB		       mov     [ebp+c],	ebx
.text:004135DE		       sar     [ebp+c],	8
.text:004135E2		       lea     eax, [ebp+_loc_update]
.text:004135E5		       push    eax	       ; plocinfo
.text:004135E6		       mov     eax, [ebp+c]
.text:004135E9		       and     eax, 0FFh
.text:004135EE		       push    eax	       ; c
.text:004135EF		       call    __isleadbyte_l
.text:004135F4		       test    eax, eax
.text:004135F6		       pop     ecx
.text:004135F7		       pop     ecx
.text:004135F8		       jz      short loc_41360C
.text:004135FA		       mov     al, byte	ptr [ebp+c]
.text:004135FD		       push    2
.text:004135FF		       mov     [ebp+buffer], al
.text:00413602		       mov     [ebp+buffer+1], bl
.text:00413605		       mov     [ebp+buffer+2], 0
.text:00413609		       pop     ecx
.text:0041360A		       jmp     short loc_413616
.text:0041360C ; ---------------------------------------------------------------------------
.text:0041360C
.text:0041360C loc_41360C:			       ; CODE XREF: __isctype_l+4Bj
.text:0041360C		       xor     ecx, ecx
.text:0041360E		       mov     [ebp+buffer], bl
.text:00413611		       mov     [ebp+buffer+1], 0
.text:00413615		       inc     ecx
.text:00413616
.text:00413616 loc_413616:			       ; CODE XREF: __isctype_l+5Dj
.text:00413616		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00413619		       push    1	       ; bError
.text:0041361B		       push    dword ptr [eax+14h] ; lcid
.text:0041361E		       push    dword ptr [eax+4] ; code_page
.text:00413621		       lea     eax, [ebp+chartype]
.text:00413624		       push    eax	       ; lpCharType
.text:00413625		       push    ecx	       ; cchSrc
.text:00413626		       lea     eax, [ebp+buffer]
.text:00413629		       push    eax	       ; lpSrcStr
.text:0041362A		       lea     eax, [ebp+_loc_update]
.text:0041362D		       push    1	       ; dwInfoType
.text:0041362F		       push    eax	       ; plocinfo
.text:00413630		       call    ___crtGetStringTypeA
.text:00413635		       add     esp, 20h
.text:00413638		       test    eax, eax
.text:0041363A		       jnz     short loc_41364C
.text:0041363C		       cmp     [ebp+_loc_update.updated], al
.text:0041363F		       jz      short loc_413648
.text:00413641		       mov     eax, [ebp+_loc_update.ptd]
.text:00413644		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00413648
.text:00413648 loc_413648:			       ; CODE XREF: __isctype_l+92j
.text:00413648		       xor     eax, eax
.text:0041364A		       jmp     short loc_413660
.text:0041364C ; ---------------------------------------------------------------------------
.text:0041364C
.text:0041364C loc_41364C:			       ; CODE XREF: __isctype_l+8Dj
.text:0041364C		       movzx   eax, [ebp+chartype]
.text:00413650
.text:00413650 loc_413650:			       ; CODE XREF: __isctype_l+2Cj
.text:00413650		       and     eax, [ebp+mask]
.text:00413653		       cmp     [ebp+_loc_update.updated], 0
.text:00413657		       jz      short loc_413660
.text:00413659		       mov     ecx, [ebp+_loc_update.ptd]
.text:0041365C		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00413660
.text:00413660 loc_413660:			       ; CODE XREF: __isctype_l+9Dj
.text:00413660					       ; __isctype_l+AAj
.text:00413660		       pop     ebx
.text:00413661		       leave
.text:00413662		       retn
.text:00413662 __isctype_l     endp
.text:00413662
.text:00413663
.text:00413663 ; =============== S U B R O U T I N E =======================================
.text:00413663
.text:00413663
.text:00413663 ; int __cdecl _isctype(int c, int mask)
.text:00413663 __isctype       proc near
.text:00413663
.text:00413663 c	       = dword ptr  4
.text:00413663 mask	       = dword ptr  8
.text:00413663
.text:00413663		       cmp     ___locale_changed, 0
.text:0041366A		       jnz     short loc_41367F
.text:0041366C		       mov     eax, [esp+c]
.text:00413670		       mov     ecx, ___initiallocinfo.pctype
.text:00413676		       movzx   eax, word ptr [ecx+eax*2]
.text:0041367A		       and     eax, [esp+mask]
.text:0041367E		       retn
.text:0041367F ; ---------------------------------------------------------------------------
.text:0041367F
.text:0041367F loc_41367F:			       ; CODE XREF: __isctype+7j
.text:0041367F		       push    0	       ; plocinfo
.text:00413681		       push    [esp+4+mask]    ; mask
.text:00413685		       push    [esp+8+c]       ; c
.text:00413689		       call    __isctype_l
.text:0041368E		       add     esp, 0Ch
.text:00413691		       retn
.text:00413691 __isctype       endp
.text:00413691
.text:00413691 ; ---------------------------------------------------------------------------
.text:00413692		       align 10h
.text:004136A0
.text:004136A0 ; =============== S U B R O U T I N E =======================================
.text:004136A0
.text:004136A0
.text:004136A0 __alloca_probe_16 proc near	       ; CODE XREF: __crtGetLocaleInfoW_stat+BBp
.text:004136A0					       ; __crtGetLocaleInfoA_stat+AAp ...
.text:004136A0
.text:004136A0 arg_0	       = byte ptr  4
.text:004136A0
.text:004136A0		       push    ecx
.text:004136A1		       lea     ecx, [esp+4+arg_0]
.text:004136A5		       sub     ecx, eax
.text:004136A7		       and     ecx, 0Fh
.text:004136AA		       add     eax, ecx
.text:004136AC		       sbb     ecx, ecx
.text:004136AE		       or      eax, ecx
.text:004136B0		       pop     ecx
.text:004136B1		       jmp     __chkstk
.text:004136B6 ; ---------------------------------------------------------------------------
.text:004136B6
.text:004136B6 __alloca_probe_8:
.text:004136B6		       push    ecx
.text:004136B7		       lea     ecx, [esp+4+arg_0]
.text:004136BB		       sub     ecx, eax
.text:004136BD		       and     ecx, 7
.text:004136C0		       add     eax, ecx
.text:004136C2		       sbb     ecx, ecx
.text:004136C4		       or      eax, ecx
.text:004136C6		       pop     ecx
.text:004136C7		       jmp     __chkstk
.text:004136C7 __alloca_probe_16 endp
.text:004136C7
.text:004136CC
.text:004136CC ; =============== S U B R O U T I N E =======================================
.text:004136CC
.text:004136CC
.text:004136CC ; int __cdecl _close_nolock(int fh)
.text:004136CC __close_nolock  proc near	       ; CODE XREF: __close+94p
.text:004136CC
.text:004136CC fh	       = dword ptr  4
.text:004136CC
.text:004136CC		       push    esi
.text:004136CD		       mov     esi, [esp+4+fh]
.text:004136D1		       push    edi
.text:004136D2		       push    esi	       ; fh
.text:004136D3		       call    __get_osfhandle
.text:004136D8		       cmp     eax, 0FFFFFFFFh
.text:004136DB		       pop     ecx
.text:004136DC		       jz      short loc_41372E
.text:004136DE		       cmp     esi, 1
.text:004136E1		       mov     eax, ___pioinfo
.text:004136E6		       jnz     short loc_4136F1
.text:004136E8		       test    byte ptr	[eax+84h], 1
.text:004136EF		       jnz     short loc_4136FC
.text:004136F1
.text:004136F1 loc_4136F1:			       ; CODE XREF: __close_nolock+1Aj
.text:004136F1		       cmp     esi, 2
.text:004136F4		       jnz     short loc_413712
.text:004136F6		       test    byte ptr	[eax+44h], 1
.text:004136FA		       jz      short loc_413712
.text:004136FC
.text:004136FC loc_4136FC:			       ; CODE XREF: __close_nolock+23j
.text:004136FC		       push    2	       ; fh
.text:004136FE		       call    __get_osfhandle
.text:00413703		       push    1	       ; fh
.text:00413705		       mov     edi, eax
.text:00413707		       call    __get_osfhandle
.text:0041370C		       cmp     eax, edi
.text:0041370E		       pop     ecx
.text:0041370F		       pop     ecx
.text:00413710		       jz      short loc_41372E
.text:00413712
.text:00413712 loc_413712:			       ; CODE XREF: __close_nolock+28j
.text:00413712					       ; __close_nolock+2Ej
.text:00413712		       push    esi	       ; fh
.text:00413713		       call    __get_osfhandle
.text:00413718		       pop     ecx
.text:00413719		       push    eax	       ; hObject
.text:0041371A		       call    ds:__imp__CloseHandle@4 ; CloseHandle(x)
.text:00413720		       test    eax, eax
.text:00413722		       jnz     short loc_41372E
.text:00413724		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0041372A		       mov     edi, eax
.text:0041372C		       jmp     short loc_413730
.text:0041372E ; ---------------------------------------------------------------------------
.text:0041372E
.text:0041372E loc_41372E:			       ; CODE XREF: __close_nolock+10j
.text:0041372E					       ; __close_nolock+44j ...
.text:0041372E		       xor     edi, edi
.text:00413730
.text:00413730 loc_413730:			       ; CODE XREF: __close_nolock+60j
.text:00413730		       push    esi	       ; fh
.text:00413731		       call    __free_osfhnd
.text:00413736		       mov     eax, esi
.text:00413738		       sar     eax, 5
.text:0041373B		       mov     eax, ___pioinfo[eax*4]
.text:00413742		       and     esi, 1Fh
.text:00413745		       shl     esi, 6
.text:00413748		       test    edi, edi
.text:0041374A		       pop     ecx
.text:0041374B		       mov     byte ptr	[eax+esi+4], 0
.text:00413750		       jz      short loc_41375E
.text:00413752		       push    edi	       ; oserrno
.text:00413753		       call    __dosmaperr
.text:00413758		       pop     ecx
.text:00413759		       or      eax, 0FFFFFFFFh
.text:0041375C		       jmp     short loc_413760
.text:0041375E ; ---------------------------------------------------------------------------
.text:0041375E
.text:0041375E loc_41375E:			       ; CODE XREF: __close_nolock+84j
.text:0041375E		       xor     eax, eax
.text:00413760
.text:00413760 loc_413760:			       ; CODE XREF: __close_nolock+90j
.text:00413760		       pop     edi
.text:00413761		       pop     esi
.text:00413762		       retn
.text:00413762 __close_nolock  endp
.text:00413762
.text:00413763
.text:00413763 ; =============== S U B R O U T I N E =======================================
.text:00413763
.text:00413763 ; Attributes: bp-based frame
.text:00413763
.text:00413763 ; int __cdecl _close(int	fh)
.text:00413763 __close	       proc near	       ; CODE XREF: __fclose_nolock+47p
.text:00413763
.text:00413763 _Expr_val       = dword ptr -20h
.text:00413763 r	       = dword ptr -1Ch
.text:00413763 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00413763 fh	       = dword ptr  8
.text:00413763
.text:00413763		       push    10h
.text:00413765		       push    offset dword_4218F8
.text:0041376A		       call    __SEH_prolog4
.text:0041376F		       mov     eax, [ebp+fh]
.text:00413772		       cmp     eax, 0FFFFFFFEh
.text:00413775		       jnz     short loc_413792
.text:00413777		       call    ___doserrno
.text:0041377C		       and     dword ptr [eax],	0
.text:0041377F		       call    __errno
.text:00413784		       mov     dword ptr [eax],	9
.text:0041378A
.text:0041378A loc_41378A:			       ; CODE XREF: __close+5Cj
.text:0041378A		       or      eax, 0FFFFFFFFh
.text:0041378D		       jmp     loc_413820
.text:00413792 ; ---------------------------------------------------------------------------
.text:00413792
.text:00413792 loc_413792:			       ; CODE XREF: __close+12j
.text:00413792		       xor     edi, edi
.text:00413794		       cmp     eax, edi
.text:00413796		       jl      short loc_4137A0
.text:00413798		       cmp     eax, __nhandle
.text:0041379E		       jb      short loc_4137C1
.text:004137A0
.text:004137A0 loc_4137A0:			       ; CODE XREF: __close+33j
.text:004137A0					       ; __close+7Cj
.text:004137A0		       call    ___doserrno
.text:004137A5		       mov     [eax], edi
.text:004137A7		       call    __errno
.text:004137AC		       mov     dword ptr [eax],	9
.text:004137B2		       push    edi	       ; pReserved
.text:004137B3		       push    edi	       ; nLine
.text:004137B4		       push    edi	       ; pszFile
.text:004137B5		       push    edi	       ; pszFunction
.text:004137B6		       push    edi	       ; pszExpression
.text:004137B7		       call    __invalid_parameter
.text:004137BC		       add     esp, 14h
.text:004137BF		       jmp     short loc_41378A
.text:004137C1 ; ---------------------------------------------------------------------------
.text:004137C1
.text:004137C1 loc_4137C1:			       ; CODE XREF: __close+3Bj
.text:004137C1		       mov     ecx, eax
.text:004137C3		       sar     ecx, 5
.text:004137C6		       lea     ebx, ds:423F00h[ecx*4]
.text:004137CD		       mov     esi, eax
.text:004137CF		       and     esi, 1Fh
.text:004137D2		       shl     esi, 6
.text:004137D5		       mov     ecx, [ebx]
.text:004137D7		       movzx   ecx, byte ptr [ecx+esi+4]
.text:004137DC		       and     ecx, 1
.text:004137DF		       jz      short loc_4137A0
.text:004137E1		       push    eax	       ; fh
.text:004137E2		       call    ___lock_fhandle
.text:004137E7		       pop     ecx
.text:004137E8		       mov     [ebp+ms_exc.disabled], edi
.text:004137EB		       mov     eax, [ebx]
.text:004137ED		       test    byte ptr	[eax+esi+4], 1
.text:004137F2		       jz      short loc_413802
.text:004137F4		       push    [ebp+fh]	       ; fh
.text:004137F7		       call    __close_nolock
.text:004137FC		       pop     ecx
.text:004137FD		       mov     [ebp+r],	eax
.text:00413800		       jmp     short loc_413811
.text:00413802 ; ---------------------------------------------------------------------------
.text:00413802
.text:00413802 loc_413802:			       ; CODE XREF: __close+8Fj
.text:00413802		       call    __errno
.text:00413807		       mov     dword ptr [eax],	9
.text:0041380D		       or      [ebp+r],	0FFFFFFFFh
.text:00413811
.text:00413811 loc_413811:			       ; CODE XREF: __close+9Dj
.text:00413811		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00413818		       call    $LN12_10
.text:0041381D
.text:0041381D $LN15_7:
.text:0041381D		       mov     eax, [ebp+r]
.text:00413820
.text:00413820 loc_413820:			       ; CODE XREF: __close+2Aj
.text:00413820		       call    __SEH_epilog4
.text:00413825		       retn
.text:00413826 ; ---------------------------------------------------------------------------
.text:00413826
.text:00413826 $LN12_10:			       ; CODE XREF: __close+B5p
.text:00413826					       ; DATA XREF: .rdata:00421910o
.text:00413826		       push    [ebp+fh]	       ; fh
.text:00413829		       call    __unlock_fhandle
.text:0041382E		       pop     ecx
.text:0041382F
.text:0041382F $LN13_7:
.text:0041382F		       retn
.text:0041382F __close	       endp
.text:0041382F
.text:00413830
.text:00413830 ; =============== S U B R O U T I N E =======================================
.text:00413830
.text:00413830
.text:00413830 ; void __cdecl _freebuf(_iobuf *stream)
.text:00413830 __freebuf       proc near	       ; CODE XREF: __fclose_nolock+3Bp
.text:00413830
.text:00413830 stream	       = dword ptr  4
.text:00413830
.text:00413830		       push    esi
.text:00413831		       mov     esi, [esp+4+stream]
.text:00413835		       mov     eax, [esi+0Ch]
.text:00413838		       test    al, 83h
.text:0041383A		       jz      short loc_41385A
.text:0041383C		       test    al, 8
.text:0041383E		       jz      short loc_41385A
.text:00413840		       push    dword ptr [esi+8] ; pBlock
.text:00413843		       call    _free
.text:00413848		       and     dword ptr [esi+0Ch], 0FFFFFBF7h
.text:0041384F		       xor     eax, eax
.text:00413851		       pop     ecx
.text:00413852		       mov     [esi], eax
.text:00413854		       mov     [esi+8],	eax
.text:00413857		       mov     [esi+4],	eax
.text:0041385A
.text:0041385A loc_41385A:			       ; CODE XREF: __freebuf+Aj
.text:0041385A					       ; __freebuf+Ej
.text:0041385A		       pop     esi
.text:0041385B		       retn
.text:0041385B __freebuf       endp
.text:0041385B
.text:0041385C
.text:0041385C ; =============== S U B R O U T I N E =======================================
.text:0041385C
.text:0041385C ; Attributes: bp-based frame
.text:0041385C
.text:0041385C ; unsigned __int16 __cdecl _putwch_nolock(wchar_t ch)
.text:0041385C __putwch_nolock proc near	       ; CODE XREF: __write_nolock+2D6p
.text:0041385C					       ; __write_nolock+2F6p ...
.text:0041385C
.text:0041385C num_written     = dword ptr -10h
.text:0041385C mbc	       = byte ptr -0Ch
.text:0041385C var_4	       = dword ptr -4
.text:0041385C Buffer	       = word ptr  8
.text:0041385C
.text:0041385C		       push    ebp
.text:0041385D		       mov     ebp, esp
.text:0041385F		       sub     esp, 10h
.text:00413862		       mov     eax, ___security_cookie
.text:00413867		       xor     eax, ebp
.text:00413869		       mov     [ebp+var_4], eax
.text:0041386C		       push    esi
.text:0041386D		       xor     esi, esi
.text:0041386F		       cmp     use_w, esi
.text:00413875		       jz      short loc_4138C5
.text:00413877		       cmp     __confh,	0FFFFFFFEh
.text:0041387E		       jnz     short loc_413885
.text:00413880		       call    ___initconout
.text:00413885
.text:00413885 loc_413885:			       ; CODE XREF: __putwch_nolock+22j
.text:00413885		       mov     eax, __confh
.text:0041388A		       cmp     eax, 0FFFFFFFFh
.text:0041388D		       jnz     short loc_413895
.text:0041388F
.text:0041388F loc_41388F:			       ; CODE XREF: __putwch_nolock+56j
.text:0041388F					       ; __putwch_nolock+61j ...
.text:0041388F		       or      ax, 0FFFFh
.text:00413893		       jmp     short loc_413905
.text:00413895 ; ---------------------------------------------------------------------------
.text:00413895
.text:00413895 loc_413895:			       ; CODE XREF: __putwch_nolock+31j
.text:00413895		       push    esi	       ; lpReserved
.text:00413896		       lea     ecx, [ebp+num_written]
.text:00413899		       push    ecx	       ; lpNumberOfCharsWritten
.text:0041389A		       push    1	       ; nNumberOfCharsToWrite
.text:0041389C		       lea     ecx, [ebp+Buffer]
.text:0041389F		       push    ecx	       ; lpBuffer
.text:004138A0		       push    eax	       ; hConsoleOutput
.text:004138A1		       call    ds:__imp__WriteConsoleW@20 ; WriteConsoleW(x,x,x,x,x)
.text:004138A7		       test    eax, eax
.text:004138A9		       jnz     short loc_413912
.text:004138AB		       cmp     use_w, 2
.text:004138B2		       jnz     short loc_41388F
.text:004138B4		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:004138BA		       cmp     eax, 78h
.text:004138BD		       jnz     short loc_41388F
.text:004138BF		       mov     use_w, esi
.text:004138C5
.text:004138C5 loc_4138C5:			       ; CODE XREF: __putwch_nolock+19j
.text:004138C5		       push    esi	       ; lpUsedDefaultChar
.text:004138C6		       push    esi	       ; lpDefaultChar
.text:004138C7		       push    5	       ; cbMultiByte
.text:004138C9		       lea     eax, [ebp+mbc]
.text:004138CC		       push    eax	       ; lpMultiByteStr
.text:004138CD		       push    1	       ; cchWideChar
.text:004138CF		       lea     eax, [ebp+Buffer]
.text:004138D2		       push    eax	       ; lpWideCharStr
.text:004138D3		       push    esi	       ; dwFlags
.text:004138D4		       call    ds:__imp__GetConsoleOutputCP@0 ;	GetConsoleOutputCP()
.text:004138DA		       push    eax	       ; CodePage
.text:004138DB		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:004138E1		       mov     ecx, __confh
.text:004138E7		       cmp     ecx, 0FFFFFFFFh
.text:004138EA		       jz      short loc_41388F
.text:004138EC		       push    esi	       ; lpReserved
.text:004138ED		       lea     edx, [ebp+num_written]
.text:004138F0		       push    edx	       ; lpNumberOfCharsWritten
.text:004138F1		       push    eax	       ; nNumberOfCharsToWrite
.text:004138F2		       lea     eax, [ebp+mbc]
.text:004138F5		       push    eax	       ; lpBuffer
.text:004138F6		       push    ecx	       ; hConsoleOutput
.text:004138F7		       call    ds:__imp__WriteConsoleA@20 ; WriteConsoleA(x,x,x,x,x)
.text:004138FD		       test    eax, eax
.text:004138FF		       jz      short loc_41388F
.text:00413901
.text:00413901 loc_413901:			       ; CODE XREF: __putwch_nolock+C0j
.text:00413901		       mov     ax, [ebp+Buffer]
.text:00413905
.text:00413905 loc_413905:			       ; CODE XREF: __putwch_nolock+37j
.text:00413905		       mov     ecx, [ebp+var_4]
.text:00413908		       xor     ecx, ebp
.text:0041390A		       pop     esi
.text:0041390B		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00413910		       leave
.text:00413911		       retn
.text:00413912 ; ---------------------------------------------------------------------------
.text:00413912
.text:00413912 loc_413912:			       ; CODE XREF: __putwch_nolock+4Dj
.text:00413912		       mov     use_w, 1
.text:0041391C		       jmp     short loc_413901
.text:0041391C __putwch_nolock endp
.text:0041391C
.text:0041391E
.text:0041391E ; =============== S U B R O U T I N E =======================================
.text:0041391E
.text:0041391E ; Attributes: bp-based frame
.text:0041391E
.text:0041391E ; int __cdecl _cputws(const wchar_t *str)
.text:0041391E __cputws	       proc near
.text:0041391E
.text:0041391E retval	       = dword ptr -20h
.text:0041391E len	       = dword ptr -1Ch
.text:0041391E ms_exc	       = CPPEH_RECORD ptr -18h
.text:0041391E str	       = dword ptr  8
.text:0041391E
.text:0041391E		       push    10h
.text:00413920		       push    offset dword_421918
.text:00413925		       call    __SEH_prolog4
.text:0041392A		       xor     esi, esi
.text:0041392C		       mov     [ebp+retval], esi
.text:0041392F		       xor     eax, eax
.text:00413931		       cmp     [ebp+str], esi
.text:00413934		       setnz   al
.text:00413937		       cmp     eax, esi
.text:00413939		       jnz     short loc_41395F
.text:0041393B		       call    ___doserrno
.text:00413940		       mov     [eax], esi
.text:00413942		       call    __errno
.text:00413947		       mov     dword ptr [eax],	16h
.text:0041394D		       push    esi	       ; pReserved
.text:0041394E		       push    esi	       ; nLine
.text:0041394F		       push    esi	       ; pszFile
.text:00413950		       push    esi	       ; pszFunction
.text:00413951		       push    esi	       ; pszExpression
.text:00413952		       call    __invalid_parameter
.text:00413957		       add     esp, 14h
.text:0041395A		       or      eax, 0FFFFFFFFh
.text:0041395D		       jmp     short loc_4139AA
.text:0041395F ; ---------------------------------------------------------------------------
.text:0041395F
.text:0041395F loc_41395F:			       ; CODE XREF: __cputws+1Bj
.text:0041395F		       push    [ebp+str]       ; wcs
.text:00413962		       call    _wcslen
.text:00413967		       mov     [ebp+len], eax
.text:0041396A		       push    3	       ; locknum
.text:0041396C		       call    __lock
.text:00413971		       pop     ecx
.text:00413972		       pop     ecx
.text:00413973		       mov     [ebp+ms_exc.disabled], esi
.text:00413976
.text:00413976 loc_413976:			       ; CODE XREF: __cputws+77j
.text:00413976		       mov     eax, [ebp+len]
.text:00413979		       dec     [ebp+len]
.text:0041397C		       test    eax, eax
.text:0041397E		       jz      short loc_41399B
.text:00413980		       mov     eax, [ebp+str]
.text:00413983		       movzx   eax, word ptr [eax]
.text:00413986		       push    eax	       ; ch
.text:00413987		       call    __putwch_nolock
.text:0041398C		       pop     ecx
.text:0041398D		       add     [ebp+str], 2
.text:00413991		       cmp     ax, 0FFFFh
.text:00413995		       jnz     short loc_413976
.text:00413997		       or      [ebp+retval], 0FFFFFFFFh
.text:0041399B
.text:0041399B loc_41399B:			       ; CODE XREF: __cputws+60j
.text:0041399B		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004139A2		       call    $LN9_8
.text:004139A7
.text:004139A7 $LN12_11:
.text:004139A7		       mov     eax, [ebp+retval]
.text:004139AA
.text:004139AA loc_4139AA:			       ; CODE XREF: __cputws+3Fj
.text:004139AA		       call    __SEH_epilog4
.text:004139AF		       retn
.text:004139B0 ; ---------------------------------------------------------------------------
.text:004139B0
.text:004139B0 $LN9_8:				       ; CODE XREF: __cputws+84p
.text:004139B0					       ; DATA XREF: .rdata:00421930o
.text:004139B0		       push    3	       ; locknum
.text:004139B2		       call    __unlock
.text:004139B7		       pop     ecx
.text:004139B8
.text:004139B8 $LN10_6:
.text:004139B8		       retn
.text:004139B8 __cputws	       endp
.text:004139B8
.text:004139B9
.text:004139B9 ; =============== S U B R O U T I N E =======================================
.text:004139B9
.text:004139B9 ; Attributes: noreturn bp-based frame
.text:004139B9
.text:004139B9 ; unsigned __int16 __cdecl _putwch(wchar_t ch)
.text:004139B9 __putwch	       proc near
.text:004139B9
.text:004139B9 retval	       = dword ptr -1Ch
.text:004139B9 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004139B9 arg_0	       = dword ptr  8
.text:004139B9
.text:004139B9		       push    0Ch
.text:004139BB		       push    offset dword_421938
.text:004139C0		       call    __SEH_prolog4
.text:004139C5		       push    3	       ; locknum
.text:004139C7		       call    __lock
.text:004139CC		       pop     ecx
.text:004139CD		       and     [ebp+ms_exc.disabled], 0
.text:004139D1		       push    [ebp+arg_0]     ; ch
.text:004139D4		       call    __putwch_nolock
.text:004139D9		       pop     ecx
.text:004139DA		       movzx   eax, ax
.text:004139DD		       mov     [ebp+retval], eax
.text:004139E0		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004139E7		       call    $LN5_0
.text:004139EC ; ---------------------------------------------------------------------------
.text:004139EC
.text:004139EC $LN8_5:
.text:004139EC		       mov     ax, word	ptr [ebp+retval]
.text:004139F0		       call    __SEH_epilog4
.text:004139F5		       retn
.text:004139F6 ; ---------------------------------------------------------------------------
.text:004139F6
.text:004139F6 $LN5_0:				       ; CODE XREF: __putwch+2Ep
.text:004139F6					       ; DATA XREF: .rdata:00421950o
.text:004139F6		       push    3	       ; locknum
.text:004139F8		       call    __unlock
.text:004139FD		       pop     ecx
.text:004139FE
.text:004139FE $LN6_8:
.text:004139FE		       retn
.text:004139FE __putwch	       endp
.text:004139FE
.text:004139FF
.text:004139FF ; =============== S U B R O U T I N E =======================================
.text:004139FF
.text:004139FF ; Attributes: bp-based frame
.text:004139FF
.text:004139FF ; int __cdecl _mbtowc_l(wchar_t *pwc, const char	*s, unsigned int n, localeinfo_struct *plocinfo)
.text:004139FF __mbtowc_l      proc near	       ; CODE XREF: _mbtowc+Ep
.text:004139FF
.text:004139FF _loc_update     = _LocaleUpdate ptr -10h
.text:004139FF pwc	       = dword ptr  8
.text:004139FF s	       = dword ptr  0Ch
.text:004139FF n	       = dword ptr  10h
.text:004139FF plocinfo	       = dword ptr  14h
.text:004139FF
.text:004139FF		       push    ebp
.text:00413A00		       mov     ebp, esp
.text:00413A02		       sub     esp, 10h
.text:00413A05		       push    ebx
.text:00413A06		       push    esi
.text:00413A07		       mov     esi, [ebp+s]
.text:00413A0A		       xor     ebx, ebx
.text:00413A0C		       cmp     esi, ebx
.text:00413A0E		       jz      short loc_413A23
.text:00413A10		       cmp     [ebp+n],	ebx
.text:00413A13		       jz      short loc_413A23
.text:00413A15		       cmp     [esi], bl
.text:00413A17		       jnz     short loc_413A29
.text:00413A19		       mov     eax, [ebp+pwc]
.text:00413A1C		       cmp     eax, ebx
.text:00413A1E		       jz      short loc_413A23
.text:00413A20		       mov     [eax], bx
.text:00413A23
.text:00413A23 loc_413A23:			       ; CODE XREF: __mbtowc_l+Fj
.text:00413A23					       ; __mbtowc_l+14j ...
.text:00413A23		       xor     eax, eax
.text:00413A25
.text:00413A25 loc_413A25:			       ; CODE XREF: __mbtowc_l+5Aj
.text:00413A25					       ; __mbtowc_l+BBj ...
.text:00413A25		       pop     esi
.text:00413A26		       pop     ebx
.text:00413A27		       leave
.text:00413A28		       retn
.text:00413A29 ; ---------------------------------------------------------------------------
.text:00413A29
.text:00413A29 loc_413A29:			       ; CODE XREF: __mbtowc_l+18j
.text:00413A29		       push    [ebp+plocinfo]  ; plocinfo
.text:00413A2C		       lea     ecx, [ebp+_loc_update] ;	this
.text:00413A2F		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00413A34		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00413A37		       cmp     [eax+14h], ebx
.text:00413A3A		       jnz     short loc_413A5B
.text:00413A3C		       mov     eax, [ebp+pwc]
.text:00413A3F		       cmp     eax, ebx
.text:00413A41		       jz      short loc_413A4A
.text:00413A43		       movzx   cx, byte	ptr [esi]
.text:00413A47		       mov     [eax], cx
.text:00413A4A
.text:00413A4A loc_413A4A:			       ; CODE XREF: __mbtowc_l+42j
.text:00413A4A					       ; __mbtowc_l+10Bj
.text:00413A4A		       cmp     [ebp+_loc_update.updated], bl
.text:00413A4D		       jz      short loc_413A56
.text:00413A4F		       mov     eax, [ebp+_loc_update.ptd]
.text:00413A52		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00413A56
.text:00413A56 loc_413A56:			       ; CODE XREF: __mbtowc_l+4Ej
.text:00413A56		       xor     eax, eax
.text:00413A58		       inc     eax
.text:00413A59		       jmp     short loc_413A25
.text:00413A5B ; ---------------------------------------------------------------------------
.text:00413A5B
.text:00413A5B loc_413A5B:			       ; CODE XREF: __mbtowc_l+3Bj
.text:00413A5B		       lea     eax, [ebp+_loc_update]
.text:00413A5E		       push    eax	       ; plocinfo
.text:00413A5F		       movzx   eax, byte ptr [esi]
.text:00413A62		       push    eax	       ; c
.text:00413A63		       call    __isleadbyte_l
.text:00413A68		       test    eax, eax
.text:00413A6A		       pop     ecx
.text:00413A6B		       pop     ecx
.text:00413A6C		       jz      short loc_413AEB
.text:00413A6E		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00413A71		       mov     ecx, [eax+0ACh]
.text:00413A77		       cmp     ecx, 1
.text:00413A7A		       jle     short loc_413AA1
.text:00413A7C		       cmp     [ebp+n],	ecx
.text:00413A7F		       jl      short loc_413AA1
.text:00413A81		       xor     edx, edx
.text:00413A83		       cmp     [ebp+pwc], ebx
.text:00413A86		       setnz   dl
.text:00413A89		       push    edx	       ; cchWideChar
.text:00413A8A		       push    [ebp+pwc]       ; lpWideCharStr
.text:00413A8D		       push    ecx	       ; cbMultiByte
.text:00413A8E		       push    esi	       ; lpMultiByteStr
.text:00413A8F		       push    9	       ; dwFlags
.text:00413A91		       push    dword ptr [eax+4] ; CodePage
.text:00413A94		       call    ds:__imp__MultiByteToWideChar@24	; MultiByteToWideChar(x,x,x,x,x,x)
.text:00413A9A		       test    eax, eax
.text:00413A9C		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00413A9F		       jnz     short loc_413AB1
.text:00413AA1
.text:00413AA1 loc_413AA1:			       ; CODE XREF: __mbtowc_l+7Bj
.text:00413AA1					       ; __mbtowc_l+80j
.text:00413AA1		       mov     ecx, [ebp+n]
.text:00413AA4		       cmp     ecx, [eax+0ACh]
.text:00413AAA		       jb      short loc_413ACC
.text:00413AAC		       cmp     [esi+1],	bl
.text:00413AAF		       jz      short loc_413ACC
.text:00413AB1
.text:00413AB1 loc_413AB1:			       ; CODE XREF: __mbtowc_l+A0j
.text:00413AB1		       cmp     [ebp+_loc_update.updated], bl
.text:00413AB4		       mov     eax, [eax+0ACh]
.text:00413ABA		       jz      loc_413A25
.text:00413AC0		       mov     ecx, [ebp+_loc_update.ptd]
.text:00413AC3		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00413AC7		       jmp     loc_413A25
.text:00413ACC ; ---------------------------------------------------------------------------
.text:00413ACC
.text:00413ACC loc_413ACC:			       ; CODE XREF: __mbtowc_l+ABj
.text:00413ACC					       ; __mbtowc_l+B0j ...
.text:00413ACC		       call    __errno
.text:00413AD1		       mov     dword ptr [eax],	2Ah
.text:00413AD7		       cmp     [ebp+_loc_update.updated], bl
.text:00413ADA		       jz      short loc_413AE3
.text:00413ADC		       mov     eax, [ebp+_loc_update.ptd]
.text:00413ADF		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00413AE3
.text:00413AE3 loc_413AE3:			       ; CODE XREF: __mbtowc_l+DBj
.text:00413AE3		       or      eax, 0FFFFFFFFh
.text:00413AE6		       jmp     loc_413A25
.text:00413AEB ; ---------------------------------------------------------------------------
.text:00413AEB
.text:00413AEB loc_413AEB:			       ; CODE XREF: __mbtowc_l+6Dj
.text:00413AEB		       xor     eax, eax
.text:00413AED		       cmp     [ebp+pwc], ebx
.text:00413AF0		       setnz   al
.text:00413AF3		       push    eax	       ; cchWideChar
.text:00413AF4		       push    [ebp+pwc]       ; lpWideCharStr
.text:00413AF7		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00413AFA		       push    1	       ; cbMultiByte
.text:00413AFC		       push    esi	       ; lpMultiByteStr
.text:00413AFD		       push    9	       ; dwFlags
.text:00413AFF		       push    dword ptr [eax+4] ; CodePage
.text:00413B02		       call    ds:__imp__MultiByteToWideChar@24	; MultiByteToWideChar(x,x,x,x,x,x)
.text:00413B08		       test    eax, eax
.text:00413B0A		       jnz     loc_413A4A
.text:00413B10		       jmp     short loc_413ACC
.text:00413B10 __mbtowc_l      endp
.text:00413B10
.text:00413B12
.text:00413B12 ; =============== S U B R O U T I N E =======================================
.text:00413B12
.text:00413B12
.text:00413B12 ; int __cdecl mbtowc(wchar_t *pwc, const	char *s, unsigned int n)
.text:00413B12 _mbtowc	       proc near	       ; CODE XREF: __write_nolock+1D1p
.text:00413B12					       ; __write_nolock+1EFp
.text:00413B12
.text:00413B12 pwc	       = dword ptr  4
.text:00413B12 s	       = dword ptr  8
.text:00413B12 n	       = dword ptr  0Ch
.text:00413B12
.text:00413B12		       push    0	       ; plocinfo
.text:00413B14		       push    [esp+4+n]       ; n
.text:00413B18		       push    [esp+8+s]       ; s
.text:00413B1C		       push    [esp+0Ch+pwc]   ; pwc
.text:00413B20		       call    __mbtowc_l
.text:00413B25		       add     esp, 10h
.text:00413B28		       retn
.text:00413B28 _mbtowc	       endp
.text:00413B28
.text:00413B29
.text:00413B29 ; =============== S U B R O U T I N E =======================================
.text:00413B29
.text:00413B29
.text:00413B29 ; int __cdecl _set_osfhnd(int fh, int value)
.text:00413B29 __set_osfhnd    proc near	       ; CODE XREF: __open_osfhandle+8Fp
.text:00413B29
.text:00413B29 fh	       = dword ptr  4
.text:00413B29 value	       = dword ptr  8
.text:00413B29
.text:00413B29		       mov     eax, [esp+fh]
.text:00413B2D		       test    eax, eax
.text:00413B2F		       push    esi
.text:00413B30		       push    edi
.text:00413B31		       jl      short loc_413B8D
.text:00413B33		       cmp     eax, __nhandle
.text:00413B39		       jnb     short loc_413B8D
.text:00413B3B		       mov     ecx, eax
.text:00413B3D		       sar     ecx, 5
.text:00413B40		       mov     esi, eax
.text:00413B42		       and     esi, 1Fh
.text:00413B45		       lea     edi, ds:423F00h[ecx*4]
.text:00413B4C		       mov     ecx, [edi]
.text:00413B4E		       shl     esi, 6
.text:00413B51		       cmp     dword ptr [esi+ecx], 0FFFFFFFFh
.text:00413B55		       jnz     short loc_413B8D
.text:00413B57		       cmp     ___app_type, 1
.text:00413B5E		       push    ebx
.text:00413B5F		       mov     ebx, [esp+0Ch+value]
.text:00413B63		       jnz     short loc_413B83
.text:00413B65		       sub     eax, 0
.text:00413B68		       jz      short loc_413B7A
.text:00413B6A		       dec     eax
.text:00413B6B		       jz      short loc_413B75
.text:00413B6D		       dec     eax
.text:00413B6E		       jnz     short loc_413B83
.text:00413B70		       push    ebx
.text:00413B71		       push    0FFFFFFF4h
.text:00413B73		       jmp     short loc_413B7D
.text:00413B75 ; ---------------------------------------------------------------------------
.text:00413B75
.text:00413B75 loc_413B75:			       ; CODE XREF: __set_osfhnd+42j
.text:00413B75		       push    ebx
.text:00413B76		       push    0FFFFFFF5h
.text:00413B78		       jmp     short loc_413B7D
.text:00413B7A ; ---------------------------------------------------------------------------
.text:00413B7A
.text:00413B7A loc_413B7A:			       ; CODE XREF: __set_osfhnd+3Fj
.text:00413B7A		       push    ebx	       ; hHandle
.text:00413B7B		       push    0FFFFFFF6h      ; nStdHandle
.text:00413B7D
.text:00413B7D loc_413B7D:			       ; CODE XREF: __set_osfhnd+4Aj
.text:00413B7D					       ; __set_osfhnd+4Fj
.text:00413B7D		       call    ds:__imp__SetStdHandle@8	; SetStdHandle(x,x)
.text:00413B83
.text:00413B83 loc_413B83:			       ; CODE XREF: __set_osfhnd+3Aj
.text:00413B83					       ; __set_osfhnd+45j
.text:00413B83		       mov     eax, [edi]
.text:00413B85		       mov     [esi+eax], ebx
.text:00413B88		       xor     eax, eax
.text:00413B8A		       pop     ebx
.text:00413B8B		       jmp     short loc_413BA3
.text:00413B8D ; ---------------------------------------------------------------------------
.text:00413B8D
.text:00413B8D loc_413B8D:			       ; CODE XREF: __set_osfhnd+8j
.text:00413B8D					       ; __set_osfhnd+10j ...
.text:00413B8D		       call    __errno
.text:00413B92		       mov     dword ptr [eax],	9
.text:00413B98		       call    ___doserrno
.text:00413B9D		       and     dword ptr [eax],	0
.text:00413BA0		       or      eax, 0FFFFFFFFh
.text:00413BA3
.text:00413BA3 loc_413BA3:			       ; CODE XREF: __set_osfhnd+62j
.text:00413BA3		       pop     edi
.text:00413BA4		       pop     esi
.text:00413BA5		       retn
.text:00413BA5 __set_osfhnd    endp
.text:00413BA5
.text:00413BA6
.text:00413BA6 ; =============== S U B R O U T I N E =======================================
.text:00413BA6
.text:00413BA6
.text:00413BA6 ; int __cdecl _free_osfhnd(int fh)
.text:00413BA6 __free_osfhnd   proc near	       ; CODE XREF: __close_nolock+65p
.text:00413BA6
.text:00413BA6 fh	       = dword ptr  4
.text:00413BA6
.text:00413BA6		       mov     ecx, [esp+fh]
.text:00413BAA		       push    ebx
.text:00413BAB		       xor     ebx, ebx
.text:00413BAD		       cmp     ecx, ebx
.text:00413BAF		       push    esi
.text:00413BB0		       push    edi
.text:00413BB1		       jl      short loc_413C0E
.text:00413BB3		       cmp     ecx, __nhandle
.text:00413BB9		       jnb     short loc_413C0E
.text:00413BBB		       mov     eax, ecx
.text:00413BBD		       sar     eax, 5
.text:00413BC0		       mov     esi, ecx
.text:00413BC2		       lea     edi, ds:423F00h[eax*4]
.text:00413BC9		       mov     eax, [edi]
.text:00413BCB		       and     esi, 1Fh
.text:00413BCE		       shl     esi, 6
.text:00413BD1		       add     eax, esi
.text:00413BD3		       test    byte ptr	[eax+4], 1
.text:00413BD7		       jz      short loc_413C0E
.text:00413BD9		       cmp     dword ptr [eax],	0FFFFFFFFh
.text:00413BDC		       jz      short loc_413C0E
.text:00413BDE		       cmp     ___app_type, 1
.text:00413BE5		       jnz     short loc_413C04
.text:00413BE7		       sub     ecx, ebx
.text:00413BE9		       jz      short loc_413BFB
.text:00413BEB		       dec     ecx
.text:00413BEC		       jz      short loc_413BF6
.text:00413BEE		       dec     ecx
.text:00413BEF		       jnz     short loc_413C04
.text:00413BF1		       push    ebx
.text:00413BF2		       push    0FFFFFFF4h
.text:00413BF4		       jmp     short loc_413BFE
.text:00413BF6 ; ---------------------------------------------------------------------------
.text:00413BF6
.text:00413BF6 loc_413BF6:			       ; CODE XREF: __free_osfhnd+46j
.text:00413BF6		       push    ebx
.text:00413BF7		       push    0FFFFFFF5h
.text:00413BF9		       jmp     short loc_413BFE
.text:00413BFB ; ---------------------------------------------------------------------------
.text:00413BFB
.text:00413BFB loc_413BFB:			       ; CODE XREF: __free_osfhnd+43j
.text:00413BFB		       push    ebx	       ; hHandle
.text:00413BFC		       push    0FFFFFFF6h      ; nStdHandle
.text:00413BFE
.text:00413BFE loc_413BFE:			       ; CODE XREF: __free_osfhnd+4Ej
.text:00413BFE					       ; __free_osfhnd+53j
.text:00413BFE		       call    ds:__imp__SetStdHandle@8	; SetStdHandle(x,x)
.text:00413C04
.text:00413C04 loc_413C04:			       ; CODE XREF: __free_osfhnd+3Fj
.text:00413C04					       ; __free_osfhnd+49j
.text:00413C04		       mov     eax, [edi]
.text:00413C06		       or      dword ptr [esi+eax], 0FFFFFFFFh
.text:00413C0A		       xor     eax, eax
.text:00413C0C		       jmp     short loc_413C23
.text:00413C0E ; ---------------------------------------------------------------------------
.text:00413C0E
.text:00413C0E loc_413C0E:			       ; CODE XREF: __free_osfhnd+Bj
.text:00413C0E					       ; __free_osfhnd+13j ...
.text:00413C0E		       call    __errno
.text:00413C13		       mov     dword ptr [eax],	9
.text:00413C19		       call    ___doserrno
.text:00413C1E		       mov     [eax], ebx
.text:00413C20		       or      eax, 0FFFFFFFFh
.text:00413C23
.text:00413C23 loc_413C23:			       ; CODE XREF: __free_osfhnd+66j
.text:00413C23		       pop     edi
.text:00413C24		       pop     esi
.text:00413C25		       pop     ebx
.text:00413C26		       retn
.text:00413C26 __free_osfhnd   endp
.text:00413C26
.text:00413C27
.text:00413C27 ; =============== S U B R O U T I N E =======================================
.text:00413C27
.text:00413C27
.text:00413C27 ; int __cdecl _get_osfhandle(int	fh)
.text:00413C27 __get_osfhandle proc near	       ; CODE XREF: __commit+85p
.text:00413C27					       ; __lseeki64_nolock+17p	...
.text:00413C27
.text:00413C27 fh	       = dword ptr  4
.text:00413C27
.text:00413C27		       mov     eax, [esp+fh]
.text:00413C2B		       cmp     eax, 0FFFFFFFEh
.text:00413C2E		       jnz     short loc_413C47
.text:00413C30		       call    ___doserrno
.text:00413C35		       and     dword ptr [eax],	0
.text:00413C38		       call    __errno
.text:00413C3D		       mov     dword ptr [eax],	9
.text:00413C43		       or      eax, 0FFFFFFFFh
.text:00413C46		       retn
.text:00413C47 ; ---------------------------------------------------------------------------
.text:00413C47
.text:00413C47 loc_413C47:			       ; CODE XREF: __get_osfhandle+7j
.text:00413C47		       push    esi
.text:00413C48		       xor     esi, esi
.text:00413C4A		       cmp     eax, esi
.text:00413C4C		       jl      short loc_413C70
.text:00413C4E		       cmp     eax, __nhandle
.text:00413C54		       jnb     short loc_413C70
.text:00413C56		       mov     ecx, eax
.text:00413C58		       and     eax, 1Fh
.text:00413C5B		       sar     ecx, 5
.text:00413C5E		       mov     ecx, ___pioinfo[ecx*4]
.text:00413C65		       shl     eax, 6
.text:00413C68		       add     eax, ecx
.text:00413C6A		       test    byte ptr	[eax+4], 1
.text:00413C6E		       jnz     short loc_413C94
.text:00413C70
.text:00413C70 loc_413C70:			       ; CODE XREF: __get_osfhandle+25j
.text:00413C70					       ; __get_osfhandle+2Dj
.text:00413C70		       call    ___doserrno
.text:00413C75		       mov     [eax], esi
.text:00413C77		       call    __errno
.text:00413C7C		       push    esi	       ; pReserved
.text:00413C7D		       push    esi	       ; nLine
.text:00413C7E		       push    esi	       ; pszFile
.text:00413C7F		       push    esi	       ; pszFunction
.text:00413C80		       push    esi	       ; pszExpression
.text:00413C81		       mov     dword ptr [eax],	9
.text:00413C87		       call    __invalid_parameter
.text:00413C8C		       add     esp, 14h
.text:00413C8F		       or      eax, 0FFFFFFFFh
.text:00413C92		       pop     esi
.text:00413C93		       retn
.text:00413C94 ; ---------------------------------------------------------------------------
.text:00413C94
.text:00413C94 loc_413C94:			       ; CODE XREF: __get_osfhandle+47j
.text:00413C94		       mov     eax, [eax]
.text:00413C96		       pop     esi
.text:00413C97		       retn
.text:00413C97 __get_osfhandle endp
.text:00413C97
.text:00413C98
.text:00413C98 ; =============== S U B R O U T I N E =======================================
.text:00413C98
.text:00413C98 ; Attributes: bp-based frame
.text:00413C98
.text:00413C98 ; int __cdecl __lock_fhandle(int	fh)
.text:00413C98 ___lock_fhandle proc near	       ; CODE XREF: __write+7Fp
.text:00413C98					       ; __commit+70p ...
.text:00413C98
.text:00413C98 retval	       = dword ptr -1Ch
.text:00413C98 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00413C98 fh	       = dword ptr  8
.text:00413C98
.text:00413C98		       push    0Ch
.text:00413C9A		       push    offset dword_421958
.text:00413C9F		       call    __SEH_prolog4
.text:00413CA4		       mov     edi, [ebp+fh]
.text:00413CA7		       mov     eax, edi
.text:00413CA9		       sar     eax, 5
.text:00413CAC		       mov     esi, edi
.text:00413CAE		       and     esi, 1Fh
.text:00413CB1		       shl     esi, 6
.text:00413CB4		       add     esi, ___pioinfo[eax*4]
.text:00413CBB		       mov     [ebp+retval], 1
.text:00413CC2		       xor     ebx, ebx
.text:00413CC4		       cmp     [esi+8],	ebx
.text:00413CC7		       jnz     short $LN12_12
.text:00413CC9		       push    0Ah	       ; locknum
.text:00413CCB		       call    __lock
.text:00413CD0		       pop     ecx
.text:00413CD1		       mov     [ebp+ms_exc.disabled], ebx
.text:00413CD4		       cmp     [esi+8],	ebx
.text:00413CD7		       jnz     short loc_413CF3
.text:00413CD9		       push    0FA0h	       ; dwSpinCount
.text:00413CDE		       lea     eax, [esi+0Ch]
.text:00413CE1		       push    eax	       ; lpCriticalSection
.text:00413CE2		       call    ___crtInitCritSecAndSpinCount
.text:00413CE7		       pop     ecx
.text:00413CE8		       pop     ecx
.text:00413CE9		       test    eax, eax
.text:00413CEB		       jnz     short loc_413CF0
.text:00413CED		       mov     [ebp+retval], ebx
.text:00413CF0
.text:00413CF0 loc_413CF0:			       ; CODE XREF: ___lock_fhandle+53j
.text:00413CF0		       inc     dword ptr [esi+8]
.text:00413CF3
.text:00413CF3 loc_413CF3:			       ; CODE XREF: ___lock_fhandle+3Fj
.text:00413CF3		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00413CFA		       call    $LN11_7
.text:00413CFF
.text:00413CFF $LN12_12:			       ; CODE XREF: ___lock_fhandle+2Fj
.text:00413CFF		       cmp     [ebp+retval], ebx
.text:00413D02		       jz      short loc_413D21
.text:00413D04		       mov     eax, edi
.text:00413D06		       sar     eax, 5
.text:00413D09		       and     edi, 1Fh
.text:00413D0C		       shl     edi, 6
.text:00413D0F		       mov     eax, ___pioinfo[eax*4]
.text:00413D16		       lea     eax, [eax+edi+0Ch]
.text:00413D1A		       push    eax	       ; lpCriticalSection
.text:00413D1B		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:00413D21
.text:00413D21 loc_413D21:			       ; CODE XREF: ___lock_fhandle+6Aj
.text:00413D21		       mov     eax, [ebp+retval]
.text:00413D24		       call    __SEH_epilog4
.text:00413D29		       retn
.text:00413D2A ; ---------------------------------------------------------------------------
.text:00413D2A
.text:00413D2A $LN9_9:				       ; DATA XREF: .rdata:00421970o
.text:00413D2A		       xor     ebx, ebx
.text:00413D2C		       mov     edi, [ebp+fh]
.text:00413D2F
.text:00413D2F $LN11_7:				       ; CODE XREF: ___lock_fhandle+62p
.text:00413D2F		       push    0Ah	       ; locknum
.text:00413D31		       call    __unlock
.text:00413D36		       pop     ecx
.text:00413D37
.text:00413D37 $LN10_7:
.text:00413D37		       retn
.text:00413D37 ___lock_fhandle endp ; sp-analysis failed
.text:00413D37
.text:00413D38
.text:00413D38 ; =============== S U B R O U T I N E =======================================
.text:00413D38
.text:00413D38
.text:00413D38 ; void __cdecl _unlock_fhandle(int fh)
.text:00413D38 __unlock_fhandle	proc near	       ; CODE XREF: __write+D5p
.text:00413D38					       ; __commit+DAp ...
.text:00413D38
.text:00413D38 fh	       = dword ptr  4
.text:00413D38
.text:00413D38		       mov     eax, [esp+fh]
.text:00413D3C		       mov     ecx, eax
.text:00413D3E		       and     eax, 1Fh
.text:00413D41		       sar     ecx, 5
.text:00413D44		       mov     ecx, ___pioinfo[ecx*4]
.text:00413D4B		       shl     eax, 6
.text:00413D4E		       lea     eax, [ecx+eax+0Ch]
.text:00413D52		       push    eax	       ; lpCriticalSection
.text:00413D53		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:00413D59		       retn
.text:00413D59 __unlock_fhandle	endp
.text:00413D59
.text:00413D5A
.text:00413D5A ; =============== S U B R O U T I N E =======================================
.text:00413D5A
.text:00413D5A ; Attributes: bp-based frame
.text:00413D5A
.text:00413D5A ; int __cdecl _alloc_osfhnd()
.text:00413D5A __alloc_osfhnd  proc near	       ; CODE XREF: __open_osfhandle:loc_413F59p
.text:00413D5A
.text:00413D5A i	       = dword ptr -28h
.text:00413D5A failed	       = dword ptr -24h
.text:00413D5A pio	       = dword ptr -20h
.text:00413D5A fh	       = dword ptr -1Ch
.text:00413D5A ms_exc	       = CPPEH_RECORD ptr -18h
.text:00413D5A
.text:00413D5A		       push    18h
.text:00413D5C		       push    offset dword_421978
.text:00413D61		       call    __SEH_prolog4
.text:00413D66		       or      [ebp+fh], 0FFFFFFFFh
.text:00413D6A		       xor     edi, edi
.text:00413D6C		       mov     [ebp+failed], edi
.text:00413D6F		       push    0Bh	       ; locknum
.text:00413D71		       call    __mtinitlocknum
.text:00413D76		       pop     ecx
.text:00413D77		       test    eax, eax
.text:00413D79		       jnz     short loc_413D83
.text:00413D7B		       or      eax, 0FFFFFFFFh
.text:00413D7E		       jmp     loc_413EE5
.text:00413D83 ; ---------------------------------------------------------------------------
.text:00413D83
.text:00413D83 loc_413D83:			       ; CODE XREF: __alloc_osfhnd+1Fj
.text:00413D83		       push    0Bh	       ; locknum
.text:00413D85		       call    __lock
.text:00413D8A		       pop     ecx
.text:00413D8B		       mov     [ebp+ms_exc.disabled], edi
.text:00413D8E
.text:00413D8E loc_413D8E:			       ; CODE XREF: __alloc_osfhnd+104j
.text:00413D8E		       mov     [ebp+i],	edi
.text:00413D91		       cmp     edi, 40h
.text:00413D94		       jge     loc_413ED6
.text:00413D9A		       mov     esi, ___pioinfo[edi*4]
.text:00413DA1		       test    esi, esi
.text:00413DA3		       jz      loc_413E63
.text:00413DA9
.text:00413DA9 loc_413DA9:			       ; CODE XREF: __alloc_osfhnd+CBj
.text:00413DA9		       mov     [ebp+pio], esi
.text:00413DAC		       mov     eax, ___pioinfo[edi*4]
.text:00413DB3		       add     eax, 800h
.text:00413DB8		       cmp     esi, eax
.text:00413DBA		       jnb     loc_413E57
.text:00413DC0		       test    byte ptr	[esi+4], 1
.text:00413DC4		       jnz     short loc_413E22
.text:00413DC6		       cmp     dword ptr [esi+8], 0
.text:00413DCA		       jnz     short $LN36_1
.text:00413DCC		       push    0Ah	       ; locknum
.text:00413DCE		       call    __lock
.text:00413DD3		       pop     ecx
.text:00413DD4		       xor     ebx, ebx
.text:00413DD6		       inc     ebx
.text:00413DD7		       mov     [ebp+ms_exc.disabled], ebx
.text:00413DDA		       cmp     dword ptr [esi+8], 0
.text:00413DDE		       jnz     short loc_413DFC
.text:00413DE0		       push    0FA0h	       ; dwSpinCount
.text:00413DE5		       lea     eax, [esi+0Ch]
.text:00413DE8		       push    eax	       ; lpCriticalSection
.text:00413DE9		       call    ___crtInitCritSecAndSpinCount
.text:00413DEE		       pop     ecx
.text:00413DEF		       pop     ecx
.text:00413DF0		       test    eax, eax
.text:00413DF2		       jnz     short loc_413DF9
.text:00413DF4		       mov     [ebp+failed], ebx
.text:00413DF7		       jmp     short loc_413DFC
.text:00413DF9 ; ---------------------------------------------------------------------------
.text:00413DF9
.text:00413DF9 loc_413DF9:			       ; CODE XREF: __alloc_osfhnd+98j
.text:00413DF9		       inc     dword ptr [esi+8]
.text:00413DFC
.text:00413DFC loc_413DFC:			       ; CODE XREF: __alloc_osfhnd+84j
.text:00413DFC					       ; __alloc_osfhnd+9Dj
.text:00413DFC		       and     [ebp+ms_exc.disabled], 0
.text:00413E00		       call    $LN35_1
.text:00413E05
.text:00413E05 $LN36_1:				       ; CODE XREF: __alloc_osfhnd+70j
.text:00413E05		       cmp     [ebp+failed], 0
.text:00413E09		       jnz     short loc_413E22
.text:00413E0B		       lea     ebx, [esi+0Ch]
.text:00413E0E		       push    ebx	       ; lpCriticalSection
.text:00413E0F		       call    ds:__imp__EnterCriticalSection@4	; EnterCriticalSection(x)
.text:00413E15		       test    byte ptr	[esi+4], 1
.text:00413E19		       jz      short loc_413E36
.text:00413E1B		       push    ebx	       ; lpCriticalSection
.text:00413E1C		       call    ds:__imp__LeaveCriticalSection@4	; LeaveCriticalSection(x)
.text:00413E22
.text:00413E22 loc_413E22:			       ; CODE XREF: __alloc_osfhnd+6Aj
.text:00413E22					       ; __alloc_osfhnd+AFj ...
.text:00413E22		       add     esi, 40h
.text:00413E25		       jmp     short loc_413DA9
.text:00413E27 ; ---------------------------------------------------------------------------
.text:00413E27
.text:00413E27 $LN33:				       ; DATA XREF: .rdata:0042199Co
.text:00413E27		       mov     edi, [ebp+i]
.text:00413E2A		       mov     esi, [ebp+pio]
.text:00413E2D
.text:00413E2D $LN35_1:				       ; CODE XREF: __alloc_osfhnd+A6p
.text:00413E2D		       push    0Ah	       ; locknum
.text:00413E2F		       call    __unlock
.text:00413E34		       pop     ecx
.text:00413E35
.text:00413E35 $LN34:
.text:00413E35		       retn
.text:00413E36 ; ---------------------------------------------------------------------------
.text:00413E36
.text:00413E36 loc_413E36:			       ; CODE XREF: __alloc_osfhnd+BFj
.text:00413E36		       cmp     [ebp+failed], 0
.text:00413E3A		       jnz     short loc_413E22
.text:00413E3C		       mov     byte ptr	[esi+4], 1
.text:00413E40		       or      dword ptr [esi],	0FFFFFFFFh
.text:00413E43		       sub     esi, ___pioinfo[edi*4]
.text:00413E4A		       sar     esi, 6
.text:00413E4D		       mov     eax, edi
.text:00413E4F		       shl     eax, 5
.text:00413E52		       add     esi, eax
.text:00413E54		       mov     [ebp+fh], esi
.text:00413E57
.text:00413E57 loc_413E57:			       ; CODE XREF: __alloc_osfhnd+60j
.text:00413E57		       cmp     [ebp+fh], 0FFFFFFFFh
.text:00413E5B		       jnz     short loc_413ED6
.text:00413E5D		       inc     edi
.text:00413E5E		       jmp     loc_413D8E
.text:00413E63 ; ---------------------------------------------------------------------------
.text:00413E63
.text:00413E63 loc_413E63:			       ; CODE XREF: __alloc_osfhnd+49j
.text:00413E63		       push    40h	       ; size
.text:00413E65		       push    20h	       ; count
.text:00413E67		       call    __calloc_crt
.text:00413E6C		       pop     ecx
.text:00413E6D		       pop     ecx
.text:00413E6E		       mov     [ebp+pio], eax
.text:00413E71		       test    eax, eax
.text:00413E73		       jz      short loc_413ED6
.text:00413E75		       lea     ecx, ds:423F00h[edi*4]
.text:00413E7C		       mov     [ecx], eax
.text:00413E7E		       add     __nhandle, 20h
.text:00413E85
.text:00413E85 loc_413E85:			       ; CODE XREF: __alloc_osfhnd+14Cj
.text:00413E85		       mov     edx, [ecx]
.text:00413E87		       add     edx, 800h
.text:00413E8D		       cmp     eax, edx
.text:00413E8F		       jnb     short loc_413EA8
.text:00413E91		       mov     byte ptr	[eax+4], 0
.text:00413E95		       or      dword ptr [eax],	0FFFFFFFFh
.text:00413E98		       mov     byte ptr	[eax+5], 0Ah
.text:00413E9C		       and     dword ptr [eax+8], 0
.text:00413EA0		       add     eax, 40h
.text:00413EA3		       mov     [ebp+pio], eax
.text:00413EA6		       jmp     short loc_413E85
.text:00413EA8 ; ---------------------------------------------------------------------------
.text:00413EA8
.text:00413EA8 loc_413EA8:			       ; CODE XREF: __alloc_osfhnd+135j
.text:00413EA8		       shl     edi, 5
.text:00413EAB		       mov     [ebp+fh], edi
.text:00413EAE		       mov     eax, edi
.text:00413EB0		       sar     eax, 5
.text:00413EB3		       mov     ecx, edi
.text:00413EB5		       and     ecx, 1Fh
.text:00413EB8		       shl     ecx, 6
.text:00413EBB		       mov     eax, ___pioinfo[eax*4]
.text:00413EC2		       mov     byte ptr	[eax+ecx+4], 1
.text:00413EC7		       push    edi	       ; fh
.text:00413EC8		       call    ___lock_fhandle
.text:00413ECD		       pop     ecx
.text:00413ECE		       test    eax, eax
.text:00413ED0		       jnz     short loc_413ED6
.text:00413ED2		       or      [ebp+fh], 0FFFFFFFFh
.text:00413ED6
.text:00413ED6 loc_413ED6:			       ; CODE XREF: __alloc_osfhnd+3Aj
.text:00413ED6					       ; __alloc_osfhnd+101j ...
.text:00413ED6		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00413EDD		       call    $LN29_0
.text:00413EE2
.text:00413EE2 $LN32:
.text:00413EE2		       mov     eax, [ebp+fh]
.text:00413EE5
.text:00413EE5 loc_413EE5:			       ; CODE XREF: __alloc_osfhnd+24j
.text:00413EE5		       call    __SEH_epilog4
.text:00413EEA		       retn
.text:00413EEB ; ---------------------------------------------------------------------------
.text:00413EEB
.text:00413EEB $LN29_0:				       ; CODE XREF: __alloc_osfhnd+183p
.text:00413EEB					       ; DATA XREF: .rdata:00421990o
.text:00413EEB		       push    0Bh	       ; locknum
.text:00413EED		       call    __unlock
.text:00413EF2		       pop     ecx
.text:00413EF3
.text:00413EF3 $LN30_1:
.text:00413EF3		       retn
.text:00413EF3 __alloc_osfhnd  endp ; sp-analysis failed
.text:00413EF3
.text:00413EF4
.text:00413EF4 ; =============== S U B R O U T I N E =======================================
.text:00413EF4
.text:00413EF4 ; Attributes: bp-based frame
.text:00413EF4
.text:00413EF4 ; int __cdecl _open_osfhandle(int osfhandle, int	flags)
.text:00413EF4 __open_osfhandle	proc near
.text:00413EF4
.text:00413EF4 success	       = dword ptr -1Ch
.text:00413EF4 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00413EF4 osfhandle       = dword ptr  8
.text:00413EF4 fh	       = dword ptr  0Ch
.text:00413EF4
.text:00413EF4		       push    0Ch
.text:00413EF6		       push    offset dword_4219A0
.text:00413EFB		       call    __SEH_prolog4
.text:00413F00		       xor     edi, edi
.text:00413F02		       mov     [ebp+success], edi
.text:00413F05		       xor     bl, bl
.text:00413F07		       test    byte ptr	[ebp+fh], 8
.text:00413F0B		       jz      short loc_413F10
.text:00413F0D		       add     bl, 20h
.text:00413F10
.text:00413F10 loc_413F10:			       ; CODE XREF: __open_osfhandle+17j
.text:00413F10		       test    word ptr	[ebp+fh], 4000h
.text:00413F16		       jz      short loc_413F1B
.text:00413F18		       or      bl, 80h
.text:00413F1B
.text:00413F1B loc_413F1B:			       ; CODE XREF: __open_osfhandle+22j
.text:00413F1B		       test    byte ptr	[ebp+fh], 80h
.text:00413F1F		       jz      short loc_413F24
.text:00413F21		       or      bl, 10h
.text:00413F24
.text:00413F24 loc_413F24:			       ; CODE XREF: __open_osfhandle+2Bj
.text:00413F24		       push    [ebp+osfhandle] ; hFile
.text:00413F27		       call    ds:__imp__GetFileType@4 ; GetFileType(x)
.text:00413F2D		       cmp     eax, edi
.text:00413F2F		       jnz     short loc_413F47
.text:00413F31		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00413F37		       push    eax	       ; oserrno
.text:00413F38		       call    __dosmaperr
.text:00413F3D		       pop     ecx
.text:00413F3E
.text:00413F3E loc_413F3E:			       ; CODE XREF: __open_osfhandle+86j
.text:00413F3E					       ; __open_osfhandle+DBj
.text:00413F3E		       or      eax, 0FFFFFFFFh
.text:00413F41
.text:00413F41 loc_413F41:			       ; CODE XREF: __open_osfhandle+E3j
.text:00413F41		       call    __SEH_epilog4
.text:00413F46		       retn
.text:00413F47 ; ---------------------------------------------------------------------------
.text:00413F47
.text:00413F47 loc_413F47:			       ; CODE XREF: __open_osfhandle+3Bj
.text:00413F47		       cmp     eax, 2
.text:00413F4A		       jnz     short loc_413F51
.text:00413F4C		       or      bl, 40h
.text:00413F4F		       jmp     short loc_413F59
.text:00413F51 ; ---------------------------------------------------------------------------
.text:00413F51
.text:00413F51 loc_413F51:			       ; CODE XREF: __open_osfhandle+56j
.text:00413F51		       cmp     eax, 3
.text:00413F54		       jnz     short loc_413F59
.text:00413F56		       or      bl, 8
.text:00413F59
.text:00413F59 loc_413F59:			       ; CODE XREF: __open_osfhandle+5Bj
.text:00413F59					       ; __open_osfhandle+60j
.text:00413F59		       call    __alloc_osfhnd
.text:00413F5E		       mov     esi, eax
.text:00413F60		       mov     [ebp+fh], esi
.text:00413F63		       cmp     esi, 0FFFFFFFFh
.text:00413F66		       jnz     short loc_413F7C
.text:00413F68		       call    __errno
.text:00413F6D		       mov     dword ptr [eax],	18h
.text:00413F73		       call    ___doserrno
.text:00413F78		       mov     [eax], edi
.text:00413F7A		       jmp     short loc_413F3E
.text:00413F7C ; ---------------------------------------------------------------------------
.text:00413F7C
.text:00413F7C loc_413F7C:			       ; CODE XREF: __open_osfhandle+72j
.text:00413F7C		       mov     [ebp+ms_exc.disabled], edi
.text:00413F7F		       push    [ebp+osfhandle] ; value
.text:00413F82		       push    esi	       ; fh
.text:00413F83		       call    __set_osfhnd
.text:00413F88		       pop     ecx
.text:00413F89		       pop     ecx
.text:00413F8A		       or      bl, 1
.text:00413F8D		       mov     eax, esi
.text:00413F8F		       sar     eax, 5
.text:00413F92		       lea     ecx, ds:423F00h[eax*4]
.text:00413F99		       mov     eax, esi
.text:00413F9B		       and     eax, 1Fh
.text:00413F9E		       shl     eax, 6
.text:00413FA1		       mov     edx, [ecx]
.text:00413FA3		       mov     [edx+eax+4], bl
.text:00413FA7		       mov     edx, [ecx]
.text:00413FA9		       lea     edx, [edx+eax+24h]
.text:00413FAD		       and     byte ptr	[edx], 80h
.text:00413FB0		       mov     ecx, [ecx]
.text:00413FB2		       lea     eax, [ecx+eax+24h]
.text:00413FB6		       and     byte ptr	[eax], 7Fh
.text:00413FB9		       mov     [ebp+success], 1
.text:00413FC0		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00413FC7		       call    $LN18_2
.text:00413FCC
.text:00413FCC $LN19_5:
.text:00413FCC		       cmp     [ebp+success], edi
.text:00413FCF		       jz      loc_413F3E
.text:00413FD5		       mov     eax, esi
.text:00413FD7		       jmp     loc_413F41
.text:00413FDC ; ---------------------------------------------------------------------------
.text:00413FDC
.text:00413FDC $LN16_4:				       ; DATA XREF: .rdata:004219B8o
.text:00413FDC		       mov     esi, [ebp+fh]
.text:00413FDF		       xor     edi, edi
.text:00413FE1
.text:00413FE1 $LN18_2:				       ; CODE XREF: __open_osfhandle+D3p
.text:00413FE1		       cmp     [ebp+success], edi
.text:00413FE4		       jnz     short loc_414001
.text:00413FE6		       mov     eax, esi
.text:00413FE8		       sar     eax, 5
.text:00413FEB		       mov     ecx, esi
.text:00413FED		       and     ecx, 1Fh
.text:00413FF0		       shl     ecx, 6
.text:00413FF3		       mov     eax, ___pioinfo[eax*4]
.text:00413FFA		       lea     eax, [eax+ecx+4]
.text:00413FFE		       and     byte ptr	[eax], 0FEh
.text:00414001
.text:00414001 loc_414001:			       ; CODE XREF: __open_osfhandle+F0j
.text:00414001		       push    esi	       ; fh
.text:00414002		       call    __unlock_fhandle
.text:00414007		       pop     ecx
.text:00414008
.text:00414008 $LN17_5:
.text:00414008		       retn
.text:00414008 __open_osfhandle	endp ; sp-analysis failed
.text:00414008
.text:00414009
.text:00414009 ; =============== S U B R O U T I N E =======================================
.text:00414009
.text:00414009 ; Attributes: bp-based frame
.text:00414009
.text:00414009 ; int __cdecl __ansicp(int lcid)
.text:00414009 ___ansicp       proc near	       ; CODE XREF: __crtLCMapStringA_stat+25Ap
.text:00414009					       ; __crtGetStringTypeA_stat+150p	...
.text:00414009
.text:00414009 nptr	       = byte ptr -0Ch
.text:00414009 var_6	       = byte ptr -6
.text:00414009 var_4	       = dword ptr -4
.text:00414009 lcid	       = dword ptr  8
.text:00414009
.text:00414009		       push    ebp
.text:0041400A		       mov     ebp, esp
.text:0041400C		       sub     esp, 0Ch
.text:0041400F		       mov     eax, ___security_cookie
.text:00414014		       xor     eax, ebp
.text:00414016		       mov     [ebp+var_4], eax
.text:00414019		       push    6	       ; cchData
.text:0041401B		       lea     eax, [ebp+nptr]
.text:0041401E		       push    eax	       ; lpLCData
.text:0041401F		       push    1004h	       ; LCType
.text:00414024		       push    [ebp+lcid]      ; Locale
.text:00414027		       mov     [ebp+var_6], 0
.text:0041402B		       call    ds:__imp__GetLocaleInfoA@16 ; GetLocaleInfoA(x,x,x,x)
.text:00414031		       test    eax, eax
.text:00414033		       jnz     short loc_41403A
.text:00414035		       or      eax, 0FFFFFFFFh
.text:00414038		       jmp     short loc_414044
.text:0041403A ; ---------------------------------------------------------------------------
.text:0041403A
.text:0041403A loc_41403A:			       ; CODE XREF: ___ansicp+2Aj
.text:0041403A		       lea     eax, [ebp+nptr]
.text:0041403D		       push    eax	       ; nptr
.text:0041403E		       call    _atol
.text:00414043		       pop     ecx
.text:00414044
.text:00414044 loc_414044:			       ; CODE XREF: ___ansicp+2Fj
.text:00414044		       mov     ecx, [ebp+var_4]
.text:00414047		       xor     ecx, ebp	       ; cookie
.text:00414049		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:0041404E		       leave
.text:0041404F		       retn
.text:0041404F ___ansicp       endp
.text:0041404F
.text:00414050
.text:00414050 ; =============== S U B R O U T I N E =======================================
.text:00414050
.text:00414050 ; Attributes: bp-based frame
.text:00414050
.text:00414050 ; char *__cdecl __convertcp(int fromCP, int toCP, const char *lpSrcStr, int *pcchSrc, char *lpDestStr, int cchDest)
.text:00414050 ___convertcp    proc near	       ; CODE XREF: __crtLCMapStringA_stat+285p
.text:00414050					       ; __crtLCMapStringA_stat+336p ...
.text:00414050
.text:00414050 var_34	       = dword ptr -34h
.text:00414050 var_30	       = dword ptr -30h
.text:00414050 sb	       = dword ptr -2Ch
.text:00414050 lpMultiByteStr  = dword ptr -28h
.text:00414050 cchSrc	       = dword ptr -24h
.text:00414050 cbuffer	       = dword ptr -20h
.text:00414050 wbuffer	       = dword ptr -1Ch
.text:00414050 cpi	       = _cpinfo ptr -18h
.text:00414050 var_4	       = dword ptr -4
.text:00414050 fromCP	       = dword ptr  8
.text:00414050 toCP	       = dword ptr  0Ch
.text:00414050 lpSrcStr	       = dword ptr  10h
.text:00414050 pcchSrc	       = dword ptr  14h
.text:00414050 lpDestStr       = dword ptr  18h
.text:00414050 cchDest	       = dword ptr  1Ch
.text:00414050
.text:00414050		       push    ebp
.text:00414051		       mov     ebp, esp
.text:00414053		       sub     esp, 34h
.text:00414056		       mov     eax, ___security_cookie
.text:0041405B		       xor     eax, ebp
.text:0041405D		       mov     [ebp+var_4], eax
.text:00414060		       mov     eax, [ebp+lpSrcStr]
.text:00414063		       mov     ecx, [ebp+lpDestStr]
.text:00414066		       mov     [ebp+lpMultiByteStr], eax
.text:00414069		       mov     eax, [ebp+pcchSrc]
.text:0041406C		       push    ebx
.text:0041406D		       mov     [ebp+var_30], eax
.text:00414070		       mov     eax, [eax]
.text:00414072		       push    esi
.text:00414073		       mov     [ebp+cchSrc], eax
.text:00414076		       mov     eax, [ebp+fromCP]
.text:00414079		       push    edi
.text:0041407A		       xor     edi, edi
.text:0041407C		       cmp     eax, [ebp+toCP]
.text:0041407F		       mov     [ebp+var_34], ecx
.text:00414082		       mov     [ebp+cbuffer], edi
.text:00414085		       mov     [ebp+sb], edi
.text:00414088		       jz      loc_4141ED
.text:0041408E		       mov     esi, ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:00414094		       lea     ecx, [ebp+cpi]
.text:00414097		       push    ecx	       ; lpCPInfo
.text:00414098		       push    eax	       ; CodePage
.text:00414099		       call    esi ; GetCPInfo(x,x) ; GetCPInfo(x,x)
.text:0041409B		       test    eax, eax
.text:0041409D		       mov     ebx, ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
.text:004140A3		       jz      short loc_414103
.text:004140A5		       cmp     [ebp+cpi.MaxCharSize], 1
.text:004140A9		       jnz     short loc_414103
.text:004140AB		       lea     eax, [ebp+cpi]
.text:004140AE		       push    eax	       ; lpCPInfo
.text:004140AF		       push    [ebp+toCP]      ; CodePage
.text:004140B2		       call    esi ; GetCPInfo(x,x) ; GetCPInfo(x,x)
.text:004140B4		       test    eax, eax
.text:004140B6		       jz      short loc_414103
.text:004140B8		       cmp     [ebp+cpi.MaxCharSize], 1
.text:004140BC		       jnz     short loc_414103
.text:004140BE		       mov     esi, [ebp+cchSrc]
.text:004140C1		       cmp     esi, 0FFFFFFFFh
.text:004140C4		       mov     [ebp+sb], 1
.text:004140CB		       jnz     short loc_4140D9
.text:004140CD		       push    [ebp+lpMultiByteStr] ; buf
.text:004140D0		       call    _strlen
.text:004140D5		       mov     esi, eax
.text:004140D7		       pop     ecx
.text:004140D8		       inc     esi
.text:004140D9
.text:004140D9 loc_4140D9:			       ; CODE XREF: ___convertcp+7Bj
.text:004140D9		       cmp     esi, edi
.text:004140DB
.text:004140DB loc_4140DB:			       ; CODE XREF: ___convertcp+C6j
.text:004140DB		       jle     short loc_414138
.text:004140DD		       cmp     esi, 7FFFFFF0h
.text:004140E3		       ja      short loc_414138
.text:004140E5		       lea     eax, [esi+esi+8]
.text:004140E9		       cmp     eax, 400h
.text:004140EE		       ja      short loc_41411F
.text:004140F0		       call    __alloca_probe_16
.text:004140F5		       mov     eax, esp
.text:004140F7		       cmp     eax, edi
.text:004140F9		       jz      short loc_414133
.text:004140FB		       mov     dword ptr [eax],	0CCCCh
.text:00414101		       jmp     short loc_414130
.text:00414103 ; ---------------------------------------------------------------------------
.text:00414103
.text:00414103 loc_414103:			       ; CODE XREF: ___convertcp+53j
.text:00414103					       ; ___convertcp+59j ...
.text:00414103		       push    edi	       ; cchWideChar
.text:00414104		       push    edi	       ; lpWideCharStr
.text:00414105		       push    [ebp+cchSrc]    ; cbMultiByte
.text:00414108		       push    [ebp+lpMultiByteStr] ; lpMultiByteStr
.text:0041410B		       push    1	       ; dwFlags
.text:0041410D		       push    [ebp+fromCP]    ; CodePage
.text:00414110		       call    ebx ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00414112		       mov     esi, eax
.text:00414114		       cmp     esi, edi
.text:00414116		       jnz     short loc_4140DB
.text:00414118
.text:00414118 loc_414118:			       ; CODE XREF: ___convertcp+EEj
.text:00414118		       xor     eax, eax
.text:0041411A		       jmp     loc_4141F0
.text:0041411F ; ---------------------------------------------------------------------------
.text:0041411F
.text:0041411F loc_41411F:			       ; CODE XREF: ___convertcp+9Ej
.text:0041411F		       push    eax	       ; size
.text:00414120		       call    _malloc
.text:00414125		       cmp     eax, edi
.text:00414127		       pop     ecx
.text:00414128		       jz      short loc_414133
.text:0041412A		       mov     dword ptr [eax],	0DDDDh
.text:00414130
.text:00414130 loc_414130:			       ; CODE XREF: ___convertcp+B1j
.text:00414130		       add     eax, 8
.text:00414133
.text:00414133 loc_414133:			       ; CODE XREF: ___convertcp+A9j
.text:00414133					       ; ___convertcp+D8j
.text:00414133		       mov     [ebp+wbuffer], eax
.text:00414136		       jmp     short loc_41413B
.text:00414138 ; ---------------------------------------------------------------------------
.text:00414138
.text:00414138 loc_414138:			       ; CODE XREF: ___convertcp:loc_4140DBj
.text:00414138					       ; ___convertcp+93j
.text:00414138		       mov     [ebp+wbuffer], edi
.text:0041413B
.text:0041413B loc_41413B:			       ; CODE XREF: ___convertcp+E6j
.text:0041413B		       cmp     [ebp+wbuffer], edi
.text:0041413E		       jz      short loc_414118
.text:00414140		       lea     eax, [esi+esi]
.text:00414143		       push    eax	       ; count
.text:00414144		       push    edi	       ; value
.text:00414145		       push    [ebp+wbuffer]   ; dst
.text:00414148		       call    _memset
.text:0041414D		       add     esp, 0Ch
.text:00414150		       push    esi	       ; cchWideChar
.text:00414151		       push    [ebp+wbuffer]   ; lpWideCharStr
.text:00414154		       push    [ebp+cchSrc]    ; cbMultiByte
.text:00414157		       push    [ebp+lpMultiByteStr] ; lpMultiByteStr
.text:0041415A		       push    1	       ; dwFlags
.text:0041415C		       push    [ebp+fromCP]    ; CodePage
.text:0041415F		       call    ebx ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00414161		       test    eax, eax
.text:00414163		       jz      short loc_4141E4
.text:00414165		       mov     ebx, [ebp+var_34]
.text:00414168		       cmp     ebx, edi
.text:0041416A		       jz      short loc_414189
.text:0041416C		       push    edi	       ; lpUsedDefaultChar
.text:0041416D		       push    edi	       ; lpDefaultChar
.text:0041416E		       push    [ebp+cchDest]   ; cbMultiByte
.text:00414171		       push    ebx	       ; lpMultiByteStr
.text:00414172		       push    esi	       ; cchWideChar
.text:00414173		       push    [ebp+wbuffer]   ; lpWideCharStr
.text:00414176		       push    edi	       ; dwFlags
.text:00414177		       push    [ebp+toCP]      ; CodePage
.text:0041417A		       call    ds:__imp__WideCharToMultiByte@32	; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414180		       test    eax, eax
.text:00414182		       jz      short loc_4141E4
.text:00414184		       mov     [ebp+cbuffer], ebx
.text:00414187		       jmp     short loc_4141E4
.text:00414189 ; ---------------------------------------------------------------------------
.text:00414189
.text:00414189 loc_414189:			       ; CODE XREF: ___convertcp+11Aj
.text:00414189		       cmp     [ebp+sb], edi
.text:0041418C		       mov     ebx, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414192		       jnz     short loc_4141A8
.text:00414194		       push    edi	       ; lpUsedDefaultChar
.text:00414195		       push    edi	       ; lpDefaultChar
.text:00414196		       push    edi	       ; cbMultiByte
.text:00414197		       push    edi	       ; lpMultiByteStr
.text:00414198		       push    esi	       ; cchWideChar
.text:00414199		       push    [ebp+wbuffer]   ; lpWideCharStr
.text:0041419C		       push    edi	       ; dwFlags
.text:0041419D		       push    [ebp+toCP]      ; CodePage
.text:004141A0		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:004141A2		       mov     esi, eax
.text:004141A4		       cmp     esi, edi
.text:004141A6		       jz      short loc_4141E4
.text:004141A8
.text:004141A8 loc_4141A8:			       ; CODE XREF: ___convertcp+142j
.text:004141A8		       push    esi	       ; size
.text:004141A9		       push    1	       ; count
.text:004141AB		       call    __calloc_crt
.text:004141B0		       cmp     eax, edi
.text:004141B2		       pop     ecx
.text:004141B3		       pop     ecx
.text:004141B4		       mov     [ebp+cbuffer], eax
.text:004141B7		       jz      short loc_4141E4
.text:004141B9		       push    edi	       ; lpUsedDefaultChar
.text:004141BA		       push    edi	       ; lpDefaultChar
.text:004141BB		       push    esi	       ; cbMultiByte
.text:004141BC		       push    eax	       ; lpMultiByteStr
.text:004141BD		       push    esi	       ; cchWideChar
.text:004141BE		       push    [ebp+wbuffer]   ; lpWideCharStr
.text:004141C1		       push    edi	       ; dwFlags
.text:004141C2		       push    [ebp+toCP]      ; CodePage
.text:004141C5		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:004141C7		       cmp     eax, edi
.text:004141C9		       jnz     short loc_4141D9
.text:004141CB		       push    [ebp+cbuffer]   ; pBlock
.text:004141CE		       call    _free
.text:004141D3		       pop     ecx
.text:004141D4		       mov     [ebp+cbuffer], edi
.text:004141D7		       jmp     short loc_4141E4
.text:004141D9 ; ---------------------------------------------------------------------------
.text:004141D9
.text:004141D9 loc_4141D9:			       ; CODE XREF: ___convertcp+179j
.text:004141D9		       cmp     [ebp+cchSrc], 0FFFFFFFFh
.text:004141DD		       jz      short loc_4141E4
.text:004141DF		       mov     ecx, [ebp+var_30]
.text:004141E2		       mov     [ecx], eax
.text:004141E4
.text:004141E4 loc_4141E4:			       ; CODE XREF: ___convertcp+113j
.text:004141E4					       ; ___convertcp+132j ...
.text:004141E4		       push    [ebp+wbuffer]   ; _Memory
.text:004141E7		       call    __freea
.text:004141EC		       pop     ecx
.text:004141ED
.text:004141ED loc_4141ED:			       ; CODE XREF: ___convertcp+38j
.text:004141ED		       mov     eax, [ebp+cbuffer]
.text:004141F0
.text:004141F0 loc_4141F0:			       ; CODE XREF: ___convertcp+CAj
.text:004141F0		       lea     esp, [ebp-40h]
.text:004141F3		       pop     edi
.text:004141F4		       pop     esi
.text:004141F5		       pop     ebx
.text:004141F6		       mov     ecx, [ebp+var_4]
.text:004141F9		       xor     ecx, ebp	       ; cookie
.text:004141FB		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00414200		       leave
.text:00414201		       retn
.text:00414201 ___convertcp    endp
.text:00414201
.text:00414202
.text:00414202 ; =============== S U B R O U T I N E =======================================
.text:00414202
.text:00414202
.text:00414202 ; int __cdecl _get_daylight(int *_Daylight)
.text:00414202 __get_daylight  proc near	       ; CODE XREF: _tzset_nolock+52p
.text:00414202					       ; _isindst_nolock+10p
.text:00414202
.text:00414202 _Daylight       = dword ptr  4
.text:00414202
.text:00414202		       mov     eax, [esp+_Daylight]
.text:00414206		       push    esi
.text:00414207		       xor     esi, esi
.text:00414209		       cmp     eax, esi
.text:0041420B		       jnz     short loc_41422A
.text:0041420D		       call    __errno
.text:00414212		       push    esi	       ; pReserved
.text:00414213		       push    esi	       ; nLine
.text:00414214		       push    esi	       ; pszFile
.text:00414215		       push    esi	       ; pszFunction
.text:00414216		       push    esi	       ; pszExpression
.text:00414217		       mov     dword ptr [eax],	16h
.text:0041421D		       call    __invalid_parameter
.text:00414222		       add     esp, 14h
.text:00414225		       push    16h
.text:00414227		       pop     eax
.text:00414228		       pop     esi
.text:00414229		       retn
.text:0041422A ; ---------------------------------------------------------------------------
.text:0041422A
.text:0041422A loc_41422A:			       ; CODE XREF: __get_daylight+9j
.text:0041422A		       mov     ecx, __daylight
.text:00414230		       mov     [eax], ecx
.text:00414232		       xor     eax, eax
.text:00414234		       pop     esi
.text:00414235		       retn
.text:00414235 __get_daylight  endp
.text:00414235
.text:00414236
.text:00414236 ; =============== S U B R O U T I N E =======================================
.text:00414236
.text:00414236
.text:00414236 ; int __cdecl _get_dstbias(int *_Daylight_savings_bias)
.text:00414236 __get_dstbias   proc near	       ; CODE XREF: _tzset_nolock+6Dp
.text:00414236					       ; cvtdate+195p
.text:00414236
.text:00414236 _Daylight_savings_bias= dword ptr  4
.text:00414236
.text:00414236		       mov     eax, [esp+_Daylight_savings_bias]
.text:0041423A		       push    esi
.text:0041423B		       xor     esi, esi
.text:0041423D		       cmp     eax, esi
.text:0041423F		       jnz     short loc_41425E
.text:00414241		       call    __errno
.text:00414246		       push    esi	       ; pReserved
.text:00414247		       push    esi	       ; nLine
.text:00414248		       push    esi	       ; pszFile
.text:00414249		       push    esi	       ; pszFunction
.text:0041424A		       push    esi	       ; pszExpression
.text:0041424B		       mov     dword ptr [eax],	16h
.text:00414251		       call    __invalid_parameter
.text:00414256		       add     esp, 14h
.text:00414259		       push    16h
.text:0041425B		       pop     eax
.text:0041425C		       pop     esi
.text:0041425D		       retn
.text:0041425E ; ---------------------------------------------------------------------------
.text:0041425E
.text:0041425E loc_41425E:			       ; CODE XREF: __get_dstbias+9j
.text:0041425E		       mov     ecx, __dstbias
.text:00414264		       mov     [eax], ecx
.text:00414266		       xor     eax, eax
.text:00414268		       pop     esi
.text:00414269		       retn
.text:00414269 __get_dstbias   endp
.text:00414269
.text:0041426A
.text:0041426A ; =============== S U B R O U T I N E =======================================
.text:0041426A
.text:0041426A
.text:0041426A ; int __cdecl _get_timezone(int *_Timezone)
.text:0041426A __get_timezone  proc near	       ; CODE XREF: _tzset_nolock+37p
.text:0041426A
.text:0041426A _Timezone       = dword ptr  4
.text:0041426A
.text:0041426A		       mov     eax, [esp+_Timezone]
.text:0041426E		       push    esi
.text:0041426F		       xor     esi, esi
.text:00414271		       cmp     eax, esi
.text:00414273		       jnz     short loc_414292
.text:00414275		       call    __errno
.text:0041427A		       push    esi	       ; pReserved
.text:0041427B		       push    esi	       ; nLine
.text:0041427C		       push    esi	       ; pszFile
.text:0041427D		       push    esi	       ; pszFunction
.text:0041427E		       push    esi	       ; pszExpression
.text:0041427F		       mov     dword ptr [eax],	16h
.text:00414285		       call    __invalid_parameter
.text:0041428A		       add     esp, 14h
.text:0041428D		       push    16h
.text:0041428F		       pop     eax
.text:00414290		       pop     esi
.text:00414291		       retn
.text:00414292 ; ---------------------------------------------------------------------------
.text:00414292
.text:00414292 loc_414292:			       ; CODE XREF: __get_timezone+9j
.text:00414292		       mov     ecx, __timezone
.text:00414298		       mov     [eax], ecx
.text:0041429A		       xor     eax, eax
.text:0041429C		       pop     esi
.text:0041429D		       retn
.text:0041429D __get_timezone  endp
.text:0041429D
.text:0041429E
.text:0041429E ; =============== S U B R O U T I N E =======================================
.text:0041429E
.text:0041429E ; Attributes: bp-based frame
.text:0041429E
.text:0041429E ; int __cdecl _get_tzname(unsigned int *_ReturnValue, char *_Buffer, unsigned int _SizeInBytes, int _Index)
.text:0041429E __get_tzname    proc near
.text:0041429E
.text:0041429E _ReturnValue    = dword ptr  8
.text:0041429E _Buffer	       = dword ptr  0Ch
.text:0041429E _SizeInBytes    = dword ptr  10h
.text:0041429E _Index	       = dword ptr  14h
.text:0041429E
.text:0041429E		       push    ebp
.text:0041429F		       mov     ebp, esp
.text:004142A1		       mov     eax, [ebp+_Buffer]
.text:004142A4		       push    ebx
.text:004142A5		       xor     ebx, ebx
.text:004142A7		       cmp     eax, ebx
.text:004142A9		       push    esi
.text:004142AA		       jz      short loc_4142E6
.text:004142AC		       cmp     [ebp+_SizeInBytes], ebx
.text:004142AF		       jbe     short loc_4142EB
.text:004142B1
.text:004142B1 loc_4142B1:			       ; CODE XREF: __get_tzname+4Bj
.text:004142B1		       cmp     eax, ebx
.text:004142B3		       jz      short loc_4142B7
.text:004142B5		       mov     [eax], bl
.text:004142B7
.text:004142B7 loc_4142B7:			       ; CODE XREF: __get_tzname+15j
.text:004142B7		       push    edi
.text:004142B8		       mov     edi, [ebp+_ReturnValue]
.text:004142BB		       cmp     edi, ebx
.text:004142BD		       jz      short loc_4142CB
.text:004142BF		       mov     eax, [ebp+_Index]
.text:004142C2		       cmp     eax, ebx
.text:004142C4		       jz      short loc_414306
.text:004142C6		       cmp     eax, 1
.text:004142C9		       jz      short loc_414306
.text:004142CB
.text:004142CB loc_4142CB:			       ; CODE XREF: __get_tzname+1Fj
.text:004142CB		       call    __errno
.text:004142D0		       push    16h
.text:004142D2		       pop     esi
.text:004142D3		       push    ebx	       ; pReserved
.text:004142D4		       push    ebx	       ; nLine
.text:004142D5		       push    ebx	       ; pszFile
.text:004142D6		       push    ebx	       ; pszFunction
.text:004142D7		       push    ebx	       ; pszExpression
.text:004142D8		       mov     [eax], esi
.text:004142DA		       call    __invalid_parameter
.text:004142DF		       add     esp, 14h
.text:004142E2		       mov     eax, esi
.text:004142E4		       jmp     short loc_41433B
.text:004142E6 ; ---------------------------------------------------------------------------
.text:004142E6
.text:004142E6 loc_4142E6:			       ; CODE XREF: __get_tzname+Cj
.text:004142E6		       cmp     [ebp+_SizeInBytes], ebx
.text:004142E9		       jz      short loc_4142B1
.text:004142EB
.text:004142EB loc_4142EB:			       ; CODE XREF: __get_tzname+11j
.text:004142EB		       call    __errno
.text:004142F0		       push    16h
.text:004142F2		       pop     esi
.text:004142F3		       push    ebx	       ; pReserved
.text:004142F4		       push    ebx	       ; nLine
.text:004142F5		       push    ebx	       ; pszFile
.text:004142F6		       push    ebx	       ; pszFunction
.text:004142F7		       push    ebx	       ; pszExpression
.text:004142F8		       mov     [eax], esi
.text:004142FA		       call    __invalid_parameter
.text:004142FF		       add     esp, 14h
.text:00414302		       mov     eax, esi
.text:00414304		       jmp     short loc_41433C
.text:00414306 ; ---------------------------------------------------------------------------
.text:00414306
.text:00414306 loc_414306:			       ; CODE XREF: __get_tzname+26j
.text:00414306					       ; __get_tzname+2Bj
.text:00414306		       lea     esi, ds:422F48h[eax*4]
.text:0041430D		       push    dword ptr [esi] ; buf
.text:0041430F		       call    _strlen
.text:00414314		       inc     eax
.text:00414315		       cmp     [ebp+_Buffer], ebx
.text:00414318		       pop     ecx
.text:00414319		       mov     [edi], eax
.text:0041431B		       jnz     short loc_414321
.text:0041431D		       xor     eax, eax
.text:0041431F		       jmp     short loc_41433B
.text:00414321 ; ---------------------------------------------------------------------------
.text:00414321
.text:00414321 loc_414321:			       ; CODE XREF: __get_tzname+7Dj
.text:00414321		       cmp     eax, [ebp+_SizeInBytes]
.text:00414324		       jbe     short loc_41432B
.text:00414326		       push    22h
.text:00414328		       pop     eax
.text:00414329		       jmp     short loc_41433B
.text:0041432B ; ---------------------------------------------------------------------------
.text:0041432B
.text:0041432B loc_41432B:			       ; CODE XREF: __get_tzname+86j
.text:0041432B		       push    dword ptr [esi] ; _Src
.text:0041432D		       push    [ebp+_SizeInBytes] ; _SizeInBytes
.text:00414330		       push    [ebp+_Buffer]   ; _Dst
.text:00414333		       call    _strcpy_s
.text:00414338		       add     esp, 0Ch
.text:0041433B
.text:0041433B loc_41433B:			       ; CODE XREF: __get_tzname+46j
.text:0041433B					       ; __get_tzname+81j ...
.text:0041433B		       pop     edi
.text:0041433C
.text:0041433C loc_41433C:			       ; CODE XREF: __get_tzname+66j
.text:0041433C		       pop     esi
.text:0041433D		       pop     ebx
.text:0041433E		       pop     ebp
.text:0041433F		       retn
.text:0041433F __get_tzname    endp
.text:0041433F
.text:00414340
.text:00414340 ; =============== S U B R O U T I N E =======================================
.text:00414340
.text:00414340
.text:00414340 ; int *__cdecl __daylight()
.text:00414340 ___daylight     proc near	       ; CODE XREF: __set_daylightp
.text:00414340					       ; _tzset_nolock+230p ...
.text:00414340		       mov     eax, offset __daylight
.text:00414345		       retn
.text:00414345 ___daylight     endp
.text:00414345
.text:00414346
.text:00414346 ; =============== S U B R O U T I N E =======================================
.text:00414346
.text:00414346
.text:00414346 ; int *__cdecl __dstbias()
.text:00414346 ___dstbias      proc near	       ; CODE XREF: __set_dstbiasp
.text:00414346					       ; _tzset_nolock+23Ap
.text:00414346		       mov     eax, offset __dstbias
.text:0041434B		       retn
.text:0041434B ___dstbias      endp
.text:0041434B
.text:0041434C
.text:0041434C ; =============== S U B R O U T I N E =======================================
.text:0041434C
.text:0041434C
.text:0041434C ; int *__cdecl __timezone()
.text:0041434C ___timezone     proc near	       ; CODE XREF: __set_timezonep
.text:0041434C					       ; _tzset_nolock+226p ...
.text:0041434C		       mov     eax, offset __timezone
.text:00414351		       retn
.text:00414351 ___timezone     endp
.text:00414351
.text:00414352
.text:00414352 ; =============== S U B R O U T I N E =======================================
.text:00414352
.text:00414352
.text:00414352 ; char **__cdecl	__tzname()
.text:00414352 ___tzname       proc near	       ; CODE XREF: _expandtime+332p
.text:00414352					       ; _tzset_nolock+2Bp
.text:00414352		       mov     eax, offset __tzname
.text:00414357		       retn
.text:00414357 ___tzname       endp
.text:00414357
.text:00414358
.text:00414358 ; =============== S U B R O U T I N E =======================================
.text:00414358
.text:00414358
.text:00414358 ; void __cdecl _set_daylight(int	_Value)
.text:00414358 __set_daylight  proc near
.text:00414358
.text:00414358 _Value	       = dword ptr  4
.text:00414358
.text:00414358		       call    ___daylight
.text:0041435D		       mov     ecx, [esp+_Value]
.text:00414361		       mov     [eax], ecx
.text:00414363		       retn
.text:00414363 __set_daylight  endp
.text:00414363
.text:00414364
.text:00414364 ; =============== S U B R O U T I N E =======================================
.text:00414364
.text:00414364
.text:00414364 ; void __cdecl _set_dstbias(int _Value)
.text:00414364 __set_dstbias   proc near
.text:00414364
.text:00414364 _Value	       = dword ptr  4
.text:00414364
.text:00414364		       call    ___dstbias
.text:00414369		       mov     ecx, [esp+_Value]
.text:0041436D		       mov     [eax], ecx
.text:0041436F		       retn
.text:0041436F __set_dstbias   endp
.text:0041436F
.text:00414370
.text:00414370 ; =============== S U B R O U T I N E =======================================
.text:00414370
.text:00414370
.text:00414370 ; void __cdecl _set_timezone(int	_Value)
.text:00414370 __set_timezone  proc near
.text:00414370
.text:00414370 _Value	       = dword ptr  4
.text:00414370
.text:00414370		       call    ___timezone
.text:00414375		       mov     ecx, [esp+_Value]
.text:00414379		       mov     [eax], ecx
.text:0041437B		       retn
.text:0041437B __set_timezone  endp
.text:0041437B
.text:0041437C
.text:0041437C ; =============== S U B R O U T I N E =======================================
.text:0041437C
.text:0041437C ; Attributes: noreturn bp-based frame
.text:0041437C
.text:0041437C _tzset_nolock   proc near	       ; CODE XREF: ___tzset+29p
.text:0041437C					       ; __tzset+18p
.text:0041437C
.text:0041437C TZ	       = dword ptr -3Ch
.text:0041437C negdiff	       = dword ptr -38h
.text:0041437C lc_cp	       = dword ptr -34h
.text:0041437C defused	       = dword ptr -30h
.text:0041437C nochange	       = dword ptr -2Ch
.text:0041437C dstbias	       = dword ptr -28h
.text:0041437C daylight	       = dword ptr -24h
.text:0041437C tzname	       = dword ptr -20h
.text:0041437C timezone	       = dword ptr -1Ch
.text:0041437C ms_exc	       = CPPEH_RECORD ptr -18h
.text:0041437C
.text:0041437C		       push    2Ch
.text:0041437E		       push    offset dword_4219C0
.text:00414383		       call    __SEH_prolog4
.text:00414388		       xor     ebx, ebx
.text:0041438A		       mov     [ebp+negdiff], ebx
.text:0041438D		       mov     [ebp+nochange], ebx
.text:00414390		       mov     [ebp+timezone], ebx
.text:00414393		       mov     [ebp+daylight], ebx
.text:00414396		       mov     [ebp+dstbias], ebx
.text:00414399		       mov     [ebp+tzname], ebx
.text:0041439C		       push    7	       ; locknum
.text:0041439E		       call    __lock
.text:004143A3		       pop     ecx
.text:004143A4		       mov     [ebp+ms_exc.disabled], ebx
.text:004143A7		       call    ___tzname
.text:004143AC		       mov     [ebp+tzname], eax
.text:004143AF		       lea     eax, [ebp+timezone]
.text:004143B2		       push    eax	       ; _Timezone
.text:004143B3		       call    __get_timezone
.text:004143B8		       pop     ecx
.text:004143B9		       cmp     eax, ebx
.text:004143BB		       jz      short loc_4143CA
.text:004143BD		       push    ebx	       ; pReserved
.text:004143BE		       push    ebx	       ; nLine
.text:004143BF		       push    ebx	       ; pszFile
.text:004143C0		       push    ebx	       ; pszFunction
.text:004143C1		       push    ebx	       ; pszExpression
.text:004143C2		       call    __invoke_watson
.text:004143C7		       add     esp, 14h
.text:004143CA
.text:004143CA loc_4143CA:			       ; CODE XREF: _tzset_nolock+3Fj
.text:004143CA		       lea     eax, [ebp+daylight]
.text:004143CD		       push    eax	       ; _Daylight
.text:004143CE		       call    __get_daylight
.text:004143D3		       pop     ecx
.text:004143D4		       cmp     eax, ebx
.text:004143D6		       jz      short loc_4143E5
.text:004143D8		       push    ebx	       ; pReserved
.text:004143D9		       push    ebx	       ; nLine
.text:004143DA		       push    ebx	       ; pszFile
.text:004143DB		       push    ebx	       ; pszFunction
.text:004143DC		       push    ebx	       ; pszExpression
.text:004143DD		       call    __invoke_watson
.text:004143E2		       add     esp, 14h
.text:004143E5
.text:004143E5 loc_4143E5:			       ; CODE XREF: _tzset_nolock+5Aj
.text:004143E5		       lea     eax, [ebp+dstbias]
.text:004143E8		       push    eax	       ; _Daylight_savings_bias
.text:004143E9		       call    __get_dstbias
.text:004143EE		       pop     ecx
.text:004143EF		       cmp     eax, ebx
.text:004143F1		       jz      short loc_414400
.text:004143F3		       push    ebx	       ; pReserved
.text:004143F4		       push    ebx	       ; nLine
.text:004143F5		       push    ebx	       ; pszFile
.text:004143F6		       push    ebx	       ; pszFunction
.text:004143F7		       push    ebx	       ; pszExpression
.text:004143F8		       call    __invoke_watson
.text:004143FD		       add     esp, 14h
.text:00414400
.text:00414400 loc_414400:			       ; CODE XREF: _tzset_nolock+75j
.text:00414400		       call    ____lc_codepage_func
.text:00414405		       mov     [ebp+lc_cp], eax
.text:00414408		       mov     tzapiused, ebx
.text:0041440E		       or      edi, 0FFFFFFFFh
.text:00414411		       mov     dstend.yr, edi
.text:00414417		       mov     dststart.yr, edi
.text:0041441D		       push    offset option   ; "TZ"
.text:00414422		       call    __getenv_helper_nolock
.text:00414427		       pop     ecx
.text:00414428		       mov     esi, eax
.text:0041442A		       mov     [ebp+TZ], esi
.text:0041442D		       cmp     esi, ebx
.text:0041442F		       jz      short loc_4144AD
.text:00414431		       cmp     [esi], bl
.text:00414433		       jz      short loc_4144AD
.text:00414435		       mov     eax, lastTZ
.text:0041443A		       cmp     eax, ebx
.text:0041443C		       jz      short loc_41445F
.text:0041443E		       push    eax	       ; str2
.text:0041443F		       push    esi	       ; str1
.text:00414440		       call    _strcmp
.text:00414445		       pop     ecx
.text:00414446		       pop     ecx
.text:00414447		       test    eax, eax
.text:00414449		       jz      loc_414598
.text:0041444F		       mov     eax, lastTZ
.text:00414454		       cmp     eax, ebx
.text:00414456		       jz      short loc_41445F
.text:00414458		       push    eax	       ; pBlock
.text:00414459		       call    _free
.text:0041445E		       pop     ecx
.text:0041445F
.text:0041445F loc_41445F:			       ; CODE XREF: _tzset_nolock+C0j
.text:0041445F					       ; _tzset_nolock+DAj
.text:0041445F		       push    esi	       ; buf
.text:00414460		       call    _strlen
.text:00414465		       inc     eax
.text:00414466		       push    eax	       ; cb
.text:00414467		       call    __malloc_crt
.text:0041446C		       pop     ecx
.text:0041446D		       pop     ecx
.text:0041446E		       mov     lastTZ, eax
.text:00414473		       cmp     eax, ebx
.text:00414475		       jz      loc_414598
.text:0041447B		       push    esi	       ; _Src
.text:0041447C		       push    esi	       ; buf
.text:0041447D		       call    _strlen
.text:00414482		       pop     ecx
.text:00414483		       inc     eax
.text:00414484		       push    eax	       ; _SizeInBytes
.text:00414485		       push    lastTZ	       ; _Dst
.text:0041448B		       call    _strcpy_s
.text:00414490		       add     esp, 0Ch
.text:00414493		       cmp     eax, ebx
.text:00414495		       jz      loc_41459F
.text:0041449B		       push    ebx	       ; pReserved
.text:0041449C		       push    ebx	       ; nLine
.text:0041449D		       push    ebx	       ; pszFile
.text:0041449E		       push    ebx	       ; pszFunction
.text:0041449F		       push    ebx	       ; pszExpression
.text:004144A0		       call    __invoke_watson
.text:004144A5		       add     esp, 14h
.text:004144A8		       jmp     loc_41459F
.text:004144AD ; ---------------------------------------------------------------------------
.text:004144AD
.text:004144AD loc_4144AD:			       ; CODE XREF: _tzset_nolock+B3j
.text:004144AD					       ; _tzset_nolock+B7j
.text:004144AD		       mov     eax, lastTZ
.text:004144B2		       cmp     eax, ebx
.text:004144B4		       jz      short loc_4144C3
.text:004144B6		       push    eax	       ; pBlock
.text:004144B7		       call    _free
.text:004144BC		       pop     ecx
.text:004144BD		       mov     lastTZ, ebx
.text:004144C3
.text:004144C3 loc_4144C3:			       ; CODE XREF: _tzset_nolock+138j
.text:004144C3		       push    offset tzinfo   ; lpTimeZoneInformation
.text:004144C8		       call    ds:__imp__GetTimeZoneInformation@4 ; GetTimeZoneInformation(x)
.text:004144CE		       cmp     eax, edi
.text:004144D0		       jz      loc_414598
.text:004144D6		       xor     ecx, ecx
.text:004144D8		       inc     ecx
.text:004144D9		       mov     tzapiused, ecx
.text:004144DF		       mov     eax, tzinfo.Bias
.text:004144E4		       imul    eax, 3Ch
.text:004144E7		       mov     [ebp+timezone], eax
.text:004144EA		       cmp     tzinfo.StandardDate.wMonth, bx
.text:004144F1		       jz      short loc_414501
.text:004144F3		       mov     edx, tzinfo.StandardBias
.text:004144F9		       imul    edx, 3Ch
.text:004144FC		       add     eax, edx
.text:004144FE		       mov     [ebp+timezone], eax
.text:00414501
.text:00414501 loc_414501:			       ; CODE XREF: _tzset_nolock+175j
.text:00414501		       cmp     tzinfo.DaylightDate.wMonth, bx
.text:00414508		       jz      short loc_414524
.text:0041450A		       mov     eax, tzinfo.DaylightBias
.text:0041450F		       cmp     eax, ebx
.text:00414511		       jz      short loc_414524
.text:00414513		       mov     [ebp+daylight], ecx
.text:00414516		       sub     eax, tzinfo.StandardBias
.text:0041451C		       imul    eax, 3Ch
.text:0041451F		       mov     [ebp+dstbias], eax
.text:00414522		       jmp     short loc_41452A
.text:00414524 ; ---------------------------------------------------------------------------
.text:00414524
.text:00414524 loc_414524:			       ; CODE XREF: _tzset_nolock+18Cj
.text:00414524					       ; _tzset_nolock+195j
.text:00414524		       mov     [ebp+daylight], ebx
.text:00414527		       mov     [ebp+dstbias], ebx
.text:0041452A
.text:0041452A loc_41452A:			       ; CODE XREF: _tzset_nolock+1A6j
.text:0041452A		       lea     eax, [ebp+defused]
.text:0041452D		       push    eax	       ; lpUsedDefaultChar
.text:0041452E		       push    ebx	       ; lpDefaultChar
.text:0041452F		       push    3Fh	       ; cbMultiByte
.text:00414531		       mov     eax, [ebp+tzname]
.text:00414534		       push    dword ptr [eax] ; lpMultiByteStr
.text:00414536		       push    edi	       ; cchWideChar
.text:00414537		       push    offset tzinfo.StandardName ; lpWideCharStr
.text:0041453C		       push    ebx	       ; dwFlags
.text:0041453D		       push    [ebp+lc_cp]     ; CodePage
.text:00414540		       mov     edi, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414546		       call    edi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00414548		       test    eax, eax
.text:0041454A		       jz      short loc_41455B
.text:0041454C		       cmp     [ebp+defused], ebx
.text:0041454F		       jnz     short loc_41455B
.text:00414551		       mov     eax, [ebp+tzname]
.text:00414554		       mov     eax, [eax]
.text:00414556		       mov     [eax+3Fh], bl
.text:00414559		       jmp     short loc_414562
.text:0041455B ; ---------------------------------------------------------------------------
.text:0041455B
.text:0041455B loc_41455B:			       ; CODE XREF: _tzset_nolock+1CEj
.text:0041455B					       ; _tzset_nolock+1D3j
.text:0041455B		       mov     eax, [ebp+tzname]
.text:0041455E		       mov     eax, [eax]
.text:00414560		       mov     [eax], bl
.text:00414562
.text:00414562 loc_414562:			       ; CODE XREF: _tzset_nolock+1DDj
.text:00414562		       lea     eax, [ebp+defused]
.text:00414565		       push    eax	       ; lpUsedDefaultChar
.text:00414566		       push    ebx	       ; lpDefaultChar
.text:00414567		       push    3Fh	       ; cbMultiByte
.text:00414569		       mov     eax, [ebp+tzname]
.text:0041456C		       push    dword ptr [eax+4] ; lpMultiByteStr
.text:0041456F		       push    0FFFFFFFFh      ; cchWideChar
.text:00414571		       push    offset tzinfo.DaylightName ; lpWideCharStr
.text:00414576		       push    ebx	       ; dwFlags
.text:00414577		       push    [ebp+lc_cp]     ; CodePage
.text:0041457A		       call    edi ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0041457C		       test    eax, eax
.text:0041457E		       jz      short loc_414590
.text:00414580		       cmp     [ebp+defused], ebx
.text:00414583		       jnz     short loc_414590
.text:00414585		       mov     eax, [ebp+tzname]
.text:00414588		       mov     eax, [eax+4]
.text:0041458B		       mov     [eax+3Fh], bl
.text:0041458E		       jmp     short loc_414598
.text:00414590 ; ---------------------------------------------------------------------------
.text:00414590
.text:00414590 loc_414590:			       ; CODE XREF: _tzset_nolock+202j
.text:00414590					       ; _tzset_nolock+207j
.text:00414590		       mov     eax, [ebp+tzname]
.text:00414593		       mov     eax, [eax+4]
.text:00414596		       mov     [eax], bl
.text:00414598
.text:00414598 loc_414598:			       ; CODE XREF: _tzset_nolock+CDj
.text:00414598					       ; _tzset_nolock+F9j ...
.text:00414598		       mov     [ebp+nochange], 1
.text:0041459F
.text:0041459F loc_41459F:			       ; CODE XREF: _tzset_nolock+119j
.text:0041459F					       ; _tzset_nolock+12Cj
.text:0041459F		       mov     edi, [ebp+timezone]
.text:004145A2		       call    ___timezone
.text:004145A7		       mov     [eax], edi
.text:004145A9		       mov     edi, [ebp+daylight]
.text:004145AC		       call    ___daylight
.text:004145B1		       mov     [eax], edi
.text:004145B3		       mov     edi, [ebp+dstbias]
.text:004145B6		       call    ___dstbias
.text:004145BB		       mov     [eax], edi
.text:004145BD		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004145C4		       call    $LN38_0
.text:004145C9 ; ---------------------------------------------------------------------------
.text:004145C9
.text:004145C9 $LN39_0:
.text:004145C9		       cmp     [ebp+nochange], ebx
.text:004145CC		       jnz     loc_4146BF
.text:004145D2		       push    3	       ; _Count
.text:004145D4		       push    esi	       ; _Src
.text:004145D5		       push    40h	       ; _SizeInBytes
.text:004145D7		       mov     edi, [ebp+tzname]
.text:004145DA		       push    dword ptr [edi] ; _Dst
.text:004145DC		       call    _strncpy_s
.text:004145E1		       add     esp, 10h
.text:004145E4		       test    eax, eax
.text:004145E6		       jz      short loc_4145F5
.text:004145E8		       push    ebx	       ; pReserved
.text:004145E9		       push    ebx	       ; nLine
.text:004145EA		       push    ebx	       ; pszFile
.text:004145EB		       push    ebx	       ; pszFunction
.text:004145EC		       push    ebx	       ; pszExpression
.text:004145ED		       call    __invoke_watson
.text:004145F2		       add     esp, 14h
.text:004145F5
.text:004145F5 loc_4145F5:			       ; CODE XREF: _tzset_nolock+26Aj
.text:004145F5		       add     esi, 3
.text:004145F8		       cmp     byte ptr	[esi], 2Dh
.text:004145FB		       jnz     short loc_414605
.text:004145FD		       mov     [ebp+negdiff], 1
.text:00414604		       inc     esi
.text:00414605
.text:00414605 loc_414605:			       ; CODE XREF: _tzset_nolock+27Fj
.text:00414605		       push    esi	       ; nptr
.text:00414606		       call    _atol
.text:0041460B		       pop     ecx
.text:0041460C		       imul    eax, 0E10h
.text:00414612		       mov     [ebp+timezone], eax
.text:00414615
.text:00414615 loc_414615:			       ; CODE XREF: _tzset_nolock+2A8j
.text:00414615		       mov     al, [esi]
.text:00414617		       cmp     al, 2Bh
.text:00414619		       jz      short loc_414623
.text:0041461B		       cmp     al, 30h
.text:0041461D		       jl      short loc_414634
.text:0041461F		       cmp     al, 39h
.text:00414621		       jg      short loc_414634
.text:00414623
.text:00414623 loc_414623:			       ; CODE XREF: _tzset_nolock+29Dj
.text:00414623		       inc     esi
.text:00414624		       jmp     short loc_414615
.text:00414626 ; ---------------------------------------------------------------------------
.text:00414626
.text:00414626 $LN36_2:				       ; DATA XREF: .rdata:004219D8o
.text:00414626		       xor     ebx, ebx
.text:00414628		       mov     esi, [ebp+TZ]
.text:0041462B
.text:0041462B $LN38_0:				       ; CODE XREF: _tzset_nolock+248p
.text:0041462B		       push    7	       ; locknum
.text:0041462D		       call    __unlock
.text:00414632		       pop     ecx
.text:00414633
.text:00414633 $LN37_0:
.text:00414633		       retn
.text:00414634 ; ---------------------------------------------------------------------------
.text:00414634
.text:00414634 loc_414634:			       ; CODE XREF: _tzset_nolock+2A1j
.text:00414634					       ; _tzset_nolock+2A5j
.text:00414634		       cmp     byte ptr	[esi], 3Ah
.text:00414637		       jnz     short loc_414671
.text:00414639		       inc     esi
.text:0041463A		       push    esi	       ; nptr
.text:0041463B		       call    _atol
.text:00414640		       pop     ecx
.text:00414641		       imul    eax, 3Ch
.text:00414644		       add     [ebp+timezone], eax
.text:00414647		       jmp     short loc_41464E
.text:00414649 ; ---------------------------------------------------------------------------
.text:00414649
.text:00414649 loc_414649:			       ; CODE XREF: _tzset_nolock+2D6j
.text:00414649		       cmp     al, 39h
.text:0041464B		       jg      short loc_414654
.text:0041464D		       inc     esi
.text:0041464E
.text:0041464E loc_41464E:			       ; CODE XREF: _tzset_nolock+2CBj
.text:0041464E		       mov     al, [esi]
.text:00414650		       cmp     al, 30h
.text:00414652		       jge     short loc_414649
.text:00414654
.text:00414654 loc_414654:			       ; CODE XREF: _tzset_nolock+2CFj
.text:00414654		       cmp     byte ptr	[esi], 3Ah
.text:00414657		       jnz     short loc_414671
.text:00414659		       inc     esi
.text:0041465A		       push    esi	       ; nptr
.text:0041465B		       call    _atol
.text:00414660		       pop     ecx
.text:00414661		       add     [ebp+timezone], eax
.text:00414664		       jmp     short loc_41466B
.text:00414666 ; ---------------------------------------------------------------------------
.text:00414666
.text:00414666 loc_414666:			       ; CODE XREF: _tzset_nolock+2F3j
.text:00414666		       cmp     al, 39h
.text:00414668		       jg      short loc_414671
.text:0041466A		       inc     esi
.text:0041466B
.text:0041466B loc_41466B:			       ; CODE XREF: _tzset_nolock+2E8j
.text:0041466B		       mov     al, [esi]
.text:0041466D		       cmp     al, 30h
.text:0041466F		       jge     short loc_414666
.text:00414671
.text:00414671 loc_414671:			       ; CODE XREF: _tzset_nolock+2BBj
.text:00414671					       ; _tzset_nolock+2DBj ...
.text:00414671		       cmp     [ebp+negdiff], ebx
.text:00414674		       jz      short loc_414679
.text:00414676		       neg     [ebp+timezone]
.text:00414679
.text:00414679 loc_414679:			       ; CODE XREF: _tzset_nolock+2F8j
.text:00414679		       movsx   eax, byte ptr [esi]
.text:0041467C		       mov     [ebp+daylight], eax
.text:0041467F		       cmp     eax, ebx
.text:00414681		       jz      short loc_4146A6
.text:00414683		       push    3	       ; _Count
.text:00414685		       push    esi	       ; _Src
.text:00414686		       push    40h	       ; _SizeInBytes
.text:00414688		       push    dword ptr [edi+4] ; _Dst
.text:0041468B		       call    _strncpy_s
.text:00414690		       add     esp, 10h
.text:00414693		       test    eax, eax
.text:00414695		       jz      short loc_4146AB
.text:00414697		       push    ebx	       ; pReserved
.text:00414698		       push    ebx	       ; nLine
.text:00414699		       push    ebx	       ; pszFile
.text:0041469A		       push    ebx	       ; pszFunction
.text:0041469B		       push    ebx	       ; pszExpression
.text:0041469C		       call    __invoke_watson
.text:004146A1		       add     esp, 14h
.text:004146A4		       jmp     short loc_4146AB
.text:004146A6 ; ---------------------------------------------------------------------------
.text:004146A6
.text:004146A6 loc_4146A6:			       ; CODE XREF: _tzset_nolock+305j
.text:004146A6		       mov     eax, [edi+4]
.text:004146A9		       mov     [eax], bl
.text:004146AB
.text:004146AB loc_4146AB:			       ; CODE XREF: _tzset_nolock+319j
.text:004146AB					       ; _tzset_nolock+328j
.text:004146AB		       mov     esi, [ebp+timezone]
.text:004146AE		       call    ___timezone
.text:004146B3		       mov     [eax], esi
.text:004146B5		       mov     esi, [ebp+daylight]
.text:004146B8		       call    ___daylight
.text:004146BD		       mov     [eax], esi
.text:004146BF
.text:004146BF loc_4146BF:			       ; CODE XREF: _tzset_nolock+250j
.text:004146BF		       call    __SEH_epilog4
.text:004146C4		       retn
.text:004146C4 _tzset_nolock   endp ; sp-analysis failed
.text:004146C4
.text:004146C5
.text:004146C5 ; =============== S U B R O U T I N E =======================================
.text:004146C5
.text:004146C5 ; Attributes: bp-based frame
.text:004146C5
.text:004146C5 ; void __usercall cvtdate(int trantype, int datetype, int year, int month<eax>, int week, int dayofweek,	int date, int hour<ecx>, int min, int sec, int msec)
.text:004146C5 cvtdate	       proc near	       ; CODE XREF: _isindst_nolock+ABp
.text:004146C5					       ; _isindst_nolock+108p ...
.text:004146C5
.text:004146C5 var_C	       = dword ptr -0Ch
.text:004146C5 var_8	       = dword ptr -8
.text:004146C5 dstbias	       = dword ptr -4
.text:004146C5 trantype	       = dword ptr  8
.text:004146C5 datetype	       = dword ptr  0Ch
.text:004146C5 year	       = dword ptr  10h
.text:004146C5 week	       = dword ptr  14h
.text:004146C5 dayofweek       = dword ptr  18h
.text:004146C5 date	       = dword ptr  1Ch
.text:004146C5 min	       = dword ptr  20h
.text:004146C5 sec	       = dword ptr  24h
.text:004146C5 msec	       = dword ptr  28h
.text:004146C5
.text:004146C5 month = eax
.text:004146C5 hour = ecx
.text:004146C5		       push    ebp
.text:004146C6		       mov     ebp, esp
.text:004146C8		       sub     esp, 0Ch
.text:004146CB		       and     [ebp+dstbias], 0
.text:004146CF		       cmp     [ebp+datetype], 1
.text:004146D3		       push    ebx
.text:004146D4		       push    esi
.text:004146D5		       push    edi
.text:004146D6		       mov     edi, [ebp+year]
.text:004146D9		       mov     esi, month
.text:004146DB		       mov     month, edi
.text:004146DD		       jnz     loc_4147DC
.text:004146E3		       and     month, 80000003h
.text:004146E8		       jns     short loc_4146EF
.text:004146EA		       dec     month
.text:004146EB		       or      month, 0FFFFFFFCh
.text:004146EE		       inc     month
.text:004146EF
.text:004146EF loc_4146EF:			       ; CODE XREF: cvtdate+23j
.text:004146EF		       mov     [ebp+var_C], month
.text:004146F2		       jnz     short loc_414700
.text:004146F4		       mov     month, edi
.text:004146F6		       push    64h
.text:004146F8		       cdq
.text:004146F9		       pop     ebx
.text:004146FA		       idiv    ebx
.text:004146FC		       test    edx, edx
.text:004146FE		       jnz     short loc_41471F
.text:00414700
.text:00414700 loc_414700:			       ; CODE XREF: cvtdate+2Dj
.text:00414700		       lea     month, [edi+76Ch]
.text:00414706		       cdq
.text:00414707		       mov     ebx, 190h
.text:0041470C		       idiv    ebx
.text:0041470E		       test    edx, edx
.text:00414710		       jz      short loc_41471F
.text:00414712		       mov     month, esi
.text:00414714		       shl     month, 2
.text:00414717		       mov     esi, dword_422FA8[month]
.text:0041471D		       jmp     short loc_41472A
.text:0041471F ; ---------------------------------------------------------------------------
.text:0041471F
.text:0041471F loc_41471F:			       ; CODE XREF: cvtdate+39j
.text:0041471F					       ; cvtdate+4Bj
.text:0041471F		       mov     month, esi
.text:00414721		       shl     month, 2
.text:00414724		       mov     esi, __confh[month]
.text:0041472A
.text:0041472A loc_41472A:			       ; CODE XREF: cvtdate+58j
.text:0041472A		       mov     [ebp+datetype], month
.text:0041472D		       lea     month, [edi+12Bh]
.text:00414733		       cdq
.text:00414734		       lea     ebx, [edi-1]
.text:00414737		       mov     edi, 190h
.text:0041473C		       idiv    edi
.text:0041473E		       push    64h
.text:00414740		       pop     edi
.text:00414741		       inc     esi
.text:00414742		       push    7
.text:00414744		       mov     [ebp+var_8], month
.text:00414747		       mov     month, ebx
.text:00414749		       cdq
.text:0041474A		       idiv    edi
.text:0041474C		       mov     edx, [ebp+var_8]
.text:0041474F		       mov     edi, [ebp+year]
.text:00414752		       sub     edx, month
.text:00414754		       mov     ebx, edx
.text:00414756		       lea     month, [edi-1]
.text:00414759		       cdq
.text:0041475A		       and     edx, 3
.text:0041475D		       add     month, edx
.text:0041475F		       sar     month, 2
.text:00414762		       mov     edx, edi
.text:00414764		       imul    edx, 16Dh
.text:0041476A		       add     month, esi
.text:0041476C		       add     month, ebx
.text:0041476E		       lea     month, [edx+month-63DBh]
.text:00414775		       cdq
.text:00414776		       pop     ebx
.text:00414777		       idiv    ebx
.text:00414779		       mov     month, [ebp+week]
.text:0041477C		       imul    month, 7
.text:0041477F		       sub     month, edx
.text:00414781		       add     month, [ebp+dayofweek]
.text:00414784		       cmp     edx, [ebp+dayofweek]
.text:00414787		       jg      short loc_41478F
.text:00414789		       lea     esi, [esi+month-7]
.text:0041478D		       jmp     short loc_414791
.text:0041478F ; ---------------------------------------------------------------------------
.text:0041478F
.text:0041478F loc_41478F:			       ; CODE XREF: cvtdate+C2j
.text:0041478F		       add     esi, month
.text:00414791
.text:00414791 loc_414791:			       ; CODE XREF: cvtdate+C8j
.text:00414791		       cmp     [ebp+week], 5
.text:00414795		       jnz     loc_41481B
.text:0041479B		       cmp     [ebp+var_C], 0
.text:0041479F		       jnz     short loc_4147AD
.text:004147A1		       mov     month, edi
.text:004147A3		       push    64h
.text:004147A5		       cdq
.text:004147A6		       pop     ebx
.text:004147A7		       idiv    ebx
.text:004147A9		       test    edx, edx
.text:004147AB		       jnz     short loc_4147CA
.text:004147AD
.text:004147AD loc_4147AD:			       ; CODE XREF: cvtdate+DAj
.text:004147AD		       lea     month, [edi+76Ch]
.text:004147B3		       cdq
.text:004147B4		       mov     ebx, 190h
.text:004147B9		       idiv    ebx
.text:004147BB		       test    edx, edx
.text:004147BD		       jz      short loc_4147CA
.text:004147BF		       mov     month, [ebp+datetype]
.text:004147C2		       mov     month, __days[month]
.text:004147C8		       jmp     short loc_4147D3
.text:004147CA ; ---------------------------------------------------------------------------
.text:004147CA
.text:004147CA loc_4147CA:			       ; CODE XREF: cvtdate+E6j
.text:004147CA					       ; cvtdate+F8j
.text:004147CA		       mov     month, [ebp+datetype]
.text:004147CD		       mov     month, __lpdays[month]
.text:004147D3
.text:004147D3 loc_4147D3:			       ; CODE XREF: cvtdate+103j
.text:004147D3		       cmp     esi, month
.text:004147D5		       jle     short loc_41481B
.text:004147D7		       sub     esi, 7
.text:004147DA		       jmp     short loc_41481B
.text:004147DC ; ---------------------------------------------------------------------------
.text:004147DC
.text:004147DC loc_4147DC:			       ; CODE XREF: cvtdate+18j
.text:004147DC		       and     month, 80000003h
.text:004147E1		       jns     short loc_4147E8
.text:004147E3		       dec     month
.text:004147E4		       or      month, 0FFFFFFFCh
.text:004147E7		       inc     month
.text:004147E8
.text:004147E8 loc_4147E8:			       ; CODE XREF: cvtdate+11Cj
.text:004147E8		       jnz     short loc_4147F6
.text:004147EA		       mov     month, edi
.text:004147EC		       push    64h
.text:004147EE		       cdq
.text:004147EF		       pop     ebx
.text:004147F0		       idiv    ebx
.text:004147F2		       test    edx, edx
.text:004147F4		       jnz     short loc_414811
.text:004147F6
.text:004147F6 loc_4147F6:			       ; CODE XREF: cvtdate:loc_4147E8j
.text:004147F6		       lea     month, [edi+76Ch]
.text:004147FC		       cdq
.text:004147FD		       mov     ebx, 190h
.text:00414802		       idiv    ebx
.text:00414804		       test    edx, edx
.text:00414806		       jz      short loc_414811
.text:00414808		       mov     esi, dword_422FA8[esi*4]
.text:0041480F		       jmp     short loc_414818
.text:00414811 ; ---------------------------------------------------------------------------
.text:00414811
.text:00414811 loc_414811:			       ; CODE XREF: cvtdate+12Fj
.text:00414811					       ; cvtdate+141j
.text:00414811		       mov     esi, __confh[esi*4]
.text:00414818
.text:00414818 loc_414818:			       ; CODE XREF: cvtdate+14Aj
.text:00414818		       add     esi, [ebp+date]
.text:0041481B
.text:0041481B loc_41481B:			       ; CODE XREF: cvtdate+D0j
.text:0041481B					       ; cvtdate+110j ...
.text:0041481B		       imul    hour, 3Ch
.text:0041481E		       add     hour, [ebp+min]
.text:00414821		       imul    hour, 3Ch
.text:00414824		       add     hour, [ebp+sec]
.text:00414827		       imul    hour, 3E8h
.text:0041482D		       add     hour, [ebp+msec]
.text:00414830		       cmp     [ebp+trantype], 1
.text:00414834		       jnz     short loc_41484A
.text:00414836		       mov     dststart.yd, esi
.text:0041483C		       mov     dststart.ms, hour
.text:00414842		       mov     dststart.yr, edi
.text:00414848		       jmp     short loc_4148B5
.text:0041484A ; ---------------------------------------------------------------------------
.text:0041484A
.text:0041484A loc_41484A:			       ; CODE XREF: cvtdate+16Fj
.text:0041484A		       lea     month, [ebp+dstbias]
.text:0041484D		       push    month	       ; _Daylight_savings_bias
.text:0041484E		       mov     dstend.yd, esi
.text:00414854		       mov     dstend.ms, hour
.text:0041485A		       call    __get_dstbias
.text:0041485F		       test    month, month
.text:00414861		       pop     hour
.text:00414862		       jz      short loc_414873
.text:00414864		       xor     month, month
.text:00414866		       push    month	       ; pReserved
.text:00414867		       push    month	       ; nLine
.text:00414868		       push    month	       ; pszFile
.text:00414869		       push    month	       ; pszFunction
.text:0041486A		       push    month	       ; pszExpression
.text:0041486B		       call    __invoke_watson
.text:00414870		       add     esp, 14h
.text:00414873
.text:00414873 loc_414873:			       ; CODE XREF: cvtdate+19Dj
.text:00414873		       mov     month, [ebp+dstbias]
.text:00414876		       imul    month, 3E8h
.text:0041487C		       add     dstend.ms, month
.text:00414882		       jns     short loc_414896
.text:00414884		       add     dstend.ms, 5265C00h
.text:0041488E		       dec     dstend.yd
.text:00414894		       jmp     short loc_4148AF
.text:00414896 ; ---------------------------------------------------------------------------
.text:00414896
.text:00414896 loc_414896:			       ; CODE XREF: cvtdate+1BDj
.text:00414896		       mov     month, 5265C00h
.text:0041489B		       cmp     dstend.ms, month
.text:004148A1		       jl      short loc_4148AF
.text:004148A3		       sub     dstend.ms, month
.text:004148A9		       inc     dstend.yd
.text:004148AF
.text:004148AF loc_4148AF:			       ; CODE XREF: cvtdate+1CFj
.text:004148AF					       ; cvtdate+1DCj
.text:004148AF		       mov     dstend.yr, edi
.text:004148B5
.text:004148B5 loc_4148B5:			       ; CODE XREF: cvtdate+183j
.text:004148B5		       pop     edi
.text:004148B6		       pop     esi
.text:004148B7		       pop     ebx
.text:004148B8		       leave
.text:004148B9		       retn
.text:004148B9 cvtdate	       endp
.text:004148B9
.text:004148BA
.text:004148BA ; =============== S U B R O U T I N E =======================================
.text:004148BA
.text:004148BA ; Attributes: bp-based frame
.text:004148BA
.text:004148BA ; int __usercall	isindst_nolock<eax>(tm *tb<edi>)
.text:004148BA _isindst_nolock proc near	       ; CODE XREF: __isindst+1Bp
.text:004148BA
.text:004148BA endmonth	       = dword ptr -0Ch
.text:004148BA endweek	       = dword ptr -8
.text:004148BA daylight	       = dword ptr -4
.text:004148BA
.text:004148BA tb = edi
.text:004148BA		       push    ebp
.text:004148BB		       mov     ebp, esp
.text:004148BD		       sub     esp, 0Ch
.text:004148C0		       push    esi
.text:004148C1		       lea     eax, [ebp+daylight]
.text:004148C4		       xor     esi, esi
.text:004148C6		       push    eax	       ; _Daylight
.text:004148C7		       mov     [ebp+daylight], esi
.text:004148CA		       call    __get_daylight
.text:004148CF		       test    eax, eax
.text:004148D1		       pop     ecx
.text:004148D2		       jz      short loc_4148E1
.text:004148D4		       push    esi	       ; pReserved
.text:004148D5		       push    esi	       ; nLine
.text:004148D6		       push    esi	       ; pszFile
.text:004148D7		       push    esi	       ; pszFunction
.text:004148D8		       push    esi	       ; pszExpression
.text:004148D9		       call    __invoke_watson
.text:004148DE		       add     esp, 14h
.text:004148E1
.text:004148E1 loc_4148E1:			       ; CODE XREF: _isindst_nolock+18j
.text:004148E1		       cmp     [ebp+daylight], esi
.text:004148E4		       jnz     short loc_4148ED
.text:004148E6		       xor     eax, eax
.text:004148E8		       jmp     loc_414A45
.text:004148ED ; ---------------------------------------------------------------------------
.text:004148ED
.text:004148ED loc_4148ED:			       ; CODE XREF: _isindst_nolock+2Aj
.text:004148ED		       mov     edx, [tb+14h]
.text:004148F0		       push    ebx
.text:004148F1		       xor     ebx, ebx
.text:004148F3		       inc     ebx
.text:004148F4		       cmp     edx, dststart.yr
.text:004148FA		       jnz     short loc_414908
.text:004148FC		       cmp     edx, dstend.yr
.text:00414902		       jz      loc_414A20
.text:00414908
.text:00414908 loc_414908:			       ; CODE XREF: _isindst_nolock+40j
.text:00414908		       cmp     tzapiused, esi
.text:0041490E		       jz      loc_4149CC
.text:00414914		       cmp     tzinfo.DaylightDate.wYear, si
.text:0041491B		       movzx   eax, tzinfo.DaylightDate.wMilliseconds ;	month
.text:00414922		       movzx   ecx, tzinfo.DaylightDate.wHour ;	hour
.text:00414929		       push    eax	       ; msec
.text:0041492A		       movzx   eax, tzinfo.DaylightDate.wSecond
.text:00414931		       push    eax	       ; sec
.text:00414932		       movzx   eax, tzinfo.DaylightDate.wMinute
.text:00414939		       push    eax	       ; min
.text:0041493A		       jnz     short loc_414951
.text:0041493C		       movzx   eax, tzinfo.DaylightDate.wDayOfWeek
.text:00414943		       push    esi
.text:00414944		       push    eax
.text:00414945		       movzx   eax, tzinfo.DaylightDate.wDay
.text:0041494C		       push    eax
.text:0041494D		       push    edx
.text:0041494E		       push    ebx
.text:0041494F		       jmp     short loc_41495D
.text:00414951 ; ---------------------------------------------------------------------------
.text:00414951
.text:00414951 loc_414951:			       ; CODE XREF: _isindst_nolock+80j
.text:00414951		       movzx   eax, tzinfo.DaylightDate.wDay
.text:00414958		       push    eax	       ; date
.text:00414959		       push    esi	       ; dayofweek
.text:0041495A		       push    esi	       ; week
.text:0041495B		       push    edx	       ; year
.text:0041495C		       push    esi	       ; datetype
.text:0041495D
.text:0041495D loc_41495D:			       ; CODE XREF: _isindst_nolock+95j
.text:0041495D		       movzx   eax, tzinfo.DaylightDate.wMonth ; month
.text:00414964		       push    ebx	       ; trantype
.text:00414965		       call    cvtdate
.text:0041496A		       movzx   eax, tzinfo.StandardDate.wMilliseconds
.text:00414971		       movzx   ecx, tzinfo.StandardDate.wHour
.text:00414978		       add     esp, 24h
.text:0041497B		       cmp     tzinfo.StandardDate.wYear, si
.text:00414982		       push    eax	       ; msec
.text:00414983		       movzx   eax, tzinfo.StandardDate.wSecond
.text:0041498A		       push    eax	       ; sec
.text:0041498B		       movzx   eax, tzinfo.StandardDate.wMinute
.text:00414992		       push    eax	       ; min
.text:00414993		       jnz     short loc_4149AC
.text:00414995		       movzx   eax, tzinfo.StandardDate.wDayOfWeek
.text:0041499C		       push    esi
.text:0041499D		       push    eax
.text:0041499E		       movzx   eax, tzinfo.StandardDate.wDay
.text:004149A5		       push    eax
.text:004149A6		       push    dword ptr [tb+14h]
.text:004149A9		       push    ebx
.text:004149AA		       jmp     short loc_4149BA
.text:004149AC ; ---------------------------------------------------------------------------
.text:004149AC
.text:004149AC loc_4149AC:			       ; CODE XREF: _isindst_nolock+D9j
.text:004149AC		       movzx   eax, tzinfo.StandardDate.wDay
.text:004149B3		       push    eax	       ; date
.text:004149B4		       push    esi	       ; dayofweek
.text:004149B5		       push    esi	       ; week
.text:004149B6		       push    dword ptr [tb+14h] ; year
.text:004149B9		       push    esi	       ; datetype
.text:004149BA
.text:004149BA loc_4149BA:			       ; CODE XREF: _isindst_nolock+F0j
.text:004149BA		       movzx   eax, tzinfo.StandardDate.wMonth ; month
.text:004149C1		       push    esi	       ; trantype
.text:004149C2		       call    cvtdate
.text:004149C7		       add     esp, 24h
.text:004149CA		       jmp     short loc_414A20
.text:004149CC ; ---------------------------------------------------------------------------
.text:004149CC
.text:004149CC loc_4149CC:			       ; CODE XREF: _isindst_nolock+54j
.text:004149CC		       cmp     edx, 6Bh
.text:004149CF		       push    3
.text:004149D1		       pop     eax
.text:004149D2		       push    2
.text:004149D4		       pop     ecx
.text:004149D5		       mov     [ebp+endmonth], 0Bh
.text:004149DC		       mov     [ebp+endweek], ebx
.text:004149DF		       jge     short loc_4149F4
.text:004149E1		       push    4
.text:004149E3		       pop     eax
.text:004149E4		       mov     ecx, ebx	       ; hour
.text:004149E6		       mov     [ebp+endmonth], 0Ah
.text:004149ED		       mov     [ebp+endweek], 5
.text:004149F4
.text:004149F4 loc_4149F4:			       ; CODE XREF: _isindst_nolock+125j
.text:004149F4		       push    esi	       ; msec
.text:004149F5		       push    esi	       ; sec
.text:004149F6		       push    esi	       ; min
.text:004149F7		       push    esi	       ; date
.text:004149F8		       push    esi	       ; dayofweek
.text:004149F9		       push    ecx	       ; week
.text:004149FA		       push    edx	       ; year
.text:004149FB		       push    ebx	       ; datetype
.text:004149FC		       push    ebx	       ; trantype
.text:004149FD		       push    2
.text:004149FF		       pop     ecx
.text:00414A00		       call    cvtdate
.text:00414A05		       mov     eax, [ebp+endmonth] ; month
.text:00414A08		       push    esi	       ; msec
.text:00414A09		       push    esi	       ; sec
.text:00414A0A		       push    esi	       ; min
.text:00414A0B		       push    esi	       ; date
.text:00414A0C		       push    esi	       ; dayofweek
.text:00414A0D		       push    [ebp+endweek]   ; week
.text:00414A10		       push    dword ptr [tb+14h] ; year
.text:00414A13		       push    ebx	       ; datetype
.text:00414A14		       push    esi	       ; trantype
.text:00414A15		       push    2
.text:00414A17		       pop     ecx
.text:00414A18		       call    cvtdate
.text:00414A1D		       add     esp, 48h
.text:00414A20
.text:00414A20 loc_414A20:			       ; CODE XREF: _isindst_nolock+48j
.text:00414A20					       ; _isindst_nolock+110j
.text:00414A20		       mov     ecx, dststart.yd
.text:00414A26		       mov     eax, dstend.yd
.text:00414A2B		       cmp     ecx, eax
.text:00414A2D		       mov     edx, [tb+1Ch]
.text:00414A30		       jge     short loc_414A48
.text:00414A32		       cmp     edx, ecx
.text:00414A34		       jl      short loc_414A58
.text:00414A36		       cmp     edx, eax
.text:00414A38		       jg      short loc_414A58
.text:00414A3A		       cmp     edx, ecx
.text:00414A3C		       jle     short loc_414A5C
.text:00414A3E		       cmp     edx, eax
.text:00414A40		       jge     short loc_414A5C
.text:00414A42
.text:00414A42 loc_414A42:			       ; CODE XREF: _isindst_nolock+190j
.text:00414A42					       ; _isindst_nolock+194j
.text:00414A42		       mov     eax, ebx
.text:00414A44
.text:00414A44 loc_414A44:			       ; CODE XREF: _isindst_nolock+1A0j
.text:00414A44					       ; _isindst_nolock+1D4j
.text:00414A44		       pop     ebx
.text:00414A45
.text:00414A45 loc_414A45:			       ; CODE XREF: _isindst_nolock+2Ej
.text:00414A45		       pop     esi
.text:00414A46		       leave
.text:00414A47		       retn
.text:00414A48 ; ---------------------------------------------------------------------------
.text:00414A48
.text:00414A48 loc_414A48:			       ; CODE XREF: _isindst_nolock+176j
.text:00414A48		       cmp     edx, eax
.text:00414A4A		       jl      short loc_414A42
.text:00414A4C		       cmp     edx, ecx
.text:00414A4E		       jg      short loc_414A42
.text:00414A50		       cmp     edx, eax
.text:00414A52		       jle     short loc_414A5C
.text:00414A54		       cmp     edx, ecx
.text:00414A56		       jge     short loc_414A5C
.text:00414A58
.text:00414A58 loc_414A58:			       ; CODE XREF: _isindst_nolock+17Aj
.text:00414A58					       ; _isindst_nolock+17Ej
.text:00414A58		       xor     eax, eax
.text:00414A5A		       jmp     short loc_414A44
.text:00414A5C ; ---------------------------------------------------------------------------
.text:00414A5C
.text:00414A5C loc_414A5C:			       ; CODE XREF: _isindst_nolock+182j
.text:00414A5C					       ; _isindst_nolock+186j ...
.text:00414A5C		       mov     eax, [tb+8]
.text:00414A5F		       imul    eax, 3Ch
.text:00414A62		       add     eax, [tb+4]
.text:00414A65		       imul    eax, 3Ch
.text:00414A68		       add     eax, [tb]
.text:00414A6A		       imul    eax, 3E8h
.text:00414A70		       cmp     edx, ecx
.text:00414A72		       jnz     short loc_414A81
.text:00414A74		       xor     ecx, ecx
.text:00414A76		       cmp     eax, dststart.ms
.text:00414A7C		       setnl   cl
.text:00414A7F		       jmp     short loc_414A8C
.text:00414A81 ; ---------------------------------------------------------------------------
.text:00414A81
.text:00414A81 loc_414A81:			       ; CODE XREF: _isindst_nolock+1B8j
.text:00414A81		       xor     ecx, ecx
.text:00414A83		       cmp     eax, dstend.ms
.text:00414A89		       setl    cl
.text:00414A8C
.text:00414A8C loc_414A8C:			       ; CODE XREF: _isindst_nolock+1C5j
.text:00414A8C		       mov     eax, ecx
.text:00414A8E		       jmp     short loc_414A44
.text:00414A8E _isindst_nolock endp
.text:00414A8E
.text:00414A90
.text:00414A90 ; =============== S U B R O U T I N E =======================================
.text:00414A90
.text:00414A90 ; Attributes: bp-based frame
.text:00414A90
.text:00414A90 ___tzset	       proc near	       ; CODE XREF: _expandtime:loc_40EF4Ap
.text:00414A90
.text:00414A90 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00414A90
.text:00414A90		       push    8
.text:00414A92		       push    offset dword_4219E0
.text:00414A97		       call    __SEH_prolog4
.text:00414A9C		       xor     esi, esi
.text:00414A9E		       cmp     first_time, esi
.text:00414AA4		       jnz     short $LN10_8
.text:00414AA6		       push    6	       ; locknum
.text:00414AA8		       call    __lock
.text:00414AAD		       pop     ecx
.text:00414AAE		       mov     [ebp+ms_exc.disabled], esi
.text:00414AB1		       cmp     first_time, esi
.text:00414AB7		       jnz     short loc_414AC4
.text:00414AB9		       call    _tzset_nolock
.text:00414ABE ; ---------------------------------------------------------------------------
.text:00414ABE		       inc     first_time
.text:00414AC4
.text:00414AC4 loc_414AC4:			       ; CODE XREF: ___tzset+27j
.text:00414AC4		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00414ACB		       call    $LN7_8
.text:00414AD0
.text:00414AD0 $LN10_8:				       ; CODE XREF: ___tzset+14j
.text:00414AD0		       call    __SEH_epilog4
.text:00414AD5		       retn
.text:00414AD6 ; ---------------------------------------------------------------------------
.text:00414AD6
.text:00414AD6 $LN7_8:				       ; CODE XREF: ___tzset+3Bp
.text:00414AD6					       ; DATA XREF: .rdata:004219F8o
.text:00414AD6		       push    6	       ; locknum
.text:00414AD8		       call    __unlock
.text:00414ADD		       pop     ecx
.text:00414ADE
.text:00414ADE $LN8_6:
.text:00414ADE		       retn
.text:00414ADE ___tzset	       endp
.text:00414ADE
.text:00414ADF
.text:00414ADF ; =============== S U B R O U T I N E =======================================
.text:00414ADF
.text:00414ADF ; Attributes: noreturn bp-based frame
.text:00414ADF
.text:00414ADF ; void __cdecl _tzset()
.text:00414ADF __tzset	       proc near
.text:00414ADF
.text:00414ADF ms_exc	       = CPPEH_RECORD ptr -18h
.text:00414ADF
.text:00414ADF		       push    8
.text:00414AE1		       push    offset dword_421A00
.text:00414AE6		       call    __SEH_prolog4
.text:00414AEB		       push    6	       ; locknum
.text:00414AED		       call    __lock
.text:00414AF2		       pop     ecx
.text:00414AF3		       and     [ebp+ms_exc.disabled], 0
.text:00414AF7		       call    _tzset_nolock
.text:00414AFC ; ---------------------------------------------------------------------------
.text:00414AFC		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00414B03		       call    $LN5_1
.text:00414B08 ; ---------------------------------------------------------------------------
.text:00414B08
.text:00414B08 $LN8_7:
.text:00414B08		       call    __SEH_epilog4
.text:00414B0D		       retn
.text:00414B0E ; ---------------------------------------------------------------------------
.text:00414B0E
.text:00414B0E $LN5_1:				       ; CODE XREF: __tzset+24p
.text:00414B0E					       ; DATA XREF: .rdata:00421A18o
.text:00414B0E		       push    6	       ; locknum
.text:00414B10		       call    __unlock
.text:00414B15		       pop     ecx
.text:00414B16
.text:00414B16 $LN6_9:
.text:00414B16		       retn
.text:00414B16 __tzset	       endp
.text:00414B16
.text:00414B17
.text:00414B17 ; =============== S U B R O U T I N E =======================================
.text:00414B17
.text:00414B17 ; Attributes: noreturn bp-based frame
.text:00414B17
.text:00414B17 ; int __cdecl _isindst(tm *tb)
.text:00414B17 __isindst       proc near
.text:00414B17
.text:00414B17 retval	       = dword ptr -1Ch
.text:00414B17 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00414B17 tb	       = dword ptr  8
.text:00414B17
.text:00414B17		       push    0Ch
.text:00414B19		       push    offset dword_421A20
.text:00414B1E		       call    __SEH_prolog4
.text:00414B23		       push    6	       ; locknum
.text:00414B25		       call    __lock
.text:00414B2A		       pop     ecx
.text:00414B2B		       and     [ebp+ms_exc.disabled], 0
.text:00414B2F		       mov     edi, [ebp+tb]   ; tb
.text:00414B32		       call    _isindst_nolock
.text:00414B37		       mov     [ebp+retval], eax
.text:00414B3A		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00414B41		       call    $LN5_2
.text:00414B46 ; ---------------------------------------------------------------------------
.text:00414B46
.text:00414B46 $LN8_8:
.text:00414B46		       mov     eax, [ebp+retval]
.text:00414B49		       call    __SEH_epilog4
.text:00414B4E		       retn
.text:00414B4F ; ---------------------------------------------------------------------------
.text:00414B4F
.text:00414B4F $LN5_2:				       ; CODE XREF: __isindst+2Ap
.text:00414B4F					       ; DATA XREF: .rdata:00421A38o
.text:00414B4F		       push    6	       ; locknum
.text:00414B51		       call    __unlock
.text:00414B56		       pop     ecx
.text:00414B57
.text:00414B57 $LN6_10:
.text:00414B57		       retn
.text:00414B57 __isindst       endp
.text:00414B57
.text:00414B58
.text:00414B58 ; =============== S U B R O U T I N E =======================================
.text:00414B58
.text:00414B58
.text:00414B58 ; int __cdecl __ascii_stricmp(const char	*dst, const char *src)
.text:00414B58 ___ascii_stricmp	proc near	       ; CODE XREF: _store_winword+22Ap
.text:00414B58					       ; _store_winword+240p ...
.text:00414B58
.text:00414B58 dst	       = dword ptr  4
.text:00414B58 src	       = dword ptr  8
.text:00414B58
.text:00414B58		       mov     edx, [esp+src]
.text:00414B5C		       push    esi
.text:00414B5D		       mov     esi, [esp+4+dst]
.text:00414B61		       push    edi
.text:00414B62
.text:00414B62 loc_414B62:			       ; CODE XREF: ___ascii_stricmp+2Ej
.text:00414B62		       movzx   eax, byte ptr [esi]
.text:00414B65		       lea     ecx, [eax-41h]
.text:00414B68		       inc     esi
.text:00414B69		       cmp     ecx, 19h
.text:00414B6C		       ja      short loc_414B71
.text:00414B6E		       add     eax, 20h
.text:00414B71
.text:00414B71 loc_414B71:			       ; CODE XREF: ___ascii_stricmp+14j
.text:00414B71		       movzx   ecx, byte ptr [edx]
.text:00414B74		       lea     edi, [ecx-41h]
.text:00414B77		       inc     edx
.text:00414B78		       cmp     edi, 19h
.text:00414B7B		       ja      short loc_414B80
.text:00414B7D		       add     ecx, 20h
.text:00414B80
.text:00414B80 loc_414B80:			       ; CODE XREF: ___ascii_stricmp+23j
.text:00414B80		       test    eax, eax
.text:00414B82		       jz      short loc_414B88
.text:00414B84		       cmp     eax, ecx
.text:00414B86		       jz      short loc_414B62
.text:00414B88
.text:00414B88 loc_414B88:			       ; CODE XREF: ___ascii_stricmp+2Aj
.text:00414B88		       pop     edi
.text:00414B89		       sub     eax, ecx
.text:00414B8B		       pop     esi
.text:00414B8C		       retn
.text:00414B8C ___ascii_stricmp	endp
.text:00414B8C
.text:00414B8D
.text:00414B8D ; =============== S U B R O U T I N E =======================================
.text:00414B8D
.text:00414B8D ; Attributes: bp-based frame
.text:00414B8D
.text:00414B8D ; int __cdecl _stricmp_l(const char *dst, const char *src, localeinfo_struct *plocinfo)
.text:00414B8D __stricmp_l     proc near	       ; CODE XREF: __stricmp+45p
.text:00414B8D
.text:00414B8D _loc_update     = _LocaleUpdate ptr -10h
.text:00414B8D dst	       = dword ptr  8
.text:00414B8D src	       = dword ptr  0Ch
.text:00414B8D plocinfo	       = dword ptr  10h
.text:00414B8D
.text:00414B8D		       push    ebp
.text:00414B8E		       mov     ebp, esp
.text:00414B90		       sub     esp, 10h
.text:00414B93		       push    ebx
.text:00414B94		       push    [ebp+plocinfo]  ; plocinfo
.text:00414B97		       lea     ecx, [ebp+_loc_update] ;	this
.text:00414B9A		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00414B9F		       xor     ebx, ebx
.text:00414BA1		       cmp     [ebp+dst], ebx
.text:00414BA4		       jnz     short loc_414BD4
.text:00414BA6		       call    __errno
.text:00414BAB		       push    ebx	       ; pReserved
.text:00414BAC		       push    ebx	       ; nLine
.text:00414BAD		       push    ebx	       ; pszFile
.text:00414BAE		       push    ebx	       ; pszFunction
.text:00414BAF		       push    ebx	       ; pszExpression
.text:00414BB0		       mov     dword ptr [eax],	16h
.text:00414BB6		       call    __invalid_parameter
.text:00414BBB		       add     esp, 14h
.text:00414BBE		       cmp     [ebp+_loc_update.updated], bl
.text:00414BC1		       jz      short loc_414BCA
.text:00414BC3		       mov     eax, [ebp+_loc_update.ptd]
.text:00414BC6		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00414BCA
.text:00414BCA loc_414BCA:			       ; CODE XREF: __stricmp_l+34j
.text:00414BCA		       mov     eax, 7FFFFFFFh
.text:00414BCF		       jmp     loc_414C5D
.text:00414BD4 ; ---------------------------------------------------------------------------
.text:00414BD4
.text:00414BD4 loc_414BD4:			       ; CODE XREF: __stricmp_l+17j
.text:00414BD4		       push    edi
.text:00414BD5		       mov     edi, [ebp+src]
.text:00414BD8		       cmp     edi, ebx
.text:00414BDA		       jnz     short loc_414C07
.text:00414BDC		       call    __errno
.text:00414BE1		       push    ebx	       ; pReserved
.text:00414BE2		       push    ebx	       ; nLine
.text:00414BE3		       push    ebx	       ; pszFile
.text:00414BE4		       push    ebx	       ; pszFunction
.text:00414BE5		       push    ebx	       ; pszExpression
.text:00414BE6		       mov     dword ptr [eax],	16h
.text:00414BEC		       call    __invalid_parameter
.text:00414BF1		       add     esp, 14h
.text:00414BF4		       cmp     [ebp+_loc_update.updated], bl
.text:00414BF7		       jz      short loc_414C00
.text:00414BF9		       mov     eax, [ebp+_loc_update.ptd]
.text:00414BFC		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00414C00
.text:00414C00 loc_414C00:			       ; CODE XREF: __stricmp_l+6Aj
.text:00414C00		       mov     eax, 7FFFFFFFh
.text:00414C05		       jmp     short loc_414C5C
.text:00414C07 ; ---------------------------------------------------------------------------
.text:00414C07
.text:00414C07 loc_414C07:			       ; CODE XREF: __stricmp_l+4Dj
.text:00414C07		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00414C0A		       cmp     [eax+14h], ebx
.text:00414C0D		       jnz     short loc_414C1C
.text:00414C0F		       push    edi	       ; src
.text:00414C10		       push    [ebp+dst]       ; dst
.text:00414C13		       call    ___ascii_stricmp
.text:00414C18		       pop     ecx
.text:00414C19		       pop     ecx
.text:00414C1A		       jmp     short loc_414C50
.text:00414C1C ; ---------------------------------------------------------------------------
.text:00414C1C
.text:00414C1C loc_414C1C:			       ; CODE XREF: __stricmp_l+80j
.text:00414C1C		       push    esi
.text:00414C1D
.text:00414C1D loc_414C1D:			       ; CODE XREF: __stricmp_l+BCj
.text:00414C1D		       mov     eax, [ebp+dst]
.text:00414C20		       movzx   eax, byte ptr [eax]
.text:00414C23		       lea     ecx, [ebp+_loc_update]
.text:00414C26		       push    ecx	       ; plocinfo
.text:00414C27		       push    eax	       ; c
.text:00414C28		       call    __tolower_l
.text:00414C2D		       inc     [ebp+dst]
.text:00414C30		       mov     esi, eax
.text:00414C32		       movzx   eax, byte ptr [edi]
.text:00414C35		       lea     ecx, [ebp+_loc_update]
.text:00414C38		       push    ecx	       ; plocinfo
.text:00414C39		       push    eax	       ; c
.text:00414C3A		       call    __tolower_l
.text:00414C3F		       add     esp, 10h
.text:00414C42		       inc     edi
.text:00414C43		       cmp     esi, ebx
.text:00414C45		       jz      short loc_414C4B
.text:00414C47		       cmp     esi, eax
.text:00414C49		       jz      short loc_414C1D
.text:00414C4B
.text:00414C4B loc_414C4B:			       ; CODE XREF: __stricmp_l+B8j
.text:00414C4B		       sub     esi, eax
.text:00414C4D		       mov     eax, esi
.text:00414C4F		       pop     esi
.text:00414C50
.text:00414C50 loc_414C50:			       ; CODE XREF: __stricmp_l+8Dj
.text:00414C50		       cmp     [ebp+_loc_update.updated], bl
.text:00414C53		       jz      short loc_414C5C
.text:00414C55		       mov     ecx, [ebp+_loc_update.ptd]
.text:00414C58		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00414C5C
.text:00414C5C loc_414C5C:			       ; CODE XREF: __stricmp_l+78j
.text:00414C5C					       ; __stricmp_l+C6j
.text:00414C5C		       pop     edi
.text:00414C5D
.text:00414C5D loc_414C5D:			       ; CODE XREF: __stricmp_l+42j
.text:00414C5D		       pop     ebx
.text:00414C5E		       leave
.text:00414C5F		       retn
.text:00414C5F __stricmp_l     endp
.text:00414C5F
.text:00414C60
.text:00414C60 ; =============== S U B R O U T I N E =======================================
.text:00414C60
.text:00414C60 ; Attributes: bp-based frame
.text:00414C60
.text:00414C60 ; int __cdecl _stricmp(const char *dst, const char *src)
.text:00414C60 __stricmp       proc near	       ; CODE XREF: TranslateName+2Dp
.text:00414C60					       ; CountryEnumProc+5Bp ...
.text:00414C60
.text:00414C60 dst	       = dword ptr  8
.text:00414C60 src	       = dword ptr  0Ch
.text:00414C60
.text:00414C60		       push    ebp
.text:00414C61		       mov     ebp, esp
.text:00414C63		       push    esi
.text:00414C64		       xor     esi, esi
.text:00414C66		       cmp     ___locale_changed, esi
.text:00414C6C		       jnz     short loc_414C9E
.text:00414C6E		       cmp     [ebp+dst], esi
.text:00414C71		       jnz     short loc_414C92
.text:00414C73
.text:00414C73 loc_414C73:			       ; CODE XREF: __stricmp+35j
.text:00414C73		       call    __errno
.text:00414C78		       push    esi	       ; pReserved
.text:00414C79		       push    esi	       ; nLine
.text:00414C7A		       push    esi	       ; pszFile
.text:00414C7B		       push    esi	       ; pszFunction
.text:00414C7C		       push    esi	       ; pszExpression
.text:00414C7D		       mov     dword ptr [eax],	16h
.text:00414C83		       call    __invalid_parameter
.text:00414C88		       add     esp, 14h
.text:00414C8B		       mov     eax, 7FFFFFFFh
.text:00414C90		       jmp     short loc_414CAD
.text:00414C92 ; ---------------------------------------------------------------------------
.text:00414C92
.text:00414C92 loc_414C92:			       ; CODE XREF: __stricmp+11j
.text:00414C92		       cmp     [ebp+src], esi
.text:00414C95		       jz      short loc_414C73
.text:00414C97		       pop     esi
.text:00414C98		       pop     ebp
.text:00414C99		       jmp     ___ascii_stricmp
.text:00414C9E ; ---------------------------------------------------------------------------
.text:00414C9E
.text:00414C9E loc_414C9E:			       ; CODE XREF: __stricmp+Cj
.text:00414C9E		       push    esi	       ; plocinfo
.text:00414C9F		       push    [ebp+src]       ; src
.text:00414CA2		       push    [ebp+dst]       ; dst
.text:00414CA5		       call    __stricmp_l
.text:00414CAA		       add     esp, 0Ch
.text:00414CAD
.text:00414CAD loc_414CAD:			       ; CODE XREF: __stricmp+30j
.text:00414CAD		       pop     esi
.text:00414CAE		       pop     ebp
.text:00414CAF		       retn
.text:00414CAF __stricmp       endp
.text:00414CAF
.text:00414CB0
.text:00414CB0 ; =============== S U B R O U T I N E =======================================
.text:00414CB0
.text:00414CB0
.text:00414CB0 ; int __cdecl atol(const	char *nptr)
.text:00414CB0 _atol	       proc near	       ; CODE XREF: ProcessCodePage+64p
.text:00414CB0					       ; ___ansicp+35p	...
.text:00414CB0
.text:00414CB0 nptr	       = dword ptr  4
.text:00414CB0
.text:00414CB0		       push    0Ah	       ; ibase
.text:00414CB2		       push    0	       ; endptr
.text:00414CB4		       push    [esp+8+nptr]    ; nptr
.text:00414CB8		       call    _strtol
.text:00414CBD		       add     esp, 0Ch
.text:00414CC0		       retn
.text:00414CC0 _atol	       endp
.text:00414CC0
.text:00414CC1
.text:00414CC1 ; =============== S U B R O U T I N E =======================================
.text:00414CC1
.text:00414CC1
.text:00414CC1 ; int __cdecl _atol_l(const char	*nptr, localeinfo_struct *plocinfo)
.text:00414CC1 __atol_l	       proc near	       ; CODE XREF: __atoi_lj
.text:00414CC1
.text:00414CC1 nptr	       = dword ptr  4
.text:00414CC1 plocinfo	       = dword ptr  8
.text:00414CC1
.text:00414CC1		       push    [esp+plocinfo]  ; plocinfo
.text:00414CC5		       push    0Ah	       ; ibase
.text:00414CC7		       push    0	       ; endptr
.text:00414CC9		       push    [esp+0Ch+nptr]  ; nptr
.text:00414CCD		       call    __strtol_l
.text:00414CD2		       add     esp, 10h
.text:00414CD5		       retn
.text:00414CD5 __atol_l	       endp
.text:00414CD5
.text:00414CD6 ; [00000005 BYTES: COLLAPSED FUNCTION _atoi. PRESS KEYPAD "+" TO	EXPAND]
.text:00414CDB ; [00000005 BYTES: COLLAPSED FUNCTION __atoi_l. PRESS KEYPAD "+"	TO EXPAND]
.text:00414CE0
.text:00414CE0 ; =============== S U B R O U T I N E =======================================
.text:00414CE0
.text:00414CE0
.text:00414CE0 ; __int64 __cdecl _atoi64(const char *nptr)
.text:00414CE0 __atoi64	       proc near
.text:00414CE0
.text:00414CE0 nptr	       = dword ptr  4
.text:00414CE0
.text:00414CE0		       push    0Ah	       ; ibase
.text:00414CE2		       push    0	       ; endptr
.text:00414CE4		       push    [esp+8+nptr]    ; nptr
.text:00414CE8		       call    __strtoi64
.text:00414CED		       add     esp, 0Ch
.text:00414CF0		       retn
.text:00414CF0 __atoi64	       endp
.text:00414CF0
.text:00414CF1
.text:00414CF1 ; =============== S U B R O U T I N E =======================================
.text:00414CF1
.text:00414CF1
.text:00414CF1 ; __int64 __cdecl _atoi64_l(const char *nptr, localeinfo_struct *plocinfo)
.text:00414CF1 __atoi64_l      proc near
.text:00414CF1
.text:00414CF1 nptr	       = dword ptr  4
.text:00414CF1 plocinfo	       = dword ptr  8
.text:00414CF1
.text:00414CF1		       push    [esp+plocinfo]  ; plocinfo
.text:00414CF5		       push    0Ah	       ; ibase
.text:00414CF7		       push    0	       ; endptr
.text:00414CF9		       push    [esp+0Ch+nptr]  ; nptr
.text:00414CFD		       call    __strtoi64_l
.text:00414D02		       add     esp, 10h
.text:00414D05		       retn
.text:00414D05 __atoi64_l      endp
.text:00414D05
.text:00414D06
.text:00414D06 ; =============== S U B R O U T I N E =======================================
.text:00414D06
.text:00414D06 ; Attributes: bp-based frame
.text:00414D06
.text:00414D06 ; int __cdecl _strnicmp_l(const char *dst, const	char *src, unsigned int	count, localeinfo_struct *plocinfo)
.text:00414D06 __strnicmp_l    proc near	       ; CODE XREF: __strnicmp+51p
.text:00414D06					       ; __strnicoll_l+9Fp
.text:00414D06
.text:00414D06 _loc_update     = _LocaleUpdate ptr -10h
.text:00414D06 dst	       = dword ptr  8
.text:00414D06 src	       = dword ptr  0Ch
.text:00414D06 count	       = dword ptr  10h
.text:00414D06 plocinfo	       = dword ptr  14h
.text:00414D06
.text:00414D06		       push    ebp
.text:00414D07		       mov     ebp, esp
.text:00414D09		       sub     esp, 10h
.text:00414D0C		       push    ebx
.text:00414D0D		       xor     ebx, ebx
.text:00414D0F		       cmp     [ebp+count], ebx
.text:00414D12		       push    esi
.text:00414D13		       push    edi
.text:00414D14		       jz      loc_414DEF
.text:00414D1A		       push    [ebp+plocinfo]  ; plocinfo
.text:00414D1D		       lea     ecx, [ebp+_loc_update] ;	this
.text:00414D20		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00414D25		       cmp     [ebp+dst], ebx
.text:00414D28		       jnz     short loc_414D58
.text:00414D2A
.text:00414D2A loc_414D2A:			       ; CODE XREF: __strnicmp_l+57j
.text:00414D2A		       call    __errno
.text:00414D2F		       push    ebx	       ; pReserved
.text:00414D30		       push    ebx	       ; nLine
.text:00414D31		       push    ebx	       ; pszFile
.text:00414D32		       push    ebx	       ; pszFunction
.text:00414D33		       push    ebx	       ; pszExpression
.text:00414D34		       mov     dword ptr [eax],	16h
.text:00414D3A		       call    __invalid_parameter
.text:00414D3F		       add     esp, 14h
.text:00414D42		       cmp     [ebp+_loc_update.updated], bl
.text:00414D45		       jz      short loc_414D4E
.text:00414D47		       mov     eax, [ebp+_loc_update.ptd]
.text:00414D4A		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00414D4E
.text:00414D4E loc_414D4E:			       ; CODE XREF: __strnicmp_l+3Fj
.text:00414D4E		       mov     eax, 7FFFFFFFh
.text:00414D53		       jmp     loc_414DF1
.text:00414D58 ; ---------------------------------------------------------------------------
.text:00414D58
.text:00414D58 loc_414D58:			       ; CODE XREF: __strnicmp_l+22j
.text:00414D58		       mov     edi, [ebp+src]
.text:00414D5B		       cmp     edi, ebx
.text:00414D5D		       jz      short loc_414D2A
.text:00414D5F		       mov     esi, 7FFFFFFFh
.text:00414D64		       cmp     [ebp+count], esi
.text:00414D67		       jbe     short loc_414D91
.text:00414D69		       call    __errno
.text:00414D6E		       push    ebx	       ; pReserved
.text:00414D6F		       push    ebx	       ; nLine
.text:00414D70		       push    ebx	       ; pszFile
.text:00414D71		       push    ebx	       ; pszFunction
.text:00414D72		       push    ebx	       ; pszExpression
.text:00414D73		       mov     dword ptr [eax],	16h
.text:00414D79		       call    __invalid_parameter
.text:00414D7E		       add     esp, 14h
.text:00414D81		       cmp     [ebp+_loc_update.updated], bl
.text:00414D84		       jz      short loc_414D8D
.text:00414D86		       mov     eax, [ebp+_loc_update.ptd]
.text:00414D89		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00414D8D
.text:00414D8D loc_414D8D:			       ; CODE XREF: __strnicmp_l+7Ej
.text:00414D8D		       mov     eax, esi
.text:00414D8F		       jmp     short loc_414DF1
.text:00414D91 ; ---------------------------------------------------------------------------
.text:00414D91
.text:00414D91 loc_414D91:			       ; CODE XREF: __strnicmp_l+61j
.text:00414D91		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00414D94		       cmp     [eax+14h], ebx
.text:00414D97		       jnz     short loc_414DB6
.text:00414D99		       push    [ebp+count]     ; count
.text:00414D9C		       push    edi	       ; last
.text:00414D9D		       push    [ebp+dst]       ; first
.text:00414DA0		       call    ___ascii_strnicmp
.text:00414DA5		       add     esp, 0Ch
.text:00414DA8
.text:00414DA8 loc_414DA8:			       ; CODE XREF: __strnicmp_l+E7j
.text:00414DA8		       cmp     [ebp+_loc_update.updated], bl
.text:00414DAB		       jz      short loc_414DF1
.text:00414DAD		       mov     ecx, [ebp+_loc_update.ptd]
.text:00414DB0		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00414DB4		       jmp     short loc_414DF1
.text:00414DB6 ; ---------------------------------------------------------------------------
.text:00414DB6
.text:00414DB6 loc_414DB6:			       ; CODE XREF: __strnicmp_l+91j
.text:00414DB6					       ; __strnicmp_l+E1j
.text:00414DB6		       mov     eax, [ebp+dst]
.text:00414DB9		       movzx   eax, byte ptr [eax]
.text:00414DBC		       lea     ecx, [ebp+_loc_update]
.text:00414DBF		       push    ecx	       ; plocinfo
.text:00414DC0		       push    eax	       ; c
.text:00414DC1		       call    __tolower_l
.text:00414DC6		       inc     [ebp+dst]
.text:00414DC9		       mov     esi, eax
.text:00414DCB		       movzx   eax, byte ptr [edi]
.text:00414DCE		       lea     ecx, [ebp+_loc_update]
.text:00414DD1		       push    ecx	       ; plocinfo
.text:00414DD2		       push    eax	       ; c
.text:00414DD3		       call    __tolower_l
.text:00414DD8		       add     esp, 10h
.text:00414DDB		       inc     edi
.text:00414DDC		       dec     [ebp+count]
.text:00414DDF		       jz      short loc_414DE9
.text:00414DE1		       cmp     esi, ebx
.text:00414DE3		       jz      short loc_414DE9
.text:00414DE5		       cmp     esi, eax
.text:00414DE7		       jz      short loc_414DB6
.text:00414DE9
.text:00414DE9 loc_414DE9:			       ; CODE XREF: __strnicmp_l+D9j
.text:00414DE9					       ; __strnicmp_l+DDj
.text:00414DE9		       sub     esi, eax
.text:00414DEB		       mov     eax, esi
.text:00414DED		       jmp     short loc_414DA8
.text:00414DEF ; ---------------------------------------------------------------------------
.text:00414DEF
.text:00414DEF loc_414DEF:			       ; CODE XREF: __strnicmp_l+Ej
.text:00414DEF		       xor     eax, eax
.text:00414DF1
.text:00414DF1 loc_414DF1:			       ; CODE XREF: __strnicmp_l+4Dj
.text:00414DF1					       ; __strnicmp_l+89j ...
.text:00414DF1		       pop     edi
.text:00414DF2		       pop     esi
.text:00414DF3		       pop     ebx
.text:00414DF4		       leave
.text:00414DF5		       retn
.text:00414DF5 __strnicmp_l    endp
.text:00414DF5
.text:00414DF6
.text:00414DF6 ; =============== S U B R O U T I N E =======================================
.text:00414DF6
.text:00414DF6 ; Attributes: bp-based frame
.text:00414DF6
.text:00414DF6 ; int __cdecl _strnicmp(const char *dst,	const char *src, unsigned int count)
.text:00414DF6 __strnicmp      proc near	       ; CODE XREF: LangCountryEnumProc+C3p
.text:00414DF6					       ; __strnicoll+Dj
.text:00414DF6
.text:00414DF6 dst	       = dword ptr  8
.text:00414DF6 src	       = dword ptr  0Ch
.text:00414DF6 count	       = dword ptr  10h
.text:00414DF6
.text:00414DF6		       push    ebp
.text:00414DF7		       mov     ebp, esp
.text:00414DF9		       push    esi
.text:00414DFA		       xor     esi, esi
.text:00414DFC		       cmp     ___locale_changed, esi
.text:00414E02		       jnz     short loc_414E3D
.text:00414E04		       cmp     [ebp+dst], esi
.text:00414E07		       jnz     short loc_414E28
.text:00414E09
.text:00414E09 loc_414E09:			       ; CODE XREF: __strnicmp+35j
.text:00414E09					       ; __strnicmp+3Ej
.text:00414E09		       call    __errno
.text:00414E0E		       push    esi	       ; pReserved
.text:00414E0F		       push    esi	       ; nLine
.text:00414E10		       push    esi	       ; pszFile
.text:00414E11		       push    esi	       ; pszFunction
.text:00414E12		       push    esi	       ; pszExpression
.text:00414E13		       mov     dword ptr [eax],	16h
.text:00414E19		       call    __invalid_parameter
.text:00414E1E		       add     esp, 14h
.text:00414E21		       mov     eax, 7FFFFFFFh
.text:00414E26		       jmp     short loc_414E4F
.text:00414E28 ; ---------------------------------------------------------------------------
.text:00414E28
.text:00414E28 loc_414E28:			       ; CODE XREF: __strnicmp+11j
.text:00414E28		       cmp     [ebp+src], esi
.text:00414E2B		       jz      short loc_414E09
.text:00414E2D		       cmp     [ebp+count], 7FFFFFFFh
.text:00414E34		       ja      short loc_414E09
.text:00414E36		       pop     esi
.text:00414E37		       pop     ebp
.text:00414E38		       jmp     ___ascii_strnicmp
.text:00414E3D ; ---------------------------------------------------------------------------
.text:00414E3D
.text:00414E3D loc_414E3D:			       ; CODE XREF: __strnicmp+Cj
.text:00414E3D		       push    esi	       ; plocinfo
.text:00414E3E		       push    [ebp+count]     ; count
.text:00414E41		       push    [ebp+src]       ; src
.text:00414E44		       push    [ebp+dst]       ; dst
.text:00414E47		       call    __strnicmp_l
.text:00414E4C		       add     esp, 10h
.text:00414E4F
.text:00414E4F loc_414E4F:			       ; CODE XREF: __strnicmp+30j
.text:00414E4F		       pop     esi
.text:00414E50		       pop     ebp
.text:00414E51		       retn
.text:00414E51 __strnicmp      endp
.text:00414E51
.text:00414E52
.text:00414E52 ; =============== S U B R O U T I N E =======================================
.text:00414E52
.text:00414E52 ; Attributes: bp-based frame
.text:00414E52
.text:00414E52 ; int __userpurge xtoa_s<eax>(unsigned int val<eax>, char *buf<ecx>, unsigned int sizeInTChars, unsigned	int radix, int is_neg)
.text:00414E52 xtoa_s	       proc near	       ; CODE XREF: __itoa_s+21p
.text:00414E52					       ; __ltoa_s+1Ep ...
.text:00414E52
.text:00414E52 length	       = dword ptr -4
.text:00414E52 sizeInTChars    = dword ptr  8
.text:00414E52 radix	       = dword ptr  0Ch
.text:00414E52 is_neg	       = dword ptr  10h
.text:00414E52
.text:00414E52 val = eax
.text:00414E52 buf = ecx
.text:00414E52		       push    ebp
.text:00414E53		       mov     ebp, esp
.text:00414E55		       push    buf
.text:00414E56		       push    ebx
.text:00414E57		       push    esi
.text:00414E58		       mov     esi, buf
.text:00414E5A		       xor     ebx, ebx
.text:00414E5C		       cmp     esi, ebx
.text:00414E5E		       jnz     short loc_414E7E
.text:00414E60		       call    __errno
.text:00414E65		       push    16h
.text:00414E67		       pop     esi
.text:00414E68		       push    ebx	       ; pReserved
.text:00414E69		       push    ebx	       ; nLine
.text:00414E6A		       push    ebx	       ; pszFile
.text:00414E6B		       push    ebx	       ; pszFunction
.text:00414E6C		       push    ebx	       ; pszExpression
.text:00414E6D		       mov     [val], esi
.text:00414E6F		       call    __invalid_parameter
.text:00414E74		       add     esp, 14h
.text:00414E77		       mov     val, esi
.text:00414E79		       jmp     loc_414F27
.text:00414E7E ; ---------------------------------------------------------------------------
.text:00414E7E
.text:00414E7E loc_414E7E:			       ; CODE XREF: xtoa_s+Cj
.text:00414E7E		       cmp     [ebp+sizeInTChars], ebx
.text:00414E81		       push    edi
.text:00414E82		       ja      short loc_414EA2
.text:00414E84
.text:00414E84 loc_414E84:			       ; CODE XREF: xtoa_s+72j
.text:00414E84		       call    __errno
.text:00414E89		       push    16h
.text:00414E8B
.text:00414E8B loc_414E8B:			       ; CODE XREF: xtoa_s+67j
.text:00414E8B		       pop     esi
.text:00414E8C		       push    ebx	       ; pReserved
.text:00414E8D		       push    ebx	       ; nLine
.text:00414E8E		       push    ebx	       ; pszFile
.text:00414E8F		       push    ebx	       ; pszFunction
.text:00414E90		       push    ebx	       ; pszExpression
.text:00414E91		       mov     [val], esi
.text:00414E93		       call    __invalid_parameter
.text:00414E98		       add     esp, 14h
.text:00414E9B		       mov     val, esi
.text:00414E9D		       jmp     loc_414F26
.text:00414EA2 ; ---------------------------------------------------------------------------
.text:00414EA2
.text:00414EA2 loc_414EA2:			       ; CODE XREF: xtoa_s+30j
.text:00414EA2		       xor     buf, buf
.text:00414EA4		       cmp     [ebp+is_neg], ebx
.text:00414EA7		       mov     [esi], bl
.text:00414EA9		       setnz   cl
.text:00414EAC		       inc     buf
.text:00414EAD		       cmp     [ebp+sizeInTChars], buf
.text:00414EB0		       ja      short loc_414EBB
.text:00414EB2
.text:00414EB2 loc_414EB2:			       ; CODE XREF: xtoa_s+BFj
.text:00414EB2		       call    __errno
.text:00414EB7		       push    22h
.text:00414EB9		       jmp     short loc_414E8B
.text:00414EBB ; ---------------------------------------------------------------------------
.text:00414EBB
.text:00414EBB loc_414EBB:			       ; CODE XREF: xtoa_s+5Ej
.text:00414EBB		       mov     buf, [ebp+radix]
.text:00414EBE		       add     buf, 0FFFFFFFEh
.text:00414EC1		       cmp     buf, 22h
.text:00414EC4		       ja      short loc_414E84
.text:00414EC6		       cmp     [ebp+is_neg], ebx
.text:00414EC9		       mov     [ebp+length], ebx
.text:00414ECC		       mov     buf, esi
.text:00414ECE		       jz      short loc_414EDF
.text:00414ED0		       mov     byte ptr	[esi], 2Dh
.text:00414ED3		       lea     buf, [esi+1]
.text:00414ED6		       mov     [ebp+length], 1
.text:00414EDD		       neg     val
.text:00414EDF
.text:00414EDF loc_414EDF:			       ; CODE XREF: xtoa_s+7Cj
.text:00414EDF		       mov     edi, buf
.text:00414EE1
.text:00414EE1 loc_414EE1:			       ; CODE XREF: xtoa_s+B3j
.text:00414EE1		       xor     edx, edx
.text:00414EE3		       div     [ebp+radix]
.text:00414EE6		       cmp     edx, 9
.text:00414EE9		       jbe     short loc_414EF0
.text:00414EEB		       add     dl, 57h
.text:00414EEE		       jmp     short loc_414EF3
.text:00414EF0 ; ---------------------------------------------------------------------------
.text:00414EF0
.text:00414EF0 loc_414EF0:			       ; CODE XREF: xtoa_s+97j
.text:00414EF0		       add     dl, 30h
.text:00414EF3
.text:00414EF3 loc_414EF3:			       ; CODE XREF: xtoa_s+9Cj
.text:00414EF3		       mov     [buf], dl
.text:00414EF5		       inc     buf
.text:00414EF6		       inc     [ebp+length]
.text:00414EF9		       xor     ebx, ebx
.text:00414EFB		       cmp     val, ebx
.text:00414EFD		       jbe     short loc_414F07
.text:00414EFF		       mov     edx, [ebp+sizeInTChars]
.text:00414F02		       cmp     [ebp+length], edx
.text:00414F05		       jb      short loc_414EE1
.text:00414F07
.text:00414F07 loc_414F07:			       ; CODE XREF: xtoa_s+ABj
.text:00414F07		       mov     val, [ebp+length]
.text:00414F0A		       cmp     val, [ebp+sizeInTChars]
.text:00414F0D		       jb      short loc_414F13
.text:00414F0F		       mov     [esi], bl
.text:00414F11		       jmp     short loc_414EB2
.text:00414F13 ; ---------------------------------------------------------------------------
.text:00414F13
.text:00414F13 loc_414F13:			       ; CODE XREF: xtoa_s+BBj
.text:00414F13		       mov     [buf], bl
.text:00414F15		       dec     buf
.text:00414F16
.text:00414F16 loc_414F16:			       ; CODE XREF: xtoa_s+D0j
.text:00414F16		       mov     dl, [edi]
.text:00414F18		       mov     al, [buf]
.text:00414F1A		       mov     [buf], dl
.text:00414F1C		       dec     buf
.text:00414F1D		       mov     [edi], al
.text:00414F1F		       inc     edi
.text:00414F20		       cmp     edi, buf
.text:00414F22		       jb      short loc_414F16
.text:00414F24		       xor     val, val
.text:00414F26
.text:00414F26 loc_414F26:			       ; CODE XREF: xtoa_s+4Bj
.text:00414F26		       pop     edi
.text:00414F27
.text:00414F27 loc_414F27:			       ; CODE XREF: xtoa_s+27j
.text:00414F27		       pop     esi
.text:00414F28		       pop     ebx
.text:00414F29		       leave
.text:00414F2A		       retn    0Ch
.text:00414F2A xtoa_s	       endp
.text:00414F2A
.text:00414F2D
.text:00414F2D ; =============== S U B R O U T I N E =======================================
.text:00414F2D
.text:00414F2D ; Attributes: bp-based frame
.text:00414F2D
.text:00414F2D ; int __cdecl _itoa_s(int val, char *buf, unsigned int sizeInTChars, int	radix)
.text:00414F2D __itoa_s	       proc near	       ; CODE XREF: ___get_qualified_locale+1CFp
.text:00414F2D
.text:00414F2D val	       = dword ptr  8
.text:00414F2D buf	       = dword ptr  0Ch
.text:00414F2D sizeInTChars    = dword ptr  10h
.text:00414F2D radix	       = dword ptr  14h
.text:00414F2D
.text:00414F2D		       push    ebp
.text:00414F2E		       mov     ebp, esp
.text:00414F30		       cmp     [ebp+radix], 0Ah
.text:00414F34		       mov     eax, [ebp+val]  ; val
.text:00414F37		       jnz     short loc_414F43
.text:00414F39		       test    eax, eax
.text:00414F3B		       jge     short loc_414F43
.text:00414F3D		       push    1
.text:00414F3F		       push    0Ah
.text:00414F41		       jmp     short loc_414F48
.text:00414F43 ; ---------------------------------------------------------------------------
.text:00414F43
.text:00414F43 loc_414F43:			       ; CODE XREF: __itoa_s+Aj
.text:00414F43					       ; __itoa_s+Ej
.text:00414F43		       push    0	       ; is_neg
.text:00414F45		       push    [ebp+radix]     ; radix
.text:00414F48
.text:00414F48 loc_414F48:			       ; CODE XREF: __itoa_s+14j
.text:00414F48		       push    [ebp+sizeInTChars] ; sizeInTChars
.text:00414F4B		       mov     ecx, [ebp+buf]  ; buf
.text:00414F4E		       call    xtoa_s
.text:00414F53		       pop     ebp
.text:00414F54		       retn
.text:00414F54 __itoa_s	       endp
.text:00414F54
.text:00414F55
.text:00414F55 ; =============== S U B R O U T I N E =======================================
.text:00414F55
.text:00414F55 ; Attributes: bp-based frame
.text:00414F55
.text:00414F55 ; int __cdecl _ltoa_s(int val, char *buf, unsigned int sizeInTChars, int	radix)
.text:00414F55 __ltoa_s	       proc near
.text:00414F55
.text:00414F55 val	       = dword ptr  8
.text:00414F55 buf	       = dword ptr  0Ch
.text:00414F55 sizeInTChars    = dword ptr  10h
.text:00414F55 radix	       = dword ptr  14h
.text:00414F55
.text:00414F55		       push    ebp
.text:00414F56		       mov     ebp, esp
.text:00414F58		       xor     eax, eax
.text:00414F5A		       cmp     [ebp+radix], 0Ah
.text:00414F5E		       jnz     short loc_414F66
.text:00414F60		       cmp     [ebp+val], eax
.text:00414F63		       jge     short loc_414F66
.text:00414F65		       inc     eax
.text:00414F66
.text:00414F66 loc_414F66:			       ; CODE XREF: __ltoa_s+9j
.text:00414F66					       ; __ltoa_s+Ej
.text:00414F66		       mov     ecx, [ebp+buf]  ; buf
.text:00414F69		       push    eax	       ; is_neg
.text:00414F6A		       push    [ebp+radix]     ; radix
.text:00414F6D		       mov     eax, [ebp+val]  ; val
.text:00414F70		       push    [ebp+sizeInTChars] ; sizeInTChars
.text:00414F73		       call    xtoa_s
.text:00414F78		       pop     ebp
.text:00414F79		       retn
.text:00414F79 __ltoa_s	       endp
.text:00414F79
.text:00414F7A
.text:00414F7A ; =============== S U B R O U T I N E =======================================
.text:00414F7A
.text:00414F7A
.text:00414F7A ; int __cdecl _ultoa_s(unsigned int val,	char *buf, unsigned int	sizeInTChars, int radix)
.text:00414F7A __ultoa_s       proc near
.text:00414F7A
.text:00414F7A val	       = dword ptr  4
.text:00414F7A buf	       = dword ptr  8
.text:00414F7A sizeInTChars    = dword ptr  0Ch
.text:00414F7A radix	       = dword ptr  10h
.text:00414F7A
.text:00414F7A		       mov     ecx, [esp+buf]  ; buf
.text:00414F7E		       mov     eax, [esp+val]  ; val
.text:00414F82		       push    0	       ; is_neg
.text:00414F84		       push    [esp+4+radix]   ; radix
.text:00414F88		       push    [esp+8+sizeInTChars] ; sizeInTChars
.text:00414F8C		       call    xtoa_s
.text:00414F91		       retn
.text:00414F91 __ultoa_s       endp
.text:00414F91
.text:00414F92
.text:00414F92 ; =============== S U B R O U T I N E =======================================
.text:00414F92
.text:00414F92 ; Attributes: bp-based frame
.text:00414F92
.text:00414F92 ; int __userpurge x64toa_s<eax>(unsigned	__int64	val, char *buf<edi>, unsigned int sizeInTChars,	unsigned int radix, int	is_neg)
.text:00414F92 x64toa_s	       proc near	       ; CODE XREF: __i64toa_s+2Bp
.text:00414F92					       ; __ui64toa_s+15p
.text:00414F92
.text:00414F92 var_8	       = dword ptr -8
.text:00414F92 length	       = dword ptr -4
.text:00414F92 val	       = qword ptr  8
.text:00414F92 sizeInTChars    = dword ptr  10h
.text:00414F92 radix	       = dword ptr  14h
.text:00414F92 firstdig	       = dword ptr  18h
.text:00414F92
.text:00414F92 buf = edi
.text:00414F92		       push    ebp
.text:00414F93		       mov     ebp, esp
.text:00414F95		       sub     esp, 0Ch
.text:00414F98		       push    ebx
.text:00414F99		       xor     ebx, ebx
.text:00414F9B		       cmp     buf, ebx
.text:00414F9D		       push    esi
.text:00414F9E		       jnz     short loc_414FBE
.text:00414FA0
.text:00414FA0 loc_414FA0:			       ; CODE XREF: x64toa_s+2Fj
.text:00414FA0					       ; x64toa_s+53j
.text:00414FA0		       call    __errno
.text:00414FA5		       push    16h
.text:00414FA7
.text:00414FA7 loc_414FA7:			       ; CODE XREF: x64toa_s+48j
.text:00414FA7		       pop     esi
.text:00414FA8		       mov     [eax], esi
.text:00414FAA
.text:00414FAA loc_414FAA:			       ; CODE XREF: x64toa_s+D1j
.text:00414FAA		       push    ebx	       ; pReserved
.text:00414FAB		       push    ebx	       ; nLine
.text:00414FAC		       push    ebx	       ; pszFile
.text:00414FAD		       push    ebx	       ; pszFunction
.text:00414FAE		       push    ebx	       ; pszExpression
.text:00414FAF		       call    __invalid_parameter
.text:00414FB4		       add     esp, 14h
.text:00414FB7		       mov     eax, esi
.text:00414FB9		       jmp     loc_415082
.text:00414FBE ; ---------------------------------------------------------------------------
.text:00414FBE
.text:00414FBE loc_414FBE:			       ; CODE XREF: x64toa_s+Cj
.text:00414FBE		       cmp     [ebp+sizeInTChars], ebx
.text:00414FC1		       jbe     short loc_414FA0
.text:00414FC3		       xor     eax, eax
.text:00414FC5		       cmp     [ebp+firstdig], ebx
.text:00414FC8		       mov     [buf], bl
.text:00414FCA		       setnz   al
.text:00414FCD		       inc     eax
.text:00414FCE		       cmp     [ebp+sizeInTChars], eax
.text:00414FD1		       ja      short loc_414FDC
.text:00414FD3		       call    __errno
.text:00414FD8		       push    22h
.text:00414FDA		       jmp     short loc_414FA7
.text:00414FDC ; ---------------------------------------------------------------------------
.text:00414FDC
.text:00414FDC loc_414FDC:			       ; CODE XREF: x64toa_s+3Fj
.text:00414FDC		       mov     eax, [ebp+radix]
.text:00414FDF		       add     eax, 0FFFFFFFEh
.text:00414FE2		       cmp     eax, 22h
.text:00414FE5		       ja      short loc_414FA0
.text:00414FE7		       cmp     [ebp+firstdig], ebx
.text:00414FEA		       mov     edx, dword ptr [ebp+val]
.text:00414FED		       mov     eax, dword ptr [ebp+val+4]
.text:00414FF0		       mov     [ebp+length], ebx
.text:00414FF3		       mov     esi, buf
.text:00414FF5		       jz      short loc_41500A
.text:00414FF7		       neg     edx
.text:00414FF9		       adc     eax, ebx
.text:00414FFB		       mov     byte ptr	[buf], 2Dh
.text:00414FFE		       lea     esi, [buf+1]
.text:00415001		       mov     [ebp+length], 1
.text:00415008		       neg     eax
.text:0041500A
.text:0041500A loc_41500A:			       ; CODE XREF: x64toa_s+63j
.text:0041500A		       mov     [ebp+firstdig], esi
.text:0041500D		       mov     dword ptr [ebp+val+4], ebx
.text:00415010
.text:00415010 loc_415010:			       ; CODE XREF: x64toa_s+B6j
.text:00415010		       push    dword ptr [ebp+val+4]
.text:00415013		       push    [ebp+radix]
.text:00415016		       push    eax
.text:00415017		       push    edx
.text:00415018		       call    __aulldvrm
.text:0041501D		       cmp     ecx, 9
.text:00415020		       mov     [ebp+var_8], ebx
.text:00415023		       mov     ebx, edx
.text:00415025		       mov     edx, eax
.text:00415027		       mov     eax, ebx
.text:00415029		       jbe     short loc_415030
.text:0041502B		       add     cl, 57h
.text:0041502E		       jmp     short loc_415033
.text:00415030 ; ---------------------------------------------------------------------------
.text:00415030
.text:00415030 loc_415030:			       ; CODE XREF: x64toa_s+97j
.text:00415030		       add     cl, 30h
.text:00415033
.text:00415033 loc_415033:			       ; CODE XREF: x64toa_s+9Cj
.text:00415033		       mov     [esi], cl
.text:00415035		       mov     ecx, [ebp+length]
.text:00415038		       inc     esi
.text:00415039		       inc     ecx
.text:0041503A		       test    eax, eax
.text:0041503C		       mov     [ebp+length], ecx
.text:0041503F		       ja      short loc_415045
.text:00415041		       test    edx, edx
.text:00415043		       jbe     short loc_41504D
.text:00415045
.text:00415045 loc_415045:			       ; CODE XREF: x64toa_s+ADj
.text:00415045		       cmp     ecx, [ebp+sizeInTChars]
.text:00415048		       jb      short loc_415010
.text:0041504A		       mov     ecx, [ebp+length]
.text:0041504D
.text:0041504D loc_41504D:			       ; CODE XREF: x64toa_s+B1j
.text:0041504D		       cmp     ecx, [ebp+sizeInTChars]
.text:00415050		       jb      short loc_415068
.text:00415052		       mov     byte ptr	[buf], 0
.text:00415055		       call    __errno
.text:0041505A		       push    22h
.text:0041505C		       pop     ecx
.text:0041505D		       mov     [eax], ecx
.text:0041505F		       mov     esi, ecx
.text:00415061		       xor     ebx, ebx
.text:00415063		       jmp     loc_414FAA
.text:00415068 ; ---------------------------------------------------------------------------
.text:00415068
.text:00415068 loc_415068:			       ; CODE XREF: x64toa_s+BEj
.text:00415068		       mov     byte ptr	[esi], 0
.text:0041506B		       dec     esi
.text:0041506C
.text:0041506C loc_41506C:			       ; CODE XREF: x64toa_s+ECj
.text:0041506C		       mov     eax, [ebp+firstdig]
.text:0041506F		       mov     dl, [eax]
.text:00415071		       mov     cl, [esi]
.text:00415073		       mov     [esi], dl
.text:00415075		       dec     esi
.text:00415076		       mov     [eax], cl
.text:00415078		       inc     eax
.text:00415079		       cmp     eax, esi
.text:0041507B		       mov     [ebp+firstdig], eax
.text:0041507E		       jb      short loc_41506C
.text:00415080		       xor     eax, eax
.text:00415082
.text:00415082 loc_415082:			       ; CODE XREF: x64toa_s+27j
.text:00415082		       pop     esi
.text:00415083		       pop     ebx
.text:00415084		       leave
.text:00415085		       retn    14h
.text:00415085 x64toa_s	       endp
.text:00415085
.text:00415088
.text:00415088 ; =============== S U B R O U T I N E =======================================
.text:00415088
.text:00415088 ; Attributes: bp-based frame
.text:00415088
.text:00415088 ; int __cdecl _i64toa_s(__int64 val, char *buf, unsigned	int sizeInTChars, int radix)
.text:00415088 __i64toa_s      proc near
.text:00415088
.text:00415088 val	       = qword ptr  8
.text:00415088 buf	       = dword ptr  10h
.text:00415088 sizeInTChars    = dword ptr  14h
.text:00415088 radix	       = dword ptr  18h
.text:00415088
.text:00415088		       push    ebp
.text:00415089		       mov     ebp, esp
.text:0041508B		       xor     eax, eax
.text:0041508D		       cmp     [ebp+radix], 0Ah
.text:00415091		       jnz     short loc_4150A2
.text:00415093		       cmp     dword ptr [ebp+val+4], eax
.text:00415096		       jg      short loc_4150A2
.text:00415098		       jl      short loc_41509F
.text:0041509A		       cmp     dword ptr [ebp+val], eax
.text:0041509D		       jnb     short loc_4150A2
.text:0041509F
.text:0041509F loc_41509F:			       ; CODE XREF: __i64toa_s+10j
.text:0041509F		       xor     eax, eax
.text:004150A1		       inc     eax
.text:004150A2
.text:004150A2 loc_4150A2:			       ; CODE XREF: __i64toa_s+9j
.text:004150A2					       ; __i64toa_s+Ej	...
.text:004150A2		       push    edi
.text:004150A3		       mov     edi, [ebp+buf]  ; buf
.text:004150A6		       push    eax	       ; is_neg
.text:004150A7		       push    [ebp+radix]     ; radix
.text:004150AA		       push    [ebp+sizeInTChars] ; sizeInTChars
.text:004150AD		       push    dword ptr [ebp+val+4]
.text:004150B0		       push    dword ptr [ebp+val] ; val
.text:004150B3		       call    x64toa_s
.text:004150B8		       pop     edi
.text:004150B9		       pop     ebp
.text:004150BA		       retn
.text:004150BA __i64toa_s      endp
.text:004150BA
.text:004150BB
.text:004150BB ; =============== S U B R O U T I N E =======================================
.text:004150BB
.text:004150BB ; Attributes: bp-based frame
.text:004150BB
.text:004150BB ; int __cdecl _ui64toa_s(unsigned __int64 val, char *buf, unsigned int sizeInTChars, int	radix)
.text:004150BB __ui64toa_s     proc near
.text:004150BB
.text:004150BB val	       = qword ptr  8
.text:004150BB buf	       = dword ptr  10h
.text:004150BB sizeInTChars    = dword ptr  14h
.text:004150BB radix	       = dword ptr  18h
.text:004150BB
.text:004150BB		       push    ebp
.text:004150BC		       mov     ebp, esp
.text:004150BE		       push    edi
.text:004150BF		       mov     edi, [ebp+buf]  ; buf
.text:004150C2		       push    0	       ; is_neg
.text:004150C4		       push    [ebp+radix]     ; radix
.text:004150C7		       push    [ebp+sizeInTChars] ; sizeInTChars
.text:004150CA		       push    dword ptr [ebp+val+4]
.text:004150CD		       push    dword ptr [ebp+val] ; val
.text:004150D0		       call    x64toa_s
.text:004150D5		       pop     edi
.text:004150D6		       pop     ebp
.text:004150D7		       retn
.text:004150D7 __ui64toa_s     endp
.text:004150D7
.text:004150D8
.text:004150D8 ; =============== S U B R O U T I N E =======================================
.text:004150D8
.text:004150D8 ; Attributes: bp-based frame
.text:004150D8
.text:004150D8 ; int __cdecl _crtGetStringTypeW_stat(localeinfo_struct *plocinfo, unsigned int dwInfoType, const wchar_t *lpSrcStr, int	cchSrc,	unsigned __int16 *lpCharType, int code_page, int lcid)
.text:004150D8 __crtGetStringTypeW_stat	proc near      ; CODE XREF: ___crtGetStringTypeW+27p
.text:004150D8
.text:004150D8 buff_size       = dword ptr -10h
.text:004150D8 retbool	       = dword ptr -0Ch
.text:004150D8 buffer	       = dword ptr -8
.text:004150D8 var_4	       = dword ptr -4
.text:004150D8 plocinfo	       = dword ptr  8
.text:004150D8 dwInfoType      = dword ptr  0Ch
.text:004150D8 lpSrcStr	       = dword ptr  10h
.text:004150D8 cchSrc	       = dword ptr  14h
.text:004150D8 lpCharType      = dword ptr  18h
.text:004150D8 code_page       = dword ptr  1Ch
.text:004150D8 lcid	       = dword ptr  20h
.text:004150D8
.text:004150D8		       push    ebp
.text:004150D9		       mov     ebp, esp
.text:004150DB		       sub     esp, 10h
.text:004150DE		       mov     eax, ___security_cookie
.text:004150E3		       xor     eax, ebp
.text:004150E5		       mov     [ebp+var_4], eax
.text:004150E8		       cmp     [ebp+cchSrc], 0FFFFFFFFh
.text:004150EC		       push    ebx
.text:004150ED		       push    esi
.text:004150EE		       push    edi
.text:004150EF		       jge     short loc_4150F8
.text:004150F1
.text:004150F1 loc_4150F1:			       ; CODE XREF: __crtGetStringTypeW_stat+85j
.text:004150F1					       ; __crtGetStringTypeW_stat+DDj ...
.text:004150F1		       xor     eax, eax
.text:004150F3		       jmp     loc_4152EA
.text:004150F8 ; ---------------------------------------------------------------------------
.text:004150F8
.text:004150F8 loc_4150F8:			       ; CODE XREF: __crtGetStringTypeW_stat+17j
.text:004150F8		       mov     eax, f_use_4
.text:004150FD		       mov     esi, ds:__imp__GetStringTypeW@16	; GetStringTypeW(x,x,x,x)
.text:00415103		       xor     ebx, ebx
.text:00415105		       xor     edi, edi
.text:00415107		       inc     ebx
.text:00415108		       cmp     eax, edi
.text:0041510A		       jnz     short loc_41513F
.text:0041510C		       lea     eax, [ebp+buffer]
.text:0041510F		       push    eax	       ; lpCharType
.text:00415110		       push    ebx	       ; cchSrc
.text:00415111		       push    offset SrcStr   ; lpSrcStr
.text:00415116		       push    ebx	       ; dwInfoType
.text:00415117		       call    esi ; GetStringTypeW(x,x,x,x) ; GetStringTypeW(x,x,x,x)
.text:00415119		       test    eax, eax
.text:0041511B		       jz      short loc_415125
.text:0041511D		       mov     f_use_4,	ebx
.text:00415123		       jmp     short loc_415143
.text:00415125 ; ---------------------------------------------------------------------------
.text:00415125
.text:00415125 loc_415125:			       ; CODE XREF: __crtGetStringTypeW_stat+43j
.text:00415125		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:0041512B		       cmp     eax, 78h
.text:0041512E		       jnz     short loc_41513A
.text:00415130		       push    2
.text:00415132		       pop     eax
.text:00415133		       mov     f_use_4,	eax
.text:00415138		       jmp     short loc_41513F
.text:0041513A ; ---------------------------------------------------------------------------
.text:0041513A
.text:0041513A loc_41513A:			       ; CODE XREF: __crtGetStringTypeW_stat+56j
.text:0041513A		       mov     eax, f_use_4
.text:0041513F
.text:0041513F loc_41513F:			       ; CODE XREF: __crtGetStringTypeW_stat+32j
.text:0041513F					       ; __crtGetStringTypeW_stat+60j
.text:0041513F		       cmp     eax, ebx
.text:00415141		       jnz     short loc_415156
.text:00415143
.text:00415143 loc_415143:			       ; CODE XREF: __crtGetStringTypeW_stat+4Bj
.text:00415143		       push    [ebp+lpCharType]	; lpCharType
.text:00415146		       push    [ebp+cchSrc]    ; cchSrc
.text:00415149		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0041514C		       push    [ebp+dwInfoType]	; dwInfoType
.text:0041514F		       call    esi ; GetStringTypeW(x,x,x,x) ; GetStringTypeW(x,x,x,x)
.text:00415151		       jmp     loc_4152EA
.text:00415156 ; ---------------------------------------------------------------------------
.text:00415156
.text:00415156 loc_415156:			       ; CODE XREF: __crtGetStringTypeW_stat+69j
.text:00415156		       cmp     eax, 2
.text:00415159		       jz      short loc_41515F
.text:0041515B		       cmp     eax, edi
.text:0041515D		       jnz     short loc_4150F1
.text:0041515F
.text:0041515F loc_41515F:			       ; CODE XREF: __crtGetStringTypeW_stat+81j
.text:0041515F		       cmp     [ebp+lcid], edi
.text:00415162		       mov     [ebp+retbool], edi
.text:00415165		       jnz     short loc_415172
.text:00415167		       mov     eax, [ebp+plocinfo]
.text:0041516A		       mov     eax, [eax]
.text:0041516C		       mov     eax, [eax+14h]
.text:0041516F		       mov     [ebp+lcid], eax
.text:00415172
.text:00415172 loc_415172:			       ; CODE XREF: __crtGetStringTypeW_stat+8Dj
.text:00415172		       cmp     [ebp+code_page],	edi
.text:00415175		       jnz     short loc_415182
.text:00415177		       mov     eax, [ebp+plocinfo]
.text:0041517A		       mov     eax, [eax]
.text:0041517C		       mov     eax, [eax+4]
.text:0041517F		       mov     [ebp+code_page],	eax
.text:00415182
.text:00415182 loc_415182:			       ; CODE XREF: __crtGetStringTypeW_stat+9Dj
.text:00415182		       push    [ebp+lcid]      ; lcid
.text:00415185		       call    ___ansicp
.text:0041518A		       cmp     [ebp+code_page],	eax
.text:0041518D		       pop     ecx
.text:0041518E		       jz      short loc_415198
.text:00415190		       cmp     eax, 0FFFFFFFFh
.text:00415193		       jz      short loc_415198
.text:00415195		       mov     [ebp+code_page],	eax
.text:00415198
.text:00415198 loc_415198:			       ; CODE XREF: __crtGetStringTypeW_stat+B6j
.text:00415198					       ; __crtGetStringTypeW_stat+BBj
.text:00415198		       mov     ebx, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:0041519E		       push    edi	       ; lpUsedDefaultChar
.text:0041519F		       push    edi	       ; lpDefaultChar
.text:004151A0		       push    edi	       ; cbMultiByte
.text:004151A1		       push    edi	       ; lpMultiByteStr
.text:004151A2		       push    [ebp+cchSrc]    ; cchWideChar
.text:004151A5		       push    [ebp+lpSrcStr]  ; lpWideCharStr
.text:004151A8		       push    edi	       ; dwFlags
.text:004151A9		       push    [ebp+code_page] ; CodePage
.text:004151AC		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:004151AE		       mov     esi, eax
.text:004151B0		       cmp     esi, edi
.text:004151B2		       mov     [ebp+buff_size],	esi
.text:004151B5		       jz      loc_4150F1
.text:004151BB		       jle     short loc_4151F8
.text:004151BD		       cmp     esi, 0FFFFFFE0h
.text:004151C0		       ja      short loc_4151F8
.text:004151C2		       lea     eax, [esi+8]
.text:004151C5		       cmp     eax, 400h
.text:004151CA		       ja      short loc_4151DF
.text:004151CC		       call    __alloca_probe_16
.text:004151D1		       mov     eax, esp
.text:004151D3		       cmp     eax, edi
.text:004151D5		       jz      short loc_4151F3
.text:004151D7		       mov     dword ptr [eax],	0CCCCh
.text:004151DD		       jmp     short loc_4151F0
.text:004151DF ; ---------------------------------------------------------------------------
.text:004151DF
.text:004151DF loc_4151DF:			       ; CODE XREF: __crtGetStringTypeW_stat+F2j
.text:004151DF		       push    eax	       ; size
.text:004151E0		       call    _malloc
.text:004151E5		       cmp     eax, edi
.text:004151E7		       pop     ecx
.text:004151E8		       jz      short loc_4151F3
.text:004151EA		       mov     dword ptr [eax],	0DDDDh
.text:004151F0
.text:004151F0 loc_4151F0:			       ; CODE XREF: __crtGetStringTypeW_stat+105j
.text:004151F0		       add     eax, 8
.text:004151F3
.text:004151F3 loc_4151F3:			       ; CODE XREF: __crtGetStringTypeW_stat+FDj
.text:004151F3					       ; __crtGetStringTypeW_stat+110j
.text:004151F3		       mov     [ebp+buffer], eax
.text:004151F6		       jmp     short loc_4151FB
.text:004151F8 ; ---------------------------------------------------------------------------
.text:004151F8
.text:004151F8 loc_4151F8:			       ; CODE XREF: __crtGetStringTypeW_stat+E3j
.text:004151F8					       ; __crtGetStringTypeW_stat+E8j
.text:004151F8		       mov     [ebp+buffer], edi
.text:004151FB
.text:004151FB loc_4151FB:			       ; CODE XREF: __crtGetStringTypeW_stat+11Ej
.text:004151FB		       cmp     [ebp+buffer], edi
.text:004151FE		       jz      loc_4150F1
.text:00415204		       push    esi	       ; count
.text:00415205		       push    edi	       ; value
.text:00415206		       push    [ebp+buffer]    ; dst
.text:00415209		       call    _memset
.text:0041520E		       add     esp, 0Ch
.text:00415211		       push    edi	       ; lpUsedDefaultChar
.text:00415212		       push    edi	       ; lpDefaultChar
.text:00415213		       push    esi	       ; cbMultiByte
.text:00415214		       push    [ebp+buffer]    ; lpMultiByteStr
.text:00415217		       push    [ebp+cchSrc]    ; cchWideChar
.text:0041521A		       push    [ebp+lpSrcStr]  ; lpWideCharStr
.text:0041521D		       push    edi	       ; dwFlags
.text:0041521E		       push    [ebp+code_page] ; CodePage
.text:00415221		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00415223		       test    eax, eax
.text:00415225		       jz      error_cleanup_3
.text:0041522B		       lea     eax, [esi+1]
.text:0041522E		       cmp     eax, edi
.text:00415230		       jle     short loc_415276
.text:00415232		       cmp     eax, 7FFFFFF0h
.text:00415237		       ja      short loc_415276
.text:00415239		       lea     eax, [esi+esi+0Ah]
.text:0041523D		       cmp     eax, 400h
.text:00415242		       ja      short loc_41525E
.text:00415244		       call    __alloca_probe_16
.text:00415249		       mov     ebx, esp
.text:0041524B		       cmp     ebx, edi
.text:0041524D		       jz      error_cleanup_3
.text:00415253		       mov     dword ptr [ebx],	0CCCCh
.text:00415259		       add     ebx, 8
.text:0041525C		       jmp     short loc_415278
.text:0041525E ; ---------------------------------------------------------------------------
.text:0041525E
.text:0041525E loc_41525E:			       ; CODE XREF: __crtGetStringTypeW_stat+16Aj
.text:0041525E		       push    eax	       ; size
.text:0041525F		       call    _malloc
.text:00415264		       cmp     eax, edi
.text:00415266		       pop     ecx
.text:00415267		       jz      short loc_415272
.text:00415269		       mov     dword ptr [eax],	0DDDDh
.text:0041526F		       add     eax, 8
.text:00415272
.text:00415272 loc_415272:			       ; CODE XREF: __crtGetStringTypeW_stat+18Fj
.text:00415272		       mov     ebx, eax
.text:00415274		       jmp     short loc_415278
.text:00415276 ; ---------------------------------------------------------------------------
.text:00415276
.text:00415276 loc_415276:			       ; CODE XREF: __crtGetStringTypeW_stat+158j
.text:00415276					       ; __crtGetStringTypeW_stat+15Fj
.text:00415276		       xor     ebx, ebx
.text:00415278
.text:00415278 loc_415278:			       ; CODE XREF: __crtGetStringTypeW_stat+184j
.text:00415278					       ; __crtGetStringTypeW_stat+19Cj
.text:00415278		       cmp     ebx, edi
.text:0041527A		       jz      short error_cleanup_3
.text:0041527C		       cmp     [ebp+lcid], edi
.text:0041527F		       jnz     short loc_41528C
.text:00415281		       mov     eax, [ebp+plocinfo]
.text:00415284		       mov     eax, [eax]
.text:00415286		       mov     eax, [eax+14h]
.text:00415289		       mov     [ebp+lcid], eax
.text:0041528C
.text:0041528C loc_41528C:			       ; CODE XREF: __crtGetStringTypeW_stat+1A7j
.text:0041528C		       mov     edi, [ebp+cchSrc]
.text:0041528F		       push    ebx	       ; lpCharType
.text:00415290		       push    [ebp+buff_size] ; cchSrc
.text:00415293		       add     edi, edi
.text:00415295		       push    [ebp+buffer]    ; lpSrcStr
.text:00415298		       lea     esi, [edi+ebx]
.text:0041529B		       push    [ebp+dwInfoType]	; dwInfoType
.text:0041529E		       or      word ptr	[esi], 0FFFFh
.text:004152A3		       push    [ebp+lcid]      ; Locale
.text:004152A6		       or      word ptr	[esi-2], 0FFFFh
.text:004152AC		       call    ds:__imp__GetStringTypeA@20 ; GetStringTypeA(x,x,x,x,x)
.text:004152B2		       cmp     word ptr	[esi-2], 0FFFFh
.text:004152B8		       mov     [ebp+retbool], eax
.text:004152BB		       jz      short loc_4152D3
.text:004152BD		       cmp     word ptr	[esi], 0FFFFh
.text:004152C2		       jnz     short loc_4152D3
.text:004152C4		       push    edi	       ; count
.text:004152C5		       push    ebx	       ; src
.text:004152C6		       push    [ebp+lpCharType]	; dst
.text:004152C9		       call    _memmove
.text:004152CE		       add     esp, 0Ch
.text:004152D1		       jmp     short loc_4152D7
.text:004152D3 ; ---------------------------------------------------------------------------
.text:004152D3
.text:004152D3 loc_4152D3:			       ; CODE XREF: __crtGetStringTypeW_stat+1E3j
.text:004152D3					       ; __crtGetStringTypeW_stat+1EAj
.text:004152D3		       and     [ebp+retbool], 0
.text:004152D7
.text:004152D7 loc_4152D7:			       ; CODE XREF: __crtGetStringTypeW_stat+1F9j
.text:004152D7		       push    ebx	       ; _Memory
.text:004152D8		       call    __freea
.text:004152DD		       pop     ecx
.text:004152DE
.text:004152DE error_cleanup_3:			       ; CODE XREF: __crtGetStringTypeW_stat+14Dj
.text:004152DE					       ; __crtGetStringTypeW_stat+175j	...
.text:004152DE		       push    [ebp+buffer]    ; _Memory
.text:004152E1		       call    __freea
.text:004152E6		       mov     eax, [ebp+retbool]
.text:004152E9		       pop     ecx
.text:004152EA
.text:004152EA loc_4152EA:			       ; CODE XREF: __crtGetStringTypeW_stat+1Bj
.text:004152EA					       ; __crtGetStringTypeW_stat+79j
.text:004152EA		       lea     esp, [ebp-1Ch]
.text:004152ED		       pop     edi
.text:004152EE		       pop     esi
.text:004152EF		       pop     ebx
.text:004152F0		       mov     ecx, [ebp+var_4]
.text:004152F3		       xor     ecx, ebp	       ; cookie
.text:004152F5		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:004152FA		       leave
.text:004152FB		       retn
.text:004152FB __crtGetStringTypeW_stat	endp
.text:004152FB
.text:004152FC
.text:004152FC ; =============== S U B R O U T I N E =======================================
.text:004152FC
.text:004152FC ; Attributes: bp-based frame
.text:004152FC
.text:004152FC ; int __cdecl __crtGetStringTypeW(localeinfo_struct *plocinfo, unsigned int dwInfoType, const wchar_t *lpSrcStr,	int cchSrc, unsigned __int16 *lpCharType, int code_page, int lcid)
.text:004152FC ___crtGetStringTypeW proc near	       ; CODE XREF: __iswctype_l+5Ap
.text:004152FC					       ; _iswctype+54p
.text:004152FC
.text:004152FC _loc_update     = _LocaleUpdate ptr -10h
.text:004152FC plocinfo	       = dword ptr  8
.text:004152FC dwInfoType      = dword ptr  0Ch
.text:004152FC lpSrcStr	       = dword ptr  10h
.text:004152FC cchSrc	       = dword ptr  14h
.text:004152FC lpCharType      = dword ptr  18h
.text:004152FC code_page       = dword ptr  1Ch
.text:004152FC lcid	       = dword ptr  20h
.text:004152FC
.text:004152FC		       push    ebp
.text:004152FD		       mov     ebp, esp
.text:004152FF		       sub     esp, 10h
.text:00415302		       push    [ebp+plocinfo]  ; plocinfo
.text:00415305		       lea     ecx, [ebp+_loc_update] ;	this
.text:00415308		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:0041530D		       push    [ebp+lcid]      ; lcid
.text:00415310		       lea     eax, [ebp+_loc_update]
.text:00415313		       push    [ebp+code_page] ; code_page
.text:00415316		       push    [ebp+lpCharType]	; lpCharType
.text:00415319		       push    [ebp+cchSrc]    ; cchSrc
.text:0041531C		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:0041531F		       push    [ebp+dwInfoType]	; dwInfoType
.text:00415322		       push    eax	       ; plocinfo
.text:00415323		       call    __crtGetStringTypeW_stat
.text:00415328		       add     esp, 1Ch
.text:0041532B		       cmp     [ebp+_loc_update.updated], 0
.text:0041532F		       jz      short locret_415338
.text:00415331		       mov     ecx, [ebp+_loc_update.ptd]
.text:00415334		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00415338
.text:00415338 locret_415338:			       ; CODE XREF: ___crtGetStringTypeW+33j
.text:00415338		       leave
.text:00415339		       retn
.text:00415339 ___crtGetStringTypeW endp
.text:00415339
.text:0041533A
.text:0041533A ; =============== S U B R O U T I N E =======================================
.text:0041533A
.text:0041533A ; Attributes: bp-based frame
.text:0041533A
.text:0041533A ; int __cdecl has_osfxsr_set()
.text:0041533A has_osfxsr_set  proc near	       ; CODE XREF: __get_sse2_info+4Dp
.text:0041533A
.text:0041533A ret	       = dword ptr -1Ch
.text:0041533A ms_exc	       = CPPEH_RECORD ptr -18h
.text:0041533A
.text:0041533A		       push    0Ch
.text:0041533C		       push    offset dword_421A40
.text:00415341		       call    __SEH_prolog4
.text:00415346		       and     [ebp+ms_exc.disabled], 0
.text:0041534A		       movapd  xmm0, xmm1
.text:0041534E		       mov     [ebp+ret], 1
.text:00415355		       jmp     short loc_41537A
.text:00415357 ; ---------------------------------------------------------------------------
.text:00415357
.text:00415357 $LN7_9:
.text:00415357		       mov     eax, [ebp+ms_exc.exc_ptr]
.text:0041535A		       mov     eax, [eax]
.text:0041535C		       mov     eax, [eax]
.text:0041535E		       cmp     eax, 0C0000005h
.text:00415363		       jz      short loc_41536F
.text:00415365		       cmp     eax, 0C000001Dh
.text:0041536A		       jz      short loc_41536F
.text:0041536C		       xor     eax, eax
.text:0041536E		       retn
.text:0041536F ; ---------------------------------------------------------------------------
.text:0041536F
.text:0041536F loc_41536F:			       ; CODE XREF: has_osfxsr_set+29j
.text:0041536F					       ; has_osfxsr_set+30j
.text:0041536F		       xor     eax, eax
.text:00415371		       inc     eax
.text:00415372
.text:00415372 $LN11_8:
.text:00415372		       retn
.text:00415373 ; ---------------------------------------------------------------------------
.text:00415373
.text:00415373 $LN8_9:
.text:00415373		       mov     esp, [ebp+ms_exc.old_esp]
.text:00415376		       and     [ebp+ret], 0
.text:0041537A
.text:0041537A loc_41537A:			       ; CODE XREF: has_osfxsr_set+1Bj
.text:0041537A		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:00415381		       mov     eax, [ebp+ret]
.text:00415384		       call    __SEH_epilog4
.text:00415389		       retn
.text:00415389 has_osfxsr_set  endp ; sp-analysis failed
.text:00415389
.text:0041538A
.text:0041538A ; =============== S U B R O U T I N E =======================================
.text:0041538A
.text:0041538A ; Attributes: bp-based frame
.text:0041538A
.text:0041538A ; int __cdecl _get_sse2_info()
.text:0041538A __get_sse2_info proc near	       ; CODE XREF: __sse2_mathfcns_init+7p
.text:0041538A					       ; ___sse2_available_initp
.text:0041538A
.text:0041538A Ident	       = $992A88C5856F6BE6869BBDDAC7BE31AD ptr -18h
.text:0041538A dwMax	       = dword ptr -0Ch
.text:0041538A Signature       = dword ptr -8
.text:0041538A cpu_feature     = dword ptr -4
.text:0041538A
.text:0041538A		       push    ebp
.text:0041538B		       mov     ebp, esp
.text:0041538D		       sub     esp, 18h
.text:00415390		       xor     eax, eax
.text:00415392		       push    ebx
.text:00415393		       mov     [ebp+cpu_feature], eax
.text:00415396		       mov     [ebp+dwMax], eax
.text:00415399		       mov     [ebp+Signature],	eax
.text:0041539C		       push    ebx
.text:0041539D		       pushf
.text:0041539E		       pop     eax
.text:0041539F		       mov     ecx, eax
.text:004153A1		       xor     eax, 200000h
.text:004153A6		       push    eax
.text:004153A7		       popf
.text:004153A8		       pushf
.text:004153A9		       pop     edx
.text:004153AA		       sub     edx, ecx
.text:004153AC		       jz      short DONE
.text:004153AE		       push    ecx
.text:004153AF		       popf
.text:004153B0		       xor     eax, eax
.text:004153B2		       cpuid
.text:004153B4		       mov     [ebp+dwMax], eax
.text:004153B7		       mov     [ebp+Ident.dw0],	ebx
.text:004153BA		       mov     [ebp+Ident.dw1],	edx
.text:004153BD		       mov     [ebp+Ident.dw2],	ecx
.text:004153C0		       mov     eax, 1
.text:004153C5		       cpuid
.text:004153C7		       mov     [ebp+cpu_feature], edx
.text:004153CA		       mov     [ebp+Signature],	eax
.text:004153CD
.text:004153CD DONE:				       ; CODE XREF: __get_sse2_info+22j
.text:004153CD		       pop     ebx
.text:004153CE		       test    [ebp+cpu_feature], 4000000h
.text:004153D5		       jz      short loc_4153E5
.text:004153D7		       call    has_osfxsr_set
.text:004153DC		       test    eax, eax
.text:004153DE		       jz      short loc_4153E5
.text:004153E0		       xor     eax, eax
.text:004153E2		       inc     eax
.text:004153E3		       jmp     short loc_4153E7
.text:004153E5 ; ---------------------------------------------------------------------------
.text:004153E5
.text:004153E5 loc_4153E5:			       ; CODE XREF: __get_sse2_info+4Bj
.text:004153E5					       ; __get_sse2_info+54j
.text:004153E5		       xor     eax, eax
.text:004153E7
.text:004153E7 loc_4153E7:			       ; CODE XREF: __get_sse2_info+59j
.text:004153E7		       pop     ebx
.text:004153E8		       leave
.text:004153E9		       retn
.text:004153E9 __get_sse2_info endp
.text:004153E9
.text:004153EA
.text:004153EA ; =============== S U B R O U T I N E =======================================
.text:004153EA
.text:004153EA
.text:004153EA ; int __cdecl __sse2_available_init()
.text:004153EA ___sse2_available_init proc near	       ; DATA XREF: .rdata:pinit_3o
.text:004153EA		       call    __get_sse2_info
.text:004153EF		       mov     ___sse2_available, eax
.text:004153F4		       xor     eax, eax
.text:004153F6		       retn
.text:004153F6 ___sse2_available_init endp
.text:004153F6
.text:004153F6 ; ---------------------------------------------------------------------------
.text:004153F7		       align 10h
.text:00415400
.text:00415400 ; =============== S U B R O U T I N E =======================================
.text:00415400
.text:00415400
.text:00415400 __chkstk	       proc near	       ; CODE XREF: __alloca_probe_16+11j
.text:00415400					       ; __alloca_probe_16+27j
.text:00415400		       push    ecx
.text:00415401		       lea     ecx, [esp+4]
.text:00415405		       sub     ecx, eax
.text:00415407		       sbb     eax, eax
.text:00415409		       not     eax
.text:0041540B		       and     ecx, eax
.text:0041540D		       mov     eax, esp
.text:0041540F		       and     eax, 0FFFFF000h
.text:00415414
.text:00415414 cs10:				       ; CODE XREF: __chkstk+29j
.text:00415414		       cmp     ecx, eax
.text:00415416		       jb      short cs20
.text:00415418		       mov     eax, ecx
.text:0041541A		       pop     ecx
.text:0041541B		       xchg    eax, esp
.text:0041541C		       mov     eax, [eax]
.text:0041541E		       mov     [esp+0],	eax
.text:00415421		       retn
.text:00415422 ; ---------------------------------------------------------------------------
.text:00415422
.text:00415422 cs20:				       ; CODE XREF: __chkstk+16j
.text:00415422		       sub     eax, 1000h
.text:00415427		       test    [eax], eax
.text:00415429		       jmp     short cs10
.text:00415429 __chkstk	       endp
.text:00415429
.text:0041542B
.text:0041542B ; =============== S U B R O U T I N E =======================================
.text:0041542B
.text:0041542B
.text:0041542B ___initconin    proc near
.text:0041542B		       xor     eax, eax
.text:0041542D		       push    eax	       ; hTemplateFile
.text:0041542E		       push    eax	       ; dwFlagsAndAttributes
.text:0041542F		       push    3	       ; dwCreationDisposition
.text:00415431		       push    eax	       ; lpSecurityAttributes
.text:00415432		       push    3	       ; dwShareMode
.text:00415434		       push    0C0000000h      ; dwDesiredAccess
.text:00415439		       push    offset FileName ; "CONIN$"
.text:0041543E		       call    ds:__imp__CreateFileA@28	; CreateFileA(x,x,x,x,x,x,x)
.text:00415444		       mov     __coninpfh, eax
.text:00415449		       retn
.text:00415449 ___initconin    endp
.text:00415449
.text:0041544A
.text:0041544A ; =============== S U B R O U T I N E =======================================
.text:0041544A
.text:0041544A
.text:0041544A ___initconout   proc near	       ; CODE XREF: __putwch_nolock+24p
.text:0041544A		       xor     eax, eax
.text:0041544C		       push    eax	       ; hTemplateFile
.text:0041544D		       push    eax	       ; dwFlagsAndAttributes
.text:0041544E		       push    3	       ; dwCreationDisposition
.text:00415450		       push    eax	       ; lpSecurityAttributes
.text:00415451		       push    3	       ; dwShareMode
.text:00415453		       push    40000000h       ; dwDesiredAccess
.text:00415458		       push    offset aConout  ; "CONOUT$"
.text:0041545D		       call    ds:__imp__CreateFileA@28	; CreateFileA(x,x,x,x,x,x,x)
.text:00415463		       mov     __confh,	eax
.text:00415468		       retn
.text:00415468 ___initconout   endp
.text:00415468
.text:00415469
.text:00415469 ; =============== S U B R O U T I N E =======================================
.text:00415469
.text:00415469
.text:00415469 ___termcon      proc near	       ; DATA XREF: .rdata:ptermo
.text:00415469		       mov     eax, __confh
.text:0041546E		       cmp     eax, 0FFFFFFFFh
.text:00415471		       push    esi
.text:00415472		       mov     esi, ds:__imp__CloseHandle@4 ; CloseHandle(x)
.text:00415478		       jz      short loc_415482
.text:0041547A		       cmp     eax, 0FFFFFFFEh
.text:0041547D		       jz      short loc_415482
.text:0041547F		       push    eax	       ; hObject
.text:00415480		       call    esi ; CloseHandle(x) ; CloseHandle(x)
.text:00415482
.text:00415482 loc_415482:			       ; CODE XREF: ___termcon+Fj
.text:00415482					       ; ___termcon+14j
.text:00415482		       mov     eax, __coninpfh
.text:00415487		       cmp     eax, 0FFFFFFFFh
.text:0041548A		       jz      short loc_415494
.text:0041548C		       cmp     eax, 0FFFFFFFEh
.text:0041548F		       jz      short loc_415494
.text:00415491		       push    eax	       ; hObject
.text:00415492		       call    esi ; CloseHandle(x) ; CloseHandle(x)
.text:00415494
.text:00415494 loc_415494:			       ; CODE XREF: ___termcon+21j
.text:00415494					       ; ___termcon+26j
.text:00415494		       pop     esi
.text:00415495		       retn
.text:00415495 ___termcon      endp
.text:00415495
.text:00415496
.text:00415496 ; =============== S U B R O U T I N E =======================================
.text:00415496
.text:00415496
.text:00415496 ; unsigned int __cdecl wcslen(const wchar_t *wcs)
.text:00415496 _wcslen	       proc near	       ; CODE XREF: __cputws+44p
.text:00415496
.text:00415496 wcs	       = dword ptr  4
.text:00415496
.text:00415496		       mov     eax, [esp+wcs]
.text:0041549A
.text:0041549A loc_41549A:			       ; CODE XREF: _wcslen+Cj
.text:0041549A		       mov     cx, [eax]
.text:0041549D		       inc     eax
.text:0041549E		       inc     eax
.text:0041549F		       test    cx, cx
.text:004154A2		       jnz     short loc_41549A
.text:004154A4		       sub     eax, [esp+wcs]
.text:004154A8		       sar     eax, 1
.text:004154AA		       dec     eax
.text:004154AB		       retn
.text:004154AB _wcslen	       endp
.text:004154AB
.text:004154AC
.text:004154AC ; =============== S U B R O U T I N E =======================================
.text:004154AC
.text:004154AC
.text:004154AC ; const char *__cdecl _getenv_helper_nolock(const char *option)
.text:004154AC __getenv_helper_nolock proc near	       ; CODE XREF: _tzset_nolock+A6p
.text:004154AC					       ; _getenv_s_helper+47p ...
.text:004154AC
.text:004154AC option	       = dword ptr  4
.text:004154AC
.text:004154AC		       cmp     ___env_initialized, 0
.text:004154B3		       push    esi
.text:004154B4		       mov     esi, __environ
.text:004154BA		       jnz     short loc_4154C0
.text:004154BC		       xor     eax, eax
.text:004154BE		       pop     esi
.text:004154BF		       retn
.text:004154C0 ; ---------------------------------------------------------------------------
.text:004154C0
.text:004154C0 loc_4154C0:			       ; CODE XREF: __getenv_helper_nolock+Ej
.text:004154C0		       test    esi, esi
.text:004154C2		       push    ebx
.text:004154C3		       push    edi
.text:004154C4		       jnz     short loc_4154E1
.text:004154C6		       cmp     __wenviron, esi
.text:004154CC		       jz      short loc_41551F
.text:004154CE		       call    ___wtomb_environ
.text:004154D3		       test    eax, eax
.text:004154D5		       jnz     short loc_41551F
.text:004154D7		       mov     esi, __environ
.text:004154DD		       test    esi, esi
.text:004154DF		       jz      short loc_41551F
.text:004154E1
.text:004154E1 loc_4154E1:			       ; CODE XREF: __getenv_helper_nolock+18j
.text:004154E1		       mov     ebx, [esp+0Ch+option]
.text:004154E5		       test    ebx, ebx
.text:004154E7		       jz      short loc_41551F
.text:004154E9		       push    ebx	       ; buf
.text:004154EA		       call    _strlen
.text:004154EF		       pop     ecx
.text:004154F0		       mov     edi, eax
.text:004154F2		       jmp     short loc_415519
.text:004154F4 ; ---------------------------------------------------------------------------
.text:004154F4
.text:004154F4 loc_4154F4:			       ; CODE XREF: __getenv_helper_nolock+71j
.text:004154F4		       push    eax	       ; buf
.text:004154F5		       call    _strlen
.text:004154FA		       cmp     eax, edi
.text:004154FC		       pop     ecx
.text:004154FD		       jbe     short loc_415516
.text:004154FF		       mov     eax, [esi]
.text:00415501		       cmp     byte ptr	[eax+edi], 3Dh
.text:00415505		       jnz     short loc_415516
.text:00415507		       push    edi	       ; n
.text:00415508		       push    ebx	       ; s2
.text:00415509		       push    eax	       ; s1
.text:0041550A		       call    __mbsnbicoll
.text:0041550F		       add     esp, 0Ch
.text:00415512		       test    eax, eax
.text:00415514		       jz      short loc_415525
.text:00415516
.text:00415516 loc_415516:			       ; CODE XREF: __getenv_helper_nolock+51j
.text:00415516					       ; __getenv_helper_nolock+59j
.text:00415516		       add     esi, 4
.text:00415519
.text:00415519 loc_415519:			       ; CODE XREF: __getenv_helper_nolock+46j
.text:00415519		       mov     eax, [esi]
.text:0041551B		       test    eax, eax
.text:0041551D		       jnz     short loc_4154F4
.text:0041551F
.text:0041551F loc_41551F:			       ; CODE XREF: __getenv_helper_nolock+20j
.text:0041551F					       ; __getenv_helper_nolock+29j ...
.text:0041551F		       xor     eax, eax
.text:00415521
.text:00415521 loc_415521:			       ; CODE XREF: __getenv_helper_nolock+7Fj
.text:00415521		       pop     edi
.text:00415522		       pop     ebx
.text:00415523		       pop     esi
.text:00415524		       retn
.text:00415525 ; ---------------------------------------------------------------------------
.text:00415525
.text:00415525 loc_415525:			       ; CODE XREF: __getenv_helper_nolock+68j
.text:00415525		       mov     eax, [esi]
.text:00415527		       lea     eax, [eax+edi+1]
.text:0041552B		       jmp     short loc_415521
.text:0041552B __getenv_helper_nolock endp
.text:0041552B
.text:0041552D
.text:0041552D ; =============== S U B R O U T I N E =======================================
.text:0041552D
.text:0041552D ; Attributes: bp-based frame
.text:0041552D
.text:0041552D ; int __usercall	getenv_s_helper<eax>(unsigned int *pReturnValue<eax>, char *buffer, unsigned int sizeInTChars, const char *varname)
.text:0041552D _getenv_s_helper	proc near
.text:0041552D
.text:0041552D buffer	       = dword ptr  8
.text:0041552D sizeInTChars    = dword ptr  0Ch
.text:0041552D varname	       = dword ptr  10h
.text:0041552D
.text:0041552D pReturnValue = eax
.text:0041552D		       push    ebp
.text:0041552E		       mov     ebp, esp
.text:00415530		       push    ebx
.text:00415531		       push    esi
.text:00415532		       mov     esi, pReturnValue
.text:00415534		       xor     ebx, ebx
.text:00415536		       cmp     esi, ebx
.text:00415538		       jnz     short loc_415555
.text:0041553A
.text:0041553A loc_41553A:			       ; CODE XREF: _getenv_s_helper+36j
.text:0041553A					       ; _getenv_s_helper+3Bj
.text:0041553A		       call    __errno
.text:0041553F		       push    16h
.text:00415541		       pop     esi
.text:00415542		       push    ebx	       ; pReserved
.text:00415543		       push    ebx	       ; nLine
.text:00415544		       push    ebx	       ; pszFile
.text:00415545		       push    ebx	       ; pszFunction
.text:00415546		       push    ebx	       ; pszExpression
.text:00415547		       mov     [pReturnValue], esi
.text:00415549		       call    __invalid_parameter
.text:0041554E		       add     esp, 14h
.text:00415551		       mov     pReturnValue, esi
.text:00415553		       jmp     short loc_4155BC
.text:00415555 ; ---------------------------------------------------------------------------
.text:00415555
.text:00415555 loc_415555:			       ; CODE XREF: _getenv_s_helper+Bj
.text:00415555		       mov     pReturnValue, [ebp+buffer]
.text:00415558		       cmp     pReturnValue, ebx
.text:0041555A		       mov     [esi], ebx
.text:0041555C		       jz      short loc_415565
.text:0041555E		       cmp     [ebp+sizeInTChars], ebx
.text:00415561		       ja      short loc_41556A
.text:00415563		       jmp     short loc_41553A
.text:00415565 ; ---------------------------------------------------------------------------
.text:00415565
.text:00415565 loc_415565:			       ; CODE XREF: _getenv_s_helper+2Fj
.text:00415565		       cmp     [ebp+sizeInTChars], ebx
.text:00415568		       jnz     short loc_41553A
.text:0041556A
.text:0041556A loc_41556A:			       ; CODE XREF: _getenv_s_helper+34j
.text:0041556A		       cmp     pReturnValue, ebx
.text:0041556C		       jz      short loc_415570
.text:0041556E		       mov     [pReturnValue], bl
.text:00415570
.text:00415570 loc_415570:			       ; CODE XREF: _getenv_s_helper+3Fj
.text:00415570		       push    edi
.text:00415571		       push    [ebp+varname]   ; option
.text:00415574		       call    __getenv_helper_nolock
.text:00415579		       mov     edi, pReturnValue
.text:0041557B		       cmp     edi, ebx
.text:0041557D		       pop     ecx
.text:0041557E		       jz      short loc_4155B9
.text:00415580		       push    edi	       ; buf
.text:00415581		       call    _strlen
.text:00415586		       inc     pReturnValue
.text:00415587		       cmp     [ebp+sizeInTChars], ebx
.text:0041558A		       pop     ecx
.text:0041558B		       mov     [esi], pReturnValue
.text:0041558D		       jz      short loc_4155B9
.text:0041558F		       cmp     pReturnValue, [ebp+sizeInTChars]
.text:00415592		       jbe     short loc_415599
.text:00415594		       push    22h
.text:00415596		       pop     pReturnValue
.text:00415597		       jmp     short loc_4155BB
.text:00415599 ; ---------------------------------------------------------------------------
.text:00415599
.text:00415599 loc_415599:			       ; CODE XREF: _getenv_s_helper+65j
.text:00415599		       push    edi	       ; _Src
.text:0041559A		       push    [ebp+sizeInTChars] ; _SizeInBytes
.text:0041559D		       push    [ebp+buffer]    ; _Dst
.text:004155A0		       call    _strcpy_s
.text:004155A5		       add     esp, 0Ch
.text:004155A8		       test    pReturnValue, pReturnValue
.text:004155AA		       jz      short loc_4155B9
.text:004155AC		       push    ebx	       ; pReserved
.text:004155AD		       push    ebx	       ; nLine
.text:004155AE		       push    ebx	       ; pszFile
.text:004155AF		       push    ebx	       ; pszFunction
.text:004155B0		       push    ebx	       ; pszExpression
.text:004155B1		       call    __invoke_watson
.text:004155B6		       add     esp, 14h
.text:004155B9
.text:004155B9 loc_4155B9:			       ; CODE XREF: _getenv_s_helper+51j
.text:004155B9					       ; _getenv_s_helper+60j ...
.text:004155B9		       xor     pReturnValue, pReturnValue
.text:004155BB
.text:004155BB loc_4155BB:			       ; CODE XREF: _getenv_s_helper+6Aj
.text:004155BB		       pop     edi
.text:004155BC
.text:004155BC loc_4155BC:			       ; CODE XREF: _getenv_s_helper+26j
.text:004155BC		       pop     esi
.text:004155BD		       pop     ebx
.text:004155BE		       pop     ebp
.text:004155BF		       retn
.text:004155BF _getenv_s_helper	endp
.text:004155BF
.text:004155C0
.text:004155C0 ; =============== S U B R O U T I N E =======================================
.text:004155C0
.text:004155C0 ; Attributes: bp-based frame
.text:004155C0
.text:004155C0 ; int __usercall	dupenv_s_helper<eax>(char **pBuffer<ebx>, unsigned int *pBufferSizeInTChars, const char	*varname)
.text:004155C0 _dupenv_s_helper	proc near
.text:004155C0
.text:004155C0 str	       = dword ptr -4
.text:004155C0 pBufferSizeInTChars= dword ptr  8
.text:004155C0 varname	       = dword ptr  0Ch
.text:004155C0
.text:004155C0 pBuffer = ebx
.text:004155C0		       push    ebp
.text:004155C1		       mov     ebp, esp
.text:004155C3		       push    ecx
.text:004155C4		       push    esi
.text:004155C5		       push    edi
.text:004155C6		       xor     edi, edi
.text:004155C8		       cmp     pBuffer,	edi
.text:004155CA		       jnz     short loc_4155E7
.text:004155CC
.text:004155CC loc_4155CC:			       ; CODE XREF: _dupenv_s_helper+35j
.text:004155CC		       call    __errno
.text:004155D1		       push    16h
.text:004155D3		       pop     esi
.text:004155D4		       push    edi	       ; pReserved
.text:004155D5		       push    edi	       ; nLine
.text:004155D6		       push    edi	       ; pszFile
.text:004155D7		       push    edi	       ; pszFunction
.text:004155D8		       push    edi	       ; pszExpression
.text:004155D9		       mov     [eax], esi
.text:004155DB		       call    __invalid_parameter
.text:004155E0		       add     esp, 14h
.text:004155E3		       mov     eax, esi
.text:004155E5		       jmp     short loc_41565E
.text:004155E7 ; ---------------------------------------------------------------------------
.text:004155E7
.text:004155E7 loc_4155E7:			       ; CODE XREF: _dupenv_s_helper+Aj
.text:004155E7		       mov     eax, [ebp+pBufferSizeInTChars]
.text:004155EA		       cmp     eax, edi
.text:004155EC		       mov     [pBuffer], edi
.text:004155EE		       jz      short loc_4155F2
.text:004155F0		       mov     [eax], edi
.text:004155F2
.text:004155F2 loc_4155F2:			       ; CODE XREF: _dupenv_s_helper+2Ej
.text:004155F2		       cmp     [ebp+varname], edi
.text:004155F5		       jz      short loc_4155CC
.text:004155F7		       push    [ebp+varname]   ; option
.text:004155FA		       call    __getenv_helper_nolock
.text:004155FF		       cmp     eax, edi
.text:00415601		       pop     ecx
.text:00415602		       mov     [ebp+str], eax
.text:00415605		       jz      short loc_41565C
.text:00415607		       push    eax	       ; buf
.text:00415608		       call    _strlen
.text:0041560D		       mov     esi, eax
.text:0041560F		       inc     esi
.text:00415610		       push    1	       ; size
.text:00415612		       push    esi	       ; num
.text:00415613		       call    _calloc
.text:00415618		       add     esp, 0Ch
.text:0041561B		       cmp     eax, edi
.text:0041561D		       mov     [pBuffer], eax
.text:0041561F		       jnz     short loc_415635
.text:00415621		       call    __errno
.text:00415626		       mov     dword ptr [eax],	0Ch
.text:0041562C		       call    __errno
.text:00415631		       mov     eax, [eax]
.text:00415633		       jmp     short loc_41565E
.text:00415635 ; ---------------------------------------------------------------------------
.text:00415635
.text:00415635 loc_415635:			       ; CODE XREF: _dupenv_s_helper+5Fj
.text:00415635		       push    [ebp+str]       ; _Src
.text:00415638		       push    esi	       ; _SizeInBytes
.text:00415639		       push    eax	       ; _Dst
.text:0041563A		       call    _strcpy_s
.text:0041563F		       add     esp, 0Ch
.text:00415642		       test    eax, eax
.text:00415644		       jz      short loc_415653
.text:00415646		       push    edi	       ; pReserved
.text:00415647		       push    edi	       ; nLine
.text:00415648		       push    edi	       ; pszFile
.text:00415649		       push    edi	       ; pszFunction
.text:0041564A		       push    edi	       ; pszExpression
.text:0041564B		       call    __invoke_watson
.text:00415650		       add     esp, 14h
.text:00415653
.text:00415653 loc_415653:			       ; CODE XREF: _dupenv_s_helper+84j
.text:00415653		       mov     eax, [ebp+pBufferSizeInTChars]
.text:00415656		       cmp     eax, edi
.text:00415658		       jz      short loc_41565C
.text:0041565A		       mov     [eax], esi
.text:0041565C
.text:0041565C loc_41565C:			       ; CODE XREF: _dupenv_s_helper+45j
.text:0041565C					       ; _dupenv_s_helper+98j
.text:0041565C		       xor     eax, eax
.text:0041565E
.text:0041565E loc_41565E:			       ; CODE XREF: _dupenv_s_helper+25j
.text:0041565E					       ; _dupenv_s_helper+73j
.text:0041565E		       pop     edi
.text:0041565F		       pop     esi
.text:00415660		       leave
.text:00415661		       retn
.text:00415661 _dupenv_s_helper	endp
.text:00415661
.text:00415662
.text:00415662 ; =============== S U B R O U T I N E =======================================
.text:00415662
.text:00415662 ; Attributes: bp-based frame
.text:00415662
.text:00415662 ; char *__cdecl getenv(const char *option)
.text:00415662 _getenv	       proc near
.text:00415662
.text:00415662 _Expr_val       = dword ptr -20h
.text:00415662 retval	       = dword ptr -1Ch
.text:00415662 ms_exc	       = CPPEH_RECORD ptr -18h
.text:00415662 option	       = dword ptr  8
.text:00415662
.text:00415662		       push    10h
.text:00415664		       push    offset dword_421A60
.text:00415669		       call    __SEH_prolog4
.text:0041566E		       xor     eax, eax
.text:00415670		       xor     esi, esi
.text:00415672		       cmp     [ebp+option], esi
.text:00415675		       setnz   al
.text:00415678		       cmp     eax, esi
.text:0041567A		       jnz     short loc_415698
.text:0041567C
.text:0041567C loc_41567C:			       ; CODE XREF: _getenv+4Cj
.text:0041567C		       call    __errno
.text:00415681		       mov     dword ptr [eax],	16h
.text:00415687		       push    esi	       ; pReserved
.text:00415688		       push    esi	       ; nLine
.text:00415689		       push    esi	       ; pszFile
.text:0041568A		       push    esi	       ; pszFunction
.text:0041568B		       push    esi	       ; pszExpression
.text:0041568C		       call    __invalid_parameter
.text:00415691		       add     esp, 14h
.text:00415694		       xor     eax, eax
.text:00415696		       jmp     short loc_4156D6
.text:00415698 ; ---------------------------------------------------------------------------
.text:00415698
.text:00415698 loc_415698:			       ; CODE XREF: _getenv+18j
.text:00415698		       mov     edi, 7FFFh
.text:0041569D		       push    edi	       ; maxsize
.text:0041569E		       push    [ebp+option]    ; str
.text:004156A1		       call    _strnlen
.text:004156A6		       pop     ecx
.text:004156A7		       pop     ecx
.text:004156A8		       cmp     eax, edi
.text:004156AA		       sbb     eax, eax
.text:004156AC		       neg     eax
.text:004156AE		       jz      short loc_41567C
.text:004156B0		       push    7	       ; locknum
.text:004156B2		       call    __lock
.text:004156B7		       pop     ecx
.text:004156B8		       mov     [ebp+ms_exc.disabled], esi
.text:004156BB		       push    [ebp+option]    ; option
.text:004156BE		       call    __getenv_helper_nolock
.text:004156C3		       pop     ecx
.text:004156C4		       mov     [ebp+retval], eax
.text:004156C7		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004156CE		       call    $LN7_10
.text:004156D3
.text:004156D3 $LN10_9:
.text:004156D3		       mov     eax, [ebp+retval]
.text:004156D6
.text:004156D6 loc_4156D6:			       ; CODE XREF: _getenv+34j
.text:004156D6		       call    __SEH_epilog4
.text:004156DB		       retn
.text:004156DC ; ---------------------------------------------------------------------------
.text:004156DC
.text:004156DC $LN7_10:				       ; CODE XREF: _getenv+6Cp
.text:004156DC					       ; DATA XREF: .rdata:00421A78o
.text:004156DC		       push    7	       ; locknum
.text:004156DE		       call    __unlock
.text:004156E3		       pop     ecx
.text:004156E4
.text:004156E4 $LN8_10:
.text:004156E4		       retn
.text:004156E4 _getenv	       endp
.text:004156E4
.text:004156E5
.text:004156E5 ; =============== S U B R O U T I N E =======================================
.text:004156E5
.text:004156E5 ; Attributes: noreturn bp-based frame
.text:004156E5
.text:004156E5 ; int __cdecl getenv_s(unsigned int *pReturnValue, char *buffer,	unsigned int sizeInTChars, const char *varname)
.text:004156E5 _getenv_s       proc near
.text:004156E5
.text:004156E5 retval	       = dword ptr -1Ch
.text:004156E5 ms_exc	       = CPPEH_RECORD ptr -18h
.text:004156E5 pReturnValue    = dword ptr  8
.text:004156E5 buffer	       = dword ptr  0Ch
.text:004156E5 sizeInTChars    = dword ptr  10h
.text:004156E5 varname	       = dword ptr  14h
.text:004156E5
.text:004156E5		       push    0Ch
.text:004156E7		       push    offset dword_421A80
.text:004156EC		       call    __SEH_prolog4
.text:004156F1		       push    7	       ; locknum
.text:004156F3		       call    __lock
.text:004156F8		       pop     ecx
.text:004156F9		       xor     ebx, ebx
.text:004156FB		       mov     [ebp+ms_exc.disabled], ebx
.text:004156FE		       xor     eax, eax
.text:00415700		       mov     edi, [ebp+pReturnValue]
.text:00415703		       cmp     edi, ebx
.text:00415705		       setnz   al
.text:00415708		       cmp     eax, ebx
.text:0041570A		       jnz     short loc_415728
.text:0041570C
.text:0041570C loc_41570C:			       ; CODE XREF: _getenv_s+63j
.text:0041570C		       call    __errno
.text:00415711		       push    16h
.text:00415713		       pop     esi
.text:00415714		       mov     [eax], esi
.text:00415716		       push    ebx	       ; pReserved
.text:00415717		       push    ebx	       ; nLine
.text:00415718		       push    ebx	       ; pszFile
.text:00415719		       push    ebx	       ; pszFunction
.text:0041571A		       push    ebx	       ; pszExpression
.text:0041571B		       call    __invalid_parameter
.text:00415720		       add     esp, 14h
.text:00415723		       mov     [ebp+retval], esi
.text:00415726		       jmp     short loc_41579F
.text:00415728 ; ---------------------------------------------------------------------------
.text:00415728
.text:00415728 loc_415728:			       ; CODE XREF: _getenv_s+25j
.text:00415728		       mov     [edi], ebx
.text:0041572A		       mov     ecx, [ebp+buffer]
.text:0041572D		       cmp     ecx, ebx
.text:0041572F		       jz      short loc_41573A
.text:00415731		       cmp     [ebp+sizeInTChars], ebx
.text:00415734		       ja      short loc_41573F
.text:00415736		       cmp     ecx, ebx
.text:00415738		       jnz     short loc_415744
.text:0041573A
.text:0041573A loc_41573A:			       ; CODE XREF: _getenv_s+4Aj
.text:0041573A		       cmp     [ebp+sizeInTChars], ebx
.text:0041573D		       jnz     short loc_415744
.text:0041573F
.text:0041573F loc_41573F:			       ; CODE XREF: _getenv_s+4Fj
.text:0041573F		       xor     eax, eax
.text:00415741		       inc     eax
.text:00415742		       jmp     short loc_415746
.text:00415744 ; ---------------------------------------------------------------------------
.text:00415744
.text:00415744 loc_415744:			       ; CODE XREF: _getenv_s+53j
.text:00415744					       ; _getenv_s+58j
.text:00415744		       xor     eax, eax
.text:00415746
.text:00415746 loc_415746:			       ; CODE XREF: _getenv_s+5Dj
.text:00415746		       cmp     eax, ebx
.text:00415748		       jz      short loc_41570C
.text:0041574A		       cmp     ecx, ebx
.text:0041574C		       jz      short loc_415750
.text:0041574E		       mov     [ecx], bl
.text:00415750
.text:00415750 loc_415750:			       ; CODE XREF: _getenv_s+67j
.text:00415750		       push    [ebp+varname]   ; option
.text:00415753		       call    __getenv_helper_nolock
.text:00415758		       pop     ecx
.text:00415759		       mov     esi, eax
.text:0041575B		       cmp     esi, ebx
.text:0041575D		       jz      short loc_41579C
.text:0041575F		       push    esi	       ; buf
.text:00415760		       call    _strlen
.text:00415765		       pop     ecx
.text:00415766		       inc     eax
.text:00415767		       mov     [edi], eax
.text:00415769		       cmp     [ebp+sizeInTChars], ebx
.text:0041576C		       jz      short loc_41579C
.text:0041576E		       cmp     eax, [ebp+sizeInTChars]
.text:00415771		       jbe     short loc_41577C
.text:00415773		       mov     [ebp+retval], 22h
.text:0041577A		       jmp     short loc_41579F
.text:0041577C ; ---------------------------------------------------------------------------
.text:0041577C
.text:0041577C loc_41577C:			       ; CODE XREF: _getenv_s+8Cj
.text:0041577C		       push    esi	       ; _Src
.text:0041577D		       push    [ebp+sizeInTChars] ; _SizeInBytes
.text:00415780		       push    [ebp+buffer]    ; _Dst
.text:00415783		       call    _strcpy_s
.text:00415788		       add     esp, 0Ch
.text:0041578B		       cmp     eax, ebx
.text:0041578D		       jz      short loc_41579C
.text:0041578F		       push    ebx	       ; pReserved
.text:00415790		       push    ebx	       ; nLine
.text:00415791		       push    ebx	       ; pszFile
.text:00415792		       push    ebx	       ; pszFunction
.text:00415793		       push    ebx	       ; pszExpression
.text:00415794		       call    __invoke_watson
.text:00415799		       add     esp, 14h
.text:0041579C
.text:0041579C loc_41579C:			       ; CODE XREF: _getenv_s+78j
.text:0041579C					       ; _getenv_s+87j	...
.text:0041579C		       mov     [ebp+retval], ebx
.text:0041579F
.text:0041579F loc_41579F:			       ; CODE XREF: _getenv_s+41j
.text:0041579F					       ; _getenv_s+95j
.text:0041579F		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:004157A6		       call    $LN5_3
.text:004157AB ; ---------------------------------------------------------------------------
.text:004157AB
.text:004157AB $LN8_11:
.text:004157AB		       mov     eax, [ebp+retval]
.text:004157AE		       call    __SEH_epilog4
.text:004157B3		       retn
.text:004157B4 ; ---------------------------------------------------------------------------
.text:004157B4
.text:004157B4 $LN5_3:				       ; CODE XREF: _getenv_s+C1p
.text:004157B4					       ; DATA XREF: .rdata:00421A98o
.text:004157B4		       push    7	       ; locknum
.text:004157B6		       call    __unlock
.text:004157BB		       pop     ecx
.text:004157BC
.text:004157BC $LN6_11:
.text:004157BC		       retn
.text:004157BC _getenv_s       endp
.text:004157BC
.text:004157BD
.text:004157BD ; =============== S U B R O U T I N E =======================================
.text:004157BD
.text:004157BD ; Attributes: noreturn bp-based frame
.text:004157BD
.text:004157BD ; int __cdecl _dupenv_s(char **pBuffer, unsigned	int *pBufferSizeInTChars, const	char *varname)
.text:004157BD __dupenv_s      proc near
.text:004157BD
.text:004157BD _Src	       = dword ptr -20h
.text:004157BD retval	       = dword ptr -1Ch
.text:004157BD ms_exc	       = CPPEH_RECORD ptr -18h
.text:004157BD pBuffer	       = dword ptr  8
.text:004157BD pBufferSizeInTChars= dword ptr  0Ch
.text:004157BD varname	       = dword ptr  10h
.text:004157BD
.text:004157BD		       push    10h
.text:004157BF		       push    offset dword_421AA0
.text:004157C4		       call    __SEH_prolog4
.text:004157C9		       push    7	       ; locknum
.text:004157CB		       call    __lock
.text:004157D0		       pop     ecx
.text:004157D1		       xor     esi, esi
.text:004157D3		       mov     [ebp+ms_exc.disabled], esi
.text:004157D6		       xor     eax, eax
.text:004157D8		       mov     ebx, [ebp+pBuffer]
.text:004157DB		       cmp     ebx, esi
.text:004157DD		       setnz   al
.text:004157E0		       cmp     eax, esi
.text:004157E2		       jnz     short loc_415803
.text:004157E4
.text:004157E4 loc_4157E4:			       ; CODE XREF: __dupenv_s+5Bj
.text:004157E4		       call    __errno
.text:004157E9		       push    16h
.text:004157EB		       pop     edi
.text:004157EC		       mov     [eax], edi
.text:004157EE		       push    esi	       ; pReserved
.text:004157EF		       push    esi	       ; nLine
.text:004157F0		       push    esi	       ; pszFile
.text:004157F1		       push    esi	       ; pszFunction
.text:004157F2		       push    esi	       ; pszExpression
.text:004157F3		       call    __invalid_parameter
.text:004157F8		       add     esp, 14h
.text:004157FB		       mov     [ebp+retval], edi
.text:004157FE		       jmp     loc_415885
.text:00415803 ; ---------------------------------------------------------------------------
.text:00415803
.text:00415803 loc_415803:			       ; CODE XREF: __dupenv_s+25j
.text:00415803		       mov     [ebx], esi
.text:00415805		       mov     eax, [ebp+pBufferSizeInTChars]
.text:00415808		       cmp     eax, esi
.text:0041580A		       jz      short loc_41580E
.text:0041580C		       mov     [eax], esi
.text:0041580E
.text:0041580E loc_41580E:			       ; CODE XREF: __dupenv_s+4Dj
.text:0041580E		       xor     eax, eax
.text:00415810		       cmp     [ebp+varname], esi
.text:00415813		       setnz   al
.text:00415816		       cmp     eax, esi
.text:00415818		       jz      short loc_4157E4
.text:0041581A		       push    [ebp+varname]   ; option
.text:0041581D		       call    __getenv_helper_nolock
.text:00415822		       pop     ecx
.text:00415823		       mov     [ebp+_Src], eax
.text:00415826		       cmp     eax, esi
.text:00415828		       jz      short loc_415882
.text:0041582A		       push    eax	       ; buf
.text:0041582B		       call    _strlen
.text:00415830		       mov     edi, eax
.text:00415832		       inc     edi
.text:00415833		       push    1	       ; size
.text:00415835		       push    edi	       ; num
.text:00415836		       call    _calloc
.text:0041583B		       add     esp, 0Ch
.text:0041583E		       mov     [ebx], eax
.text:00415840		       cmp     eax, esi
.text:00415842		       jnz     short loc_41585B
.text:00415844		       call    __errno
.text:00415849		       mov     dword ptr [eax],	0Ch
.text:0041584F		       call    __errno
.text:00415854		       mov     eax, [eax]
.text:00415856		       mov     [ebp+retval], eax
.text:00415859		       jmp     short loc_415885
.text:0041585B ; ---------------------------------------------------------------------------
.text:0041585B
.text:0041585B loc_41585B:			       ; CODE XREF: __dupenv_s+85j
.text:0041585B		       push    [ebp+_Src]      ; _Src
.text:0041585E		       push    edi	       ; _SizeInBytes
.text:0041585F		       push    eax	       ; _Dst
.text:00415860		       call    _strcpy_s
.text:00415865		       add     esp, 0Ch
.text:00415868		       cmp     eax, esi
.text:0041586A		       jz      short loc_415879
.text:0041586C		       push    esi	       ; pReserved
.text:0041586D		       push    esi	       ; nLine
.text:0041586E		       push    esi	       ; pszFile
.text:0041586F		       push    esi	       ; pszFunction
.text:00415870		       push    esi	       ; pszExpression
.text:00415871		       call    __invoke_watson
.text:00415876		       add     esp, 14h
.text:00415879
.text:00415879 loc_415879:			       ; CODE XREF: __dupenv_s+ADj
.text:00415879		       mov     eax, [ebp+pBufferSizeInTChars]
.text:0041587C		       cmp     eax, esi
.text:0041587E		       jz      short loc_415882
.text:00415880		       mov     [eax], edi
.text:00415882
.text:00415882 loc_415882:			       ; CODE XREF: __dupenv_s+6Bj
.text:00415882					       ; __dupenv_s+C1j
.text:00415882		       mov     [ebp+retval], esi
.text:00415885
.text:00415885 loc_415885:			       ; CODE XREF: __dupenv_s+41j
.text:00415885					       ; __dupenv_s+9Cj
.text:00415885		       mov     [ebp+ms_exc.disabled], 0FFFFFFFEh
.text:0041588C		       call    $LN5_4
.text:00415891 ; ---------------------------------------------------------------------------
.text:00415891
.text:00415891 $LN8_12:
.text:00415891		       mov     eax, [ebp+retval]
.text:00415894		       call    __SEH_epilog4
.text:00415899		       retn
.text:0041589A ; ---------------------------------------------------------------------------
.text:0041589A
.text:0041589A $LN5_4:				       ; CODE XREF: __dupenv_s+CFp
.text:0041589A					       ; DATA XREF: .rdata:00421AB8o
.text:0041589A		       push    7	       ; locknum
.text:0041589C		       call    __unlock
.text:004158A1		       pop     ecx
.text:004158A2
.text:004158A2 $LN6_12:
.text:004158A2		       retn
.text:004158A2 __dupenv_s      endp
.text:004158A2
.text:004158A3
.text:004158A3 ; =============== S U B R O U T I N E =======================================
.text:004158A3
.text:004158A3
.text:004158A3 ; int __cdecl _tolower(int c)
.text:004158A3 __tolower       proc near
.text:004158A3
.text:004158A3 c	       = dword ptr  4
.text:004158A3
.text:004158A3		       mov     eax, [esp+c]
.text:004158A7		       add     eax, 20h
.text:004158AA		       retn
.text:004158AA __tolower       endp
.text:004158AA
.text:004158AB
.text:004158AB ; =============== S U B R O U T I N E =======================================
.text:004158AB
.text:004158AB ; Attributes: bp-based frame
.text:004158AB
.text:004158AB ; int __cdecl _tolower_l(int c, localeinfo_struct *plocinfo)
.text:004158AB __tolower_l     proc near	       ; CODE XREF: __stricmp_l+9Bp
.text:004158AB					       ; __stricmp_l+ADp ...
.text:004158AB
.text:004158AB _loc_update     = _LocaleUpdate ptr -18h
.text:004158AB outbuffer       = byte ptr -8
.text:004158AB inbuffer	       = byte ptr -4
.text:004158AB c	       = dword ptr  8
.text:004158AB plocinfo	       = dword ptr  0Ch
.text:004158AB
.text:004158AB		       push    ebp
.text:004158AC		       mov     ebp, esp
.text:004158AE		       sub     esp, 18h
.text:004158B1		       push    ebx
.text:004158B2		       push    esi
.text:004158B3		       push    [ebp+plocinfo]  ; plocinfo
.text:004158B6		       lea     ecx, [ebp+_loc_update] ;	this
.text:004158B9		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004158BE		       mov     ebx, [ebp+c]
.text:004158C1		       mov     esi, 100h
.text:004158C6		       cmp     ebx, esi
.text:004158C8		       jnb     short loc_41591E
.text:004158CA		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:004158CD		       cmp     dword ptr [ecx+0ACh], 1
.text:004158D4		       jle     short loc_4158EA
.text:004158D6		       lea     eax, [ebp+_loc_update]
.text:004158D9		       push    eax	       ; plocinfo
.text:004158DA		       push    1	       ; mask
.text:004158DC		       push    ebx	       ; c
.text:004158DD		       call    __isctype_l
.text:004158E2		       mov     ecx, [ebp+_loc_update.localeinfo.locinfo]
.text:004158E5		       add     esp, 0Ch
.text:004158E8		       jmp     short loc_4158F7
.text:004158EA ; ---------------------------------------------------------------------------
.text:004158EA
.text:004158EA loc_4158EA:			       ; CODE XREF: __tolower_l+29j
.text:004158EA		       mov     eax, [ecx+0C8h]
.text:004158F0		       movzx   eax, byte ptr [eax+ebx*2]
.text:004158F4		       and     eax, 1
.text:004158F7
.text:004158F7 loc_4158F7:			       ; CODE XREF: __tolower_l+3Dj
.text:004158F7		       test    eax, eax
.text:004158F9		       jz      short loc_41590A
.text:004158FB		       mov     eax, [ecx+0CCh]
.text:00415901		       movzx   eax, byte ptr [eax+ebx]
.text:00415905		       jmp     loc_4159B1
.text:0041590A ; ---------------------------------------------------------------------------
.text:0041590A
.text:0041590A loc_41590A:			       ; CODE XREF: __tolower_l+4Ej
.text:0041590A					       ; __tolower_l+EAj
.text:0041590A		       cmp     [ebp+_loc_update.updated], 0
.text:0041590E		       jz      short loc_415917
.text:00415910		       mov     eax, [ebp+_loc_update.ptd]
.text:00415913		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415917
.text:00415917 loc_415917:			       ; CODE XREF: __tolower_l+63j
.text:00415917		       mov     eax, ebx
.text:00415919		       jmp     loc_4159BE
.text:0041591E ; ---------------------------------------------------------------------------
.text:0041591E
.text:0041591E loc_41591E:			       ; CODE XREF: __tolower_l+1Dj
.text:0041591E		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00415921		       cmp     dword ptr [eax+0ACh], 1
.text:00415928		       jle     short loc_41595B
.text:0041592A		       mov     [ebp+c],	ebx
.text:0041592D		       sar     [ebp+c],	8
.text:00415931		       lea     eax, [ebp+_loc_update]
.text:00415934		       push    eax	       ; plocinfo
.text:00415935		       mov     eax, [ebp+c]
.text:00415938		       and     eax, 0FFh
.text:0041593D		       push    eax	       ; c
.text:0041593E		       call    __isleadbyte_l
.text:00415943		       test    eax, eax
.text:00415945		       pop     ecx
.text:00415946		       pop     ecx
.text:00415947		       jz      short loc_41595B
.text:00415949		       mov     al, byte	ptr [ebp+c]
.text:0041594C		       push    2
.text:0041594E		       mov     [ebp+inbuffer], al
.text:00415951		       mov     [ebp+inbuffer+1], bl
.text:00415954		       mov     [ebp+inbuffer+2], 0
.text:00415958		       pop     ecx
.text:00415959		       jmp     short loc_415970
.text:0041595B ; ---------------------------------------------------------------------------
.text:0041595B
.text:0041595B loc_41595B:			       ; CODE XREF: __tolower_l+7Dj
.text:0041595B					       ; __tolower_l+9Cj
.text:0041595B		       call    __errno
.text:00415960		       mov     dword ptr [eax],	2Ah
.text:00415966		       xor     ecx, ecx
.text:00415968		       mov     [ebp+inbuffer], bl
.text:0041596B		       mov     [ebp+inbuffer+1], 0
.text:0041596F		       inc     ecx
.text:00415970
.text:00415970 loc_415970:			       ; CODE XREF: __tolower_l+AEj
.text:00415970		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:00415973		       push    1	       ; bError
.text:00415975		       push    dword ptr [eax+4] ; code_page
.text:00415978		       lea     edx, [ebp+outbuffer]
.text:0041597B		       push    3	       ; cchDest
.text:0041597D		       push    edx	       ; lpDestStr
.text:0041597E		       push    ecx	       ; cchSrc
.text:0041597F		       lea     ecx, [ebp+inbuffer]
.text:00415982		       push    ecx	       ; lpSrcStr
.text:00415983		       push    esi	       ; dwMapFlags
.text:00415984		       push    dword ptr [eax+14h] ; Locale
.text:00415987		       lea     eax, [ebp+_loc_update]
.text:0041598A		       push    eax	       ; plocinfo
.text:0041598B		       call    ___crtLCMapStringA
.text:00415990		       add     esp, 24h
.text:00415993		       test    eax, eax
.text:00415995		       jz      loc_41590A
.text:0041599B		       cmp     eax, 1
.text:0041599E		       jnz     short loc_4159A6
.text:004159A0		       movzx   eax, [ebp+outbuffer]
.text:004159A4		       jmp     short loc_4159B1
.text:004159A6 ; ---------------------------------------------------------------------------
.text:004159A6
.text:004159A6 loc_4159A6:			       ; CODE XREF: __tolower_l+F3j
.text:004159A6		       movzx   ecx, [ebp+outbuffer+1]
.text:004159AA		       xor     eax, eax
.text:004159AC		       mov     ah, [ebp+outbuffer]
.text:004159AF		       or      eax, ecx
.text:004159B1
.text:004159B1 loc_4159B1:			       ; CODE XREF: __tolower_l+5Aj
.text:004159B1					       ; __tolower_l+F9j
.text:004159B1		       cmp     [ebp+_loc_update.updated], 0
.text:004159B5		       jz      short loc_4159BE
.text:004159B7		       mov     ecx, [ebp+_loc_update.ptd]
.text:004159BA		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:004159BE
.text:004159BE loc_4159BE:			       ; CODE XREF: __tolower_l+6Ej
.text:004159BE					       ; __tolower_l+10Aj
.text:004159BE		       pop     esi
.text:004159BF		       pop     ebx
.text:004159C0		       leave
.text:004159C1		       retn
.text:004159C1 __tolower_l     endp
.text:004159C1
.text:004159C2
.text:004159C2 ; =============== S U B R O U T I N E =======================================
.text:004159C2
.text:004159C2
.text:004159C2 ; int __cdecl tolower(int c)
.text:004159C2 _tolower	       proc near
.text:004159C2
.text:004159C2 c	       = dword ptr  4
.text:004159C2
.text:004159C2		       cmp     ___locale_changed, 0
.text:004159C9		       jnz     short loc_4159DB
.text:004159CB		       mov     eax, [esp+c]
.text:004159CF		       lea     ecx, [eax-41h]
.text:004159D2		       cmp     ecx, 19h
.text:004159D5		       ja      short locret_4159E8
.text:004159D7		       add     eax, 20h
.text:004159DA		       retn
.text:004159DB ; ---------------------------------------------------------------------------
.text:004159DB
.text:004159DB loc_4159DB:			       ; CODE XREF: _tolower+7j
.text:004159DB		       push    0	       ; plocinfo
.text:004159DD		       push    [esp+4+c]       ; c
.text:004159E1		       call    __tolower_l
.text:004159E6		       pop     ecx
.text:004159E7		       pop     ecx
.text:004159E8
.text:004159E8 locret_4159E8:			       ; CODE XREF: _tolower+13j
.text:004159E8		       retn
.text:004159E8 _tolower	       endp
.text:004159E8
.text:004159E9
.text:004159E9 ; =============== S U B R O U T I N E =======================================
.text:004159E9
.text:004159E9 ; Attributes: bp-based frame
.text:004159E9
.text:004159E9 ; unsigned __int64 __cdecl strtoxq(localeinfo_struct *plocinfo, const char *nptr, const char **endptr, int ibase, int flags)
.text:004159E9 strtoxq	       proc near	       ; CODE XREF: __strtoi64:loc_415C9Cp
.text:004159E9					       ; __strtoi64_l+12p ...
.text:004159E9
.text:004159E9 _loc_update     = _LocaleUpdate ptr -38h
.text:004159E9 var_24	       = dword ptr -24h
.text:004159E9 var_20	       = dword ptr -20h
.text:004159E9 var_1C	       = dword ptr -1Ch
.text:004159E9 maxval	       = qword ptr -18h
.text:004159E9 number	       = qword ptr -10h
.text:004159E9 p	       = dword ptr -8
.text:004159E9 c	       = byte ptr -1
.text:004159E9 plocinfo	       = dword ptr  8
.text:004159E9 nptr	       = dword ptr  0Ch
.text:004159E9 endptr	       = dword ptr  10h
.text:004159E9 ibase	       = dword ptr  14h
.text:004159E9 flags	       = dword ptr  18h
.text:004159E9
.text:004159E9		       push    ebp
.text:004159EA		       mov     ebp, esp
.text:004159EC		       sub     esp, 38h
.text:004159EF		       push    ebx
.text:004159F0		       push    edi
.text:004159F1		       push    [ebp+plocinfo]  ; plocinfo
.text:004159F4		       lea     ecx, [ebp+_loc_update] ;	this
.text:004159F7		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004159FC		       mov     eax, [ebp+endptr]
.text:004159FF		       mov     edi, [ebp+nptr]
.text:00415A02		       xor     ebx, ebx
.text:00415A04		       cmp     eax, ebx
.text:00415A06		       jz      short loc_415A0A
.text:00415A08		       mov     [eax], edi
.text:00415A0A
.text:00415A0A loc_415A0A:			       ; CODE XREF: strtoxq+1Dj
.text:00415A0A		       cmp     edi, ebx
.text:00415A0C		       jnz     short loc_415A3B
.text:00415A0E
.text:00415A0E loc_415A0E:			       ; CODE XREF: strtoxq+5Bj
.text:00415A0E					       ; strtoxq+61j
.text:00415A0E		       call    __errno
.text:00415A13		       push    ebx	       ; pReserved
.text:00415A14		       push    ebx	       ; nLine
.text:00415A15		       push    ebx	       ; pszFile
.text:00415A16		       push    ebx	       ; pszFunction
.text:00415A17		       push    ebx	       ; pszExpression
.text:00415A18		       mov     dword ptr [eax],	16h
.text:00415A1E		       call    __invalid_parameter
.text:00415A23		       add     esp, 14h
.text:00415A26		       cmp     [ebp+_loc_update.updated], bl
.text:00415A29		       jz      short loc_415A32
.text:00415A2B		       mov     eax, [ebp+_loc_update.ptd]
.text:00415A2E		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415A32
.text:00415A32 loc_415A32:			       ; CODE XREF: strtoxq+40j
.text:00415A32		       xor     eax, eax
.text:00415A34		       xor     edx, edx
.text:00415A36		       jmp     loc_415C79
.text:00415A3B ; ---------------------------------------------------------------------------
.text:00415A3B
.text:00415A3B loc_415A3B:			       ; CODE XREF: strtoxq+23j
.text:00415A3B		       cmp     [ebp+ibase], ebx
.text:00415A3E		       jz      short loc_415A4C
.text:00415A40		       cmp     [ebp+ibase], 2
.text:00415A44		       jl      short loc_415A0E
.text:00415A46		       cmp     [ebp+ibase], 24h
.text:00415A4A		       jg      short loc_415A0E
.text:00415A4C
.text:00415A4C loc_415A4C:			       ; CODE XREF: strtoxq+55j
.text:00415A4C		       push    esi
.text:00415A4D		       mov     esi, [ebp+_loc_update.localeinfo.locinfo]
.text:00415A50		       mov     dword ptr [ebp+number], ebx
.text:00415A53		       mov     dword ptr [ebp+number+4], ebx
.text:00415A56
.text:00415A56 loc_415A56:			       ; CODE XREF: strtoxq+A7j
.text:00415A56		       mov     al, [edi]
.text:00415A58		       inc     edi
.text:00415A59		       cmp     dword ptr [esi+0ACh], 1
.text:00415A60		       mov     [ebp+c],	al
.text:00415A63		       jle     short loc_415A7D
.text:00415A65		       lea     eax, [ebp+_loc_update]
.text:00415A68		       push    eax	       ; plocinfo
.text:00415A69		       movzx   eax, [ebp+c]
.text:00415A6D		       push    8	       ; mask
.text:00415A6F		       push    eax	       ; c
.text:00415A70		       call    __isctype_l
.text:00415A75		       mov     esi, [ebp+_loc_update.localeinfo.locinfo]
.text:00415A78		       add     esp, 0Ch
.text:00415A7B		       jmp     short loc_415A8E
.text:00415A7D ; ---------------------------------------------------------------------------
.text:00415A7D
.text:00415A7D loc_415A7D:			       ; CODE XREF: strtoxq+7Aj
.text:00415A7D		       movzx   eax, [ebp+c]
.text:00415A81		       mov     ecx, [esi+0C8h]
.text:00415A87		       movzx   eax, byte ptr [ecx+eax*2]
.text:00415A8B		       and     eax, 8
.text:00415A8E
.text:00415A8E loc_415A8E:			       ; CODE XREF: strtoxq+92j
.text:00415A8E		       cmp     eax, ebx
.text:00415A90		       jnz     short loc_415A56
.text:00415A92		       cmp     [ebp+c],	2Dh
.text:00415A96		       mov     [ebp+p],	edi
.text:00415A99		       jnz     short loc_415AA1
.text:00415A9B		       or      [ebp+flags], 2
.text:00415A9F		       jmp     short loc_415AA7
.text:00415AA1 ; ---------------------------------------------------------------------------
.text:00415AA1
.text:00415AA1 loc_415AA1:			       ; CODE XREF: strtoxq+B0j
.text:00415AA1		       cmp     [ebp+c],	2Bh
.text:00415AA5		       jnz     short loc_415AB0
.text:00415AA7
.text:00415AA7 loc_415AA7:			       ; CODE XREF: strtoxq+B6j
.text:00415AA7		       mov     al, [edi]
.text:00415AA9		       inc     edi
.text:00415AAA		       mov     [ebp+p],	edi
.text:00415AAD		       mov     [ebp+c],	al
.text:00415AB0
.text:00415AB0 loc_415AB0:			       ; CODE XREF: strtoxq+BCj
.text:00415AB0		       cmp     [ebp+ibase], ebx
.text:00415AB3		       push    10h
.text:00415AB5		       pop     ecx
.text:00415AB6		       jnz     short loc_415ADD
.text:00415AB8		       cmp     [ebp+c],	30h
.text:00415ABC		       jz      short loc_415AC7
.text:00415ABE		       mov     [ebp+ibase], 0Ah
.text:00415AC5		       jmp     short loc_415AFC
.text:00415AC7 ; ---------------------------------------------------------------------------
.text:00415AC7
.text:00415AC7 loc_415AC7:			       ; CODE XREF: strtoxq+D3j
.text:00415AC7		       mov     al, [edi]
.text:00415AC9		       cmp     al, 78h
.text:00415ACB		       jz      short loc_415ADA
.text:00415ACD		       cmp     al, 58h
.text:00415ACF		       jz      short loc_415ADA
.text:00415AD1		       mov     [ebp+ibase], 8
.text:00415AD8		       jmp     short loc_415AFC
.text:00415ADA ; ---------------------------------------------------------------------------
.text:00415ADA
.text:00415ADA loc_415ADA:			       ; CODE XREF: strtoxq+E2j
.text:00415ADA					       ; strtoxq+E6j
.text:00415ADA		       mov     [ebp+ibase], ecx
.text:00415ADD
.text:00415ADD loc_415ADD:			       ; CODE XREF: strtoxq+CDj
.text:00415ADD		       cmp     [ebp+ibase], ecx
.text:00415AE0		       jnz     short loc_415AFC
.text:00415AE2		       cmp     [ebp+c],	30h
.text:00415AE6		       jnz     short loc_415AFC
.text:00415AE8		       mov     al, [edi]
.text:00415AEA		       cmp     al, 78h
.text:00415AEC		       jz      short loc_415AF2
.text:00415AEE		       cmp     al, 58h
.text:00415AF0		       jnz     short loc_415AFC
.text:00415AF2
.text:00415AF2 loc_415AF2:			       ; CODE XREF: strtoxq+103j
.text:00415AF2		       inc     edi
.text:00415AF3		       mov     al, [edi]
.text:00415AF5		       inc     edi
.text:00415AF6		       mov     [ebp+c],	al
.text:00415AF9		       mov     [ebp+p],	edi
.text:00415AFC
.text:00415AFC loc_415AFC:			       ; CODE XREF: strtoxq+DCj
.text:00415AFC					       ; strtoxq+EFj ...
.text:00415AFC		       mov     eax, [ebp+ibase]
.text:00415AFF		       cdq
.text:00415B00		       push    edx
.text:00415B01		       mov     edi, eax
.text:00415B03		       push    edi
.text:00415B04		       push    0FFFFFFFFh
.text:00415B06		       push    0FFFFFFFFh
.text:00415B08		       mov     [ebp+var_24], edx
.text:00415B0B		       call    __aulldvrm
.text:00415B10		       mov     [ebp+var_1C], ebx
.text:00415B13		       mov     ebx, [esi+0C8h]
.text:00415B19		       mov     [ebp+var_20], ecx
.text:00415B1C		       mov     dword ptr [ebp+maxval], eax
.text:00415B1F		       mov     dword ptr [ebp+maxval+4], edx
.text:00415B22
.text:00415B22 loc_415B22:			       ; CODE XREF: strtoxq+1ECj
.text:00415B22		       mov     cl, [ebp+c]
.text:00415B25		       movzx   eax, cl
.text:00415B28		       movzx   eax, word ptr [ebx+eax*2]
.text:00415B2C		       test    al, 4
.text:00415B2E		       jz      short loc_415B38
.text:00415B30		       movsx   esi, cl
.text:00415B33		       sub     esi, 30h
.text:00415B36		       jmp     short loc_415B4F
.text:00415B38 ; ---------------------------------------------------------------------------
.text:00415B38
.text:00415B38 loc_415B38:			       ; CODE XREF: strtoxq+145j
.text:00415B38		       test    ax, 103h
.text:00415B3C		       jz      short loc_415B8F
.text:00415B3E		       mov     al, cl
.text:00415B40		       sub     al, 61h
.text:00415B42		       cmp     al, 19h
.text:00415B44		       movsx   eax, cl
.text:00415B47		       ja      short loc_415B4C
.text:00415B49		       sub     eax, 20h
.text:00415B4C
.text:00415B4C loc_415B4C:			       ; CODE XREF: strtoxq+15Ej
.text:00415B4C		       lea     esi, [eax-37h]
.text:00415B4F
.text:00415B4F loc_415B4F:			       ; CODE XREF: strtoxq+14Dj
.text:00415B4F		       cmp     esi, [ebp+ibase]
.text:00415B52		       jnb     short loc_415B8F
.text:00415B54		       mov     ecx, dword ptr [ebp+number+4]
.text:00415B57		       or      [ebp+flags], 8
.text:00415B5B		       cmp     ecx, dword ptr [ebp+maxval+4]
.text:00415B5E		       jb      short loc_415BB1
.text:00415B60		       ja      short loc_415B6A
.text:00415B62		       mov     eax, dword ptr [ebp+number]
.text:00415B65		       cmp     eax, dword ptr [ebp+maxval]
.text:00415B68		       jb      short loc_415BB1
.text:00415B6A
.text:00415B6A loc_415B6A:			       ; CODE XREF: strtoxq+177j
.text:00415B6A		       mov     eax, dword ptr [ebp+maxval]
.text:00415B6D		       cmp     dword ptr [ebp+number], eax
.text:00415B70		       jnz     short loc_415B85
.text:00415B72		       cmp     ecx, dword ptr [ebp+maxval+4]
.text:00415B75		       jnz     short loc_415B85
.text:00415B77		       xor     eax, eax
.text:00415B79		       cmp     eax, [ebp+var_1C]
.text:00415B7C		       jb      short loc_415BB1
.text:00415B7E		       ja      short loc_415B85
.text:00415B80		       cmp     esi, [ebp+var_20]
.text:00415B83		       jbe     short loc_415BB1
.text:00415B85
.text:00415B85 loc_415B85:			       ; CODE XREF: strtoxq+187j
.text:00415B85					       ; strtoxq+18Cj ...
.text:00415B85		       or      [ebp+flags], 4
.text:00415B89		       cmp     [ebp+endptr], 0
.text:00415B8D		       jnz     short loc_415BCA
.text:00415B8F
.text:00415B8F loc_415B8F:			       ; CODE XREF: strtoxq+153j
.text:00415B8F					       ; strtoxq+169j
.text:00415B8F		       mov     eax, [ebp+flags]
.text:00415B92		       dec     [ebp+p]
.text:00415B95		       test    al, 8
.text:00415B97		       jnz     short loc_415BDA
.text:00415B99		       xor     eax, eax
.text:00415B9B		       cmp     [ebp+endptr], eax
.text:00415B9E		       jz      short loc_415BA6
.text:00415BA0		       mov     ecx, [ebp+nptr]
.text:00415BA3		       mov     [ebp+p],	ecx
.text:00415BA6
.text:00415BA6 loc_415BA6:			       ; CODE XREF: strtoxq+1B5j
.text:00415BA6		       mov     dword ptr [ebp+number], eax
.text:00415BA9		       mov     dword ptr [ebp+number+4], eax
.text:00415BAC		       jmp     loc_415C40
.text:00415BB1 ; ---------------------------------------------------------------------------
.text:00415BB1
.text:00415BB1 loc_415BB1:			       ; CODE XREF: strtoxq+175j
.text:00415BB1					       ; strtoxq+17Fj ...
.text:00415BB1		       push    ecx
.text:00415BB2		       push    dword ptr [ebp+number]
.text:00415BB5		       push    [ebp+var_24]
.text:00415BB8		       push    edi
.text:00415BB9		       call    __allmul
.text:00415BBE		       xor     ecx, ecx
.text:00415BC0		       add     eax, esi
.text:00415BC2		       adc     edx, ecx
.text:00415BC4		       mov     dword ptr [ebp+number], eax
.text:00415BC7		       mov     dword ptr [ebp+number+4], edx
.text:00415BCA
.text:00415BCA loc_415BCA:			       ; CODE XREF: strtoxq+1A4j
.text:00415BCA		       mov     eax, [ebp+p]
.text:00415BCD		       mov     al, [eax]
.text:00415BCF		       inc     [ebp+p]
.text:00415BD2		       mov     [ebp+c],	al
.text:00415BD5		       jmp     loc_415B22
.text:00415BDA ; ---------------------------------------------------------------------------
.text:00415BDA
.text:00415BDA loc_415BDA:			       ; CODE XREF: strtoxq+1AEj
.text:00415BDA		       test    al, 4
.text:00415BDC		       mov     esi, 7FFFFFFFh
.text:00415BE1		       mov     ebx, 80000000h
.text:00415BE6		       jnz     short loc_415C0F
.text:00415BE8		       test    al, 1
.text:00415BEA		       jnz     short loc_415C40
.text:00415BEC		       and     eax, 2
.text:00415BEF		       jz      short loc_415BFE
.text:00415BF1		       cmp     dword ptr [ebp+number+4], ebx
.text:00415BF4		       ja      short loc_415C0F
.text:00415BF6		       jb      short loc_415BFE
.text:00415BF8		       cmp     dword ptr [ebp+number], 0
.text:00415BFC		       ja      short loc_415C0F
.text:00415BFE
.text:00415BFE loc_415BFE:			       ; CODE XREF: strtoxq+206j
.text:00415BFE					       ; strtoxq+20Dj
.text:00415BFE		       test    eax, eax
.text:00415C00		       jnz     short loc_415C40
.text:00415C02		       cmp     dword ptr [ebp+number+4], esi
.text:00415C05		       jb      short loc_415C40
.text:00415C07		       ja      short loc_415C0F
.text:00415C09		       cmp     dword ptr [ebp+number], 0FFFFFFFFh
.text:00415C0D		       jbe     short loc_415C40
.text:00415C0F
.text:00415C0F loc_415C0F:			       ; CODE XREF: strtoxq+1FDj
.text:00415C0F					       ; strtoxq+20Bj ...
.text:00415C0F		       call    __errno
.text:00415C14		       test    byte ptr	[ebp+flags], 1
.text:00415C18		       mov     dword ptr [eax],	22h
.text:00415C1E		       jz      short loc_415C2A
.text:00415C20		       or      dword ptr [ebp+number], 0FFFFFFFFh
.text:00415C24		       or      dword ptr [ebp+number+4], 0FFFFFFFFh
.text:00415C28		       jmp     short loc_415C40
.text:00415C2A ; ---------------------------------------------------------------------------
.text:00415C2A
.text:00415C2A loc_415C2A:			       ; CODE XREF: strtoxq+235j
.text:00415C2A		       test    byte ptr	[ebp+flags], 2
.text:00415C2E		       jz      short loc_415C39
.text:00415C30		       and     dword ptr [ebp+number], 0
.text:00415C34		       mov     dword ptr [ebp+number+4], ebx
.text:00415C37		       jmp     short loc_415C40
.text:00415C39 ; ---------------------------------------------------------------------------
.text:00415C39
.text:00415C39 loc_415C39:			       ; CODE XREF: strtoxq+245j
.text:00415C39		       or      dword ptr [ebp+number], 0FFFFFFFFh
.text:00415C3D		       mov     dword ptr [ebp+number+4], esi
.text:00415C40
.text:00415C40 loc_415C40:			       ; CODE XREF: strtoxq+1C3j
.text:00415C40					       ; strtoxq+201j ...
.text:00415C40		       mov     eax, [ebp+endptr]
.text:00415C43		       test    eax, eax
.text:00415C45		       pop     esi
.text:00415C46		       jz      short loc_415C4D
.text:00415C48		       mov     ecx, [ebp+p]
.text:00415C4B		       mov     [eax], ecx
.text:00415C4D
.text:00415C4D loc_415C4D:			       ; CODE XREF: strtoxq+25Dj
.text:00415C4D		       test    byte ptr	[ebp+flags], 2
.text:00415C51		       jz      short loc_415C66
.text:00415C53		       mov     eax, dword ptr [ebp+number]
.text:00415C56		       mov     ecx, dword ptr [ebp+number+4]
.text:00415C59		       neg     eax
.text:00415C5B		       adc     ecx, 0
.text:00415C5E		       neg     ecx
.text:00415C60		       mov     dword ptr [ebp+number], eax
.text:00415C63		       mov     dword ptr [ebp+number+4], ecx
.text:00415C66
.text:00415C66 loc_415C66:			       ; CODE XREF: strtoxq+268j
.text:00415C66		       cmp     [ebp+_loc_update.updated], 0
.text:00415C6A		       jz      short loc_415C73
.text:00415C6C		       mov     eax, [ebp+_loc_update.ptd]
.text:00415C6F		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415C73
.text:00415C73 loc_415C73:			       ; CODE XREF: strtoxq+281j
.text:00415C73		       mov     eax, dword ptr [ebp+number]
.text:00415C76		       mov     edx, dword ptr [ebp+number+4]
.text:00415C79
.text:00415C79 loc_415C79:			       ; CODE XREF: strtoxq+4Dj
.text:00415C79		       pop     edi
.text:00415C7A		       pop     ebx
.text:00415C7B		       leave
.text:00415C7C		       retn
.text:00415C7C strtoxq	       endp
.text:00415C7C
.text:00415C7D
.text:00415C7D ; =============== S U B R O U T I N E =======================================
.text:00415C7D
.text:00415C7D ; Attributes: bp-based frame
.text:00415C7D
.text:00415C7D ; __int64 __cdecl _strtoi64(const char *nptr, char **endptr, int	ibase)
.text:00415C7D __strtoi64      proc near	       ; CODE XREF: __atoi64+8p
.text:00415C7D
.text:00415C7D nptr	       = dword ptr  8
.text:00415C7D endptr	       = dword ptr  0Ch
.text:00415C7D ibase	       = dword ptr  10h
.text:00415C7D
.text:00415C7D		       push    ebp
.text:00415C7E		       mov     ebp, esp
.text:00415C80		       xor     eax, eax
.text:00415C82		       cmp     ___locale_changed, eax
.text:00415C88		       push    eax	       ; flags
.text:00415C89		       push    [ebp+ibase]     ; ibase
.text:00415C8C		       push    [ebp+endptr]    ; endptr
.text:00415C8F		       push    [ebp+nptr]      ; nptr
.text:00415C92		       jnz     short loc_415C9B
.text:00415C94		       push    offset ___initiallocalestructinfo
.text:00415C99		       jmp     short loc_415C9C
.text:00415C9B ; ---------------------------------------------------------------------------
.text:00415C9B
.text:00415C9B loc_415C9B:			       ; CODE XREF: __strtoi64+15j
.text:00415C9B		       push    eax	       ; plocinfo
.text:00415C9C
.text:00415C9C loc_415C9C:			       ; CODE XREF: __strtoi64+1Cj
.text:00415C9C		       call    strtoxq
.text:00415CA1		       add     esp, 14h
.text:00415CA4		       pop     ebp
.text:00415CA5		       retn
.text:00415CA5 __strtoi64      endp
.text:00415CA5
.text:00415CA6
.text:00415CA6 ; =============== S U B R O U T I N E =======================================
.text:00415CA6
.text:00415CA6
.text:00415CA6 ; __int64 __cdecl _strtoi64_l(const char	*nptr, char **endptr, int ibase, localeinfo_struct *plocinfo)
.text:00415CA6 __strtoi64_l    proc near	       ; CODE XREF: __atoi64_l+Cp
.text:00415CA6
.text:00415CA6 nptr	       = dword ptr  4
.text:00415CA6 endptr	       = dword ptr  8
.text:00415CA6 ibase	       = dword ptr  0Ch
.text:00415CA6 plocinfo	       = dword ptr  10h
.text:00415CA6
.text:00415CA6		       push    0	       ; flags
.text:00415CA8		       push    [esp+4+ibase]   ; ibase
.text:00415CAC		       push    [esp+8+endptr]  ; endptr
.text:00415CB0		       push    [esp+0Ch+nptr]  ; nptr
.text:00415CB4		       push    [esp+10h+plocinfo] ; plocinfo
.text:00415CB8		       call    strtoxq
.text:00415CBD		       add     esp, 14h
.text:00415CC0		       retn
.text:00415CC0 __strtoi64_l    endp
.text:00415CC0
.text:00415CC1
.text:00415CC1 ; =============== S U B R O U T I N E =======================================
.text:00415CC1
.text:00415CC1 ; Attributes: bp-based frame
.text:00415CC1
.text:00415CC1 ; unsigned __int64 __cdecl _strtoui64(const char	*nptr, char **endptr, int ibase)
.text:00415CC1 __strtoui64     proc near
.text:00415CC1
.text:00415CC1 nptr	       = dword ptr  8
.text:00415CC1 endptr	       = dword ptr  0Ch
.text:00415CC1 ibase	       = dword ptr  10h
.text:00415CC1
.text:00415CC1		       push    ebp
.text:00415CC2		       mov     ebp, esp
.text:00415CC4		       cmp     ___locale_changed, 0
.text:00415CCB		       push    1	       ; flags
.text:00415CCD		       push    [ebp+ibase]     ; ibase
.text:00415CD0		       push    [ebp+endptr]    ; endptr
.text:00415CD3		       push    [ebp+nptr]      ; nptr
.text:00415CD6		       jnz     short loc_415CDF
.text:00415CD8		       push    offset ___initiallocalestructinfo
.text:00415CDD		       jmp     short loc_415CE1
.text:00415CDF ; ---------------------------------------------------------------------------
.text:00415CDF
.text:00415CDF loc_415CDF:			       ; CODE XREF: __strtoui64+15j
.text:00415CDF		       push    0	       ; plocinfo
.text:00415CE1
.text:00415CE1 loc_415CE1:			       ; CODE XREF: __strtoui64+1Cj
.text:00415CE1		       call    strtoxq
.text:00415CE6		       add     esp, 14h
.text:00415CE9		       pop     ebp
.text:00415CEA		       retn
.text:00415CEA __strtoui64     endp
.text:00415CEA
.text:00415CEB
.text:00415CEB ; =============== S U B R O U T I N E =======================================
.text:00415CEB
.text:00415CEB
.text:00415CEB ; unsigned __int64 __cdecl _strtoui64_l(const char *nptr, char **endptr,	int ibase, localeinfo_struct *plocinfo)
.text:00415CEB __strtoui64_l   proc near
.text:00415CEB
.text:00415CEB nptr	       = dword ptr  4
.text:00415CEB endptr	       = dword ptr  8
.text:00415CEB ibase	       = dword ptr  0Ch
.text:00415CEB plocinfo	       = dword ptr  10h
.text:00415CEB
.text:00415CEB		       push    1	       ; flags
.text:00415CED		       push    [esp+4+ibase]   ; ibase
.text:00415CF1		       push    [esp+8+endptr]  ; endptr
.text:00415CF5		       push    [esp+0Ch+nptr]  ; nptr
.text:00415CF9		       push    [esp+10h+plocinfo] ; plocinfo
.text:00415CFD		       call    strtoxq
.text:00415D02		       add     esp, 14h
.text:00415D05		       retn
.text:00415D05 __strtoui64_l   endp
.text:00415D05
.text:00415D05 ; ---------------------------------------------------------------------------
.text:00415D06		       align 10h
.text:00415D10
.text:00415D10 ; =============== S U B R O U T I N E =======================================
.text:00415D10
.text:00415D10 ; Attributes: bp-based frame
.text:00415D10
.text:00415D10 ; void __cdecl __ascii_strnicmp(char *first, char *last,	unsigned int count)
.text:00415D10 ___ascii_strnicmp proc near	       ; CODE XREF: __strnicmp_l+9Ap
.text:00415D10					       ; __strnicmp+42j
.text:00415D10
.text:00415D10 first	       = dword ptr  8
.text:00415D10 last	       = dword ptr  0Ch
.text:00415D10 count	       = dword ptr  10h
.text:00415D10
.text:00415D10		       push    ebp
.text:00415D11		       mov     ebp, esp
.text:00415D13		       push    edi
.text:00415D14		       push    esi
.text:00415D15		       push    ebx
.text:00415D16		       mov     ecx, [ebp+count]
.text:00415D19		       or      ecx, ecx
.text:00415D1B		       jz      short toend_0
.text:00415D1D		       mov     esi, [ebp+first]
.text:00415D20		       mov     edi, [ebp+last]
.text:00415D23		       mov     bh, 41h
.text:00415D25		       mov     bl, 5Ah
.text:00415D27		       mov     dh, 20h
.text:00415D29		       lea     ecx, [ecx+0]
.text:00415D2C
.text:00415D2C lupe:				       ; CODE XREF: ___ascii_strnicmp+49j
.text:00415D2C		       mov     ah, [esi]
.text:00415D2E		       or      ah, ah
.text:00415D30		       mov     al, [edi]
.text:00415D32		       jz      short eject
.text:00415D34		       or      al, al
.text:00415D36		       jz      short eject
.text:00415D38		       add     esi, 1
.text:00415D3B		       add     edi, 1
.text:00415D3E		       cmp     ah, bh
.text:00415D40		       jb      short skip1
.text:00415D42		       cmp     ah, bl
.text:00415D44		       ja      short skip1
.text:00415D46		       add     ah, dh
.text:00415D48
.text:00415D48 skip1:				       ; CODE XREF: ___ascii_strnicmp+30j
.text:00415D48					       ; ___ascii_strnicmp+34j
.text:00415D48		       cmp     al, bh
.text:00415D4A		       jb      short skip2
.text:00415D4C		       cmp     al, bl
.text:00415D4E		       ja      short skip2
.text:00415D50		       add     al, dh
.text:00415D52
.text:00415D52 skip2:				       ; CODE XREF: ___ascii_strnicmp+3Aj
.text:00415D52					       ; ___ascii_strnicmp+3Ej
.text:00415D52		       cmp     ah, al
.text:00415D54		       jnz     short differ
.text:00415D56		       sub     ecx, 1
.text:00415D59		       jnz     short lupe
.text:00415D5B
.text:00415D5B eject:				       ; CODE XREF: ___ascii_strnicmp+22j
.text:00415D5B					       ; ___ascii_strnicmp+26j
.text:00415D5B		       xor     ecx, ecx
.text:00415D5D		       cmp     ah, al
.text:00415D5F		       jz      short toend_0
.text:00415D61
.text:00415D61 differ:				       ; CODE XREF: ___ascii_strnicmp+44j
.text:00415D61		       mov     ecx, 0FFFFFFFFh
.text:00415D66		       jb      short toend_0
.text:00415D68		       neg     ecx
.text:00415D6A
.text:00415D6A toend_0:				       ; CODE XREF: ___ascii_strnicmp+Bj
.text:00415D6A					       ; ___ascii_strnicmp+4Fj	...
.text:00415D6A		       mov     eax, ecx
.text:00415D6C		       pop     ebx
.text:00415D6D		       pop     esi
.text:00415D6E		       pop     edi
.text:00415D6F		       leave
.text:00415D70		       retn
.text:00415D70 ___ascii_strnicmp endp
.text:00415D70
.text:00415D71
.text:00415D71 ; =============== S U B R O U T I N E =======================================
.text:00415D71
.text:00415D71 ; Attributes: bp-based frame
.text:00415D71
.text:00415D71 ; int __cdecl _mbsnbicoll_l(const char *s1, const char *s2, unsigned int	n, localeinfo_struct *plocinfo)
.text:00415D71 __mbsnbicoll_l  proc near	       ; CODE XREF: __mbsnbicoll+Ep
.text:00415D71
.text:00415D71 _loc_update     = _LocaleUpdate ptr -10h
.text:00415D71 s1	       = dword ptr  8
.text:00415D71 s2	       = dword ptr  0Ch
.text:00415D71 n	       = dword ptr  10h
.text:00415D71 plocinfo	       = dword ptr  14h
.text:00415D71
.text:00415D71		       push    ebp
.text:00415D72		       mov     ebp, esp
.text:00415D74		       sub     esp, 10h
.text:00415D77		       push    ebx
.text:00415D78		       push    [ebp+plocinfo]  ; plocinfo
.text:00415D7B		       lea     ecx, [ebp+_loc_update] ;	this
.text:00415D7E		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00415D83		       mov     ecx, [ebp+n]
.text:00415D86		       xor     ebx, ebx
.text:00415D88		       cmp     ecx, ebx
.text:00415D8A		       jnz     short loc_415D9F
.text:00415D8C		       cmp     [ebp+_loc_update.updated], bl
.text:00415D8F		       jz      short loc_415D98
.text:00415D91		       mov     eax, [ebp+_loc_update.ptd]
.text:00415D94		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415D98
.text:00415D98 loc_415D98:			       ; CODE XREF: __mbsnbicoll_l+1Ej
.text:00415D98		       xor     eax, eax
.text:00415D9A		       jmp     loc_415E5A
.text:00415D9F ; ---------------------------------------------------------------------------
.text:00415D9F
.text:00415D9F loc_415D9F:			       ; CODE XREF: __mbsnbicoll_l+19j
.text:00415D9F		       cmp     [ebp+s1], ebx
.text:00415DA2		       jnz     short loc_415DD2
.text:00415DA4
.text:00415DA4 loc_415DA4:			       ; CODE XREF: __mbsnbicoll_l+64j
.text:00415DA4		       call    __errno
.text:00415DA9		       push    ebx	       ; pReserved
.text:00415DAA		       push    ebx	       ; nLine
.text:00415DAB		       push    ebx	       ; pszFile
.text:00415DAC		       push    ebx	       ; pszFunction
.text:00415DAD		       push    ebx	       ; pszExpression
.text:00415DAE		       mov     dword ptr [eax],	16h
.text:00415DB4		       call    __invalid_parameter
.text:00415DB9		       add     esp, 14h
.text:00415DBC		       cmp     [ebp+_loc_update.updated], bl
.text:00415DBF		       jz      short loc_415DC8
.text:00415DC1		       mov     eax, [ebp+_loc_update.ptd]
.text:00415DC4		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415DC8
.text:00415DC8 loc_415DC8:			       ; CODE XREF: __mbsnbicoll_l+4Ej
.text:00415DC8		       mov     eax, 7FFFFFFFh
.text:00415DCD		       jmp     loc_415E5A
.text:00415DD2 ; ---------------------------------------------------------------------------
.text:00415DD2
.text:00415DD2 loc_415DD2:			       ; CODE XREF: __mbsnbicoll_l+31j
.text:00415DD2		       cmp     [ebp+s2], ebx
.text:00415DD5		       jz      short loc_415DA4
.text:00415DD7		       push    esi
.text:00415DD8		       mov     esi, 7FFFFFFFh
.text:00415DDD		       cmp     ecx, esi
.text:00415DDF		       jbe     short loc_415DFB
.text:00415DE1		       call    __errno
.text:00415DE6		       push    ebx	       ; pReserved
.text:00415DE7		       push    ebx	       ; nLine
.text:00415DE8		       push    ebx	       ; pszFile
.text:00415DE9		       push    ebx	       ; pszFunction
.text:00415DEA		       push    ebx	       ; pszExpression
.text:00415DEB		       mov     dword ptr [eax],	16h
.text:00415DF1		       call    __invalid_parameter
.text:00415DF6		       add     esp, 14h
.text:00415DF9		       jmp     short loc_415E3A
.text:00415DFB ; ---------------------------------------------------------------------------
.text:00415DFB
.text:00415DFB loc_415DFB:			       ; CODE XREF: __mbsnbicoll_l+6Ej
.text:00415DFB		       mov     eax, [ebp+_loc_update.localeinfo.mbcinfo]
.text:00415DFE		       cmp     [eax+8],	ebx
.text:00415E01		       jnz     short loc_415E17
.text:00415E03		       push    [ebp+plocinfo]  ; plocinfo
.text:00415E06		       push    ecx	       ; count
.text:00415E07		       push    [ebp+s2]	       ; _string2
.text:00415E0A		       push    [ebp+s1]	       ; _string1
.text:00415E0D		       call    __strnicoll_l
.text:00415E12		       add     esp, 10h
.text:00415E15		       jmp     short loc_415E4D
.text:00415E17 ; ---------------------------------------------------------------------------
.text:00415E17
.text:00415E17 loc_415E17:			       ; CODE XREF: __mbsnbicoll_l+90j
.text:00415E17		       push    dword ptr [eax+4] ; code_page
.text:00415E1A		       push    ecx	       ; cchCount2
.text:00415E1B		       push    [ebp+s2]	       ; lpString2
.text:00415E1E		       push    ecx	       ; cchCount1
.text:00415E1F		       push    [ebp+s1]	       ; lpString1
.text:00415E22		       push    1001h	       ; dwCmpFlags
.text:00415E27		       push    dword ptr [eax+0Ch] ; Locale
.text:00415E2A		       lea     eax, [ebp+_loc_update]
.text:00415E2D		       push    eax	       ; plocinfo
.text:00415E2E		       call    ___crtCompareStringA
.text:00415E33		       add     esp, 20h
.text:00415E36		       cmp     eax, ebx
.text:00415E38		       jnz     short loc_415E4A
.text:00415E3A
.text:00415E3A loc_415E3A:			       ; CODE XREF: __mbsnbicoll_l+88j
.text:00415E3A		       cmp     [ebp+_loc_update.updated], bl
.text:00415E3D		       jz      short loc_415E46
.text:00415E3F		       mov     eax, [ebp+_loc_update.ptd]
.text:00415E42		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00415E46
.text:00415E46 loc_415E46:			       ; CODE XREF: __mbsnbicoll_l+CCj
.text:00415E46		       mov     eax, esi
.text:00415E48		       jmp     short loc_415E59
.text:00415E4A ; ---------------------------------------------------------------------------
.text:00415E4A
.text:00415E4A loc_415E4A:			       ; CODE XREF: __mbsnbicoll_l+C7j
.text:00415E4A		       add     eax, 0FFFFFFFEh
.text:00415E4D
.text:00415E4D loc_415E4D:			       ; CODE XREF: __mbsnbicoll_l+A4j
.text:00415E4D		       cmp     [ebp+_loc_update.updated], bl
.text:00415E50		       jz      short loc_415E59
.text:00415E52		       mov     ecx, [ebp+_loc_update.ptd]
.text:00415E55		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00415E59
.text:00415E59 loc_415E59:			       ; CODE XREF: __mbsnbicoll_l+D7j
.text:00415E59					       ; __mbsnbicoll_l+DFj
.text:00415E59		       pop     esi
.text:00415E5A
.text:00415E5A loc_415E5A:			       ; CODE XREF: __mbsnbicoll_l+29j
.text:00415E5A					       ; __mbsnbicoll_l+5Cj
.text:00415E5A		       pop     ebx
.text:00415E5B		       leave
.text:00415E5C		       retn
.text:00415E5C __mbsnbicoll_l  endp
.text:00415E5C
.text:00415E5D
.text:00415E5D ; =============== S U B R O U T I N E =======================================
.text:00415E5D
.text:00415E5D
.text:00415E5D ; int __cdecl _mbsnbicoll(const char *s1, const char *s2, unsigned int n)
.text:00415E5D __mbsnbicoll    proc near	       ; CODE XREF: __getenv_helper_nolock+5Ep
.text:00415E5D					       ; findenv+Fp
.text:00415E5D
.text:00415E5D s1	       = dword ptr  4
.text:00415E5D s2	       = dword ptr  8
.text:00415E5D n	       = dword ptr  0Ch
.text:00415E5D
.text:00415E5D		       push    0	       ; plocinfo
.text:00415E5F		       push    [esp+4+n]       ; n
.text:00415E63		       push    [esp+8+s2]      ; s2
.text:00415E67		       push    [esp+0Ch+s1]    ; s1
.text:00415E6B		       call    __mbsnbicoll_l
.text:00415E70		       add     esp, 10h
.text:00415E73		       retn
.text:00415E73 __mbsnbicoll    endp
.text:00415E73
.text:00415E74
.text:00415E74 ; =============== S U B R O U T I N E =======================================
.text:00415E74
.text:00415E74 ; Attributes: bp-based frame
.text:00415E74
.text:00415E74 ; int __cdecl __wtomb_environ()
.text:00415E74 ___wtomb_environ	proc near	       ; CODE XREF: __getenv_helper_nolock+22p
.text:00415E74					       ; ___crtsetenv+85p
.text:00415E74
.text:00415E74 size	       = dword ptr -8
.text:00415E74 envp	       = dword ptr -4
.text:00415E74
.text:00415E74		       push    ebp
.text:00415E75		       mov     ebp, esp
.text:00415E77		       push    ecx
.text:00415E78		       push    ecx
.text:00415E79		       push    ebx
.text:00415E7A		       push    esi
.text:00415E7B		       xor     esi, esi
.text:00415E7D		       push    edi
.text:00415E7E		       mov     edi, __wenviron
.text:00415E84		       mov     [ebp+envp], esi
.text:00415E87		       mov     eax, [edi]
.text:00415E89		       cmp     eax, esi
.text:00415E8B		       jz      short loc_415EF2
.text:00415E8D		       mov     ebx, ds:__imp__WideCharToMultiByte@32 ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00415E93
.text:00415E93 loc_415E93:			       ; CODE XREF: ___wtomb_environ+7Cj
.text:00415E93		       push    esi	       ; lpUsedDefaultChar
.text:00415E94		       push    esi	       ; lpDefaultChar
.text:00415E95		       push    esi	       ; cbMultiByte
.text:00415E96		       push    esi	       ; lpMultiByteStr
.text:00415E97		       push    0FFFFFFFFh      ; cchWideChar
.text:00415E99		       push    eax	       ; lpWideCharStr
.text:00415E9A		       push    esi	       ; dwFlags
.text:00415E9B		       push    esi	       ; CodePage
.text:00415E9C		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00415E9E		       cmp     eax, esi
.text:00415EA0		       mov     [ebp+size], eax
.text:00415EA3		       jz      short loc_415EF9
.text:00415EA5		       push    1	       ; size
.text:00415EA7		       push    eax	       ; count
.text:00415EA8		       call    __calloc_crt
.text:00415EAD		       cmp     eax, esi
.text:00415EAF		       pop     ecx
.text:00415EB0		       pop     ecx
.text:00415EB1		       mov     [ebp+envp], eax
.text:00415EB4		       jz      short loc_415EF9
.text:00415EB6		       push    esi	       ; lpUsedDefaultChar
.text:00415EB7		       push    esi	       ; lpDefaultChar
.text:00415EB8		       push    [ebp+size]      ; cbMultiByte
.text:00415EBB		       push    eax	       ; lpMultiByteStr
.text:00415EBC		       push    0FFFFFFFFh      ; cchWideChar
.text:00415EBE		       push    dword ptr [edi] ; lpWideCharStr
.text:00415EC0		       push    esi	       ; dwFlags
.text:00415EC1		       push    esi	       ; CodePage
.text:00415EC2		       call    ebx ; WideCharToMultiByte(x,x,x,x,x,x,x,x) ; WideCharToMultiByte(x,x,x,x,x,x,x,x)
.text:00415EC4		       test    eax, eax
.text:00415EC6		       jz      short loc_415EFE
.text:00415EC8		       lea     eax, [ebp+envp]
.text:00415ECB		       push    esi	       ; primary
.text:00415ECC		       push    eax	       ; poption
.text:00415ECD		       call    ___crtsetenv
.text:00415ED2		       test    eax, eax
.text:00415ED4		       pop     ecx
.text:00415ED5		       pop     ecx
.text:00415ED6		       jge     short loc_415EE9
.text:00415ED8		       cmp     [ebp+envp], esi
.text:00415EDB		       jz      short loc_415EE9
.text:00415EDD		       push    [ebp+envp]      ; pBlock
.text:00415EE0		       call    _free
.text:00415EE5		       pop     ecx
.text:00415EE6		       mov     [ebp+envp], esi
.text:00415EE9
.text:00415EE9 loc_415EE9:			       ; CODE XREF: ___wtomb_environ+62j
.text:00415EE9					       ; ___wtomb_environ+67j
.text:00415EE9		       add     edi, 4
.text:00415EEC		       mov     eax, [edi]
.text:00415EEE		       cmp     eax, esi
.text:00415EF0		       jnz     short loc_415E93
.text:00415EF2
.text:00415EF2 loc_415EF2:			       ; CODE XREF: ___wtomb_environ+17j
.text:00415EF2		       xor     eax, eax
.text:00415EF4
.text:00415EF4 loc_415EF4:			       ; CODE XREF: ___wtomb_environ+88j
.text:00415EF4		       pop     edi
.text:00415EF5		       pop     esi
.text:00415EF6		       pop     ebx
.text:00415EF7		       leave
.text:00415EF8		       retn
.text:00415EF9 ; ---------------------------------------------------------------------------
.text:00415EF9
.text:00415EF9 loc_415EF9:			       ; CODE XREF: ___wtomb_environ+2Fj
.text:00415EF9					       ; ___wtomb_environ+40j ...
.text:00415EF9		       or      eax, 0FFFFFFFFh
.text:00415EFC		       jmp     short loc_415EF4
.text:00415EFE ; ---------------------------------------------------------------------------
.text:00415EFE
.text:00415EFE loc_415EFE:			       ; CODE XREF: ___wtomb_environ+52j
.text:00415EFE		       push    [ebp+envp]      ; pBlock
.text:00415F01		       call    _free
.text:00415F06		       pop     ecx
.text:00415F07		       jmp     short loc_415EF9
.text:00415F07 ___wtomb_environ	endp
.text:00415F07
.text:00415F09
.text:00415F09 ; =============== S U B R O U T I N E =======================================
.text:00415F09
.text:00415F09
.text:00415F09 ; unsigned int __cdecl strnlen(const char *str, unsigned	int maxsize)
.text:00415F09 _strnlen	       proc near	       ; CODE XREF: _getenv+3Fp
.text:00415F09
.text:00415F09 str	       = dword ptr  4
.text:00415F09 maxsize	       = dword ptr  8
.text:00415F09
.text:00415F09		       xor     eax, eax
.text:00415F0B		       cmp     [esp+maxsize], eax
.text:00415F0F		       jbe     short locret_415F22
.text:00415F11		       mov     ecx, [esp+str]
.text:00415F15
.text:00415F15 loc_415F15:			       ; CODE XREF: _strnlen+17j
.text:00415F15		       cmp     byte ptr	[ecx], 0
.text:00415F18		       jz      short locret_415F22
.text:00415F1A		       inc     eax
.text:00415F1B		       inc     ecx
.text:00415F1C		       cmp     eax, [esp+maxsize]
.text:00415F20		       jb      short loc_415F15
.text:00415F22
.text:00415F22 locret_415F22:			       ; CODE XREF: _strnlen+6j
.text:00415F22					       ; _strnlen+Fj
.text:00415F22		       retn
.text:00415F22 _strnlen	       endp
.text:00415F22
.text:00415F22 ; ---------------------------------------------------------------------------
.text:00415F23		       align 10h
.text:00415F30
.text:00415F30 ; =============== S U B R O U T I N E =======================================
.text:00415F30
.text:00415F30
.text:00415F30 __allmul	       proc near	       ; CODE XREF: strtoxq+1D0p
.text:00415F30
.text:00415F30 arg_0	       = dword ptr  4
.text:00415F30 arg_4	       = dword ptr  8
.text:00415F30 arg_8	       = dword ptr  0Ch
.text:00415F30 arg_C	       = dword ptr  10h
.text:00415F30
.text:00415F30		       mov     eax, [esp+arg_4]
.text:00415F34		       mov     ecx, [esp+arg_C]
.text:00415F38		       or      ecx, eax
.text:00415F3A		       mov     ecx, [esp+arg_8]
.text:00415F3E		       jnz     short hard
.text:00415F40		       mov     eax, [esp+arg_0]
.text:00415F44		       mul     ecx
.text:00415F46		       retn    10h
.text:00415F49 ; ---------------------------------------------------------------------------
.text:00415F49
.text:00415F49 hard:				       ; CODE XREF: __allmul+Ej
.text:00415F49		       push    ebx
.text:00415F4A		       mul     ecx
.text:00415F4C		       mov     ebx, eax
.text:00415F4E		       mov     eax, [esp+4+arg_0]
.text:00415F52		       mul     [esp+4+arg_C]
.text:00415F56		       add     ebx, eax
.text:00415F58		       mov     eax, [esp+4+arg_0]
.text:00415F5C		       mul     ecx
.text:00415F5E		       add     edx, ebx
.text:00415F60		       pop     ebx
.text:00415F61		       retn    10h
.text:00415F61 __allmul	       endp
.text:00415F61
.text:00415F64
.text:00415F64 ; =============== S U B R O U T I N E =======================================
.text:00415F64
.text:00415F64
.text:00415F64 ; int __usercall	strncnt_0<eax>(const char *string<eax>,	int cnt)
.text:00415F64 strncnt_0       proc near
.text:00415F64
.text:00415F64 cnt	       = dword ptr  4
.text:00415F64
.text:00415F64 string =	eax
.text:00415F64		       mov     ecx, [esp+cnt]
.text:00415F68		       jmp     short loc_415F71
.text:00415F6A ; ---------------------------------------------------------------------------
.text:00415F6A
.text:00415F6A loc_415F6A:			       ; CODE XREF: strncnt_0+Fj
.text:00415F6A		       dec     ecx
.text:00415F6B		       cmp     byte ptr	[string], 0
.text:00415F6E		       jz      short loc_415F76
.text:00415F70		       inc     string
.text:00415F71
.text:00415F71 loc_415F71:			       ; CODE XREF: strncnt_0+4j
.text:00415F71		       test    ecx, ecx
.text:00415F73		       jnz     short loc_415F6A
.text:00415F75		       dec     ecx
.text:00415F76
.text:00415F76 loc_415F76:			       ; CODE XREF: strncnt_0+Aj
.text:00415F76		       mov     string, [esp+cnt]
.text:00415F7A		       sub     string, ecx
.text:00415F7C		       dec     string
.text:00415F7D		       retn
.text:00415F7D strncnt_0       endp
.text:00415F7D
.text:00415F7E
.text:00415F7E ; =============== S U B R O U T I N E =======================================
.text:00415F7E
.text:00415F7E ; Attributes: bp-based frame
.text:00415F7E
.text:00415F7E ; int __usercall	_crtCompareStringA_stat<eax>(localeinfo_struct *plocinfo<ecx>, unsigned	int Locale, unsigned int dwCmpFlags, const char	*lpString1<edx>, int cchCount1,	const char *lpString2, int cchCount2, int code_page)
.text:00415F7E __crtCompareStringA_stat	proc near      ; CODE XREF: ___crtCompareStringA+29p
.text:00415F7E
.text:00415F7E buff_size1      = dword ptr -2Ch
.text:00415F7E retcode	       = dword ptr -28h
.text:00415F7E lpSrcStr	       = dword ptr -24h
.text:00415F7E wbuffer1	       = dword ptr -20h
.text:00415F7E var_1C	       = dword ptr -1Ch
.text:00415F7E lpCPInfo	       = _cpinfo ptr -18h
.text:00415F7E var_4	       = dword ptr -4
.text:00415F7E Locale	       = dword ptr  8
.text:00415F7E dwCmpFlags      = dword ptr  0Ch
.text:00415F7E cchCount1       = dword ptr  10h
.text:00415F7E lpString2       = dword ptr  14h
.text:00415F7E cchCount2       = dword ptr  18h
.text:00415F7E code_page       = dword ptr  1Ch
.text:00415F7E
.text:00415F7E plocinfo	= ecx
.text:00415F7E lpString1 = edx
.text:00415F7E		       push    ebp
.text:00415F7F		       mov     ebp, esp
.text:00415F81		       sub     esp, 2Ch
.text:00415F84		       mov     eax, ___security_cookie
.text:00415F89		       xor     eax, ebp
.text:00415F8B		       mov     [ebp+var_4], eax
.text:00415F8E		       mov     eax, [ebp+lpString2]
.text:00415F91		       push    ebx
.text:00415F92		       push    esi
.text:00415F93		       push    edi
.text:00415F94		       xor     edi, edi
.text:00415F96		       cmp     f_use_5,	edi
.text:00415F9C		       mov     ebx, lpString1
.text:00415F9E		       mov     esi, plocinfo
.text:00415FA0		       mov     [ebp+lpSrcStr], ebx
.text:00415FA3		       mov     [ebp+var_1C], eax
.text:00415FA6		       jnz     short loc_415FE0
.text:00415FA8		       push    1	       ; cchCount2
.text:00415FAA		       mov     eax, offset SrcStr
.text:00415FAF		       push    eax	       ; lpString2
.text:00415FB0		       push    1	       ; cchCount1
.text:00415FB2		       push    eax	       ; lpString1
.text:00415FB3		       push    edi	       ; dwCmpFlags
.text:00415FB4		       push    edi	       ; Locale
.text:00415FB5		       call    ds:__imp__CompareStringW@24 ; CompareStringW(x,x,x,x,x,x)
.text:00415FBB		       test    eax, eax
.text:00415FBD		       jz      short loc_415FCB
.text:00415FBF		       mov     f_use_5,	1
.text:00415FC9		       jmp     short loc_415FE0
.text:00415FCB ; ---------------------------------------------------------------------------
.text:00415FCB
.text:00415FCB loc_415FCB:			       ; CODE XREF: __crtCompareStringA_stat+3Fj
.text:00415FCB		       call    ds:__imp__GetLastError@0	; GetLastError()
.text:00415FD1		       cmp     eax, 78h
.text:00415FD4		       jnz     short loc_415FE0
.text:00415FD6		       mov     f_use_5,	2
.text:00415FE0
.text:00415FE0 loc_415FE0:			       ; CODE XREF: __crtCompareStringA_stat+28j
.text:00415FE0					       ; __crtCompareStringA_stat+4Bj ...
.text:00415FE0		       cmp     [ebp+cchCount1],	edi
.text:00415FE3		       jle     short loc_416026
.text:00415FE5		       mov     plocinfo, [ebp+cchCount1]
.text:00415FE8		       mov     eax, ebx
.text:00415FEA
.text:00415FEA loc_415FEA:			       ; CODE XREF: __crtCompareStringA_stat+75j
.text:00415FEA		       dec     plocinfo
.text:00415FEB		       cmp     byte ptr	[eax], 0
.text:00415FEE		       jz      short loc_415FF8
.text:00415FF0		       inc     eax
.text:00415FF1		       cmp     plocinfo, edi
.text:00415FF3		       jnz     short loc_415FEA
.text:00415FF5		       or      plocinfo, 0FFFFFFFFh
.text:00415FF8
.text:00415FF8 loc_415FF8:			       ; CODE XREF: __crtCompareStringA_stat+70j
.text:00415FF8		       or      eax, 0FFFFFFFFh
.text:00415FFB		       sub     eax, plocinfo
.text:00415FFD		       add     [ebp+cchCount1],	eax
.text:00416000
.text:00416000 loc_416000:			       ; CODE XREF: __crtCompareStringA_stat+ACj
.text:00416000		       mov     lpString1, [ebp+cchCount2]
.text:00416003		       cmp     lpString1, edi
.text:00416005		       jle     short loc_416033
.text:00416007		       mov     eax, [ebp+var_1C]
.text:0041600A		       mov     plocinfo, lpString1
.text:0041600C
.text:0041600C loc_41600C:			       ; CODE XREF: __crtCompareStringA_stat+97j
.text:0041600C		       dec     plocinfo
.text:0041600D		       cmp     byte ptr	[eax], 0
.text:00416010		       jz      short loc_41601A
.text:00416012		       inc     eax
.text:00416013		       cmp     plocinfo, edi
.text:00416015		       jnz     short loc_41600C
.text:00416017		       or      plocinfo, 0FFFFFFFFh
.text:0041601A
.text:0041601A loc_41601A:			       ; CODE XREF: __crtCompareStringA_stat+92j
.text:0041601A		       or      eax, 0FFFFFFFFh
.text:0041601D		       sub     eax, plocinfo
.text:0041601F		       add     lpString1, eax
.text:00416021		       mov     [ebp+cchCount2],	lpString1
.text:00416024		       jmp     short loc_416038
.text:00416026 ; ---------------------------------------------------------------------------
.text:00416026
.text:00416026 loc_416026:			       ; CODE XREF: __crtCompareStringA_stat+65j
.text:00416026		       cmp     [ebp+cchCount1],	0FFFFFFFFh
.text:0041602A		       jge     short loc_416000
.text:0041602C
.text:0041602C loc_41602C:			       ; CODE XREF: __crtCompareStringA_stat+B8j
.text:0041602C					       ; __crtCompareStringA_stat+D6j ...
.text:0041602C		       xor     eax, eax
.text:0041602E		       jmp     loc_4162F5
.text:00416033 ; ---------------------------------------------------------------------------
.text:00416033
.text:00416033 loc_416033:			       ; CODE XREF: __crtCompareStringA_stat+87j
.text:00416033		       cmp     lpString1, 0FFFFFFFFh
.text:00416036		       jl      short loc_41602C
.text:00416038
.text:00416038 loc_416038:			       ; CODE XREF: __crtCompareStringA_stat+A6j
.text:00416038		       mov     plocinfo, f_use_5
.text:0041603E		       cmp     plocinfo, 2
.text:00416041		       jz      loc_416240
.text:00416047		       cmp     plocinfo, edi
.text:00416049		       jz      loc_416240
.text:0041604F		       xor     eax, eax
.text:00416051		       inc     eax
.text:00416052		       cmp     plocinfo, eax
.text:00416054		       jnz     short loc_41602C
.text:00416056		       cmp     [ebp+code_page],	edi
.text:00416059		       mov     [ebp+retcode], edi
.text:0041605C		       jnz     short loc_416066
.text:0041605E		       mov     plocinfo, [esi]
.text:00416060		       mov     plocinfo, [plocinfo+4]
.text:00416063		       mov     [ebp+code_page],	plocinfo
.text:00416066
.text:00416066 loc_416066:			       ; CODE XREF: __crtCompareStringA_stat+DEj
.text:00416066		       cmp     [ebp+cchCount1],	edi
.text:00416069		       jz      short loc_416073
.text:0041606B		       cmp     lpString1, edi
.text:0041606D		       jnz     loc_41610D
.text:00416073
.text:00416073 loc_416073:			       ; CODE XREF: __crtCompareStringA_stat+EBj
.text:00416073		       cmp     [ebp+cchCount1],	lpString1
.text:00416076		       jnz     short loc_416080
.text:00416078
.text:00416078 loc_416078:			       ; CODE XREF: __crtCompareStringA_stat+147j
.text:00416078					       ; __crtCompareStringA_stat+180j
.text:00416078		       push    2
.text:0041607A
.text:0041607A loc_41607A:			       ; CODE XREF: __crtCompareStringA_stat+111j
.text:0041607A		       pop     eax
.text:0041607B		       jmp     loc_4162F5
.text:00416080 ; ---------------------------------------------------------------------------
.text:00416080
.text:00416080 loc_416080:			       ; CODE XREF: __crtCompareStringA_stat+F8j
.text:00416080		       cmp     lpString1, eax
.text:00416082		       jg      loc_4162F5
.text:00416088		       cmp     [ebp+cchCount1],	eax
.text:0041608B		       jle     short loc_416091
.text:0041608D
.text:0041608D loc_41608D:			       ; CODE XREF: __crtCompareStringA_stat+12Dj
.text:0041608D					       ; __crtCompareStringA_stat+136j	...
.text:0041608D		       push    3
.text:0041608F		       jmp     short loc_41607A
.text:00416091 ; ---------------------------------------------------------------------------
.text:00416091
.text:00416091 loc_416091:			       ; CODE XREF: __crtCompareStringA_stat+10Dj
.text:00416091		       lea     eax, [ebp+lpCPInfo]
.text:00416094		       push    eax	       ; lpCPInfo
.text:00416095		       push    [ebp+code_page] ; CodePage
.text:00416098		       call    ds:__imp__GetCPInfo@8 ; GetCPInfo(x,x)
.text:0041609E		       test    eax, eax
.text:004160A0		       jz      short loc_41602C
.text:004160A2		       cmp     [ebp+cchCount1],	edi
.text:004160A5		       jle     short loc_4160D0
.text:004160A7		       cmp     [ebp+lpCPInfo.MaxCharSize], 2
.text:004160AB		       jb      short loc_41608D
.text:004160AD		       cmp     [ebp+lpCPInfo.LeadByte],	0
.text:004160B1		       lea     eax, [ebp+lpCPInfo.LeadByte]
.text:004160B4		       jz      short loc_41608D
.text:004160B6
.text:004160B6 loc_4160B6:			       ; CODE XREF: __crtCompareStringA_stat+14Ej
.text:004160B6		       mov     dl, [eax+1]
.text:004160B9		       test    dl, dl
.text:004160BB		       jz      short loc_41608D
.text:004160BD		       mov     cl, [ebx]
.text:004160BF		       cmp     cl, [eax]
.text:004160C1		       jb      short loc_4160C7
.text:004160C3		       cmp     cl, dl
.text:004160C5		       jbe     short loc_416078
.text:004160C7
.text:004160C7 loc_4160C7:			       ; CODE XREF: __crtCompareStringA_stat+143j
.text:004160C7		       inc     eax
.text:004160C8		       inc     eax
.text:004160C9		       cmp     byte ptr	[eax], 0
.text:004160CC		       jnz     short loc_4160B6
.text:004160CE		       jmp     short loc_41608D
.text:004160D0 ; ---------------------------------------------------------------------------
.text:004160D0
.text:004160D0 loc_4160D0:			       ; CODE XREF: __crtCompareStringA_stat+127j
.text:004160D0		       cmp     [ebp+cchCount2],	edi
.text:004160D3		       jle     short loc_41610D
.text:004160D5		       cmp     [ebp+lpCPInfo.MaxCharSize], 2
.text:004160D9		       jnb     short loc_4160E3
.text:004160DB
.text:004160DB loc_4160DB:			       ; CODE XREF: __crtCompareStringA_stat+16Cj
.text:004160DB					       ; __crtCompareStringA_stat+173j	...
.text:004160DB		       xor     eax, eax
.text:004160DD		       inc     eax
.text:004160DE		       jmp     loc_4162F5
.text:004160E3 ; ---------------------------------------------------------------------------
.text:004160E3
.text:004160E3 loc_4160E3:			       ; CODE XREF: __crtCompareStringA_stat+15Bj
.text:004160E3		       cmp     [ebp+lpCPInfo.LeadByte],	0
.text:004160E7		       lea     eax, [ebp+lpCPInfo.LeadByte]
.text:004160EA		       jz      short loc_4160DB
.text:004160EC
.text:004160EC loc_4160EC:			       ; CODE XREF: __crtCompareStringA_stat+18Bj
.text:004160EC		       mov     dl, [eax+1]
.text:004160EF		       test    dl, dl
.text:004160F1		       jz      short loc_4160DB
.text:004160F3		       mov     plocinfo, [ebp+var_1C]
.text:004160F6		       mov     cl, [plocinfo]
.text:004160F8		       cmp     cl, [eax]
.text:004160FA		       jb      short loc_416104
.text:004160FC		       cmp     cl, dl
.text:004160FE		       jbe     loc_416078
.text:00416104
.text:00416104 loc_416104:			       ; CODE XREF: __crtCompareStringA_stat+17Cj
.text:00416104		       inc     eax
.text:00416105		       inc     eax
.text:00416106		       cmp     byte ptr	[eax], 0
.text:00416109		       jnz     short loc_4160EC
.text:0041610B		       jmp     short loc_4160DB
.text:0041610D ; ---------------------------------------------------------------------------
.text:0041610D
.text:0041610D loc_41610D:			       ; CODE XREF: __crtCompareStringA_stat+EFj
.text:0041610D					       ; __crtCompareStringA_stat+155j
.text:0041610D		       mov     esi, ds:__imp__MultiByteToWideChar@24 ; MultiByteToWideChar(x,x,x,x,x,x)
.text:00416113		       push    edi	       ; cchWideChar
.text:00416114		       push    edi	       ; lpWideCharStr
.text:00416115		       push    [ebp+cchCount1] ; cbMultiByte
.text:00416118		       push    ebx	       ; lpMultiByteStr
.text:00416119		       push    9	       ; dwFlags
.text:0041611B		       push    [ebp+code_page] ; CodePage
.text:0041611E		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00416120		       mov     ebx, eax
.text:00416122		       cmp     ebx, edi
.text:00416124		       mov     [ebp+buff_size1], ebx
.text:00416127		       jz      loc_41602C
.text:0041612D		       test    ebx, ebx
.text:0041612F		       mov     edi, 400h
.text:00416134		       jle     short loc_416176
.text:00416136		       push    0FFFFFFE0h
.text:00416138		       xor     lpString1, lpString1
.text:0041613A		       pop     eax
.text:0041613B		       div     ebx
.text:0041613D		       cmp     eax, 2
.text:00416140		       jb      short loc_416176
.text:00416142		       lea     eax, [ebx+ebx+8]
.text:00416146		       cmp     eax, edi
.text:00416148		       ja      short loc_41615D
.text:0041614A		       call    __alloca_probe_16
.text:0041614F		       mov     eax, esp
.text:00416151		       test    eax, eax
.text:00416153		       jz      short loc_416171
.text:00416155		       mov     dword ptr [eax],	0CCCCh
.text:0041615B		       jmp     short loc_41616E
.text:0041615D ; ---------------------------------------------------------------------------
.text:0041615D
.text:0041615D loc_41615D:			       ; CODE XREF: __crtCompareStringA_stat+1CAj
.text:0041615D		       push    eax	       ; size
.text:0041615E		       call    _malloc
.text:00416163		       test    eax, eax
.text:00416165		       pop     plocinfo
.text:00416166		       jz      short loc_416171
.text:00416168		       mov     dword ptr [eax],	0DDDDh
.text:0041616E
.text:0041616E loc_41616E:			       ; CODE XREF: __crtCompareStringA_stat+1DDj
.text:0041616E		       add     eax, 8
.text:00416171
.text:00416171 loc_416171:			       ; CODE XREF: __crtCompareStringA_stat+1D5j
.text:00416171					       ; __crtCompareStringA_stat+1E8j
.text:00416171		       mov     [ebp+wbuffer1], eax
.text:00416174		       jmp     short loc_41617A
.text:00416176 ; ---------------------------------------------------------------------------
.text:00416176
.text:00416176 loc_416176:			       ; CODE XREF: __crtCompareStringA_stat+1B6j
.text:00416176					       ; __crtCompareStringA_stat+1C2j
.text:00416176		       and     [ebp+wbuffer1], 0
.text:0041617A
.text:0041617A loc_41617A:			       ; CODE XREF: __crtCompareStringA_stat+1F6j
.text:0041617A		       cmp     [ebp+wbuffer1], 0
.text:0041617E		       jz      loc_41602C
.text:00416184		       push    ebx	       ; cchWideChar
.text:00416185		       push    [ebp+wbuffer1]  ; lpWideCharStr
.text:00416188		       push    [ebp+cchCount1] ; cbMultiByte
.text:0041618B		       push    [ebp+lpSrcStr]  ; lpMultiByteStr
.text:0041618E		       push    1	       ; dwFlags
.text:00416190		       push    [ebp+code_page] ; CodePage
.text:00416193		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:00416195		       test    eax, eax
.text:00416197		       jz      error_cleanup_4
.text:0041619D		       push    0	       ; cchWideChar
.text:0041619F		       push    0	       ; lpWideCharStr
.text:004161A1		       push    [ebp+cchCount2] ; cbMultiByte
.text:004161A4		       push    [ebp+var_1C]    ; lpMultiByteStr
.text:004161A7		       push    9	       ; dwFlags
.text:004161A9		       push    [ebp+code_page] ; CodePage
.text:004161AC		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:004161AE		       mov     ebx, eax
.text:004161B0		       test    ebx, ebx
.text:004161B2		       jz      short error_cleanup_4
.text:004161B4		       jle     short loc_4161F8
.text:004161B6		       push    0FFFFFFE0h
.text:004161B8		       xor     lpString1, lpString1
.text:004161BA		       pop     eax
.text:004161BB		       div     ebx
.text:004161BD		       cmp     eax, 2
.text:004161C0		       jb      short loc_4161F8
.text:004161C2		       lea     eax, [ebx+ebx+8]
.text:004161C6		       cmp     eax, edi
.text:004161C8		       ja      short loc_4161E0
.text:004161CA		       call    __alloca_probe_16
.text:004161CF		       mov     edi, esp
.text:004161D1		       test    edi, edi
.text:004161D3		       jz      short error_cleanup_4
.text:004161D5		       mov     dword ptr [edi],	0CCCCh
.text:004161DB		       add     edi, 8
.text:004161DE		       jmp     short loc_4161FA
.text:004161E0 ; ---------------------------------------------------------------------------
.text:004161E0
.text:004161E0 loc_4161E0:			       ; CODE XREF: __crtCompareStringA_stat+24Aj
.text:004161E0		       push    eax	       ; size
.text:004161E1		       call    _malloc
.text:004161E6		       test    eax, eax
.text:004161E8		       pop     plocinfo
.text:004161E9		       jz      short loc_4161F4
.text:004161EB		       mov     dword ptr [eax],	0DDDDh
.text:004161F1		       add     eax, 8
.text:004161F4
.text:004161F4 loc_4161F4:			       ; CODE XREF: __crtCompareStringA_stat+26Bj
.text:004161F4		       mov     edi, eax
.text:004161F6		       jmp     short loc_4161FA
.text:004161F8 ; ---------------------------------------------------------------------------
.text:004161F8
.text:004161F8 loc_4161F8:			       ; CODE XREF: __crtCompareStringA_stat+236j
.text:004161F8					       ; __crtCompareStringA_stat+242j
.text:004161F8		       xor     edi, edi
.text:004161FA
.text:004161FA loc_4161FA:			       ; CODE XREF: __crtCompareStringA_stat+260j
.text:004161FA					       ; __crtCompareStringA_stat+278j
.text:004161FA		       test    edi, edi
.text:004161FC		       jz      short error_cleanup_4
.text:004161FE		       push    ebx	       ; cchWideChar
.text:004161FF		       push    edi	       ; lpWideCharStr
.text:00416200		       push    [ebp+cchCount2] ; cbMultiByte
.text:00416203		       push    [ebp+var_1C]    ; lpMultiByteStr
.text:00416206		       push    1	       ; dwFlags
.text:00416208		       push    [ebp+code_page] ; CodePage
.text:0041620B		       call    esi ; MultiByteToWideChar(x,x,x,x,x,x) ;	MultiByteToWideChar(x,x,x,x,x,x)
.text:0041620D		       test    eax, eax
.text:0041620F		       jz      short loc_416228
.text:00416211		       push    ebx	       ; cchCount2
.text:00416212		       push    edi	       ; lpString2
.text:00416213		       push    [ebp+buff_size1]	; cchCount1
.text:00416216		       push    [ebp+wbuffer1]  ; lpString1
.text:00416219		       push    [ebp+dwCmpFlags]	; dwCmpFlags
.text:0041621C		       push    [ebp+Locale]    ; Locale
.text:0041621F		       call    ds:__imp__CompareStringW@24 ; CompareStringW(x,x,x,x,x,x)
.text:00416225		       mov     [ebp+retcode], eax
.text:00416228
.text:00416228 loc_416228:			       ; CODE XREF: __crtCompareStringA_stat+291j
.text:00416228		       push    edi	       ; _Memory
.text:00416229		       call    __freea
.text:0041622E		       pop     plocinfo
.text:0041622F
.text:0041622F error_cleanup_4:			       ; CODE XREF: __crtCompareStringA_stat+219j
.text:0041622F					       ; __crtCompareStringA_stat+234j	...
.text:0041622F		       push    [ebp+wbuffer1]  ; _Memory
.text:00416232		       call    __freea
.text:00416237		       mov     eax, [ebp+retcode]
.text:0041623A		       pop     plocinfo
.text:0041623B		       jmp     loc_4162F5
.text:00416240 ; ---------------------------------------------------------------------------
.text:00416240
.text:00416240 loc_416240:			       ; CODE XREF: __crtCompareStringA_stat+C3j
.text:00416240					       ; __crtCompareStringA_stat+CBj
.text:00416240		       xor     edi, edi
.text:00416242		       xor     ebx, ebx
.text:00416244		       cmp     [ebp+Locale], edi
.text:00416247		       jnz     short loc_416251
.text:00416249		       mov     eax, [esi]
.text:0041624B		       mov     eax, [eax+14h]
.text:0041624E		       mov     [ebp+Locale], eax
.text:00416251
.text:00416251 loc_416251:			       ; CODE XREF: __crtCompareStringA_stat+2C9j
.text:00416251		       cmp     [ebp+code_page],	edi
.text:00416254		       jnz     short loc_41625E
.text:00416256		       mov     eax, [esi]
.text:00416258		       mov     eax, [eax+4]
.text:0041625B		       mov     [ebp+code_page],	eax
.text:0041625E
.text:0041625E loc_41625E:			       ; CODE XREF: __crtCompareStringA_stat+2D6j
.text:0041625E		       push    [ebp+Locale]    ; lcid
.text:00416261		       call    ___ansicp
.text:00416266		       mov     esi, eax
.text:00416268		       cmp     esi, 0FFFFFFFFh
.text:0041626B		       pop     plocinfo
.text:0041626C		       jz      loc_41602C
.text:00416272		       cmp     esi, [ebp+code_page]
.text:00416275		       jz      short loc_4162C7
.text:00416277		       push    0	       ; cchDest
.text:00416279		       push    0	       ; lpDestStr
.text:0041627B		       lea     eax, [ebp+cchCount1]
.text:0041627E		       push    eax	       ; pcchSrc
.text:0041627F		       push    [ebp+lpSrcStr]  ; lpSrcStr
.text:00416282		       push    esi	       ; toCP
.text:00416283		       push    [ebp+code_page] ; fromCP
.text:00416286		       call    ___convertcp
.text:0041628B		       mov     ebx, eax
.text:0041628D		       add     esp, 18h
.text:00416290		       test    ebx, ebx
.text:00416292		       jz      loc_41602C
.text:00416298		       push    0	       ; cchDest
.text:0041629A		       push    0	       ; lpDestStr
.text:0041629C		       lea     eax, [ebp+cchCount2]
.text:0041629F		       push    eax	       ; pcchSrc
.text:004162A0		       push    [ebp+var_1C]    ; lpSrcStr
.text:004162A3		       push    esi	       ; toCP
.text:004162A4		       push    [ebp+code_page] ; fromCP
.text:004162A7		       call    ___convertcp
.text:004162AC		       mov     edi, eax
.text:004162AE		       add     esp, 18h
.text:004162B1		       test    edi, edi
.text:004162B3		       jnz     short loc_4162C1
.text:004162B5		       push    ebx	       ; pBlock
.text:004162B6		       call    _free
.text:004162BB		       pop     plocinfo
.text:004162BC		       jmp     loc_41602C
.text:004162C1 ; ---------------------------------------------------------------------------
.text:004162C1
.text:004162C1 loc_4162C1:			       ; CODE XREF: __crtCompareStringA_stat+335j
.text:004162C1		       mov     [ebp+lpSrcStr], ebx
.text:004162C4		       mov     [ebp+var_1C], edi
.text:004162C7
.text:004162C7 loc_4162C7:			       ; CODE XREF: __crtCompareStringA_stat+2F7j
.text:004162C7		       push    [ebp+cchCount2] ; cchCount2
.text:004162CA		       push    [ebp+var_1C]    ; lpString2
.text:004162CD		       push    [ebp+cchCount1] ; cchCount1
.text:004162D0		       push    [ebp+lpSrcStr]  ; lpString1
.text:004162D3		       push    [ebp+dwCmpFlags]	; dwCmpFlags
.text:004162D6		       push    [ebp+Locale]    ; Locale
.text:004162D9		       call    ds:__imp__CompareStringA@24 ; CompareStringA(x,x,x,x,x,x)
.text:004162DF		       test    ebx, ebx
.text:004162E1		       mov     esi, eax
.text:004162E3		       jz      short loc_4162F3
.text:004162E5		       push    ebx	       ; pBlock
.text:004162E6		       call    _free
.text:004162EB		       push    edi	       ; pBlock
.text:004162EC		       call    _free
.text:004162F1		       pop     plocinfo
.text:004162F2		       pop     plocinfo
.text:004162F3
.text:004162F3 loc_4162F3:			       ; CODE XREF: __crtCompareStringA_stat+365j
.text:004162F3		       mov     eax, esi
.text:004162F5
.text:004162F5 loc_4162F5:			       ; CODE XREF: __crtCompareStringA_stat+B0j
.text:004162F5					       ; __crtCompareStringA_stat+FDj ...
.text:004162F5		       lea     esp, [ebp-38h]
.text:004162F8		       pop     edi
.text:004162F9		       pop     esi
.text:004162FA		       pop     ebx
.text:004162FB		       mov     plocinfo, [ebp+var_4]
.text:004162FE		       xor     plocinfo, ebp   ; cookie
.text:00416300		       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:00416305		       leave
.text:00416306		       retn
.text:00416306 __crtCompareStringA_stat	endp
.text:00416306
.text:00416307
.text:00416307 ; =============== S U B R O U T I N E =======================================
.text:00416307
.text:00416307 ; Attributes: bp-based frame
.text:00416307
.text:00416307 ; int __cdecl __crtCompareStringA(localeinfo_struct *plocinfo, unsigned int Locale, unsigned int	dwCmpFlags, const char *lpString1, int cchCount1, const	char *lpString2, int cchCount2,	int code_page)
.text:00416307 ___crtCompareStringA proc near	       ; CODE XREF: __mbsnbicoll_l+BDp
.text:00416307					       ; __strnicoll_l+BEp
.text:00416307
.text:00416307 _loc_update     = _LocaleUpdate ptr -10h
.text:00416307 plocinfo	       = dword ptr  8
.text:00416307 Locale	       = dword ptr  0Ch
.text:00416307 dwCmpFlags      = dword ptr  10h
.text:00416307 lpString1       = dword ptr  14h
.text:00416307 cchCount1       = dword ptr  18h
.text:00416307 lpString2       = dword ptr  1Ch
.text:00416307 cchCount2       = dword ptr  20h
.text:00416307 code_page       = dword ptr  24h
.text:00416307
.text:00416307		       push    ebp
.text:00416308		       mov     ebp, esp
.text:0041630A		       sub     esp, 10h
.text:0041630D		       push    [ebp+plocinfo]  ; plocinfo
.text:00416310		       lea     ecx, [ebp+_loc_update] ;	this
.text:00416313		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00416318		       push    [ebp+code_page] ; code_page
.text:0041631B		       mov     edx, [ebp+lpString1] ; lpString1
.text:0041631E		       push    [ebp+cchCount2] ; cchCount2
.text:00416321		       lea     ecx, [ebp+_loc_update] ;	plocinfo
.text:00416324		       push    [ebp+lpString2] ; lpString2
.text:00416327		       push    [ebp+cchCount1] ; cchCount1
.text:0041632A		       push    [ebp+dwCmpFlags]	; dwCmpFlags
.text:0041632D		       push    [ebp+Locale]    ; Locale
.text:00416330		       call    __crtCompareStringA_stat
.text:00416335		       add     esp, 18h
.text:00416338		       cmp     [ebp+_loc_update.updated], 0
.text:0041633C		       jz      short locret_416345
.text:0041633E		       mov     ecx, [ebp+_loc_update.ptd]
.text:00416341		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00416345
.text:00416345 locret_416345:			       ; CODE XREF: ___crtCompareStringA+35j
.text:00416345		       leave
.text:00416346		       retn
.text:00416346 ___crtCompareStringA endp
.text:00416346
.text:00416347
.text:00416347 ; =============== S U B R O U T I N E =======================================
.text:00416347
.text:00416347 ; Attributes: bp-based frame
.text:00416347
.text:00416347 ; int __cdecl _strnicoll_l(const	char *_string1,	const char *_string2, unsigned int count, localeinfo_struct *plocinfo)
.text:00416347 __strnicoll_l   proc near	       ; CODE XREF: __mbsnbicoll_l+9Cp
.text:00416347					       ; __strnicoll+1Dp
.text:00416347
.text:00416347 _loc_update     = _LocaleUpdate ptr -10h
.text:00416347 _string1	       = dword ptr  8
.text:00416347 _string2	       = dword ptr  0Ch
.text:00416347 count	       = dword ptr  10h
.text:00416347 plocinfo	       = dword ptr  14h
.text:00416347
.text:00416347		       push    ebp
.text:00416348		       mov     ebp, esp
.text:0041634A		       sub     esp, 10h
.text:0041634D		       push    ebx
.text:0041634E		       push    [ebp+plocinfo]  ; plocinfo
.text:00416351		       lea     ecx, [ebp+_loc_update] ;	this
.text:00416354		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:00416359		       mov     edx, [ebp+count]
.text:0041635C		       xor     ebx, ebx
.text:0041635E		       cmp     edx, ebx
.text:00416360		       jnz     short loc_416375
.text:00416362		       cmp     [ebp+_loc_update.updated], bl
.text:00416365		       jz      short loc_41636E
.text:00416367		       mov     eax, [ebp+_loc_update.ptd]
.text:0041636A		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0041636E
.text:0041636E loc_41636E:			       ; CODE XREF: __strnicoll_l+1Ej
.text:0041636E		       xor     eax, eax
.text:00416370		       jmp     loc_41643C
.text:00416375 ; ---------------------------------------------------------------------------
.text:00416375
.text:00416375 loc_416375:			       ; CODE XREF: __strnicoll_l+19j
.text:00416375		       cmp     [ebp+_string1], ebx
.text:00416378		       jnz     short loc_4163A8
.text:0041637A
.text:0041637A loc_41637A:			       ; CODE XREF: __strnicoll_l+64j
.text:0041637A		       call    __errno
.text:0041637F		       push    ebx	       ; pReserved
.text:00416380		       push    ebx	       ; nLine
.text:00416381		       push    ebx	       ; pszFile
.text:00416382		       push    ebx	       ; pszFunction
.text:00416383		       push    ebx	       ; pszExpression
.text:00416384		       mov     dword ptr [eax],	16h
.text:0041638A		       call    __invalid_parameter
.text:0041638F		       add     esp, 14h
.text:00416392		       cmp     [ebp+_loc_update.updated], bl
.text:00416395		       jz      short loc_41639E
.text:00416397		       mov     eax, [ebp+_loc_update.ptd]
.text:0041639A		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:0041639E
.text:0041639E loc_41639E:			       ; CODE XREF: __strnicoll_l+4Ej
.text:0041639E		       mov     eax, 7FFFFFFFh
.text:004163A3		       jmp     loc_41643C
.text:004163A8 ; ---------------------------------------------------------------------------
.text:004163A8
.text:004163A8 loc_4163A8:			       ; CODE XREF: __strnicoll_l+31j
.text:004163A8		       cmp     [ebp+_string2], ebx
.text:004163AB		       jz      short loc_41637A
.text:004163AD		       push    esi
.text:004163AE		       mov     esi, 7FFFFFFFh
.text:004163B3		       cmp     edx, esi
.text:004163B5		       jbe     short loc_4163D1
.text:004163B7		       call    __errno
.text:004163BC		       push    ebx	       ; pReserved
.text:004163BD		       push    ebx	       ; nLine
.text:004163BE		       push    ebx	       ; pszFile
.text:004163BF		       push    ebx	       ; pszFunction
.text:004163C0		       push    ebx	       ; pszExpression
.text:004163C1		       mov     dword ptr [eax],	16h
.text:004163C7		       call    __invalid_parameter
.text:004163CC		       add     esp, 14h
.text:004163CF		       jmp     short loc_41641C
.text:004163D1 ; ---------------------------------------------------------------------------
.text:004163D1
.text:004163D1 loc_4163D1:			       ; CODE XREF: __strnicoll_l+6Ej
.text:004163D1		       mov     eax, [ebp+_loc_update.localeinfo.locinfo]
.text:004163D4		       mov     ecx, [eax+10h]
.text:004163D7		       cmp     ecx, ebx
.text:004163D9		       jnz     short loc_4163F0
.text:004163DB		       lea     eax, [ebp+_loc_update]
.text:004163DE		       push    eax	       ; plocinfo
.text:004163DF		       push    edx	       ; count
.text:004163E0		       push    [ebp+_string2]  ; src
.text:004163E3		       push    [ebp+_string1]  ; dst
.text:004163E6		       call    __strnicmp_l
.text:004163EB		       add     esp, 10h
.text:004163EE		       jmp     short loc_41642F
.text:004163F0 ; ---------------------------------------------------------------------------
.text:004163F0
.text:004163F0 loc_4163F0:			       ; CODE XREF: __strnicoll_l+92j
.text:004163F0		       push    dword ptr [eax+8] ; code_page
.text:004163F3		       lea     eax, [ebp+_loc_update]
.text:004163F6		       push    edx	       ; cchCount2
.text:004163F7		       push    [ebp+_string2]  ; lpString2
.text:004163FA		       push    edx	       ; cchCount1
.text:004163FB		       push    [ebp+_string1]  ; lpString1
.text:004163FE		       push    1001h	       ; dwCmpFlags
.text:00416403		       push    ecx	       ; Locale
.text:00416404		       push    eax	       ; plocinfo
.text:00416405		       call    ___crtCompareStringA
.text:0041640A		       add     esp, 20h
.text:0041640D		       cmp     eax, ebx
.text:0041640F		       jnz     short loc_41642C
.text:00416411		       call    __errno
.text:00416416		       mov     dword ptr [eax],	16h
.text:0041641C
.text:0041641C loc_41641C:			       ; CODE XREF: __strnicoll_l+88j
.text:0041641C		       cmp     [ebp+_loc_update.updated], bl
.text:0041641F		       jz      short loc_416428
.text:00416421		       mov     eax, [ebp+_loc_update.ptd]
.text:00416424		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00416428
.text:00416428 loc_416428:			       ; CODE XREF: __strnicoll_l+D8j
.text:00416428		       mov     eax, esi
.text:0041642A		       jmp     short loc_41643B
.text:0041642C ; ---------------------------------------------------------------------------
.text:0041642C
.text:0041642C loc_41642C:			       ; CODE XREF: __strnicoll_l+C8j
.text:0041642C		       add     eax, 0FFFFFFFEh
.text:0041642F
.text:0041642F loc_41642F:			       ; CODE XREF: __strnicoll_l+A7j
.text:0041642F		       cmp     [ebp+_loc_update.updated], bl
.text:00416432		       jz      short loc_41643B
.text:00416434		       mov     ecx, [ebp+_loc_update.ptd]
.text:00416437		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:0041643B
.text:0041643B loc_41643B:			       ; CODE XREF: __strnicoll_l+E3j
.text:0041643B					       ; __strnicoll_l+EBj
.text:0041643B		       pop     esi
.text:0041643C
.text:0041643C loc_41643C:			       ; CODE XREF: __strnicoll_l+29j
.text:0041643C					       ; __strnicoll_l+5Cj
.text:0041643C		       pop     ebx
.text:0041643D		       leave
.text:0041643E		       retn
.text:0041643E __strnicoll_l   endp
.text:0041643E
.text:0041643F
.text:0041643F ; =============== S U B R O U T I N E =======================================
.text:0041643F
.text:0041643F ; Attributes: bp-based frame
.text:0041643F
.text:0041643F ; int __cdecl _strnicoll(const char *_string1, const char *_string2, unsigned int count)
.text:0041643F __strnicoll     proc near
.text:0041643F
.text:0041643F _string1	       = dword ptr  8
.text:0041643F _string2	       = dword ptr  0Ch
.text:0041643F count	       = dword ptr  10h
.text:0041643F
.text:0041643F		       push    ebp
.text:00416440		       mov     ebp, esp
.text:00416442		       cmp     ___locale_changed, 0
.text:00416449		       jnz     short loc_416451
.text:0041644B		       pop     ebp
.text:0041644C		       jmp     __strnicmp
.text:00416451 ; ---------------------------------------------------------------------------
.text:00416451
.text:00416451 loc_416451:			       ; CODE XREF: __strnicoll+Aj
.text:00416451		       push    0	       ; plocinfo
.text:00416453		       push    [ebp+count]     ; count
.text:00416456		       push    [ebp+_string2]  ; _string2
.text:00416459		       push    [ebp+_string1]  ; _string1
.text:0041645C		       call    __strnicoll_l
.text:00416461		       add     esp, 10h
.text:00416464		       pop     ebp
.text:00416465		       retn
.text:00416465 __strnicoll     endp
.text:00416465
.text:00416466
.text:00416466 ; =============== S U B R O U T I N E =======================================
.text:00416466
.text:00416466
.text:00416466 ; int __usercall	findenv<eax>(const char	*name, int len<edi>)
.text:00416466 findenv	       proc near	       ; CODE XREF: ___crtsetenv+EEp
.text:00416466
.text:00416466 name	       = dword ptr  4
.text:00416466
.text:00416466 len = edi
.text:00416466		       push    esi
.text:00416467		       mov     esi, __environ
.text:0041646D		       jmp     short loc_416491
.text:0041646F ; ---------------------------------------------------------------------------
.text:0041646F
.text:0041646F loc_41646F:			       ; CODE XREF: findenv+2Fj
.text:0041646F		       push    len	       ; n
.text:00416470		       push    eax	       ; s2
.text:00416471		       push    [esp+0Ch+name]  ; s1
.text:00416475		       call    __mbsnbicoll
.text:0041647A		       add     esp, 0Ch
.text:0041647D		       test    eax, eax
.text:0041647F		       jnz     short loc_41648E
.text:00416481		       mov     eax, [esi]
.text:00416483		       mov     al, [len+eax]
.text:00416486		       cmp     al, 3Dh
.text:00416488		       jz      short loc_4164A6
.text:0041648A		       test    al, al
.text:0041648C		       jz      short loc_4164A6
.text:0041648E
.text:0041648E loc_41648E:			       ; CODE XREF: findenv+19j
.text:0041648E		       add     esi, 4
.text:00416491
.text:00416491 loc_416491:			       ; CODE XREF: findenv+7j
.text:00416491		       mov     eax, [esi]
.text:00416493		       test    eax, eax
.text:00416495		       jnz     short loc_41646F
.text:00416497		       mov     eax, esi
.text:00416499		       sub     eax, __environ
.text:0041649F		       pop     esi
.text:004164A0		       sar     eax, 2
.text:004164A3		       neg     eax
.text:004164A5		       retn
.text:004164A6 ; ---------------------------------------------------------------------------
.text:004164A6
.text:004164A6 loc_4164A6:			       ; CODE XREF: findenv+22j
.text:004164A6					       ; findenv+26j
.text:004164A6		       mov     eax, esi
.text:004164A8		       sub     eax, __environ
.text:004164AE		       pop     esi
.text:004164AF		       sar     eax, 2
.text:004164B2		       retn
.text:004164B2 findenv	       endp
.text:004164B2
.text:004164B3
.text:004164B3 ; =============== S U B R O U T I N E =======================================
.text:004164B3
.text:004164B3 ; Attributes: bp-based frame
.text:004164B3
.text:004164B3 ; char **__usercall copy_environ<eax>(char **oldenviron<edi>)
.text:004164B3 copy_environ    proc near	       ; CODE XREF: ___crtsetenv+6Ap
.text:004164B3
.text:004164B3 newenviron      = dword ptr -4
.text:004164B3
.text:004164B3 oldenviron = edi
.text:004164B3		       push    ebp
.text:004164B4		       mov     ebp, esp
.text:004164B6		       push    ecx
.text:004164B7		       xor     eax, eax
.text:004164B9		       test    oldenviron, oldenviron
.text:004164BB		       mov     ecx, oldenviron
.text:004164BD		       jnz     short loc_4164C1
.text:004164BF		       leave
.text:004164C0		       retn
.text:004164C1 ; ---------------------------------------------------------------------------
.text:004164C1
.text:004164C1 loc_4164C1:			       ; CODE XREF: copy_environ+Aj
.text:004164C1		       cmp     [oldenviron], eax
.text:004164C3		       jz      short loc_4164CE
.text:004164C5
.text:004164C5 loc_4164C5:			       ; CODE XREF: copy_environ+19j
.text:004164C5		       add     ecx, 4
.text:004164C8		       inc     eax
.text:004164C9		       cmp     dword ptr [ecx],	0
.text:004164CC		       jnz     short loc_4164C5
.text:004164CE
.text:004164CE loc_4164CE:			       ; CODE XREF: copy_environ+10j
.text:004164CE		       push    ebx
.text:004164CF		       push    esi
.text:004164D0		       inc     eax
.text:004164D1		       push    4	       ; size
.text:004164D3		       push    eax	       ; count
.text:004164D4		       call    __calloc_crt
.text:004164D9		       mov     esi, eax
.text:004164DB		       test    esi, esi
.text:004164DD		       pop     ecx
.text:004164DE		       pop     ecx
.text:004164DF		       mov     [ebp+newenviron], esi
.text:004164E2		       jnz     short loc_4164EC
.text:004164E4		       push    9	       ; rterrnum
.text:004164E6		       call    __amsg_exit
.text:004164EB		       pop     ecx
.text:004164EC
.text:004164EC loc_4164EC:			       ; CODE XREF: copy_environ+2Fj
.text:004164EC		       mov     eax, [oldenviron]
.text:004164EE		       mov     ebx, oldenviron
.text:004164F0		       jmp     short loc_416503
.text:004164F2 ; ---------------------------------------------------------------------------
.text:004164F2
.text:004164F2 loc_4164F2:			       ; CODE XREF: copy_environ+52j
.text:004164F2		       push    eax	       ; string
.text:004164F3		       call    __strdup
.text:004164F8		       mov     [esi], eax
.text:004164FA		       add     esi, 4
.text:004164FD		       add     ebx, 4
.text:00416500		       mov     eax, [ebx]
.text:00416502		       pop     ecx
.text:00416503
.text:00416503 loc_416503:			       ; CODE XREF: copy_environ+3Dj
.text:00416503		       test    eax, eax
.text:00416505		       jnz     short loc_4164F2
.text:00416507		       and     [esi], eax
.text:00416509		       mov     eax, [ebp+newenviron]
.text:0041650C		       pop     esi
.text:0041650D		       pop     ebx
.text:0041650E		       leave
.text:0041650F		       retn
.text:0041650F copy_environ    endp
.text:0041650F
.text:00416510
.text:00416510 ; =============== S U B R O U T I N E =======================================
.text:00416510
.text:00416510 ; Attributes: bp-based frame
.text:00416510
.text:00416510 ; int __cdecl __crtsetenv(char **poption, const int primary)
.text:00416510 ___crtsetenv    proc near	       ; CODE XREF: ___wtomb_environ+59p
.text:00416510
.text:00416510 env	       = dword ptr -14h
.text:00416510 retval	       = dword ptr -10h
.text:00416510 equal	       = dword ptr -0Ch
.text:00416510 remove	       = dword ptr -8
.text:00416510 option	       = dword ptr -4
.text:00416510 poption	       = dword ptr  8
.text:00416510 primary	       = dword ptr  0Ch
.text:00416510
.text:00416510		       push    ebp
.text:00416511		       mov     ebp, esp
.text:00416513		       sub     esp, 14h
.text:00416516		       mov     eax, [ebp+poption]
.text:00416519		       push    ebx
.text:0041651A		       xor     ebx, ebx
.text:0041651C		       cmp     eax, ebx
.text:0041651E		       push    edi
.text:0041651F		       mov     [ebp+retval], ebx
.text:00416522		       jnz     short loc_416541
.text:00416524		       call    __errno
.text:00416529		       push    ebx	       ; pReserved
.text:0041652A		       push    ebx	       ; nLine
.text:0041652B		       push    ebx	       ; pszFile
.text:0041652C		       push    ebx	       ; pszFunction
.text:0041652D		       push    ebx	       ; pszExpression
.text:0041652E		       mov     dword ptr [eax],	16h
.text:00416534		       call    __invalid_parameter
.text:00416539		       add     esp, 14h
.text:0041653C		       or      eax, 0FFFFFFFFh
.text:0041653F		       jmp     short loc_4165AD
.text:00416541 ; ---------------------------------------------------------------------------
.text:00416541
.text:00416541 loc_416541:			       ; CODE XREF: ___crtsetenv+12j
.text:00416541		       push    esi
.text:00416542		       mov     esi, [eax]
.text:00416544		       cmp     esi, ebx
.text:00416546		       mov     [ebp+option], esi
.text:00416549		       jz      short loc_41659E
.text:0041654B		       push    3Dh	       ; c
.text:0041654D		       push    esi	       ; string
.text:0041654E		       call    __mbschr
.text:00416553		       cmp     eax, ebx
.text:00416555		       pop     ecx
.text:00416556		       pop     ecx
.text:00416557		       mov     [ebp+equal], eax
.text:0041655A		       jz      short loc_41659E
.text:0041655C		       cmp     esi, eax
.text:0041655E		       jz      short loc_41659E
.text:00416560		       xor     ecx, ecx
.text:00416562		       cmp     [eax+1],	bl
.text:00416565		       mov     eax, __environ
.text:0041656A		       setz    cl
.text:0041656D		       cmp     eax, ___initenv
.text:00416573		       mov     [ebp+remove], ecx
.text:00416576		       jnz     short loc_416584
.text:00416578		       mov     edi, eax	       ; oldenviron
.text:0041657A		       call    copy_environ
.text:0041657F		       mov     __environ, eax
.text:00416584
.text:00416584 loc_416584:			       ; CODE XREF: ___crtsetenv+66j
.text:00416584		       cmp     eax, ebx
.text:00416586		       jnz     short loc_4165E8
.text:00416588		       cmp     [ebp+primary], ebx
.text:0041658B		       jz      short loc_4165B1
.text:0041658D		       cmp     __wenviron, ebx
.text:00416593		       jz      short loc_4165B1
.text:00416595		       call    ___wtomb_environ
.text:0041659A		       test    eax, eax
.text:0041659C		       jz      short loc_4165E8
.text:0041659E
.text:0041659E loc_41659E:			       ; CODE XREF: ___crtsetenv+39j
.text:0041659E					       ; ___crtsetenv+4Aj ...
.text:0041659E		       call    __errno
.text:004165A3		       mov     dword ptr [eax],	16h
.text:004165A9
.text:004165A9 loc_4165A9:			       ; CODE XREF: ___crtsetenv+B9j
.text:004165A9					       ; ___crtsetenv+D4j ...
.text:004165A9		       or      eax, 0FFFFFFFFh
.text:004165AC
.text:004165AC loc_4165AC:			       ; CODE XREF: ___crtsetenv+232j
.text:004165AC					       ; ___crtsetenv+247j
.text:004165AC		       pop     esi
.text:004165AD
.text:004165AD loc_4165AD:			       ; CODE XREF: ___crtsetenv+2Fj
.text:004165AD		       pop     edi
.text:004165AE		       pop     ebx
.text:004165AF		       leave
.text:004165B0		       retn
.text:004165B1 ; ---------------------------------------------------------------------------
.text:004165B1
.text:004165B1 loc_4165B1:			       ; CODE XREF: ___crtsetenv+7Bj
.text:004165B1					       ; ___crtsetenv+83j
.text:004165B1		       cmp     [ebp+remove], ebx
.text:004165B4		       jnz     loc_416755
.text:004165BA		       push    4	       ; cb
.text:004165BC		       call    __malloc_crt
.text:004165C1		       cmp     eax, ebx
.text:004165C3		       pop     ecx
.text:004165C4		       mov     __environ, eax
.text:004165C9		       jz      short loc_4165A9
.text:004165CB		       mov     [eax], ebx
.text:004165CD		       cmp     __wenviron, ebx
.text:004165D3		       jnz     short loc_4165E8
.text:004165D5		       push    4	       ; cb
.text:004165D7		       call    __malloc_crt
.text:004165DC		       cmp     eax, ebx
.text:004165DE		       pop     ecx
.text:004165DF		       mov     __wenviron, eax
.text:004165E4		       jz      short loc_4165A9
.text:004165E6		       mov     [eax], ebx
.text:004165E8
.text:004165E8 loc_4165E8:			       ; CODE XREF: ___crtsetenv+76j
.text:004165E8					       ; ___crtsetenv+8Cj ...
.text:004165E8		       mov     esi, __environ
.text:004165EE		       cmp     esi, ebx
.text:004165F0		       mov     [ebp+env], esi
.text:004165F3		       jz      short loc_4165A9
.text:004165F5		       mov     edi, [ebp+equal]
.text:004165F8		       sub     edi, [ebp+option] ; len
.text:004165FB		       push    [ebp+option]    ; name
.text:004165FE		       call    findenv
.text:00416603		       mov     edi, eax
.text:00416605		       cmp     edi, ebx
.text:00416607		       pop     ecx
.text:00416608		       jl      short loc_41665C
.text:0041660A		       cmp     [esi], ebx
.text:0041660C		       jz      short loc_41665C
.text:0041660E		       lea     esi, [esi+edi*4]
.text:00416611		       push    dword ptr [esi] ; pBlock
.text:00416613		       call    _free
.text:00416618		       cmp     [ebp+remove], ebx
.text:0041661B		       pop     ecx
.text:0041661C		       jnz     short loc_416639
.text:0041661E		       mov     eax, [ebp+option]
.text:00416621		       mov     [esi], eax
.text:00416623		       mov     eax, [ebp+poption]
.text:00416626		       mov     [eax], ebx
.text:00416628		       jmp     loc_4166AF
.text:0041662D ; ---------------------------------------------------------------------------
.text:0041662D
.text:0041662D loc_41662D:			       ; CODE XREF: ___crtsetenv+12Bj
.text:0041662D		       mov     eax, [esi+4]
.text:00416630		       mov     [esi], eax
.text:00416632		       mov     eax, [ebp+env]
.text:00416635		       inc     edi
.text:00416636		       lea     esi, [eax+edi*4]
.text:00416639
.text:00416639 loc_416639:			       ; CODE XREF: ___crtsetenv+10Cj
.text:00416639		       cmp     [esi], ebx
.text:0041663B		       jnz     short loc_41662D
.text:0041663D		       cmp     edi, 3FFFFFFFh
.text:00416643		       jnb     short loc_4166AF
.text:00416645		       push    4	       ; size
.text:00416647		       push    edi	       ; count
.text:00416648		       push    __environ       ; ptr
.text:0041664E		       call    __recalloc_crt
.text:00416653		       add     esp, 0Ch
.text:00416656		       cmp     eax, ebx
.text:00416658		       jz      short loc_4166AF
.text:0041665A		       jmp     short loc_4166AA
.text:0041665C ; ---------------------------------------------------------------------------
.text:0041665C
.text:0041665C loc_41665C:			       ; CODE XREF: ___crtsetenv+F8j
.text:0041665C					       ; ___crtsetenv+FCj
.text:0041665C		       cmp     [ebp+remove], ebx
.text:0041665F		       jnz     loc_416747
.text:00416665		       cmp     edi, ebx
.text:00416667		       jge     short loc_41666B
.text:00416669		       neg     edi
.text:0041666B
.text:0041666B loc_41666B:			       ; CODE XREF: ___crtsetenv+157j
.text:0041666B		       lea     eax, [edi+2]
.text:0041666E		       cmp     eax, edi
.text:00416670		       jl      loc_4165A9
.text:00416676		       cmp     eax, 3FFFFFFFh
.text:0041667B		       jnb     loc_4165A9
.text:00416681		       push    eax	       ; size
.text:00416682		       push    4	       ; count
.text:00416684		       push    __environ       ; ptr
.text:0041668A		       call    __recalloc_crt
.text:0041668F		       add     esp, 0Ch
.text:00416692		       cmp     eax, ebx
.text:00416694		       jz      loc_4165A9
.text:0041669A		       mov     edx, [ebp+option]
.text:0041669D		       lea     ecx, [eax+edi*4]
.text:004166A0		       mov     [ecx], edx
.text:004166A2		       mov     [ecx+4],	ebx
.text:004166A5		       mov     ecx, [ebp+poption]
.text:004166A8		       mov     [ecx], ebx
.text:004166AA
.text:004166AA loc_4166AA:			       ; CODE XREF: ___crtsetenv+14Aj
.text:004166AA		       mov     __environ, eax
.text:004166AF
.text:004166AF loc_4166AF:			       ; CODE XREF: ___crtsetenv+118j
.text:004166AF					       ; ___crtsetenv+133j ...
.text:004166AF		       cmp     [ebp+primary], ebx
.text:004166B2		       jz      short loc_41672C
.text:004166B4		       mov     esi, [ebp+option]
.text:004166B7		       push    1	       ; size
.text:004166B9		       push    esi	       ; buf
.text:004166BA		       call    _strlen
.text:004166BF		       inc     eax
.text:004166C0		       pop     ecx
.text:004166C1		       inc     eax
.text:004166C2		       push    eax	       ; count
.text:004166C3		       call    __calloc_crt
.text:004166C8		       mov     edi, eax
.text:004166CA		       cmp     edi, ebx
.text:004166CC		       pop     ecx
.text:004166CD		       pop     ecx
.text:004166CE		       jz      short loc_41672C
.text:004166D0		       push    esi	       ; _Src
.text:004166D1		       push    esi	       ; buf
.text:004166D2		       call    _strlen
.text:004166D7		       inc     eax
.text:004166D8		       pop     ecx
.text:004166D9		       inc     eax
.text:004166DA		       push    eax	       ; _SizeInBytes
.text:004166DB		       push    edi	       ; _Dst
.text:004166DC		       call    _strcpy_s
.text:004166E1		       add     esp, 0Ch
.text:004166E4		       test    eax, eax
.text:004166E6		       jz      short loc_4166F5
.text:004166E8		       push    ebx	       ; pReserved
.text:004166E9		       push    ebx	       ; nLine
.text:004166EA		       push    ebx	       ; pszFile
.text:004166EB		       push    ebx	       ; pszFunction
.text:004166EC		       push    ebx	       ; pszExpression
.text:004166ED		       call    __invoke_watson
.text:004166F2		       add     esp, 14h
.text:004166F5
.text:004166F5 loc_4166F5:			       ; CODE XREF: ___crtsetenv+1D6j
.text:004166F5		       mov     ecx, [ebp+remove]
.text:004166F8		       mov     eax, edi
.text:004166FA		       sub     eax, esi
.text:004166FC		       add     eax, [ebp+equal]
.text:004166FF		       mov     [eax], bl
.text:00416701		       inc     eax
.text:00416702		       neg     ecx
.text:00416704		       sbb     ecx, ecx
.text:00416706		       not     ecx
.text:00416708		       and     ecx, eax
.text:0041670A		       push    ecx	       ; lpValue
.text:0041670B		       push    edi	       ; lpName
.text:0041670C		       call    ds:__imp__SetEnvironmentVariableA@8 ; SetEnvironmentVariableA(x,x)
.text:00416712		       test    eax, eax
.text:00416714		       jnz     short loc_416725
.text:00416716		       or      [ebp+retval], 0FFFFFFFFh
.text:0041671A		       call    __errno
.text:0041671F		       mov     dword ptr [eax],	2Ah
.text:00416725
.text:00416725 loc_416725:			       ; CODE XREF: ___crtsetenv+204j
.text:00416725		       push    edi	       ; pBlock
.text:00416726		       call    _free
.text:0041672B		       pop     ecx
.text:0041672C
.text:0041672C loc_41672C:			       ; CODE XREF: ___crtsetenv+1A2j
.text:0041672C					       ; ___crtsetenv+1BEj
.text:0041672C		       cmp     [ebp+remove], ebx
.text:0041672F		       jz      short loc_41673F
.text:00416731		       push    [ebp+option]    ; pBlock
.text:00416734		       call    _free
.text:00416739		       mov     eax, [ebp+poption]
.text:0041673C		       pop     ecx
.text:0041673D		       mov     [eax], ebx
.text:0041673F
.text:0041673F loc_41673F:			       ; CODE XREF: ___crtsetenv+21Fj
.text:0041673F		       mov     eax, [ebp+retval]
.text:00416742		       jmp     loc_4165AC
.text:00416747 ; ---------------------------------------------------------------------------
.text:00416747
.text:00416747 loc_416747:			       ; CODE XREF: ___crtsetenv+14Fj
.text:00416747		       push    [ebp+option]    ; pBlock
.text:0041674A		       call    _free
.text:0041674F		       mov     eax, [ebp+poption]
.text:00416752		       pop     ecx
.text:00416753		       mov     [eax], ebx
.text:00416755
.text:00416755 loc_416755:			       ; CODE XREF: ___crtsetenv+A4j
.text:00416755		       xor     eax, eax
.text:00416757		       jmp     loc_4165AC
.text:00416757 ___crtsetenv    endp
.text:00416757
.text:0041675C
.text:0041675C ; =============== S U B R O U T I N E =======================================
.text:0041675C
.text:0041675C
.text:0041675C ; char *__cdecl _strdup(const char *string)
.text:0041675C __strdup	       proc near	       ; CODE XREF: copy_environ+40p
.text:0041675C
.text:0041675C string	       = dword ptr  4
.text:0041675C
.text:0041675C		       push    ebx
.text:0041675D		       mov     ebx, [esp+4+string]
.text:00416761		       push    ebp
.text:00416762		       xor     ebp, ebp
.text:00416764		       cmp     ebx, ebp
.text:00416766		       jnz     short loc_41676C
.text:00416768		       xor     eax, eax
.text:0041676A		       jmp     short loc_4167A9
.text:0041676C ; ---------------------------------------------------------------------------
.text:0041676C
.text:0041676C loc_41676C:			       ; CODE XREF: __strdup+Aj
.text:0041676C		       push    esi
.text:0041676D		       push    edi
.text:0041676E		       push    ebx	       ; buf
.text:0041676F		       call    _strlen
.text:00416774		       mov     esi, eax
.text:00416776		       inc     esi
.text:00416777		       push    esi	       ; size
.text:00416778		       call    _malloc
.text:0041677D		       mov     edi, eax
.text:0041677F		       cmp     edi, ebp
.text:00416781		       pop     ecx
.text:00416782		       pop     ecx
.text:00416783		       jz      short loc_4167A5
.text:00416785		       push    ebx	       ; _Src
.text:00416786		       push    esi	       ; _SizeInBytes
.text:00416787		       push    edi	       ; _Dst
.text:00416788		       call    _strcpy_s
.text:0041678D		       add     esp, 0Ch
.text:00416790		       test    eax, eax
.text:00416792		       jz      short loc_4167A1
.text:00416794		       push    ebp	       ; pReserved
.text:00416795		       push    ebp	       ; nLine
.text:00416796		       push    ebp	       ; pszFile
.text:00416797		       push    ebp	       ; pszFunction
.text:00416798		       push    ebp	       ; pszExpression
.text:00416799		       call    __invoke_watson
.text:0041679E		       add     esp, 14h
.text:004167A1
.text:004167A1 loc_4167A1:			       ; CODE XREF: __strdup+36j
.text:004167A1		       mov     eax, edi
.text:004167A3		       jmp     short loc_4167A7
.text:004167A5 ; ---------------------------------------------------------------------------
.text:004167A5
.text:004167A5 loc_4167A5:			       ; CODE XREF: __strdup+27j
.text:004167A5		       xor     eax, eax
.text:004167A7
.text:004167A7 loc_4167A7:			       ; CODE XREF: __strdup+47j
.text:004167A7		       pop     edi
.text:004167A8		       pop     esi
.text:004167A9
.text:004167A9 loc_4167A9:			       ; CODE XREF: __strdup+Ej
.text:004167A9		       pop     ebp
.text:004167AA		       pop     ebx
.text:004167AB		       retn
.text:004167AB __strdup	       endp
.text:004167AB
.text:004167AC
.text:004167AC ; =============== S U B R O U T I N E =======================================
.text:004167AC
.text:004167AC ; Attributes: bp-based frame
.text:004167AC
.text:004167AC ; const char *__cdecl _mbschr_l(const char *string, unsigned int	c, localeinfo_struct *plocinfo)
.text:004167AC __mbschr_l      proc near	       ; CODE XREF: __mbschr+Ap
.text:004167AC
.text:004167AC _loc_update     = _LocaleUpdate ptr -10h
.text:004167AC string	       = dword ptr  8
.text:004167AC c	       = dword ptr  0Ch
.text:004167AC plocinfo	       = dword ptr  10h
.text:004167AC
.text:004167AC		       push    ebp
.text:004167AD		       mov     ebp, esp
.text:004167AF		       sub     esp, 10h
.text:004167B2		       push    ebx
.text:004167B3		       push    [ebp+plocinfo]  ; plocinfo
.text:004167B6		       lea     ecx, [ebp+_loc_update] ;	this
.text:004167B9		       call    ??0_LocaleUpdate@@QAE@PAUlocaleinfo_struct@@@Z ;	_LocaleUpdate::_LocaleUpdate(localeinfo_struct *)
.text:004167BE		       mov     eax, [ebp+string]
.text:004167C1		       xor     ebx, ebx
.text:004167C3		       cmp     eax, ebx
.text:004167C5		       jnz     short loc_4167EF
.text:004167C7		       call    __errno
.text:004167CC		       push    ebx	       ; pReserved
.text:004167CD		       push    ebx	       ; nLine
.text:004167CE		       push    ebx	       ; pszFile
.text:004167CF		       push    ebx	       ; pszFunction
.text:004167D0		       push    ebx	       ; pszExpression
.text:004167D1		       mov     dword ptr [eax],	16h
.text:004167D7		       call    __invalid_parameter
.text:004167DC		       add     esp, 14h
.text:004167DF		       cmp     [ebp+_loc_update.updated], bl
.text:004167E2		       jz      short loc_4167EB
.text:004167E4		       mov     eax, [ebp+_loc_update.ptd]
.text:004167E7		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:004167EB
.text:004167EB loc_4167EB:			       ; CODE XREF: __mbschr_l+36j
.text:004167EB		       xor     eax, eax
.text:004167ED		       jmp     short loc_416863
.text:004167EF ; ---------------------------------------------------------------------------
.text:004167EF
.text:004167EF loc_4167EF:			       ; CODE XREF: __mbschr_l+19j
.text:004167EF		       push    esi
.text:004167F0		       mov     esi, [ebp+_loc_update.localeinfo.mbcinfo]
.text:004167F3		       cmp     [esi+8],	ebx
.text:004167F6		       jnz     short loc_416832
.text:004167F8		       push    [ebp+c]	       ; chr
.text:004167FB		       push    eax	       ; string
.text:004167FC		       call    _strchr
.text:00416801		       pop     ecx
.text:00416802		       pop     ecx
.text:00416803		       jmp     short loc_416846
.text:00416805 ; ---------------------------------------------------------------------------
.text:00416805
.text:00416805 loc_416805:			       ; CODE XREF: __mbschr_l+90j
.text:00416805		       movzx   edx, cl
.text:00416808		       test    byte ptr	[edx+esi+1Dh], 4
.text:0041680D		       jz      short loc_416829
.text:0041680F		       inc     eax
.text:00416810		       mov     dl, [eax]
.text:00416812		       cmp     dl, bl
.text:00416814		       jz      short loc_416854
.text:00416816		       movzx   ecx, cx
.text:00416819		       movzx   edx, dl
.text:0041681C		       shl     ecx, 8
.text:0041681F		       or      ecx, edx
.text:00416821		       cmp     [ebp+c],	ecx
.text:00416824		       jnz     short loc_416831
.text:00416826		       dec     eax
.text:00416827		       jmp     short loc_416846
.text:00416829 ; ---------------------------------------------------------------------------
.text:00416829
.text:00416829 loc_416829:			       ; CODE XREF: __mbschr_l+61j
.text:00416829		       movzx   edx, cx
.text:0041682C		       cmp     [ebp+c],	edx
.text:0041682F		       jz      short loc_41683E
.text:00416831
.text:00416831 loc_416831:			       ; CODE XREF: __mbschr_l+78j
.text:00416831		       inc     eax
.text:00416832
.text:00416832 loc_416832:			       ; CODE XREF: __mbschr_l+4Aj
.text:00416832		       movzx   cx, byte	ptr [eax]
.text:00416836		       movzx   ecx, cx
.text:00416839		       cmp     cx, bx
.text:0041683C		       jnz     short loc_416805
.text:0041683E
.text:0041683E loc_41683E:			       ; CODE XREF: __mbschr_l+83j
.text:0041683E		       movzx   ecx, cx
.text:00416841		       cmp     [ebp+c],	ecx
.text:00416844		       jnz     short loc_416854
.text:00416846
.text:00416846 loc_416846:			       ; CODE XREF: __mbschr_l+57j
.text:00416846					       ; __mbschr_l+7Bj
.text:00416846		       cmp     [ebp+_loc_update.updated], bl
.text:00416849		       jz      short loc_416862
.text:0041684B		       mov     ecx, [ebp+_loc_update.ptd]
.text:0041684E		       and     dword ptr [ecx+70h], 0FFFFFFFDh
.text:00416852		       jmp     short loc_416862
.text:00416854 ; ---------------------------------------------------------------------------
.text:00416854
.text:00416854 loc_416854:			       ; CODE XREF: __mbschr_l+68j
.text:00416854					       ; __mbschr_l+98j
.text:00416854		       cmp     [ebp+_loc_update.updated], bl
.text:00416857		       jz      short loc_416860
.text:00416859		       mov     eax, [ebp+_loc_update.ptd]
.text:0041685C		       and     dword ptr [eax+70h], 0FFFFFFFDh
.text:00416860
.text:00416860 loc_416860:			       ; CODE XREF: __mbschr_l+ABj
.text:00416860		       xor     eax, eax
.text:00416862
.text:00416862 loc_416862:			       ; CODE XREF: __mbschr_l+9Dj
.text:00416862					       ; __mbschr_l+A6j
.text:00416862		       pop     esi
.text:00416863
.text:00416863 loc_416863:			       ; CODE XREF: __mbschr_l+41j
.text:00416863		       pop     ebx
.text:00416864		       leave
.text:00416865		       retn
.text:00416865 __mbschr_l      endp
.text:00416865
.text:00416866
.text:00416866 ; =============== S U B R O U T I N E =======================================
.text:00416866
.text:00416866
.text:00416866 ; const char *__cdecl _mbschr(const char	*string, unsigned int c)
.text:00416866 __mbschr	       proc near	       ; CODE XREF: ___crtsetenv+3Ep
.text:00416866
.text:00416866 string	       = dword ptr  4
.text:00416866 c	       = dword ptr  8
.text:00416866
.text:00416866		       push    0	       ; plocinfo
.text:00416868		       push    [esp+4+c]       ; c
.text:0041686C		       push    [esp+8+string]  ; string
.text:00416870		       call    __mbschr_l
.text:00416875		       add     esp, 0Ch
.text:00416878		       retn
.text:00416878 __mbschr	       endp
.text:00416878
.text:00416878 ; ---------------------------------------------------------------------------
.text:00416879		       align 10h
.text:00416880 ; START OF FUNCTION CHUNK FOR _strchr
.text:00416880
.text:00416880 found_bx:			       ; CODE XREF: _strchr+1Fj
.text:00416880		       lea     eax, [edx-1]
.text:00416883		       pop     ebx
.text:00416884		       retn
.text:00416884 ; END OF	FUNCTION CHUNK FOR _strchr
.text:00416884 ; ---------------------------------------------------------------------------
.text:00416885		       align 10h
.text:00416890
.text:00416890 ; =============== S U B R O U T I N E =======================================
.text:00416890
.text:00416890
.text:00416890 ; void __cdecl strchr(char *string, char	chr)
.text:00416890 _strchr	       proc near	       ; CODE XREF: __mbschr_l+50p
.text:00416890
.text:00416890 arg_0	       = dword ptr  4
.text:00416890 string	       = dword ptr  8
.text:00416890 chr	       = byte ptr  0Ch
.text:00416890
.text:00416890 ; FUNCTION CHUNK	AT .text:00416880 SIZE 00000005	BYTES
.text:00416890
.text:00416890		       xor     eax, eax
.text:00416892		       mov     al, byte	ptr [esp+string]
.text:00416896
.text:00416896 ___from_strstr_to_strchr:
.text:00416896		       push    ebx
.text:00416897		       mov     ebx, eax
.text:00416899		       shl     eax, 8
.text:0041689C		       mov     edx, [esp+4+arg_0]
.text:004168A0		       test    edx, 3
.text:004168A6		       jz      short main_loop_start
.text:004168A8
.text:004168A8 str_misaligned_0:		       ; CODE XREF: _strchr+2Bj
.text:004168A8		       mov     cl, [edx]
.text:004168AA		       add     edx, 1
.text:004168AD		       cmp     cl, bl
.text:004168AF		       jz      short found_bx
.text:004168B1		       test    cl, cl
.text:004168B3		       jz      short retnull_bx
.text:004168B5		       test    edx, 3
.text:004168BB		       jnz     short str_misaligned_0
.text:004168BD
.text:004168BD main_loop_start:			       ; CODE XREF: _strchr+16j
.text:004168BD		       or      ebx, eax
.text:004168BF		       push    edi
.text:004168C0		       mov     eax, ebx
.text:004168C2		       shl     ebx, 10h
.text:004168C5		       push    esi
.text:004168C6		       or      ebx, eax
.text:004168C8
.text:004168C8 main_loop_0:			       ; CODE XREF: _strchr+63j
.text:004168C8					       ; _strchr+72j ...
.text:004168C8		       mov     ecx, [edx]
.text:004168CA		       mov     edi, 7EFEFEFFh
.text:004168CF		       mov     eax, ecx
.text:004168D1		       mov     esi, edi
.text:004168D3		       xor     ecx, ebx
.text:004168D5		       add     esi, eax
.text:004168D7		       add     edi, ecx
.text:004168D9		       xor     ecx, 0FFFFFFFFh
.text:004168DC		       xor     eax, 0FFFFFFFFh
.text:004168DF		       xor     ecx, edi
.text:004168E1		       xor     eax, esi
.text:004168E3		       add     edx, 4
.text:004168E6		       and     ecx, 81010100h
.text:004168EC		       jnz     short chr_is_found
.text:004168EE		       and     eax, 81010100h
.text:004168F3		       jz      short main_loop_0
.text:004168F5		       and     eax, 1010100h
.text:004168FA		       jnz     short retnull
.text:004168FC		       and     esi, 80000000h
.text:00416902		       jnz     short main_loop_0
.text:00416904
.text:00416904 retnull:				       ; CODE XREF: _strchr+6Aj
.text:00416904					       ; _strchr+83j ...
.text:00416904		       pop     esi
.text:00416905		       pop     edi
.text:00416906
.text:00416906 retnull_bx:			       ; CODE XREF: _strchr+23j
.text:00416906		       pop     ebx
.text:00416907		       xor     eax, eax
.text:00416909		       retn
.text:0041690A ; ---------------------------------------------------------------------------
.text:0041690A
.text:0041690A chr_is_found:			       ; CODE XREF: _strchr+5Cj
.text:0041690A		       mov     eax, [edx-4]
.text:0041690D		       cmp     al, bl
.text:0041690F		       jz      short loc_416947
.text:00416911		       test    al, al
.text:00416913		       jz      short retnull
.text:00416915		       cmp     ah, bl
.text:00416917		       jz      short loc_416940
.text:00416919		       test    ah, ah
.text:0041691B		       jz      short retnull
.text:0041691D		       shr     eax, 10h
.text:00416920		       cmp     al, bl
.text:00416922		       jz      short loc_416939
.text:00416924		       test    al, al
.text:00416926		       jz      short retnull
.text:00416928		       cmp     ah, bl
.text:0041692A		       jz      short loc_416932
.text:0041692C		       test    ah, ah
.text:0041692E		       jz      short retnull
.text:00416930		       jmp     short main_loop_0
.text:00416932 ; ---------------------------------------------------------------------------
.text:00416932
.text:00416932 loc_416932:			       ; CODE XREF: _strchr+9Aj
.text:00416932		       pop     esi
.text:00416933		       pop     edi
.text:00416934		       lea     eax, [edx-1]
.text:00416937		       pop     ebx
.text:00416938		       retn
.text:00416939 ; ---------------------------------------------------------------------------
.text:00416939
.text:00416939 loc_416939:			       ; CODE XREF: _strchr+92j
.text:00416939		       lea     eax, [edx-2]
.text:0041693C		       pop     esi
.text:0041693D		       pop     edi
.text:0041693E		       pop     ebx
.text:0041693F		       retn
.text:00416940 ; ---------------------------------------------------------------------------
.text:00416940
.text:00416940 loc_416940:			       ; CODE XREF: _strchr+87j
.text:00416940		       lea     eax, [edx-3]
.text:00416943		       pop     esi
.text:00416944		       pop     edi
.text:00416945		       pop     ebx
.text:00416946		       retn
.text:00416947 ; ---------------------------------------------------------------------------
.text:00416947
.text:00416947 loc_416947:			       ; CODE XREF: _strchr+7Fj
.text:00416947		       lea     eax, [edx-4]
.text:0041694A		       pop     esi
.text:0041694B		       pop     edi
.text:0041694C		       pop     ebx
.text:0041694D		       retn
.text:0041694D _strchr	       endp
.text:0041694D
.text:0041694E ; [00000006 BYTES: COLLAPSED FUNCTION GetLastError(). PRESS KEYPAD "+" TO EXPAND]
.text:00416954 ; [00000006 BYTES: COLLAPSED FUNCTION HeapFree(x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:0041695A ; [00000006 BYTES: COLLAPSED FUNCTION GetProcAddress(x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416960 ; [00000006 BYTES: COLLAPSED FUNCTION GetModuleHandleA(x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416966 ; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess(x). PRESS KEYPAD "+" TO EXPAND]
.text:0041696C ; [00000006 BYTES: COLLAPSED FUNCTION EnterCriticalSection(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416972 ; [00000006 BYTES: COLLAPSED FUNCTION LeaveCriticalSection(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416978 ; [00000006 BYTES: COLLAPSED FUNCTION HeapAlloc(x,x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:0041697E ; [00000006 BYTES: COLLAPSED FUNCTION GetCommandLineA().	PRESS KEYPAD "+" TO EXPAND]
.text:00416984 ; [00000006 BYTES: COLLAPSED FUNCTION GetVersionExA(x). PRESS KEYPAD "+"	TO EXPAND]
.text:0041698A ; [00000006 BYTES: COLLAPSED FUNCTION GetProcessHeap(). PRESS KEYPAD "+"	TO EXPAND]
.text:00416990 ; [00000006 BYTES: COLLAPSED FUNCTION TerminateProcess(x,x). PRESS KEYPAD "+" TO	EXPAND]
.text:00416996 ; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentProcess(). PRESS	KEYPAD "+" TO EXPAND]
.text:0041699C ; [00000006 BYTES: COLLAPSED FUNCTION UnhandledExceptionFilter(x). PRESS	KEYPAD "+" TO EXPAND]
.text:004169A2 ; [00000006 BYTES: COLLAPSED FUNCTION SetUnhandledExceptionFilter(x). PRESS KEYPAD "+" TO EXPAND]
.text:004169A8 ; [00000006 BYTES: COLLAPSED FUNCTION IsDebuggerPresent(). PRESS	KEYPAD "+" TO EXPAND]
.text:004169AE ; [00000006 BYTES: COLLAPSED FUNCTION HeapDestroy(x). PRESS KEYPAD "+" TO EXPAND]
.text:004169B4 ; [00000006 BYTES: COLLAPSED FUNCTION HeapCreate(x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:004169BA ; [00000006 BYTES: COLLAPSED FUNCTION VirtualFree(x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:004169C0 ; [00000006 BYTES: COLLAPSED FUNCTION DeleteCriticalSection(x). PRESS KEYPAD "+"	TO EXPAND]
.text:004169C6 ; [00000006 BYTES: COLLAPSED FUNCTION FatalAppExitA(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:004169CC ; [00000006 BYTES: COLLAPSED FUNCTION VirtualAlloc(x,x,x,x). PRESS KEYPAD "+" TO	EXPAND]
.text:004169D2 ; [00000006 BYTES: COLLAPSED FUNCTION HeapReAlloc(x,x,x,x). PRESS KEYPAD	"+" TO EXPAND]
.text:004169D8 ; [00000006 BYTES: COLLAPSED FUNCTION TlsGetValue(x). PRESS KEYPAD "+" TO EXPAND]
.text:004169DE ; [00000006 BYTES: COLLAPSED FUNCTION TlsAlloc(). PRESS KEYPAD "+" TO EXPAND]
.text:004169E4 ; [00000006 BYTES: COLLAPSED FUNCTION TlsSetValue(x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:004169EA ; [00000006 BYTES: COLLAPSED FUNCTION TlsFree(x). PRESS KEYPAD "+" TO EXPAND]
.text:004169F0 ; [00000006 BYTES: COLLAPSED FUNCTION InterlockedIncrement(x). PRESS KEYPAD "+" TO EXPAND]
.text:004169F6 ; [00000006 BYTES: COLLAPSED FUNCTION SetLastError(x). PRESS KEYPAD "+" TO EXPAND]
.text:004169FC ; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentThreadId(). PRESS KEYPAD	"+" TO EXPAND]
.text:00416A02 ; [00000006 BYTES: COLLAPSED FUNCTION InterlockedDecrement(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A08 ; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentThread(). PRESS KEYPAD "+" TO EXPAND]
.text:00416A0E ; [00000006 BYTES: COLLAPSED FUNCTION WriteFile(x,x,x,x,x). PRESS KEYPAD	"+" TO EXPAND]
.text:00416A14 ; [00000006 BYTES: COLLAPSED FUNCTION GetStdHandle(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A1A ; [00000006 BYTES: COLLAPSED FUNCTION GetModuleFileNameA(x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416A20 ; [00000006 BYTES: COLLAPSED FUNCTION SetConsoleCtrlHandler(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A26 ; [00000006 BYTES: COLLAPSED FUNCTION FreeLibrary(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A2C ; [00000006 BYTES: COLLAPSED FUNCTION InterlockedExchange(x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416A32 ; [00000006 BYTES: COLLAPSED FUNCTION LoadLibraryA(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A38 ; [00000006 BYTES: COLLAPSED FUNCTION InitializeCriticalSection(x). PRESS KEYPAD	"+" TO EXPAND]
.text:00416A3E ; [00000006 BYTES: COLLAPSED FUNCTION SetHandleCount(x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416A44 ; [00000006 BYTES: COLLAPSED FUNCTION GetFileType(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A4A ; [00000006 BYTES: COLLAPSED FUNCTION GetStartupInfoA(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A50 ; [00000006 BYTES: COLLAPSED FUNCTION Sleep(x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416A56 ; [00000006 BYTES: COLLAPSED FUNCTION FreeEnvironmentStringsA(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A5C ; [00000006 BYTES: COLLAPSED FUNCTION GetEnvironmentStrings(). PRESS KEYPAD "+" TO EXPAND]
.text:00416A62 ; [00000006 BYTES: COLLAPSED FUNCTION FreeEnvironmentStringsW(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A68 ; [00000006 BYTES: COLLAPSED FUNCTION WideCharToMultiByte(x,x,x,x,x,x,x,x). PRESS KEYPAD	"+" TO EXPAND]
.text:00416A6E ; [00000006 BYTES: COLLAPSED FUNCTION GetEnvironmentStringsW(). PRESS KEYPAD "+"	TO EXPAND]
.text:00416A74 ; [00000006 BYTES: COLLAPSED FUNCTION QueryPerformanceCounter(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A7A ; [00000006 BYTES: COLLAPSED FUNCTION GetTickCount(). PRESS KEYPAD "+" TO EXPAND]
.text:00416A80 ; [00000006 BYTES: COLLAPSED FUNCTION GetCurrentProcessId(). PRESS KEYPAD "+" TO	EXPAND]
.text:00416A86 ; [00000006 BYTES: COLLAPSED FUNCTION GetSystemTimeAsFileTime(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A8C ; [00000006 BYTES: COLLAPSED FUNCTION GetCPInfo(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416A92 ; [00000006 BYTES: COLLAPSED FUNCTION GetACP(). PRESS KEYPAD "+"	TO EXPAND]
.text:00416A98 ; [00000006 BYTES: COLLAPSED FUNCTION GetOEMCP(). PRESS KEYPAD "+" TO EXPAND]
.text:00416A9E ; [00000006 BYTES: COLLAPSED FUNCTION IsValidCodePage(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416AA4 ; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416AAA ; [00000006 BYTES: COLLAPSED FUNCTION HeapSize(x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416AB0 ; [00000006 BYTES: COLLAPSED FUNCTION MultiByteToWideChar(x,x,x,x,x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416AB6 ; [00000006 BYTES: COLLAPSED FUNCTION GetLocaleInfoA(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416ABC ; [00000006 BYTES: COLLAPSED FUNCTION GetLocaleInfoW(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416AC2 ; [00000006 BYTES: COLLAPSED FUNCTION GetConsoleCP(). PRESS KEYPAD "+" TO EXPAND]
.text:00416AC8 ; [00000006 BYTES: COLLAPSED FUNCTION GetConsoleMode(x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416ACE ; [00000006 BYTES: COLLAPSED FUNCTION FlushFileBuffers(x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416AD4 ; [00000006 BYTES: COLLAPSED FUNCTION LCMapStringA(x,x,x,x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416ADA ; [00000006 BYTES: COLLAPSED FUNCTION LCMapStringW(x,x,x,x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416AE0 ; [00000006 BYTES: COLLAPSED FUNCTION GetStringTypeA(x,x,x,x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416AE6 ; [00000006 BYTES: COLLAPSED FUNCTION GetStringTypeW(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416AEC ; [00000006 BYTES: COLLAPSED FUNCTION GetTimeFormatA(x,x,x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416AF2 ; [00000006 BYTES: COLLAPSED FUNCTION GetDateFormatA(x,x,x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416AF8 ; [00000006 BYTES: COLLAPSED FUNCTION GetUserDefaultLCID(). PRESS KEYPAD	"+" TO EXPAND]
.text:00416AFE ; [00000006 BYTES: COLLAPSED FUNCTION EnumSystemLocalesA(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416B04 ; [00000006 BYTES: COLLAPSED FUNCTION IsValidLocale(x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416B0A ; [00000006 BYTES: COLLAPSED FUNCTION SetFilePointer(x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416B10 ; [00000006 BYTES: COLLAPSED FUNCTION CloseHandle(x). PRESS KEYPAD "+" TO EXPAND]
.text:00416B16 ; [00000006 BYTES: COLLAPSED FUNCTION WriteConsoleA(x,x,x,x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416B1C ; [00000006 BYTES: COLLAPSED FUNCTION GetConsoleOutputCP(). PRESS KEYPAD	"+" TO EXPAND]
.text:00416B22 ; [00000006 BYTES: COLLAPSED FUNCTION WriteConsoleW(x,x,x,x,x). PRESS KEYPAD "+"	TO EXPAND]
.text:00416B28 ; [00000006 BYTES: COLLAPSED FUNCTION SetStdHandle(x,x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416B2E ; [00000006 BYTES: COLLAPSED FUNCTION GetTimeZoneInformation(x).	PRESS KEYPAD "+" TO EXPAND]
.text:00416B34 ; [00000006 BYTES: COLLAPSED FUNCTION CreateFileA(x,x,x,x,x,x,x). PRESS KEYPAD "+" TO EXPAND]
.text:00416B3A ; [00000006 BYTES: COLLAPSED FUNCTION CompareStringA(x,x,x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416B40 ; [00000006 BYTES: COLLAPSED FUNCTION CompareStringW(x,x,x,x,x,x). PRESS	KEYPAD "+" TO EXPAND]
.text:00416B46 ; [00000006 BYTES: COLLAPSED FUNCTION SetEnvironmentVariableA(x,x). PRESS KEYPAD	"+" TO EXPAND]
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db ''
.text:00416B4C		       db '',0
.text:0041D034		       align 1000h
.text:0041D034 _text	       ends
.text:0041D034
.rdata:0041E000	; Section 2. (virtual address 0001E000)
.rdata:0041E000	; Virtual size			: 00003D04 (  15620.)
.rdata:0041E000	; Section size in file		: 00004000 (  16384.)
.rdata:0041E000	; Offset to raw	data for section: 0001E000
.rdata:0041E000	; Flags	40000040: Data Readable
.rdata:0041E000	; Alignment	: default
.rdata:0041E000	; ===========================================================================
.rdata:0041E000
.rdata:0041E000	; Segment type:	Pure data
.rdata:0041E000	; Segment permissions: Read
.rdata:0041E000	_rdata		segment	para public 'DATA' use32
.rdata:0041E000			assume cs:_rdata
.rdata:0041E000			;org 41E000h
.rdata:0041E000	___xc_a		dd 41h dup(0)		; DATA XREF: __cinit+49o
.rdata:0041E104	___xc_z		dd 41h dup(0)		; DATA XREF: __cinit+50o
.rdata:0041E208	; int (__cdecl *__xi_a)()
.rdata:0041E208	___xi_a		dd 0			; DATA XREF: __cinit+2Do
.rdata:0041E20C			dd 40h dup(0)
.rdata:0041E30C	; int (__cdecl *pinit)()
.rdata:0041E30C	pinit		dd offset ___initstdio
.rdata:0041E310	; int (__cdecl *pinit_0)()
.rdata:0041E310	pinit_0		dd offset ___onexitinit
.rdata:0041E314	; int (__cdecl *pinit_1)()
.rdata:0041E314	pinit_1		dd offset ___initmbctable
.rdata:0041E318	; int (__cdecl *pinit_2)()
.rdata:0041E318	pinit_2		dd offset __sse2_mathfcns_init
.rdata:0041E31C	; int (__cdecl *pinit_3)()
.rdata:0041E31C	pinit_3		dd offset ___sse2_available_init
.rdata:0041E320			dd 41h dup(0)
.rdata:0041E424	; int (__cdecl *pinit_4)()
.rdata:0041E424	pinit_4		dd offset ___CxxSetUnhandledExceptionFilter
.rdata:0041E428			dd 40h dup(0)
.rdata:0041E528	; int (__cdecl *__xi_z)()
.rdata:0041E528	___xi_z		dd 0			; DATA XREF: __cinit+28o
.rdata:0041E52C			dd 40h dup(0)
.rdata:0041E62C	; void (__cdecl	*__xp_a)()
.rdata:0041E62C	___xp_a		dd 0			; DATA XREF: doexit+87o
.rdata:0041E630			dd 40h dup(0)
.rdata:0041E730	; void (__cdecl	*pterm)()
.rdata:0041E730	pterm		dd offset ___termcon
.rdata:0041E734			dd 40h dup(0)
.rdata:0041E834	; void (__cdecl	*pterm_0)()
.rdata:0041E834	pterm_0		dd offset ___endstdio
.rdata:0041E838			dd 40h dup(0)
.rdata:0041E938	; void (__cdecl	*__xp_z)()
.rdata:0041E938	___xp_z		dd 0			; DATA XREF: doexit:loc_401C84o
.rdata:0041E93C			dd 40h dup(0)
.rdata:0041EA3C	; void (__cdecl	*__xt_a)()
.rdata:0041EA3C	___xt_a		dd 0			; DATA XREF: doexit+97o
.rdata:0041EA40			dd 40h dup(0)
.rdata:0041EB40	; void (__cdecl	*__xt_z)()
.rdata:0041EB40	___xt_z		dd 0			; DATA XREF: doexit:loc_401C94o
.rdata:0041EB44			dd 44h dup(0)
.rdata:0041EC54	aRM		db 'RM',0
.rdata:0041EC59			align 4
.rdata:0041EC5C			dd 2, 45h, 2 dup(20DDCh)
.rdata:0041EC6C	; char ProcName[]
.rdata:0041EC6C	ProcName	db 'CorExitProcess',0   ; DATA XREF: ___crtCorExitProcess+Fo
.rdata:0041EC7B			align 4
.rdata:0041EC7C	; char ModuleName[]
.rdata:0041EC7C	ModuleName	db 'mscoree.dll',0      ; DATA XREF: ___crtCorExitProcesso
.rdata:0041EC88	aNull:					; DATA XREF: .data:___wnullstringo
.rdata:0041EC88			unicode	0, <(null)>,0
.rdata:0041EC96			align 4
.rdata:0041EC98	aNull_0		db '(null)',0           ; DATA XREF: __output_l+177r
.rdata:0041EC98						; .data:___nullstringo
.rdata:0041EC9F			align 10h
.rdata:0041ECA0	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ProcessDetach
.rdata:0041ECA0	?ProcessDetach@NativeDll@_CrtImplementationDetails_@@0IB dd 0
.rdata:0041ECA4	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ProcessAttach
.rdata:0041ECA4	?ProcessAttach@NativeDll@_CrtImplementationDetails_@@0IB dd 1
.rdata:0041ECA8	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ThreadAttach
.rdata:0041ECA8	?ThreadAttach@NativeDll@_CrtImplementationDetails_@@0IB	dd 2
.rdata:0041ECAC	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ThreadDetach
.rdata:0041ECAC	?ThreadDetach@NativeDll@_CrtImplementationDetails_@@0IB	dd 3
.rdata:0041ECB0	; private: static unsigned int const _CrtImplementationDetails_::NativeDll::ProcessVerifier
.rdata:0041ECB0	?ProcessVerifier@NativeDll@_CrtImplementationDetails_@@0IB dd 4, 0
.rdata:0041ECB8	___lookuptable	db 6			; DATA XREF: __output_l:loc_402869r
.rdata:0041ECB9			db 2 dup(0), 6
.rdata:0041ECBC			dd 100h, 6030010h, 10020600h, 45454504h, 5050505h, 303505h
.rdata:0041ECBC			dd 50h,	38202800h, 8075850h, 30303700h,	75057h,	8202000h
.rdata:0041ECBC			dd 0
.rdata:0041ECF0			db 8,'`h````',0
.rdata:0041ECF8			dd 78707800h, 8787878h,	807h, 8080007h,	8000008h, 7000800h
.rdata:0041ECF8			dd 8
.rdata:0041ED14	; char str1[]
.rdata:0041ED14	str1		db '.mixcrt',0          ; DATA XREF: _use_encode_pointer+42o
.rdata:0041ED1C	; char aEncodepointer[]
.rdata:0041ED1C	aEncodepointer	db 'EncodePointer',0    ; DATA XREF: __encode_pointer+4Eo
.rdata:0041ED1C						; __initptd+37o
.rdata:0041ED2A			align 4
.rdata:0041ED2C	; char aKernel32_dll_0[]
.rdata:0041ED2C	aKernel32_dll_0	db 'KERNEL32.DLL',0     ; DATA XREF: __encode_pointer:loc_4049F5o
.rdata:0041ED2C						; __decode_pointer:loc_404A6Co	...
.rdata:0041ED39			align 4
.rdata:0041ED3C	; char aDecodepointer[]
.rdata:0041ED3C	aDecodepointer	db 'DecodePointer',0    ; DATA XREF: __decode_pointer+4Eo
.rdata:0041ED3C						; __initptd+4Do
.rdata:0041ED4A			align 4
.rdata:0041ED4C	; char aFlsfree[]
.rdata:0041ED4C	aFlsfree	db 'FlsFree',0          ; DATA XREF: __mtinit+44o
.rdata:0041ED54	; char aFlssetvalue[]
.rdata:0041ED54	aFlssetvalue	db 'FlsSetValue',0      ; DATA XREF: __mtinit+37o
.rdata:0041ED60	; char aFlsgetvalue[]
.rdata:0041ED60	aFlsgetvalue	db 'FlsGetValue',0      ; DATA XREF: __mtinit+2Ao
.rdata:0041ED6C	; char aFlsalloc[]
.rdata:0041ED6C	aFlsalloc	db 'FlsAlloc',0         ; DATA XREF: __mtinit+22o
.rdata:0041ED75			align 4
.rdata:0041ED78	aRuntimeError	db 'runtime error ',0   ; DATA XREF: .data:rterrso
.rdata:0041ED87			align 4
.rdata:0041ED88	asc_41ED88	db 0Dh,0Ah,0		; DATA XREF: .data:rterrso
.rdata:0041ED8B			align 4
.rdata:0041ED8C	aTlossError	db 'TLOSS error',0Dh,0Ah,0 ; DATA XREF: .data:rterrso
.rdata:0041ED9A			align 4
.rdata:0041ED9C	aSingError	db 'SING error',0Dh,0Ah,0 ; DATA XREF: .data:rterrso
.rdata:0041EDA9			align 4
.rdata:0041EDAC	aDomainError	db 'DOMAIN error',0Dh,0Ah,0 ; DATA XREF: .data:rterrso
.rdata:0041EDBB			align 10h
.rdata:0041EDC0	aR6034AnApplica	db 'R6034',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041EDC0			db 'An application has made an attempt to load the C runtime library '
.rdata:0041EDC0			db 'incorrectly.',0Ah
.rdata:0041EDC0			db 'Please contact the application',27h,'s support team for more informa'
.rdata:0041EDC0			db 'tion.',0Dh,0Ah,0
.rdata:0041EE5B			align 10h
.rdata:0041EE60	aR6033AttemptTo	db 'R6033',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041EE60			db '- Attempt to use MSIL code from this assembly during native code '
.rdata:0041EE60			db 'initialization',0Ah
.rdata:0041EE60			db 'This indicates a bug in your application. It is most likely the r'
.rdata:0041EE60			db 'esult of calling an MSIL-compiled (/clr) function from a native c'
.rdata:0041EE60			db 'onstructor or from DllMain.',0Dh,0Ah,0
.rdata:0041EF57			align 4
.rdata:0041EF58	aR6032NotEnough	db 'R6032',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041EF58			db '- not enough space for locale information',0Dh,0Ah,0
.rdata:0041EF8B			align 10h
.rdata:0041EF90	aR6031AttemptTo	db 'R6031',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041EF90			db '- Attempt to initialize the CRT more than once.',0Ah
.rdata:0041EF90			db 'This indicates a bug in your application.',0Dh,0Ah,0
.rdata:0041EFF3			align 4
.rdata:0041EFF4	aR6030CrtNotIni	db 'R6030',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041EFF4			db '- CRT not initialized',0Dh,0Ah,0
.rdata:0041F013			align 4
.rdata:0041F014	aR6028UnableToI	db 'R6028',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F014			db '- unable to initialize heap',0Dh,0Ah,0
.rdata:0041F039			align 4
.rdata:0041F03C	aR6027NotEnough	db 'R6027',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F03C			db '- not enough space for lowio initialization',0Dh,0Ah,0
.rdata:0041F071			align 4
.rdata:0041F074	aR6026NotEnough	db 'R6026',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F074			db '- not enough space for stdio initialization',0Dh,0Ah,0
.rdata:0041F0A9			align 4
.rdata:0041F0AC	aR6025PureVirtu	db 'R6025',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F0AC			db '- pure virtual function call',0Dh,0Ah,0
.rdata:0041F0D2			align 4
.rdata:0041F0D4	aR6024NotEnough	db 'R6024',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F0D4			db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
.rdata:0041F109			align 4
.rdata:0041F10C	aR6019UnableToO	db 'R6019',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F10C			db '- unable to open console device',0Dh,0Ah,0
.rdata:0041F135			align 4
.rdata:0041F138	aR6018Unexpecte	db 'R6018',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F138			db '- unexpected heap error',0Dh,0Ah,0
.rdata:0041F159			align 4
.rdata:0041F15C	aR6017Unexpecte	db 'R6017',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F15C			db '- unexpected multithread lock error',0Dh,0Ah,0
.rdata:0041F189			align 4
.rdata:0041F18C	aR6016NotEnough	db 'R6016',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F18C			db '- not enough space for thread data',0Dh,0Ah,0
.rdata:0041F1B8	aThisApplicatio	db 0Dh,0Ah		; DATA XREF: .data:rterrso
.rdata:0041F1B8			db 'This application has requested the Runtime to terminate it in an '
.rdata:0041F1B8			db 'unusual way.',0Ah
.rdata:0041F1B8			db 'Please contact the application',27h,'s support team for more informa'
.rdata:0041F1B8			db 'tion.',0Dh,0Ah,0
.rdata:0041F24E			align 10h
.rdata:0041F250	aR6009NotEnough	db 'R6009',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F250			db '- not enough space for environment',0Dh,0Ah,0
.rdata:0041F27C	aR6008NotEnough	db 'R6008',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F27C			db '- not enough space for arguments',0Dh,0Ah,0
.rdata:0041F2A6			align 4
.rdata:0041F2A8	aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:rterrso
.rdata:0041F2A8			db '- floating point support not loaded',0Dh,0Ah,0
.rdata:0041F2D5			align 4
.rdata:0041F2D8	; char Caption[]
.rdata:0041F2D8	Caption		db 'Microsoft Visual C++ Runtime Library',0
.rdata:0041F2D8						; DATA XREF: __NMSG_WRITE+157o
.rdata:0041F2FD			align 10h
.rdata:0041F300	; char asc_41F300[]
.rdata:0041F300	asc_41F300	db 0Ah			; DATA XREF: __NMSG_WRITE:loc_4050CAo
.rdata:0041F300			db 0Ah,0
.rdata:0041F303			align 4
.rdata:0041F304	; char a___[]
.rdata:0041F304	a___		db '...',0              ; DATA XREF: __NMSG_WRITE+E8o
.rdata:0041F308	; char aProgramNameUnk[]
.rdata:0041F308	aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+A3o
.rdata:0041F31F			align 10h
.rdata:0041F320	; char Src[]
.rdata:0041F320	_Src		db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+5Bo
.rdata:0041F320			db 0Ah
.rdata:0041F320			db 'Program: ',0
.rdata:0041F33A			align 4
.rdata:0041F33C	; char aSystemfunction[]
.rdata:0041F33C	aSystemfunction	db 'SystemFunction036',0 ; DATA XREF: _rand_s:loc_405C3Do
.rdata:0041F34E			align 10h
.rdata:0041F350	; char LibFileName[]
.rdata:0041F350	LibFileName	db 'ADVAPI32.DLL',0     ; DATA XREF: _rand_s+45o
.rdata:0041F35D			align 10h
.rdata:0041F360	; char aInitializecrit[]
.rdata:0041F360	aInitializecrit	db 'InitializeCriticalSectionAndSpinCount',0
.rdata:0041F360						; DATA XREF: ___crtInitCritSecAndSpinCount+53o
.rdata:0041F386			align 4
.rdata:0041F388	; char aKernel32_dll[]
.rdata:0041F388	aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: ___crtInitCritSecAndSpinCount+44o
.rdata:0041F395			align 4
.rdata:0041F398	aLc_time	db 'LC_TIME',0          ; DATA XREF: .rdata:off_41F414o
.rdata:0041F3A0	aLc_numeric	db 'LC_NUMERIC',0       ; DATA XREF: .rdata:0041F408o
.rdata:0041F3AB			align 4
.rdata:0041F3AC	aLc_monetary	db 'LC_MONETARY',0      ; DATA XREF: .rdata:0041F3FCo
.rdata:0041F3B8	aLc_ctype	db 'LC_CTYPE',0         ; DATA XREF: .rdata:0041F3F0o
.rdata:0041F3C1			align 4
.rdata:0041F3C4	aLc_collate	db 'LC_COLLATE',0       ; DATA XREF: .rdata:off_41F3E4o
.rdata:0041F3CF			align 10h
.rdata:0041F3D0	aLc_all		db 'LC_ALL',0           ; DATA XREF: .rdata:___lc_categoryo
.rdata:0041F3D7			align 4
.rdata:0041F3D8	___lc_category	dd offset aLc_all	; "LC_ALL"
.rdata:0041F3DC			align 10h
.rdata:0041F3E0	off_41F3E0	dd offset ___init_dummy	; DATA XREF: _setlocale_set_cat+255r
.rdata:0041F3E4	off_41F3E4	dd offset aLc_collate	; DATA XREF: _setlocale_get_all+3Dr
.rdata:0041F3E4						; _setlocale_get_all+53o ...
.rdata:0041F3E4						; "LC_COLLATE"
.rdata:0041F3E8			dd offset ___clocalestr	; "C"
.rdata:0041F3EC			dd offset ___init_collate
.rdata:0041F3F0			dd offset aLc_ctype	; "LC_CTYPE"
.rdata:0041F3F4			dd offset ___clocalestr	; "C"
.rdata:0041F3F8			dd offset ___init_ctype
.rdata:0041F3FC			dd offset aLc_monetary	; "LC_MONETARY"
.rdata:0041F400			dd offset ___clocalestr	; "C"
.rdata:0041F404			dd offset ___init_monetary
.rdata:0041F408			dd offset aLc_numeric	; "LC_NUMERIC"
.rdata:0041F40C			dd offset ___clocalestr	; "C"
.rdata:0041F410			dd offset ___init_numeric
.rdata:0041F414	off_41F414	dd offset aLc_time	; DATA XREF: _setlocale_get_all+C9o
.rdata:0041F414						; _setlocale_nolock+D2o
.rdata:0041F414						; "LC_TIME"
.rdata:0041F418			dd offset ___clocalestr	; "C"
.rdata:0041F41C			dd offset ___init_time
.rdata:0041F420	; char first_127char[127]
.rdata:0041F420	_first_127char	db 1, 2, 3, 4, 5, 6, 7,	8, 9, 0Ah, 0Bh,	0Ch, 0Dh, 0Eh
.rdata:0041F420						; DATA XREF: _setlocale_set_cat+1E2o
.rdata:0041F420			db 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
.rdata:0041F420			db 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
.rdata:0041F420			db 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
.rdata:0041F420			db 30h,	31h, 32h, 33h, 34h, 35h, 36h, 37h, 38h,	39h, 3Ah
.rdata:0041F420			db 3Bh,	3Ch, 3Dh, 3Eh, 3Fh, 40h, 41h, 42h, 43h,	44h, 45h
.rdata:0041F420			db 46h,	47h, 48h, 49h, 4Ah, 4Bh, 4Ch, 4Dh, 4Eh,	4Fh, 50h
.rdata:0041F420			db 51h,	52h, 53h, 54h, 55h, 56h, 57h, 58h, 59h,	5Ah, 5Bh
.rdata:0041F420			db 5Ch,	5Dh, 5Eh, 5Fh, 60h, 61h, 62h, 63h, 64h,	65h, 66h
.rdata:0041F420			db 67h,	68h, 69h, 6Ah, 6Bh, 6Ch, 6Dh, 6Eh, 6Fh,	70h, 71h
.rdata:0041F420			db 72h,	73h, 74h, 75h, 76h, 77h, 78h, 79h, 7Ah,	7Bh, 7Ch
.rdata:0041F420			db 7Dh,	7Eh, 7Fh
.rdata:0041F49F			align 10h
.rdata:0041F4A0	; char control[]
.rdata:0041F4A0	control		db '_.,',0              ; DATA XREF: ___lc_strtolc:loc_407A90o
.rdata:0041F4A0						; ___lc_strtolc+10Co ...
.rdata:0041F4A4	a__0		db '.',0                ; DATA XREF: ___lc_lctostr+54o
.rdata:0041F4A6			align 4
.rdata:0041F4A8	a_		db '_',0                ; DATA XREF: ___lc_lctostr+32o
.rdata:0041F4AA			align 4
.rdata:0041F4AC	; char asc_41F4AC[]
.rdata:0041F4AC	asc_41F4AC	db ';',0                ; DATA XREF: _setlocale_get_all:loc_407C1Do
.rdata:0041F4AC						; _setlocale_nolock+DBo
.rdata:0041F4AE			align 10h
.rdata:0041F4B0	asc_41F4B0	db '=',0                ; DATA XREF: _setlocale_get_all+38o
.rdata:0041F4B0						; _setlocale_get_all+B2o
.rdata:0041F4B2	word_41F4B2	dw 0			; DATA XREF: __expandlocale+146o
.rdata:0041F4B4	; char aC[]
.rdata:0041F4B4	aC		db 'C',0                ; DATA XREF: __expandlocale+75o
.rdata:0041F4B6			align 4
.rdata:0041F4B8	; char asc_41F4B8[]
.rdata:0041F4B8	asc_41F4B8	db '=;',0               ; DATA XREF: _setlocale_nolock:loc_408270o
.rdata:0041F4BB			align 10h
.rdata:0041F4C0	___lookuptable_s db 6			; DATA XREF: __output_s_l+18Br
.rdata:0041F4C0						; __output_p_l+1B2r
.rdata:0041F4C1	aAajaba		db '',0
.rdata:0041F4C8			dd 86031000h, 80828680h, 45050514h, 85854545h, 585h, 50803030h
.rdata:0041F4C8			dd 8008880h, 38272800h,	805750h, 30370007h, 88505030h
.rdata:0041F4C8			dd 20000000h, 80888028h, 80h
.rdata:0041F500	aHHhhXppwpp	db '`h`hhh',8,8,7,'xppwpp',8,8,0
.rdata:0041F512			dw 800h
.rdata:0041F514			dd 7000800h, 8
.rdata:0041F51C	; char aGetprocesswind[]
.rdata:0041F51C	aGetprocesswind	db 'GetProcessWindowStation',0
.rdata:0041F51C						; DATA XREF: ___crtMessageBoxA+C2o
.rdata:0041F534	; char aGetuserobjecti[]
.rdata:0041F534	aGetuserobjecti	db 'GetUserObjectInformationA',0
.rdata:0041F534						; DATA XREF: ___crtMessageBoxA+AAo
.rdata:0041F54E			align 10h
.rdata:0041F550	aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+6Eo
.rdata:0041F563			align 4
.rdata:0041F564	aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+59o
.rdata:0041F574	; char aMessageboxa[]
.rdata:0041F574	aMessageboxa	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+43o
.rdata:0041F580	; char aUser32_dll[]
.rdata:0041F580	aUser32_dll	db 'USER32.DLL',0       ; DATA XREF: ___crtMessageBoxA+28o
.rdata:0041F58B			align 4
.rdata:0041F58C	; const	wchar_t	SrcStr
.rdata:0041F58C	SrcStr		dw 0			; DATA XREF: __crtLCMapStringA_stat+25o
.rdata:0041F58C						; __crtGetStringTypeA_stat+27o	...
.rdata:0041F58E			align 10h
.rdata:0041F590	___newctype	dd 40h dup(0)
.rdata:0041F690	asc_41F690:				; DATA XREF: ___init_ctype+35Co
.rdata:0041F690						; .data:___initiallocinfoo ...
.rdata:0041F690			unicode	0, <	     (((((		    H>
.rdata:0041F6D2			dw 10h
.rdata:0041F6D4			dd 7 dup(100010h), 5 dup(840084h), 3 dup(100010h), 810010h
.rdata:0041F6D4			dd 2 dup(810081h), 10081h, 9 dup(10001h), 100001h, 2 dup(100010h)
.rdata:0041F6D4			dd 820010h, 2 dup(820082h), 20082h, 9 dup(20002h), 100002h
.rdata:0041F6D4			dd 100010h, 200010h, 40h dup(0)
.rdata:0041F890	; const	unsigned __int16 _wctype[]
.rdata:0041F890	__wctype	db 2 dup(0)
.rdata:0041F892	word_41F892	dw 20h			; DATA XREF: .data:__pwctypeo
.rdata:0041F894	aHH:					; DATA XREF: .data:_ctype_loc_styleo
.rdata:0041F894			unicode	0, <	    h((((		   H>
.rdata:0041F8D4			dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
.rdata:0041F8D4			dd 3 dup(1810181h), 0Ah	dup(1010101h), 3 dup(100010h)
.rdata:0041F8D4			dd 3 dup(1820182h), 0Ah	dup(1020102h), 2 dup(100010h)
.rdata:0041F8D4			dd 10h dup(200020h), 480020h, 8	dup(100010h), 140010h
.rdata:0041F8D4			dd 100014h, 2 dup(100010h), 100014h, 2 dup(100010h), 1010010h
.rdata:0041F8D4			dd 0Bh dup(1010101h), 1010010h,	3 dup(1010101h), 0Ch dup(1020102h)
.rdata:0041F8D4			dd 1020010h, 3 dup(1020102h), 1010102h,	0
.rdata:0041FA98	___newclmap	dd 83828180h, 87868584h, 8B8A8988h, 8F8E8D8Ch, 93929190h
.rdata:0041FA98			dd 97969594h, 9B9A9998h, 9F9E9D9Ch, 0A3A2A1A0h,	0A7A6A5A4h
.rdata:0041FA98			dd 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h, 0B7B6B5B4h, 0BBBAB9B8h
.rdata:0041FA98			dd 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h, 0CBCAC9C8h, 0CFCECDCCh
.rdata:0041FA98			dd 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h, 0DFDEDDDCh, 0E3E2E1E0h
.rdata:0041FA98			dd 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh, 0F3F2F1F0h, 0F7F6F5F4h
.rdata:0041FA98			dd 0FBFAF9F8h, 0FFFEFDFCh
.rdata:0041FB18	dword_41FB18	dd 3020100h, 7060504h, 0B0A0908h, 0F0E0D0Ch, 13121110h
.rdata:0041FB18						; DATA XREF: ___init_ctype+366o
.rdata:0041FB18						; .data:___initiallocinfoo
.rdata:0041FB18			dd 17161514h, 1B1A1918h, 1F1E1D1Ch, 23222120h, 27262524h
.rdata:0041FB18			dd 2B2A2928h, 2F2E2D2Ch, 33323130h, 37363534h, 3B3A3938h
.rdata:0041FB18			dd 3F3E3D3Ch, 63626140h, 67666564h, 6B6A6968h, 6F6E6D6Ch
.rdata:0041FB18			dd 73727170h, 77767574h, 5B7A7978h, 5F5E5D5Ch, 63626160h
.rdata:0041FB18			dd 67666564h, 6B6A6968h, 6F6E6D6Ch, 73727170h, 77767574h
.rdata:0041FB18			dd 7B7A7978h, 7F7E7D7Ch, 83828180h, 87868584h, 8B8A8988h
.rdata:0041FB18			dd 8F8E8D8Ch, 93929190h, 97969594h, 9B9A9998h, 9F9E9D9Ch
.rdata:0041FB18			dd 0A3A2A1A0h, 0A7A6A5A4h, 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h
.rdata:0041FB18			dd 0B7B6B5B4h, 0BBBAB9B8h, 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h
.rdata:0041FB18			dd 0CBCAC9C8h, 0CFCECDCCh, 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h
.rdata:0041FB18			dd 0DFDEDDDCh, 0E3E2E1E0h, 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh
.rdata:0041FB18			dd 0F3F2F1F0h, 0F7F6F5F4h, 0FBFAF9F8h, 0FFFEFDFCh
.rdata:0041FC18	___newcumap	dd 83828180h, 87868584h, 8B8A8988h, 8F8E8D8Ch, 93929190h
.rdata:0041FC18			dd 97969594h, 9B9A9998h, 9F9E9D9Ch, 0A3A2A1A0h,	0A7A6A5A4h
.rdata:0041FC18			dd 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h, 0B7B6B5B4h, 0BBBAB9B8h
.rdata:0041FC18			dd 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h, 0CBCAC9C8h, 0CFCECDCCh
.rdata:0041FC18			dd 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h, 0DFDEDDDCh, 0E3E2E1E0h
.rdata:0041FC18			dd 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh, 0F3F2F1F0h, 0F7F6F5F4h
.rdata:0041FC18			dd 0FBFAF9F8h, 0FFFEFDFCh
.rdata:0041FC98	dword_41FC98	dd 3020100h, 7060504h, 0B0A0908h, 0F0E0D0Ch, 13121110h
.rdata:0041FC98						; DATA XREF: ___init_ctype+370o
.rdata:0041FC98						; .data:___initiallocinfoo
.rdata:0041FC98			dd 17161514h, 1B1A1918h, 1F1E1D1Ch, 23222120h, 27262524h
.rdata:0041FC98			dd 2B2A2928h, 2F2E2D2Ch, 33323130h, 37363534h, 3B3A3938h
.rdata:0041FC98			dd 3F3E3D3Ch, 43424140h, 47464544h, 4B4A4948h, 4F4E4D4Ch
.rdata:0041FC98			dd 53525150h, 57565554h, 5B5A5958h, 5F5E5D5Ch, 43424160h
.rdata:0041FC98			dd 47464544h, 4B4A4948h, 4F4E4D4Ch, 53525150h, 57565554h
.rdata:0041FC98			dd 7B5A5958h, 7F7E7D7Ch, 83828180h, 87868584h, 8B8A8988h
.rdata:0041FC98			dd 8F8E8D8Ch, 93929190h, 97969594h, 9B9A9998h, 9F9E9D9Ch
.rdata:0041FC98			dd 0A3A2A1A0h, 0A7A6A5A4h, 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h
.rdata:0041FC98			dd 0B7B6B5B4h, 0BBBAB9B8h, 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h
.rdata:0041FC98			dd 0CBCAC9C8h, 0CFCECDCCh, 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h
.rdata:0041FC98			dd 0DFDEDDDCh, 0E3E2E1E0h, 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh
.rdata:0041FC98			dd 0F3F2F1F0h, 0F7F6F5F4h, 0FBFAF9F8h, 0FFFEFDFCh
.rdata:0041FD98	aHhMmSs		db 'HH:mm:ss',0         ; DATA XREF: .data:00422E40o
.rdata:0041FDA1			align 4
.rdata:0041FDA4	aDdddMmmmDdYyyy	db 'dddd, MMMM dd, yyyy',0 ; DATA XREF: .data:00422E3Co
.rdata:0041FDB8	aMmDdYy		db 'MM/dd/yy',0         ; DATA XREF: .data:00422E38o
.rdata:0041FDC1			align 4
.rdata:0041FDC4	aPm		db 'PM',0               ; DATA XREF: .data:00422E34o
.rdata:0041FDC7			align 4
.rdata:0041FDC8	aAm		db 'AM',0               ; DATA XREF: .data:00422E30o
.rdata:0041FDCB			align 4
.rdata:0041FDCC	aDecember	db 'December',0         ; DATA XREF: .data:00422E2Co
.rdata:0041FDD5			align 4
.rdata:0041FDD8	aNovember	db 'November',0         ; DATA XREF: .data:00422E28o
.rdata:0041FDE1			align 4
.rdata:0041FDE4	aOctober	db 'October',0          ; DATA XREF: .data:00422E24o
.rdata:0041FDEC	aSeptember	db 'September',0        ; DATA XREF: .data:00422E20o
.rdata:0041FDF6			align 4
.rdata:0041FDF8	aAugust		db 'August',0           ; DATA XREF: .data:00422E1Co
.rdata:0041FDFF			align 10h
.rdata:0041FE00	aJuly		db 'July',0             ; DATA XREF: .data:00422E18o
.rdata:0041FE05			align 4
.rdata:0041FE08	aJune		db 'June',0             ; DATA XREF: .data:00422E14o
.rdata:0041FE0D			align 10h
.rdata:0041FE10	aApril		db 'April',0            ; DATA XREF: .data:00422E0Co
.rdata:0041FE16			align 4
.rdata:0041FE18	aMarch		db 'March',0            ; DATA XREF: .data:00422E08o
.rdata:0041FE1E			align 10h
.rdata:0041FE20	aFebruary	db 'February',0         ; DATA XREF: .data:00422E04o
.rdata:0041FE29			align 4
.rdata:0041FE2C	aJanuary	db 'January',0          ; DATA XREF: .data:00422E00o
.rdata:0041FE34	aDec		db 'Dec',0              ; DATA XREF: .data:00422DFCo
.rdata:0041FE38	aNov		db 'Nov',0              ; DATA XREF: .data:00422DF8o
.rdata:0041FE3C	aOct		db 'Oct',0              ; DATA XREF: .data:00422DF4o
.rdata:0041FE40	aSep		db 'Sep',0              ; DATA XREF: .data:00422DF0o
.rdata:0041FE44	aAug		db 'Aug',0              ; DATA XREF: .data:00422DECo
.rdata:0041FE48	aJul		db 'Jul',0              ; DATA XREF: .data:00422DE8o
.rdata:0041FE4C	aJun		db 'Jun',0              ; DATA XREF: .data:00422DE4o
.rdata:0041FE50	aMay		db 'May',0              ; DATA XREF: .data:00422DE0o
.rdata:0041FE50						; .data:00422E10o
.rdata:0041FE54	aApr		db 'Apr',0              ; DATA XREF: .data:00422DDCo
.rdata:0041FE58	aMar		db 'Mar',0              ; DATA XREF: .data:00422DD8o
.rdata:0041FE5C	aFeb		db 'Feb',0              ; DATA XREF: .data:00422DD4o
.rdata:0041FE60	aJan		db 'Jan',0              ; DATA XREF: .data:00422DD0o
.rdata:0041FE64	aSaturday	db 'Saturday',0         ; DATA XREF: .data:00422DCCo
.rdata:0041FE6D			align 10h
.rdata:0041FE70	aFriday		db 'Friday',0           ; DATA XREF: .data:00422DC8o
.rdata:0041FE77			align 4
.rdata:0041FE78	aThursday	db 'Thursday',0         ; DATA XREF: .data:00422DC4o
.rdata:0041FE81			align 4
.rdata:0041FE84	aWednesday	db 'Wednesday',0        ; DATA XREF: .data:00422DC0o
.rdata:0041FE8E			align 10h
.rdata:0041FE90	aTuesday	db 'Tuesday',0          ; DATA XREF: .data:00422DBCo
.rdata:0041FE98	aMonday		db 'Monday',0           ; DATA XREF: .data:00422DB8o
.rdata:0041FE9F			align 10h
.rdata:0041FEA0	aSunday		db 'Sunday',0           ; DATA XREF: .data:00422DB4o
.rdata:0041FEA7			align 4
.rdata:0041FEA8	aSat		db 'Sat',0              ; DATA XREF: .data:00422DB0o
.rdata:0041FEAC	aFri		db 'Fri',0              ; DATA XREF: .data:00422DACo
.rdata:0041FEB0	aThu		db 'Thu',0              ; DATA XREF: .data:00422DA8o
.rdata:0041FEB4	aWed		db 'Wed',0              ; DATA XREF: .data:00422DA4o
.rdata:0041FEB8	aTue		db 'Tue',0              ; DATA XREF: .data:00422DA0o
.rdata:0041FEBC	aMon		db 'Mon',0              ; DATA XREF: .data:00422D9Co
.rdata:0041FEC0	aSun		db 'Sun',0              ; DATA XREF: .data:___lc_time_co
.rdata:0041FEC4	; char aAP[]
.rdata:0041FEC4	aAP		db 'a/p',0              ; DATA XREF: _store_winword:loc_40F23Do
.rdata:0041FEC8	; char src[]
.rdata:0041FEC8	src		db 'am/pm',0            ; DATA XREF: _store_winword:loc_40F227o
.rdata:0041FECE			align 10h
.rdata:0041FED0	aUnitedStates	db 'united-states',0
.rdata:0041FEDE			align 10h
.rdata:0041FEE0	aUnitedKingdom	db 'united-kingdom',0
.rdata:0041FEEF			align 10h
.rdata:0041FEF0	aTrinidadTobago	db 'trinidad & tobago',0
.rdata:0041FF02			align 4
.rdata:0041FF04	aSouthKorea_0	db 'south-korea',0
.rdata:0041FF10	aSouthAfrica_0	db 'south-africa',0
.rdata:0041FF1D			align 10h
.rdata:0041FF20	aSouthKorea	db 'south korea',0
.rdata:0041FF2C	aSouthAfrica	db 'south africa',0
.rdata:0041FF39			align 4
.rdata:0041FF3C	aSlovak		db 'slovak',0
.rdata:0041FF43			align 4
.rdata:0041FF44	aPuertoRico	db 'puerto-rico',0
.rdata:0041FF50	aPrChina	db 'pr-china',0
.rdata:0041FF59			align 4
.rdata:0041FF5C	aPrChina_0	db 'pr china',0
.rdata:0041FF65			align 4
.rdata:0041FF68	aNz		db 'nz',0
.rdata:0041FF6B			align 4
.rdata:0041FF6C	aNewZealand	db 'new-zealand',0
.rdata:0041FF78	aHongKong	db 'hong-kong',0
.rdata:0041FF82			align 4
.rdata:0041FF84	aHolland	db 'holland',0
.rdata:0041FF8C	aGreatBritain	db 'great britain',0
.rdata:0041FF9A			align 4
.rdata:0041FF9C	aEngland	db 'england',0
.rdata:0041FFA4	aCzech		db 'czech',0
.rdata:0041FFAA			align 4
.rdata:0041FFAC	aChina		db 'china',0
.rdata:0041FFB2			align 4
.rdata:0041FFB4	aBritain	db 'britain',0          ; DATA XREF: .rdata:004205E8o
.rdata:0041FFBC	aAmerica	db 'america',0          ; DATA XREF: .rdata:___rg_countryo
.rdata:0041FFC4	aUsa		db 'usa',0
.rdata:0041FFC8	aUs		db 'us',0
.rdata:0041FFCB			align 4
.rdata:0041FFCC	aUk		db 'uk',0
.rdata:0041FFCF			align 10h
.rdata:0041FFD0	aSwiss		db 'swiss',0
.rdata:0041FFD6			align 4
.rdata:0041FFD8	aSwedishFinland	db 'swedish-finland',0
.rdata:0041FFE8	aSpanishVenezue	db 'spanish-venezuela',0
.rdata:0041FFFA			align 4
.rdata:0041FFFC	aSpanishUruguay	db 'spanish-uruguay',0
.rdata:0042000C	aSpanishPuertoR	db 'spanish-puerto rico',0
.rdata:00420020	aSpanishPeru	db 'spanish-peru',0
.rdata:0042002D			align 10h
.rdata:00420030	aSpanishParagua	db 'spanish-paraguay',0
.rdata:00420041			align 4
.rdata:00420044	aSpanishPanama	db 'spanish-panama',0
.rdata:00420053			align 4
.rdata:00420054	aSpanishNicarag	db 'spanish-nicaragua',0
.rdata:00420066			align 4
.rdata:00420068	aSpanishModern	db 'spanish-modern',0
.rdata:00420077			align 4
.rdata:00420078	aSpanishMexican	db 'spanish-mexican',0
.rdata:00420088	aSpanishHondura	db 'spanish-honduras',0
.rdata:00420099			align 4
.rdata:0042009C	aSpanishGuatema	db 'spanish-guatemala',0
.rdata:004200AE			align 10h
.rdata:004200B0	aSpanishElSalva	db 'spanish-el salvador',0
.rdata:004200C4	aSpanishEcuador	db 'spanish-ecuador',0
.rdata:004200D4	aSpanishDominic	db 'spanish-dominican republic',0
.rdata:004200EF			align 10h
.rdata:004200F0	aSpanishCostaRi	db 'spanish-costa rica',0
.rdata:00420103			align 4
.rdata:00420104	aSpanishColombi	db 'spanish-colombia',0
.rdata:00420115			align 4
.rdata:00420118	aSpanishChile	db 'spanish-chile',0
.rdata:00420126			align 4
.rdata:00420128	aSpanishBolivia	db 'spanish-bolivia',0
.rdata:00420138	aSpanishArgenti	db 'spanish-argentina',0
.rdata:0042014A			align 4
.rdata:0042014C	aPortugueseBraz	db 'portuguese-brazilian',0
.rdata:00420161			align 4
.rdata:00420164	aNorwegianNyn_0	db 'norwegian-nynorsk',0
.rdata:00420176			align 4
.rdata:00420178	aNorwegianBokma	db 'norwegian-bokmal',0
.rdata:00420189			align 4
.rdata:0042018C	aNorwegian	db 'norwegian',0
.rdata:00420196			align 4
.rdata:00420198	aItalianSwiss	db 'italian-swiss',0
.rdata:004201A6			align 4
.rdata:004201A8	aIrishEnglish	db 'irish-english',0
.rdata:004201B6			align 4
.rdata:004201B8	aGermanSwiss	db 'german-swiss',0
.rdata:004201C5			align 4
.rdata:004201C8	aGermanLuxembou	db 'german-luxembourg',0
.rdata:004201DA			align 4
.rdata:004201DC	aGermanLichtens	db 'german-lichtenstein',0
.rdata:004201F0	aGermanAustrian	db 'german-austrian',0
.rdata:00420200	aFrenchSwiss	db 'french-swiss',0
.rdata:0042020D			align 10h
.rdata:00420210	aFrenchLuxembou	db 'french-luxembourg',0
.rdata:00420222			align 4
.rdata:00420224	aFrenchCanadian	db 'french-canadian',0
.rdata:00420234	aFrenchBelgian	db 'french-belgian',0
.rdata:00420243			align 4
.rdata:00420244	aEnglishUsa	db 'english-usa',0
.rdata:00420250	aEnglishUs	db 'english-us',0
.rdata:0042025B			align 4
.rdata:0042025C	aEnglishUk	db 'english-uk',0
.rdata:00420267			align 4
.rdata:00420268	aEnglishTrinida	db 'english-trinidad y tobago',0
.rdata:00420282			align 4
.rdata:00420284	aEnglishSouthAf	db 'english-south africa',0
.rdata:00420299			align 4
.rdata:0042029C	aEnglishNz	db 'english-nz',0
.rdata:004202A7			align 4
.rdata:004202A8	aEnglishJamaica	db 'english-jamaica',0
.rdata:004202B8	aEnglishIre	db 'english-ire',0
.rdata:004202C4	aEnglishCaribbe	db 'english-caribbean',0
.rdata:004202D6			align 4
.rdata:004202D8	aEnglishCan	db 'english-can',0
.rdata:004202E4	aEnglishBelize	db 'english-belize',0
.rdata:004202F3			align 4
.rdata:004202F4	aEnglishAus	db 'english-aus',0
.rdata:00420300	aEnglishAmerica	db 'english-american',0
.rdata:00420311			align 4
.rdata:00420314	aDutchBelgian	db 'dutch-belgian',0
.rdata:00420322			align 4
.rdata:00420324	aChineseTraditi	db 'chinese-traditional',0
.rdata:00420338	aChineseSingapo	db 'chinese-singapore',0
.rdata:0042034A			align 4
.rdata:0042034C	aChineseSimplif	db 'chinese-simplified',0
.rdata:0042035F			align 10h
.rdata:00420360	aChineseHongkon	db 'chinese-hongkong',0
.rdata:00420371			align 4
.rdata:00420374	aChinese	db 'chinese',0
.rdata:0042037C	aChi		db 'chi',0
.rdata:00420380	aChh		db 'chh',0
.rdata:00420384	aCanadian	db 'canadian',0
.rdata:0042038D			align 10h
.rdata:00420390	aBelgian	db 'belgian',0
.rdata:00420398	aAustralian	db 'australian',0
.rdata:004203A3			align 4
.rdata:004203A4	aAmericanEnglis	db 'american-english',0
.rdata:004203B5			align 4
.rdata:004203B8	aAmericanEngl_0	db 'american english',0 ; DATA XREF: .rdata:004203E0o
.rdata:004203C9			align 4
.rdata:004203CC	aAmerican	db 'american',0         ; DATA XREF: .rdata:___rg_languageo
.rdata:004203D5			align 4
.rdata:004203D8	; tagLOCALETAB __rg_language
.rdata:004203D8	___rg_language	dd offset aAmerican	; szName
.rdata:004203D8						; DATA XREF: ___get_qualified_locale+74o
.rdata:004203D8			db 45h,	4Eh, 55h, 0	; chAbbrev ; "american"
.rdata:004203E0			dd offset aAmericanEngl_0 ; "american english"
.rdata:004203E4			dd 554E45h, 4203A4h, 554E45h, 420398h, 414E45h,	420390h
.rdata:004203E4			dd 424C4Eh, 420384h, 434E45h, 420380h, 48485Ah,	42037Ch
.rdata:004203E4			dd 49485Ah, 420374h, 534843h, 420360h, 48485Ah,	42034Ch
.rdata:004203E4			dd 534843h, 420338h, 49485Ah, 420324h, 544843h,	420314h
.rdata:004203E4			dd 424C4Eh, 420300h, 554E45h, 4202F4h, 414E45h,	4202E4h
.rdata:004203E4			dd 4C4E45h, 4202D8h, 434E45h, 4202C4h, 424E45h,	4202B8h
.rdata:004203E4			dd 494E45h, 4202A8h, 4A4E45h, 42029Ch, 5A4E45h,	420284h
.rdata:004203E4			dd 534E45h, 420268h, 544E45h, 42025Ch, 474E45h,	420250h
.rdata:004203E4			dd 554E45h, 420244h, 554E45h, 420234h, 425246h,	420224h
.rdata:004203E4			dd 435246h, 420210h, 4C5246h, 420200h, 535246h,	4201F0h
.rdata:004203E4			dd 414544h, 4201DCh, 434544h, 4201C8h, 4C4544h,	4201B8h
.rdata:004203E4			dd 534544h, 4201A8h, 494E45h, 420198h, 535449h,	42018Ch
.rdata:004203E4			dd 524F4Eh, 420178h, 524F4Eh, 420164h, 4E4F4Eh,	42014Ch
.rdata:004203E4			dd 425450h, 420138h, 535345h, 420128h, 425345h,	420118h
.rdata:004203E4			dd 4C5345h, 420104h, 4F5345h, 4200F0h, 435345h,	4200D4h
.rdata:004203E4			dd 445345h, 4200C4h, 465345h, 4200B0h, 455345h,	42009Ch
.rdata:004203E4			dd 475345h, 420088h, 485345h, 420078h, 4D5345h,	420068h
.rdata:004203E4			dd 4E5345h, 420054h, 495345h, 420044h, 415345h,	420030h
.rdata:004203E4			dd 5A5345h, 420020h, 525345h, 42000Ch, 555345h,	41FFFCh
.rdata:004203E4			dd 595345h, 41FFE8h, 565345h, 41FFD8h, 465653h,	41FFD0h
.rdata:004203E4			dd 534544h, 41FFCCh, 474E45h, 41FFC8h, 554E45h,	41FFC4h
.rdata:004203E4			dd 554E45h
.rdata:004205E0	; tagLOCALETAB __rg_country
.rdata:004205E0	___rg_country	dd offset aAmerica	; szName
.rdata:004205E0						; DATA XREF: ___get_qualified_locale+3Co
.rdata:004205E0			db 55h,	53h, 41h, 0	; chAbbrev ; "america"
.rdata:004205E8			dd offset aBritain	; "britain"
.rdata:004205EC			dd 524247h, 41FFACh, 4E4843h, 41FFA4h, 455A43h,	41FF9Ch
.rdata:004205EC			dd 524247h, 41FF8Ch, 524247h, 41FF84h, 444C4Eh,	41FF78h
.rdata:004205EC			dd 474B48h, 41FF6Ch, 4C5A4Eh, 41FF68h, 4C5A4Eh,	41FF5Ch
.rdata:004205EC			dd 4E4843h, 41FF50h, 4E4843h, 41FF44h, 495250h,	41FF3Ch
.rdata:004205EC			dd 4B5653h, 41FF2Ch, 46415Ah, 41FF20h, 524F4Bh,	41FF10h
.rdata:004205EC			dd 46415Ah, 41FF04h, 524F4Bh, 41FEF0h, 4F5454h,	41FFCCh
.rdata:004205EC			dd 524247h, 41FEE0h, 524247h, 41FED0h, 415355h,	41FFC8h
.rdata:004205EC			dd 415355h
.rdata:00420698	___rglangidNotDefault dw 0C0Ch		; DATA XREF: TestDefaultCountry+7r
.rdata:0042069A			dw 0C1Ah
.rdata:0042069C			dd 4361007h, 42D080Ch, 100C0403h, 81D0810h
.rdata:004206AC	; char aOcp[]
.rdata:004206AC	aOcp		db 'OCP',0              ; DATA XREF: ProcessCodePage+2Do
.rdata:004206B0	; char str2[]
.rdata:004206B0	str2		db 'ACP',0              ; DATA XREF: ProcessCodePage+1Co
.rdata:004206B4	; char aNorwegianNynor[]
.rdata:004206B4	aNorwegianNynor	db 'Norwegian-Nynorsk',0
.rdata:004206B4						; DATA XREF: ___get_qualified_locale+179o
.rdata:004206C6			align 4
.rdata:004206C8	; _EXCEPTION_POINTERS GS_ExceptionPointers
.rdata:004206C8	GS_ExceptionPointers _EXCEPTION_POINTERS <offset GS_ExceptionRecord, \
.rdata:004206C8						; DATA XREF: ___report_gsfailure+D4o
.rdata:004206C8					     offset GS_ContextRecord>
.rdata:004206D0	___dnames	db 'SunMonTueWedThuFriSat',0
.rdata:004206E6			align 4
.rdata:004206E8	___mnames	db 'JanFebMarAprMayJunJulAugSepOctNovDec',0
.rdata:0042070D			align 10h
.rdata:00420710	; char option[]
.rdata:00420710	option		db 'TZ',0               ; DATA XREF: _tzset_nolock+A1o
.rdata:00420713			align 4
.rdata:00420714	; char FileName[]
.rdata:00420714	FileName	db 'CONIN$',0           ; DATA XREF: ___initconin+Eo
.rdata:0042071B			align 4
.rdata:0042071C	; char aConout[]
.rdata:0042071C	aConout		db 'CONOUT$',0          ; DATA XREF: ___initconout+Eo
.rdata:00420724			align 8
.rdata:00420728	__load_config_used:
.rdata:00420728			unicode	0, <H>,0
.rdata:0042072C			dd 0Eh dup(0)
.rdata:00420764			dd offset ___security_cookie
.rdata:00420768			dd offset ___safe_se_handler_table
.rdata:0042076C			dd 3, 19Bh dup(0)
.rdata:00420DDC	aRsds		db 'RSDS%',0
.rdata:00420DE2			dw 9065h
.rdata:00420DE4			dd 4C7B013Ah, 0C2CB85BCh, 892B36DCh, 1
.rdata:00420DF4	aCAdityaWorkWal	db 'C:\aditya\work\waldo\tests\large\testavl.pdb',0
.rdata:00420E21			align 4
.rdata:00420E24			dd 43h dup(0)
.rdata:00420F30	___safe_se_handler_table dd 3390h, 8E4Ch, 13078h, 41h dup(0)
.rdata:00420F30						; DATA XREF: .rdata:00420768o
.rdata:00421040	___rtc_iaa	dd 0
.rdata:00421044	dword_421044	dd 40h dup(0)		; DATA XREF: __RTC_Initialize+2o
.rdata:00421144	___rtc_izz	dd 41h dup(0)		; DATA XREF: __RTC_Initialize+7o
.rdata:00421248	___rtc_taa	dd 0
.rdata:0042124C	dword_42124C	dd 40h dup(0)		; DATA XREF: __RTC_Terminate+2o
.rdata:0042134C	___rtc_tzz	dd 41h dup(0)		; DATA XREF: __RTC_Terminate+7o
.rdata:00421450	dword_421450	dd 0FFFFFFFEh, 0	; DATA XREF: _printf+2o
.rdata:00421458			dd 0FFFFFFD4h, 0
.rdata:00421460			dd 0FFFFFFFEh, 0
.rdata:00421468			dd offset $LN6
.rdata:0042146C			align 10h
.rdata:00421470	dword_421470	dd 0FFFFFFFEh, 0	; DATA XREF: _free+2o
.rdata:00421478			dd 0FFFFFFD4h, 0
.rdata:00421480			dd 0FFFFFFFEh, 0
.rdata:00421488			dd offset $LN12
.rdata:0042148C			align 10h
.rdata:00421490	dword_421490	dd 0FFFFFFFEh, 0	; DATA XREF: doexit+2o
.rdata:00421498			dd 0FFFFFFD0h, 0
.rdata:004214A0			dd 0FFFFFFFEh, 0
.rdata:004214A8			dd offset $LN29
.rdata:004214AC			align 10h
.rdata:004214B0	dword_4214B0	dd 0FFFFFFFEh, 0	; DATA XREF: _fprintf+2o
.rdata:004214B8			dd 0FFFFFFD4h, 0
.rdata:004214C0			dd 0FFFFFFFEh, 0
.rdata:004214C8			dd offset $LN16_0
.rdata:004214CC			align 10h
.rdata:004214D0	dword_4214D0	dd 0FFFFFFFEh, 0	; DATA XREF: _V6_HeapAlloc+2o
.rdata:004214D8			dd 0FFFFFFD4h, 0
.rdata:004214E0			dd 0FFFFFFFEh, 0
.rdata:004214E8			dd offset $LN6_0
.rdata:004214EC			align 10h
.rdata:004214F0	dword_4214F0	dd 0FFFFFFFEh, 0	; DATA XREF: __tmainCRTStartup+2o
.rdata:004214F8			dd 0FFFFFFC4h, 0
.rdata:00421500			dd 0FFFFFFFEh, 402474h,	402488h, 0
.rdata:00421510	dword_421510	dd 0FFFFFFFEh, 0	; DATA XREF: _vprintf_helper+2o
.rdata:00421518			dd 0FFFFFFD0h, 0
.rdata:00421520			dd 0FFFFFFFEh, 0
.rdata:00421528			dd offset $LN6_1
.rdata:0042152C			align 10h
.rdata:00421530	dword_421530	dd 0FFFFFFFEh, 0	; DATA XREF: __mtinitlocknum+2o
.rdata:00421538			dd 0FFFFFFD4h, 0
.rdata:00421540			dd 0FFFFFFFEh, 0
.rdata:00421548			dd offset $LN12_0
.rdata:0042154C			align 10h
.rdata:00421550	dword_421550	dd 0FFFFFFFEh, 0	; DATA XREF: __initptd+2o
.rdata:00421558			dd 0FFFFFFD4h, 0
.rdata:00421560			dd 0FFFFFFFEh, 0
.rdata:00421568			dd offset $LN8_0
.rdata:0042156C			align 10h
.rdata:00421570	dword_421570	dd 0FFFFFFFEh, 0	; DATA XREF: _freefls(x)+2o
.rdata:00421578			dd 0FFFFFFD8h, 0
.rdata:00421580			dd 0FFFFFFFEh, 0
.rdata:00421588			dd offset $LN17_1
.rdata:0042158C			dd 0FFFFFFFEh, 0
.rdata:00421594			dd offset $LN21
.rdata:00421598	dword_421598	dd 0FFFFFFFEh, 0	; DATA XREF: __onexit+2o
.rdata:004215A0			dd 0FFFFFFD4h, 0
.rdata:004215A8			dd 0FFFFFFFEh, 0
.rdata:004215B0			dd offset $LN5
.rdata:004215B4			align 8
.rdata:004215B8	dword_4215B8	dd 0FFFFFFFEh, 0	; DATA XREF: __IsNonwritableInCurrentImage+5o
.rdata:004215C0			dd 0FFFFFFD8h, 0
.rdata:004215C8			dd 0FFFFFFFEh, 405459h,	40546Dh, 0
.rdata:004215D8	dword_4215D8	dd 0FFFFFFFEh, 0	; DATA XREF: terminate(void)+2o
.rdata:004215E0			dd 0FFFFFFD8h, 0
.rdata:004215E8			dd 0FFFFFFFEh, 4054ABh,	4054AFh, 0
.rdata:004215F8	dword_4215F8	dd 0FFFFFFFEh, 0	; DATA XREF: _inconsistency(void)+2o
.rdata:00421600			dd 0FFFFFFD8h, 0
.rdata:00421608			dd 0FFFFFFFEh, 4054FBh,	4054FFh, 0
.rdata:00421618	dword_421618	dd 0FFFFFFFEh, 0	; DATA XREF: ctrlevent_capture+2o
.rdata:00421620			dd 0FFFFFFD0h, 0
.rdata:00421628			dd 0FFFFFFFEh, 0
.rdata:00421630			dd offset $LN10_1
.rdata:00421634			align 8
.rdata:00421638	dword_421638	dd 0FFFFFFFEh, 0	; DATA XREF: _signal+2o
.rdata:00421640			dd 0FFFFFFD0h, 0
.rdata:00421648			dd 0FFFFFFFEh, 0
.rdata:00421650			dd offset $LN41
.rdata:00421654			align 8
.rdata:00421658	dword_421658	dd 0FFFFFFFEh, 0	; DATA XREF: _raise+2o
.rdata:00421660			dd 0FFFFFFC0h, 0
.rdata:00421668			dd 0FFFFFFFEh, 0
.rdata:00421670			dd offset $LN35_0
.rdata:00421674			align 8
.rdata:00421678	dword_421678	dd 0FFFFFFFEh, 0	; DATA XREF: ___crtInitCritSecAndSpinCount+2o
.rdata:00421680			dd 0FFFFFFCCh, 0
.rdata:00421688			dd 0FFFFFFFEh, 405ED1h,	405EE8h, 0
.rdata:00421698	dword_421698	dd 0FFFFFFFEh, 0	; DATA XREF: __ioinit+2o
.rdata:004216A0			dd 0FFFFFF8Ch, 0
.rdata:004216A8			dd 0FFFFFFFEh, 4061C0h,	4061C4h, 0
.rdata:004216B8	dword_4216B8	dd 0FFFFFFFEh, 0	; DATA XREF: _vfprintf_helper+2o
.rdata:004216C0			dd 0FFFFFFD4h, 0
.rdata:004216C8			dd 0FFFFFFFEh, 0
.rdata:004216D0			dd offset $LN16_2
.rdata:004216D4			align 8
.rdata:004216D8	dword_4216D8	dd 0FFFFFFFEh, 0	; DATA XREF: __fcloseall+2o
.rdata:004216E0			dd 0FFFFFFD0h, 0
.rdata:004216E8			dd 0FFFFFFFEh, 0
.rdata:004216F0			dd offset $LN11_2
.rdata:004216F4			align 8
.rdata:004216F8	dword_4216F8	dd 0FFFFFFFEh, 0	; DATA XREF: flsall+2o
.rdata:00421700			dd 0FFFFFFCCh, 0
.rdata:00421708			dd 0FFFFFFFEh, 0
.rdata:00421710			dd offset $LN18_0
.rdata:00421714			dd 2 dup(0)
.rdata:0042171C			dd offset $LN22_0
.rdata:00421720	dword_421720	dd 0FFFFFFFEh, 0	; DATA XREF: _fflush+2o
.rdata:00421728			dd 0FFFFFFD4h, 0
.rdata:00421730			dd 0FFFFFFFEh, 0
.rdata:00421738			dd offset $LN6_5
.rdata:0042173C			align 10h
.rdata:00421740	dword_421740	dd 0FFFFFFFEh, 0	; DATA XREF: ___updatetmbcinfo+2o
.rdata:00421748			dd 0FFFFFFD4h, 0
.rdata:00421750			dd 0FFFFFFFEh, 0
.rdata:00421758			dd offset $LN11_3
.rdata:0042175C			align 10h
.rdata:00421760	dword_421760	dd 0FFFFFFFEh, 0	; DATA XREF: __setmbcp+2o
.rdata:00421768			dd 0FFFFFFCCh, 0
.rdata:00421770			dd 0FFFFFFFEh, 0
.rdata:00421778			dd offset $LN25_0
.rdata:0042177C			align 10h
.rdata:00421780	dword_421780	dd 0FFFFFFFEh, 0	; DATA XREF: ___updatetlocinfo+2o
.rdata:00421788			dd 0FFFFFFD4h, 0
.rdata:00421790			dd 0FFFFFFFEh, 0
.rdata:00421798			dd offset $LN9_4
.rdata:0042179C			align 10h
.rdata:004217A0	dword_4217A0	dd 0FFFFFFFEh, 0	; DATA XREF: __free_locale+2o
.rdata:004217A8			dd 0FFFFFFD8h, 0
.rdata:004217B0			dd 0FFFFFFFEh, 0
.rdata:004217B8			dd offset $LN9_5
.rdata:004217BC			align 10h
.rdata:004217C0	dword_4217C0	dd 0FFFFFFFEh, 0	; DATA XREF: __get_current_locale+2o
.rdata:004217C8			dd 0FFFFFFD4h, 0
.rdata:004217D0			dd 0FFFFFFFEh, 0
.rdata:004217D8			dd offset $LN6_7
.rdata:004217DC			align 10h
.rdata:004217E0	dword_4217E0	dd 0FFFFFFFEh, 0	; DATA XREF: _setlocale+2o
.rdata:004217E8			dd 0FFFFFFCCh, 0
.rdata:004217F0			dd 0FFFFFFFEh, 0
.rdata:004217F8			dd offset $LN15_2
.rdata:004217FC			dd 2 dup(0)
.rdata:00421804			dd offset $LN19_4
.rdata:00421808			align 10h
.rdata:00421810			dd offset $LN23_1
.rdata:00421814			align 8
.rdata:00421818	dword_421818	dd 0FFFFFFFEh, 0	; DATA XREF: __msize+2o
.rdata:00421820			dd 0FFFFFFD0h, 0
.rdata:00421828			dd 0FFFFFFFEh, 0
.rdata:00421830			dd offset $LN10_4
.rdata:00421834			align 8
.rdata:00421838	dword_421838	dd 0FFFFFFFEh, 0	; DATA XREF: __calloc_impl+2o
.rdata:00421840			dd 0FFFFFFD4h, 0
.rdata:00421848			dd 0FFFFFFFEh, 0
.rdata:00421850			dd offset $LN22_2
.rdata:00421854			align 8
.rdata:00421858	dword_421858	dd 0FFFFFFFEh, 0	; DATA XREF: _realloc+2o
.rdata:00421860			dd 0FFFFFFD0h, 0
.rdata:00421868			dd 0FFFFFFFEh, 0
.rdata:00421870			dd offset $LN46
.rdata:00421874			align 8
.rdata:00421878	dword_421878	dd 0FFFFFFFEh, 0	; DATA XREF: _fclose+2o
.rdata:00421880			dd 0FFFFFFD4h, 0
.rdata:00421888			dd 0FFFFFFFEh, 0
.rdata:00421890			dd offset $LN8_4
.rdata:00421894			align 8
.rdata:00421898	dword_421898	dd 0FFFFFFFEh, 0	; DATA XREF: __write+2o
.rdata:004218A0			dd 0FFFFFFD0h, 0
.rdata:004218A8			dd 0FFFFFFFEh, 0
.rdata:004218B0			dd offset $LN12_8
.rdata:004218B4			align 8
.rdata:004218B8	dword_4218B8	dd 0FFFFFFFEh, 0	; DATA XREF: __commit+2o
.rdata:004218C0			dd 0FFFFFFD0h, 0
.rdata:004218C8			dd 0FFFFFFFEh, 0
.rdata:004218D0			dd offset $LN14_2
.rdata:004218D4			align 8
.rdata:004218D8	dword_4218D8	dd 0FFFFFFFEh, 0	; DATA XREF: __lseeki64+2o
.rdata:004218E0			dd 0FFFFFFCCh, 0
.rdata:004218E8			dd 0FFFFFFFEh, 0
.rdata:004218F0			dd offset $LN12_9
.rdata:004218F4			align 8
.rdata:004218F8	dword_4218F8	dd 0FFFFFFFEh, 0	; DATA XREF: __close+2o
.rdata:00421900			dd 0FFFFFFD0h, 0
.rdata:00421908			dd 0FFFFFFFEh, 0
.rdata:00421910			dd offset $LN12_10
.rdata:00421914			align 8
.rdata:00421918	dword_421918	dd 0FFFFFFFEh, 0	; DATA XREF: __cputws+2o
.rdata:00421920			dd 0FFFFFFD0h, 0
.rdata:00421928			dd 0FFFFFFFEh, 0
.rdata:00421930			dd offset $LN9_8
.rdata:00421934			align 8
.rdata:00421938	dword_421938	dd 0FFFFFFFEh, 0	; DATA XREF: __putwch+2o
.rdata:00421940			dd 0FFFFFFD4h, 0
.rdata:00421948			dd 0FFFFFFFEh, 0
.rdata:00421950			dd offset $LN5_0
.rdata:00421954			align 8
.rdata:00421958	dword_421958	dd 0FFFFFFFEh, 0	; DATA XREF: ___lock_fhandle+2o
.rdata:00421960			dd 0FFFFFFD4h, 0
.rdata:00421968			dd 0FFFFFFFEh, 0
.rdata:00421970			dd offset $LN9_9
.rdata:00421974			align 8
.rdata:00421978	dword_421978	dd 0FFFFFFFEh, 0	; DATA XREF: __alloc_osfhnd+2o
.rdata:00421980			dd 0FFFFFFC8h, 0
.rdata:00421988			dd 0FFFFFFFEh, 0
.rdata:00421990			dd offset $LN29_0
.rdata:00421994			dd 2 dup(0)
.rdata:0042199C			dd offset $LN33
.rdata:004219A0	dword_4219A0	dd 0FFFFFFFEh, 0	; DATA XREF: __open_osfhandle+2o
.rdata:004219A8			dd 0FFFFFFD4h, 0
.rdata:004219B0			dd 0FFFFFFFEh, 0
.rdata:004219B8			dd offset $LN16_4
.rdata:004219BC			align 10h
.rdata:004219C0	dword_4219C0	dd 0FFFFFFFEh, 0	; DATA XREF: _tzset_nolock+2o
.rdata:004219C8			dd 0FFFFFFB4h, 0
.rdata:004219D0			dd 0FFFFFFFEh, 0
.rdata:004219D8			dd offset $LN36_2
.rdata:004219DC			align 10h
.rdata:004219E0	dword_4219E0	dd 0FFFFFFFEh, 0	; DATA XREF: ___tzset+2o
.rdata:004219E8			dd 0FFFFFFD8h, 0
.rdata:004219F0			dd 0FFFFFFFEh, 0
.rdata:004219F8			dd offset $LN7_8
.rdata:004219FC			align 10h
.rdata:00421A00	dword_421A00	dd 0FFFFFFFEh, 0	; DATA XREF: __tzset+2o
.rdata:00421A08			dd 0FFFFFFD8h, 0
.rdata:00421A10			dd 0FFFFFFFEh, 0
.rdata:00421A18			dd offset $LN5_1
.rdata:00421A1C			align 10h
.rdata:00421A20	dword_421A20	dd 0FFFFFFFEh, 0	; DATA XREF: __isindst+2o
.rdata:00421A28			dd 0FFFFFFD4h, 0
.rdata:00421A30			dd 0FFFFFFFEh, 0
.rdata:00421A38			dd offset $LN5_2
.rdata:00421A3C			align 10h
.rdata:00421A40	dword_421A40	dd 0FFFFFFFEh, 0	; DATA XREF: has_osfxsr_set+2o
.rdata:00421A48			dd 0FFFFFFD4h, 0
.rdata:00421A50			dd 0FFFFFFFEh, 415357h,	415373h, 0
.rdata:00421A60	dword_421A60	dd 0FFFFFFFEh, 0	; DATA XREF: _getenv+2o
.rdata:00421A68			dd 0FFFFFFD0h, 0
.rdata:00421A70			dd 0FFFFFFFEh, 0
.rdata:00421A78			dd offset $LN7_10
.rdata:00421A7C			align 10h
.rdata:00421A80	dword_421A80	dd 0FFFFFFFEh, 0	; DATA XREF: _getenv_s+2o
.rdata:00421A88			dd 0FFFFFFD4h, 0
.rdata:00421A90			dd 0FFFFFFFEh, 0
.rdata:00421A98			dd offset $LN5_3
.rdata:00421A9C			align 10h
.rdata:00421AA0	dword_421AA0	dd 0FFFFFFFEh, 0	; DATA XREF: __dupenv_s+2o
.rdata:00421AA8			dd 0FFFFFFD0h, 0
.rdata:00421AB0			dd 0FFFFFFFEh, 0
.rdata:00421AB8			dd offset $LN5_4
.rdata:00421ABC			align 800h
.rdata:00421ABC	_rdata		ends
.rdata:00421ABC
.data:00422000 ; Section 3. (virtual address 00022000)
.data:00422000 ; Virtual size		       : 000033C8 (  13256.)
.data:00422000 ; Section size in file	       : 00002000 (   8192.)
.data:00422000 ; Offset	to raw data for	section: 00022000
.data:00422000 ; Flags C0000040: Data Readable Writable
.data:00422000 ; Alignment     : default
.data:00422000 ; ===========================================================================
.data:00422000
.data:00422000 ; Segment type: Pure data
.data:00422000 ; Segment permissions: Read/Write
.data:00422000 _data	       segment para public 'DATA' use32
.data:00422000		       assume cs:_data
.data:00422000		       ;org 422000h
.data:00422000 ; char format[]
.data:00422000 format	       db 'Error at %d',0Ah,0  ; DATA XREF: _main+9Eo
.data:0042200D		       align 10h
.data:00422010 ; char aMinIsDMaxIsD[]
.data:00422010 aMinIsDMaxIsD   db 'Min is %d, Max is %d',0Ah,0 ; DATA XREF: _main+D9o
.data:00422026		       align 10h
.data:00422030 aOutOfSpace     db 'Out of space!!!',0  ; DATA XREF: _Insert+1Do
.data:00422040 ; char aS[]
.data:00422040 aS	       db '%s',0Ah,0           ; DATA XREF: _Insert+22o
.data:00422044 ; char aSorryDeleteIsU[]
.data:00422044 aSorryDeleteIsU db 'Sorry; Delete is unimplemented; %d remains',0Ah,0
.data:00422044					       ; DATA XREF: _Delete+7o
.data:00422070		       dd 3 dup(0)
.data:0042207C ; void *_aexit_rtn
.data:0042207C __aexit_rtn     dd offset __exit	       ; DATA XREF: __amsg_exit+Er
.data:0042207C					       ; __init_pointers+45w
.data:00422080 ; FILE _iob[]
.data:00422080 __iob	       dd offset __bufin       ; DATA XREF: ___iob_funco
.data:00422080					       ; ___initstdio+52o ...
.data:00422084		       align 8
.data:00422088		       dd offset __bufin
.data:0042208C		       dd 101h
.data:00422090 dword_422090    dd 2 dup(0)	       ; DATA XREF: ___initstdio+74o
.data:00422098		       dd 1000h, 4 dup(0)
.data:004220AC		       dd 2, 1,	6 dup(0)
.data:004220CC		       dd 2 dup(2), 7 dup(0)
.data:004220F0 dword_4220F0    dd 7Ch dup(0)	       ; DATA XREF: ___initstdio+A4o
.data:004222E0 dword_4222E0    dd 8 dup(0)	       ; DATA XREF: __lock_file+Eo
.data:004222E0					       ; __unlock_file+Do
.data:00422300 ___app_type     dd 1		       ; DATA XREF: ___initstdio+67o
.data:00422300					       ; __NMSG_WRITE+42r ...
.data:00422304 ; char *__nullstring
.data:00422304 ___nullstring   dd offset aNull_0       ; DATA XREF: __output_l:loc_402BCEr
.data:00422304					       ; __output_l+7E6r ...
.data:00422304					       ; "(null)"
.data:00422308 ___wnullstring  dd offset aNull	       ; DATA XREF: __output_l+433r
.data:00422308					       ; __output_s_l+444r ...
.data:00422308					       ; "(null)"
.data:0042230C		       align 10h
.data:00422310 ; errentry errtable[45]
.data:00422310 errtable	       errentry	<1, 16h>       ; DATA XREF: __get_errno_from_oserr:loc_4031F5r
.data:00422310					       ; __get_errno_from_oserr:loc_403210r
.data:00422310		       errentry	<2, 2>
.data:00422310		       errentry	<3, 2>
.data:00422310		       errentry	<4, 18h>
.data:00422310		       errentry	<5, 0Dh>
.data:00422310		       errentry	<6, 9>
.data:00422310		       errentry	<7, 0Ch>
.data:00422310		       errentry	<8, 0Ch>
.data:00422310		       errentry	<9, 0Ch>
.data:00422310		       errentry	<0Ah, 7>
.data:00422310		       errentry	<0Bh, 8>
.data:00422310		       errentry	<0Ch, 16h>
.data:00422310		       errentry	<0Dh, 16h>
.data:00422310		       errentry	<0Fh, 2>
.data:00422310		       errentry	<10h, 0Dh>
.data:00422310		       errentry	<11h, 12h>
.data:00422310		       errentry	<12h, 2>
.data:00422310		       errentry	<21h, 0Dh>
.data:00422310		       errentry	<35h, 2>
.data:00422310		       errentry	<41h, 0Dh>
.data:00422310		       errentry	<43h, 2>
.data:00422310		       errentry	<50h, 11h>
.data:00422310		       errentry	<52h, 0Dh>
.data:00422310		       errentry	<53h, 0Dh>
.data:00422310		       errentry	<57h, 16h>
.data:00422310		       errentry	<59h, 0Bh>
.data:00422310		       errentry	<6Ch, 0Dh>
.data:00422310		       errentry	<6Dh, 20h>
.data:00422310		       errentry	<70h, 1Ch>
.data:00422310		       errentry	<72h, 9>
.data:00422310		       errentry	<6, 16h>
.data:00422310		       errentry	<80h, 0Ah>
.data:00422310		       errentry	<81h, 0Ah>
.data:00422310		       errentry	<82h, 9>
.data:00422310		       errentry	<83h, 16h>
.data:00422310		       errentry	<84h, 0Dh>
.data:00422310		       errentry	<91h, 29h>
.data:00422310		       errentry	<9Eh, 0Dh>
.data:00422310		       errentry	<0A1h, 2>
.data:00422310		       errentry	<0A4h, 0Bh>
.data:00422310		       errentry	<0A7h, 0Dh>
.data:00422310		       errentry	<0B7h, 11h>
.data:00422310		       errentry	<0CEh, 2>
.data:00422310		       errentry	<0D7h, 0Bh>
.data:00422310		       errentry	<718h, 0Ch>
.data:00422478 ; int ErrnoNoMem
.data:00422478 ErrnoNoMem      dd 0Ch		       ; DATA XREF: __errno+9o
.data:0042247C ; unsigned int DoserrorNoMem
.data:0042247C DoserrorNoMem   dd 8		       ; DATA XREF: ___doserrno+9o
.data:00422480 ___security_cookie dd 0BB40E64Eh	       ; DATA XREF: __set_printf_count_outputr
.data:00422480					       ; __get_printf_count_outputr ...
.data:00422484 ___security_cookie_complement dd	44BF19B1h
.data:00422484					       ; DATA XREF: ___security_init_cookie+29w
.data:00422484					       ; ___security_init_cookie+89w ...
.data:00422488 ; unsigned int _amblksiz
.data:00422488 __amblksiz      dd 10h		       ; DATA XREF: __set_amblksiz:loc_4039BAw
.data:00422488					       ; __get_amblksiz+30r
.data:0042248C		       align 10h
.data:00422490 ; LPCRITICAL_SECTION locktable
.data:00422490 _locktable      $A523CF47630928189F043837EB68A11F 2 dup(<0, lkPrealloc>)
.data:00422490					       ; DATA XREF: __mtinitlocks:loc_4037DAw
.data:00422490					       ; __mtdeletelocks+8o ...
.data:00422490		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00422490		       $A523CF47630928189F043837EB68A11F 2 dup(<0, lkPrealloc>)
.data:00422490		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00422490		       $A523CF47630928189F043837EB68A11F 3 dup(<0, lkPrealloc>)
.data:00422490		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00422490		       $A523CF47630928189F043837EB68A11F <0, lkPrealloc>
.data:00422490		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00422490		       $A523CF47630928189F043837EB68A11F 3 dup(<0, lkPrealloc>)
.data:00422490		       $A523CF47630928189F043837EB68A11F <0, 0>
.data:00422490		       $A523CF47630928189F043837EB68A11F 3 dup(<0, lkPrealloc>)
.data:00422490		       $A523CF47630928189F043837EB68A11F  11h dup(<0>)
.data:004225B0 ___flsindex     dd 0FFFFFFFFh	       ; DATA XREF: __mtdeletelocks+2Ao
.data:004225B0					       ; __mtdeletelocks+4Ao ...
.data:004225B4 ; DWORD __getvalueindex
.data:004225B4 ___getvalueindex	dd 0FFFFFFFFh	       ; DATA XREF: __encode_pointer+1r
.data:004225B4					       ; __encode_pointer+1Er ...
.data:004225B8 ; rterrmsgs rterrs[23]
.data:004225B8 rterrs	       rterrmsgs <2, offset aR6002FloatingP>
.data:004225B8					       ; DATA XREF: __NMSG_WRITE:loc_404FC6r
.data:004225B8					       ; __GET_RTERRMSG+6r ...
.data:004225B8		       rterrmsgs <8, offset aR6008NotEnough> ; "runtime	error "
.data:004225B8		       rterrmsgs <9, offset aR6009NotEnough>
.data:004225B8		       rterrmsgs <0Ah, offset aThisApplicatio>
.data:004225B8		       rterrmsgs <10h, offset aR6016NotEnough>
.data:004225B8		       rterrmsgs <11h, offset aR6017Unexpecte>
.data:004225B8		       rterrmsgs <12h, offset aR6018Unexpecte>
.data:004225B8		       rterrmsgs <13h, offset aR6019UnableToO>
.data:004225B8		       rterrmsgs <18h, offset aR6024NotEnough>
.data:004225B8		       rterrmsgs <19h, offset aR6025PureVirtu>
.data:004225B8		       rterrmsgs <1Ah, offset aR6026NotEnough>
.data:004225B8		       rterrmsgs <1Bh, offset aR6027NotEnough>
.data:004225B8		       rterrmsgs <1Ch, offset aR6028UnableToI>
.data:004225B8		       rterrmsgs <1Eh, offset aR6030CrtNotIni>
.data:004225B8		       rterrmsgs <1Fh, offset aR6031AttemptTo>
.data:004225B8		       rterrmsgs <20h, offset aR6032NotEnough>
.data:004225B8		       rterrmsgs <21h, offset aR6033AttemptTo>
.data:004225B8		       rterrmsgs <22h, offset aR6034AnApplica>
.data:004225B8		       rterrmsgs <78h, offset aDomainError>
.data:004225B8		       rterrmsgs <79h, offset aSingError>
.data:004225B8		       rterrmsgs <7Ah, offset aTlossError>
.data:004225B8		       rterrmsgs <0FCh,	offset asc_41ED88>
.data:004225B8		       rterrmsgs <0FFh,	offset aRuntimeError>
.data:00422670 __cfltcvt_tab   dd offset __fptrap      ; DATA XREF: __initp_misc_cfltcvt_tab:loc_405335o
.data:00422674		       dd offset __fptrap
.data:00422678		       dd offset __fptrap
.data:0042267C		       dd offset __fptrap
.data:00422680		       dd offset __fptrap
.data:00422684		       dd offset __fptrap
.data:00422688 ; void *codedptr
.data:00422688 codedptr	       dd offset __fptrap      ; DATA XREF: __output_l+61Ar
.data:00422688					       ; __output_s_l+629r ...
.data:0042268C		       dd offset __fptrap
.data:00422690 ; void *off_422690
.data:00422690 off_422690      dd offset __fptrap      ; DATA XREF: __output_l+65Fr
.data:00422690					       ; __output_s_l+66Fr ...
.data:00422694 ; void *off_422694
.data:00422694 off_422694      dd offset __fptrap      ; DATA XREF: __output_l+640r
.data:00422694					       ; __output_s_l+650r ...
.data:00422698 ; char _XcptActTab[3]
.data:00422698 __XcptActTab    db 5, 2 dup(0)	       ; DATA XREF: __initptd+1Do
.data:00422698					       ; _freefls(x)+6Eo ...
.data:0042269B		       db 0C0h
.data:0042269C		       dd 0Bh, 0
.data:004226A4		       dd 0C000001Dh, 4, 0
.data:004226B0		       dd 0C0000096h, 4, 0
.data:004226BC		       dd 0C000008Dh, 8, 0
.data:004226C8		       dd 0C000008Eh, 8, 0
.data:004226D4		       dd 0C000008Fh, 8, 0
.data:004226E0		       dd 0C0000090h, 8, 0
.data:004226EC		       dd 0C0000091h, 8, 0
.data:004226F8		       dd 0C0000092h, 8, 0
.data:00422704		       dd 0C0000093h, 8, 0
.data:00422710 __First_FPE_Indx	dd 3		       ; DATA XREF: __XcptFilter+90r
.data:00422710					       ; __XcptFilter+AFr ...
.data:00422714 __Num_FPE       dd 7		       ; DATA XREF: __XcptFilter+96r
.data:00422714					       ; __XcptFilter+B5r ...
.data:00422718 ; unsigned int _XcptActTabSize
.data:00422718 __XcptActTabSize	dd 78h		       ; DATA XREF: _signal+83r
.data:00422718					       ; _signal+9Ar
.data:0042271C __XcptActTabCount dd 0Ah		       ; DATA XREF: xcptlookup+4r
.data:0042271C					       ; __XcptFilter+18r ...
.data:00422720 ___badioinfo    dd 0FFFFFFFFh, 0A80h, 0Eh dup(0)
.data:00422720					       ; DATA XREF: _fprintf:loc_401E0Co
.data:00422720					       ; _fprintf:loc_401E51o ...
.data:00422760 ; volatile LONG __initialmbcinfo
.data:00422760 ___initialmbcinfo dd 0		       ; DATA XREF: __initptd+6Eo
.data:00422760					       ; _freefls(x)+9Ao ...
.data:00422764		       dd 16h dup(0)
.data:004227BC		       dd 10100000h, 6 dup(10101010h), 0
.data:004227DC		       dd 20200000h, 6 dup(20202020h), 31h dup(0)
.data:004228BC		       dd 62610000h, 66656463h,	6A696867h, 6E6D6C6Bh, 7271706Fh
.data:004228BC		       dd 76757473h, 7A797877h,	0
.data:004228DC		       db    0
.data:004228DD		       align 2
.data:004228DE aAbcdefghijklmn db 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',0
.data:004228F9		       align 4
.data:004228FC		       dd 21h dup(0)
.data:00422980 ; unsigned __int8 _mbctype[]
.data:00422980 __mbctype       db 0		       ; DATA XREF: __setmbcp+102w
.data:00422981		       align 4
.data:00422984		       dd 0Fh dup(0)
.data:004229C0		       dd 10100000h, 6 dup(10101010h), 0
.data:004229E0		       dd 20200000h, 6 dup(20202020h), 23h dup(0)
.data:00422A88 ; unsigned __int8 _mbcasemap[]
.data:00422A88 __mbcasemap     db 0		       ; DATA XREF: __setmbcp+11Ew
.data:00422A89		       align 4
.data:00422A8C		       dd 0Fh dup(0)
.data:00422AC8		       dd 63626100h, 67666564h,	6B6A6968h, 6F6E6D6Ch, 73727170h
.data:00422AC8		       dd 77767574h, 7A7978h, 0
.data:00422AE8		       db    0
.data:00422AE9 aAbcdefghijkl_0 db 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',0
.data:00422B04		       dd 21h dup(0)
.data:00422B88 ; volatile LONG *___ptmbcinfo
.data:00422B88 ___ptmbcinfo    dd offset ___initialmbcinfo
.data:00422B88					       ; DATA XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+41r
.data:00422B88					       ; ___updatetmbcinfo+4Cr	...
.data:00422B8C ; char _rgctypeflag[4]
.data:00422B8C __rgctypeflag   db 1, 2,	4, 8	       ; DATA XREF: __setmbcp_nolock+111r
.data:00422B90 ; code_page_info	_rgcode_page_info[5]
.data:00422B90 __rgcode_page_info dd 3A4h		  ; code_page
.data:00422B90					       ; DATA XREF: __setmbcp_nolock:loc_407145r
.data:00422B90					       ; __setmbcp_nolock+159o
.data:00422B90		       dw 8260h, 8279h,	21h, 3 dup(0); mbulinfo
.data:00422B90		       db 0A6h,	0DFh, 6	dup(0),	0A1h, 0A5h, 6 dup(0), 81h, 9Fh;	rgrange
.data:00422B90		       db 0E0h,	0FCh, 4	dup(0),	40h, 7Eh, 80h, 0FCh, 4 dup(0); rgrange
.data:00422B90		       dd 3A8h		       ; code_page
.data:00422B90		       dw 0A3C1h, 0A3DAh, 20h, 3 dup(0); mbulinfo
.data:00422B90		       db 10h dup(0), 81h, 0FEh, 6 dup(0), 40h,	0FEh, 6	dup(0);	rgrange
.data:00422B90		       dd 3B5h		       ; code_page
.data:00422B90		       dw 0A3C1h, 0A3DAh, 20h, 3 dup(0); mbulinfo
.data:00422B90		       db 10h dup(0), 81h, 0FEh, 6 dup(0), 41h,	0FEh, 6	dup(0);	rgrange
.data:00422B90		       dd 3B6h		       ; code_page
.data:00422B90		       dw 0A2CFh, 0A2E4h, 1Ah, 0A2E5h, 0A2E8h, 5Bh; mbulinfo
.data:00422B90		       db 10h dup(0), 81h, 0FEh, 6 dup(0), 40h,	7Eh, 0A1h, 0FEh; rgrange
.data:00422B90		       db 4 dup(0)	       ; rgrange
.data:00422B90		       dd 551h		       ; code_page
.data:00422B90		       dw 0DA51h, 0DA5Eh, 20h, 0DA5Fh, 0DA6Ah, 32h; mbulinfo
.data:00422B90		       db 10h dup(0), 81h, 0D3h, 0D8h, 0DEh, 0E0h, 0F9h, 2 dup(0); rgrange
.data:00422B90		       db 31h, 7Eh, 81h, 0FEh, 4 dup(0); rgrange
.data:00422C80 ; const __int16 *ctype_loc_style
.data:00422C80 _ctype_loc_style	dd offset aHH	       ; DATA XREF: _setlocale_set_cat+20Er
.data:00422C80					       ; "	  h((((			 H"
.data:00422C84 ___globallocalestatus dd	0FFFFFFFEh     ; DATA XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+2Cr
.data:00422C84					       ; _LocaleUpdate::_LocaleUpdate(localeinfo_struct	*)+4Cr	...
.data:00422C88 ; char __clocalestr[2]
.data:00422C88 ___clocalestr   db 'C',0                ; DATA XREF: ___freetlocinfo:loc_4075DFo
.data:00422C88					       ; ___addlocaleref:loc_40766Do ...
.data:00422C8A		       align 10h
.data:00422C90 ; threadlocaleinfostruct	__initiallocinfo
.data:00422C90 ___initiallocinfo dd 1			 ; refcount
.data:00422C90					       ; DATA XREF: _freefls(x)+DAo
.data:00422C90					       ; _updatetlocinfoEx_nolock+28o ...
.data:00422C90		       dd 0		       ; lc_codepage ; "	 (((((			H"
.data:00422C90		       dd 0		       ; lc_collate_cp
.data:00422C90		       dd 6 dup(0)	       ; lc_handle
.data:00422C90		       dw 0		       ; lc_id.wLanguage
.data:00422C90		       dw 0		       ; lc_id.wCountry
.data:00422C90		       dw 0		       ; lc_id.wCodePage
.data:00422C90		       dw 0		       ; lc_id.wLanguage
.data:00422C90		       dw 0		       ; lc_id.wCountry
.data:00422C90		       dw 0		       ; lc_id.wCodePage
.data:00422C90		       dw 0		       ; lc_id.wLanguage
.data:00422C90		       dw 0		       ; lc_id.wCountry
.data:00422C90		       dw 0		       ; lc_id.wCodePage
.data:00422C90		       dw 0		       ; lc_id.wLanguage
.data:00422C90		       dw 0		       ; lc_id.wCountry
.data:00422C90		       dw 0		       ; lc_id.wCodePage
.data:00422C90		       dw 0		       ; lc_id.wLanguage
.data:00422C90		       dw 0		       ; lc_id.wCountry
.data:00422C90		       dw 0		       ; lc_id.wCodePage
.data:00422C90		       dw 0		       ; lc_id.wLanguage
.data:00422C90		       dw 0		       ; lc_id.wCountry
.data:00422C90		       dw 0		       ; lc_id.wCodePage
.data:00422C90		       dd 0		       ; lc_category.locale
.data:00422C90		       dd 0		       ; lc_category.wlocale
.data:00422C90		       dd 0		       ; lc_category.refcount
.data:00422C90		       dd 0		       ; lc_category.wrefcount
.data:00422C90		       dd offset ___clocalestr ; lc_category.locale
.data:00422C90		       dd 0		       ; lc_category.wlocale
.data:00422C90		       dd 0		       ; lc_category.refcount
.data:00422C90		       dd 0		       ; lc_category.wrefcount
.data:00422C90		       dd offset ___clocalestr ; lc_category.locale
.data:00422C90		       dd 0		       ; lc_category.wlocale
.data:00422C90		       dd 0		       ; lc_category.refcount
.data:00422C90		       dd 0		       ; lc_category.wrefcount
.data:00422C90		       dd offset ___clocalestr ; lc_category.locale
.data:00422C90		       dd 0		       ; lc_category.wlocale
.data:00422C90		       dd 0		       ; lc_category.refcount
.data:00422C90		       dd 0		       ; lc_category.wrefcount
.data:00422C90		       dd offset ___clocalestr ; lc_category.locale
.data:00422C90		       dd 0		       ; lc_category.wlocale
.data:00422C90		       dd 0		       ; lc_category.refcount
.data:00422C90		       dd 0		       ; lc_category.wrefcount
.data:00422C90		       dd offset ___clocalestr ; lc_category.locale
.data:00422C90		       dd 0		       ; lc_category.wlocale
.data:00422C90		       dd 0		       ; lc_category.refcount
.data:00422C90		       dd 0		       ; lc_category.wrefcount
.data:00422C90		       dd 1		       ; lc_clike
.data:00422C90		       dd 1		       ; mb_cur_max
.data:00422C90		       dd 0		       ; lconv_intl_refcount
.data:00422C90		       dd 0		       ; lconv_num_refcount
.data:00422C90		       dd 0		       ; lconv_mon_refcount
.data:00422C90		       dd offset ___lconv_c    ; lconv
.data:00422C90		       dd 0		       ; ctype1_refcount
.data:00422C90		       dd 0		       ; ctype1
.data:00422C90		       dd offset asc_41F690    ; pctype
.data:00422C90		       dd offset dword_41FB18  ; pclmap
.data:00422C90		       dd offset dword_41FC98  ; pcumap
.data:00422C90		       dd offset ___lc_time_c  ; lc_time_curr
.data:00422D68 ; threadlocaleinfostruct	*___ptlocinfo
.data:00422D68 ___ptlocinfo    dd offset ___initiallocinfo
.data:00422D68					       ; DATA XREF: _LocaleUpdate::_LocaleUpdate(localeinfo_struct *)+24r
.data:00422D68					       ; __initptd+93r	...
.data:00422D6C ___lc_clike     dd 1		       ; DATA XREF: sync_legacy_variables_lk+1Dw
.data:00422D70 ; localeinfo_struct __initiallocalestructinfo
.data:00422D70 ___initiallocalestructinfo localeinfo_struct <offset ___initiallocinfo, offset ___initialmbcinfo>
.data:00422D70					       ; DATA XREF: _iswctype+4Fo
.data:00422D70					       ; _strtol+17o ...
.data:00422D78		       align 10h
.data:00422D80 ___abort_behavior dd 3		       ; DATA XREF: _abort+1Br
.data:00422D80					       ; _abort:loc_40B34Er ...
.data:00422D84		       align 10h
.data:00422D90 ; const unsigned	__int16	*_pctype
.data:00422D90 __pctype	       dd offset asc_41F690    ; DATA XREF: sync_legacy_variables_lk+41w
.data:00422D90					       ; "	   (((((		  H"
.data:00422D94 ; const wctype_t	*_pwctype
.data:00422D94 __pwctype       dd offset word_41F892   ; DATA XREF: ___pwctype_funcr
.data:00422D94					       ; __iswctype_l+20r ...
.data:00422D98 ___lc_time_c    dd offset aSun	       ; DATA XREF: ___freetlocinfo+D9o
.data:00422D98					       ; ___init_time+Co ...
.data:00422D98					       ; "Sun"
.data:00422D9C		       dd offset aMon	       ; "Mon"
.data:00422DA0		       dd offset aTue	       ; "Tue"
.data:00422DA4		       dd offset aWed	       ; "Wed"
.data:00422DA8		       dd offset aThu	       ; "Thu"
.data:00422DAC		       dd offset aFri	       ; "Fri"
.data:00422DB0		       dd offset aSat	       ; "Sat"
.data:00422DB4		       dd offset aSunday       ; "Sunday"
.data:00422DB8		       dd offset aMonday       ; "Monday"
.data:00422DBC		       dd offset aTuesday      ; "Tuesday"
.data:00422DC0		       dd offset aWednesday    ; "Wednesday"
.data:00422DC4		       dd offset aThursday     ; "Thursday"
.data:00422DC8		       dd offset aFriday       ; "Friday"
.data:00422DCC		       dd offset aSaturday     ; "Saturday"
.data:00422DD0		       dd offset aJan	       ; "Jan"
.data:00422DD4		       dd offset aFeb	       ; "Feb"
.data:00422DD8		       dd offset aMar	       ; "Mar"
.data:00422DDC		       dd offset aApr	       ; "Apr"
.data:00422DE0		       dd offset aMay	       ; "May"
.data:00422DE4		       dd offset aJun	       ; "Jun"
.data:00422DE8		       dd offset aJul	       ; "Jul"
.data:00422DEC		       dd offset aAug	       ; "Aug"
.data:00422DF0		       dd offset aSep	       ; "Sep"
.data:00422DF4		       dd offset aOct	       ; "Oct"
.data:00422DF8		       dd offset aNov	       ; "Nov"
.data:00422DFC		       dd offset aDec	       ; "Dec"
.data:00422E00		       dd offset aJanuary      ; "January"
.data:00422E04		       dd offset aFebruary     ; "February"
.data:00422E08		       dd offset aMarch	       ; "March"
.data:00422E0C		       dd offset aApril	       ; "April"
.data:00422E10		       dd offset aMay	       ; "May"
.data:00422E14		       dd offset aJune	       ; "June"
.data:00422E18		       dd offset aJuly	       ; "July"
.data:00422E1C		       dd offset aAugust       ; "August"
.data:00422E20		       dd offset aSeptember    ; "September"
.data:00422E24		       dd offset aOctober      ; "October"
.data:00422E28		       dd offset aNovember     ; "November"
.data:00422E2C		       dd offset aDecember     ; "December"
.data:00422E30		       dd offset aAm	       ; "AM"
.data:00422E34		       dd offset aPm	       ; "PM"
.data:00422E38		       dd offset aMmDdYy       ; "MM/dd/yy"
.data:00422E3C		       dd offset aDdddMmmmDdYyyy ; "dddd, MMMM dd, yyyy"
.data:00422E40		       dd offset aHhMmSs       ; "HH:mm:ss"
.data:00422E44		       dd 409h,	1, 0
.data:00422E50 ___lc_time_curr dd offset ___lc_time_c  ; DATA XREF: sync_legacy_variables_lk+29w
.data:00422E54 ___lconv_static_decimal dd 2Eh	       ; DATA XREF: .data:___lconv_co
.data:00422E58 ___lconv_c      dd offset ___lconv_static_decimal
.data:00422E58					       ; DATA XREF: ___freetlocinfo+14o
.data:00422E58					       ; ___free_lconv_num+Br ...
.data:00422E5C off_422E5C      dd offset ___lconv_static_null
.data:00422E5C					       ; DATA XREF: ___free_lconv_num+1Dr
.data:00422E5C					       ; ___init_numeric+144r
.data:00422E60 off_422E60      dd offset ___lconv_static_null
.data:00422E60					       ; DATA XREF: ___free_lconv_num+2Fr
.data:00422E60					       ; ___init_numeric+14Dr
.data:00422E64 off_422E64      dd offset ___lconv_static_null
.data:00422E64					       ; DATA XREF: ___free_lconv_mon+Cr
.data:00422E68 off_422E68      dd offset ___lconv_static_null
.data:00422E68					       ; DATA XREF: ___free_lconv_mon+1Er
.data:00422E6C off_422E6C      dd offset ___lconv_static_null
.data:00422E6C					       ; DATA XREF: ___free_lconv_mon+30r
.data:00422E70 off_422E70      dd offset ___lconv_static_null
.data:00422E70					       ; DATA XREF: ___free_lconv_mon+42r
.data:00422E74 off_422E74      dd offset ___lconv_static_null
.data:00422E74					       ; DATA XREF: ___free_lconv_mon+54r
.data:00422E78 off_422E78      dd offset ___lconv_static_null
.data:00422E78					       ; DATA XREF: ___free_lconv_mon+66r
.data:00422E7C off_422E7C      dd offset ___lconv_static_null
.data:00422E7C					       ; DATA XREF: ___free_lconv_mon+78r
.data:00422E80		       dd 2 dup(7F7F7F7Fh)
.data:00422E88 ___lconv	       dd offset ___lconv_c    ; DATA XREF: sync_legacy_variables_lk+35w
.data:00422E88					       ; _localeconv:loc_40F688r
.data:00422E8C ; int __mb_cur_max
.data:00422E8C ___mb_cur_max   dd 1		       ; DATA XREF: sync_legacy_variables_lk+4Dw
.data:00422E90 ___decimal_point	dd 2Eh
.data:00422E94 ___decimal_point_length dd 1, 2 dup(0)
.data:00422EA0 __NLG_Destination dd 19930520h, 3 dup(0)	; DATA XREF: __NLG_Notify1+2o
.data:00422EA0					       ; __NLG_Notify+2o
.data:00422EB0 ; int use_w
.data:00422EB0 use_w	       dd 2		       ; DATA XREF: __putwch_nolock+13r
.data:00422EB0					       ; __putwch_nolock+4Fr ...
.data:00422EB4		       align 8
.data:00422EB8 ; __int32 _timezone
.data:00422EB8 __timezone      dd 7080h		       ; DATA XREF: __get_timezone:loc_414292r
.data:00422EB8					       ; ___timezoneo
.data:00422EBC ; int _daylight
.data:00422EBC __daylight      dd 1		       ; DATA XREF: __get_daylight:loc_41422Ar
.data:00422EBC					       ; ___daylighto
.data:00422EC0 ; __int32 _dstbias
.data:00422EC0 __dstbias       dd 0FFFFF1F0h	       ; DATA XREF: __get_dstbias:loc_41425Er
.data:00422EC0					       ; ___dstbiaso
.data:00422EC4		       align 8
.data:00422EC8 ; char tzstd[64]
.data:00422EC8 tzstd	       db 50h, 53h, 54h, 3Dh dup(0) ; DATA XREF: .data:__tznameo
.data:00422F08 ; char tzdst[64]
.data:00422F08 tzdst	       db 50h, 44h, 54h, 3Dh dup(0) ; DATA XREF: .data:00422F4Co
.data:00422F48 ; char *_tzname[2]
.data:00422F48 __tzname	       dd offset tzstd	       ; DATA XREF: ___tznameo
.data:00422F4C		       dd offset tzdst
.data:00422F50 ; transitiondate	dststart
.data:00422F50 dststart	       transitiondate <0FFFFFFFFh, 0, 0>
.data:00422F50					       ; DATA XREF: _tzset_nolock+9Bw
.data:00422F50					       ; cvtdate+17Dw ...
.data:00422F5C ; transitiondate	dstend
.data:00422F5C dstend	       transitiondate <0FFFFFFFFh, 0, 0>
.data:00422F5C					       ; DATA XREF: _tzset_nolock+95w
.data:00422F5C					       ; cvtdate:loc_4148AFw ...
.data:00422F68		       align 10h
.data:00422F70 ; HANDLE	_coninpfh
.data:00422F70 __coninpfh      dd 0FFFFFFFEh	       ; DATA XREF: ___initconin+19w
.data:00422F70					       ; ___termcon:loc_415482r
.data:00422F74 ; HANDLE	_confh
.data:00422F74 __confh	       dd 0FFFFFFFEh	       ; DATA XREF: __putwch_nolock+1Br
.data:00422F74					       ; __putwch_nolock:loc_413885r ...
.data:00422F78 __lpdays	       dd 0FFFFFFFFh	       ; DATA XREF: cvtdate+108r
.data:00422F7C		       dd 1Eh, 3Bh, 5Ah, 78h, 97h, 0B5h, 0D4h, 0F3h, 111h, 130h
.data:00422F7C		       dd 14Eh
.data:00422FA8 dword_422FA8    dd 16Dh		       ; DATA XREF: cvtdate+52r
.data:00422FA8					       ; cvtdate+143r
.data:00422FAC __days	       dd 0FFFFFFFFh	       ; DATA XREF: cvtdate+FDr
.data:00422FB0		       dd 1Eh, 3Ah, 59h, 77h, 96h, 0B4h, 0D3h, 0F2h, 110h, 12Fh
.data:00422FB0		       dd 14Dh,	16Ch, 108h dup(0)
.data:00423400 ; unsigned int _enable_percent_n
.data:00423400 __enable_percent_n dd 0		       ; DATA XREF: __set_printf_count_output+Fr
.data:00423400					       ; __set_printf_count_output+1Ew	...
.data:00423404 __umaskval      dd 0
.data:00423408 __osplatform    dd 0		       ; DATA XREF: __get_osplatform:loc_401A03r
.data:00423408					       ; __get_osver:loc_401A3Ar ...
.data:0042340C ; unsigned int _osver
.data:0042340C __osver	       dd 0		       ; DATA XREF: __get_osver+30r
.data:0042340C					       ; __set_osver+4w ...
.data:00423410 ; unsigned int _winver
.data:00423410 __winver	       dd 0		       ; DATA XREF: __get_winver+30r
.data:00423410					       ; __set_winver+4w ...
.data:00423414 ; unsigned int _winmajor
.data:00423414 __winmajor      dd 0		       ; DATA XREF: __get_winmajor+30r
.data:00423414					       ; __set_winmajor+4w ...
.data:00423418 ; unsigned int _winminor
.data:00423418 __winminor      dd 0		       ; DATA XREF: __get_winminor+30r
.data:00423418					       ; __set_winminor+4w ...
.data:0042341C ; int __argc
.data:0042341C ___argc	       dd 0		       ; DATA XREF: __tmainCRTStartup+154r
.data:0042341C					       ; __setargv+A2w
.data:00423420 ; char **__argv
.data:00423420 ___argv	       dd 0		       ; DATA XREF: __tmainCRTStartup+14Er
.data:00423420					       ; __setargv+A7w
.data:00423424 ; wchar_t **__wargv
.data:00423424 ___wargv	       dd 0
.data:00423428 ; char **_environ
.data:00423428 __environ       dd 0		       ; DATA XREF: __tmainCRTStartup:loc_40243Fr
.data:00423428					       ; __setenvp+4Bw	...
.data:0042342C ___initenv      dd 0		       ; DATA XREF: __tmainCRTStartup+148w
.data:0042342C					       ; ___crtsetenv+5Dr
.data:00423430 ; wchar_t **_wenviron
.data:00423430 __wenviron      dd 0		       ; DATA XREF: __getenv_helper_nolock+1Ar
.data:00423430					       ; ___wtomb_environ+Ar ...
.data:00423434 ___winitenv     dd 0
.data:00423438 ; char *_pgmptr
.data:00423438 __pgmptr	       dd 0		       ; DATA XREF: __get_pgmptr:loc_401B61r
.data:00423438					       ; __set_pgmptr+4w ...
.data:0042343C ; wchar_t *_wpgmptr
.data:0042343C __wpgmptr       dd 0		       ; DATA XREF: __get_wpgmptr:loc_401B2Ar
.data:00423440 __exitflag      db 0		       ; DATA XREF: doexit+2Dw
.data:00423440					       ; ___endstdio+5r
.data:00423441		       align 4
.data:00423444 __C_Termination_Done dd 0	       ; DATA XREF: doexit+24w
.data:00423448 __C_Exit_Done   dd 0		       ; DATA XREF: doexit+1Cr
.data:00423448					       ; doexit+B4w
.data:0042344C __cflush	       dd 0		       ; DATA XREF: __stbuf:loc_4024F2w
.data:0042344C					       ; __getbufw
.data:00423450 ; char *_aenvptr
.data:00423450 __aenvptr       dd 0		       ; DATA XREF: __tmainCRTStartup+109w
.data:00423450					       ; __setenvp:loc_406892r	...
.data:00423454 __wenvptr       dd 0
.data:00423458 ___error_mode   dd 0		       ; DATA XREF: fast_error_exitr
.data:00423458					       ; __set_error_mode+15r ...
.data:0042345C __stdbuf	       dd 2 dup(0)
.data:00423464 ; void *__pInvalidArgHandler
.data:00423464 ___pInvalidArgHandler dd	0	       ; DATA XREF: __initp_misc_invarg+4w
.data:00423464					       ; __set_invalid_parameter_handler+1r ...
.data:00423468 ; HANDLE	_crtheap
.data:00423468 __crtheap       dd 0		       ; DATA XREF: _free+62r
.data:00423468					       ; __heap_allocr	...
.data:0042346C		       align 10h
.data:00423470 ; _RTL_CRITICAL_SECTION lclcritsects[14]
.data:00423470 lclcritsects    _RTL_CRITICAL_SECTION 0Eh dup(<0>)
.data:00423470					       ; DATA XREF: __mtinitlocks+4o
.data:004235C0 ; char *__sbh_pHeaderDefer
.data:004235C0 ___sbh_pHeaderDefer dd 0		       ; DATA XREF: ___sbh_heap_init+21w
.data:004235C0					       ; ___sbh_free_block+21Cr ...
.data:004235C4 ; void *gpFlsAlloc
.data:004235C4 _gpFlsAlloc     dd 0		       ; DATA XREF: __mtinit+30w
.data:004235C4					       ; __mtinit+51r ...
.data:004235C8 ; LPVOID	gpFlsGetValue
.data:004235C8 _gpFlsGetValue  dd 0		       ; DATA XREF: ___set_flsgetvalue+13r
.data:004235C8					       ; __mtinit+3Dw ...
.data:004235CC ; void *gpFlsSetValue
.data:004235CC _gpFlsSetValue  dd 0		       ; DATA XREF: __fls_setvalue(x,x)+8r
.data:004235CC					       ; __getptd_noexit+38r ...
.data:004235D0 ; void *gpFlsFree
.data:004235D0 _gpFlsFree      dd 0		       ; DATA XREF: __mtterm+Br
.data:004235D0					       ; __mtinit+5Ew ...
.data:004235D4		       align 8
.data:004235D8 ; char outmsg[788]
.data:004235D8 outmsg	       db 314h dup(0)	       ; DATA XREF: __NMSG_WRITE+66o
.data:004238EC ; void *__pInconsistency
.data:004238EC ?__pInconsistency@@3P6AXXZA dd 0	       ; DATA XREF: __NMSG_WRITE+E3o
.data:004238EC					       ; _inconsistency(void)+Cr ...
.data:004238F0 ; void (__cdecl *ctrlc_action)(int)
.data:004238F0 ctrlc_action    dd 0		       ; DATA XREF: __initp_misc_winsig+4w
.data:004238F0					       ; ctrlevent_capture+1Do	...
.data:004238F4 ; void (__cdecl *ctrlbreak_action)(int)
.data:004238F4 ctrlbreak_action	dd 0		       ; DATA XREF: __initp_misc_winsig+9w
.data:004238F4					       ; ctrlevent_capture:loc_40571Do	...
.data:004238F8 ; void (__cdecl *abort_action)(int)
.data:004238F8 abort_action    dd 0		       ; DATA XREF: __initp_misc_winsig+Ew
.data:004238F8					       ; ___get_sigabrtr ...
.data:004238FC ; void (__cdecl *term_action)(int)
.data:004238FC term_action     dd 0		       ; DATA XREF: __initp_misc_winsig+13w
.data:004238FC					       ; _signal:loc_40596Fr ...
.data:00423900 ; int ConsoleCtrlHandler_Installed
.data:00423900 ConsoleCtrlHandler_Installed dd 0       ; DATA XREF: _signal:loc_4058D9r
.data:00423900					       ; _signal+124w
.data:00423904 ; volatile LONG g_pfnRtlGenRandom
.data:00423904 g_pfnRtlGenRandom dd 0		       ; DATA XREF: __initp_misc_rand_s+4w
.data:00423904					       ; _rand_s+3r ...
.data:00423908 ; wchar_t wcbuffer
.data:00423908 wcbuffer	       dw 4 dup(0)	       ; DATA XREF: ___getlocaleinfo+117o
.data:00423910 ___pPurecall    dd 0		       ; DATA XREF: ___getlocaleinfo+14Eo
.data:00423910					       ; __initp_misc_purevirt+4w
.data:00423914 ; int (__stdcall	*_pfnInitCritSecAndSpinCount)(_RTL_CRITICAL_SECTION *, unsigned	int)
.data:00423914 __pfnInitCritSecAndSpinCount dd 0       ; DATA XREF: __initp_misc_initcrit+4w
.data:00423914					       ; ___crtInitCritSecAndSpinCount+11r ...
.data:00423918 ; void *_pnhHeap
.data:00423918 ?_pnhHeap@@3P6AHI@ZA dd 0	       ; DATA XREF: __initp_heap_handler+4w
.data:00423918					       ; _set_new_handler(int (*)(uint))+8r ...
.data:0042391C __maxwait       dd 0		       ; DATA XREF: _wait_a_bit+12r
.data:0042391C					       ; __set_malloc_crt_max_wait+4r ...
.data:00423920 __newmode       dd 0		       ; DATA XREF: _malloc+80r
.data:00423920					       ; __calloc_impl+CAr ...
.data:00423924		       align 8
.data:00423928 ; char pgmname[261]
.data:00423928 _pgmname	       db 105h dup(0)	       ; DATA XREF: __setargv+1Do
.data:00423A2D		       align 10h
.data:00423A30 ; int f_use
.data:00423A30 f_use	       dd 0		       ; DATA XREF: ___crtGetEnvironmentStringsA+2r
.data:00423A30					       ; ___crtGetEnvironmentStringsA+24w ...
.data:00423A34 ; int fSystemSet
.data:00423A34 fSystemSet      dd 0		       ; DATA XREF: getSystemCP+15w
.data:00423A34					       ; getSystemCP+1Dw ...
.data:00423A38 ___mbulinfo     dw 0		       ; DATA XREF: __setmbcp+E7w
.data:00423A3A		       align 4
.data:00423A3C		       dd 2 dup(0)
.data:00423A44 ___mbcodepage   dd 0		       ; DATA XREF: __setmbcp+C3w
.data:00423A48 ___ismbcodepage dd 0		       ; DATA XREF: __setmbcp+CBw
.data:00423A4C ___mblcid       dd 0		       ; DATA XREF: __setmbcp+D3w
.data:00423A50 ___locale_changed dd 0		       ; DATA XREF: _setlocale+B9w
.data:00423A50					       ; _isalphar ...
.data:00423A54 ; char __lc_handle[24]
.data:00423A54 ___lc_handle    db 18h dup(0)	       ; DATA XREF: _setlocale+109o
.data:00423A6C ___lc_codepage  dd 0		       ; DATA XREF: sync_legacy_variables_lk+8w
.data:00423A70 ___lc_collate_cp	dd 0		       ; DATA XREF: sync_legacy_variables_lk+11w
.data:00423A74 ; int (__stdcall	*pfnMessageBox)(HWND__ *, const	char *,	const char *, unsigned int)
.data:00423A74 pfnMessageBox   dd 0		       ; DATA XREF: ___crtMessageBoxA+10r
.data:00423A74					       ; ___crtMessageBoxA+61w	...
.data:00423A78 ; HWND__	*(__stdcall *pfnGetActiveWindow)()
.data:00423A78 pfnGetActiveWindow dd 0		       ; DATA XREF: ___crtMessageBoxA+76w
.data:00423A78					       ; ___crtMessageBoxA:loc_40B023r
.data:00423A7C ; HWND__	*(__stdcall *pfnGetLastActivePopup)(HWND__ *)
.data:00423A7C pfnGetLastActivePopup dd	0	       ; DATA XREF: ___crtMessageBoxA+83w
.data:00423A7C					       ; ___crtMessageBoxA+179r
.data:00423A80 ; HWINSTA__ *(__stdcall *pfnGetProcessWindowStation)()
.data:00423A80 pfnGetProcessWindowStation dd 0	       ; DATA XREF: ___crtMessageBoxA+D1w
.data:00423A80					       ; ___crtMessageBoxA:loc_40AF9Er
.data:00423A84 ; int (__stdcall	*pfnGetUserObjectInformation)(void *, int, void	*, unsigned int, unsigned int *)
.data:00423A84 pfnGetUserObjectInformation dd 0	       ; DATA XREF: ___crtMessageBoxA+BBw
.data:00423A84					       ; ___crtMessageBoxA+E2r	...
.data:00423A88 ; int f_use_0
.data:00423A88 f_use_0	       dd 0		       ; DATA XREF: __crtGetLocaleInfoW_stat+Fr
.data:00423A88					       ; __crtGetLocaleInfoW_stat+30w ...
.data:00423A8C ; int f_use_1
.data:00423A8C f_use_1	       dd 0		       ; DATA XREF: __crtGetLocaleInfoA_stat+Fr
.data:00423A8C					       ; __crtGetLocaleInfoA_stat+30w ...
.data:00423A90 ; int f_use_2
.data:00423A90 f_use_2	       dd 0		       ; DATA XREF: __crtLCMapStringA_stat+14r
.data:00423A90					       ; __crtLCMapStringA_stat+3Aw ...
.data:00423A94 ; int f_use_3
.data:00423A94 f_use_3	       dd 0		       ; DATA XREF: __crtGetStringTypeA_stat+Fr
.data:00423A94					       ; __crtGetStringTypeA_stat+37w ...
.data:00423A98 ___lconv_static_null dd 2 dup(0)	       ; DATA XREF: .data:off_422E5Co
.data:00423A98					       ; .data:off_422E60o ...
.data:00423AA0 ; _EXCEPTION_RECORD GS_ExceptionRecord
.data:00423AA0 GS_ExceptionRecord _EXCEPTION_RECORD <0>	; DATA XREF: ___report_gsfailure+8Fw
.data:00423AA0					       ; .rdata:GS_ExceptionPointerso ...
.data:00423AF0 ; int DebuggerWasPresent
.data:00423AF0 DebuggerWasPresent dd 0		       ; DATA XREF: ___report_gsfailure+BFw
.data:00423AF0					       ; ___report_gsfailure+DFr
.data:00423AF4		       align 8
.data:00423AF8 ; _CONTEXT GS_ContextRecord
.data:00423AF8 GS_ContextRecord	_CONTEXT <0>	       ; DATA XREF: ___report_gsfailure+7Bw
.data:00423AF8					       ; .rdata:GS_ExceptionPointerso
.data:00423DC4		       align 8
.data:00423DC8 ; _TIME_ZONE_INFORMATION	tzinfo
.data:00423DC8 tzinfo	       _TIME_ZONE_INFORMATION <0>
.data:00423DC8					       ; DATA XREF: _tzset_nolock:loc_4144C3o
.data:00423DC8					       ; _tzset_nolock+163r ...
.data:00423E74 ; int tzapiused
.data:00423E74 tzapiused       dd 0		       ; DATA XREF: _tzset_nolock+8Cw
.data:00423E74					       ; _tzset_nolock+15Dw ...
.data:00423E78 ; char *lastTZ
.data:00423E78 lastTZ	       dd 0		       ; DATA XREF: _tzset_nolock+B9r
.data:00423E78					       ; _tzset_nolock+D3r ...
.data:00423E7C ; int first_time
.data:00423E7C first_time      dd 0		       ; DATA XREF: ___tzset+Er
.data:00423E7C					       ; ___tzset+21r ...
.data:00423E80 ; int f_use_4
.data:00423E80 f_use_4	       dd 0		       ; DATA XREF: __crtGetStringTypeW_stat:loc_4150F8r
.data:00423E80					       ; __crtGetStringTypeW_stat+45w ...
.data:00423E84 ; int f_use_5
.data:00423E84 f_use_5	       dd 0		       ; DATA XREF: __crtCompareStringA_stat+18r
.data:00423E84					       ; __crtCompareStringA_stat+41w ...
.data:00423E88 ___use_sse2_mathfcns dd 0	       ; DATA XREF: __sse2_mathfcns_initw
.data:00423E88					       ; __sse2_mathfcns_init+Cw ...
.data:00423E8C		       dd 3 dup(0)
.data:00423E98 ___sse2_available dd 0		       ; DATA XREF: _memset+1Er
.data:00423E98					       ; _memmove+28r ...
.data:00423E9C __debugger_hook_dummy dd	0	       ; DATA XREF: __crt_debugger_hookw
.data:00423EA0		       dd 2 dup(0)
.data:00423EA8 ___setlc_active dd 0		       ; DATA XREF: ____setlc_active_funcr
.data:00423EAC		       dd 3 dup(0)
.data:00423EB8 ___unguarded_readlc_active dd 0	       ; DATA XREF: ____unguarded_readlc_active_add_funco
.data:00423EBC ; UINT _nhandle
.data:00423EBC __nhandle       dd 0		       ; DATA XREF: __ioinit+3Cw
.data:00423EBC					       ; __ioinit+CDw ...
.data:00423EC0		       dd 10h dup(0)
.data:00423F00 ___pioinfo      dd 0		       ; DATA XREF: ___initstdio+7Fr
.data:00423F00					       ; __ioinit+37w ...
.data:00423F04		       dd 3Fh dup(0)
.data:00424000 ___sbh_initialized dd 5 dup(?)	       ; DATA XREF: __ioterm+41o
.data:00424014 ___sbh_cntHeaderList dd ?	       ; DATA XREF: __heap_term+16r
.data:00424014					       ; __heap_term+46r ...
.data:00424018 ; LPVOID	__sbh_pHeaderList
.data:00424018 ___sbh_pHeaderList dd ?		       ; DATA XREF: __heap_term+1Fr
.data:00424018					       ; __heap_term:loc_403772r ...
.data:0042401C ___sbh_threshold	dd ?		       ; DATA XREF: _V6_HeapAlloc+13r
.data:0042401C					       ; __get_sbh_threshold+1Ar ...
.data:00424020 ___sbh_pHeaderScan dd ?		       ; DATA XREF: ___sbh_heap_init+2Fw
.data:00424020					       ; ___sbh_free_block+2FCw ...
.data:00424024 ___sbh_sizeHeaderList dd	?	       ; DATA XREF: ___sbh_heap_init+3Cw
.data:00424024					       ; ___sbh_alloc_new_regionr ...
.data:00424028 ___sbh_indGroupDefer dd ?	       ; DATA XREF: ___sbh_free_block+229r
.data:00424028					       ; ___sbh_free_block+249r ...
.data:0042402C ___active_heap  dd ?		       ; DATA XREF: _free+13r
.data:0042402C					       ; __heap_alloc:loc_40214Er ...
.data:00424030		       dd 2 dup(?)
.data:00424038 ; char _pDestructExceptionObject[]
.data:00424038 __pDestructExceptionObject dd ?	       ; DATA XREF: __except_handler4+F1r
.data:00424038					       ; __except_handler4+FAo	...
.data:0042403C		       dd 2 dup(?)
.data:00424044 __acmdln	       dd ?		       ; DATA XREF: __tmainCRTStartup+FFw
.data:00424044					       ; __setargv+30r
.data:00424048		       align 10h
.data:00424050 ; void *__piob
.data:00424050 ___piob	       dd ?		       ; DATA XREF: ___initstdio+2Bw
.data:00424050					       ; ___initstdio+44w ...
.data:00424054		       dd 0D3h dup(?)
.data:004243A0 __bufin	       dd 400h dup(?)	       ; DATA XREF: .data:__iobo
.data:004243A0					       ; .data:00422088o
.data:004253A0 ; unsigned int _nstream
.data:004253A0 __nstream       dd ?		       ; DATA XREF: ___initstdior
.data:004253A0					       ; ___initstdio:loc_401F5Dw ...
.data:004253A4 ___env_initialized dd ?		       ; DATA XREF: __setenvp+B3w
.data:004253A4					       ; __getenv_helper_nolockr
.data:004253A8		       dd 3 dup(?)
.data:004253B4 ; void *__onexitend
.data:004253B4 ___onexitend    dd ?		       ; DATA XREF: doexit+45r
.data:004253B4					       ; _onexit_nolock+10r ...
.data:004253B8 ; void *__onexitbegin
.data:004253B8 ___onexitbegin  dd ?		       ; DATA XREF: doexit+37r
.data:004253B8					       ; _onexit_nolock+5r ...
.data:004253BC ___mbctype_initialized dd ?	       ; DATA XREF: __setenvp+3r
.data:004253BC					       ; __setargv+9r ...
.data:004253C0 ; char _FPinit[]
.data:004253C0 __FPinit	       dd ?		       ; DATA XREF: __cinitr
.data:004253C0					       ; __cinit+9o ...
.data:004253C4 ; char __dyn_tls_init_callback[]
.data:004253C4 ___dyn_tls_init_callback	dd ?	       ; DATA XREF: __cinit:loc_401BD9r
.data:004253C4					       ; __cinit+74o ...
.data:004253C8		       align 1000h
.data:004253C8 _data	       ends
.data:004253C8
.idata:004261EC	;
.idata:004261EC	; Imports from KERNEL32.dll
.idata:004261EC	;
.idata:004261EC	; Section 4. (virtual address 00026000)
.idata:004261EC	; Virtual size			: 00000B73 (   2931.)
.idata:004261EC	; Section size in file		: 00001000 (   4096.)
.idata:004261EC	; Offset to raw	data for section: 00024000
.idata:004261EC	; Flags	C0000040: Data Readable	Writable
.idata:004261EC	; Alignment	: default
.idata:004261EC	; ===========================================================================
.idata:004261EC
.idata:004261EC	; Segment type:	Externs
.idata:004261EC	; _idata
.idata:004261EC	; DWORD	__stdcall GetLastError()
.idata:004261EC			extrn __imp__GetLastError@0:dword ; CODE XREF: _free+79p
.idata:004261EC						; __getptd_noexit+2p ...
.idata:004261F0	; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
.idata:004261F0			extrn __imp__HeapFree@12:dword ; CODE XREF: _free+68p
.idata:004261F0						; __tmainCRTStartup+4Ep ...
.idata:004261F4	; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
.idata:004261F4			extrn __imp__GetProcAddress@8:dword
.idata:004261F4						; CODE XREF: ___crtCorExitProcess+15p
.idata:004261F4						; __encode_pointer+54p	...
.idata:004261F8	; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
.idata:004261F8			extrn __imp__GetModuleHandleA@4:dword
.idata:004261F8						; CODE XREF: ___crtCorExitProcess+5p
.idata:004261F8						; _use_encode_pointer+28p ...
.idata:004261FC	; void __stdcall ExitProcess(UINT uExitCode)
.idata:004261FC			extrn __imp__ExitProcess@4:dword
.idata:004261FC						; CODE XREF: ___crtExitProcess+Ep
.idata:004261FC						; DATA XREF: ___crtExitProcess+Er ...
.idata:00426200	; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:00426200			extrn __imp__EnterCriticalSection@4:dword
.idata:00426200						; CODE XREF: __lock_file+34p
.idata:00426200						; __lock_file2+27p ...
.idata:00426204	; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:00426204			extrn __imp__LeaveCriticalSection@4:dword
.idata:00426204						; CODE XREF: __unlock_file+2Fp
.idata:00426204						; __unlock_file2+23p ...
.idata:00426208	; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
.idata:00426208			extrn __imp__HeapAlloc@12:dword
.idata:00426208						; CODE XREF: __heap_alloc+3Dp
.idata:00426208						; __heap_alloc+6Dp ...
.idata:0042620C	; LPSTR	__stdcall GetCommandLineA()
.idata:0042620C			extrn __imp__GetCommandLineA@0:dword
.idata:0042620C						; CODE XREF: __tmainCRTStartup:loc_4023F5p
.idata:0042620C						; DATA XREF: __tmainCRTStartup:loc_4023F5r ...
.idata:00426210	; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
.idata:00426210			extrn __imp__GetVersionExA@4:dword
.idata:00426210						; CODE XREF: __tmainCRTStartup+3Ep
.idata:00426210						; DATA XREF: __tmainCRTStartup+3Er ...
.idata:00426214	; HANDLE __stdcall GetProcessHeap()
.idata:00426214			extrn __imp__GetProcessHeap@0:dword
.idata:00426214						; CODE XREF: __tmainCRTStartup+1Ap
.idata:00426214						; __tmainCRTStartup+4Bp ...
.idata:00426218	; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
.idata:00426218			extrn __imp__TerminateProcess@8:dword
.idata:00426218						; CODE XREF: __invoke_watson+E0p
.idata:00426218						; ___report_gsfailure+FCp
.idata:00426218						; DATA XREF: ...
.idata:0042621C	; HANDLE __stdcall GetCurrentProcess()
.idata:0042621C			extrn __imp__GetCurrentProcess@0:dword
.idata:0042621C						; CODE XREF: __invoke_watson+D9p
.idata:0042621C						; ___report_gsfailure+F5p
.idata:0042621C						; DATA XREF: ...
.idata:00426220	; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
.idata:00426220			extrn __imp__UnhandledExceptionFilter@4:dword
.idata:00426220						; CODE XREF: __invoke_watson+BEp
.idata:00426220						; _abort+E5p ...
.idata:00426224	; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
.idata:00426224			extrn __imp__SetUnhandledExceptionFilter@4:dword
.idata:00426224						; CODE XREF: __invoke_watson+B4p
.idata:00426224						; ___CxxSetUnhandledExceptionFilter+5p	...
.idata:00426228	; BOOL __stdcall IsDebuggerPresent()
.idata:00426228			extrn __imp__IsDebuggerPresent@0:dword
.idata:00426228						; CODE XREF: __invoke_watson+AAp
.idata:00426228						; ___report_gsfailure+B9p
.idata:00426228						; DATA XREF: ...
.idata:0042622C	; BOOL __stdcall HeapDestroy(HANDLE hHeap)
.idata:0042622C			extrn __imp__HeapDestroy@4:dword
.idata:0042622C						; CODE XREF: __heap_init+47p
.idata:0042622C						; __heap_term+66p
.idata:0042622C						; DATA XREF: ...
.idata:00426230	; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
.idata:00426230			extrn __imp__HeapCreate@12:dword
.idata:00426230						; CODE XREF: __heap_init+11p
.idata:00426230						; DATA XREF: __heap_init+11r ...
.idata:00426234	; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
.idata:00426234			extrn __imp__VirtualFree@12:dword
.idata:00426234						; CODE XREF: __heap_term+31p
.idata:00426234						; ___sbh_free_block+247p ...
.idata:00426238	; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:00426238			extrn __imp__DeleteCriticalSection@4:dword
.idata:00426238						; CODE XREF: __mtdeletelocks+1Bp
.idata:00426238						; __mtdeletelocks+45p ...
.idata:0042623C	; void __stdcall FatalAppExitA(UINT uAction, LPCSTR lpMessageText)
.idata:0042623C			extrn __imp__FatalAppExitA@8:dword
.idata:0042623C						; CODE XREF: __lockerr_exit+6p
.idata:0042623C						; DATA XREF: __lockerr_exit+6r	...
.idata:00426240	; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
.idata:00426240			extrn __imp__VirtualAlloc@16:dword
.idata:00426240						; CODE XREF: ___sbh_alloc_new_region+77p
.idata:00426240						; ___sbh_alloc_new_group+52p
.idata:00426240						; DATA XREF: ...
.idata:00426244	; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
.idata:00426244			extrn __imp__HeapReAlloc@16:dword
.idata:00426244						; CODE XREF: ___sbh_alloc_new_region+27p
.idata:00426244						; _realloc+134p ...
.idata:00426248	; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
.idata:00426248			extrn __imp__TlsGetValue@4:dword
.idata:00426248						; CODE XREF: __encode_pointer+Dp
.idata:00426248						; __encode_pointer+24p	...
.idata:0042624C	; DWORD	__stdcall TlsAlloc()
.idata:0042624C			extrn __imp__TlsAlloc@0:dword ;	CODE XREF: __crtTlsAlloc(x)p
.idata:0042624C						; __mtinit:loc_404ED5p
.idata:0042624C						; DATA XREF: ...
.idata:00426250	; BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue)
.idata:00426250			extrn __imp__TlsSetValue@8:dword
.idata:00426250						; CODE XREF: ___set_flsgetvalue+28p
.idata:00426250						; __freeptd+62p ...
.idata:00426254	; BOOL __stdcall TlsFree(DWORD dwTlsIndex)
.idata:00426254			extrn __imp__TlsFree@4:dword ; CODE XREF: __mtterm+2Bp
.idata:00426254						; DATA XREF: __mtterm+2Br ...
.idata:00426258	; LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend)
.idata:00426258			extrn __imp__InterlockedIncrement@4:dword
.idata:00426258						; CODE XREF: __initptd+77p
.idata:00426258						; ___updatetmbcinfo+84p ...
.idata:0042625C	; void __stdcall SetLastError(DWORD dwErrCode)
.idata:0042625C			extrn __imp__SetLastError@4:dword
.idata:0042625C						; CODE XREF: __getptd_noexit+6Cp
.idata:0042625C						; ___crtInitCritSecAndSpinCount+ABp
.idata:0042625C						; DATA XREF: ...
.idata:00426260	; DWORD	__stdcall GetCurrentThreadId()
.idata:00426260			extrn __imp__GetCurrentThreadId@0:dword
.idata:00426260						; CODE XREF: __getptd_noexit+54p
.idata:00426260						; __mtinit+169p ...
.idata:00426264	; LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend)
.idata:00426264			extrn __imp__InterlockedDecrement@4:dword
.idata:00426264						; CODE XREF: _freefls(x)+90p
.idata:00426264						; ___updatetmbcinfo+59p ...
.idata:00426268	; HANDLE __stdcall GetCurrentThread()
.idata:00426268			extrn __imp__GetCurrentThread@0:dword
.idata:00426268						; DATA XREF: ___threadhandler
.idata:00426268						; GetCurrentThread()r
.idata:0042626C	; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
.idata:0042626C			extrn __imp__WriteFile@20:dword
.idata:0042626C						; CODE XREF: __NMSG_WRITE+194p
.idata:0042626C						; __write_nolock+241p ...
.idata:00426270	; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
.idata:00426270			extrn __imp__GetStdHandle@4:dword
.idata:00426270						; CODE XREF: __NMSG_WRITE+169p
.idata:00426270						; __ioinit+1C9p
.idata:00426270						; DATA XREF: ...
.idata:00426274	; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPCH lpFilename, DWORD nSize)
.idata:00426274			extrn __imp__GetModuleFileNameA@12:dword
.idata:00426274						; CODE XREF: __NMSG_WRITE+99p
.idata:00426274						; __setargv+2Ap
.idata:00426274						; DATA XREF: ...
.idata:00426278	; BOOL __stdcall SetConsoleCtrlHandler(PHANDLER_ROUTINE	HandlerRoutine,	BOOL Add)
.idata:00426278			extrn __imp__SetConsoleCtrlHandler@8:dword
.idata:00426278						; CODE XREF: _signal+117p
.idata:00426278						; DATA XREF: _signal+117r ...
.idata:0042627C	; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
.idata:0042627C			extrn __imp__FreeLibrary@4:dword ; CODE	XREF: _rand_s+DAp
.idata:0042627C						; DATA XREF: _rand_s+DAr ...
.idata:00426280	; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
.idata:00426280			extrn __imp__InterlockedExchange@8:dword
.idata:00426280						; CODE XREF: _rand_s+CDp
.idata:00426280						; DATA XREF: _rand_s+CDr ...
.idata:00426284	; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
.idata:00426284			extrn __imp__LoadLibraryA@4:dword ; CODE XREF: _rand_s+4Ap
.idata:00426284						; ___crtMessageBoxA+2Dp
.idata:00426284						; DATA XREF: ...
.idata:00426288	; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:00426288			extrn __imp__InitializeCriticalSection@4:dword
.idata:00426288						; CODE XREF: __crtInitCritSecNoSpinCount+4p
.idata:00426288						; DATA XREF: __crtInitCritSecNoSpinCount+4r ...
.idata:0042628C	; UINT __stdcall SetHandleCount(UINT uNumber)
.idata:0042628C			extrn __imp__SetHandleCount@4:dword
.idata:0042628C						; CODE XREF: __ioinit+233p
.idata:0042628C						; DATA XREF: __ioinit+233r ...
.idata:00426290	; DWORD	__stdcall GetFileType(HANDLE hFile)
.idata:00426290			extrn __imp__GetFileType@4:dword ; CODE	XREF: __ioinit+13Fp
.idata:00426290						; __ioinit+1DBp ...
.idata:00426294	; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
.idata:00426294			extrn __imp__GetStartupInfoA@4:dword
.idata:00426294						; CODE XREF: __ioinit+15p
.idata:00426294						; DATA XREF: __ioinit+15r ...
.idata:00426298	; void __stdcall Sleep(DWORD dwMilliseconds)
.idata:00426298			extrn __imp__Sleep@4:dword ; CODE XREF:	_wait_a_bit+6p
.idata:00426298						; __malloc_crt+1Dp ...
.idata:0042629C	; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
.idata:0042629C			extrn __imp__FreeEnvironmentStringsA@4:dword
.idata:0042629C						; CODE XREF: ___crtGetEnvironmentStringsA+10Fp
.idata:0042629C						; ___crtGetEnvironmentStringsA+126p
.idata:0042629C						; DATA XREF: ...
.idata:004262A0	; LPCH __stdcall GetEnvironmentStrings()
.idata:004262A0			extrn __imp__GetEnvironmentStrings@0:dword
.idata:004262A0						; CODE XREF: ___crtGetEnvironmentStringsA:loc_406C94p
.idata:004262A0						; DATA XREF: ___crtGetEnvironmentStringsA:loc_406C94r ...
.idata:004262A4	; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
.idata:004262A4			extrn __imp__FreeEnvironmentStringsW@4:dword
.idata:004262A4						; CODE XREF: ___crtGetEnvironmentStringsA+CCp
.idata:004262A4						; DATA XREF: ___crtGetEnvironmentStringsA+CCr ...
.idata:004262A8	; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
.idata:004262A8			extrn __imp__WideCharToMultiByte@32:dword
.idata:004262A8						; CODE XREF: ___crtGetEnvironmentStringsA+91p
.idata:004262A8						; ___crtGetEnvironmentStringsA+B3p ...
.idata:004262AC	; LPWCH	__stdcall GetEnvironmentStringsW()
.idata:004262AC			extrn __imp__GetEnvironmentStringsW@0:dword
.idata:004262AC						; CODE XREF: ___crtGetEnvironmentStringsA+1Cp
.idata:004262AC						; ___crtGetEnvironmentStringsA+56p
.idata:004262AC						; DATA XREF: ...
.idata:004262B0	; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
.idata:004262B0			extrn __imp__QueryPerformanceCounter@4:dword
.idata:004262B0						; CODE XREF: ___security_init_cookie+5Dp
.idata:004262B0						; DATA XREF: ___security_init_cookie+5Dr ...
.idata:004262B4	; DWORD	__stdcall GetTickCount()
.idata:004262B4			extrn __imp__GetTickCount@0:dword
.idata:004262B4						; CODE XREF: ___security_init_cookie+51p
.idata:004262B4						; DATA XREF: ___security_init_cookie+51r ...
.idata:004262B8	; DWORD	__stdcall GetCurrentProcessId()
.idata:004262B8			extrn __imp__GetCurrentProcessId@0:dword
.idata:004262B8						; CODE XREF: ___security_init_cookie+41p
.idata:004262B8						; DATA XREF: ___security_init_cookie+41r ...
.idata:004262BC	; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
.idata:004262BC			extrn __imp__GetSystemTimeAsFileTime@4:dword
.idata:004262BC						; CODE XREF: ___security_init_cookie+35p
.idata:004262BC						; DATA XREF: ___security_init_cookie+35r ...
.idata:004262C0	; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
.idata:004262C0			extrn __imp__GetCPInfo@8:dword ; CODE XREF: setSBUpLow+24p
.idata:004262C0						; __setmbcp_nolock+84p	...
.idata:004262C4	; UINT __stdcall GetACP()
.idata:004262C4			extrn __imp__GetACP@0:dword ; CODE XREF: getSystemCP+4Ap
.idata:004262C4						; DATA XREF: getSystemCP+4Ar ...
.idata:004262C8	; UINT __stdcall GetOEMCP()
.idata:004262C8			extrn __imp__GetOEMCP@0:dword ;	CODE XREF: getSystemCP+27p
.idata:004262C8						; DATA XREF: getSystemCP+27r ...
.idata:004262CC	; BOOL __stdcall IsValidCodePage(UINT CodePage)
.idata:004262CC			extrn __imp__IsValidCodePage@4:dword
.idata:004262CC						; CODE XREF: __setmbcp_nolock+71p
.idata:004262CC						; ___get_qualified_locale+128p
.idata:004262CC						; DATA XREF: ...
.idata:004262D0	; __declspec(dllimport)	__stdcall RtlUnwind(x, x, x, x)
.idata:004262D0			extrn __imp__RtlUnwind@16:dword
.idata:004262D0						; DATA XREF: RtlUnwind(x,x,x,x)r
.idata:004262D4	; SIZE_T __stdcall HeapSize(HANDLE hHeap, DWORD	dwFlags, LPCVOID lpMem)
.idata:004262D4			extrn __imp__HeapSize@12:dword ; CODE XREF: __msize+82p
.idata:004262D4						; DATA XREF: __msize+82r ...
.idata:004262D8	; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
.idata:004262D8			extrn __imp__MultiByteToWideChar@24:dword
.idata:004262D8						; CODE XREF: __crtGetLocaleInfoW_stat+116p
.idata:004262D8						; __crtLCMapStringA_stat+CEp ...
.idata:004262DC	; int __stdcall	GetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData)
.idata:004262DC			extrn __imp__GetLocaleInfoA@16:dword
.idata:004262DC						; CODE XREF: __crtGetLocaleInfoW_stat+94p
.idata:004262DC						; __crtGetLocaleInfoW_stat+F7p	...
.idata:004262E0	; int __stdcall	GetLocaleInfoW(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int	cchData)
.idata:004262E0			extrn __imp__GetLocaleInfoW@16:dword
.idata:004262E0						; CODE XREF: __crtGetLocaleInfoW_stat+2Ap
.idata:004262E0						; __crtGetLocaleInfoW_stat+63p	...
.idata:004262E4	; UINT __stdcall GetConsoleCP()
.idata:004262E4			extrn __imp__GetConsoleCP@0:dword
.idata:004262E4						; CODE XREF: __write_nolock:loc_40C6A6p
.idata:004262E4						; DATA XREF: __write_nolock:loc_40C6A6r ...
.idata:004262E8	; BOOL __stdcall GetConsoleMode(HANDLE hConsoleHandle, LPDWORD lpMode)
.idata:004262E8			extrn __imp__GetConsoleMode@8:dword
.idata:004262E8						; CODE XREF: __write_nolock+126p
.idata:004262E8						; DATA XREF: __write_nolock+126r ...
.idata:004262EC	; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
.idata:004262EC			extrn __imp__FlushFileBuffers@4:dword
.idata:004262EC						; CODE XREF: __commit+8Cp
.idata:004262EC						; DATA XREF: __commit+8Cr ...
.idata:004262F0	; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
.idata:004262F0			extrn __imp__LCMapStringA@24:dword
.idata:004262F0						; CODE XREF: __crtLCMapStringA_stat+2A6p
.idata:004262F0						; __crtLCMapStringA_stat+318p ...
.idata:004262F4	; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
.idata:004262F4			extrn __imp__LCMapStringW@24:dword
.idata:004262F4						; CODE XREF: __crtLCMapStringA_stat+30p
.idata:004262F4						; __crtLCMapStringA_stat+156p ...
.idata:004262F8	; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
.idata:004262F8			extrn __imp__GetStringTypeA@20:dword
.idata:004262F8						; CODE XREF: __crtGetStringTypeA_stat+191p
.idata:004262F8						; __crtGetStringTypeW_stat+1D4p
.idata:004262F8						; DATA XREF: ...
.idata:004262FC	; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
.idata:004262FC			extrn __imp__GetStringTypeW@16:dword
.idata:004262FC						; CODE XREF: __crtGetStringTypeA_stat+2Dp
.idata:004262FC						; __crtGetStringTypeA_stat+11Cp ...
.idata:00426300	; int __stdcall	GetTimeFormatA(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpTime, LPCSTR lpFormat, LPSTR lpTimeStr, int cchTime)
.idata:00426300			extrn __imp__GetTimeFormatA@24:dword
.idata:00426300						; DATA XREF: _store_winword+54r
.idata:00426300						; GetTimeFormatA(x,x,x,x,x,x)r
.idata:00426304	; int __stdcall	GetDateFormatA(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpDate, LPCSTR lpFormat, LPSTR lpDateStr, int cchDate)
.idata:00426304			extrn __imp__GetDateFormatA@24:dword
.idata:00426304						; CODE XREF: _store_winword+A5p
.idata:00426304						; DATA XREF: _store_winword+4Cr ...
.idata:00426308	; LCID __stdcall GetUserDefaultLCID()
.idata:00426308			extrn __imp__GetUserDefaultLCID@0:dword
.idata:00426308						; CODE XREF: GetLcidFromDefault+7p
.idata:00426308						; ___get_qualified_locale:loc_40FD68p
.idata:00426308						; DATA XREF: ...
.idata:0042630C	; BOOL __stdcall EnumSystemLocalesA(LOCALE_ENUMPROCA lpLocaleEnumProc, DWORD dwFlags)
.idata:0042630C			extrn __imp__EnumSystemLocalesA@8:dword
.idata:0042630C						; CODE XREF: GetLcidFromCountry+1Bp
.idata:0042630C						; GetLcidFromLangCountry+47p ...
.idata:00426310	; BOOL __stdcall IsValidLocale(LCID Locale, DWORD dwFlags)
.idata:00426310			extrn __imp__IsValidLocale@8:dword
.idata:00426310						; CODE XREF: ___get_qualified_locale+13Bp
.idata:00426310						; DATA XREF: ___get_qualified_locale+13Br ...
.idata:00426314	; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
.idata:00426314			extrn __imp__SetFilePointer@16:dword
.idata:00426314						; CODE XREF: __lseeki64_nolock+40p
.idata:00426314						; DATA XREF: __lseeki64_nolock+40r ...
.idata:00426318	; BOOL __stdcall CloseHandle(HANDLE hObject)
.idata:00426318			extrn __imp__CloseHandle@4:dword
.idata:00426318						; CODE XREF: __close_nolock+4Ep
.idata:00426318						; ___termcon+17p ...
.idata:0042631C	; BOOL __stdcall WriteConsoleA(HANDLE hConsoleOutput, const void *lpBuffer, DWORD nNumberOfCharsToWrite, LPDWORD lpNumberOfCharsWritten, LPVOID	lpReserved)
.idata:0042631C			extrn __imp__WriteConsoleA@20:dword
.idata:0042631C						; CODE XREF: __putwch_nolock+9Bp
.idata:0042631C						; DATA XREF: __putwch_nolock+9Br ...
.idata:00426320	; UINT __stdcall GetConsoleOutputCP()
.idata:00426320			extrn __imp__GetConsoleOutputCP@0:dword
.idata:00426320						; CODE XREF: __putwch_nolock+78p
.idata:00426320						; DATA XREF: __putwch_nolock+78r ...
.idata:00426324	; BOOL __stdcall WriteConsoleW(HANDLE hConsoleOutput, const void *lpBuffer, DWORD nNumberOfCharsToWrite, LPDWORD lpNumberOfCharsWritten, LPVOID	lpReserved)
.idata:00426324			extrn __imp__WriteConsoleW@20:dword
.idata:00426324						; CODE XREF: __putwch_nolock+45p
.idata:00426324						; DATA XREF: __putwch_nolock+45r ...
.idata:00426328	; BOOL __stdcall SetStdHandle(DWORD nStdHandle,	HANDLE hHandle)
.idata:00426328			extrn __imp__SetStdHandle@8:dword
.idata:00426328						; CODE XREF: __set_osfhnd:loc_413B7Dp
.idata:00426328						; __free_osfhnd:loc_413BFEp
.idata:00426328						; DATA XREF: ...
.idata:0042632C	; DWORD	__stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)
.idata:0042632C			extrn __imp__GetTimeZoneInformation@4:dword
.idata:0042632C						; CODE XREF: _tzset_nolock+14Cp
.idata:0042632C						; DATA XREF: _tzset_nolock+14Cr ...
.idata:00426330	; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
.idata:00426330			extrn __imp__CreateFileA@28:dword
.idata:00426330						; CODE XREF: ___initconin+13p
.idata:00426330						; ___initconout+13p
.idata:00426330						; DATA XREF: ...
.idata:00426334	; int __stdcall	CompareStringA(LCID Locale, DWORD dwCmpFlags, LPCSTR lpString1,	int cchCount1, LPCSTR lpString2, int cchCount2)
.idata:00426334			extrn __imp__CompareStringA@24:dword
.idata:00426334						; CODE XREF: __crtCompareStringA_stat+35Bp
.idata:00426334						; DATA XREF: __crtCompareStringA_stat+35Br ...
.idata:00426338	; int __stdcall	CompareStringW(LCID Locale, DWORD dwCmpFlags, LPCWSTR lpString1, int cchCount1,	LPCWSTR	lpString2, int cchCount2)
.idata:00426338			extrn __imp__CompareStringW@24:dword
.idata:00426338						; CODE XREF: __crtCompareStringA_stat+37p
.idata:00426338						; __crtCompareStringA_stat+2A1p
.idata:00426338						; DATA XREF: ...
.idata:0042633C	; BOOL __stdcall SetEnvironmentVariableA(LPCSTR	lpName,	LPCSTR lpValue)
.idata:0042633C			extrn __imp__SetEnvironmentVariableA@8:dword
.idata:0042633C						; CODE XREF: ___crtsetenv+1FCp
.idata:0042633C						; DATA XREF: ___crtsetenv+1FCr	...
.idata:00426340			extrn _KERNEL32_NULL_THUNK_DATA:byte:70h
.idata:00426340
.idata:00426340
.idata:00426340			end _mainCRTStartup
